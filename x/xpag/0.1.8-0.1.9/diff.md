# Comparing `tmp/xpag-0.1.8-py3-none-any.whl.zip` & `tmp/xpag-0.1.9-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,42 +1,42 @@
-Zip file size: 54803 bytes, number of entries: 40
--rw-r--r--  2.0 unx      211 b- defN 23-May-09 14:49 xpag/__init__.py
--rw-r--r--  2.0 unx      204 b- defN 23-May-09 14:49 xpag/agents/__init__.py
--rw-r--r--  2.0 unx     1098 b- defN 23-May-09 14:49 xpag/agents/agent.py
--rw-r--r--  2.0 unx        0 b- defN 23-May-09 14:49 xpag/agents/sac/__init__.py
--rw-r--r--  2.0 unx     5554 b- defN 23-May-09 14:49 xpag/agents/sac/sac.py
--rw-r--r--  2.0 unx    18817 b- defN 23-May-09 14:49 xpag/agents/sac/sac_from_jaxrl.py
--rw-r--r--  2.0 unx        0 b- defN 23-May-09 14:49 xpag/agents/sdqn/__init__.py
--rw-r--r--  2.0 unx    22063 b- defN 23-May-09 14:49 xpag/agents/sdqn/sdqn.py
--rw-r--r--  2.0 unx        0 b- defN 23-May-09 14:49 xpag/agents/td3/__init__.py
--rw-r--r--  2.0 unx    15221 b- defN 23-May-09 14:49 xpag/agents/td3/td3.py
--rw-r--r--  2.0 unx        0 b- defN 23-May-09 14:49 xpag/agents/tqc/__init__.py
--rw-r--r--  2.0 unx    12988 b- defN 23-May-09 14:49 xpag/agents/tqc/tqc.py
--rw-r--r--  2.0 unx      160 b- defN 23-May-09 14:49 xpag/buffers/__init__.py
--rw-r--r--  2.0 unx    11221 b- defN 23-May-09 14:49 xpag/buffers/buffer.py
--rw-r--r--  2.0 unx     5236 b- defN 23-May-09 14:49 xpag/buffers/jax_buffer.py
--rw-r--r--  2.0 unx       55 b- defN 23-May-09 14:49 xpag/plotting/__init__.py
--rw-r--r--  2.0 unx     4086 b- defN 23-May-09 14:49 xpag/plotting/plotting.py
--rw-r--r--  2.0 unx     2841 b- defN 23-May-09 14:49 xpag/samplers/HER.py
--rw-r--r--  2.0 unx      182 b- defN 23-May-09 14:49 xpag/samplers/__init__.py
--rw-r--r--  2.0 unx     2941 b- defN 23-May-09 14:49 xpag/samplers/jax_sampler.py
--rw-r--r--  2.0 unx     1917 b- defN 23-May-09 14:49 xpag/samplers/sampler.py
--rw-r--r--  2.0 unx       71 b- defN 23-May-09 14:49 xpag/setters/__init__.py
--rw-r--r--  2.0 unx     3734 b- defN 23-May-09 14:49 xpag/setters/setter.py
--rw-r--r--  2.0 unx      438 b- defN 23-May-09 14:49 xpag/tools/__init__.py
--rw-r--r--  2.0 unx     5065 b- defN 23-May-09 14:49 xpag/tools/eval.py
--rw-r--r--  2.0 unx     7611 b- defN 23-May-09 14:49 xpag/tools/learn.py
--rw-r--r--  2.0 unx     3225 b- defN 23-May-09 14:49 xpag/tools/logging.py
--rw-r--r--  2.0 unx     4708 b- defN 23-May-09 14:49 xpag/tools/replay.py
--rw-r--r--  2.0 unx      899 b- defN 23-May-09 14:49 xpag/tools/timing.py
--rw-r--r--  2.0 unx     5273 b- defN 23-May-09 14:49 xpag/tools/utils.py
--rw-r--r--  2.0 unx      179 b- defN 23-May-09 14:49 xpag/wrappers/__init__.py
--rw-r--r--  2.0 unx     8257 b- defN 23-May-09 14:49 xpag/wrappers/brax_vec_env.py
--rw-r--r--  2.0 unx     6071 b- defN 23-May-09 14:49 xpag/wrappers/goalenv_wrapper.py
--rw-r--r--  2.0 unx    10125 b- defN 23-May-09 14:49 xpag/wrappers/gym_vec_env.py
--rw-r--r--  2.0 unx      936 b- defN 23-May-09 14:49 xpag/wrappers/reset_done.py
--rw-r--r--  2.0 unx     1517 b- defN 23-May-09 14:49 xpag-0.1.8.dist-info/LICENSE
--rw-r--r--  2.0 unx    15098 b- defN 23-May-09 14:49 xpag-0.1.8.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-May-09 14:49 xpag-0.1.8.dist-info/WHEEL
--rw-r--r--  2.0 unx        5 b- defN 23-May-09 14:49 xpag-0.1.8.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     3184 b- defN 23-May-09 14:49 xpag-0.1.8.dist-info/RECORD
-40 files, 181283 bytes uncompressed, 49781 bytes compressed:  72.5%
+Zip file size: 54938 bytes, number of entries: 40
+-rw-r--r--  2.0 unx      211 b- defN 23-May-16 09:12 xpag/__init__.py
+-rw-r--r--  2.0 unx      204 b- defN 23-May-16 09:12 xpag/agents/__init__.py
+-rw-r--r--  2.0 unx     1098 b- defN 23-May-16 09:12 xpag/agents/agent.py
+-rw-r--r--  2.0 unx        0 b- defN 23-May-16 09:12 xpag/agents/sac/__init__.py
+-rw-r--r--  2.0 unx     5554 b- defN 23-May-16 09:12 xpag/agents/sac/sac.py
+-rw-r--r--  2.0 unx    18817 b- defN 23-May-16 09:12 xpag/agents/sac/sac_from_jaxrl.py
+-rw-r--r--  2.0 unx        0 b- defN 23-May-16 09:12 xpag/agents/sdqn/__init__.py
+-rw-r--r--  2.0 unx    22063 b- defN 23-May-16 09:12 xpag/agents/sdqn/sdqn.py
+-rw-r--r--  2.0 unx        0 b- defN 23-May-16 09:12 xpag/agents/td3/__init__.py
+-rw-r--r--  2.0 unx    15221 b- defN 23-May-16 09:12 xpag/agents/td3/td3.py
+-rw-r--r--  2.0 unx        0 b- defN 23-May-16 09:12 xpag/agents/tqc/__init__.py
+-rw-r--r--  2.0 unx    12988 b- defN 23-May-16 09:12 xpag/agents/tqc/tqc.py
+-rw-r--r--  2.0 unx      160 b- defN 23-May-16 09:12 xpag/buffers/__init__.py
+-rw-r--r--  2.0 unx    11221 b- defN 23-May-16 09:12 xpag/buffers/buffer.py
+-rw-r--r--  2.0 unx     5236 b- defN 23-May-16 09:12 xpag/buffers/jax_buffer.py
+-rw-r--r--  2.0 unx       55 b- defN 23-May-16 09:12 xpag/plotting/__init__.py
+-rw-r--r--  2.0 unx     4086 b- defN 23-May-16 09:12 xpag/plotting/plotting.py
+-rw-r--r--  2.0 unx     2841 b- defN 23-May-16 09:12 xpag/samplers/HER.py
+-rw-r--r--  2.0 unx      182 b- defN 23-May-16 09:12 xpag/samplers/__init__.py
+-rw-r--r--  2.0 unx     2941 b- defN 23-May-16 09:12 xpag/samplers/jax_sampler.py
+-rw-r--r--  2.0 unx     1917 b- defN 23-May-16 09:12 xpag/samplers/sampler.py
+-rw-r--r--  2.0 unx       71 b- defN 23-May-16 09:12 xpag/setters/__init__.py
+-rw-r--r--  2.0 unx     3734 b- defN 23-May-16 09:12 xpag/setters/setter.py
+-rw-r--r--  2.0 unx      438 b- defN 23-May-16 09:12 xpag/tools/__init__.py
+-rw-r--r--  2.0 unx     5065 b- defN 23-May-16 09:12 xpag/tools/eval.py
+-rw-r--r--  2.0 unx     7611 b- defN 23-May-16 09:12 xpag/tools/learn.py
+-rw-r--r--  2.0 unx     3225 b- defN 23-May-16 09:12 xpag/tools/logging.py
+-rw-r--r--  2.0 unx     4708 b- defN 23-May-16 09:12 xpag/tools/replay.py
+-rw-r--r--  2.0 unx      899 b- defN 23-May-16 09:12 xpag/tools/timing.py
+-rw-r--r--  2.0 unx     6933 b- defN 23-May-16 09:12 xpag/tools/utils.py
+-rw-r--r--  2.0 unx      179 b- defN 23-May-16 09:12 xpag/wrappers/__init__.py
+-rw-r--r--  2.0 unx     8257 b- defN 23-May-16 09:12 xpag/wrappers/brax_vec_env.py
+-rw-r--r--  2.0 unx     6099 b- defN 23-May-16 09:12 xpag/wrappers/goalenv_wrapper.py
+-rw-r--r--  2.0 unx    10148 b- defN 23-May-16 09:12 xpag/wrappers/gym_vec_env.py
+-rw-r--r--  2.0 unx      936 b- defN 23-May-16 09:12 xpag/wrappers/reset_done.py
+-rw-r--r--  2.0 unx     1517 b- defN 23-May-16 09:13 xpag-0.1.9.dist-info/LICENSE
+-rw-r--r--  2.0 unx    15098 b- defN 23-May-16 09:13 xpag-0.1.9.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-May-16 09:13 xpag-0.1.9.dist-info/WHEEL
+-rw-r--r--  2.0 unx        5 b- defN 23-May-16 09:13 xpag-0.1.9.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     3184 b- defN 23-May-16 09:13 xpag-0.1.9.dist-info/RECORD
+40 files, 182994 bytes uncompressed, 49916 bytes compressed:  72.7%
```

## zipnote {}

```diff
@@ -99,23 +99,23 @@
 
 Filename: xpag/wrappers/gym_vec_env.py
 Comment: 
 
 Filename: xpag/wrappers/reset_done.py
 Comment: 
 
-Filename: xpag-0.1.8.dist-info/LICENSE
+Filename: xpag-0.1.9.dist-info/LICENSE
 Comment: 
 
-Filename: xpag-0.1.8.dist-info/METADATA
+Filename: xpag-0.1.9.dist-info/METADATA
 Comment: 
 
-Filename: xpag-0.1.8.dist-info/WHEEL
+Filename: xpag-0.1.9.dist-info/WHEEL
 Comment: 
 
-Filename: xpag-0.1.8.dist-info/top_level.txt
+Filename: xpag-0.1.9.dist-info/top_level.txt
 Comment: 
 
-Filename: xpag-0.1.8.dist-info/RECORD
+Filename: xpag-0.1.9.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## xpag/__init__.py

```diff
@@ -2,8 +2,8 @@
 from xpag import plotting
 from xpag import wrappers
 from xpag import buffers
 from xpag import samplers
 from xpag import agents
 from xpag import setters
 
-__version__ = "0.1.8"  # -version-
+__version__ = "0.1.9"  # -version-
```

## xpag/tools/utils.py

```diff
@@ -116,19 +116,39 @@
     is_goalenv = is_goalenv
     if hasattr(env, "is_vector_env"):
         gymvecenv = env.is_vector_env
     else:
         gymvecenv = False
     dims = {}
     if gymvecenv:
-        assert isinstance(env.single_observation_space, spaces.box.Box) and isinstance(
-            env.single_action_space, spaces.box.Box
-        ), "xpag only allows spaces of type gymnasium.spaces.box.Box"
-
         info["action_dim"] = env.single_action_space.shape[-1]
+        if is_goalenv:
+            assert (
+                isinstance(env.single_observation_space["observation"], spaces.box.Box)
+                and isinstance(
+                    env.single_observation_space["achieved_goal"], spaces.box.Box
+                )
+                and isinstance(
+                    env.single_observation_space["desired_goal"], spaces.box.Box
+                )
+                and isinstance(env.single_action_space, spaces.box.Box)
+            ), (
+                'env.single_observation_space["observation"] and '
+                'env.single_observation_space["achieved_goal"] and '
+                'env.single_observation_space["desired_goal"] and '
+                "env.single_action_space must be of type gymnasium.spaces.box.Box"
+            )
+        else:
+            assert isinstance(
+                env.single_observation_space, spaces.box.Box
+            ) and isinstance(env.single_action_space, spaces.box.Box), (
+                "env.single_observation_space and "
+                "env.single_action_space must be of type gymnasium.spaces.box.Box"
+            )
+
         info["observation_dim"] = (
             env.single_observation_space["observation"].shape[-1]
             if is_goalenv
             else env.single_observation_space.shape[-1]
         )
         info["achieved_goal_dim"] = (
             env.single_observation_space["achieved_goal"].shape[-1]
@@ -137,17 +157,33 @@
         )
         info["desired_goal_dim"] = (
             env.single_observation_space["desired_goal"].shape[-1]
             if is_goalenv
             else None
         )
     else:
-        assert isinstance(env.observation_space, spaces.box.Box) and isinstance(
-            env.action_space, spaces.box.Box
-        ), "xpag only allows spaces of type gymnasium.spaces.box.Box"
+        if is_goalenv:
+            assert (
+                isinstance(env.observation_space["observation"], spaces.box.Box)
+                and isinstance(env.observation_space["achieved_goal"], spaces.box.Box)
+                and isinstance(env.observation_space["desired_goal"], spaces.box.Box)
+                and isinstance(env.action_space, spaces.box.Box)
+            ), (
+                'env.observation_space["observation"] and '
+                'env.observation_space["achieved_goal"] and '
+                'env.observation_space["desired_goal"] and '
+                "env.action_space must be of type gymnasium.spaces.box.Box"
+            )
+        else:
+            assert isinstance(env.observation_space, spaces.box.Box) and isinstance(
+                env.action_space, spaces.box.Box
+            ), (
+                "env.observation_space and "
+                "env.action_space must be of type gymnasium.spaces.box.Box"
+            )
 
         info["action_dim"] = env.action_space.shape[-1]
         info["observation_dim"] = (
             env.observation_space["observation"].shape[-1]
             if is_goalenv
             else env.observation_space.shape[-1]
         )
```

## xpag/wrappers/goalenv_wrapper.py

```diff
@@ -1,16 +1,16 @@
 import gymnasium as gym
-from gymnasium.vector import VectorEnv
+from gymnasium.vector import VectorEnv, VectorEnvWrapper
 from gymnasium import spaces
 from xpag.tools.utils import get_datatype, datatype_convert, where, hstack
 import numpy as np
 from typing import Callable, Any
 
 
-class GoalEnvWrapper(gym.Wrapper):
+class GoalEnvWrapper(VectorEnvWrapper):
     def __init__(
         self,
         env: VectorEnv,
         goal_space: spaces.Space,
         compute_achieved_goal: Callable[[Any], Any],
         compute_reward: Callable[[Any, Any, Any, Any, Any, Any, Any, Any], Any],
         compute_success: Callable[[Any, Any], Any],
@@ -107,15 +107,15 @@
     def set_goal(self, goal):
         assert (
             self.datatype is not None
         ), "reset() or reset_done() must be called before set_goal()"
         self.last_desired_goal = datatype_convert(goal, self.datatype)
 
 
-class CumulRewardWrapper(gym.Wrapper):
+class CumulRewardWrapper(VectorEnvWrapper):
     """An environment wrapper that adds the cumulative reward to observations.
     It assumes that the environment is not a goal-based environment, and that
     observations are 1D arrays (with .single_observation_space of type spaces.Box).
     """
 
     def __init__(
         self,
```

## xpag/wrappers/gym_vec_env.py

```diff
@@ -8,15 +8,15 @@
 import numpy as np
 import gymnasium as gym
 from gymnasium.vector.utils import (
     write_to_shared_memory,
     concatenate,
     create_empty_array,
 )
-from gymnasium.vector import VectorEnv, AsyncVectorEnv
+from gymnasium.vector import VectorEnv, AsyncVectorEnv, VectorEnvWrapper
 from xpag.wrappers.reset_done import ResetDoneWrapper
 from xpag.tools.utils import get_env_dimensions
 
 
 def check_goalenv(env) -> bool:
     """
     Checks if an environment is of type 'GoalEnv'.
@@ -145,15 +145,15 @@
 
 def gym_vec_env(env_name: str, num_envs: int, wrap_function: Callable = None):
     env, env_info = gym_vec_env_(env_name, num_envs, wrap_function)
     eval_env, _ = gym_vec_env_(env_name, 1, wrap_function)
     return env, eval_env, env_info
 
 
-class ResetDoneVecWrapper(gym.Wrapper):
+class ResetDoneVecWrapper(VectorEnvWrapper):
     def __init__(self, env: VectorEnv, max_episode_steps: int):
         super().__init__(env)
         self.max_episode_steps = max_episode_steps
 
     def reset(self, **kwargs):
         obs, info_ = self.env.reset(**kwargs)
         return obs, {"info_tuple": tuple(info_)}
```

## Comparing `xpag-0.1.8.dist-info/LICENSE` & `xpag-0.1.9.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `xpag-0.1.8.dist-info/METADATA` & `xpag-0.1.9.dist-info/METADATA`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: xpag
-Version: 0.1.8
+Version: 0.1.9
 Summary: xpag: Exploring Agents
 Home-page: https://github.com/perrin-isir/xpag
 Author: Nicolas Perrin-Gilbert
 License: LICENSE
 Description-Content-Type: text/markdown
 License-File: LICENSE
 Requires-Dist: psutil (>=5.8.0)
@@ -19,15 +19,15 @@
 Requires-Dist: flax (>=0.6.3)
 Requires-Dist: brax (>=0.9.0)
 Requires-Dist: tensorflow-probability (>=0.15.0)
 Requires-Dist: mediapy (>=1.1.4)
 
 # ![alt text](https://raw.githubusercontent.com/perrin-isir/xpag/main/logo.png "xpag logo")
 
-![version](https://img.shields.io/badge/version-0.1.8-blue)
+![version](https://img.shields.io/badge/version-0.1.9-blue)
 [![codestyle](https://img.shields.io/badge/code%20style-black-000000.svg)](https://github.com/psf/black)
 [![Documentation](https://img.shields.io/github/actions/workflow/status/perrin-isir/xpag/docs.yml?branch=main&label=docs)](https://perrin-isir.github.io/xpag/)
 [![PyPI version](https://img.shields.io/pypi/v/xpag)](https://pypi.org/project/xpag/)
 
 
 *xpag* ("e**xp**loring **ag**ents") is a modular reinforcement learning library with JAX agents, currently in beta version.
```

## Comparing `xpag-0.1.8.dist-info/RECORD` & `xpag-0.1.9.dist-info/RECORD`

 * *Files 6% similar despite different names*

```diff
@@ -1,8 +1,8 @@
-xpag/__init__.py,sha256=4me-5TXuzghFP4LNEl-OnOl9TftoCM-NMTg749JVmdw,211
+xpag/__init__.py,sha256=EYp8A3CVBVkt6zmJiyWhpFgyqCtIP_-0_D7Mv83KNOM,211
 xpag/agents/__init__.py,sha256=qwWcvnIIALsfDemnUNkyQqZNAbRoNbBkS9ppu0BjjRc,204
 xpag/agents/agent.py,sha256=sMvWydFTU1f4kar6nnSbvXSi56tlEla6NJiwgVnM47s,1098
 xpag/agents/sac/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 xpag/agents/sac/sac.py,sha256=xLKisxVIAmQ5FA4E4ppV3O7W8HyWgUu0VkVZzGJvsik,5554
 xpag/agents/sac/sac_from_jaxrl.py,sha256=2Nbr3jg96Ohbwcjom10WH0Pcu5ipH058KI66_LFZYUk,18817
 xpag/agents/sdqn/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 xpag/agents/sdqn/sdqn.py,sha256=0CP9Se8S9QIpMUjHJmFAQBulGzAd6FQHKbkQWhCtLSY,22063
@@ -23,18 +23,18 @@
 xpag/setters/setter.py,sha256=Rey6VOm8T8gEhVql_2LhQIN6ZKC0lC5J6aAOizPq5Rs,3734
 xpag/tools/__init__.py,sha256=6PpnqZEtELXPQ_vWnyp-l6ZnIVFXFiaMWhaTZ7XEJoI,438
 xpag/tools/eval.py,sha256=8ceSq-WiZTljQE1IE220iR1b1WodqgHsFfaxu88CK0k,5065
 xpag/tools/learn.py,sha256=Ow63UUpeW5g6vx1Hzz_wVggrCwQOfa24eyc18-_ct60,7611
 xpag/tools/logging.py,sha256=Ip3ETtLHYyqlmC8Z2BncuaI_y2RNBN99-UF1VoEWeuE,3225
 xpag/tools/replay.py,sha256=ixLRRzDgcg9NtQtbxPKTj69tpGsU4Xtop8QiL__TpfA,4708
 xpag/tools/timing.py,sha256=aihoZOw4xCML2hrgpqWs_TgFIOThPqJuyFG7weod9-Y,899
-xpag/tools/utils.py,sha256=S0AQObm47diWYNgg3aP4SSz2UEZ5F_G2leGkBGV952I,5273
+xpag/tools/utils.py,sha256=4ptg9fqSaMWWVAVXcENarK7gBfvJuIDoNW_lm1mHrsM,6933
 xpag/wrappers/__init__.py,sha256=4tECDefZtReXVN3tUyIbfNeO-Q-hXA9Pm0e5vOMKwgA,179
 xpag/wrappers/brax_vec_env.py,sha256=NvB7BvuPhWz9OSNtyz7W6infeViVRM5OOauA43OAJiE,8257
-xpag/wrappers/goalenv_wrapper.py,sha256=wryWDyfQGneC6y1emTLUmtU0c0bB8VkXhFZCPdiZkls,6071
-xpag/wrappers/gym_vec_env.py,sha256=Ot43NfJTBOLGjvvXaaSjIFpZRwNGdbW8jySODxW_X4U,10125
+xpag/wrappers/goalenv_wrapper.py,sha256=G4wmfUn7d6ae-O3b8273ZaPP-bmj6Bx8nf7QDiN3mls,6099
+xpag/wrappers/gym_vec_env.py,sha256=VQ2Q5xUa8dgpLeshqIoLNGxKzJ3CrvyG5__lFlaaZzk,10148
 xpag/wrappers/reset_done.py,sha256=GJHmSIpJuQNkiO-rKg0oDG0np7_CbZkBPJ-4akSpypY,936
-xpag-0.1.8.dist-info/LICENSE,sha256=g85jiSLf3DU-cU426LLpqKUqjFwcnfYF8qpyms8R9p8,1517
-xpag-0.1.8.dist-info/METADATA,sha256=mBpg3Kwuazbl_0w6Aj8JnECz-GO0fk6N_CwJrcNRSM0,15098
-xpag-0.1.8.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
-xpag-0.1.8.dist-info/top_level.txt,sha256=CUClY4Z7dB5zr_iqoqBK479ZNT9uDDCD7hWIHgQTDpc,5
-xpag-0.1.8.dist-info/RECORD,,
+xpag-0.1.9.dist-info/LICENSE,sha256=g85jiSLf3DU-cU426LLpqKUqjFwcnfYF8qpyms8R9p8,1517
+xpag-0.1.9.dist-info/METADATA,sha256=k_gYZB0frPqLZth7lpNtHjbguCuTZ57j0JLAVzwkKAQ,15098
+xpag-0.1.9.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
+xpag-0.1.9.dist-info/top_level.txt,sha256=CUClY4Z7dB5zr_iqoqBK479ZNT9uDDCD7hWIHgQTDpc,5
+xpag-0.1.9.dist-info/RECORD,,
```

