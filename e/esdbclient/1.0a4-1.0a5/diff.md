# Comparing `tmp/esdbclient-1.0a4.tar.gz` & `tmp/esdbclient-1.0a5.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "esdbclient-1.0a4.tar", max compression
+gzip compressed data, was "esdbclient-1.0a5.tar", max compression
```

## Comparing `esdbclient-1.0a4.tar` & `esdbclient-1.0a5.tar`

### file list

```diff
@@ -1,37 +1,37 @@
--rw-r--r--   0        0        0     1520 2022-06-23 14:19:18.317032 esdbclient-1.0a4/LICENSE
--rw-r--r--   0        0        0    94512 2023-05-11 10:14:17.148733 esdbclient-1.0a4/README.md
--rw-r--r--   0        0        0      515 2023-05-10 19:02:05.845353 esdbclient-1.0a4/esdbclient/__init__.py
--rw-r--r--   0        0        0    14218 2023-05-11 10:04:02.070439 esdbclient-1.0a4/esdbclient/asyncio_client.py
--rw-r--r--   0        0        0    32769 2023-05-11 10:04:02.066290 esdbclient-1.0a4/esdbclient/client.py
--rw-r--r--   0        0        0    11556 2023-05-10 19:02:05.847236 esdbclient-1.0a4/esdbclient/connection.py
--rw-r--r--   0        0        0     2129 2023-05-11 10:04:49.023146 esdbclient-1.0a4/esdbclient/esdbapibase.py
--rw-r--r--   0        0        0      800 2023-02-12 00:54:11.521056 esdbclient-1.0a4/esdbclient/events.py
--rw-r--r--   0        0        0     3100 2023-05-09 23:15:53.658421 esdbclient-1.0a4/esdbclient/exceptions.py
--rw-r--r--   0        0        0     4912 2023-05-10 19:02:05.848113 esdbclient-1.0a4/esdbclient/gossip.py
--rw-r--r--   0        0        0    23300 2023-05-10 19:02:05.848956 esdbclient-1.0a4/esdbclient/persistent.py
--rw-r--r--   0        0        0    13401 2023-05-09 15:45:39.784205 esdbclient-1.0a4/esdbclient/protos/Grpc/cluster_pb2.py
--rw-r--r--   0        0        0    37958 2023-05-09 15:45:38.350807 esdbclient-1.0a4/esdbclient/protos/Grpc/cluster_pb2.pyi
--rw-r--r--   0        0        0    19336 2023-05-09 15:45:39.761236 esdbclient-1.0a4/esdbclient/protos/Grpc/cluster_pb2_grpc.py
--rw-r--r--   0        0        0     1790 2023-05-09 15:45:39.793881 esdbclient-1.0a4/esdbclient/protos/Grpc/code_pb2.py
--rw-r--r--   0        0        0    13555 2023-05-09 15:45:37.813695 esdbclient-1.0a4/esdbclient/protos/Grpc/code_pb2.pyi
--rw-r--r--   0        0        0      158 2023-05-09 15:45:37.734763 esdbclient-1.0a4/esdbclient/protos/Grpc/code_pb2_grpc.py
--rw-r--r--   0        0        0     2817 2023-05-09 15:45:39.765118 esdbclient-1.0a4/esdbclient/protos/Grpc/gossip_pb2.py
--rw-r--r--   0        0        0     5524 2023-05-09 15:45:37.858863 esdbclient-1.0a4/esdbclient/protos/Grpc/gossip_pb2.pyi
--rw-r--r--   0        0        0     2752 2023-05-09 15:45:39.763073 esdbclient-1.0a4/esdbclient/protos/Grpc/gossip_pb2_grpc.py
--rw-r--r--   0        0        0    22467 2023-05-09 15:45:39.771649 esdbclient-1.0a4/esdbclient/protos/Grpc/persistent_pb2.py
--rw-r--r--   0        0        0    73220 2023-05-09 15:45:38.784305 esdbclient-1.0a4/esdbclient/protos/Grpc/persistent_pb2.pyi
--rw-r--r--   0        0        0    15771 2023-05-09 15:45:39.791304 esdbclient-1.0a4/esdbclient/protos/Grpc/persistent_pb2_grpc.py
--rw-r--r--   0        0        0     3782 2023-05-09 15:45:39.773845 esdbclient-1.0a4/esdbclient/protos/Grpc/shared_pb2.py
--rw-r--r--   0        0        0     9874 2023-05-09 15:45:37.963369 esdbclient-1.0a4/esdbclient/protos/Grpc/shared_pb2.pyi
--rw-r--r--   0        0        0      158 2023-05-09 15:45:37.783977 esdbclient-1.0a4/esdbclient/protos/Grpc/shared_pb2_grpc.py
--rw-r--r--   0        0        0     1686 2023-05-09 15:45:39.755017 esdbclient-1.0a4/esdbclient/protos/Grpc/status_pb2.py
--rw-r--r--   0        0        0     2838 2023-05-09 15:45:37.828819 esdbclient-1.0a4/esdbclient/protos/Grpc/status_pb2.pyi
--rw-r--r--   0        0        0      158 2023-05-09 15:45:37.797991 esdbclient-1.0a4/esdbclient/protos/Grpc/status_pb2_grpc.py
--rw-r--r--   0        0        0    19933 2023-05-09 15:45:39.801455 esdbclient-1.0a4/esdbclient/protos/Grpc/streams_pb2.py
--rw-r--r--   0        0        0    71744 2023-05-09 15:45:38.782146 esdbclient-1.0a4/esdbclient/protos/Grpc/streams_pb2.pyi
--rw-r--r--   0        0        0     9787 2023-05-09 15:45:37.926522 esdbclient-1.0a4/esdbclient/protos/Grpc/streams_pb2_grpc.py
--rw-r--r--   0        0        0        0 2022-06-23 14:19:18.321130 esdbclient-1.0a4/esdbclient/py.typed
--rw-r--r--   0        0        0    43278 2023-05-10 19:02:05.850483 esdbclient-1.0a4/esdbclient/streams.py
--rw-r--r--   0        0        0     2668 2023-05-11 00:30:41.914906 esdbclient-1.0a4/pyproject.toml
--rw-r--r--   0        0        0    97885 1970-01-01 00:00:00.000000 esdbclient-1.0a4/setup.py
--rw-r--r--   0        0        0    95842 1970-01-01 00:00:00.000000 esdbclient-1.0a4/PKG-INFO
+-rw-r--r--   0        0        0     1520 2022-06-23 14:19:18.317032 esdbclient-1.0a5/LICENSE
+-rw-r--r--   0        0        0   107338 2023-05-16 17:59:25.274009 esdbclient-1.0a5/README.md
+-rw-r--r--   0        0        0      515 2023-05-10 19:02:05.845353 esdbclient-1.0a5/esdbclient/__init__.py
+-rw-r--r--   0        0        0    14218 2023-05-11 10:04:02.070439 esdbclient-1.0a5/esdbclient/asyncio_client.py
+-rw-r--r--   0        0        0    35330 2023-05-16 12:05:07.454645 esdbclient-1.0a5/esdbclient/client.py
+-rw-r--r--   0        0        0    11556 2023-05-10 19:02:05.847236 esdbclient-1.0a5/esdbclient/connection.py
+-rw-r--r--   0        0        0     2330 2023-05-12 13:14:11.908419 esdbclient-1.0a5/esdbclient/esdbapibase.py
+-rw-r--r--   0        0        0      838 2023-05-11 20:15:54.815803 esdbclient-1.0a5/esdbclient/events.py
+-rw-r--r--   0        0        0     3199 2023-05-11 22:17:12.557460 esdbclient-1.0a5/esdbclient/exceptions.py
+-rw-r--r--   0        0        0     4912 2023-05-10 19:02:05.848113 esdbclient-1.0a5/esdbclient/gossip.py
+-rw-r--r--   0        0        0    28984 2023-05-16 12:05:07.458965 esdbclient-1.0a5/esdbclient/persistent.py
+-rw-r--r--   0        0        0    13401 2023-05-09 15:45:39.784205 esdbclient-1.0a5/esdbclient/protos/Grpc/cluster_pb2.py
+-rw-r--r--   0        0        0    37958 2023-05-09 15:45:38.350807 esdbclient-1.0a5/esdbclient/protos/Grpc/cluster_pb2.pyi
+-rw-r--r--   0        0        0    19336 2023-05-09 15:45:39.761236 esdbclient-1.0a5/esdbclient/protos/Grpc/cluster_pb2_grpc.py
+-rw-r--r--   0        0        0     1790 2023-05-09 15:45:39.793881 esdbclient-1.0a5/esdbclient/protos/Grpc/code_pb2.py
+-rw-r--r--   0        0        0    13555 2023-05-09 15:45:37.813695 esdbclient-1.0a5/esdbclient/protos/Grpc/code_pb2.pyi
+-rw-r--r--   0        0        0      158 2023-05-09 15:45:37.734763 esdbclient-1.0a5/esdbclient/protos/Grpc/code_pb2_grpc.py
+-rw-r--r--   0        0        0     2817 2023-05-09 15:45:39.765118 esdbclient-1.0a5/esdbclient/protos/Grpc/gossip_pb2.py
+-rw-r--r--   0        0        0     5524 2023-05-09 15:45:37.858863 esdbclient-1.0a5/esdbclient/protos/Grpc/gossip_pb2.pyi
+-rw-r--r--   0        0        0     2752 2023-05-09 15:45:39.763073 esdbclient-1.0a5/esdbclient/protos/Grpc/gossip_pb2_grpc.py
+-rw-r--r--   0        0        0    22467 2023-05-09 15:45:39.771649 esdbclient-1.0a5/esdbclient/protos/Grpc/persistent_pb2.py
+-rw-r--r--   0        0        0    73220 2023-05-09 15:45:38.784305 esdbclient-1.0a5/esdbclient/protos/Grpc/persistent_pb2.pyi
+-rw-r--r--   0        0        0    15771 2023-05-09 15:45:39.791304 esdbclient-1.0a5/esdbclient/protos/Grpc/persistent_pb2_grpc.py
+-rw-r--r--   0        0        0     3782 2023-05-09 15:45:39.773845 esdbclient-1.0a5/esdbclient/protos/Grpc/shared_pb2.py
+-rw-r--r--   0        0        0     9874 2023-05-09 15:45:37.963369 esdbclient-1.0a5/esdbclient/protos/Grpc/shared_pb2.pyi
+-rw-r--r--   0        0        0      158 2023-05-09 15:45:37.783977 esdbclient-1.0a5/esdbclient/protos/Grpc/shared_pb2_grpc.py
+-rw-r--r--   0        0        0     1686 2023-05-09 15:45:39.755017 esdbclient-1.0a5/esdbclient/protos/Grpc/status_pb2.py
+-rw-r--r--   0        0        0     2838 2023-05-09 15:45:37.828819 esdbclient-1.0a5/esdbclient/protos/Grpc/status_pb2.pyi
+-rw-r--r--   0        0        0      158 2023-05-09 15:45:37.797991 esdbclient-1.0a5/esdbclient/protos/Grpc/status_pb2_grpc.py
+-rw-r--r--   0        0        0    19933 2023-05-09 15:45:39.801455 esdbclient-1.0a5/esdbclient/protos/Grpc/streams_pb2.py
+-rw-r--r--   0        0        0    71744 2023-05-09 15:45:38.782146 esdbclient-1.0a5/esdbclient/protos/Grpc/streams_pb2.pyi
+-rw-r--r--   0        0        0     9787 2023-05-09 15:45:37.926522 esdbclient-1.0a5/esdbclient/protos/Grpc/streams_pb2_grpc.py
+-rw-r--r--   0        0        0        0 2022-06-23 14:19:18.321130 esdbclient-1.0a5/esdbclient/py.typed
+-rw-r--r--   0        0        0    43490 2023-05-12 18:07:09.772591 esdbclient-1.0a5/esdbclient/streams.py
+-rw-r--r--   0        0        0     2670 2023-05-16 19:17:37.212060 esdbclient-1.0a5/pyproject.toml
+-rw-r--r--   0        0        0   111251 1970-01-01 00:00:00.000000 esdbclient-1.0a5/setup.py
+-rw-r--r--   0        0        0   108668 1970-01-01 00:00:00.000000 esdbclient-1.0a5/PKG-INFO
```

### Comparing `esdbclient-1.0a4/LICENSE` & `esdbclient-1.0a5/LICENSE`

 * *Files identical despite different names*

### Comparing `esdbclient-1.0a4/README.md` & `esdbclient-1.0a5/README.md`

 * *Files 4% similar despite different names*

```diff
@@ -69,5839 +69,6641 @@
 00000440: 6f62 6162 6c79 2074 6865 2074 6872 6565  obably the three
 00000450: 206d 6f73 7420 7573 6566 756c 206d 6574   most useful met
 00000460: 686f 6473 206f 6620 6045 5344 4243 6c69  hods of `ESDBCli
 00000470: 656e 7460 2061 7265 3a0a 0a2a 2060 6170  ent` are:..* `ap
 00000480: 7065 6e64 5f65 7665 6e74 7328 2960 2054  pend_events()` T
 00000490: 6869 7320 6d65 7468 6f64 2063 616e 2062  his method can b
 000004a0: 6520 7573 6564 2074 6f20 7265 636f 7264  e used to record
-000004b0: 0a65 7665 6e74 7320 696e 2061 2070 6172  .events in a par
-000004c0: 7469 6375 6c61 7220 2273 7472 6561 6d22  ticular "stream"
+000004b0: 2065 7665 6e74 7320 696e 2061 2070 6172   events in a par
+000004c0: 7469 6375 6c61 720a 2273 7472 6561 6d22  ticular."stream"
 000004d0: 2e20 5468 6973 2069 7320 7573 6566 756c  . This is useful
-000004e0: 2077 6865 6e20 6578 6563 7574 696e 6720   when executing 
-000004f0: 6120 636f 6d6d 616e 640a 696e 2061 6e20  a command.in an 
-00000500: 6170 706c 6963 6174 696f 6e2e 2045 6974  application. Eit
-00000510: 6865 7220 616c 6c20 6f72 206e 6f6e 6520  her all or none 
-00000520: 6f66 2074 6865 2065 7665 6e74 7320 7769  of the events wi
-00000530: 6c6c 2062 6520 7265 636f 7264 6564 2e0a  ll be recorded..
-00000540: 0a2a 2060 7265 6164 5f73 7472 6561 6d5f  .* `read_stream_
-00000550: 6576 656e 7473 2829 6020 5468 6973 206d  events()` This m
-00000560: 6574 686f 6420 6361 6e20 6265 2075 7365  ethod can be use
-00000570: 6420 746f 2072 6574 7269 6576 6520 616c  d to retrieve al
-00000580: 6c20 7468 6520 7265 636f 7264 6564 0a65  l the recorded.e
-00000590: 7665 6e74 7320 696e 2061 2022 7374 7265  vents in a "stre
-000005a0: 616d 222e 2054 6869 7320 6973 2075 7365  am". This is use
-000005b0: 6675 6c20 666f 7220 7265 636f 6e73 7472  ful for reconstr
-000005c0: 7563 7469 6e67 2061 6e20 6167 6772 6567  ucting an aggreg
-000005d0: 6174 6520 6265 666f 7265 0a65 7865 6375  ate before.execu
-000005e0: 7469 6e67 2061 2063 6f6d 6d61 6e64 2069  ting a command i
-000005f0: 6e20 616e 2061 7070 6c69 6361 7469 6f6e  n an application
-00000600: 2e0a 0a2a 2060 7375 6273 6372 6962 655f  ...* `subscribe_
-00000610: 616c 6c5f 6576 656e 7473 2829 6020 5468  all_events()` Th
-00000620: 6973 206d 6574 686f 6420 6361 6e20 6265  is method can be
-00000630: 2075 7365 6420 746f 2072 6563 6569 7665   used to receive
-00000640: 2061 6c6c 2072 6563 6f72 6465 640a 6576   all recorded.ev
-00000650: 656e 7473 2061 6372 6f73 7320 616c 6c20  ents across all 
-00000660: 2273 7472 6561 6d73 222e 2054 6869 7320  "streams". This 
-00000670: 6973 2075 7365 6675 6c20 696e 2065 7665  is useful in eve
-00000680: 6e74 2d70 726f 6365 7373 696e 6720 636f  nt-processing co
-00000690: 6d70 6f6e 656e 7473 2c0a 616e 6420 7375  mponents,.and su
-000006a0: 7070 6f72 7473 2070 726f 6365 7373 696e  pports processin
-000006b0: 6720 6576 656e 7473 2077 6974 6820 2265  g events with "e
-000006c0: 7861 6374 6c79 2d6f 6e63 6522 2073 656d  xactly-once" sem
-000006d0: 616e 7469 6373 2e0a 0a54 6865 2065 7861  antics...The exa
-000006e0: 6d70 6c65 2062 656c 6f77 2075 7365 7320  mple below uses 
-000006f0: 616e 2022 696e 7365 6375 7265 2220 4576  an "insecure" Ev
-00000700: 656e 7453 746f 7265 4442 2073 6572 7665  entStoreDB serve
-00000710: 7220 7275 6e6e 696e 6720 6c6f 6361 6c6c  r running locall
-00000720: 7920 6f6e 2070 6f72 7420 3231 3134 2e0a  y on port 2114..
-00000730: 0a60 6060 7079 7468 6f6e 0a69 6d70 6f72  .```python.impor
-00000740: 7420 6573 6462 636c 6965 6e74 2c20 7575  t esdbclient, uu
-00000750: 6964 0a0a 0a23 2043 6f6e 7374 7275 6374  id...# Construct
-00000760: 2045 5344 4243 6c69 656e 7420 7769 7468   ESDBClient with
-00000770: 2061 6e20 4576 656e 7453 746f 7265 4442   an EventStoreDB
-00000780: 2055 5249 2e0a 0a63 6c69 656e 7420 3d20   URI...client = 
-00000790: 6573 6462 636c 6965 6e74 2e45 5344 4243  esdbclient.ESDBC
-000007a0: 6c69 656e 7428 7572 693d 2265 7364 623a  lient(uri="esdb:
-000007b0: 2f2f 6c6f 6361 6c68 6f73 743a 3231 3134  //localhost:2114
-000007c0: 3f54 6c73 3d66 616c 7365 2229 0a0a 0a23  ?Tls=false")...#
-000007d0: 2041 7070 656e 6420 6576 656e 7473 2074   Append events t
-000007e0: 6f20 6120 6e65 7720 7374 7265 616d 2e0a  o a new stream..
-000007f0: 0a73 7472 6561 6d5f 6e61 6d65 203d 2073  .stream_name = s
-00000800: 7472 2875 7569 642e 7575 6964 3428 2929  tr(uuid.uuid4())
-00000810: 0a0a 6576 656e 7431 203d 2065 7364 6263  ..event1 = esdbc
-00000820: 6c69 656e 742e 4e65 7745 7665 6e74 2874  lient.NewEvent(t
-00000830: 7970 653d 274f 7264 6572 4372 6561 7465  ype='OrderCreate
-00000840: 6427 2c20 6461 7461 3d62 2764 6174 6131  d', data=b'data1
-00000850: 2729 0a0a 636c 6965 6e74 2e61 7070 656e  ')..client.appen
-00000860: 645f 6576 656e 7473 280a 2020 2020 7374  d_events(.    st
-00000870: 7265 616d 5f6e 616d 653d 7374 7265 616d  ream_name=stream
-00000880: 5f6e 616d 652c 0a20 2020 2065 7870 6563  _name,.    expec
-00000890: 7465 645f 706f 7369 7469 6f6e 3d4e 6f6e  ted_position=Non
-000008a0: 652c 0a20 2020 2065 7665 6e74 733d 5b65  e,.    events=[e
-000008b0: 7665 6e74 315d 2c0a 290a 0a0a 2320 4170  vent1],.)...# Ap
-000008c0: 7065 6e64 206d 6f72 6520 6576 656e 7473  pend more events
-000008d0: 2074 6f20 616e 2065 7869 7374 696e 6720   to an existing 
-000008e0: 7374 7265 616d 2e0a 0a65 7665 6e74 3220  stream...event2 
-000008f0: 3d20 6573 6462 636c 6965 6e74 2e4e 6577  = esdbclient.New
-00000900: 4576 656e 7428 7479 7065 3d27 4f72 6465  Event(type='Orde
-00000910: 7255 7064 6174 6564 272c 2064 6174 613d  rUpdated', data=
-00000920: 6227 6461 7461 3227 290a 6576 656e 7433  b'data2').event3
-00000930: 203d 2065 7364 6263 6c69 656e 742e 4e65   = esdbclient.Ne
-00000940: 7745 7665 6e74 2874 7970 653d 274f 7264  wEvent(type='Ord
-00000950: 6572 4465 6c65 7465 6427 2c20 6461 7461  erDeleted', data
-00000960: 3d62 2764 6174 6133 2729 0a0a 636c 6965  =b'data3')..clie
-00000970: 6e74 2e61 7070 656e 645f 6576 656e 7473  nt.append_events
-00000980: 280a 2020 2020 7374 7265 616d 5f6e 616d  (.    stream_nam
-00000990: 653d 7374 7265 616d 5f6e 616d 652c 0a20  e=stream_name,. 
-000009a0: 2020 2065 7870 6563 7465 645f 706f 7369     expected_posi
-000009b0: 7469 6f6e 3d30 2c0a 2020 2020 6576 656e  tion=0,.    even
-000009c0: 7473 3d5b 6576 656e 7432 2c20 6576 656e  ts=[event2, even
-000009d0: 7433 5d2c 0a29 0a0a 0a23 2052 6561 6420  t3],.)...# Read 
-000009e0: 616c 6c20 6576 656e 7473 2072 6563 6f72  all events recor
-000009f0: 6465 6420 696e 2061 2073 7472 6561 6d2e  ded in a stream.
-00000a00: 0a0a 7265 636f 7264 6564 203d 2063 6c69  ..recorded = cli
-00000a10: 656e 742e 7265 6164 5f73 7472 6561 6d5f  ent.read_stream_
-00000a20: 6576 656e 7473 280a 2020 2020 7374 7265  events(.    stre
-00000a30: 616d 5f6e 616d 653d 7374 7265 616d 5f6e  am_name=stream_n
-00000a40: 616d 650a 290a 0a61 7373 6572 7420 6c65  ame.)..assert le
-00000a50: 6e28 7265 636f 7264 6564 2920 3d3d 2033  n(recorded) == 3
-00000a60: 0a61 7373 6572 7420 7265 636f 7264 6564  .assert recorded
-00000a70: 5b30 5d2e 6461 7461 203d 3d20 6576 656e  [0].data == even
-00000a80: 7431 2e64 6174 610a 6173 7365 7274 2072  t1.data.assert r
-00000a90: 6563 6f72 6465 645b 315d 2e64 6174 6120  ecorded[1].data 
-00000aa0: 3d3d 2065 7665 6e74 322e 6461 7461 0a61  == event2.data.a
-00000ab0: 7373 6572 7420 7265 636f 7264 6564 5b32  ssert recorded[2
-00000ac0: 5d2e 6461 7461 203d 3d20 6576 656e 7433  ].data == event3
-00000ad0: 2e64 6174 610a 6173 7365 7274 2072 6563  .data.assert rec
-00000ae0: 6f72 6465 645b 305d 2e74 7970 6520 3d3d  orded[0].type ==
-00000af0: 2065 7665 6e74 312e 7479 7065 0a61 7373   event1.type.ass
-00000b00: 6572 7420 7265 636f 7264 6564 5b31 5d2e  ert recorded[1].
-00000b10: 7479 7065 203d 3d20 6576 656e 7432 2e74  type == event2.t
-00000b20: 7970 650a 6173 7365 7274 2072 6563 6f72  ype.assert recor
-00000b30: 6465 645b 325d 2e74 7970 6520 3d3d 2065  ded[2].type == e
-00000b40: 7665 6e74 332e 7479 7065 0a0a 0a23 2049  vent3.type...# I
-00000b50: 6e20 616e 2065 7665 6e74 2d70 726f 6365  n an event-proce
-00000b60: 7373 696e 6720 636f 6d70 6f6e 656e 742c  ssing component,
-00000b70: 2075 7365 2061 2022 6361 7463 682d 7570   use a "catch-up
-00000b80: 2220 7375 6273 6372 6970 7469 6f6e 0a23  " subscription.#
-00000b90: 2074 6f20 7265 6365 6976 6520 616c 6c20   to receive all 
-00000ba0: 6576 656e 7473 2061 6372 6f73 7320 616c  events across al
-00000bb0: 6c20 7374 7265 616d 732c 2069 6e63 6c75  l streams, inclu
-00000bc0: 6469 6e67 2065 7665 6e74 7320 7468 6174  ding events that
-00000bd0: 0a23 2068 6176 6520 6e6f 7420 7965 7420  .# have not yet 
-00000be0: 6265 656e 2072 6563 6f72 6465 642c 2073  been recorded, s
-00000bf0: 7461 7274 696e 6720 6672 6f6d 2074 6865  tarting from the
-00000c00: 2063 6f6d 706f 6e65 6e74 2773 206c 6173   component's las
-00000c10: 740a 2320 7361 7665 6420 2263 6f6d 6d69  t.# saved "commi
-00000c20: 7420 706f 7369 7469 6f6e 222e 0a0a 6c61  t position"...la
-00000c30: 7374 5f73 6176 6564 5f63 6f6d 6d69 745f  st_saved_commit_
-00000c40: 706f 7369 7469 6f6e 203d 2030 0a0a 7375  position = 0..su
-00000c50: 6273 6372 6970 7469 6f6e 203d 2063 6c69  bscription = cli
-00000c60: 656e 742e 7375 6273 6372 6962 655f 616c  ent.subscribe_al
-00000c70: 6c5f 6576 656e 7473 280a 2020 2020 636f  l_events(.    co
-00000c80: 6d6d 6974 5f70 6f73 6974 696f 6e3d 6c61  mmit_position=la
-00000c90: 7374 5f73 6176 6564 5f63 6f6d 6d69 745f  st_saved_commit_
-00000ca0: 706f 7369 7469 6f6e 0a29 0a0a 2320 546f  position.)..# To
-00000cb0: 2069 6d70 6c65 6d65 6e74 2022 6578 6163   implement "exac
-00000cc0: 746c 792d 6f6e 6365 2220 7365 6d61 6e74  tly-once" semant
-00000cd0: 6963 732c 2069 7465 7261 7465 206f 7665  ics, iterate ove
-00000ce0: 7220 7468 650a 2320 2263 6174 6368 2d75  r the.# "catch-u
-00000cf0: 7022 2073 7562 7363 7269 7074 696f 6e2e  p" subscription.
-00000d00: 2050 726f 6365 7373 2065 6163 6820 7265   Process each re
-00000d10: 6365 6976 6564 2065 7665 6e74 2c0a 2320  ceived event,.# 
-00000d20: 696e 2074 7572 6e2c 2074 6872 6f75 6768  in turn, through
-00000d30: 2061 6e20 6576 656e 742d 7072 6f63 6573   an event-proces
-00000d40: 7369 6e67 2070 6f6c 6963 792e 2053 6176  sing policy. Sav
-00000d50: 6520 7468 650a 2320 7661 6c75 6520 6f66  e the.# value of
-00000d60: 2074 6865 2063 6f6d 6d69 745f 706f 7369   the commit_posi
-00000d70: 7469 6f6e 2061 7474 7269 6275 7465 206f  tion attribute o
-00000d80: 6620 7468 6520 7072 6f63 6573 7365 640a  f the processed.
-00000d90: 2320 6576 656e 7420 7769 7468 206e 6577  # event with new
-00000da0: 2073 7461 7465 2067 656e 6572 6174 6564   state generated
-00000db0: 2062 7920 7468 6520 706f 6c69 6379 2069   by the policy i
-00000dc0: 6e20 7468 6520 7361 6d65 0a23 2061 746f  n the same.# ato
-00000dd0: 6d69 6320 7472 616e 7361 6374 696f 6e2e  mic transaction.
-00000de0: 2055 7365 2074 6865 206c 6173 7420 7361   Use the last sa
-00000df0: 7665 6420 2263 6f6d 6d69 7420 706f 7369  ved "commit posi
-00000e00: 7469 6f6e 220a 2320 7768 656e 2072 6573  tion".# when res
-00000e10: 7461 7274 696e 6720 7468 6520 2263 6174  tarting the "cat
-00000e20: 6368 2d75 7022 2073 7562 7363 7269 7074  ch-up" subscript
-00000e30: 696f 6e2e 0a0a 7265 6365 6976 6564 203d  ion...received =
-00000e40: 205b 5d0a 666f 7220 6576 656e 7420 696e   [].for event in
-00000e50: 2073 7562 7363 7269 7074 696f 6e3a 0a20   subscription:. 
-00000e60: 2020 2072 6563 6569 7665 642e 6170 7065     received.appe
-00000e70: 6e64 2865 7665 6e74 290a 2020 2020 6966  nd(event).    if
-00000e80: 2065 7665 6e74 2e69 6420 3d3d 2065 7665   event.id == eve
-00000e90: 6e74 332e 6964 3a0a 2020 2020 2020 2020  nt3.id:.        
-00000ea0: 6272 6561 6b0a 0a61 7373 6572 7420 7265  break..assert re
-00000eb0: 6365 6976 6564 5b2d 335d 2e64 6174 6120  ceived[-3].data 
-00000ec0: 3d3d 2065 7665 6e74 312e 6461 7461 0a61  == event1.data.a
-00000ed0: 7373 6572 7420 7265 6365 6976 6564 5b2d  ssert received[-
-00000ee0: 325d 2e64 6174 6120 3d3d 2065 7665 6e74  2].data == event
-00000ef0: 322e 6461 7461 0a61 7373 6572 7420 7265  2.data.assert re
-00000f00: 6365 6976 6564 5b2d 315d 2e64 6174 6120  ceived[-1].data 
-00000f10: 3d3d 2065 7665 6e74 332e 6461 7461 0a61  == event3.data.a
-00000f20: 7373 6572 7420 7265 6365 6976 6564 5b2d  ssert received[-
-00000f30: 335d 2e74 7970 6520 3d3d 2065 7665 6e74  3].type == event
-00000f40: 312e 7479 7065 0a61 7373 6572 7420 7265  1.type.assert re
-00000f50: 6365 6976 6564 5b2d 325d 2e74 7970 6520  ceived[-2].type 
-00000f60: 3d3d 2065 7665 6e74 322e 7479 7065 0a61  == event2.type.a
-00000f70: 7373 6572 7420 7265 6365 6976 6564 5b2d  ssert received[-
-00000f80: 315d 2e74 7970 6520 3d3d 2065 7665 6e74  1].type == event
-00000f90: 332e 7479 7065 0a0a 6173 7365 7274 2072  3.type..assert r
-00000fa0: 6563 6569 7665 645b 2d33 5d2e 636f 6d6d  eceived[-3].comm
-00000fb0: 6974 5f70 6f73 6974 696f 6e20 3e20 300a  it_position > 0.
-00000fc0: 6173 7365 7274 2072 6563 6569 7665 645b  assert received[
-00000fd0: 2d32 5d2e 636f 6d6d 6974 5f70 6f73 6974  -2].commit_posit
-00000fe0: 696f 6e20 3e20 7265 6365 6976 6564 5b2d  ion > received[-
-00000ff0: 335d 2e63 6f6d 6d69 745f 706f 7369 7469  3].commit_positi
-00001000: 6f6e 0a61 7373 6572 7420 7265 6365 6976  on.assert receiv
-00001010: 6564 5b2d 315d 2e63 6f6d 6d69 745f 706f  ed[-1].commit_po
-00001020: 7369 7469 6f6e 203e 2072 6563 6569 7665  sition > receive
-00001030: 645b 2d32 5d2e 636f 6d6d 6974 5f70 6f73  d[-2].commit_pos
-00001040: 6974 696f 6e0a 0a0a 2320 436c 6f73 6520  ition...# Close 
-00001050: 7468 6520 636c 6965 6e74 2061 6674 6572  the client after
-00001060: 2075 7365 2e0a 0a63 6c69 656e 742e 636c   use...client.cl
-00001070: 6f73 6528 290a 6060 600a 0a53 6565 2062  ose().```..See b
-00001080: 656c 6f77 2066 6f72 206d 6f72 6520 6465  elow for more de
-00001090: 7461 696c 732e 0a0a 466f 7220 616e 2065  tails...For an e
-000010a0: 7861 6d70 6c65 206f 6620 7573 6167 652c  xample of usage,
-000010b0: 2073 6565 2074 6865 205b 6576 656e 7473   see the [events
-000010c0: 6f75 7263 696e 672d 6576 656e 7473 746f  ourcing-eventsto
-000010d0: 7265 6462 5d28 0a68 7474 7073 3a2f 2f67  redb](.https://g
-000010e0: 6974 6875 622e 636f 6d2f 7079 6576 656e  ithub.com/pyeven
-000010f0: 7473 6f75 7263 696e 672f 6576 656e 7473  tsourcing/events
-00001100: 6f75 7263 696e 672d 6576 656e 7473 746f  ourcing-eventsto
-00001110: 7265 6462 2920 7061 636b 6167 652e 0a0a  redb) package...
-00001120: 2323 2054 6162 6c65 206f 6620 636f 6e74  ## Table of cont
-00001130: 656e 7473 0a0a 3c21 2d2d 2054 4f43 202d  ents..<!-- TOC -
-00001140: 2d3e 0a2a 205b 496e 7374 616c 6c20 7061  ->.* [Install pa
-00001150: 636b 6167 655d 2823 696e 7374 616c 6c2d  ckage](#install-
-00001160: 7061 636b 6167 6529 0a20 202a 205b 4672  package).  * [Fr
-00001170: 6f6d 2050 7950 495d 2823 6672 6f6d 2d70  om PyPI](#from-p
-00001180: 7970 6929 0a20 202a 205b 5769 7468 2050  ypi).  * [With P
-00001190: 6f65 7472 795d 2823 7769 7468 2d70 6f65  oetry](#with-poe
-000011a0: 7472 7929 0a2a 205b 4576 656e 7453 746f  try).* [EventSto
-000011b0: 7265 4442 2073 6572 7665 725d 2823 6576  reDB server](#ev
-000011c0: 656e 7473 746f 7265 6462 2d73 6572 7665  entstoredb-serve
-000011d0: 7229 0a20 202a 205b 5275 6e20 636f 6e74  r).  * [Run cont
-000011e0: 6169 6e65 725d 2823 7275 6e2d 636f 6e74  ainer](#run-cont
-000011f0: 6169 6e65 7229 0a20 202a 205b 5374 6f70  ainer).  * [Stop
-00001200: 2063 6f6e 7461 696e 6572 5d28 2373 746f   container](#sto
-00001210: 702d 636f 6e74 6169 6e65 7229 0a2a 205b  p-container).* [
-00001220: 4576 656e 7453 746f 7265 4442 2063 6c69  EventStoreDB cli
-00001230: 656e 745d 2823 6576 656e 7473 746f 7265  ent](#eventstore
-00001240: 6462 2d63 6c69 656e 7429 0a20 202a 205b  db-client).  * [
-00001250: 496d 706f 7274 2063 6c61 7373 5d28 2369  Import class](#i
-00001260: 6d70 6f72 742d 636c 6173 7329 0a20 202a  mport-class).  *
-00001270: 205b 436f 6e73 7472 7563 7420 636c 6965   [Construct clie
-00001280: 6e74 5d28 2363 6f6e 7374 7275 6374 2d63  nt](#construct-c
-00001290: 6c69 656e 7429 0a2a 205b 5374 7265 616d  lient).* [Stream
-000012a0: 735d 2823 7374 7265 616d 7329 0a20 202a  s](#streams).  *
-000012b0: 205b 4170 7065 6e64 2065 7665 6e74 735d   [Append events]
-000012c0: 2823 6170 7065 6e64 2d65 7665 6e74 7329  (#append-events)
-000012d0: 0a20 202a 205b 4170 7065 6e64 2065 7665  .  * [Append eve
-000012e0: 6e74 5d28 2361 7070 656e 642d 6576 656e  nt](#append-even
-000012f0: 7429 0a20 202a 205b 4964 656d 706f 7465  t).  * [Idempote
-00001300: 6e74 2061 7070 656e 6420 6f70 6572 6174  nt append operat
-00001310: 696f 6e73 5d28 2369 6465 6d70 6f74 656e  ions](#idempoten
-00001320: 742d 6170 7065 6e64 2d6f 7065 7261 7469  t-append-operati
-00001330: 6f6e 7329 0a20 202a 205b 5265 6164 2073  ons).  * [Read s
-00001340: 7472 6561 6d20 6576 656e 7473 5d28 2372  tream events](#r
-00001350: 6561 642d 7374 7265 616d 2d65 7665 6e74  ead-stream-event
-00001360: 7329 0a20 202a 205b 5265 6164 2061 6c6c  s).  * [Read all
-00001370: 2065 7665 6e74 735d 2823 7265 6164 2d61   events](#read-a
-00001380: 6c6c 2d65 7665 6e74 7329 0a20 202a 205b  ll-events).  * [
-00001390: 4765 7420 6375 7272 656e 7420 7374 7265  Get current stre
-000013a0: 616d 2070 6f73 6974 696f 6e5d 2823 6765  am position](#ge
-000013b0: 742d 6375 7272 656e 742d 7374 7265 616d  t-current-stream
-000013c0: 2d70 6f73 6974 696f 6e29 0a20 202a 205b  -position).  * [
-000013d0: 4765 7420 6375 7272 656e 7420 636f 6d6d  Get current comm
-000013e0: 6974 2070 6f73 6974 696f 6e5d 2823 6765  it position](#ge
-000013f0: 742d 6375 7272 656e 742d 636f 6d6d 6974  t-current-commit
-00001400: 2d70 6f73 6974 696f 6e29 0a20 202a 205b  -position).  * [
-00001410: 4765 7420 7374 7265 616d 206d 6574 6164  Get stream metad
-00001420: 6174 615d 2823 6765 742d 7374 7265 616d  ata](#get-stream
-00001430: 2d6d 6574 6164 6174 6129 0a20 202a 205b  -metadata).  * [
-00001440: 5365 7420 7374 7265 616d 206d 6574 6164  Set stream metad
-00001450: 6174 615d 2823 7365 742d 7374 7265 616d  ata](#set-stream
-00001460: 2d6d 6574 6164 6174 6129 0a20 202a 205b  -metadata).  * [
-00001470: 4465 6c65 7465 2073 7472 6561 6d5d 2823  Delete stream](#
-00001480: 6465 6c65 7465 2d73 7472 6561 6d29 0a20  delete-stream). 
-00001490: 202a 205b 546f 6d62 7374 6f6e 6520 7374   * [Tombstone st
-000014a0: 7265 616d 5d28 2374 6f6d 6273 746f 6e65  ream](#tombstone
-000014b0: 2d73 7472 6561 6d29 0a2a 205b 4361 7463  -stream).* [Catc
-000014c0: 682d 7570 2073 7562 7363 7269 7074 696f  h-up subscriptio
-000014d0: 6e73 5d28 2363 6174 6368 2d75 702d 7375  ns](#catch-up-su
-000014e0: 6273 6372 6970 7469 6f6e 7329 0a20 202a  bscriptions).  *
-000014f0: 205b 486f 7720 746f 2069 6d70 6c65 6d65   [How to impleme
-00001500: 6e74 2065 7861 6374 6c79 2d6f 6e63 6520  nt exactly-once 
-00001510: 6576 656e 7420 7072 6f63 6573 7369 6e67  event processing
-00001520: 5d28 2368 6f77 2d74 6f2d 696d 706c 656d  ](#how-to-implem
-00001530: 656e 742d 6578 6163 746c 792d 6f6e 6365  ent-exactly-once
-00001540: 2d65 7665 6e74 2d70 726f 6365 7373 696e  -event-processin
-00001550: 6729 0a20 202a 205b 5375 6273 6372 6962  g).  * [Subscrib
-00001560: 6520 616c 6c20 6576 656e 7473 5d28 2373  e all events](#s
-00001570: 7562 7363 7269 6265 2d61 6c6c 2d65 7665  ubscribe-all-eve
-00001580: 6e74 7329 0a20 202a 205b 5375 6273 6372  nts).  * [Subscr
-00001590: 6962 6520 7374 7265 616d 2065 7665 6e74  ibe stream event
-000015a0: 735d 2823 7375 6273 6372 6962 652d 7374  s](#subscribe-st
-000015b0: 7265 616d 2d65 7665 6e74 7329 0a2a 205b  ream-events).* [
-000015c0: 5065 7273 6973 7465 6e74 2073 7562 7363  Persistent subsc
-000015d0: 7269 7074 696f 6e73 5d28 2370 6572 7369  riptions](#persi
-000015e0: 7374 656e 742d 7375 6273 6372 6970 7469  stent-subscripti
-000015f0: 6f6e 7329 0a20 202a 205b 4372 6561 7465  ons).  * [Create
-00001600: 2073 7562 7363 7269 7074 696f 6e5d 2823   subscription](#
-00001610: 6372 6561 7465 2d73 7562 7363 7269 7074  create-subscript
-00001620: 696f 6e29 0a20 202a 205b 5265 6164 2073  ion).  * [Read s
-00001630: 7562 7363 7269 7074 696f 6e5d 2823 7265  ubscription](#re
-00001640: 6164 2d73 7562 7363 7269 7074 696f 6e29  ad-subscription)
-00001650: 0a20 202a 205b 4765 7420 7375 6273 6372  .  * [Get subscr
-00001660: 6970 7469 6f6e 2069 6e66 6f5d 2823 6765  iption info](#ge
-00001670: 742d 7375 6273 6372 6970 7469 6f6e 2d69  t-subscription-i
-00001680: 6e66 6f29 0a20 202a 205b 4c69 7374 2073  nfo).  * [List s
-00001690: 7562 7363 7269 7074 696f 6e73 5d28 236c  ubscriptions](#l
-000016a0: 6973 742d 7375 6273 6372 6970 7469 6f6e  ist-subscription
-000016b0: 7329 0a20 202a 205b 4465 6c65 7465 2073  s).  * [Delete s
-000016c0: 7562 7363 7269 7074 696f 6e5d 2823 6465  ubscription](#de
-000016d0: 6c65 7465 2d73 7562 7363 7269 7074 696f  lete-subscriptio
-000016e0: 6e29 0a20 202a 205b 4372 6561 7465 2073  n).  * [Create s
-000016f0: 7472 6561 6d20 7375 6273 6372 6970 7469  tream subscripti
-00001700: 6f6e 5d28 2363 7265 6174 652d 7374 7265  on](#create-stre
-00001710: 616d 2d73 7562 7363 7269 7074 696f 6e29  am-subscription)
-00001720: 0a20 202a 205b 5265 6164 2073 7472 6561  .  * [Read strea
-00001730: 6d20 7375 6273 6372 6970 7469 6f6e 5d28  m subscription](
-00001740: 2372 6561 642d 7374 7265 616d 2d73 7562  #read-stream-sub
-00001750: 7363 7269 7074 696f 6e29 0a20 202a 205b  scription).  * [
-00001760: 4765 7420 7374 7265 616d 2073 7562 7363  Get stream subsc
-00001770: 7269 7074 696f 6e20 696e 666f 5d28 2367  ription info](#g
-00001780: 6574 2d73 7472 6561 6d2d 7375 6273 6372  et-stream-subscr
-00001790: 6970 7469 6f6e 2d69 6e66 6f29 0a20 202a  iption-info).  *
-000017a0: 205b 4c69 7374 2073 7472 6561 6d20 7375   [List stream su
-000017b0: 6273 6372 6970 7469 6f6e 735d 2823 6c69  bscriptions](#li
-000017c0: 7374 2d73 7472 6561 6d2d 7375 6273 6372  st-stream-subscr
-000017d0: 6970 7469 6f6e 7329 0a20 202a 205b 4465  iptions).  * [De
-000017e0: 6c65 7465 2073 7472 6561 6d20 7375 6273  lete stream subs
-000017f0: 6372 6970 7469 6f6e 5d28 2364 656c 6574  cription](#delet
-00001800: 652d 7374 7265 616d 2d73 7562 7363 7269  e-stream-subscri
-00001810: 7074 696f 6e29 0a2a 205b 436f 6e6e 6563  ption).* [Connec
-00001820: 7469 6f6e 5d28 2363 6f6e 6e65 6374 696f  tion](#connectio
-00001830: 6e29 0a20 202a 205b 5265 636f 6e6e 6563  n).  * [Reconnec
-00001840: 745d 2823 7265 636f 6e6e 6563 7429 0a20  t](#reconnect). 
-00001850: 202a 205b 436c 6f73 655d 2823 636c 6f73   * [Close](#clos
-00001860: 6529 0a2a 205b 4e6f 7465 735d 2823 6e6f  e).* [Notes](#no
-00001870: 7465 7329 0a20 202a 205b 436f 6e6e 6563  tes).  * [Connec
-00001880: 7469 6f6e 2073 7472 696e 6773 5d28 2363  tion strings](#c
-00001890: 6f6e 6e65 6374 696f 6e2d 7374 7269 6e67  onnection-string
-000018a0: 7329 0a20 202a 205b 5265 6775 6c61 7220  s).  * [Regular 
-000018b0: 6578 7072 6573 7369 6f6e 2066 696c 7465  expression filte
-000018c0: 7273 5d28 2372 6567 756c 6172 2d65 7870  rs](#regular-exp
-000018d0: 7265 7373 696f 6e2d 6669 6c74 6572 7329  ression-filters)
-000018e0: 0a20 202a 205b 4e65 7720 6576 656e 7420  .  * [New event 
-000018f0: 6f62 6a65 6374 735d 2823 6e65 772d 6576  objects](#new-ev
-00001900: 656e 742d 6f62 6a65 6374 7329 0a20 202a  ent-objects).  *
-00001910: 205b 5265 636f 7264 6564 2065 7665 6e74   [Recorded event
-00001920: 206f 626a 6563 7473 5d28 2372 6563 6f72   objects](#recor
-00001930: 6465 642d 6576 656e 742d 6f62 6a65 6374  ded-event-object
-00001940: 7329 0a20 202a 205b 4173 796e 6369 6f20  s).  * [Asyncio 
-00001950: 636c 6965 6e74 5d28 2361 7379 6e63 696f  client](#asyncio
-00001960: 2d63 6c69 656e 7429 0a2a 205b 436f 6e74  -client).* [Cont
-00001970: 7269 6275 746f 7273 5d28 2363 6f6e 7472  ributors](#contr
-00001980: 6962 7574 6f72 7329 0a20 202a 205b 496e  ibutors).  * [In
-00001990: 7374 616c 6c20 506f 6574 7279 5d28 2369  stall Poetry](#i
-000019a0: 6e73 7461 6c6c 2d70 6f65 7472 7929 0a20  nstall-poetry). 
-000019b0: 202a 205b 5365 7475 7020 666f 7220 5079   * [Setup for Py
-000019c0: 4368 6172 6d20 7573 6572 735d 2823 7365  Charm users](#se
-000019d0: 7475 702d 666f 722d 7079 6368 6172 6d2d  tup-for-pycharm-
-000019e0: 7573 6572 7329 0a20 202a 205b 5365 7475  users).  * [Setu
-000019f0: 7020 6672 6f6d 2063 6f6d 6d61 6e64 206c  p from command l
-00001a00: 696e 655d 2823 7365 7475 702d 6672 6f6d  ine](#setup-from
-00001a10: 2d63 6f6d 6d61 6e64 2d6c 696e 6529 0a20  -command-line). 
-00001a20: 202a 205b 5072 6f6a 6563 7420 4d61 6b65   * [Project Make
-00001a30: 6669 6c65 2063 6f6d 6d61 6e64 735d 2823  file commands](#
-00001a40: 7072 6f6a 6563 742d 6d61 6b65 6669 6c65  project-makefile
-00001a50: 2d63 6f6d 6d61 6e64 7329 0a3c 212d 2d20  -commands).<!-- 
-00001a60: 544f 4320 2d2d 3e0a 0a23 2320 496e 7374  TOC -->..## Inst
-00001a70: 616c 6c20 7061 636b 6167 650a 0a49 7420  all package..It 
-00001a80: 6973 2072 6563 6f6d 6d65 6e64 6564 2074  is recommended t
-00001a90: 6f20 696e 7374 616c 6c20 5079 7468 6f6e  o install Python
-00001aa0: 2070 6163 6b61 6765 7320 696e 746f 2061   packages into a
-00001ab0: 2050 7974 686f 6e20 7669 7274 7561 6c20   Python virtual 
-00001ac0: 656e 7669 726f 6e6d 656e 742e 0a0a 2323  environment...##
-00001ad0: 2320 4672 6f6d 2050 7950 490a 0a59 6f75  # From PyPI..You
-00001ae0: 2063 616e 2075 7365 2070 6970 2074 6f20   can use pip to 
-00001af0: 696e 7374 616c 6c20 7468 6973 2070 6163  install this pac
-00001b00: 6b61 6765 2064 6972 6563 746c 7920 6672  kage directly fr
-00001b10: 6f6d 0a5b 7468 6520 5079 7468 6f6e 2050  om.[the Python P
-00001b20: 6163 6b61 6765 2049 6e64 6578 5d28 6874  ackage Index](ht
-00001b30: 7470 733a 2f2f 7079 7069 2e6f 7267 2f70  tps://pypi.org/p
-00001b40: 726f 6a65 6374 2f65 7364 6263 6c69 656e  roject/esdbclien
-00001b50: 742f 292e 0a0a 2020 2020 2420 7069 7020  t/)...    $ pip 
-00001b60: 696e 7374 616c 6c20 6573 6462 636c 6965  install esdbclie
-00001b70: 6e74 0a0a 2323 2320 5769 7468 2050 6f65  nt..### With Poe
-00001b80: 7472 790a 0a59 6f75 2063 616e 2075 7365  try..You can use
-00001b90: 2050 6f65 7472 7920 746f 2061 6464 2074   Poetry to add t
-00001ba0: 6869 7320 7061 636b 6167 6520 746f 2079  his package to y
-00001bb0: 6f75 7220 7079 7072 6f6a 6563 742e 746f  our pyproject.to
-00001bc0: 6d6c 2061 6e64 2069 6e73 7461 6c6c 2069  ml and install i
-00001bd0: 742e 0a0a 2020 2020 2420 706f 6574 7279  t...    $ poetry
-00001be0: 2061 6464 2065 7364 6263 6c69 656e 740a   add esdbclient.
-00001bf0: 0a23 2320 4576 656e 7453 746f 7265 4442  .## EventStoreDB
-00001c00: 2073 6572 7665 720a 0a54 6865 2045 7665   server..The Eve
-00001c10: 6e74 5374 6f72 6544 4220 7365 7276 6572  ntStoreDB server
-00001c20: 2063 616e 2062 6520 7275 6e20 6c6f 6361   can be run loca
-00001c30: 6c6c 7920 7573 696e 6720 7468 6520 6f66  lly using the of
-00001c40: 6669 6369 616c 2044 6f63 6b65 7220 636f  ficial Docker co
-00001c50: 6e74 6169 6e65 7220 696d 6167 652e 0a0a  ntainer image...
-00001c60: 2323 2320 5275 6e20 636f 6e74 6169 6e65  ### Run containe
-00001c70: 720a 0a46 6f72 2064 6576 656c 6f70 6d65  r..For developme
-00001c80: 6e74 2c20 796f 7520 6361 6e20 7275 6e20  nt, you can run 
-00001c90: 6120 2273 6563 7572 6522 2045 7665 6e74  a "secure" Event
-00001ca0: 5374 6f72 6544 4220 7365 7276 6572 2075  StoreDB server u
-00001cb0: 7369 6e67 2074 6865 2066 6f6c 6c6f 7769  sing the followi
-00001cc0: 6e67 2063 6f6d 6d61 6e64 2e0a 0a20 2020  ng command...   
-00001cd0: 2024 2064 6f63 6b65 7220 7275 6e20 2d64   $ docker run -d
-00001ce0: 202d 2d6e 616d 6520 6576 656e 7473 746f   --name eventsto
-00001cf0: 7265 6462 2d73 6563 7572 6520 2d69 7420  redb-secure -it 
-00001d00: 2d70 2032 3131 333a 3231 3133 202d 2d65  -p 2113:2113 --e
-00001d10: 6e76 2022 484f 4d45 3d2f 746d 7022 2065  nv "HOME=/tmp" e
-00001d20: 7665 6e74 7374 6f72 652f 6576 656e 7473  ventstore/events
-00001d30: 746f 7265 3a32 312e 3130 2e39 2d62 7573  tore:21.10.9-bus
-00001d40: 7465 722d 736c 696d 202d 2d64 6576 0a0a  ter-slim --dev..
-00001d50: 4173 2077 6520 7769 6c6c 2073 6565 2c20  As we will see, 
-00001d60: 7468 6520 636c 6965 6e74 206e 6565 6473  the client needs
-00001d70: 2061 6e20 4576 656e 7453 746f 7265 4442   an EventStoreDB
-00001d80: 2063 6f6e 6e65 6374 696f 6e20 7374 7269   connection stri
-00001d90: 6e67 2055 5249 2061 7320 7468 6520 7661  ng URI as the va
-00001da0: 6c75 6520 6f66 0a69 7473 2060 7572 6960  lue of.its `uri`
-00001db0: 2063 6f6e 7374 7275 6374 6f72 2061 7267   constructor arg
-00001dc0: 756d 656e 742e 2053 6565 2074 6865 204e  ument. See the N
-00001dd0: 6f74 6573 2073 6563 7469 6f6e 2062 656c  otes section bel
-00001de0: 6f77 2066 6f72 2064 6574 6169 6c65 6420  ow for detailed 
-00001df0: 696e 666f 726d 6174 696f 6e0a 6162 6f75  information.abou
-00001e00: 7420 4576 656e 7453 746f 7265 4442 2063  t EventStoreDB c
-00001e10: 6f6e 6e65 6374 696f 6e20 7374 7269 6e67  onnection string
-00001e20: 2055 5249 732e 0a0a 5468 6520 636f 6e6e   URIs...The conn
-00001e30: 6563 7469 6f6e 2073 7472 696e 6720 666f  ection string fo
-00001e40: 7220 7468 6973 2022 7365 6375 7265 2220  r this "secure" 
-00001e50: 4576 656e 7453 746f 7265 4442 2073 6572  EventStoreDB ser
-00001e60: 7665 7220 776f 756c 6420 6265 3a0a 0a20  ver would be:.. 
-00001e70: 2020 2065 7364 623a 2f2f 6164 6d69 6e3a     esdb://admin:
-00001e80: 6368 616e 6765 6974 406c 6f63 616c 686f  changeit@localho
-00001e90: 7374 3a32 3131 330a 0a54 6f20 636f 6e6e  st:2113..To conn
-00001ea0: 6563 7420 746f 2061 2022 7365 6375 7265  ect to a "secure
-00001eb0: 2220 7365 7276 6572 2c20 796f 7520 7769  " server, you wi
-00001ec0: 6c6c 2075 7375 616c 6c79 206e 6565 6420  ll usually need 
-00001ed0: 746f 2069 6e63 6c75 6465 2061 2022 7573  to include a "us
-00001ee0: 6572 6e61 6d65 220a 616e 6420 6120 2270  ername".and a "p
-00001ef0: 6173 7377 6f72 6422 2069 6e20 7468 6520  assword" in the 
-00001f00: 636f 6e6e 6563 7469 6f6e 2073 7472 696e  connection strin
-00001f10: 672c 2073 6f20 7468 6174 2074 6865 2073  g, so that the s
-00001f20: 6572 7665 7220 6361 6e20 6175 7468 656e  erver can authen
-00001f30: 7469 6361 7465 2074 6865 0a63 6c69 656e  ticate the.clien
-00001f40: 742e 2054 6865 2064 6566 6175 6c74 2075  t. The default u
-00001f50: 7365 726e 616d 6520 6973 2022 6164 6d69  sername is "admi
-00001f60: 6e22 2061 6e64 2074 6865 2064 6566 6175  n" and the defau
-00001f70: 6c74 2070 6173 7377 6f72 6420 6973 2022  lt password is "
-00001f80: 6368 616e 6765 6974 222e 0a0a 5768 656e  changeit"...When
-00001f90: 2063 6f6e 6e65 6374 696e 6720 746f 2061   connecting to a
-00001fa0: 2022 7365 6375 7265 2220 7365 7276 6572   "secure" server
-00001fb0: 2c20 7468 6520 636c 6965 6e74 2061 6c73  , the client als
-00001fc0: 6f20 6e65 6564 7320 616e 2053 534c 2f54  o needs an SSL/T
-00001fd0: 4c53 0a63 6572 7469 6669 6361 7465 2061  LS.certificate a
-00001fe0: 7320 7468 6520 7661 6c75 6520 6f66 2069  s the value of i
-00001ff0: 7473 2060 726f 6f74 5f63 6572 7469 6669  ts `root_certifi
-00002000: 6361 7465 7360 2063 6f6e 7374 7275 6374  cates` construct
-00002010: 6f72 2061 7267 756d 656e 742e 2054 6f20  or argument. To 
-00002020: 636f 6e6e 6563 740a 746f 2061 2022 7365  connect.to a "se
-00002030: 6375 7265 2220 7365 7276 6572 2079 6f75  cure" server you
-00002040: 2077 696c 6c20 6e65 6564 2061 6e20 5353   will need an SS
-00002050: 4c2f 544c 5320 6365 7274 6966 6963 6174  L/TLS certificat
-00002060: 6520 736f 2074 6861 7420 7468 6520 636c  e so that the cl
-00002070: 6965 6e74 2063 616e 0a61 7574 6865 6e74  ient can.authent
-00002080: 6963 6174 6520 7468 6520 7365 7276 6572  icate the server
-00002090: 2e20 466f 7220 6465 7665 6c6f 706d 656e  . For developmen
-000020a0: 742c 2079 6f75 2063 616e 2065 6974 6865  t, you can eithe
-000020b0: 7220 7573 6520 7468 6520 5353 4c2f 544c  r use the SSL/TL
-000020c0: 5320 6365 7274 6966 6963 6174 650a 6f66  S certificate.of
-000020d0: 2074 6865 2063 6572 7469 6669 6361 7465   the certificate
-000020e0: 2061 7574 686f 7269 7479 2075 7365 6420   authority used 
-000020f0: 746f 2063 7265 6174 6520 7468 6520 7365  to create the se
-00002100: 7276 6572 2773 2063 6572 7469 6669 6361  rver's certifica
-00002110: 7465 2c20 6f72 2077 6865 6e20 7573 696e  te, or when usin
-00002120: 6720 610a 7369 6e67 6c65 2d6e 6f64 6520  g a.single-node 
-00002130: 636c 7573 7465 722c 2079 6f75 2063 616e  cluster, you can
-00002140: 2075 7365 2074 6865 2073 6572 7665 7220   use the server 
-00002150: 6365 7274 6966 6963 6174 6520 6974 7365  certificate itse
-00002160: 6c66 2e20 596f 7520 6361 6e20 6765 7420  lf. You can get 
-00002170: 7468 650a 7365 7276 6572 2063 6572 7469  the.server certi
-00002180: 6669 6361 7465 2077 6974 6820 7468 6520  ficate with the 
-00002190: 666f 6c6c 6f77 696e 6720 5079 7468 6f6e  following Python
-000021a0: 2063 6f64 652e 0a0a 0a60 6060 7079 7468   code....```pyth
-000021b0: 6f6e 0a69 6d70 6f72 7420 7373 6c0a 0a73  on.import ssl..s
-000021c0: 6572 7665 725f 6365 7274 6966 6963 6174  erver_certificat
-000021d0: 6520 3d20 7373 6c2e 6765 745f 7365 7276  e = ssl.get_serv
-000021e0: 6572 5f63 6572 7469 6669 6361 7465 2861  er_certificate(a
-000021f0: 6464 723d 2827 6c6f 6361 6c68 6f73 7427  ddr=('localhost'
-00002200: 2c20 3231 3133 2929 0a60 6060 0a0a 596f  , 2113)).```..Yo
-00002210: 7520 6361 6e20 616c 736f 2073 7461 7274  u can also start
-00002220: 2061 6e20 2269 6e73 6563 7572 6522 2073   an "insecure" s
-00002230: 6572 7665 7220 7573 696e 6720 7468 6520  erver using the 
-00002240: 666f 6c6c 6f77 696e 6720 636f 6d6d 616e  following comman
-00002250: 642e 0a0a 2020 2020 2420 646f 636b 6572  d...    $ docker
-00002260: 2072 756e 202d 6420 2d2d 6e61 6d65 2065   run -d --name e
-00002270: 7665 6e74 7374 6f72 6564 622d 696e 7365  ventstoredb-inse
-00002280: 6375 7265 202d 6974 202d 7020 3231 3134  cure -it -p 2114
-00002290: 3a32 3131 3320 6576 656e 7473 746f 7265  :2113 eventstore
-000022a0: 2f65 7665 6e74 7374 6f72 653a 3231 2e31  /eventstore:21.1
-000022b0: 302e 392d 6275 7374 6572 2d73 6c69 6d20  0.9-buster-slim 
-000022c0: 2d2d 696e 7365 6375 7265 0a0a 5468 6520  --insecure..The 
-000022d0: 636f 6e6e 6563 7469 6f6e 2073 7472 696e  connection strin
-000022e0: 6720 5552 4920 666f 7220 7468 6973 2022  g URI for this "
-000022f0: 696e 7365 6375 7265 2220 7365 7276 6572  insecure" server
-00002300: 2077 6f75 6c64 2062 653a 0a0a 2020 2020   would be:..    
-00002310: 6573 6462 3a2f 2f6c 6f63 616c 686f 7374  esdb://localhost
-00002320: 3a32 3131 343f 546c 733d 6661 6c73 650a  :2114?Tls=false.
-00002330: 0a41 7320 7765 2077 696c 6c20 7365 652c  .As we will see,
-00002340: 2077 6865 6e20 636f 6e6e 6563 7469 6e67   when connecting
-00002350: 2074 6f20 616e 2022 696e 7365 6375 7265   to an "insecure
-00002360: 2220 7365 7276 6572 2c20 7468 6572 6520  " server, there 
-00002370: 6973 206e 6f20 6e65 6564 2074 6f20 696e  is no need to in
-00002380: 636c 7564 650a 6120 2275 7365 726e 616d  clude.a "usernam
-00002390: 6522 2061 6e64 2061 2022 7061 7373 776f  e" and a "passwo
-000023a0: 7264 2220 696e 2074 6865 2063 6f6e 6e65  rd" in the conne
-000023b0: 6374 696f 6e20 7374 7269 6e67 2e20 4966  ction string. If
-000023c0: 2079 6f75 2064 6f2c 2074 6865 7365 2076   you do, these v
-000023d0: 616c 7565 7320 7769 6c6c 0a62 6520 6967  alues will.be ig
-000023e0: 6e6f 7265 6420 6279 2074 6865 2063 6c69  nored by the cli
-000023f0: 656e 742c 2073 6f20 7468 6174 2074 6865  ent, so that the
-00002400: 7920 7769 6c6c 206e 6f74 2062 6520 7365  y will not be se
-00002410: 6e74 2074 6f20 7468 6520 7365 7276 6572  nt to the server
-00002420: 206f 7665 7220 616e 0a69 6e73 6563 7572   over an.insecur
-00002430: 6520 6368 616e 6e65 6c2e 0a0a 506c 6561  e channel...Plea
-00002440: 7365 206e 6f74 652c 2074 6865 2022 696e  se note, the "in
-00002450: 7365 6375 7265 2220 636f 6e6e 6563 7469  secure" connecti
-00002460: 6f6e 2073 7472 696e 6720 7573 6573 2061  on string uses a
-00002470: 2071 7565 7279 2073 7472 696e 6720 7769   query string wi
-00002480: 7468 2074 6865 2066 6965 6c64 2d76 616c  th the field-val
-00002490: 7565 0a60 546c 733d 6661 6c73 6560 2e20  ue.`Tls=false`. 
-000024a0: 5468 6520 7661 6c75 6520 6f66 2074 6869  The value of thi
-000024b0: 7320 6669 656c 6420 6973 2062 7920 6465  s field is by de
-000024c0: 6661 756c 7420 6074 7275 6560 2e20 5365  fault `true`. Se
-000024d0: 6520 7468 6520 4e6f 7465 7320 7365 6374  e the Notes sect
-000024e0: 696f 6e20 6265 6c6f 770a 666f 7220 6d6f  ion below.for mo
-000024f0: 7265 2069 6e66 6f72 6d61 7469 6f6e 2061  re information a
-00002500: 626f 7574 2045 7665 6e74 5374 6f72 6544  bout EventStoreD
-00002510: 4220 636f 6e6e 6563 7469 6f6e 2073 7472  B connection str
-00002520: 696e 6773 2061 6e64 2074 6865 2066 6965  ings and the fie
-00002530: 6c64 7320 7468 6174 2063 616e 2062 650a  lds that can be.
-00002540: 7573 6564 2069 6e20 7468 6520 7175 6572  used in the quer
-00002550: 7920 7374 7269 6e67 2074 6f20 7370 6563  y string to spec
-00002560: 6966 7920 636f 6e6e 6563 7469 6f6e 206f  ify connection o
-00002570: 7074 696f 6e73 2e0a 0a23 2323 2053 746f  ptions...### Sto
-00002580: 7020 636f 6e74 6169 6e65 720a 0a54 6f20  p container..To 
-00002590: 7374 6f70 2061 6e64 2072 656d 6f76 6520  stop and remove 
-000025a0: 7468 6520 2273 6563 7572 6522 2063 6f6e  the "secure" con
-000025b0: 7461 696e 6572 2c20 7573 6520 7468 6520  tainer, use the 
-000025c0: 666f 6c6c 6f77 696e 6720 446f 636b 6572  following Docker
-000025d0: 2063 6f6d 6d61 6e64 732e 0a0a 2020 2020   commands...    
-000025e0: 2420 646f 636b 6572 2073 746f 7020 6576  $ docker stop ev
-000025f0: 656e 7473 746f 7265 6462 2d73 6563 7572  entstoredb-secur
-00002600: 650a 0924 2064 6f63 6b65 7220 726d 2065  e..$ docker rm e
-00002610: 7665 6e74 7374 6f72 6564 622d 7365 6375  ventstoredb-secu
-00002620: 7265 0a0a 546f 2073 746f 7020 616e 6420  re..To stop and 
-00002630: 7265 6d6f 7665 2074 6865 2022 696e 7365  remove the "inse
-00002640: 6375 7265 2220 636f 6e74 6169 6e65 722c  cure" container,
-00002650: 2075 7365 2074 6865 2066 6f6c 6c6f 7769   use the followi
-00002660: 6e67 2044 6f63 6b65 7220 636f 6d6d 616e  ng Docker comman
-00002670: 6473 2e0a 0a20 2020 2024 2064 6f63 6b65  ds...    $ docke
-00002680: 7220 7374 6f70 2065 7665 6e74 7374 6f72  r stop eventstor
-00002690: 6564 622d 696e 7365 6375 7265 0a09 2420  edb-insecure..$ 
-000026a0: 646f 636b 6572 2072 6d20 6576 656e 7473  docker rm events
-000026b0: 746f 7265 6462 2d69 6e73 6563 7572 650a  toredb-insecure.
-000026c0: 0a0a 2323 2045 7665 6e74 5374 6f72 6544  ..## EventStoreD
-000026d0: 4220 636c 6965 6e74 0a0a 5468 6973 2045  B client..This E
-000026e0: 7665 6e74 5374 6f72 6544 4220 636c 6965  ventStoreDB clie
-000026f0: 6e74 2069 7320 696d 706c 656d 656e 7465  nt is implemente
-00002700: 6420 696e 2074 6865 2060 6573 6462 636c  d in the `esdbcl
-00002710: 6965 6e74 6020 7061 636b 6167 6520 7769  ient` package wi
-00002720: 7468 0a74 6865 2060 4553 4442 436c 6965  th.the `ESDBClie
-00002730: 6e74 6020 636c 6173 732e 0a0a 2323 2320  nt` class...### 
-00002740: 496d 706f 7274 2063 6c61 7373 0a0a 5468  Import class..Th
-00002750: 6520 6045 5344 4243 6c69 656e 7460 2063  e `ESDBClient` c
-00002760: 6c61 7373 2063 616e 2062 6520 696d 706f  lass can be impo
-00002770: 7274 6564 2066 726f 6d20 7468 6520 6065  rted from the `e
-00002780: 7364 6263 6c69 656e 7460 2070 6163 6b61  sdbclient` packa
-00002790: 6765 2e0a 0a60 6060 7079 7468 6f6e 0a66  ge...```python.f
-000027a0: 726f 6d20 6573 6462 636c 6965 6e74 2069  rom esdbclient i
-000027b0: 6d70 6f72 7420 4553 4442 436c 6965 6e74  mport ESDBClient
-000027c0: 0a60 6060 0a0a 2323 2320 436f 6e73 7472  .```..### Constr
-000027d0: 7563 7420 636c 6965 6e74 0a0a 5468 6520  uct client..The 
-000027e0: 6045 5344 4243 6c69 656e 7460 2063 6c61  `ESDBClient` cla
-000027f0: 7373 2063 616e 2062 6520 636f 6e73 7472  ss can be constr
-00002800: 7563 7465 6420 7769 7468 2061 2060 7572  ucted with a `ur
-00002810: 6960 2061 7267 756d 656e 742c 2077 6869  i` argument, whi
-00002820: 6368 2069 7320 7265 7175 6972 6564 2e0a  ch is required..
-00002830: 416e 642c 2074 6f20 636f 6e6e 6563 7420  And, to connect 
-00002840: 746f 2061 2022 7365 6375 7265 2220 4576  to a "secure" Ev
-00002850: 656e 7453 746f 7265 4442 2073 6572 7665  entStoreDB serve
-00002860: 722c 2074 6865 206f 7074 696f 6e61 6c20  r, the optional 
-00002870: 6072 6f6f 745f 6365 7274 6966 6963 6174  `root_certificat
-00002880: 6573 600a 6172 6775 6d65 6e74 2069 7320  es`.argument is 
-00002890: 616c 736f 2072 6571 7569 7265 642e 0a0a  also required...
-000028a0: 5468 6520 6075 7269 6020 6172 6775 6d65  The `uri` argume
-000028b0: 6e74 2069 7320 6578 7065 6374 6564 2074  nt is expected t
-000028c0: 6f20 6265 2061 6e20 4576 656e 7453 746f  o be an EventSto
-000028d0: 7265 4442 2063 6f6e 6e65 6374 696f 6e20  reDB connection 
-000028e0: 7374 7269 6e67 2055 5249 2074 6861 740a  string URI that.
-000028f0: 636f 6e66 6f72 6d73 2077 6974 6820 7468  conforms with th
-00002900: 6520 7374 616e 6461 7264 2045 7665 6e74  e standard Event
-00002910: 5374 6f72 6544 4220 2265 7364 6222 206f  StoreDB "esdb" o
-00002920: 7220 2265 7364 622b 6469 7363 6f76 6572  r "esdb+discover
-00002930: 2220 5552 4920 7363 6865 6d65 732e 2054  " URI schemes. T
-00002940: 6865 0a73 796e 7461 7820 616e 6420 7365  he.syntax and se
-00002950: 6d61 6e74 6963 7320 6f66 2045 7665 6e74  mantics of Event
-00002960: 5374 6f72 6544 4220 636f 6e6e 6563 7469  StoreDB connecti
-00002970: 6f6e 2073 7472 696e 6773 2061 7265 2065  on strings are e
-00002980: 7870 6c61 696e 6564 2069 6e20 7468 6520  xplained in the 
-00002990: 4e6f 7465 730a 7365 6374 696f 6e20 6265  Notes.section be
-000029a0: 6c6f 772e 0a0a 466f 7220 6578 616d 706c  low...For exampl
-000029b0: 652c 2074 6865 2066 6f6c 6c6f 7769 6e67  e, the following
-000029c0: 2063 6f6e 6e65 6374 696f 6e20 7374 7269   connection stri
-000029d0: 6e67 2073 7065 6369 6669 6573 2074 6861  ng specifies tha
-000029e0: 7420 7468 6520 636c 6965 6e74 2073 686f  t the client sho
-000029f0: 756c 640a 6174 7465 6d70 7420 746f 2063  uld.attempt to c
-00002a00: 7265 6174 6520 6120 2273 6563 7572 6522  reate a "secure"
-00002a10: 2063 6f6e 6e65 6374 696f 6e20 746f 2070   connection to p
-00002a20: 6f72 7420 3231 3133 206f 6e20 226c 6f63  ort 2113 on "loc
-00002a30: 616c 686f 7374 222c 2061 6e64 2075 7365  alhost", and use
-00002a40: 2074 6865 0a63 6c69 656e 7420 6372 6564   the.client cred
-00002a50: 656e 7469 616c 7320 2275 7365 726e 616d  entials "usernam
-00002a60: 6522 2061 6e64 2022 7061 7373 776f 7264  e" and "password
-00002a70: 2220 7768 656e 206d 616b 696e 6720 6361  " when making ca
-00002a80: 6c6c 7320 746f 2074 6865 2073 6572 7665  lls to the serve
-00002a90: 722e 0a0a 2020 2020 6573 6462 3a2f 2f75  r...    esdb://u
-00002aa0: 7365 726e 616d 653a 7061 7373 776f 7264  sername:password
-00002ab0: 406c 6f63 616c 686f 7374 3a32 3131 333f  @localhost:2113?
-00002ac0: 546c 733d 7472 7565 0a0a 5468 6520 636c  Tls=true..The cl
-00002ad0: 6965 6e74 206d 7573 7420 6265 2063 6f6e  ient must be con
-00002ae0: 6669 6775 7265 6420 746f 2063 7265 6174  figured to creat
-00002af0: 6520 6120 2273 6563 7572 6522 2063 6f6e  e a "secure" con
-00002b00: 6e65 6374 696f 6e20 746f 2061 2022 7365  nection to a "se
-00002b10: 6375 7265 2220 7365 7276 6572 2c0a 6f72  cure" server,.or
-00002b20: 2061 6c74 6572 6e61 7469 7665 6c79 2061   alternatively a
-00002b30: 6e20 2269 6e73 6563 7572 6522 2063 6f6e  n "insecure" con
-00002b40: 6e65 6374 696f 6e20 746f 2061 6e20 2269  nection to an "i
-00002b50: 6e73 6563 7572 6522 2073 6572 7665 722e  nsecure" server.
-00002b60: 2042 7920 6465 6661 756c 742c 2074 6865   By default, the
-00002b70: 0a63 6c69 656e 7420 7769 6c6c 2061 7474  .client will att
-00002b80: 656d 7074 2074 6f20 6372 6561 7465 2061  empt to create a
-00002b90: 2022 7365 6375 7265 2220 636f 6e6e 6563   "secure" connec
-00002ba0: 7469 6f6e 2e20 416e 6420 736f 2c20 7768  tion. And so, wh
-00002bb0: 656e 2063 6f6e 6e65 6374 696e 6720 746f  en connecting to
-00002bc0: 2061 6e0a 2269 6e73 6563 7572 6522 2073   an."insecure" s
-00002bd0: 6572 7665 722c 2074 6865 2063 6f6e 6e65  erver, the conne
-00002be0: 6374 696f 6e20 7374 7269 6e67 206d 7573  ction string mus
-00002bf0: 7420 7370 6563 6966 7920 7468 6174 2074  t specify that t
-00002c00: 6865 2063 6c69 656e 7420 7368 6f75 6c64  he client should
-00002c10: 2061 7474 656d 7074 0a74 6f20 6d61 6b65   attempt.to make
-00002c20: 2061 6e20 2269 6e73 6563 7572 6522 2063   an "insecure" c
-00002c30: 6f6e 6e65 6374 696f 6e2e 0a0a 5468 6520  onnection...The 
-00002c40: 666f 6c6c 6f77 696e 6720 636f 6e6e 6563  following connec
-00002c50: 7469 6f6e 2073 7472 696e 6720 7370 6563  tion string spec
-00002c60: 6966 6965 7320 7468 6174 2074 6865 2063  ifies that the c
-00002c70: 6c69 656e 7420 7368 6f75 6c64 0a61 7474  lient should.att
-00002c80: 656d 7074 2074 6f20 6372 6561 7465 2061  empt to create a
-00002c90: 6e20 2269 6e73 6563 7572 6522 2063 6f6e  n "insecure" con
-00002ca0: 6e65 6374 696f 6e20 746f 2070 6f72 7420  nection to port 
-00002cb0: 3231 3134 206f 6e20 226c 6f63 616c 686f  2114 on "localho
-00002cc0: 7374 222e 0a57 6865 6e20 636f 6e6e 6563  st"..When connec
-00002cd0: 7469 6e67 2074 6f20 616e 2022 696e 7365  ting to an "inse
-00002ce0: 6375 7265 2220 7365 7276 6572 2c20 7468  cure" server, th
-00002cf0: 6520 636c 6965 6e74 2077 696c 6c20 6967  e client will ig
-00002d00: 6e6f 7265 2061 6e79 0a75 7365 726e 616d  nore any.usernam
-00002d10: 6520 616e 6420 7061 7373 776f 7264 2069  e and password i
-00002d20: 6e66 6f72 6d61 7469 6f6e 2069 6e63 6c75  nformation inclu
-00002d30: 6465 6420 696e 2074 6865 2063 6f6e 6e65  ded in the conne
-00002d40: 6374 696f 6e20 7374 7269 6e67 2c0a 736f  ction string,.so
-00002d50: 2074 6861 7420 7573 6572 6e61 6d65 7320   that usernames 
-00002d60: 616e 6420 7061 7373 776f 7264 7320 6172  and passwords ar
-00002d70: 6520 6e6f 7420 7365 6e74 206f 7665 7220  e not sent over 
-00002d80: 616e 2022 696e 7365 6375 7265 2220 636f  an "insecure" co
-00002d90: 6e6e 6563 7469 6f6e 2e0a 0a20 2020 2065  nnection...    e
-00002da0: 7364 623a 2f2f 6c6f 6361 6c68 6f73 743a  sdb://localhost:
-00002db0: 3231 3134 3f54 6c73 3d66 616c 7365 0a0a  2114?Tls=false..
-00002dc0: 506c 6561 7365 206e 6f74 652c 2074 6865  Please note, the
-00002dd0: 2022 696e 7365 6375 7265 2220 636f 6e6e   "insecure" conn
-00002de0: 6563 7469 6f6e 2073 7472 696e 6720 7573  ection string us
-00002df0: 6573 2061 2071 7565 7279 2073 7472 696e  es a query strin
-00002e00: 6720 7769 7468 2074 6865 2066 6965 6c64  g with the field
-00002e10: 2d76 616c 7565 0a60 546c 733d 6661 6c73  -value.`Tls=fals
-00002e20: 6560 2e20 5468 6520 7661 6c75 6520 6f66  e`. The value of
-00002e30: 2074 6869 7320 6669 656c 6420 6973 2062   this field is b
-00002e40: 7920 6465 6661 756c 7420 6074 7275 6560  y default `true`
-00002e50: 2e20 556e 6c65 7373 2074 6865 2063 6f6e  . Unless the con
-00002e60: 6e65 6374 696f 6e20 7374 7269 6e67 0a55  nection string.U
-00002e70: 5249 2069 6e63 6c75 6465 7320 7468 6520  RI includes the 
-00002e80: 6669 656c 642d 7661 6c75 6520 6054 6c73  field-value `Tls
-00002e90: 3d66 616c 7365 6020 696e 2074 6865 2071  =false` in the q
-00002ea0: 7565 7279 2073 7472 696e 672c 2074 6865  uery string, the
-00002eb0: 2060 726f 6f74 5f63 6572 7469 6669 6361   `root_certifica
-00002ec0: 7465 7360 0a63 6f6e 7374 7275 6374 6f72  tes`.constructor
-00002ed0: 2061 7267 756d 656e 7420 6973 2061 6c73   argument is als
-00002ee0: 6f20 7265 7175 6972 6564 2e0a 0a57 6865  o required...Whe
-00002ef0: 6e20 636f 6e6e 6563 7469 6e67 2074 6f20  n connecting to 
-00002f00: 6120 2273 6563 7572 6522 2073 6572 7665  a "secure" serve
-00002f10: 722c 2074 6865 2060 726f 6f74 5f63 6572  r, the `root_cer
-00002f20: 7469 6669 6361 7465 7360 2061 7267 756d  tificates` argum
-00002f30: 656e 7420 6973 2065 7870 6563 7465 6420  ent is expected 
-00002f40: 746f 0a62 6520 6120 5079 7468 6f6e 2060  to.be a Python `
-00002f50: 7374 7260 2063 6f6e 7461 696e 696e 6720  str` containing 
-00002f60: 5045 4d20 656e 636f 6465 6420 5353 4c2f  PEM encoded SSL/
-00002f70: 544c 5320 726f 6f74 2063 6572 7469 6669  TLS root certifi
-00002f80: 6361 7465 732e 2054 6869 7320 7661 6c75  cates. This valu
-00002f90: 6520 6973 0a70 6173 7365 6420 6469 7265  e is.passed dire
-00002fa0: 6374 6c79 2074 6f20 6067 7270 632e 7373  ctly to `grpc.ss
-00002fb0: 6c5f 6368 616e 6e65 6c5f 6372 6564 656e  l_channel_creden
-00002fc0: 7469 616c 7328 2960 2e20 4974 2069 7320  tials()`. It is 
-00002fd0: 7573 6564 2066 6f72 2061 7574 6865 6e74  used for authent
-00002fe0: 6963 6174 696e 6720 7468 650a 7365 7276  icating the.serv
-00002ff0: 6572 2074 6f20 7468 6520 636c 6965 6e74  er to the client
-00003000: 2e20 4974 2069 7320 636f 6d6d 6f6e 6c79  . It is commonly
-00003010: 2074 6865 2063 6572 7469 6669 6361 7465   the certificate
-00003020: 206f 6620 7468 6520 6365 7274 6966 6963   of the certific
-00003030: 6174 6520 6175 7468 6f72 6974 7920 7468  ate authority th
-00003040: 6174 0a77 6173 2072 6573 706f 6e73 6962  at.was responsib
-00003050: 6c65 2066 6f72 2067 656e 6572 6174 696e  le for generatin
-00003060: 6720 7468 6520 5353 4c2f 544c 5320 6365  g the SSL/TLS ce
-00003070: 7274 6966 6963 6174 6520 7573 6564 2062  rtificate used b
-00003080: 7920 7468 6520 4576 656e 7453 746f 7265  y the EventStore
-00003090: 4442 2073 6572 7665 722e 0a42 7574 2c20  DB server..But, 
-000030a0: 616c 7465 726e 6174 6976 656c 7920 666f  alternatively fo
-000030b0: 7220 6465 7665 6c6f 706d 656e 742c 2079  r development, y
-000030c0: 6f75 2063 616e 2075 7365 2074 6865 2073  ou can use the s
-000030d0: 6572 7665 7227 7320 6365 7274 6966 6963  erver's certific
-000030e0: 6174 6520 6974 7365 6c66 2e0a 0a49 6e20  ate itself...In 
-000030f0: 7468 6520 6578 616d 706c 6520 6265 6c6f  the example belo
-00003100: 772c 2074 6865 2063 6f6e 7374 7275 6374  w, the construct
-00003110: 6f72 2061 7267 756d 656e 7420 7661 6c75  or argument valu
-00003120: 6573 2061 7265 2074 616b 656e 2066 726f  es are taken fro
-00003130: 6d20 7468 6520 6f70 6572 6174 696e 670a  m the operating.
-00003140: 7379 7374 656d 2065 6e76 6972 6f6e 6d65  system environme
-00003150: 6e74 2e20 5468 6973 2069 7320 6120 7479  nt. This is a ty
-00003160: 7069 6361 6c20 6172 7261 6e67 656d 656e  pical arrangemen
-00003170: 7420 696e 2061 2070 726f 6475 6374 696f  t in a productio
-00003180: 6e20 656e 7669 726f 6e6d 656e 742e 2049  n environment. I
-00003190: 7420 6973 0a64 6f6e 6520 7468 6973 2077  t is.done this w
-000031a0: 6179 2068 6572 6520 736f 2074 6861 7420  ay here so that 
-000031b0: 7468 6520 636f 6465 2069 6e20 7468 6973  the code in this
-000031c0: 2064 6f63 756d 656e 7461 7469 6f6e 2063   documentation c
-000031d0: 616e 2062 6520 7465 7374 6564 2077 6974  an be tested wit
-000031e0: 6820 626f 7468 0a61 2022 7365 6375 7265  h both.a "secure
-000031f0: 2220 616e 6420 616e 2022 696e 7365 6375  " and an "insecu
-00003200: 7265 2220 7365 7276 6572 2e0a 0a60 6060  re" server...```
-00003210: 7079 7468 6f6e 0a69 6d70 6f72 7420 6f73  python.import os
-00003220: 0a0a 636c 6965 6e74 203d 2045 5344 4243  ..client = ESDBC
-00003230: 6c69 656e 7428 0a20 2020 2075 7269 3d6f  lient(.    uri=o
-00003240: 732e 6765 7465 6e76 2822 4553 4442 5f55  s.getenv("ESDB_U
-00003250: 5249 2229 2c0a 2020 2020 726f 6f74 5f63  RI"),.    root_c
-00003260: 6572 7469 6669 6361 7465 733d 6f73 2e67  ertificates=os.g
-00003270: 6574 656e 7628 2245 5344 425f 524f 4f54  etenv("ESDB_ROOT
-00003280: 5f43 4552 5449 4649 4341 5445 5322 292c  _CERTIFICATES"),
-00003290: 0a29 0a60 6060 0a0a 5365 6520 7468 6520  .).```..See the 
-000032a0: 4e6f 7465 7320 7365 6374 696f 6e20 6265  Notes section be
-000032b0: 6c6f 7720 666f 7220 6465 7461 696c 6564  low for detailed
-000032c0: 2069 6e66 6f72 6d61 7469 6f6e 2061 626f   information abo
-000032d0: 7574 2045 7665 6e74 5374 6f72 6544 4220  ut EventStoreDB 
-000032e0: 636f 6e6e 6563 7469 6f6e 0a73 7472 696e  connection.strin
-000032f0: 6773 2061 6e64 2074 6865 2066 6965 6c64  gs and the field
-00003300: 7320 7468 6174 2063 616e 2062 6520 7573  s that can be us
-00003310: 6564 2069 6e20 7468 6520 7175 6572 7920  ed in the query 
-00003320: 7374 7269 6e67 2074 6f20 7370 6563 6966  string to specif
-00003330: 7920 636f 6e6e 6563 7469 6f6e 0a6f 7074  y connection.opt
-00003340: 696f 6e73 2e0a 0a23 2320 5374 7265 616d  ions...## Stream
-00003350: 730a 0a49 6e20 4576 656e 7453 746f 7265  s..In EventStore
-00003360: 4442 2c20 6120 2273 7472 6561 6d22 2069  DB, a "stream" i
-00003370: 7320 6120 7365 7175 656e 6365 206f 6620  s a sequence of 
-00003380: 7265 636f 7264 6564 2065 7665 6e74 7320  recorded events 
-00003390: 7468 6174 2061 6c6c 2068 6176 650a 7468  that all have.th
-000033a0: 6520 7361 6d65 2022 7374 7265 616d 206e  e same "stream n
-000033b0: 616d 6522 2e20 5468 6572 6520 7769 6c6c  ame". There will
-000033c0: 206e 6f72 6d61 6c6c 7920 6265 206d 616e   normally be man
-000033d0: 7920 7374 7265 616d 7320 696e 2061 2064  y streams in a d
-000033e0: 6174 6162 6173 652e 0a45 6163 6820 7265  atabase..Each re
-000033f0: 636f 7264 6564 2065 7665 6e74 2068 6173  corded event has
-00003400: 2061 2022 7374 7265 616d 2070 6f73 6974   a "stream posit
-00003410: 696f 6e22 2069 6e20 6974 7320 7374 7265  ion" in its stre
-00003420: 616d 2c20 616e 6420 6120 2263 6f6d 6d69  am, and a "commi
-00003430: 7420 706f 7369 7469 6f6e 220a 696e 2074  t position".in t
-00003440: 6865 2064 6174 6162 6173 652e 2054 6865  he database. The
-00003450: 2073 7472 6561 6d20 706f 7369 7469 6f6e   stream position
-00003460: 7320 6f66 2074 6865 2072 6563 6f72 6465  s of the recorde
-00003470: 6420 6576 656e 7473 2069 6e20 6120 7374  d events in a st
-00003480: 7265 616d 2069 7320 6120 6761 706c 6573  ream is a gaples
-00003490: 730a 7365 7175 656e 6365 2073 7461 7274  s.sequence start
-000034a0: 696e 6720 6672 6f6d 207a 6572 6f2e 2054  ing from zero. T
-000034b0: 6865 2063 6f6d 6d69 7420 706f 7369 7469  he commit positi
-000034c0: 6f6e 7320 6f66 2074 6865 2072 6563 6f72  ons of the recor
-000034d0: 6465 6420 6576 656e 7473 2069 6e20 7468  ded events in th
-000034e0: 6520 6461 7461 6261 7365 0a66 6f72 6d20  e database.form 
-000034f0: 6120 7365 7175 656e 6365 2074 6861 7420  a sequence that 
-00003500: 6973 206e 6f74 2067 6170 6c65 7373 2e0a  is not gapless..
-00003510: 0a54 6865 206d 6574 686f 6473 2060 6170  .The methods `ap
-00003520: 7065 6e64 5f65 7665 6e74 7328 2960 2c20  pend_events()`, 
-00003530: 6072 6561 645f 7374 7265 616d 5f65 7665  `read_stream_eve
-00003540: 6e74 7328 2960 2061 6e64 2060 7265 6164  nts()` and `read
-00003550: 5f61 6c6c 5f65 7665 6e74 7328 2960 2063  _all_events()` c
-00003560: 616e 0a62 6520 7573 6564 2074 6f20 7265  an.be used to re
-00003570: 636f 7264 2061 6e64 2072 6561 6420 6576  cord and read ev
-00003580: 656e 7473 2069 6e20 7468 6520 6461 7461  ents in the data
-00003590: 6261 7365 2e0a 0a23 2323 2041 7070 656e  base...### Appen
-000035a0: 6420 6576 656e 7473 0a0a 2a72 6571 7569  d events..*requi
-000035b0: 7265 7320 6c65 6164 6572 2a0a 0a54 6865  res leader*..The
-000035c0: 2060 6170 7065 6e64 5f65 7665 6e74 7328   `append_events(
-000035d0: 2960 206d 6574 686f 6420 6361 6e20 6265  )` method can be
-000035e0: 2075 7365 6420 746f 2077 7269 7465 2061   used to write a
-000035f0: 2073 6571 7565 6e63 6520 6f66 206e 6577   sequence of new
-00003600: 2065 7665 6e74 7320 6174 6f6d 6963 616c   events atomical
-00003610: 6c79 0a74 6f20 6120 2273 7472 6561 6d22  ly.to a "stream"
-00003620: 2e20 5772 6974 696e 6720 6e65 7720 6576  . Writing new ev
-00003630: 656e 7473 2065 6974 6865 7220 6372 6561  ents either crea
-00003640: 7465 7320 6120 7374 7265 616d 2c20 6f72  tes a stream, or
-00003650: 2061 7070 656e 6473 2065 7665 6e74 7320   appends events 
-00003660: 746f 2074 6865 2065 6e64 0a6f 6620 6120  to the end.of a 
-00003670: 7374 7265 616d 2e20 5468 6973 206d 6574  stream. This met
-00003680: 686f 6420 6973 2069 6465 6d70 6f74 656e  hod is idempoten
-00003690: 7420 2873 6565 2062 656c 6f77 292e 0a0a  t (see below)...
-000036a0: 5468 6973 206d 6574 686f 6420 6361 6e20  This method can 
-000036b0: 6265 2075 7365 6420 746f 2072 6563 6f72  be used to recor
-000036c0: 6420 6174 6f6d 6963 616c 6c79 2061 6c6c  d atomically all
-000036d0: 2074 6865 206e 6577 0a65 7665 6e74 7320   the new.events 
-000036e0: 7468 6174 2061 7265 2067 656e 6572 6174  that are generat
-000036f0: 6564 2077 6865 6e20 6578 6563 7574 696e  ed when executin
-00003700: 6720 6120 636f 6d6d 616e 6420 696e 2061  g a command in a
-00003710: 6e20 6170 706c 6963 6174 696f 6e2e 0a0a  n application...
-00003720: 5468 7265 6520 6172 6775 6d65 6e74 7320  Three arguments 
-00003730: 6172 6520 7265 7175 6972 6564 2c20 6073  are required, `s
-00003740: 7472 6561 6d5f 6e61 6d65 602c 2060 6578  tream_name`, `ex
-00003750: 7065 6374 6564 5f70 6f73 6974 696f 6e60  pected_position`
-00003760: 0a61 6e64 2060 6576 656e 7473 602e 0a0a  .and `events`...
-00003770: 5468 6520 6073 7472 6561 6d5f 6e61 6d65  The `stream_name
-00003780: 6020 6172 6775 6d65 6e74 2069 7320 7265  ` argument is re
-00003790: 7175 6972 6564 2c20 616e 6420 6973 2065  quired, and is e
-000037a0: 7870 6563 7465 6420 746f 2062 6520 6120  xpected to be a 
-000037b0: 5079 7468 6f6e 0a60 7374 7260 2074 6861  Python.`str` tha
-000037c0: 7420 756e 6971 7565 6c79 2069 6465 6e74  t uniquely ident
-000037d0: 6966 6965 7320 7468 6520 7374 7265 616d  ifies the stream
-000037e0: 2069 6e20 7468 6520 6461 7461 6261 7365   in the database
-000037f0: 2e0a 0a54 6865 2060 6578 7065 6374 6564  ...The `expected
-00003800: 5f70 6f73 6974 696f 6e60 2061 7267 756d  _position` argum
-00003810: 656e 7420 6973 2072 6571 7569 7265 642c  ent is required,
-00003820: 2069 7320 6578 7065 6374 6564 2074 6f20   is expected to 
-00003830: 6265 3a20 604e 6f6e 6560 0a69 6620 6576  be: `None`.if ev
-00003840: 656e 7473 2061 7265 2062 6569 6e67 2077  ents are being w
-00003850: 7269 7474 656e 2074 6f20 6120 6e65 7720  ritten to a new 
-00003860: 7374 7265 616d 2c20 616e 6420 6f74 6865  stream, and othe
-00003870: 7277 6973 6520 616e 2050 7974 686f 6e20  rwise an Python 
-00003880: 6069 6e74 600a 6571 7561 6c20 746f 2074  `int`.equal to t
-00003890: 6865 2070 6f73 6974 696f 6e20 696e 2074  he position in t
-000038a0: 6865 2073 7472 6561 6d20 6f66 2074 6865  he stream of the
-000038b0: 206c 6173 7420 7265 636f 7264 6564 2065   last recorded e
-000038c0: 7665 6e74 2069 6e20 7468 6520 7374 7265  vent in the stre
-000038d0: 616d 2e0a 0a54 6865 2060 6576 656e 7473  am...The `events
-000038e0: 6020 6172 6775 6d65 6e74 2069 7320 7265  ` argument is re
-000038f0: 7175 6972 6564 2c20 616e 6420 6973 2065  quired, and is e
-00003900: 7870 6563 7465 6420 746f 2062 6520 6120  xpected to be a 
-00003910: 7365 7175 656e 6365 206f 6620 6e65 770a  sequence of new.
-00003920: 6576 656e 7420 6f62 6a65 6374 7320 746f  event objects to
-00003930: 2062 6520 6170 7065 6e64 6564 2074 6f20   be appended to 
-00003940: 7468 6520 6e61 6d65 6420 7374 7265 616d  the named stream
-00003950: 2e20 5468 6520 604e 6577 4576 656e 7460  . The `NewEvent`
-00003960: 2063 6c61 7373 2073 686f 756c 640a 6265   class should.be
-00003970: 2075 7365 6420 746f 2063 6f6e 7374 7275   used to constru
-00003980: 6374 206e 6577 2065 7665 6e74 206f 626a  ct new event obj
-00003990: 6563 7473 2028 7365 6520 6265 6c6f 7729  ects (see below)
-000039a0: 2e0a 0a54 6869 7320 6d65 7468 6f64 2074  ...This method t
-000039b0: 616b 6573 2061 6e20 6f70 7469 6f6e 616c  akes an optional
-000039c0: 2060 7469 6d65 6f75 7460 2061 7267 756d   `timeout` argum
-000039d0: 656e 742c 2077 6869 6368 2069 7320 6120  ent, which is a 
-000039e0: 5079 7468 6f6e 2060 666c 6f61 7460 2074  Python `float` t
-000039f0: 6861 7420 7365 7473 0a61 2064 6561 646c  hat sets.a deadl
-00003a00: 696e 6520 666f 7220 7468 6520 636f 6d70  ine for the comp
-00003a10: 6c65 7469 6f6e 206f 6620 7468 6520 6752  letion of the gR
-00003a20: 5043 206f 7065 7261 7469 6f6e 2e0a 0a53  PC operation...S
-00003a30: 7472 6561 6d73 2061 7265 2063 7265 6174  treams are creat
-00003a40: 6564 2062 7920 7772 6974 696e 6720 6576  ed by writing ev
-00003a50: 656e 7473 2e20 5468 6520 636f 7272 6563  ents. The correc
-00003a60: 7420 7661 6c75 6520 6f66 2074 6865 2060  t value of the `
-00003a70: 6578 7065 6374 6564 5f70 6f73 6974 696f  expected_positio
-00003a80: 6e60 0a61 7267 756d 656e 7420 7768 656e  n`.argument when
-00003a90: 2077 7269 7469 6e67 2074 6865 2066 6972   writing the fir
-00003aa0: 7374 2065 7665 6e74 206f 6620 6120 6e65  st event of a ne
-00003ab0: 7720 7374 7265 616d 2069 7320 604e 6f6e  w stream is `Non
-00003ac0: 6560 2e20 506c 6561 7365 206e 6f74 652c  e`. Please note,
-00003ad0: 2069 7420 6973 0a6e 6f74 2070 6f73 7369   it is.not possi
-00003ae0: 626c 6520 746f 2073 6f6d 6568 6f77 2063  ble to somehow c
-00003af0: 7265 6174 6520 616e 2022 656d 7074 7922  reate an "empty"
-00003b00: 2073 7472 6561 6d20 696e 2045 7665 6e74   stream in Event
-00003b10: 5374 6f72 6544 422e 0a0a 5468 6520 7374  StoreDB...The st
-00003b20: 7265 616d 2070 6f73 6974 696f 6e73 206f  ream positions o
-00003b30: 6620 7265 636f 7264 6564 2065 7665 6e74  f recorded event
-00003b40: 7320 696e 2061 2073 7472 6561 6d20 7374  s in a stream st
-00003b50: 6172 7420 6672 6f6d 207a 6572 6f2c 2061  art from zero, a
-00003b60: 6e64 2066 6f72 6d20 6120 6761 706c 6573  nd form a gaples
-00003b70: 730a 7365 7175 656e 6365 206f 6620 696e  s.sequence of in
-00003b80: 7465 6765 7273 2e20 5468 6520 7374 7265  tegers. The stre
-00003b90: 616d 2070 6f73 6974 696f 6e20 6f66 2074  am position of t
-00003ba0: 6865 2066 6972 7374 2072 6563 6f72 6465  he first recorde
-00003bb0: 6420 6576 656e 7420 696e 2061 2073 7472  d event in a str
-00003bc0: 6561 6d20 6973 0a60 3060 2e20 416e 6420  eam is.`0`. And 
-00003bd0: 736f 2077 6865 6e20 6170 7065 6e64 696e  so when appendin
-00003be0: 6720 7468 6520 7365 636f 6e64 206e 6577  g the second new
-00003bf0: 2065 7665 6e74 2074 6f20 6120 7374 7265   event to a stre
-00003c00: 616d 2074 6861 7420 6861 7320 6f6e 6520  am that has one 
-00003c10: 7265 636f 7264 6564 2065 7665 6e74 2c0a  recorded event,.
-00003c20: 7468 6520 636f 7272 6563 7420 7661 6c75  the correct valu
-00003c30: 6520 6f66 2074 6865 2060 6578 7065 6374  e of the `expect
-00003c40: 6564 5f70 6f73 6974 696f 6e60 2061 7267  ed_position` arg
-00003c50: 756d 656e 7420 6973 2060 3060 2e20 5369  ument is `0`. Si
-00003c60: 6d69 6c61 726c 792c 2074 6865 2073 7472  milarly, the str
-00003c70: 6561 6d0a 706f 7369 7469 6f6e 206f 6620  eam.position of 
-00003c80: 7468 6520 7365 636f 6e64 2072 6563 6f72  the second recor
-00003c90: 6465 6420 6576 656e 7420 696e 2061 2073  ded event in a s
-00003ca0: 7472 6561 6d20 6973 2060 3160 2c20 616e  tream is `1`, an
-00003cb0: 6420 736f 2077 6865 6e20 6170 7065 6e64  d so when append
-00003cc0: 696e 6720 7468 650a 7468 6972 6420 6e65  ing the.third ne
-00003cd0: 7720 6576 656e 7420 746f 2061 2073 7472  w event to a str
-00003ce0: 6561 6d20 7468 6174 2068 6173 2074 776f  eam that has two
-00003cf0: 2072 6563 6f72 6465 6420 6576 656e 7473   recorded events
-00003d00: 2c20 7468 6520 636f 7272 6563 7420 7661  , the correct va
-00003d10: 6c75 6520 6f66 2074 6865 0a60 6578 7065  lue of the.`expe
-00003d20: 6374 6564 5f70 6f73 6974 696f 6e60 2061  cted_position` a
-00003d30: 7267 756d 656e 7420 6973 2060 3160 2e20  rgument is `1`. 
-00003d40: 416e 6420 736f 206f 6e2e 2e2e 2028 5468  And so on... (Th
-00003d50: 6572 6520 6973 2061 2074 6865 6f72 6574  ere is a theoret
-00003d60: 6963 616c 206d 6178 696d 756d 0a6e 756d  ical maximum.num
-00003d70: 6265 7220 6f66 2072 6563 6f72 6465 6420  ber of recorded 
-00003d80: 6576 656e 7473 2074 6861 7420 616e 7920  events that any 
-00003d90: 7374 7265 616d 2063 616e 2068 6176 652c  stream can have,
-00003da0: 2062 7574 2049 276d 206e 6f74 2073 7572   but I'm not sur
-00003db0: 6520 7768 6174 2069 7420 6973 3b0a 6d61  e what it is;.ma
-00003dc0: 7962 6520 392c 3232 332c 3337 322c 3033  ybe 9,223,372,03
-00003dd0: 362c 3835 342c 3737 352c 3830 3720 6265  6,854,775,807 be
-00003de0: 6361 7573 6520 6974 2069 7320 696d 706c  cause it is impl
-00003df0: 656d 656e 7465 6420 6173 2061 2060 6c6f  emented as a `lo
-00003e00: 6e67 6020 696e 2043 233f 290a 0a49 6620  ng` in C#?)..If 
-00003e10: 7468 6572 6520 6973 2061 206d 6973 6d61  there is a misma
-00003e20: 7463 6820 6265 7477 6565 6e20 7468 6520  tch between the 
-00003e30: 6769 7665 6e20 7661 6c75 6520 6f66 2074  given value of t
-00003e40: 6865 2060 6578 7065 6374 6564 5f70 6f73  he `expected_pos
-00003e50: 6974 696f 6e60 2061 7267 756d 656e 740a  ition` argument.
-00003e60: 616e 6420 7468 6520 706f 7369 7469 6f6e  and the position
-00003e70: 206f 6620 7468 6520 6c61 7374 2072 6563   of the last rec
-00003e80: 6f72 6465 6420 6576 656e 7420 696e 2061  orded event in a
-00003e90: 2073 7472 6561 6d2c 2074 6865 6e20 616e   stream, then an
-00003ea0: 2060 4578 7065 6374 6564 506f 7369 7469   `ExpectedPositi
-00003eb0: 6f6e 4572 726f 7260 0a65 7863 6570 7469  onError`.excepti
-00003ec0: 6f6e 2077 696c 6c20 6265 2072 6169 7365  on will be raise
-00003ed0: 642e 2054 6869 7320 6566 6665 6374 6976  d. This effectiv
-00003ee0: 656c 7920 6163 636f 6d70 6c69 7368 6573  ely accomplishes
-00003ef0: 206f 7074 696d 6973 7469 6320 636f 6e63   optimistic conc
-00003f00: 7572 7265 6e63 7920 636f 6e74 726f 6c2e  urrency control.
-00003f10: 0a0a 4966 2079 6f75 2077 6973 6820 746f  ..If you wish to
-00003f20: 2064 6973 6162 6c65 206f 7074 696d 6973   disable optimis
-00003f30: 7469 6320 636f 6e63 7572 7265 6e63 7920  tic concurrency 
-00003f40: 636f 6e74 726f 6c20 7768 656e 2061 7070  control when app
-00003f50: 656e 6469 6e67 206e 6577 2065 7665 6e74  ending new event
-00003f60: 732c 2079 6f75 0a63 616e 2073 6574 2074  s, you.can set t
-00003f70: 6865 2060 6578 7065 6374 6564 5f70 6f73  he `expected_pos
-00003f80: 6974 696f 6e60 2074 6f20 6120 6e65 6761  ition` to a nega
-00003f90: 7469 7665 2069 6e74 6567 6572 2e0a 0a49  tive integer...I
-00003fa0: 6620 796f 7520 6e65 6564 2074 6f20 6469  f you need to di
-00003fb0: 7363 6f76 6572 2074 6865 2063 7572 7265  scover the curre
-00003fc0: 6e74 2070 6f73 6974 696f 6e20 6f66 2074  nt position of t
-00003fd0: 6865 206c 6173 7420 7265 636f 7264 6564  he last recorded
-00003fe0: 2065 7665 6e74 2069 6e20 6120 7374 7265   event in a stre
-00003ff0: 616d 2c0a 796f 7520 6361 6e20 7573 6520  am,.you can use 
-00004000: 7468 6520 6067 6574 5f73 7472 6561 6d5f  the `get_stream_
-00004010: 706f 7369 7469 6f6e 2829 6020 6d65 7468  position()` meth
-00004020: 6f64 2028 7365 6520 6265 6c6f 7729 2e0a  od (see below)..
-00004030: 0a50 6c65 6173 6520 6e6f 7465 2c20 7468  .Please note, th
-00004040: 6520 6170 7065 6e64 2065 7665 6e74 7320  e append events 
-00004050: 6f70 6572 6174 696f 6e20 6973 2061 746f  operation is ato
-00004060: 6d69 632c 2073 6f20 7468 6174 2065 6974  mic, so that eit
-00004070: 6865 7220 616c 6c0a 6f72 206e 6f6e 6520  her all.or none 
-00004080: 6f66 2074 6865 2067 6976 656e 206e 6577  of the given new
-00004090: 2065 7665 6e74 7320 7769 6c6c 2062 6520   events will be 
-000040a0: 7265 636f 7264 6564 2e20 4279 2064 6573  recorded. By des
-000040b0: 6967 6e2c 2069 7420 6973 206f 6e6c 790a  ign, it is only.
-000040c0: 706f 7373 6962 6c65 2077 6974 6820 4576  possible with Ev
-000040d0: 656e 7453 746f 7265 4442 2074 6f20 6174  entStoreDB to at
-000040e0: 6f6d 6963 616c 6c79 2072 6563 6f72 6420  omically record 
-000040f0: 6e65 7720 6576 656e 7473 2069 6e20 6f6e  new events in on
-00004100: 6520 7374 7265 616d 2e0a 0a49 6e20 7468  e stream...In th
-00004110: 6520 6578 616d 706c 6520 6265 6c6f 772c  e example below,
-00004120: 2061 206e 6577 2065 7665 6e74 2069 7320   a new event is 
-00004130: 6170 7065 6e64 6564 2074 6f20 6120 6e65  appended to a ne
-00004140: 7720 7374 7265 616d 2e0a 0a60 6060 7079  w stream...```py
-00004150: 7468 6f6e 0a66 726f 6d20 7575 6964 2069  thon.from uuid i
-00004160: 6d70 6f72 7420 7575 6964 340a 0a66 726f  mport uuid4..fro
-00004170: 6d20 6573 6462 636c 6965 6e74 2069 6d70  m esdbclient imp
-00004180: 6f72 7420 4e65 7745 7665 6e74 0a0a 2320  ort NewEvent..# 
-00004190: 436f 6e73 7472 7563 7420 6e65 7720 6576  Construct new ev
-000041a0: 656e 7420 6f62 6a65 6374 2e0a 6576 656e  ent object..even
-000041b0: 7431 203d 204e 6577 4576 656e 7428 7479  t1 = NewEvent(ty
-000041c0: 7065 3d27 4f72 6465 7243 7265 6174 6564  pe='OrderCreated
-000041d0: 272c 2064 6174 613d 6227 6461 7461 3127  ', data=b'data1'
-000041e0: 290a 0a23 2044 6566 696e 6520 7374 7265  )..# Define stre
-000041f0: 616d 206e 616d 652e 0a73 7472 6561 6d5f  am name..stream_
-00004200: 6e61 6d65 3120 3d20 7374 7228 7575 6964  name1 = str(uuid
-00004210: 3428 2929 0a0a 2320 4170 7065 6e64 206c  4())..# Append l
-00004220: 6973 7420 6f66 2065 7665 6e74 7320 746f  ist of events to
-00004230: 206e 6577 2073 7472 6561 6d2e 0a63 6f6d   new stream..com
-00004240: 6d69 745f 706f 7369 7469 6f6e 3120 3d20  mit_position1 = 
-00004250: 636c 6965 6e74 2e61 7070 656e 645f 6576  client.append_ev
-00004260: 656e 7473 280a 2020 2020 7374 7265 616d  ents(.    stream
-00004270: 5f6e 616d 653d 7374 7265 616d 5f6e 616d  _name=stream_nam
-00004280: 6531 2c0a 2020 2020 6578 7065 6374 6564  e1,.    expected
-00004290: 5f70 6f73 6974 696f 6e3d 4e6f 6e65 2c0a  _position=None,.
-000042a0: 2020 2020 6576 656e 7473 3d5b 6576 656e      events=[even
-000042b0: 7431 5d2c 0a29 0a60 6060 0a0a 496e 2074  t1],.).```..In t
-000042c0: 6865 2065 7861 6d70 6c65 2062 656c 6f77  he example below
-000042d0: 2c20 7477 6f20 7375 6273 6571 7565 6e74  , two subsequent
-000042e0: 2065 7665 6e74 7320 6172 6520 6170 7065   events are appe
-000042f0: 6e64 6564 2074 6f20 616e 2065 7869 7374  nded to an exist
-00004300: 696e 670a 7374 7265 616d 2e0a 0a60 6060  ing.stream...```
-00004310: 7079 7468 6f6e 0a65 7665 6e74 3220 3d20  python.event2 = 
-00004320: 4e65 7745 7665 6e74 2874 7970 653d 274f  NewEvent(type='O
-00004330: 7264 6572 5570 6461 7465 6427 2c20 6461  rderUpdated', da
-00004340: 7461 3d62 2764 6174 6132 2729 0a65 7665  ta=b'data2').eve
-00004350: 6e74 3320 3d20 4e65 7745 7665 6e74 2874  nt3 = NewEvent(t
-00004360: 7970 653d 274f 7264 6572 4465 6c65 7465  ype='OrderDelete
-00004370: 6427 2c20 6461 7461 3d62 2764 6174 6133  d', data=b'data3
-00004380: 2729 0a0a 636f 6d6d 6974 5f70 6f73 6974  ')..commit_posit
-00004390: 696f 6e32 203d 2063 6c69 656e 742e 6170  ion2 = client.ap
-000043a0: 7065 6e64 5f65 7665 6e74 7328 0a20 2020  pend_events(.   
-000043b0: 2073 7472 6561 6d5f 6e61 6d65 3d73 7472   stream_name=str
-000043c0: 6561 6d5f 6e61 6d65 312c 0a20 2020 2065  eam_name1,.    e
-000043d0: 7870 6563 7465 645f 706f 7369 7469 6f6e  xpected_position
-000043e0: 3d30 2c0a 2020 2020 6576 656e 7473 3d5b  =0,.    events=[
-000043f0: 6576 656e 7432 2c20 6576 656e 7433 5d2c  event2, event3],
-00004400: 0a29 0a60 6060 0a0a 4966 2074 6865 206f  .).```..If the o
-00004410: 7065 7261 7469 6f6e 2069 7320 7375 6363  peration is succ
-00004420: 6573 7366 756c 2c20 7468 6973 206d 6574  essful, this met
-00004430: 686f 6420 7265 7475 726e 7320 616e 2069  hod returns an i
-00004440: 6e74 6567 6572 0a72 6570 7265 7365 6e74  nteger.represent
-00004450: 696e 6720 7468 6520 6f76 6572 616c 6c20  ing the overall 
-00004460: 2263 6f6d 6d69 7420 706f 7369 7469 6f6e  "commit position
-00004470: 2220 6173 2069 7420 7761 7320 7768 656e  " as it was when
-00004480: 2074 6865 206f 7065 7261 7469 6f6e 0a77   the operation.w
-00004490: 6173 2063 6f6d 706c 6574 6564 2e20 4f74  as completed. Ot
-000044a0: 6865 7277 6973 652c 2061 6e20 6578 6365  herwise, an exce
-000044b0: 7074 696f 6e20 7769 6c6c 2062 6520 7261  ption will be ra
-000044c0: 6973 6564 2e0a 0a41 2022 636f 6d6d 6974  ised...A "commit
-000044d0: 2070 6f73 6974 696f 6e22 2069 7320 6120   position" is a 
-000044e0: 6d6f 6e6f 746f 6e69 6361 6c6c 7920 696e  monotonically in
-000044f0: 6372 6561 7369 6e67 2069 6e74 6567 6572  creasing integer
-00004500: 2072 6570 7265 7365 6e74 696e 670a 7468   representing.th
-00004510: 6520 706f 7369 7469 6f6e 206f 6620 7468  e position of th
-00004520: 6520 7265 636f 7264 6564 2065 7665 6e74  e recorded event
-00004530: 2069 6e20 6120 2274 6f74 616c 206f 7264   in a "total ord
-00004540: 6572 2220 6f66 2061 6c6c 2072 6563 6f72  er" of all recor
-00004550: 6465 640a 6576 656e 7473 2069 6e20 7468  ded.events in th
-00004560: 6520 6461 7461 6261 7365 2061 6372 6f73  e database acros
-00004570: 7320 616c 6c20 7374 7265 616d 732e 2049  s all streams. I
-00004580: 7420 6973 2074 6865 2061 6374 7561 6c20  t is the actual 
-00004590: 706f 7369 7469 6f6e 0a6f 6620 7468 6520  position.of the 
-000045a0: 6576 656e 7420 7265 636f 7264 206f 6e20  event record on 
-000045b0: 6469 736b 2c20 616e 6420 7468 6572 6520  disk, and there 
-000045c0: 6172 6520 7573 7561 6c6c 7920 6c61 7267  are usually larg
-000045d0: 6520 6469 6666 6572 656e 6365 730a 6265  e differences.be
-000045e0: 7477 6565 6e20 7375 6363 6573 7369 7665  tween successive
-000045f0: 2063 6f6d 6d69 7473 2e20 496e 2063 6f6e   commits. In con
-00004600: 7365 7175 656e 6365 2c20 7468 6520 7365  sequence, the se
-00004610: 7175 656e 6365 206f 6620 636f 6d6d 6974  quence of commit
-00004620: 0a70 6f73 6974 696f 6e73 2069 7320 6e6f  .positions is no
-00004630: 7420 6761 706c 6573 732e 2049 6e64 6565  t gapless. Indee
-00004640: 642c 2074 6865 7265 2061 7265 2075 7375  d, there are usu
-00004650: 616c 6c79 206c 6172 6765 2064 6966 6665  ally large diffe
-00004660: 7265 6e63 6573 0a62 6574 7765 656e 2074  rences.between t
-00004670: 6865 2063 6f6d 6d69 7420 706f 7369 7469  he commit positi
-00004680: 6f6e 7320 6f66 2073 7563 6365 7373 6976  ons of successiv
-00004690: 6520 7265 636f 7264 6564 2065 7665 6e74  e recorded event
-000046a0: 732e 0a0a 5468 6520 2263 6f6d 6d69 7420  s...The "commit 
-000046b0: 706f 7369 7469 6f6e 2220 7265 7475 726e  position" return
-000046c0: 6564 2062 7920 6061 7070 656e 645f 6576  ed by `append_ev
-000046d0: 656e 7473 2829 6020 6973 2074 6861 7420  ents()` is that 
-000046e0: 6f66 2074 6865 206c 6173 740a 7265 636f  of the last.reco
-000046f0: 7264 6564 2065 7665 6e74 2069 6e20 7468  rded event in th
-00004700: 6520 6769 7665 6e20 6261 7463 6820 6f66  e given batch of
-00004710: 206e 6577 2065 7665 6e74 732e 0a0a 5468   new events...Th
-00004720: 6520 2263 6f6d 6d69 7420 706f 7369 7469  e "commit positi
-00004730: 6f6e 2220 7265 7475 726e 6564 2069 6e20  on" returned in 
-00004740: 7468 6973 2077 6179 2063 616e 2074 6865  this way can the
-00004750: 7265 666f 7265 2062 6520 7573 6564 2074  refore be used t
-00004760: 6f20 7761 6974 0a66 6f72 2061 2064 6f77  o wait.for a dow
-00004770: 6e73 7472 6561 6d20 636f 6d70 6f6e 656e  nstream componen
-00004780: 7420 746f 2068 6176 6520 7072 6f63 6573  t to have proces
-00004790: 7365 6420 616c 6c20 7468 6520 6576 656e  sed all the even
-000047a0: 7473 2074 6861 7420 7765 7265 2072 6563  ts that were rec
-000047b0: 6f72 6465 642e 0a0a 466f 7220 6578 616d  orded...For exam
-000047c0: 706c 652c 2063 6f6e 7369 6465 7220 6120  ple, consider a 
-000047d0: 7573 6572 2069 6e74 6572 6661 6365 2063  user interface c
-000047e0: 6f6d 6d61 6e64 2074 6861 7420 7265 7375  ommand that resu
-000047f0: 6c74 7320 696e 2074 6865 2072 6563 6f72  lts in the recor
-00004800: 6469 6e67 0a6f 6620 6e65 7720 6576 656e  ding.of new even
-00004810: 7473 2c20 616e 6420 6120 7175 6572 7920  ts, and a query 
-00004820: 696e 746f 2061 6e20 6576 656e 7475 616c  into an eventual
-00004830: 6c79 2063 6f6e 7369 7374 656e 7420 6d61  ly consistent ma
-00004840: 7465 7269 616c 697a 6564 0a76 6965 7720  terialized.view 
-00004850: 696e 2061 2064 6f77 6e73 7472 6561 6d20  in a downstream 
-00004860: 636f 6d70 6f6e 656e 7420 7468 6174 2069  component that i
-00004870: 7320 7570 6461 7465 6420 6672 6f6d 2074  s updated from t
-00004880: 6865 7365 2065 7665 6e74 732e 2049 6620  hese events. If 
-00004890: 7468 6520 6e65 770a 6576 656e 7473 2068  the new.events h
-000048a0: 6176 6520 6e6f 7420 7965 7420 6265 656e  ave not yet been
-000048b0: 2070 726f 6365 7373 6564 2c20 7468 6520   processed, the 
-000048c0: 7669 6577 2077 6f75 6c64 2062 6520 7374  view would be st
-000048d0: 616c 652e 2054 6865 2022 636f 6d6d 6974  ale. The "commit
-000048e0: 2070 6f73 6974 696f 6e22 0a63 616e 2062   position".can b
-000048f0: 6520 7573 6564 2062 7920 7468 6520 7573  e used by the us
-00004900: 6572 2069 6e74 6572 6661 6365 2074 6f20  er interface to 
-00004910: 706f 6c6c 2074 6865 2064 6f77 6e73 7472  poll the downstr
-00004920: 6561 6d20 636f 6d70 6f6e 656e 7420 756e  eam component un
-00004930: 7469 6c20 6974 2068 6173 0a70 726f 6365  til it has.proce
-00004940: 7373 6564 2074 686f 7365 206e 6577 2065  ssed those new e
-00004950: 7665 6e74 732c 2061 6674 6572 2077 6869  vents, after whi
-00004960: 6368 2074 696d 6520 7468 6520 7669 6577  ch time the view
-00004970: 2077 696c 6c20 6e6f 7420 6265 2073 7461   will not be sta
-00004980: 6c65 2e0a 0a0a 2323 2320 4170 7065 6e64  le....### Append
-00004990: 2065 7665 6e74 0a0a 2a72 6571 7569 7265   event..*require
-000049a0: 7320 6c65 6164 6572 2a0a 0a54 6865 2060  s leader*..The `
-000049b0: 6170 7065 6e64 5f65 7665 6e74 2829 6020  append_event()` 
-000049c0: 6d65 7468 6f64 2063 616e 2062 6520 7573  method can be us
-000049d0: 6564 2074 6f20 7772 6974 6520 6120 7369  ed to write a si
-000049e0: 6e67 6c65 206e 6577 2065 7665 6e74 2074  ngle new event t
-000049f0: 6f20 6120 7374 7265 616d 2e0a 0a54 6872  o a stream...Thr
-00004a00: 6565 2061 7267 756d 656e 7473 2061 7265  ee arguments are
-00004a10: 2072 6571 7569 7265 642c 2060 7374 7265   required, `stre
-00004a20: 616d 5f6e 616d 6560 2c20 6065 7870 6563  am_name`, `expec
-00004a30: 7465 645f 706f 7369 7469 6f6e 6020 616e  ted_position` an
-00004a40: 6420 6065 7665 6e74 602e 0a0a 5468 6973  d `event`...This
-00004a50: 206d 6574 686f 6420 776f 726b 7320 696e   method works in
-00004a60: 2074 6865 2073 616d 6520 7761 7920 6173   the same way as
-00004a70: 2060 6170 7065 6e64 5f65 7665 6e74 7328   `append_events(
-00004a80: 2960 2c20 686f 7765 7665 7220 6065 7665  )`, however `eve
-00004a90: 6e74 6020 6973 2065 7870 6563 7465 640a  nt` is expected.
-00004aa0: 746f 2062 6520 6120 7369 6e67 6c65 2060  to be a single `
-00004ab0: 4e65 7745 7665 6e74 602e 0a0a 5468 6973  NewEvent`...This
-00004ac0: 206d 6574 686f 6420 7461 6b65 7320 616e   method takes an
-00004ad0: 206f 7074 696f 6e61 6c20 6074 696d 656f   optional `timeo
-00004ae0: 7574 6020 6172 6775 6d65 6e74 2c20 7768  ut` argument, wh
-00004af0: 6963 6820 6973 2061 2050 7974 686f 6e20  ich is a Python 
-00004b00: 6066 6c6f 6174 6020 7468 6174 2073 6574  `float` that set
-00004b10: 730a 6120 6465 6164 6c69 6e65 2066 6f72  s.a deadline for
-00004b20: 2074 6865 2063 6f6d 706c 6574 696f 6e20   the completion 
-00004b30: 6f66 2074 6865 2067 5250 4320 6f70 6572  of the gRPC oper
-00004b40: 6174 696f 6e2e 0a0a 5369 6e63 6520 7468  ation...Since th
-00004b50: 6520 6861 6e64 6c69 6e67 206f 6620 6120  e handling of a 
-00004b60: 636f 6d6d 616e 6420 696e 2079 6f75 7220  command in your 
-00004b70: 6170 706c 6963 6174 696f 6e20 6d61 7920  application may 
-00004b80: 7265 7375 6c74 2069 6e20 6f6e 6520 6f72  result in one or
-00004b90: 206d 616e 790a 6e65 7720 6576 656e 7473   many.new events
-00004ba0: 2c20 616e 6420 7468 6520 7265 7375 6c74  , and the result
-00004bb0: 7320 6f66 2068 616e 646c 696e 6720 6120  s of handling a 
-00004bc0: 636f 6d6d 616e 6420 7368 6f75 6c64 2062  command should b
-00004bd0: 6520 7265 636f 7264 6564 2061 746f 6d69  e recorded atomi
-00004be0: 6361 6c6c 792c 0a61 6e64 2074 6865 2077  cally,.and the w
-00004bf0: 7269 7469 6e67 206f 6620 6e65 7720 6576  riting of new ev
-00004c00: 656e 7473 2067 656e 6572 6174 6564 2062  ents generated b
-00004c10: 7920 6120 636f 6d6d 616e 6420 6861 6e64  y a command hand
-00004c20: 6c65 7220 6973 2075 7375 616c 6c79 2061  ler is usually a
-00004c30: 2063 6f6e 6365 726e 0a74 6861 7420 6973   concern.that is
-00004c40: 2066 6163 746f 7265 6420 6f75 7420 616e   factored out an
-00004c50: 6420 7573 6564 2065 7665 7279 7768 6572  d used everywher
-00004c60: 6520 696e 2061 2070 726f 6a65 6374 2c20  e in a project, 
-00004c70: 6974 2069 7320 7175 6974 6520 7573 7561  it is quite usua
-00004c80: 6c20 696e 2061 2070 726f 6a65 6374 0a74  l in a project.t
-00004c90: 6f20 6f6e 6c79 2075 7365 2060 6170 7065  o only use `appe
-00004ca0: 6e64 5f65 7665 6e74 7328 2960 2074 6f20  nd_events()` to 
-00004cb0: 7265 636f 7264 206e 6577 2065 7665 6e74  record new event
-00004cc0: 732e 2046 6f72 2074 6869 7320 7265 6173  s. For this reas
-00004cd0: 6f6e 2c20 616e 2065 7861 6d70 6c65 2069  on, an example i
-00004ce0: 730a 6e6f 7420 7072 6f76 6964 6564 2068  s.not provided h
-00004cf0: 6572 652e 0a0a 0a23 2323 2049 6465 6d70  ere....### Idemp
-00004d00: 6f74 656e 7420 6170 7065 6e64 206f 7065  otent append ope
-00004d10: 7261 7469 6f6e 730a 0a53 6f6d 6574 696d  rations..Sometim
-00004d20: 6573 2069 7420 6d61 7920 6861 7070 656e  es it may happen
-00004d30: 2074 6861 7420 6120 6e65 7720 6576 656e   that a new even
-00004d40: 7420 6973 2073 7563 6365 7373 6675 6c6c  t is successfull
-00004d50: 7920 7265 636f 7264 6564 2061 6e64 2074  y recorded and t
-00004d60: 6865 6e20 736f 6d65 686f 770a 7468 6520  hen somehow.the 
-00004d70: 636f 6e6e 6563 7469 6f6e 2074 6f20 7468  connection to th
-00004d80: 6520 6461 7461 6261 7365 2067 6574 7320  e database gets 
-00004d90: 696e 7465 7272 7570 7465 6420 6265 666f  interrupted befo
-00004da0: 7265 2074 6865 2073 7563 6365 7373 6675  re the successfu
-00004db0: 6c20 6361 6c6c 2063 616e 2072 6574 7572  l call can retur
-00004dc0: 6e0a 7375 6363 6573 7366 756c 6c79 2074  n.successfully t
-00004dd0: 6f20 7468 6520 636c 6965 6e74 2e20 496e  o the client. In
-00004de0: 2063 6173 6520 6f66 2061 6e20 6572 726f   case of an erro
-00004df0: 7220 7768 656e 2061 7070 656e 6469 6e67  r when appending
-00004e00: 2061 6e20 6576 656e 742c 2069 7420 6d61   an event, it ma
-00004e10: 7920 6265 0a64 6573 6972 6162 6c65 2074  y be.desirable t
-00004e20: 6f20 7265 7472 7920 6170 7065 6e64 696e  o retry appendin
-00004e30: 6720 7468 6520 7361 6d65 2065 7665 6e74  g the same event
-00004e40: 2061 7420 7468 6520 7361 6d65 2070 6f73   at the same pos
-00004e50: 6974 696f 6e2e 2049 6620 7468 6520 6576  ition. If the ev
-00004e60: 656e 7420 7761 730a 696e 2066 6163 7420  ent was.in fact 
-00004e70: 7375 6363 6573 7366 756c 6c79 2072 6563  successfully rec
-00004e80: 6f72 6465 642c 2069 7420 6973 2063 6f6e  orded, it is con
-00004e90: 7665 6e69 656e 7420 666f 7220 7468 6520  venient for the 
-00004ea0: 7265 7472 7920 746f 2072 6574 7572 6e20  retry to return 
-00004eb0: 7375 6363 6573 7366 756c 6c79 0a77 6974  successfully.wit
-00004ec0: 686f 7574 2072 6169 7369 6e67 2061 6e20  hout raising an 
-00004ed0: 6572 726f 7220 6475 6520 746f 206f 7074  error due to opt
-00004ee0: 696d 6973 7469 6320 636f 6e63 7572 7265  imistic concurre
-00004ef0: 6e63 7920 636f 6e74 726f 6c20 2861 7320  ncy control (as 
-00004f00: 6465 7363 7269 6265 6420 6162 6f76 6529  described above)
-00004f10: 2e0a 0a54 6865 2065 7861 6d70 6c65 2062  ...The example b
-00004f20: 656c 6f77 2073 686f 7773 2074 6865 2060  elow shows the `
-00004f30: 6170 7065 6e64 5f65 7665 6e74 7328 2960  append_events()`
-00004f40: 206d 6574 686f 6420 6265 696e 6720 6361   method being ca
-00004f50: 6c6c 6564 2061 6761 696e 2077 6974 680a  lled again with.
-00004f60: 6065 7665 6e74 3360 2061 6e64 2060 6578  `event3` and `ex
-00004f70: 7065 6374 6564 5f70 6f73 6974 696f 6e3d  pected_position=
-00004f80: 3260 2e20 5765 2063 616e 2073 6565 2074  2`. We can see t
-00004f90: 6861 7420 7265 7065 6174 696e 6720 7468  hat repeating th
-00004fa0: 6520 6361 6c6c 2074 6f0a 6061 7070 656e  e call to.`appen
-00004fb0: 645f 6576 656e 7473 2829 6020 7265 7475  d_events()` retu
-00004fc0: 726e 7320 7375 6363 6573 7366 756c 6c79  rns successfully
-00004fd0: 2e0a 0a60 6060 7079 7468 6f6e 0a23 2052  ...```python.# R
-00004fe0: 6574 7279 2061 7070 656e 6469 6e67 2065  etry appending e
-00004ff0: 7665 6e74 332e 0a63 6f6d 6d69 745f 706f  vent3..commit_po
-00005000: 7369 7469 6f6e 5f72 6574 7279 203d 2063  sition_retry = c
-00005010: 6c69 656e 742e 6170 7065 6e64 5f65 7665  lient.append_eve
-00005020: 6e74 7328 0a20 2020 2073 7472 6561 6d5f  nts(.    stream_
-00005030: 6e61 6d65 3d73 7472 6561 6d5f 6e61 6d65  name=stream_name
-00005040: 312c 0a20 2020 2065 7870 6563 7465 645f  1,.    expected_
-00005050: 706f 7369 7469 6f6e 3d30 2c0a 2020 2020  position=0,.    
-00005060: 6576 656e 7473 3d5b 6576 656e 7432 2c20  events=[event2, 
-00005070: 6576 656e 7433 5d2c 0a29 0a60 6060 0a0a  event3],.).```..
-00005080: 5765 2063 616e 2073 6565 2074 6861 7420  We can see that 
-00005090: 7468 6520 7361 6d65 2063 6f6d 6d69 7420  the same commit 
-000050a0: 706f 7369 7469 6f6e 2069 7320 7265 7475  position is retu
-000050b0: 726e 6564 2061 7320 6162 6f76 652e 0a0a  rned as above...
-000050c0: 6060 6070 7974 686f 6e0a 6173 7365 7274  ```python.assert
-000050d0: 2063 6f6d 6d69 745f 706f 7369 7469 6f6e   commit_position
-000050e0: 5f72 6574 7279 203d 3d20 636f 6d6d 6974  _retry == commit
-000050f0: 5f70 6f73 6974 696f 6e32 0a60 6060 0a0a  _position2.```..
-00005100: 4279 2063 616c 6c69 6e67 2060 7265 6164  By calling `read
-00005110: 5f73 7472 6561 6d5f 6576 656e 7473 2829  _stream_events()
-00005120: 602c 2077 6520 6361 6e20 616c 736f 2073  `, we can also s
-00005130: 6565 2074 6865 2073 7472 6561 6d20 6861  ee the stream ha
-00005140: 7320 6265 656e 2075 6e63 6861 6e67 6564  s been unchanged
-00005150: 0a64 6573 7069 7465 2074 6865 2060 6170  .despite the `ap
-00005160: 7065 6e64 5f65 7665 6e74 7328 2960 206d  pend_events()` m
-00005170: 6574 686f 6420 6861 7669 6e67 2062 6565  ethod having bee
-00005180: 6e20 6361 6c6c 6564 2074 7769 6365 2077  n called twice w
-00005190: 6974 6820 7468 6520 7361 6d65 2061 7267  ith the same arg
-000051a0: 756d 656e 7473 2e0a 5468 6174 2069 732c  uments..That is,
-000051b0: 2074 6865 7265 2061 7265 2073 7469 6c6c   there are still
-000051c0: 206f 6e6c 7920 7468 7265 6520 6576 656e   only three even
-000051d0: 7473 2069 6e20 7468 6520 7374 7265 616d  ts in the stream
-000051e0: 2e0a 0a60 6060 7079 7468 6f6e 0a65 7665  ...```python.eve
-000051f0: 6e74 7320 3d20 636c 6965 6e74 2e72 6561  nts = client.rea
-00005200: 645f 7374 7265 616d 5f65 7665 6e74 7328  d_stream_events(
-00005210: 0a20 2020 2073 7472 6561 6d5f 6e61 6d65  .    stream_name
-00005220: 3d73 7472 6561 6d5f 6e61 6d65 310a 290a  =stream_name1.).
-00005230: 0a61 7373 6572 7420 6c65 6e28 6576 656e  .assert len(even
-00005240: 7473 2920 3d3d 2033 0a60 6060 0a0a 5468  ts) == 3.```..Th
-00005250: 6973 2069 6465 6d70 6f74 656e 7420 6265  is idempotent be
-00005260: 6861 7669 6f75 7220 6973 2061 6374 6976  haviour is activ
-00005270: 6174 6564 2062 6563 6175 7365 2074 6865  ated because the
-00005280: 2060 4e65 7745 7665 6e74 6020 636c 6173   `NewEvent` clas
-00005290: 7320 6861 7320 616e 2060 6964 600a 6174  s has an `id`.at
-000052a0: 7472 6962 7574 6520 7468 6174 2c20 6279  tribute that, by
-000052b0: 2064 6566 6175 6c74 2c20 6973 2061 7373   default, is ass
-000052c0: 6967 6e65 6420 6120 6e65 7720 616e 6420  igned a new and 
-000052d0: 756e 6971 7565 2076 6572 7369 6f6e 2d34  unique version-4
-000052e0: 2055 5549 4420 7768 656e 2061 6e0a 696e   UUID when an.in
-000052f0: 7374 616e 6365 206f 6620 604e 6577 4576  stance of `NewEv
-00005300: 656e 7460 2069 7320 636f 6e73 7472 7563  ent` is construc
-00005310: 7465 642e 2049 6620 6576 656e 7473 2077  ted. If events w
-00005320: 6974 6820 7468 6520 7361 6d65 2060 6964  ith the same `id
-00005330: 6020 6172 6520 6170 7065 6e64 6564 0a61  ` are appended.a
-00005340: 7420 7468 6520 7361 6d65 2060 6578 7065  t the same `expe
-00005350: 6374 6564 5f70 6f73 6974 696f 6e60 2c20  cted_position`, 
-00005360: 7468 6520 7374 7265 616d 2077 696c 6c20  the stream will 
-00005370: 6265 2075 6e63 6861 6e67 6564 2c20 7468  be unchanged, th
-00005380: 6520 6f70 6572 6174 696f 6e20 7769 6c6c  e operation will
-00005390: 0a63 6f6d 706c 6574 6520 7375 6363 6573  .complete succes
-000053a0: 7366 756c 6c79 2c20 616e 6420 7468 6520  sfully, and the 
-000053b0: 7361 6d65 2063 6f6d 6d69 7420 706f 7369  same commit posi
-000053c0: 7469 6f6e 2077 696c 6c20 6265 2072 6574  tion will be ret
-000053d0: 7572 6e65 6420 746f 2074 6865 2063 616c  urned to the cal
-000053e0: 6c65 722e 0a0a 6060 6070 7974 686f 6e0a  ler...```python.
-000053f0: 6672 6f6d 2075 7569 6420 696d 706f 7274  from uuid import
-00005400: 2055 5549 440a 0a0a 6173 7365 7274 2069   UUID...assert i
-00005410: 7369 6e73 7461 6e63 6528 6576 656e 7431  sinstance(event1
-00005420: 2e69 642c 2055 5549 4429 0a61 7373 6572  .id, UUID).asser
-00005430: 7420 6973 696e 7374 616e 6365 2865 7665  t isinstance(eve
-00005440: 6e74 322e 6964 2c20 5555 4944 290a 6173  nt2.id, UUID).as
-00005450: 7365 7274 2069 7369 6e73 7461 6e63 6528  sert isinstance(
-00005460: 6576 656e 7433 2e69 642c 2055 5549 4429  event3.id, UUID)
-00005470: 0a0a 6173 7365 7274 2065 7665 6e74 312e  ..assert event1.
-00005480: 6964 2021 3d20 6576 656e 7432 2e69 640a  id != event2.id.
-00005490: 6173 7365 7274 2065 7665 6e74 322e 6964  assert event2.id
-000054a0: 2021 3d20 6576 656e 7433 2e69 640a 0a61   != event3.id..a
-000054b0: 7373 6572 7420 6576 656e 7473 5b30 5d2e  ssert events[0].
-000054c0: 6964 203d 3d20 6576 656e 7431 2e69 640a  id == event1.id.
-000054d0: 6173 7365 7274 2065 7665 6e74 735b 315d  assert events[1]
-000054e0: 2e69 6420 3d3d 2065 7665 6e74 322e 6964  .id == event2.id
-000054f0: 0a61 7373 6572 7420 6576 656e 7473 5b32  .assert events[2
-00005500: 5d2e 6964 203d 3d20 6576 656e 7433 2e69  ].id == event3.i
-00005510: 640a 6060 600a 0a49 7420 6973 2070 6f73  d.```..It is pos
-00005520: 7369 626c 6520 746f 2073 6574 2074 6865  sible to set the
-00005530: 2060 6964 6020 636f 6e73 7472 7563 746f   `id` constructo
-00005540: 7220 6172 6775 6d65 6e74 206f 6620 604e  r argument of `N
-00005550: 6577 4576 656e 7460 2077 6865 6e20 696e  ewEvent` when in
-00005560: 7374 616e 7469 6174 696e 670a 7468 6520  stantiating.the 
-00005570: 604e 6577 4576 656e 7460 2063 6c61 7373  `NewEvent` class
-00005580: 2c20 6275 7420 696e 2074 6865 2065 7861  , but in the exa
-00005590: 6d70 6c65 7320 6162 6f76 6520 7765 2068  mples above we h
-000055a0: 6176 6520 6265 656e 2075 7369 6e67 2074  ave been using t
-000055b0: 6865 2064 6566 6175 6c74 0a62 6568 6176  he default.behav
-000055c0: 696f 7572 2c20 7768 6963 6820 6973 2074  iour, which is t
-000055d0: 6861 7420 7468 6520 6069 6460 2076 616c  hat the `id` val
-000055e0: 7565 2069 7320 6765 6e65 7261 7465 6420  ue is generated 
-000055f0: 7768 656e 2074 6865 2060 4e65 7745 7665  when the `NewEve
-00005600: 6e74 6020 636c 6173 7320 6973 0a69 6e73  nt` class is.ins
-00005610: 7461 6e74 6961 7465 642e 0a0a 0a23 2323  tantiated....###
-00005620: 2052 6561 6420 7374 7265 616d 2065 7665   Read stream eve
-00005630: 6e74 730a 0a54 6865 2060 7265 6164 5f73  nts..The `read_s
-00005640: 7472 6561 6d5f 6576 656e 7473 2829 6020  tream_events()` 
-00005650: 6d65 7468 6f64 2063 616e 2062 6520 7573  method can be us
-00005660: 6564 2074 6f20 6f62 7461 696e 2074 6865  ed to obtain the
-00005670: 2072 6563 6f72 6465 6420 6576 656e 7473   recorded events
-00005680: 2069 6e20 610a 7374 7265 616d 2e20 4974   in a.stream. It
-00005690: 2072 6574 7572 6e73 2061 2073 6571 7565   returns a seque
-000056a0: 6e63 6520 6f66 2072 6563 6f72 6465 6420  nce of recorded 
-000056b0: 6576 656e 7473 206f 626a 6563 7473 2e20  events objects. 
-000056c0: 5468 6520 7265 6365 6976 6564 2072 6563  The received rec
-000056d0: 6f72 6465 6420 6576 656e 740a 6f62 6a65  orded event.obje
-000056e0: 6374 2061 7265 2069 6e73 7461 6e63 6573  ct are instances
-000056f0: 206f 6620 7468 6520 6052 6563 6f72 6465   of the `Recorde
-00005700: 6445 7665 6e74 6020 636c 6173 7320 2873  dEvent` class (s
-00005710: 6565 2062 656c 6f77 292e 0a0a 5468 6973  ee below)...This
-00005720: 206d 6574 686f 6420 6861 7320 6f6e 6520   method has one 
-00005730: 7265 7175 6972 6564 2061 7267 756d 656e  required argumen
-00005740: 742c 2060 7374 7265 616d 5f6e 616d 6560  t, `stream_name`
-00005750: 2c20 7768 6963 6820 6973 2074 6865 206e  , which is the n
-00005760: 616d 6520 6f66 0a74 6865 2073 7472 6561  ame of.the strea
-00005770: 6d20 6672 6f6d 2077 6869 6368 2074 6f20  m from which to 
-00005780: 7265 6164 2065 7665 6e74 732e 2042 7920  read events. By 
-00005790: 6465 6661 756c 742c 2074 6865 2072 6563  default, the rec
-000057a0: 6f72 6465 6420 6576 656e 7473 2069 6e20  orded events in 
-000057b0: 7468 650a 7374 7265 616d 2061 7265 2072  the.stream are r
-000057c0: 6574 7572 6e65 6420 696e 2074 6865 206f  eturned in the o
-000057d0: 7264 6572 2074 6865 7920 7765 7265 2072  rder they were r
-000057e0: 6563 6f72 6465 642e 0a0a 5468 6520 6d65  ecorded...The me
-000057f0: 7468 6f64 2060 7265 6164 5f73 7472 6561  thod `read_strea
-00005800: 6d5f 6576 656e 7473 2829 6020 616c 736f  m_events()` also
-00005810: 2073 7570 706f 7274 7320 666f 7572 206f   supports four o
-00005820: 7074 696f 6e61 6c20 6172 6775 6d65 6e74  ptional argument
-00005830: 732c 0a60 7374 7265 616d 5f70 6f73 6974  s,.`stream_posit
-00005840: 696f 6e60 2c20 6062 6163 6b77 6172 6473  ion`, `backwards
-00005850: 602c 2060 6c69 6d69 7460 2c20 616e 6420  `, `limit`, and 
-00005860: 6074 696d 656f 7574 602e 0a0a 5468 6520  `timeout`...The 
-00005870: 6f70 7469 6f6e 616c 2060 7374 7265 616d  optional `stream
-00005880: 5f70 6f73 6974 696f 6e60 2061 7267 756d  _position` argum
-00005890: 656e 7420 6973 2061 6e20 6f70 7469 6f6e  ent is an option
-000058a0: 616c 2069 6e74 6567 6572 2074 6861 7420  al integer that 
-000058b0: 6361 6e20 6265 2075 7365 6420 746f 0a69  can be used to.i
-000058c0: 6e64 6963 6174 6520 7468 6520 706f 7369  ndicate the posi
-000058d0: 7469 6f6e 2069 6e20 7468 6520 7374 7265  tion in the stre
-000058e0: 616d 2066 726f 6d20 7768 6963 6820 746f  am from which to
-000058f0: 2073 7461 7274 2072 6561 6469 6e67 2e20   start reading. 
-00005900: 5468 6973 2061 7267 756d 656e 7420 6973  This argument is
-00005910: 0a60 4e6f 6e65 6020 6279 2064 6566 6175  .`None` by defau
-00005920: 6c74 2c20 7768 6963 6820 6d65 616e 7320  lt, which means 
-00005930: 7468 6520 7374 7265 616d 2077 696c 6c20  the stream will 
-00005940: 6265 2072 6561 6420 6569 7468 6572 2066  be read either f
-00005950: 726f 6d20 7468 6520 7374 6172 7420 6f66  rom the start of
-00005960: 2074 6865 0a73 7472 6561 6d20 2874 6865   the.stream (the
-00005970: 2064 6566 6175 6c74 2062 6568 6176 696f   default behavio
-00005980: 7572 292c 206f 7220 6672 6f6d 2074 6865  ur), or from the
-00005990: 2065 6e64 206f 6620 7468 6520 7374 7265   end of the stre
-000059a0: 616d 2069 6620 6062 6163 6b77 6172 6473  am if `backwards
-000059b0: 6020 6973 0a60 5472 7565 6020 2873 6565  ` is.`True` (see
-000059c0: 2062 656c 6f77 292e 2057 6865 6e20 7265   below). When re
-000059d0: 6164 696e 6720 6120 7374 7265 616d 2066  ading a stream f
-000059e0: 726f 6d20 6120 7370 6563 6966 6963 2070  rom a specific p
-000059f0: 6f73 6974 696f 6e20 696e 2074 6865 2073  osition in the s
-00005a00: 7472 6561 6d2c 2074 6865 0a72 6563 6f72  tream, the.recor
-00005a10: 6465 6420 6576 656e 7420 6174 2074 6861  ded event at tha
-00005a20: 7420 706f 7369 7469 6f6e 2077 696c 6c20  t position will 
-00005a30: 6265 2069 6e63 6c75 6465 642c 2062 6f74  be included, bot
-00005a40: 6820 7768 656e 2072 6561 6469 6e67 2066  h when reading f
-00005a50: 6f72 7761 7264 730a 6672 6f6d 2074 6861  orwards.from tha
-00005a60: 7420 706f 7369 7469 6f6e 2c20 616e 6420  t position, and 
-00005a70: 7768 656e 2072 6561 6469 6e67 2062 6163  when reading bac
-00005a80: 6b77 6172 6473 2066 726f 6d20 7468 6174  kwards from that
-00005a90: 2070 6f73 6974 696f 6e2e 0a0a 5468 6520   position...The 
-00005aa0: 6f70 7469 6f6e 616c 2060 6261 636b 7761  optional `backwa
-00005ab0: 7264 7360 2061 7267 756d 656e 7420 6973  rds` argument is
-00005ac0: 2061 2062 6f6f 6c65 616e 2c20 6279 2064   a boolean, by d
-00005ad0: 6566 6175 6c74 2060 4661 6c73 6560 2c20  efault `False`, 
-00005ae0: 7768 6963 6820 6d65 616e 7320 7468 650a  which means the.
-00005af0: 7374 7265 616d 2077 696c 6c20 6265 2072  stream will be r
-00005b00: 6561 6420 666f 7277 6172 6473 2062 7920  ead forwards by 
-00005b10: 6465 6661 756c 742c 2073 6f20 7468 6174  default, so that
-00005b20: 2065 7665 6e74 7320 6172 6520 7265 7475   events are retu
-00005b30: 726e 6564 2069 6e20 7468 650a 6f72 6465  rned in the.orde
-00005b40: 7220 7468 6579 2077 6572 6520 6170 7065  r they were appe
-00005b50: 6e64 6564 2c20 4966 2060 6261 636b 7761  nded, If `backwa
-00005b60: 7264 7360 2069 7320 6054 7275 6560 2c20  rds` is `True`, 
-00005b70: 7468 6520 7374 7265 616d 2077 696c 6c20  the stream will 
-00005b80: 6265 2072 6561 640a 6261 636b 7761 7264  be read.backward
-00005b90: 732c 2073 6f20 7468 6174 2065 7665 6e74  s, so that event
-00005ba0: 7320 6172 6520 7265 7475 726e 6564 2069  s are returned i
-00005bb0: 6e20 7265 7665 7273 6520 6f72 6465 722e  n reverse order.
-00005bc0: 0a0a 5468 6520 6f70 7469 6f6e 616c 2060  ..The optional `
-00005bd0: 6c69 6d69 7460 2061 7267 756d 656e 7420  limit` argument 
-00005be0: 6973 2061 6e20 696e 7465 6765 7220 7768  is an integer wh
-00005bf0: 6963 6820 6c69 6d69 7473 2074 6865 206e  ich limits the n
-00005c00: 756d 6265 7220 6f66 2065 7665 6e74 7320  umber of events 
-00005c10: 7468 6174 2077 696c 6c0a 6265 2072 6574  that will.be ret
-00005c20: 7572 6e65 642e 2054 6865 2064 6566 6175  urned. The defau
-00005c30: 6c74 2076 616c 7565 2069 7320 6073 7973  lt value is `sys
-00005c40: 2e6d 6178 696e 7460 2e0a 0a54 6865 206f  .maxint`...The o
-00005c50: 7074 696f 6e61 6c20 6074 696d 656f 7574  ptional `timeout
-00005c60: 6020 6172 6775 6d65 6e74 2069 7320 6120  ` argument is a 
-00005c70: 5079 7468 6f6e 2060 666c 6f61 7460 2077  Python `float` w
-00005c80: 6869 6368 2073 6574 7320 6120 6465 6164  hich sets a dead
-00005c90: 6c69 6e65 2066 6f72 0a74 6865 2063 6f6d  line for.the com
-00005ca0: 706c 6574 696f 6e20 6f66 2074 6865 2067  pletion of the g
-00005cb0: 5250 4320 6f70 6572 6174 696f 6e2e 0a0a  RPC operation...
-00005cc0: 5468 6520 6578 616d 706c 6520 6265 6c6f  The example belo
-00005cd0: 7720 7368 6f77 7320 686f 7720 746f 2072  w shows how to r
-00005ce0: 6561 6420 7468 6520 7265 636f 7264 6564  ead the recorded
-00005cf0: 2065 7665 6e74 7320 6f66 2061 2073 7472   events of a str
-00005d00: 6561 6d0a 666f 7277 6172 6473 2066 726f  eam.forwards fro
-00005d10: 6d20 7468 6520 7374 6172 7420 6f66 2074  m the start of t
-00005d20: 6865 2073 7472 6561 6d20 746f 2074 6865  he stream to the
-00005d30: 2065 6e64 206f 6620 7468 6520 7374 7265   end of the stre
-00005d40: 616d 2e20 5468 650a 6e61 6d65 206f 6620  am. The.name of 
-00005d50: 6120 7374 7265 616d 2069 7320 6769 7665  a stream is give
-00005d60: 6e20 7768 656e 2063 616c 6c69 6e67 2074  n when calling t
-00005d70: 6865 206d 6574 686f 642e 0a0a 6060 6070  he method...```p
-00005d80: 7974 686f 6e0a 6576 656e 7473 203d 2063  ython.events = c
-00005d90: 6c69 656e 742e 7265 6164 5f73 7472 6561  lient.read_strea
-00005da0: 6d5f 6576 656e 7473 280a 2020 2020 7374  m_events(.    st
-00005db0: 7265 616d 5f6e 616d 653d 7374 7265 616d  ream_name=stream
-00005dc0: 5f6e 616d 6531 0a29 0a60 6060 0a0a 4e6f  _name1.).```..No
-00005dd0: 7720 7468 6174 2077 6520 6861 7665 2061  w that we have a
-00005de0: 2073 6571 7565 6e63 6520 6f66 2065 7665   sequence of eve
-00005df0: 6e74 206f 626a 6563 7473 2c20 7765 2063  nt objects, we c
-00005e00: 616e 2063 6865 636b 2077 6520 676f 7420  an check we got 
-00005e10: 7468 650a 7468 7265 6520 6576 656e 7473  the.three events
-00005e20: 2074 6861 7420 7765 7265 2061 7070 656e   that were appen
-00005e30: 6465 6420 746f 2074 6865 2073 7472 6561  ded to the strea
-00005e40: 6d2c 2061 6e64 2074 6861 7420 7468 6579  m, and that they
-00005e50: 2061 7265 0a6f 7264 6572 6564 2065 7861   are.ordered exa
-00005e60: 6374 6c79 2061 7320 7468 6579 2077 6572  ctly as they wer
-00005e70: 6520 6170 7065 6e64 6564 2e0a 0a60 6060  e appended...```
-00005e80: 7079 7468 6f6e 0a61 7373 6572 7420 6c65  python.assert le
-00005e90: 6e28 6576 656e 7473 2920 3d3d 2033 0a0a  n(events) == 3..
-00005ea0: 6173 7365 7274 2065 7665 6e74 735b 305d  assert events[0]
-00005eb0: 2e73 7472 6561 6d5f 6e61 6d65 203d 3d20  .stream_name == 
-00005ec0: 7374 7265 616d 5f6e 616d 6531 0a61 7373  stream_name1.ass
-00005ed0: 6572 7420 6576 656e 7473 5b30 5d2e 7374  ert events[0].st
-00005ee0: 7265 616d 5f70 6f73 6974 696f 6e20 3d3d  ream_position ==
-00005ef0: 2030 0a61 7373 6572 7420 6576 656e 7473   0.assert events
-00005f00: 5b30 5d2e 7479 7065 203d 3d20 6576 656e  [0].type == even
-00005f10: 7431 2e74 7970 650a 6173 7365 7274 2065  t1.type.assert e
-00005f20: 7665 6e74 735b 305d 2e64 6174 6120 3d3d  vents[0].data ==
-00005f30: 2065 7665 6e74 312e 6461 7461 0a0a 6173   event1.data..as
-00005f40: 7365 7274 2065 7665 6e74 735b 315d 2e73  sert events[1].s
-00005f50: 7472 6561 6d5f 6e61 6d65 203d 3d20 7374  tream_name == st
-00005f60: 7265 616d 5f6e 616d 6531 0a61 7373 6572  ream_name1.asser
-00005f70: 7420 6576 656e 7473 5b31 5d2e 7374 7265  t events[1].stre
-00005f80: 616d 5f70 6f73 6974 696f 6e20 3d3d 2031  am_position == 1
-00005f90: 0a61 7373 6572 7420 6576 656e 7473 5b31  .assert events[1
-00005fa0: 5d2e 7479 7065 203d 3d20 6576 656e 7432  ].type == event2
-00005fb0: 2e74 7970 650a 6173 7365 7274 2065 7665  .type.assert eve
-00005fc0: 6e74 735b 315d 2e64 6174 6120 3d3d 2065  nts[1].data == e
-00005fd0: 7665 6e74 322e 6461 7461 0a0a 6173 7365  vent2.data..asse
-00005fe0: 7274 2065 7665 6e74 735b 325d 2e73 7472  rt events[2].str
-00005ff0: 6561 6d5f 6e61 6d65 203d 3d20 7374 7265  eam_name == stre
-00006000: 616d 5f6e 616d 6531 0a61 7373 6572 7420  am_name1.assert 
-00006010: 6576 656e 7473 5b32 5d2e 7374 7265 616d  events[2].stream
-00006020: 5f70 6f73 6974 696f 6e20 3d3d 2032 0a61  _position == 2.a
-00006030: 7373 6572 7420 6576 656e 7473 5b32 5d2e  ssert events[2].
-00006040: 7479 7065 203d 3d20 6576 656e 7433 2e74  type == event3.t
-00006050: 7970 650a 6173 7365 7274 2065 7665 6e74  ype.assert event
-00006060: 735b 325d 2e64 6174 6120 3d3d 2065 7665  s[2].data == eve
-00006070: 6e74 332e 6461 7461 0a60 6060 0a0a 5468  nt3.data.```..Th
-00006080: 6520 6578 616d 706c 6520 6265 6c6f 7720  e example below 
-00006090: 7368 6f77 7320 686f 7720 746f 2072 6561  shows how to rea
-000060a0: 6420 7265 636f 7264 6564 2065 7665 6e74  d recorded event
-000060b0: 7320 696e 2061 2073 7472 6561 6d20 666f  s in a stream fo
-000060c0: 7277 6172 6473 2066 726f 6d0a 6120 7370  rwards from.a sp
-000060d0: 6563 6966 6963 2073 7472 6561 6d20 706f  ecific stream po
-000060e0: 7369 7469 6f6e 2074 6f20 7468 6520 656e  sition to the en
-000060f0: 6420 6f66 2074 6865 2073 7472 6561 6d2e  d of the stream.
-00006100: 0a0a 6060 6070 7974 686f 6e0a 6576 656e  ..```python.even
-00006110: 7473 203d 2063 6c69 656e 742e 7265 6164  ts = client.read
-00006120: 5f73 7472 6561 6d5f 6576 656e 7473 280a  _stream_events(.
-00006130: 2020 2020 7374 7265 616d 5f6e 616d 653d      stream_name=
-00006140: 7374 7265 616d 5f6e 616d 6531 2c0a 2020  stream_name1,.  
-00006150: 2020 7374 7265 616d 5f70 6f73 6974 696f    stream_positio
-00006160: 6e3d 312c 0a29 0a0a 6173 7365 7274 206c  n=1,.)..assert l
-00006170: 656e 2865 7665 6e74 7329 203d 3d20 320a  en(events) == 2.
-00006180: 0a61 7373 6572 7420 6576 656e 7473 5b30  .assert events[0
-00006190: 5d2e 7374 7265 616d 5f6e 616d 6520 3d3d  ].stream_name ==
-000061a0: 2073 7472 6561 6d5f 6e61 6d65 310a 6173   stream_name1.as
-000061b0: 7365 7274 2065 7665 6e74 735b 305d 2e73  sert events[0].s
-000061c0: 7472 6561 6d5f 706f 7369 7469 6f6e 203d  tream_position =
-000061d0: 3d20 310a 6173 7365 7274 2065 7665 6e74  = 1.assert event
-000061e0: 735b 305d 2e74 7970 6520 3d3d 2065 7665  s[0].type == eve
-000061f0: 6e74 322e 7479 7065 0a61 7373 6572 7420  nt2.type.assert 
-00006200: 6576 656e 7473 5b30 5d2e 6461 7461 203d  events[0].data =
-00006210: 3d20 6576 656e 7432 2e64 6174 610a 0a61  = event2.data..a
-00006220: 7373 6572 7420 6576 656e 7473 5b31 5d2e  ssert events[1].
-00006230: 7374 7265 616d 5f6e 616d 6520 3d3d 2073  stream_name == s
-00006240: 7472 6561 6d5f 6e61 6d65 310a 6173 7365  tream_name1.asse
-00006250: 7274 2065 7665 6e74 735b 315d 2e73 7472  rt events[1].str
-00006260: 6561 6d5f 706f 7369 7469 6f6e 203d 3d20  eam_position == 
-00006270: 320a 6173 7365 7274 2065 7665 6e74 735b  2.assert events[
-00006280: 315d 2e74 7970 6520 3d3d 2065 7665 6e74  1].type == event
-00006290: 332e 7479 7065 0a61 7373 6572 7420 6576  3.type.assert ev
-000062a0: 656e 7473 5b31 5d2e 6461 7461 203d 3d20  ents[1].data == 
-000062b0: 6576 656e 7433 2e64 6174 610a 6060 600a  event3.data.```.
-000062c0: 0a54 6865 2065 7861 6d70 6c65 2062 656c  .The example bel
-000062d0: 6f77 2073 686f 7773 2068 6f77 2074 6f20  ow shows how to 
-000062e0: 7265 6164 2074 6865 2072 6563 6f72 6465  read the recorde
-000062f0: 6420 6576 656e 7473 2069 6e20 6120 7374  d events in a st
-00006300: 7265 616d 2062 6163 6b77 6172 6473 2066  ream backwards f
-00006310: 726f 6d0a 7468 6520 656e 6420 6f66 2074  rom.the end of t
-00006320: 6865 2073 7472 6561 6d20 746f 2074 6865  he stream to the
-00006330: 2073 7461 7274 206f 6620 7468 6520 7374   start of the st
-00006340: 7265 616d 2e0a 0a60 6060 7079 7468 6f6e  ream...```python
-00006350: 0a65 7665 6e74 7320 3d20 636c 6965 6e74  .events = client
-00006360: 2e72 6561 645f 7374 7265 616d 5f65 7665  .read_stream_eve
-00006370: 6e74 7328 0a20 2020 2073 7472 6561 6d5f  nts(.    stream_
-00006380: 6e61 6d65 3d73 7472 6561 6d5f 6e61 6d65  name=stream_name
-00006390: 312c 0a20 2020 2062 6163 6b77 6172 6473  1,.    backwards
-000063a0: 3d54 7275 652c 0a29 0a0a 6173 7365 7274  =True,.)..assert
-000063b0: 206c 656e 2865 7665 6e74 7329 203d 3d20   len(events) == 
-000063c0: 330a 0a61 7373 6572 7420 6576 656e 7473  3..assert events
-000063d0: 5b30 5d2e 7374 7265 616d 5f6e 616d 6520  [0].stream_name 
-000063e0: 3d3d 2073 7472 6561 6d5f 6e61 6d65 310a  == stream_name1.
-000063f0: 6173 7365 7274 2065 7665 6e74 735b 305d  assert events[0]
-00006400: 2e73 7472 6561 6d5f 706f 7369 7469 6f6e  .stream_position
-00006410: 203d 3d20 320a 6173 7365 7274 2065 7665   == 2.assert eve
-00006420: 6e74 735b 305d 2e74 7970 6520 3d3d 2065  nts[0].type == e
-00006430: 7665 6e74 332e 7479 7065 0a61 7373 6572  vent3.type.asser
-00006440: 7420 6576 656e 7473 5b30 5d2e 6461 7461  t events[0].data
-00006450: 203d 3d20 6576 656e 7433 2e64 6174 610a   == event3.data.
-00006460: 0a61 7373 6572 7420 6576 656e 7473 5b31  .assert events[1
-00006470: 5d2e 7374 7265 616d 5f6e 616d 6520 3d3d  ].stream_name ==
-00006480: 2073 7472 6561 6d5f 6e61 6d65 310a 6173   stream_name1.as
-00006490: 7365 7274 2065 7665 6e74 735b 315d 2e73  sert events[1].s
-000064a0: 7472 6561 6d5f 706f 7369 7469 6f6e 203d  tream_position =
-000064b0: 3d20 310a 6173 7365 7274 2065 7665 6e74  = 1.assert event
-000064c0: 735b 315d 2e74 7970 6520 3d3d 2065 7665  s[1].type == eve
-000064d0: 6e74 322e 7479 7065 0a61 7373 6572 7420  nt2.type.assert 
-000064e0: 6576 656e 7473 5b31 5d2e 6461 7461 203d  events[1].data =
-000064f0: 3d20 6576 656e 7432 2e64 6174 610a 6060  = event2.data.``
-00006500: 600a 0a54 6865 2065 7861 6d70 6c65 2062  `..The example b
-00006510: 656c 6f77 2073 686f 7773 2068 6f77 2074  elow shows how t
-00006520: 6f20 7265 6164 2061 206c 696d 6974 6564  o read a limited
-00006530: 206e 756d 6265 7220 2874 776f 2920 6f66   number (two) of
-00006540: 2074 6865 2072 6563 6f72 6465 6420 6576   the recorded ev
-00006550: 656e 7473 0a69 6e20 6120 7374 7265 616d  ents.in a stream
-00006560: 2066 6f72 7761 7264 7320 6672 6f6d 2074   forwards from t
-00006570: 6865 2073 7461 7274 206f 6620 7468 6520  he start of the 
-00006580: 7374 7265 616d 2e0a 0a60 6060 7079 7468  stream...```pyth
-00006590: 6f6e 0a65 7665 6e74 7320 3d20 636c 6965  on.events = clie
-000065a0: 6e74 2e72 6561 645f 7374 7265 616d 5f65  nt.read_stream_e
-000065b0: 7665 6e74 7328 0a20 2020 2073 7472 6561  vents(.    strea
-000065c0: 6d5f 6e61 6d65 3d73 7472 6561 6d5f 6e61  m_name=stream_na
-000065d0: 6d65 312c 0a20 2020 206c 696d 6974 3d32  me1,.    limit=2
-000065e0: 2c0a 290a 0a61 7373 6572 7420 6c65 6e28  ,.)..assert len(
-000065f0: 6576 656e 7473 2920 3d3d 2032 0a0a 6173  events) == 2..as
-00006600: 7365 7274 2065 7665 6e74 735b 305d 2e73  sert events[0].s
-00006610: 7472 6561 6d5f 6e61 6d65 203d 3d20 7374  tream_name == st
-00006620: 7265 616d 5f6e 616d 6531 0a61 7373 6572  ream_name1.asser
-00006630: 7420 6576 656e 7473 5b30 5d2e 7374 7265  t events[0].stre
-00006640: 616d 5f70 6f73 6974 696f 6e20 3d3d 2030  am_position == 0
-00006650: 0a61 7373 6572 7420 6576 656e 7473 5b30  .assert events[0
-00006660: 5d2e 7479 7065 203d 3d20 6576 656e 7431  ].type == event1
-00006670: 2e74 7970 650a 6173 7365 7274 2065 7665  .type.assert eve
-00006680: 6e74 735b 305d 2e64 6174 6120 3d3d 2065  nts[0].data == e
-00006690: 7665 6e74 312e 6461 7461 0a0a 6173 7365  vent1.data..asse
-000066a0: 7274 2065 7665 6e74 735b 315d 2e73 7472  rt events[1].str
-000066b0: 6561 6d5f 6e61 6d65 203d 3d20 7374 7265  eam_name == stre
-000066c0: 616d 5f6e 616d 6531 0a61 7373 6572 7420  am_name1.assert 
-000066d0: 6576 656e 7473 5b31 5d2e 7374 7265 616d  events[1].stream
-000066e0: 5f70 6f73 6974 696f 6e20 3d3d 2031 0a61  _position == 1.a
-000066f0: 7373 6572 7420 6576 656e 7473 5b31 5d2e  ssert events[1].
-00006700: 7479 7065 203d 3d20 6576 656e 7432 2e74  type == event2.t
-00006710: 7970 650a 6173 7365 7274 2065 7665 6e74  ype.assert event
-00006720: 735b 315d 2e64 6174 6120 3d3d 2065 7665  s[1].data == eve
-00006730: 6e74 322e 6461 7461 0a60 6060 0a0a 5468  nt2.data.```..Th
-00006740: 6520 6578 616d 706c 6520 6265 6c6f 7720  e example below 
-00006750: 7368 6f77 7320 686f 7720 746f 2072 6561  shows how to rea
-00006760: 6420 6120 6c69 6d69 7465 6420 6e75 6d62  d a limited numb
-00006770: 6572 2028 6f6e 6529 206f 6620 7468 6520  er (one) of the 
-00006780: 7265 636f 7264 6564 0a65 7665 6e74 7320  recorded.events 
-00006790: 696e 2061 2073 7472 6561 6d20 6261 636b  in a stream back
-000067a0: 7761 7264 7320 6672 6f6d 2061 2067 6976  wards from a giv
-000067b0: 656e 2073 7472 6561 6d20 706f 7369 7469  en stream positi
-000067c0: 6f6e 2e0a 0a60 6060 7079 7468 6f6e 0a65  on...```python.e
-000067d0: 7665 6e74 7320 3d20 636c 6965 6e74 2e72  vents = client.r
-000067e0: 6561 645f 7374 7265 616d 5f65 7665 6e74  ead_stream_event
-000067f0: 7328 0a20 2020 2073 7472 6561 6d5f 6e61  s(.    stream_na
-00006800: 6d65 3d73 7472 6561 6d5f 6e61 6d65 312c  me=stream_name1,
-00006810: 0a20 2020 2073 7472 6561 6d5f 706f 7369  .    stream_posi
-00006820: 7469 6f6e 3d32 2c0a 2020 2020 6261 636b  tion=2,.    back
-00006830: 7761 7264 733d 5472 7565 2c0a 2020 2020  wards=True,.    
-00006840: 6c69 6d69 743d 312c 0a29 0a0a 6173 7365  limit=1,.)..asse
-00006850: 7274 206c 656e 2865 7665 6e74 7329 203d  rt len(events) =
-00006860: 3d20 310a 0a61 7373 6572 7420 6576 656e  = 1..assert even
-00006870: 7473 5b30 5d2e 7374 7265 616d 5f6e 616d  ts[0].stream_nam
-00006880: 6520 3d3d 2073 7472 6561 6d5f 6e61 6d65  e == stream_name
-00006890: 310a 6173 7365 7274 2065 7665 6e74 735b  1.assert events[
-000068a0: 305d 2e73 7472 6561 6d5f 706f 7369 7469  0].stream_positi
-000068b0: 6f6e 203d 3d20 320a 6173 7365 7274 2065  on == 2.assert e
-000068c0: 7665 6e74 735b 305d 2e74 7970 6520 3d3d  vents[0].type ==
-000068d0: 2065 7665 6e74 332e 7479 7065 0a61 7373   event3.type.ass
-000068e0: 6572 7420 6576 656e 7473 5b30 5d2e 6461  ert events[0].da
-000068f0: 7461 203d 3d20 6576 656e 7433 2e64 6174  ta == event3.dat
-00006900: 610a 6060 600a 0a23 2323 2052 6561 6420  a.```..### Read 
-00006910: 616c 6c20 6576 656e 7473 0a0a 5468 6520  all events..The 
-00006920: 6d65 7468 6f64 2060 7265 6164 5f61 6c6c  method `read_all
-00006930: 5f65 7665 6e74 7328 2960 2063 616e 2062  _events()` can b
-00006940: 6520 7573 6564 2074 6f20 7265 6164 2061  e used to read a
-00006950: 6c6c 2072 6563 6f72 6465 6420 6576 656e  ll recorded even
-00006960: 7473 0a69 6e20 7468 6520 6461 7461 6261  ts.in the databa
-00006970: 7365 2069 6e20 7468 6520 6f72 6465 7220  se in the order 
-00006980: 7468 6579 2077 6572 6520 7265 636f 7264  they were record
-00006990: 6564 2e20 4974 2072 6574 7572 6e73 2061  ed. It returns a
-000069a0: 6e20 6974 6572 6162 6c65 206f 660a 6576  n iterable of.ev
-000069b0: 656e 7473 2074 6861 7420 6861 7665 2062  ents that have b
-000069c0: 6565 6e20 7265 636f 7264 6564 2069 6e20  een recorded in 
-000069d0: 7468 6520 6461 7461 6261 7365 2e20 4974  the database. It
-000069e0: 6572 6174 696e 6720 6f76 6572 2074 6869  erating over thi
-000069f0: 7320 6974 6572 6162 6c65 0a6f 626a 6563  s iterable.objec
-00006a00: 7420 7769 6c6c 2073 746f 7020 7768 656e  t will stop when
-00006a10: 2069 7420 6861 7320 7969 656c 6465 6420   it has yielded 
-00006a20: 7468 6520 6c61 7374 2072 6563 6f72 6465  the last recorde
-00006a30: 6420 6576 656e 742e 2054 6865 2072 6563  d event. The rec
-00006a40: 6569 7665 640a 7265 636f 7264 6564 2065  eived.recorded e
-00006a50: 7665 6e74 206f 626a 6563 7420 6172 6520  vent object are 
-00006a60: 696e 7374 616e 6365 7320 6f66 2074 6865  instances of the
-00006a70: 2060 5265 636f 7264 6564 4576 656e 7460   `RecordedEvent`
-00006a80: 2063 6c61 7373 2028 7365 6520 6265 6c6f   class (see belo
-00006a90: 7729 2e0a 0a54 6869 7320 6d65 7468 6f64  w)...This method
-00006aa0: 2073 7570 706f 7274 7320 7365 7665 6e20   supports seven 
-00006ab0: 6f70 7469 6f6e 616c 2061 7267 756d 656e  optional argumen
-00006ac0: 7473 2c20 6063 6f6d 6d69 745f 706f 7369  ts, `commit_posi
-00006ad0: 7469 6f6e 602c 2060 6261 636b 7761 7264  tion`, `backward
-00006ae0: 7360 2c0a 6066 696c 7465 725f 6578 636c  s`,.`filter_excl
-00006af0: 7564 6560 2c20 6066 696c 7465 725f 696e  ude`, `filter_in
-00006b00: 636c 7564 6560 2c20 6066 696c 7465 725f  clude`, `filter_
-00006b10: 6279 5f73 7472 6561 6d5f 6e61 6d65 602c  by_stream_name`,
-00006b20: 2060 6c69 6d69 7460 2c20 616e 6420 6074   `limit`, and `t
-00006b30: 696d 656f 7574 602e 0a0a 5468 6520 6f70  imeout`...The op
-00006b40: 7469 6f6e 616c 2060 636f 6d6d 6974 5f70  tional `commit_p
-00006b50: 6f73 6974 696f 6e60 2061 7267 756d 656e  osition` argumen
-00006b60: 7420 6973 2061 6e20 6f70 7469 6f6e 616c  t is an optional
-00006b70: 2069 6e74 6567 6572 2074 6861 7420 6361   integer that ca
-00006b80: 6e20 6265 2075 7365 6420 746f 0a73 7065  n be used to.spe
-00006b90: 6369 6679 2074 6865 2063 6f6d 6d69 7420  cify the commit 
-00006ba0: 706f 7369 7469 6f6e 2066 726f 6d20 7768  position from wh
-00006bb0: 6963 6820 746f 2073 7461 7274 2072 6561  ich to start rea
-00006bc0: 6469 6e67 2e20 5468 6973 2061 7267 756d  ding. This argum
-00006bd0: 656e 7420 6973 2060 4e6f 6e65 6020 6279  ent is `None` by
-00006be0: 0a64 6566 6175 6c74 2c20 6d65 616e 696e  .default, meanin
-00006bf0: 6720 7468 6174 2061 6c6c 2074 6865 2065  g that all the e
-00006c00: 7665 6e74 7320 7769 6c6c 2062 6520 7265  vents will be re
-00006c10: 6164 2065 6974 6865 7220 6672 6f6d 2074  ad either from t
-00006c20: 6865 2073 7461 7274 2c20 6f72 0a66 726f  he start, or.fro
-00006c30: 6d20 7468 6520 656e 6420 6966 2060 6261  m the end if `ba
-00006c40: 636b 7761 7264 7360 2069 7320 6054 7275  ckwards` is `Tru
-00006c50: 6560 2028 7365 6520 6265 6c6f 7729 2e20  e` (see below). 
-00006c60: 506c 6561 7365 206e 6f74 652c 2069 6620  Please note, if 
-00006c70: 7370 6563 6966 6965 642c 0a74 6865 2073  specified,.the s
-00006c80: 7065 6369 6669 6564 2070 6f73 6974 696f  pecified positio
-00006c90: 6e20 6d75 7374 2062 6520 616e 2061 6374  n must be an act
-00006ca0: 7561 6c6c 7920 6578 6973 7469 6e67 2063  ually existing c
-00006cb0: 6f6d 6d69 7420 706f 7369 7469 6f6e 2c20  ommit position, 
-00006cc0: 6265 6361 7573 650a 616e 7920 6f74 6865  because.any othe
-00006cd0: 7220 6e75 6d62 6572 2077 696c 6c20 7265  r number will re
-00006ce0: 7375 6c74 2069 6e20 6120 7365 7276 6572  sult in a server
-00006cf0: 2065 7272 6f72 2028 6174 206c 6561 7374   error (at least
-00006d00: 2069 6e20 4576 656e 7453 746f 7265 4442   in EventStoreDB
-00006d10: 2076 3231 2e31 3029 2e0a 0a54 6865 206f   v21.10)...The o
-00006d20: 7074 696f 6e61 6c20 6062 6163 6b77 6172  ptional `backwar
-00006d30: 6473 6020 6172 6775 6d65 6e74 2069 7320  ds` argument is 
-00006d40: 6120 626f 6f6c 6561 6e20 7768 6963 6820  a boolean which 
-00006d50: 6973 2062 7920 6465 6661 756c 7420 6046  is by default `F
-00006d60: 616c 7365 6020 6d65 616e 696e 6720 7468  alse` meaning th
-00006d70: 650a 6576 656e 7473 2077 696c 6c20 6265  e.events will be
-00006d80: 2072 6561 6420 666f 7277 6172 6473 2062   read forwards b
-00006d90: 7920 6465 6661 756c 742c 2073 6f20 7468  y default, so th
-00006da0: 6174 2065 7665 6e74 7320 6172 6520 7265  at events are re
-00006db0: 7475 726e 6564 2069 6e20 7468 650a 6f72  turned in the.or
-00006dc0: 6465 7220 7468 6579 2077 6572 6520 636f  der they were co
-00006dd0: 6d6d 6974 7465 642c 2049 6620 6062 6163  mmitted, If `bac
-00006de0: 6b77 6172 6473 6020 6973 2060 5472 7565  kwards` is `True
-00006df0: 602c 2074 6865 2065 7665 6e74 7320 7769  `, the events wi
-00006e00: 6c6c 2062 6520 7265 6164 0a62 6163 6b77  ll be read.backw
-00006e10: 6172 6473 2c20 736f 2074 6861 7420 6576  ards, so that ev
-00006e20: 656e 7473 2061 7265 2072 6574 7572 6e65  ents are returne
-00006e30: 6420 696e 2072 6576 6572 7365 206f 7264  d in reverse ord
-00006e40: 6572 2e0a 0a54 6865 206f 7074 696f 6e61  er...The optiona
-00006e50: 6c20 6066 696c 7465 725f 6578 636c 7564  l `filter_exclud
-00006e60: 6560 2061 7267 756d 656e 7420 6973 2061  e` argument is a
-00006e70: 2073 6571 7565 6e63 6520 6f66 2072 6567   sequence of reg
-00006e80: 756c 6172 2065 7870 7265 7373 696f 6e73  ular expressions
-00006e90: 2074 6861 740a 6d61 7463 6820 7265 636f   that.match reco
-00006ea0: 7264 6564 2065 7665 6e74 7320 7468 6174  rded events that
-00006eb0: 2073 686f 756c 6420 6e6f 7420 6265 2069   should not be i
-00006ec0: 6e63 6c75 6465 642e 2054 6869 7320 6172  ncluded. This ar
-00006ed0: 6775 6d65 6e74 2069 7320 6967 6e6f 7265  gument is ignore
-00006ee0: 640a 6966 2060 6669 6c74 6572 5f69 6e63  d.if `filter_inc
-00006ef0: 6c75 6465 6020 6973 2073 6574 2074 6f20  lude` is set to 
-00006f00: 6120 6e6f 6e2d 656d 7074 7920 7365 7175  a non-empty sequ
-00006f10: 656e 6365 2e20 4279 2064 6566 6175 6c74  ence. By default
-00006f20: 2c20 7468 6973 2061 7267 756d 656e 7420  , this argument 
-00006f30: 6973 2073 6574 0a74 6f20 6d61 7463 6820  is set.to match 
-00006f40: 7468 6520 6576 656e 7420 7479 7065 7320  the event types 
-00006f50: 6f66 2022 7379 7374 656d 2065 7665 6e74  of "system event
-00006f60: 7322 2c20 736f 2074 6861 7420 4576 656e  s", so that Even
-00006f70: 7453 746f 7265 4442 2073 7973 7465 6d20  tStoreDB system 
-00006f80: 6576 656e 7473 0a77 696c 6c20 6e6f 7420  events.will not 
-00006f90: 6e6f 726d 616c 6c79 2062 6520 696e 636c  normally be incl
-00006fa0: 7564 6564 2e20 5365 6520 7468 6520 4e6f  uded. See the No
-00006fb0: 7465 7320 7365 6374 696f 6e20 6265 6c6f  tes section belo
-00006fc0: 7720 666f 7220 6d6f 7265 2069 6e66 6f72  w for more infor
-00006fd0: 6d61 7469 6f6e 0a61 626f 7574 2066 696c  mation.about fil
-00006fe0: 7465 7220 6578 7072 6573 7369 6f6e 732e  ter expressions.
-00006ff0: 0a0a 5468 6520 6f70 7469 6f6e 616c 2060  ..The optional `
-00007000: 6669 6c74 6572 5f69 6e63 6c75 6465 6020  filter_include` 
-00007010: 6172 6775 6d65 6e74 2069 7320 6120 7365  argument is a se
-00007020: 7175 656e 6365 206f 6620 7265 6775 6c61  quence of regula
-00007030: 7220 6578 7072 6573 7369 6f6e 730a 7468  r expressions.th
-00007040: 6174 206d 6174 6368 2072 6563 6f72 6465  at match recorde
-00007050: 6420 6576 656e 7473 2074 6861 7420 7368  d events that sh
-00007060: 6f75 6c64 2062 6520 696e 636c 7564 6564  ould be included
-00007070: 2e20 4279 2064 6566 6175 6c74 2c20 7468  . By default, th
-00007080: 6973 2061 7267 756d 656e 740a 6973 2061  is argument.is a
-00007090: 6e20 656d 7074 7920 7475 706c 652e 2049  n empty tuple. I
-000070a0: 6620 7468 6973 2061 7267 756d 656e 7420  f this argument 
-000070b0: 6973 2073 6574 2074 6f20 6120 6e6f 6e2d  is set to a non-
-000070c0: 656d 7074 7920 7365 7175 656e 6365 2c20  empty sequence, 
-000070d0: 7468 650a 6066 696c 7465 725f 6578 636c  the.`filter_excl
-000070e0: 7564 6560 2061 7267 756d 656e 7420 6973  ude` argument is
-000070f0: 2069 676e 6f72 6564 2e0a 0a54 6865 206f   ignored...The o
-00007100: 7074 696f 6e61 6c20 6066 696c 7465 725f  ptional `filter_
-00007110: 6279 5f73 7472 6561 6d5f 6e61 6d65 6020  by_stream_name` 
-00007120: 6172 6775 6d65 6e74 2069 7320 6120 626f  argument is a bo
-00007130: 6f6c 6561 6e20 7661 6c75 6520 7468 6174  olean value that
-00007140: 2069 6e64 6963 6174 6573 2077 6865 7468   indicates wheth
-00007150: 6572 0a74 6865 2066 696c 7465 7220 7769  er.the filter wi
-00007160: 6c6c 2061 7070 6c79 2074 6f20 6576 656e  ll apply to even
-00007170: 7420 7479 7065 7320 6f72 2073 7472 6561  t types or strea
-00007180: 6d20 6e61 6d65 732e 2042 7920 6465 6661  m names. By defa
-00007190: 756c 742c 2074 6869 7320 7661 6c75 6520  ult, this value 
-000071a0: 6973 2060 4661 6c73 6560 0a61 6e64 2073  is `False`.and s
-000071b0: 6f20 7468 6520 6669 6c74 6572 696e 6720  o the filtering 
-000071c0: 7769 6c6c 2061 7070 6c79 2074 6f20 7468  will apply to th
-000071d0: 6520 6576 656e 7420 7479 7065 2073 7472  e event type str
-000071e0: 696e 6773 206f 6620 7265 636f 7264 6564  ings of recorded
-000071f0: 2065 7665 6e74 732e 0a0a 5468 6520 6f70   events...The op
-00007200: 7469 6f6e 616c 2060 6c69 6d69 7460 2061  tional `limit` a
-00007210: 7267 756d 656e 7420 6973 2061 6e20 696e  rgument is an in
-00007220: 7465 6765 7220 7768 6963 6820 6c69 6d69  teger which limi
-00007230: 7473 2074 6865 206e 756d 6265 7220 6f66  ts the number of
-00007240: 2065 7665 6e74 7320 7468 6174 2077 696c   events that wil
-00007250: 6c0a 6265 2072 6574 7572 6e65 642e 2054  l.be returned. T
-00007260: 6865 2064 6566 6175 6c74 2076 616c 7565  he default value
-00007270: 2069 7320 6073 7973 2e6d 6178 696e 7460   is `sys.maxint`
-00007280: 2e0a 0a54 6865 206f 7074 696f 6e61 6c20  ...The optional 
-00007290: 6074 696d 656f 7574 6020 6172 6775 6d65  `timeout` argume
-000072a0: 6e74 2069 7320 6120 5079 7468 6f6e 2060  nt is a Python `
-000072b0: 666c 6f61 7460 2077 6869 6368 2073 6574  float` which set
-000072c0: 7320 610a 6465 6164 6c69 6e65 2066 6f72  s a.deadline for
-000072d0: 2074 6865 2063 6f6d 706c 6574 696f 6e20   the completion 
-000072e0: 6f66 2074 6865 2067 5250 4320 6f70 6572  of the gRPC oper
-000072f0: 6174 696f 6e2e 0a0a 5468 6520 6669 6c74  ation...The filt
-00007300: 6572 696e 6720 6f66 2065 7665 6e74 7320  ering of events 
-00007310: 6973 2064 6f6e 6520 6f6e 2074 6865 2045  is done on the E
-00007320: 7665 6e74 5374 6f72 6544 4220 7365 7276  ventStoreDB serv
-00007330: 6572 2e20 5468 650a 606c 696d 6974 6020  er. The.`limit` 
-00007340: 6172 6775 6d65 6e74 2069 7320 6170 706c  argument is appl
-00007350: 6965 6420 6f6e 2074 6865 2073 6572 7665  ied on the serve
-00007360: 7220 6166 7465 7220 6669 6c74 6572 696e  r after filterin
-00007370: 672e 2053 6565 2062 656c 6f77 2066 6f72  g. See below for
-00007380: 0a6d 6f72 6520 696e 666f 726d 6174 696f  .more informatio
-00007390: 6e20 6162 6f75 7420 6669 6c74 6572 2072  n about filter r
-000073a0: 6567 756c 6172 2065 7870 7265 7373 696f  egular expressio
-000073b0: 6e73 2e0a 0a57 6865 6e20 7265 6164 696e  ns...When readin
-000073c0: 6720 666f 7277 6172 6473 2066 726f 6d20  g forwards from 
-000073d0: 6120 7370 6563 6966 6963 2063 6f6d 6d69  a specific commi
-000073e0: 7420 706f 7369 7469 6f6e 2c20 7468 6520  t position, the 
-000073f0: 6576 656e 7420 6174 2074 6865 2073 7065  event at the spe
-00007400: 6369 6669 6564 0a70 6f73 6974 696f 6e20  cified.position 
-00007410: 5749 4c4c 2062 6520 696e 636c 7564 6564  WILL be included
-00007420: 2e20 486f 7765 7665 722c 2077 6865 6e20  . However, when 
-00007430: 7265 6164 696e 6720 6261 636b 7761 7264  reading backward
-00007440: 732c 2074 6865 2065 7665 6e74 2061 7420  s, the event at 
-00007450: 7468 650a 7370 6563 6966 6965 6420 706f  the.specified po
-00007460: 7369 7469 6f6e 2077 696c 6c20 4e4f 5420  sition will NOT 
-00007470: 6265 2069 6e63 6c75 6465 642e 2028 5468  be included. (Th
-00007480: 6973 206e 6f6e 2d69 6e63 6c75 7369 7665  is non-inclusive
-00007490: 2062 6568 6176 696f 7572 2c20 6f66 2065   behaviour, of e
-000074a0: 7863 6c75 6469 6e67 0a74 6865 2073 7065  xcluding.the spe
-000074b0: 6369 6669 6564 2063 6f6d 6d69 7420 706f  cified commit po
-000074c0: 7369 7469 6f6e 2077 6865 6e20 7265 6164  sition when read
-000074d0: 696e 6720 616c 6c20 7374 7265 616d 7320  ing all streams 
-000074e0: 6261 636b 7761 7264 732c 2064 6966 6665  backwards, diffe
-000074f0: 7273 2066 726f 6d20 7468 650a 6265 6861  rs from the.beha
-00007500: 7669 6f75 7220 7768 656e 2072 6561 6469  viour when readi
-00007510: 6e67 2061 2073 7472 6561 6d20 6261 636b  ng a stream back
-00007520: 7761 7264 7320 6672 6f6d 2061 2073 7065  wards from a spe
-00007530: 6369 6669 6320 7374 7265 616d 2070 6f73  cific stream pos
-00007540: 6974 696f 6e2e 290a 0a54 6865 2065 7861  ition.)..The exa
-00007550: 6d70 6c65 2062 656c 6f77 2073 686f 7773  mple below shows
-00007560: 2068 6f77 2074 6f20 7265 6164 2061 6c6c   how to read all
-00007570: 2065 7665 6e74 7320 696e 2074 6865 2064   events in the d
-00007580: 6174 6162 6173 6520 696e 2074 6865 0a6f  atabase in the.o
-00007590: 7264 6572 2074 6865 7920 7765 7265 2072  rder they were r
-000075a0: 6563 6f72 6465 642e 0a0a 6060 6070 7974  ecorded...```pyt
-000075b0: 686f 6e0a 6576 656e 7473 203d 206c 6973  hon.events = lis
-000075c0: 7428 636c 6965 6e74 2e72 6561 645f 616c  t(client.read_al
-000075d0: 6c5f 6576 656e 7473 2829 290a 0a61 7373  l_events())..ass
-000075e0: 6572 7420 6c65 6e28 6576 656e 7473 2920  ert len(events) 
-000075f0: 3e3d 2033 0a60 6060 0a0a 5468 6520 6578  >= 3.```..The ex
-00007600: 616d 706c 6520 6265 6c6f 7720 7368 6f77  ample below show
-00007610: 7320 686f 7720 746f 2072 6561 6420 616c  s how to read al
-00007620: 6c20 7265 636f 7264 6564 2065 7665 6e74  l recorded event
-00007630: 7320 6672 6f6d 2061 2073 7065 6369 6669  s from a specifi
-00007640: 6320 636f 6d6d 6974 2070 6f73 6974 696f  c commit positio
-00007650: 6e2e 0a0a 6060 6070 7974 686f 6e0a 6576  n...```python.ev
-00007660: 656e 7473 203d 206c 6973 7428 0a20 2020  ents = list(.   
-00007670: 2063 6c69 656e 742e 7265 6164 5f61 6c6c   client.read_all
-00007680: 5f65 7665 6e74 7328 0a20 2020 2020 2020  _events(.       
-00007690: 2063 6f6d 6d69 745f 706f 7369 7469 6f6e   commit_position
-000076a0: 3d63 6f6d 6d69 745f 706f 7369 7469 6f6e  =commit_position
-000076b0: 310a 2020 2020 290a 290a 0a61 7373 6572  1.    ).)..asser
-000076c0: 7420 6c65 6e28 6576 656e 7473 2920 3d3d  t len(events) ==
-000076d0: 2033 0a0a 6173 7365 7274 2065 7665 6e74   3..assert event
-000076e0: 735b 305d 2e73 7472 6561 6d5f 6e61 6d65  s[0].stream_name
-000076f0: 203d 3d20 7374 7265 616d 5f6e 616d 6531   == stream_name1
-00007700: 0a61 7373 6572 7420 6576 656e 7473 5b30  .assert events[0
-00007710: 5d2e 7374 7265 616d 5f70 6f73 6974 696f  ].stream_positio
-00007720: 6e20 3d3d 2030 0a61 7373 6572 7420 6576  n == 0.assert ev
-00007730: 656e 7473 5b30 5d2e 7479 7065 203d 3d20  ents[0].type == 
-00007740: 6576 656e 7431 2e74 7970 650a 6173 7365  event1.type.asse
-00007750: 7274 2065 7665 6e74 735b 305d 2e64 6174  rt events[0].dat
-00007760: 6120 3d3d 2065 7665 6e74 312e 6461 7461  a == event1.data
-00007770: 0a0a 6173 7365 7274 2065 7665 6e74 735b  ..assert events[
-00007780: 315d 2e73 7472 6561 6d5f 6e61 6d65 203d  1].stream_name =
-00007790: 3d20 7374 7265 616d 5f6e 616d 6531 0a61  = stream_name1.a
-000077a0: 7373 6572 7420 6576 656e 7473 5b31 5d2e  ssert events[1].
-000077b0: 7374 7265 616d 5f70 6f73 6974 696f 6e20  stream_position 
-000077c0: 3d3d 2031 0a61 7373 6572 7420 6576 656e  == 1.assert even
-000077d0: 7473 5b31 5d2e 7479 7065 203d 3d20 6576  ts[1].type == ev
-000077e0: 656e 7432 2e74 7970 650a 6173 7365 7274  ent2.type.assert
-000077f0: 2065 7665 6e74 735b 315d 2e64 6174 6120   events[1].data 
-00007800: 3d3d 2065 7665 6e74 322e 6461 7461 0a0a  == event2.data..
-00007810: 6173 7365 7274 2065 7665 6e74 735b 325d  assert events[2]
-00007820: 2e73 7472 6561 6d5f 6e61 6d65 203d 3d20  .stream_name == 
-00007830: 7374 7265 616d 5f6e 616d 6531 0a61 7373  stream_name1.ass
-00007840: 6572 7420 6576 656e 7473 5b32 5d2e 7374  ert events[2].st
-00007850: 7265 616d 5f70 6f73 6974 696f 6e20 3d3d  ream_position ==
-00007860: 2032 0a61 7373 6572 7420 6576 656e 7473   2.assert events
-00007870: 5b32 5d2e 7479 7065 203d 3d20 6576 656e  [2].type == even
-00007880: 7433 2e74 7970 650a 6173 7365 7274 2065  t3.type.assert e
-00007890: 7665 6e74 735b 325d 2e64 6174 6120 3d3d  vents[2].data ==
-000078a0: 2065 7665 6e74 332e 6461 7461 0a60 6060   event3.data.```
-000078b0: 0a0a 5468 6520 6578 616d 706c 6520 6265  ..The example be
-000078c0: 6c6f 7720 7368 6f77 7320 686f 7720 746f  low shows how to
-000078d0: 2072 6561 6420 616c 6c20 7265 636f 7264   read all record
-000078e0: 6564 2065 7665 6e74 7320 696e 2072 6576  ed events in rev
-000078f0: 6572 7365 206f 7264 6572 2e0a 0a60 6060  erse order...```
-00007900: 7079 7468 6f6e 0a65 7665 6e74 7320 3d20  python.events = 
-00007910: 6c69 7374 280a 2020 2020 636c 6965 6e74  list(.    client
-00007920: 2e72 6561 645f 616c 6c5f 6576 656e 7473  .read_all_events
-00007930: 280a 2020 2020 2020 2020 6261 636b 7761  (.        backwa
-00007940: 7264 733d 5472 7565 0a20 2020 2029 0a29  rds=True.    ).)
-00007950: 0a0a 6173 7365 7274 206c 656e 2865 7665  ..assert len(eve
-00007960: 6e74 7329 203e 3d20 330a 0a61 7373 6572  nts) >= 3..asser
-00007970: 7420 6576 656e 7473 5b30 5d2e 7374 7265  t events[0].stre
-00007980: 616d 5f6e 616d 6520 3d3d 2073 7472 6561  am_name == strea
-00007990: 6d5f 6e61 6d65 310a 6173 7365 7274 2065  m_name1.assert e
-000079a0: 7665 6e74 735b 305d 2e73 7472 6561 6d5f  vents[0].stream_
-000079b0: 706f 7369 7469 6f6e 203d 3d20 320a 6173  position == 2.as
-000079c0: 7365 7274 2065 7665 6e74 735b 305d 2e74  sert events[0].t
-000079d0: 7970 6520 3d3d 2065 7665 6e74 332e 7479  ype == event3.ty
-000079e0: 7065 0a61 7373 6572 7420 6576 656e 7473  pe.assert events
-000079f0: 5b30 5d2e 6461 7461 203d 3d20 6576 656e  [0].data == even
-00007a00: 7433 2e64 6174 610a 0a61 7373 6572 7420  t3.data..assert 
-00007a10: 6576 656e 7473 5b31 5d2e 7374 7265 616d  events[1].stream
-00007a20: 5f6e 616d 6520 3d3d 2073 7472 6561 6d5f  _name == stream_
-00007a30: 6e61 6d65 310a 6173 7365 7274 2065 7665  name1.assert eve
-00007a40: 6e74 735b 315d 2e73 7472 6561 6d5f 706f  nts[1].stream_po
-00007a50: 7369 7469 6f6e 203d 3d20 310a 6173 7365  sition == 1.asse
-00007a60: 7274 2065 7665 6e74 735b 315d 2e74 7970  rt events[1].typ
-00007a70: 6520 3d3d 2065 7665 6e74 322e 7479 7065  e == event2.type
-00007a80: 0a61 7373 6572 7420 6576 656e 7473 5b31  .assert events[1
-00007a90: 5d2e 6461 7461 203d 3d20 6576 656e 7432  ].data == event2
-00007aa0: 2e64 6174 610a 0a61 7373 6572 7420 6576  .data..assert ev
-00007ab0: 656e 7473 5b32 5d2e 7374 7265 616d 5f6e  ents[2].stream_n
-00007ac0: 616d 6520 3d3d 2073 7472 6561 6d5f 6e61  ame == stream_na
-00007ad0: 6d65 310a 6173 7365 7274 2065 7665 6e74  me1.assert event
-00007ae0: 735b 325d 2e73 7472 6561 6d5f 706f 7369  s[2].stream_posi
-00007af0: 7469 6f6e 203d 3d20 300a 6173 7365 7274  tion == 0.assert
-00007b00: 2065 7665 6e74 735b 325d 2e74 7970 6520   events[2].type 
-00007b10: 3d3d 2065 7665 6e74 312e 7479 7065 0a61  == event1.type.a
-00007b20: 7373 6572 7420 6576 656e 7473 5b32 5d2e  ssert events[2].
-00007b30: 6461 7461 203d 3d20 6576 656e 7431 2e64  data == event1.d
-00007b40: 6174 610a 6060 600a 0a54 6865 2065 7861  ata.```..The exa
-00007b50: 6d70 6c65 2062 656c 6f77 2073 686f 7773  mple below shows
-00007b60: 2068 6f77 2074 6f20 7265 6164 2061 206c   how to read a l
-00007b70: 696d 6974 6564 206e 756d 6265 7220 286f  imited number (o
-00007b80: 6e65 2920 6f66 2074 6865 2072 6563 6f72  ne) of the recor
-00007b90: 6465 6420 6576 656e 7473 0a69 6e20 7468  ded events.in th
-00007ba0: 6520 6461 7461 6261 7365 2066 6f72 7761  e database forwa
-00007bb0: 7264 7320 6672 6f6d 2061 2073 7065 6369  rds from a speci
-00007bc0: 6669 6320 636f 6d6d 6974 2070 6f73 6974  fic commit posit
-00007bd0: 696f 6e2e 2050 6c65 6173 6520 6e6f 7465  ion. Please note
-00007be0: 2c20 7768 656e 2072 6561 6469 6e67 0a61  , when reading.a
-00007bf0: 6c6c 2065 7665 6e74 7320 666f 7277 6172  ll events forwar
-00007c00: 6473 2066 726f 6d20 6120 7370 6563 6966  ds from a specif
-00007c10: 6963 2063 6f6d 6d69 7420 706f 7369 7469  ic commit positi
-00007c20: 6f6e 2c20 7468 6520 6576 656e 7420 6174  on, the event at
-00007c30: 2074 6865 2073 7065 6369 6669 6564 0a70   the specified.p
-00007c40: 6f73 6974 696f 6e20 5749 4c4c 2062 6520  osition WILL be 
-00007c50: 696e 636c 7564 6564 2e0a 0a0a 6060 6070  included....```p
-00007c60: 7974 686f 6e0a 6576 656e 7473 203d 206c  ython.events = l
-00007c70: 6973 7428 0a20 2020 2063 6c69 656e 742e  ist(.    client.
-00007c80: 7265 6164 5f61 6c6c 5f65 7665 6e74 7328  read_all_events(
-00007c90: 0a20 2020 2020 2020 2063 6f6d 6d69 745f  .        commit_
-00007ca0: 706f 7369 7469 6f6e 3d63 6f6d 6d69 745f  position=commit_
-00007cb0: 706f 7369 7469 6f6e 312c 0a20 2020 2020  position1,.     
-00007cc0: 2020 206c 696d 6974 3d31 2c0a 2020 2020     limit=1,.    
-00007cd0: 290a 290a 0a61 7373 6572 7420 6c65 6e28  ).)..assert len(
-00007ce0: 6576 656e 7473 2920 3d3d 2031 0a0a 6173  events) == 1..as
-00007cf0: 7365 7274 2065 7665 6e74 735b 305d 2e73  sert events[0].s
-00007d00: 7472 6561 6d5f 6e61 6d65 203d 3d20 7374  tream_name == st
-00007d10: 7265 616d 5f6e 616d 6531 0a61 7373 6572  ream_name1.asser
-00007d20: 7420 6576 656e 7473 5b30 5d2e 7374 7265  t events[0].stre
-00007d30: 616d 5f70 6f73 6974 696f 6e20 3d3d 2030  am_position == 0
-00007d40: 0a61 7373 6572 7420 6576 656e 7473 5b30  .assert events[0
-00007d50: 5d2e 7479 7065 203d 3d20 6576 656e 7431  ].type == event1
-00007d60: 2e74 7970 650a 6173 7365 7274 2065 7665  .type.assert eve
-00007d70: 6e74 735b 305d 2e64 6174 6120 3d3d 2065  nts[0].data == e
-00007d80: 7665 6e74 312e 6461 7461 0a0a 6173 7365  vent1.data..asse
-00007d90: 7274 2065 7665 6e74 735b 305d 2e63 6f6d  rt events[0].com
-00007da0: 6d69 745f 706f 7369 7469 6f6e 203d 3d20  mit_position == 
-00007db0: 636f 6d6d 6974 5f70 6f73 6974 696f 6e31  commit_position1
-00007dc0: 0a60 6060 0a0a 5468 6520 6578 616d 706c  .```..The exampl
-00007dd0: 6520 6265 6c6f 7720 7368 6f77 7320 686f  e below shows ho
-00007de0: 7720 746f 2072 6561 6420 6120 6c69 6d69  w to read a limi
-00007df0: 7465 6420 6e75 6d62 6572 2028 6f6e 6529  ted number (one)
-00007e00: 206f 6620 7468 6520 7265 636f 7264 6564   of the recorded
-00007e10: 2065 7665 6e74 730a 696e 2074 6865 2064   events.in the d
-00007e20: 6174 6162 6173 6520 6261 636b 7761 7264  atabase backward
-00007e30: 7320 6672 6f6d 2074 6865 2065 6e64 2e20  s from the end. 
-00007e40: 5468 6973 2067 6976 6573 2074 6865 206c  This gives the l
-00007e50: 6173 7420 7265 636f 7264 6564 2065 7665  ast recorded eve
-00007e60: 6e74 2e0a 0a60 6060 7079 7468 6f6e 0a65  nt...```python.e
-00007e70: 7665 6e74 7320 3d20 6c69 7374 280a 2020  vents = list(.  
-00007e80: 2020 636c 6965 6e74 2e72 6561 645f 616c    client.read_al
-00007e90: 6c5f 6576 656e 7473 280a 2020 2020 2020  l_events(.      
-00007ea0: 2020 6261 636b 7761 7264 733d 5472 7565    backwards=True
-00007eb0: 2c0a 2020 2020 2020 2020 6c69 6d69 743d  ,.        limit=
-00007ec0: 312c 0a20 2020 2029 0a29 0a0a 6173 7365  1,.    ).)..asse
-00007ed0: 7274 206c 656e 2865 7665 6e74 7329 203d  rt len(events) =
-00007ee0: 3d20 310a 0a61 7373 6572 7420 6576 656e  = 1..assert even
-00007ef0: 7473 5b30 5d2e 7374 7265 616d 5f6e 616d  ts[0].stream_nam
-00007f00: 6520 3d3d 2073 7472 6561 6d5f 6e61 6d65  e == stream_name
-00007f10: 310a 6173 7365 7274 2065 7665 6e74 735b  1.assert events[
-00007f20: 305d 2e73 7472 6561 6d5f 706f 7369 7469  0].stream_positi
-00007f30: 6f6e 203d 3d20 320a 6173 7365 7274 2065  on == 2.assert e
-00007f40: 7665 6e74 735b 305d 2e74 7970 6520 3d3d  vents[0].type ==
-00007f50: 2065 7665 6e74 332e 7479 7065 0a61 7373   event3.type.ass
-00007f60: 6572 7420 6576 656e 7473 5b30 5d2e 6461  ert events[0].da
-00007f70: 7461 203d 3d20 6576 656e 7433 2e64 6174  ta == event3.dat
-00007f80: 610a 6060 600a 0a54 6865 2065 7861 6d70  a.```..The examp
-00007f90: 6c65 2062 656c 6f77 2073 686f 7773 2068  le below shows h
-00007fa0: 6f77 2074 6f20 7265 6164 2061 206c 696d  ow to read a lim
-00007fb0: 6974 6564 206e 756d 6265 7220 286f 6e65  ited number (one
-00007fc0: 2920 6f66 2074 6865 2072 6563 6f72 6465  ) of the recorde
-00007fd0: 6420 6576 656e 7473 0a69 6e20 7468 6520  d events.in the 
-00007fe0: 6461 7461 6261 7365 2062 6163 6b77 6172  database backwar
-00007ff0: 6473 2066 726f 6d20 6120 7370 6563 6966  ds from a specif
-00008000: 6963 2063 6f6d 6d69 7420 706f 7369 7469  ic commit positi
-00008010: 6f6e 2e20 506c 6561 7365 206e 6f74 652c  on. Please note,
-00008020: 2077 6865 6e20 7265 6164 696e 670a 616c   when reading.al
-00008030: 6c20 6576 656e 7473 2062 6163 6b77 6172  l events backwar
-00008040: 6473 2066 726f 6d20 6120 7370 6563 6966  ds from a specif
-00008050: 6963 2063 6f6d 6d69 7420 706f 7369 7469  ic commit positi
-00008060: 6f6e 2c20 7468 6520 6576 656e 7420 6174  on, the event at
-00008070: 2074 6865 2073 7065 6369 6669 6564 0a70   the specified.p
-00008080: 6f73 6974 696f 6e20 5749 4c4c 204e 4f54  osition WILL NOT
-00008090: 2062 6520 696e 636c 7564 6564 2e0a 0a60   be included...`
-000080a0: 6060 7079 7468 6f6e 0a65 7665 6e74 7320  ``python.events 
-000080b0: 3d20 6c69 7374 280a 2020 2020 636c 6965  = list(.    clie
-000080c0: 6e74 2e72 6561 645f 616c 6c5f 6576 656e  nt.read_all_even
-000080d0: 7473 280a 2020 2020 2020 2020 636f 6d6d  ts(.        comm
-000080e0: 6974 5f70 6f73 6974 696f 6e3d 636f 6d6d  it_position=comm
-000080f0: 6974 5f70 6f73 6974 696f 6e32 2c0a 2020  it_position2,.  
-00008100: 2020 2020 2020 6261 636b 7761 7264 733d        backwards=
-00008110: 5472 7565 2c0a 2020 2020 2020 2020 6c69  True,.        li
-00008120: 6d69 743d 312c 0a20 2020 2029 0a29 0a0a  mit=1,.    ).)..
-00008130: 6173 7365 7274 206c 656e 2865 7665 6e74  assert len(event
-00008140: 7329 203d 3d20 310a 0a61 7373 6572 7420  s) == 1..assert 
-00008150: 6576 656e 7473 5b30 5d2e 636f 6d6d 6974  events[0].commit
-00008160: 5f70 6f73 6974 696f 6e20 3c20 636f 6d6d  _position < comm
-00008170: 6974 5f70 6f73 6974 696f 6e32 0a60 6060  it_position2.```
-00008180: 0a0a 0a23 2323 2047 6574 2063 7572 7265  ...### Get curre
-00008190: 6e74 2073 7472 6561 6d20 706f 7369 7469  nt stream positi
-000081a0: 6f6e 0a0a 5468 6520 6067 6574 5f73 7472  on..The `get_str
-000081b0: 6561 6d5f 706f 7369 7469 6f6e 2829 6020  eam_position()` 
-000081c0: 6d65 7468 6f64 2063 616e 2062 6520 7573  method can be us
-000081d0: 6564 2074 6f0a 6765 7420 7468 6520 2273  ed to.get the "s
-000081e0: 7472 6561 6d20 706f 7369 7469 6f6e 2220  tream position" 
-000081f0: 6f66 2074 6865 206c 6173 7420 7265 636f  of the last reco
-00008200: 7264 6564 2065 7665 6e74 2069 6e20 6120  rded event in a 
-00008210: 7374 7265 616d 2e0a 0a54 6869 7320 6d65  stream...This me
-00008220: 7468 6f64 2068 6173 2061 2060 7374 7265  thod has a `stre
-00008230: 616d 5f6e 616d 6560 2061 7267 756d 656e  am_name` argumen
-00008240: 742c 2077 6869 6368 2069 7320 7265 7175  t, which is requ
-00008250: 6972 6564 2e0a 0a54 6869 7320 6d65 7468  ired...This meth
-00008260: 6f64 2061 6c73 6f20 7461 6b65 7320 616e  od also takes an
-00008270: 206f 7074 696f 6e61 6c20 6074 696d 656f   optional `timeo
-00008280: 7574 6020 6172 6775 6d65 6e74 2c20 7468  ut` argument, th
-00008290: 6174 0a69 7320 6578 7065 6374 6564 2074  at.is expected t
-000082a0: 6f20 6265 2061 2050 7974 686f 6e20 6066  o be a Python `f
-000082b0: 6c6f 6174 602c 2077 6869 6368 2073 6574  loat`, which set
-000082c0: 7320 6120 6465 6164 6c69 6e65 0a66 6f72  s a deadline.for
-000082d0: 2074 6865 2063 6f6d 706c 6574 696f 6e20   the completion 
-000082e0: 6f66 2074 6865 2067 5250 4320 6f70 6572  of the gRPC oper
-000082f0: 6174 696f 6e2e 0a0a 5468 6520 7365 7175  ation...The sequ
-00008300: 656e 6365 206f 6620 706f 7369 7469 6f6e  ence of position
-00008310: 7320 696e 2061 2073 7472 6561 6d20 6973  s in a stream is
-00008320: 2067 6170 6c65 7373 2e20 4974 2069 7320   gapless. It is 
-00008330: 7a65 726f 2d62 6173 6564 2c0a 736f 2074  zero-based,.so t
-00008340: 6861 7420 6120 7374 7265 616d 2077 6974  hat a stream wit
-00008350: 6820 6f6e 6520 7265 636f 7264 6564 2065  h one recorded e
-00008360: 7665 6e74 2068 6173 2061 2063 7572 7265  vent has a curre
-00008370: 6e74 2073 7472 6561 6d0a 706f 7369 7469  nt stream.positi
-00008380: 6f6e 206f 6620 6030 602e 2054 6865 2063  on of `0`. The c
-00008390: 7572 7265 6e74 2073 7472 6561 6d20 706f  urrent stream po
-000083a0: 7369 7469 6f6e 2069 7320 6031 6020 7768  sition is `1` wh
-000083b0: 656e 2061 2073 7472 6561 6d20 6861 730a  en a stream has.
-000083c0: 7477 6f20 6576 656e 7473 2c20 616e 6420  two events, and 
-000083d0: 6974 2069 7320 6032 6020 7768 656e 2074  it is `2` when t
-000083e0: 6865 7265 2061 7265 2065 7665 6e74 732c  here are events,
-000083f0: 2061 6e64 2073 6f20 6f6e 2e0a 0a49 6e20   and so on...In 
-00008400: 7468 6520 6578 616d 706c 6520 6265 6c6f  the example belo
-00008410: 772c 2074 6865 2063 7572 7265 6e74 2073  w, the current s
-00008420: 7472 6561 6d20 706f 7369 7469 6f6e 2069  tream position i
-00008430: 7320 6f62 7461 696e 6564 206f 6620 7468  s obtained of th
-00008440: 650a 7374 7265 616d 2074 6f20 7768 6963  e.stream to whic
-00008450: 6820 6576 656e 7473 2077 6572 6520 6170  h events were ap
-00008460: 7065 6e64 6564 2069 6e20 7468 6520 6578  pended in the ex
-00008470: 616d 706c 6573 2061 626f 7665 2e0a 4265  amples above..Be
-00008480: 6361 7573 6520 7468 6520 7365 7175 656e  cause the sequen
-00008490: 6365 206f 6620 7374 7265 616d 2070 6f73  ce of stream pos
-000084a0: 6974 696f 6e73 2069 7320 7a65 726f 2d62  itions is zero-b
-000084b0: 6173 6564 2c20 616e 6420 6265 6361 7573  ased, and becaus
-000084c0: 650a 7468 7265 6520 6576 656e 7473 2077  e.three events w
-000084d0: 6572 6520 6170 7065 6e64 6564 2c20 736f  ere appended, so
-000084e0: 2074 6865 2063 7572 7265 6e74 2073 7472   the current str
-000084f0: 6561 6d20 706f 7369 7469 6f6e 2069 7320  eam position is 
-00008500: 6032 602e 0a0a 6060 6070 7974 686f 6e0a  `2`...```python.
-00008510: 7374 7265 616d 5f70 6f73 6974 696f 6e20  stream_position 
-00008520: 3d20 636c 6965 6e74 2e67 6574 5f73 7472  = client.get_str
-00008530: 6561 6d5f 706f 7369 7469 6f6e 280a 2020  eam_position(.  
-00008540: 2020 7374 7265 616d 5f6e 616d 653d 7374    stream_name=st
-00008550: 7265 616d 5f6e 616d 6531 0a29 0a0a 6173  ream_name1.)..as
-00008560: 7365 7274 2073 7472 6561 6d5f 706f 7369  sert stream_posi
-00008570: 7469 6f6e 203d 3d20 320a 6060 600a 0a49  tion == 2.```..I
-00008580: 6620 6120 7374 7265 616d 2064 6f65 7320  f a stream does 
-00008590: 6e6f 7420 6578 6973 742c 2074 6865 2072  not exist, the r
-000085a0: 6574 7572 6e65 6420 7374 7265 616d 2070  eturned stream p
-000085b0: 6f73 6974 696f 6e20 7661 6c75 6520 6973  osition value is
-000085c0: 2060 4e6f 6e65 602c 0a77 6869 6368 206d   `None`,.which m
-000085d0: 6174 6368 6573 2074 6865 2072 6571 7569  atches the requi
-000085e0: 7265 6420 6578 7065 6374 6564 2070 6f73  red expected pos
-000085f0: 6974 696f 6e20 7768 656e 2061 7070 656e  ition when appen
-00008600: 6469 6e67 2074 6865 2066 6972 7374 2065  ding the first e
-00008610: 7665 6e74 0a6f 6620 6120 6e65 7720 7374  vent.of a new st
-00008620: 7265 616d 2028 7365 6520 6162 6f76 6529  ream (see above)
-00008630: 2e0a 0a60 6060 7079 7468 6f6e 0a73 7472  ...```python.str
-00008640: 6561 6d5f 706f 7369 7469 6f6e 203d 2063  eam_position = c
-00008650: 6c69 656e 742e 6765 745f 7374 7265 616d  lient.get_stream
-00008660: 5f70 6f73 6974 696f 6e28 0a20 2020 2073  _position(.    s
-00008670: 7472 6561 6d5f 6e61 6d65 3d73 7472 2875  tream_name=str(u
-00008680: 7569 6434 2829 290a 290a 0a61 7373 6572  uid4()).)..asser
-00008690: 7420 7374 7265 616d 5f70 6f73 6974 696f  t stream_positio
-000086a0: 6e20 3d3d 204e 6f6e 650a 6060 600a 0a54  n == None.```..T
-000086b0: 6869 7320 6d65 7468 6f64 2074 616b 6573  his method takes
-000086c0: 2061 6e20 6f70 7469 6f6e 616c 2061 7267   an optional arg
-000086d0: 756d 656e 7420 6074 696d 656f 7574 6020  ument `timeout` 
-000086e0: 7768 6963 6820 6973 2061 2050 7974 686f  which is a Pytho
-000086f0: 6e20 6066 6c6f 6174 6020 7468 6174 2073  n `float` that s
-00008700: 6574 730a 6120 6465 6164 6c69 6e65 2066  ets.a deadline f
-00008710: 6f72 2074 6865 2063 6f6d 706c 6574 696f  or the completio
-00008720: 6e20 6f66 2074 6865 2067 5250 4320 6f70  n of the gRPC op
-00008730: 6572 6174 696f 6e2e 0a0a 0a23 2323 2047  eration....### G
-00008740: 6574 2063 7572 7265 6e74 2063 6f6d 6d69  et current commi
-00008750: 7420 706f 7369 7469 6f6e 0a0a 5468 6520  t position..The 
-00008760: 6d65 7468 6f64 2060 6765 745f 636f 6d6d  method `get_comm
-00008770: 6974 5f70 6f73 6974 696f 6e28 2960 2063  it_position()` c
-00008780: 616e 2062 6520 7573 6564 2074 6f20 6765  an be used to ge
-00008790: 7420 7468 6520 6375 7272 656e 740a 636f  t the current.co
-000087a0: 6d6d 6974 2070 6f73 6974 696f 6e20 6f66  mmit position of
-000087b0: 2074 6865 2064 6174 6162 6173 652e 0a0a   the database...
-000087c0: 6060 6070 7974 686f 6e0a 636f 6d6d 6974  ```python.commit
-000087d0: 5f70 6f73 6974 696f 6e20 3d20 636c 6965  _position = clie
-000087e0: 6e74 2e67 6574 5f63 6f6d 6d69 745f 706f  nt.get_commit_po
-000087f0: 7369 7469 6f6e 2829 0a60 6060 0a0a 5468  sition().```..Th
-00008800: 6973 206d 6574 686f 6420 7461 6b65 7320  is method takes 
-00008810: 616e 206f 7074 696f 6e61 6c20 6172 6775  an optional argu
-00008820: 6d65 6e74 2060 7469 6d65 6f75 7460 2077  ment `timeout` w
-00008830: 6869 6368 2069 7320 6120 5079 7468 6f6e  hich is a Python
-00008840: 2060 666c 6f61 7460 2074 6861 7420 7365   `float` that se
-00008850: 7473 0a61 2064 6561 646c 696e 6520 666f  ts.a deadline fo
-00008860: 7220 7468 6520 636f 6d70 6c65 7469 6f6e  r the completion
-00008870: 206f 6620 7468 6520 6752 5043 206f 7065   of the gRPC ope
-00008880: 7261 7469 6f6e 2e0a 0a54 6869 7320 6d65  ration...This me
-00008890: 7468 6f64 2063 616e 2062 6520 7573 6566  thod can be usef
-000088a0: 756c 2074 6f20 6d65 6173 7572 6520 7072  ul to measure pr
-000088b0: 6f67 7265 7373 206f 6620 6120 646f 776e  ogress of a down
-000088c0: 7374 7265 616d 2063 6f6d 706f 6e65 6e74  stream component
-000088d0: 0a74 6861 7420 6973 2070 726f 6365 7373  .that is process
-000088e0: 696e 6720 616c 6c20 7265 636f 7264 6564  ing all recorded
-000088f0: 2065 7665 6e74 732c 2062 7920 636f 6d70   events, by comp
-00008900: 6172 696e 6720 7468 6520 6375 7272 656e  aring the curren
-00008910: 7420 636f 6d6d 6974 0a70 6f73 6974 696f  t commit.positio
-00008920: 6e20 7769 7468 2074 6865 2072 6563 6f72  n with the recor
-00008930: 6465 6420 636f 6d6d 6974 2070 6f73 6974  ded commit posit
-00008940: 696f 6e20 6f66 2074 6865 206c 6173 7420  ion of the last 
-00008950: 7375 6363 6573 7366 756c 6c79 2070 726f  successfully pro
-00008960: 6365 7373 6564 0a65 7665 6e74 2069 6e20  cessed.event in 
-00008970: 6120 646f 776e 7374 7265 616d 2063 6f6d  a downstream com
-00008980: 706f 6e65 6e74 2e0a 0a54 6865 2076 616c  ponent...The val
-00008990: 7565 206f 6620 7468 6520 6063 6f6d 6d69  ue of the `commi
-000089a0: 745f 706f 7369 7469 6f6e 6020 6172 6775  t_position` argu
-000089b0: 6d65 6e74 2077 6865 6e20 7265 6164 696e  ment when readin
-000089c0: 6720 6576 656e 7473 2065 6974 6865 7220  g events either 
-000089d0: 6279 2075 7369 6e67 0a74 6865 2060 7265  by using.the `re
-000089e0: 6164 5f61 6c6c 5f65 7665 6e74 7328 2960  ad_all_events()`
-000089f0: 206d 6574 686f 6420 6f72 2062 7920 7573   method or by us
-00008a00: 696e 6720 6120 6361 7463 682d 7570 2073  ing a catch-up s
-00008a10: 7562 7363 7269 7074 696f 6e20 776f 756c  ubscription woul
-00008a20: 6420 7573 7561 6c6c 790a 6265 2064 6574  d usually.be det
-00008a30: 6572 6d69 6e65 6420 6279 2074 6865 2072  ermined by the r
-00008a40: 6563 6f72 6465 6420 636f 6d6d 6974 2070  ecorded commit p
-00008a50: 6f73 6974 696f 6e20 6f66 2074 6865 206c  osition of the l
-00008a60: 6173 7420 7375 6363 6573 7366 756c 6c79  ast successfully
-00008a70: 2070 726f 6365 7373 6564 0a65 7665 6e74   processed.event
-00008a80: 2069 6e20 6120 646f 776e 7374 7265 616d   in a downstream
-00008a90: 2063 6f6d 706f 6e65 6e74 2e0a 0a0a 2323   component....##
-00008aa0: 2320 4765 7420 7374 7265 616d 206d 6574  # Get stream met
-00008ab0: 6164 6174 610a 0a54 6865 206d 6574 686f  adata..The metho
-00008ac0: 6420 6067 6574 5f73 7472 6561 6d5f 6d65  d `get_stream_me
-00008ad0: 7461 6461 7461 2829 6020 6765 7473 2074  tadata()` gets t
-00008ae0: 6865 206d 6574 6164 6174 6120 666f 7220  he metadata for 
-00008af0: 6120 7374 7265 616d 2c20 616c 6f6e 670a  a stream, along.
-00008b00: 7769 7468 2074 6865 2076 6572 7369 6f6e  with the version
-00008b10: 206f 6620 7468 6520 7374 7265 616d 206d   of the stream m
-00008b20: 6574 6164 6174 612e 0a0a 6060 6070 7974  etadata...```pyt
-00008b30: 686f 6e0a 6d65 7461 6461 7461 2c20 6d65  hon.metadata, me
-00008b40: 7461 6461 7461 5f76 6572 7369 6f6e 203d  tadata_version =
-00008b50: 2063 6c69 656e 742e 6765 745f 7374 7265   client.get_stre
-00008b60: 616d 5f6d 6574 6164 6174 6128 7374 7265  am_metadata(stre
-00008b70: 616d 5f6e 616d 653d 7374 7265 616d 5f6e  am_name=stream_n
-00008b80: 616d 6531 290a 6060 600a 0a54 6865 2072  ame1).```..The r
-00008b90: 6574 7572 6e65 6420 606d 6574 6164 6174  eturned `metadat
-00008ba0: 6160 2076 616c 7565 2069 7320 6120 5079  a` value is a Py
-00008bb0: 7468 6f6e 2060 6469 6374 602e 2054 6865  thon `dict`. The
-00008bc0: 2072 6574 7572 6e65 6420 606d 6574 6164   returned `metad
-00008bd0: 6174 615f 7665 7273 696f 6e60 0a76 616c  ata_version`.val
-00008be0: 7565 2069 7320 6569 7468 6572 2061 6e20  ue is either an 
-00008bf0: 6069 6e74 602c 206f 7220 604e 6f6e 6560  `int`, or `None`
-00008c00: 2069 6620 7468 6520 7374 7265 616d 2064   if the stream d
-00008c10: 6f65 7320 6e6f 7420 6578 6973 742e 2054  oes not exist. T
-00008c20: 6865 7365 2076 616c 7565 7320 6361 6e0a  hese values can.
-00008c30: 6265 2070 6173 7365 6420 696e 746f 2060  be passed into `
-00008c40: 7365 745f 7374 7265 616d 5f6d 6574 6164  set_stream_metad
-00008c50: 6174 6128 2960 2e0a 0a0a 2323 2320 5365  ata()`....### Se
-00008c60: 7420 7374 7265 616d 206d 6574 6164 6174  t stream metadat
-00008c70: 610a 0a2a 7265 7175 6972 6573 206c 6561  a..*requires lea
-00008c80: 6465 722a 0a0a 5468 6520 6d65 7468 6f64  der*..The method
-00008c90: 2060 7365 745f 7374 7265 616d 5f6d 6574   `set_stream_met
-00008ca0: 6164 6174 6128 2960 2073 6574 7320 7468  adata()` sets th
-00008cb0: 6520 6d65 7461 6461 7461 2066 6f72 2061  e metadata for a
-00008cc0: 2073 7472 6561 6d2c 2061 6c6f 6e67 0a77   stream, along.w
-00008cd0: 6974 6820 7468 6520 7665 7273 696f 6e20  ith the version 
-00008ce0: 6f66 2074 6865 2073 7472 6561 6d20 6d65  of the stream me
-00008cf0: 7461 6461 7461 2e0a 0a60 6060 7079 7468  tadata...```pyth
-00008d00: 6f6e 0a6d 6574 6164 6174 615b 2266 6f6f  on.metadata["foo
-00008d10: 225d 203d 2022 6261 7222 0a0a 636c 6965  "] = "bar"..clie
-00008d20: 6e74 2e73 6574 5f73 7472 6561 6d5f 6d65  nt.set_stream_me
-00008d30: 7461 6461 7461 280a 2020 2020 7374 7265  tadata(.    stre
-00008d40: 616d 5f6e 616d 653d 7374 7265 616d 5f6e  am_name=stream_n
-00008d50: 616d 6531 2c0a 2020 2020 6d65 7461 6461  ame1,.    metada
-00008d60: 7461 3d6d 6574 6164 6174 612c 0a20 2020  ta=metadata,.   
-00008d70: 2065 7870 6563 7465 645f 706f 7369 7469   expected_positi
-00008d80: 6f6e 3d6d 6574 6164 6174 615f 7665 7273  on=metadata_vers
-00008d90: 696f 6e2c 0a29 0a60 6060 0a0a 5468 6520  ion,.).```..The 
-00008da0: 6065 7870 6563 7465 645f 706f 7369 7469  `expected_positi
-00008db0: 6f6e 6020 6172 6775 6d65 6e74 2073 686f  on` argument sho
-00008dc0: 756c 6420 6265 2074 6865 2063 7572 7265  uld be the curre
-00008dd0: 6e74 2076 6572 7369 6f6e 206f 6620 7468  nt version of th
-00008de0: 6520 7374 7265 616d 206d 6574 6164 6174  e stream metadat
-00008df0: 612e 0a0a 506c 6561 7365 2072 6566 6572  a...Please refer
-00008e00: 2074 6f20 7468 6520 4576 656e 7453 746f   to the EventSto
-00008e10: 7265 4442 2064 6f63 756d 656e 7461 7469  reDB documentati
-00008e20: 6f6e 2066 6f72 206d 6f72 6520 696e 666f  on for more info
-00008e30: 726d 6174 696f 6e20 6162 6f75 7420 7374  rmation about st
-00008e40: 7265 616d 0a6d 6574 6164 6174 612e 0a0a  ream.metadata...
-00008e50: 2323 2320 4465 6c65 7465 2073 7472 6561  ### Delete strea
-00008e60: 6d0a 0a2a 7265 7175 6972 6573 206c 6561  m..*requires lea
-00008e70: 6465 722a 0a0a 5468 6520 6d65 7468 6f64  der*..The method
-00008e80: 2060 6465 6c65 7465 5f73 7472 6561 6d28   `delete_stream(
-00008e90: 2960 2063 616e 2062 6520 7573 6564 2074  )` can be used t
-00008ea0: 6f20 2264 656c 6574 6522 2061 2073 7472  o "delete" a str
-00008eb0: 6561 6d2e 0a0a 6060 6070 7974 686f 6e0a  eam...```python.
-00008ec0: 636f 6d6d 6974 5f70 6f73 6974 696f 6e20  commit_position 
-00008ed0: 3d20 636c 6965 6e74 2e64 656c 6574 655f  = client.delete_
-00008ee0: 7374 7265 616d 2873 7472 6561 6d5f 6e61  stream(stream_na
-00008ef0: 6d65 3d73 7472 6561 6d5f 6e61 6d65 312c  me=stream_name1,
-00008f00: 2065 7870 6563 7465 645f 706f 7369 7469   expected_positi
-00008f10: 6f6e 3d32 290a 6060 600a 0a41 6674 6572  on=2).```..After
-00008f20: 2064 656c 6574 696e 6720 6120 7374 7265   deleting a stre
-00008f30: 616d 2c20 6974 2773 2073 7469 6c6c 2070  am, it's still p
-00008f40: 6f73 7369 626c 6520 746f 2061 7070 656e  ossible to appen
-00008f50: 6420 6e65 7720 6576 656e 7473 2e20 5265  d new events. Re
-00008f60: 6164 696e 6720 6672 6f6d 2061 0a64 656c  ading from a.del
-00008f70: 6574 6564 2073 7472 6561 6d20 7769 6c6c  eted stream will
-00008f80: 2072 6574 7572 6e20 6f6e 6c79 2065 7665   return only eve
-00008f90: 6e74 7320 7468 6174 2068 6176 6520 6265  nts that have be
-00008fa0: 656e 2061 7070 656e 6465 6420 6166 7465  en appended afte
-00008fb0: 7220 6974 2077 6173 0a64 656c 6574 6564  r it was.deleted
-00008fc0: 2e0a 0a23 2323 2054 6f6d 6273 746f 6e65  ...### Tombstone
-00008fd0: 2073 7472 6561 6d0a 0a2a 7265 7175 6972   stream..*requir
-00008fe0: 6573 206c 6561 6465 722a 0a0a 5468 6520  es leader*..The 
-00008ff0: 6d65 7468 6f64 2060 746f 6d62 7374 6f6e  method `tombston
-00009000: 655f 7374 7265 616d 2829 6020 6361 6e20  e_stream()` can 
-00009010: 6265 2075 7365 6420 746f 2022 746f 6d62  be used to "tomb
-00009020: 7374 6f6e 6522 2061 2073 7472 6561 6d2e  stone" a stream.
-00009030: 0a0a 6060 6070 7974 686f 6e0a 636f 6d6d  ..```python.comm
-00009040: 6974 5f70 6f73 6974 696f 6e20 3d20 636c  it_position = cl
-00009050: 6965 6e74 2e74 6f6d 6273 746f 6e65 5f73  ient.tombstone_s
-00009060: 7472 6561 6d28 7374 7265 616d 5f6e 616d  tream(stream_nam
-00009070: 653d 7374 7265 616d 5f6e 616d 6531 2c20  e=stream_name1, 
-00009080: 6578 7065 6374 6564 5f70 6f73 6974 696f  expected_positio
-00009090: 6e3d 3229 0a60 6060 0a0a 4166 7465 7220  n=2).```..After 
-000090a0: 746f 6d62 7374 6f6e 696e 6720 6120 7374  tombstoning a st
-000090b0: 7265 616d 2c20 6974 2773 206e 6f74 2070  ream, it's not p
-000090c0: 6f73 7369 626c 6520 746f 2061 7070 656e  ossible to appen
-000090d0: 6420 6e65 7720 6576 656e 7473 2e0a 0a0a  d new events....
-000090e0: 2323 2043 6174 6368 2d75 7020 7375 6273  ## Catch-up subs
-000090f0: 6372 6970 7469 6f6e 730a 0a22 4361 7463  criptions.."Catc
-00009100: 682d 7570 2220 7375 6273 6372 6970 7469  h-up" subscripti
-00009110: 6f6e 7320 6361 6e20 6265 2075 7365 6420  ons can be used 
-00009120: 746f 2072 6563 6569 7665 2065 7665 6e74  to receive event
-00009130: 7320 7468 6174 2068 6176 6520 6265 656e  s that have been
-00009140: 2072 6563 6f72 6465 640a 696e 2074 6865   recorded.in the
-00009150: 2064 6174 6162 6173 652c 2061 6e64 2061   database, and a
-00009160: 6c73 6f20 6576 656e 7473 2074 6861 7420  lso events that 
-00009170: 6172 6520 7265 636f 7264 6564 2061 6674  are recorded aft
-00009180: 6572 2061 2073 7562 7363 7269 7074 696f  er a subscriptio
-00009190: 6e20 7761 7320 7374 6172 7465 642e 0a0a  n was started...
-000091a0: 5468 6520 6d65 7468 6f64 2060 7375 6273  The method `subs
-000091b0: 6372 6962 655f 616c 6c5f 6576 656e 7473  cribe_all_events
-000091c0: 2829 6020 7374 6172 7473 2061 2063 6174  ()` starts a cat
-000091d0: 6368 2d75 7020 7375 6273 6372 6970 7469  ch-up subscripti
-000091e0: 6f6e 2074 6f20 7265 6365 6976 6520 616c  on to receive al
-000091f0: 6c0a 6576 656e 7473 2074 6861 7420 6861  l.events that ha
-00009200: 7665 2062 6565 6e20 616e 6420 7769 6c6c  ve been and will
-00009210: 2062 6520 7265 636f 7264 6564 2069 6e20   be recorded in 
-00009220: 7468 6520 6461 7461 6261 7365 2e20 5468  the database. Th
-00009230: 6520 6d65 7468 6f64 0a60 7375 6273 6372  e method.`subscr
-00009240: 6962 655f 7374 7265 616d 5f65 7665 6e74  ibe_stream_event
-00009250: 7328 2960 2073 7461 7274 7320 6120 6361  s()` starts a ca
-00009260: 7463 682d 7570 2073 7562 7363 7269 7074  tch-up subscript
-00009270: 696f 6e20 746f 2072 6563 6569 7665 2065  ion to receive e
-00009280: 7665 6e74 7320 6672 6f6d 0a61 2073 7065  vents from.a spe
-00009290: 6369 6669 6320 7374 7265 616d 2e0a 0a43  cific stream...C
-000092a0: 6174 6368 2d75 7020 7375 6273 6372 6970  atch-up subscrip
-000092b0: 7469 6f6e 7320 656e 6361 7073 756c 6174  tions encapsulat
-000092c0: 6520 6120 7374 7265 616d 696e 6720 6752  e a streaming gR
-000092d0: 5043 2063 616c 6c20 7768 6963 6820 6973  PC call which is
-000092e0: 0a6b 6570 7420 6f70 656e 2062 7920 7468  .kept open by th
-000092f0: 6520 7365 7276 6572 2c20 7769 7468 206e  e server, with n
-00009300: 6577 6c79 2072 6563 6f72 6465 6420 6576  ewly recorded ev
-00009310: 656e 7473 2073 656e 7420 746f 2074 6865  ents sent to the
-00009320: 2063 6c69 656e 740a 6173 2074 6865 2063   client.as the c
-00009330: 6c69 656e 7420 6974 6572 6174 6573 206f  lient iterates o
-00009340: 7665 7220 7468 6520 7375 6273 6372 6970  ver the subscrip
-00009350: 7469 6f6e 2072 6573 706f 6e73 652e 0a0a  tion response...
-00009360: 4d61 6e79 2063 6174 6368 2d75 7020 7375  Many catch-up su
-00009370: 6273 6372 6970 7469 6f6e 7320 6361 6e20  bscriptions can 
-00009380: 6265 2063 7265 6174 6564 2c20 636f 6e63  be created, conc
-00009390: 7572 7265 6e74 6c79 206f 7220 7375 6363  urrently or succ
-000093a0: 6573 7369 7665 6c79 2c20 616e 6420 616c  essively, and al
-000093b0: 6c0a 7769 6c6c 2072 6563 6569 7665 2061  l.will receive a
-000093c0: 6c6c 2074 6865 2072 6563 6f72 6465 6420  ll the recorded 
-000093d0: 6576 656e 7473 2074 6865 7920 6861 7665  events they have
-000093e0: 2062 6565 6e20 7265 7175 6573 7465 6420   been requested 
-000093f0: 746f 2072 6563 6569 7665 2e0a 0a54 6865  to receive...The
-00009400: 2072 6563 6569 7665 6420 7265 636f 7264   received record
-00009410: 6564 2065 7665 6e74 206f 626a 6563 7420  ed event object 
-00009420: 6172 6520 696e 7374 616e 6365 7320 6f66  are instances of
-00009430: 2074 6865 2060 5265 636f 7264 6564 4576   the `RecordedEv
-00009440: 656e 7460 2063 6c61 7373 0a28 7365 6520  ent` class.(see 
-00009450: 6265 6c6f 7729 2e0a 0a23 2323 2048 6f77  below)...### How
-00009460: 2074 6f20 696d 706c 656d 656e 7420 6578   to implement ex
-00009470: 6163 746c 792d 6f6e 6365 2065 7665 6e74  actly-once event
-00009480: 2070 726f 6365 7373 696e 670a 0a54 6865   processing..The
-00009490: 2063 6f6d 6d69 7420 706f 7369 7469 6f6e   commit position
-000094a0: 7320 6f66 2072 6563 6f72 6465 6420 6576  s of recorded ev
-000094b0: 656e 7473 2074 6861 7420 6172 6520 7265  ents that are re
-000094c0: 6365 6976 6564 2061 6e64 2070 726f 6365  ceived and proce
-000094d0: 7373 6564 2062 7920 610a 646f 776e 7374  ssed by a.downst
-000094e0: 7265 616d 2063 6f6d 706f 6e65 6e74 2061  ream component a
-000094f0: 7265 2075 7365 6675 6c6c 7920 7265 636f  re usefully reco
-00009500: 7264 6564 2062 7920 7468 6520 646f 776e  rded by the down
-00009510: 7374 7265 616d 2063 6f6d 706f 6e65 6e74  stream component
-00009520: 2073 6f20 7468 6174 0a74 6865 2063 6f6d   so that.the com
-00009530: 6d69 7420 706f 7369 7469 6f6e 206f 6620  mit position of 
-00009540: 6c61 7374 2070 726f 6365 7373 6564 2065  last processed e
-00009550: 7665 6e74 2063 616e 2062 6520 6465 7465  vent can be dete
-00009560: 726d 696e 6564 2e0a 0a54 6865 206c 6173  rmined...The las
-00009570: 7420 7265 636f 7264 6564 2063 6f6d 6d69  t recorded commi
-00009580: 7420 706f 7369 7469 6f6e 2063 616e 2062  t position can b
-00009590: 6520 7573 6564 2074 6f20 7370 6563 6966  e used to specif
-000095a0: 7920 7468 6520 636f 6d6d 6974 2070 6f73  y the commit pos
-000095b0: 6974 696f 6e20 6672 6f6d 2077 6869 6368  ition from which
-000095c0: 0a74 6f20 7375 6273 6372 6962 6520 7768  .to subscribe wh
-000095d0: 656e 2070 726f 6365 7373 696e 6720 6973  en processing is
-000095e0: 2072 6573 756d 6564 2e20 5369 6e63 6520   resumed. Since 
-000095f0: 7468 6973 2063 6f6d 6d69 7420 706f 7369  this commit posi
-00009600: 7469 6f6e 2077 696c 6c20 7265 7072 6573  tion will repres
-00009610: 656e 7420 7468 650a 706f 7369 7469 6f6e  ent the.position
-00009620: 206f 6620 7468 6520 6c61 7374 2073 7563   of the last suc
-00009630: 6365 7373 6675 6c6c 7920 7072 6f63 6573  cessfully proces
-00009640: 7365 6420 6576 656e 7420 696e 2061 2064  sed event in a d
-00009650: 6f77 6e73 7472 6561 6d20 636f 6d70 6f6e  ownstream compon
-00009660: 656e 742c 2073 6f20 6974 0a77 696c 6c20  ent, so it.will 
-00009670: 6265 2075 7375 616c 2074 6f20 7761 6e74  be usual to want
-00009680: 2074 6865 206e 6578 7420 6576 656e 7420   the next event 
-00009690: 6166 7465 7220 7468 6973 2070 6f73 6974  after this posit
-000096a0: 696f 6e2c 2062 6563 6175 7365 2074 6861  ion, because tha
-000096b0: 7420 6973 2074 6865 206e 6578 740a 6576  t is the next.ev
-000096c0: 656e 7420 7468 6174 2068 6173 206e 6f74  ent that has not
-000096d0: 2079 6574 2062 6565 6e20 7072 6f63 6573   yet been proces
-000096e0: 7365 642e 2046 6f72 2074 6869 7320 7265  sed. For this re
-000096f0: 6173 6f6e 2c20 7768 656e 2073 7562 7363  ason, when subsc
-00009700: 7269 6269 6e67 2066 6f72 2065 7665 6e74  ribing for event
-00009710: 730a 6672 6f6d 2061 2073 7065 6369 6669  s.from a specifi
-00009720: 6320 636f 6d6d 6974 2070 6f73 6974 696f  c commit positio
-00009730: 6e20 7573 696e 6720 6120 6361 7463 682d  n using a catch-
-00009740: 7570 2073 7562 7363 7269 7074 696f 6e20  up subscription 
-00009750: 696e 2045 7665 6e74 5374 6f72 6544 422c  in EventStoreDB,
-00009760: 2074 6865 0a72 6563 6f72 6465 6420 6576   the.recorded ev
-00009770: 656e 7420 6174 2074 6865 2073 7065 6369  ent at the speci
-00009780: 6669 6564 2063 6f6d 6d69 7420 706f 7369  fied commit posi
-00009790: 7469 6f6e 2077 696c 6c20 4e4f 5420 6265  tion will NOT be
-000097a0: 2069 6e63 6c75 6465 6420 696e 2074 6865   included in the
-000097b0: 2073 6571 7565 6e63 650a 6f66 2072 6563   sequence.of rec
-000097c0: 6f72 6465 6420 6576 656e 7473 2074 6861  orded events tha
-000097d0: 7420 6172 6520 7265 6365 6976 6564 2e0a  t are received..
-000097e0: 0a54 6f20 6163 636f 6d70 6c69 7368 2022  .To accomplish "
-000097f0: 6578 6163 746c 792d 6f6e 6365 2220 7072  exactly-once" pr
-00009800: 6f63 6573 7369 6e67 206f 6620 7265 636f  ocessing of reco
-00009810: 7264 6564 2065 7665 6e74 7320 696e 2061  rded events in a
-00009820: 2064 6f77 6e73 7472 6561 6d0a 636f 6d70   downstream.comp
-00009830: 6f6e 656e 7420 7768 656e 2075 7369 6e67  onent when using
-00009840: 2061 2063 6174 6368 2d75 7020 7375 6273   a catch-up subs
-00009850: 6372 6970 7469 6f6e 2c20 7468 6520 636f  cription, the co
-00009860: 6d6d 6974 2070 6f73 6974 696f 6e20 6f66  mmit position of
-00009870: 2061 2072 6563 6f72 6465 640a 6576 656e   a recorded.even
-00009880: 7420 7368 6f75 6c64 2062 6520 7265 636f  t should be reco
-00009890: 7264 6564 2061 746f 6d69 6361 6c6c 7920  rded atomically 
-000098a0: 616e 6420 756e 6971 7565 6c79 2061 6c6f  and uniquely alo
-000098b0: 6e67 2077 6974 6820 7468 6520 7265 7375  ng with the resu
-000098c0: 6c74 206f 6620 7072 6f63 6573 7369 6e67  lt of processing
-000098d0: 0a72 6563 6f72 6465 6420 6576 656e 7473  .recorded events
-000098e0: 2c20 666f 7220 6578 616d 706c 6520 696e  , for example in
-000098f0: 2074 6865 2073 616d 6520 6461 7461 6261   the same databa
-00009900: 7365 2061 7320 6d61 7465 7269 616c 6973  se as materialis
-00009910: 6564 2076 6965 7773 2077 6865 6e0a 696d  ed views when.im
-00009920: 706c 656d 656e 7469 6e67 2065 7665 6e74  plementing event
-00009930: 7561 6c6c 792d 636f 6e73 6973 7465 6e74  ually-consistent
-00009940: 2043 5152 532c 206f 7220 696e 2074 6865   CQRS, or in the
-00009950: 2073 616d 6520 6461 7461 6261 7365 2061   same database a
-00009960: 7320 6120 646f 776e 7374 7265 616d 0a61  s a downstream.a
-00009970: 6e61 6c79 7469 6373 206f 7220 7265 706f  nalytics or repo
-00009980: 7274 696e 6720 6f72 2061 7263 6869 7669  rting or archivi
-00009990: 6e67 2061 7070 6c69 6361 7469 6f6e 2e20  ng application. 
-000099a0: 4279 2072 6563 6f72 6469 6e67 2074 6865  By recording the
-000099b0: 2063 6f6d 6d69 7420 706f 7369 7469 6f6e   commit position
-000099c0: 0a6f 6620 7265 636f 7264 6564 2065 7665  .of recorded eve
-000099d0: 6e74 7320 6174 6f6d 6963 616c 6c79 2077  nts atomically w
-000099e0: 6974 6820 7468 6520 6e65 7720 7374 6174  ith the new stat
-000099f0: 6520 7468 6174 2072 6573 756c 7473 2066  e that results f
-00009a00: 726f 6d20 7072 6f63 6573 7369 6e67 0a72  rom processing.r
-00009a10: 6563 6f72 6465 6420 6576 656e 7473 2c20  ecorded events, 
-00009a20: 2264 7561 6c20 7772 6974 696e 6722 2069  "dual writing" i
-00009a30: 6e20 7468 6520 636f 6e73 756d 7074 696f  n the consumptio
-00009a40: 6e20 6f66 2072 6563 6f72 6465 6420 6576  n of recorded ev
-00009a50: 656e 7473 2063 616e 2062 650a 6176 6f69  ents can be.avoi
-00009a60: 6465 642e 2042 7920 616c 736f 2072 6563  ded. By also rec
-00009a70: 6f72 6469 6e67 2074 6865 2063 6f6d 6d69  ording the commi
-00009a80: 7420 706f 7369 7469 6f6e 2075 6e69 7175  t position uniqu
-00009a90: 656c 792c 2074 6865 206e 6577 2073 7461  ely, the new sta
-00009aa0: 7465 2063 616e 6e6f 7420 6265 0a72 6563  te cannot be.rec
-00009ab0: 6f72 6465 6420 7477 6963 652c 2061 6e64  orded twice, and
-00009ac0: 2068 656e 6365 2074 6865 2072 6563 6f72   hence the recor
-00009ad0: 6465 6420 7374 6174 6520 6f66 2074 6865  ded state of the
-00009ae0: 2064 6f77 6e73 7472 6561 6d20 636f 6d70   downstream comp
-00009af0: 6f6e 656e 7420 7769 6c6c 2062 650a 7570  onent will be.up
-00009b00: 6461 7465 6420 6f6e 6c79 206f 6e63 6520  dated only once 
-00009b10: 666f 7220 616e 7920 7265 636f 7264 6564  for any recorded
-00009b20: 2065 7665 6e74 2e20 4279 2075 7369 6e67   event. By using
-00009b30: 2074 6865 2067 7265 6174 6573 7420 7265   the greatest re
-00009b40: 636f 7264 6564 2063 6f6d 6d69 740a 706f  corded commit.po
-00009b50: 7369 7469 6f6e 2074 6f20 7265 7375 6d65  sition to resume
-00009b60: 2061 2063 6174 6368 2d75 7020 7375 6273   a catch-up subs
-00009b70: 6372 6970 7469 6f6e 2c20 616c 6c20 7265  cription, all re
-00009b80: 636f 7264 6564 2065 7665 6e74 7320 7769  corded events wi
-00009b90: 6c6c 2065 7665 6e74 7561 6c6c 790a 6265  ll eventually.be
-00009ba0: 2070 726f 6365 7373 6564 2e20 5468 6520   processed. The 
-00009bb0: 636f 6d62 696e 6174 696f 6e20 6f66 2074  combination of t
-00009bc0: 6865 2022 6174 2d6d 6f73 742d 6f6e 6365  he "at-most-once
-00009bd0: 2220 636f 6e64 6974 696f 6e20 616e 6420  " condition and 
-00009be0: 7468 6520 2261 742d 6c65 6173 742d 6f6e  the "at-least-on
-00009bf0: 6365 220a 636f 6e64 6974 696f 6e20 6769  ce".condition gi
-00009c00: 7665 7320 7468 6520 2265 7861 6374 6c79  ves the "exactly
-00009c10: 2d6f 6e63 6522 2063 6f6e 6469 7469 6f6e  -once" condition
-00009c20: 2e0a 0a54 6865 2064 616e 6765 7220 7769  ...The danger wi
-00009c30: 7468 2022 6475 616c 2077 7269 7469 6e67  th "dual writing
-00009c40: 2220 696e 2074 6865 2063 6f6e 7375 6d70  " in the consump
-00009c50: 7469 6f6e 206f 6620 7265 636f 7264 6564  tion of recorded
-00009c60: 2065 7665 6e74 7320 6973 2074 6861 7420   events is that 
-00009c70: 6966 2061 0a72 6563 6f72 6465 6420 6576  if a.recorded ev
-00009c80: 656e 7420 6973 2073 7563 6365 7373 6675  ent is successfu
-00009c90: 6c6c 7920 7072 6f63 6573 7365 6420 616e  lly processed an
-00009ca0: 6420 6e65 7720 7374 6174 6520 7265 636f  d new state reco
-00009cb0: 7264 6564 2061 746f 6d69 6361 6c6c 7920  rded atomically 
-00009cc0: 696e 206f 6e65 0a74 7261 6e73 6163 7469  in one.transacti
-00009cd0: 6f6e 2077 6974 6820 7468 6520 636f 6d6d  on with the comm
-00009ce0: 6974 2070 6f73 6974 696f 6e20 7265 636f  it position reco
-00009cf0: 7264 6564 2069 6e20 6120 7365 7061 7261  rded in a separa
-00009d00: 7465 2074 7261 6e73 6163 7469 6f6e 2c20  te transaction, 
-00009d10: 6f6e 6520 6d61 790a 6861 7070 656e 2061  one may.happen a
-00009d20: 6e64 206e 6f74 2074 6865 206f 7468 6572  nd not the other
-00009d30: 2e20 4966 2074 6865 206e 6577 2073 7461  . If the new sta
-00009d40: 7465 2069 7320 7265 636f 7264 6564 2062  te is recorded b
-00009d50: 7574 2074 6865 2070 6f73 6974 696f 6e20  ut the position 
-00009d60: 6973 206c 6f73 742c 0a61 6e64 2074 6865  is lost,.and the
-00009d70: 6e20 7468 6520 7072 6f63 6573 7369 6e67  n the processing
-00009d80: 2069 7320 7374 6f70 7065 6420 616e 6420   is stopped and 
-00009d90: 7265 7375 6d65 642c 2074 6865 2072 6563  resumed, the rec
-00009da0: 6f72 6465 6420 6576 656e 7420 6d61 7920  orded event may 
-00009db0: 6265 2070 726f 6365 7373 6564 0a74 7769  be processed.twi
-00009dc0: 6365 2e20 4f6e 2074 6865 206f 7468 6572  ce. On the other
-00009dd0: 2068 616e 642c 2069 6620 7468 6520 636f   hand, if the co
-00009de0: 6d6d 6974 2070 6f73 6974 696f 6e20 6973  mmit position is
-00009df0: 2072 6563 6f72 6465 6420 6275 7420 7468   recorded but th
-00009e00: 6520 6e65 7720 7374 6174 6520 6973 0a6c  e new state is.l
-00009e10: 6f73 742c 2074 6865 2072 6563 6f72 6465  ost, the recorde
-00009e20: 6420 6576 656e 7420 6d61 7920 6566 6665  d event may effe
-00009e30: 6374 6976 656c 7920 6e6f 7420 6265 2070  ctively not be p
-00009e40: 726f 6365 7373 6564 2061 7420 616c 6c2e  rocessed at all.
-00009e50: 2042 7920 6569 7468 6572 0a70 726f 6365   By either.proce
-00009e60: 7373 696e 6720 616e 2065 7665 6e74 206d  ssing an event m
-00009e70: 6f72 6520 7468 616e 206f 6e63 652c 206f  ore than once, o
-00009e80: 7220 6279 2066 6169 6c69 6e67 2074 6f20  r by failing to 
-00009e90: 7072 6f63 6573 7320 616e 2065 7665 6e74  process an event
-00009ea0: 2c20 7468 6520 7265 636f 7264 6564 0a73  , the recorded.s
-00009eb0: 7461 7465 206f 6620 7468 6520 646f 776e  tate of the down
-00009ec0: 7374 7265 616d 2063 6f6d 706f 6e65 6e74  stream component
-00009ed0: 206d 6967 6874 2062 6520 696e 6163 6375   might be inaccu
-00009ee0: 7261 7465 2c20 6f72 2070 6f73 7369 626c  rate, or possibl
-00009ef0: 7920 696e 636f 6e73 6973 7465 6e74 2c20  y inconsistent, 
-00009f00: 616e 640a 7065 7268 6170 7320 6361 7461  and.perhaps cata
-00009f10: 7374 726f 7068 6963 616c 6c79 2073 6f2e  strophically so.
-00009f20: 2053 7563 6820 636f 6e73 6571 7565 6e63   Such consequenc
-00009f30: 6573 206d 6179 206f 7220 6d61 7920 6e6f  es may or may no
-00009f40: 7420 6d61 7474 6572 2069 6e20 796f 7572  t matter in your
-00009f50: 2073 6974 7561 7469 6f6e 2e0a 4275 7420   situation..But 
-00009f60: 736f 6d65 7469 6d65 7320 696e 636f 6e73  sometimes incons
-00009f70: 6973 7465 6e63 6965 7320 6d61 7920 6861  istencies may ha
-00009f80: 6c74 2070 726f 6365 7373 696e 6720 756e  lt processing un
-00009f90: 7469 6c20 7468 6520 6973 7375 6520 6973  til the issue is
-00009fa0: 2072 6573 6f6c 7665 642e 2059 6f75 2063   resolved. You c
-00009fb0: 616e 0a61 766f 6964 2022 6475 616c 2077  an.avoid "dual w
-00009fc0: 7269 7469 6e67 2220 696e 2074 6865 2063  riting" in the c
-00009fd0: 6f6e 7375 6d70 7469 6f6e 206f 6620 6576  onsumption of ev
-00009fe0: 656e 7473 2062 7920 6174 6f6d 6963 616c  ents by atomical
-00009ff0: 6c79 2072 6563 6f72 6469 6e67 2074 6865  ly recording the
-0000a000: 2063 6f6d 6d69 740a 706f 7369 7469 6f6e   commit.position
-0000a010: 206f 6620 6120 7265 636f 7264 6564 2065   of a recorded e
-0000a020: 7665 6e74 2061 6c6f 6e67 2077 6974 6820  vent along with 
-0000a030: 7468 6520 6e65 7720 7374 6174 6520 7468  the new state th
-0000a040: 6174 2072 6573 756c 7473 2066 726f 6d20  at results from 
-0000a050: 7072 6f63 6573 7369 6e67 2074 6861 740a  processing that.
-0000a060: 6576 656e 7420 696e 2074 6865 2073 616d  event in the sam
-0000a070: 6520 6174 6f6d 6963 2074 7261 6e73 6163  e atomic transac
-0000a080: 7469 6f6e 2e20 4279 206d 616b 696e 6720  tion. By making 
-0000a090: 7468 6520 7265 636f 7264 696e 6720 6f66  the recording of
-0000a0a0: 2074 6865 2063 6f6d 6d69 7420 706f 7369   the commit posi
-0000a0b0: 7469 6f6e 730a 756e 6971 7565 2c20 736f  tions.unique, so
-0000a0c0: 2074 6861 7420 7472 616e 7361 6374 696f   that transactio
-0000a0d0: 6e73 2077 696c 6c20 6265 2072 6f6c 6c65  ns will be rolle
-0000a0e0: 6420 6261 636b 2077 6865 6e20 7468 6572  d back when ther
-0000a0f0: 6520 6973 2061 2063 6f6e 666c 6963 742c  e is a conflict,
-0000a100: 2079 6f75 2077 696c 6c0a 7072 6576 656e   you will.preven
-0000a110: 7420 7468 6520 7265 7375 6c74 7320 6f66  t the results of
-0000a120: 2061 6e79 2064 7570 6c69 6361 7465 2070   any duplicate p
-0000a130: 726f 6365 7373 696e 6720 6f66 2061 2072  rocessing of a r
-0000a140: 6563 6f72 6465 6420 6576 656e 7420 6265  ecorded event be
-0000a150: 696e 6720 636f 6d6d 6974 7465 642e 0a0a  ing committed...
-0000a160: 5265 636f 7264 6564 2065 7665 6e74 7320  Recorded events 
-0000a170: 7265 6365 6976 6564 2066 726f 6d20 6120  received from a 
-0000a180: 6361 7463 682d 7570 2073 7562 7363 7269  catch-up subscri
-0000a190: 7074 696f 6e20 6361 6e6e 6f74 2062 6520  ption cannot be 
-0000a1a0: 6163 6b6e 6f77 6c65 6467 6564 2062 6163  acknowledged bac
-0000a1b0: 6b0a 746f 2074 6865 2045 7665 6e74 5374  k.to the EventSt
-0000a1c0: 6f72 6544 4220 7365 7276 6572 2e20 4163  oreDB server. Ac
-0000a1d0: 6b6e 6f77 6c65 6467 696e 6720 6576 656e  knowledging even
-0000a1e0: 7473 2c20 686f 7765 7665 722c 2069 7320  ts, however, is 
-0000a1f0: 616e 2061 7370 6563 7420 6f66 2022 7065  an aspect of "pe
-0000a200: 7273 6973 7465 6e74 0a73 7562 7363 7269  rsistent.subscri
-0000a210: 7074 696f 6e73 2220 2873 6565 2062 656c  ptions" (see bel
-0000a220: 6f77 292e 2048 6f70 696e 6720 746f 2072  ow). Hoping to r
-0000a230: 656c 7920 6f6e 2061 636b 6e6f 776c 6564  ely on acknowled
-0000a240: 6769 6e67 2065 7665 6e74 7320 746f 2061  ging events to a
-0000a250: 6e20 7570 7374 7265 616d 0a63 6f6d 706f  n upstream.compo
-0000a260: 6e65 6e74 2069 7320 616e 2065 7861 6d70  nent is an examp
-0000a270: 6c65 206f 6620 6475 616c 2077 7269 7469  le of dual writi
-0000a280: 6e67 2e0a 0a23 2323 2053 7562 7363 7269  ng...### Subscri
-0000a290: 6265 2061 6c6c 2065 7665 6e74 730a 0a54  be all events..T
-0000a2a0: 6865 6073 7562 7363 7269 6265 5f61 6c6c  he`subscribe_all
-0000a2b0: 5f65 7665 6e74 7328 2960 206d 6574 686f  _events()` metho
-0000a2c0: 6420 6361 6e20 6265 2075 7365 6420 746f  d can be used to
-0000a2d0: 2073 7461 7274 2061 2022 6361 7463 682d   start a "catch-
-0000a2e0: 7570 2220 7375 6273 6372 6970 7469 6f6e  up" subscription
-0000a2f0: 0a74 6861 7420 6361 6e20 7265 7475 726e  .that can return
-0000a300: 2065 7665 6e74 7320 6672 6f6d 2061 6c6c   events from all
-0000a310: 2073 7472 6561 6d73 2069 6e20 7468 6520   streams in the 
-0000a320: 6461 7461 6261 7365 2e0a 0a54 6869 7320  database...This 
-0000a330: 6d65 7468 6f64 2063 616e 2062 6520 7573  method can be us
-0000a340: 6564 2062 7920 6120 646f 776e 7374 7265  ed by a downstre
-0000a350: 616d 2063 6f6d 706f 6e65 6e74 0a74 6f20  am component.to 
-0000a360: 7072 6f63 6573 7320 7265 636f 7264 6564  process recorded
-0000a370: 2065 7665 6e74 7320 7769 7468 2065 7861   events with exa
-0000a380: 6374 6c79 2d6f 6e63 6520 7365 6d61 6e74  ctly-once semant
-0000a390: 6963 732e 0a0a 5468 6973 206d 6574 686f  ics...This metho
-0000a3a0: 6420 7461 6b65 7320 616e 206f 7074 696f  d takes an optio
-0000a3b0: 6e61 6c20 6063 6f6d 6d69 745f 706f 7369  nal `commit_posi
-0000a3c0: 7469 6f6e 6020 6172 6775 6d65 6e74 2c20  tion` argument, 
-0000a3d0: 7768 6963 6820 6361 6e20 6265 0a75 7365  which can be.use
-0000a3e0: 6420 746f 2073 7065 6369 6679 2061 2063  d to specify a c
-0000a3f0: 6f6d 6d69 7420 706f 7369 7469 6f6e 2066  ommit position f
-0000a400: 726f 6d20 7768 6963 6820 746f 2073 7562  rom which to sub
-0000a410: 7363 7269 6265 2e20 5468 6520 6465 6661  scribe. The defa
-0000a420: 756c 740a 7661 6c75 6520 6973 2060 4e6f  ult.value is `No
-0000a430: 6e65 602c 2077 6869 6368 206d 6561 6e73  ne`, which means
-0000a440: 2074 6865 2073 7562 7363 7269 7074 696f   the subscriptio
-0000a450: 6e20 7769 6c6c 206f 7065 7261 7465 2066  n will operate f
-0000a460: 726f 6d20 7468 6520 6669 7273 740a 7265  rom the first.re
-0000a470: 636f 7264 6564 2065 7665 6e74 2069 6e20  corded event in 
-0000a480: 7468 6520 6461 7461 6261 7365 2e20 4966  the database. If
-0000a490: 2061 2063 6f6d 6d69 7420 706f 7369 7469   a commit positi
-0000a4a0: 6f6e 2069 7320 6769 7665 6e2c 2069 7420  on is given, it 
-0000a4b0: 6d75 7374 206d 6174 6368 0a61 6e20 6163  must match.an ac
-0000a4c0: 7475 616c 6c79 2065 7869 7374 696e 6720  tually existing 
-0000a4d0: 636f 6d6d 6974 2070 6f73 6974 696f 6e20  commit position 
-0000a4e0: 696e 2074 6865 2064 6174 6162 6173 652e  in the database.
-0000a4f0: 2054 6865 2072 6563 6f64 6564 2065 7665   The recoded eve
-0000a500: 6e74 7320 7468 6174 0a61 7265 206f 6274  nts that.are obt
-0000a510: 6169 6e65 6420 7769 6c6c 206e 6f74 2069  ained will not i
-0000a520: 6e63 6c75 6465 2074 6865 2065 7665 6e74  nclude the event
-0000a530: 2072 6563 6f72 6465 6420 6174 2074 6861   recorded at tha
-0000a540: 7420 636f 6d6d 6974 2070 6f73 6974 696f  t commit positio
-0000a550: 6e2e 0a0a 5468 6973 206d 6574 686f 6420  n...This method 
-0000a560: 616c 736f 2074 616b 6573 2066 6f75 7220  also takes four 
-0000a570: 6f74 6865 7220 6f70 7469 6f6e 616c 2061  other optional a
-0000a580: 7267 756d 656e 7473 2c20 6066 696c 7465  rguments, `filte
-0000a590: 725f 6578 636c 7564 6560 2c0a 6066 696c  r_exclude`,.`fil
-0000a5a0: 7465 725f 696e 636c 7564 6560 2c20 6066  ter_include`, `f
-0000a5b0: 696c 7465 725f 6279 5f73 7472 6561 6d5f  ilter_by_stream_
-0000a5c0: 6e61 6d65 602c 2061 6e64 2060 7469 6d65  name`, and `time
-0000a5d0: 6f75 7460 2e0a 0a54 6865 206f 7074 696f  out`...The optio
-0000a5e0: 6e61 6c20 6172 6775 6d65 6e74 2060 6669  nal argument `fi
-0000a5f0: 6c74 6572 5f65 7863 6c75 6465 6020 6973  lter_exclude` is
-0000a600: 2061 2073 6571 7565 6e63 6520 6f66 2072   a sequence of r
-0000a610: 6567 756c 6172 2065 7870 7265 7373 696f  egular expressio
-0000a620: 6e73 2074 6861 740a 6d61 7463 6820 7265  ns that.match re
-0000a630: 636f 7264 6564 2065 7665 6e74 7320 7468  corded events th
-0000a640: 6174 2073 686f 756c 6420 6e6f 7420 6265  at should not be
-0000a650: 2069 6e63 6c75 6465 642e 2054 6869 7320   included. This 
-0000a660: 6172 6775 6d65 6e74 2069 7320 6967 6e6f  argument is igno
-0000a670: 7265 640a 6966 2060 6669 6c74 6572 5f69  red.if `filter_i
-0000a680: 6e63 6c75 6465 6020 6973 2073 6574 2074  nclude` is set t
-0000a690: 6f20 6120 6e6f 6e2d 656d 7074 7920 7365  o a non-empty se
-0000a6a0: 7175 656e 6365 2e20 4279 2064 6566 6175  quence. By defau
-0000a6b0: 6c74 2c20 7468 6973 2061 7267 756d 656e  lt, this argumen
-0000a6c0: 7420 6973 2073 6574 0a74 6f20 6d61 7463  t is set.to matc
-0000a6d0: 6820 7468 6520 6576 656e 7420 7479 7065  h the event type
-0000a6e0: 7320 6f66 2022 7379 7374 656d 2065 7665  s of "system eve
-0000a6f0: 6e74 7322 2c20 736f 2074 6861 7420 4576  nts", so that Ev
-0000a700: 656e 7453 746f 7265 4442 2073 7973 7465  entStoreDB syste
-0000a710: 6d20 6576 656e 7473 0a77 696c 6c20 6e6f  m events.will no
-0000a720: 7420 6e6f 726d 616c 6c79 2062 6520 696e  t normally be in
-0000a730: 636c 7564 6564 2e20 5365 6520 7468 6520  cluded. See the 
-0000a740: 4e6f 7465 7320 7365 6374 696f 6e20 6265  Notes section be
-0000a750: 6c6f 7720 666f 7220 6d6f 7265 2069 6e66  low for more inf
-0000a760: 6f72 6d61 7469 6f6e 0a61 626f 7574 2066  ormation.about f
-0000a770: 696c 7465 7220 6578 7072 6573 7369 6f6e  ilter expression
-0000a780: 732e 0a0a 5468 6520 6f70 7469 6f6e 616c  s...The optional
-0000a790: 2061 7267 756d 656e 7420 6066 696c 7465   argument `filte
-0000a7a0: 725f 696e 636c 7564 6560 2069 7320 6120  r_include` is a 
-0000a7b0: 7365 7175 656e 6365 206f 6620 7265 6775  sequence of regu
-0000a7c0: 6c61 7220 6578 7072 6573 7369 6f6e 730a  lar expressions.
-0000a7d0: 7468 6174 206d 6174 6368 2072 6563 6f72  that match recor
-0000a7e0: 6465 6420 6576 656e 7473 2074 6861 7420  ded events that 
-0000a7f0: 7368 6f75 6c64 2062 6520 696e 636c 7564  should be includ
-0000a800: 6564 2e20 4279 2064 6566 6175 6c74 2c20  ed. By default, 
-0000a810: 7468 6973 2061 7267 756d 656e 740a 6973  this argument.is
-0000a820: 2061 6e20 656d 7074 7920 7475 706c 652e   an empty tuple.
-0000a830: 2049 6620 7468 6973 2061 7267 756d 656e   If this argumen
-0000a840: 7420 6973 2073 6574 2074 6f20 6120 6e6f  t is set to a no
-0000a850: 6e2d 656d 7074 7920 7365 7175 656e 6365  n-empty sequence
-0000a860: 2c20 7468 650a 6066 696c 7465 725f 6578  , the.`filter_ex
-0000a870: 636c 7564 6560 2061 7267 756d 656e 7420  clude` argument 
-0000a880: 6973 2069 676e 6f72 6564 2e0a 0a54 6865  is ignored...The
-0000a890: 206f 7074 696f 6e61 6c20 6172 6775 6d65   optional argume
-0000a8a0: 6e74 2060 6669 6c74 6572 5f62 795f 7374  nt `filter_by_st
-0000a8b0: 7265 616d 5f6e 616d 6560 2069 7320 6120  ream_name` is a 
-0000a8c0: 626f 6f6c 6561 6e20 7661 6c75 6520 7468  boolean value th
-0000a8d0: 6174 2069 6e64 6963 6174 6573 2077 6865  at indicates whe
-0000a8e0: 7468 6572 0a74 6865 2066 696c 7465 7220  ther.the filter 
-0000a8f0: 7769 6c6c 2061 7070 6c79 2074 6f20 6576  will apply to ev
-0000a900: 656e 7420 7479 7065 7320 6f72 2073 7472  ent types or str
-0000a910: 6561 6d20 6e61 6d65 732e 2042 7920 6465  eam names. By de
-0000a920: 6661 756c 742c 2074 6869 7320 7661 6c75  fault, this valu
-0000a930: 6520 6973 2060 4661 6c73 6560 0a61 6e64  e is `False`.and
-0000a940: 2073 6f20 7468 6520 6669 6c74 6572 696e   so the filterin
-0000a950: 6720 7769 6c6c 2061 7070 6c79 2074 6f20  g will apply to 
-0000a960: 7468 6520 6576 656e 7420 7479 7065 2073  the event type s
-0000a970: 7472 696e 6773 206f 6620 7265 636f 7264  trings of record
-0000a980: 6564 2065 7665 6e74 732e 0a0a 506c 6561  ed events...Plea
-0000a990: 7365 206e 6f74 652c 2074 6865 2066 696c  se note, the fil
-0000a9a0: 7465 7269 6e67 2068 6170 7065 6e73 206f  tering happens o
-0000a9b0: 6e20 7468 6520 4576 656e 7453 746f 7265  n the EventStore
-0000a9c0: 4442 2073 6572 7665 722c 2061 6e64 2074  DB server, and t
-0000a9d0: 6865 0a60 6c69 6d69 7460 2061 7267 756d  he.`limit` argum
-0000a9e0: 656e 7420 6973 2061 7070 6c69 6564 206f  ent is applied o
-0000a9f0: 6e20 7468 6520 7365 7276 6572 2061 6674  n the server aft
-0000aa00: 6572 2066 696c 7465 7269 6e67 2e20 5365  er filtering. Se
-0000aa10: 6520 6265 6c6f 7720 666f 720a 6d6f 7265  e below for.more
-0000aa20: 2069 6e66 6f72 6d61 7469 6f6e 2061 626f   information abo
-0000aa30: 7574 2066 696c 7465 7220 7265 6775 6c61  ut filter regula
-0000aa40: 7220 6578 7072 6573 7369 6f6e 732e 0a0a  r expressions...
-0000aa50: 5468 6520 6f70 7469 6f6e 616c 2060 7469  The optional `ti
-0000aa60: 6d65 6f75 7460 2061 7267 756d 656e 7420  meout` argument 
-0000aa70: 6973 2061 2050 7974 686f 6e20 6066 6c6f  is a Python `flo
-0000aa80: 6174 6020 7768 6963 6820 7365 7473 2061  at` which sets a
-0000aa90: 0a64 6561 646c 696e 6520 666f 7220 7468  .deadline for th
-0000aaa0: 6520 636f 6d70 6c65 7469 6f6e 206f 6620  e completion of 
-0000aab0: 7468 6520 6752 5043 206f 7065 7261 7469  the gRPC operati
-0000aac0: 6f6e 2e0a 0a54 6869 7320 6d65 7468 6f64  on...This method
-0000aad0: 2072 6574 7572 6e73 2061 2050 7974 686f   returns a Pytho
-0000aae0: 6e20 6974 6572 6174 6f72 2074 6861 7420  n iterator that 
-0000aaf0: 7969 656c 6473 2072 6563 6f72 6465 6420  yields recorded 
-0000ab00: 6576 656e 7473 2c20 696e 636c 7564 696e  events, includin
-0000ab10: 6720 6576 656e 7473 0a74 6861 7420 6172  g events.that ar
-0000ab20: 6520 7265 636f 7264 6564 2061 6674 6572  e recorded after
-0000ab30: 2074 6865 2073 7562 7363 7269 7074 696f   the subscriptio
-0000ab40: 6e20 7761 7320 6372 6561 7465 642e 2049  n was created. I
-0000ab50: 7465 7261 7469 6e67 206f 7665 7220 7468  terating over th
-0000ab60: 6973 206f 626a 6563 7420 7769 6c6c 0a74  is object will.t
-0000ab70: 6865 7265 666f 7265 206e 6f74 2073 746f  herefore not sto
-0000ab80: 702c 2075 6e6c 6573 7320 7468 6520 636f  p, unless the co
-0000ab90: 6e6e 6563 7469 6f6e 2074 6f20 7468 6520  nnection to the 
-0000aba0: 6461 7461 6261 7365 2069 7320 6c6f 7374  database is lost
-0000abb0: 2e20 5468 6520 6361 6c6c 2077 696c 6c0a  . The call will.
-0000abc0: 6265 2065 6e64 6564 2077 6865 6e20 7468  be ended when th
-0000abd0: 6520 6974 6572 6174 6f72 206f 626a 6563  e iterator objec
-0000abe0: 7420 6973 2064 656c 6574 6564 2066 726f  t is deleted fro
-0000abf0: 6d20 6d65 6d6f 7279 2c20 7768 6963 6820  m memory, which 
-0000ac00: 7769 6c6c 2068 6170 7065 6e20 7768 656e  will happen when
-0000ac10: 2074 6865 0a69 7465 7261 746f 7220 6f62   the.iterator ob
-0000ac20: 6a65 6374 2067 6f65 7320 6f75 7420 6f66  ject goes out of
-0000ac30: 2073 636f 7065 206f 7220 6973 2065 7870   scope or is exp
-0000ac40: 6c69 6369 746c 7920 6465 6c65 7465 6420  licitly deleted 
-0000ac50: 2873 6565 2062 656c 6f77 292e 2054 6865  (see below). The
-0000ac60: 2063 616c 6c0a 6d61 7920 616c 736f 2062   call.may also b
-0000ac70: 6520 636c 6f73 6564 2062 7920 7468 6520  e closed by the 
-0000ac80: 7365 7276 6572 2e0a 0a54 6865 2073 7562  server...The sub
-0000ac90: 7363 7269 7074 696f 6e20 6f62 6a65 6374  scription object
-0000aca0: 2063 616e 2062 6520 7573 6564 2064 6972   can be used dir
-0000acb0: 6563 746c 792c 2062 7574 2069 7420 6d69  ectly, but it mi
-0000acc0: 6768 7420 6265 2075 7365 6420 7769 7468  ght be used with
-0000acd0: 696e 2061 2074 6872 6561 6465 640a 6c6f  in a threaded.lo
-0000ace0: 6f70 2064 6564 6963 6174 6564 2074 6f20  op dedicated to 
-0000acf0: 7265 6365 6976 696e 6720 6576 656e 7473  receiving events
-0000ad00: 2074 6861 7420 6361 6e20 6265 2073 746f   that can be sto
-0000ad10: 7070 6564 2069 6e20 6120 636f 6e74 726f  pped in a contro
-0000ad20: 6c6c 6564 2077 6179 2c20 7769 7468 0a72  lled way, with.r
-0000ad30: 6563 6f72 6465 6420 6576 656e 7473 2070  ecorded events p
-0000ad40: 7574 206f 6e20 6120 7175 6575 6520 666f  ut on a queue fo
-0000ad50: 7220 7072 6f63 6573 7369 6e67 2069 6e20  r processing in 
-0000ad60: 6120 6469 6666 6572 656e 7420 7468 7265  a different thre
-0000ad70: 6164 2e20 5468 6973 2070 6163 6b61 6765  ad. This package
-0000ad80: 0a64 6f65 736e 2774 2070 726f 7669 6465  .doesn't provide
-0000ad90: 2073 7563 6820 6120 7468 7265 6164 6564   such a threaded
-0000ada0: 206f 7220 7175 6575 696e 6720 6f62 6a65   or queuing obje
-0000adb0: 6374 2063 6c61 7373 2e20 4a75 7374 206d  ct class. Just m
-0000adc0: 616b 6520 7375 7265 2074 6f20 7265 636f  ake sure to reco
-0000add0: 6e73 7472 7563 740a 7468 6520 7375 6273  nstruct.the subs
-0000ade0: 6372 6970 7469 6f6e 2028 616e 6420 7468  cription (and th
-0000adf0: 6520 7175 6575 6529 2075 7369 6e67 2074  e queue) using t
-0000ae00: 6865 206c 6173 7420 7265 636f 7264 6564  he last recorded
-0000ae10: 2063 6f6d 6d69 7420 706f 7369 7469 6f6e   commit position
-0000ae20: 2077 6865 6e20 7265 7375 6d69 6e67 0a74   when resuming.t
-0000ae30: 6865 2073 7562 7363 7269 7074 696f 6e20  he subscription 
-0000ae40: 6166 7465 7220 616e 2065 7272 6f72 2c20  after an error, 
-0000ae50: 746f 2062 6520 7375 7265 2061 6c6c 2065  to be sure all e
-0000ae60: 7665 6e74 7320 6172 6520 7072 6f63 6573  vents are proces
-0000ae70: 7365 6420 6f6e 6365 2e0a 0a54 6865 2065  sed once...The e
-0000ae80: 7861 6d70 6c65 2062 656c 6f77 2073 686f  xample below sho
-0000ae90: 7773 2068 6f77 2074 6f20 7375 6273 6372  ws how to subscr
-0000aea0: 6962 6520 746f 2072 6563 6569 7665 2061  ibe to receive a
-0000aeb0: 6c6c 2072 6563 6f72 6465 640a 6576 656e  ll recorded.even
-0000aec0: 7473 2066 726f 6d20 7468 6520 7374 6172  ts from the star
-0000aed0: 742c 2061 6e64 2074 6865 6e20 7265 7375  t, and then resu
-0000aee0: 6d69 6e67 2066 726f 6d20 6120 7370 6563  ming from a spec
-0000aef0: 6966 6963 2063 6f6d 6d69 7420 706f 7369  ific commit posi
-0000af00: 7469 6f6e 2e0a 5468 7265 6520 616c 7265  tion..Three alre
-0000af10: 6164 792d 7265 636f 7264 6564 2065 7665  ady-recorded eve
-0000af20: 6e74 7320 6172 6520 7265 6365 6976 6564  nts are received
-0000af30: 2c20 616e 6420 7468 656e 2074 6872 6565  , and then three
-0000af40: 206e 6577 2065 7665 6e74 7320 6172 650a   new events are.
-0000af50: 7265 636f 7264 6564 2c20 7768 6963 6820  recorded, which 
-0000af60: 6172 6520 7468 656e 2072 6563 6569 7665  are then receive
-0000af70: 6420 7669 6120 7468 6520 7375 6273 6372  d via the subscr
-0000af80: 6970 7469 6f6e 2e0a 0a60 6060 7079 7468  iption...```pyth
-0000af90: 6f6e 0a0a 2320 4170 7065 6e64 2061 6e20  on..# Append an 
-0000afa0: 6576 656e 7420 746f 2061 206e 6577 2073  event to a new s
-0000afb0: 7472 6561 6d2e 0a73 7472 6561 6d5f 6e61  tream..stream_na
-0000afc0: 6d65 3220 3d20 7374 7228 7575 6964 3428  me2 = str(uuid4(
-0000afd0: 2929 0a65 7665 6e74 3420 3d20 4e65 7745  )).event4 = NewE
-0000afe0: 7665 6e74 2874 7970 653d 274f 7264 6572  vent(type='Order
-0000aff0: 4372 6561 7465 6427 2c20 6461 7461 3d62  Created', data=b
-0000b000: 2764 6174 6134 2729 0a63 6c69 656e 742e  'data4').client.
-0000b010: 6170 7065 6e64 5f65 7665 6e74 7328 0a20  append_events(. 
-0000b020: 2020 2073 7472 6561 6d5f 6e61 6d65 3d73     stream_name=s
-0000b030: 7472 6561 6d5f 6e61 6d65 322c 0a20 2020  tream_name2,.   
-0000b040: 2065 7870 6563 7465 645f 706f 7369 7469   expected_positi
-0000b050: 6f6e 3d4e 6f6e 652c 0a20 2020 2065 7665  on=None,.    eve
-0000b060: 6e74 733d 5b65 7665 6e74 345d 2c0a 290a  nts=[event4],.).
-0000b070: 0a23 2053 7562 7363 7269 6265 2066 726f  .# Subscribe fro
-0000b080: 6d20 7468 6520 6669 7273 7420 7265 636f  m the first reco
-0000b090: 7264 6564 2065 7665 6e74 2069 6e20 7468  rded event in th
-0000b0a0: 6520 6461 7461 6261 7365 2e0a 7375 6273  e database..subs
-0000b0b0: 6372 6970 7469 6f6e 203d 2063 6c69 656e  cription = clien
-0000b0c0: 742e 7375 6273 6372 6962 655f 616c 6c5f  t.subscribe_all_
-0000b0d0: 6576 656e 7473 2829 0a72 6563 6569 7665  events().receive
-0000b0e0: 645f 6576 656e 7473 203d 205b 5d0a 0a23  d_events = []..#
-0000b0f0: 2050 726f 6365 7373 2065 7665 6e74 7320   Process events 
-0000b100: 7265 6365 6976 6564 2066 726f 6d20 7468  received from th
-0000b110: 6520 6361 7463 682d 7570 2073 7562 7363  e catch-up subsc
-0000b120: 7269 7074 696f 6e2e 0a66 6f72 2065 7665  ription..for eve
-0000b130: 6e74 2069 6e20 7375 6273 6372 6970 7469  nt in subscripti
-0000b140: 6f6e 3a0a 2020 2020 6c61 7374 5f63 6f6d  on:.    last_com
-0000b150: 6d69 745f 706f 7369 7469 6f6e 203d 2065  mit_position = e
-0000b160: 7665 6e74 2e63 6f6d 6d69 745f 706f 7369  vent.commit_posi
-0000b170: 7469 6f6e 0a20 2020 2072 6563 6569 7665  tion.    receive
-0000b180: 645f 6576 656e 7473 2e61 7070 656e 6428  d_events.append(
-0000b190: 6576 656e 7429 0a20 2020 2069 6620 6576  event).    if ev
-0000b1a0: 656e 742e 6964 203d 3d20 6576 656e 7434  ent.id == event4
-0000b1b0: 2e69 643a 0a20 2020 2020 2020 2062 7265  .id:.        bre
-0000b1c0: 616b 0a0a 6173 7365 7274 2072 6563 6569  ak..assert recei
-0000b1d0: 7665 645f 6576 656e 7473 5b2d 345d 2e69  ved_events[-4].i
-0000b1e0: 6420 3d3d 2065 7665 6e74 312e 6964 0a61  d == event1.id.a
-0000b1f0: 7373 6572 7420 7265 6365 6976 6564 5f65  ssert received_e
-0000b200: 7665 6e74 735b 2d33 5d2e 6964 203d 3d20  vents[-3].id == 
-0000b210: 6576 656e 7432 2e69 640a 6173 7365 7274  event2.id.assert
-0000b220: 2072 6563 6569 7665 645f 6576 656e 7473   received_events
-0000b230: 5b2d 325d 2e69 6420 3d3d 2065 7665 6e74  [-2].id == event
-0000b240: 332e 6964 0a61 7373 6572 7420 7265 6365  3.id.assert rece
-0000b250: 6976 6564 5f65 7665 6e74 735b 2d31 5d2e  ived_events[-1].
-0000b260: 6964 203d 3d20 6576 656e 7434 2e69 640a  id == event4.id.
-0000b270: 0a23 2041 7070 656e 6420 7375 6273 6571  .# Append subseq
-0000b280: 7565 6e74 2065 7665 6e74 7320 746f 2074  uent events to t
-0000b290: 6865 2073 7472 6561 6d2e 0a65 7665 6e74  he stream..event
-0000b2a0: 3520 3d20 4e65 7745 7665 6e74 2874 7970  5 = NewEvent(typ
-0000b2b0: 653d 274f 7264 6572 5570 6461 7465 6427  e='OrderUpdated'
-0000b2c0: 2c20 6461 7461 3d62 2764 6174 6135 2729  , data=b'data5')
-0000b2d0: 0a63 6c69 656e 742e 6170 7065 6e64 5f65  .client.append_e
-0000b2e0: 7665 6e74 7328 0a20 2020 2073 7472 6561  vents(.    strea
-0000b2f0: 6d5f 6e61 6d65 3d73 7472 6561 6d5f 6e61  m_name=stream_na
-0000b300: 6d65 322c 0a20 2020 2065 7870 6563 7465  me2,.    expecte
-0000b310: 645f 706f 7369 7469 6f6e 3d30 2c0a 2020  d_position=0,.  
-0000b320: 2020 6576 656e 7473 3d5b 6576 656e 7435    events=[event5
-0000b330: 5d2c 0a29 0a0a 2320 5265 6365 6976 6520  ],.)..# Receive 
-0000b340: 7375 6273 6571 7565 6e74 2065 7665 6e74  subsequent event
-0000b350: 7320 6672 6f6d 2074 6865 2073 7562 7363  s from the subsc
-0000b360: 7269 7074 696f 6e2e 0a66 6f72 2065 7665  ription..for eve
-0000b370: 6e74 2069 6e20 7375 6273 6372 6970 7469  nt in subscripti
-0000b380: 6f6e 3a0a 2020 2020 6c61 7374 5f63 6f6d  on:.    last_com
-0000b390: 6d69 745f 706f 7369 7469 6f6e 203d 2065  mit_position = e
-0000b3a0: 7665 6e74 2e63 6f6d 6d69 745f 706f 7369  vent.commit_posi
-0000b3b0: 7469 6f6e 0a20 2020 2072 6563 6569 7665  tion.    receive
-0000b3c0: 645f 6576 656e 7473 2e61 7070 656e 6428  d_events.append(
-0000b3d0: 6576 656e 7429 0a20 2020 2069 6620 6576  event).    if ev
-0000b3e0: 656e 742e 6964 203d 3d20 6576 656e 7435  ent.id == event5
-0000b3f0: 2e69 643a 0a20 2020 2020 2020 2062 7265  .id:.        bre
-0000b400: 616b 0a0a 0a61 7373 6572 7420 7265 6365  ak...assert rece
-0000b410: 6976 6564 5f65 7665 6e74 735b 2d35 5d2e  ived_events[-5].
-0000b420: 6964 203d 3d20 6576 656e 7431 2e69 640a  id == event1.id.
-0000b430: 6173 7365 7274 2072 6563 6569 7665 645f  assert received_
-0000b440: 6576 656e 7473 5b2d 345d 2e69 6420 3d3d  events[-4].id ==
-0000b450: 2065 7665 6e74 322e 6964 0a61 7373 6572   event2.id.asser
-0000b460: 7420 7265 6365 6976 6564 5f65 7665 6e74  t received_event
-0000b470: 735b 2d33 5d2e 6964 203d 3d20 6576 656e  s[-3].id == even
-0000b480: 7433 2e69 640a 6173 7365 7274 2072 6563  t3.id.assert rec
-0000b490: 6569 7665 645f 6576 656e 7473 5b2d 325d  eived_events[-2]
-0000b4a0: 2e69 6420 3d3d 2065 7665 6e74 342e 6964  .id == event4.id
-0000b4b0: 0a61 7373 6572 7420 7265 6365 6976 6564  .assert received
-0000b4c0: 5f65 7665 6e74 735b 2d31 5d2e 6964 203d  _events[-1].id =
-0000b4d0: 3d20 6576 656e 7435 2e69 640a 0a0a 2320  = event5.id...# 
-0000b4e0: 4170 7065 6e64 206d 6f72 6520 6576 656e  Append more even
-0000b4f0: 7473 2074 6f20 7468 6520 7374 7265 616d  ts to the stream
-0000b500: 2e0a 6576 656e 7436 203d 204e 6577 4576  ..event6 = NewEv
-0000b510: 656e 7428 7479 7065 3d27 4f72 6465 7244  ent(type='OrderD
-0000b520: 656c 6574 6564 272c 2064 6174 613d 6227  eleted', data=b'
-0000b530: 6461 7461 3627 290a 636c 6965 6e74 2e61  data6').client.a
-0000b540: 7070 656e 645f 6576 656e 7473 280a 2020  ppend_events(.  
-0000b550: 2020 7374 7265 616d 5f6e 616d 653d 7374    stream_name=st
-0000b560: 7265 616d 5f6e 616d 6532 2c0a 2020 2020  ream_name2,.    
-0000b570: 6578 7065 6374 6564 5f70 6f73 6974 696f  expected_positio
-0000b580: 6e3d 312c 0a20 2020 2065 7665 6e74 733d  n=1,.    events=
-0000b590: 5b65 7665 6e74 365d 2c0a 290a 0a0a 2320  [event6],.)...# 
-0000b5a0: 5265 7375 6d65 2073 7562 7363 7269 6269  Resume subscribi
-0000b5b0: 6e67 2066 726f 6d20 7468 6520 6c61 7374  ng from the last
-0000b5c0: 2063 6f6d 6d69 7420 706f 7369 7469 6f6e   commit position
-0000b5d0: 2e0a 7375 6273 6372 6970 7469 6f6e 203d  ..subscription =
-0000b5e0: 2063 6c69 656e 742e 7375 6273 6372 6962   client.subscrib
-0000b5f0: 655f 616c 6c5f 6576 656e 7473 280a 2020  e_all_events(.  
-0000b600: 2020 636f 6d6d 6974 5f70 6f73 6974 696f    commit_positio
-0000b610: 6e3d 6c61 7374 5f63 6f6d 6d69 745f 706f  n=last_commit_po
-0000b620: 7369 7469 6f6e 0a29 0a0a 0a23 2043 6174  sition.)...# Cat
-0000b630: 6368 2075 7020 6279 2072 6563 6569 7669  ch up by receivi
-0000b640: 6e67 2074 6865 206e 6577 2065 7665 6e74  ng the new event
-0000b650: 2066 726f 6d20 7468 6520 7375 6273 6372   from the subscr
-0000b660: 6970 7469 6f6e 2e0a 666f 7220 6576 656e  iption..for even
-0000b670: 7420 696e 2073 7562 7363 7269 7074 696f  t in subscriptio
-0000b680: 6e3a 0a20 2020 2072 6563 6569 7665 645f  n:.    received_
-0000b690: 6576 656e 7473 2e61 7070 656e 6428 6576  events.append(ev
-0000b6a0: 656e 7429 0a20 2020 2069 6620 6576 656e  ent).    if even
-0000b6b0: 742e 6964 203d 3d20 6576 656e 7436 2e69  t.id == event6.i
-0000b6c0: 643a 0a20 2020 2020 2020 2062 7265 616b  d:.        break
-0000b6d0: 0a0a 6173 7365 7274 2072 6563 6569 7665  ..assert receive
-0000b6e0: 645f 6576 656e 7473 5b2d 365d 2e69 6420  d_events[-6].id 
-0000b6f0: 3d3d 2065 7665 6e74 312e 6964 0a61 7373  == event1.id.ass
-0000b700: 6572 7420 7265 6365 6976 6564 5f65 7665  ert received_eve
-0000b710: 6e74 735b 2d35 5d2e 6964 203d 3d20 6576  nts[-5].id == ev
-0000b720: 656e 7432 2e69 640a 6173 7365 7274 2072  ent2.id.assert r
-0000b730: 6563 6569 7665 645f 6576 656e 7473 5b2d  eceived_events[-
-0000b740: 345d 2e69 6420 3d3d 2065 7665 6e74 332e  4].id == event3.
-0000b750: 6964 0a61 7373 6572 7420 7265 6365 6976  id.assert receiv
-0000b760: 6564 5f65 7665 6e74 735b 2d33 5d2e 6964  ed_events[-3].id
-0000b770: 203d 3d20 6576 656e 7434 2e69 640a 6173   == event4.id.as
-0000b780: 7365 7274 2072 6563 6569 7665 645f 6576  sert received_ev
-0000b790: 656e 7473 5b2d 325d 2e69 6420 3d3d 2065  ents[-2].id == e
-0000b7a0: 7665 6e74 352e 6964 0a61 7373 6572 7420  vent5.id.assert 
-0000b7b0: 7265 6365 6976 6564 5f65 7665 6e74 735b  received_events[
-0000b7c0: 2d31 5d2e 6964 203d 3d20 6576 656e 7436  -1].id == event6
-0000b7d0: 2e69 640a 0a0a 2320 4170 7065 6e64 2074  .id...# Append t
-0000b7e0: 6872 6565 206d 6f72 6520 6576 656e 7473  hree more events
-0000b7f0: 2074 6f20 6120 6e65 7720 7374 7265 616d   to a new stream
-0000b800: 2e0a 7374 7265 616d 5f6e 616d 6533 203d  ..stream_name3 =
-0000b810: 2073 7472 2875 7569 6434 2829 290a 6576   str(uuid4()).ev
-0000b820: 656e 7437 203d 204e 6577 4576 656e 7428  ent7 = NewEvent(
-0000b830: 7479 7065 3d27 4f72 6465 7243 7265 6174  type='OrderCreat
-0000b840: 6564 272c 2064 6174 613d 6227 6461 7461  ed', data=b'data
-0000b850: 3727 290a 6576 656e 7438 203d 204e 6577  7').event8 = New
-0000b860: 4576 656e 7428 7479 7065 3d27 4f72 6465  Event(type='Orde
-0000b870: 7255 7064 6174 6564 272c 2064 6174 613d  rUpdated', data=
-0000b880: 6227 6461 7461 3827 290a 6576 656e 7439  b'data8').event9
-0000b890: 203d 204e 6577 4576 656e 7428 7479 7065   = NewEvent(type
-0000b8a0: 3d27 4f72 6465 7244 656c 6574 6564 272c  ='OrderDeleted',
-0000b8b0: 2064 6174 613d 6227 6461 7461 3927 290a   data=b'data9').
-0000b8c0: 0a63 6c69 656e 742e 6170 7065 6e64 5f65  .client.append_e
-0000b8d0: 7665 6e74 7328 0a20 2020 2073 7472 6561  vents(.    strea
-0000b8e0: 6d5f 6e61 6d65 3d73 7472 6561 6d5f 6e61  m_name=stream_na
-0000b8f0: 6d65 332c 0a20 2020 2065 7870 6563 7465  me3,.    expecte
-0000b900: 645f 706f 7369 7469 6f6e 3d4e 6f6e 652c  d_position=None,
-0000b910: 0a20 2020 2065 7665 6e74 733d 5b65 7665  .    events=[eve
-0000b920: 6e74 372c 2065 7665 6e74 382c 2065 7665  nt7, event8, eve
-0000b930: 6e74 395d 2c0a 290a 0a23 2052 6563 6569  nt9],.)..# Recei
-0000b940: 7665 2074 6865 2074 6872 6565 206e 6577  ve the three new
-0000b950: 2065 7665 6e74 7320 6672 6f6d 2074 6865   events from the
-0000b960: 2072 6573 756d 6564 2073 7562 7363 7269   resumed subscri
-0000b970: 7074 696f 6e2e 0a66 6f72 2065 7665 6e74  ption..for event
-0000b980: 2069 6e20 7375 6273 6372 6970 7469 6f6e   in subscription
-0000b990: 3a0a 2020 2020 7265 6365 6976 6564 5f65  :.    received_e
-0000b9a0: 7665 6e74 732e 6170 7065 6e64 2865 7665  vents.append(eve
-0000b9b0: 6e74 290a 2020 2020 6966 2065 7665 6e74  nt).    if event
-0000b9c0: 2e69 6420 3d3d 2065 7665 6e74 392e 6964  .id == event9.id
-0000b9d0: 3a0a 2020 2020 2020 2020 6272 6561 6b0a  :.        break.
-0000b9e0: 0a61 7373 6572 7420 7265 6365 6976 6564  .assert received
-0000b9f0: 5f65 7665 6e74 735b 2d39 5d2e 6964 203d  _events[-9].id =
-0000ba00: 3d20 6576 656e 7431 2e69 640a 6173 7365  = event1.id.asse
-0000ba10: 7274 2072 6563 6569 7665 645f 6576 656e  rt received_even
-0000ba20: 7473 5b2d 385d 2e69 6420 3d3d 2065 7665  ts[-8].id == eve
-0000ba30: 6e74 322e 6964 0a61 7373 6572 7420 7265  nt2.id.assert re
-0000ba40: 6365 6976 6564 5f65 7665 6e74 735b 2d37  ceived_events[-7
-0000ba50: 5d2e 6964 203d 3d20 6576 656e 7433 2e69  ].id == event3.i
-0000ba60: 640a 6173 7365 7274 2072 6563 6569 7665  d.assert receive
-0000ba70: 645f 6576 656e 7473 5b2d 365d 2e69 6420  d_events[-6].id 
-0000ba80: 3d3d 2065 7665 6e74 342e 6964 0a61 7373  == event4.id.ass
-0000ba90: 6572 7420 7265 6365 6976 6564 5f65 7665  ert received_eve
-0000baa0: 6e74 735b 2d35 5d2e 6964 203d 3d20 6576  nts[-5].id == ev
-0000bab0: 656e 7435 2e69 640a 6173 7365 7274 2072  ent5.id.assert r
-0000bac0: 6563 6569 7665 645f 6576 656e 7473 5b2d  eceived_events[-
-0000bad0: 345d 2e69 6420 3d3d 2065 7665 6e74 362e  4].id == event6.
-0000bae0: 6964 0a61 7373 6572 7420 7265 6365 6976  id.assert receiv
-0000baf0: 6564 5f65 7665 6e74 735b 2d33 5d2e 6964  ed_events[-3].id
-0000bb00: 203d 3d20 6576 656e 7437 2e69 640a 6173   == event7.id.as
-0000bb10: 7365 7274 2072 6563 6569 7665 645f 6576  sert received_ev
-0000bb20: 656e 7473 5b2d 325d 2e69 6420 3d3d 2065  ents[-2].id == e
-0000bb30: 7665 6e74 382e 6964 0a61 7373 6572 7420  vent8.id.assert 
-0000bb40: 7265 6365 6976 6564 5f65 7665 6e74 735b  received_events[
-0000bb50: 2d31 5d2e 6964 203d 3d20 6576 656e 7439  -1].id == event9
-0000bb60: 2e69 640a 6060 600a 0a54 6865 2063 6174  .id.```..The cat
-0000bb70: 6368 2d75 7020 7375 6273 6372 6970 7469  ch-up subscripti
-0000bb80: 6f6e 2063 616c 6c20 6973 2065 6e64 6564  on call is ended
-0000bb90: 2061 7320 736f 6f6e 2061 7320 7468 6520   as soon as the 
-0000bba0: 7375 6273 6372 6970 7469 6f6e 206f 626a  subscription obj
-0000bbb0: 6563 740a 676f 6573 206f 7574 206f 6620  ect.goes out of 
-0000bbc0: 7363 6f70 6520 6f72 2069 7320 6578 706c  scope or is expl
-0000bbd0: 6963 6974 6c79 2064 656c 6574 6564 2066  icitly deleted f
-0000bbe0: 726f 6d20 6d65 6d6f 7279 2e0a 0a60 6060  rom memory...```
-0000bbf0: 7079 7468 6f6e 0a23 2045 6e64 2074 6865  python.# End the
-0000bc00: 2073 7562 7363 7269 7074 696f 6e2e 0a64   subscription..d
-0000bc10: 656c 2073 7562 7363 7269 7074 696f 6e0a  el subscription.
-0000bc20: 6060 600a 0a23 2323 2053 7562 7363 7269  ```..### Subscri
-0000bc30: 6265 2073 7472 6561 6d20 6576 656e 7473  be stream events
-0000bc40: 0a0a 5468 6560 7375 6273 6372 6962 655f  ..The`subscribe_
-0000bc50: 7374 7265 616d 5f65 7665 6e74 7328 2960  stream_events()`
-0000bc60: 206d 6574 686f 6420 6361 6e20 6265 2075   method can be u
-0000bc70: 7365 6420 746f 2073 7461 7274 2061 2022  sed to start a "
-0000bc80: 6361 7463 682d 7570 2220 7375 6273 6372  catch-up" subscr
-0000bc90: 6970 7469 6f6e 0a74 6861 7420 6361 6e20  iption.that can 
-0000bca0: 7265 7475 726e 2065 7665 6e74 7320 7468  return events th
-0000bcb0: 6174 2061 7265 2072 6563 6f72 6465 6420  at are recorded 
-0000bcc0: 696e 2061 2073 696e 676c 6520 7374 7265  in a single stre
-0000bcd0: 616d 2e0a 0a54 6869 7320 6d65 7468 6f64  am...This method
-0000bce0: 2074 616b 6573 2061 2072 6571 7569 7265   takes a require
-0000bcf0: 6420 6073 7472 6561 6d5f 6e61 6d65 6020  d `stream_name` 
-0000bd00: 6172 6775 6d65 6e74 2c20 7768 6963 6820  argument, which 
-0000bd10: 7370 6563 6966 6965 7320 7468 6520 6e61  specifies the na
-0000bd20: 6d65 206f 6620 7468 6520 7374 7265 616d  me of the stream
-0000bd30: 0a66 726f 6d20 7768 6963 6820 7265 636f  .from which reco
-0000bd40: 7264 6564 2065 7665 6e74 7320 7769 6c6c  rded events will
-0000bd50: 2062 6520 7265 6365 6976 6564 2e0a 0a54   be received...T
-0000bd60: 6869 7320 6d65 7468 6f64 2061 6c73 6f20  his method also 
-0000bd70: 7461 6b65 7320 7477 6f20 6f70 7469 6f6e  takes two option
-0000bd80: 616c 2061 7267 756d 656e 7473 2c20 6073  al arguments, `s
-0000bd90: 7472 6561 6d5f 706f 7369 7469 6f6e 602c  tream_position`,
-0000bda0: 2061 6e64 2060 7469 6d65 6f75 7460 2e0a   and `timeout`..
-0000bdb0: 0a54 6865 206f 7074 696f 6e61 6c20 6073  .The optional `s
-0000bdc0: 7472 6561 6d5f 706f 7369 7469 6f6e 6020  tream_position` 
-0000bdd0: 6172 6775 6d65 6e74 2073 7065 6369 6669  argument specifi
-0000bde0: 6573 2061 2070 6f73 6974 696f 6e20 696e  es a position in
-0000bdf0: 2074 6865 2073 7472 6561 6d20 6672 6f6d   the stream from
-0000be00: 2077 6869 6368 0a72 6563 6f72 6465 6420   which.recorded 
-0000be10: 6576 656e 7473 2077 696c 6c20 6265 2072  events will be r
-0000be20: 6563 6569 7665 642e 2054 6865 2065 7665  eceived. The eve
-0000be30: 6e74 2061 7420 7468 6520 7370 6563 6966  nt at the specif
-0000be40: 6965 6420 7374 7265 616d 2070 6f73 6974  ied stream posit
-0000be50: 696f 6e20 7769 6c6c 206e 6f74 0a62 6520  ion will not.be 
-0000be60: 696e 636c 7564 6564 2e0a 0a54 6865 206f  included...The o
-0000be70: 7074 696f 6e61 6c20 6074 696d 656f 7574  ptional `timeout
-0000be80: 6020 6172 6775 6d65 6e74 2069 7320 6120  ` argument is a 
-0000be90: 5079 7468 6f6e 2060 666c 6f61 7460 2074  Python `float` t
-0000bea0: 6861 7420 7365 7473 0a61 2064 6561 646c  hat sets.a deadl
-0000beb0: 696e 6520 666f 7220 7468 6520 636f 6d70  ine for the comp
-0000bec0: 6c65 7469 6f6e 206f 6620 7468 6520 6752  letion of the gR
-0000bed0: 5043 206f 7065 7261 7469 6f6e 2e0a 0a54  PC operation...T
-0000bee0: 6865 2065 7861 6d70 6c65 2062 656c 6f77  he example below
-0000bef0: 2073 686f 7773 2068 6f77 2074 6f20 7374   shows how to st
-0000bf00: 6172 7420 6120 6361 7463 682d 7570 2073  art a catch-up s
-0000bf10: 7562 7363 7269 7074 696f 6e20 746f 2061  ubscription to a
-0000bf20: 2073 7472 6561 6d2e 0a0a 6060 6070 7974   stream...```pyt
-0000bf30: 686f 6e0a 0a23 2053 7562 7363 7269 6265  hon..# Subscribe
-0000bf40: 2074 6f20 6576 656e 7473 2066 726f 6d20   to events from 
-0000bf50: 7374 7265 616d 322c 2066 726f 6d20 7468  stream2, from th
-0000bf60: 6520 7374 6172 742e 0a73 7562 7363 7269  e start..subscri
-0000bf70: 7074 696f 6e20 3d20 636c 6965 6e74 2e73  ption = client.s
-0000bf80: 7562 7363 7269 6265 5f73 7472 6561 6d5f  ubscribe_stream_
-0000bf90: 6576 656e 7473 2873 7472 6561 6d5f 6e61  events(stream_na
-0000bfa0: 6d65 3d73 7472 6561 6d5f 6e61 6d65 3229  me=stream_name2)
-0000bfb0: 0a0a 2320 5265 6164 2066 726f 6d20 7468  ..# Read from th
-0000bfc0: 6520 7375 6273 6372 6970 7469 6f6e 2e0a  e subscription..
-0000bfd0: 6576 656e 7473 203d 205b 5d0a 666f 7220  events = [].for 
-0000bfe0: 6576 656e 7420 696e 2073 7562 7363 7269  event in subscri
-0000bff0: 7074 696f 6e3a 0a20 2020 2065 7665 6e74  ption:.    event
-0000c000: 732e 6170 7065 6e64 2865 7665 6e74 290a  s.append(event).
-0000c010: 2020 2020 6966 2065 7665 6e74 2e69 6420      if event.id 
-0000c020: 3d3d 2065 7665 6e74 362e 6964 3a0a 2020  == event6.id:.  
-0000c030: 2020 2020 2020 6272 6561 6b0a 0a23 2043        break..# C
-0000c040: 6865 636b 2077 6520 676f 7420 6576 656e  heck we got even
-0000c050: 7473 206f 6e6c 7920 6672 6f6d 2073 7472  ts only from str
-0000c060: 6561 6d32 2e0a 6173 7365 7274 206c 656e  eam2..assert len
-0000c070: 2865 7665 6e74 7329 203d 3d20 330a 6576  (events) == 3.ev
-0000c080: 656e 7473 5b30 5d2e 7374 7265 616d 5f6e  ents[0].stream_n
-0000c090: 616d 6520 3d3d 2073 7472 6561 6d5f 6e61  ame == stream_na
-0000c0a0: 6d65 320a 6576 656e 7473 5b31 5d2e 7374  me2.events[1].st
-0000c0b0: 7265 616d 5f6e 616d 6520 3d3d 2073 7472  ream_name == str
-0000c0c0: 6561 6d5f 6e61 6d65 320a 6576 656e 7473  eam_name2.events
-0000c0d0: 5b32 5d2e 7374 7265 616d 5f6e 616d 6520  [2].stream_name 
-0000c0e0: 3d3d 2073 7472 6561 6d5f 6e61 6d65 320a  == stream_name2.
-0000c0f0: 0a23 2041 7070 656e 6420 616e 6f74 6865  .# Append anothe
-0000c100: 7220 6576 656e 7420 746f 2073 7472 6561  r event to strea
-0000c110: 6d33 2e0a 6576 656e 7431 3020 3d20 4e65  m3..event10 = Ne
-0000c120: 7745 7665 6e74 2874 7970 653d 224f 7264  wEvent(type="Ord
-0000c130: 6572 556e 6465 6c65 7465 6422 2c20 6461  erUndeleted", da
-0000c140: 7461 3d62 2764 6174 6131 3027 290a 636c  ta=b'data10').cl
-0000c150: 6965 6e74 2e61 7070 656e 645f 6576 656e  ient.append_even
-0000c160: 7473 280a 2020 2020 7374 7265 616d 5f6e  ts(.    stream_n
-0000c170: 616d 653d 7374 7265 616d 5f6e 616d 6533  ame=stream_name3
-0000c180: 2c0a 2020 2020 6578 7065 6374 6564 5f70  ,.    expected_p
-0000c190: 6f73 6974 696f 6e3d 322c 0a20 2020 2065  osition=2,.    e
-0000c1a0: 7665 6e74 733d 5b65 7665 6e74 3130 5d2c  vents=[event10],
-0000c1b0: 0a29 0a0a 2320 4170 7065 6e64 2061 6e6f  .)..# Append ano
-0000c1c0: 7468 6572 2065 7665 6e74 2074 6f20 7374  ther event to st
-0000c1d0: 7265 616d 322e 0a65 7665 6e74 3131 203d  ream2..event11 =
-0000c1e0: 204e 6577 4576 656e 7428 7479 7065 3d22   NewEvent(type="
-0000c1f0: 4f72 6465 7255 6e64 656c 6574 6564 222c  OrderUndeleted",
-0000c200: 2064 6174 613d 6227 6461 7461 3131 2729   data=b'data11')
-0000c210: 0a63 6c69 656e 742e 6170 7065 6e64 5f65  .client.append_e
-0000c220: 7665 6e74 7328 0a20 2020 2073 7472 6561  vents(.    strea
-0000c230: 6d5f 6e61 6d65 3d73 7472 6561 6d5f 6e61  m_name=stream_na
-0000c240: 6d65 322c 0a20 2020 2065 7870 6563 7465  me2,.    expecte
-0000c250: 645f 706f 7369 7469 6f6e 3d32 2c0a 2020  d_position=2,.  
-0000c260: 2020 6576 656e 7473 3d5b 6576 656e 7431    events=[event1
-0000c270: 315d 0a29 0a0a 2320 436f 6e74 696e 7565  1].)..# Continue
-0000c280: 2072 6561 6469 6e67 2066 726f 6d20 7468   reading from th
-0000c290: 6520 7375 6273 6372 6970 7469 6f6e 2e0a  e subscription..
-0000c2a0: 666f 7220 6576 656e 7420 696e 2073 7562  for event in sub
-0000c2b0: 7363 7269 7074 696f 6e3a 0a20 2020 2065  scription:.    e
-0000c2c0: 7665 6e74 732e 6170 7065 6e64 2865 7665  vents.append(eve
-0000c2d0: 6e74 290a 2020 2020 6966 2065 7665 6e74  nt).    if event
-0000c2e0: 2e69 6420 3d3d 2065 7665 6e74 3131 2e69  .id == event11.i
-0000c2f0: 643a 0a20 2020 2020 2020 2062 7265 616b  d:.        break
-0000c300: 0a0a 2320 4368 6563 6b20 7765 2067 6f74  ..# Check we got
-0000c310: 2065 7665 6e74 7320 6f6e 6c79 2066 726f   events only fro
-0000c320: 6d20 7374 7265 616d 322e 0a61 7373 6572  m stream2..asser
-0000c330: 7420 6c65 6e28 6576 656e 7473 2920 3d3d  t len(events) ==
-0000c340: 2034 0a65 7665 6e74 735b 305d 2e73 7472   4.events[0].str
-0000c350: 6561 6d5f 6e61 6d65 203d 3d20 7374 7265  eam_name == stre
-0000c360: 616d 5f6e 616d 6532 0a65 7665 6e74 735b  am_name2.events[
-0000c370: 315d 2e73 7472 6561 6d5f 6e61 6d65 203d  1].stream_name =
-0000c380: 3d20 7374 7265 616d 5f6e 616d 6532 0a65  = stream_name2.e
-0000c390: 7665 6e74 735b 325d 2e73 7472 6561 6d5f  vents[2].stream_
-0000c3a0: 6e61 6d65 203d 3d20 7374 7265 616d 5f6e  name == stream_n
-0000c3b0: 616d 6532 0a65 7665 6e74 735b 335d 2e73  ame2.events[3].s
-0000c3c0: 7472 6561 6d5f 6e61 6d65 203d 3d20 7374  tream_name == st
-0000c3d0: 7265 616d 5f6e 616d 6532 0a60 6060 0a0a  ream_name2.```..
-0000c3e0: 5468 6520 6578 616d 706c 6520 6265 6c6f  The example belo
-0000c3f0: 7720 7368 6f77 7320 686f 7720 746f 2073  w shows how to s
-0000c400: 7461 7274 2061 2063 6174 6368 2d75 7020  tart a catch-up 
-0000c410: 7375 6273 6372 6970 7469 6f6e 2074 6f20  subscription to 
-0000c420: 6120 7374 7265 616d 2066 726f 6d20 610a  a stream from a.
-0000c430: 7370 6563 6966 6963 2073 7472 6561 6d20  specific stream 
-0000c440: 706f 7369 7469 6f6e 2e0a 0a60 6060 7079  position...```py
-0000c450: 7468 6f6e 0a0a 2320 5375 6273 6372 6962  thon..# Subscrib
-0000c460: 6520 746f 2065 7665 6e74 7320 6672 6f6d  e to events from
-0000c470: 2073 7472 6561 6d32 2c20 6672 6f6d 2074   stream2, from t
-0000c480: 6865 2073 7461 7274 2e0a 7375 6273 6372  he start..subscr
-0000c490: 6970 7469 6f6e 203d 2063 6c69 656e 742e  iption = client.
-0000c4a0: 7375 6273 6372 6962 655f 7374 7265 616d  subscribe_stream
-0000c4b0: 5f65 7665 6e74 7328 0a20 2020 2073 7472  _events(.    str
-0000c4c0: 6561 6d5f 6e61 6d65 3d73 7472 6561 6d5f  eam_name=stream_
-0000c4d0: 6e61 6d65 322c 0a20 2020 2073 7472 6561  name2,.    strea
-0000c4e0: 6d5f 706f 7369 7469 6f6e 3d31 2c0a 290a  m_position=1,.).
-0000c4f0: 0a23 2052 6561 6420 6576 656e 7420 6672  .# Read event fr
-0000c500: 6f6d 2074 6865 2073 7562 7363 7269 7074  om the subscript
-0000c510: 696f 6e2e 0a65 7665 6e74 7320 3d20 5b5d  ion..events = []
-0000c520: 0a66 6f72 2065 7665 6e74 2069 6e20 7375  .for event in su
-0000c530: 6273 6372 6970 7469 6f6e 3a0a 2020 2020  bscription:.    
-0000c540: 6576 656e 7473 2e61 7070 656e 6428 6576  events.append(ev
-0000c550: 656e 7429 0a20 2020 2069 6620 6576 656e  ent).    if even
-0000c560: 742e 6964 203d 3d20 6576 656e 7431 312e  t.id == event11.
-0000c570: 6964 3a0a 2020 2020 2020 2020 6272 6561  id:.        brea
-0000c580: 6b0a 0a23 2043 6865 636b 2077 6520 676f  k..# Check we go
-0000c590: 7420 6576 656e 7473 206f 6e6c 7920 6166  t events only af
-0000c5a0: 7465 7220 706f 7369 7469 6f6e 2031 2e0a  ter position 1..
-0000c5b0: 6173 7365 7274 206c 656e 2865 7665 6e74  assert len(event
-0000c5c0: 7329 203d 3d20 320a 6576 656e 7473 5b30  s) == 2.events[0
-0000c5d0: 5d2e 6964 203d 3d20 6576 656e 7436 2e69  ].id == event6.i
-0000c5e0: 640a 6576 656e 7473 5b30 5d2e 7374 7265  d.events[0].stre
-0000c5f0: 616d 5f70 6f73 6974 696f 6e20 3d3d 2032  am_position == 2
-0000c600: 0a65 7665 6e74 735b 305d 2e73 7472 6561  .events[0].strea
-0000c610: 6d5f 6e61 6d65 203d 3d20 7374 7265 616d  m_name == stream
-0000c620: 5f6e 616d 6532 0a65 7665 6e74 735b 315d  _name2.events[1]
-0000c630: 2e69 6420 3d3d 2065 7665 6e74 3131 2e69  .id == event11.i
-0000c640: 640a 6576 656e 7473 5b31 5d2e 7374 7265  d.events[1].stre
-0000c650: 616d 5f70 6f73 6974 696f 6e20 3d3d 2033  am_position == 3
-0000c660: 0a65 7665 6e74 735b 315d 2e73 7472 6561  .events[1].strea
-0000c670: 6d5f 6e61 6d65 203d 3d20 7374 7265 616d  m_name == stream
-0000c680: 5f6e 616d 6532 0a60 6060 0a0a 2323 2050  _name2.```..## P
-0000c690: 6572 7369 7374 656e 7420 7375 6273 6372  ersistent subscr
-0000c6a0: 6970 7469 6f6e 730a 0a23 2323 2043 7265  iptions..### Cre
-0000c6b0: 6174 6520 7375 6273 6372 6970 7469 6f6e  ate subscription
-0000c6c0: 0a0a 2a72 6571 7569 7265 7320 6c65 6164  ..*requires lead
-0000c6d0: 6572 2a0a 0a54 6865 206d 6574 686f 6420  er*..The method 
-0000c6e0: 6063 7265 6174 655f 7375 6273 6372 6970  `create_subscrip
-0000c6f0: 7469 6f6e 2829 6020 6361 6e20 6265 2075  tion()` can be u
-0000c700: 7365 6420 746f 2063 7265 6174 6520 610a  sed to create a.
-0000c710: 2270 6572 7369 7374 656e 7420 7375 6273  "persistent subs
-0000c720: 6372 6970 7469 6f6e 2220 746f 2045 7665  cription" to Eve
-0000c730: 6e74 5374 6f72 6544 422e 0a0a 5468 6973  ntStoreDB...This
-0000c740: 206d 6574 686f 6420 7461 6b65 7320 6120   method takes a 
-0000c750: 7265 7175 6972 6564 2060 6772 6f75 705f  required `group_
-0000c760: 6e61 6d65 6020 6172 6775 6d65 6e74 2c20  name` argument, 
-0000c770: 7768 6963 6820 6973 2074 6865 0a6e 616d  which is the.nam
-0000c780: 6520 6f66 2061 2022 6772 6f75 7022 206f  e of a "group" o
-0000c790: 6620 636f 6e73 756d 6572 7320 6f66 2074  f consumers of t
-0000c7a0: 6865 2073 7562 7363 7269 7074 696f 6e2e  he subscription.
-0000c7b0: 0a0a 5468 6973 206d 6574 686f 6420 616c  ..This method al
-0000c7c0: 736f 2074 616b 6573 2073 6576 656e 206f  so takes seven o
-0000c7d0: 7074 696f 6e61 6c20 6172 6775 6d65 6e74  ptional argument
-0000c7e0: 732c 2060 6672 6f6d 5f65 6e64 602c 2060  s, `from_end`, `
-0000c7f0: 636f 6d6d 6974 5f70 6f73 6974 696f 6e60  commit_position`
-0000c800: 2c0a 6066 696c 7465 725f 6578 636c 7564  ,.`filter_exclud
-0000c810: 6560 2c20 6066 696c 7465 725f 696e 636c  e`, `filter_incl
-0000c820: 7564 6560 2c20 6066 696c 7465 725f 6279  ude`, `filter_by
-0000c830: 5f73 7472 6561 6d5f 6e61 6d65 602c 2060  _stream_name`, `
-0000c840: 636f 6e73 756d 6572 5f73 7472 6174 6567  consumer_strateg
-0000c850: 7960 2c0a 616e 6420 6074 696d 656f 7574  y`,.and `timeout
-0000c860: 602e 0a0a 5468 6520 6f70 7469 6f6e 616c  `...The optional
-0000c870: 2060 6672 6f6d 5f65 6e64 6020 6172 6775   `from_end` argu
-0000c880: 6d65 6e74 2063 616e 2062 6520 7573 6564  ment can be used
-0000c890: 2074 6f20 7370 6563 6966 7920 7468 6174   to specify that
-0000c8a0: 2074 6865 2067 726f 7570 206f 6620 636f   the group of co
-0000c8b0: 6e73 756d 6572 730a 6f66 2074 6865 2073  nsumers.of the s
-0000c8c0: 7562 7363 7269 7074 696f 6e20 7368 6f75  ubscription shou
-0000c8d0: 6c64 206f 6e6c 7920 7265 6365 6976 6520  ld only receive 
-0000c8e0: 6576 656e 7473 2074 6861 7420 7765 7265  events that were
-0000c8f0: 2072 6563 6f72 6465 6420 6166 7465 7220   recorded after 
-0000c900: 7468 6520 7375 6273 6372 6970 7469 6f6e  the subscription
-0000c910: 0a77 6173 2063 7265 6174 6564 2e0a 0a41  .was created...A
-0000c920: 6c74 6572 6e61 7469 7665 6c79 2c20 7468  lternatively, th
-0000c930: 6520 6f70 7469 6f6e 616c 2060 636f 6d6d  e optional `comm
-0000c940: 6974 5f70 6f73 6974 696f 6e60 2061 7267  it_position` arg
-0000c950: 756d 656e 7420 6361 6e20 6265 2075 7365  ument can be use
-0000c960: 6420 746f 2073 7065 6369 6679 2061 2063  d to specify a c
-0000c970: 6f6d 6d69 740a 706f 7369 7469 6f6e 2066  ommit.position f
-0000c980: 726f 6d20 7768 6963 6820 636f 6d6d 6974  rom which commit
-0000c990: 2070 6f73 6974 696f 6e20 7468 6520 6772   position the gr
-0000c9a0: 6f75 7020 6f66 2063 6f6e 7375 6d65 7273  oup of consumers
-0000c9b0: 206f 6620 7468 6520 7375 6273 6372 6970   of the subscrip
-0000c9c0: 7469 6f6e 2073 686f 756c 640a 7265 6365  tion should.rece
-0000c9d0: 6976 6520 6576 656e 7473 2e20 506c 6561  ive events. Plea
-0000c9e0: 7365 206e 6f74 652c 2074 6865 2072 6563  se note, the rec
-0000c9f0: 6f72 6465 6420 6576 656e 7420 6174 2074  orded event at t
-0000ca00: 6865 2073 7065 6369 6669 6564 2063 6f6d  he specified com
-0000ca10: 6d69 7420 706f 7369 7469 6f6e 206d 6967  mit position mig
-0000ca20: 6874 0a62 6520 696e 636c 7564 6564 2069  ht.be included i
-0000ca30: 6e20 7468 6520 7265 636f 7264 6564 2065  n the recorded e
-0000ca40: 7665 6e74 7320 7265 6365 6976 6564 2062  vents received b
-0000ca50: 7920 7468 6520 6772 6f75 7020 6f66 2063  y the group of c
-0000ca60: 6f6e 7375 6d65 7273 2e0a 0a49 6620 6e65  onsumers...If ne
-0000ca70: 6974 6865 7220 6066 726f 6d5f 656e 6460  ither `from_end`
-0000ca80: 206f 7220 6063 6f6d 6d69 745f 706f 7369   or `commit_posi
-0000ca90: 7469 6f6e 6020 6172 6520 7370 6563 6966  tion` are specif
-0000caa0: 6965 642c 2074 6865 2067 726f 7570 206f  ied, the group o
-0000cab0: 6620 636f 6e73 756d 6572 730a 6f66 2074  f consumers.of t
-0000cac0: 6865 2073 7562 7363 7269 7074 696f 6e20  he subscription 
-0000cad0: 7769 6c6c 2070 6f74 656e 7469 616c 6c79  will potentially
-0000cae0: 2072 6563 6569 7665 2061 6c6c 2072 6563   receive all rec
-0000caf0: 6f72 6465 6420 6576 656e 7473 2069 6e20  orded events in 
-0000cb00: 7468 6520 6461 7461 6261 7365 2e0a 0a54  the database...T
-0000cb10: 6865 206f 7074 696f 6e61 6c20 6066 696c  he optional `fil
-0000cb20: 7465 725f 6578 636c 7564 6560 2061 7267  ter_exclude` arg
-0000cb30: 756d 656e 7420 6973 2061 2073 6571 7565  ument is a seque
-0000cb40: 6e63 6520 6f66 2072 6567 756c 6172 2065  nce of regular e
-0000cb50: 7870 7265 7373 696f 6e73 2074 6861 740a  xpressions that.
-0000cb60: 6d61 7463 6820 7265 636f 7264 6564 2065  match recorded e
-0000cb70: 7665 6e74 7320 7468 6174 2073 686f 756c  vents that shoul
-0000cb80: 6420 6e6f 7420 6265 2069 6e63 6c75 6465  d not be include
-0000cb90: 642e 2054 6869 7320 6172 6775 6d65 6e74  d. This argument
-0000cba0: 2069 7320 6967 6e6f 7265 640a 6966 2060   is ignored.if `
-0000cbb0: 6669 6c74 6572 5f69 6e63 6c75 6465 6020  filter_include` 
-0000cbc0: 6973 2073 6574 2074 6f20 6120 6e6f 6e2d  is set to a non-
-0000cbd0: 656d 7074 7920 7365 7175 656e 6365 2e20  empty sequence. 
-0000cbe0: 4279 2064 6566 6175 6c74 2c20 7468 6973  By default, this
-0000cbf0: 2061 7267 756d 656e 7420 6973 2073 6574   argument is set
-0000cc00: 0a74 6f20 6d61 7463 6820 7468 6520 6576  .to match the ev
-0000cc10: 656e 7420 7479 7065 7320 6f66 2022 7379  ent types of "sy
-0000cc20: 7374 656d 2065 7665 6e74 7322 2c20 736f  stem events", so
-0000cc30: 2074 6861 7420 4576 656e 7453 746f 7265   that EventStore
-0000cc40: 4442 2073 7973 7465 6d20 6576 656e 7473  DB system events
-0000cc50: 0a77 696c 6c20 6e6f 7420 6e6f 726d 616c  .will not normal
-0000cc60: 6c79 2062 6520 7265 6365 6976 6564 2e20  ly be received. 
-0000cc70: 5365 6520 7468 6520 4e6f 7465 7320 7365  See the Notes se
-0000cc80: 6374 696f 6e20 6265 6c6f 7720 666f 7220  ction below for 
-0000cc90: 6d6f 7265 2069 6e66 6f72 6d61 7469 6f6e  more information
-0000cca0: 0a61 626f 7574 2066 696c 7465 7220 6578  .about filter ex
-0000ccb0: 7072 6573 7369 6f6e 732e 0a0a 5468 6520  pressions...The 
-0000ccc0: 6f70 7469 6f6e 616c 2060 6669 6c74 6572  optional `filter
-0000ccd0: 5f69 6e63 6c75 6465 6020 6172 6775 6d65  _include` argume
-0000cce0: 6e74 2069 7320 6120 7365 7175 656e 6365  nt is a sequence
-0000ccf0: 206f 6620 7265 6775 6c61 7220 6578 7072   of regular expr
-0000cd00: 6573 7369 6f6e 730a 7468 6174 206d 6174  essions.that mat
-0000cd10: 6368 2072 6563 6f72 6465 6420 6576 656e  ch recorded even
-0000cd20: 7473 2074 6861 7420 7368 6f75 6c64 2062  ts that should b
-0000cd30: 6520 7265 6365 6976 6564 2e20 4279 2064  e received. By d
-0000cd40: 6566 6175 6c74 2c20 7468 6973 2061 7267  efault, this arg
-0000cd50: 756d 656e 740a 6973 2061 6e20 656d 7074  ument.is an empt
-0000cd60: 7920 7475 706c 652e 2049 6620 7468 6973  y tuple. If this
-0000cd70: 2061 7267 756d 656e 7420 6973 2073 6574   argument is set
-0000cd80: 2074 6f20 6120 6e6f 6e2d 656d 7074 7920   to a non-empty 
-0000cd90: 7365 7175 656e 6365 2c20 7468 650a 6066  sequence, the.`f
-0000cda0: 696c 7465 725f 6578 636c 7564 6560 2061  ilter_exclude` a
-0000cdb0: 7267 756d 656e 7420 6973 2069 676e 6f72  rgument is ignor
-0000cdc0: 6564 2e0a 0a54 6865 206f 7074 696f 6e61  ed...The optiona
-0000cdd0: 6c20 6066 696c 7465 725f 6279 5f73 7472  l `filter_by_str
-0000cde0: 6561 6d5f 6e61 6d65 6020 6172 6775 6d65  eam_name` argume
-0000cdf0: 6e74 2069 7320 6120 626f 6f6c 6561 6e20  nt is a boolean 
-0000ce00: 7661 6c75 6520 7468 6174 2069 6e64 6963  value that indic
-0000ce10: 6174 6573 2077 6865 7468 6572 0a74 6865  ates whether.the
-0000ce20: 2066 696c 7465 7220 7769 6c6c 2061 7070   filter will app
-0000ce30: 6c79 2074 6f20 6576 656e 7420 7479 7065  ly to event type
-0000ce40: 7320 6f72 2073 7472 6561 6d20 6e61 6d65  s or stream name
-0000ce50: 732e 2042 7920 6465 6661 756c 742c 2074  s. By default, t
-0000ce60: 6869 7320 7661 6c75 6520 6973 2060 4661  his value is `Fa
-0000ce70: 6c73 6560 0a61 6e64 2073 6f20 7468 6520  lse`.and so the 
-0000ce80: 6669 6c74 6572 696e 6720 7769 6c6c 2061  filtering will a
-0000ce90: 7070 6c79 2074 6f20 7468 6520 6576 656e  pply to the even
-0000cea0: 7420 7479 7065 2073 7472 696e 6773 206f  t type strings o
-0000ceb0: 6620 7265 636f 7264 6564 2065 7665 6e74  f recorded event
-0000cec0: 732e 0a0a 5468 6520 6f70 7469 6f6e 616c  s...The optional
-0000ced0: 2060 636f 6e73 756d 6572 5f73 7472 6174   `consumer_strat
-0000cee0: 6567 7960 2061 7267 756d 656e 7420 6973  egy` argument is
-0000cef0: 2061 2050 7974 686f 6e20 6073 7472 6020   a Python `str` 
-0000cf00: 7468 6174 2064 6566 696e 6573 0a74 6865  that defines.the
-0000cf10: 2063 6f6e 7375 6d65 7220 7374 7261 7465   consumer strate
-0000cf20: 6779 2066 6f72 2074 6869 7320 7065 7273  gy for this pers
-0000cf30: 6973 7465 6e74 2073 7562 7363 7269 7074  istent subscript
-0000cf40: 696f 6e2e 2054 6865 2076 616c 7565 206f  ion. The value o
-0000cf50: 6620 7468 6973 2061 7267 756d 656e 740a  f this argument.
-0000cf60: 6361 6e20 6265 2060 2744 6973 7061 7463  can be `'Dispatc
-0000cf70: 6854 6f53 696e 676c 6527 602c 2060 2752  hToSingle'`, `'R
-0000cf80: 6f75 6e64 526f 6269 6e27 602c 2060 2750  oundRobin'`, `'P
-0000cf90: 696e 6e65 6427 602c 206f 7220 6027 5069  inned'`, or `'Pi
-0000cfa0: 6e6e 6564 4279 436f 7272 656c 6174 696f  nnedByCorrelatio
-0000cfb0: 6e27 602e 2054 6865 0a64 6566 6175 6c74  n'`. The.default
-0000cfc0: 2076 616c 7565 2069 7320 6027 4469 7370   value is `'Disp
-0000cfd0: 6174 6368 546f 5369 6e67 6c65 2760 2e0a  atchToSingle'`..
-0000cfe0: 0a54 6865 206f 7074 696f 6e61 6c20 6074  .The optional `t
-0000cff0: 696d 656f 7574 6020 6172 6775 6d65 6e74  imeout` argument
-0000d000: 2069 7320 6120 5079 7468 6f6e 2060 666c   is a Python `fl
-0000d010: 6f61 7460 2077 6869 6368 2073 6574 7320  oat` which sets 
-0000d020: 610a 6465 6164 6c69 6e65 2066 6f72 2074  a.deadline for t
-0000d030: 6865 2063 6f6d 706c 6574 696f 6e20 6f66  he completion of
-0000d040: 2074 6865 2067 5250 4320 6f70 6572 6174   the gRPC operat
-0000d050: 696f 6e2e 0a0a 5468 6520 6d65 7468 6f64  ion...The method
-0000d060: 2060 6372 6561 7465 5f73 7562 7363 7269   `create_subscri
-0000d070: 7074 696f 6e28 2960 2064 6f65 7320 6e6f  ption()` does no
-0000d080: 7420 7265 7475 726e 2061 2076 616c 7565  t return a value
-0000d090: 2c20 6265 6361 7573 650a 7265 636f 7264  , because.record
-0000d0a0: 6564 2065 7665 6e74 7320 6172 6520 6f62  ed events are ob
-0000d0b0: 7461 696e 6564 2062 7920 7468 6520 6772  tained by the gr
-0000d0c0: 6f75 7020 6f66 2063 6f6e 7375 6d65 7273  oup of consumers
-0000d0d0: 206f 6620 7468 6520 7375 6273 6372 6970   of the subscrip
-0000d0e0: 7469 6f6e 0a75 7369 6e67 2074 6865 2060  tion.using the `
-0000d0f0: 7265 6164 5f73 7562 7363 7269 7074 696f  read_subscriptio
-0000d100: 6e28 2960 206d 6574 686f 642e 0a0a 496e  n()` method...In
-0000d110: 2074 6865 2065 7861 6d70 6c65 2062 656c   the example bel
-0000d120: 6f77 2c20 6120 7065 7273 6973 7465 6e74  ow, a persistent
-0000d130: 2073 7562 7363 7269 7074 696f 6e20 6973   subscription is
-0000d140: 2063 7265 6174 6564 2e0a 0a60 6060 7079   created...```py
-0000d150: 7468 6f6e 0a23 2043 7265 6174 6520 6120  thon.# Create a 
-0000d160: 7065 7273 6973 7465 6e74 2073 7562 7363  persistent subsc
-0000d170: 7269 7074 696f 6e2e 0a67 726f 7570 5f6e  ription..group_n
-0000d180: 616d 6520 3d20 6622 6772 6f75 702d 7b75  ame = f"group-{u
-0000d190: 7569 6434 2829 7d22 0a63 6c69 656e 742e  uid4()}".client.
-0000d1a0: 6372 6561 7465 5f73 7562 7363 7269 7074  create_subscript
-0000d1b0: 696f 6e28 6772 6f75 705f 6e61 6d65 3d67  ion(group_name=g
-0000d1c0: 726f 7570 5f6e 616d 6529 0a60 6060 0a0a  roup_name).```..
-0000d1d0: 2323 2320 5265 6164 2073 7562 7363 7269  ### Read subscri
-0000d1e0: 7074 696f 6e0a 0a2a 7265 7175 6972 6573  ption..*requires
-0000d1f0: 206c 6561 6465 722a 0a0a 5468 6520 6d65   leader*..The me
-0000d200: 7468 6f64 2060 7265 6164 5f73 7562 7363  thod `read_subsc
-0000d210: 7269 7074 696f 6e28 2960 2063 616e 2062  ription()` can b
-0000d220: 6520 7573 6564 2062 7920 6120 6772 6f75  e used by a grou
-0000d230: 7020 6f66 2063 6f6e 7375 6d65 7273 2074  p of consumers t
-0000d240: 6f20 7265 6365 6976 650a 7265 636f 7264  o receive.record
-0000d250: 6564 2065 7665 6e74 7320 6672 6f6d 2061  ed events from a
-0000d260: 2070 6572 7369 7374 656e 7420 7375 6273   persistent subs
-0000d270: 6372 6970 7469 6f6e 2063 7265 6174 6564  cription created
-0000d280: 2075 7369 6e67 2060 6372 6561 7465 5f73   using `create_s
-0000d290: 7562 7363 7269 7074 696f 6e60 2e0a 0a54  ubscription`...T
-0000d2a0: 6869 7320 6d65 7468 6f64 2074 616b 6573  his method takes
-0000d2b0: 2061 2072 6571 7569 7265 6420 6067 726f   a required `gro
-0000d2c0: 7570 5f6e 616d 6560 2061 7267 756d 656e  up_name` argumen
-0000d2d0: 742c 2077 6869 6368 2069 730a 7468 6520  t, which is.the 
-0000d2e0: 6e61 6d65 206f 6620 6120 2267 726f 7570  name of a "group
-0000d2f0: 2220 6f66 2063 6f6e 7375 6d65 7273 206f  " of consumers o
-0000d300: 6620 7468 6520 7375 6273 6372 6970 7469  f the subscripti
-0000d310: 6f6e 2073 7065 6369 6669 6564 0a77 6865  on specified.whe
-0000d320: 6e20 6063 7265 6174 655f 7375 6273 6372  n `create_subscr
-0000d330: 6970 7469 6f6e 2829 6020 7761 7320 6361  iption()` was ca
-0000d340: 6c6c 6564 2e0a 0a54 6869 7320 6d65 7468  lled...This meth
-0000d350: 6f64 2061 6c73 6f20 7461 6b65 7320 616e  od also takes an
-0000d360: 206f 7074 696f 6e61 6c20 6074 696d 656f   optional `timeo
-0000d370: 7574 6020 6172 6775 6d65 6e74 2c20 7468  ut` argument, th
-0000d380: 6174 0a69 7320 6578 7065 6374 6564 2074  at.is expected t
-0000d390: 6f20 6265 2061 2050 7974 686f 6e20 6066  o be a Python `f
-0000d3a0: 6c6f 6174 602c 2077 6869 6368 2073 6574  loat`, which set
-0000d3b0: 7320 6120 6465 6164 6c69 6e65 0a66 6f72  s a deadline.for
-0000d3c0: 2074 6865 2063 6f6d 706c 6574 696f 6e20   the completion 
-0000d3d0: 6f66 2074 6865 2067 5250 4320 6f70 6572  of the gRPC oper
-0000d3e0: 6174 696f 6e2e 0a0a 5468 6973 206d 6574  ation...This met
-0000d3f0: 686f 6420 7265 7475 726e 7320 6120 322d  hod returns a 2-
-0000d400: 7475 706c 653a 2061 2022 7265 6164 2072  tuple: a "read r
-0000d410: 6571 7565 7374 2220 6f62 6a65 6374 2061  equest" object a
-0000d420: 6e64 2061 2022 7265 6164 2072 6573 706f  nd a "read respo
-0000d430: 6e73 6522 206f 626a 6563 742e 0a0a 6060  nse" object...``
-0000d440: 6070 7974 686f 6e0a 7265 6164 5f72 6571  `python.read_req
-0000d450: 2c20 7265 6164 5f72 6573 7020 3d20 636c  , read_resp = cl
-0000d460: 6965 6e74 2e72 6561 645f 7375 6273 6372  ient.read_subscr
-0000d470: 6970 7469 6f6e 2867 726f 7570 5f6e 616d  iption(group_nam
-0000d480: 653d 6772 6f75 705f 6e61 6d65 290a 6060  e=group_name).``
-0000d490: 600a 0a54 6865 2022 7265 6164 2072 6573  `..The "read res
-0000d4a0: 706f 6e73 6522 206f 626a 6563 7420 6973  ponse" object is
-0000d4b0: 2061 6e20 6974 6572 6174 6f72 2074 6861   an iterator tha
-0000d4c0: 7420 7969 656c 6473 2072 6563 6f72 6465  t yields recorde
-0000d4d0: 6420 6576 656e 7473 2066 726f 6d0a 7468  d events from.th
-0000d4e0: 6520 7370 6563 6966 6965 6420 636f 6d6d  e specified comm
-0000d4f0: 6974 2070 6f73 6974 696f 6e2e 0a0a 5468  it position...Th
-0000d500: 6520 2272 6561 6420 7265 7175 6573 7422  e "read request"
-0000d510: 206f 626a 6563 7420 6861 7320 616e 2060   object has an `
-0000d520: 6163 6b28 2960 206d 6574 686f 6420 7468  ack()` method th
-0000d530: 6174 2073 686f 756c 6420 6265 2075 7365  at should be use
-0000d540: 6420 6279 2061 2063 6f6e 7375 6d65 720a  d by a consumer.
-0000d550: 696e 2061 2067 726f 7570 2074 6f20 6163  in a group to ac
-0000d560: 6b6e 6f77 6c65 6467 6520 746f 2074 6865  knowledge to the
-0000d570: 2073 6572 7665 7220 7468 6174 2069 7420   server that it 
-0000d580: 6861 7320 7265 6365 6976 6564 2061 6e64  has received and
-0000d590: 2073 7563 6365 7373 6675 6c6c 790a 7072   successfully.pr
-0000d5a0: 6f63 6573 7365 6420 6120 7265 636f 7264  ocessed a record
-0000d5b0: 6564 2065 7665 6e74 2e20 5468 6973 2077  ed event. This w
-0000d5c0: 696c 6c20 7072 6576 656e 7420 7468 6174  ill prevent that
-0000d5d0: 2072 6563 6f72 6465 6420 6576 656e 7420   recorded event 
-0000d5e0: 6265 696e 6720 7265 6365 6976 6564 0a62  being received.b
-0000d5f0: 7920 616e 6f74 6865 7220 636f 6e73 756d  y another consum
-0000d600: 6572 2069 6e20 7468 6520 7361 6d65 2067  er in the same g
-0000d610: 726f 7570 2e20 5468 6520 6061 636b 2829  roup. The `ack()
-0000d620: 6020 6d65 7468 6f64 2074 616b 6573 2061  ` method takes a
-0000d630: 6e20 6065 7665 6e74 5f69 6460 0a61 7267  n `event_id`.arg
-0000d640: 756d 656e 742c 2077 6869 6368 2069 7320  ument, which is 
-0000d650: 7468 6520 4944 206f 6620 7468 6520 7265  the ID of the re
-0000d660: 636f 7264 6564 2065 7665 6e74 2074 6861  corded event tha
-0000d670: 7420 6861 7320 6265 656e 2072 6563 6569  t has been recei
-0000d680: 7665 642e 0a0a 5468 6520 2272 6561 6420  ved...The "read 
-0000d690: 7265 7175 6573 7422 206f 626a 6563 7420  request" object 
-0000d6a0: 616c 736f 2068 6173 2061 6e20 606e 6163  also has an `nac
-0000d6b0: 6b28 2960 206d 6574 686f 6420 7468 6174  k()` method that
-0000d6c0: 2073 686f 756c 6420 6265 2075 7365 6420   should be used 
-0000d6d0: 6279 2061 2063 6f6e 7375 6d65 720a 696e  by a consumer.in
-0000d6e0: 2061 2067 726f 7570 2074 6f20 6e65 6761   a group to nega
-0000d6f0: 7469 7665 6c79 2061 636b 6e6f 776c 6564  tively acknowled
-0000d700: 6765 2074 6f20 7468 6520 7365 7276 6572  ge to the server
-0000d710: 2074 6861 7420 6974 2068 6173 2072 6563   that it has rec
-0000d720: 6569 7665 6420 6275 7420 6e6f 740a 7375  eived but not.su
-0000d730: 6363 6573 7366 756c 6c79 2070 726f 6365  ccessfully proce
-0000d740: 7373 6564 2061 2072 6563 6f72 6465 6420  ssed a recorded 
-0000d750: 6576 656e 742e 2054 6865 2060 6e61 636b  event. The `nack
-0000d760: 2829 6020 6d65 7468 6f64 2074 616b 6573  ()` method takes
-0000d770: 2061 6e20 6065 7665 6e74 5f69 6460 0a61   an `event_id`.a
-0000d780: 7267 756d 656e 742c 2077 6869 6368 2069  rgument, which i
-0000d790: 7320 7468 6520 4944 206f 6620 7468 6520  s the ID of the 
-0000d7a0: 7265 636f 7264 6564 2065 7665 6e74 2074  recorded event t
-0000d7b0: 6861 7420 6861 7320 6265 656e 2072 6563  hat has been rec
-0000d7c0: 6569 7665 642c 2061 6e64 2061 6e0a 6061  eived, and an.`a
-0000d7d0: 6374 696f 6e60 2061 7267 756d 656e 742c  ction` argument,
-0000d7e0: 2077 6869 6368 2073 686f 756c 6420 6265   which should be
-0000d7f0: 2061 2050 7974 686f 6e20 6073 7472 602c   a Python `str`,
-0000d800: 2065 6974 6865 7220 6027 756e 6b6e 6f77   either `'unknow
-0000d810: 6e27 602c 2060 2770 6172 6b27 602c 0a60  n'`, `'park'`,.`
-0000d820: 2772 6574 7279 2760 2c20 6027 736b 6970  'retry'`, `'skip
-0000d830: 2760 2c20 6f72 2060 2773 746f 7027 602e  '`, or `'stop'`.
-0000d840: 0a0a 5468 6520 6578 616d 706c 6520 6265  ..The example be
-0000d850: 6c6f 7720 6974 6572 6174 6573 206f 7665  low iterates ove
-0000d860: 7220 7468 6520 2272 6561 6420 7265 7370  r the "read resp
-0000d870: 6f6e 7365 2220 6f62 6a65 6374 2c20 616e  onse" object, an
-0000d880: 6420 6361 6c6c 7320 6061 636b 2829 600a  d calls `ack()`.
-0000d890: 6f6e 2074 6865 2022 7265 6164 2072 6573  on the "read res
-0000d8a0: 706f 6e73 6522 206f 626a 6563 742e 2054  ponse" object. T
-0000d8b0: 6865 2066 6f72 206c 6f6f 7020 6272 6561  he for loop brea
-0000d8c0: 6b73 2077 6865 6e20 7765 2068 6176 6520  ks when we have 
-0000d8d0: 7265 6365 6976 6564 0a74 6865 206c 6173  received.the las
-0000d8e0: 7420 6576 656e 742c 2073 6f20 7468 6174  t event, so that
-0000d8f0: 2077 6520 6361 6e20 636f 6e74 696e 7565   we can continue
-0000d900: 2077 6974 6820 7468 6520 6578 616d 706c   with the exampl
-0000d910: 6573 2062 656c 6f77 2e0a 0a60 6060 7079  es below...```py
-0000d920: 7468 6f6e 0a65 7665 6e74 7320 3d20 5b5d  thon.events = []
-0000d930: 0a66 6f72 2065 7665 6e74 2069 6e20 7265  .for event in re
-0000d940: 6164 5f72 6573 703a 0a20 2020 2065 7665  ad_resp:.    eve
-0000d950: 6e74 732e 6170 7065 6e64 2865 7665 6e74  nts.append(event
-0000d960: 290a 0a20 2020 2023 2041 636b 6e6f 776c  )..    # Acknowl
-0000d970: 6564 6765 2074 6865 2072 6563 6569 7665  edge the receive
-0000d980: 6420 6576 656e 742e 0a20 2020 2072 6561  d event..    rea
-0000d990: 645f 7265 712e 6163 6b28 6576 656e 745f  d_req.ack(event_
-0000d9a0: 6964 3d65 7665 6e74 2e69 6429 0a0a 2020  id=event.id)..  
-0000d9b0: 2020 2320 4272 6561 6b20 7768 656e 2074    # Break when t
-0000d9c0: 6865 206c 6173 7420 6576 656e 7420 6861  he last event ha
-0000d9d0: 7320 6265 656e 2072 6563 6569 7665 642e  s been received.
-0000d9e0: 0a20 2020 2069 6620 6576 656e 742e 6964  .    if event.id
-0000d9f0: 203d 3d20 6576 656e 7431 312e 6964 3a0a   == event11.id:.
-0000da00: 2020 2020 2020 2020 6272 6561 6b0a 6060          break.``
-0000da10: 600a 0a54 6865 2072 6563 6569 7665 6420  `..The received 
-0000da20: 6576 656e 7473 2061 7265 2074 6865 2065  events are the e
-0000da30: 7665 6e74 7320 7765 2061 7070 656e 6465  vents we appende
-0000da40: 6420 6162 6f76 652e 0a0a 6060 6070 7974  d above...```pyt
-0000da50: 686f 6e0a 6173 7365 7274 2065 7665 6e74  hon.assert event
-0000da60: 735b 2d31 315d 2e69 6420 3d3d 2065 7665  s[-11].id == eve
-0000da70: 6e74 312e 6964 0a61 7373 6572 7420 6576  nt1.id.assert ev
-0000da80: 656e 7473 5b2d 3130 5d2e 6964 203d 3d20  ents[-10].id == 
-0000da90: 6576 656e 7432 2e69 640a 6173 7365 7274  event2.id.assert
-0000daa0: 2065 7665 6e74 735b 2d39 5d2e 6964 203d   events[-9].id =
-0000dab0: 3d20 6576 656e 7433 2e69 640a 6173 7365  = event3.id.asse
-0000dac0: 7274 2065 7665 6e74 735b 2d38 5d2e 6964  rt events[-8].id
-0000dad0: 203d 3d20 6576 656e 7434 2e69 640a 6173   == event4.id.as
-0000dae0: 7365 7274 2065 7665 6e74 735b 2d37 5d2e  sert events[-7].
-0000daf0: 6964 203d 3d20 6576 656e 7435 2e69 640a  id == event5.id.
-0000db00: 6173 7365 7274 2065 7665 6e74 735b 2d36  assert events[-6
-0000db10: 5d2e 6964 203d 3d20 6576 656e 7436 2e69  ].id == event6.i
-0000db20: 640a 6173 7365 7274 2065 7665 6e74 735b  d.assert events[
-0000db30: 2d35 5d2e 6964 203d 3d20 6576 656e 7437  -5].id == event7
-0000db40: 2e69 640a 6173 7365 7274 2065 7665 6e74  .id.assert event
-0000db50: 735b 2d34 5d2e 6964 203d 3d20 6576 656e  s[-4].id == even
-0000db60: 7438 2e69 640a 6173 7365 7274 2065 7665  t8.id.assert eve
-0000db70: 6e74 735b 2d33 5d2e 6964 203d 3d20 6576  nts[-3].id == ev
-0000db80: 656e 7439 2e69 640a 6173 7365 7274 2065  ent9.id.assert e
-0000db90: 7665 6e74 735b 2d32 5d2e 6964 203d 3d20  vents[-2].id == 
-0000dba0: 6576 656e 7431 302e 6964 0a61 7373 6572  event10.id.asser
-0000dbb0: 7420 6576 656e 7473 5b2d 315d 2e69 6420  t events[-1].id 
-0000dbc0: 3d3d 2065 7665 6e74 3131 2e69 640a 6060  == event11.id.``
-0000dbd0: 600a 0a54 6865 2022 7265 6164 2072 6571  `..The "read req
-0000dbe0: 7565 7374 2220 6f62 6a65 6374 2061 6c73  uest" object als
-0000dbf0: 6f20 6861 7320 616e 2060 6e61 636b 2829  o has an `nack()
-0000dc00: 6020 6d65 7468 6f64 2074 6861 7420 6361  ` method that ca
-0000dc10: 6e20 6265 2075 7365 6420 6279 2061 2063  n be used by a c
-0000dc20: 6f6e 7375 6d65 720a 696e 2061 2067 726f  onsumer.in a gro
-0000dc30: 7570 2074 6f20 6163 6b6e 6f77 6c65 6467  up to acknowledg
-0000dc40: 6520 746f 2074 6865 2073 6572 7665 7220  e to the server 
-0000dc50: 7468 6174 2069 7420 6861 7320 6661 696c  that it has fail
-0000dc60: 6564 2073 7563 6365 7373 6675 6c6c 7920  ed successfully 
-0000dc70: 746f 0a70 726f 6365 7373 2061 2072 6563  to.process a rec
-0000dc80: 6f72 6465 6420 6576 656e 742e 2054 6869  orded event. Thi
-0000dc90: 7320 7769 6c6c 2061 6c6c 6f77 2074 6861  s will allow tha
-0000dca0: 7420 7265 636f 7264 6564 2065 7665 6e74  t recorded event
-0000dcb0: 2074 6f20 6265 2072 6563 6569 7665 640a   to be received.
-0000dcc0: 6279 2074 6869 7320 6f72 2061 6e6f 7468  by this or anoth
-0000dcd0: 6572 2063 6f6e 7375 6d65 7220 696e 2074  er consumer in t
-0000dce0: 6865 2073 616d 6520 6772 6f75 702e 0a0a  he same group...
-0000dcf0: 4974 206d 6967 6874 2062 6520 6d6f 7265  It might be more
-0000dd00: 2075 7365 6675 6c20 746f 2065 6e63 6170   useful to encap
-0000dd10: 7375 6c61 7465 2074 6865 2072 6571 7565  sulate the reque
-0000dd20: 7374 2061 6e64 2072 6573 706f 6e73 6520  st and response 
-0000dd30: 6f62 6a65 6374 7320 616e 6420 746f 2069  objects and to i
-0000dd40: 7465 7261 7465 0a6f 7665 7220 7468 6520  terate.over the 
-0000dd50: 2272 6561 6420 7265 7370 6f6e 7365 2220  "read response" 
-0000dd60: 696e 2061 2073 6570 6172 6174 6520 7468  in a separate th
-0000dd70: 7265 6164 2c20 746f 2063 616c 6c20 6261  read, to call ba
-0000dd80: 636b 2074 6f20 6120 6861 6e64 6c65 7220  ck to a handler 
-0000dd90: 6675 6e63 7469 6f6e 2077 6865 6e0a 6120  function when.a 
-0000dda0: 7265 636f 7264 6564 2065 7665 6e74 2069  recorded event i
-0000ddb0: 7320 7265 6365 6976 6564 2c20 616e 6420  s received, and 
-0000ddc0: 6361 6c6c 2060 6163 6b28 2960 2069 6620  call `ack()` if 
-0000ddd0: 7468 6520 6861 6e64 6c65 7220 646f 6573  the handler does
-0000dde0: 206e 6f74 2072 6169 7365 2061 6e0a 6578   not raise an.ex
-0000ddf0: 6365 7074 696f 6e2c 2061 6e64 2074 6f20  ception, and to 
-0000de00: 6361 6c6c 2060 6e61 636b 2829 6020 6966  call `nack()` if
-0000de10: 2061 6e20 6578 6365 7074 696f 6e20 6973   an exception is
-0000de20: 2072 6169 7365 642e 2054 6865 2065 7861   raised. The exa
-0000de30: 6d70 6c65 2062 656c 6f77 2073 686f 7773  mple below shows
-0000de40: 2068 6f77 0a74 6869 7320 6d69 6768 7420   how.this might 
-0000de50: 6265 2064 6f6e 652e 0a0a 6060 6070 7974  be done...```pyt
-0000de60: 686f 6e0a 6672 6f6d 2074 6872 6561 6469  hon.from threadi
-0000de70: 6e67 2069 6d70 6f72 7420 5468 7265 6164  ng import Thread
-0000de80: 0a0a 0a63 6c61 7373 2053 7562 7363 7269  ...class Subscri
-0000de90: 7074 696f 6e52 6561 6465 723a 0a20 2020  ptionReader:.   
-0000dea0: 2064 6566 205f 5f69 6e69 745f 5f28 7365   def __init__(se
-0000deb0: 6c66 2c20 636c 6965 6e74 2c20 6772 6f75  lf, client, grou
-0000dec0: 705f 6e61 6d65 2c20 6361 6c6c 6261 636b  p_name, callback
-0000ded0: 293a 0a20 2020 2020 2020 2073 656c 662e  ):.        self.
-0000dee0: 636c 6965 6e74 203d 2063 6c69 656e 740a  client = client.
-0000def0: 2020 2020 2020 2020 7365 6c66 2e67 726f          self.gro
-0000df00: 7570 5f6e 616d 6520 3d20 6772 6f75 705f  up_name = group_
-0000df10: 6e61 6d65 0a20 2020 2020 2020 2073 656c  name.        sel
-0000df20: 662e 6361 6c6c 6261 636b 203d 2063 616c  f.callback = cal
-0000df30: 6c62 6163 6b0a 2020 2020 2020 2020 7365  lback.        se
-0000df40: 6c66 2e74 6872 6561 6420 3d20 5468 7265  lf.thread = Thre
-0000df50: 6164 2874 6172 6765 743d 7365 6c66 2e72  ad(target=self.r
-0000df60: 6561 645f 7375 6273 6372 6970 7469 6f6e  ead_subscription
-0000df70: 2c20 6461 656d 6f6e 3d54 7275 6529 0a20  , daemon=True). 
-0000df80: 2020 2020 2020 2073 656c 662e 6572 726f         self.erro
-0000df90: 7220 3d20 4e6f 6e65 0a0a 2020 2020 6465  r = None..    de
-0000dfa0: 6620 7374 6172 7428 7365 6c66 293a 0a20  f start(self):. 
-0000dfb0: 2020 2020 2020 2073 656c 662e 7468 7265         self.thre
-0000dfc0: 6164 2e73 7461 7274 2829 0a0a 2020 2020  ad.start()..    
-0000dfd0: 6465 6620 6a6f 696e 2873 656c 6629 3a0a  def join(self):.
-0000dfe0: 2020 2020 2020 2020 7365 6c66 2e74 6872          self.thr
-0000dff0: 6561 642e 6a6f 696e 2829 0a0a 2020 2020  ead.join()..    
-0000e000: 6465 6620 7265 6164 5f73 7562 7363 7269  def read_subscri
-0000e010: 7074 696f 6e28 7365 6c66 293a 0a20 2020  ption(self):.   
-0000e020: 2020 2020 2072 6571 2c20 7265 7370 203d       req, resp =
-0000e030: 2073 656c 662e 636c 6965 6e74 2e72 6561   self.client.rea
-0000e040: 645f 7375 6273 6372 6970 7469 6f6e 2867  d_subscription(g
-0000e050: 726f 7570 5f6e 616d 653d 7365 6c66 2e67  roup_name=self.g
-0000e060: 726f 7570 5f6e 616d 6529 0a20 2020 2020  roup_name).     
-0000e070: 2020 2066 6f72 2065 7665 6e74 2069 6e20     for event in 
-0000e080: 7265 7370 3a0a 2020 2020 2020 2020 2020  resp:.          
-0000e090: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
-0000e0a0: 2020 2020 2020 2073 656c 662e 6361 6c6c         self.call
-0000e0b0: 6261 636b 2865 7665 6e74 290a 2020 2020  back(event).    
-0000e0c0: 2020 2020 2020 2020 6578 6365 7074 2045          except E
-0000e0d0: 7863 6570 7469 6f6e 2061 7320 653a 0a20  xception as e:. 
-0000e0e0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-0000e0f0: 2072 6571 2e6e 6163 6b28 6576 656e 742e   req.nack(event.
-0000e100: 6964 2920 2023 206e 6f74 2079 6574 2069  id)  # not yet i
-0000e110: 6d70 6c65 6d65 6e74 6564 2e2e 2e2e 0a20  mplemented..... 
-0000e120: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0000e130: 656c 662e 6572 726f 7220 3d20 650a 2020  elf.error = e.  
-0000e140: 2020 2020 2020 2020 2020 2020 2020 6272                br
-0000e150: 6561 6b0a 2020 2020 2020 2020 2020 2020  eak.            
-0000e160: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0000e170: 2020 2020 2020 7265 712e 6163 6b28 6576        req.ack(ev
-0000e180: 656e 742e 6964 290a 0a0a 2320 4372 6561  ent.id)...# Crea
-0000e190: 7465 2061 6e6f 7468 6572 2070 6572 7369  te another persi
-0000e1a0: 7374 656e 7420 7375 6273 6372 6970 7469  stent subscripti
-0000e1b0: 6f6e 2e0a 6772 6f75 705f 6e61 6d65 203d  on..group_name =
-0000e1c0: 2066 2267 726f 7570 2d7b 7575 6964 3428   f"group-{uuid4(
-0000e1d0: 297d 220a 636c 6965 6e74 2e63 7265 6174  )}".client.creat
-0000e1e0: 655f 7375 6273 6372 6970 7469 6f6e 2867  e_subscription(g
-0000e1f0: 726f 7570 5f6e 616d 653d 6772 6f75 705f  roup_name=group_
-0000e200: 6e61 6d65 290a 0a65 7665 6e74 7320 3d20  name)..events = 
-0000e210: 5b5d 0a0a 6465 6620 6861 6e64 6c65 5f65  []..def handle_e
-0000e220: 7665 6e74 2865 7665 6e74 293a 0a20 2020  vent(event):.   
-0000e230: 2065 7665 6e74 732e 6170 7065 6e64 2865   events.append(e
-0000e240: 7665 6e74 290a 2020 2020 6966 2065 7665  vent).    if eve
-0000e250: 6e74 2e69 6420 3d3d 2065 7665 6e74 3131  nt.id == event11
-0000e260: 2e69 643a 0a20 2020 2020 2020 2072 6169  .id:.        rai
-0000e270: 7365 2045 7863 6570 7469 6f6e 2829 0a0a  se Exception()..
-0000e280: 0a72 6561 6465 7220 3d20 5375 6273 6372  .reader = Subscr
-0000e290: 6970 7469 6f6e 5265 6164 6572 280a 2020  iptionReader(.  
-0000e2a0: 2020 636c 6965 6e74 3d63 6c69 656e 742c    client=client,
-0000e2b0: 0a20 2020 2067 726f 7570 5f6e 616d 653d  .    group_name=
-0000e2c0: 6772 6f75 705f 6e61 6d65 2c0a 2020 2020  group_name,.    
-0000e2d0: 6361 6c6c 6261 636b 3d68 616e 646c 655f  callback=handle_
-0000e2e0: 6576 656e 740a 290a 0a72 6561 6465 722e  event.)..reader.
-0000e2f0: 7374 6172 7428 290a 7265 6164 6572 2e6a  start().reader.j
-0000e300: 6f69 6e28 290a 0a61 7373 6572 7420 6576  oin()..assert ev
-0000e310: 656e 7473 5b2d 315d 2e69 6420 3d3d 2065  ents[-1].id == e
-0000e320: 7665 6e74 3131 2e69 640a 6060 600a 0a50  vent11.id.```..P
-0000e330: 6c65 6173 6520 6e6f 7465 2c20 7768 656e  lease note, when
-0000e340: 2070 726f 6365 7373 696e 6720 6576 656e   processing even
-0000e350: 7473 2069 6e20 6120 646f 776e 7374 7265  ts in a downstre
-0000e360: 616d 2063 6f6d 706f 6e65 6e74 2c20 7468  am component, th
-0000e370: 6520 636f 6d6d 6974 2070 6f73 6974 696f  e commit positio
-0000e380: 6e20 6f66 0a74 6865 206c 6173 7420 7375  n of.the last su
-0000e390: 6363 6573 7366 756c 6c79 2070 726f 6365  ccessfully proce
-0000e3a0: 7373 6564 2065 7665 6e74 2069 7320 7573  ssed event is us
-0000e3b0: 6566 756c 6c79 2072 6563 6f72 6465 6420  efully recorded 
-0000e3c0: 6279 2074 6865 2064 6f77 6e73 7472 6561  by the downstrea
-0000e3d0: 6d20 636f 6d70 6f6e 656e 740a 736f 2074  m component.so t
-0000e3e0: 6861 7420 7468 6520 636f 6d6d 6974 2070  hat the commit p
-0000e3f0: 6f73 6974 696f 6e20 6361 6e20 6265 2064  osition can be d
-0000e400: 6574 6572 6d69 6e65 6420 6279 2074 6865  etermined by the
-0000e410: 2064 6f77 6e73 7472 6561 6d20 636f 6d70   downstream comp
-0000e420: 6f6e 656e 7420 6672 6f6d 2069 7473 206f  onent from its o
-0000e430: 776e 0a72 6563 6f72 6465 6420 7768 656e  wn.recorded when
-0000e440: 2069 7420 6973 2072 6573 7461 7274 6564   it is restarted
-0000e450: 2e20 5468 6973 2063 6f6d 6d69 7420 706f  . This commit po
-0000e460: 7369 7469 6f6e 2063 616e 2062 6520 7573  sition can be us
-0000e470: 6564 2074 6f20 7370 6563 6966 7920 7468  ed to specify th
-0000e480: 6520 636f 6d6d 6974 0a70 6f73 6974 696f  e commit.positio
-0000e490: 6e20 6672 6f6d 2077 6869 6368 2074 6f20  n from which to 
-0000e4a0: 7375 6273 6372 6962 652e 2053 696e 6365  subscribe. Since
-0000e4b0: 2074 6869 7320 636f 6d6d 6974 2070 6f73   this commit pos
-0000e4c0: 6974 696f 6e20 7265 7072 6573 656e 7473  ition represents
-0000e4d0: 2074 6865 2070 6f73 6974 696f 6e20 6f66   the position of
-0000e4e0: 0a74 6865 206c 6173 7420 7375 6363 6573  .the last succes
-0000e4f0: 7366 756c 6c79 2070 726f 6365 7373 6564  sfully processed
-0000e500: 2065 7665 6e74 2069 6e20 6120 646f 776e   event in a down
-0000e510: 7374 7265 616d 2063 6f6d 706f 6e65 6e74  stream component
-0000e520: 2c20 736f 2069 7420 7769 6c6c 2062 6520  , so it will be 
-0000e530: 7573 7561 6c20 746f 0a77 616e 7420 746f  usual to.want to
-0000e540: 2072 6561 6420 6672 6f6d 2074 6865 206e   read from the n
-0000e550: 6578 7420 6576 656e 7420 6166 7465 7220  ext event after 
-0000e560: 7468 6973 2070 6f73 6974 696f 6e2c 2062  this position, b
-0000e570: 6563 6175 7365 2074 6861 7420 6973 2074  ecause that is t
-0000e580: 6865 206e 6578 7420 6576 656e 740a 7468  he next event.th
-0000e590: 6174 206e 6565 6473 2074 6f20 6265 2070  at needs to be p
-0000e5a0: 726f 6365 7373 6564 2e20 486f 7765 7665  rocessed. Howeve
-0000e5b0: 722c 2077 6865 6e20 7375 6273 6372 6962  r, when subscrib
-0000e5c0: 696e 6720 666f 7220 6576 656e 7473 2075  ing for events u
-0000e5d0: 7369 6e67 2061 2070 6572 7369 7374 656e  sing a persisten
-0000e5e0: 740a 7375 6273 6372 6970 7469 6f6e 2069  t.subscription i
-0000e5f0: 6e20 4576 656e 7453 746f 7265 4442 2c20  n EventStoreDB, 
-0000e600: 7468 6520 6576 656e 7420 6174 2074 6865  the event at the
-0000e610: 2073 7065 6369 6669 6564 2063 6f6d 6d69   specified commi
-0000e620: 7420 706f 7369 7469 6f6e 204d 4159 2062  t position MAY b
-0000e630: 6520 7265 7475 726e 6564 0a61 7320 7468  e returned.as th
-0000e640: 6520 6669 7273 7420 6576 656e 7420 696e  e first event in
-0000e650: 2074 6865 2072 6563 6569 7665 6420 7365   the received se
-0000e660: 7175 656e 6365 206f 6620 7265 636f 7264  quence of record
-0000e670: 6564 2065 7665 6e74 732c 2061 6e64 2073  ed events, and s
-0000e680: 6f20 6974 206d 6179 0a62 6520 6e65 6365  o it may.be nece
-0000e690: 7373 6172 7920 746f 2063 6865 636b 2074  ssary to check t
-0000e6a0: 6865 2063 6f6d 6d69 7420 706f 7369 7469  he commit positi
-0000e6b0: 6f6e 206f 6620 7468 6520 7265 6365 6976  on of the receiv
-0000e6c0: 6564 2065 7665 6e74 7320 616e 6420 746f  ed events and to
-0000e6d0: 2064 6973 6361 7264 0a61 6e79 2020 7265   discard.any  re
-0000e6e0: 636f 7264 6564 2065 7665 6e74 206f 626a  corded event obj
-0000e6f0: 6563 7420 7468 6174 2068 6173 2061 2063  ect that has a c
-0000e700: 6f6d 6d69 7420 706f 7369 7469 6f6e 2065  ommit position e
-0000e710: 7175 616c 2074 6f20 7468 6520 636f 6d6d  qual to the comm
-0000e720: 6974 2070 6f73 6974 696f 6e0a 7370 6563  it position.spec
-0000e730: 6966 6965 6420 696e 2074 6865 2072 6571  ified in the req
-0000e740: 7565 7374 2e0a 0a57 6869 6c73 7420 7468  uest...Whilst th
-0000e750: 6572 6520 6172 6520 736f 6d65 2061 6476  ere are some adv
-0000e760: 616e 7461 6765 7320 6f66 2070 6572 7369  antages of persi
-0000e770: 7374 656e 7420 7375 6273 6372 6970 7469  stent subscripti
-0000e780: 6f6e 732c 2069 6e20 7061 7274 6963 756c  ons, in particul
-0000e790: 6172 2074 6865 0a70 726f 6365 7373 696e  ar the.processin
-0000e7a0: 6720 6f66 2072 6563 6f72 6465 6420 6576  g of recorded ev
-0000e7b0: 656e 7473 2062 7920 6120 6772 6f75 7020  ents by a group 
-0000e7c0: 6f66 2063 6f6e 7375 6d65 7273 2c20 6279  of consumers, by
-0000e7d0: 2074 7261 636b 696e 6720 696e 2074 6865   tracking in the
-0000e7e0: 0a75 7073 7472 6561 6d20 7365 7276 6572  .upstream server
-0000e7f0: 2074 6865 2070 6f73 6974 696f 6e20 696e   the position in
-0000e800: 2074 6865 2063 6f6d 6d69 7420 7365 7175   the commit sequ
-0000e810: 656e 6365 206f 6620 6576 656e 7473 2074  ence of events t
-0000e820: 6861 7420 6861 7665 2062 6565 6e20 7072  hat have been pr
-0000e830: 6f63 6573 7365 642c 0a74 6865 7265 2069  ocessed,.there i
-0000e840: 7320 6120 6461 6e67 6572 206f 6620 2264  s a danger of "d
-0000e850: 7561 6c20 7772 6974 696e 6722 2069 6e20  ual writing" in 
-0000e860: 7468 6520 636f 6e73 756d 7074 696f 6e20  the consumption 
-0000e870: 6f66 2065 7665 6e74 732e 2052 656c 6961  of events. Relia
-0000e880: 6269 6c69 7479 0a69 6e20 7072 6f63 6573  bility.in proces
-0000e890: 7369 6e67 206f 6620 7265 636f 7264 6564  sing of recorded
-0000e8a0: 2065 7665 6e74 7320 6279 2061 2067 726f   events by a gro
-0000e8b0: 7570 206f 6620 636f 6e73 756d 6572 7320  up of consumers 
-0000e8c0: 7769 6c6c 2072 656c 7920 696e 7374 6561  will rely instea
-0000e8d0: 6420 6f6e 0a69 6465 6d70 6f74 656e 7420  d on.idempotent 
-0000e8e0: 6861 6e64 6c69 6e67 206f 6620 6475 706c  handling of dupl
-0000e8f0: 6963 6174 6520 6d65 7373 6167 6573 2c20  icate messages, 
-0000e900: 616e 6420 7265 7369 6c69 656e 6365 2074  and resilience t
-0000e910: 6f20 6f75 742d 6f66 2d6f 7264 6572 2064  o out-of-order d
-0000e920: 656c 6976 6572 792e 0a0a 2323 2320 4765  elivery...### Ge
-0000e930: 7420 7375 6273 6372 6970 7469 6f6e 2069  t subscription i
-0000e940: 6e66 6f0a 0a2a 7265 7175 6972 6573 206c  nfo..*requires l
-0000e950: 6561 6465 722a 0a0a 5468 6520 6067 6574  eader*..The `get
-0000e960: 5f73 7562 7363 7269 7074 696f 6e5f 696e  _subscription_in
-0000e970: 666f 2829 6020 6d65 7468 6f64 2063 616e  fo()` method can
-0000e980: 2062 6520 7573 6564 2074 6f20 6765 7420   be used to get 
-0000e990: 696e 666f 726d 6174 696f 6e20 666f 7220  information for 
-0000e9a0: 610a 7065 7273 6973 7465 6e74 2073 7562  a.persistent sub
-0000e9b0: 7363 7269 7074 696f 6e2e 0a0a 5468 6973  scription...This
-0000e9c0: 206d 6574 686f 6420 6861 7320 6f6e 6520   method has one 
-0000e9d0: 7265 7175 6972 6564 2061 7267 756d 656e  required argumen
-0000e9e0: 742c 2060 6772 6f75 705f 6e61 6d65 602c  t, `group_name`,
-0000e9f0: 2077 6869 6368 0a73 686f 756c 6420 6d61   which.should ma
-0000ea00: 7463 6820 7468 6520 7661 6c75 6520 6f66  tch the value of
-0000ea10: 2074 6865 2061 7267 756d 656e 7420 7573   the argument us
-0000ea20: 6564 2077 6865 6e20 6361 6c6c 696e 6720  ed when calling 
-0000ea30: 6063 7265 6174 655f 7375 6273 6372 6970  `create_subscrip
-0000ea40: 7469 6f6e 2829 602e 0a0a 5468 6973 206d  tion()`...This m
-0000ea50: 6574 686f 6420 616c 736f 2074 616b 6573  ethod also takes
-0000ea60: 2061 6e20 6f70 7469 6f6e 616c 2060 7469   an optional `ti
-0000ea70: 6d65 6f75 7460 2061 7267 756d 656e 742c  meout` argument,
-0000ea80: 2074 6861 740a 6973 2065 7870 6563 7465   that.is expecte
-0000ea90: 6420 746f 2062 6520 6120 5079 7468 6f6e  d to be a Python
-0000eaa0: 2060 666c 6f61 7460 2c20 7768 6963 6820   `float`, which 
-0000eab0: 7365 7473 2061 2064 6561 646c 696e 650a  sets a deadline.
-0000eac0: 666f 7220 7468 6520 636f 6d70 6c65 7469  for the completi
-0000ead0: 6f6e 206f 6620 7468 6520 6752 5043 206f  on of the gRPC o
-0000eae0: 7065 7261 7469 6f6e 2e0a 0a60 6060 7079  peration...```py
-0000eaf0: 7468 6f6e 0a73 7562 7363 7269 7074 696f  thon.subscriptio
-0000eb00: 6e5f 696e 666f 203d 2063 6c69 656e 742e  n_info = client.
-0000eb10: 6765 745f 7375 6273 6372 6970 7469 6f6e  get_subscription
-0000eb20: 5f69 6e66 6f28 0a20 2020 2067 726f 7570  _info(.    group
-0000eb30: 5f6e 616d 653d 6772 6f75 705f 6e61 6d65  _name=group_name
-0000eb40: 2c0a 290a 6060 600a 0a54 6865 2072 6574  ,.).```..The ret
-0000eb50: 7572 6e65 6420 7661 6c75 6520 6973 2061  urned value is a
-0000eb60: 2060 5375 6273 6372 6970 7469 6f6e 496e   `SubscriptionIn
-0000eb70: 666f 6020 6f62 6a65 6374 2e0a 0a23 2323  fo` object...###
-0000eb80: 204c 6973 7420 7375 6273 6372 6970 7469   List subscripti
-0000eb90: 6f6e 730a 0a2a 7265 7175 6972 6573 206c  ons..*requires l
-0000eba0: 6561 6465 722a 0a0a 5468 6520 606c 6973  eader*..The `lis
-0000ebb0: 745f 7375 6273 6372 6970 7469 6f6e 7328  t_subscriptions(
-0000ebc0: 2960 206d 6574 686f 6420 6361 6e20 6265  )` method can be
-0000ebd0: 2075 7365 6420 746f 2067 6574 2069 6e66   used to get inf
-0000ebe0: 6f72 6d61 7469 6f6e 2066 6f72 2061 6c6c  ormation for all
-0000ebf0: 0a65 7869 7374 696e 6720 7065 7273 6973  .existing persis
-0000ec00: 7465 6e74 2073 7562 7363 7269 7074 696f  tent subscriptio
-0000ec10: 6e73 2e0a 0a54 6869 7320 6d65 7468 6f64  ns...This method
-0000ec20: 2074 616b 6573 2061 6e20 6f70 7469 6f6e   takes an option
-0000ec30: 616c 2060 7469 6d65 6f75 7460 2061 7267  al `timeout` arg
-0000ec40: 756d 656e 742c 2074 6861 740a 6973 2065  ument, that.is e
-0000ec50: 7870 6563 7465 6420 746f 2062 6520 6120  xpected to be a 
-0000ec60: 5079 7468 6f6e 2060 666c 6f61 7460 2c20  Python `float`, 
-0000ec70: 7768 6963 6820 7365 7473 2061 2064 6561  which sets a dea
-0000ec80: 646c 696e 650a 666f 7220 7468 6520 636f  dline.for the co
-0000ec90: 6d70 6c65 7469 6f6e 206f 6620 7468 6520  mpletion of the 
-0000eca0: 6752 5043 206f 7065 7261 7469 6f6e 2e0a  gRPC operation..
-0000ecb0: 0a60 6060 7079 7468 6f6e 0a73 7562 7363  .```python.subsc
-0000ecc0: 7269 7074 696f 6e73 203d 2063 6c69 656e  riptions = clien
-0000ecd0: 742e 6c69 7374 5f73 7562 7363 7269 7074  t.list_subscript
-0000ece0: 696f 6e73 2829 0a60 6060 0a0a 5468 6520  ions().```..The 
-0000ecf0: 7265 7475 726e 6564 2076 616c 7565 2069  returned value i
-0000ed00: 7320 6120 6c69 7374 206f 6620 6053 7562  s a list of `Sub
-0000ed10: 7363 7269 7074 696f 6e49 6e66 6f60 206f  scriptionInfo` o
-0000ed20: 626a 6563 7473 2e0a 0a23 2323 2044 656c  bjects...### Del
-0000ed30: 6574 6520 7375 6273 6372 6970 7469 6f6e  ete subscription
-0000ed40: 0a0a 2a72 6571 7569 7265 7320 6c65 6164  ..*requires lead
-0000ed50: 6572 2a0a 0a54 6865 2060 6465 6c65 7465  er*..The `delete
-0000ed60: 5f73 7562 7363 7269 7074 696f 6e28 2960  _subscription()`
-0000ed70: 206d 6574 686f 6420 6361 6e20 6265 2075   method can be u
-0000ed80: 7365 6420 746f 2064 656c 6574 6520 6120  sed to delete a 
-0000ed90: 7065 7273 6973 7465 6e74 0a73 7562 7363  persistent.subsc
-0000eda0: 7269 7074 696f 6e2e 0a0a 5468 6973 206d  ription...This m
-0000edb0: 6574 686f 6420 6861 7320 6f6e 6520 7265  ethod has one re
-0000edc0: 7175 6972 6564 2061 7267 756d 656e 742c  quired argument,
-0000edd0: 2060 6772 6f75 705f 6e61 6d65 602c 2077   `group_name`, w
-0000ede0: 6869 6368 0a73 686f 756c 6420 6d61 7463  hich.should matc
-0000edf0: 6820 7468 6520 7661 6c75 6520 6f66 2061  h the value of a
-0000ee00: 7267 756d 656e 7420 7573 6564 2077 6865  rgument used whe
-0000ee10: 6e20 6361 6c6c 696e 6720 6063 7265 6174  n calling `creat
-0000ee20: 655f 7375 6273 6372 6970 7469 6f6e 2829  e_subscription()
-0000ee30: 602e 0a0a 5468 6973 206d 6574 686f 6420  `...This method 
-0000ee40: 616c 736f 2074 616b 6573 2061 6e20 6f70  also takes an op
-0000ee50: 7469 6f6e 616c 2060 7469 6d65 6f75 7460  tional `timeout`
-0000ee60: 2061 7267 756d 656e 742c 2074 6861 740a   argument, that.
-0000ee70: 6973 2065 7870 6563 7465 6420 746f 2062  is expected to b
-0000ee80: 6520 6120 5079 7468 6f6e 2060 666c 6f61  e a Python `floa
-0000ee90: 7460 2c20 7768 6963 6820 7365 7473 2061  t`, which sets a
-0000eea0: 2064 6561 646c 696e 650a 666f 7220 7468   deadline.for th
-0000eeb0: 6520 636f 6d70 6c65 7469 6f6e 206f 6620  e completion of 
-0000eec0: 7468 6520 6752 5043 206f 7065 7261 7469  the gRPC operati
-0000eed0: 6f6e 2e0a 0a60 6060 7079 7468 6f6e 0a63  on...```python.c
-0000eee0: 6c69 656e 742e 6465 6c65 7465 5f73 7562  lient.delete_sub
-0000eef0: 7363 7269 7074 696f 6e28 0a20 2020 2067  scription(.    g
-0000ef00: 726f 7570 5f6e 616d 653d 6772 6f75 705f  roup_name=group_
-0000ef10: 6e61 6d65 2c0a 290a 6060 600a 0a23 2323  name,.).```..###
-0000ef20: 2043 7265 6174 6520 7374 7265 616d 2073   Create stream s
-0000ef30: 7562 7363 7269 7074 696f 6e0a 0a2a 7265  ubscription..*re
-0000ef40: 7175 6972 6573 206c 6561 6465 722a 0a0a  quires leader*..
-0000ef50: 5468 6520 6063 7265 6174 655f 7374 7265  The `create_stre
-0000ef60: 616d 5f73 7562 7363 7269 7074 696f 6e28  am_subscription(
-0000ef70: 2960 206d 6574 686f 6420 6361 6e20 6265  )` method can be
-0000ef80: 2075 7365 6420 746f 2063 7265 6174 6520   used to create 
-0000ef90: 6120 7065 7273 6973 7465 6e74 0a73 7562  a persistent.sub
-0000efa0: 7363 7269 7074 696f 6e20 666f 7220 6120  scription for a 
-0000efb0: 7374 7265 616d 2e0a 0a54 6869 7320 6d65  stream...This me
-0000efc0: 7468 6f64 2068 6173 2074 776f 2072 6571  thod has two req
-0000efd0: 7569 7265 6420 6172 6775 6d65 6e74 732c  uired arguments,
-0000efe0: 2060 6772 6f75 705f 6e61 6d65 6020 616e   `group_name` an
-0000eff0: 6420 6073 7472 6561 6d5f 6e61 6d65 602e  d `stream_name`.
-0000f000: 2054 6865 0a60 6772 6f75 705f 6e61 6d65   The.`group_name
-0000f010: 6020 6172 6775 6d65 6e74 206e 616d 6573  ` argument names
-0000f020: 2074 6865 2067 726f 7570 206f 6620 636f   the group of co
-0000f030: 6e73 756d 6572 7320 7468 6174 2077 696c  nsumers that wil
-0000f040: 6c20 7265 6365 6976 6520 6576 656e 7473  l receive events
-0000f050: 0a66 726f 6d20 7468 6973 2073 7562 7363  .from this subsc
-0000f060: 7269 7074 696f 6e2e 2054 6865 2060 7374  ription. The `st
-0000f070: 7265 616d 5f6e 616d 6560 2061 7267 756d  ream_name` argum
-0000f080: 656e 7420 7370 6563 6966 6965 7320 7768  ent specifies wh
-0000f090: 6963 6820 7374 7265 616d 0a74 6865 2073  ich stream.the s
-0000f0a0: 7562 7363 7269 7074 696f 6e20 7769 6c6c  ubscription will
-0000f0b0: 2066 6f6c 6c6f 772e 2054 6865 2076 616c   follow. The val
-0000f0c0: 7565 7320 6f66 2062 6f74 6820 7468 6573  ues of both thes
-0000f0d0: 6520 6172 6775 6d65 6e74 7320 6172 6520  e arguments are 
-0000f0e0: 6578 7065 6374 6564 0a74 6f20 6265 2050  expected.to be P
-0000f0f0: 7974 686f 6e20 6073 7472 6020 6f62 6a65  ython `str` obje
-0000f100: 6374 732e 0a0a 5468 6520 6d65 7468 6f64  cts...The method
-0000f110: 2061 6c73 6f20 7461 6b65 7320 666f 7572   also takes four
-0000f120: 206f 7074 696f 6e61 6c20 6172 6775 6d65   optional argume
-0000f130: 6e74 732c 2060 7374 7265 616d 5f70 6f73  nts, `stream_pos
-0000f140: 6974 696f 6e60 2c20 6066 726f 6d5f 656e  ition`, `from_en
-0000f150: 6460 2c0a 6063 6f6e 7375 6d65 725f 7374  d`,.`consumer_st
-0000f160: 7261 7465 6779 602c 2061 6e64 2060 7469  rategy`, and `ti
-0000f170: 6d65 6f75 7460 2e0a 0a54 6869 7320 6f70  meout`...This op
-0000f180: 7469 6f6e 616c 2060 7374 7265 616d 5f70  tional `stream_p
-0000f190: 6f73 6974 696f 6e60 2061 7267 756d 656e  osition` argumen
-0000f1a0: 7420 7370 6563 6966 6965 7320 6120 7374  t specifies a st
-0000f1b0: 7265 616d 2070 6f73 6974 696f 6e20 6672  ream position fr
-0000f1c0: 6f6d 0a77 6869 6368 2074 6f20 7375 6273  om.which to subs
-0000f1d0: 6372 6962 652e 2054 6865 2072 6563 6f72  cribe. The recor
-0000f1e0: 6465 6420 6576 656e 7420 6174 2074 6869  ded event at thi
-0000f1f0: 7320 7374 7265 616d 0a70 6f73 6974 696f  s stream.positio
-0000f200: 6e20 7769 6c6c 2062 6520 7265 6365 6976  n will be receiv
-0000f210: 6564 2077 6865 6e20 7265 6164 696e 6720  ed when reading 
-0000f220: 7468 6520 7375 6273 6372 6970 7469 6f6e  the subscription
-0000f230: 2e0a 0a54 6869 7320 6f70 7469 6f6e 616c  ...This optional
-0000f240: 2060 6672 6f6d 5f65 6e64 6020 6172 6775   `from_end` argu
-0000f250: 6d65 6e74 2069 7320 6120 5079 7468 6f6e  ment is a Python
-0000f260: 2060 626f 6f6c 602e 0a42 7920 6465 6661   `bool`..By defa
-0000f270: 756c 742c 2074 6865 2076 616c 7565 206f  ult, the value o
-0000f280: 6620 7468 6973 2061 7267 756d 656e 7420  f this argument 
-0000f290: 6973 2046 616c 7365 2e20 4966 2074 6869  is False. If thi
-0000f2a0: 7320 6172 6775 6d65 6e74 2069 7320 7365  s argument is se
-0000f2b0: 740a 746f 2061 2054 7275 6520 7661 6c75  t.to a True valu
-0000f2c0: 652c 2072 6561 6469 6e67 2066 726f 6d20  e, reading from 
-0000f2d0: 7468 6520 7375 6273 6372 6970 7469 6f6e  the subscription
-0000f2e0: 2077 696c 6c20 7265 6365 6976 6520 6f6e   will receive on
-0000f2f0: 6c79 2065 7665 6e74 730a 7265 636f 7264  ly events.record
-0000f300: 6564 2061 6674 6572 2074 6865 2073 7562  ed after the sub
-0000f310: 7363 7269 7074 696f 6e20 7761 7320 6372  scription was cr
-0000f320: 6561 7465 642e 2054 6861 7420 6973 2c20  eated. That is, 
-0000f330: 6974 2069 7320 6e6f 7420 696e 636c 7573  it is not inclus
-0000f340: 6976 650a 6f66 2074 6865 2063 7572 7265  ive.of the curre
-0000f350: 6e74 2073 7472 6561 6d20 706f 7369 7469  nt stream positi
-0000f360: 6f6e 2e0a 0a54 6865 206f 7074 696f 6e61  on...The optiona
-0000f370: 6c20 6063 6f6e 7375 6d65 725f 7374 7261  l `consumer_stra
-0000f380: 7465 6779 6020 6172 6775 6d65 6e74 2069  tegy` argument i
-0000f390: 7320 6120 5079 7468 6f6e 2060 7374 7260  s a Python `str`
-0000f3a0: 2074 6861 7420 6465 6669 6e65 730a 7468   that defines.th
-0000f3b0: 6520 636f 6e73 756d 6572 2073 7472 6174  e consumer strat
-0000f3c0: 6567 7920 666f 7220 7468 6973 2070 6572  egy for this per
-0000f3d0: 7369 7374 656e 7420 7375 6273 6372 6970  sistent subscrip
-0000f3e0: 7469 6f6e 2e20 5468 6520 7661 6c75 6520  tion. The value 
-0000f3f0: 6f66 2074 6869 7320 6172 6775 6d65 6e74  of this argument
-0000f400: 0a63 616e 2062 6520 6027 4469 7370 6174  .can be `'Dispat
-0000f410: 6368 546f 5369 6e67 6c65 2760 2c20 6027  chToSingle'`, `'
-0000f420: 526f 756e 6452 6f62 696e 2760 2c20 6027  RoundRobin'`, `'
-0000f430: 5069 6e6e 6564 2760 2c20 6f72 2060 2750  Pinned'`, or `'P
-0000f440: 696e 6e65 6442 7943 6f72 7265 6c61 7469  innedByCorrelati
-0000f450: 6f6e 2760 2e20 5468 650a 6465 6661 756c  on'`. The.defaul
-0000f460: 7420 7661 6c75 6520 6973 2060 2744 6973  t value is `'Dis
-0000f470: 7061 7463 6854 6f53 696e 676c 6527 602e  patchToSingle'`.
-0000f480: 0a0a 5468 6973 206d 6574 686f 6420 616c  ..This method al
-0000f490: 736f 2074 616b 6573 2061 6e20 6f70 7469  so takes an opti
-0000f4a0: 6f6e 616c 2060 7469 6d65 6f75 7460 2061  onal `timeout` a
-0000f4b0: 7267 756d 656e 742c 2074 6861 740a 6973  rgument, that.is
-0000f4c0: 2065 7870 6563 7465 6420 746f 2062 6520   expected to be 
-0000f4d0: 6120 5079 7468 6f6e 2060 666c 6f61 7460  a Python `float`
-0000f4e0: 2c20 7768 6963 6820 7365 7473 2061 2064  , which sets a d
-0000f4f0: 6561 646c 696e 650a 666f 7220 7468 6520  eadline.for the 
-0000f500: 636f 6d70 6c65 7469 6f6e 206f 6620 7468  completion of th
-0000f510: 6520 6752 5043 206f 7065 7261 7469 6f6e  e gRPC operation
-0000f520: 2e0a 0a54 6869 7320 6d65 7468 6f64 2064  ...This method d
-0000f530: 6f65 7320 6e6f 7420 7265 7475 726e 2061  oes not return a
-0000f540: 2076 616c 7565 2e20 4576 656e 7473 2063   value. Events c
-0000f550: 616e 2062 6520 7265 6365 6976 6564 2062  an be received b
-0000f560: 7920 6974 6572 6174 696e 670a 6f76 6572  y iterating.over
-0000f570: 2074 6865 2076 616c 7565 2072 6574 7572   the value retur
-0000f580: 6e65 6420 6279 2063 616c 6c69 6e67 2060  ned by calling `
-0000f590: 7265 6164 5f73 7472 6561 6d5f 7375 6273  read_stream_subs
-0000f5a0: 6372 6970 7469 6f6e 2829 6020 2873 6565  cription()` (see
-0000f5b0: 2062 656c 6f77 292e 0a0a 5468 6520 6578   below)...The ex
-0000f5c0: 616d 706c 6520 6265 6c6f 7720 6372 6561  ample below crea
-0000f5d0: 7465 7320 6120 7065 7273 6973 7465 6e74  tes a persistent
-0000f5e0: 2073 7472 6561 6d20 7375 6273 6372 6970   stream subscrip
-0000f5f0: 7469 6f6e 2066 726f 6d20 7468 6520 7374  tion from the st
-0000f600: 6172 7420 6f66 2074 6865 2073 7472 6561  art of the strea
-0000f610: 6d2e 0a0a 6060 6070 7974 686f 6e0a 2320  m...```python.# 
-0000f620: 4372 6561 7465 2061 2070 6572 7369 7374  Create a persist
-0000f630: 656e 7420 7374 7265 616d 2073 7562 7363  ent stream subsc
-0000f640: 7269 7074 696f 6e20 6672 6f6d 2073 7461  ription from sta
-0000f650: 7274 206f 6620 7468 6520 7374 7265 616d  rt of the stream
-0000f660: 2e0a 6772 6f75 705f 6e61 6d65 3120 3d20  ..group_name1 = 
-0000f670: 6622 6772 6f75 702d 7b75 7569 6434 2829  f"group-{uuid4()
-0000f680: 7d22 0a63 6c69 656e 742e 6372 6561 7465  }".client.create
-0000f690: 5f73 7472 6561 6d5f 7375 6273 6372 6970  _stream_subscrip
-0000f6a0: 7469 6f6e 280a 2020 2020 6772 6f75 705f  tion(.    group_
-0000f6b0: 6e61 6d65 3d67 726f 7570 5f6e 616d 6531  name=group_name1
-0000f6c0: 2c0a 2020 2020 7374 7265 616d 5f6e 616d  ,.    stream_nam
-0000f6d0: 653d 7374 7265 616d 5f6e 616d 6532 2c0a  e=stream_name2,.
-0000f6e0: 290a 6060 600a 0a54 6865 2065 7861 6d70  ).```..The examp
-0000f6f0: 6c65 2062 656c 6f77 2063 7265 6174 6573  le below creates
-0000f700: 2061 2070 6572 7369 7374 656e 7420 7374   a persistent st
-0000f710: 7265 616d 2073 7562 7363 7269 7074 696f  ream subscriptio
-0000f720: 6e20 6672 6f6d 2061 2073 7472 6561 6d20  n from a stream 
-0000f730: 706f 7369 7469 6f6e 2e0a 0a60 6060 7079  position...```py
-0000f740: 7468 6f6e 0a23 2043 7265 6174 6520 6120  thon.# Create a 
-0000f750: 7065 7273 6973 7465 6e74 2073 7472 6561  persistent strea
-0000f760: 6d20 7375 6273 6372 6970 7469 6f6e 2066  m subscription f
-0000f770: 726f 6d20 6120 7374 7265 616d 2070 6f73  rom a stream pos
-0000f780: 6974 696f 6e2e 0a67 726f 7570 5f6e 616d  ition..group_nam
-0000f790: 6532 203d 2066 2267 726f 7570 2d7b 7575  e2 = f"group-{uu
-0000f7a0: 6964 3428 297d 220a 636c 6965 6e74 2e63  id4()}".client.c
-0000f7b0: 7265 6174 655f 7374 7265 616d 5f73 7562  reate_stream_sub
-0000f7c0: 7363 7269 7074 696f 6e28 0a20 2020 2067  scription(.    g
-0000f7d0: 726f 7570 5f6e 616d 653d 6772 6f75 705f  roup_name=group_
-0000f7e0: 6e61 6d65 322c 0a20 2020 2073 7472 6561  name2,.    strea
-0000f7f0: 6d5f 6e61 6d65 3d73 7472 6561 6d5f 6e61  m_name=stream_na
-0000f800: 6d65 322c 0a20 2020 2073 7472 6561 6d5f  me2,.    stream_
-0000f810: 706f 7369 7469 6f6e 3d32 0a29 0a60 6060  position=2.).```
-0000f820: 0a0a 5468 6520 6578 616d 706c 6520 6265  ..The example be
-0000f830: 6c6f 7720 6372 6561 7465 7320 6120 7065  low creates a pe
-0000f840: 7273 6973 7465 6e74 2073 7472 6561 6d20  rsistent stream 
-0000f850: 7375 6273 6372 6970 7469 6f6e 2066 726f  subscription fro
-0000f860: 6d20 7468 6520 656e 6420 6f66 2074 6865  m the end of the
-0000f870: 2073 7472 6561 6d2e 0a0a 6060 6070 7974   stream...```pyt
-0000f880: 686f 6e0a 2320 4372 6561 7465 2061 2070  hon.# Create a p
-0000f890: 6572 7369 7374 656e 7420 7374 7265 616d  ersistent stream
-0000f8a0: 2073 7562 7363 7269 7074 696f 6e20 6672   subscription fr
-0000f8b0: 6f6d 2065 6e64 206f 6620 7468 6520 7374  om end of the st
-0000f8c0: 7265 616d 2e0a 6772 6f75 705f 6e61 6d65  ream..group_name
-0000f8d0: 3320 3d20 6622 6772 6f75 702d 7b75 7569  3 = f"group-{uui
-0000f8e0: 6434 2829 7d22 0a63 6c69 656e 742e 6372  d4()}".client.cr
-0000f8f0: 6561 7465 5f73 7472 6561 6d5f 7375 6273  eate_stream_subs
-0000f900: 6372 6970 7469 6f6e 280a 2020 2020 6772  cription(.    gr
-0000f910: 6f75 705f 6e61 6d65 3d67 726f 7570 5f6e  oup_name=group_n
-0000f920: 616d 6533 2c0a 2020 2020 7374 7265 616d  ame3,.    stream
-0000f930: 5f6e 616d 653d 7374 7265 616d 5f6e 616d  _name=stream_nam
-0000f940: 6532 2c0a 2020 2020 6672 6f6d 5f65 6e64  e2,.    from_end
-0000f950: 3d54 7275 650a 290a 6060 600a 0a23 2323  =True.).```..###
-0000f960: 2052 6561 6420 7374 7265 616d 2073 7562   Read stream sub
-0000f970: 7363 7269 7074 696f 6e0a 0a2a 7265 7175  scription..*requ
-0000f980: 6972 6573 206c 6561 6465 722a 0a0a 5468  ires leader*..Th
-0000f990: 6520 6072 6561 645f 7374 7265 616d 5f73  e `read_stream_s
-0000f9a0: 7562 7363 7269 7074 696f 6e28 2960 206d  ubscription()` m
-0000f9b0: 6574 686f 6420 6361 6e20 6265 2075 7365  ethod can be use
-0000f9c0: 6420 746f 2063 7265 6174 6520 6120 7065  d to create a pe
-0000f9d0: 7273 6973 7465 6e74 0a73 7562 7363 7269  rsistent.subscri
-0000f9e0: 7074 696f 6e20 666f 7220 6120 7374 7265  ption for a stre
-0000f9f0: 616d 2e0a 0a54 6869 7320 6d65 7468 6f64  am...This method
-0000fa00: 2068 6173 2074 776f 2072 6571 7569 7265   has two require
-0000fa10: 6420 6172 6775 6d65 6e74 732c 2060 6772  d arguments, `gr
-0000fa20: 6f75 705f 6e61 6d65 6020 616e 6420 6073  oup_name` and `s
-0000fa30: 7472 6561 6d5f 6e61 6d65 602c 2077 6869  tream_name`, whi
-0000fa40: 6368 0a73 686f 756c 6420 6d61 7463 6820  ch.should match 
-0000fa50: 7468 6520 7661 6c75 6573 206f 6620 6172  the values of ar
-0000fa60: 6775 6d65 6e74 7320 7573 6564 2077 6865  guments used whe
-0000fa70: 6e20 6361 6c6c 696e 6720 6063 7265 6174  n calling `creat
-0000fa80: 655f 7374 7265 616d 5f73 7562 7363 7269  e_stream_subscri
-0000fa90: 7074 696f 6e28 2960 2e0a 0a54 6869 7320  ption()`...This 
-0000faa0: 6d65 7468 6f64 2061 6c73 6f20 7461 6b65  method also take
-0000fab0: 7320 616e 206f 7074 696f 6e61 6c20 6074  s an optional `t
-0000fac0: 696d 656f 7574 6020 6172 6775 6d65 6e74  imeout` argument
-0000fad0: 2c20 7468 6174 0a69 7320 6578 7065 6374  , that.is expect
-0000fae0: 6564 2074 6f20 6265 2061 2050 7974 686f  ed to be a Pytho
-0000faf0: 6e20 6066 6c6f 6174 602c 2077 6869 6368  n `float`, which
-0000fb00: 2073 6574 7320 6120 6465 6164 6c69 6e65   sets a deadline
-0000fb10: 0a66 6f72 2074 6865 2063 6f6d 706c 6574  .for the complet
-0000fb20: 696f 6e20 6f66 2074 6865 2067 5250 4320  ion of the gRPC 
-0000fb30: 6f70 6572 6174 696f 6e2e 0a0a 4a75 7374  operation...Just
-0000fb40: 206c 696b 6520 6072 6561 645f 7375 6273   like `read_subs
-0000fb50: 6372 6970 7469 6f6e 602c 2074 6869 7320  cription`, this 
-0000fb60: 6d65 7468 6f64 2072 6574 7572 6e73 2061  method returns a
-0000fb70: 2032 2d74 7570 6c65 3a20 6120 2272 6561   2-tuple: a "rea
-0000fb80: 6420 7265 7175 6573 7422 206f 626a 6563  d request" objec
-0000fb90: 740a 616e 6420 6120 2272 6561 6420 7265  t.and a "read re
-0000fba0: 7370 6f6e 7365 2220 6f62 6a65 6374 2e0a  sponse" object..
-0000fbb0: 0a60 6060 7079 7468 6f6e 0a72 6561 645f  .```python.read_
-0000fbc0: 7265 712c 2072 6561 645f 7265 7370 203d  req, read_resp =
-0000fbd0: 2063 6c69 656e 742e 7265 6164 5f73 7472   client.read_str
-0000fbe0: 6561 6d5f 7375 6273 6372 6970 7469 6f6e  eam_subscription
-0000fbf0: 280a 2020 2020 6772 6f75 705f 6e61 6d65  (.    group_name
-0000fc00: 3d67 726f 7570 5f6e 616d 6531 2c0a 2020  =group_name1,.  
-0000fc10: 2020 7374 7265 616d 5f6e 616d 653d 7374    stream_name=st
-0000fc20: 7265 616d 5f6e 616d 6532 2c0a 290a 6060  ream_name2,.).``
-0000fc30: 600a 0a54 6865 2065 7861 6d70 6c65 2062  `..The example b
-0000fc40: 656c 6f77 2069 7465 7261 7465 7320 6f76  elow iterates ov
-0000fc50: 6572 2074 6865 2022 7265 6164 2072 6573  er the "read res
-0000fc60: 706f 6e73 6522 206f 626a 6563 742c 2061  ponse" object, a
-0000fc70: 6e64 2063 616c 6c73 2060 6163 6b28 2960  nd calls `ack()`
-0000fc80: 0a6f 6e20 7468 6520 2272 6561 6420 7265  .on the "read re
-0000fc90: 7370 6f6e 7365 2220 6f62 6a65 6374 2e20  sponse" object. 
-0000fca0: 5468 6520 666f 7220 6c6f 6f70 2062 7265  The for loop bre
-0000fcb0: 616b 7320 7768 656e 2077 6520 6861 7665  aks when we have
-0000fcc0: 2072 6563 6569 7665 640a 7468 6520 6c61   received.the la
-0000fcd0: 7374 2065 7665 6e74 2069 6e20 7468 6520  st event in the 
-0000fce0: 7374 7265 616d 2c20 736f 2074 6861 7420  stream, so that 
-0000fcf0: 7765 2063 616e 2066 696e 6973 6820 7468  we can finish th
-0000fd00: 6520 6578 616d 706c 6573 2069 6e20 7468  e examples in th
-0000fd10: 6973 0a64 6f63 756d 656e 7461 7469 6f6e  is.documentation
-0000fd20: 2e0a 0a60 6060 7079 7468 6f6e 0a65 7665  ...```python.eve
-0000fd30: 6e74 7320 3d20 5b5d 0a66 6f72 2065 7665  nts = [].for eve
-0000fd40: 6e74 2069 6e20 7265 6164 5f72 6573 703a  nt in read_resp:
-0000fd50: 0a20 2020 2065 7665 6e74 732e 6170 7065  .    events.appe
-0000fd60: 6e64 2865 7665 6e74 290a 0a20 2020 2023  nd(event)..    #
-0000fd70: 2041 636b 6e6f 776c 6564 6765 2074 6865   Acknowledge the
-0000fd80: 2072 6563 6569 7665 6420 6576 656e 742e   received event.
-0000fd90: 0a20 2020 2072 6561 645f 7265 712e 6163  .    read_req.ac
-0000fda0: 6b28 6576 656e 745f 6964 3d65 7665 6e74  k(event_id=event
-0000fdb0: 2e69 6429 0a0a 2020 2020 2320 4272 6561  .id)..    # Brea
-0000fdc0: 6b20 7768 656e 2074 6865 206c 6173 7420  k when the last 
-0000fdd0: 6576 656e 7420 6861 7320 6265 656e 2072  event has been r
-0000fde0: 6563 6569 7665 642e 0a20 2020 2069 6620  eceived..    if 
-0000fdf0: 6576 656e 742e 6964 203d 3d20 6576 656e  event.id == even
-0000fe00: 7431 312e 6964 3a0a 2020 2020 2020 2020  t11.id:.        
-0000fe10: 6272 6561 6b0a 6060 600a 0a57 6520 6361  break.```..We ca
-0000fe20: 6e20 6368 6563 6b20 7765 2072 6563 6569  n check we recei
-0000fe30: 7665 6420 616c 6c20 7468 6520 6576 656e  ved all the even
-0000fe40: 7473 2074 6861 7420 7765 7265 2061 7070  ts that were app
-0000fe50: 656e 6465 6420 746f 2060 7374 7265 616d  ended to `stream
-0000fe60: 5f6e 616d 6532 600a 696e 2074 6865 2065  _name2`.in the e
-0000fe70: 7861 6d70 6c65 7320 6162 6f76 652e 0a0a  xamples above...
-0000fe80: 6060 6070 7974 686f 6e0a 6173 7365 7274  ```python.assert
-0000fe90: 206c 656e 2865 7665 6e74 7329 203d 3d20   len(events) == 
-0000fea0: 340a 6173 7365 7274 2065 7665 6e74 735b  4.assert events[
-0000feb0: 305d 2e73 7472 6561 6d5f 6e61 6d65 203d  0].stream_name =
-0000fec0: 3d20 7374 7265 616d 5f6e 616d 6532 0a61  = stream_name2.a
-0000fed0: 7373 6572 7420 6576 656e 7473 5b30 5d2e  ssert events[0].
-0000fee0: 6964 203d 3d20 6576 656e 7434 2e69 640a  id == event4.id.
-0000fef0: 6173 7365 7274 2065 7665 6e74 735b 315d  assert events[1]
-0000ff00: 2e73 7472 6561 6d5f 6e61 6d65 203d 3d20  .stream_name == 
-0000ff10: 7374 7265 616d 5f6e 616d 6532 0a61 7373  stream_name2.ass
-0000ff20: 6572 7420 6576 656e 7473 5b31 5d2e 6964  ert events[1].id
-0000ff30: 203d 3d20 6576 656e 7435 2e69 640a 6173   == event5.id.as
-0000ff40: 7365 7274 2065 7665 6e74 735b 325d 2e73  sert events[2].s
-0000ff50: 7472 6561 6d5f 6e61 6d65 203d 3d20 7374  tream_name == st
-0000ff60: 7265 616d 5f6e 616d 6532 0a61 7373 6572  ream_name2.asser
-0000ff70: 7420 6576 656e 7473 5b32 5d2e 6964 203d  t events[2].id =
-0000ff80: 3d20 6576 656e 7436 2e69 640a 6173 7365  = event6.id.asse
-0000ff90: 7274 2065 7665 6e74 735b 335d 2e73 7472  rt events[3].str
-0000ffa0: 6561 6d5f 6e61 6d65 203d 3d20 7374 7265  eam_name == stre
-0000ffb0: 616d 5f6e 616d 6532 0a61 7373 6572 7420  am_name2.assert 
-0000ffc0: 6576 656e 7473 5b33 5d2e 6964 203d 3d20  events[3].id == 
-0000ffd0: 6576 656e 7431 312e 6964 0a60 6060 0a0a  event11.id.```..
-0000ffe0: 2323 2320 4765 7420 7374 7265 616d 2073  ### Get stream s
-0000fff0: 7562 7363 7269 7074 696f 6e20 696e 666f  ubscription info
-00010000: 0a0a 2a72 6571 7569 7265 7320 6c65 6164  ..*requires lead
-00010010: 6572 2a0a 0a54 6865 2060 6765 745f 7374  er*..The `get_st
-00010020: 7265 616d 5f73 7562 7363 7269 7074 696f  ream_subscriptio
-00010030: 6e5f 696e 666f 2829 6020 6d65 7468 6f64  n_info()` method
-00010040: 2063 616e 2062 6520 7573 6564 2074 6f20   can be used to 
-00010050: 6765 7420 696e 666f 726d 6174 696f 6e20  get information 
-00010060: 666f 7220 610a 7065 7273 6973 7465 6e74  for a.persistent
-00010070: 2073 7562 7363 7269 7074 696f 6e20 666f   subscription fo
-00010080: 7220 6120 7374 7265 616d 2e0a 0a54 6869  r a stream...Thi
-00010090: 7320 6d65 7468 6f64 2068 6173 2074 776f  s method has two
-000100a0: 2072 6571 7569 7265 6420 6172 6775 6d65   required argume
-000100b0: 6e74 732c 2060 6772 6f75 705f 6e61 6d65  nts, `group_name
-000100c0: 6020 616e 6420 6073 7472 6561 6d5f 6e61  ` and `stream_na
-000100d0: 6d65 602c 2077 6869 6368 0a73 686f 756c  me`, which.shoul
-000100e0: 6420 6d61 7463 6820 7468 6520 7661 6c75  d match the valu
-000100f0: 6573 206f 6620 6172 6775 6d65 6e74 7320  es of arguments 
-00010100: 7573 6564 2077 6865 6e20 6361 6c6c 696e  used when callin
-00010110: 6720 6063 7265 6174 655f 7374 7265 616d  g `create_stream
-00010120: 5f73 7562 7363 7269 7074 696f 6e28 2960  _subscription()`
-00010130: 2e0a 0a54 6869 7320 6d65 7468 6f64 2061  ...This method a
-00010140: 6c73 6f20 7461 6b65 7320 616e 206f 7074  lso takes an opt
-00010150: 696f 6e61 6c20 6074 696d 656f 7574 6020  ional `timeout` 
-00010160: 6172 6775 6d65 6e74 2c20 7468 6174 0a69  argument, that.i
-00010170: 7320 6578 7065 6374 6564 2074 6f20 6265  s expected to be
-00010180: 2061 2050 7974 686f 6e20 6066 6c6f 6174   a Python `float
-00010190: 602c 2077 6869 6368 2073 6574 7320 6120  `, which sets a 
-000101a0: 6465 6164 6c69 6e65 0a66 6f72 2074 6865  deadline.for the
-000101b0: 2063 6f6d 706c 6574 696f 6e20 6f66 2074   completion of t
-000101c0: 6865 2067 5250 4320 6f70 6572 6174 696f  he gRPC operatio
-000101d0: 6e2e 0a0a 6060 6070 7974 686f 6e0a 7375  n...```python.su
-000101e0: 6273 6372 6970 7469 6f6e 5f69 6e66 6f20  bscription_info 
-000101f0: 3d20 636c 6965 6e74 2e67 6574 5f73 7472  = client.get_str
-00010200: 6561 6d5f 7375 6273 6372 6970 7469 6f6e  eam_subscription
-00010210: 5f69 6e66 6f28 0a20 2020 2067 726f 7570  _info(.    group
-00010220: 5f6e 616d 653d 6772 6f75 705f 6e61 6d65  _name=group_name
-00010230: 312c 0a20 2020 2073 7472 6561 6d5f 6e61  1,.    stream_na
-00010240: 6d65 3d73 7472 6561 6d5f 6e61 6d65 322c  me=stream_name2,
-00010250: 0a29 0a60 6060 0a0a 5468 6520 7265 7475  .).```..The retu
-00010260: 726e 6564 2076 616c 7565 2069 7320 6120  rned value is a 
-00010270: 6053 7562 7363 7269 7074 696f 6e49 6e66  `SubscriptionInf
-00010280: 6f60 206f 626a 6563 742e 0a0a 2323 2320  o` object...### 
-00010290: 4c69 7374 2073 7472 6561 6d20 7375 6273  List stream subs
-000102a0: 6372 6970 7469 6f6e 730a 0a2a 7265 7175  criptions..*requ
-000102b0: 6972 6573 206c 6561 6465 722a 0a0a 5468  ires leader*..Th
-000102c0: 6520 606c 6973 745f 7374 7265 616d 5f73  e `list_stream_s
-000102d0: 7562 7363 7269 7074 696f 6e73 2829 6020  ubscriptions()` 
-000102e0: 6d65 7468 6f64 2063 616e 2062 6520 7573  method can be us
-000102f0: 6564 2074 6f20 6765 7420 696e 666f 726d  ed to get inform
-00010300: 6174 696f 6e20 666f 7220 616c 6c0a 7468  ation for all.th
-00010310: 6520 7065 7273 6973 7465 6e74 2073 7562  e persistent sub
-00010320: 7363 7269 7074 696f 6e73 2066 6f72 2061  scriptions for a
-00010330: 2073 7472 6561 6d2e 0a0a 5468 6973 206d   stream...This m
-00010340: 6574 686f 6420 6861 7320 6f6e 6520 7265  ethod has one re
-00010350: 7175 6972 6564 2061 7267 756d 656e 742c  quired argument,
-00010360: 2060 7374 7265 616d 5f6e 616d 6560 2e0a   `stream_name`..
-00010370: 0a54 6869 7320 6d65 7468 6f64 2061 6c73  .This method als
-00010380: 6f20 7461 6b65 7320 616e 206f 7074 696f  o takes an optio
-00010390: 6e61 6c20 6074 696d 656f 7574 6020 6172  nal `timeout` ar
-000103a0: 6775 6d65 6e74 2c20 7468 6174 0a69 7320  gument, that.is 
-000103b0: 6578 7065 6374 6564 2074 6f20 6265 2061  expected to be a
-000103c0: 2050 7974 686f 6e20 6066 6c6f 6174 602c   Python `float`,
-000103d0: 2077 6869 6368 2073 6574 7320 6120 6465   which sets a de
-000103e0: 6164 6c69 6e65 0a66 6f72 2074 6865 2063  adline.for the c
-000103f0: 6f6d 706c 6574 696f 6e20 6f66 2074 6865  ompletion of the
-00010400: 2067 5250 4320 6f70 6572 6174 696f 6e2e   gRPC operation.
-00010410: 0a0a 6060 6070 7974 686f 6e0a 7375 6273  ..```python.subs
-00010420: 6372 6970 7469 6f6e 7320 3d20 636c 6965  criptions = clie
-00010430: 6e74 2e6c 6973 745f 7374 7265 616d 5f73  nt.list_stream_s
-00010440: 7562 7363 7269 7074 696f 6e73 280a 2020  ubscriptions(.  
-00010450: 2020 7374 7265 616d 5f6e 616d 653d 7374    stream_name=st
-00010460: 7265 616d 5f6e 616d 6532 2c0a 290a 6060  ream_name2,.).``
-00010470: 600a 0a54 6865 2072 6574 7572 6e65 6420  `..The returned 
-00010480: 7661 6c75 6520 6973 2061 206c 6973 7420  value is a list 
-00010490: 6f66 2060 5375 6273 6372 6970 7469 6f6e  of `Subscription
-000104a0: 496e 666f 6020 6f62 6a65 6374 732e 0a0a  Info` objects...
-000104b0: 2323 2320 4465 6c65 7465 2073 7472 6561  ### Delete strea
-000104c0: 6d20 7375 6273 6372 6970 7469 6f6e 0a0a  m subscription..
-000104d0: 2a72 6571 7569 7265 7320 6c65 6164 6572  *requires leader
-000104e0: 2a0a 0a54 6865 2060 6465 6c65 7465 5f73  *..The `delete_s
-000104f0: 7472 6561 6d5f 7375 6273 6372 6970 7469  tream_subscripti
-00010500: 6f6e 2829 6020 6d65 7468 6f64 2063 616e  on()` method can
-00010510: 2062 6520 7573 6564 2074 6f20 6465 6c65   be used to dele
-00010520: 7465 2061 2070 6572 7369 7374 656e 740a  te a persistent.
-00010530: 7375 6273 6372 6970 7469 6f6e 2066 6f72  subscription for
-00010540: 2061 2073 7472 6561 6d2e 0a0a 5468 6973   a stream...This
-00010550: 206d 6574 686f 6420 6861 7320 7477 6f20   method has two 
-00010560: 7265 7175 6972 6564 2061 7267 756d 656e  required argumen
-00010570: 7473 2c20 6067 726f 7570 5f6e 616d 6560  ts, `group_name`
-00010580: 2061 6e64 2060 7374 7265 616d 5f6e 616d   and `stream_nam
-00010590: 6560 2c20 7768 6963 680a 7368 6f75 6c64  e`, which.should
-000105a0: 206d 6174 6368 2074 6865 2076 616c 7565   match the value
-000105b0: 7320 6f66 2061 7267 756d 656e 7473 2075  s of arguments u
-000105c0: 7365 6420 7768 656e 2063 616c 6c69 6e67  sed when calling
-000105d0: 2060 6372 6561 7465 5f73 7472 6561 6d5f   `create_stream_
-000105e0: 7375 6273 6372 6970 7469 6f6e 2829 602e  subscription()`.
-000105f0: 0a0a 5468 6973 206d 6574 686f 6420 616c  ..This method al
-00010600: 736f 2074 616b 6573 2061 6e20 6f70 7469  so takes an opti
-00010610: 6f6e 616c 2060 7469 6d65 6f75 7460 2061  onal `timeout` a
-00010620: 7267 756d 656e 742c 2074 6861 740a 6973  rgument, that.is
-00010630: 2065 7870 6563 7465 6420 746f 2062 6520   expected to be 
-00010640: 6120 5079 7468 6f6e 2060 666c 6f61 7460  a Python `float`
-00010650: 2c20 7768 6963 6820 7365 7473 2061 2064  , which sets a d
-00010660: 6561 646c 696e 650a 666f 7220 7468 6520  eadline.for the 
-00010670: 636f 6d70 6c65 7469 6f6e 206f 6620 7468  completion of th
-00010680: 6520 6752 5043 206f 7065 7261 7469 6f6e  e gRPC operation
-00010690: 2e0a 0a60 6060 7079 7468 6f6e 0a63 6c69  ...```python.cli
-000106a0: 656e 742e 6465 6c65 7465 5f73 7472 6561  ent.delete_strea
-000106b0: 6d5f 7375 6273 6372 6970 7469 6f6e 280a  m_subscription(.
-000106c0: 2020 2020 6772 6f75 705f 6e61 6d65 3d67      group_name=g
-000106d0: 726f 7570 5f6e 616d 6531 2c0a 2020 2020  roup_name1,.    
-000106e0: 7374 7265 616d 5f6e 616d 653d 7374 7265  stream_name=stre
-000106f0: 616d 5f6e 616d 6532 2c0a 290a 6060 600a  am_name2,.).```.
-00010700: 0a23 2320 436f 6e6e 6563 7469 6f6e 0a0a  .## Connection..
-00010710: 2323 2320 5265 636f 6e6e 6563 740a 0a54  ### Reconnect..T
-00010720: 6865 2060 7265 636f 6e6e 6563 7428 2960  he `reconnect()`
-00010730: 206d 6574 686f 6420 6361 6e20 6265 2075   method can be u
-00010740: 7365 6420 746f 206d 616e 7561 6c6c 7920  sed to manually 
-00010750: 7265 636f 6e6e 6563 7420 7468 6520 636c  reconnect the cl
-00010760: 6965 6e74 2074 6f20 610a 7375 6974 6162  ient to a.suitab
-00010770: 6c65 2045 7665 6e74 5374 6f72 6544 4220  le EventStoreDB 
-00010780: 6e6f 6465 2e20 5468 6973 206d 6574 686f  node. This metho
-00010790: 6420 7573 6573 2074 6865 2073 616d 6520  d uses the same 
-000107a0: 726f 7574 696e 6520 666f 7220 7265 6164  routine for read
-000107b0: 696e 6720 7468 650a 636c 7573 7465 7220  ing the.cluster 
-000107c0: 6e6f 6465 2073 7461 7465 7320 616e 6420  node states and 
-000107d0: 7468 656e 2063 6f6e 6e65 6374 696e 6720  then connecting 
-000107e0: 746f 2061 2073 7569 7461 626c 6520 6e6f  to a suitable no
-000107f0: 6465 2061 6363 6f72 6469 6e67 2074 6f20  de according to 
-00010800: 7468 650a 636c 6965 6e74 2773 206e 6f64  the.client's nod
-00010810: 6520 7072 6566 6572 656e 6365 2074 6861  e preference tha
-00010820: 7420 6973 2073 7065 6369 6669 6564 2069  t is specified i
-00010830: 6e20 7468 6520 636f 6e6e 6563 7469 6f6e  n the connection
-00010840: 2073 7472 696e 6720 5552 4920 7768 656e   string URI when
-00010850: 0a74 6865 2063 6c69 656e 7420 6973 2063  .the client is c
-00010860: 6f6e 7374 7275 6374 6564 2e20 5468 6973  onstructed. This
-00010870: 206d 6574 686f 6420 6973 2074 6872 6561   method is threa
-00010880: 642d 7361 6665 2c20 616e 6420 6974 2069  d-safe, and it i
-00010890: 7320 2263 6f6e 7365 7276 6174 6976 6522  s "conservative"
-000108a0: 0a69 6e20 7468 6174 2c20 7768 656e 2069  .in that, when i
-000108b0: 7420 6973 2063 616c 6c65 6420 6279 2073  t is called by s
-000108c0: 6576 6572 616c 2074 6872 6561 6473 2061  everal threads a
-000108d0: 7420 7468 6520 7361 6d65 2074 696d 652c  t the same time,
-000108e0: 206f 6e6c 7920 6f6e 650a 7265 636f 6e6e   only one.reconn
-000108f0: 6563 7469 6f6e 2077 696c 6c20 6f63 6375  ection will occu
-00010900: 722e 2043 6f6e 6375 7272 656e 7420 6174  r. Concurrent at
-00010910: 7465 6d70 7473 2074 6f20 7265 636f 6e6e  tempts to reconn
-00010920: 6563 7420 7769 6c6c 2062 6c6f 636b 2075  ect will block u
-00010930: 6e74 696c 0a74 6865 2063 6c69 656e 7420  ntil.the client 
-00010940: 6861 7320 7265 636f 6e6e 6563 7465 6420  has reconnected 
-00010950: 7375 6363 6573 7366 756c 6c79 2c20 616e  successfully, an
-00010960: 6420 7468 656e 2074 6865 7920 7769 6c6c  d then they will
-00010970: 2061 6c6c 2072 6574 7572 6e20 6e6f 726d   all return norm
-00010980: 616c 6c79 2e0a 0a60 6060 7079 7468 6f6e  ally...```python
-00010990: 0a63 6c69 656e 742e 7265 636f 6e6e 6563  .client.reconnec
-000109a0: 7428 290a 6060 600a 0a41 6e20 6578 616d  t().```..An exam
-000109b0: 706c 6520 6f66 2077 6865 6e20 6974 206d  ple of when it m
-000109c0: 6967 6874 2062 6520 6465 7369 7261 626c  ight be desirabl
-000109d0: 6520 746f 2072 6563 6f6e 6e65 6374 206d  e to reconnect m
-000109e0: 616e 7561 6c6c 7920 6973 2077 6865 6e20  anually is when 
-000109f0: 2866 6f72 2070 6572 666f 726d 616e 6365  (for performance
-00010a00: 0a72 6561 736f 6e73 2920 7468 6520 636c  .reasons) the cl
-00010a10: 6965 6e74 2773 206e 6f64 6520 7072 6566  ient's node pref
-00010a20: 6572 656e 6365 2069 7320 746f 2062 6520  erence is to be 
-00010a30: 636f 6e6e 6563 7465 6420 746f 2061 2066  connected to a f
-00010a40: 6f6c 6c6f 7765 7220 6e6f 6465 2069 6e20  ollower node in 
-00010a50: 7468 650a 636c 7573 7465 722c 2061 6e64  the.cluster, and
-00010a60: 2c20 6166 7465 7220 6120 636c 7573 7465  , after a cluste
-00010a70: 7220 6c65 6164 6572 2065 6c65 6374 696f  r leader electio
-00010a80: 6e2c 2074 6865 2066 6f6c 6c6f 7765 7220  n, the follower 
-00010a90: 6265 636f 6d65 7320 7468 6520 6c65 6164  becomes the lead
-00010aa0: 6572 2e0a 5265 636f 6e6e 6563 7469 6e67  er..Reconnecting
-00010ab0: 2074 6f20 6120 666f 6c6c 6f77 6572 206e   to a follower n
-00010ac0: 6f64 6520 696e 2074 6869 7320 6361 7365  ode in this case
-00010ad0: 2069 7320 6375 7272 656e 746c 7920 6265   is currently be
-00010ae0: 796f 6e64 2074 6865 2063 6170 6162 696c  yond the capabil
-00010af0: 6974 6965 7320 6f66 0a74 6869 7320 636c  ities of.this cl
-00010b00: 6965 6e74 2c20 6275 7420 7468 6973 2062  ient, but this b
-00010b10: 6568 6176 696f 7220 6d69 6768 7420 6265  ehavior might be
-00010b20: 2069 6d70 6c65 6d65 6e74 6564 2069 6e20   implemented in 
-00010b30: 6120 6675 7475 7265 2072 656c 6561 7365  a future release
-00010b40: 2e0a 0a50 6c65 6173 6520 6e6f 7465 2c20  ...Please note, 
-00010b50: 6e65 6172 6c79 2061 6c6c 2074 6865 2063  nearly all the c
-00010b60: 6c69 656e 7420 6d65 7468 6f64 7320 6172  lient methods ar
-00010b70: 6520 6465 636f 7261 7465 6420 7769 7468  e decorated with
-00010b80: 2060 4061 7574 6f72 6563 6f6e 6e65 6374   `@autoreconnect
-00010b90: 6020 2877 6869 6368 0a63 616c 6c73 2074  ` (which.calls t
-00010ba0: 6865 2060 7265 636f 6e6e 6563 7428 2960  he `reconnect()`
-00010bb0: 206d 6574 686f 6420 7768 656e 2074 6865   method when the
-00010bc0: 2063 6c69 656e 7420 6465 7465 6374 7320   client detects 
-00010bd0: 7468 6174 2072 6563 6f6e 6e65 6374 696e  that reconnectin
-00010be0: 6720 6973 2072 6571 7569 7265 6429 0a61  g is required).a
-00010bf0: 6e64 2061 2060 4072 6574 7279 6020 6465  nd a `@retry` de
-00010c00: 636f 7261 746f 7220 7468 6174 206d 6f72  corator that mor
-00010c10: 6520 6765 6e65 7261 6c6c 7920 7769 6c6c  e generally will
-00010c20: 2072 6574 7279 206f 7065 7261 7469 6f6e   retry operation
-00010c30: 7320 7468 6174 2066 6169 6c20 6475 6520  s that fail due 
-00010c40: 746f 0a63 6f6e 6e65 6374 696f 6e20 6973  to.connection is
-00010c50: 7375 6573 2e0a 0a54 6865 2060 4061 7574  sues...The `@aut
-00010c60: 6f72 6563 6f6e 6e65 6374 6020 6465 636f  oreconnect` deco
-00010c70: 7261 746f 7220 7769 6c6c 2072 6563 6f6e  rator will recon
-00010c80: 6e65 6374 2074 6f20 6120 7375 6974 6162  nect to a suitab
-00010c90: 6c65 206e 6f64 6520 696e 2074 6865 2063  le node in the c
-00010ca0: 6c75 7374 6572 2077 6865 6e0a 7468 6520  luster when.the 
-00010cb0: 7365 7276 6572 2074 6f20 7768 6963 6820  server to which 
-00010cc0: 7468 6520 636c 6965 6e74 2068 6173 2062  the client has b
-00010cd0: 6565 6e20 636f 6e6e 6563 7465 6420 6861  een connected ha
-00010ce0: 7320 6265 636f 6d65 2075 6e61 7661 696c  s become unavail
-00010cf0: 6162 6c65 2c20 6f72 2077 6865 6e20 7468  able, or when th
-00010d00: 650a 636c 6965 6e74 2773 2067 5250 4320  e.client's gRPC 
-00010d10: 6368 616e 6e65 6c20 6861 7070 656e 7320  channel happens 
-00010d20: 746f 2068 6176 6520 6265 656e 2063 6c6f  to have been clo
-00010d30: 7365 642e 2054 6865 2063 6c69 656e 7420  sed. The client 
-00010d40: 7769 6c6c 2061 6c73 6f20 7265 636f 6e6e  will also reconn
-00010d50: 6563 7420 7768 656e 0a61 206d 6574 686f  ect when.a metho
-00010d60: 6420 6973 2063 616c 6c65 6420 7468 6174  d is called that
-00010d70: 2072 6571 7569 7265 7320 6120 6c65 6164   requires a lead
-00010d80: 6572 2c20 616e 6420 7468 6520 636c 6965  er, and the clie
-00010d90: 6e74 2773 206e 6f64 6520 7072 6566 6572  nt's node prefer
-00010da0: 656e 6365 2069 7320 746f 2062 650a 636f  ence is to be.co
-00010db0: 6e6e 6563 7465 6420 746f 2061 206c 6561  nnected to a lea
-00010dc0: 6465 722c 2062 7574 2074 6865 206e 6f64  der, but the nod
-00010dd0: 6520 7468 6174 2074 6865 2063 6c69 656e  e that the clien
-00010de0: 7420 6861 7320 6265 656e 2063 6f6e 6e65  t has been conne
-00010df0: 6374 6564 2074 6f20 7374 6f70 7320 6265  cted to stops be
-00010e00: 696e 670a 7468 6520 6c65 6164 6572 2e20  ing.the leader. 
-00010e10: 496e 2074 6869 7320 6361 7365 2c20 7468  In this case, th
-00010e20: 6520 636c 6965 6e74 2077 696c 6c20 7265  e client will re
-00010e30: 636f 6e6e 6563 7420 746f 2074 6865 2063  connect to the c
-00010e40: 7572 7265 6e74 206c 6561 6465 722e 2041  urrent leader. A
-00010e50: 6674 6572 0a72 6563 6f6e 6e65 6374 696e  fter.reconnectin
-00010e60: 672c 2074 6865 2066 6169 6c65 6420 6f70  g, the failed op
-00010e70: 6572 6174 696f 6e20 7769 6c6c 2062 6520  eration will be 
-00010e80: 7265 7472 6965 642e 0a0a 5468 6520 6040  retried...The `@
-00010e90: 7265 7472 7960 2064 6563 6f72 6174 6f72  retry` decorator
-00010ea0: 2072 6574 7269 6573 206f 7065 7261 7469   retries operati
-00010eb0: 6f6e 7320 7468 6174 2068 6176 6520 6661  ons that have fa
-00010ec0: 696c 6564 2064 7565 2074 6f20 6d6f 7265  iled due to more
-00010ed0: 2067 656e 6572 616c 0a63 6f6e 6e65 6374   general.connect
-00010ee0: 696f 6e20 6973 7375 6573 2c20 7375 6368  ion issues, such
-00010ef0: 2061 7320 6120 6465 6164 6c69 6e65 2062   as a deadline b
-00010f00: 6569 6e67 2072 6561 6368 6564 2028 736f  eing reached (so
-00010f10: 2074 6861 7420 7468 6520 6f70 6572 6174   that the operat
-00010f20: 696f 6e20 7469 6d65 730a 6f75 7429 2c20  ion times.out), 
-00010f30: 6f72 2069 6e20 6361 7365 2074 6865 2073  or in case the s
-00010f40: 6572 7665 7220 7468 726f 7773 2061 6e20  erver throws an 
-00010f50: 6578 6365 7074 696f 6e20 7768 656e 2068  exception when h
-00010f60: 616e 646c 696e 6720 6120 636c 6965 6e74  andling a client
-00010f70: 2072 6571 7565 7374 2e0a 0a50 6c65 6173   request...Pleas
-00010f80: 6520 616c 736f 206e 6f74 652c 2074 6865  e also note, the
-00010f90: 2061 7370 6563 7473 206e 6f74 2063 6f76   aspects not cov
-00010fa0: 6572 6564 2062 7920 7468 6520 7265 636f  ered by the reco
-00010fb0: 6e6e 6563 7420 616e 6420 7265 7472 7920  nnect and retry 
-00010fc0: 6465 636f 7261 746f 720a 6265 6861 7669  decorator.behavi
-00010fd0: 6f75 7273 2068 6176 6520 746f 2064 6f20  ours have to do 
-00010fe0: 7769 7468 206d 6574 686f 6473 2074 6861  with methods tha
-00010ff0: 7420 7265 7475 726e 2069 7465 7261 746f  t return iterato
-00011000: 7273 2e20 466f 7220 6578 616d 706c 652c  rs. For example,
-00011010: 2063 6f6e 7369 6465 720a 7468 6520 6072   consider.the `r
-00011020: 6561 645f 616c 6c5f 6576 656e 7473 2829  ead_all_events()
-00011030: 6020 6d65 7468 6f64 2c20 7768 6963 6820  ` method, which 
-00011040: 7265 7475 726e 7320 616e 2069 7465 7261  returns an itera
-00011050: 746f 7220 6f66 2060 5265 636f 7264 6564  tor of `Recorded
-00011060: 4576 656e 7460 206f 626a 6563 7473 2e0a  Event` objects..
-00011070: 5468 6520 6d65 7468 6f64 2068 6173 2072  The method has r
-00011080: 6574 7572 6e65 6420 616e 6420 7468 6520  eturned and the 
-00011090: 6d65 7468 6f64 2064 6563 6f72 6174 6f72  method decorator
-000110a0: 7320 6861 7665 2074 6865 7265 666f 7265  s have therefore
-000110b0: 2065 7869 7465 6420 6265 666f 7265 2074   exited before t
-000110c0: 6865 0a69 7465 7261 7469 6e67 206f 6620  he.iterating of 
-000110d0: 7468 6520 7265 7370 6f6e 7365 2062 6567  the response beg
-000110e0: 696e 732e 2054 6865 7265 666f 7265 2c20  ins. Therefore, 
-000110f0: 6974 2069 736e 2774 2070 6f73 7369 626c  it isn't possibl
-00011100: 6520 666f 7220 7468 6973 206d 6574 686f  e for this metho
-00011110: 6420 746f 0a74 7269 6767 6572 2061 2072  d to.trigger a r
-00011120: 6563 6f6e 6e65 6374 696f 6e20 6f72 2066  econnection or f
-00011130: 6f72 2069 7420 746f 2072 6574 7279 2c20  or it to retry, 
-00011140: 7768 656e 2074 6865 2073 7472 6561 6d69  when the streami
-00011150: 6e67 2072 6573 706f 6e73 6520 736f 6d65  ng response some
-00011160: 686f 7720 6661 696c 732e 0a0a 416e 6f74  how fails...Anot
-00011170: 6865 7220 6578 616d 706c 6520 6973 2074  her example is t
-00011180: 6865 2022 6361 7463 682d 7570 2220 616e  he "catch-up" an
-00011190: 6420 7065 7273 6973 7465 6e74 2073 7562  d persistent sub
-000111a0: 7363 7269 7074 696f 6e20 7265 6164 206d  scription read m
-000111b0: 6574 686f 6473 2c20 616c 7468 6f75 6768  ethods, although
-000111c0: 0a77 6974 6820 7468 6573 6520 6d65 7468  .with these meth
-000111d0: 6f64 7320 7468 6572 6520 6973 2061 6e20  ods there is an 
-000111e0: 696e 6974 6961 6c20 2263 6f6e 6669 726d  initial "confirm
-000111f0: 6174 696f 6e22 2072 6573 706f 6e73 6520  ation" response 
-00011200: 6672 6f6d 2074 6865 2073 6572 7665 7220  from the server 
-00011210: 7768 6963 680a 6973 2072 6563 6569 7665  which.is receive
-00011220: 6420 616e 6420 6368 6563 6b65 6420 6279  d and checked by
-00011230: 2074 6865 2063 6c69 656e 7420 6265 666f   the client befo
-00011240: 7265 2074 6865 206d 6574 686f 6420 7265  re the method re
-00011250: 7475 726e 732c 2073 6f20 6966 2074 6865  turns, so if the
-00011260: 2073 6572 7665 7220 6973 0a75 6e61 7661   server is.unava
-00011270: 696c 6162 6c65 2077 6865 6e20 7468 6520  ilable when the 
-00011280: 6361 6c6c 2069 7320 6d61 6465 2c20 6f72  call is made, or
-00011290: 2069 6620 7468 6520 6368 616e 6e65 6c20   if the channel 
-000112a0: 6973 2073 6f6d 6568 6f77 2063 6c6f 7365  is somehow close
-000112b0: 642c 206f 7220 6966 2074 6865 0a73 6572  d, or if the.ser
-000112c0: 7665 7220 7468 726f 7773 2061 6e20 6572  ver throws an er
-000112d0: 726f 7220 666f 7220 736f 6d65 2072 6561  ror for some rea
-000112e0: 736f 6e2c 2074 6865 6e20 7468 6520 636c  son, then the cl
-000112f0: 6965 6e74 2077 696c 6c20 6569 7468 6572  ient will either
-00011300: 2072 6563 6f6e 6e65 6374 2061 6e64 0a72   reconnect and.r
-00011310: 6574 7279 2c20 6f72 206d 6f72 6520 7369  etry, or more si
-00011320: 6d70 6c79 206a 7573 7420 7265 7472 7920  mply just retry 
-00011330: 7468 6520 6f70 6572 6174 696f 6e2c 2061  the operation, a
-00011340: 6363 6f72 6469 6e67 2074 6865 2074 7970  ccording the typ
-00011350: 6520 6f66 2065 7272 6f72 2074 6861 740a  e of error that.
-00011360: 7761 7320 656e 636f 756e 7465 7265 642e  was encountered.
-00011370: 2048 6f77 6576 6572 2c20 616e 2065 7665   However, an eve
-00011380: 6e74 2d70 726f 6365 7373 696e 6720 636f  nt-processing co
-00011390: 6d70 6f6e 656e 7420 7468 6174 2069 7465  mponent that ite
-000113a0: 7261 7465 7320 6f76 6572 2061 0a73 7563  rates over a.suc
-000113b0: 6365 7373 6675 6c6c 7920 7265 7475 726e  cessfully return
-000113c0: 6564 2022 6361 7463 682d 7570 2220 7375  ed "catch-up" su
-000113d0: 6273 6372 6970 7469 6f6e 2072 6573 706f  bscription respo
-000113e0: 6e73 6520 7769 6c6c 206e 6565 6420 746f  nse will need to
-000113f0: 2062 6520 6d6f 6e69 746f 7265 6420 666f   be monitored fo
-00011400: 720a 6572 726f 7273 2c20 616e 642c 2069  r.errors, and, i
-00011410: 6620 6974 2066 6169 6c73 2061 6674 6572  f it fails after
-00011420: 2069 7420 6861 7320 7374 6172 7465 6420   it has started 
-00011430: 6974 6572 6174 696e 6720 6f76 6572 2074  iterating over t
-00011440: 6865 2072 6573 706f 6e73 652c 2074 6865  he response, the
-00011450: 2063 6174 6368 2d75 700a 7375 6273 6372   catch-up.subscr
-00011460: 6970 7469 6f6e 2077 696c 6c20 6e65 6564  iption will need
-00011470: 2074 6f20 6265 2072 6573 7461 7274 6564   to be restarted
-00011480: 2066 726f 6d20 7468 6520 6576 656e 742d   from the event-
-00011490: 7072 6f63 6573 7369 6e67 2063 6f6d 706f  processing compo
-000114a0: 6e65 6e74 2773 2022 6c61 7374 0a73 6176  nent's "last.sav
-000114b0: 6564 2063 6f6d 6d69 7420 706f 7369 7469  ed commit positi
-000114c0: 6f6e 222e 2049 6620 7468 6520 6576 656e  on". If the even
-000114d0: 742d 7072 6f63 6573 7369 6e67 2063 6f6d  t-processing com
-000114e0: 706f 6e65 6e74 2069 7320 7265 636f 7264  ponent is record
-000114f0: 696e 6720 7468 6520 636f 6d6d 6974 0a70  ing the commit.p
-00011500: 6f73 6974 696f 6e20 6f66 2065 6163 6820  osition of each 
-00011510: 7265 636f 7264 6564 2065 7665 6e74 2061  recorded event a
-00011520: 746f 6d69 6361 6c6c 7920 616c 6f6e 6720  tomically along 
-00011530: 7769 7468 2061 6e79 206e 6577 2073 7461  with any new sta
-00011540: 7465 2074 6861 7420 7265 7375 6c74 7320  te that results 
-00011550: 6672 6f6d 0a70 726f 6365 7373 696e 6720  from.processing 
-00011560: 7468 6520 7265 636f 7264 6564 2065 7665  the recorded eve
-00011570: 6e74 732c 2061 6e64 2074 6865 2063 6f6d  nts, and the com
-00011580: 6d69 7420 706f 7369 7469 6f6e 7320 6172  mit positions ar
-00011590: 6520 7265 636f 7264 6564 2077 6974 6820  e recorded with 
-000115a0: 6120 756e 6971 7565 6e65 7373 0a63 6f6e  a uniqueness.con
-000115b0: 7374 7261 696e 742c 2074 6865 6e20 7468  straint, then th
-000115c0: 6572 6520 7769 6c6c 206e 6f20 6461 6e67  ere will no dang
-000115d0: 6572 2074 6f20 7468 6520 7072 6f6a 6563  er to the projec
-000115e0: 7465 6420 7374 6174 6520 6265 636f 6d69  ted state becomi
-000115f0: 6e67 2069 6e63 6f6e 7369 7374 656e 7420  ng inconsistent 
-00011600: 6475 650a 746f 2074 6865 7365 2063 6f6e  due.to these con
-00011610: 6e65 6374 696f 6e20 6973 7375 6573 2e20  nection issues. 
-00011620: 496e 2074 6869 7320 6361 7365 2c20 7468  In this case, th
-00011630: 6520 636c 6965 6e74 2077 696c 6c20 6175  e client will au
-00011640: 746f 6d61 7469 6361 6c6c 7920 7265 636f  tomatically reco
-00011650: 6e6e 6563 7420 746f 2061 0a6e 6f64 6520  nnect to a.node 
-00011660: 696e 2074 6865 2063 6c75 7374 6572 2077  in the cluster w
-00011670: 6865 6e20 7468 6520 7375 6273 6571 7565  hen the subseque
-00011680: 6e74 2063 616c 6c20 746f 2061 2063 6174  nt call to a cat
-00011690: 6368 2d75 7020 7375 6273 6372 6970 7469  ch-up subscripti
-000116a0: 6f6e 206d 6574 686f 6420 6973 206d 6164  on method is mad
-000116b0: 652e 0a59 6f75 206a 7573 7420 6e65 6564  e..You just need
-000116c0: 2074 6f20 6861 6e64 6c65 2074 6865 2065   to handle the e
-000116d0: 7863 6570 7469 6f6e 2074 6861 7420 6f63  xception that oc
-000116e0: 6375 7273 2066 726f 6d20 7468 6520 6974  curs from the it
-000116f0: 6572 6174 6f72 2c20 7468 656e 2072 6561  erator, then rea
-00011700: 6420 796f 7572 206c 6173 740a 7361 7665  d your last.save
-00011710: 6420 636f 6d6d 6974 2070 6f73 6974 696f  d commit positio
-00011720: 6e2c 2061 6e64 2074 6865 6e20 7265 7374  n, and then rest
-00011730: 6172 7420 796f 7572 2065 7665 6e74 2d70  art your event-p
-00011740: 726f 6365 7373 696e 6720 636f 6d70 6f6e  rocessing compon
-00011750: 656e 742c 2075 7369 6e67 2074 6865 2073  ent, using the s
-00011760: 616d 650a 636c 6965 6e74 206f 626a 6563  ame.client objec
-00011770: 742e 2054 6865 2063 6c69 656e 7420 7769  t. The client wi
-00011780: 6c6c 2072 6563 6f6e 6e65 6374 2069 6620  ll reconnect if 
-00011790: 7468 6572 6520 6973 2061 206e 6565 6420  there is a need 
-000117a0: 746f 2064 6f20 736f 2077 6865 6e20 7468  to do so when th
-000117b0: 6520 7375 6273 6571 7565 6e74 0a63 616c  e subsequent.cal
-000117c0: 6c20 6973 206d 6164 652e 2053 696d 696c  l is made. Simil
-000117d0: 6172 6c79 2c20 7768 656e 2072 6561 6469  arly, when readi
-000117e0: 6e67 2070 6572 7369 7374 656e 7420 7375  ng persistent su
-000117f0: 6273 6372 6970 7469 6f6e 732c 2069 6620  bscriptions, if 
-00011800: 7468 6572 6520 6172 650a 636f 6e6e 6563  there are.connec
-00011810: 7469 7669 7479 2069 7373 7565 7320 6166  tivity issues af
-00011820: 7465 7220 796f 7520 6861 7665 2073 7461  ter you have sta
-00011830: 7274 6564 2069 7465 7261 7469 6e67 206f  rted iterating o
-00011840: 7665 7220 6120 7375 6363 6573 7366 756c  ver a successful
-00011850: 6c79 2072 6563 6569 7665 640a 7265 7370  ly received.resp
-00011860: 6f6e 7365 2c20 7468 656e 2074 6865 2073  onse, then the s
-00011870: 6572 7665 7220 6361 6c6c 2077 696c 6c20  erver call will 
-00011880: 6e65 6564 2074 6f20 6265 2072 6573 7461  need to be resta
-00011890: 7274 6564 2e20 496e 2074 6869 7320 6361  rted. In this ca
-000118a0: 7365 2c20 7468 6520 7265 6365 6976 6564  se, the received
-000118b0: 0a65 7665 6e74 7320 7769 6c6c 2073 7461  .events will sta
-000118c0: 7274 2077 6974 6820 7468 6520 6c61 7374  rt with the last
-000118d0: 2073 6176 6564 2063 6865 636b 706f 696e   saved checkpoin
-000118e0: 7420 6f6e 2074 6865 2073 6572 7665 7220  t on the server 
-000118f0: 2870 6f74 656e 7469 616c 6c79 2072 6574  (potentially ret
-00011900: 7572 6e69 6e67 0a65 7665 6e74 7320 7468  urning.events th
-00011910: 6174 2077 6572 6520 696e 2066 6163 7420  at were in fact 
-00011920: 7375 6363 6573 7366 756c 6c79 2070 726f  successfully pro
-00011930: 6365 7373 6564 292e 0a0a 0a23 2323 2043  cessed)....### C
-00011940: 6c6f 7365 0a0a 5468 6520 6063 6c6f 7365  lose..The `close
-00011950: 2829 6020 6d65 7468 6f64 2063 616e 2062  ()` method can b
-00011960: 6520 7573 6564 2074 6f20 636c 6561 6e6c  e used to cleanl
-00011970: 7920 636c 6f73 6520 7468 6520 6752 5043  y close the gRPC
-00011980: 2063 6f6e 6e65 6374 696f 6e2e 0a0a 6060   connection...``
-00011990: 6070 7974 686f 6e0a 636c 6965 6e74 2e63  `python.client.c
-000119a0: 6c6f 7365 2829 0a60 6060 0a0a 2323 204e  lose().```..## N
-000119b0: 6f74 6573 0a0a 2323 2320 436f 6e6e 6563  otes..### Connec
-000119c0: 7469 6f6e 2073 7472 696e 6773 0a0a 5468  tion strings..Th
-000119d0: 6520 4576 656e 7453 746f 7265 4442 2063  e EventStoreDB c
-000119e0: 6f6e 6e65 6374 696f 6e20 7374 7269 6e67  onnection string
-000119f0: 2069 7320 6120 5552 4920 7468 6174 2063   is a URI that c
-00011a00: 6f6e 666f 726d 7320 7769 7468 206f 6e65  onforms with one
-00011a10: 206f 6620 7477 6f20 706f 7373 6962 6c65   of two possible
-00011a20: 0a73 6368 656d 6573 2c20 6569 7468 6572  .schemes, either
-00011a30: 2074 6865 2022 6573 6462 2220 7363 6865   the "esdb" sche
-00011a40: 6d65 206f 7220 7468 6520 2265 7364 622b  me or the "esdb+
-00011a50: 6469 7363 6f76 6572 2220 7363 6865 6d65  discover" scheme
-00011a60: 2e20 5468 6520 7379 6e74 6178 2061 6e64  . The syntax and
-00011a70: 0a73 656d 616e 7469 6373 206f 6620 7468  .semantics of th
-00011a80: 6520 4576 656e 7453 746f 7265 4442 2055  e EventStoreDB U
-00011a90: 5249 2073 6368 656d 6573 2061 7265 2065  RI schemes are e
-00011aa0: 7870 6c61 696e 6564 2062 656c 6f77 2e20  xplained below. 
-00011ab0: 5468 6520 7379 6e74 6178 2069 730a 6465  The syntax is.de
-00011ac0: 6669 6e65 6420 7573 696e 6720 5b45 424e  fined using [EBN
-00011ad0: 465d 2868 7474 7073 3a2f 2f65 6e2e 7769  F](https://en.wi
-00011ae0: 6b69 7065 6469 612e 6f72 672f 7769 6b69  kipedia.org/wiki
-00011af0: 2f45 7874 656e 6465 645f 4261 636b 7573  /Extended_Backus
-00011b00: e280 934e 6175 725f 666f 726d 292e 0a0a  ...Naur_form)...
-00011b10: 5468 6520 2265 7364 6222 2055 5249 2073  The "esdb" URI s
-00011b20: 6368 656d 6520 6361 6e20 6265 2064 6566  cheme can be def
-00011b30: 696e 6564 2069 6e20 7468 6520 666f 6c6c  ined in the foll
-00011b40: 6f77 696e 6720 7761 792e 0a0a 2020 2020  owing way...    
-00011b50: 6573 6462 2d75 7269 203d 2022 6573 6462  esdb-uri = "esdb
-00011b60: 3a2f 2f22 202c 205b 2075 7365 722d 696e  ://" , [ user-in
-00011b70: 666f 202c 2022 4022 205d 202c 2067 7270  fo , "@" ] , grp
-00011b80: 632d 7461 7267 6574 2c20 7b20 222c 2220  c-target, { "," 
-00011b90: 2c20 6772 7063 2d74 6172 6765 7420 7d20  , grpc-target } 
-00011ba0: 2c20 5b20 223f 2220 2c20 7175 6572 792d  , [ "?" , query-
-00011bb0: 7374 7269 6e67 205d 203b 0a0a 496e 2074  string ] ;..In t
-00011bc0: 6865 2022 6573 6462 2220 5552 4920 7363  he "esdb" URI sc
-00011bd0: 6865 6d65 2c20 6166 7465 7220 7468 6520  heme, after the 
-00011be0: 6f70 7469 6f6e 616c 2075 7365 7220 696e  optional user in
-00011bf0: 666f 2073 7472 696e 672c 2074 6865 7265  fo string, there
-00011c00: 206d 7573 7420 6265 2061 7420 6c65 6173   must be at leas
-00011c10: 740a 6f6e 6520 6752 5043 2074 6172 6765  t.one gRPC targe
-00011c20: 742e 2049 6620 7468 6572 6520 6172 6520  t. If there are 
-00011c30: 7365 7665 7261 6c20 6752 5043 2074 6172  several gRPC tar
-00011c40: 6765 7473 2c20 7468 6579 206d 7573 7420  gets, they must 
-00011c50: 6265 2073 6570 6172 6174 6564 2066 726f  be separated fro
-00011c60: 6d20 6561 6368 0a6f 7468 6572 2077 6974  m each.other wit
-00011c70: 6820 7468 6520 222c 2220 6368 6172 6163  h the "," charac
-00011c80: 7465 722e 2045 6163 6820 6752 5043 2074  ter. Each gRPC t
-00011c90: 6172 6765 7420 7368 6f75 6c64 2069 6e64  arget should ind
-00011ca0: 6963 6174 6520 616e 2045 7665 6e74 5374  icate an EventSt
-00011cb0: 6f72 6544 4220 6752 5043 0a73 6572 7665  oreDB gRPC.serve
-00011cc0: 7220 736f 636b 6574 2c20 6279 2073 7065  r socket, by spe
-00011cd0: 6369 6679 696e 6720 6120 686f 7374 2061  cifying a host a
-00011ce0: 6e64 2061 2070 6f72 7420 6e75 6d62 6572  nd a port number
-00011cf0: 2073 6570 6172 6174 6564 2077 6974 6820   separated with 
-00011d00: 7468 6520 223a 2220 6368 6172 6163 7465  the ":" characte
-00011d10: 722e 0a54 6865 2068 6f73 7420 6d61 7920  r..The host may 
-00011d20: 6265 2061 2068 6f73 746e 616d 6520 7468  be a hostname th
-00011d30: 6174 2063 616e 2062 6520 7265 736f 6c76  at can be resolv
-00011d40: 6564 2074 6f20 616e 2049 5020 6164 6472  ed to an IP addr
-00011d50: 6573 732c 206f 7220 616e 2049 5020 6164  ess, or an IP ad
-00011d60: 6472 6573 732e 0a0a 2020 2020 6772 7063  dress...    grpc
-00011d70: 2d74 6172 6765 7420 3d20 2820 686f 7374  -target = ( host
-00011d80: 6e61 6d65 207c 2069 702d 6164 6472 6573  name | ip-addres
-00011d90: 7320 2920 2c20 223a 2220 2c20 706f 7274  s ) , ":" , port
-00011da0: 2d6e 756d 6265 7220 3b0a 0a0a 5468 6520  -number ;...The 
-00011db0: 2265 7364 622b 6469 7363 6f76 6572 2220  "esdb+discover" 
-00011dc0: 5552 4920 7363 6865 6d65 2063 616e 2062  URI scheme can b
-00011dd0: 6520 6465 6669 6e65 6420 696e 2074 6865  e defined in the
-00011de0: 2066 6f6c 6c6f 7769 6e67 2077 6179 2e0a   following way..
-00011df0: 0a20 2020 2065 7364 622d 6469 7363 6f76  .    esdb-discov
-00011e00: 6572 2d75 7269 203d 2022 6573 6462 2b64  er-uri = "esdb+d
-00011e10: 6973 636f 7665 723a 2f2f 2220 2c20 5b20  iscover://" , [ 
-00011e20: 7573 6572 2d69 6e66 6f2c 2022 4022 205d  user-info, "@" ]
-00011e30: 202c 2063 6c75 7374 6572 2d64 6f6d 6169   , cluster-domai
-00011e40: 6e6e 616d 6520 2c20 5b20 223f 2220 2c20  nname , [ "?" , 
-00011e50: 7175 6572 792d 7374 7269 6e67 205d 203b  query-string ] ;
-00011e60: 0a0a 496e 2074 6865 2022 6573 6462 2b64  ..In the "esdb+d
-00011e70: 6973 636f 7665 7222 2055 5249 2073 6368  iscover" URI sch
-00011e80: 656d 652c 2061 6674 6572 2074 6865 2075  eme, after the u
-00011e90: 7365 7220 696e 666f 2073 7472 696e 672c  ser info string,
-00011ea0: 2074 6865 7265 206d 7573 7420 6265 2061   there must be a
-00011eb0: 2064 6f6d 6169 6e0a 6e61 6d65 2077 6869   domain.name whi
-00011ec0: 6368 2073 686f 756c 6420 6964 656e 7469  ch should identi
-00011ed0: 6679 2061 2063 6c75 7374 6572 206f 6620  fy a cluster of 
-00011ee0: 4576 656e 7453 746f 7265 4442 2073 6572  EventStoreDB ser
-00011ef0: 7665 7273 2e20 5468 6520 636c 6965 6e74  vers. The client
-00011f00: 2077 696c 6c20 7573 6520 6120 444e 530a   will use a DNS.
-00011f10: 7365 7276 6572 2074 6f20 7265 736f 6c76  server to resolv
-00011f20: 6520 7468 6520 646f 6d61 696e 206e 616d  e the domain nam
-00011f30: 6520 746f 2061 206c 6973 7420 6f66 2061  e to a list of a
-00011f40: 6464 7265 7373 6573 206f 6620 4576 656e  ddresses of Even
-00011f50: 7453 746f 7265 4442 2073 6572 7665 7273  tStoreDB servers
-00011f60: 2c0a 6279 2071 7565 7279 696e 6720 666f  ,.by querying fo
-00011f70: 7220 2741 2720 7265 636f 7264 732e 2049  r 'A' records. I
-00011f80: 6e20 7468 6973 2063 6173 652c 2074 6865  n this case, the
-00011f90: 2070 6f72 7420 6e75 6d62 6572 2022 3231   port number "21
-00011fa0: 3133 2220 7769 6c6c 2062 6520 7573 6564  13" will be used
-00011fb0: 2074 6f0a 636f 6e73 7472 7563 7420 6752   to.construct gR
-00011fc0: 5043 2074 6172 6765 7473 2066 726f 6d20  PC targets from 
-00011fd0: 7468 6520 6164 6472 6573 7365 7320 6f62  the addresses ob
-00011fe0: 7461 696e 6564 2066 726f 6d20 2741 2720  tained from 'A' 
-00011ff0: 7265 636f 7264 7320 7072 6f76 6964 6564  records provided
-00012000: 2062 7920 7468 650a 444e 5320 7365 7276   by the.DNS serv
-00012010: 6572 2e20 5468 6572 6566 6f72 652c 2069  er. Therefore, i
-00012020: 6620 796f 7520 7761 6e74 2074 6f20 7573  f you want to us
-00012030: 6520 7468 6520 2265 7364 622b 6469 7363  e the "esdb+disc
-00012040: 6f76 6572 2220 5552 4920 7363 6865 6d65  over" URI scheme
-00012050: 2c20 796f 7520 7769 6c6c 0a6e 6565 6420  , you will.need 
-00012060: 746f 2063 6f6e 6669 6775 7265 2044 4e53  to configure DNS
-00012070: 2077 6865 6e20 7365 7474 696e 6720 7570   when setting up
-00012080: 2079 6f75 7220 4576 656e 7453 746f 7265   your EventStore
-00012090: 4442 2063 6c75 7374 6572 2e0a 0a57 6974  DB cluster...Wit
-000120a0: 6820 626f 7468 2074 6865 2022 6573 6462  h both the "esdb
-000120b0: 2220 616e 6420 2265 7364 622b 6469 736f  " and "esdb+diso
-000120c0: 6376 6572 2220 5552 4920 7363 6865 6d65  cver" URI scheme
-000120d0: 732c 2074 6865 2063 6c69 656e 7420 6669  s, the client fi
-000120e0: 7273 746c 7920 6f62 7461 696e 730a 6120  rstly obtains.a 
-000120f0: 6c69 7374 206f 6620 6752 5043 2074 6172  list of gRPC tar
-00012100: 6765 7473 3a20 6569 7468 6572 2064 6972  gets: either dir
-00012110: 6563 746c 7920 6672 6f6d 2022 6573 6462  ectly from "esdb
-00012120: 2220 636f 6e6e 6563 7469 6f6e 2073 7472  " connection str
-00012130: 696e 6773 3b20 6f72 2069 6e64 6972 6563  ings; or indirec
-00012140: 746c 790a 6672 6f6d 2022 6573 6462 2b64  tly.from "esdb+d
-00012150: 6973 636f 7665 7222 2063 6f6e 6e65 6374  iscover" connect
-00012160: 696f 6e20 7374 7269 6e67 7320 7669 6120  ion strings via 
-00012170: 444e 532e 2054 6869 7320 6c69 7374 206f  DNS. This list o
-00012180: 6620 7461 7267 6574 7320 6973 206b 6e6f  f targets is kno
-00012190: 776e 2061 7320 7468 650a 2267 6f73 7369  wn as the."gossi
-000121a0: 7020 7365 6564 222e 2054 6865 2063 6c69  p seed". The cli
-000121b0: 656e 7420 7769 6c6c 2074 6865 6e20 6174  ent will then at
-000121c0: 7465 6d70 7420 746f 2063 6f6e 6e65 6374  tempt to connect
-000121d0: 2074 6f20 6561 6368 2067 5250 4320 7461   to each gRPC ta
-000121e0: 7267 6574 2069 6e20 7475 726e 2c0a 6174  rget in turn,.at
-000121f0: 7465 6d70 7469 6e67 2074 6f20 6361 6c6c  tempting to call
-00012200: 2074 6865 2045 7665 6e74 5374 6f72 6544   the EventStoreD
-00012210: 4220 476f 7373 6970 2041 5049 2074 6f20  B Gossip API to 
-00012220: 6f62 7461 696e 2069 6e66 6f72 6d61 7469  obtain informati
-00012230: 6f6e 2061 626f 7574 2074 6865 0a45 7665  on about the.Eve
-00012240: 6e74 5374 6f72 6544 4220 636c 7573 7465  ntStoreDB cluste
-00012250: 722e 2041 206d 656d 6265 7220 6f66 2074  r. A member of t
-00012260: 6865 2063 6c75 7374 6572 2069 7320 7365  he cluster is se
-00012270: 6c65 6374 6564 2062 7920 7468 6520 636c  lected by the cl
-00012280: 6965 6e74 2c20 6163 636f 7264 696e 670a  ient, according.
-00012290: 746f 2074 6865 2022 6e6f 6465 2070 7265  to the "node pre
-000122a0: 6665 7265 6e63 6522 206f 7074 696f 6e20  ference" option 
-000122b0: 2873 6565 2062 656c 6f77 292e 2054 6865  (see below). The
-000122c0: 2063 6c69 656e 7420 6d61 7920 7468 656e   client may then
-000122d0: 206e 6565 6420 746f 2063 6c6f 7365 2069   need to close i
-000122e0: 7473 0a63 6f6e 6e65 6374 696f 6e20 616e  ts.connection an
-000122f0: 6420 7265 636f 6e6e 6563 7420 746f 2074  d reconnect to t
-00012300: 6865 2073 656c 6563 7465 6420 7365 7276  he selected serv
-00012310: 6572 2e0a 0a49 6e20 626f 7468 2074 6865  er...In both the
-00012320: 2022 6573 6462 2220 616e 6420 2265 7364   "esdb" and "esd
-00012330: 622b 6469 7363 6f76 6572 2220 7363 6865  b+discover" sche
-00012340: 6d65 732c 2074 6865 2055 5249 206d 6179  mes, the URI may
-00012350: 2069 6e63 6c75 6465 2061 2075 7365 7220   include a user 
-00012360: 696e 666f 2073 7472 696e 672e 0a49 6620  info string..If 
-00012370: 6974 2065 7869 7374 7320 696e 2074 6865  it exists in the
-00012380: 2055 5249 2c20 7468 6520 7573 6572 2069   URI, the user i
-00012390: 6e66 6f20 7374 7269 6e67 206d 7573 7420  nfo string must 
-000123a0: 6265 2073 6570 6172 6174 6564 2066 726f  be separated fro
-000123b0: 6d20 7468 6520 7265 7374 206f 6620 7468  m the rest of th
-000123c0: 6520 5552 490a 7769 7468 2074 6865 2022  e URI.with the "
-000123d0: 4022 2063 6861 7261 6374 6572 2e20 5468  @" character. Th
-000123e0: 6520 7573 6572 2069 6e66 6f20 7374 7269  e user info stri
-000123f0: 6e67 206d 7573 7420 696e 636c 7564 6520  ng must include 
-00012400: 6120 7573 6572 6e61 6d65 2061 6e64 2061  a username and a
-00012410: 2070 6173 7377 6f72 642c 0a73 6570 6172   password,.separ
-00012420: 6174 6564 2077 6974 6820 7468 6520 223a  ated with the ":
-00012430: 2220 6368 6172 6163 7465 722e 0a0a 2020  " character...  
-00012440: 2020 7573 6572 2d69 6e66 6f20 3d20 7573    user-info = us
-00012450: 6572 6e61 6d65 202c 2022 3a22 202c 2070  ername , ":" , p
-00012460: 6173 7377 6f72 6420 3b0a 0a54 6865 2075  assword ;..The u
-00012470: 7365 7220 696e 666f 2069 7320 7365 6e74  ser info is sent
-00012480: 2062 7920 7468 6520 636c 6965 6e74 2061   by the client a
-00012490: 7320 2263 616c 6c20 6372 6564 656e 7469  s "call credenti
-000124a0: 616c 7322 2069 6e20 6561 6368 2063 616c  als" in each cal
-000124b0: 6c20 746f 2061 2022 7365 6375 7265 220a  l to a "secure".
-000124c0: 7365 7276 6572 2c20 696e 2061 2022 6261  server, in a "ba
-000124d0: 7369 6320 6175 7468 2220 6175 7468 6f72  sic auth" author
-000124e0: 697a 6174 696f 6e20 6865 6164 6572 2e20  ization header. 
-000124f0: 5468 6973 2061 7574 686f 7269 7a61 7469  This authorizati
-00012500: 6f6e 2068 6561 6465 7220 6973 2075 7365  on header is use
-00012510: 6420 6279 0a74 6865 2073 6572 7665 7220  d by.the server 
-00012520: 746f 2061 7574 6865 6e74 6963 6174 6520  to authenticate 
-00012530: 7468 6520 636c 6965 6e74 2e20 5468 6520  the client. The 
-00012540: 6175 7468 6f72 697a 6174 696f 6e20 6865  authorization he
-00012550: 6164 6572 2069 7320 6e6f 7420 7365 6e74  ader is not sent
-00012560: 2074 6f0a 2269 6e73 6563 7572 6522 2073   to."insecure" s
-00012570: 6572 7665 7273 2e0a 0a49 6e20 626f 7468  ervers...In both
-00012580: 2074 6865 2022 6573 6462 2220 616e 6420   the "esdb" and 
-00012590: 2265 7364 622b 6469 7363 6f76 6572 2220  "esdb+discover" 
-000125a0: 7363 6865 6d65 732c 2074 6865 206f 7074  schemes, the opt
-000125b0: 696f 6e61 6c20 7175 6572 7920 7374 7269  ional query stri
-000125c0: 6e67 206d 7573 7420 6265 206f 6e65 0a6f  ng must be one.o
-000125d0: 7220 6d61 6e79 2066 6965 6c64 2d76 616c  r many field-val
-000125e0: 7565 2061 7267 756d 656e 7473 2c20 7365  ue arguments, se
-000125f0: 7061 7261 7465 6420 6672 6f6d 2065 6163  parated from eac
-00012600: 6820 6f74 6865 7220 7769 7468 2074 6865  h other with the
-00012610: 2022 2622 2063 6861 7261 6374 6572 2e0a   "&" character..
-00012620: 0a20 2020 2071 7565 7279 2d73 7472 696e  .    query-strin
-00012630: 6720 3d20 6669 656c 642d 7661 6c75 652c  g = field-value,
-00012640: 207b 2022 2622 2c20 6669 656c 642d 7661   { "&", field-va
-00012650: 6c75 6520 7d20 3b0a 0a45 6163 6820 6669  lue } ;..Each fi
-00012660: 656c 642d 7661 6c75 6520 6172 6775 6d65  eld-value argume
-00012670: 6e74 206d 7573 7420 6265 206f 6e65 206f  nt must be one o
-00012680: 6620 7468 6520 7375 7070 6f72 7465 6420  f the supported 
-00012690: 6669 656c 6473 2c20 616e 6420 616e 0a61  fields, and an.a
-000126a0: 7070 726f 7072 6961 7465 2076 616c 7565  ppropriate value
-000126b0: 2c20 7365 7061 7261 7465 6420 7769 7468  , separated with
-000126c0: 2074 6865 2022 3d22 2063 6861 7261 6374   the "=" charact
-000126d0: 6572 2e0a 0a20 2020 2066 6965 6c64 2d76  er...    field-v
-000126e0: 616c 7565 203d 2028 2022 546c 7322 2c20  alue = ( "Tls", 
-000126f0: 223d 2220 2c20 2274 7275 6522 207c 2022  "=" , "true" | "
-00012700: 6661 6c73 6522 2029 0a20 2020 2020 2020  false" ).       
-00012710: 2020 2020 2020 2020 207c 2028 2022 546c           | ( "Tl
-00012720: 7356 6572 6966 7943 6572 7422 2c20 223d  sVerifyCert", "=
-00012730: 2220 2c20 2274 7275 6522 207c 2022 6661  " , "true" | "fa
-00012740: 6c73 6522 2029 0a20 2020 2020 2020 2020  lse" ).         
-00012750: 2020 2020 2020 207c 2028 2022 436f 6e6e         | ( "Conn
-00012760: 6563 7469 6f6e 4e61 6d65 222c 2022 3d22  ectionName", "="
-00012770: 202c 2073 7472 696e 6720 290a 2020 2020   , string ).    
-00012780: 2020 2020 2020 2020 2020 2020 7c20 2820              | ( 
-00012790: 224e 6f64 6550 7265 6665 7265 6e63 6522  "NodePreference"
-000127a0: 2c20 223d 2220 2c20 226c 6561 6465 7222  , "=" , "leader"
-000127b0: 207c 2022 666f 6c6c 6f77 6572 2220 7c20   | "follower" | 
-000127c0: 2272 6561 646f 6e6c 7972 6570 6c69 6361  "readonlyreplica
-000127d0: 2220 7c20 2272 616e 646f 6d22 2029 0a20  " | "random" ). 
-000127e0: 2020 2020 2020 2020 2020 2020 2020 207c                 |
-000127f0: 2028 2022 4465 6661 756c 7444 6561 646c   ( "DefaultDeadl
-00012800: 696e 6522 2c20 223d 2220 2c20 696e 7465  ine", "=" , inte
-00012810: 6765 7220 290a 2020 2020 2020 2020 2020  ger ).          
-00012820: 2020 2020 2020 7c20 2820 2247 6f73 7369        | ( "Gossi
-00012830: 7054 696d 656f 7574 222c 2022 3d22 202c  pTimeout", "=" ,
-00012840: 2069 6e74 6567 6572 2029 0a20 2020 2020   integer ).     
-00012850: 2020 2020 2020 2020 2020 207c 2028 2022             | ( "
-00012860: 4d61 7844 6973 636f 7665 7241 7474 656d  MaxDiscoverAttem
-00012870: 7074 7322 2c20 223d 2220 2c20 696e 7465  pts", "=" , inte
-00012880: 6765 7220 290a 2020 2020 2020 2020 2020  ger ).          
-00012890: 2020 2020 2020 7c20 2820 2244 6973 636f        | ( "Disco
-000128a0: 7665 7279 496e 7465 7276 616c 222c 2022  veryInterval", "
-000128b0: 3d22 202c 2069 6e74 6567 6572 2029 0a20  =" , integer ). 
-000128c0: 2020 2020 2020 2020 2020 2020 2020 207c                 |
-000128d0: 2028 2022 4d61 7844 6973 636f 7665 7241   ( "MaxDiscoverA
-000128e0: 7474 656d 7074 7322 2c20 223d 2220 2c20  ttempts", "=" , 
-000128f0: 696e 7465 6765 7220 290a 2020 2020 2020  integer ).      
-00012900: 2020 2020 2020 2020 2020 7c20 2820 224b            | ( "K
-00012910: 6565 7041 6c69 7665 496e 7465 7276 616c  eepAliveInterval
-00012920: 222c 2022 3d22 202c 2069 6e74 6567 6572  ", "=" , integer
-00012930: 2029 0a20 2020 2020 2020 2020 2020 2020   ).             
-00012940: 2020 207c 2028 2022 4b65 6570 416c 6976     | ( "KeepAliv
-00012950: 6549 6e74 6572 7661 6c22 2c20 223d 2220  eInterval", "=" 
-00012960: 2c20 696e 7465 6765 7220 2920 3b0a 0a54  , integer ) ;..T
-00012970: 6865 2074 6162 6c65 2062 656c 6f77 2064  he table below d
-00012980: 6573 6372 6962 6573 2074 6865 2071 7565  escribes the que
-00012990: 7279 2066 6965 6c64 2d76 616c 7565 7320  ry field-values 
-000129a0: 7375 7070 6f72 7465 6420 6279 2074 6869  supported by thi
-000129b0: 7320 636c 6965 6e74 2e0a 0a7c 2046 6965  s client...| Fie
-000129c0: 6c64 2020 2020 2020 2020 2020 2020 2020  ld              
-000129d0: 207c 2056 616c 7565 2020 2020 2020 2020   | Value        
-000129e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000129f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012a10: 2020 2020 2020 2020 207c 2044 6573 6372           | Descr
-00012a20: 6970 7469 6f6e 2020 2020 2020 2020 2020  iption          
-00012a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012ab0: 2020 2020 2020 2020 2020 2020 207c 0a7c               |.|
-00012ac0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00012ad0: 2d2d 2d2d 2d7c 2d2d 2d2d 2d2d 2d2d 2d2d  -----|----------
-00012ae0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00012af0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00012b00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00012b10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d7c 2d2d  -------------|--
-00012b20: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00012b30: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00012b40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00012b50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00012b60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00012b70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00012b80: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00012b90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00012ba0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00012bb0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00012bc0: 2d7c 0a7c 2054 6c73 2020 2020 2020 2020  -|.| Tls        
-00012bd0: 2020 2020 2020 2020 207c 2022 7472 7565           | "true
-00012be0: 222c 2022 6661 6c73 6522 2028 6465 6661  ", "false" (defa
-00012bf0: 756c 743a 2022 7472 7565 2229 2020 2020  ult: "true")    
-00012c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012c20: 207c 2049 6620 2274 7275 6522 2074 6865   | If "true" the
-00012c30: 2063 6c69 656e 7420 7769 6c6c 2063 7265   client will cre
-00012c40: 6174 6520 6120 2273 6563 7572 6522 2067  ate a "secure" g
-00012c50: 5250 4320 6368 616e 6e65 6c2e 2049 6620  RPC channel. If 
-00012c60: 2266 616c 7365 2220 7468 6520 636c 6965  "false" the clie
-00012c70: 6e74 2077 696c 6c20 6372 6561 7465 2061  nt will create a
-00012c80: 6e20 2269 6e73 6563 7572 6522 2067 5250  n "insecure" gRP
-00012c90: 4320 6368 616e 6e65 6c2e 2054 6869 7320  C channel. This 
-00012ca0: 6d75 7374 206d 6174 6368 2074 6865 2073  must match the s
-00012cb0: 6572 7665 7220 636f 6e66 6967 7572 6174  erver configurat
-00012cc0: 696f 6e2e 207c 0a7c 2054 6c73 5665 7269  ion. |.| TlsVeri
-00012cd0: 6679 4365 7274 2020 2020 2020 207c 2022  fyCert       | "
-00012ce0: 7472 7565 222c 2022 6661 6c73 6522 2028  true", "false" (
-00012cf0: 6465 6661 756c 743a 2022 7472 7565 2229  default: "true")
-00012d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012d20: 2020 2020 207c 2054 6869 7320 7661 6c75       | This valu
-00012d30: 6520 6973 2063 7572 7265 6e74 6c79 2069  e is currently i
-00012d40: 676e 6f72 6564 2e20 2020 2020 2020 2020  gnored.         
-00012d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012dc0: 2020 2020 2020 2020 207c 0a7c 2043 6f6e           |.| Con
-00012dd0: 6e65 6374 696f 6e4e 616d 6520 2020 2020  nectionName     
-00012de0: 207c 2073 7472 696e 6720 2864 6566 6175   | string (defau
-00012df0: 6c74 3a20 6175 746f 2d67 656e 6572 6174  lt: auto-generat
-00012e00: 6564 2076 6572 7369 6f6e 2d34 2055 5549  ed version-4 UUI
-00012e10: 4429 2020 2020 2020 2020 2020 2020 2020  D)              
-00012e20: 2020 2020 2020 2020 207c 2053 656e 7420           | Sent 
-00012e30: 696e 2063 616c 6c20 6d65 7461 6461 7461  in call metadata
-00012e40: 2066 6f72 2065 7665 7279 2063 616c 6c2c   for every call,
-00012e50: 2074 6f20 6964 656e 7469 6679 2074 6865   to identify the
-00012e60: 2063 6c69 656e 7420 746f 2074 6865 2063   client to the c
-00012e70: 6c75 7374 6572 2e20 2020 2020 2020 2020  luster.         
-00012e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012ec0: 2020 2020 2020 2020 2020 2020 207c 0a7c               |.|
-00012ed0: 204e 6f64 6550 7265 6665 7265 6e63 6520   NodePreference 
-00012ee0: 2020 2020 207c 2022 6c65 6164 6572 222c       | "leader",
-00012ef0: 2022 666f 6c6c 6f77 6572 222c 2022 7265   "follower", "re
-00012f00: 6164 6f6e 6c79 7265 706c 6963 6122 2c20  adonlyreplica", 
-00012f10: 2272 616e 646f 6d22 2028 6465 6661 756c  "random" (defaul
-00012f20: 743a 2022 6c65 6164 6572 2229 207c 2054  t: "leader") | T
-00012f30: 6865 206e 6f64 6520 7374 6174 6520 7072  he node state pr
-00012f40: 6566 6572 7265 6420 6279 2074 6865 2063  eferred by the c
-00012f50: 6c69 656e 742e 2054 6865 2063 6c69 656e  lient. The clien
-00012f60: 7420 7769 6c6c 2073 656c 6563 7420 6120  t will select a 
-00012f70: 6e6f 6465 2066 726f 6d20 7468 6520 636c  node from the cl
-00012f80: 7573 7465 7220 696e 666f 2072 6563 6569  uster info recei
-00012f90: 7665 6420 6672 6f6d 2074 6865 2047 6f73  ved from the Gos
-00012fa0: 7369 7020 4150 4920 6163 636f 7264 696e  sip API accordin
-00012fb0: 6720 746f 2074 6869 7320 7072 6566 6572  g to this prefer
-00012fc0: 656e 6365 2e20 2020 2020 2020 2020 2020  ence.           
-00012fd0: 207c 0a7c 2044 6566 6175 6c74 4465 6164   |.| DefaultDead
-00012fe0: 6c69 6e65 2020 2020 207c 2069 6e74 6567  line     | integ
-00012ff0: 6572 2028 6465 6661 756c 743a 2060 4e6f  er (default: `No
-00013000: 6e65 6029 2020 2020 2020 2020 2020 2020  ne`)            
-00013010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013030: 207c 2054 6865 2064 6566 6175 6c74 2076   | The default v
-00013040: 616c 7565 2028 696e 2073 6563 6f6e 6473  alue (in seconds
-00013050: 2920 6f66 2074 6865 2060 7469 6d65 6f75  ) of the `timeou
-00013060: 7460 2061 7267 756d 656e 7420 6f66 2063  t` argument of c
-00013070: 6c69 656e 7420 2277 7269 7465 2220 6d65  lient "write" me
-00013080: 7468 6f64 7320 7375 6368 2061 7320 6061  thods such as `a
-00013090: 7070 656e 645f 6576 656e 7473 2829 602e  ppend_events()`.
-000130a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000130b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000130c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000130d0: 2020 2020 207c 0a7c 2047 6f73 7369 7054       |.| GossipT
-000130e0: 696d 656f 7574 2020 2020 2020 207c 2069  imeout       | i
-000130f0: 6e74 6567 6572 2028 6465 6661 756c 743a  nteger (default:
-00013100: 2035 2920 2020 2020 2020 2020 2020 2020   5)             
-00013110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013130: 2020 2020 207c 2054 6865 2064 6566 6175       | The defau
-00013140: 6c74 2076 616c 7565 2028 696e 2073 6563  lt value (in sec
-00013150: 6f6e 6473 2920 6f66 2074 6865 2060 7469  onds) of the `ti
-00013160: 6d65 6f75 7460 2061 7267 756d 656e 7420  meout` argument 
-00013170: 6f66 2067 6f73 7369 7020 7265 6164 206d  of gossip read m
-00013180: 6574 686f 6473 2c20 7375 6368 2061 7320  ethods, such as 
-00013190: 6072 6561 645f 676f 7373 6970 2829 602e  `read_gossip()`.
-000131a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000131b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000131c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000131d0: 2020 2020 2020 2020 207c 0a7c 204d 6178           |.| Max
-000131e0: 4469 7363 6f76 6572 4174 7465 6d70 7473  DiscoverAttempts
-000131f0: 207c 2069 6e74 6567 6572 2028 6465 6661   | integer (defa
-00013200: 756c 743a 2031 3029 2020 2020 2020 2020  ult: 10)        
-00013210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013230: 2020 2020 2020 2020 207c 2054 6865 206e           | The n
-00013240: 756d 6265 7220 6f66 2061 7474 656d 7074  umber of attempt
-00013250: 7320 746f 2072 6561 6420 676f 7373 6970  s to read gossip
-00013260: 2077 6865 6e20 636f 6e6e 6563 7469 6e67   when connecting
-00013270: 206f 7220 7265 636f 6e6e 6563 7469 6e67   or reconnecting
-00013280: 2074 6f20 6120 636c 7573 7465 7220 6d65   to a cluster me
-00013290: 6d62 6572 2e20 2020 2020 2020 2020 2020  mber.           
-000132a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000132b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000132c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000132d0: 2020 2020 2020 2020 2020 2020 207c 0a7c               |.|
-000132e0: 2044 6973 636f 7665 7279 496e 7465 7276   DiscoveryInterv
-000132f0: 616c 2020 207c 2069 6e74 6567 6572 2028  al   | integer (
-00013300: 6465 6661 756c 743a 2031 3030 2920 2020  default: 100)   
-00013310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013330: 2020 2020 2020 2020 2020 2020 207c 2048               | H
-00013340: 6f77 206c 6f6e 6720 746f 2077 6169 7420  ow long to wait 
-00013350: 2869 6e20 6d69 6c6c 6973 6563 6f6e 6473  (in milliseconds
-00013360: 2920 6265 7477 6565 6e20 676f 7373 6970  ) between gossip
-00013370: 2072 6574 7269 6573 2e20 2020 2020 2020   retries.       
-00013380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000133a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000133b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000133c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000133d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000133e0: 207c 0a7c 204b 6565 7041 6c69 7665 496e   |.| KeepAliveIn
-000133f0: 7465 7276 616c 2020 207c 2069 6e74 6567  terval   | integ
-00013400: 6572 2028 6465 6661 756c 743a 2060 4e6f  er (default: `No
-00013410: 6e65 6029 2020 2020 2020 2020 2020 2020  ne`)            
+000004e0: 2066 6f72 2065 7861 6d70 6c65 2077 6865   for example whe
+000004f0: 6e20 6578 6563 7574 696e 6720 6120 636f  n executing a co
+00000500: 6d6d 616e 6420 696e 2061 6e20 6170 706c  mmand in an appl
+00000510: 6963 6174 696f 6e0a 7468 6174 206d 7574  ication.that mut
+00000520: 6174 6573 2061 6e20 6167 6772 6567 6174  ates an aggregat
+00000530: 652e 2054 6869 7320 6d65 7468 6f64 2069  e. This method i
+00000540: 7320 2261 746f 6d69 6322 2069 6e20 7468  s "atomic" in th
+00000550: 6174 2065 6974 6865 7220 616c 6c20 6f72  at either all or
+00000560: 206e 6f6e 6520 6f66 0a74 6865 2065 7665   none of.the eve
+00000570: 6e74 7320 7769 6c6c 2062 6520 7265 636f  nts will be reco
+00000580: 7264 6564 2e0a 0a2a 2060 7265 6164 5f73  rded...* `read_s
+00000590: 7472 6561 6d5f 6576 656e 7473 2829 6020  tream_events()` 
+000005a0: 5468 6973 206d 6574 686f 6420 6361 6e20  This method can 
+000005b0: 6265 2075 7365 6420 746f 2072 6574 7269  be used to retri
+000005c0: 6576 6520 616c 6c20 7468 6520 7265 636f  eve all the reco
+000005d0: 7264 6564 0a65 7665 6e74 7320 696e 2061  rded.events in a
+000005e0: 2022 7374 7265 616d 222e 2054 6869 7320   "stream". This 
+000005f0: 6973 2075 7365 6675 6c20 666f 7220 6578  is useful for ex
+00000600: 616d 706c 6520 7768 656e 2072 6563 6f6e  ample when recon
+00000610: 7374 7275 6374 696e 6720 616e 2061 6767  structing an agg
+00000620: 7265 6761 7465 0a62 6566 6f72 6520 6578  regate.before ex
+00000630: 6563 7574 696e 6720 6120 636f 6d6d 616e  ecuting a comman
+00000640: 6420 696e 2061 6e20 6170 706c 6963 6174  d in an applicat
+00000650: 696f 6e2e 0a0a 2a20 6073 7562 7363 7269  ion...* `subscri
+00000660: 6265 5f61 6c6c 5f65 7665 6e74 7328 2960  be_all_events()`
+00000670: 2054 6869 7320 6d65 7468 6f64 2063 616e   This method can
+00000680: 2062 6520 7573 6564 2074 6f20 7265 6365   be used to rece
+00000690: 6976 6520 616c 6c20 7265 636f 7264 6564  ive all recorded
+000006a0: 0a65 7665 6e74 7320 6163 726f 7373 2061  .events across a
+000006b0: 6c6c 2022 7374 7265 616d 7322 2e20 5468  ll "streams". Th
+000006c0: 6973 2069 7320 7573 6566 756c 2069 6e20  is is useful in 
+000006d0: 646f 776e 7374 7265 616d 2065 7665 6e74  downstream event
+000006e0: 2d70 726f 6365 7373 696e 670a 636f 6d70  -processing.comp
+000006f0: 6f6e 656e 7473 2c20 616e 6420 7375 7070  onents, and supp
+00000700: 6f72 7473 2070 726f 6365 7373 696e 6720  orts processing 
+00000710: 6576 656e 7473 2077 6974 6820 2265 7861  events with "exa
+00000720: 6374 6c79 2d6f 6e63 6522 2073 656d 616e  ctly-once" seman
+00000730: 7469 6373 2028 7365 6520 6265 6c6f 7729  tics (see below)
+00000740: 2e0a 0a54 6865 2065 7861 6d70 6c65 2062  ...The example b
+00000750: 656c 6f77 2075 7365 7320 616e 2022 696e  elow uses an "in
+00000760: 7365 6375 7265 2220 4576 656e 7453 746f  secure" EventSto
+00000770: 7265 4442 2073 6572 7665 7220 7275 6e6e  reDB server runn
+00000780: 696e 6720 6c6f 6361 6c6c 7920 6f6e 2070  ing locally on p
+00000790: 6f72 7420 3231 3134 2e0a 0a60 6060 7079  ort 2114...```py
+000007a0: 7468 6f6e 0a69 6d70 6f72 7420 6573 6462  thon.import esdb
+000007b0: 636c 6965 6e74 2c20 7575 6964 0a0a 0a23  client, uuid...#
+000007c0: 2043 6f6e 7374 7275 6374 2045 5344 4243   Construct ESDBC
+000007d0: 6c69 656e 7420 7769 7468 2061 6e20 4576  lient with an Ev
+000007e0: 656e 7453 746f 7265 4442 2055 5249 2e0a  entStoreDB URI..
+000007f0: 0a63 6c69 656e 7420 3d20 6573 6462 636c  .client = esdbcl
+00000800: 6965 6e74 2e45 5344 4243 6c69 656e 7428  ient.ESDBClient(
+00000810: 7572 693d 2265 7364 623a 2f2f 6c6f 6361  uri="esdb://loca
+00000820: 6c68 6f73 743a 3231 3134 3f54 6c73 3d66  lhost:2114?Tls=f
+00000830: 616c 7365 2229 0a0a 0a23 2041 7070 656e  alse")...# Appen
+00000840: 6420 6576 656e 7473 2074 6f20 6120 6e65  d events to a ne
+00000850: 7720 7374 7265 616d 2e0a 0a73 7472 6561  w stream...strea
+00000860: 6d5f 6e61 6d65 203d 2073 7472 2875 7569  m_name = str(uui
+00000870: 642e 7575 6964 3428 2929 0a0a 6576 656e  d.uuid4())..even
+00000880: 7431 203d 2065 7364 6263 6c69 656e 742e  t1 = esdbclient.
+00000890: 4e65 7745 7665 6e74 2874 7970 653d 274f  NewEvent(type='O
+000008a0: 7264 6572 4372 6561 7465 6427 2c20 6461  rderCreated', da
+000008b0: 7461 3d62 2764 6174 6131 2729 0a0a 636c  ta=b'data1')..cl
+000008c0: 6965 6e74 2e61 7070 656e 645f 6576 656e  ient.append_even
+000008d0: 7473 280a 2020 2020 7374 7265 616d 5f6e  ts(.    stream_n
+000008e0: 616d 653d 7374 7265 616d 5f6e 616d 652c  ame=stream_name,
+000008f0: 0a20 2020 2065 7870 6563 7465 645f 706f  .    expected_po
+00000900: 7369 7469 6f6e 3d4e 6f6e 652c 0a20 2020  sition=None,.   
+00000910: 2065 7665 6e74 733d 5b65 7665 6e74 315d   events=[event1]
+00000920: 2c0a 290a 0a0a 2320 4170 7065 6e64 206d  ,.)...# Append m
+00000930: 6f72 6520 6576 656e 7473 2074 6f20 616e  ore events to an
+00000940: 2065 7869 7374 696e 6720 7374 7265 616d   existing stream
+00000950: 2e0a 0a65 7665 6e74 3220 3d20 6573 6462  ...event2 = esdb
+00000960: 636c 6965 6e74 2e4e 6577 4576 656e 7428  client.NewEvent(
+00000970: 7479 7065 3d27 4f72 6465 7255 7064 6174  type='OrderUpdat
+00000980: 6564 272c 2064 6174 613d 6227 6461 7461  ed', data=b'data
+00000990: 3227 290a 6576 656e 7433 203d 2065 7364  2').event3 = esd
+000009a0: 6263 6c69 656e 742e 4e65 7745 7665 6e74  bclient.NewEvent
+000009b0: 2874 7970 653d 274f 7264 6572 4465 6c65  (type='OrderDele
+000009c0: 7465 6427 2c20 6461 7461 3d62 2764 6174  ted', data=b'dat
+000009d0: 6133 2729 0a0a 636c 6965 6e74 2e61 7070  a3')..client.app
+000009e0: 656e 645f 6576 656e 7473 280a 2020 2020  end_events(.    
+000009f0: 7374 7265 616d 5f6e 616d 653d 7374 7265  stream_name=stre
+00000a00: 616d 5f6e 616d 652c 0a20 2020 2065 7870  am_name,.    exp
+00000a10: 6563 7465 645f 706f 7369 7469 6f6e 3d30  ected_position=0
+00000a20: 2c0a 2020 2020 6576 656e 7473 3d5b 6576  ,.    events=[ev
+00000a30: 656e 7432 2c20 6576 656e 7433 5d2c 0a29  ent2, event3],.)
+00000a40: 0a0a 0a23 2052 6561 6420 616c 6c20 6576  ...# Read all ev
+00000a50: 656e 7473 2072 6563 6f72 6465 6420 696e  ents recorded in
+00000a60: 2061 2073 7472 6561 6d2e 0a0a 7265 636f   a stream...reco
+00000a70: 7264 6564 203d 2063 6c69 656e 742e 7265  rded = client.re
+00000a80: 6164 5f73 7472 6561 6d5f 6576 656e 7473  ad_stream_events
+00000a90: 280a 2020 2020 7374 7265 616d 5f6e 616d  (.    stream_nam
+00000aa0: 653d 7374 7265 616d 5f6e 616d 650a 290a  e=stream_name.).
+00000ab0: 0a61 7373 6572 7420 6c65 6e28 7265 636f  .assert len(reco
+00000ac0: 7264 6564 2920 3d3d 2033 0a61 7373 6572  rded) == 3.asser
+00000ad0: 7420 7265 636f 7264 6564 5b30 5d2e 6461  t recorded[0].da
+00000ae0: 7461 203d 3d20 6576 656e 7431 2e64 6174  ta == event1.dat
+00000af0: 610a 6173 7365 7274 2072 6563 6f72 6465  a.assert recorde
+00000b00: 645b 315d 2e64 6174 6120 3d3d 2065 7665  d[1].data == eve
+00000b10: 6e74 322e 6461 7461 0a61 7373 6572 7420  nt2.data.assert 
+00000b20: 7265 636f 7264 6564 5b32 5d2e 6461 7461  recorded[2].data
+00000b30: 203d 3d20 6576 656e 7433 2e64 6174 610a   == event3.data.
+00000b40: 6173 7365 7274 2072 6563 6f72 6465 645b  assert recorded[
+00000b50: 305d 2e74 7970 6520 3d3d 2065 7665 6e74  0].type == event
+00000b60: 312e 7479 7065 0a61 7373 6572 7420 7265  1.type.assert re
+00000b70: 636f 7264 6564 5b31 5d2e 7479 7065 203d  corded[1].type =
+00000b80: 3d20 6576 656e 7432 2e74 7970 650a 6173  = event2.type.as
+00000b90: 7365 7274 2072 6563 6f72 6465 645b 325d  sert recorded[2]
+00000ba0: 2e74 7970 6520 3d3d 2065 7665 6e74 332e  .type == event3.
+00000bb0: 7479 7065 0a0a 0a23 2049 6e20 616e 2065  type...# In an e
+00000bc0: 7665 6e74 2d70 726f 6365 7373 696e 6720  vent-processing 
+00000bd0: 636f 6d70 6f6e 656e 742c 2075 7365 2061  component, use a
+00000be0: 2022 6361 7463 682d 7570 2220 7375 6273   "catch-up" subs
+00000bf0: 6372 6970 7469 6f6e 0a23 2074 6f20 7265  cription.# to re
+00000c00: 6365 6976 6520 616c 6c20 6576 656e 7473  ceive all events
+00000c10: 2061 6372 6f73 7320 616c 6c20 7374 7265   across all stre
+00000c20: 616d 732c 2069 6e63 6c75 6469 6e67 2065  ams, including e
+00000c30: 7665 6e74 7320 7468 6174 0a23 2068 6176  vents that.# hav
+00000c40: 6520 6e6f 7420 7965 7420 6265 656e 2072  e not yet been r
+00000c50: 6563 6f72 6465 642c 2073 7461 7274 696e  ecorded, startin
+00000c60: 6720 6672 6f6d 2074 6865 2063 6f6d 706f  g from the compo
+00000c70: 6e65 6e74 2773 206c 6173 740a 2320 7361  nent's last.# sa
+00000c80: 7665 6420 2263 6f6d 6d69 7420 706f 7369  ved "commit posi
+00000c90: 7469 6f6e 222e 0a0a 6c61 7374 5f73 6176  tion"...last_sav
+00000ca0: 6564 5f63 6f6d 6d69 745f 706f 7369 7469  ed_commit_positi
+00000cb0: 6f6e 203d 2030 0a0a 7375 6273 6372 6970  on = 0..subscrip
+00000cc0: 7469 6f6e 203d 2063 6c69 656e 742e 7375  tion = client.su
+00000cd0: 6273 6372 6962 655f 616c 6c5f 6576 656e  bscribe_all_even
+00000ce0: 7473 280a 2020 2020 636f 6d6d 6974 5f70  ts(.    commit_p
+00000cf0: 6f73 6974 696f 6e3d 6c61 7374 5f73 6176  osition=last_sav
+00000d00: 6564 5f63 6f6d 6d69 745f 706f 7369 7469  ed_commit_positi
+00000d10: 6f6e 0a29 0a0a 2320 546f 2069 6d70 6c65  on.)..# To imple
+00000d20: 6d65 6e74 2022 6578 6163 746c 792d 6f6e  ment "exactly-on
+00000d30: 6365 2220 7365 6d61 6e74 6963 732c 2069  ce" semantics, i
+00000d40: 7465 7261 7465 206f 7665 7220 7468 650a  terate over the.
+00000d50: 2320 2263 6174 6368 2d75 7022 2073 7562  # "catch-up" sub
+00000d60: 7363 7269 7074 696f 6e2e 2050 726f 6365  scription. Proce
+00000d70: 7373 2065 6163 6820 7265 6365 6976 6564  ss each received
+00000d80: 2065 7665 6e74 2c0a 2320 696e 2074 7572   event,.# in tur
+00000d90: 6e2c 2074 6872 6f75 6768 2061 6e20 6576  n, through an ev
+00000da0: 656e 742d 7072 6f63 6573 7369 6e67 2070  ent-processing p
+00000db0: 6f6c 6963 792e 2053 6176 6520 7468 650a  olicy. Save the.
+00000dc0: 2320 7661 6c75 6520 6f66 2074 6865 2063  # value of the c
+00000dd0: 6f6d 6d69 745f 706f 7369 7469 6f6e 2061  ommit_position a
+00000de0: 7474 7269 6275 7465 206f 6620 7468 6520  ttribute of the 
+00000df0: 7072 6f63 6573 7365 640a 2320 6576 656e  processed.# even
+00000e00: 7420 7769 7468 206e 6577 2073 7461 7465  t with new state
+00000e10: 2067 656e 6572 6174 6564 2062 7920 7468   generated by th
+00000e20: 6520 706f 6c69 6379 2069 6e20 7468 6520  e policy in the 
+00000e30: 7361 6d65 0a23 2061 746f 6d69 6320 7472  same.# atomic tr
+00000e40: 616e 7361 6374 696f 6e2e 2055 7365 2074  ansaction. Use t
+00000e50: 6865 206c 6173 7420 7361 7665 6420 2263  he last saved "c
+00000e60: 6f6d 6d69 7420 706f 7369 7469 6f6e 220a  ommit position".
+00000e70: 2320 7768 656e 2072 6573 7461 7274 696e  # when restartin
+00000e80: 6720 7468 6520 2263 6174 6368 2d75 7022  g the "catch-up"
+00000e90: 2073 7562 7363 7269 7074 696f 6e2e 0a0a   subscription...
+00000ea0: 7265 6365 6976 6564 203d 205b 5d0a 666f  received = [].fo
+00000eb0: 7220 6576 656e 7420 696e 2073 7562 7363  r event in subsc
+00000ec0: 7269 7074 696f 6e3a 0a20 2020 2072 6563  ription:.    rec
+00000ed0: 6569 7665 642e 6170 7065 6e64 2865 7665  eived.append(eve
+00000ee0: 6e74 290a 2020 2020 6966 2065 7665 6e74  nt).    if event
+00000ef0: 2e69 6420 3d3d 2065 7665 6e74 332e 6964  .id == event3.id
+00000f00: 3a0a 2020 2020 2020 2020 6272 6561 6b0a  :.        break.
+00000f10: 0a61 7373 6572 7420 7265 6365 6976 6564  .assert received
+00000f20: 5b2d 335d 2e64 6174 6120 3d3d 2065 7665  [-3].data == eve
+00000f30: 6e74 312e 6461 7461 0a61 7373 6572 7420  nt1.data.assert 
+00000f40: 7265 6365 6976 6564 5b2d 325d 2e64 6174  received[-2].dat
+00000f50: 6120 3d3d 2065 7665 6e74 322e 6461 7461  a == event2.data
+00000f60: 0a61 7373 6572 7420 7265 6365 6976 6564  .assert received
+00000f70: 5b2d 315d 2e64 6174 6120 3d3d 2065 7665  [-1].data == eve
+00000f80: 6e74 332e 6461 7461 0a61 7373 6572 7420  nt3.data.assert 
+00000f90: 7265 6365 6976 6564 5b2d 335d 2e74 7970  received[-3].typ
+00000fa0: 6520 3d3d 2065 7665 6e74 312e 7479 7065  e == event1.type
+00000fb0: 0a61 7373 6572 7420 7265 6365 6976 6564  .assert received
+00000fc0: 5b2d 325d 2e74 7970 6520 3d3d 2065 7665  [-2].type == eve
+00000fd0: 6e74 322e 7479 7065 0a61 7373 6572 7420  nt2.type.assert 
+00000fe0: 7265 6365 6976 6564 5b2d 315d 2e74 7970  received[-1].typ
+00000ff0: 6520 3d3d 2065 7665 6e74 332e 7479 7065  e == event3.type
+00001000: 0a0a 6173 7365 7274 2072 6563 6569 7665  ..assert receive
+00001010: 645b 2d33 5d2e 636f 6d6d 6974 5f70 6f73  d[-3].commit_pos
+00001020: 6974 696f 6e20 3e20 300a 6173 7365 7274  ition > 0.assert
+00001030: 2072 6563 6569 7665 645b 2d32 5d2e 636f   received[-2].co
+00001040: 6d6d 6974 5f70 6f73 6974 696f 6e20 3e20  mmit_position > 
+00001050: 7265 6365 6976 6564 5b2d 335d 2e63 6f6d  received[-3].com
+00001060: 6d69 745f 706f 7369 7469 6f6e 0a61 7373  mit_position.ass
+00001070: 6572 7420 7265 6365 6976 6564 5b2d 315d  ert received[-1]
+00001080: 2e63 6f6d 6d69 745f 706f 7369 7469 6f6e  .commit_position
+00001090: 203e 2072 6563 6569 7665 645b 2d32 5d2e   > received[-2].
+000010a0: 636f 6d6d 6974 5f70 6f73 6974 696f 6e0a  commit_position.
+000010b0: 0a0a 2320 436c 6f73 6520 7468 6520 636c  ..# Close the cl
+000010c0: 6965 6e74 2061 6674 6572 2075 7365 2e0a  ient after use..
+000010d0: 0a63 6c69 656e 742e 636c 6f73 6528 290a  .client.close().
+000010e0: 6060 600a 0a53 6565 2062 656c 6f77 2066  ```..See below f
+000010f0: 6f72 206d 6f72 6520 6465 7461 696c 732e  or more details.
+00001100: 0a0a 466f 7220 616e 2065 7861 6d70 6c65  ..For an example
+00001110: 206f 6620 7573 6167 652c 2073 6565 2074   of usage, see t
+00001120: 6865 205b 6576 656e 7473 6f75 7263 696e  he [eventsourcin
+00001130: 672d 6576 656e 7473 746f 7265 6462 5d28  g-eventstoredb](
+00001140: 0a68 7474 7073 3a2f 2f67 6974 6875 622e  .https://github.
+00001150: 636f 6d2f 7079 6576 656e 7473 6f75 7263  com/pyeventsourc
+00001160: 696e 672f 6576 656e 7473 6f75 7263 696e  ing/eventsourcin
+00001170: 672d 6576 656e 7473 746f 7265 6462 2920  g-eventstoredb) 
+00001180: 7061 636b 6167 652e 0a0a 2323 2054 6162  package...## Tab
+00001190: 6c65 206f 6620 636f 6e74 656e 7473 0a0a  le of contents..
+000011a0: 3c21 2d2d 2054 4f43 202d 2d3e 0a2a 205b  <!-- TOC -->.* [
+000011b0: 496e 7374 616c 6c20 7061 636b 6167 655d  Install package]
+000011c0: 2823 696e 7374 616c 6c2d 7061 636b 6167  (#install-packag
+000011d0: 6529 0a20 202a 205b 4672 6f6d 2050 7950  e).  * [From PyP
+000011e0: 495d 2823 6672 6f6d 2d70 7970 6929 0a20  I](#from-pypi). 
+000011f0: 202a 205b 5769 7468 2050 6f65 7472 795d   * [With Poetry]
+00001200: 2823 7769 7468 2d70 6f65 7472 7929 0a2a  (#with-poetry).*
+00001210: 205b 4576 656e 7453 746f 7265 4442 2073   [EventStoreDB s
+00001220: 6572 7665 725d 2823 6576 656e 7473 746f  erver](#eventsto
+00001230: 7265 6462 2d73 6572 7665 7229 0a20 202a  redb-server).  *
+00001240: 205b 5275 6e20 636f 6e74 6169 6e65 725d   [Run container]
+00001250: 2823 7275 6e2d 636f 6e74 6169 6e65 7229  (#run-container)
+00001260: 0a20 202a 205b 5374 6f70 2063 6f6e 7461  .  * [Stop conta
+00001270: 696e 6572 5d28 2373 746f 702d 636f 6e74  iner](#stop-cont
+00001280: 6169 6e65 7229 0a2a 205b 4576 656e 7453  ainer).* [EventS
+00001290: 746f 7265 4442 2063 6c69 656e 745d 2823  toreDB client](#
+000012a0: 6576 656e 7473 746f 7265 6462 2d63 6c69  eventstoredb-cli
+000012b0: 656e 7429 0a20 202a 205b 496d 706f 7274  ent).  * [Import
+000012c0: 2063 6c61 7373 5d28 2369 6d70 6f72 742d   class](#import-
+000012d0: 636c 6173 7329 0a20 202a 205b 436f 6e73  class).  * [Cons
+000012e0: 7472 7563 7420 636c 6965 6e74 5d28 2363  truct client](#c
+000012f0: 6f6e 7374 7275 6374 2d63 6c69 656e 7429  onstruct-client)
+00001300: 0a2a 205b 5374 7265 616d 735d 2823 7374  .* [Streams](#st
+00001310: 7265 616d 7329 0a20 202a 205b 4170 7065  reams).  * [Appe
+00001320: 6e64 2065 7665 6e74 735d 2823 6170 7065  nd events](#appe
+00001330: 6e64 2d65 7665 6e74 7329 0a20 202a 205b  nd-events).  * [
+00001340: 4170 7065 6e64 2065 7665 6e74 5d28 2361  Append event](#a
+00001350: 7070 656e 642d 6576 656e 7429 0a20 202a  ppend-event).  *
+00001360: 205b 4964 656d 706f 7465 6e74 2061 7070   [Idempotent app
+00001370: 656e 6420 6f70 6572 6174 696f 6e73 5d28  end operations](
+00001380: 2369 6465 6d70 6f74 656e 742d 6170 7065  #idempotent-appe
+00001390: 6e64 2d6f 7065 7261 7469 6f6e 7329 0a20  nd-operations). 
+000013a0: 202a 205b 5265 6164 2073 7472 6561 6d20   * [Read stream 
+000013b0: 6576 656e 7473 5d28 2372 6561 642d 7374  events](#read-st
+000013c0: 7265 616d 2d65 7665 6e74 7329 0a20 202a  ream-events).  *
+000013d0: 205b 486f 7720 746f 2069 6d70 6c65 6d65   [How to impleme
+000013e0: 6e74 2073 6e61 7073 686f 7474 696e 6720  nt snapshotting 
+000013f0: 7769 7468 2045 7665 6e74 5374 6f72 6544  with EventStoreD
+00001400: 425d 2823 686f 772d 746f 2d69 6d70 6c65  B](#how-to-imple
+00001410: 6d65 6e74 2d73 6e61 7073 686f 7474 696e  ment-snapshottin
+00001420: 672d 7769 7468 2d65 7665 6e74 7374 6f72  g-with-eventstor
+00001430: 6564 6229 0a20 202a 205b 5265 6164 2061  edb).  * [Read a
+00001440: 6c6c 2065 7665 6e74 735d 2823 7265 6164  ll events](#read
+00001450: 2d61 6c6c 2d65 7665 6e74 7329 0a20 202a  -all-events).  *
+00001460: 205b 4765 7420 6375 7272 656e 7420 7374   [Get current st
+00001470: 7265 616d 2070 6f73 6974 696f 6e5d 2823  ream position](#
+00001480: 6765 742d 6375 7272 656e 742d 7374 7265  get-current-stre
+00001490: 616d 2d70 6f73 6974 696f 6e29 0a20 202a  am-position).  *
+000014a0: 205b 4765 7420 6375 7272 656e 7420 636f   [Get current co
+000014b0: 6d6d 6974 2070 6f73 6974 696f 6e5d 2823  mmit position](#
+000014c0: 6765 742d 6375 7272 656e 742d 636f 6d6d  get-current-comm
+000014d0: 6974 2d70 6f73 6974 696f 6e29 0a20 202a  it-position).  *
+000014e0: 205b 4765 7420 7374 7265 616d 206d 6574   [Get stream met
+000014f0: 6164 6174 615d 2823 6765 742d 7374 7265  adata](#get-stre
+00001500: 616d 2d6d 6574 6164 6174 6129 0a20 202a  am-metadata).  *
+00001510: 205b 5365 7420 7374 7265 616d 206d 6574   [Set stream met
+00001520: 6164 6174 615d 2823 7365 742d 7374 7265  adata](#set-stre
+00001530: 616d 2d6d 6574 6164 6174 6129 0a20 202a  am-metadata).  *
+00001540: 205b 4465 6c65 7465 2073 7472 6561 6d5d   [Delete stream]
+00001550: 2823 6465 6c65 7465 2d73 7472 6561 6d29  (#delete-stream)
+00001560: 0a20 202a 205b 546f 6d62 7374 6f6e 6520  .  * [Tombstone 
+00001570: 7374 7265 616d 5d28 2374 6f6d 6273 746f  stream](#tombsto
+00001580: 6e65 2d73 7472 6561 6d29 0a2a 205b 4361  ne-stream).* [Ca
+00001590: 7463 682d 7570 2073 7562 7363 7269 7074  tch-up subscript
+000015a0: 696f 6e73 5d28 2363 6174 6368 2d75 702d  ions](#catch-up-
+000015b0: 7375 6273 6372 6970 7469 6f6e 7329 0a20  subscriptions). 
+000015c0: 202a 205b 486f 7720 746f 2069 6d70 6c65   * [How to imple
+000015d0: 6d65 6e74 2065 7861 6374 6c79 2d6f 6e63  ment exactly-onc
+000015e0: 6520 6576 656e 7420 7072 6f63 6573 7369  e event processi
+000015f0: 6e67 5d28 2368 6f77 2d74 6f2d 696d 706c  ng](#how-to-impl
+00001600: 656d 656e 742d 6578 6163 746c 792d 6f6e  ement-exactly-on
+00001610: 6365 2d65 7665 6e74 2d70 726f 6365 7373  ce-event-process
+00001620: 696e 6729 0a20 202a 205b 5375 6273 6372  ing).  * [Subscr
+00001630: 6962 6520 616c 6c20 6576 656e 7473 5d28  ibe all events](
+00001640: 2373 7562 7363 7269 6265 2d61 6c6c 2d65  #subscribe-all-e
+00001650: 7665 6e74 7329 0a20 202a 205b 5375 6273  vents).  * [Subs
+00001660: 6372 6962 6520 7374 7265 616d 2065 7665  cribe stream eve
+00001670: 6e74 735d 2823 7375 6273 6372 6962 652d  nts](#subscribe-
+00001680: 7374 7265 616d 2d65 7665 6e74 7329 0a2a  stream-events).*
+00001690: 205b 5065 7273 6973 7465 6e74 2073 7562   [Persistent sub
+000016a0: 7363 7269 7074 696f 6e73 5d28 2370 6572  scriptions](#per
+000016b0: 7369 7374 656e 742d 7375 6273 6372 6970  sistent-subscrip
+000016c0: 7469 6f6e 7329 0a20 202a 205b 4372 6561  tions).  * [Crea
+000016d0: 7465 2073 7562 7363 7269 7074 696f 6e5d  te subscription]
+000016e0: 2823 6372 6561 7465 2d73 7562 7363 7269  (#create-subscri
+000016f0: 7074 696f 6e29 0a20 202a 205b 5265 6164  ption).  * [Read
+00001700: 2073 7562 7363 7269 7074 696f 6e5d 2823   subscription](#
+00001710: 7265 6164 2d73 7562 7363 7269 7074 696f  read-subscriptio
+00001720: 6e29 0a20 202a 205b 4765 7420 7375 6273  n).  * [Get subs
+00001730: 6372 6970 7469 6f6e 2069 6e66 6f5d 2823  cription info](#
+00001740: 6765 742d 7375 6273 6372 6970 7469 6f6e  get-subscription
+00001750: 2d69 6e66 6f29 0a20 202a 205b 4c69 7374  -info).  * [List
+00001760: 2073 7562 7363 7269 7074 696f 6e73 5d28   subscriptions](
+00001770: 236c 6973 742d 7375 6273 6372 6970 7469  #list-subscripti
+00001780: 6f6e 7329 0a20 202a 205b 4465 6c65 7465  ons).  * [Delete
+00001790: 2073 7562 7363 7269 7074 696f 6e5d 2823   subscription](#
+000017a0: 6465 6c65 7465 2d73 7562 7363 7269 7074  delete-subscript
+000017b0: 696f 6e29 0a20 202a 205b 5570 6461 7465  ion).  * [Update
+000017c0: 2073 7562 7363 7269 7074 696f 6e5d 2823   subscription](#
+000017d0: 7570 6461 7465 2d73 7562 7363 7269 7074  update-subscript
+000017e0: 696f 6e29 0a20 202a 205b 4372 6561 7465  ion).  * [Create
+000017f0: 2073 7472 6561 6d20 7375 6273 6372 6970   stream subscrip
+00001800: 7469 6f6e 5d28 2363 7265 6174 652d 7374  tion](#create-st
+00001810: 7265 616d 2d73 7562 7363 7269 7074 696f  ream-subscriptio
+00001820: 6e29 0a20 202a 205b 5265 6164 2073 7472  n).  * [Read str
+00001830: 6561 6d20 7375 6273 6372 6970 7469 6f6e  eam subscription
+00001840: 5d28 2372 6561 642d 7374 7265 616d 2d73  ](#read-stream-s
+00001850: 7562 7363 7269 7074 696f 6e29 0a20 202a  ubscription).  *
+00001860: 205b 4765 7420 7374 7265 616d 2073 7562   [Get stream sub
+00001870: 7363 7269 7074 696f 6e20 696e 666f 5d28  scription info](
+00001880: 2367 6574 2d73 7472 6561 6d2d 7375 6273  #get-stream-subs
+00001890: 6372 6970 7469 6f6e 2d69 6e66 6f29 0a20  cription-info). 
+000018a0: 202a 205b 4c69 7374 2073 7472 6561 6d20   * [List stream 
+000018b0: 7375 6273 6372 6970 7469 6f6e 735d 2823  subscriptions](#
+000018c0: 6c69 7374 2d73 7472 6561 6d2d 7375 6273  list-stream-subs
+000018d0: 6372 6970 7469 6f6e 7329 0a20 202a 205b  criptions).  * [
+000018e0: 5570 6461 7465 2073 7472 6561 6d20 7375  Update stream su
+000018f0: 6273 6372 6970 7469 6f6e 5d28 2375 7064  bscription](#upd
+00001900: 6174 652d 7374 7265 616d 2d73 7562 7363  ate-stream-subsc
+00001910: 7269 7074 696f 6e29 0a20 202a 205b 4465  ription).  * [De
+00001920: 6c65 7465 2073 7472 6561 6d20 7375 6273  lete stream subs
+00001930: 6372 6970 7469 6f6e 5d28 2364 656c 6574  cription](#delet
+00001940: 652d 7374 7265 616d 2d73 7562 7363 7269  e-stream-subscri
+00001950: 7074 696f 6e29 0a20 202a 205b 5065 7273  ption).  * [Pers
+00001960: 6973 7465 6e74 2073 7562 7363 7269 7074  istent subscript
+00001970: 696f 6e20 636f 6e73 756d 6572 5d28 2370  ion consumer](#p
+00001980: 6572 7369 7374 656e 742d 7375 6273 6372  ersistent-subscr
+00001990: 6970 7469 6f6e 2d63 6f6e 7375 6d65 7229  iption-consumer)
+000019a0: 0a2a 205b 436f 6e6e 6563 7469 6f6e 5d28  .* [Connection](
+000019b0: 2363 6f6e 6e65 6374 696f 6e29 0a20 202a  #connection).  *
+000019c0: 205b 5265 636f 6e6e 6563 745d 2823 7265   [Reconnect](#re
+000019d0: 636f 6e6e 6563 7429 0a20 202a 205b 436c  connect).  * [Cl
+000019e0: 6f73 655d 2823 636c 6f73 6529 0a2a 205b  ose](#close).* [
+000019f0: 4e6f 7465 735d 2823 6e6f 7465 7329 0a20  Notes](#notes). 
+00001a00: 202a 205b 436f 6e6e 6563 7469 6f6e 2073   * [Connection s
+00001a10: 7472 696e 6773 5d28 2363 6f6e 6e65 6374  trings](#connect
+00001a20: 696f 6e2d 7374 7269 6e67 7329 0a20 202a  ion-strings).  *
+00001a30: 205b 5265 6775 6c61 7220 6578 7072 6573   [Regular expres
+00001a40: 7369 6f6e 2066 696c 7465 7273 5d28 2372  sion filters](#r
+00001a50: 6567 756c 6172 2d65 7870 7265 7373 696f  egular-expressio
+00001a60: 6e2d 6669 6c74 6572 7329 0a20 202a 205b  n-filters).  * [
+00001a70: 4e65 7720 6576 656e 7420 6f62 6a65 6374  New event object
+00001a80: 735d 2823 6e65 772d 6576 656e 742d 6f62  s](#new-event-ob
+00001a90: 6a65 6374 7329 0a20 202a 205b 5265 636f  jects).  * [Reco
+00001aa0: 7264 6564 2065 7665 6e74 206f 626a 6563  rded event objec
+00001ab0: 7473 5d28 2372 6563 6f72 6465 642d 6576  ts](#recorded-ev
+00001ac0: 656e 742d 6f62 6a65 6374 7329 0a20 202a  ent-objects).  *
+00001ad0: 205b 4173 796e 6369 6f20 636c 6965 6e74   [Asyncio client
+00001ae0: 5d28 2361 7379 6e63 696f 2d63 6c69 656e  ](#asyncio-clien
+00001af0: 7429 0a2a 205b 436f 6e74 7269 6275 746f  t).* [Contributo
+00001b00: 7273 5d28 2363 6f6e 7472 6962 7574 6f72  rs](#contributor
+00001b10: 7329 0a20 202a 205b 496e 7374 616c 6c20  s).  * [Install 
+00001b20: 506f 6574 7279 5d28 2369 6e73 7461 6c6c  Poetry](#install
+00001b30: 2d70 6f65 7472 7929 0a20 202a 205b 5365  -poetry).  * [Se
+00001b40: 7475 7020 666f 7220 5079 4368 6172 6d20  tup for PyCharm 
+00001b50: 7573 6572 735d 2823 7365 7475 702d 666f  users](#setup-fo
+00001b60: 722d 7079 6368 6172 6d2d 7573 6572 7329  r-pycharm-users)
+00001b70: 0a20 202a 205b 5365 7475 7020 6672 6f6d  .  * [Setup from
+00001b80: 2063 6f6d 6d61 6e64 206c 696e 655d 2823   command line](#
+00001b90: 7365 7475 702d 6672 6f6d 2d63 6f6d 6d61  setup-from-comma
+00001ba0: 6e64 2d6c 696e 6529 0a20 202a 205b 5072  nd-line).  * [Pr
+00001bb0: 6f6a 6563 7420 4d61 6b65 6669 6c65 2063  oject Makefile c
+00001bc0: 6f6d 6d61 6e64 735d 2823 7072 6f6a 6563  ommands](#projec
+00001bd0: 742d 6d61 6b65 6669 6c65 2d63 6f6d 6d61  t-makefile-comma
+00001be0: 6e64 7329 0a3c 212d 2d20 544f 4320 2d2d  nds).<!-- TOC --
+00001bf0: 3e0a 0a23 2320 496e 7374 616c 6c20 7061  >..## Install pa
+00001c00: 636b 6167 650a 0a49 7420 6973 2072 6563  ckage..It is rec
+00001c10: 6f6d 6d65 6e64 6564 2074 6f20 696e 7374  ommended to inst
+00001c20: 616c 6c20 5079 7468 6f6e 2070 6163 6b61  all Python packa
+00001c30: 6765 7320 696e 746f 2061 2050 7974 686f  ges into a Pytho
+00001c40: 6e20 7669 7274 7561 6c20 656e 7669 726f  n virtual enviro
+00001c50: 6e6d 656e 742e 0a0a 2323 2320 4672 6f6d  nment...### From
+00001c60: 2050 7950 490a 0a59 6f75 2063 616e 2075   PyPI..You can u
+00001c70: 7365 2070 6970 2074 6f20 696e 7374 616c  se pip to instal
+00001c80: 6c20 7468 6973 2070 6163 6b61 6765 2064  l this package d
+00001c90: 6972 6563 746c 7920 6672 6f6d 0a5b 7468  irectly from.[th
+00001ca0: 6520 5079 7468 6f6e 2050 6163 6b61 6765  e Python Package
+00001cb0: 2049 6e64 6578 5d28 6874 7470 733a 2f2f   Index](https://
+00001cc0: 7079 7069 2e6f 7267 2f70 726f 6a65 6374  pypi.org/project
+00001cd0: 2f65 7364 6263 6c69 656e 742f 292e 0a0a  /esdbclient/)...
+00001ce0: 2020 2020 2420 7069 7020 696e 7374 616c      $ pip instal
+00001cf0: 6c20 6573 6462 636c 6965 6e74 0a0a 2323  l esdbclient..##
+00001d00: 2320 5769 7468 2050 6f65 7472 790a 0a59  # With Poetry..Y
+00001d10: 6f75 2063 616e 2075 7365 2050 6f65 7472  ou can use Poetr
+00001d20: 7920 746f 2061 6464 2074 6869 7320 7061  y to add this pa
+00001d30: 636b 6167 6520 746f 2079 6f75 7220 7079  ckage to your py
+00001d40: 7072 6f6a 6563 742e 746f 6d6c 2061 6e64  project.toml and
+00001d50: 2069 6e73 7461 6c6c 2069 742e 0a0a 2020   install it...  
+00001d60: 2020 2420 706f 6574 7279 2061 6464 2065    $ poetry add e
+00001d70: 7364 6263 6c69 656e 740a 0a23 2320 4576  sdbclient..## Ev
+00001d80: 656e 7453 746f 7265 4442 2073 6572 7665  entStoreDB serve
+00001d90: 720a 0a54 6865 2045 7665 6e74 5374 6f72  r..The EventStor
+00001da0: 6544 4220 7365 7276 6572 2063 616e 2062  eDB server can b
+00001db0: 6520 7275 6e20 6c6f 6361 6c6c 7920 7573  e run locally us
+00001dc0: 696e 6720 7468 6520 6f66 6669 6369 616c  ing the official
+00001dd0: 2044 6f63 6b65 7220 636f 6e74 6169 6e65   Docker containe
+00001de0: 7220 696d 6167 652e 0a0a 2323 2320 5275  r image...### Ru
+00001df0: 6e20 636f 6e74 6169 6e65 720a 0a46 6f72  n container..For
+00001e00: 2064 6576 656c 6f70 6d65 6e74 2c20 796f   development, yo
+00001e10: 7520 6361 6e20 7275 6e20 6120 2273 6563  u can run a "sec
+00001e20: 7572 6522 2045 7665 6e74 5374 6f72 6544  ure" EventStoreD
+00001e30: 4220 7365 7276 6572 2075 7369 6e67 2074  B server using t
+00001e40: 6865 2066 6f6c 6c6f 7769 6e67 2063 6f6d  he following com
+00001e50: 6d61 6e64 2e0a 0a20 2020 2024 2064 6f63  mand...    $ doc
+00001e60: 6b65 7220 7275 6e20 2d64 202d 2d6e 616d  ker run -d --nam
+00001e70: 6520 6576 656e 7473 746f 7265 6462 2d73  e eventstoredb-s
+00001e80: 6563 7572 6520 2d69 7420 2d70 2032 3131  ecure -it -p 211
+00001e90: 333a 3231 3133 202d 2d65 6e76 2022 484f  3:2113 --env "HO
+00001ea0: 4d45 3d2f 746d 7022 2065 7665 6e74 7374  ME=/tmp" eventst
+00001eb0: 6f72 652f 6576 656e 7473 746f 7265 3a32  ore/eventstore:2
+00001ec0: 312e 3130 2e39 2d62 7573 7465 722d 736c  1.10.9-buster-sl
+00001ed0: 696d 202d 2d64 6576 0a0a 4173 2077 6520  im --dev..As we 
+00001ee0: 7769 6c6c 2073 6565 2c20 7468 6520 636c  will see, the cl
+00001ef0: 6965 6e74 206e 6565 6473 2061 6e20 4576  ient needs an Ev
+00001f00: 656e 7453 746f 7265 4442 2063 6f6e 6e65  entStoreDB conne
+00001f10: 6374 696f 6e20 7374 7269 6e67 2055 5249  ction string URI
+00001f20: 2061 7320 7468 6520 7661 6c75 6520 6f66   as the value of
+00001f30: 0a69 7473 2060 7572 6960 2063 6f6e 7374  .its `uri` const
+00001f40: 7275 6374 6f72 2061 7267 756d 656e 742e  ructor argument.
+00001f50: 2053 6565 2074 6865 204e 6f74 6573 2073   See the Notes s
+00001f60: 6563 7469 6f6e 2062 656c 6f77 2066 6f72  ection below for
+00001f70: 2064 6574 6169 6c65 6420 696e 666f 726d   detailed inform
+00001f80: 6174 696f 6e0a 6162 6f75 7420 4576 656e  ation.about Even
+00001f90: 7453 746f 7265 4442 2063 6f6e 6e65 6374  tStoreDB connect
+00001fa0: 696f 6e20 7374 7269 6e67 2055 5249 732e  ion string URIs.
+00001fb0: 0a0a 5468 6520 636f 6e6e 6563 7469 6f6e  ..The connection
+00001fc0: 2073 7472 696e 6720 666f 7220 7468 6973   string for this
+00001fd0: 2022 7365 6375 7265 2220 4576 656e 7453   "secure" EventS
+00001fe0: 746f 7265 4442 2073 6572 7665 7220 776f  toreDB server wo
+00001ff0: 756c 6420 6265 3a0a 0a20 2020 2065 7364  uld be:..    esd
+00002000: 623a 2f2f 6164 6d69 6e3a 6368 616e 6765  b://admin:change
+00002010: 6974 406c 6f63 616c 686f 7374 3a32 3131  it@localhost:211
+00002020: 330a 0a54 6f20 636f 6e6e 6563 7420 746f  3..To connect to
+00002030: 2061 2022 7365 6375 7265 2220 7365 7276   a "secure" serv
+00002040: 6572 2c20 796f 7520 7769 6c6c 2075 7375  er, you will usu
+00002050: 616c 6c79 206e 6565 6420 746f 2069 6e63  ally need to inc
+00002060: 6c75 6465 2061 2022 7573 6572 6e61 6d65  lude a "username
+00002070: 220a 616e 6420 6120 2270 6173 7377 6f72  ".and a "passwor
+00002080: 6422 2069 6e20 7468 6520 636f 6e6e 6563  d" in the connec
+00002090: 7469 6f6e 2073 7472 696e 672c 2073 6f20  tion string, so 
+000020a0: 7468 6174 2074 6865 2073 6572 7665 7220  that the server 
+000020b0: 6361 6e20 6175 7468 656e 7469 6361 7465  can authenticate
+000020c0: 2074 6865 0a63 6c69 656e 742e 2054 6865   the.client. The
+000020d0: 2064 6566 6175 6c74 2075 7365 726e 616d   default usernam
+000020e0: 6520 6973 2022 6164 6d69 6e22 2061 6e64  e is "admin" and
+000020f0: 2074 6865 2064 6566 6175 6c74 2070 6173   the default pas
+00002100: 7377 6f72 6420 6973 2022 6368 616e 6765  sword is "change
+00002110: 6974 222e 0a0a 5768 656e 2063 6f6e 6e65  it"...When conne
+00002120: 6374 696e 6720 746f 2061 2022 7365 6375  cting to a "secu
+00002130: 7265 2220 7365 7276 6572 2c20 7468 6520  re" server, the 
+00002140: 636c 6965 6e74 2061 6c73 6f20 6e65 6564  client also need
+00002150: 7320 616e 2053 534c 2f54 4c53 0a63 6572  s an SSL/TLS.cer
+00002160: 7469 6669 6361 7465 2061 7320 7468 6520  tificate as the 
+00002170: 7661 6c75 6520 6f66 2069 7473 2060 726f  value of its `ro
+00002180: 6f74 5f63 6572 7469 6669 6361 7465 7360  ot_certificates`
+00002190: 2063 6f6e 7374 7275 6374 6f72 2061 7267   constructor arg
+000021a0: 756d 656e 742e 2054 6f20 636f 6e6e 6563  ument. To connec
+000021b0: 740a 746f 2061 2022 7365 6375 7265 2220  t.to a "secure" 
+000021c0: 7365 7276 6572 2079 6f75 2077 696c 6c20  server you will 
+000021d0: 6e65 6564 2061 6e20 5353 4c2f 544c 5320  need an SSL/TLS 
+000021e0: 6365 7274 6966 6963 6174 6520 736f 2074  certificate so t
+000021f0: 6861 7420 7468 6520 636c 6965 6e74 2063  hat the client c
+00002200: 616e 0a61 7574 6865 6e74 6963 6174 6520  an.authenticate 
+00002210: 7468 6520 7365 7276 6572 2e20 466f 7220  the server. For 
+00002220: 6465 7665 6c6f 706d 656e 742c 2079 6f75  development, you
+00002230: 2063 616e 2065 6974 6865 7220 7573 6520   can either use 
+00002240: 7468 6520 5353 4c2f 544c 5320 6365 7274  the SSL/TLS cert
+00002250: 6966 6963 6174 650a 6f66 2074 6865 2063  ificate.of the c
+00002260: 6572 7469 6669 6361 7465 2061 7574 686f  ertificate autho
+00002270: 7269 7479 2075 7365 6420 746f 2063 7265  rity used to cre
+00002280: 6174 6520 7468 6520 7365 7276 6572 2773  ate the server's
+00002290: 2063 6572 7469 6669 6361 7465 2c20 6f72   certificate, or
+000022a0: 2077 6865 6e20 7573 696e 6720 610a 7369   when using a.si
+000022b0: 6e67 6c65 2d6e 6f64 6520 636c 7573 7465  ngle-node cluste
+000022c0: 722c 2079 6f75 2063 616e 2075 7365 2074  r, you can use t
+000022d0: 6865 2073 6572 7665 7220 6365 7274 6966  he server certif
+000022e0: 6963 6174 6520 6974 7365 6c66 2e20 596f  icate itself. Yo
+000022f0: 7520 6361 6e20 6765 7420 7468 650a 7365  u can get the.se
+00002300: 7276 6572 2063 6572 7469 6669 6361 7465  rver certificate
+00002310: 2077 6974 6820 7468 6520 666f 6c6c 6f77   with the follow
+00002320: 696e 6720 5079 7468 6f6e 2063 6f64 652e  ing Python code.
+00002330: 0a0a 0a60 6060 7079 7468 6f6e 0a69 6d70  ...```python.imp
+00002340: 6f72 7420 7373 6c0a 0a73 6572 7665 725f  ort ssl..server_
+00002350: 6365 7274 6966 6963 6174 6520 3d20 7373  certificate = ss
+00002360: 6c2e 6765 745f 7365 7276 6572 5f63 6572  l.get_server_cer
+00002370: 7469 6669 6361 7465 2861 6464 723d 2827  tificate(addr=('
+00002380: 6c6f 6361 6c68 6f73 7427 2c20 3231 3133  localhost', 2113
+00002390: 2929 0a60 6060 0a0a 596f 7520 6361 6e20  )).```..You can 
+000023a0: 616c 736f 2073 7461 7274 2061 6e20 2269  also start an "i
+000023b0: 6e73 6563 7572 6522 2073 6572 7665 7220  nsecure" server 
+000023c0: 7573 696e 6720 7468 6520 666f 6c6c 6f77  using the follow
+000023d0: 696e 6720 636f 6d6d 616e 642e 0a0a 2020  ing command...  
+000023e0: 2020 2420 646f 636b 6572 2072 756e 202d    $ docker run -
+000023f0: 6420 2d2d 6e61 6d65 2065 7665 6e74 7374  d --name eventst
+00002400: 6f72 6564 622d 696e 7365 6375 7265 202d  oredb-insecure -
+00002410: 6974 202d 7020 3231 3134 3a32 3131 3320  it -p 2114:2113 
+00002420: 6576 656e 7473 746f 7265 2f65 7665 6e74  eventstore/event
+00002430: 7374 6f72 653a 3231 2e31 302e 392d 6275  store:21.10.9-bu
+00002440: 7374 6572 2d73 6c69 6d20 2d2d 696e 7365  ster-slim --inse
+00002450: 6375 7265 0a0a 5468 6520 636f 6e6e 6563  cure..The connec
+00002460: 7469 6f6e 2073 7472 696e 6720 5552 4920  tion string URI 
+00002470: 666f 7220 7468 6973 2022 696e 7365 6375  for this "insecu
+00002480: 7265 2220 7365 7276 6572 2077 6f75 6c64  re" server would
+00002490: 2062 653a 0a0a 2020 2020 6573 6462 3a2f   be:..    esdb:/
+000024a0: 2f6c 6f63 616c 686f 7374 3a32 3131 343f  /localhost:2114?
+000024b0: 546c 733d 6661 6c73 650a 0a41 7320 7765  Tls=false..As we
+000024c0: 2077 696c 6c20 7365 652c 2077 6865 6e20   will see, when 
+000024d0: 636f 6e6e 6563 7469 6e67 2074 6f20 616e  connecting to an
+000024e0: 2022 696e 7365 6375 7265 2220 7365 7276   "insecure" serv
+000024f0: 6572 2c20 7468 6572 6520 6973 206e 6f20  er, there is no 
+00002500: 6e65 6564 2074 6f20 696e 636c 7564 650a  need to include.
+00002510: 6120 2275 7365 726e 616d 6522 2061 6e64  a "username" and
+00002520: 2061 2022 7061 7373 776f 7264 2220 696e   a "password" in
+00002530: 2074 6865 2063 6f6e 6e65 6374 696f 6e20   the connection 
+00002540: 7374 7269 6e67 2e20 4966 2079 6f75 2064  string. If you d
+00002550: 6f2c 2074 6865 7365 2076 616c 7565 7320  o, these values 
+00002560: 7769 6c6c 0a62 6520 6967 6e6f 7265 6420  will.be ignored 
+00002570: 6279 2074 6865 2063 6c69 656e 742c 2073  by the client, s
+00002580: 6f20 7468 6174 2074 6865 7920 7769 6c6c  o that they will
+00002590: 206e 6f74 2062 6520 7365 6e74 2074 6f20   not be sent to 
+000025a0: 7468 6520 7365 7276 6572 206f 7665 7220  the server over 
+000025b0: 616e 0a69 6e73 6563 7572 6520 6368 616e  an.insecure chan
+000025c0: 6e65 6c2e 0a0a 506c 6561 7365 206e 6f74  nel...Please not
+000025d0: 652c 2074 6865 2022 696e 7365 6375 7265  e, the "insecure
+000025e0: 2220 636f 6e6e 6563 7469 6f6e 2073 7472  " connection str
+000025f0: 696e 6720 7573 6573 2061 2071 7565 7279  ing uses a query
+00002600: 2073 7472 696e 6720 7769 7468 2074 6865   string with the
+00002610: 2066 6965 6c64 2d76 616c 7565 0a60 546c   field-value.`Tl
+00002620: 733d 6661 6c73 6560 2e20 5468 6520 7661  s=false`. The va
+00002630: 6c75 6520 6f66 2074 6869 7320 6669 656c  lue of this fiel
+00002640: 6420 6973 2062 7920 6465 6661 756c 7420  d is by default 
+00002650: 6074 7275 6560 2e20 5365 6520 7468 6520  `true`. See the 
+00002660: 4e6f 7465 7320 7365 6374 696f 6e20 6265  Notes section be
+00002670: 6c6f 770a 666f 7220 6d6f 7265 2069 6e66  low.for more inf
+00002680: 6f72 6d61 7469 6f6e 2061 626f 7574 2045  ormation about E
+00002690: 7665 6e74 5374 6f72 6544 4220 636f 6e6e  ventStoreDB conn
+000026a0: 6563 7469 6f6e 2073 7472 696e 6773 2061  ection strings a
+000026b0: 6e64 2074 6865 2066 6965 6c64 7320 7468  nd the fields th
+000026c0: 6174 2063 616e 2062 650a 7573 6564 2069  at can be.used i
+000026d0: 6e20 7468 6520 7175 6572 7920 7374 7269  n the query stri
+000026e0: 6e67 2074 6f20 7370 6563 6966 7920 636f  ng to specify co
+000026f0: 6e6e 6563 7469 6f6e 206f 7074 696f 6e73  nnection options
+00002700: 2e0a 0a23 2323 2053 746f 7020 636f 6e74  ...### Stop cont
+00002710: 6169 6e65 720a 0a54 6f20 7374 6f70 2061  ainer..To stop a
+00002720: 6e64 2072 656d 6f76 6520 7468 6520 2273  nd remove the "s
+00002730: 6563 7572 6522 2063 6f6e 7461 696e 6572  ecure" container
+00002740: 2c20 7573 6520 7468 6520 666f 6c6c 6f77  , use the follow
+00002750: 696e 6720 446f 636b 6572 2063 6f6d 6d61  ing Docker comma
+00002760: 6e64 732e 0a0a 2020 2020 2420 646f 636b  nds...    $ dock
+00002770: 6572 2073 746f 7020 6576 656e 7473 746f  er stop eventsto
+00002780: 7265 6462 2d73 6563 7572 650a 0924 2064  redb-secure..$ d
+00002790: 6f63 6b65 7220 726d 2065 7665 6e74 7374  ocker rm eventst
+000027a0: 6f72 6564 622d 7365 6375 7265 0a0a 546f  oredb-secure..To
+000027b0: 2073 746f 7020 616e 6420 7265 6d6f 7665   stop and remove
+000027c0: 2074 6865 2022 696e 7365 6375 7265 2220   the "insecure" 
+000027d0: 636f 6e74 6169 6e65 722c 2075 7365 2074  container, use t
+000027e0: 6865 2066 6f6c 6c6f 7769 6e67 2044 6f63  he following Doc
+000027f0: 6b65 7220 636f 6d6d 616e 6473 2e0a 0a20  ker commands... 
+00002800: 2020 2024 2064 6f63 6b65 7220 7374 6f70     $ docker stop
+00002810: 2065 7665 6e74 7374 6f72 6564 622d 696e   eventstoredb-in
+00002820: 7365 6375 7265 0a09 2420 646f 636b 6572  secure..$ docker
+00002830: 2072 6d20 6576 656e 7473 746f 7265 6462   rm eventstoredb
+00002840: 2d69 6e73 6563 7572 650a 0a0a 2323 2045  -insecure...## E
+00002850: 7665 6e74 5374 6f72 6544 4220 636c 6965  ventStoreDB clie
+00002860: 6e74 0a0a 5468 6973 2045 7665 6e74 5374  nt..This EventSt
+00002870: 6f72 6544 4220 636c 6965 6e74 2069 7320  oreDB client is 
+00002880: 696d 706c 656d 656e 7465 6420 696e 2074  implemented in t
+00002890: 6865 2060 6573 6462 636c 6965 6e74 6020  he `esdbclient` 
+000028a0: 7061 636b 6167 6520 7769 7468 0a74 6865  package with.the
+000028b0: 2060 4553 4442 436c 6965 6e74 6020 636c   `ESDBClient` cl
+000028c0: 6173 732e 0a0a 2323 2320 496d 706f 7274  ass...### Import
+000028d0: 2063 6c61 7373 0a0a 5468 6520 6045 5344   class..The `ESD
+000028e0: 4243 6c69 656e 7460 2063 6c61 7373 2063  BClient` class c
+000028f0: 616e 2062 6520 696d 706f 7274 6564 2066  an be imported f
+00002900: 726f 6d20 7468 6520 6065 7364 6263 6c69  rom the `esdbcli
+00002910: 656e 7460 2070 6163 6b61 6765 2e0a 0a60  ent` package...`
+00002920: 6060 7079 7468 6f6e 0a66 726f 6d20 6573  ``python.from es
+00002930: 6462 636c 6965 6e74 2069 6d70 6f72 7420  dbclient import 
+00002940: 4553 4442 436c 6965 6e74 0a60 6060 0a0a  ESDBClient.```..
+00002950: 2323 2320 436f 6e73 7472 7563 7420 636c  ### Construct cl
+00002960: 6965 6e74 0a0a 5468 6520 6045 5344 4243  ient..The `ESDBC
+00002970: 6c69 656e 7460 2063 6c61 7373 2063 616e  lient` class can
+00002980: 2062 6520 636f 6e73 7472 7563 7465 6420   be constructed 
+00002990: 7769 7468 2061 2060 7572 6960 2061 7267  with a `uri` arg
+000029a0: 756d 656e 742c 2077 6869 6368 2069 7320  ument, which is 
+000029b0: 7265 7175 6972 6564 2e0a 416e 642c 2074  required..And, t
+000029c0: 6f20 636f 6e6e 6563 7420 746f 2061 2022  o connect to a "
+000029d0: 7365 6375 7265 2220 4576 656e 7453 746f  secure" EventSto
+000029e0: 7265 4442 2073 6572 7665 722c 2074 6865  reDB server, the
+000029f0: 206f 7074 696f 6e61 6c20 6072 6f6f 745f   optional `root_
+00002a00: 6365 7274 6966 6963 6174 6573 600a 6172  certificates`.ar
+00002a10: 6775 6d65 6e74 2069 7320 616c 736f 2072  gument is also r
+00002a20: 6571 7569 7265 642e 0a0a 5468 6520 6075  equired...The `u
+00002a30: 7269 6020 6172 6775 6d65 6e74 2069 7320  ri` argument is 
+00002a40: 6578 7065 6374 6564 2074 6f20 6265 2061  expected to be a
+00002a50: 6e20 4576 656e 7453 746f 7265 4442 2063  n EventStoreDB c
+00002a60: 6f6e 6e65 6374 696f 6e20 7374 7269 6e67  onnection string
+00002a70: 2055 5249 2074 6861 740a 636f 6e66 6f72   URI that.confor
+00002a80: 6d73 2077 6974 6820 7468 6520 7374 616e  ms with the stan
+00002a90: 6461 7264 2045 7665 6e74 5374 6f72 6544  dard EventStoreD
+00002aa0: 4220 2265 7364 6222 206f 7220 2265 7364  B "esdb" or "esd
+00002ab0: 622b 6469 7363 6f76 6572 2220 5552 4920  b+discover" URI 
+00002ac0: 7363 6865 6d65 732e 2054 6865 0a73 796e  schemes. The.syn
+00002ad0: 7461 7820 616e 6420 7365 6d61 6e74 6963  tax and semantic
+00002ae0: 7320 6f66 2045 7665 6e74 5374 6f72 6544  s of EventStoreD
+00002af0: 4220 636f 6e6e 6563 7469 6f6e 2073 7472  B connection str
+00002b00: 696e 6773 2061 7265 2065 7870 6c61 696e  ings are explain
+00002b10: 6564 2069 6e20 7468 6520 4e6f 7465 730a  ed in the Notes.
+00002b20: 7365 6374 696f 6e20 6265 6c6f 772e 0a0a  section below...
+00002b30: 466f 7220 6578 616d 706c 652c 2074 6865  For example, the
+00002b40: 2066 6f6c 6c6f 7769 6e67 2063 6f6e 6e65   following conne
+00002b50: 6374 696f 6e20 7374 7269 6e67 2073 7065  ction string spe
+00002b60: 6369 6669 6573 2074 6861 7420 7468 6520  cifies that the 
+00002b70: 636c 6965 6e74 2073 686f 756c 640a 6174  client should.at
+00002b80: 7465 6d70 7420 746f 2063 7265 6174 6520  tempt to create 
+00002b90: 6120 2273 6563 7572 6522 2063 6f6e 6e65  a "secure" conne
+00002ba0: 6374 696f 6e20 746f 2070 6f72 7420 3231  ction to port 21
+00002bb0: 3133 206f 6e20 226c 6f63 616c 686f 7374  13 on "localhost
+00002bc0: 222c 2061 6e64 2075 7365 2074 6865 0a63  ", and use the.c
+00002bd0: 6c69 656e 7420 6372 6564 656e 7469 616c  lient credential
+00002be0: 7320 2275 7365 726e 616d 6522 2061 6e64  s "username" and
+00002bf0: 2022 7061 7373 776f 7264 2220 7768 656e   "password" when
+00002c00: 206d 616b 696e 6720 6361 6c6c 7320 746f   making calls to
+00002c10: 2074 6865 2073 6572 7665 722e 0a0a 2020   the server...  
+00002c20: 2020 6573 6462 3a2f 2f75 7365 726e 616d    esdb://usernam
+00002c30: 653a 7061 7373 776f 7264 406c 6f63 616c  e:password@local
+00002c40: 686f 7374 3a32 3131 333f 546c 733d 7472  host:2113?Tls=tr
+00002c50: 7565 0a0a 5468 6520 636c 6965 6e74 206d  ue..The client m
+00002c60: 7573 7420 6265 2063 6f6e 6669 6775 7265  ust be configure
+00002c70: 6420 746f 2063 7265 6174 6520 6120 2273  d to create a "s
+00002c80: 6563 7572 6522 2063 6f6e 6e65 6374 696f  ecure" connectio
+00002c90: 6e20 746f 2061 2022 7365 6375 7265 2220  n to a "secure" 
+00002ca0: 7365 7276 6572 2c0a 6f72 2061 6c74 6572  server,.or alter
+00002cb0: 6e61 7469 7665 6c79 2061 6e20 2269 6e73  natively an "ins
+00002cc0: 6563 7572 6522 2063 6f6e 6e65 6374 696f  ecure" connectio
+00002cd0: 6e20 746f 2061 6e20 2269 6e73 6563 7572  n to an "insecur
+00002ce0: 6522 2073 6572 7665 722e 2042 7920 6465  e" server. By de
+00002cf0: 6661 756c 742c 2074 6865 0a63 6c69 656e  fault, the.clien
+00002d00: 7420 7769 6c6c 2061 7474 656d 7074 2074  t will attempt t
+00002d10: 6f20 6372 6561 7465 2061 2022 7365 6375  o create a "secu
+00002d20: 7265 2220 636f 6e6e 6563 7469 6f6e 2e20  re" connection. 
+00002d30: 416e 6420 736f 2c20 7768 656e 2063 6f6e  And so, when con
+00002d40: 6e65 6374 696e 6720 746f 2061 6e0a 2269  necting to an."i
+00002d50: 6e73 6563 7572 6522 2073 6572 7665 722c  nsecure" server,
+00002d60: 2074 6865 2063 6f6e 6e65 6374 696f 6e20   the connection 
+00002d70: 7374 7269 6e67 206d 7573 7420 7370 6563  string must spec
+00002d80: 6966 7920 7468 6174 2074 6865 2063 6c69  ify that the cli
+00002d90: 656e 7420 7368 6f75 6c64 2061 7474 656d  ent should attem
+00002da0: 7074 0a74 6f20 6d61 6b65 2061 6e20 2269  pt.to make an "i
+00002db0: 6e73 6563 7572 6522 2063 6f6e 6e65 6374  nsecure" connect
+00002dc0: 696f 6e2e 0a0a 5468 6520 666f 6c6c 6f77  ion...The follow
+00002dd0: 696e 6720 636f 6e6e 6563 7469 6f6e 2073  ing connection s
+00002de0: 7472 696e 6720 7370 6563 6966 6965 7320  tring specifies 
+00002df0: 7468 6174 2074 6865 2063 6c69 656e 7420  that the client 
+00002e00: 7368 6f75 6c64 0a61 7474 656d 7074 2074  should.attempt t
+00002e10: 6f20 6372 6561 7465 2061 6e20 2269 6e73  o create an "ins
+00002e20: 6563 7572 6522 2063 6f6e 6e65 6374 696f  ecure" connectio
+00002e30: 6e20 746f 2070 6f72 7420 3231 3134 206f  n to port 2114 o
+00002e40: 6e20 226c 6f63 616c 686f 7374 222e 0a57  n "localhost"..W
+00002e50: 6865 6e20 636f 6e6e 6563 7469 6e67 2074  hen connecting t
+00002e60: 6f20 616e 2022 696e 7365 6375 7265 2220  o an "insecure" 
+00002e70: 7365 7276 6572 2c20 7468 6520 636c 6965  server, the clie
+00002e80: 6e74 2077 696c 6c20 6967 6e6f 7265 2061  nt will ignore a
+00002e90: 6e79 0a75 7365 726e 616d 6520 616e 6420  ny.username and 
+00002ea0: 7061 7373 776f 7264 2069 6e66 6f72 6d61  password informa
+00002eb0: 7469 6f6e 2069 6e63 6c75 6465 6420 696e  tion included in
+00002ec0: 2074 6865 2063 6f6e 6e65 6374 696f 6e20   the connection 
+00002ed0: 7374 7269 6e67 2c0a 736f 2074 6861 7420  string,.so that 
+00002ee0: 7573 6572 6e61 6d65 7320 616e 6420 7061  usernames and pa
+00002ef0: 7373 776f 7264 7320 6172 6520 6e6f 7420  sswords are not 
+00002f00: 7365 6e74 206f 7665 7220 616e 2022 696e  sent over an "in
+00002f10: 7365 6375 7265 2220 636f 6e6e 6563 7469  secure" connecti
+00002f20: 6f6e 2e0a 0a20 2020 2065 7364 623a 2f2f  on...    esdb://
+00002f30: 6c6f 6361 6c68 6f73 743a 3231 3134 3f54  localhost:2114?T
+00002f40: 6c73 3d66 616c 7365 0a0a 506c 6561 7365  ls=false..Please
+00002f50: 206e 6f74 652c 2074 6865 2022 696e 7365   note, the "inse
+00002f60: 6375 7265 2220 636f 6e6e 6563 7469 6f6e  cure" connection
+00002f70: 2073 7472 696e 6720 7573 6573 2061 2071   string uses a q
+00002f80: 7565 7279 2073 7472 696e 6720 7769 7468  uery string with
+00002f90: 2074 6865 2066 6965 6c64 2d76 616c 7565   the field-value
+00002fa0: 0a60 546c 733d 6661 6c73 6560 2e20 5468  .`Tls=false`. Th
+00002fb0: 6520 7661 6c75 6520 6f66 2074 6869 7320  e value of this 
+00002fc0: 6669 656c 6420 6973 2062 7920 6465 6661  field is by defa
+00002fd0: 756c 7420 6074 7275 6560 2e20 556e 6c65  ult `true`. Unle
+00002fe0: 7373 2074 6865 2063 6f6e 6e65 6374 696f  ss the connectio
+00002ff0: 6e20 7374 7269 6e67 0a55 5249 2069 6e63  n string.URI inc
+00003000: 6c75 6465 7320 7468 6520 6669 656c 642d  ludes the field-
+00003010: 7661 6c75 6520 6054 6c73 3d66 616c 7365  value `Tls=false
+00003020: 6020 696e 2074 6865 2071 7565 7279 2073  ` in the query s
+00003030: 7472 696e 672c 2074 6865 2060 726f 6f74  tring, the `root
+00003040: 5f63 6572 7469 6669 6361 7465 7360 0a63  _certificates`.c
+00003050: 6f6e 7374 7275 6374 6f72 2061 7267 756d  onstructor argum
+00003060: 656e 7420 6973 2061 6c73 6f20 7265 7175  ent is also requ
+00003070: 6972 6564 2e0a 0a57 6865 6e20 636f 6e6e  ired...When conn
+00003080: 6563 7469 6e67 2074 6f20 6120 2273 6563  ecting to a "sec
+00003090: 7572 6522 2073 6572 7665 722c 2074 6865  ure" server, the
+000030a0: 2060 726f 6f74 5f63 6572 7469 6669 6361   `root_certifica
+000030b0: 7465 7360 2061 7267 756d 656e 7420 6973  tes` argument is
+000030c0: 2065 7870 6563 7465 6420 746f 0a62 6520   expected to.be 
+000030d0: 6120 5079 7468 6f6e 2060 7374 7260 2063  a Python `str` c
+000030e0: 6f6e 7461 696e 696e 6720 5045 4d20 656e  ontaining PEM en
+000030f0: 636f 6465 6420 5353 4c2f 544c 5320 726f  coded SSL/TLS ro
+00003100: 6f74 2063 6572 7469 6669 6361 7465 732e  ot certificates.
+00003110: 2054 6869 7320 7661 6c75 6520 6973 0a70   This value is.p
+00003120: 6173 7365 6420 6469 7265 6374 6c79 2074  assed directly t
+00003130: 6f20 6067 7270 632e 7373 6c5f 6368 616e  o `grpc.ssl_chan
+00003140: 6e65 6c5f 6372 6564 656e 7469 616c 7328  nel_credentials(
+00003150: 2960 2e20 4974 2069 7320 7573 6564 2066  )`. It is used f
+00003160: 6f72 2061 7574 6865 6e74 6963 6174 696e  or authenticatin
+00003170: 6720 7468 650a 7365 7276 6572 2074 6f20  g the.server to 
+00003180: 7468 6520 636c 6965 6e74 2e20 4974 2069  the client. It i
+00003190: 7320 636f 6d6d 6f6e 6c79 2074 6865 2063  s commonly the c
+000031a0: 6572 7469 6669 6361 7465 206f 6620 7468  ertificate of th
+000031b0: 6520 6365 7274 6966 6963 6174 6520 6175  e certificate au
+000031c0: 7468 6f72 6974 7920 7468 6174 0a77 6173  thority that.was
+000031d0: 2072 6573 706f 6e73 6962 6c65 2066 6f72   responsible for
+000031e0: 2067 656e 6572 6174 696e 6720 7468 6520   generating the 
+000031f0: 5353 4c2f 544c 5320 6365 7274 6966 6963  SSL/TLS certific
+00003200: 6174 6520 7573 6564 2062 7920 7468 6520  ate used by the 
+00003210: 4576 656e 7453 746f 7265 4442 2073 6572  EventStoreDB ser
+00003220: 7665 722e 0a42 7574 2c20 616c 7465 726e  ver..But, altern
+00003230: 6174 6976 656c 7920 666f 7220 6465 7665  atively for deve
+00003240: 6c6f 706d 656e 742c 2079 6f75 2063 616e  lopment, you can
+00003250: 2075 7365 2074 6865 2073 6572 7665 7227   use the server'
+00003260: 7320 6365 7274 6966 6963 6174 6520 6974  s certificate it
+00003270: 7365 6c66 2e0a 0a49 6e20 7468 6520 6578  self...In the ex
+00003280: 616d 706c 6520 6265 6c6f 772c 2074 6865  ample below, the
+00003290: 2063 6f6e 7374 7275 6374 6f72 2061 7267   constructor arg
+000032a0: 756d 656e 7420 7661 6c75 6573 2061 7265  ument values are
+000032b0: 2074 616b 656e 2066 726f 6d20 7468 6520   taken from the 
+000032c0: 6f70 6572 6174 696e 670a 7379 7374 656d  operating.system
+000032d0: 2065 6e76 6972 6f6e 6d65 6e74 2e20 5468   environment. Th
+000032e0: 6973 2069 7320 6120 7479 7069 6361 6c20  is is a typical 
+000032f0: 6172 7261 6e67 656d 656e 7420 696e 2061  arrangement in a
+00003300: 2070 726f 6475 6374 696f 6e20 656e 7669   production envi
+00003310: 726f 6e6d 656e 742e 2049 7420 6973 0a64  ronment. It is.d
+00003320: 6f6e 6520 7468 6973 2077 6179 2068 6572  one this way her
+00003330: 6520 736f 2074 6861 7420 7468 6520 636f  e so that the co
+00003340: 6465 2069 6e20 7468 6973 2064 6f63 756d  de in this docum
+00003350: 656e 7461 7469 6f6e 2063 616e 2062 6520  entation can be 
+00003360: 7465 7374 6564 2077 6974 6820 626f 7468  tested with both
+00003370: 0a61 2022 7365 6375 7265 2220 616e 6420  .a "secure" and 
+00003380: 616e 2022 696e 7365 6375 7265 2220 7365  an "insecure" se
+00003390: 7276 6572 2e0a 0a60 6060 7079 7468 6f6e  rver...```python
+000033a0: 0a69 6d70 6f72 7420 6f73 0a0a 636c 6965  .import os..clie
+000033b0: 6e74 203d 2045 5344 4243 6c69 656e 7428  nt = ESDBClient(
+000033c0: 0a20 2020 2075 7269 3d6f 732e 6765 7465  .    uri=os.gete
+000033d0: 6e76 2822 4553 4442 5f55 5249 2229 2c0a  nv("ESDB_URI"),.
+000033e0: 2020 2020 726f 6f74 5f63 6572 7469 6669      root_certifi
+000033f0: 6361 7465 733d 6f73 2e67 6574 656e 7628  cates=os.getenv(
+00003400: 2245 5344 425f 524f 4f54 5f43 4552 5449  "ESDB_ROOT_CERTI
+00003410: 4649 4341 5445 5322 292c 0a29 0a60 6060  FICATES"),.).```
+00003420: 0a0a 5365 6520 7468 6520 4e6f 7465 7320  ..See the Notes 
+00003430: 7365 6374 696f 6e20 6265 6c6f 7720 666f  section below fo
+00003440: 7220 6465 7461 696c 6564 2069 6e66 6f72  r detailed infor
+00003450: 6d61 7469 6f6e 2061 626f 7574 2045 7665  mation about Eve
+00003460: 6e74 5374 6f72 6544 4220 636f 6e6e 6563  ntStoreDB connec
+00003470: 7469 6f6e 0a73 7472 696e 6773 2061 6e64  tion.strings and
+00003480: 2074 6865 2066 6965 6c64 7320 7468 6174   the fields that
+00003490: 2063 616e 2062 6520 7573 6564 2069 6e20   can be used in 
+000034a0: 7468 6520 7175 6572 7920 7374 7269 6e67  the query string
+000034b0: 2074 6f20 7370 6563 6966 7920 636f 6e6e   to specify conn
+000034c0: 6563 7469 6f6e 0a6f 7074 696f 6e73 2e0a  ection.options..
+000034d0: 0a23 2320 5374 7265 616d 730a 0a49 6e20  .## Streams..In 
+000034e0: 4576 656e 7453 746f 7265 4442 2c20 6120  EventStoreDB, a 
+000034f0: 2273 7472 6561 6d22 2069 7320 6120 7365  "stream" is a se
+00003500: 7175 656e 6365 206f 6620 7265 636f 7264  quence of record
+00003510: 6564 2065 7665 6e74 7320 7468 6174 2061  ed events that a
+00003520: 6c6c 2068 6176 650a 7468 6520 7361 6d65  ll have.the same
+00003530: 2022 7374 7265 616d 206e 616d 6522 2e20   "stream name". 
+00003540: 5468 6572 6520 7769 6c6c 206e 6f72 6d61  There will norma
+00003550: 6c6c 7920 6265 206d 616e 7920 7374 7265  lly be many stre
+00003560: 616d 7320 696e 2061 2064 6174 6162 6173  ams in a databas
+00003570: 652e 0a45 6163 6820 7265 636f 7264 6564  e..Each recorded
+00003580: 2065 7665 6e74 2068 6173 2061 2022 7374   event has a "st
+00003590: 7265 616d 2070 6f73 6974 696f 6e22 2069  ream position" i
+000035a0: 6e20 6974 7320 7374 7265 616d 2c20 616e  n its stream, an
+000035b0: 6420 6120 2263 6f6d 6d69 7420 706f 7369  d a "commit posi
+000035c0: 7469 6f6e 220a 696e 2074 6865 2064 6174  tion".in the dat
+000035d0: 6162 6173 652e 2054 6865 2073 7472 6561  abase. The strea
+000035e0: 6d20 706f 7369 7469 6f6e 7320 6f66 2074  m positions of t
+000035f0: 6865 2072 6563 6f72 6465 6420 6576 656e  he recorded even
+00003600: 7473 2069 6e20 6120 7374 7265 616d 2069  ts in a stream i
+00003610: 7320 6120 6761 706c 6573 730a 7365 7175  s a gapless.sequ
+00003620: 656e 6365 2073 7461 7274 696e 6720 6672  ence starting fr
+00003630: 6f6d 207a 6572 6f2e 2054 6865 2063 6f6d  om zero. The com
+00003640: 6d69 7420 706f 7369 7469 6f6e 7320 6f66  mit positions of
+00003650: 2074 6865 2072 6563 6f72 6465 6420 6576   the recorded ev
+00003660: 656e 7473 2069 6e20 7468 6520 6461 7461  ents in the data
+00003670: 6261 7365 0a66 6f72 6d20 6120 7365 7175  base.form a sequ
+00003680: 656e 6365 2074 6861 7420 6973 206e 6f74  ence that is not
+00003690: 2067 6170 6c65 7373 2e0a 0a54 6865 206d   gapless...The m
+000036a0: 6574 686f 6473 2060 6170 7065 6e64 5f65  ethods `append_e
+000036b0: 7665 6e74 7328 2960 2c20 6072 6561 645f  vents()`, `read_
+000036c0: 7374 7265 616d 5f65 7665 6e74 7328 2960  stream_events()`
+000036d0: 2061 6e64 2060 7265 6164 5f61 6c6c 5f65   and `read_all_e
+000036e0: 7665 6e74 7328 2960 2063 616e 0a62 6520  vents()` can.be 
+000036f0: 7573 6564 2074 6f20 7265 636f 7264 2061  used to record a
+00003700: 6e64 2072 6561 6420 6576 656e 7473 2069  nd read events i
+00003710: 6e20 7468 6520 6461 7461 6261 7365 2e0a  n the database..
+00003720: 0a23 2323 2041 7070 656e 6420 6576 656e  .### Append even
+00003730: 7473 0a0a 2a72 6571 7569 7265 7320 6c65  ts..*requires le
+00003740: 6164 6572 2a0a 0a54 6865 2060 6170 7065  ader*..The `appe
+00003750: 6e64 5f65 7665 6e74 7328 2960 206d 6574  nd_events()` met
+00003760: 686f 6420 6361 6e20 6265 2075 7365 6420  hod can be used 
+00003770: 746f 2077 7269 7465 2061 2073 6571 7565  to write a seque
+00003780: 6e63 6520 6f66 206e 6577 2065 7665 6e74  nce of new event
+00003790: 7320 6174 6f6d 6963 616c 6c79 0a74 6f20  s atomically.to 
+000037a0: 6120 2273 7472 6561 6d22 2e20 5772 6974  a "stream". Writ
+000037b0: 696e 6720 6e65 7720 6576 656e 7473 2065  ing new events e
+000037c0: 6974 6865 7220 6372 6561 7465 7320 6120  ither creates a 
+000037d0: 7374 7265 616d 2c20 6f72 2061 7070 656e  stream, or appen
+000037e0: 6473 2065 7665 6e74 7320 746f 2074 6865  ds events to the
+000037f0: 2065 6e64 0a6f 6620 6120 7374 7265 616d   end.of a stream
+00003800: 2e20 5468 6973 206d 6574 686f 6420 6973  . This method is
+00003810: 2069 6465 6d70 6f74 656e 742e 0a0a 5468   idempotent...Th
+00003820: 6973 206d 6574 686f 6420 6361 6e20 6265  is method can be
+00003830: 2075 7365 6420 746f 2072 6563 6f72 6420   used to record 
+00003840: 6174 6f6d 6963 616c 6c79 2061 6c6c 2074  atomically all t
+00003850: 6865 206e 6577 0a65 7665 6e74 7320 7468  he new.events th
+00003860: 6174 2061 7265 2067 656e 6572 6174 6564  at are generated
+00003870: 2077 6865 6e20 6578 6563 7574 696e 6720   when executing 
+00003880: 6120 636f 6d6d 616e 6420 696e 2061 6e20  a command in an 
+00003890: 6170 706c 6963 6174 696f 6e2e 0a0a 5468  application...Th
+000038a0: 7265 6520 6172 6775 6d65 6e74 7320 6172  ree arguments ar
+000038b0: 6520 7265 7175 6972 6564 2c20 6073 7472  e required, `str
+000038c0: 6561 6d5f 6e61 6d65 602c 2060 6578 7065  eam_name`, `expe
+000038d0: 6374 6564 5f70 6f73 6974 696f 6e60 0a61  cted_position`.a
+000038e0: 6e64 2060 6576 656e 7473 602e 0a0a 5468  nd `events`...Th
+000038f0: 6520 6073 7472 6561 6d5f 6e61 6d65 6020  e `stream_name` 
+00003900: 6172 6775 6d65 6e74 2069 7320 7265 7175  argument is requ
+00003910: 6972 6564 2c20 616e 6420 6973 2065 7870  ired, and is exp
+00003920: 6563 7465 6420 746f 2062 6520 6120 5079  ected to be a Py
+00003930: 7468 6f6e 0a60 7374 7260 2074 6861 7420  thon.`str` that 
+00003940: 756e 6971 7565 6c79 2069 6465 6e74 6966  uniquely identif
+00003950: 6965 7320 7468 6520 7374 7265 616d 2069  ies the stream i
+00003960: 6e20 7468 6520 6461 7461 6261 7365 2e0a  n the database..
+00003970: 0a54 6865 2060 6578 7065 6374 6564 5f70  .The `expected_p
+00003980: 6f73 6974 696f 6e60 2061 7267 756d 656e  osition` argumen
+00003990: 7420 6973 2072 6571 7569 7265 642c 2069  t is required, i
+000039a0: 7320 6578 7065 6374 6564 2074 6f20 6265  s expected to be
+000039b0: 3a20 604e 6f6e 6560 0a69 6620 6576 656e  : `None`.if even
+000039c0: 7473 2061 7265 2062 6569 6e67 2077 7269  ts are being wri
+000039d0: 7474 656e 2074 6f20 6120 6e65 7720 7374  tten to a new st
+000039e0: 7265 616d 2c20 616e 6420 6f74 6865 7277  ream, and otherw
+000039f0: 6973 6520 616e 2050 7974 686f 6e20 6069  ise an Python `i
+00003a00: 6e74 600a 6571 7561 6c20 746f 2074 6865  nt`.equal to the
+00003a10: 2070 6f73 6974 696f 6e20 696e 2074 6865   position in the
+00003a20: 2073 7472 6561 6d20 6f66 2074 6865 206c   stream of the l
+00003a30: 6173 7420 7265 636f 7264 6564 2065 7665  ast recorded eve
+00003a40: 6e74 2069 6e20 7468 6520 7374 7265 616d  nt in the stream
+00003a50: 2e0a 0a54 6865 2060 6576 656e 7473 6020  ...The `events` 
+00003a60: 6172 6775 6d65 6e74 2069 7320 7265 7175  argument is requ
+00003a70: 6972 6564 2c20 616e 6420 6973 2065 7870  ired, and is exp
+00003a80: 6563 7465 6420 746f 2062 6520 6120 7365  ected to be a se
+00003a90: 7175 656e 6365 206f 6620 6e65 770a 6576  quence of new.ev
+00003aa0: 656e 7420 6f62 6a65 6374 7320 746f 2062  ent objects to b
+00003ab0: 6520 6170 7065 6e64 6564 2074 6f20 7468  e appended to th
+00003ac0: 6520 6e61 6d65 6420 7374 7265 616d 2e20  e named stream. 
+00003ad0: 5468 6520 604e 6577 4576 656e 7460 2063  The `NewEvent` c
+00003ae0: 6c61 7373 2073 686f 756c 640a 6265 2075  lass should.be u
+00003af0: 7365 6420 746f 2063 6f6e 7374 7275 6374  sed to construct
+00003b00: 206e 6577 2065 7665 6e74 206f 626a 6563   new event objec
+00003b10: 7473 2028 7365 6520 7468 6520 4e6f 7465  ts (see the Note
+00003b20: 7320 7365 6374 696f 6e20 6265 6c6f 7720  s section below 
+00003b30: 666f 7220 6465 7461 696c 730a 6f66 2074  for details.of t
+00003b40: 6869 7320 636c 6173 7329 2e0a 0a54 6869  his class)...Thi
+00003b50: 7320 6d65 7468 6f64 2074 616b 6573 2061  s method takes a
+00003b60: 6e20 6f70 7469 6f6e 616c 2060 7469 6d65  n optional `time
+00003b70: 6f75 7460 2061 7267 756d 656e 742c 2077  out` argument, w
+00003b80: 6869 6368 2069 7320 6120 5079 7468 6f6e  hich is a Python
+00003b90: 2060 666c 6f61 7460 2074 6861 7420 7365   `float` that se
+00003ba0: 7473 0a61 2064 6561 646c 696e 6520 666f  ts.a deadline fo
+00003bb0: 7220 7468 6520 636f 6d70 6c65 7469 6f6e  r the completion
+00003bc0: 206f 6620 7468 6520 6752 5043 206f 7065   of the gRPC ope
+00003bd0: 7261 7469 6f6e 2e0a 0a53 7472 6561 6d73  ration...Streams
+00003be0: 2061 7265 2063 7265 6174 6564 2062 7920   are created by 
+00003bf0: 7772 6974 696e 6720 6576 656e 7473 2e20  writing events. 
+00003c00: 5468 6520 636f 7272 6563 7420 7661 6c75  The correct valu
+00003c10: 6520 6f66 2074 6865 2060 6578 7065 6374  e of the `expect
+00003c20: 6564 5f70 6f73 6974 696f 6e60 0a61 7267  ed_position`.arg
+00003c30: 756d 656e 7420 7768 656e 2077 7269 7469  ument when writi
+00003c40: 6e67 2074 6865 2066 6972 7374 2065 7665  ng the first eve
+00003c50: 6e74 206f 6620 6120 6e65 7720 7374 7265  nt of a new stre
+00003c60: 616d 2069 7320 604e 6f6e 6560 2e20 506c  am is `None`. Pl
+00003c70: 6561 7365 206e 6f74 652c 2069 7420 6973  ease note, it is
+00003c80: 0a6e 6f74 2070 6f73 7369 626c 6520 746f  .not possible to
+00003c90: 2073 6f6d 6568 6f77 2063 7265 6174 6520   somehow create 
+00003ca0: 616e 2022 656d 7074 7922 2073 7472 6561  an "empty" strea
+00003cb0: 6d20 696e 2045 7665 6e74 5374 6f72 6544  m in EventStoreD
+00003cc0: 422e 0a0a 5468 6520 7374 7265 616d 2070  B...The stream p
+00003cd0: 6f73 6974 696f 6e73 206f 6620 7265 636f  ositions of reco
+00003ce0: 7264 6564 2065 7665 6e74 7320 696e 2061  rded events in a
+00003cf0: 2073 7472 6561 6d20 7374 6172 7420 6672   stream start fr
+00003d00: 6f6d 207a 6572 6f2c 2061 6e64 2066 6f72  om zero, and for
+00003d10: 6d20 6120 6761 706c 6573 730a 7365 7175  m a gapless.sequ
+00003d20: 656e 6365 206f 6620 696e 7465 6765 7273  ence of integers
+00003d30: 2e20 5468 6520 7374 7265 616d 2070 6f73  . The stream pos
+00003d40: 6974 696f 6e20 6f66 2074 6865 2066 6972  ition of the fir
+00003d50: 7374 2072 6563 6f72 6465 6420 6576 656e  st recorded even
+00003d60: 7420 696e 2061 2073 7472 6561 6d20 6973  t in a stream is
+00003d70: 0a60 3060 2e20 416e 6420 736f 2077 6865  .`0`. And so whe
+00003d80: 6e20 6170 7065 6e64 696e 6720 7468 6520  n appending the 
+00003d90: 7365 636f 6e64 206e 6577 2065 7665 6e74  second new event
+00003da0: 2074 6f20 6120 7374 7265 616d 2074 6861   to a stream tha
+00003db0: 7420 6861 7320 6f6e 6520 7265 636f 7264  t has one record
+00003dc0: 6564 2065 7665 6e74 2c0a 7468 6520 636f  ed event,.the co
+00003dd0: 7272 6563 7420 7661 6c75 6520 6f66 2074  rrect value of t
+00003de0: 6865 2060 6578 7065 6374 6564 5f70 6f73  he `expected_pos
+00003df0: 6974 696f 6e60 2061 7267 756d 656e 7420  ition` argument 
+00003e00: 6973 2060 3060 2e20 5369 6d69 6c61 726c  is `0`. Similarl
+00003e10: 792c 2074 6865 2073 7472 6561 6d0a 706f  y, the stream.po
+00003e20: 7369 7469 6f6e 206f 6620 7468 6520 7365  sition of the se
+00003e30: 636f 6e64 2072 6563 6f72 6465 6420 6576  cond recorded ev
+00003e40: 656e 7420 696e 2061 2073 7472 6561 6d20  ent in a stream 
+00003e50: 6973 2060 3160 2c20 616e 6420 736f 2077  is `1`, and so w
+00003e60: 6865 6e20 6170 7065 6e64 696e 6720 7468  hen appending th
+00003e70: 650a 7468 6972 6420 6e65 7720 6576 656e  e.third new even
+00003e80: 7420 746f 2061 2073 7472 6561 6d20 7468  t to a stream th
+00003e90: 6174 2068 6173 2074 776f 2072 6563 6f72  at has two recor
+00003ea0: 6465 6420 6576 656e 7473 2c20 7468 6520  ded events, the 
+00003eb0: 636f 7272 6563 7420 7661 6c75 6520 6f66  correct value of
+00003ec0: 2074 6865 0a60 6578 7065 6374 6564 5f70   the.`expected_p
+00003ed0: 6f73 6974 696f 6e60 2061 7267 756d 656e  osition` argumen
+00003ee0: 7420 6973 2060 3160 2e20 416e 6420 736f  t is `1`. And so
+00003ef0: 206f 6e2e 2e2e 0a0a 4966 2074 6865 7265   on.....If there
+00003f00: 2069 7320 6120 6d69 736d 6174 6368 2062   is a mismatch b
+00003f10: 6574 7765 656e 2074 6865 2067 6976 656e  etween the given
+00003f20: 2076 616c 7565 206f 6620 7468 6520 6065   value of the `e
+00003f30: 7870 6563 7465 645f 706f 7369 7469 6f6e  xpected_position
+00003f40: 6020 6172 6775 6d65 6e74 0a61 6e64 2074  ` argument.and t
+00003f50: 6865 2070 6f73 6974 696f 6e20 6f66 2074  he position of t
+00003f60: 6865 206c 6173 7420 7265 636f 7264 6564  he last recorded
+00003f70: 2065 7665 6e74 2069 6e20 6120 7374 7265   event in a stre
+00003f80: 616d 2c20 7468 656e 2061 6e20 6045 7870  am, then an `Exp
+00003f90: 6563 7465 6450 6f73 6974 696f 6e45 7272  ectedPositionErr
+00003fa0: 6f72 600a 6578 6365 7074 696f 6e20 7769  or`.exception wi
+00003fb0: 6c6c 2062 6520 7261 6973 6564 2e20 5468  ll be raised. Th
+00003fc0: 6973 2065 6666 6563 7469 7665 6c79 2061  is effectively a
+00003fd0: 6363 6f6d 706c 6973 6865 7320 6f70 7469  ccomplishes opti
+00003fe0: 6d69 7374 6963 2063 6f6e 6375 7272 656e  mistic concurren
+00003ff0: 6379 2063 6f6e 7472 6f6c 2e0a 0a49 6620  cy control...If 
+00004000: 796f 7520 7769 7368 2074 6f20 6469 7361  you wish to disa
+00004010: 626c 6520 6f70 7469 6d69 7374 6963 2063  ble optimistic c
+00004020: 6f6e 6375 7272 656e 6379 2063 6f6e 7472  oncurrency contr
+00004030: 6f6c 2077 6865 6e20 6170 7065 6e64 696e  ol when appendin
+00004040: 6720 6e65 7720 6576 656e 7473 2c20 796f  g new events, yo
+00004050: 750a 6361 6e20 7365 7420 7468 6520 6065  u.can set the `e
+00004060: 7870 6563 7465 645f 706f 7369 7469 6f6e  xpected_position
+00004070: 6020 746f 2061 206e 6567 6174 6976 6520  ` to a negative 
+00004080: 696e 7465 6765 722e 0a0a 4966 2079 6f75  integer...If you
+00004090: 206e 6565 6420 746f 2064 6973 636f 7665   need to discove
+000040a0: 7220 7468 6520 6375 7272 656e 7420 706f  r the current po
+000040b0: 7369 7469 6f6e 206f 6620 7468 6520 6c61  sition of the la
+000040c0: 7374 2072 6563 6f72 6465 6420 6576 656e  st recorded even
+000040d0: 7420 696e 2061 2073 7472 6561 6d2c 0a79  t in a stream,.y
+000040e0: 6f75 2063 616e 2075 7365 2074 6865 2060  ou can use the `
+000040f0: 6765 745f 7374 7265 616d 5f70 6f73 6974  get_stream_posit
+00004100: 696f 6e28 2960 206d 6574 686f 642e 0a0a  ion()` method...
+00004110: 506c 6561 7365 206e 6f74 652c 2074 6865  Please note, the
+00004120: 2061 7070 656e 6420 6576 656e 7473 206f   append events o
+00004130: 7065 7261 7469 6f6e 2069 7320 6174 6f6d  peration is atom
+00004140: 6963 2c20 736f 2074 6861 7420 6569 7468  ic, so that eith
+00004150: 6572 2061 6c6c 0a6f 7220 6e6f 6e65 206f  er all.or none o
+00004160: 6620 7468 6520 6769 7665 6e20 6e65 7720  f the given new 
+00004170: 6576 656e 7473 2077 696c 6c20 6265 2072  events will be r
+00004180: 6563 6f72 6465 642e 2042 7920 6465 7369  ecorded. By desi
+00004190: 676e 2c20 6974 2069 7320 6f6e 6c79 0a70  gn, it is only.p
+000041a0: 6f73 7369 626c 6520 7769 7468 2045 7665  ossible with Eve
+000041b0: 6e74 5374 6f72 6544 4220 746f 2061 746f  ntStoreDB to ato
+000041c0: 6d69 6361 6c6c 7920 7265 636f 7264 206e  mically record n
+000041d0: 6577 2065 7665 6e74 7320 696e 206f 6e65  ew events in one
+000041e0: 2073 7472 6561 6d2e 0a0a 496e 2074 6865   stream...In the
+000041f0: 2065 7861 6d70 6c65 2062 656c 6f77 2c20   example below, 
+00004200: 6120 6e65 7720 6576 656e 7420 6973 2061  a new event is a
+00004210: 7070 656e 6465 6420 746f 2061 206e 6577  ppended to a new
+00004220: 2073 7472 6561 6d2e 0a0a 6060 6070 7974   stream...```pyt
+00004230: 686f 6e0a 6672 6f6d 2075 7569 6420 696d  hon.from uuid im
+00004240: 706f 7274 2075 7569 6434 0a0a 6672 6f6d  port uuid4..from
+00004250: 2065 7364 6263 6c69 656e 7420 696d 706f   esdbclient impo
+00004260: 7274 204e 6577 4576 656e 740a 0a23 2043  rt NewEvent..# C
+00004270: 6f6e 7374 7275 6374 206e 6577 2065 7665  onstruct new eve
+00004280: 6e74 206f 626a 6563 742e 0a65 7665 6e74  nt object..event
+00004290: 3120 3d20 4e65 7745 7665 6e74 2874 7970  1 = NewEvent(typ
+000042a0: 653d 274f 7264 6572 4372 6561 7465 6427  e='OrderCreated'
+000042b0: 2c20 6461 7461 3d62 2764 6174 6131 2729  , data=b'data1')
+000042c0: 0a0a 2320 4465 6669 6e65 2073 7472 6561  ..# Define strea
+000042d0: 6d20 6e61 6d65 2e0a 7374 7265 616d 5f6e  m name..stream_n
+000042e0: 616d 6531 203d 2073 7472 2875 7569 6434  ame1 = str(uuid4
+000042f0: 2829 290a 0a23 2041 7070 656e 6420 6c69  ())..# Append li
+00004300: 7374 206f 6620 6576 656e 7473 2074 6f20  st of events to 
+00004310: 6e65 7720 7374 7265 616d 2e0a 636f 6d6d  new stream..comm
+00004320: 6974 5f70 6f73 6974 696f 6e31 203d 2063  it_position1 = c
+00004330: 6c69 656e 742e 6170 7065 6e64 5f65 7665  lient.append_eve
+00004340: 6e74 7328 0a20 2020 2073 7472 6561 6d5f  nts(.    stream_
+00004350: 6e61 6d65 3d73 7472 6561 6d5f 6e61 6d65  name=stream_name
+00004360: 312c 0a20 2020 2065 7870 6563 7465 645f  1,.    expected_
+00004370: 706f 7369 7469 6f6e 3d4e 6f6e 652c 0a20  position=None,. 
+00004380: 2020 2065 7665 6e74 733d 5b65 7665 6e74     events=[event
+00004390: 315d 2c0a 290a 6060 600a 0a49 6e20 7468  1],.).```..In th
+000043a0: 6520 6578 616d 706c 6520 6265 6c6f 772c  e example below,
+000043b0: 2074 776f 2073 7562 7365 7175 656e 7420   two subsequent 
+000043c0: 6576 656e 7473 2061 7265 2061 7070 656e  events are appen
+000043d0: 6465 6420 746f 2061 6e20 6578 6973 7469  ded to an existi
+000043e0: 6e67 0a73 7472 6561 6d2e 0a0a 6060 6070  ng.stream...```p
+000043f0: 7974 686f 6e0a 6576 656e 7432 203d 204e  ython.event2 = N
+00004400: 6577 4576 656e 7428 7479 7065 3d27 4f72  ewEvent(type='Or
+00004410: 6465 7255 7064 6174 6564 272c 2064 6174  derUpdated', dat
+00004420: 613d 6227 6461 7461 3227 290a 6576 656e  a=b'data2').even
+00004430: 7433 203d 204e 6577 4576 656e 7428 7479  t3 = NewEvent(ty
+00004440: 7065 3d27 4f72 6465 7244 656c 6574 6564  pe='OrderDeleted
+00004450: 272c 2064 6174 613d 6227 6461 7461 3327  ', data=b'data3'
+00004460: 290a 0a63 6f6d 6d69 745f 706f 7369 7469  )..commit_positi
+00004470: 6f6e 3220 3d20 636c 6965 6e74 2e61 7070  on2 = client.app
+00004480: 656e 645f 6576 656e 7473 280a 2020 2020  end_events(.    
+00004490: 7374 7265 616d 5f6e 616d 653d 7374 7265  stream_name=stre
+000044a0: 616d 5f6e 616d 6531 2c0a 2020 2020 6578  am_name1,.    ex
+000044b0: 7065 6374 6564 5f70 6f73 6974 696f 6e3d  pected_position=
+000044c0: 302c 0a20 2020 2065 7665 6e74 733d 5b65  0,.    events=[e
+000044d0: 7665 6e74 322c 2065 7665 6e74 335d 2c0a  vent2, event3],.
+000044e0: 290a 6060 600a 0a49 6620 7468 6520 6f70  ).```..If the op
+000044f0: 6572 6174 696f 6e20 6973 2073 7563 6365  eration is succe
+00004500: 7373 6675 6c2c 2074 6869 7320 6d65 7468  ssful, this meth
+00004510: 6f64 2072 6574 7572 6e73 2061 6e20 696e  od returns an in
+00004520: 7465 6765 720a 7265 7072 6573 656e 7469  teger.representi
+00004530: 6e67 2074 6865 2064 6174 6162 6173 6520  ng the database 
+00004540: 2263 6f6d 6d69 7420 706f 7369 7469 6f6e  "commit position
+00004550: 2220 6173 2069 7420 7761 7320 7768 656e  " as it was when
+00004560: 2074 6865 206f 7065 7261 7469 6f6e 0a77   the operation.w
+00004570: 6173 2063 6f6d 706c 6574 6564 2e0a 0a41  as completed...A
+00004580: 2022 636f 6d6d 6974 2070 6f73 6974 696f   "commit positio
+00004590: 6e22 2069 7320 6120 6d6f 6e6f 746f 6e69  n" is a monotoni
+000045a0: 6361 6c6c 7920 696e 6372 6561 7369 6e67  cally increasing
+000045b0: 2069 6e74 6567 6572 2072 6570 7265 7365   integer represe
+000045c0: 6e74 696e 670a 7468 6520 706f 7369 7469  nting.the positi
+000045d0: 6f6e 206f 6620 7468 6520 7265 636f 7264  on of the record
+000045e0: 6564 2065 7665 6e74 2069 6e20 6120 2274  ed event in a "t
+000045f0: 6f74 616c 206f 7264 6572 2220 6f66 2061  otal order" of a
+00004600: 6c6c 2072 6563 6f72 6465 640a 6576 656e  ll recorded.even
+00004610: 7473 2069 6e20 7468 6520 6461 7461 6261  ts in the databa
+00004620: 7365 2061 6372 6f73 7320 616c 6c20 7374  se across all st
+00004630: 7265 616d 732e 2049 7420 6973 2074 6865  reams. It is the
+00004640: 2061 6374 7561 6c20 706f 7369 7469 6f6e   actual position
+00004650: 0a6f 6620 7468 6520 6576 656e 7420 7265  .of the event re
+00004660: 636f 7264 206f 6e20 6469 736b 2e20 496e  cord on disk. In
+00004670: 2063 6f6e 7365 7175 656e 6365 2c20 7468   consequence, th
+00004680: 6520 7365 7175 656e 6365 206f 6620 636f  e sequence of co
+00004690: 6d6d 6974 0a70 6f73 6974 696f 6e73 2069  mmit.positions i
+000046a0: 7320 6e6f 7420 6761 706c 6573 732e 2049  s not gapless. I
+000046b0: 6e64 6565 642c 2074 6865 7265 2061 7265  ndeed, there are
+000046c0: 2075 7375 616c 6c79 206c 6172 6765 2064   usually large d
+000046d0: 6966 6665 7265 6e63 6573 0a62 6574 7765  ifferences.betwe
+000046e0: 656e 2074 6865 2063 6f6d 6d69 7420 706f  en the commit po
+000046f0: 7369 7469 6f6e 7320 6f66 2073 7563 6365  sitions of succe
+00004700: 7373 6976 6520 7265 636f 7264 6564 2065  ssive recorded e
+00004710: 7665 6e74 732e 0a0a 5468 6520 2263 6f6d  vents...The "com
+00004720: 6d69 7420 706f 7369 7469 6f6e 2220 7265  mit position" re
+00004730: 7475 726e 6564 2062 7920 6061 7070 656e  turned by `appen
+00004740: 645f 6576 656e 7473 2829 6020 6973 2074  d_events()` is t
+00004750: 6861 7420 6f66 2074 6865 206c 6173 740a  hat of the last.
+00004760: 7265 636f 7264 6564 2065 7665 6e74 2069  recorded event i
+00004770: 6e20 7468 6520 6769 7665 6e20 6261 7463  n the given batc
+00004780: 6820 6f66 206e 6577 2065 7665 6e74 732e  h of new events.
+00004790: 0a0a 5468 6520 2263 6f6d 6d69 7420 706f  ..The "commit po
+000047a0: 7369 7469 6f6e 2220 7265 7475 726e 6564  sition" returned
+000047b0: 2069 6e20 7468 6973 2077 6179 2063 616e   in this way can
+000047c0: 2074 6865 7265 666f 7265 2062 6520 7573   therefore be us
+000047d0: 6564 2074 6f20 7761 6974 0a66 6f72 2061  ed to wait.for a
+000047e0: 2064 6f77 6e73 7472 6561 6d20 636f 6d70   downstream comp
+000047f0: 6f6e 656e 7420 746f 2068 6176 6520 7072  onent to have pr
+00004800: 6f63 6573 7365 6420 616c 6c20 7468 6520  ocessed all the 
+00004810: 6576 656e 7473 2074 6861 7420 7765 7265  events that were
+00004820: 2072 6563 6f72 6465 642e 0a0a 466f 7220   recorded...For 
+00004830: 6578 616d 706c 652c 2063 6f6e 7369 6465  example, conside
+00004840: 7220 6120 7573 6572 2069 6e74 6572 6661  r a user interfa
+00004850: 6365 2063 6f6d 6d61 6e64 2074 6861 7420  ce command that 
+00004860: 7265 7375 6c74 7320 696e 2074 6865 2072  results in the r
+00004870: 6563 6f72 6469 6e67 0a6f 6620 6e65 7720  ecording.of new 
+00004880: 6576 656e 7473 2c20 616e 6420 6120 7175  events, and a qu
+00004890: 6572 7920 696e 746f 2061 6e20 6576 656e  ery into an even
+000048a0: 7475 616c 6c79 2063 6f6e 7369 7374 656e  tually consisten
+000048b0: 7420 6d61 7465 7269 616c 697a 6564 0a76  t materialized.v
+000048c0: 6965 7720 696e 2061 2064 6f77 6e73 7472  iew in a downstr
+000048d0: 6561 6d20 636f 6d70 6f6e 656e 7420 7468  eam component th
+000048e0: 6174 2069 7320 7570 6461 7465 6420 6672  at is updated fr
+000048f0: 6f6d 2074 6865 7365 2065 7665 6e74 732e  om these events.
+00004900: 2049 6620 7468 6520 6e65 770a 6576 656e   If the new.even
+00004910: 7473 2068 6176 6520 6e6f 7420 7965 7420  ts have not yet 
+00004920: 6265 656e 2070 726f 6365 7373 6564 2c20  been processed, 
+00004930: 7468 6520 7669 6577 2077 6f75 6c64 2062  the view would b
+00004940: 6520 7374 616c 652e 2054 6865 2022 636f  e stale. The "co
+00004950: 6d6d 6974 2070 6f73 6974 696f 6e22 0a63  mmit position".c
+00004960: 616e 2062 6520 7573 6564 2062 7920 7468  an be used by th
+00004970: 6520 7573 6572 2069 6e74 6572 6661 6365  e user interface
+00004980: 2074 6f20 706f 6c6c 2074 6865 2064 6f77   to poll the dow
+00004990: 6e73 7472 6561 6d20 636f 6d70 6f6e 656e  nstream componen
+000049a0: 7420 756e 7469 6c20 6974 2068 6173 0a70  t until it has.p
+000049b0: 726f 6365 7373 6564 2074 686f 7365 206e  rocessed those n
+000049c0: 6577 2065 7665 6e74 732c 2061 6674 6572  ew events, after
+000049d0: 2077 6869 6368 2074 696d 6520 7468 6520   which time the 
+000049e0: 7669 6577 2077 696c 6c20 6e6f 7420 6265  view will not be
+000049f0: 2073 7461 6c65 2e0a 0a0a 2323 2320 4170   stale....### Ap
+00004a00: 7065 6e64 2065 7665 6e74 0a0a 2a72 6571  pend event..*req
+00004a10: 7569 7265 7320 6c65 6164 6572 2a0a 0a54  uires leader*..T
+00004a20: 6865 2060 6170 7065 6e64 5f65 7665 6e74  he `append_event
+00004a30: 2829 6020 6d65 7468 6f64 2063 616e 2062  ()` method can b
+00004a40: 6520 7573 6564 2074 6f20 7772 6974 6520  e used to write 
+00004a50: 6120 7369 6e67 6c65 206e 6577 2065 7665  a single new eve
+00004a60: 6e74 2074 6f20 6120 7374 7265 616d 2e0a  nt to a stream..
+00004a70: 0a54 6872 6565 2061 7267 756d 656e 7473  .Three arguments
+00004a80: 2061 7265 2072 6571 7569 7265 642c 2060   are required, `
+00004a90: 7374 7265 616d 5f6e 616d 6560 2c20 6065  stream_name`, `e
+00004aa0: 7870 6563 7465 645f 706f 7369 7469 6f6e  xpected_position
+00004ab0: 6020 616e 6420 6065 7665 6e74 602e 0a0a  ` and `event`...
+00004ac0: 5468 6973 206d 6574 686f 6420 776f 726b  This method work
+00004ad0: 7320 696e 2074 6865 2073 616d 6520 7761  s in the same wa
+00004ae0: 7920 6173 2060 6170 7065 6e64 5f65 7665  y as `append_eve
+00004af0: 6e74 7328 2960 2c20 686f 7765 7665 7220  nts()`, however 
+00004b00: 6065 7665 6e74 6020 6973 2065 7870 6563  `event` is expec
+00004b10: 7465 640a 746f 2062 6520 6120 7369 6e67  ted.to be a sing
+00004b20: 6c65 2060 4e65 7745 7665 6e74 602e 0a0a  le `NewEvent`...
+00004b30: 5468 6973 206d 6574 686f 6420 7461 6b65  This method take
+00004b40: 7320 616e 206f 7074 696f 6e61 6c20 6074  s an optional `t
+00004b50: 696d 656f 7574 6020 6172 6775 6d65 6e74  imeout` argument
+00004b60: 2c20 7768 6963 6820 6973 2061 2050 7974  , which is a Pyt
+00004b70: 686f 6e20 6066 6c6f 6174 6020 7468 6174  hon `float` that
+00004b80: 2073 6574 730a 6120 6465 6164 6c69 6e65   sets.a deadline
+00004b90: 2066 6f72 2074 6865 2063 6f6d 706c 6574   for the complet
+00004ba0: 696f 6e20 6f66 2074 6865 2067 5250 4320  ion of the gRPC 
+00004bb0: 6f70 6572 6174 696f 6e2e 0a0a 4966 2074  operation...If t
+00004bc0: 6865 206f 7065 7261 7469 6f6e 2069 7320  he operation is 
+00004bd0: 7375 6363 6573 7366 756c 2c20 7468 6973  successful, this
+00004be0: 206d 6574 686f 6420 7265 7475 726e 7320   method returns 
+00004bf0: 616e 2069 6e74 6567 6572 0a72 6570 7265  an integer.repre
+00004c00: 7365 6e74 696e 6720 7468 6520 6461 7461  senting the data
+00004c10: 6261 7365 2022 636f 6d6d 6974 2070 6f73  base "commit pos
+00004c20: 6974 696f 6e22 2061 7320 6974 2077 6173  ition" as it was
+00004c30: 2077 6865 6e20 7468 6520 6f70 6572 6174   when the operat
+00004c40: 696f 6e0a 7761 7320 636f 6d70 6c65 7465  ion.was complete
+00004c50: 642e 0a0a 5369 6e63 6520 7468 6520 6861  d...Since the ha
+00004c60: 6e64 6c69 6e67 206f 6620 6120 636f 6d6d  ndling of a comm
+00004c70: 616e 6420 696e 2079 6f75 7220 6170 706c  and in your appl
+00004c80: 6963 6174 696f 6e20 6d61 7920 7265 7375  ication may resu
+00004c90: 6c74 2069 6e20 6f6e 6520 6f72 206d 616e  lt in one or man
+00004ca0: 790a 6e65 7720 6576 656e 7473 2c20 616e  y.new events, an
+00004cb0: 6420 7468 6520 7265 7375 6c74 7320 6f66  d the results of
+00004cc0: 2068 616e 646c 696e 6720 6120 636f 6d6d   handling a comm
+00004cd0: 616e 6420 7368 6f75 6c64 2062 6520 7265  and should be re
+00004ce0: 636f 7264 6564 2061 746f 6d69 6361 6c6c  corded atomicall
+00004cf0: 792c 0a61 6e64 2074 6865 2077 7269 7469  y,.and the writi
+00004d00: 6e67 206f 6620 6e65 7720 6576 656e 7473  ng of new events
+00004d10: 2067 656e 6572 6174 6564 2062 7920 6120   generated by a 
+00004d20: 636f 6d6d 616e 6420 6861 6e64 6c65 7220  command handler 
+00004d30: 6973 2075 7375 616c 6c79 2061 2063 6f6e  is usually a con
+00004d40: 6365 726e 0a74 6861 7420 6973 2066 6163  cern.that is fac
+00004d50: 746f 7265 6420 6f75 7420 616e 6420 7573  tored out and us
+00004d60: 6564 2065 7665 7279 7768 6572 6520 696e  ed everywhere in
+00004d70: 2061 2070 726f 6a65 6374 2c20 6974 2069   a project, it i
+00004d80: 7320 6d6f 7265 2075 7375 616c 2069 6e20  s more usual in 
+00004d90: 6120 7072 6f6a 6563 740a 746f 2075 7365  a project.to use
+00004da0: 2060 6170 7065 6e64 5f65 7665 6e74 7328   `append_events(
+00004db0: 2960 2074 6f20 7265 636f 7264 206e 6577  )` to record new
+00004dc0: 2065 7665 6e74 732e 2048 6f77 6576 6572   events. However
+00004dd0: 2c20 7468 6973 206d 6574 686f 6420 6d61  , this method ma
+00004de0: 7920 6f63 6361 7369 6f6e 616c 6c79 0a62  y occasionally.b
+00004df0: 6520 7573 6566 756c 2c20 616e 6420 696e  e useful, and in
+00004e00: 6465 6564 2069 7420 6973 2075 7365 6420  deed it is used 
+00004e10: 6279 2060 7365 745f 7374 7265 616d 5f6d  by `set_stream_m
+00004e20: 6574 6164 6174 6128 2960 2e0a 0a0a 2323  etadata()`....##
+00004e30: 2320 4964 656d 706f 7465 6e74 2061 7070  # Idempotent app
+00004e40: 656e 6420 6f70 6572 6174 696f 6e73 0a0a  end operations..
+00004e50: 536f 6d65 7469 6d65 7320 6974 206d 6179  Sometimes it may
+00004e60: 2068 6170 7065 6e20 7468 6174 2c20 7768   happen that, wh
+00004e70: 656e 2063 616c 6c69 6e67 2060 6170 7065  en calling `appe
+00004e80: 6e64 5f65 7665 6e74 7328 2960 206f 7220  nd_events()` or 
+00004e90: 6061 7070 656e 645f 6576 656e 7428 2960  `append_event()`
+00004ea0: 2c0a 7468 6520 6e65 7720 6576 656e 7473  ,.the new events
+00004eb0: 2061 7265 2073 7563 6365 7373 6675 6c6c   are successfull
+00004ec0: 7920 7265 636f 7264 6564 2c20 6275 7420  y recorded, but 
+00004ed0: 7468 656e 2073 6f6d 6568 6f77 2074 6865  then somehow the
+00004ee0: 2063 6f6e 6e65 6374 696f 6e20 746f 2074   connection to t
+00004ef0: 6865 0a64 6174 6162 6173 6520 6765 7473  he.database gets
+00004f00: 2069 6e74 6572 7275 7074 6564 2062 6566   interrupted bef
+00004f10: 6f72 6520 7468 6520 7375 6363 6573 7366  ore the successf
+00004f20: 756c 2063 616c 6c20 6361 6e20 7265 7475  ul call can retu
+00004f30: 726e 2073 7563 6365 7373 6675 6c6c 7920  rn successfully 
+00004f40: 746f 0a74 6865 2063 6c69 656e 742e 2049  to.the client. I
+00004f50: 6e20 6361 7365 206f 6620 616e 2065 7272  n case of an err
+00004f60: 6f72 2077 6865 6e20 6170 7065 6e64 696e  or when appendin
+00004f70: 6720 616e 2065 7665 6e74 2c20 6974 2069  g an event, it i
+00004f80: 7320 6465 7369 7261 626c 6520 746f 0a72  s desirable to.r
+00004f90: 6574 7279 2061 7070 656e 6469 6e67 2074  etry appending t
+00004fa0: 6865 2073 616d 6520 6576 656e 7420 6174  he same event at
+00004fb0: 2074 6865 2073 616d 6520 706f 7369 7469   the same positi
+00004fc0: 6f6e 2e20 4966 2074 6865 2065 7665 6e74  on. If the event
+00004fd0: 2077 6173 2069 6e20 6661 6374 0a73 7563   was in fact.suc
+00004fe0: 6365 7373 6675 6c6c 7920 7265 636f 7264  cessfully record
+00004ff0: 6564 2c20 6974 2069 7320 636f 6e76 656e  ed, it is conven
+00005000: 6965 6e74 2066 6f72 2074 6865 2072 6574  ient for the ret
+00005010: 7269 6564 206f 7065 7261 7469 6f6e 2074  ried operation t
+00005020: 6f20 7265 7475 726e 0a73 7563 6365 7373  o return.success
+00005030: 6675 6c6c 7920 7769 7468 6f75 7420 7261  fully without ra
+00005040: 6973 696e 6720 616e 2065 7272 6f72 2064  ising an error d
+00005050: 7565 2074 6f20 6f70 7469 6d69 7374 6963  ue to optimistic
+00005060: 2063 6f6e 6375 7272 656e 6379 2063 6f6e   concurrency con
+00005070: 7472 6f6c 0a28 6173 2064 6573 6372 6962  trol.(as describ
+00005080: 6564 2061 626f 7665 292e 0a0a 5468 6520  ed above)...The 
+00005090: 6578 616d 706c 6520 6265 6c6f 7720 7368  example below sh
+000050a0: 6f77 7320 7468 6520 6061 7070 656e 645f  ows the `append_
+000050b0: 6576 656e 7473 2829 6020 6d65 7468 6f64  events()` method
+000050c0: 2062 6569 6e67 2063 616c 6c65 6420 6167   being called ag
+000050d0: 6169 6e20 7769 7468 0a60 6576 656e 7433  ain with.`event3
+000050e0: 6020 616e 6420 6065 7870 6563 7465 645f  ` and `expected_
+000050f0: 706f 7369 7469 6f6e 3d32 602e 2057 6520  position=2`. We 
+00005100: 6361 6e20 7365 6520 7468 6174 2072 6570  can see that rep
+00005110: 6561 7469 6e67 2074 6865 2063 616c 6c20  eating the call 
+00005120: 746f 0a60 6170 7065 6e64 5f65 7665 6e74  to.`append_event
+00005130: 7328 2960 2072 6574 7572 6e73 2073 7563  s()` returns suc
+00005140: 6365 7373 6675 6c6c 792e 0a0a 6060 6070  cessfully...```p
+00005150: 7974 686f 6e0a 2320 5265 7472 7920 6170  ython.# Retry ap
+00005160: 7065 6e64 696e 6720 6576 656e 7433 2e0a  pending event3..
+00005170: 636f 6d6d 6974 5f70 6f73 6974 696f 6e5f  commit_position_
+00005180: 7265 7472 7920 3d20 636c 6965 6e74 2e61  retry = client.a
+00005190: 7070 656e 645f 6576 656e 7473 280a 2020  ppend_events(.  
+000051a0: 2020 7374 7265 616d 5f6e 616d 653d 7374    stream_name=st
+000051b0: 7265 616d 5f6e 616d 6531 2c0a 2020 2020  ream_name1,.    
+000051c0: 6578 7065 6374 6564 5f70 6f73 6974 696f  expected_positio
+000051d0: 6e3d 302c 0a20 2020 2065 7665 6e74 733d  n=0,.    events=
+000051e0: 5b65 7665 6e74 322c 2065 7665 6e74 335d  [event2, event3]
+000051f0: 2c0a 290a 6060 600a 0a57 6520 6361 6e20  ,.).```..We can 
+00005200: 7365 6520 7468 6174 2074 6865 2073 616d  see that the sam
+00005210: 6520 636f 6d6d 6974 2070 6f73 6974 696f  e commit positio
+00005220: 6e20 6973 2072 6574 7572 6e65 6420 6173  n is returned as
+00005230: 2061 626f 7665 2e0a 0a60 6060 7079 7468   above...```pyth
+00005240: 6f6e 0a61 7373 6572 7420 636f 6d6d 6974  on.assert commit
+00005250: 5f70 6f73 6974 696f 6e5f 7265 7472 7920  _position_retry 
+00005260: 3d3d 2063 6f6d 6d69 745f 706f 7369 7469  == commit_positi
+00005270: 6f6e 320a 6060 600a 0a42 7920 6361 6c6c  on2.```..By call
+00005280: 696e 6720 6072 6561 645f 7374 7265 616d  ing `read_stream
+00005290: 5f65 7665 6e74 7328 2960 2c20 7765 2063  _events()`, we c
+000052a0: 616e 2061 6c73 6f20 7365 6520 7468 6520  an also see the 
+000052b0: 7374 7265 616d 2068 6173 2062 6565 6e20  stream has been 
+000052c0: 756e 6368 616e 6765 640a 6465 7370 6974  unchanged.despit
+000052d0: 6520 7468 6520 6061 7070 656e 645f 6576  e the `append_ev
+000052e0: 656e 7473 2829 6020 6d65 7468 6f64 2068  ents()` method h
+000052f0: 6176 696e 6720 6265 656e 2063 616c 6c65  aving been calle
+00005300: 6420 7477 6963 6520 7769 7468 2074 6865  d twice with the
+00005310: 2073 616d 6520 6172 6775 6d65 6e74 732e   same arguments.
+00005320: 0a54 6861 7420 6973 2c20 7468 6572 6520  .That is, there 
+00005330: 6172 6520 7374 696c 6c20 6f6e 6c79 2074  are still only t
+00005340: 6872 6565 2065 7665 6e74 7320 696e 2074  hree events in t
+00005350: 6865 2073 7472 6561 6d2e 0a0a 6060 6070  he stream...```p
+00005360: 7974 686f 6e0a 6576 656e 7473 203d 2063  ython.events = c
+00005370: 6c69 656e 742e 7265 6164 5f73 7472 6561  lient.read_strea
+00005380: 6d5f 6576 656e 7473 280a 2020 2020 7374  m_events(.    st
+00005390: 7265 616d 5f6e 616d 653d 7374 7265 616d  ream_name=stream
+000053a0: 5f6e 616d 6531 0a29 0a0a 6173 7365 7274  _name1.)..assert
+000053b0: 206c 656e 2865 7665 6e74 7329 203d 3d20   len(events) == 
+000053c0: 330a 6060 600a 0a54 6869 7320 6964 656d  3.```..This idem
+000053d0: 706f 7465 6e74 2062 6568 6176 696f 7572  potent behaviour
+000053e0: 2069 7320 6163 7469 7661 7465 6420 6265   is activated be
+000053f0: 6361 7573 6520 7468 6520 604e 6577 4576  cause the `NewEv
+00005400: 656e 7460 2063 6c61 7373 2068 6173 2061  ent` class has a
+00005410: 6e20 6069 6460 0a61 7474 7269 6275 7465  n `id`.attribute
+00005420: 2074 6861 742c 2062 7920 6465 6661 756c   that, by defaul
+00005430: 742c 2069 7320 6173 7369 676e 6564 2061  t, is assigned a
+00005440: 206e 6577 2061 6e64 2075 6e69 7175 6520   new and unique 
+00005450: 7665 7273 696f 6e2d 3420 5555 4944 2077  version-4 UUID w
+00005460: 6865 6e20 616e 0a69 6e73 7461 6e63 6520  hen an.instance 
+00005470: 6f66 2060 4e65 7745 7665 6e74 6020 6973  of `NewEvent` is
+00005480: 2063 6f6e 7374 7275 6374 6564 2e20 4966   constructed. If
+00005490: 2065 7665 6e74 7320 7769 7468 2074 6865   events with the
+000054a0: 2073 616d 6520 6069 6460 2061 7265 2061   same `id` are a
+000054b0: 7070 656e 6465 640a 6174 2074 6865 2073  ppended.at the s
+000054c0: 616d 6520 6065 7870 6563 7465 645f 706f  ame `expected_po
+000054d0: 7369 7469 6f6e 602c 2074 6865 2073 7472  sition`, the str
+000054e0: 6561 6d20 7769 6c6c 2062 6520 756e 6368  eam will be unch
+000054f0: 616e 6765 642c 2074 6865 206f 7065 7261  anged, the opera
+00005500: 7469 6f6e 2077 696c 6c0a 636f 6d70 6c65  tion will.comple
+00005510: 7465 2073 7563 6365 7373 6675 6c6c 792c  te successfully,
+00005520: 2061 6e64 2074 6865 2073 616d 6520 636f   and the same co
+00005530: 6d6d 6974 2070 6f73 6974 696f 6e20 7769  mmit position wi
+00005540: 6c6c 2062 6520 7265 7475 726e 6564 2074  ll be returned t
+00005550: 6f20 7468 6520 6361 6c6c 6572 2e0a 0a60  o the caller...`
+00005560: 6060 7079 7468 6f6e 0a66 726f 6d20 7575  ``python.from uu
+00005570: 6964 2069 6d70 6f72 7420 5555 4944 0a0a  id import UUID..
+00005580: 0a61 7373 6572 7420 6973 696e 7374 616e  .assert isinstan
+00005590: 6365 2865 7665 6e74 312e 6964 2c20 5555  ce(event1.id, UU
+000055a0: 4944 290a 6173 7365 7274 2069 7369 6e73  ID).assert isins
+000055b0: 7461 6e63 6528 6576 656e 7432 2e69 642c  tance(event2.id,
+000055c0: 2055 5549 4429 0a61 7373 6572 7420 6973   UUID).assert is
+000055d0: 696e 7374 616e 6365 2865 7665 6e74 332e  instance(event3.
+000055e0: 6964 2c20 5555 4944 290a 0a61 7373 6572  id, UUID)..asser
+000055f0: 7420 6576 656e 7431 2e69 6420 213d 2065  t event1.id != e
+00005600: 7665 6e74 322e 6964 0a61 7373 6572 7420  vent2.id.assert 
+00005610: 6576 656e 7432 2e69 6420 213d 2065 7665  event2.id != eve
+00005620: 6e74 332e 6964 0a0a 6173 7365 7274 2065  nt3.id..assert e
+00005630: 7665 6e74 735b 305d 2e69 6420 3d3d 2065  vents[0].id == e
+00005640: 7665 6e74 312e 6964 0a61 7373 6572 7420  vent1.id.assert 
+00005650: 6576 656e 7473 5b31 5d2e 6964 203d 3d20  events[1].id == 
+00005660: 6576 656e 7432 2e69 640a 6173 7365 7274  event2.id.assert
+00005670: 2065 7665 6e74 735b 325d 2e69 6420 3d3d   events[2].id ==
+00005680: 2065 7665 6e74 332e 6964 0a60 6060 0a0a   event3.id.```..
+00005690: 4974 2069 7320 706f 7373 6962 6c65 2074  It is possible t
+000056a0: 6f20 7365 7420 7468 6520 6069 6460 2063  o set the `id` c
+000056b0: 6f6e 7374 7275 6374 6f72 2061 7267 756d  onstructor argum
+000056c0: 656e 7420 6f66 2060 4e65 7745 7665 6e74  ent of `NewEvent
+000056d0: 6020 7768 656e 2069 6e73 7461 6e74 6961  ` when instantia
+000056e0: 7469 6e67 0a74 6865 2060 4e65 7745 7665  ting.the `NewEve
+000056f0: 6e74 6020 636c 6173 732c 2062 7574 2069  nt` class, but i
+00005700: 6e20 7468 6520 6578 616d 706c 6573 2061  n the examples a
+00005710: 626f 7665 2077 6520 6861 7665 2062 6565  bove we have bee
+00005720: 6e20 7573 696e 6720 7468 6520 6465 6661  n using the defa
+00005730: 756c 740a 6265 6861 7669 6f75 722c 2077  ult.behaviour, w
+00005740: 6869 6368 2069 7320 7468 6174 2074 6865  hich is that the
+00005750: 2060 6964 6020 7661 6c75 6520 6973 2067   `id` value is g
+00005760: 656e 6572 6174 6564 2077 6865 6e20 7468  enerated when th
+00005770: 6520 604e 6577 4576 656e 7460 2063 6c61  e `NewEvent` cla
+00005780: 7373 2069 730a 696e 7374 616e 7469 6174  ss is.instantiat
+00005790: 6564 2e0a 0a0a 2323 2320 5265 6164 2073  ed....### Read s
+000057a0: 7472 6561 6d20 6576 656e 7473 0a0a 5468  tream events..Th
+000057b0: 6520 6072 6561 645f 7374 7265 616d 5f65  e `read_stream_e
+000057c0: 7665 6e74 7328 2960 206d 6574 686f 6420  vents()` method 
+000057d0: 6361 6e20 6265 2075 7365 6420 746f 206f  can be used to o
+000057e0: 6274 6169 6e20 7468 6520 7265 636f 7264  btain the record
+000057f0: 6564 2065 7665 6e74 7320 696e 2061 0a73  ed events in a.s
+00005800: 7472 6561 6d2e 2049 7420 7265 7475 726e  tream. It return
+00005810: 7320 6120 7365 7175 656e 6365 206f 6620  s a sequence of 
+00005820: 7265 636f 7264 6564 2065 7665 6e74 7320  recorded events 
+00005830: 6f62 6a65 6374 732e 2054 6865 2072 6563  objects. The rec
+00005840: 6569 7665 6420 7265 636f 7264 6564 2065  eived recorded e
+00005850: 7665 6e74 0a6f 626a 6563 7420 6172 6520  vent.object are 
+00005860: 696e 7374 616e 6365 7320 6f66 2074 6865  instances of the
+00005870: 2060 5265 636f 7264 6564 4576 656e 7460   `RecordedEvent`
+00005880: 2063 6c61 7373 2028 7365 6520 7468 6520   class (see the 
+00005890: 4e6f 7465 7320 7365 6374 696f 6e20 6265  Notes section be
+000058a0: 6c6f 7720 666f 720a 6465 7461 696c 7320  low for.details 
+000058b0: 6f66 2074 6869 7320 636c 6173 7329 2e0a  of this class)..
+000058c0: 0a54 6869 7320 6d65 7468 6f64 2068 6173  .This method has
+000058d0: 206f 6e65 2072 6571 7569 7265 6420 6172   one required ar
+000058e0: 6775 6d65 6e74 2c20 6073 7472 6561 6d5f  gument, `stream_
+000058f0: 6e61 6d65 602c 2077 6869 6368 2069 7320  name`, which is 
+00005900: 7468 6520 6e61 6d65 206f 660a 7468 6520  the name of.the 
+00005910: 7374 7265 616d 2066 726f 6d20 7768 6963  stream from whic
+00005920: 6820 746f 2072 6561 6420 6576 656e 7473  h to read events
+00005930: 2e20 4279 2064 6566 6175 6c74 2c20 7468  . By default, th
+00005940: 6520 7265 636f 7264 6564 2065 7665 6e74  e recorded event
+00005950: 7320 696e 2074 6865 0a73 7472 6561 6d20  s in the.stream 
+00005960: 6172 6520 7265 7475 726e 6564 2069 6e20  are returned in 
+00005970: 7468 6520 6f72 6465 7220 7468 6579 2077  the order they w
+00005980: 6572 6520 7265 636f 7264 6564 2e0a 0a54  ere recorded...T
+00005990: 6865 206d 6574 686f 6420 6072 6561 645f  he method `read_
+000059a0: 7374 7265 616d 5f65 7665 6e74 7328 2960  stream_events()`
+000059b0: 2061 6c73 6f20 7375 7070 6f72 7473 2066   also supports f
+000059c0: 6f75 7220 6f70 7469 6f6e 616c 2061 7267  our optional arg
+000059d0: 756d 656e 7473 2c0a 6073 7472 6561 6d5f  uments,.`stream_
+000059e0: 706f 7369 7469 6f6e 602c 2060 6261 636b  position`, `back
+000059f0: 7761 7264 7360 2c20 606c 696d 6974 602c  wards`, `limit`,
+00005a00: 2061 6e64 2060 7469 6d65 6f75 7460 2e0a   and `timeout`..
+00005a10: 0a54 6865 206f 7074 696f 6e61 6c20 6073  .The optional `s
+00005a20: 7472 6561 6d5f 706f 7369 7469 6f6e 6020  tream_position` 
+00005a30: 6172 6775 6d65 6e74 2069 7320 616e 206f  argument is an o
+00005a40: 7074 696f 6e61 6c20 696e 7465 6765 7220  ptional integer 
+00005a50: 7468 6174 2063 616e 2062 6520 7573 6564  that can be used
+00005a60: 2074 6f0a 696e 6469 6361 7465 2074 6865   to.indicate the
+00005a70: 2070 6f73 6974 696f 6e20 696e 2074 6865   position in the
+00005a80: 2073 7472 6561 6d20 6672 6f6d 2077 6869   stream from whi
+00005a90: 6368 2074 6f20 7374 6172 7420 7265 6164  ch to start read
+00005aa0: 696e 672e 2054 6869 7320 6172 6775 6d65  ing. This argume
+00005ab0: 6e74 2069 730a 604e 6f6e 6560 2062 7920  nt is.`None` by 
+00005ac0: 6465 6661 756c 742c 2077 6869 6368 206d  default, which m
+00005ad0: 6561 6e73 2074 6865 2073 7472 6561 6d20  eans the stream 
+00005ae0: 7769 6c6c 2062 6520 7265 6164 2065 6974  will be read eit
+00005af0: 6865 7220 6672 6f6d 2074 6865 2073 7461  her from the sta
+00005b00: 7274 206f 6620 7468 650a 7374 7265 616d  rt of the.stream
+00005b10: 2028 7468 6520 6465 6661 756c 7420 6265   (the default be
+00005b20: 6861 7669 6f75 7229 2c20 6f72 2066 726f  haviour), or fro
+00005b30: 6d20 7468 6520 656e 6420 6f66 2074 6865  m the end of the
+00005b40: 2073 7472 6561 6d20 6966 2060 6261 636b   stream if `back
+00005b50: 7761 7264 7360 2069 730a 6054 7275 6560  wards` is.`True`
+00005b60: 2e20 5768 656e 2072 6561 6469 6e67 2061  . When reading a
+00005b70: 2073 7472 6561 6d20 6672 6f6d 2061 2073   stream from a s
+00005b80: 7065 6369 6669 6320 706f 7369 7469 6f6e  pecific position
+00005b90: 2069 6e20 7468 6520 7374 7265 616d 2c20   in the stream, 
+00005ba0: 7468 650a 7265 636f 7264 6564 2065 7665  the.recorded eve
+00005bb0: 6e74 2061 7420 7468 6174 2070 6f73 6974  nt at that posit
+00005bc0: 696f 6e20 7769 6c6c 2062 6520 696e 636c  ion will be incl
+00005bd0: 7564 6564 2c20 626f 7468 2077 6865 6e20  uded, both when 
+00005be0: 7265 6164 696e 6720 666f 7277 6172 6473  reading forwards
+00005bf0: 0a66 726f 6d20 7468 6174 2070 6f73 6974  .from that posit
+00005c00: 696f 6e2c 2061 6e64 2077 6865 6e20 7265  ion, and when re
+00005c10: 6164 696e 6720 6261 636b 7761 7264 7320  ading backwards 
+00005c20: 6672 6f6d 2074 6861 7420 706f 7369 7469  from that positi
+00005c30: 6f6e 2e0a 0a54 6865 206f 7074 696f 6e61  on...The optiona
+00005c40: 6c20 6062 6163 6b77 6172 6473 6020 6172  l `backwards` ar
+00005c50: 6775 6d65 6e74 2069 7320 6120 5079 7468  gument is a Pyth
+00005c60: 6f6e 2060 626f 6f6c 602e 2054 6865 2064  on `bool`. The d
+00005c70: 6566 6175 6c74 2069 7320 6046 616c 7365  efault is `False
+00005c80: 602c 2077 6869 6368 0a6d 6561 6e73 2074  `, which.means t
+00005c90: 6865 2073 7472 6561 6d20 7769 6c6c 2062  he stream will b
+00005ca0: 6520 7265 6164 2066 6f72 7761 7264 7320  e read forwards 
+00005cb0: 6279 2064 6566 6175 6c74 2c20 736f 2074  by default, so t
+00005cc0: 6861 7420 6576 656e 7473 2061 7265 2072  hat events are r
+00005cd0: 6574 7572 6e65 6420 696e 2074 6865 0a6f  eturned in the.o
+00005ce0: 7264 6572 2074 6865 7920 7765 7265 2061  rder they were a
+00005cf0: 7070 656e 6465 642c 2049 6620 6062 6163  ppended, If `bac
+00005d00: 6b77 6172 6473 6020 6973 2060 5472 7565  kwards` is `True
+00005d10: 602c 2074 6865 2065 7665 6e74 7320 6172  `, the events ar
+00005d20: 6520 7265 7475 726e 6564 2069 6e20 7265  e returned in re
+00005d30: 7665 7273 650a 6f72 6465 722e 0a0a 5468  verse.order...Th
+00005d40: 6520 6f70 7469 6f6e 616c 2060 6c69 6d69  e optional `limi
+00005d50: 7460 2061 7267 756d 656e 7420 6973 2061  t` argument is a
+00005d60: 6e20 696e 7465 6765 7220 7768 6963 6820  n integer which 
+00005d70: 7265 7374 7269 6374 7320 7468 6520 6e75  restricts the nu
+00005d80: 6d62 6572 206f 6620 6576 656e 7473 2074  mber of events t
+00005d90: 6861 740a 7769 6c6c 2062 6520 7265 7475  hat.will be retu
+00005da0: 726e 6564 2e20 5468 6520 6465 6661 756c  rned. The defaul
+00005db0: 7420 7661 6c75 6520 6973 2060 7379 732e  t value is `sys.
+00005dc0: 6d61 7869 6e74 602e 0a0a 5468 6520 6f70  maxint`...The op
+00005dd0: 7469 6f6e 616c 2060 7469 6d65 6f75 7460  tional `timeout`
+00005de0: 2061 7267 756d 656e 7420 6973 2061 2050   argument is a P
+00005df0: 7974 686f 6e20 6066 6c6f 6174 6020 7768  ython `float` wh
+00005e00: 6963 6820 7365 7473 2061 2064 6561 646c  ich sets a deadl
+00005e10: 696e 6520 666f 720a 7468 6520 636f 6d70  ine for.the comp
+00005e20: 6c65 7469 6f6e 206f 6620 7468 6520 6752  letion of the gR
+00005e30: 5043 206f 7065 7261 7469 6f6e 2e0a 0a54  PC operation...T
+00005e40: 6865 2065 7861 6d70 6c65 2062 656c 6f77  he example below
+00005e50: 2073 686f 7773 2068 6f77 2074 6f20 7265   shows how to re
+00005e60: 6164 2074 6865 2072 6563 6f72 6465 6420  ad the recorded 
+00005e70: 6576 656e 7473 206f 6620 6120 7374 7265  events of a stre
+00005e80: 616d 0a66 6f72 7761 7264 7320 6672 6f6d  am.forwards from
+00005e90: 2074 6865 2073 7461 7274 206f 6620 7468   the start of th
+00005ea0: 6520 7374 7265 616d 2074 6f20 7468 6520  e stream to the 
+00005eb0: 656e 6420 6f66 2074 6865 2073 7472 6561  end of the strea
+00005ec0: 6d2e 2054 6865 0a6e 616d 6520 6f66 2061  m. The.name of a
+00005ed0: 2073 7472 6561 6d20 6973 2067 6976 656e   stream is given
+00005ee0: 2077 6865 6e20 6361 6c6c 696e 6720 7468   when calling th
+00005ef0: 6520 6d65 7468 6f64 2e0a 0a60 6060 7079  e method...```py
+00005f00: 7468 6f6e 0a65 7665 6e74 7320 3d20 636c  thon.events = cl
+00005f10: 6965 6e74 2e72 6561 645f 7374 7265 616d  ient.read_stream
+00005f20: 5f65 7665 6e74 7328 0a20 2020 2073 7472  _events(.    str
+00005f30: 6561 6d5f 6e61 6d65 3d73 7472 6561 6d5f  eam_name=stream_
+00005f40: 6e61 6d65 310a 290a 6060 600a 0a4e 6f77  name1.).```..Now
+00005f50: 2074 6861 7420 7765 2068 6176 6520 6120   that we have a 
+00005f60: 7365 7175 656e 6365 206f 6620 6576 656e  sequence of even
+00005f70: 7420 6f62 6a65 6374 732c 2077 6520 6361  t objects, we ca
+00005f80: 6e20 6368 6563 6b20 7765 2067 6f74 2074  n check we got t
+00005f90: 6865 0a74 6872 6565 2065 7665 6e74 7320  he.three events 
+00005fa0: 7468 6174 2077 6572 6520 6170 7065 6e64  that were append
+00005fb0: 6564 2074 6f20 7468 6520 7374 7265 616d  ed to the stream
+00005fc0: 2c20 616e 6420 7468 6174 2074 6865 7920  , and that they 
+00005fd0: 6172 650a 6f72 6465 7265 6420 6578 6163  are.ordered exac
+00005fe0: 746c 7920 6173 2074 6865 7920 7765 7265  tly as they were
+00005ff0: 2061 7070 656e 6465 642e 0a0a 6060 6070   appended...```p
+00006000: 7974 686f 6e0a 6173 7365 7274 206c 656e  ython.assert len
+00006010: 2865 7665 6e74 7329 203d 3d20 330a 0a61  (events) == 3..a
+00006020: 7373 6572 7420 6576 656e 7473 5b30 5d2e  ssert events[0].
+00006030: 7374 7265 616d 5f6e 616d 6520 3d3d 2073  stream_name == s
+00006040: 7472 6561 6d5f 6e61 6d65 310a 6173 7365  tream_name1.asse
+00006050: 7274 2065 7665 6e74 735b 305d 2e73 7472  rt events[0].str
+00006060: 6561 6d5f 706f 7369 7469 6f6e 203d 3d20  eam_position == 
+00006070: 300a 6173 7365 7274 2065 7665 6e74 735b  0.assert events[
+00006080: 305d 2e74 7970 6520 3d3d 2065 7665 6e74  0].type == event
+00006090: 312e 7479 7065 0a61 7373 6572 7420 6576  1.type.assert ev
+000060a0: 656e 7473 5b30 5d2e 6461 7461 203d 3d20  ents[0].data == 
+000060b0: 6576 656e 7431 2e64 6174 610a 0a61 7373  event1.data..ass
+000060c0: 6572 7420 6576 656e 7473 5b31 5d2e 7374  ert events[1].st
+000060d0: 7265 616d 5f6e 616d 6520 3d3d 2073 7472  ream_name == str
+000060e0: 6561 6d5f 6e61 6d65 310a 6173 7365 7274  eam_name1.assert
+000060f0: 2065 7665 6e74 735b 315d 2e73 7472 6561   events[1].strea
+00006100: 6d5f 706f 7369 7469 6f6e 203d 3d20 310a  m_position == 1.
+00006110: 6173 7365 7274 2065 7665 6e74 735b 315d  assert events[1]
+00006120: 2e74 7970 6520 3d3d 2065 7665 6e74 322e  .type == event2.
+00006130: 7479 7065 0a61 7373 6572 7420 6576 656e  type.assert even
+00006140: 7473 5b31 5d2e 6461 7461 203d 3d20 6576  ts[1].data == ev
+00006150: 656e 7432 2e64 6174 610a 0a61 7373 6572  ent2.data..asser
+00006160: 7420 6576 656e 7473 5b32 5d2e 7374 7265  t events[2].stre
+00006170: 616d 5f6e 616d 6520 3d3d 2073 7472 6561  am_name == strea
+00006180: 6d5f 6e61 6d65 310a 6173 7365 7274 2065  m_name1.assert e
+00006190: 7665 6e74 735b 325d 2e73 7472 6561 6d5f  vents[2].stream_
+000061a0: 706f 7369 7469 6f6e 203d 3d20 320a 6173  position == 2.as
+000061b0: 7365 7274 2065 7665 6e74 735b 325d 2e74  sert events[2].t
+000061c0: 7970 6520 3d3d 2065 7665 6e74 332e 7479  ype == event3.ty
+000061d0: 7065 0a61 7373 6572 7420 6576 656e 7473  pe.assert events
+000061e0: 5b32 5d2e 6461 7461 203d 3d20 6576 656e  [2].data == even
+000061f0: 7433 2e64 6174 610a 6060 600a 0a54 6865  t3.data.```..The
+00006200: 2065 7861 6d70 6c65 2062 656c 6f77 2073   example below s
+00006210: 686f 7773 2068 6f77 2074 6f20 7265 6164  hows how to read
+00006220: 2072 6563 6f72 6465 6420 6576 656e 7473   recorded events
+00006230: 2069 6e20 6120 7374 7265 616d 2066 6f72   in a stream for
+00006240: 7761 7264 7320 6672 6f6d 0a61 2073 7065  wards from.a spe
+00006250: 6369 6669 6320 7374 7265 616d 2070 6f73  cific stream pos
+00006260: 6974 696f 6e20 746f 2074 6865 2065 6e64  ition to the end
+00006270: 206f 6620 7468 6520 7374 7265 616d 2e0a   of the stream..
+00006280: 0a60 6060 7079 7468 6f6e 0a65 7665 6e74  .```python.event
+00006290: 7320 3d20 636c 6965 6e74 2e72 6561 645f  s = client.read_
+000062a0: 7374 7265 616d 5f65 7665 6e74 7328 0a20  stream_events(. 
+000062b0: 2020 2073 7472 6561 6d5f 6e61 6d65 3d73     stream_name=s
+000062c0: 7472 6561 6d5f 6e61 6d65 312c 0a20 2020  tream_name1,.   
+000062d0: 2073 7472 6561 6d5f 706f 7369 7469 6f6e   stream_position
+000062e0: 3d31 2c0a 290a 0a61 7373 6572 7420 6c65  =1,.)..assert le
+000062f0: 6e28 6576 656e 7473 2920 3d3d 2032 0a0a  n(events) == 2..
+00006300: 6173 7365 7274 2065 7665 6e74 735b 305d  assert events[0]
+00006310: 2e73 7472 6561 6d5f 6e61 6d65 203d 3d20  .stream_name == 
+00006320: 7374 7265 616d 5f6e 616d 6531 0a61 7373  stream_name1.ass
+00006330: 6572 7420 6576 656e 7473 5b30 5d2e 7374  ert events[0].st
+00006340: 7265 616d 5f70 6f73 6974 696f 6e20 3d3d  ream_position ==
+00006350: 2031 0a61 7373 6572 7420 6576 656e 7473   1.assert events
+00006360: 5b30 5d2e 7479 7065 203d 3d20 6576 656e  [0].type == even
+00006370: 7432 2e74 7970 650a 6173 7365 7274 2065  t2.type.assert e
+00006380: 7665 6e74 735b 305d 2e64 6174 6120 3d3d  vents[0].data ==
+00006390: 2065 7665 6e74 322e 6461 7461 0a0a 6173   event2.data..as
+000063a0: 7365 7274 2065 7665 6e74 735b 315d 2e73  sert events[1].s
+000063b0: 7472 6561 6d5f 6e61 6d65 203d 3d20 7374  tream_name == st
+000063c0: 7265 616d 5f6e 616d 6531 0a61 7373 6572  ream_name1.asser
+000063d0: 7420 6576 656e 7473 5b31 5d2e 7374 7265  t events[1].stre
+000063e0: 616d 5f70 6f73 6974 696f 6e20 3d3d 2032  am_position == 2
+000063f0: 0a61 7373 6572 7420 6576 656e 7473 5b31  .assert events[1
+00006400: 5d2e 7479 7065 203d 3d20 6576 656e 7433  ].type == event3
+00006410: 2e74 7970 650a 6173 7365 7274 2065 7665  .type.assert eve
+00006420: 6e74 735b 315d 2e64 6174 6120 3d3d 2065  nts[1].data == e
+00006430: 7665 6e74 332e 6461 7461 0a60 6060 0a0a  vent3.data.```..
+00006440: 5468 6520 6578 616d 706c 6520 6265 6c6f  The example belo
+00006450: 7720 7368 6f77 7320 686f 7720 746f 2072  w shows how to r
+00006460: 6561 6420 7468 6520 7265 636f 7264 6564  ead the recorded
+00006470: 2065 7665 6e74 7320 696e 2061 2073 7472   events in a str
+00006480: 6561 6d20 6261 636b 7761 7264 7320 6672  eam backwards fr
+00006490: 6f6d 0a74 6865 2065 6e64 206f 6620 7468  om.the end of th
+000064a0: 6520 7374 7265 616d 2074 6f20 7468 6520  e stream to the 
+000064b0: 7374 6172 7420 6f66 2074 6865 2073 7472  start of the str
+000064c0: 6561 6d2e 0a0a 6060 6070 7974 686f 6e0a  eam...```python.
+000064d0: 6576 656e 7473 203d 2063 6c69 656e 742e  events = client.
+000064e0: 7265 6164 5f73 7472 6561 6d5f 6576 656e  read_stream_even
+000064f0: 7473 280a 2020 2020 7374 7265 616d 5f6e  ts(.    stream_n
+00006500: 616d 653d 7374 7265 616d 5f6e 616d 6531  ame=stream_name1
+00006510: 2c0a 2020 2020 6261 636b 7761 7264 733d  ,.    backwards=
+00006520: 5472 7565 2c0a 290a 0a61 7373 6572 7420  True,.)..assert 
+00006530: 6c65 6e28 6576 656e 7473 2920 3d3d 2033  len(events) == 3
+00006540: 0a0a 6173 7365 7274 2065 7665 6e74 735b  ..assert events[
+00006550: 305d 2e73 7472 6561 6d5f 6e61 6d65 203d  0].stream_name =
+00006560: 3d20 7374 7265 616d 5f6e 616d 6531 0a61  = stream_name1.a
+00006570: 7373 6572 7420 6576 656e 7473 5b30 5d2e  ssert events[0].
+00006580: 7374 7265 616d 5f70 6f73 6974 696f 6e20  stream_position 
+00006590: 3d3d 2032 0a61 7373 6572 7420 6576 656e  == 2.assert even
+000065a0: 7473 5b30 5d2e 7479 7065 203d 3d20 6576  ts[0].type == ev
+000065b0: 656e 7433 2e74 7970 650a 6173 7365 7274  ent3.type.assert
+000065c0: 2065 7665 6e74 735b 305d 2e64 6174 6120   events[0].data 
+000065d0: 3d3d 2065 7665 6e74 332e 6461 7461 0a0a  == event3.data..
+000065e0: 6173 7365 7274 2065 7665 6e74 735b 315d  assert events[1]
+000065f0: 2e73 7472 6561 6d5f 6e61 6d65 203d 3d20  .stream_name == 
+00006600: 7374 7265 616d 5f6e 616d 6531 0a61 7373  stream_name1.ass
+00006610: 6572 7420 6576 656e 7473 5b31 5d2e 7374  ert events[1].st
+00006620: 7265 616d 5f70 6f73 6974 696f 6e20 3d3d  ream_position ==
+00006630: 2031 0a61 7373 6572 7420 6576 656e 7473   1.assert events
+00006640: 5b31 5d2e 7479 7065 203d 3d20 6576 656e  [1].type == even
+00006650: 7432 2e74 7970 650a 6173 7365 7274 2065  t2.type.assert e
+00006660: 7665 6e74 735b 315d 2e64 6174 6120 3d3d  vents[1].data ==
+00006670: 2065 7665 6e74 322e 6461 7461 0a60 6060   event2.data.```
+00006680: 0a0a 5468 6520 6578 616d 706c 6520 6265  ..The example be
+00006690: 6c6f 7720 7368 6f77 7320 686f 7720 746f  low shows how to
+000066a0: 2072 6561 6420 6120 6c69 6d69 7465 6420   read a limited 
+000066b0: 6e75 6d62 6572 2028 7477 6f29 206f 6620  number (two) of 
+000066c0: 7468 6520 7265 636f 7264 6564 2065 7665  the recorded eve
+000066d0: 6e74 730a 696e 2061 2073 7472 6561 6d20  nts.in a stream 
+000066e0: 666f 7277 6172 6473 2066 726f 6d20 7468  forwards from th
+000066f0: 6520 7374 6172 7420 6f66 2074 6865 2073  e start of the s
+00006700: 7472 6561 6d2e 0a0a 6060 6070 7974 686f  tream...```pytho
+00006710: 6e0a 6576 656e 7473 203d 2063 6c69 656e  n.events = clien
+00006720: 742e 7265 6164 5f73 7472 6561 6d5f 6576  t.read_stream_ev
+00006730: 656e 7473 280a 2020 2020 7374 7265 616d  ents(.    stream
+00006740: 5f6e 616d 653d 7374 7265 616d 5f6e 616d  _name=stream_nam
+00006750: 6531 2c0a 2020 2020 6c69 6d69 743d 322c  e1,.    limit=2,
+00006760: 0a29 0a0a 6173 7365 7274 206c 656e 2865  .)..assert len(e
+00006770: 7665 6e74 7329 203d 3d20 320a 0a61 7373  vents) == 2..ass
+00006780: 6572 7420 6576 656e 7473 5b30 5d2e 7374  ert events[0].st
+00006790: 7265 616d 5f6e 616d 6520 3d3d 2073 7472  ream_name == str
+000067a0: 6561 6d5f 6e61 6d65 310a 6173 7365 7274  eam_name1.assert
+000067b0: 2065 7665 6e74 735b 305d 2e73 7472 6561   events[0].strea
+000067c0: 6d5f 706f 7369 7469 6f6e 203d 3d20 300a  m_position == 0.
+000067d0: 6173 7365 7274 2065 7665 6e74 735b 305d  assert events[0]
+000067e0: 2e74 7970 6520 3d3d 2065 7665 6e74 312e  .type == event1.
+000067f0: 7479 7065 0a61 7373 6572 7420 6576 656e  type.assert even
+00006800: 7473 5b30 5d2e 6461 7461 203d 3d20 6576  ts[0].data == ev
+00006810: 656e 7431 2e64 6174 610a 0a61 7373 6572  ent1.data..asser
+00006820: 7420 6576 656e 7473 5b31 5d2e 7374 7265  t events[1].stre
+00006830: 616d 5f6e 616d 6520 3d3d 2073 7472 6561  am_name == strea
+00006840: 6d5f 6e61 6d65 310a 6173 7365 7274 2065  m_name1.assert e
+00006850: 7665 6e74 735b 315d 2e73 7472 6561 6d5f  vents[1].stream_
+00006860: 706f 7369 7469 6f6e 203d 3d20 310a 6173  position == 1.as
+00006870: 7365 7274 2065 7665 6e74 735b 315d 2e74  sert events[1].t
+00006880: 7970 6520 3d3d 2065 7665 6e74 322e 7479  ype == event2.ty
+00006890: 7065 0a61 7373 6572 7420 6576 656e 7473  pe.assert events
+000068a0: 5b31 5d2e 6461 7461 203d 3d20 6576 656e  [1].data == even
+000068b0: 7432 2e64 6174 610a 6060 600a 0a54 6865  t2.data.```..The
+000068c0: 2065 7861 6d70 6c65 2062 656c 6f77 2073   example below s
+000068d0: 686f 7773 2068 6f77 2074 6f20 7265 6164  hows how to read
+000068e0: 2061 206c 696d 6974 6564 206e 756d 6265   a limited numbe
+000068f0: 7220 286f 6e65 2920 6f66 2074 6865 2072  r (one) of the r
+00006900: 6563 6f72 6465 640a 6576 656e 7473 2069  ecorded.events i
+00006910: 6e20 6120 7374 7265 616d 2062 6163 6b77  n a stream backw
+00006920: 6172 6473 2066 726f 6d20 6120 6769 7665  ards from a give
+00006930: 6e20 7374 7265 616d 2070 6f73 6974 696f  n stream positio
+00006940: 6e2e 0a0a 6060 6070 7974 686f 6e0a 6576  n...```python.ev
+00006950: 656e 7473 203d 2063 6c69 656e 742e 7265  ents = client.re
+00006960: 6164 5f73 7472 6561 6d5f 6576 656e 7473  ad_stream_events
+00006970: 280a 2020 2020 7374 7265 616d 5f6e 616d  (.    stream_nam
+00006980: 653d 7374 7265 616d 5f6e 616d 6531 2c0a  e=stream_name1,.
+00006990: 2020 2020 7374 7265 616d 5f70 6f73 6974      stream_posit
+000069a0: 696f 6e3d 322c 0a20 2020 2062 6163 6b77  ion=2,.    backw
+000069b0: 6172 6473 3d54 7275 652c 0a20 2020 206c  ards=True,.    l
+000069c0: 696d 6974 3d31 2c0a 290a 0a61 7373 6572  imit=1,.)..asser
+000069d0: 7420 6c65 6e28 6576 656e 7473 2920 3d3d  t len(events) ==
+000069e0: 2031 0a0a 6173 7365 7274 2065 7665 6e74   1..assert event
+000069f0: 735b 305d 2e73 7472 6561 6d5f 6e61 6d65  s[0].stream_name
+00006a00: 203d 3d20 7374 7265 616d 5f6e 616d 6531   == stream_name1
+00006a10: 0a61 7373 6572 7420 6576 656e 7473 5b30  .assert events[0
+00006a20: 5d2e 7374 7265 616d 5f70 6f73 6974 696f  ].stream_positio
+00006a30: 6e20 3d3d 2032 0a61 7373 6572 7420 6576  n == 2.assert ev
+00006a40: 656e 7473 5b30 5d2e 7479 7065 203d 3d20  ents[0].type == 
+00006a50: 6576 656e 7433 2e74 7970 650a 6173 7365  event3.type.asse
+00006a60: 7274 2065 7665 6e74 735b 305d 2e64 6174  rt events[0].dat
+00006a70: 6120 3d3d 2065 7665 6e74 332e 6461 7461  a == event3.data
+00006a80: 0a60 6060 0a0a 5468 6520 6072 6561 645f  .```..The `read_
+00006a90: 7374 7265 616d 5f65 7665 6e74 7328 2960  stream_events()`
+00006aa0: 206d 6574 686f 6420 7769 6c6c 2072 6169   method will rai
+00006ab0: 7365 2061 2060 4e6f 7446 6f75 6e64 6020  se a `NotFound` 
+00006ac0: 6578 6365 7074 696f 6e20 6966 2074 6865  exception if the
+00006ad0: 2073 7472 6561 6d0a 646f 6573 206e 6f74   stream.does not
+00006ae0: 2065 7869 7374 2e0a 0a60 6060 7079 7468   exist...```pyth
+00006af0: 6f6e 0a66 726f 6d20 6573 6462 636c 6965  on.from esdbclie
+00006b00: 6e74 2e65 7863 6570 7469 6f6e 7320 696d  nt.exceptions im
+00006b10: 706f 7274 204e 6f74 466f 756e 640a 0a0a  port NotFound...
+00006b20: 7472 793a 0a20 2020 2063 6c69 656e 742e  try:.    client.
+00006b30: 7265 6164 5f73 7472 6561 6d5f 6576 656e  read_stream_even
+00006b40: 7473 2827 6e6f 742d 612d 7374 7265 616d  ts('not-a-stream
+00006b50: 2729 0a65 7863 6570 7420 4e6f 7446 6f75  ').except NotFou
+00006b60: 6e64 3a0a 2020 2020 7061 7373 2020 2320  nd:.    pass  # 
+00006b70: 5468 6520 7374 7265 616d 2027 6e6f 742d  The stream 'not-
+00006b80: 612d 7374 7265 616d 2720 646f 6573 206e  a-stream' does n
+00006b90: 6f74 2065 7869 7374 2e0a 656c 7365 3a0a  ot exist..else:.
+00006ba0: 2020 2020 7261 6973 6520 4578 6365 7074      raise Except
+00006bb0: 696f 6e28 2253 686f 756c 646e 2774 2067  ion("Shouldn't g
+00006bc0: 6574 2068 6572 6522 290a 6060 600a 0a23  et here").```..#
+00006bd0: 2323 2048 6f77 2074 6f20 696d 706c 656d  ## How to implem
+00006be0: 656e 7420 736e 6170 7368 6f74 7469 6e67  ent snapshotting
+00006bf0: 2077 6974 6820 4576 656e 7453 746f 7265   with EventStore
+00006c00: 4442 0a0a 4576 656e 742d 736f 7572 6365  DB..Event-source
+00006c10: 6420 6167 6772 6567 6174 6573 2061 7265  d aggregates are
+00006c20: 2074 7970 6963 616c 6c79 2072 6563 6f6e   typically recon
+00006c30: 7374 7275 6374 6564 2066 726f 6d20 7265  structed from re
+00006c40: 636f 7264 6564 2065 7665 6e74 7320 6279  corded events by
+00006c50: 2063 616c 6c69 6e67 0a61 206d 7574 6174   calling.a mutat
+00006c60: 6f72 2066 756e 6374 696f 6e20 666f 7220  or function for 
+00006c70: 6561 6368 2072 6563 6f72 6465 6420 6576  each recorded ev
+00006c80: 656e 742c 2065 766f 6c76 696e 6720 6672  ent, evolving fr
+00006c90: 6f6d 2061 6e20 696e 6974 6961 6c20 7374  om an initial st
+00006ca0: 6174 650a 604e 6f6e 6560 2074 6f20 7468  ate.`None` to th
+00006cb0: 6520 6375 7272 656e 7420 7374 6174 6520  e current state 
+00006cc0: 6f66 2074 6865 2061 6767 7265 6761 7465  of the aggregate
+00006cd0: 2e20 5468 6520 6675 6e63 7469 6f6e 2060  . The function `
+00006ce0: 6765 745f 6167 6772 6567 6174 6528 2960  get_aggregate()`
+00006cf0: 2073 686f 7773 0a68 6f77 2074 6869 7320   shows.how this 
+00006d00: 6361 6e20 6265 2064 6f6e 652e 2054 6865  can be done. The
+00006d10: 2061 6767 7265 6761 7465 2049 4420 6973   aggregate ID is
+00006d20: 2075 7365 6420 6173 2061 2073 7472 6561   used as a strea
+00006d30: 6d20 6e61 6d65 2e20 5468 6520 6578 6365  m name. The exce
+00006d40: 7074 696f 6e0a 6041 6767 7265 6761 7465  ption.`Aggregate
+00006d50: 4e6f 7446 6f75 6e64 6020 6973 2072 6169  NotFound` is rai
+00006d60: 7365 6420 6966 2074 6865 2061 6767 7265  sed if the aggre
+00006d70: 6761 7465 2073 7472 6561 6d20 6973 206e  gate stream is n
+00006d80: 6f74 2066 6f75 6e64 2e0a 0a60 6060 7079  ot found...```py
+00006d90: 7468 6f6e 0a64 6566 2067 6574 5f61 6767  thon.def get_agg
+00006da0: 7265 6761 7465 2861 6767 7265 6761 7465  regate(aggregate
+00006db0: 5f69 642c 206d 7574 6174 6f72 5f66 756e  _id, mutator_fun
+00006dc0: 6329 3a0a 2020 2020 7374 7265 616d 5f6e  c):.    stream_n
+00006dd0: 616d 6520 3d20 6167 6772 6567 6174 655f  ame = aggregate_
+00006de0: 6964 0a0a 2020 2020 2320 4765 7420 7265  id..    # Get re
+00006df0: 636f 7264 6564 2065 7665 6e74 732e 0a20  corded events.. 
+00006e00: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
+00006e10: 6576 656e 7473 203d 2063 6c69 656e 742e  events = client.
+00006e20: 7265 6164 5f73 7472 6561 6d5f 6576 656e  read_stream_even
+00006e30: 7473 280a 2020 2020 2020 2020 2020 2020  ts(.            
+00006e40: 7374 7265 616d 5f6e 616d 653d 7374 7265  stream_name=stre
+00006e50: 616d 5f6e 616d 652c 0a20 2020 2020 2020  am_name,.       
+00006e60: 2020 2020 2073 7472 6561 6d5f 706f 7369       stream_posi
+00006e70: 7469 6f6e 3d4e 6f6e 650a 2020 2020 2020  tion=None.      
+00006e80: 2020 290a 2020 2020 6578 6365 7074 204e    ).    except N
+00006e90: 6f74 466f 756e 6420 6173 2065 3a0a 2020  otFound as e:.  
+00006ea0: 2020 2020 2020 7261 6973 6520 4167 6772        raise Aggr
+00006eb0: 6567 6174 654e 6f74 466f 756e 6428 6167  egateNotFound(ag
+00006ec0: 6772 6567 6174 655f 6964 2920 6672 6f6d  gregate_id) from
+00006ed0: 2065 0a20 2020 2065 6c73 653a 0a20 2020   e.    else:.   
+00006ee0: 2020 2020 2023 2052 6563 6f6e 7374 7275       # Reconstru
+00006ef0: 6374 2061 6767 7265 6761 7465 2066 726f  ct aggregate fro
+00006f00: 6d20 7265 636f 7264 6564 2065 7665 6e74  m recorded event
+00006f10: 732e 0a20 2020 2020 2020 2061 6767 7265  s..        aggre
+00006f20: 6761 7465 203d 204e 6f6e 650a 2020 2020  gate = None.    
+00006f30: 2020 2020 666f 7220 6576 656e 7420 696e      for event in
+00006f40: 2065 7665 6e74 733a 0a20 2020 2020 2020   events:.       
+00006f50: 2020 2020 2061 6767 7265 6761 7465 203d       aggregate =
+00006f60: 206d 7574 6174 6f72 5f66 756e 6328 6167   mutator_func(ag
+00006f70: 6772 6567 6174 652c 2065 7665 6e74 290a  gregate, event).
+00006f80: 2020 2020 2020 2020 7265 7475 726e 2061          return a
+00006f90: 6767 7265 6761 7465 0a0a 0a63 6c61 7373  ggregate...class
+00006fa0: 2041 6767 7265 6761 7465 4e6f 7446 6f75   AggregateNotFou
+00006fb0: 6e64 2845 7863 6570 7469 6f6e 293a 0a20  nd(Exception):. 
+00006fc0: 2020 2022 2222 5261 6973 6564 2077 6865     """Raised whe
+00006fd0: 6e20 616e 2061 6767 7265 6761 7465 2069  n an aggregate i
+00006fe0: 7320 6e6f 7420 666f 756e 642e 2222 220a  s not found.""".
+00006ff0: 6060 600a 0a53 6e61 7073 686f 7473 2063  ```..Snapshots c
+00007000: 616e 2069 6d70 726f 7665 2074 6865 2070  an improve the p
+00007010: 6572 666f 726d 616e 6365 206f 6620 6167  erformance of ag
+00007020: 6772 6567 6174 6573 2074 6861 7420 776f  gregates that wo
+00007030: 756c 6420 6f74 6865 7277 6973 6520 6265  uld otherwise be
+00007040: 0a72 6563 6f6e 7374 7275 6374 6564 2066  .reconstructed f
+00007050: 726f 6d20 7665 7279 206c 6f6e 6720 7374  rom very long st
+00007060: 7265 616d 732e 2048 6f77 6576 6572 2c20  reams. However, 
+00007070: 6974 2069 7320 6765 6e65 7261 6c6c 7920  it is generally 
+00007080: 7265 636f 6d6d 656e 6465 6420 746f 0a64  recommended to.d
+00007090: 6573 6967 6e20 6167 6772 6567 6174 6573  esign aggregates
+000070a0: 2074 6f20 6861 7665 2061 2066 696e 6974   to have a finit
+000070b0: 6520 6c69 6665 6379 636c 652c 2061 6e64  e lifecycle, and
+000070c0: 2068 656e 6365 2072 656c 6174 6976 656c   hence relativel
+000070d0: 7920 7368 6f72 7420 7374 7265 616d 732c  y short streams,
+000070e0: 0a74 6865 7265 6279 2061 766f 6964 696e  .thereby avoidin
+000070f0: 6720 7468 6520 6e65 6564 2066 6f72 2073  g the need for s
+00007100: 6e61 7073 686f 7474 696e 672e 2054 6869  napshotting. Thi
+00007110: 7320 2268 6f77 2074 6f22 2073 6563 7469  s "how to" secti
+00007120: 6f6e 2069 7320 696e 7465 6e64 6564 0a6d  on is intended.m
+00007130: 6572 656c 7920 746f 2073 686f 7720 686f  erely to show ho
+00007140: 7720 736e 6170 7368 6f74 7469 6e67 206f  w snapshotting o
+00007150: 6620 6167 6772 6567 6174 6573 2063 616e  f aggregates can
+00007160: 2062 6520 696d 706c 656d 656e 7465 6420   be implemented 
+00007170: 7769 7468 2045 7665 6e74 5374 6f72 6544  with EventStoreD
+00007180: 420a 7573 696e 6720 7468 6973 2050 7974  B.using this Pyt
+00007190: 686f 6e20 636c 6965 6e74 2e0a 0a53 6e61  hon client...Sna
+000071a0: 7073 686f 7474 696e 6720 6f66 2061 6767  pshotting of agg
+000071b0: 7265 6761 7465 7320 6361 6e20 6265 2069  regates can be i
+000071c0: 6d70 6c65 6d65 6e74 6564 2062 7920 7265  mplemented by re
+000071d0: 636f 7264 696e 6720 7468 6520 6375 7272  cording the curr
+000071e0: 656e 7420 7374 6174 6520 6f66 0a61 6e20  ent state of.an 
+000071f0: 6167 6772 6567 6174 6520 6173 2061 206e  aggregate as a n
+00007200: 6577 2065 7665 6e74 2e0a 0a49 6620 616e  ew event...If an
+00007210: 2061 6767 7265 6761 7465 206f 626a 6563   aggregate objec
+00007220: 7420 6861 7320 6120 7665 7273 696f 6e20  t has a version 
+00007230: 6e75 6d62 6572 2074 6861 7420 636f 7272  number that corr
+00007240: 6573 706f 6e64 7320 746f 2074 6865 2073  esponds to the s
+00007250: 7472 6561 6d20 706f 7369 7469 6f6e 206f  tream position o
+00007260: 660a 7468 6520 6c61 7374 2065 7665 6e74  f.the last event
+00007270: 2074 6861 7420 7761 7320 7573 6564 2074   that was used t
+00007280: 6f20 7265 636f 6e73 7472 7563 7420 7468  o reconstruct th
+00007290: 6520 6167 6772 6567 6174 652c 2061 6e64  e aggregate, and
+000072a0: 2074 6869 7320 7665 7273 696f 6e20 6e75   this version nu
+000072b0: 6d62 6572 0a69 7320 7265 636f 7264 6564  mber.is recorded
+000072c0: 2069 6e20 7468 6520 736e 6170 7368 6f74   in the snapshot
+000072d0: 206d 6574 6164 6174 612c 2074 6865 6e20   metadata, then 
+000072e0: 616e 7920 6576 656e 7473 2074 6861 7420  any events that 
+000072f0: 6172 6520 7265 636f 7264 6564 2061 6674  are recorded aft
+00007300: 6572 2074 6865 0a73 6e61 7073 686f 7420  er the.snapshot 
+00007310: 6361 6e20 6265 2073 656c 6563 7465 6420  can be selected 
+00007320: 7573 696e 6720 7468 6973 2076 6572 7369  using this versi
+00007330: 6f6e 206e 756d 6265 722e 2054 6865 2061  on number. The a
+00007340: 6767 7265 6761 7465 2063 616e 2074 6865  ggregate can the
+00007350: 6e20 6265 0a72 6563 6f6e 7374 7275 6374  n be.reconstruct
+00007360: 6564 2066 726f 6d20 7468 6520 6c61 7374  ed from the last
+00007370: 2073 6e61 7073 686f 7420 616e 6420 616e   snapshot and an
+00007380: 7920 7375 6273 6571 7565 6e74 2065 7665  y subsequent eve
+00007390: 6e74 732c 2077 6974 686f 7574 2068 6176  nts, without hav
+000073a0: 696e 670a 746f 2072 6570 6c61 7920 7468  ing.to replay th
+000073b0: 6520 656e 7469 7265 2068 6973 746f 7279  e entire history
+000073c0: 2e0a 0a57 6520 7769 6c6c 2075 7365 2061  ...We will use a
+000073d0: 2073 6570 6172 6174 6520 7374 7265 616d   separate stream
+000073e0: 2066 6f72 2061 6e20 6167 6772 6567 6174   for an aggregat
+000073f0: 6527 7320 736e 6170 7368 6f74 7320 7468  e's snapshots th
+00007400: 6174 2069 7320 6e61 6d65 6420 6166 7465  at is named afte
+00007410: 7220 7468 650a 7374 7265 616d 2075 7365  r the.stream use
+00007420: 6420 666f 7220 7265 636f 7264 696e 6720  d for recording 
+00007430: 6974 7320 6576 656e 7473 2e20 5468 6520  its events. The 
+00007440: 6e61 6d65 206f 6620 7468 6520 736e 6170  name of the snap
+00007450: 7368 6f74 2073 7472 6561 6d20 7769 6c6c  shot stream will
+00007460: 2062 650a 636f 6e73 7472 7563 7465 6420   be.constructed 
+00007470: 6279 2070 7265 6669 7869 6e67 2074 6865  by prefixing the
+00007480: 2061 6767 7265 6761 7465 2773 2073 7472   aggregate's str
+00007490: 6561 6d20 6e61 6d65 2077 6974 6820 6027  eam name with `'
+000074a0: 2473 6e61 7073 686f 742d 2760 2e0a 0a60  $snapshot-'`...`
+000074b0: 6060 7079 7468 6f6e 0a53 4e41 5053 484f  ``python.SNAPSHO
+000074c0: 545f 5052 4546 4958 203d 2027 2473 6e61  T_PREFIX = '$sna
+000074d0: 7073 686f 742d 270a 0a64 6566 206d 616b  pshot-'..def mak
+000074e0: 655f 736e 6170 7368 6f74 5f73 7472 6561  e_snapshot_strea
+000074f0: 6d5f 6e61 6d65 2873 7472 6561 6d5f 6e61  m_name(stream_na
+00007500: 6d65 293a 0a20 2020 2072 6574 7572 6e20  me):.    return 
+00007510: 6627 7b53 4e41 5053 484f 545f 5052 4546  f'{SNAPSHOT_PREF
+00007520: 4958 7d7b 7374 7265 616d 5f6e 616d 657d  IX}{stream_name}
+00007530: 270a 0a0a 6465 6620 7374 7269 705f 736e  '...def strip_sn
+00007540: 6170 7368 6f74 5f73 7472 6561 6d5f 6e61  apshot_stream_na
+00007550: 6d65 2873 6e61 7073 686f 745f 7374 7265  me(snapshot_stre
+00007560: 616d 5f6e 616d 6529 3a0a 2020 2020 7265  am_name):.    re
+00007570: 7475 726e 2073 6e61 7073 686f 745f 7374  turn snapshot_st
+00007580: 7265 616d 5f6e 616d 652e 6c73 7472 6970  ream_name.lstrip
+00007590: 2853 4e41 5053 484f 545f 5052 4546 4958  (SNAPSHOT_PREFIX
+000075a0: 290a 6060 600a 0a4c 6574 2773 2072 6564  ).```..Let's red
+000075b0: 6566 696e 6520 7468 6520 6067 6574 5f61  efine the `get_a
+000075c0: 6767 7265 6761 7465 2829 6020 6675 6e63  ggregate()` func
+000075d0: 7469 6f6e 2c20 736f 2074 6861 7420 6974  tion, so that it
+000075e0: 206c 6f6f 6b73 2066 6f72 2061 2073 6e61   looks for a sna
+000075f0: 7073 686f 7420 6576 656e 742c 0a74 6865  pshot event,.the
+00007600: 6e20 7365 6c65 6374 7320 7375 6273 6571  n selects subseq
+00007610: 7565 6e74 2061 6767 7265 6761 7465 2065  uent aggregate e
+00007620: 7665 6e74 732c 2061 6e64 2074 6865 6e20  vents, and then 
+00007630: 6361 6c6c 7320 6120 6d75 7461 746f 7220  calls a mutator 
+00007640: 6675 6e63 7469 6f6e 2066 6f72 2065 6163  function for eac
+00007650: 680a 7265 636f 7264 6564 2065 7665 6e74  h.recorded event
+00007660: 2e20 5765 2077 696c 6c20 7573 6520 4a53  . We will use JS
+00007670: 4f4e 2074 6f20 7365 7269 616c 697a 6520  ON to serialize 
+00007680: 616e 6420 6465 7365 7269 616c 697a 6520  and deserialize 
+00007690: 5079 7468 6f6e 2060 6469 6374 6020 6f62  Python `dict` ob
+000076a0: 6a65 6374 732e 0a0a 4e6f 7469 6365 2074  jects...Notice t
+000076b0: 6861 7420 7468 6520 6167 6772 6567 6174  hat the aggregat
+000076c0: 6520 6576 656e 7473 2061 7265 2072 6561  e events are rea
+000076d0: 6420 6672 6f6d 2061 2073 7472 6561 6d20  d from a stream 
+000076e0: 666f 7220 6167 6772 6567 6174 650a 6576  for aggregate.ev
+000076f0: 656e 7473 2c20 7768 696c 7374 2074 6865  ents, whilst the
+00007700: 2073 6e61 7073 686f 7420 6973 2072 6561   snapshot is rea
+00007710: 6420 6672 6f6d 2061 2073 6570 6172 6174  d from a separat
+00007720: 6520 7374 7265 616d 2066 6f72 2061 6767  e stream for agg
+00007730: 7265 6761 7465 2073 6e61 7073 686f 7473  regate snapshots
+00007740: 2e0a 0a60 6060 7079 7468 6f6e 0a69 6d70  ...```python.imp
+00007750: 6f72 7420 6a73 6f6e 0a0a 0a64 6566 2067  ort json...def g
+00007760: 6574 5f61 6767 7265 6761 7465 2861 6767  et_aggregate(agg
+00007770: 7265 6761 7465 5f69 642c 206d 7574 6174  regate_id, mutat
+00007780: 6f72 5f66 756e 6329 3a0a 2020 2020 7374  or_func):.    st
+00007790: 7265 616d 5f6e 616d 6520 3d20 6167 6772  ream_name = aggr
+000077a0: 6567 6174 655f 6964 0a20 2020 2072 6563  egate_id.    rec
+000077b0: 6f72 6465 645f 6576 656e 7473 203d 205b  orded_events = [
+000077c0: 5d0a 0a20 2020 2023 204c 6f6f 6b20 666f  ]..    # Look fo
+000077d0: 7220 6120 736e 6170 7368 6f74 2e0a 2020  r a snapshot..  
+000077e0: 2020 7472 793a 0a20 2020 2020 2020 2073    try:.        s
+000077f0: 6e61 7073 686f 7473 203d 2063 6c69 656e  napshots = clien
+00007800: 742e 7265 6164 5f73 7472 6561 6d5f 6576  t.read_stream_ev
+00007810: 656e 7473 280a 2020 2020 2020 2020 2020  ents(.          
+00007820: 2020 7374 7265 616d 5f6e 616d 653d 6d61    stream_name=ma
+00007830: 6b65 5f73 6e61 7073 686f 745f 7374 7265  ke_snapshot_stre
+00007840: 616d 5f6e 616d 6528 7374 7265 616d 5f6e  am_name(stream_n
+00007850: 616d 6529 2c0a 2020 2020 2020 2020 2020  ame),.          
+00007860: 2020 6261 636b 7761 7264 733d 5472 7565    backwards=True
+00007870: 2c0a 2020 2020 2020 2020 2020 2020 6c69  ,.            li
+00007880: 6d69 743d 310a 2020 2020 2020 2020 290a  mit=1.        ).
+00007890: 2020 2020 6578 6365 7074 204e 6f74 466f      except NotFo
+000078a0: 756e 643a 0a20 2020 2020 2020 2073 7472  und:.        str
+000078b0: 6561 6d5f 706f 7369 7469 6f6e 203d 204e  eam_position = N
+000078c0: 6f6e 650a 2020 2020 656c 7365 3a0a 2020  one.    else:.  
+000078d0: 2020 2020 2020 736e 6170 7368 6f74 203d        snapshot =
+000078e0: 2073 6e61 7073 686f 7473 5b30 5d0a 2020   snapshots[0].  
+000078f0: 2020 2020 2020 7374 7265 616d 5f70 6f73        stream_pos
+00007900: 6974 696f 6e20 3d20 6465 7365 7269 616c  ition = deserial
+00007910: 697a 6528 736e 6170 7368 6f74 2e6d 6574  ize(snapshot.met
+00007920: 6164 6174 6129 5b27 7665 7273 696f 6e27  adata)['version'
+00007930: 5d20 2b20 310a 2020 2020 2020 2020 7265  ] + 1.        re
+00007940: 636f 7264 6564 5f65 7665 6e74 732e 6170  corded_events.ap
+00007950: 7065 6e64 2873 6e61 7073 686f 7429 0a0a  pend(snapshot)..
+00007960: 2020 2020 2320 4765 7420 7375 6273 6571      # Get subseq
+00007970: 7565 6e74 2065 7665 6e74 732e 0a20 2020  uent events..   
+00007980: 2074 7279 3a0a 2020 2020 2020 2020 6576   try:.        ev
+00007990: 656e 7473 203d 2063 6c69 656e 742e 7265  ents = client.re
+000079a0: 6164 5f73 7472 6561 6d5f 6576 656e 7473  ad_stream_events
+000079b0: 280a 2020 2020 2020 2020 2020 2020 7374  (.            st
+000079c0: 7265 616d 5f6e 616d 653d 7374 7265 616d  ream_name=stream
+000079d0: 5f6e 616d 652c 0a20 2020 2020 2020 2020  _name,.         
+000079e0: 2020 2073 7472 6561 6d5f 706f 7369 7469     stream_positi
+000079f0: 6f6e 3d73 7472 6561 6d5f 706f 7369 7469  on=stream_positi
+00007a00: 6f6e 0a20 2020 2020 2020 2029 0a20 2020  on.        ).   
+00007a10: 2065 7863 6570 7420 4e6f 7446 6f75 6e64   except NotFound
+00007a20: 2061 7320 653a 0a20 2020 2020 2020 2072   as e:.        r
+00007a30: 6169 7365 2041 6767 7265 6761 7465 4e6f  aise AggregateNo
+00007a40: 7446 6f75 6e64 2861 6767 7265 6761 7465  tFound(aggregate
+00007a50: 5f69 6429 2066 726f 6d20 650a 2020 2020  _id) from e.    
+00007a60: 656c 7365 3a0a 2020 2020 2020 2020 7265  else:.        re
+00007a70: 636f 7264 6564 5f65 7665 6e74 7320 2b3d  corded_events +=
+00007a80: 2065 7665 6e74 730a 0a20 2020 2023 2052   events..    # R
+00007a90: 6563 6f6e 7374 7275 6374 2061 6767 7265  econstruct aggre
+00007aa0: 6761 7465 2066 726f 6d20 7265 636f 7264  gate from record
+00007ab0: 6564 2065 7665 6e74 732e 0a20 2020 2061  ed events..    a
+00007ac0: 6767 7265 6761 7465 203d 204e 6f6e 650a  ggregate = None.
+00007ad0: 2020 2020 666f 7220 6576 656e 7420 696e      for event in
+00007ae0: 2072 6563 6f72 6465 645f 6576 656e 7473   recorded_events
+00007af0: 3a0a 2020 2020 2020 2020 6167 6772 6567  :.        aggreg
+00007b00: 6174 6520 3d20 6d75 7461 746f 725f 6675  ate = mutator_fu
+00007b10: 6e63 2861 6767 7265 6761 7465 2c20 6576  nc(aggregate, ev
+00007b20: 656e 7429 0a0a 2020 2020 7265 7475 726e  ent)..    return
+00007b30: 2061 6767 7265 6761 7465 0a0a 0a64 6566   aggregate...def
+00007b40: 2073 6572 6961 6c69 7a65 2864 293a 0a20   serialize(d):. 
+00007b50: 2020 2072 6574 7572 6e20 6a73 6f6e 2e64     return json.d
+00007b60: 756d 7073 2864 292e 656e 636f 6465 2829  umps(d).encode()
+00007b70: 0a0a 0a64 6566 2064 6573 6572 6961 6c69  ...def deseriali
+00007b80: 7a65 2873 293a 0a20 2020 2072 6574 7572  ze(s):.    retur
+00007b90: 6e20 6a73 6f6e 2e6c 6f61 6473 2873 2e64  n json.loads(s.d
+00007ba0: 6563 6f64 6528 2929 0a60 6060 0a0a 546f  ecode()).```..To
+00007bb0: 2073 686f 7720 686f 7720 7468 6973 2063   show how this c
+00007bc0: 616e 2062 6520 7573 6564 2c20 6c65 7427  an be used, let'
+00007bd0: 7320 6465 6669 6e65 2061 6e20 2269 6d6d  s define an "imm
+00007be0: 7574 6162 6c65 2220 6044 6f67 6020 6167  utable" `Dog` ag
+00007bf0: 6772 6567 6174 6520 636c 6173 732c 2077  gregate class, w
+00007c00: 6974 680a 6174 7472 6962 7574 6573 2060  ith.attributes `
+00007c10: 6e61 6d65 6020 616e 6420 6074 7269 636b  name` and `trick
+00007c20: 7360 2e20 5468 6520 6174 7472 6962 7574  s`. The attribut
+00007c30: 6573 2060 6964 6020 616e 6420 6076 6572  es `id` and `ver
+00007c40: 7369 6f6e 6020 7769 6c6c 2069 6e64 6963  sion` will indic
+00007c50: 6174 6520 616e 0a61 6767 7265 6761 7465  ate an.aggregate
+00007c60: 206f 626a 6563 7427 7320 4944 2061 6e64   object's ID and
+00007c70: 2076 6572 7369 6f6e 206e 756d 6265 722e   version number.
+00007c80: 2054 6865 2061 7474 7269 6275 7465 2060   The attribute `
+00007c90: 6973 5f66 726f 6d5f 736e 6170 7368 6f74  is_from_snapshot
+00007ca0: 6020 6973 2061 6464 6564 0a68 6572 6520  ` is added.here 
+00007cb0: 6d65 7265 6c79 2074 6f20 6465 6d6f 6e73  merely to demons
+00007cc0: 7472 6174 6520 6265 6c6f 7720 7768 656e  trate below when
+00007cd0: 2061 6e20 6167 6772 6567 6174 6520 6f62   an aggregate ob
+00007ce0: 6a65 6374 2068 6173 2062 6565 6e20 7265  ject has been re
+00007cf0: 636f 6e73 7472 7563 7465 6420 7573 696e  constructed usin
+00007d00: 670a 6120 736e 6170 7368 6f74 2e0a 0a60  g.a snapshot...`
+00007d10: 6060 7079 7468 6f6e 0a66 726f 6d20 6461  ``python.from da
+00007d20: 7461 636c 6173 7365 7320 696d 706f 7274  taclasses import
+00007d30: 2064 6174 6163 6c61 7373 0a0a 0a40 6461   dataclass...@da
+00007d40: 7461 636c 6173 7328 6672 6f7a 656e 3d54  taclass(frozen=T
+00007d50: 7275 6529 0a63 6c61 7373 2041 6767 7265  rue).class Aggre
+00007d60: 6761 7465 3a0a 2020 2020 6964 3a20 7374  gate:.    id: st
+00007d70: 720a 2020 2020 7665 7273 696f 6e3a 2069  r.    version: i
+00007d80: 6e74 0a20 2020 2069 735f 6672 6f6d 5f73  nt.    is_from_s
+00007d90: 6e61 7073 686f 743a 2062 6f6f 6c0a 0a0a  napshot: bool...
+00007da0: 4064 6174 6163 6c61 7373 2866 726f 7a65  @dataclass(froze
+00007db0: 6e3d 5472 7565 290a 636c 6173 7320 446f  n=True).class Do
+00007dc0: 6728 4167 6772 6567 6174 6529 3a0a 2020  g(Aggregate):.  
+00007dd0: 2020 6e61 6d65 3a20 7374 720a 2020 2020    name: str.    
+00007de0: 7472 6963 6b73 3a20 6c69 7374 0a0a 6060  tricks: list..``
+00007df0: 600a 0a4c 6574 2773 2061 6c73 6f20 6465  `..Let's also de
+00007e00: 6669 6e65 2061 206d 7574 6174 6f72 2066  fine a mutator f
+00007e10: 756e 6374 696f 6e20 606d 7574 6174 655f  unction `mutate_
+00007e20: 646f 6728 2960 2074 6861 7420 6361 6e20  dog()` that can 
+00007e30: 6576 6f6c 7665 2074 6865 2073 7461 7465  evolve the state
+00007e40: 206f 6620 610a 6044 6f67 6020 6167 6772   of a.`Dog` aggr
+00007e50: 6567 6174 6520 6769 7665 6e20 7661 7269  egate given vari
+00007e60: 6f75 7320 6469 6666 6572 656e 7420 7479  ous different ty
+00007e70: 7065 7320 6f66 2065 7665 6e74 732c 2060  pes of events, `
+00007e80: 2744 6f67 5265 6769 7374 6572 6564 2760  'DogRegistered'`
+00007e90: 2c0a 6027 446f 674c 6561 726e 6564 5472  ,.`'DogLearnedTr
+00007ea0: 6963 6b27 602c 2061 6e64 2060 2724 536e  ick'`, and `'$Sn
+00007eb0: 6170 7368 6f74 6027 2e20 5468 6520 736e  apshot`'. The sn
+00007ec0: 6170 7368 6f74 2065 7665 6e74 2074 7970  apshot event typ
+00007ed0: 6520 6973 2070 7265 6669 7865 6420 7769  e is prefixed wi
+00007ee0: 7468 0a60 2724 2760 2073 6f20 7468 6174  th.`'$'` so that
+00007ef0: 2069 7420 6361 6e20 6265 2066 696c 7465   it can be filte
+00007f00: 7265 6420 6f75 7420 7768 656e 2072 6561  red out when rea
+00007f10: 6469 6e67 2061 6c6c 2065 7665 6e74 7320  ding all events 
+00007f20: 6672 6f6d 2074 6865 2064 6174 6162 6173  from the databas
+00007f30: 652e 0a0a 6060 6070 7974 686f 6e0a 6465  e...```python.de
+00007f40: 6620 6d75 7461 7465 5f64 6f67 2864 6f67  f mutate_dog(dog
+00007f50: 2c20 6576 656e 7429 3a0a 2020 2020 6461  , event):.    da
+00007f60: 7461 203d 2064 6573 6572 6961 6c69 7a65  ta = deserialize
+00007f70: 2865 7665 6e74 2e64 6174 6129 0a20 2020  (event.data).   
+00007f80: 2069 6620 6576 656e 742e 7479 7065 203d   if event.type =
+00007f90: 3d20 2744 6f67 5265 6769 7374 6572 6564  = 'DogRegistered
+00007fa0: 273a 0a20 2020 2020 2020 2072 6574 7572  ':.        retur
+00007fb0: 6e20 446f 6728 0a20 2020 2020 2020 2020  n Dog(.         
+00007fc0: 2020 2069 643d 6576 656e 742e 7374 7265     id=event.stre
+00007fd0: 616d 5f6e 616d 652c 0a20 2020 2020 2020  am_name,.       
+00007fe0: 2020 2020 2076 6572 7369 6f6e 3d65 7665       version=eve
+00007ff0: 6e74 2e73 7472 6561 6d5f 706f 7369 7469  nt.stream_positi
+00008000: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
+00008010: 6973 5f66 726f 6d5f 736e 6170 7368 6f74  is_from_snapshot
+00008020: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
+00008030: 2020 2020 6e61 6d65 3d64 6174 615b 276e      name=data['n
+00008040: 616d 6527 5d2c 0a20 2020 2020 2020 2020  ame'],.         
+00008050: 2020 2074 7269 636b 733d 5b5d 2c0a 2020     tricks=[],.  
+00008060: 2020 2020 2020 290a 2020 2020 656c 6966        ).    elif
+00008070: 2065 7665 6e74 2e74 7970 6520 3d3d 2027   event.type == '
+00008080: 446f 674c 6561 726e 6564 5472 6963 6b27  DogLearnedTrick'
+00008090: 3a0a 2020 2020 2020 2020 6173 7365 7274  :.        assert
+000080a0: 2065 7665 6e74 2e73 7472 6561 6d5f 706f   event.stream_po
+000080b0: 7369 7469 6f6e 203d 3d20 646f 672e 7665  sition == dog.ve
+000080c0: 7273 696f 6e20 2b20 310a 2020 2020 2020  rsion + 1.      
+000080d0: 2020 6173 7365 7274 2065 7665 6e74 2e73    assert event.s
+000080e0: 7472 6561 6d5f 6e61 6d65 203d 3d20 646f  tream_name == do
+000080f0: 672e 6964 0a20 2020 2020 2020 2072 6574  g.id.        ret
+00008100: 7572 6e20 446f 6728 0a20 2020 2020 2020  urn Dog(.       
+00008110: 2020 2020 2069 643d 646f 672e 6964 2c0a       id=dog.id,.
+00008120: 2020 2020 2020 2020 2020 2020 7665 7273              vers
+00008130: 696f 6e3d 6576 656e 742e 7374 7265 616d  ion=event.stream
+00008140: 5f70 6f73 6974 696f 6e2c 0a20 2020 2020  _position,.     
+00008150: 2020 2020 2020 2069 735f 6672 6f6d 5f73         is_from_s
+00008160: 6e61 7073 686f 743d 646f 672e 6973 5f66  napshot=dog.is_f
+00008170: 726f 6d5f 736e 6170 7368 6f74 2c0a 2020  rom_snapshot,.  
+00008180: 2020 2020 2020 2020 2020 6e61 6d65 3d64            name=d
+00008190: 6f67 2e6e 616d 652c 0a20 2020 2020 2020  og.name,.       
+000081a0: 2020 2020 2074 7269 636b 733d 646f 672e       tricks=dog.
+000081b0: 7472 6963 6b73 202b 205b 6461 7461 5b27  tricks + [data['
+000081c0: 7472 6963 6b27 5d5d 2c0a 2020 2020 2020  trick']],.      
+000081d0: 2020 290a 2020 2020 656c 6966 2065 7665    ).    elif eve
+000081e0: 6e74 2e74 7970 6520 3d3d 2027 2453 6e61  nt.type == '$Sna
+000081f0: 7073 686f 7427 3a0a 2020 2020 2020 2020  pshot':.        
+00008200: 7265 7475 726e 2044 6f67 280a 2020 2020  return Dog(.    
+00008210: 2020 2020 2020 2020 6964 3d73 7472 6970          id=strip
+00008220: 5f73 6e61 7073 686f 745f 7374 7265 616d  _snapshot_stream
+00008230: 5f6e 616d 6528 6576 656e 742e 7374 7265  _name(event.stre
+00008240: 616d 5f6e 616d 6529 2c0a 2020 2020 2020  am_name),.      
+00008250: 2020 2020 2020 7665 7273 696f 6e3d 6465        version=de
+00008260: 7365 7269 616c 697a 6528 6576 656e 742e  serialize(event.
+00008270: 6d65 7461 6461 7461 295b 2776 6572 7369  metadata)['versi
+00008280: 6f6e 275d 2c0a 2020 2020 2020 2020 2020  on'],.          
+00008290: 2020 6973 5f66 726f 6d5f 736e 6170 7368    is_from_snapsh
+000082a0: 6f74 3d54 7275 652c 0a20 2020 2020 2020  ot=True,.       
+000082b0: 2020 2020 206e 616d 653d 6461 7461 5b27       name=data['
+000082c0: 6e61 6d65 275d 2c0a 2020 2020 2020 2020  name'],.        
+000082d0: 2020 2020 7472 6963 6b73 3d64 6174 615b      tricks=data[
+000082e0: 2774 7269 636b 7327 5d2c 0a20 2020 2020  'tricks'],.     
+000082f0: 2020 2029 0a20 2020 2065 6c73 653a 0a20     ).    else:. 
+00008300: 2020 2020 2020 2072 6169 7365 2045 7863         raise Exc
+00008310: 6570 7469 6f6e 2866 2255 6e6b 6e6f 776e  eption(f"Unknown
+00008320: 2065 7665 6e74 2074 7970 653a 207b 6576   event type: {ev
+00008330: 656e 742e 7479 7065 7d22 290a 6060 600a  ent.type}").```.
+00008340: 0a46 6f72 2063 6f6e 7665 6e69 656e 6365  .For convenience
+00008350: 2c20 6c65 7427 7320 616c 736f 2064 6566  , let's also def
+00008360: 696e 6520 6120 6067 6574 5f64 6f67 2829  ine a `get_dog()
+00008370: 6020 6675 6e63 7469 6f6e 2074 6861 7420  ` function that 
+00008380: 6361 6c6c 7320 6067 6574 5f61 6767 7265  calls `get_aggre
+00008390: 6761 7465 2829 600a 7769 7468 2074 6865  gate()`.with the
+000083a0: 2060 6d75 7461 7465 5f64 6f67 2829 6020   `mutate_dog()` 
+000083b0: 6675 6e63 7469 6f6e 2061 7320 7468 6520  function as the 
+000083c0: 606d 7574 6174 6f72 5f66 756e 6360 2061  `mutator_func` a
+000083d0: 7267 756d 656e 742e 0a0a 6060 6070 7974  rgument...```pyt
+000083e0: 686f 6e0a 6465 6620 6765 745f 646f 6728  hon.def get_dog(
+000083f0: 646f 675f 6964 293a 0a20 2020 2072 6574  dog_id):.    ret
+00008400: 7572 6e20 6765 745f 6167 6772 6567 6174  urn get_aggregat
+00008410: 6528 0a20 2020 2020 2020 2061 6767 7265  e(.        aggre
+00008420: 6761 7465 5f69 643d 646f 675f 6964 2c0a  gate_id=dog_id,.
+00008430: 2020 2020 2020 2020 6d75 7461 746f 725f          mutator_
+00008440: 6675 6e63 3d6d 7574 6174 655f 646f 672c  func=mutate_dog,
+00008450: 0a20 2020 2029 0a60 6060 0a0a 5765 2063  .    ).```..We c
+00008460: 616e 2061 6c73 6f20 6465 6669 6e65 2073  an also define s
+00008470: 6f6d 6520 2263 6f6d 6d61 6e64 2220 6675  ome "command" fu
+00008480: 6e63 7469 6f6e 7320 7468 6174 2061 7070  nctions that app
+00008490: 656e 6420 6e65 7720 6576 656e 7473 2074  end new events t
+000084a0: 6f20 7468 650a 6461 7461 6261 7365 2e20  o the.database. 
+000084b0: 5468 6520 6072 6567 6973 7465 725f 646f  The `register_do
+000084c0: 6728 2960 2066 756e 6374 696f 6e20 6170  g()` function ap
+000084d0: 7065 6e64 7320 6120 6044 6f67 5265 6769  pends a `DogRegi
+000084e0: 7374 6572 6564 6020 6576 656e 742e 2054  stered` event. T
+000084f0: 6865 0a60 7265 636f 7264 5f74 7269 636b  he.`record_trick
+00008500: 5f6c 6561 726e 6564 2829 6020 6170 7065  _learned()` appe
+00008510: 6e64 7320 6120 6044 6f67 4c65 6172 6e65  nds a `DogLearne
+00008520: 6454 7269 636b 6020 6576 656e 742e 2054  dTrick` event. T
+00008530: 6865 2066 756e 6374 696f 6e0a 6073 6e61  he function.`sna
+00008540: 7073 686f 745f 646f 6728 2960 2061 7070  pshot_dog()` app
+00008550: 656e 6473 2061 2060 2453 6e61 7073 686f  ends a `$Snapsho
+00008560: 7460 2065 7665 6e74 2e20 4e6f 7469 6365  t` event. Notice
+00008570: 2074 6861 7420 7468 650a 6072 6563 6f72   that the.`recor
+00008580: 645f 7472 6963 6b5f 6c65 6172 6e65 6428  d_trick_learned(
+00008590: 2960 2061 6e64 2060 736e 6170 7368 6f74  )` and `snapshot
+000085a0: 5f64 6f67 2829 6020 6675 6e63 7469 6f6e  _dog()` function
+000085b0: 7320 7573 6520 6067 6574 5f64 6f67 2829  s use `get_dog()
+000085c0: 602e 0a0a 4e6f 7469 6365 2061 6c73 6f20  `...Notice also 
+000085d0: 7468 6174 2074 6865 2060 446f 6752 6567  that the `DogReg
+000085e0: 6973 7465 7265 6460 2061 6e64 2060 446f  istered` and `Do
+000085f0: 674c 6561 726e 6564 5472 6963 6b60 2065  gLearnedTrick` e
+00008600: 7665 6e74 7320 6172 6520 6170 7065 6e64  vents are append
+00008610: 6564 2074 6f20 610a 7374 7265 616d 2066  ed to a.stream f
+00008620: 6f72 2061 6767 7265 6761 7465 2065 7665  or aggregate eve
+00008630: 6e74 732c 2077 6869 6c73 7420 7468 6520  nts, whilst the 
+00008640: 6024 536e 6170 7368 6f74 6020 6973 2061  `$Snapshot` is a
+00008650: 7070 656e 6465 6420 746f 2061 2073 6570  ppended to a sep
+00008660: 6172 6174 6520 7374 7265 616d 0a66 6f72  arate stream.for
+00008670: 2061 6767 7265 6761 7465 2073 6e61 7073   aggregate snaps
+00008680: 686f 7473 2e20 5468 6520 736e 6170 7368  hots. The snapsh
+00008690: 6f74 2065 7665 6e74 2074 7970 6520 6973  ot event type is
+000086a0: 2070 7265 6669 7865 6420 7769 7468 2060   prefixed with `
+000086b0: 2724 2760 2073 6f20 7468 6174 2069 7420  '$'` so that it 
+000086c0: 6361 6e0a 6265 2066 696c 7465 7265 6420  can.be filtered 
+000086d0: 6f75 7420 7768 656e 2072 6561 6469 6e67  out when reading
+000086e0: 2061 6c6c 2065 7665 6e74 7320 6672 6f6d   all events from
+000086f0: 2074 6865 2064 6174 6162 6173 652e 0a0a   the database...
+00008700: 6060 6070 7974 686f 6e0a 6465 6620 7265  ```python.def re
+00008710: 6769 7374 6572 5f64 6f67 286e 616d 6529  gister_dog(name)
+00008720: 3a0a 2020 2020 646f 675f 6964 203d 2073  :.    dog_id = s
+00008730: 7472 2875 7569 6434 2829 290a 2020 2020  tr(uuid4()).    
+00008740: 6576 656e 7420 3d20 4e65 7745 7665 6e74  event = NewEvent
+00008750: 280a 2020 2020 2020 2020 7479 7065 3d27  (.        type='
+00008760: 446f 6752 6567 6973 7465 7265 6427 2c0a  DogRegistered',.
+00008770: 2020 2020 2020 2020 6461 7461 3d73 6572          data=ser
+00008780: 6961 6c69 7a65 287b 276e 616d 6527 3a20  ialize({'name': 
+00008790: 6e61 6d65 7d29 2c0a 2020 2020 290a 2020  name}),.    ).  
+000087a0: 2020 636c 6965 6e74 2e61 7070 656e 645f    client.append_
+000087b0: 6576 656e 7428 0a20 2020 2020 2020 2073  event(.        s
+000087c0: 7472 6561 6d5f 6e61 6d65 3d64 6f67 5f69  tream_name=dog_i
+000087d0: 642c 0a20 2020 2020 2020 2065 7870 6563  d,.        expec
+000087e0: 7465 645f 706f 7369 7469 6f6e 3d4e 6f6e  ted_position=Non
+000087f0: 652c 0a20 2020 2020 2020 2065 7665 6e74  e,.        event
+00008800: 3d65 7665 6e74 2c0a 2020 2020 290a 2020  =event,.    ).  
+00008810: 2020 7265 7475 726e 2064 6f67 5f69 640a    return dog_id.
+00008820: 0a0a 6465 6620 7265 636f 7264 5f74 7269  ..def record_tri
+00008830: 636b 5f6c 6561 726e 6564 2864 6f67 5f69  ck_learned(dog_i
+00008840: 642c 2074 7269 636b 293a 0a20 2020 2064  d, trick):.    d
+00008850: 6f67 203d 2067 6574 5f64 6f67 2864 6f67  og = get_dog(dog
+00008860: 5f69 6429 0a20 2020 2065 7665 6e74 203d  _id).    event =
+00008870: 204e 6577 4576 656e 7428 0a20 2020 2020   NewEvent(.     
+00008880: 2020 2074 7970 653d 2744 6f67 4c65 6172     type='DogLear
+00008890: 6e65 6454 7269 636b 272c 0a20 2020 2020  nedTrick',.     
+000088a0: 2020 2064 6174 613d 7365 7269 616c 697a     data=serializ
+000088b0: 6528 7b27 7472 6963 6b27 3a20 7472 6963  e({'trick': tric
+000088c0: 6b7d 292c 0a20 2020 2029 0a20 2020 2063  k}),.    ).    c
+000088d0: 6c69 656e 742e 6170 7065 6e64 5f65 7665  lient.append_eve
+000088e0: 6e74 280a 2020 2020 2020 2020 7374 7265  nt(.        stre
+000088f0: 616d 5f6e 616d 653d 646f 675f 6964 2c0a  am_name=dog_id,.
+00008900: 2020 2020 2020 2020 6578 7065 6374 6564          expected
+00008910: 5f70 6f73 6974 696f 6e3d 646f 672e 7665  _position=dog.ve
+00008920: 7273 696f 6e2c 0a20 2020 2020 2020 2065  rsion,.        e
+00008930: 7665 6e74 3d65 7665 6e74 2c0a 2020 2020  vent=event,.    
+00008940: 290a 0a0a 6465 6620 736e 6170 7368 6f74  )...def snapshot
+00008950: 5f64 6f67 2864 6f67 5f69 6429 3a0a 2020  _dog(dog_id):.  
+00008960: 2020 646f 6720 3d20 6765 745f 646f 6728    dog = get_dog(
+00008970: 646f 675f 6964 290a 2020 2020 6576 656e  dog_id).    even
+00008980: 7420 3d20 4e65 7745 7665 6e74 280a 2020  t = NewEvent(.  
+00008990: 2020 2020 2020 7479 7065 3d27 2453 6e61        type='$Sna
+000089a0: 7073 686f 7427 2c0a 2020 2020 2020 2020  pshot',.        
+000089b0: 6461 7461 3d73 6572 6961 6c69 7a65 287b  data=serialize({
+000089c0: 276e 616d 6527 3a20 646f 672e 6e61 6d65  'name': dog.name
+000089d0: 2c20 2774 7269 636b 7327 3a20 646f 672e  , 'tricks': dog.
+000089e0: 7472 6963 6b73 7d29 2c0a 2020 2020 2020  tricks}),.      
+000089f0: 2020 6d65 7461 6461 7461 3d73 6572 6961    metadata=seria
+00008a00: 6c69 7a65 287b 2776 6572 7369 6f6e 273a  lize({'version':
+00008a10: 2064 6f67 2e76 6572 7369 6f6e 7d29 2c0a   dog.version}),.
+00008a20: 2020 2020 290a 2020 2020 636c 6965 6e74      ).    client
+00008a30: 2e61 7070 656e 645f 6576 656e 7428 0a20  .append_event(. 
+00008a40: 2020 2020 2020 2073 7472 6561 6d5f 6e61         stream_na
+00008a50: 6d65 3d6d 616b 655f 736e 6170 7368 6f74  me=make_snapshot
+00008a60: 5f73 7472 6561 6d5f 6e61 6d65 2864 6f67  _stream_name(dog
+00008a70: 5f69 6429 2c0a 2020 2020 2020 2020 6578  _id),.        ex
+00008a80: 7065 6374 6564 5f70 6f73 6974 696f 6e3d  pected_position=
+00008a90: 2d31 2c0a 2020 2020 2020 2020 6576 656e  -1,.        even
+00008aa0: 743d 6576 656e 742c 0a20 2020 2029 0a60  t=event,.    ).`
+00008ab0: 6060 0a0a 4e6f 7720 7765 2063 616e 2072  ``..Now we can r
+00008ac0: 6567 6973 7465 7220 6120 6e65 7720 646f  egister a new do
+00008ad0: 672c 2061 6e64 2072 6563 6f72 6420 7468  g, and record th
+00008ae0: 6174 2073 6f6d 6520 7472 6963 6b73 2068  at some tricks h
+00008af0: 6176 6520 6265 656e 206c 6561 726e 6564  ave been learned
+00008b00: 2e0a 0a60 6060 7079 7468 6f6e 0a23 2052  ...```python.# R
+00008b10: 6567 6973 7465 7220 6120 6e65 7720 646f  egister a new do
+00008b20: 672e 0a64 6f67 5f69 6420 3d20 7265 6769  g..dog_id = regi
+00008b30: 7374 6572 5f64 6f67 2827 4669 646f 2729  ster_dog('Fido')
+00008b40: 0a0a 646f 6720 3d20 6765 745f 646f 6728  ..dog = get_dog(
+00008b50: 646f 675f 6964 290a 6173 7365 7274 2064  dog_id).assert d
+00008b60: 6f67 2e6e 616d 6520 3d3d 2027 4669 646f  og.name == 'Fido
+00008b70: 270a 6173 7365 7274 2064 6f67 2e74 7269  '.assert dog.tri
+00008b80: 636b 7320 3d3d 205b 5d0a 6173 7365 7274  cks == [].assert
+00008b90: 2064 6f67 2e76 6572 7369 6f6e 203d 3d20   dog.version == 
+00008ba0: 300a 6173 7365 7274 2064 6f67 2e69 735f  0.assert dog.is_
+00008bb0: 6672 6f6d 5f73 6e61 7073 686f 7420 6973  from_snapshot is
+00008bc0: 2046 616c 7365 0a0a 0a23 2052 6563 6f72   False...# Recor
+00008bd0: 6420 7468 6174 2027 4669 646f 2720 6c65  d that 'Fido' le
+00008be0: 6172 6e65 6420 6120 6e65 7720 7472 6963  arned a new tric
+00008bf0: 6b2e 0a72 6563 6f72 645f 7472 6963 6b5f  k..record_trick_
+00008c00: 6c65 6172 6e65 6428 646f 675f 6964 2c20  learned(dog_id, 
+00008c10: 7472 6963 6b3d 2772 6f6c 6c20 6f76 6572  trick='roll over
+00008c20: 2729 0a0a 646f 6720 3d20 6765 745f 646f  ')..dog = get_do
+00008c30: 6728 646f 675f 6964 290a 6173 7365 7274  g(dog_id).assert
+00008c40: 2064 6f67 2e6e 616d 6520 3d3d 2027 4669   dog.name == 'Fi
+00008c50: 646f 270a 6173 7365 7274 2064 6f67 2e74  do'.assert dog.t
+00008c60: 7269 636b 7320 3d3d 205b 2772 6f6c 6c20  ricks == ['roll 
+00008c70: 6f76 6572 275d 0a61 7373 6572 7420 646f  over'].assert do
+00008c80: 672e 7665 7273 696f 6e20 3d3d 2031 0a61  g.version == 1.a
+00008c90: 7373 6572 7420 646f 672e 6973 5f66 726f  ssert dog.is_fro
+00008ca0: 6d5f 736e 6170 7368 6f74 2069 7320 4661  m_snapshot is Fa
+00008cb0: 6c73 650a 0a0a 2320 5265 636f 7264 2074  lse...# Record t
+00008cc0: 6861 7420 2746 6964 6f27 206c 6561 726e  hat 'Fido' learn
+00008cd0: 6564 2061 6e6f 7468 6572 206e 6577 2074  ed another new t
+00008ce0: 7269 636b 2e0a 7265 636f 7264 5f74 7269  rick..record_tri
+00008cf0: 636b 5f6c 6561 726e 6564 2864 6f67 5f69  ck_learned(dog_i
+00008d00: 642c 2074 7269 636b 3d27 6665 7463 6820  d, trick='fetch 
+00008d10: 6261 6c6c 2729 0a0a 646f 6720 3d20 6765  ball')..dog = ge
+00008d20: 745f 646f 6728 646f 675f 6964 290a 6173  t_dog(dog_id).as
+00008d30: 7365 7274 2064 6f67 2e6e 616d 6520 3d3d  sert dog.name ==
+00008d40: 2027 4669 646f 270a 6173 7365 7274 2064   'Fido'.assert d
+00008d50: 6f67 2e74 7269 636b 7320 3d3d 205b 2772  og.tricks == ['r
+00008d60: 6f6c 6c20 6f76 6572 272c 2027 6665 7463  oll over', 'fetc
+00008d70: 6820 6261 6c6c 275d 0a61 7373 6572 7420  h ball'].assert 
+00008d80: 646f 672e 7665 7273 696f 6e20 3d3d 2032  dog.version == 2
+00008d90: 0a61 7373 6572 7420 646f 672e 6973 5f66  .assert dog.is_f
+00008da0: 726f 6d5f 736e 6170 7368 6f74 2069 7320  rom_snapshot is 
+00008db0: 4661 6c73 650a 6060 600a 0a41 6674 6572  False.```..After
+00008dc0: 2077 6520 6361 6c6c 2060 736e 6170 7368   we call `snapsh
+00008dd0: 6f74 5f64 6f67 2829 602c 2074 6865 2060  ot_dog()`, the `
+00008de0: 6765 745f 646f 6728 2960 2066 756e 6374  get_dog()` funct
+00008df0: 696f 6e20 7769 6c6c 2072 6574 7572 6e20  ion will return 
+00008e00: 6120 6044 6f67 600a 6f62 6a65 6374 2074  a `Dog`.object t
+00008e10: 6861 7420 6861 7320 6265 656e 2063 6f6e  hat has been con
+00008e20: 7374 7275 6374 6564 2075 7369 6e67 2074  structed using t
+00008e30: 6865 2060 2453 6e61 7073 686f 7460 2065  he `$Snapshot` e
+00008e40: 7665 6e74 2e0a 0a60 6060 7079 7468 6f6e  vent...```python
+00008e50: 0a23 2053 6e61 7073 686f 7420 2746 6964  .# Snapshot 'Fid
+00008e60: 6f27 2e0a 736e 6170 7368 6f74 5f64 6f67  o'..snapshot_dog
+00008e70: 2864 6f67 5f69 6429 0a0a 646f 6720 3d20  (dog_id)..dog = 
+00008e80: 6765 745f 646f 6728 646f 675f 6964 290a  get_dog(dog_id).
+00008e90: 6173 7365 7274 2064 6f67 2e6e 616d 6520  assert dog.name 
+00008ea0: 3d3d 2027 4669 646f 270a 6173 7365 7274  == 'Fido'.assert
+00008eb0: 2064 6f67 2e74 7269 636b 7320 3d3d 205b   dog.tricks == [
+00008ec0: 2772 6f6c 6c20 6f76 6572 272c 2027 6665  'roll over', 'fe
+00008ed0: 7463 6820 6261 6c6c 275d 0a61 7373 6572  tch ball'].asser
+00008ee0: 7420 646f 672e 7665 7273 696f 6e20 3d3d  t dog.version ==
+00008ef0: 2032 0a61 7373 6572 7420 646f 672e 6973   2.assert dog.is
+00008f00: 5f66 726f 6d5f 736e 6170 7368 6f74 2069  _from_snapshot i
+00008f10: 7320 5472 7565 0a60 6060 0a0a 5765 2063  s True.```..We c
+00008f20: 616e 2063 6f6e 7469 6e75 6520 746f 2065  an continue to e
+00008f30: 766f 6c76 6520 7468 6520 7374 6174 6520  volve the state 
+00008f40: 6f66 2074 6865 2060 446f 6760 2061 6767  of the `Dog` agg
+00008f50: 7265 6761 7465 2c20 7573 696e 670a 7468  regate, using.th
+00008f60: 6520 736e 6170 7368 6f74 2062 6f74 6820  e snapshot both 
+00008f70: 6475 7269 6e67 2074 6865 2063 616c 6c20  during the call 
+00008f80: 7468 6520 6072 6563 6f72 645f 7472 6963  the `record_tric
+00008f90: 6b5f 6c65 6172 6e65 6428 2960 2061 6e64  k_learned()` and
+00008fa0: 0a77 6865 6e20 6361 6c6c 696e 6720 6067  .when calling `g
+00008fb0: 6574 5f64 6f67 2829 602e 0a0a 6060 6070  et_dog()`...```p
+00008fc0: 7974 686f 6e0a 7265 636f 7264 5f74 7269  ython.record_tri
+00008fd0: 636b 5f6c 6561 726e 6564 2864 6f67 5f69  ck_learned(dog_i
+00008fe0: 642c 2074 7269 636b 3d27 7369 7427 290a  d, trick='sit').
+00008ff0: 0a64 6f67 203d 2067 6574 5f64 6f67 2864  .dog = get_dog(d
+00009000: 6f67 5f69 6429 0a61 7373 6572 7420 646f  og_id).assert do
+00009010: 672e 6e61 6d65 203d 3d20 2746 6964 6f27  g.name == 'Fido'
+00009020: 0a61 7373 6572 7420 646f 672e 7472 6963  .assert dog.tric
+00009030: 6b73 203d 3d20 5b27 726f 6c6c 206f 7665  ks == ['roll ove
+00009040: 7227 2c20 2766 6574 6368 2062 616c 6c27  r', 'fetch ball'
+00009050: 2c20 2773 6974 275d 0a61 7373 6572 7420  , 'sit'].assert 
+00009060: 646f 672e 7665 7273 696f 6e20 3d3d 2033  dog.version == 3
+00009070: 0a61 7373 6572 7420 646f 672e 6973 5f66  .assert dog.is_f
+00009080: 726f 6d5f 736e 6170 7368 6f74 2069 7320  rom_snapshot is 
+00009090: 5472 7565 0a60 6060 0a0a 5765 2063 616e  True.```..We can
+000090a0: 2073 6565 2066 726f 6d20 7468 6520 6069   see from the `i
+000090b0: 735f 6672 6f6d 5f73 6e61 7073 686f 7460  s_from_snapshot`
+000090c0: 2061 7474 7269 6275 7465 2074 6861 7420   attribute that 
+000090d0: 7468 6520 6044 6f67 6020 6f62 6a65 6374  the `Dog` object
+000090e0: 2077 6173 2069 6e64 6565 640a 7265 636f   was indeed.reco
+000090f0: 6e73 7472 7563 7465 6420 6672 6f6d 2074  nstructed from t
+00009100: 6865 2073 6e61 7073 686f 742e 0a0a 0a23  he snapshot....#
+00009110: 2323 2052 6561 6420 616c 6c20 6576 656e  ## Read all even
+00009120: 7473 0a0a 5468 6520 6d65 7468 6f64 2060  ts..The method `
+00009130: 7265 6164 5f61 6c6c 5f65 7665 6e74 7328  read_all_events(
+00009140: 2960 2063 616e 2062 6520 7573 6564 2074  )` can be used t
+00009150: 6f20 7265 6164 2061 6c6c 2072 6563 6f72  o read all recor
+00009160: 6465 6420 6576 656e 7473 0a69 6e20 7468  ded events.in th
+00009170: 6520 6461 7461 6261 7365 2069 6e20 7468  e database in th
+00009180: 6520 6f72 6465 7220 7468 6579 2077 6572  e order they wer
+00009190: 6520 7265 636f 7264 6564 2e20 4974 2072  e recorded. It r
+000091a0: 6574 7572 6e73 2061 6e20 6974 6572 6162  eturns an iterab
+000091b0: 6c65 206f 660a 6576 656e 7473 2074 6861  le of.events tha
+000091c0: 7420 6861 7665 2062 6565 6e20 7265 636f  t have been reco
+000091d0: 7264 6564 2069 6e20 7468 6520 6461 7461  rded in the data
+000091e0: 6261 7365 2e20 4974 6572 6174 696e 6720  base. Iterating 
+000091f0: 6f76 6572 2074 6869 7320 6974 6572 6162  over this iterab
+00009200: 6c65 0a6f 626a 6563 7420 7769 6c6c 2073  le.object will s
+00009210: 746f 7020 7768 656e 2069 7420 6861 7320  top when it has 
+00009220: 7969 656c 6465 6420 7468 6520 6c61 7374  yielded the last
+00009230: 2072 6563 6f72 6465 6420 6576 656e 742e   recorded event.
+00009240: 2054 6865 2072 6563 6569 7665 640a 7265   The received.re
+00009250: 636f 7264 6564 2065 7665 6e74 206f 626a  corded event obj
+00009260: 6563 7420 6172 6520 696e 7374 616e 6365  ect are instance
+00009270: 7320 6f66 2074 6865 2060 5265 636f 7264  s of the `Record
+00009280: 6564 4576 656e 7460 2063 6c61 7373 2028  edEvent` class (
+00009290: 7365 6520 7468 650a 4e6f 7465 7320 7365  see the.Notes se
+000092a0: 6374 696f 6e20 6265 6c6f 7720 666f 7220  ction below for 
+000092b0: 6465 7461 696c 7320 6f66 2074 6869 7320  details of this 
+000092c0: 636c 6173 7329 2e0a 0a54 6869 7320 6d65  class)...This me
+000092d0: 7468 6f64 2073 7570 706f 7274 7320 7365  thod supports se
+000092e0: 7665 6e20 6f70 7469 6f6e 616c 2061 7267  ven optional arg
+000092f0: 756d 656e 7473 2c20 6063 6f6d 6d69 745f  uments, `commit_
+00009300: 706f 7369 7469 6f6e 602c 2060 6261 636b  position`, `back
+00009310: 7761 7264 7360 2c0a 6066 696c 7465 725f  wards`,.`filter_
+00009320: 6578 636c 7564 6560 2c20 6066 696c 7465  exclude`, `filte
+00009330: 725f 696e 636c 7564 6560 2c20 6066 696c  r_include`, `fil
+00009340: 7465 725f 6279 5f73 7472 6561 6d5f 6e61  ter_by_stream_na
+00009350: 6d65 602c 2060 6c69 6d69 7460 2c20 616e  me`, `limit`, an
+00009360: 6420 6074 696d 656f 7574 602e 0a0a 5468  d `timeout`...Th
+00009370: 6520 6f70 7469 6f6e 616c 2060 636f 6d6d  e optional `comm
+00009380: 6974 5f70 6f73 6974 696f 6e60 2061 7267  it_position` arg
+00009390: 756d 656e 7420 6973 2061 6e20 6f70 7469  ument is an opti
+000093a0: 6f6e 616c 2069 6e74 6567 6572 2074 6861  onal integer tha
+000093b0: 7420 6361 6e20 6265 2075 7365 6420 746f  t can be used to
+000093c0: 0a73 7065 6369 6679 2074 6865 2063 6f6d  .specify the com
+000093d0: 6d69 7420 706f 7369 7469 6f6e 2066 726f  mit position fro
+000093e0: 6d20 7768 6963 6820 746f 2073 7461 7274  m which to start
+000093f0: 2072 6561 6469 6e67 2e20 5468 6973 2061   reading. This a
+00009400: 7267 756d 656e 7420 6973 2060 4e6f 6e65  rgument is `None
+00009410: 6020 6279 0a64 6566 6175 6c74 2c20 6d65  ` by.default, me
+00009420: 616e 696e 6720 7468 6174 2061 6c6c 2074  aning that all t
+00009430: 6865 2065 7665 6e74 7320 7769 6c6c 2062  he events will b
+00009440: 6520 7265 6164 2065 6974 6865 7220 6672  e read either fr
+00009450: 6f6d 2074 6865 2073 7461 7274 2c20 6f72  om the start, or
+00009460: 0a66 726f 6d20 7468 6520 656e 6420 6966  .from the end if
+00009470: 2060 6261 636b 7761 7264 7360 2069 7320   `backwards` is 
+00009480: 6054 7275 6560 2e20 506c 6561 7365 206e  `True`. Please n
+00009490: 6f74 652c 2069 6620 6120 636f 6d6d 6974  ote, if a commit
+000094a0: 2070 6f73 6974 696f 6e20 6973 2073 7065   position is spe
+000094b0: 6369 6669 6564 2c0a 6974 206d 7573 7420  cified,.it must 
+000094c0: 6265 2061 6e20 6163 7475 616c 6c79 2065  be an actually e
+000094d0: 7869 7374 696e 6720 636f 6d6d 6974 2070  xisting commit p
+000094e0: 6f73 6974 696f 6e20 696e 2074 6865 2064  osition in the d
+000094f0: 6174 6162 6173 652e 0a41 6e79 206f 7468  atabase..Any oth
+00009500: 6572 206e 756d 6265 7220 7769 6c6c 2072  er number will r
+00009510: 6573 756c 7420 696e 2061 2073 6572 7665  esult in a serve
+00009520: 7220 6572 726f 7220 2861 7420 6c65 6173  r error (at leas
+00009530: 7420 696e 2045 7665 6e74 5374 6f72 6544  t in EventStoreD
+00009540: 4220 7632 312e 3130 292e 0a0a 5468 6520  B v21.10)...The 
+00009550: 6f70 7469 6f6e 616c 2060 6261 636b 7761  optional `backwa
+00009560: 7264 7360 2061 7267 756d 656e 7420 6973  rds` argument is
+00009570: 2061 2050 7974 686f 6e20 6062 6f6f 6c60   a Python `bool`
+00009580: 2e20 5468 6520 6465 6661 756c 7420 6973  . The default is
+00009590: 2060 4661 6c73 6560 2c20 7768 6963 680a   `False`, which.
+000095a0: 6d65 616e 7320 7468 6520 6461 7461 6261  means the databa
+000095b0: 7365 2077 696c 6c20 6265 2072 6561 6420  se will be read 
+000095c0: 666f 7277 6172 6473 2062 7920 6465 6661  forwards by defa
+000095d0: 756c 742c 2073 6f20 7468 6174 2065 7665  ult, so that eve
+000095e0: 6e74 7320 6172 6520 7265 7475 726e 6564  nts are returned
+000095f0: 2069 6e20 7468 650a 6f72 6465 7220 7468   in the.order th
+00009600: 6579 2077 6572 6520 7265 636f 7264 6564  ey were recorded
+00009610: 2c20 4966 2060 6261 636b 7761 7264 7360  , If `backwards`
+00009620: 2069 7320 6054 7275 6560 2c20 7468 6520   is `True`, the 
+00009630: 6576 656e 7473 2061 7265 2072 6574 7572  events are retur
+00009640: 6e65 6420 696e 2072 6576 6572 7365 0a6f  ned in reverse.o
+00009650: 7264 6572 2e0a 0a54 6865 206f 7074 696f  rder...The optio
+00009660: 6e61 6c20 6066 696c 7465 725f 6578 636c  nal `filter_excl
+00009670: 7564 6560 2061 7267 756d 656e 7420 6973  ude` argument is
+00009680: 2061 2073 6571 7565 6e63 6520 6f66 2072   a sequence of r
+00009690: 6567 756c 6172 2065 7870 7265 7373 696f  egular expressio
+000096a0: 6e73 2074 6861 740a 6d61 7463 6820 7265  ns that.match re
+000096b0: 636f 7264 6564 2065 7665 6e74 7320 7468  corded events th
+000096c0: 6174 2073 686f 756c 6420 6e6f 7420 6265  at should not be
+000096d0: 2069 6e63 6c75 6465 642e 2054 6869 7320   included. This 
+000096e0: 6172 6775 6d65 6e74 2069 7320 6967 6e6f  argument is igno
+000096f0: 7265 640a 6966 2060 6669 6c74 6572 5f69  red.if `filter_i
+00009700: 6e63 6c75 6465 6020 6973 2073 6574 2074  nclude` is set t
+00009710: 6f20 6120 6e6f 6e2d 656d 7074 7920 7365  o a non-empty se
+00009720: 7175 656e 6365 2e20 4279 2064 6566 6175  quence. By defau
+00009730: 6c74 2c20 7468 6973 2061 7267 756d 656e  lt, this argumen
+00009740: 7420 6973 2073 6574 0a74 6f20 6d61 7463  t is set.to matc
+00009750: 6820 7468 6520 6576 656e 7420 7479 7065  h the event type
+00009760: 7320 6f66 2022 7379 7374 656d 2065 7665  s of "system eve
+00009770: 6e74 7322 2c20 736f 2074 6861 7420 4576  nts", so that Ev
+00009780: 656e 7453 746f 7265 4442 2073 7973 7465  entStoreDB syste
+00009790: 6d20 6576 656e 7473 0a77 696c 6c20 6e6f  m events.will no
+000097a0: 7420 6e6f 726d 616c 6c79 2062 6520 696e  t normally be in
+000097b0: 636c 7564 6564 2e20 5365 6520 7468 6520  cluded. See the 
+000097c0: 4e6f 7465 7320 7365 6374 696f 6e20 6265  Notes section be
+000097d0: 6c6f 7720 666f 7220 6d6f 7265 2069 6e66  low for more inf
+000097e0: 6f72 6d61 7469 6f6e 0a61 626f 7574 2066  ormation.about f
+000097f0: 696c 7465 7220 6578 7072 6573 7369 6f6e  ilter expression
+00009800: 732e 0a0a 5468 6520 6f70 7469 6f6e 616c  s...The optional
+00009810: 2060 6669 6c74 6572 5f69 6e63 6c75 6465   `filter_include
+00009820: 6020 6172 6775 6d65 6e74 2069 7320 6120  ` argument is a 
+00009830: 7365 7175 656e 6365 206f 6620 7265 6775  sequence of regu
+00009840: 6c61 7220 6578 7072 6573 7369 6f6e 730a  lar expressions.
+00009850: 7468 6174 206d 6174 6368 2072 6563 6f72  that match recor
+00009860: 6465 6420 6576 656e 7473 2074 6861 7420  ded events that 
+00009870: 7368 6f75 6c64 2062 6520 696e 636c 7564  should be includ
+00009880: 6564 2e20 4279 2064 6566 6175 6c74 2c20  ed. By default, 
+00009890: 7468 6973 2061 7267 756d 656e 740a 6973  this argument.is
+000098a0: 2061 6e20 656d 7074 7920 7475 706c 652e   an empty tuple.
+000098b0: 2049 6620 7468 6973 2061 7267 756d 656e   If this argumen
+000098c0: 7420 6973 2073 6574 2074 6f20 6120 6e6f  t is set to a no
+000098d0: 6e2d 656d 7074 7920 7365 7175 656e 6365  n-empty sequence
+000098e0: 2c20 7468 650a 6066 696c 7465 725f 6578  , the.`filter_ex
+000098f0: 636c 7564 6560 2061 7267 756d 656e 7420  clude` argument 
+00009900: 6973 2069 676e 6f72 6564 2e0a 0a54 6865  is ignored...The
+00009910: 206f 7074 696f 6e61 6c20 6066 696c 7465   optional `filte
+00009920: 725f 6279 5f73 7472 6561 6d5f 6e61 6d65  r_by_stream_name
+00009930: 6020 6172 6775 6d65 6e74 2069 7320 6120  ` argument is a 
+00009940: 5079 7468 6f6e 2060 626f 6f6c 6020 7468  Python `bool` th
+00009950: 6174 2069 6e64 6963 6174 6573 2077 6865  at indicates whe
+00009960: 7468 6572 0a74 6865 2066 696c 7465 7220  ther.the filter 
+00009970: 7769 6c6c 2061 7070 6c79 2074 6f20 6576  will apply to ev
+00009980: 656e 7420 7479 7065 7320 6f72 2073 7472  ent types or str
+00009990: 6561 6d20 6e61 6d65 732e 2042 7920 6465  eam names. By de
+000099a0: 6661 756c 742c 2074 6869 7320 7661 6c75  fault, this valu
+000099b0: 6520 6973 2060 4661 6c73 6560 0a61 6e64  e is `False`.and
+000099c0: 2073 6f20 7468 6520 6669 6c74 6572 696e   so the filterin
+000099d0: 6720 7769 6c6c 2061 7070 6c79 2074 6f20  g will apply to 
+000099e0: 7468 6520 6576 656e 7420 7479 7065 2073  the event type s
+000099f0: 7472 696e 6773 206f 6620 7265 636f 7264  trings of record
+00009a00: 6564 2065 7665 6e74 732e 0a0a 5468 6520  ed events...The 
+00009a10: 6f70 7469 6f6e 616c 2060 6c69 6d69 7460  optional `limit`
+00009a20: 2061 7267 756d 656e 7420 6973 2061 6e20   argument is an 
+00009a30: 696e 7465 6765 7220 7768 6963 6820 7265  integer which re
+00009a40: 7374 7269 6374 7320 7468 6520 6e75 6d62  stricts the numb
+00009a50: 6572 206f 6620 6576 656e 7473 2074 6861  er of events tha
+00009a60: 740a 7769 6c6c 2062 6520 7265 7475 726e  t.will be return
+00009a70: 6564 2e20 5468 6520 6465 6661 756c 7420  ed. The default 
+00009a80: 7661 6c75 6520 6973 2060 7379 732e 6d61  value is `sys.ma
+00009a90: 7869 6e74 602e 0a0a 5468 6520 6f70 7469  xint`...The opti
+00009aa0: 6f6e 616c 2060 7469 6d65 6f75 7460 2061  onal `timeout` a
+00009ab0: 7267 756d 656e 7420 6973 2061 2050 7974  rgument is a Pyt
+00009ac0: 686f 6e20 6066 6c6f 6174 6020 7768 6963  hon `float` whic
+00009ad0: 6820 7365 7473 2061 0a64 6561 646c 696e  h sets a.deadlin
+00009ae0: 6520 666f 7220 7468 6520 636f 6d70 6c65  e for the comple
+00009af0: 7469 6f6e 206f 6620 7468 6520 6752 5043  tion of the gRPC
+00009b00: 206f 7065 7261 7469 6f6e 2e0a 0a54 6865   operation...The
+00009b10: 2066 696c 7465 7269 6e67 206f 6620 6576   filtering of ev
+00009b20: 656e 7473 2069 7320 646f 6e65 206f 6e20  ents is done on 
+00009b30: 7468 6520 4576 656e 7453 746f 7265 4442  the EventStoreDB
+00009b40: 2073 6572 7665 722e 2054 6865 0a60 6c69   server. The.`li
+00009b50: 6d69 7460 2061 7267 756d 656e 7420 6973  mit` argument is
+00009b60: 2061 7070 6c69 6564 206f 6e20 7468 6520   applied on the 
+00009b70: 7365 7276 6572 2061 6674 6572 2066 696c  server after fil
+00009b80: 7465 7269 6e67 2e0a 0a57 6865 6e20 7265  tering...When re
+00009b90: 6164 696e 6720 666f 7277 6172 6473 2066  ading forwards f
+00009ba0: 726f 6d20 6120 7370 6563 6966 6963 2063  rom a specific c
+00009bb0: 6f6d 6d69 7420 706f 7369 7469 6f6e 2c20  ommit position, 
+00009bc0: 7468 6520 6576 656e 7420 6174 2074 6865  the event at the
+00009bd0: 2073 7065 6369 6669 6564 0a70 6f73 6974   specified.posit
+00009be0: 696f 6e20 5749 4c4c 2062 6520 696e 636c  ion WILL be incl
+00009bf0: 7564 6564 2e20 486f 7765 7665 722c 2077  uded. However, w
+00009c00: 6865 6e20 7265 6164 696e 6720 6261 636b  hen reading back
+00009c10: 7761 7264 732c 2074 6865 2065 7665 6e74  wards, the event
+00009c20: 2061 7420 7468 650a 7370 6563 6966 6965   at the.specifie
+00009c30: 6420 706f 7369 7469 6f6e 2077 696c 6c20  d position will 
+00009c40: 4e4f 5420 6265 2069 6e63 6c75 6465 642e  NOT be included.
+00009c50: 2028 5468 6973 206e 6f6e 2d69 6e63 6c75   (This non-inclu
+00009c60: 7369 7665 2062 6568 6176 696f 7572 2c20  sive behaviour, 
+00009c70: 6f66 2065 7863 6c75 6469 6e67 0a74 6865  of excluding.the
+00009c80: 2073 7065 6369 6669 6564 2063 6f6d 6d69   specified commi
+00009c90: 7420 706f 7369 7469 6f6e 2077 6865 6e20  t position when 
+00009ca0: 7265 6164 696e 6720 616c 6c20 7374 7265  reading all stre
+00009cb0: 616d 7320 6261 636b 7761 7264 732c 2064  ams backwards, d
+00009cc0: 6966 6665 7273 2066 726f 6d20 7468 650a  iffers from the.
+00009cd0: 6265 6861 7669 6f75 7220 7768 656e 2072  behaviour when r
+00009ce0: 6561 6469 6e67 2061 2073 7472 6561 6d20  eading a stream 
+00009cf0: 6261 636b 7761 7264 7320 6672 6f6d 2061  backwards from a
+00009d00: 2073 7065 6369 6669 6320 7374 7265 616d   specific stream
+00009d10: 2070 6f73 6974 696f 6e2e 290a 0a54 6865   position.)..The
+00009d20: 2065 7861 6d70 6c65 2062 656c 6f77 2073   example below s
+00009d30: 686f 7773 2068 6f77 2074 6f20 7265 6164  hows how to read
+00009d40: 2061 6c6c 2065 7665 6e74 7320 696e 2074   all events in t
+00009d50: 6865 2064 6174 6162 6173 6520 696e 2074  he database in t
+00009d60: 6865 0a6f 7264 6572 2074 6865 7920 7765  he.order they we
+00009d70: 7265 2072 6563 6f72 6465 642e 0a0a 6060  re recorded...``
+00009d80: 6070 7974 686f 6e0a 6576 656e 7473 203d  `python.events =
+00009d90: 206c 6973 7428 636c 6965 6e74 2e72 6561   list(client.rea
+00009da0: 645f 616c 6c5f 6576 656e 7473 2829 290a  d_all_events()).
+00009db0: 0a61 7373 6572 7420 6c65 6e28 6576 656e  .assert len(even
+00009dc0: 7473 2920 3e3d 2033 0a60 6060 0a0a 5468  ts) >= 3.```..Th
+00009dd0: 6520 6578 616d 706c 6520 6265 6c6f 7720  e example below 
+00009de0: 7368 6f77 7320 686f 7720 746f 2072 6561  shows how to rea
+00009df0: 6420 616c 6c20 7265 636f 7264 6564 2065  d all recorded e
+00009e00: 7665 6e74 7320 6672 6f6d 2061 2073 7065  vents from a spe
+00009e10: 6369 6669 6320 636f 6d6d 6974 2070 6f73  cific commit pos
+00009e20: 6974 696f 6e2e 0a0a 6060 6070 7974 686f  ition...```pytho
+00009e30: 6e0a 6576 656e 7473 203d 206c 6973 7428  n.events = list(
+00009e40: 0a20 2020 2063 6c69 656e 742e 7265 6164  .    client.read
+00009e50: 5f61 6c6c 5f65 7665 6e74 7328 0a20 2020  _all_events(.   
+00009e60: 2020 2020 2063 6f6d 6d69 745f 706f 7369       commit_posi
+00009e70: 7469 6f6e 3d63 6f6d 6d69 745f 706f 7369  tion=commit_posi
+00009e80: 7469 6f6e 310a 2020 2020 290a 290a 0a61  tion1.    ).)..a
+00009e90: 7373 6572 7420 6c65 6e28 6576 656e 7473  ssert len(events
+00009ea0: 2920 3d3d 2037 0a0a 6173 7365 7274 2065  ) == 7..assert e
+00009eb0: 7665 6e74 735b 305d 2e73 7472 6561 6d5f  vents[0].stream_
+00009ec0: 6e61 6d65 203d 3d20 7374 7265 616d 5f6e  name == stream_n
+00009ed0: 616d 6531 0a61 7373 6572 7420 6576 656e  ame1.assert even
+00009ee0: 7473 5b30 5d2e 7374 7265 616d 5f70 6f73  ts[0].stream_pos
+00009ef0: 6974 696f 6e20 3d3d 2030 0a61 7373 6572  ition == 0.asser
+00009f00: 7420 6576 656e 7473 5b30 5d2e 7479 7065  t events[0].type
+00009f10: 203d 3d20 6576 656e 7431 2e74 7970 650a   == event1.type.
+00009f20: 6173 7365 7274 2065 7665 6e74 735b 305d  assert events[0]
+00009f30: 2e64 6174 6120 3d3d 2065 7665 6e74 312e  .data == event1.
+00009f40: 6461 7461 0a0a 6173 7365 7274 2065 7665  data..assert eve
+00009f50: 6e74 735b 315d 2e73 7472 6561 6d5f 6e61  nts[1].stream_na
+00009f60: 6d65 203d 3d20 7374 7265 616d 5f6e 616d  me == stream_nam
+00009f70: 6531 0a61 7373 6572 7420 6576 656e 7473  e1.assert events
+00009f80: 5b31 5d2e 7374 7265 616d 5f70 6f73 6974  [1].stream_posit
+00009f90: 696f 6e20 3d3d 2031 0a61 7373 6572 7420  ion == 1.assert 
+00009fa0: 6576 656e 7473 5b31 5d2e 7479 7065 203d  events[1].type =
+00009fb0: 3d20 6576 656e 7432 2e74 7970 650a 6173  = event2.type.as
+00009fc0: 7365 7274 2065 7665 6e74 735b 315d 2e64  sert events[1].d
+00009fd0: 6174 6120 3d3d 2065 7665 6e74 322e 6461  ata == event2.da
+00009fe0: 7461 0a0a 6173 7365 7274 2065 7665 6e74  ta..assert event
+00009ff0: 735b 325d 2e73 7472 6561 6d5f 6e61 6d65  s[2].stream_name
+0000a000: 203d 3d20 7374 7265 616d 5f6e 616d 6531   == stream_name1
+0000a010: 0a61 7373 6572 7420 6576 656e 7473 5b32  .assert events[2
+0000a020: 5d2e 7374 7265 616d 5f70 6f73 6974 696f  ].stream_positio
+0000a030: 6e20 3d3d 2032 0a61 7373 6572 7420 6576  n == 2.assert ev
+0000a040: 656e 7473 5b32 5d2e 7479 7065 203d 3d20  ents[2].type == 
+0000a050: 6576 656e 7433 2e74 7970 650a 6173 7365  event3.type.asse
+0000a060: 7274 2065 7665 6e74 735b 325d 2e64 6174  rt events[2].dat
+0000a070: 6120 3d3d 2065 7665 6e74 332e 6461 7461  a == event3.data
+0000a080: 0a0a 6173 7365 7274 2065 7665 6e74 735b  ..assert events[
+0000a090: 335d 2e74 7970 6520 3d3d 2022 446f 6752  3].type == "DogR
+0000a0a0: 6567 6973 7465 7265 6422 0a61 7373 6572  egistered".asser
+0000a0b0: 7420 6576 656e 7473 5b34 5d2e 7479 7065  t events[4].type
+0000a0c0: 203d 3d20 2244 6f67 4c65 6172 6e65 6454   == "DogLearnedT
+0000a0d0: 7269 636b 220a 6173 7365 7274 2065 7665  rick".assert eve
+0000a0e0: 6e74 735b 355d 2e74 7970 6520 3d3d 2022  nts[5].type == "
+0000a0f0: 446f 674c 6561 726e 6564 5472 6963 6b22  DogLearnedTrick"
+0000a100: 0a61 7373 6572 7420 6576 656e 7473 5b36  .assert events[6
+0000a110: 5d2e 7479 7065 203d 3d20 2244 6f67 4c65  ].type == "DogLe
+0000a120: 6172 6e65 6454 7269 636b 220a 6060 600a  arnedTrick".```.
+0000a130: 0a54 6865 2065 7861 6d70 6c65 2062 656c  .The example bel
+0000a140: 6f77 2073 686f 7773 2068 6f77 2074 6f20  ow shows how to 
+0000a150: 7265 6164 2061 6c6c 2072 6563 6f72 6465  read all recorde
+0000a160: 6420 6576 656e 7473 2069 6e20 7265 7665  d events in reve
+0000a170: 7273 6520 6f72 6465 722e 0a0a 6060 6070  rse order...```p
+0000a180: 7974 686f 6e0a 6576 656e 7473 203d 206c  ython.events = l
+0000a190: 6973 7428 0a20 2020 2063 6c69 656e 742e  ist(.    client.
+0000a1a0: 7265 6164 5f61 6c6c 5f65 7665 6e74 7328  read_all_events(
+0000a1b0: 0a20 2020 2020 2020 2062 6163 6b77 6172  .        backwar
+0000a1c0: 6473 3d54 7275 650a 2020 2020 290a 290a  ds=True.    ).).
+0000a1d0: 0a61 7373 6572 7420 6c65 6e28 6576 656e  .assert len(even
+0000a1e0: 7473 2920 3e3d 2033 0a0a 6173 7365 7274  ts) >= 3..assert
+0000a1f0: 2065 7665 6e74 735b 305d 2e74 7970 6520   events[0].type 
+0000a200: 3d3d 2022 446f 674c 6561 726e 6564 5472  == "DogLearnedTr
+0000a210: 6963 6b22 0a61 7373 6572 7420 6576 656e  ick".assert even
+0000a220: 7473 5b31 5d2e 7479 7065 203d 3d20 2244  ts[1].type == "D
+0000a230: 6f67 4c65 6172 6e65 6454 7269 636b 220a  ogLearnedTrick".
+0000a240: 6173 7365 7274 2065 7665 6e74 735b 325d  assert events[2]
+0000a250: 2e74 7970 6520 3d3d 2022 446f 674c 6561  .type == "DogLea
+0000a260: 726e 6564 5472 6963 6b22 0a61 7373 6572  rnedTrick".asser
+0000a270: 7420 6576 656e 7473 5b33 5d2e 7479 7065  t events[3].type
+0000a280: 203d 3d20 2244 6f67 5265 6769 7374 6572   == "DogRegister
+0000a290: 6564 220a 0a61 7373 6572 7420 6576 656e  ed"..assert even
+0000a2a0: 7473 5b34 5d2e 7374 7265 616d 5f6e 616d  ts[4].stream_nam
+0000a2b0: 6520 3d3d 2073 7472 6561 6d5f 6e61 6d65  e == stream_name
+0000a2c0: 310a 6173 7365 7274 2065 7665 6e74 735b  1.assert events[
+0000a2d0: 345d 2e73 7472 6561 6d5f 706f 7369 7469  4].stream_positi
+0000a2e0: 6f6e 203d 3d20 320a 6173 7365 7274 2065  on == 2.assert e
+0000a2f0: 7665 6e74 735b 345d 2e74 7970 6520 3d3d  vents[4].type ==
+0000a300: 2065 7665 6e74 332e 7479 7065 0a61 7373   event3.type.ass
+0000a310: 6572 7420 6576 656e 7473 5b34 5d2e 6461  ert events[4].da
+0000a320: 7461 203d 3d20 6576 656e 7433 2e64 6174  ta == event3.dat
+0000a330: 610a 0a61 7373 6572 7420 6576 656e 7473  a..assert events
+0000a340: 5b35 5d2e 7374 7265 616d 5f6e 616d 6520  [5].stream_name 
+0000a350: 3d3d 2073 7472 6561 6d5f 6e61 6d65 310a  == stream_name1.
+0000a360: 6173 7365 7274 2065 7665 6e74 735b 355d  assert events[5]
+0000a370: 2e73 7472 6561 6d5f 706f 7369 7469 6f6e  .stream_position
+0000a380: 203d 3d20 310a 6173 7365 7274 2065 7665   == 1.assert eve
+0000a390: 6e74 735b 355d 2e74 7970 6520 3d3d 2065  nts[5].type == e
+0000a3a0: 7665 6e74 322e 7479 7065 0a61 7373 6572  vent2.type.asser
+0000a3b0: 7420 6576 656e 7473 5b35 5d2e 6461 7461  t events[5].data
+0000a3c0: 203d 3d20 6576 656e 7432 2e64 6174 610a   == event2.data.
+0000a3d0: 0a61 7373 6572 7420 6576 656e 7473 5b36  .assert events[6
+0000a3e0: 5d2e 7374 7265 616d 5f6e 616d 6520 3d3d  ].stream_name ==
+0000a3f0: 2073 7472 6561 6d5f 6e61 6d65 310a 6173   stream_name1.as
+0000a400: 7365 7274 2065 7665 6e74 735b 365d 2e73  sert events[6].s
+0000a410: 7472 6561 6d5f 706f 7369 7469 6f6e 203d  tream_position =
+0000a420: 3d20 300a 6173 7365 7274 2065 7665 6e74  = 0.assert event
+0000a430: 735b 365d 2e74 7970 6520 3d3d 2065 7665  s[6].type == eve
+0000a440: 6e74 312e 7479 7065 0a61 7373 6572 7420  nt1.type.assert 
+0000a450: 6576 656e 7473 5b36 5d2e 6461 7461 203d  events[6].data =
+0000a460: 3d20 6576 656e 7431 2e64 6174 610a 0a60  = event1.data..`
+0000a470: 6060 0a0a 5468 6520 6578 616d 706c 6520  ``..The example 
+0000a480: 6265 6c6f 7720 7368 6f77 7320 686f 7720  below shows how 
+0000a490: 746f 2072 6561 6420 6120 6c69 6d69 7465  to read a limite
+0000a4a0: 6420 6e75 6d62 6572 2028 6f6e 6529 206f  d number (one) o
+0000a4b0: 6620 7468 6520 7265 636f 7264 6564 2065  f the recorded e
+0000a4c0: 7665 6e74 730a 696e 2074 6865 2064 6174  vents.in the dat
+0000a4d0: 6162 6173 6520 666f 7277 6172 6473 2066  abase forwards f
+0000a4e0: 726f 6d20 6120 7370 6563 6966 6963 2063  rom a specific c
+0000a4f0: 6f6d 6d69 7420 706f 7369 7469 6f6e 2e20  ommit position. 
+0000a500: 506c 6561 7365 206e 6f74 652c 2077 6865  Please note, whe
+0000a510: 6e20 7265 6164 696e 670a 616c 6c20 6576  n reading.all ev
+0000a520: 656e 7473 2066 6f72 7761 7264 7320 6672  ents forwards fr
+0000a530: 6f6d 2061 2073 7065 6369 6669 6320 636f  om a specific co
+0000a540: 6d6d 6974 2070 6f73 6974 696f 6e2c 2074  mmit position, t
+0000a550: 6865 2065 7665 6e74 2061 7420 7468 6520  he event at the 
+0000a560: 7370 6563 6966 6965 640a 706f 7369 7469  specified.positi
+0000a570: 6f6e 2057 494c 4c20 6265 2069 6e63 6c75  on WILL be inclu
+0000a580: 6465 642e 0a0a 0a60 6060 7079 7468 6f6e  ded....```python
+0000a590: 0a65 7665 6e74 7320 3d20 6c69 7374 280a  .events = list(.
+0000a5a0: 2020 2020 636c 6965 6e74 2e72 6561 645f      client.read_
+0000a5b0: 616c 6c5f 6576 656e 7473 280a 2020 2020  all_events(.    
+0000a5c0: 2020 2020 636f 6d6d 6974 5f70 6f73 6974      commit_posit
+0000a5d0: 696f 6e3d 636f 6d6d 6974 5f70 6f73 6974  ion=commit_posit
+0000a5e0: 696f 6e31 2c0a 2020 2020 2020 2020 6c69  ion1,.        li
+0000a5f0: 6d69 743d 312c 0a20 2020 2029 0a29 0a0a  mit=1,.    ).)..
+0000a600: 6173 7365 7274 206c 656e 2865 7665 6e74  assert len(event
+0000a610: 7329 203d 3d20 310a 0a61 7373 6572 7420  s) == 1..assert 
+0000a620: 6576 656e 7473 5b30 5d2e 7374 7265 616d  events[0].stream
+0000a630: 5f6e 616d 6520 3d3d 2073 7472 6561 6d5f  _name == stream_
+0000a640: 6e61 6d65 310a 6173 7365 7274 2065 7665  name1.assert eve
+0000a650: 6e74 735b 305d 2e73 7472 6561 6d5f 706f  nts[0].stream_po
+0000a660: 7369 7469 6f6e 203d 3d20 300a 6173 7365  sition == 0.asse
+0000a670: 7274 2065 7665 6e74 735b 305d 2e74 7970  rt events[0].typ
+0000a680: 6520 3d3d 2065 7665 6e74 312e 7479 7065  e == event1.type
+0000a690: 0a61 7373 6572 7420 6576 656e 7473 5b30  .assert events[0
+0000a6a0: 5d2e 6461 7461 203d 3d20 6576 656e 7431  ].data == event1
+0000a6b0: 2e64 6174 610a 0a61 7373 6572 7420 6576  .data..assert ev
+0000a6c0: 656e 7473 5b30 5d2e 636f 6d6d 6974 5f70  ents[0].commit_p
+0000a6d0: 6f73 6974 696f 6e20 3d3d 2063 6f6d 6d69  osition == commi
+0000a6e0: 745f 706f 7369 7469 6f6e 310a 6060 600a  t_position1.```.
+0000a6f0: 0a54 6865 2065 7861 6d70 6c65 2062 656c  .The example bel
+0000a700: 6f77 2073 686f 7773 2068 6f77 2074 6f20  ow shows how to 
+0000a710: 7265 6164 2061 206c 696d 6974 6564 206e  read a limited n
+0000a720: 756d 6265 7220 286f 6e65 2920 6f66 2074  umber (one) of t
+0000a730: 6865 2072 6563 6f72 6465 6420 6576 656e  he recorded even
+0000a740: 7473 0a69 6e20 7468 6520 6461 7461 6261  ts.in the databa
+0000a750: 7365 2062 6163 6b77 6172 6473 2066 726f  se backwards fro
+0000a760: 6d20 7468 6520 656e 642e 2054 6869 7320  m the end. This 
+0000a770: 6769 7665 7320 7468 6520 6c61 7374 2072  gives the last r
+0000a780: 6563 6f72 6465 6420 6576 656e 742e 0a0a  ecorded event...
+0000a790: 6060 6070 7974 686f 6e0a 6576 656e 7473  ```python.events
+0000a7a0: 203d 206c 6973 7428 0a20 2020 2063 6c69   = list(.    cli
+0000a7b0: 656e 742e 7265 6164 5f61 6c6c 5f65 7665  ent.read_all_eve
+0000a7c0: 6e74 7328 0a20 2020 2020 2020 2062 6163  nts(.        bac
+0000a7d0: 6b77 6172 6473 3d54 7275 652c 0a20 2020  kwards=True,.   
+0000a7e0: 2020 2020 206c 696d 6974 3d31 2c0a 2020       limit=1,.  
+0000a7f0: 2020 290a 290a 0a61 7373 6572 7420 6c65    ).)..assert le
+0000a800: 6e28 6576 656e 7473 2920 3d3d 2031 0a0a  n(events) == 1..
+0000a810: 6173 7365 7274 2065 7665 6e74 735b 305d  assert events[0]
+0000a820: 2e74 7970 6520 3d3d 2022 446f 674c 6561  .type == "DogLea
+0000a830: 726e 6564 5472 6963 6b22 0a60 6060 0a0a  rnedTrick".```..
+0000a840: 5468 6520 6578 616d 706c 6520 6265 6c6f  The example belo
+0000a850: 7720 7368 6f77 7320 686f 7720 746f 2072  w shows how to r
+0000a860: 6561 6420 6120 6c69 6d69 7465 6420 6e75  ead a limited nu
+0000a870: 6d62 6572 2028 6f6e 6529 206f 6620 7468  mber (one) of th
+0000a880: 6520 7265 636f 7264 6564 2065 7665 6e74  e recorded event
+0000a890: 730a 696e 2074 6865 2064 6174 6162 6173  s.in the databas
+0000a8a0: 6520 6261 636b 7761 7264 7320 6672 6f6d  e backwards from
+0000a8b0: 2061 2073 7065 6369 6669 6320 636f 6d6d   a specific comm
+0000a8c0: 6974 2070 6f73 6974 696f 6e2e 2050 6c65  it position. Ple
+0000a8d0: 6173 6520 6e6f 7465 2c20 7768 656e 2072  ase note, when r
+0000a8e0: 6561 6469 6e67 0a61 6c6c 2065 7665 6e74  eading.all event
+0000a8f0: 7320 6261 636b 7761 7264 7320 6672 6f6d  s backwards from
+0000a900: 2061 2073 7065 6369 6669 6320 636f 6d6d   a specific comm
+0000a910: 6974 2070 6f73 6974 696f 6e2c 2074 6865  it position, the
+0000a920: 2065 7665 6e74 2061 7420 7468 6520 7370   event at the sp
+0000a930: 6563 6966 6965 640a 706f 7369 7469 6f6e  ecified.position
+0000a940: 2057 494c 4c20 4e4f 5420 6265 2069 6e63   WILL NOT be inc
+0000a950: 6c75 6465 642e 0a0a 6060 6070 7974 686f  luded...```pytho
+0000a960: 6e0a 6576 656e 7473 203d 206c 6973 7428  n.events = list(
+0000a970: 0a20 2020 2063 6c69 656e 742e 7265 6164  .    client.read
+0000a980: 5f61 6c6c 5f65 7665 6e74 7328 0a20 2020  _all_events(.   
+0000a990: 2020 2020 2063 6f6d 6d69 745f 706f 7369       commit_posi
+0000a9a0: 7469 6f6e 3d63 6f6d 6d69 745f 706f 7369  tion=commit_posi
+0000a9b0: 7469 6f6e 322c 0a20 2020 2020 2020 2062  tion2,.        b
+0000a9c0: 6163 6b77 6172 6473 3d54 7275 652c 0a20  ackwards=True,. 
+0000a9d0: 2020 2020 2020 206c 696d 6974 3d31 2c0a         limit=1,.
+0000a9e0: 2020 2020 290a 290a 0a61 7373 6572 7420      ).)..assert 
+0000a9f0: 6c65 6e28 6576 656e 7473 2920 3d3d 2031  len(events) == 1
+0000aa00: 0a0a 6173 7365 7274 2065 7665 6e74 735b  ..assert events[
+0000aa10: 305d 2e63 6f6d 6d69 745f 706f 7369 7469  0].commit_positi
+0000aa20: 6f6e 203c 2063 6f6d 6d69 745f 706f 7369  on < commit_posi
+0000aa30: 7469 6f6e 320a 6060 600a 0a0a 2323 2320  tion2.```...### 
+0000aa40: 4765 7420 6375 7272 656e 7420 7374 7265  Get current stre
+0000aa50: 616d 2070 6f73 6974 696f 6e0a 0a54 6865  am position..The
+0000aa60: 2060 6765 745f 7374 7265 616d 5f70 6f73   `get_stream_pos
+0000aa70: 6974 696f 6e28 2960 206d 6574 686f 6420  ition()` method 
+0000aa80: 6361 6e20 6265 2075 7365 6420 746f 0a67  can be used to.g
+0000aa90: 6574 2074 6865 2022 7374 7265 616d 2070  et the "stream p
+0000aaa0: 6f73 6974 696f 6e22 206f 6620 7468 6520  osition" of the 
+0000aab0: 6c61 7374 2072 6563 6f72 6465 6420 6576  last recorded ev
+0000aac0: 656e 7420 696e 2061 2073 7472 6561 6d2e  ent in a stream.
+0000aad0: 0a0a 5468 6973 206d 6574 686f 6420 6861  ..This method ha
+0000aae0: 7320 6120 6073 7472 6561 6d5f 6e61 6d65  s a `stream_name
+0000aaf0: 6020 6172 6775 6d65 6e74 2c20 7768 6963  ` argument, whic
+0000ab00: 6820 6973 2072 6571 7569 7265 642e 0a0a  h is required...
+0000ab10: 5468 6973 206d 6574 686f 6420 616c 736f  This method also
+0000ab20: 2074 616b 6573 2061 6e20 6f70 7469 6f6e   takes an option
+0000ab30: 616c 2060 7469 6d65 6f75 7460 2061 7267  al `timeout` arg
+0000ab40: 756d 656e 742c 2074 6861 740a 6973 2065  ument, that.is e
+0000ab50: 7870 6563 7465 6420 746f 2062 6520 6120  xpected to be a 
+0000ab60: 5079 7468 6f6e 2060 666c 6f61 7460 2c20  Python `float`, 
+0000ab70: 7768 6963 6820 7365 7473 2061 2064 6561  which sets a dea
+0000ab80: 646c 696e 650a 666f 7220 7468 6520 636f  dline.for the co
+0000ab90: 6d70 6c65 7469 6f6e 206f 6620 7468 6520  mpletion of the 
+0000aba0: 6752 5043 206f 7065 7261 7469 6f6e 2e0a  gRPC operation..
+0000abb0: 0a54 6865 2073 6571 7565 6e63 6520 6f66  .The sequence of
+0000abc0: 2070 6f73 6974 696f 6e73 2069 6e20 6120   positions in a 
+0000abd0: 7374 7265 616d 2069 7320 6761 706c 6573  stream is gaples
+0000abe0: 732e 2049 7420 6973 207a 6572 6f2d 6261  s. It is zero-ba
+0000abf0: 7365 642c 0a73 6f20 7468 6174 2061 2073  sed,.so that a s
+0000ac00: 7472 6561 6d20 7769 7468 206f 6e65 2072  tream with one r
+0000ac10: 6563 6f72 6465 6420 6576 656e 7420 6861  ecorded event ha
+0000ac20: 7320 6120 6375 7272 656e 7420 7374 7265  s a current stre
+0000ac30: 616d 0a70 6f73 6974 696f 6e20 6f66 2060  am.position of `
+0000ac40: 3060 2e20 5468 6520 6375 7272 656e 7420  0`. The current 
+0000ac50: 7374 7265 616d 2070 6f73 6974 696f 6e20  stream position 
+0000ac60: 6973 2060 3160 2077 6865 6e20 6120 7374  is `1` when a st
+0000ac70: 7265 616d 2068 6173 0a74 776f 2065 7665  ream has.two eve
+0000ac80: 6e74 732c 2061 6e64 2069 7420 6973 2060  nts, and it is `
+0000ac90: 3260 2077 6865 6e20 7468 6572 6520 6172  2` when there ar
+0000aca0: 6520 6576 656e 7473 2c20 616e 6420 736f  e events, and so
+0000acb0: 206f 6e2e 0a0a 496e 2074 6865 2065 7861   on...In the exa
+0000acc0: 6d70 6c65 2062 656c 6f77 2c20 7468 6520  mple below, the 
+0000acd0: 6375 7272 656e 7420 7374 7265 616d 2070  current stream p
+0000ace0: 6f73 6974 696f 6e20 6973 206f 6274 6169  osition is obtai
+0000acf0: 6e65 6420 6f66 2074 6865 0a73 7472 6561  ned of the.strea
+0000ad00: 6d20 746f 2077 6869 6368 2065 7665 6e74  m to which event
+0000ad10: 7320 7765 7265 2061 7070 656e 6465 6420  s were appended 
+0000ad20: 696e 2074 6865 2065 7861 6d70 6c65 7320  in the examples 
+0000ad30: 6162 6f76 652e 0a42 6563 6175 7365 2074  above..Because t
+0000ad40: 6865 2073 6571 7565 6e63 6520 6f66 2073  he sequence of s
+0000ad50: 7472 6561 6d20 706f 7369 7469 6f6e 7320  tream positions 
+0000ad60: 6973 207a 6572 6f2d 6261 7365 642c 2061  is zero-based, a
+0000ad70: 6e64 2062 6563 6175 7365 0a74 6872 6565  nd because.three
+0000ad80: 2065 7665 6e74 7320 7765 7265 2061 7070   events were app
+0000ad90: 656e 6465 642c 2073 6f20 7468 6520 6375  ended, so the cu
+0000ada0: 7272 656e 7420 7374 7265 616d 2070 6f73  rrent stream pos
+0000adb0: 6974 696f 6e20 6973 2060 3260 2e0a 0a60  ition is `2`...`
+0000adc0: 6060 7079 7468 6f6e 0a73 7472 6561 6d5f  ``python.stream_
+0000add0: 706f 7369 7469 6f6e 203d 2063 6c69 656e  position = clien
+0000ade0: 742e 6765 745f 7374 7265 616d 5f70 6f73  t.get_stream_pos
+0000adf0: 6974 696f 6e28 0a20 2020 2073 7472 6561  ition(.    strea
+0000ae00: 6d5f 6e61 6d65 3d73 7472 6561 6d5f 6e61  m_name=stream_na
+0000ae10: 6d65 310a 290a 0a61 7373 6572 7420 7374  me1.)..assert st
+0000ae20: 7265 616d 5f70 6f73 6974 696f 6e20 3d3d  ream_position ==
+0000ae30: 2032 0a60 6060 0a0a 4966 2061 2073 7472   2.```..If a str
+0000ae40: 6561 6d20 646f 6573 206e 6f74 2065 7869  eam does not exi
+0000ae50: 7374 2c20 7468 6520 7265 7475 726e 6564  st, the returned
+0000ae60: 2073 7472 6561 6d20 706f 7369 7469 6f6e   stream position
+0000ae70: 2076 616c 7565 2069 7320 604e 6f6e 6560   value is `None`
+0000ae80: 2c0a 7768 6963 6820 6d61 7463 6865 7320  ,.which matches 
+0000ae90: 7468 6520 7265 7175 6972 6564 2065 7870  the required exp
+0000aea0: 6563 7465 6420 706f 7369 7469 6f6e 2077  ected position w
+0000aeb0: 6865 6e20 6170 7065 6e64 696e 6720 7468  hen appending th
+0000aec0: 6520 6669 7273 7420 6576 656e 740a 6f66  e first event.of
+0000aed0: 2061 206e 6577 2073 7472 6561 6d20 2873   a new stream (s
+0000aee0: 6565 2061 626f 7665 292e 0a0a 6060 6070  ee above)...```p
+0000aef0: 7974 686f 6e0a 7374 7265 616d 5f70 6f73  ython.stream_pos
+0000af00: 6974 696f 6e20 3d20 636c 6965 6e74 2e67  ition = client.g
+0000af10: 6574 5f73 7472 6561 6d5f 706f 7369 7469  et_stream_positi
+0000af20: 6f6e 280a 2020 2020 7374 7265 616d 5f6e  on(.    stream_n
+0000af30: 616d 653d 7374 7228 7575 6964 3428 2929  ame=str(uuid4())
+0000af40: 0a29 0a0a 6173 7365 7274 2073 7472 6561  .)..assert strea
+0000af50: 6d5f 706f 7369 7469 6f6e 203d 3d20 4e6f  m_position == No
+0000af60: 6e65 0a60 6060 0a0a 5468 6973 206d 6574  ne.```..This met
+0000af70: 686f 6420 7461 6b65 7320 616e 206f 7074  hod takes an opt
+0000af80: 696f 6e61 6c20 6172 6775 6d65 6e74 2060  ional argument `
+0000af90: 7469 6d65 6f75 7460 2077 6869 6368 2069  timeout` which i
+0000afa0: 7320 6120 5079 7468 6f6e 2060 666c 6f61  s a Python `floa
+0000afb0: 7460 2074 6861 7420 7365 7473 0a61 2064  t` that sets.a d
+0000afc0: 6561 646c 696e 6520 666f 7220 7468 6520  eadline for the 
+0000afd0: 636f 6d70 6c65 7469 6f6e 206f 6620 7468  completion of th
+0000afe0: 6520 6752 5043 206f 7065 7261 7469 6f6e  e gRPC operation
+0000aff0: 2e0a 0a0a 2323 2320 4765 7420 6375 7272  ....### Get curr
+0000b000: 656e 7420 636f 6d6d 6974 2070 6f73 6974  ent commit posit
+0000b010: 696f 6e0a 0a54 6865 206d 6574 686f 6420  ion..The method 
+0000b020: 6067 6574 5f63 6f6d 6d69 745f 706f 7369  `get_commit_posi
+0000b030: 7469 6f6e 2829 6020 6361 6e20 6265 2075  tion()` can be u
+0000b040: 7365 6420 746f 2067 6574 2074 6865 2063  sed to get the c
+0000b050: 7572 7265 6e74 0a63 6f6d 6d69 7420 706f  urrent.commit po
+0000b060: 7369 7469 6f6e 206f 6620 7468 6520 6461  sition of the da
+0000b070: 7461 6261 7365 2e0a 0a60 6060 7079 7468  tabase...```pyth
+0000b080: 6f6e 0a63 6f6d 6d69 745f 706f 7369 7469  on.commit_positi
+0000b090: 6f6e 203d 2063 6c69 656e 742e 6765 745f  on = client.get_
+0000b0a0: 636f 6d6d 6974 5f70 6f73 6974 696f 6e28  commit_position(
+0000b0b0: 290a 6060 600a 0a54 6869 7320 6d65 7468  ).```..This meth
+0000b0c0: 6f64 2074 616b 6573 2061 6e20 6f70 7469  od takes an opti
+0000b0d0: 6f6e 616c 2061 7267 756d 656e 7420 6074  onal argument `t
+0000b0e0: 696d 656f 7574 6020 7768 6963 6820 6973  imeout` which is
+0000b0f0: 2061 2050 7974 686f 6e20 6066 6c6f 6174   a Python `float
+0000b100: 6020 7468 6174 2073 6574 730a 6120 6465  ` that sets.a de
+0000b110: 6164 6c69 6e65 2066 6f72 2074 6865 2063  adline for the c
+0000b120: 6f6d 706c 6574 696f 6e20 6f66 2074 6865  ompletion of the
+0000b130: 2067 5250 4320 6f70 6572 6174 696f 6e2e   gRPC operation.
+0000b140: 0a0a 5468 6973 206d 6574 686f 6420 6361  ..This method ca
+0000b150: 6e20 6265 2075 7365 6675 6c20 746f 206d  n be useful to m
+0000b160: 6561 7375 7265 2070 726f 6772 6573 7320  easure progress 
+0000b170: 6f66 2061 2064 6f77 6e73 7472 6561 6d20  of a downstream 
+0000b180: 636f 6d70 6f6e 656e 740a 7468 6174 2069  component.that i
+0000b190: 7320 7072 6f63 6573 7369 6e67 2061 6c6c  s processing all
+0000b1a0: 2072 6563 6f72 6465 6420 6576 656e 7473   recorded events
+0000b1b0: 2c20 6279 2063 6f6d 7061 7269 6e67 2074  , by comparing t
+0000b1c0: 6865 2063 7572 7265 6e74 2063 6f6d 6d69  he current commi
+0000b1d0: 740a 706f 7369 7469 6f6e 2077 6974 6820  t.position with 
+0000b1e0: 7468 6520 7265 636f 7264 6564 2063 6f6d  the recorded com
+0000b1f0: 6d69 7420 706f 7369 7469 6f6e 206f 6620  mit position of 
+0000b200: 7468 6520 6c61 7374 2073 7563 6365 7373  the last success
+0000b210: 6675 6c6c 7920 7072 6f63 6573 7365 640a  fully processed.
+0000b220: 6576 656e 7420 696e 2061 2064 6f77 6e73  event in a downs
+0000b230: 7472 6561 6d20 636f 6d70 6f6e 656e 742e  tream component.
+0000b240: 0a0a 5468 6520 7661 6c75 6520 6f66 2074  ..The value of t
+0000b250: 6865 2060 636f 6d6d 6974 5f70 6f73 6974  he `commit_posit
+0000b260: 696f 6e60 2061 7267 756d 656e 7420 7768  ion` argument wh
+0000b270: 656e 2072 6561 6469 6e67 2065 7665 6e74  en reading event
+0000b280: 7320 6569 7468 6572 2062 7920 7573 696e  s either by usin
+0000b290: 670a 7468 6520 6072 6561 645f 616c 6c5f  g.the `read_all_
+0000b2a0: 6576 656e 7473 2829 6020 6d65 7468 6f64  events()` method
+0000b2b0: 206f 7220 6279 2075 7369 6e67 2061 2063   or by using a c
+0000b2c0: 6174 6368 2d75 7020 7375 6273 6372 6970  atch-up subscrip
+0000b2d0: 7469 6f6e 2077 6f75 6c64 2075 7375 616c  tion would usual
+0000b2e0: 6c79 0a62 6520 6465 7465 726d 696e 6564  ly.be determined
+0000b2f0: 2062 7920 7468 6520 7265 636f 7264 6564   by the recorded
+0000b300: 2063 6f6d 6d69 7420 706f 7369 7469 6f6e   commit position
+0000b310: 206f 6620 7468 6520 6c61 7374 2073 7563   of the last suc
+0000b320: 6365 7373 6675 6c6c 7920 7072 6f63 6573  cessfully proces
+0000b330: 7365 640a 6576 656e 7420 696e 2061 2064  sed.event in a d
+0000b340: 6f77 6e73 7472 6561 6d20 636f 6d70 6f6e  ownstream compon
+0000b350: 656e 742e 0a0a 0a23 2323 2047 6574 2073  ent....### Get s
+0000b360: 7472 6561 6d20 6d65 7461 6461 7461 0a0a  tream metadata..
+0000b370: 5468 6520 6d65 7468 6f64 2060 6765 745f  The method `get_
+0000b380: 7374 7265 616d 5f6d 6574 6164 6174 6128  stream_metadata(
+0000b390: 2960 2067 6574 7320 7468 6520 6d65 7461  )` gets the meta
+0000b3a0: 6461 7461 2066 6f72 2061 2073 7472 6561  data for a strea
+0000b3b0: 6d2c 2061 6c6f 6e67 0a77 6974 6820 7468  m, along.with th
+0000b3c0: 6520 7665 7273 696f 6e20 6f66 2074 6865  e version of the
+0000b3d0: 2073 7472 6561 6d20 6d65 7461 6461 7461   stream metadata
+0000b3e0: 2e0a 0a60 6060 7079 7468 6f6e 0a6d 6574  ...```python.met
+0000b3f0: 6164 6174 612c 206d 6574 6164 6174 615f  adata, metadata_
+0000b400: 7665 7273 696f 6e20 3d20 636c 6965 6e74  version = client
+0000b410: 2e67 6574 5f73 7472 6561 6d5f 6d65 7461  .get_stream_meta
+0000b420: 6461 7461 2873 7472 6561 6d5f 6e61 6d65  data(stream_name
+0000b430: 3d73 7472 6561 6d5f 6e61 6d65 3129 0a60  =stream_name1).`
+0000b440: 6060 0a0a 5468 6520 7265 7475 726e 6564  ``..The returned
+0000b450: 2060 6d65 7461 6461 7461 6020 7661 6c75   `metadata` valu
+0000b460: 6520 6973 2061 2050 7974 686f 6e20 6064  e is a Python `d
+0000b470: 6963 7460 2e20 5468 6520 7265 7475 726e  ict`. The return
+0000b480: 6564 2060 6d65 7461 6461 7461 5f76 6572  ed `metadata_ver
+0000b490: 7369 6f6e 600a 7661 6c75 6520 6973 2065  sion`.value is e
+0000b4a0: 6974 6865 7220 616e 2060 696e 7460 2c20  ither an `int`, 
+0000b4b0: 6f72 2060 4e6f 6e65 6020 6966 2074 6865  or `None` if the
+0000b4c0: 2073 7472 6561 6d20 646f 6573 206e 6f74   stream does not
+0000b4d0: 2065 7869 7374 2e20 5468 6573 6520 7661   exist. These va
+0000b4e0: 6c75 6573 2063 616e 0a62 6520 7061 7373  lues can.be pass
+0000b4f0: 6564 2069 6e74 6f20 6073 6574 5f73 7472  ed into `set_str
+0000b500: 6561 6d5f 6d65 7461 6461 7461 2829 602e  eam_metadata()`.
+0000b510: 0a0a 0a23 2323 2053 6574 2073 7472 6561  ...### Set strea
+0000b520: 6d20 6d65 7461 6461 7461 0a0a 2a72 6571  m metadata..*req
+0000b530: 7569 7265 7320 6c65 6164 6572 2a0a 0a54  uires leader*..T
+0000b540: 6865 206d 6574 686f 6420 6073 6574 5f73  he method `set_s
+0000b550: 7472 6561 6d5f 6d65 7461 6461 7461 2829  tream_metadata()
+0000b560: 6020 7365 7473 2074 6865 206d 6574 6164  ` sets the metad
+0000b570: 6174 6120 666f 7220 6120 7374 7265 616d  ata for a stream
+0000b580: 2c20 616c 6f6e 670a 7769 7468 2074 6865  , along.with the
+0000b590: 2076 6572 7369 6f6e 206f 6620 7468 6520   version of the 
+0000b5a0: 7374 7265 616d 206d 6574 6164 6174 612e  stream metadata.
+0000b5b0: 0a0a 6060 6070 7974 686f 6e0a 6d65 7461  ..```python.meta
+0000b5c0: 6461 7461 5b22 666f 6f22 5d20 3d20 2262  data["foo"] = "b
+0000b5d0: 6172 220a 0a63 6c69 656e 742e 7365 745f  ar"..client.set_
+0000b5e0: 7374 7265 616d 5f6d 6574 6164 6174 6128  stream_metadata(
+0000b5f0: 0a20 2020 2073 7472 6561 6d5f 6e61 6d65  .    stream_name
+0000b600: 3d73 7472 6561 6d5f 6e61 6d65 312c 0a20  =stream_name1,. 
+0000b610: 2020 206d 6574 6164 6174 613d 6d65 7461     metadata=meta
+0000b620: 6461 7461 2c0a 2020 2020 6578 7065 6374  data,.    expect
+0000b630: 6564 5f70 6f73 6974 696f 6e3d 6d65 7461  ed_position=meta
+0000b640: 6461 7461 5f76 6572 7369 6f6e 2c0a 290a  data_version,.).
+0000b650: 6060 600a 0a54 6865 2060 6578 7065 6374  ```..The `expect
+0000b660: 6564 5f70 6f73 6974 696f 6e60 2061 7267  ed_position` arg
+0000b670: 756d 656e 7420 7368 6f75 6c64 2062 6520  ument should be 
+0000b680: 7468 6520 6375 7272 656e 7420 7665 7273  the current vers
+0000b690: 696f 6e20 6f66 2074 6865 2073 7472 6561  ion of the strea
+0000b6a0: 6d20 6d65 7461 6461 7461 2e0a 0a50 6c65  m metadata...Ple
+0000b6b0: 6173 6520 7265 6665 7220 746f 2074 6865  ase refer to the
+0000b6c0: 2045 7665 6e74 5374 6f72 6544 4220 646f   EventStoreDB do
+0000b6d0: 6375 6d65 6e74 6174 696f 6e20 666f 7220  cumentation for 
+0000b6e0: 6d6f 7265 2069 6e66 6f72 6d61 7469 6f6e  more information
+0000b6f0: 2061 626f 7574 2073 7472 6561 6d0a 6d65   about stream.me
+0000b700: 7461 6461 7461 2e0a 0a23 2323 2044 656c  tadata...### Del
+0000b710: 6574 6520 7374 7265 616d 0a0a 2a72 6571  ete stream..*req
+0000b720: 7569 7265 7320 6c65 6164 6572 2a0a 0a54  uires leader*..T
+0000b730: 6865 206d 6574 686f 6420 6064 656c 6574  he method `delet
+0000b740: 655f 7374 7265 616d 2829 6020 6361 6e20  e_stream()` can 
+0000b750: 6265 2075 7365 6420 746f 2022 6465 6c65  be used to "dele
+0000b760: 7465 2220 6120 7374 7265 616d 2e0a 0a60  te" a stream...`
+0000b770: 6060 7079 7468 6f6e 0a63 6f6d 6d69 745f  ``python.commit_
+0000b780: 706f 7369 7469 6f6e 203d 2063 6c69 656e  position = clien
+0000b790: 742e 6465 6c65 7465 5f73 7472 6561 6d28  t.delete_stream(
+0000b7a0: 7374 7265 616d 5f6e 616d 653d 7374 7265  stream_name=stre
+0000b7b0: 616d 5f6e 616d 6531 2c20 6578 7065 6374  am_name1, expect
+0000b7c0: 6564 5f70 6f73 6974 696f 6e3d 3229 0a60  ed_position=2).`
+0000b7d0: 6060 0a0a 4166 7465 7220 6465 6c65 7469  ``..After deleti
+0000b7e0: 6e67 2061 2073 7472 6561 6d2c 2069 7427  ng a stream, it'
+0000b7f0: 7320 7374 696c 6c20 706f 7373 6962 6c65  s still possible
+0000b800: 2074 6f20 6170 7065 6e64 206e 6577 2065   to append new e
+0000b810: 7665 6e74 732e 2052 6561 6469 6e67 2066  vents. Reading f
+0000b820: 726f 6d20 610a 6465 6c65 7465 6420 7374  rom a.deleted st
+0000b830: 7265 616d 2077 696c 6c20 7265 7475 726e  ream will return
+0000b840: 206f 6e6c 7920 6576 656e 7473 2074 6861   only events tha
+0000b850: 7420 6861 7665 2062 6565 6e20 6170 7065  t have been appe
+0000b860: 6e64 6564 2061 6674 6572 2069 7420 7761  nded after it wa
+0000b870: 730a 6465 6c65 7465 642e 0a0a 2323 2320  s.deleted...### 
+0000b880: 546f 6d62 7374 6f6e 6520 7374 7265 616d  Tombstone stream
+0000b890: 0a0a 2a72 6571 7569 7265 7320 6c65 6164  ..*requires lead
+0000b8a0: 6572 2a0a 0a54 6865 206d 6574 686f 6420  er*..The method 
+0000b8b0: 6074 6f6d 6273 746f 6e65 5f73 7472 6561  `tombstone_strea
+0000b8c0: 6d28 2960 2063 616e 2062 6520 7573 6564  m()` can be used
+0000b8d0: 2074 6f20 2274 6f6d 6273 746f 6e65 2220   to "tombstone" 
+0000b8e0: 6120 7374 7265 616d 2e0a 0a60 6060 7079  a stream...```py
+0000b8f0: 7468 6f6e 0a63 6f6d 6d69 745f 706f 7369  thon.commit_posi
+0000b900: 7469 6f6e 203d 2063 6c69 656e 742e 746f  tion = client.to
+0000b910: 6d62 7374 6f6e 655f 7374 7265 616d 2873  mbstone_stream(s
+0000b920: 7472 6561 6d5f 6e61 6d65 3d73 7472 6561  tream_name=strea
+0000b930: 6d5f 6e61 6d65 312c 2065 7870 6563 7465  m_name1, expecte
+0000b940: 645f 706f 7369 7469 6f6e 3d32 290a 6060  d_position=2).``
+0000b950: 600a 0a41 6674 6572 2074 6f6d 6273 746f  `..After tombsto
+0000b960: 6e69 6e67 2061 2073 7472 6561 6d2c 2069  ning a stream, i
+0000b970: 7427 7320 6e6f 7420 706f 7373 6962 6c65  t's not possible
+0000b980: 2074 6f20 6170 7065 6e64 206e 6577 2065   to append new e
+0000b990: 7665 6e74 732e 0a0a 0a23 2320 4361 7463  vents....## Catc
+0000b9a0: 682d 7570 2073 7562 7363 7269 7074 696f  h-up subscriptio
+0000b9b0: 6e73 0a0a 2243 6174 6368 2d75 7022 2073  ns.."Catch-up" s
+0000b9c0: 7562 7363 7269 7074 696f 6e73 2063 616e  ubscriptions can
+0000b9d0: 2062 6520 7573 6564 2074 6f20 7265 6365   be used to rece
+0000b9e0: 6976 6520 6576 656e 7473 2074 6861 7420  ive events that 
+0000b9f0: 6861 7665 2062 6565 6e20 7265 636f 7264  have been record
+0000ba00: 6564 0a69 6e20 7468 6520 6461 7461 6261  ed.in the databa
+0000ba10: 7365 2c20 616e 6420 616c 736f 2065 7665  se, and also eve
+0000ba20: 6e74 7320 7468 6174 2061 7265 2072 6563  nts that are rec
+0000ba30: 6f72 6465 6420 6166 7465 7220 6120 7375  orded after a su
+0000ba40: 6273 6372 6970 7469 6f6e 2077 6173 2073  bscription was s
+0000ba50: 7461 7274 6564 2e0a 0a54 6865 206d 6574  tarted...The met
+0000ba60: 686f 6420 6073 7562 7363 7269 6265 5f61  hod `subscribe_a
+0000ba70: 6c6c 5f65 7665 6e74 7328 2960 2073 7461  ll_events()` sta
+0000ba80: 7274 7320 6120 6361 7463 682d 7570 2073  rts a catch-up s
+0000ba90: 7562 7363 7269 7074 696f 6e20 746f 2072  ubscription to r
+0000baa0: 6563 6569 7665 2061 6c6c 0a65 7665 6e74  eceive all.event
+0000bab0: 7320 7468 6174 2068 6176 6520 6265 656e  s that have been
+0000bac0: 2061 6e64 2077 696c 6c20 6265 2072 6563   and will be rec
+0000bad0: 6f72 6465 6420 696e 2074 6865 2064 6174  orded in the dat
+0000bae0: 6162 6173 652e 2054 6865 206d 6574 686f  abase. The metho
+0000baf0: 640a 6073 7562 7363 7269 6265 5f73 7472  d.`subscribe_str
+0000bb00: 6561 6d5f 6576 656e 7473 2829 6020 7374  eam_events()` st
+0000bb10: 6172 7473 2061 2063 6174 6368 2d75 7020  arts a catch-up 
+0000bb20: 7375 6273 6372 6970 7469 6f6e 2074 6f20  subscription to 
+0000bb30: 7265 6365 6976 6520 6576 656e 7473 2066  receive events f
+0000bb40: 726f 6d0a 6120 7370 6563 6966 6963 2073  rom.a specific s
+0000bb50: 7472 6561 6d2e 0a0a 4361 7463 682d 7570  tream...Catch-up
+0000bb60: 2073 7562 7363 7269 7074 696f 6e73 2065   subscriptions e
+0000bb70: 6e63 6170 7375 6c61 7465 2061 2073 7472  ncapsulate a str
+0000bb80: 6561 6d69 6e67 2067 5250 4320 6361 6c6c  eaming gRPC call
+0000bb90: 2077 6869 6368 2069 730a 6b65 7074 206f   which is.kept o
+0000bba0: 7065 6e20 6279 2074 6865 2073 6572 7665  pen by the serve
+0000bbb0: 722c 2077 6974 6820 6e65 776c 7920 7265  r, with newly re
+0000bbc0: 636f 7264 6564 2065 7665 6e74 7320 7365  corded events se
+0000bbd0: 6e74 2074 6f20 7468 6520 636c 6965 6e74  nt to the client
+0000bbe0: 0a61 7320 7468 6520 636c 6965 6e74 2069  .as the client i
+0000bbf0: 7465 7261 7465 7320 6f76 6572 2074 6865  terates over the
+0000bc00: 2073 7562 7363 7269 7074 696f 6e20 7265   subscription re
+0000bc10: 7370 6f6e 7365 2e0a 0a4d 616e 7920 6361  sponse...Many ca
+0000bc20: 7463 682d 7570 2073 7562 7363 7269 7074  tch-up subscript
+0000bc30: 696f 6e73 2063 616e 2062 6520 6372 6561  ions can be crea
+0000bc40: 7465 642c 2063 6f6e 6375 7272 656e 746c  ted, concurrentl
+0000bc50: 7920 6f72 2073 7563 6365 7373 6976 656c  y or successivel
+0000bc60: 792c 2061 6e64 2061 6c6c 0a77 696c 6c20  y, and all.will 
+0000bc70: 7265 6365 6976 6520 616c 6c20 7468 6520  receive all the 
+0000bc80: 7265 636f 7264 6564 2065 7665 6e74 7320  recorded events 
+0000bc90: 7468 6579 2068 6176 6520 6265 656e 2072  they have been r
+0000bca0: 6571 7565 7374 6564 2074 6f20 7265 6365  equested to rece
+0000bcb0: 6976 652e 0a0a 5468 6520 7265 6365 6976  ive...The receiv
+0000bcc0: 6564 2072 6563 6f72 6465 6420 6576 656e  ed recorded even
+0000bcd0: 7420 6f62 6a65 6374 2061 7265 2069 6e73  t object are ins
+0000bce0: 7461 6e63 6573 206f 6620 7468 6520 6052  tances of the `R
+0000bcf0: 6563 6f72 6465 6445 7665 6e74 6020 636c  ecordedEvent` cl
+0000bd00: 6173 730a 2873 6565 2074 6865 204e 6f74  ass.(see the Not
+0000bd10: 6573 2073 6563 7469 6f6e 2062 656c 6f77  es section below
+0000bd20: 2066 6f72 2064 6574 6169 6c73 206f 6620   for details of 
+0000bd30: 7468 6973 2063 6c61 7373 292e 0a0a 2323  this class)...##
+0000bd40: 2320 486f 7720 746f 2069 6d70 6c65 6d65  # How to impleme
+0000bd50: 6e74 2065 7861 6374 6c79 2d6f 6e63 6520  nt exactly-once 
+0000bd60: 6576 656e 7420 7072 6f63 6573 7369 6e67  event processing
+0000bd70: 0a0a 5468 6520 636f 6d6d 6974 2070 6f73  ..The commit pos
+0000bd80: 6974 696f 6e73 206f 6620 7265 636f 7264  itions of record
+0000bd90: 6564 2065 7665 6e74 7320 7468 6174 2061  ed events that a
+0000bda0: 7265 2072 6563 6569 7665 6420 616e 6420  re received and 
+0000bdb0: 7072 6f63 6573 7365 6420 6279 2061 0a64  processed by a.d
+0000bdc0: 6f77 6e73 7472 6561 6d20 636f 6d70 6f6e  ownstream compon
+0000bdd0: 656e 7420 6172 6520 7573 6566 756c 6c79  ent are usefully
+0000bde0: 2072 6563 6f72 6465 6420 6279 2074 6865   recorded by the
+0000bdf0: 2064 6f77 6e73 7472 6561 6d20 636f 6d70   downstream comp
+0000be00: 6f6e 656e 7420 736f 2074 6861 740a 7468  onent so that.th
+0000be10: 6520 636f 6d6d 6974 2070 6f73 6974 696f  e commit positio
+0000be20: 6e20 6f66 206c 6173 7420 7072 6f63 6573  n of last proces
+0000be30: 7365 6420 6576 656e 7420 6361 6e20 6265  sed event can be
+0000be40: 2064 6574 6572 6d69 6e65 642e 0a0a 5468   determined...Th
+0000be50: 6520 6c61 7374 2072 6563 6f72 6465 6420  e last recorded 
+0000be60: 636f 6d6d 6974 2070 6f73 6974 696f 6e20  commit position 
+0000be70: 6361 6e20 6265 2075 7365 6420 746f 2073  can be used to s
+0000be80: 7065 6369 6679 2074 6865 2063 6f6d 6d69  pecify the commi
+0000be90: 7420 706f 7369 7469 6f6e 2066 726f 6d20  t position from 
+0000bea0: 7768 6963 680a 746f 2073 7562 7363 7269  which.to subscri
+0000beb0: 6265 2077 6865 6e20 7072 6f63 6573 7369  be when processi
+0000bec0: 6e67 2069 7320 7265 7375 6d65 642e 2053  ng is resumed. S
+0000bed0: 696e 6365 2074 6869 7320 636f 6d6d 6974  ince this commit
+0000bee0: 2070 6f73 6974 696f 6e20 7769 6c6c 2072   position will r
+0000bef0: 6570 7265 7365 6e74 2074 6865 0a70 6f73  epresent the.pos
+0000bf00: 6974 696f 6e20 6f66 2074 6865 206c 6173  ition of the las
+0000bf10: 7420 7375 6363 6573 7366 756c 6c79 2070  t successfully p
+0000bf20: 726f 6365 7373 6564 2065 7665 6e74 2069  rocessed event i
+0000bf30: 6e20 6120 646f 776e 7374 7265 616d 2063  n a downstream c
+0000bf40: 6f6d 706f 6e65 6e74 2c20 736f 2069 740a  omponent, so it.
+0000bf50: 7769 6c6c 2062 6520 7573 7561 6c20 746f  will be usual to
+0000bf60: 2077 616e 7420 7468 6520 6e65 7874 2065   want the next e
+0000bf70: 7665 6e74 2061 6674 6572 2074 6869 7320  vent after this 
+0000bf80: 706f 7369 7469 6f6e 2c20 6265 6361 7573  position, becaus
+0000bf90: 6520 7468 6174 2069 7320 7468 6520 6e65  e that is the ne
+0000bfa0: 7874 0a65 7665 6e74 2074 6861 7420 6861  xt.event that ha
+0000bfb0: 7320 6e6f 7420 7965 7420 6265 656e 2070  s not yet been p
+0000bfc0: 726f 6365 7373 6564 2e20 466f 7220 7468  rocessed. For th
+0000bfd0: 6973 2072 6561 736f 6e2c 2077 6865 6e20  is reason, when 
+0000bfe0: 7375 6273 6372 6962 696e 6720 666f 7220  subscribing for 
+0000bff0: 6576 656e 7473 0a66 726f 6d20 6120 7370  events.from a sp
+0000c000: 6563 6966 6963 2063 6f6d 6d69 7420 706f  ecific commit po
+0000c010: 7369 7469 6f6e 2075 7369 6e67 2061 2063  sition using a c
+0000c020: 6174 6368 2d75 7020 7375 6273 6372 6970  atch-up subscrip
+0000c030: 7469 6f6e 2069 6e20 4576 656e 7453 746f  tion in EventSto
+0000c040: 7265 4442 2c20 7468 650a 7265 636f 7264  reDB, the.record
+0000c050: 6564 2065 7665 6e74 2061 7420 7468 6520  ed event at the 
+0000c060: 7370 6563 6966 6965 6420 636f 6d6d 6974  specified commit
+0000c070: 2070 6f73 6974 696f 6e20 7769 6c6c 204e   position will N
+0000c080: 4f54 2062 6520 696e 636c 7564 6564 2069  OT be included i
+0000c090: 6e20 7468 6520 7365 7175 656e 6365 0a6f  n the sequence.o
+0000c0a0: 6620 7265 636f 7264 6564 2065 7665 6e74  f recorded event
+0000c0b0: 7320 7468 6174 2061 7265 2072 6563 6569  s that are recei
+0000c0c0: 7665 642e 0a0a 546f 2061 6363 6f6d 706c  ved...To accompl
+0000c0d0: 6973 6820 2265 7861 6374 6c79 2d6f 6e63  ish "exactly-onc
+0000c0e0: 6522 2070 726f 6365 7373 696e 6720 6f66  e" processing of
+0000c0f0: 2072 6563 6f72 6465 6420 6576 656e 7473   recorded events
+0000c100: 2069 6e20 6120 646f 776e 7374 7265 616d   in a downstream
+0000c110: 0a63 6f6d 706f 6e65 6e74 2077 6865 6e20  .component when 
+0000c120: 7573 696e 6720 6120 6361 7463 682d 7570  using a catch-up
+0000c130: 2073 7562 7363 7269 7074 696f 6e2c 2074   subscription, t
+0000c140: 6865 2063 6f6d 6d69 7420 706f 7369 7469  he commit positi
+0000c150: 6f6e 206f 6620 6120 7265 636f 7264 6564  on of a recorded
+0000c160: 0a65 7665 6e74 2073 686f 756c 6420 6265  .event should be
+0000c170: 2072 6563 6f72 6465 6420 6174 6f6d 6963   recorded atomic
+0000c180: 616c 6c79 2061 6e64 2075 6e69 7175 656c  ally and uniquel
+0000c190: 7920 616c 6f6e 6720 7769 7468 2074 6865  y along with the
+0000c1a0: 2072 6573 756c 7420 6f66 2070 726f 6365   result of proce
+0000c1b0: 7373 696e 670a 7265 636f 7264 6564 2065  ssing.recorded e
+0000c1c0: 7665 6e74 732c 2066 6f72 2065 7861 6d70  vents, for examp
+0000c1d0: 6c65 2069 6e20 7468 6520 7361 6d65 2064  le in the same d
+0000c1e0: 6174 6162 6173 6520 6173 206d 6174 6572  atabase as mater
+0000c1f0: 6961 6c69 7365 6420 7669 6577 7320 7768  ialised views wh
+0000c200: 656e 0a69 6d70 6c65 6d65 6e74 696e 6720  en.implementing 
+0000c210: 6576 656e 7475 616c 6c79 2d63 6f6e 7369  eventually-consi
+0000c220: 7374 656e 7420 4351 5253 2c20 6f72 2069  stent CQRS, or i
+0000c230: 6e20 7468 6520 7361 6d65 2064 6174 6162  n the same datab
+0000c240: 6173 6520 6173 2061 2064 6f77 6e73 7472  ase as a downstr
+0000c250: 6561 6d0a 616e 616c 7974 6963 7320 6f72  eam.analytics or
+0000c260: 2072 6570 6f72 7469 6e67 206f 7220 6172   reporting or ar
+0000c270: 6368 6976 696e 6720 6170 706c 6963 6174  chiving applicat
+0000c280: 696f 6e2e 2042 7920 7265 636f 7264 696e  ion. By recordin
+0000c290: 6720 7468 6520 636f 6d6d 6974 2070 6f73  g the commit pos
+0000c2a0: 6974 696f 6e0a 6f66 2072 6563 6f72 6465  ition.of recorde
+0000c2b0: 6420 6576 656e 7473 2061 746f 6d69 6361  d events atomica
+0000c2c0: 6c6c 7920 7769 7468 2074 6865 206e 6577  lly with the new
+0000c2d0: 2073 7461 7465 2074 6861 7420 7265 7375   state that resu
+0000c2e0: 6c74 7320 6672 6f6d 2070 726f 6365 7373  lts from process
+0000c2f0: 696e 670a 7265 636f 7264 6564 2065 7665  ing.recorded eve
+0000c300: 6e74 732c 2022 6475 616c 2077 7269 7469  nts, "dual writi
+0000c310: 6e67 2220 696e 2074 6865 2063 6f6e 7375  ng" in the consu
+0000c320: 6d70 7469 6f6e 206f 6620 7265 636f 7264  mption of record
+0000c330: 6564 2065 7665 6e74 7320 6361 6e20 6265  ed events can be
+0000c340: 0a61 766f 6964 6564 2e20 4279 2061 6c73  .avoided. By als
+0000c350: 6f20 7265 636f 7264 696e 6720 7468 6520  o recording the 
+0000c360: 636f 6d6d 6974 2070 6f73 6974 696f 6e20  commit position 
+0000c370: 756e 6971 7565 6c79 2c20 7468 6520 6e65  uniquely, the ne
+0000c380: 7720 7374 6174 6520 6361 6e6e 6f74 2062  w state cannot b
+0000c390: 650a 7265 636f 7264 6564 2074 7769 6365  e.recorded twice
+0000c3a0: 2c20 616e 6420 6865 6e63 6520 7468 6520  , and hence the 
+0000c3b0: 7265 636f 7264 6564 2073 7461 7465 206f  recorded state o
+0000c3c0: 6620 7468 6520 646f 776e 7374 7265 616d  f the downstream
+0000c3d0: 2063 6f6d 706f 6e65 6e74 2077 696c 6c20   component will 
+0000c3e0: 6265 0a75 7064 6174 6564 206f 6e6c 7920  be.updated only 
+0000c3f0: 6f6e 6365 2066 6f72 2061 6e79 2072 6563  once for any rec
+0000c400: 6f72 6465 6420 6576 656e 742e 2042 7920  orded event. By 
+0000c410: 7573 696e 6720 7468 6520 6772 6561 7465  using the greate
+0000c420: 7374 2072 6563 6f72 6465 6420 636f 6d6d  st recorded comm
+0000c430: 6974 0a70 6f73 6974 696f 6e20 746f 2072  it.position to r
+0000c440: 6573 756d 6520 6120 6361 7463 682d 7570  esume a catch-up
+0000c450: 2073 7562 7363 7269 7074 696f 6e2c 2061   subscription, a
+0000c460: 6c6c 2072 6563 6f72 6465 6420 6576 656e  ll recorded even
+0000c470: 7473 2077 696c 6c20 6576 656e 7475 616c  ts will eventual
+0000c480: 6c79 0a62 6520 7072 6f63 6573 7365 642e  ly.be processed.
+0000c490: 2054 6865 2063 6f6d 6269 6e61 7469 6f6e   The combination
+0000c4a0: 206f 6620 7468 6520 2261 742d 6d6f 7374   of the "at-most
+0000c4b0: 2d6f 6e63 6522 2063 6f6e 6469 7469 6f6e  -once" condition
+0000c4c0: 2061 6e64 2074 6865 2022 6174 2d6c 6561   and the "at-lea
+0000c4d0: 7374 2d6f 6e63 6522 0a63 6f6e 6469 7469  st-once".conditi
+0000c4e0: 6f6e 2067 6976 6573 2074 6865 2022 6578  on gives the "ex
+0000c4f0: 6163 746c 792d 6f6e 6365 2220 636f 6e64  actly-once" cond
+0000c500: 6974 696f 6e2e 0a0a 5468 6520 6461 6e67  ition...The dang
+0000c510: 6572 2077 6974 6820 2264 7561 6c20 7772  er with "dual wr
+0000c520: 6974 696e 6722 2069 6e20 7468 6520 636f  iting" in the co
+0000c530: 6e73 756d 7074 696f 6e20 6f66 2072 6563  nsumption of rec
+0000c540: 6f72 6465 6420 6576 656e 7473 2069 7320  orded events is 
+0000c550: 7468 6174 2069 6620 610a 7265 636f 7264  that if a.record
+0000c560: 6564 2065 7665 6e74 2069 7320 7375 6363  ed event is succ
+0000c570: 6573 7366 756c 6c79 2070 726f 6365 7373  essfully process
+0000c580: 6564 2061 6e64 206e 6577 2073 7461 7465  ed and new state
+0000c590: 2072 6563 6f72 6465 6420 6174 6f6d 6963   recorded atomic
+0000c5a0: 616c 6c79 2069 6e20 6f6e 650a 7472 616e  ally in one.tran
+0000c5b0: 7361 6374 696f 6e20 7769 7468 2074 6865  saction with the
+0000c5c0: 2063 6f6d 6d69 7420 706f 7369 7469 6f6e   commit position
+0000c5d0: 2072 6563 6f72 6465 6420 696e 2061 2073   recorded in a s
+0000c5e0: 6570 6172 6174 6520 7472 616e 7361 6374  eparate transact
+0000c5f0: 696f 6e2c 206f 6e65 206d 6179 0a68 6170  ion, one may.hap
+0000c600: 7065 6e20 616e 6420 6e6f 7420 7468 6520  pen and not the 
+0000c610: 6f74 6865 722e 2049 6620 7468 6520 6e65  other. If the ne
+0000c620: 7720 7374 6174 6520 6973 2072 6563 6f72  w state is recor
+0000c630: 6465 6420 6275 7420 7468 6520 706f 7369  ded but the posi
+0000c640: 7469 6f6e 2069 7320 6c6f 7374 2c0a 616e  tion is lost,.an
+0000c650: 6420 7468 656e 2074 6865 2070 726f 6365  d then the proce
+0000c660: 7373 696e 6720 6973 2073 746f 7070 6564  ssing is stopped
+0000c670: 2061 6e64 2072 6573 756d 6564 2c20 7468   and resumed, th
+0000c680: 6520 7265 636f 7264 6564 2065 7665 6e74  e recorded event
+0000c690: 206d 6179 2062 6520 7072 6f63 6573 7365   may be processe
+0000c6a0: 640a 7477 6963 652e 204f 6e20 7468 6520  d.twice. On the 
+0000c6b0: 6f74 6865 7220 6861 6e64 2c20 6966 2074  other hand, if t
+0000c6c0: 6865 2063 6f6d 6d69 7420 706f 7369 7469  he commit positi
+0000c6d0: 6f6e 2069 7320 7265 636f 7264 6564 2062  on is recorded b
+0000c6e0: 7574 2074 6865 206e 6577 2073 7461 7465  ut the new state
+0000c6f0: 2069 730a 6c6f 7374 2c20 7468 6520 7265   is.lost, the re
+0000c700: 636f 7264 6564 2065 7665 6e74 206d 6179  corded event may
+0000c710: 2065 6666 6563 7469 7665 6c79 206e 6f74   effectively not
+0000c720: 2062 6520 7072 6f63 6573 7365 6420 6174   be processed at
+0000c730: 2061 6c6c 2e20 4279 2065 6974 6865 720a   all. By either.
+0000c740: 7072 6f63 6573 7369 6e67 2061 6e20 6576  processing an ev
+0000c750: 656e 7420 6d6f 7265 2074 6861 6e20 6f6e  ent more than on
+0000c760: 6365 2c20 6f72 2062 7920 6661 696c 696e  ce, or by failin
+0000c770: 6720 746f 2070 726f 6365 7373 2061 6e20  g to process an 
+0000c780: 6576 656e 742c 2074 6865 2072 6563 6f72  event, the recor
+0000c790: 6465 640a 7374 6174 6520 6f66 2074 6865  ded.state of the
+0000c7a0: 2064 6f77 6e73 7472 6561 6d20 636f 6d70   downstream comp
+0000c7b0: 6f6e 656e 7420 6d69 6768 7420 6265 2069  onent might be i
+0000c7c0: 6e61 6363 7572 6174 652c 206f 7220 706f  naccurate, or po
+0000c7d0: 7373 6962 6c79 2069 6e63 6f6e 7369 7374  ssibly inconsist
+0000c7e0: 656e 742c 2061 6e64 0a70 6572 6861 7073  ent, and.perhaps
+0000c7f0: 2063 6174 6173 7472 6f70 6869 6361 6c6c   catastrophicall
+0000c800: 7920 736f 2e20 5375 6368 2063 6f6e 7365  y so. Such conse
+0000c810: 7175 656e 6365 7320 6d61 7920 6f72 206d  quences may or m
+0000c820: 6179 206e 6f74 206d 6174 7465 7220 696e  ay not matter in
+0000c830: 2079 6f75 7220 7369 7475 6174 696f 6e2e   your situation.
+0000c840: 0a42 7574 2073 6f6d 6574 696d 6573 2069  .But sometimes i
+0000c850: 6e63 6f6e 7369 7374 656e 6369 6573 206d  nconsistencies m
+0000c860: 6179 2068 616c 7420 7072 6f63 6573 7369  ay halt processi
+0000c870: 6e67 2075 6e74 696c 2074 6865 2069 7373  ng until the iss
+0000c880: 7565 2069 7320 7265 736f 6c76 6564 2e20  ue is resolved. 
+0000c890: 596f 7520 6361 6e0a 6176 6f69 6420 2264  You can.avoid "d
+0000c8a0: 7561 6c20 7772 6974 696e 6722 2069 6e20  ual writing" in 
+0000c8b0: 7468 6520 636f 6e73 756d 7074 696f 6e20  the consumption 
+0000c8c0: 6f66 2065 7665 6e74 7320 6279 2061 746f  of events by ato
+0000c8d0: 6d69 6361 6c6c 7920 7265 636f 7264 696e  mically recordin
+0000c8e0: 6720 7468 6520 636f 6d6d 6974 0a70 6f73  g the commit.pos
+0000c8f0: 6974 696f 6e20 6f66 2061 2072 6563 6f72  ition of a recor
+0000c900: 6465 6420 6576 656e 7420 616c 6f6e 6720  ded event along 
+0000c910: 7769 7468 2074 6865 206e 6577 2073 7461  with the new sta
+0000c920: 7465 2074 6861 7420 7265 7375 6c74 7320  te that results 
+0000c930: 6672 6f6d 2070 726f 6365 7373 696e 6720  from processing 
+0000c940: 7468 6174 0a65 7665 6e74 2069 6e20 7468  that.event in th
+0000c950: 6520 7361 6d65 2061 746f 6d69 6320 7472  e same atomic tr
+0000c960: 616e 7361 6374 696f 6e2e 2042 7920 6d61  ansaction. By ma
+0000c970: 6b69 6e67 2074 6865 2072 6563 6f72 6469  king the recordi
+0000c980: 6e67 206f 6620 7468 6520 636f 6d6d 6974  ng of the commit
+0000c990: 2070 6f73 6974 696f 6e73 0a75 6e69 7175   positions.uniqu
+0000c9a0: 652c 2073 6f20 7468 6174 2074 7261 6e73  e, so that trans
+0000c9b0: 6163 7469 6f6e 7320 7769 6c6c 2062 6520  actions will be 
+0000c9c0: 726f 6c6c 6564 2062 6163 6b20 7768 656e  rolled back when
+0000c9d0: 2074 6865 7265 2069 7320 6120 636f 6e66   there is a conf
+0000c9e0: 6c69 6374 2c20 796f 7520 7769 6c6c 0a70  lict, you will.p
+0000c9f0: 7265 7665 6e74 2074 6865 2072 6573 756c  revent the resul
+0000ca00: 7473 206f 6620 616e 7920 6475 706c 6963  ts of any duplic
+0000ca10: 6174 6520 7072 6f63 6573 7369 6e67 206f  ate processing o
+0000ca20: 6620 6120 7265 636f 7264 6564 2065 7665  f a recorded eve
+0000ca30: 6e74 2062 6569 6e67 2063 6f6d 6d69 7474  nt being committ
+0000ca40: 6564 2e0a 0a52 6563 6f72 6465 6420 6576  ed...Recorded ev
+0000ca50: 656e 7473 2072 6563 6569 7665 6420 6672  ents received fr
+0000ca60: 6f6d 2061 2063 6174 6368 2d75 7020 7375  om a catch-up su
+0000ca70: 6273 6372 6970 7469 6f6e 2063 616e 6e6f  bscription canno
+0000ca80: 7420 6265 2061 636b 6e6f 776c 6564 6765  t be acknowledge
+0000ca90: 6420 6261 636b 0a74 6f20 7468 6520 4576  d back.to the Ev
+0000caa0: 656e 7453 746f 7265 4442 2073 6572 7665  entStoreDB serve
+0000cab0: 722e 2041 636b 6e6f 776c 6564 6769 6e67  r. Acknowledging
+0000cac0: 2065 7665 6e74 732c 2068 6f77 6576 6572   events, however
+0000cad0: 2c20 6973 2061 6e20 6173 7065 6374 206f  , is an aspect o
+0000cae0: 6620 2270 6572 7369 7374 656e 740a 7375  f "persistent.su
+0000caf0: 6273 6372 6970 7469 6f6e 7322 2e20 486f  bscriptions". Ho
+0000cb00: 7069 6e67 2074 6f20 7265 6c79 206f 6e20  ping to rely on 
+0000cb10: 6163 6b6e 6f77 6c65 6467 696e 6720 6576  acknowledging ev
+0000cb20: 656e 7473 2074 6f20 616e 2075 7073 7472  ents to an upstr
+0000cb30: 6561 6d0a 636f 6d70 6f6e 656e 7420 6973  eam.component is
+0000cb40: 2061 6e20 6578 616d 706c 6520 6f66 2064   an example of d
+0000cb50: 7561 6c20 7772 6974 696e 672e 0a0a 2323  ual writing...##
+0000cb60: 2320 5375 6273 6372 6962 6520 616c 6c20  # Subscribe all 
+0000cb70: 6576 656e 7473 0a0a 5468 6560 7375 6273  events..The`subs
+0000cb80: 6372 6962 655f 616c 6c5f 6576 656e 7473  cribe_all_events
+0000cb90: 2829 6020 6d65 7468 6f64 2063 616e 2062  ()` method can b
+0000cba0: 6520 7573 6564 2074 6f20 7374 6172 7420  e used to start 
+0000cbb0: 6120 2263 6174 6368 2d75 7022 2073 7562  a "catch-up" sub
+0000cbc0: 7363 7269 7074 696f 6e0a 7468 6174 2063  scription.that c
+0000cbd0: 616e 2072 6574 7572 6e20 6576 656e 7473  an return events
+0000cbe0: 2066 726f 6d20 616c 6c20 7374 7265 616d   from all stream
+0000cbf0: 7320 696e 2074 6865 2064 6174 6162 6173  s in the databas
+0000cc00: 652e 0a0a 5468 6973 206d 6574 686f 6420  e...This method 
+0000cc10: 6361 6e20 6265 2075 7365 6420 6279 2061  can be used by a
+0000cc20: 2064 6f77 6e73 7472 6561 6d20 636f 6d70   downstream comp
+0000cc30: 6f6e 656e 740a 746f 2070 726f 6365 7373  onent.to process
+0000cc40: 2072 6563 6f72 6465 6420 6576 656e 7473   recorded events
+0000cc50: 2077 6974 6820 6578 6163 746c 792d 6f6e   with exactly-on
+0000cc60: 6365 2073 656d 616e 7469 6373 2e0a 0a54  ce semantics...T
+0000cc70: 6869 7320 6d65 7468 6f64 2074 616b 6573  his method takes
+0000cc80: 2061 6e20 6f70 7469 6f6e 616c 2060 636f   an optional `co
+0000cc90: 6d6d 6974 5f70 6f73 6974 696f 6e60 2061  mmit_position` a
+0000cca0: 7267 756d 656e 742c 2077 6869 6368 2063  rgument, which c
+0000ccb0: 616e 2062 650a 7573 6564 2074 6f20 7370  an be.used to sp
+0000ccc0: 6563 6966 7920 6120 636f 6d6d 6974 2070  ecify a commit p
+0000ccd0: 6f73 6974 696f 6e20 6672 6f6d 2077 6869  osition from whi
+0000cce0: 6368 2074 6f20 7375 6273 6372 6962 652e  ch to subscribe.
+0000ccf0: 2054 6865 2064 6566 6175 6c74 0a76 616c   The default.val
+0000cd00: 7565 2069 7320 604e 6f6e 6560 2c20 7768  ue is `None`, wh
+0000cd10: 6963 6820 6d65 616e 7320 7468 6520 7375  ich means the su
+0000cd20: 6273 6372 6970 7469 6f6e 2077 696c 6c20  bscription will 
+0000cd30: 6f70 6572 6174 6520 6672 6f6d 2074 6865  operate from the
+0000cd40: 2066 6972 7374 0a72 6563 6f72 6465 6420   first.recorded 
+0000cd50: 6576 656e 7420 696e 2074 6865 2064 6174  event in the dat
+0000cd60: 6162 6173 652e 2049 6620 6120 636f 6d6d  abase. If a comm
+0000cd70: 6974 2070 6f73 6974 696f 6e20 6973 2067  it position is g
+0000cd80: 6976 656e 2c20 6974 206d 7573 7420 6d61  iven, it must ma
+0000cd90: 7463 680a 616e 2061 6374 7561 6c6c 7920  tch.an actually 
+0000cda0: 6578 6973 7469 6e67 2063 6f6d 6d69 7420  existing commit 
+0000cdb0: 706f 7369 7469 6f6e 2069 6e20 7468 6520  position in the 
+0000cdc0: 6461 7461 6261 7365 2e20 5468 6520 7265  database. The re
+0000cdd0: 636f 6465 6420 6576 656e 7473 2074 6861  coded events tha
+0000cde0: 740a 6172 6520 6f62 7461 696e 6564 2077  t.are obtained w
+0000cdf0: 696c 6c20 6e6f 7420 696e 636c 7564 6520  ill not include 
+0000ce00: 7468 6520 6576 656e 7420 7265 636f 7264  the event record
+0000ce10: 6564 2061 7420 7468 6174 2063 6f6d 6d69  ed at that commi
+0000ce20: 7420 706f 7369 7469 6f6e 2e0a 0a54 6869  t position...Thi
+0000ce30: 7320 6d65 7468 6f64 2061 6c73 6f20 7461  s method also ta
+0000ce40: 6b65 7320 666f 7572 206f 7468 6572 206f  kes four other o
+0000ce50: 7074 696f 6e61 6c20 6172 6775 6d65 6e74  ptional argument
+0000ce60: 732c 2060 6669 6c74 6572 5f65 7863 6c75  s, `filter_exclu
+0000ce70: 6465 602c 0a60 6669 6c74 6572 5f69 6e63  de`,.`filter_inc
+0000ce80: 6c75 6465 602c 2060 6669 6c74 6572 5f62  lude`, `filter_b
+0000ce90: 795f 7374 7265 616d 5f6e 616d 6560 2c20  y_stream_name`, 
+0000cea0: 616e 6420 6074 696d 656f 7574 602e 0a0a  and `timeout`...
+0000ceb0: 5468 6520 6f70 7469 6f6e 616c 2061 7267  The optional arg
+0000cec0: 756d 656e 7420 6066 696c 7465 725f 6578  ument `filter_ex
+0000ced0: 636c 7564 6560 2069 7320 6120 7365 7175  clude` is a sequ
+0000cee0: 656e 6365 206f 6620 7265 6775 6c61 7220  ence of regular 
+0000cef0: 6578 7072 6573 7369 6f6e 7320 7468 6174  expressions that
+0000cf00: 0a6d 6174 6368 2072 6563 6f72 6465 6420  .match recorded 
+0000cf10: 6576 656e 7473 2074 6861 7420 7368 6f75  events that shou
+0000cf20: 6c64 206e 6f74 2062 6520 696e 636c 7564  ld not be includ
+0000cf30: 6564 2e20 5468 6973 2061 7267 756d 656e  ed. This argumen
+0000cf40: 7420 6973 2069 676e 6f72 6564 0a69 6620  t is ignored.if 
+0000cf50: 6066 696c 7465 725f 696e 636c 7564 6560  `filter_include`
+0000cf60: 2069 7320 7365 7420 746f 2061 206e 6f6e   is set to a non
+0000cf70: 2d65 6d70 7479 2073 6571 7565 6e63 652e  -empty sequence.
+0000cf80: 2042 7920 6465 6661 756c 742c 2074 6869   By default, thi
+0000cf90: 7320 6172 6775 6d65 6e74 2069 7320 7365  s argument is se
+0000cfa0: 740a 746f 206d 6174 6368 2074 6865 2065  t.to match the e
+0000cfb0: 7665 6e74 2074 7970 6573 206f 6620 2273  vent types of "s
+0000cfc0: 7973 7465 6d20 6576 656e 7473 222c 2073  ystem events", s
+0000cfd0: 6f20 7468 6174 2045 7665 6e74 5374 6f72  o that EventStor
+0000cfe0: 6544 4220 7379 7374 656d 2065 7665 6e74  eDB system event
+0000cff0: 730a 7769 6c6c 206e 6f74 206e 6f72 6d61  s.will not norma
+0000d000: 6c6c 7920 6265 2069 6e63 6c75 6465 642e  lly be included.
+0000d010: 2053 6565 2074 6865 204e 6f74 6573 2073   See the Notes s
+0000d020: 6563 7469 6f6e 2062 656c 6f77 2066 6f72  ection below for
+0000d030: 206d 6f72 6520 696e 666f 726d 6174 696f   more informatio
+0000d040: 6e0a 6162 6f75 7420 6669 6c74 6572 2065  n.about filter e
+0000d050: 7870 7265 7373 696f 6e73 2e0a 0a54 6865  xpressions...The
+0000d060: 206f 7074 696f 6e61 6c20 6172 6775 6d65   optional argume
+0000d070: 6e74 2060 6669 6c74 6572 5f69 6e63 6c75  nt `filter_inclu
+0000d080: 6465 6020 6973 2061 2073 6571 7565 6e63  de` is a sequenc
+0000d090: 6520 6f66 2072 6567 756c 6172 2065 7870  e of regular exp
+0000d0a0: 7265 7373 696f 6e73 0a74 6861 7420 6d61  ressions.that ma
+0000d0b0: 7463 6820 7265 636f 7264 6564 2065 7665  tch recorded eve
+0000d0c0: 6e74 7320 7468 6174 2073 686f 756c 6420  nts that should 
+0000d0d0: 6265 2069 6e63 6c75 6465 642e 2042 7920  be included. By 
+0000d0e0: 6465 6661 756c 742c 2074 6869 7320 6172  default, this ar
+0000d0f0: 6775 6d65 6e74 0a69 7320 616e 2065 6d70  gument.is an emp
+0000d100: 7479 2074 7570 6c65 2e20 4966 2074 6869  ty tuple. If thi
+0000d110: 7320 6172 6775 6d65 6e74 2069 7320 7365  s argument is se
+0000d120: 7420 746f 2061 206e 6f6e 2d65 6d70 7479  t to a non-empty
+0000d130: 2073 6571 7565 6e63 652c 2074 6865 0a60   sequence, the.`
+0000d140: 6669 6c74 6572 5f65 7863 6c75 6465 6020  filter_exclude` 
+0000d150: 6172 6775 6d65 6e74 2069 7320 6967 6e6f  argument is igno
+0000d160: 7265 642e 0a0a 5468 6520 6f70 7469 6f6e  red...The option
+0000d170: 616c 2061 7267 756d 656e 7420 6066 696c  al argument `fil
+0000d180: 7465 725f 6279 5f73 7472 6561 6d5f 6e61  ter_by_stream_na
+0000d190: 6d65 6020 6973 2061 2050 7974 686f 6e20  me` is a Python 
+0000d1a0: 6062 6f6f 6c60 2074 6861 7420 696e 6469  `bool` that indi
+0000d1b0: 6361 7465 7320 7768 6574 6865 720a 7468  cates whether.th
+0000d1c0: 6520 6669 6c74 6572 2077 696c 6c20 6170  e filter will ap
+0000d1d0: 706c 7920 746f 2065 7665 6e74 2074 7970  ply to event typ
+0000d1e0: 6573 206f 7220 7374 7265 616d 206e 616d  es or stream nam
+0000d1f0: 6573 2e20 4279 2064 6566 6175 6c74 2c20  es. By default, 
+0000d200: 7468 6973 2076 616c 7565 2069 7320 6046  this value is `F
+0000d210: 616c 7365 600a 616e 6420 736f 2074 6865  alse`.and so the
+0000d220: 2066 696c 7465 7269 6e67 2077 696c 6c20   filtering will 
+0000d230: 6170 706c 7920 746f 2074 6865 2065 7665  apply to the eve
+0000d240: 6e74 2074 7970 6520 7374 7269 6e67 7320  nt type strings 
+0000d250: 6f66 2072 6563 6f72 6465 6420 6576 656e  of recorded even
+0000d260: 7473 2e0a 0a50 6c65 6173 6520 6e6f 7465  ts...Please note
+0000d270: 2c20 7468 6520 6669 6c74 6572 696e 6720  , the filtering 
+0000d280: 6861 7070 656e 7320 6f6e 2074 6865 2045  happens on the E
+0000d290: 7665 6e74 5374 6f72 6544 4220 7365 7276  ventStoreDB serv
+0000d2a0: 6572 2c20 616e 6420 7468 650a 606c 696d  er, and the.`lim
+0000d2b0: 6974 6020 6172 6775 6d65 6e74 2069 7320  it` argument is 
+0000d2c0: 6170 706c 6965 6420 6f6e 2074 6865 2073  applied on the s
+0000d2d0: 6572 7665 7220 6166 7465 7220 6669 6c74  erver after filt
+0000d2e0: 6572 696e 672e 0a0a 5468 6520 6f70 7469  ering...The opti
+0000d2f0: 6f6e 616c 2060 7469 6d65 6f75 7460 2061  onal `timeout` a
+0000d300: 7267 756d 656e 7420 6973 2061 2050 7974  rgument is a Pyt
+0000d310: 686f 6e20 6066 6c6f 6174 6020 7768 6963  hon `float` whic
+0000d320: 6820 7365 7473 2061 0a64 6561 646c 696e  h sets a.deadlin
+0000d330: 6520 666f 7220 7468 6520 636f 6d70 6c65  e for the comple
+0000d340: 7469 6f6e 206f 6620 7468 6520 6752 5043  tion of the gRPC
+0000d350: 206f 7065 7261 7469 6f6e 2e0a 0a54 6869   operation...Thi
+0000d360: 7320 6d65 7468 6f64 2072 6574 7572 6e73  s method returns
+0000d370: 2061 2050 7974 686f 6e20 6974 6572 6174   a Python iterat
+0000d380: 6f72 2074 6861 7420 7969 656c 6473 2072  or that yields r
+0000d390: 6563 6f72 6465 6420 6576 656e 7473 2c20  ecorded events, 
+0000d3a0: 696e 636c 7564 696e 6720 6576 656e 7473  including events
+0000d3b0: 0a74 6861 7420 6172 6520 7265 636f 7264  .that are record
+0000d3c0: 6564 2061 6674 6572 2074 6865 2073 7562  ed after the sub
+0000d3d0: 7363 7269 7074 696f 6e20 7761 7320 6372  scription was cr
+0000d3e0: 6561 7465 642e 2049 7465 7261 7469 6e67  eated. Iterating
+0000d3f0: 206f 7665 7220 7468 6973 206f 626a 6563   over this objec
+0000d400: 7420 7769 6c6c 0a74 6865 7265 666f 7265  t will.therefore
+0000d410: 206e 6f74 2073 746f 702c 2075 6e6c 6573   not stop, unles
+0000d420: 7320 7468 6520 636f 6e6e 6563 7469 6f6e  s the connection
+0000d430: 2074 6f20 7468 6520 6461 7461 6261 7365   to the database
+0000d440: 2069 7320 6c6f 7374 2e20 5468 6520 6361   is lost. The ca
+0000d450: 6c6c 2077 696c 6c0a 6265 2065 6e64 6564  ll will.be ended
+0000d460: 2077 6865 6e20 7468 6520 6974 6572 6174   when the iterat
+0000d470: 6f72 206f 626a 6563 7420 6973 2064 656c  or object is del
+0000d480: 6574 6564 2066 726f 6d20 6d65 6d6f 7279  eted from memory
+0000d490: 2c20 7768 6963 6820 7769 6c6c 2068 6170  , which will hap
+0000d4a0: 7065 6e20 7768 656e 2074 6865 0a69 7465  pen when the.ite
+0000d4b0: 7261 746f 7220 6f62 6a65 6374 2067 6f65  rator object goe
+0000d4c0: 7320 6f75 7420 6f66 2073 636f 7065 206f  s out of scope o
+0000d4d0: 7220 6973 2065 7870 6c69 6369 746c 7920  r is explicitly 
+0000d4e0: 6465 6c65 7465 642e 2054 6865 2063 616c  deleted. The cal
+0000d4f0: 6c20 6d61 7920 616c 736f 2062 650a 636c  l may also be.cl
+0000d500: 6f73 6564 2062 7920 7468 6520 7365 7276  osed by the serv
+0000d510: 6572 2e0a 0a54 6865 2073 7562 7363 7269  er...The subscri
+0000d520: 7074 696f 6e20 6f62 6a65 6374 2063 616e  ption object can
+0000d530: 2062 6520 7573 6564 2064 6972 6563 746c   be used directl
+0000d540: 792c 2062 7574 2069 7420 6d69 6768 7420  y, but it might 
+0000d550: 6265 2075 7365 6420 7769 7468 696e 2061  be used within a
+0000d560: 2074 6872 6561 6465 640a 6c6f 6f70 2064   threaded.loop d
+0000d570: 6564 6963 6174 6564 2074 6f20 7265 6365  edicated to rece
+0000d580: 6976 696e 6720 6576 656e 7473 2074 6861  iving events tha
+0000d590: 7420 6361 6e20 6265 2073 746f 7070 6564  t can be stopped
+0000d5a0: 2069 6e20 6120 636f 6e74 726f 6c6c 6564   in a controlled
+0000d5b0: 2077 6179 2c20 7769 7468 0a72 6563 6f72   way, with.recor
+0000d5c0: 6465 6420 6576 656e 7473 2070 7574 206f  ded events put o
+0000d5d0: 6e20 6120 7175 6575 6520 666f 7220 7072  n a queue for pr
+0000d5e0: 6f63 6573 7369 6e67 2069 6e20 6120 6469  ocessing in a di
+0000d5f0: 6666 6572 656e 7420 7468 7265 6164 2e20  fferent thread. 
+0000d600: 5468 6973 2070 6163 6b61 6765 0a64 6f65  This package.doe
+0000d610: 736e 2774 2070 726f 7669 6465 2073 7563  sn't provide suc
+0000d620: 6820 6120 7468 7265 6164 6564 206f 7220  h a threaded or 
+0000d630: 7175 6575 696e 6720 6f62 6a65 6374 2063  queuing object c
+0000d640: 6c61 7373 2e20 4a75 7374 206d 616b 6520  lass. Just make 
+0000d650: 7375 7265 2074 6f20 7265 636f 6e73 7472  sure to reconstr
+0000d660: 7563 740a 7468 6520 7375 6273 6372 6970  uct.the subscrip
+0000d670: 7469 6f6e 2028 616e 6420 7468 6520 7175  tion (and the qu
+0000d680: 6575 6529 2075 7369 6e67 2074 6865 206c  eue) using the l
+0000d690: 6173 7420 7265 636f 7264 6564 2063 6f6d  ast recorded com
+0000d6a0: 6d69 7420 706f 7369 7469 6f6e 2077 6865  mit position whe
+0000d6b0: 6e20 7265 7375 6d69 6e67 0a74 6865 2073  n resuming.the s
+0000d6c0: 7562 7363 7269 7074 696f 6e20 6166 7465  ubscription afte
+0000d6d0: 7220 616e 2065 7272 6f72 2c20 746f 2062  r an error, to b
+0000d6e0: 6520 7375 7265 2061 6c6c 2065 7665 6e74  e sure all event
+0000d6f0: 7320 6172 6520 7072 6f63 6573 7365 6420  s are processed 
+0000d700: 6f6e 6365 2e0a 0a54 6865 2065 7861 6d70  once...The examp
+0000d710: 6c65 2062 656c 6f77 2073 686f 7773 2068  le below shows h
+0000d720: 6f77 2074 6f20 7375 6273 6372 6962 6520  ow to subscribe 
+0000d730: 746f 2072 6563 6569 7665 2061 6c6c 2072  to receive all r
+0000d740: 6563 6f72 6465 640a 6576 656e 7473 2066  ecorded.events f
+0000d750: 726f 6d20 7468 6520 7374 6172 742c 2061  rom the start, a
+0000d760: 6e64 2074 6865 6e20 7265 7375 6d69 6e67  nd then resuming
+0000d770: 2066 726f 6d20 6120 7370 6563 6966 6963   from a specific
+0000d780: 2063 6f6d 6d69 7420 706f 7369 7469 6f6e   commit position
+0000d790: 2e0a 5468 7265 6520 616c 7265 6164 792d  ..Three already-
+0000d7a0: 7265 636f 7264 6564 2065 7665 6e74 7320  recorded events 
+0000d7b0: 6172 6520 7265 6365 6976 6564 2c20 616e  are received, an
+0000d7c0: 6420 7468 656e 2074 6872 6565 206e 6577  d then three new
+0000d7d0: 2065 7665 6e74 7320 6172 650a 7265 636f   events are.reco
+0000d7e0: 7264 6564 2c20 7768 6963 6820 6172 6520  rded, which are 
+0000d7f0: 7468 656e 2072 6563 6569 7665 6420 7669  then received vi
+0000d800: 6120 7468 6520 7375 6273 6372 6970 7469  a the subscripti
+0000d810: 6f6e 2e0a 0a60 6060 7079 7468 6f6e 0a0a  on...```python..
+0000d820: 2320 4170 7065 6e64 2061 6e20 6576 656e  # Append an even
+0000d830: 7420 746f 2061 206e 6577 2073 7472 6561  t to a new strea
+0000d840: 6d2e 0a73 7472 6561 6d5f 6e61 6d65 3220  m..stream_name2 
+0000d850: 3d20 7374 7228 7575 6964 3428 2929 0a65  = str(uuid4()).e
+0000d860: 7665 6e74 3420 3d20 4e65 7745 7665 6e74  vent4 = NewEvent
+0000d870: 2874 7970 653d 274f 7264 6572 4372 6561  (type='OrderCrea
+0000d880: 7465 6427 2c20 6461 7461 3d62 2764 6174  ted', data=b'dat
+0000d890: 6134 2729 0a63 6c69 656e 742e 6170 7065  a4').client.appe
+0000d8a0: 6e64 5f65 7665 6e74 7328 0a20 2020 2073  nd_events(.    s
+0000d8b0: 7472 6561 6d5f 6e61 6d65 3d73 7472 6561  tream_name=strea
+0000d8c0: 6d5f 6e61 6d65 322c 0a20 2020 2065 7870  m_name2,.    exp
+0000d8d0: 6563 7465 645f 706f 7369 7469 6f6e 3d4e  ected_position=N
+0000d8e0: 6f6e 652c 0a20 2020 2065 7665 6e74 733d  one,.    events=
+0000d8f0: 5b65 7665 6e74 345d 2c0a 290a 0a23 2053  [event4],.)..# S
+0000d900: 7562 7363 7269 6265 2066 726f 6d20 7468  ubscribe from th
+0000d910: 6520 6669 7273 7420 7265 636f 7264 6564  e first recorded
+0000d920: 2065 7665 6e74 2069 6e20 7468 6520 6461   event in the da
+0000d930: 7461 6261 7365 2e0a 7375 6273 6372 6970  tabase..subscrip
+0000d940: 7469 6f6e 203d 2063 6c69 656e 742e 7375  tion = client.su
+0000d950: 6273 6372 6962 655f 616c 6c5f 6576 656e  bscribe_all_even
+0000d960: 7473 2829 0a72 6563 6569 7665 645f 6576  ts().received_ev
+0000d970: 656e 7473 203d 205b 5d0a 0a23 2050 726f  ents = []..# Pro
+0000d980: 6365 7373 2065 7665 6e74 7320 7265 6365  cess events rece
+0000d990: 6976 6564 2066 726f 6d20 7468 6520 6361  ived from the ca
+0000d9a0: 7463 682d 7570 2073 7562 7363 7269 7074  tch-up subscript
+0000d9b0: 696f 6e2e 0a66 6f72 2065 7665 6e74 2069  ion..for event i
+0000d9c0: 6e20 7375 6273 6372 6970 7469 6f6e 3a0a  n subscription:.
+0000d9d0: 2020 2020 6c61 7374 5f63 6f6d 6d69 745f      last_commit_
+0000d9e0: 706f 7369 7469 6f6e 203d 2065 7665 6e74  position = event
+0000d9f0: 2e63 6f6d 6d69 745f 706f 7369 7469 6f6e  .commit_position
+0000da00: 0a20 2020 2072 6563 6569 7665 645f 6576  .    received_ev
+0000da10: 656e 7473 2e61 7070 656e 6428 6576 656e  ents.append(even
+0000da20: 7429 0a20 2020 2069 6620 6576 656e 742e  t).    if event.
+0000da30: 6964 203d 3d20 6576 656e 7434 2e69 643a  id == event4.id:
+0000da40: 0a20 2020 2020 2020 2062 7265 616b 0a0a  .        break..
+0000da50: 6173 7365 7274 2072 6563 6569 7665 645f  assert received_
+0000da60: 6576 656e 7473 5b2d 385d 2e69 6420 3d3d  events[-8].id ==
+0000da70: 2065 7665 6e74 312e 6964 0a61 7373 6572   event1.id.asser
+0000da80: 7420 7265 6365 6976 6564 5f65 7665 6e74  t received_event
+0000da90: 735b 2d37 5d2e 6964 203d 3d20 6576 656e  s[-7].id == even
+0000daa0: 7432 2e69 640a 6173 7365 7274 2072 6563  t2.id.assert rec
+0000dab0: 6569 7665 645f 6576 656e 7473 5b2d 365d  eived_events[-6]
+0000dac0: 2e69 6420 3d3d 2065 7665 6e74 332e 6964  .id == event3.id
+0000dad0: 0a61 7373 6572 7420 7265 6365 6976 6564  .assert received
+0000dae0: 5f65 7665 6e74 735b 2d35 5d2e 7479 7065  _events[-5].type
+0000daf0: 203d 3d20 2244 6f67 5265 6769 7374 6572   == "DogRegister
+0000db00: 6564 220a 6173 7365 7274 2072 6563 6569  ed".assert recei
+0000db10: 7665 645f 6576 656e 7473 5b2d 345d 2e74  ved_events[-4].t
+0000db20: 7970 6520 3d3d 2022 446f 674c 6561 726e  ype == "DogLearn
+0000db30: 6564 5472 6963 6b22 0a61 7373 6572 7420  edTrick".assert 
+0000db40: 7265 6365 6976 6564 5f65 7665 6e74 735b  received_events[
+0000db50: 2d33 5d2e 7479 7065 203d 3d20 2244 6f67  -3].type == "Dog
+0000db60: 4c65 6172 6e65 6454 7269 636b 220a 6173  LearnedTrick".as
+0000db70: 7365 7274 2072 6563 6569 7665 645f 6576  sert received_ev
+0000db80: 656e 7473 5b2d 325d 2e74 7970 6520 3d3d  ents[-2].type ==
+0000db90: 2022 446f 674c 6561 726e 6564 5472 6963   "DogLearnedTric
+0000dba0: 6b22 0a61 7373 6572 7420 7265 6365 6976  k".assert receiv
+0000dbb0: 6564 5f65 7665 6e74 735b 2d31 5d2e 6964  ed_events[-1].id
+0000dbc0: 203d 3d20 6576 656e 7434 2e69 640a 0a23   == event4.id..#
+0000dbd0: 2041 7070 656e 6420 7375 6273 6571 7565   Append subseque
+0000dbe0: 6e74 2065 7665 6e74 7320 746f 2074 6865  nt events to the
+0000dbf0: 2073 7472 6561 6d2e 0a65 7665 6e74 3520   stream..event5 
+0000dc00: 3d20 4e65 7745 7665 6e74 2874 7970 653d  = NewEvent(type=
+0000dc10: 274f 7264 6572 5570 6461 7465 6427 2c20  'OrderUpdated', 
+0000dc20: 6461 7461 3d62 2764 6174 6135 2729 0a63  data=b'data5').c
+0000dc30: 6c69 656e 742e 6170 7065 6e64 5f65 7665  lient.append_eve
+0000dc40: 6e74 7328 0a20 2020 2073 7472 6561 6d5f  nts(.    stream_
+0000dc50: 6e61 6d65 3d73 7472 6561 6d5f 6e61 6d65  name=stream_name
+0000dc60: 322c 0a20 2020 2065 7870 6563 7465 645f  2,.    expected_
+0000dc70: 706f 7369 7469 6f6e 3d30 2c0a 2020 2020  position=0,.    
+0000dc80: 6576 656e 7473 3d5b 6576 656e 7435 5d2c  events=[event5],
+0000dc90: 0a29 0a0a 2320 5265 6365 6976 6520 7375  .)..# Receive su
+0000dca0: 6273 6571 7565 6e74 2065 7665 6e74 7320  bsequent events 
+0000dcb0: 6672 6f6d 2074 6865 2073 7562 7363 7269  from the subscri
+0000dcc0: 7074 696f 6e2e 0a66 6f72 2065 7665 6e74  ption..for event
+0000dcd0: 2069 6e20 7375 6273 6372 6970 7469 6f6e   in subscription
+0000dce0: 3a0a 2020 2020 6c61 7374 5f63 6f6d 6d69  :.    last_commi
+0000dcf0: 745f 706f 7369 7469 6f6e 203d 2065 7665  t_position = eve
+0000dd00: 6e74 2e63 6f6d 6d69 745f 706f 7369 7469  nt.commit_positi
+0000dd10: 6f6e 0a20 2020 2072 6563 6569 7665 645f  on.    received_
+0000dd20: 6576 656e 7473 2e61 7070 656e 6428 6576  events.append(ev
+0000dd30: 656e 7429 0a20 2020 2069 6620 6576 656e  ent).    if even
+0000dd40: 742e 6964 203d 3d20 6576 656e 7435 2e69  t.id == event5.i
+0000dd50: 643a 0a20 2020 2020 2020 2062 7265 616b  d:.        break
+0000dd60: 0a0a 0a0a 6173 7365 7274 2072 6563 6569  ....assert recei
+0000dd70: 7665 645f 6576 656e 7473 5b2d 325d 2e69  ved_events[-2].i
+0000dd80: 6420 3d3d 2065 7665 6e74 342e 6964 0a61  d == event4.id.a
+0000dd90: 7373 6572 7420 7265 6365 6976 6564 5f65  ssert received_e
+0000dda0: 7665 6e74 735b 2d31 5d2e 6964 203d 3d20  vents[-1].id == 
+0000ddb0: 6576 656e 7435 2e69 640a 0a0a 2320 4170  event5.id...# Ap
+0000ddc0: 7065 6e64 206d 6f72 6520 6576 656e 7473  pend more events
+0000ddd0: 2074 6f20 7468 6520 7374 7265 616d 2e0a   to the stream..
+0000dde0: 6576 656e 7436 203d 204e 6577 4576 656e  event6 = NewEven
+0000ddf0: 7428 7479 7065 3d27 4f72 6465 7244 656c  t(type='OrderDel
+0000de00: 6574 6564 272c 2064 6174 613d 6227 6461  eted', data=b'da
+0000de10: 7461 3627 290a 636c 6965 6e74 2e61 7070  ta6').client.app
+0000de20: 656e 645f 6576 656e 7473 280a 2020 2020  end_events(.    
+0000de30: 7374 7265 616d 5f6e 616d 653d 7374 7265  stream_name=stre
+0000de40: 616d 5f6e 616d 6532 2c0a 2020 2020 6578  am_name2,.    ex
+0000de50: 7065 6374 6564 5f70 6f73 6974 696f 6e3d  pected_position=
+0000de60: 312c 0a20 2020 2065 7665 6e74 733d 5b65  1,.    events=[e
+0000de70: 7665 6e74 365d 2c0a 290a 0a0a 2320 5265  vent6],.)...# Re
+0000de80: 7375 6d65 2073 7562 7363 7269 6269 6e67  sume subscribing
+0000de90: 2066 726f 6d20 7468 6520 6c61 7374 2063   from the last c
+0000dea0: 6f6d 6d69 7420 706f 7369 7469 6f6e 2e0a  ommit position..
+0000deb0: 7375 6273 6372 6970 7469 6f6e 203d 2063  subscription = c
+0000dec0: 6c69 656e 742e 7375 6273 6372 6962 655f  lient.subscribe_
+0000ded0: 616c 6c5f 6576 656e 7473 280a 2020 2020  all_events(.    
+0000dee0: 636f 6d6d 6974 5f70 6f73 6974 696f 6e3d  commit_position=
+0000def0: 6c61 7374 5f63 6f6d 6d69 745f 706f 7369  last_commit_posi
+0000df00: 7469 6f6e 0a29 0a0a 0a23 2043 6174 6368  tion.)...# Catch
+0000df10: 2075 7020 6279 2072 6563 6569 7669 6e67   up by receiving
+0000df20: 2074 6865 206e 6577 2065 7665 6e74 2066   the new event f
+0000df30: 726f 6d20 7468 6520 7375 6273 6372 6970  rom the subscrip
+0000df40: 7469 6f6e 2e0a 666f 7220 6576 656e 7420  tion..for event 
+0000df50: 696e 2073 7562 7363 7269 7074 696f 6e3a  in subscription:
+0000df60: 0a20 2020 2072 6563 6569 7665 645f 6576  .    received_ev
+0000df70: 656e 7473 2e61 7070 656e 6428 6576 656e  ents.append(even
+0000df80: 7429 0a20 2020 2069 6620 6576 656e 742e  t).    if event.
+0000df90: 6964 203d 3d20 6576 656e 7436 2e69 643a  id == event6.id:
+0000dfa0: 0a20 2020 2020 2020 2062 7265 616b 0a0a  .        break..
+0000dfb0: 6173 7365 7274 2072 6563 6569 7665 645f  assert received_
+0000dfc0: 6576 656e 7473 5b2d 335d 2e69 6420 3d3d  events[-3].id ==
+0000dfd0: 2065 7665 6e74 342e 6964 0a61 7373 6572   event4.id.asser
+0000dfe0: 7420 7265 6365 6976 6564 5f65 7665 6e74  t received_event
+0000dff0: 735b 2d32 5d2e 6964 203d 3d20 6576 656e  s[-2].id == even
+0000e000: 7435 2e69 640a 6173 7365 7274 2072 6563  t5.id.assert rec
+0000e010: 6569 7665 645f 6576 656e 7473 5b2d 315d  eived_events[-1]
+0000e020: 2e69 6420 3d3d 2065 7665 6e74 362e 6964  .id == event6.id
+0000e030: 0a0a 0a23 2041 7070 656e 6420 7468 7265  ...# Append thre
+0000e040: 6520 6d6f 7265 2065 7665 6e74 7320 746f  e more events to
+0000e050: 2061 206e 6577 2073 7472 6561 6d2e 0a73   a new stream..s
+0000e060: 7472 6561 6d5f 6e61 6d65 3320 3d20 7374  tream_name3 = st
+0000e070: 7228 7575 6964 3428 2929 0a65 7665 6e74  r(uuid4()).event
+0000e080: 3720 3d20 4e65 7745 7665 6e74 2874 7970  7 = NewEvent(typ
+0000e090: 653d 274f 7264 6572 4372 6561 7465 6427  e='OrderCreated'
+0000e0a0: 2c20 6461 7461 3d62 2764 6174 6137 2729  , data=b'data7')
+0000e0b0: 0a65 7665 6e74 3820 3d20 4e65 7745 7665  .event8 = NewEve
+0000e0c0: 6e74 2874 7970 653d 274f 7264 6572 5570  nt(type='OrderUp
+0000e0d0: 6461 7465 6427 2c20 6461 7461 3d62 2764  dated', data=b'd
+0000e0e0: 6174 6138 2729 0a65 7665 6e74 3920 3d20  ata8').event9 = 
+0000e0f0: 4e65 7745 7665 6e74 2874 7970 653d 274f  NewEvent(type='O
+0000e100: 7264 6572 4465 6c65 7465 6427 2c20 6461  rderDeleted', da
+0000e110: 7461 3d62 2764 6174 6139 2729 0a0a 636c  ta=b'data9')..cl
+0000e120: 6965 6e74 2e61 7070 656e 645f 6576 656e  ient.append_even
+0000e130: 7473 280a 2020 2020 7374 7265 616d 5f6e  ts(.    stream_n
+0000e140: 616d 653d 7374 7265 616d 5f6e 616d 6533  ame=stream_name3
+0000e150: 2c0a 2020 2020 6578 7065 6374 6564 5f70  ,.    expected_p
+0000e160: 6f73 6974 696f 6e3d 4e6f 6e65 2c0a 2020  osition=None,.  
+0000e170: 2020 6576 656e 7473 3d5b 6576 656e 7437    events=[event7
+0000e180: 2c20 6576 656e 7438 2c20 6576 656e 7439  , event8, event9
+0000e190: 5d2c 0a29 0a0a 2320 5265 6365 6976 6520  ],.)..# Receive 
+0000e1a0: 7468 6520 7468 7265 6520 6e65 7720 6576  the three new ev
+0000e1b0: 656e 7473 2066 726f 6d20 7468 6520 7265  ents from the re
+0000e1c0: 7375 6d65 6420 7375 6273 6372 6970 7469  sumed subscripti
+0000e1d0: 6f6e 2e0a 666f 7220 6576 656e 7420 696e  on..for event in
+0000e1e0: 2073 7562 7363 7269 7074 696f 6e3a 0a20   subscription:. 
+0000e1f0: 2020 2072 6563 6569 7665 645f 6576 656e     received_even
+0000e200: 7473 2e61 7070 656e 6428 6576 656e 7429  ts.append(event)
+0000e210: 0a20 2020 2069 6620 6576 656e 742e 6964  .    if event.id
+0000e220: 203d 3d20 6576 656e 7439 2e69 643a 0a20   == event9.id:. 
+0000e230: 2020 2020 2020 2062 7265 616b 0a0a 6173         break..as
+0000e240: 7365 7274 2072 6563 6569 7665 645f 6576  sert received_ev
+0000e250: 656e 7473 5b2d 365d 2e69 6420 3d3d 2065  ents[-6].id == e
+0000e260: 7665 6e74 342e 6964 0a61 7373 6572 7420  vent4.id.assert 
+0000e270: 7265 6365 6976 6564 5f65 7665 6e74 735b  received_events[
+0000e280: 2d35 5d2e 6964 203d 3d20 6576 656e 7435  -5].id == event5
+0000e290: 2e69 640a 6173 7365 7274 2072 6563 6569  .id.assert recei
+0000e2a0: 7665 645f 6576 656e 7473 5b2d 345d 2e69  ved_events[-4].i
+0000e2b0: 6420 3d3d 2065 7665 6e74 362e 6964 0a61  d == event6.id.a
+0000e2c0: 7373 6572 7420 7265 6365 6976 6564 5f65  ssert received_e
+0000e2d0: 7665 6e74 735b 2d33 5d2e 6964 203d 3d20  vents[-3].id == 
+0000e2e0: 6576 656e 7437 2e69 640a 6173 7365 7274  event7.id.assert
+0000e2f0: 2072 6563 6569 7665 645f 6576 656e 7473   received_events
+0000e300: 5b2d 325d 2e69 6420 3d3d 2065 7665 6e74  [-2].id == event
+0000e310: 382e 6964 0a61 7373 6572 7420 7265 6365  8.id.assert rece
+0000e320: 6976 6564 5f65 7665 6e74 735b 2d31 5d2e  ived_events[-1].
+0000e330: 6964 203d 3d20 6576 656e 7439 2e69 640a  id == event9.id.
+0000e340: 6060 600a 0a54 6865 2063 6174 6368 2d75  ```..The catch-u
+0000e350: 7020 7375 6273 6372 6970 7469 6f6e 2063  p subscription c
+0000e360: 616c 6c20 6973 2065 6e64 6564 2061 7320  all is ended as 
+0000e370: 736f 6f6e 2061 7320 7468 6520 7375 6273  soon as the subs
+0000e380: 6372 6970 7469 6f6e 206f 626a 6563 740a  cription object.
+0000e390: 676f 6573 206f 7574 206f 6620 7363 6f70  goes out of scop
+0000e3a0: 6520 6f72 2069 7320 6578 706c 6963 6974  e or is explicit
+0000e3b0: 6c79 2064 656c 6574 6564 2066 726f 6d20  ly deleted from 
+0000e3c0: 6d65 6d6f 7279 2e0a 0a60 6060 7079 7468  memory...```pyth
+0000e3d0: 6f6e 0a23 2045 6e64 2074 6865 2073 7562  on.# End the sub
+0000e3e0: 7363 7269 7074 696f 6e2e 0a64 656c 2073  scription..del s
+0000e3f0: 7562 7363 7269 7074 696f 6e0a 6060 600a  ubscription.```.
+0000e400: 0a23 2323 2053 7562 7363 7269 6265 2073  .### Subscribe s
+0000e410: 7472 6561 6d20 6576 656e 7473 0a0a 5468  tream events..Th
+0000e420: 6560 7375 6273 6372 6962 655f 7374 7265  e`subscribe_stre
+0000e430: 616d 5f65 7665 6e74 7328 2960 206d 6574  am_events()` met
+0000e440: 686f 6420 6361 6e20 6265 2075 7365 6420  hod can be used 
+0000e450: 746f 2073 7461 7274 2061 2022 6361 7463  to start a "catc
+0000e460: 682d 7570 2220 7375 6273 6372 6970 7469  h-up" subscripti
+0000e470: 6f6e 0a74 6861 7420 6361 6e20 7265 7475  on.that can retu
+0000e480: 726e 2065 7665 6e74 7320 7468 6174 2061  rn events that a
+0000e490: 7265 2072 6563 6f72 6465 6420 696e 2061  re recorded in a
+0000e4a0: 2073 696e 676c 6520 7374 7265 616d 2e0a   single stream..
+0000e4b0: 0a54 6869 7320 6d65 7468 6f64 2074 616b  .This method tak
+0000e4c0: 6573 2061 2072 6571 7569 7265 6420 6073  es a required `s
+0000e4d0: 7472 6561 6d5f 6e61 6d65 6020 6172 6775  tream_name` argu
+0000e4e0: 6d65 6e74 2c20 7768 6963 6820 7370 6563  ment, which spec
+0000e4f0: 6966 6965 7320 7468 6520 6e61 6d65 206f  ifies the name o
+0000e500: 6620 7468 6520 7374 7265 616d 0a66 726f  f the stream.fro
+0000e510: 6d20 7768 6963 6820 7265 636f 7264 6564  m which recorded
+0000e520: 2065 7665 6e74 7320 7769 6c6c 2062 6520   events will be 
+0000e530: 7265 6365 6976 6564 2e0a 0a54 6869 7320  received...This 
+0000e540: 6d65 7468 6f64 2061 6c73 6f20 7461 6b65  method also take
+0000e550: 7320 7477 6f20 6f70 7469 6f6e 616c 2061  s two optional a
+0000e560: 7267 756d 656e 7473 2c20 6073 7472 6561  rguments, `strea
+0000e570: 6d5f 706f 7369 7469 6f6e 602c 2061 6e64  m_position`, and
+0000e580: 2060 7469 6d65 6f75 7460 2e0a 0a54 6865   `timeout`...The
+0000e590: 206f 7074 696f 6e61 6c20 6073 7472 6561   optional `strea
+0000e5a0: 6d5f 706f 7369 7469 6f6e 6020 6172 6775  m_position` argu
+0000e5b0: 6d65 6e74 2073 7065 6369 6669 6573 2061  ment specifies a
+0000e5c0: 2070 6f73 6974 696f 6e20 696e 2074 6865   position in the
+0000e5d0: 2073 7472 6561 6d20 6672 6f6d 2077 6869   stream from whi
+0000e5e0: 6368 0a72 6563 6f72 6465 6420 6576 656e  ch.recorded even
+0000e5f0: 7473 2077 696c 6c20 6265 2072 6563 6569  ts will be recei
+0000e600: 7665 642e 2054 6865 2065 7665 6e74 2061  ved. The event a
+0000e610: 7420 7468 6520 7370 6563 6966 6965 6420  t the specified 
+0000e620: 7374 7265 616d 2070 6f73 6974 696f 6e20  stream position 
+0000e630: 7769 6c6c 206e 6f74 0a62 6520 696e 636c  will not.be incl
+0000e640: 7564 6564 2e0a 0a54 6865 206f 7074 696f  uded...The optio
+0000e650: 6e61 6c20 6074 696d 656f 7574 6020 6172  nal `timeout` ar
+0000e660: 6775 6d65 6e74 2069 7320 6120 5079 7468  gument is a Pyth
+0000e670: 6f6e 2060 666c 6f61 7460 2074 6861 7420  on `float` that 
+0000e680: 7365 7473 0a61 2064 6561 646c 696e 6520  sets.a deadline 
+0000e690: 666f 7220 7468 6520 636f 6d70 6c65 7469  for the completi
+0000e6a0: 6f6e 206f 6620 7468 6520 6752 5043 206f  on of the gRPC o
+0000e6b0: 7065 7261 7469 6f6e 2e0a 0a54 6865 2065  peration...The e
+0000e6c0: 7861 6d70 6c65 2062 656c 6f77 2073 686f  xample below sho
+0000e6d0: 7773 2068 6f77 2074 6f20 7374 6172 7420  ws how to start 
+0000e6e0: 6120 6361 7463 682d 7570 2073 7562 7363  a catch-up subsc
+0000e6f0: 7269 7074 696f 6e20 746f 2061 2073 7472  ription to a str
+0000e700: 6561 6d2e 0a0a 6060 6070 7974 686f 6e0a  eam...```python.
+0000e710: 0a23 2053 7562 7363 7269 6265 2074 6f20  .# Subscribe to 
+0000e720: 6576 656e 7473 2066 726f 6d20 7374 7265  events from stre
+0000e730: 616d 322c 2066 726f 6d20 7468 6520 7374  am2, from the st
+0000e740: 6172 742e 0a73 7562 7363 7269 7074 696f  art..subscriptio
+0000e750: 6e20 3d20 636c 6965 6e74 2e73 7562 7363  n = client.subsc
+0000e760: 7269 6265 5f73 7472 6561 6d5f 6576 656e  ribe_stream_even
+0000e770: 7473 2873 7472 6561 6d5f 6e61 6d65 3d73  ts(stream_name=s
+0000e780: 7472 6561 6d5f 6e61 6d65 3229 0a0a 2320  tream_name2)..# 
+0000e790: 5265 6164 2066 726f 6d20 7468 6520 7375  Read from the su
+0000e7a0: 6273 6372 6970 7469 6f6e 2e0a 6576 656e  bscription..even
+0000e7b0: 7473 203d 205b 5d0a 666f 7220 6576 656e  ts = [].for even
+0000e7c0: 7420 696e 2073 7562 7363 7269 7074 696f  t in subscriptio
+0000e7d0: 6e3a 0a20 2020 2065 7665 6e74 732e 6170  n:.    events.ap
+0000e7e0: 7065 6e64 2865 7665 6e74 290a 2020 2020  pend(event).    
+0000e7f0: 6966 2065 7665 6e74 2e69 6420 3d3d 2065  if event.id == e
+0000e800: 7665 6e74 362e 6964 3a0a 2020 2020 2020  vent6.id:.      
+0000e810: 2020 6272 6561 6b0a 0a23 2043 6865 636b    break..# Check
+0000e820: 2077 6520 676f 7420 6576 656e 7473 206f   we got events o
+0000e830: 6e6c 7920 6672 6f6d 2073 7472 6561 6d32  nly from stream2
+0000e840: 2e0a 6173 7365 7274 206c 656e 2865 7665  ..assert len(eve
+0000e850: 6e74 7329 203d 3d20 330a 6576 656e 7473  nts) == 3.events
+0000e860: 5b30 5d2e 7374 7265 616d 5f6e 616d 6520  [0].stream_name 
+0000e870: 3d3d 2073 7472 6561 6d5f 6e61 6d65 320a  == stream_name2.
+0000e880: 6576 656e 7473 5b31 5d2e 7374 7265 616d  events[1].stream
+0000e890: 5f6e 616d 6520 3d3d 2073 7472 6561 6d5f  _name == stream_
+0000e8a0: 6e61 6d65 320a 6576 656e 7473 5b32 5d2e  name2.events[2].
+0000e8b0: 7374 7265 616d 5f6e 616d 6520 3d3d 2073  stream_name == s
+0000e8c0: 7472 6561 6d5f 6e61 6d65 320a 0a23 2041  tream_name2..# A
+0000e8d0: 7070 656e 6420 616e 6f74 6865 7220 6576  ppend another ev
+0000e8e0: 656e 7420 746f 2073 7472 6561 6d33 2e0a  ent to stream3..
+0000e8f0: 6576 656e 7431 3020 3d20 4e65 7745 7665  event10 = NewEve
+0000e900: 6e74 2874 7970 653d 224f 7264 6572 556e  nt(type="OrderUn
+0000e910: 6465 6c65 7465 6422 2c20 6461 7461 3d62  deleted", data=b
+0000e920: 2764 6174 6131 3027 290a 636c 6965 6e74  'data10').client
+0000e930: 2e61 7070 656e 645f 6576 656e 7473 280a  .append_events(.
+0000e940: 2020 2020 7374 7265 616d 5f6e 616d 653d      stream_name=
+0000e950: 7374 7265 616d 5f6e 616d 6533 2c0a 2020  stream_name3,.  
+0000e960: 2020 6578 7065 6374 6564 5f70 6f73 6974    expected_posit
+0000e970: 696f 6e3d 322c 0a20 2020 2065 7665 6e74  ion=2,.    event
+0000e980: 733d 5b65 7665 6e74 3130 5d2c 0a29 0a0a  s=[event10],.)..
+0000e990: 2320 4170 7065 6e64 2061 6e6f 7468 6572  # Append another
+0000e9a0: 2065 7665 6e74 2074 6f20 7374 7265 616d   event to stream
+0000e9b0: 322e 0a65 7665 6e74 3131 203d 204e 6577  2..event11 = New
+0000e9c0: 4576 656e 7428 7479 7065 3d22 4f72 6465  Event(type="Orde
+0000e9d0: 7255 6e64 656c 6574 6564 222c 2064 6174  rUndeleted", dat
+0000e9e0: 613d 6227 6461 7461 3131 2729 0a63 6c69  a=b'data11').cli
+0000e9f0: 656e 742e 6170 7065 6e64 5f65 7665 6e74  ent.append_event
+0000ea00: 7328 0a20 2020 2073 7472 6561 6d5f 6e61  s(.    stream_na
+0000ea10: 6d65 3d73 7472 6561 6d5f 6e61 6d65 322c  me=stream_name2,
+0000ea20: 0a20 2020 2065 7870 6563 7465 645f 706f  .    expected_po
+0000ea30: 7369 7469 6f6e 3d32 2c0a 2020 2020 6576  sition=2,.    ev
+0000ea40: 656e 7473 3d5b 6576 656e 7431 315d 0a29  ents=[event11].)
+0000ea50: 0a0a 2320 436f 6e74 696e 7565 2072 6561  ..# Continue rea
+0000ea60: 6469 6e67 2066 726f 6d20 7468 6520 7375  ding from the su
+0000ea70: 6273 6372 6970 7469 6f6e 2e0a 666f 7220  bscription..for 
+0000ea80: 6576 656e 7420 696e 2073 7562 7363 7269  event in subscri
+0000ea90: 7074 696f 6e3a 0a20 2020 2065 7665 6e74  ption:.    event
+0000eaa0: 732e 6170 7065 6e64 2865 7665 6e74 290a  s.append(event).
+0000eab0: 2020 2020 6966 2065 7665 6e74 2e69 6420      if event.id 
+0000eac0: 3d3d 2065 7665 6e74 3131 2e69 643a 0a20  == event11.id:. 
+0000ead0: 2020 2020 2020 2062 7265 616b 0a0a 2320         break..# 
+0000eae0: 4368 6563 6b20 7765 2067 6f74 2065 7665  Check we got eve
+0000eaf0: 6e74 7320 6f6e 6c79 2066 726f 6d20 7374  nts only from st
+0000eb00: 7265 616d 322e 0a61 7373 6572 7420 6c65  ream2..assert le
+0000eb10: 6e28 6576 656e 7473 2920 3d3d 2034 0a65  n(events) == 4.e
+0000eb20: 7665 6e74 735b 305d 2e73 7472 6561 6d5f  vents[0].stream_
+0000eb30: 6e61 6d65 203d 3d20 7374 7265 616d 5f6e  name == stream_n
+0000eb40: 616d 6532 0a65 7665 6e74 735b 315d 2e73  ame2.events[1].s
+0000eb50: 7472 6561 6d5f 6e61 6d65 203d 3d20 7374  tream_name == st
+0000eb60: 7265 616d 5f6e 616d 6532 0a65 7665 6e74  ream_name2.event
+0000eb70: 735b 325d 2e73 7472 6561 6d5f 6e61 6d65  s[2].stream_name
+0000eb80: 203d 3d20 7374 7265 616d 5f6e 616d 6532   == stream_name2
+0000eb90: 0a65 7665 6e74 735b 335d 2e73 7472 6561  .events[3].strea
+0000eba0: 6d5f 6e61 6d65 203d 3d20 7374 7265 616d  m_name == stream
+0000ebb0: 5f6e 616d 6532 0a60 6060 0a0a 5468 6520  _name2.```..The 
+0000ebc0: 6578 616d 706c 6520 6265 6c6f 7720 7368  example below sh
+0000ebd0: 6f77 7320 686f 7720 746f 2073 7461 7274  ows how to start
+0000ebe0: 2061 2063 6174 6368 2d75 7020 7375 6273   a catch-up subs
+0000ebf0: 6372 6970 7469 6f6e 2074 6f20 6120 7374  cription to a st
+0000ec00: 7265 616d 2066 726f 6d20 610a 7370 6563  ream from a.spec
+0000ec10: 6966 6963 2073 7472 6561 6d20 706f 7369  ific stream posi
+0000ec20: 7469 6f6e 2e0a 0a60 6060 7079 7468 6f6e  tion...```python
+0000ec30: 0a0a 2320 5375 6273 6372 6962 6520 746f  ..# Subscribe to
+0000ec40: 2065 7665 6e74 7320 6672 6f6d 2073 7472   events from str
+0000ec50: 6561 6d32 2c20 6672 6f6d 2074 6865 2073  eam2, from the s
+0000ec60: 7461 7274 2e0a 7375 6273 6372 6970 7469  tart..subscripti
+0000ec70: 6f6e 203d 2063 6c69 656e 742e 7375 6273  on = client.subs
+0000ec80: 6372 6962 655f 7374 7265 616d 5f65 7665  cribe_stream_eve
+0000ec90: 6e74 7328 0a20 2020 2073 7472 6561 6d5f  nts(.    stream_
+0000eca0: 6e61 6d65 3d73 7472 6561 6d5f 6e61 6d65  name=stream_name
+0000ecb0: 322c 0a20 2020 2073 7472 6561 6d5f 706f  2,.    stream_po
+0000ecc0: 7369 7469 6f6e 3d31 2c0a 290a 0a23 2052  sition=1,.)..# R
+0000ecd0: 6561 6420 6576 656e 7420 6672 6f6d 2074  ead event from t
+0000ece0: 6865 2073 7562 7363 7269 7074 696f 6e2e  he subscription.
+0000ecf0: 0a65 7665 6e74 7320 3d20 5b5d 0a66 6f72  .events = [].for
+0000ed00: 2065 7665 6e74 2069 6e20 7375 6273 6372   event in subscr
+0000ed10: 6970 7469 6f6e 3a0a 2020 2020 6576 656e  iption:.    even
+0000ed20: 7473 2e61 7070 656e 6428 6576 656e 7429  ts.append(event)
+0000ed30: 0a20 2020 2069 6620 6576 656e 742e 6964  .    if event.id
+0000ed40: 203d 3d20 6576 656e 7431 312e 6964 3a0a   == event11.id:.
+0000ed50: 2020 2020 2020 2020 6272 6561 6b0a 0a23          break..#
+0000ed60: 2043 6865 636b 2077 6520 676f 7420 6576   Check we got ev
+0000ed70: 656e 7473 206f 6e6c 7920 6166 7465 7220  ents only after 
+0000ed80: 706f 7369 7469 6f6e 2031 2e0a 6173 7365  position 1..asse
+0000ed90: 7274 206c 656e 2865 7665 6e74 7329 203d  rt len(events) =
+0000eda0: 3d20 320a 6576 656e 7473 5b30 5d2e 6964  = 2.events[0].id
+0000edb0: 203d 3d20 6576 656e 7436 2e69 640a 6576   == event6.id.ev
+0000edc0: 656e 7473 5b30 5d2e 7374 7265 616d 5f70  ents[0].stream_p
+0000edd0: 6f73 6974 696f 6e20 3d3d 2032 0a65 7665  osition == 2.eve
+0000ede0: 6e74 735b 305d 2e73 7472 6561 6d5f 6e61  nts[0].stream_na
+0000edf0: 6d65 203d 3d20 7374 7265 616d 5f6e 616d  me == stream_nam
+0000ee00: 6532 0a65 7665 6e74 735b 315d 2e69 6420  e2.events[1].id 
+0000ee10: 3d3d 2065 7665 6e74 3131 2e69 640a 6576  == event11.id.ev
+0000ee20: 656e 7473 5b31 5d2e 7374 7265 616d 5f70  ents[1].stream_p
+0000ee30: 6f73 6974 696f 6e20 3d3d 2033 0a65 7665  osition == 3.eve
+0000ee40: 6e74 735b 315d 2e73 7472 6561 6d5f 6e61  nts[1].stream_na
+0000ee50: 6d65 203d 3d20 7374 7265 616d 5f6e 616d  me == stream_nam
+0000ee60: 6532 0a60 6060 0a0a 2323 2050 6572 7369  e2.```..## Persi
+0000ee70: 7374 656e 7420 7375 6273 6372 6970 7469  stent subscripti
+0000ee80: 6f6e 730a 0a23 2323 2043 7265 6174 6520  ons..### Create 
+0000ee90: 7375 6273 6372 6970 7469 6f6e 0a0a 2a72  subscription..*r
+0000eea0: 6571 7569 7265 7320 6c65 6164 6572 2a0a  equires leader*.
+0000eeb0: 0a54 6865 206d 6574 686f 6420 6063 7265  .The method `cre
+0000eec0: 6174 655f 7375 6273 6372 6970 7469 6f6e  ate_subscription
+0000eed0: 2829 6020 6361 6e20 6265 2075 7365 6420  ()` can be used 
+0000eee0: 746f 2063 7265 6174 6520 610a 2270 6572  to create a."per
+0000eef0: 7369 7374 656e 7420 7375 6273 6372 6970  sistent subscrip
+0000ef00: 7469 6f6e 2220 746f 2045 7665 6e74 5374  tion" to EventSt
+0000ef10: 6f72 6544 422e 0a0a 5468 6973 206d 6574  oreDB...This met
+0000ef20: 686f 6420 7461 6b65 7320 6120 7265 7175  hod takes a requ
+0000ef30: 6972 6564 2060 6772 6f75 705f 6e61 6d65  ired `group_name
+0000ef40: 6020 6172 6775 6d65 6e74 2c20 7768 6963  ` argument, whic
+0000ef50: 6820 6973 2074 6865 0a6e 616d 6520 6f66  h is the.name of
+0000ef60: 2061 2022 6772 6f75 7022 206f 6620 636f   a "group" of co
+0000ef70: 6e73 756d 6572 7320 6f66 2074 6865 2073  nsumers of the s
+0000ef80: 7562 7363 7269 7074 696f 6e2e 0a0a 5468  ubscription...Th
+0000ef90: 6973 206d 6574 686f 6420 616c 736f 2074  is method also t
+0000efa0: 616b 6573 2073 6576 656e 206f 7074 696f  akes seven optio
+0000efb0: 6e61 6c20 6172 6775 6d65 6e74 732c 2060  nal arguments, `
+0000efc0: 6672 6f6d 5f65 6e64 602c 2060 636f 6d6d  from_end`, `comm
+0000efd0: 6974 5f70 6f73 6974 696f 6e60 2c0a 6066  it_position`,.`f
+0000efe0: 696c 7465 725f 6578 636c 7564 6560 2c20  ilter_exclude`, 
+0000eff0: 6066 696c 7465 725f 696e 636c 7564 6560  `filter_include`
+0000f000: 2c20 6066 696c 7465 725f 6279 5f73 7472  , `filter_by_str
+0000f010: 6561 6d5f 6e61 6d65 602c 2060 636f 6e73  eam_name`, `cons
+0000f020: 756d 6572 5f73 7472 6174 6567 7960 2c0a  umer_strategy`,.
+0000f030: 616e 6420 6074 696d 656f 7574 602e 0a0a  and `timeout`...
+0000f040: 5468 6520 6f70 7469 6f6e 616c 2060 6672  The optional `fr
+0000f050: 6f6d 5f65 6e64 6020 6172 6775 6d65 6e74  om_end` argument
+0000f060: 2063 616e 2062 6520 7573 6564 2074 6f20   can be used to 
+0000f070: 7370 6563 6966 7920 7468 6174 2074 6865  specify that the
+0000f080: 2067 726f 7570 206f 6620 636f 6e73 756d   group of consum
+0000f090: 6572 730a 6f66 2074 6865 2073 7562 7363  ers.of the subsc
+0000f0a0: 7269 7074 696f 6e20 7368 6f75 6c64 206f  ription should o
+0000f0b0: 6e6c 7920 7265 6365 6976 6520 6576 656e  nly receive even
+0000f0c0: 7473 2074 6861 7420 7765 7265 2072 6563  ts that were rec
+0000f0d0: 6f72 6465 6420 6166 7465 7220 7468 6520  orded after the 
+0000f0e0: 7375 6273 6372 6970 7469 6f6e 0a77 6173  subscription.was
+0000f0f0: 2063 7265 6174 6564 2e0a 0a41 6c74 6572   created...Alter
+0000f100: 6e61 7469 7665 6c79 2c20 7468 6520 6f70  natively, the op
+0000f110: 7469 6f6e 616c 2060 636f 6d6d 6974 5f70  tional `commit_p
+0000f120: 6f73 6974 696f 6e60 2061 7267 756d 656e  osition` argumen
+0000f130: 7420 6361 6e20 6265 2075 7365 6420 746f  t can be used to
+0000f140: 2073 7065 6369 6679 2061 2063 6f6d 6d69   specify a commi
+0000f150: 740a 706f 7369 7469 6f6e 2066 726f 6d20  t.position from 
+0000f160: 7768 6963 6820 636f 6d6d 6974 2070 6f73  which commit pos
+0000f170: 6974 696f 6e20 7468 6520 6772 6f75 7020  ition the group 
+0000f180: 6f66 2063 6f6e 7375 6d65 7273 206f 6620  of consumers of 
+0000f190: 7468 6520 7375 6273 6372 6970 7469 6f6e  the subscription
+0000f1a0: 2073 686f 756c 640a 7265 6365 6976 6520   should.receive 
+0000f1b0: 6576 656e 7473 2e20 506c 6561 7365 206e  events. Please n
+0000f1c0: 6f74 652c 2074 6865 2072 6563 6f72 6465  ote, the recorde
+0000f1d0: 6420 6576 656e 7420 6174 2074 6865 2073  d event at the s
+0000f1e0: 7065 6369 6669 6564 2063 6f6d 6d69 7420  pecified commit 
+0000f1f0: 706f 7369 7469 6f6e 206d 6967 6874 0a62  position might.b
+0000f200: 6520 696e 636c 7564 6564 2069 6e20 7468  e included in th
+0000f210: 6520 7265 636f 7264 6564 2065 7665 6e74  e recorded event
+0000f220: 7320 7265 6365 6976 6564 2062 7920 7468  s received by th
+0000f230: 6520 6772 6f75 7020 6f66 2063 6f6e 7375  e group of consu
+0000f240: 6d65 7273 2e0a 0a49 6620 6e65 6974 6865  mers...If neithe
+0000f250: 7220 6066 726f 6d5f 656e 6460 206f 7220  r `from_end` or 
+0000f260: 6063 6f6d 6d69 745f 706f 7369 7469 6f6e  `commit_position
+0000f270: 6020 6172 6520 7370 6563 6966 6965 642c  ` are specified,
+0000f280: 2074 6865 2067 726f 7570 206f 6620 636f   the group of co
+0000f290: 6e73 756d 6572 730a 6f66 2074 6865 2073  nsumers.of the s
+0000f2a0: 7562 7363 7269 7074 696f 6e20 7769 6c6c  ubscription will
+0000f2b0: 2070 6f74 656e 7469 616c 6c79 2072 6563   potentially rec
+0000f2c0: 6569 7665 2061 6c6c 2072 6563 6f72 6465  eive all recorde
+0000f2d0: 6420 6576 656e 7473 2069 6e20 7468 6520  d events in the 
+0000f2e0: 6461 7461 6261 7365 2e0a 0a54 6865 206f  database...The o
+0000f2f0: 7074 696f 6e61 6c20 6066 696c 7465 725f  ptional `filter_
+0000f300: 6578 636c 7564 6560 2061 7267 756d 656e  exclude` argumen
+0000f310: 7420 6973 2061 2073 6571 7565 6e63 6520  t is a sequence 
+0000f320: 6f66 2072 6567 756c 6172 2065 7870 7265  of regular expre
+0000f330: 7373 696f 6e73 2074 6861 740a 6d61 7463  ssions that.matc
+0000f340: 6820 7265 636f 7264 6564 2065 7665 6e74  h recorded event
+0000f350: 7320 7468 6174 2073 686f 756c 6420 6e6f  s that should no
+0000f360: 7420 6265 2069 6e63 6c75 6465 642e 2054  t be included. T
+0000f370: 6869 7320 6172 6775 6d65 6e74 2069 7320  his argument is 
+0000f380: 6967 6e6f 7265 640a 6966 2060 6669 6c74  ignored.if `filt
+0000f390: 6572 5f69 6e63 6c75 6465 6020 6973 2073  er_include` is s
+0000f3a0: 6574 2074 6f20 6120 6e6f 6e2d 656d 7074  et to a non-empt
+0000f3b0: 7920 7365 7175 656e 6365 2e20 4279 2064  y sequence. By d
+0000f3c0: 6566 6175 6c74 2c20 7468 6973 2061 7267  efault, this arg
+0000f3d0: 756d 656e 7420 6973 2073 6574 0a74 6f20  ument is set.to 
+0000f3e0: 6d61 7463 6820 7468 6520 6576 656e 7420  match the event 
+0000f3f0: 7479 7065 7320 6f66 2022 7379 7374 656d  types of "system
+0000f400: 2065 7665 6e74 7322 2c20 736f 2074 6861   events", so tha
+0000f410: 7420 4576 656e 7453 746f 7265 4442 2073  t EventStoreDB s
+0000f420: 7973 7465 6d20 6576 656e 7473 0a77 696c  ystem events.wil
+0000f430: 6c20 6e6f 7420 6e6f 726d 616c 6c79 2062  l not normally b
+0000f440: 6520 7265 6365 6976 6564 2e20 5365 6520  e received. See 
+0000f450: 7468 6520 4e6f 7465 7320 7365 6374 696f  the Notes sectio
+0000f460: 6e20 6265 6c6f 7720 666f 7220 6d6f 7265  n below for more
+0000f470: 2069 6e66 6f72 6d61 7469 6f6e 0a61 626f   information.abo
+0000f480: 7574 2066 696c 7465 7220 6578 7072 6573  ut filter expres
+0000f490: 7369 6f6e 732e 0a0a 5468 6520 6f70 7469  sions...The opti
+0000f4a0: 6f6e 616c 2060 6669 6c74 6572 5f69 6e63  onal `filter_inc
+0000f4b0: 6c75 6465 6020 6172 6775 6d65 6e74 2069  lude` argument i
+0000f4c0: 7320 6120 7365 7175 656e 6365 206f 6620  s a sequence of 
+0000f4d0: 7265 6775 6c61 7220 6578 7072 6573 7369  regular expressi
+0000f4e0: 6f6e 730a 7468 6174 206d 6174 6368 2072  ons.that match r
+0000f4f0: 6563 6f72 6465 6420 6576 656e 7473 2074  ecorded events t
+0000f500: 6861 7420 7368 6f75 6c64 2062 6520 7265  hat should be re
+0000f510: 6365 6976 6564 2e20 4279 2064 6566 6175  ceived. By defau
+0000f520: 6c74 2c20 7468 6973 2061 7267 756d 656e  lt, this argumen
+0000f530: 740a 6973 2061 6e20 656d 7074 7920 7475  t.is an empty tu
+0000f540: 706c 652e 2049 6620 7468 6973 2061 7267  ple. If this arg
+0000f550: 756d 656e 7420 6973 2073 6574 2074 6f20  ument is set to 
+0000f560: 6120 6e6f 6e2d 656d 7074 7920 7365 7175  a non-empty sequ
+0000f570: 656e 6365 2c20 7468 650a 6066 696c 7465  ence, the.`filte
+0000f580: 725f 6578 636c 7564 6560 2061 7267 756d  r_exclude` argum
+0000f590: 656e 7420 6973 2069 676e 6f72 6564 2e0a  ent is ignored..
+0000f5a0: 0a54 6865 206f 7074 696f 6e61 6c20 6066  .The optional `f
+0000f5b0: 696c 7465 725f 6279 5f73 7472 6561 6d5f  ilter_by_stream_
+0000f5c0: 6e61 6d65 6020 6172 6775 6d65 6e74 2069  name` argument i
+0000f5d0: 7320 6120 5079 7468 6f6e 2060 626f 6f6c  s a Python `bool
+0000f5e0: 6020 7468 6174 2069 6e64 6963 6174 6573  ` that indicates
+0000f5f0: 2077 6865 7468 6572 0a74 6865 2066 696c   whether.the fil
+0000f600: 7465 7220 7769 6c6c 2061 7070 6c79 2074  ter will apply t
+0000f610: 6f20 6576 656e 7420 7479 7065 7320 6f72  o event types or
+0000f620: 2073 7472 6561 6d20 6e61 6d65 732e 2042   stream names. B
+0000f630: 7920 6465 6661 756c 742c 2074 6869 7320  y default, this 
+0000f640: 7661 6c75 6520 6973 2060 4661 6c73 6560  value is `False`
+0000f650: 0a61 6e64 2073 6f20 7468 6520 6669 6c74  .and so the filt
+0000f660: 6572 696e 6720 7769 6c6c 2061 7070 6c79  ering will apply
+0000f670: 2074 6f20 7468 6520 6576 656e 7420 7479   to the event ty
+0000f680: 7065 2073 7472 696e 6773 206f 6620 7265  pe strings of re
+0000f690: 636f 7264 6564 2065 7665 6e74 732e 0a0a  corded events...
+0000f6a0: 5468 6520 6f70 7469 6f6e 616c 2060 636f  The optional `co
+0000f6b0: 6e73 756d 6572 5f73 7472 6174 6567 7960  nsumer_strategy`
+0000f6c0: 2061 7267 756d 656e 7420 6973 2061 2050   argument is a P
+0000f6d0: 7974 686f 6e20 6073 7472 6020 7468 6174  ython `str` that
+0000f6e0: 2064 6566 696e 6573 0a74 6865 2063 6f6e   defines.the con
+0000f6f0: 7375 6d65 7220 7374 7261 7465 6779 2066  sumer strategy f
+0000f700: 6f72 2074 6869 7320 7065 7273 6973 7465  or this persiste
+0000f710: 6e74 2073 7562 7363 7269 7074 696f 6e2e  nt subscription.
+0000f720: 2054 6865 2076 616c 7565 206f 6620 7468   The value of th
+0000f730: 6973 2061 7267 756d 656e 740a 6361 6e20  is argument.can 
+0000f740: 6265 2060 2744 6973 7061 7463 6854 6f53  be `'DispatchToS
+0000f750: 696e 676c 6527 602c 2060 2752 6f75 6e64  ingle'`, `'Round
+0000f760: 526f 6269 6e27 602c 2060 2750 696e 6e65  Robin'`, `'Pinne
+0000f770: 6427 602c 206f 7220 6027 5069 6e6e 6564  d'`, or `'Pinned
+0000f780: 4279 436f 7272 656c 6174 696f 6e27 602e  ByCorrelation'`.
+0000f790: 2054 6865 0a64 6566 6175 6c74 2076 616c   The.default val
+0000f7a0: 7565 2069 7320 6027 4469 7370 6174 6368  ue is `'Dispatch
+0000f7b0: 546f 5369 6e67 6c65 2760 2e0a 0a54 6865  ToSingle'`...The
+0000f7c0: 206f 7074 696f 6e61 6c20 6074 696d 656f   optional `timeo
+0000f7d0: 7574 6020 6172 6775 6d65 6e74 2069 7320  ut` argument is 
+0000f7e0: 6120 5079 7468 6f6e 2060 666c 6f61 7460  a Python `float`
+0000f7f0: 2077 6869 6368 2073 6574 7320 610a 6465   which sets a.de
+0000f800: 6164 6c69 6e65 2066 6f72 2074 6865 2063  adline for the c
+0000f810: 6f6d 706c 6574 696f 6e20 6f66 2074 6865  ompletion of the
+0000f820: 2067 5250 4320 6f70 6572 6174 696f 6e2e   gRPC operation.
+0000f830: 0a0a 5468 6520 6d65 7468 6f64 2060 6372  ..The method `cr
+0000f840: 6561 7465 5f73 7562 7363 7269 7074 696f  eate_subscriptio
+0000f850: 6e28 2960 2064 6f65 7320 6e6f 7420 7265  n()` does not re
+0000f860: 7475 726e 2061 2076 616c 7565 2c20 6265  turn a value, be
+0000f870: 6361 7573 650a 7265 636f 7264 6564 2065  cause.recorded e
+0000f880: 7665 6e74 7320 6172 6520 6f62 7461 696e  vents are obtain
+0000f890: 6564 2062 7920 7468 6520 6772 6f75 7020  ed by the group 
+0000f8a0: 6f66 2063 6f6e 7375 6d65 7273 206f 6620  of consumers of 
+0000f8b0: 7468 6520 7375 6273 6372 6970 7469 6f6e  the subscription
+0000f8c0: 0a75 7369 6e67 2074 6865 2060 7265 6164  .using the `read
+0000f8d0: 5f73 7562 7363 7269 7074 696f 6e28 2960  _subscription()`
+0000f8e0: 206d 6574 686f 642e 0a0a 496e 2074 6865   method...In the
+0000f8f0: 2065 7861 6d70 6c65 2062 656c 6f77 2c20   example below, 
+0000f900: 6120 7065 7273 6973 7465 6e74 2073 7562  a persistent sub
+0000f910: 7363 7269 7074 696f 6e20 6973 2063 7265  scription is cre
+0000f920: 6174 6564 2e0a 0a60 6060 7079 7468 6f6e  ated...```python
+0000f930: 0a23 2043 7265 6174 6520 6120 7065 7273  .# Create a pers
+0000f940: 6973 7465 6e74 2073 7562 7363 7269 7074  istent subscript
+0000f950: 696f 6e2e 0a67 726f 7570 5f6e 616d 6520  ion..group_name 
+0000f960: 3d20 6622 6772 6f75 702d 7b75 7569 6434  = f"group-{uuid4
+0000f970: 2829 7d22 0a63 6c69 656e 742e 6372 6561  ()}".client.crea
+0000f980: 7465 5f73 7562 7363 7269 7074 696f 6e28  te_subscription(
+0000f990: 6772 6f75 705f 6e61 6d65 3d67 726f 7570  group_name=group
+0000f9a0: 5f6e 616d 6529 0a60 6060 0a0a 2323 2320  _name).```..### 
+0000f9b0: 5265 6164 2073 7562 7363 7269 7074 696f  Read subscriptio
+0000f9c0: 6e0a 0a2a 7265 7175 6972 6573 206c 6561  n..*requires lea
+0000f9d0: 6465 722a 0a0a 5468 6520 6d65 7468 6f64  der*..The method
+0000f9e0: 2060 7265 6164 5f73 7562 7363 7269 7074   `read_subscript
+0000f9f0: 696f 6e28 2960 2063 616e 2062 6520 7573  ion()` can be us
+0000fa00: 6564 2062 7920 6120 6772 6f75 7020 6f66  ed by a group of
+0000fa10: 2063 6f6e 7375 6d65 7273 2074 6f20 7265   consumers to re
+0000fa20: 6365 6976 650a 7265 636f 7264 6564 2065  ceive.recorded e
+0000fa30: 7665 6e74 7320 6672 6f6d 2061 2070 6572  vents from a per
+0000fa40: 7369 7374 656e 7420 7375 6273 6372 6970  sistent subscrip
+0000fa50: 7469 6f6e 2063 7265 6174 6564 2075 7369  tion created usi
+0000fa60: 6e67 2060 6372 6561 7465 5f73 7562 7363  ng `create_subsc
+0000fa70: 7269 7074 696f 6e60 2e0a 0a54 6869 7320  ription`...This 
+0000fa80: 6d65 7468 6f64 2074 616b 6573 2061 2072  method takes a r
+0000fa90: 6571 7569 7265 6420 6067 726f 7570 5f6e  equired `group_n
+0000faa0: 616d 6560 2061 7267 756d 656e 742c 2077  ame` argument, w
+0000fab0: 6869 6368 2069 730a 7468 6520 6e61 6d65  hich is.the name
+0000fac0: 206f 6620 6120 2267 726f 7570 2220 6f66   of a "group" of
+0000fad0: 2063 6f6e 7375 6d65 7273 206f 6620 7468   consumers of th
+0000fae0: 6520 7375 6273 6372 6970 7469 6f6e 2073  e subscription s
+0000faf0: 7065 6369 6669 6564 0a77 6865 6e20 6063  pecified.when `c
+0000fb00: 7265 6174 655f 7375 6273 6372 6970 7469  reate_subscripti
+0000fb10: 6f6e 2829 6020 7761 7320 6361 6c6c 6564  on()` was called
+0000fb20: 2e0a 0a54 6869 7320 6d65 7468 6f64 2061  ...This method a
+0000fb30: 6c73 6f20 7461 6b65 7320 616e 206f 7074  lso takes an opt
+0000fb40: 696f 6e61 6c20 6074 696d 656f 7574 6020  ional `timeout` 
+0000fb50: 6172 6775 6d65 6e74 2c20 7468 6174 0a69  argument, that.i
+0000fb60: 7320 6578 7065 6374 6564 2074 6f20 6265  s expected to be
+0000fb70: 2061 2050 7974 686f 6e20 6066 6c6f 6174   a Python `float
+0000fb80: 602c 2077 6869 6368 2073 6574 7320 6120  `, which sets a 
+0000fb90: 6465 6164 6c69 6e65 0a66 6f72 2074 6865  deadline.for the
+0000fba0: 2063 6f6d 706c 6574 696f 6e20 6f66 2074   completion of t
+0000fbb0: 6865 2067 5250 4320 6f70 6572 6174 696f  he gRPC operatio
+0000fbc0: 6e2e 0a0a 5468 6973 206d 6574 686f 6420  n...This method 
+0000fbd0: 7265 7475 726e 7320 6120 6050 6572 7369  returns a `Persi
+0000fbe0: 7374 656e 7453 7562 7363 7269 7074 696f  stentSubscriptio
+0000fbf0: 6e60 206f 626a 6563 742c 2077 6869 6368  n` object, which
+0000fc00: 2069 7320 616e 2069 7465 7261 746f 720a   is an iterator.
+0000fc10: 6769 7669 6e67 2060 5265 636f 7264 6564  giving `Recorded
+0000fc20: 4576 656e 7460 206f 626a 6563 7473 2c20  Event` objects, 
+0000fc30: 7468 6174 2061 6c73 6f20 6861 7320 6061  that also has `a
+0000fc40: 636b 2829 602c 2060 6e61 636b 2829 6020  ck()`, `nack()` 
+0000fc50: 616e 6420 6073 746f 7028 2960 0a6d 6574  and `stop()`.met
+0000fc60: 686f 6473 2e0a 0a60 6060 7079 7468 6f6e  hods...```python
+0000fc70: 0a73 7562 7363 7269 7074 696f 6e20 3d20  .subscription = 
+0000fc80: 636c 6965 6e74 2e72 6561 645f 7375 6273  client.read_subs
+0000fc90: 6372 6970 7469 6f6e 2867 726f 7570 5f6e  cription(group_n
+0000fca0: 616d 653d 6772 6f75 705f 6e61 6d65 290a  ame=group_name).
+0000fcb0: 6060 600a 0a54 6865 2060 6163 6b28 2960  ```..The `ack()`
+0000fcc0: 206d 6574 686f 6420 7368 6f75 6c64 2062   method should b
+0000fcd0: 6520 7573 6564 2062 7920 6120 636f 6e73  e used by a cons
+0000fce0: 756d 6572 2074 6f20 696e 6469 6361 7465  umer to indicate
+0000fcf0: 2074 6f20 7468 6520 7365 7276 6572 2074   to the server t
+0000fd00: 6861 7420 6974 0a68 6173 2072 6563 6569  hat it.has recei
+0000fd10: 7665 6420 616e 6420 7375 6363 6573 7366  ved and successf
+0000fd20: 756c 6c79 2070 726f 6365 7373 6564 2061  ully processed a
+0000fd30: 2072 6563 6f72 6465 6420 6576 656e 742e   recorded event.
+0000fd40: 2054 6869 7320 7769 6c6c 2070 7265 7665   This will preve
+0000fd50: 6e74 2074 6861 740a 7265 636f 7264 6564  nt that.recorded
+0000fd60: 2065 7665 6e74 2062 6569 6e67 2072 6563   event being rec
+0000fd70: 6569 7665 6420 6279 2061 6e6f 7468 6572  eived by another
+0000fd80: 2063 6f6e 7375 6d65 7220 696e 2074 6865   consumer in the
+0000fd90: 2073 616d 6520 6772 6f75 702e 2054 6865   same group. The
+0000fda0: 2060 6163 6b28 2960 0a6d 6574 686f 6420   `ack()`.method 
+0000fdb0: 7461 6b65 7320 616e 2060 6576 656e 745f  takes an `event_
+0000fdc0: 6964 6020 6172 6775 6d65 6e74 2c20 7768  id` argument, wh
+0000fdd0: 6963 6820 6973 2074 6865 2049 4420 6f66  ich is the ID of
+0000fde0: 2074 6865 2072 6563 6f72 6465 6420 6576   the recorded ev
+0000fdf0: 656e 7420 7468 6174 0a68 6173 2062 6565  ent that.has bee
+0000fe00: 6e20 7265 6365 6976 6564 2e0a 0a54 6865  n received...The
+0000fe10: 2065 7861 6d70 6c65 2062 656c 6f77 2069   example below i
+0000fe20: 7465 7261 7465 7320 6f76 6572 2074 6865  terates over the
+0000fe30: 2073 7562 7363 7269 7074 696f 6e20 6f62   subscription ob
+0000fe40: 6a65 6374 2c20 616e 6420 6361 6c6c 7320  ject, and calls 
+0000fe50: 6061 636b 2829 602e 2054 6865 0a60 7374  `ack()`. The.`st
+0000fe60: 6f70 2829 6020 6d65 7468 6f64 2069 7320  op()` method is 
+0000fe70: 6361 6c6c 6564 2077 6865 6e20 7765 2068  called when we h
+0000fe80: 6176 6520 7265 6365 6976 6564 2074 6865  ave received the
+0000fe90: 206c 6173 7420 6576 656e 742c 2073 6f20   last event, so 
+0000fea0: 7468 6174 2077 6520 6361 6e0a 636f 6e74  that we can.cont
+0000feb0: 696e 7565 2077 6974 6820 7468 6520 6578  inue with the ex
+0000fec0: 616d 706c 6573 2062 656c 6f77 2e0a 0a60  amples below...`
+0000fed0: 6060 7079 7468 6f6e 0a65 7665 6e74 7320  ``python.events 
+0000fee0: 3d20 5b5d 0a66 6f72 2065 7665 6e74 2069  = [].for event i
+0000fef0: 6e20 7375 6273 6372 6970 7469 6f6e 3a0a  n subscription:.
+0000ff00: 2020 2020 6576 656e 7473 2e61 7070 656e      events.appen
+0000ff10: 6428 6576 656e 7429 0a0a 2020 2020 2320  d(event)..    # 
+0000ff20: 4163 6b6e 6f77 6c65 6467 6520 7468 6520  Acknowledge the 
+0000ff30: 7265 6365 6976 6564 2065 7665 6e74 2e0a  received event..
+0000ff40: 2020 2020 7375 6273 6372 6970 7469 6f6e      subscription
+0000ff50: 2e61 636b 2865 7665 6e74 5f69 643d 6576  .ack(event_id=ev
+0000ff60: 656e 742e 6964 290a 0a20 2020 2023 2042  ent.id)..    # B
+0000ff70: 7265 616b 2077 6865 6e20 7468 6520 6c61  reak when the la
+0000ff80: 7374 2065 7665 6e74 2068 6173 2062 6565  st event has bee
+0000ff90: 6e20 7265 6365 6976 6564 2e0a 2020 2020  n received..    
+0000ffa0: 6966 2065 7665 6e74 2e69 6420 3d3d 2065  if event.id == e
+0000ffb0: 7665 6e74 3131 2e69 643a 0a20 2020 2020  vent11.id:.     
+0000ffc0: 2020 2073 7562 7363 7269 7074 696f 6e2e     subscription.
+0000ffd0: 7374 6f70 2829 0a60 6060 0a0a 5468 6520  stop().```..The 
+0000ffe0: 7265 6365 6976 6564 2065 7665 6e74 7320  received events 
+0000fff0: 6172 6520 7468 6520 6576 656e 7473 2077  are the events w
+00010000: 6520 6170 7065 6e64 6564 2061 626f 7665  e appended above
+00010010: 2e0a 0a60 6060 7079 7468 6f6e 0a61 7373  ...```python.ass
+00010020: 6572 7420 6576 656e 7473 5b2d 3135 5d2e  ert events[-15].
+00010030: 6964 203d 3d20 6576 656e 7431 2e69 640a  id == event1.id.
+00010040: 6173 7365 7274 2065 7665 6e74 735b 2d31  assert events[-1
+00010050: 345d 2e69 6420 3d3d 2065 7665 6e74 322e  4].id == event2.
+00010060: 6964 0a61 7373 6572 7420 6576 656e 7473  id.assert events
+00010070: 5b2d 3133 5d2e 6964 203d 3d20 6576 656e  [-13].id == even
+00010080: 7433 2e69 640a 6173 7365 7274 2065 7665  t3.id.assert eve
+00010090: 6e74 735b 2d31 325d 2e74 7970 6520 3d3d  nts[-12].type ==
+000100a0: 2022 446f 6752 6567 6973 7465 7265 6422   "DogRegistered"
+000100b0: 0a61 7373 6572 7420 6576 656e 7473 5b2d  .assert events[-
+000100c0: 3131 5d2e 7479 7065 203d 3d20 2244 6f67  11].type == "Dog
+000100d0: 4c65 6172 6e65 6454 7269 636b 220a 6173  LearnedTrick".as
+000100e0: 7365 7274 2065 7665 6e74 735b 2d31 305d  sert events[-10]
+000100f0: 2e74 7970 6520 3d3d 2022 446f 674c 6561  .type == "DogLea
+00010100: 726e 6564 5472 6963 6b22 0a61 7373 6572  rnedTrick".asser
+00010110: 7420 6576 656e 7473 5b2d 395d 2e74 7970  t events[-9].typ
+00010120: 6520 3d3d 2022 446f 674c 6561 726e 6564  e == "DogLearned
+00010130: 5472 6963 6b22 0a61 7373 6572 7420 6576  Trick".assert ev
+00010140: 656e 7473 5b2d 385d 2e69 6420 3d3d 2065  ents[-8].id == e
+00010150: 7665 6e74 342e 6964 0a61 7373 6572 7420  vent4.id.assert 
+00010160: 6576 656e 7473 5b2d 375d 2e69 6420 3d3d  events[-7].id ==
+00010170: 2065 7665 6e74 352e 6964 0a61 7373 6572   event5.id.asser
+00010180: 7420 6576 656e 7473 5b2d 365d 2e69 6420  t events[-6].id 
+00010190: 3d3d 2065 7665 6e74 362e 6964 0a61 7373  == event6.id.ass
+000101a0: 6572 7420 6576 656e 7473 5b2d 355d 2e69  ert events[-5].i
+000101b0: 6420 3d3d 2065 7665 6e74 372e 6964 0a61  d == event7.id.a
+000101c0: 7373 6572 7420 6576 656e 7473 5b2d 345d  ssert events[-4]
+000101d0: 2e69 6420 3d3d 2065 7665 6e74 382e 6964  .id == event8.id
+000101e0: 0a61 7373 6572 7420 6576 656e 7473 5b2d  .assert events[-
+000101f0: 335d 2e69 6420 3d3d 2065 7665 6e74 392e  3].id == event9.
+00010200: 6964 0a61 7373 6572 7420 6576 656e 7473  id.assert events
+00010210: 5b2d 325d 2e69 6420 3d3d 2065 7665 6e74  [-2].id == event
+00010220: 3130 2e69 640a 6173 7365 7274 2065 7665  10.id.assert eve
+00010230: 6e74 735b 2d31 5d2e 6964 203d 3d20 6576  nts[-1].id == ev
+00010240: 656e 7431 312e 6964 0a60 6060 0a0a 5468  ent11.id.```..Th
+00010250: 6520 2273 7562 7363 7269 7074 696f 6e22  e "subscription"
+00010260: 206f 626a 6563 7420 616c 736f 2068 6173   object also has
+00010270: 2061 6e20 606e 6163 6b28 2960 206d 6574   an `nack()` met
+00010280: 686f 6420 7468 6174 2073 686f 756c 6420  hod that should 
+00010290: 6265 2075 7365 6420 6279 2061 2063 6f6e  be used by a con
+000102a0: 7375 6d65 720a 746f 206e 6567 6174 6976  sumer.to negativ
+000102b0: 656c 7920 6163 6b6e 6f77 6c65 6467 6520  ely acknowledge 
+000102c0: 746f 2074 6865 2073 6572 7665 7220 7468  to the server th
+000102d0: 6174 2069 7420 6861 7320 7265 6365 6976  at it has receiv
+000102e0: 6564 2062 7574 206e 6f74 2073 7563 6365  ed but not succe
+000102f0: 7373 6675 6c6c 790a 7072 6f63 6573 7365  ssfully.processe
+00010300: 6420 6120 7265 636f 7264 6564 2065 7665  d a recorded eve
+00010310: 6e74 2e20 5468 6520 606e 6163 6b28 2960  nt. The `nack()`
+00010320: 206d 6574 686f 6420 7461 6b65 7320 616e   method takes an
+00010330: 2060 6576 656e 745f 6964 6020 6172 6775   `event_id` argu
+00010340: 6d65 6e74 2c20 7768 6963 6820 6973 0a74  ment, which is.t
+00010350: 6865 2049 4420 6f66 2074 6865 2072 6563  he ID of the rec
+00010360: 6f72 6465 6420 6576 656e 7420 7468 6174  orded event that
+00010370: 2068 6173 2062 6565 6e20 7265 6365 6976   has been receiv
+00010380: 6564 2c20 616e 6420 616e 2060 6163 7469  ed, and an `acti
+00010390: 6f6e 6020 6172 6775 6d65 6e74 2c20 7768  on` argument, wh
+000103a0: 6963 680a 7368 6f75 6c64 2062 6520 6120  ich.should be a 
+000103b0: 5079 7468 6f6e 2060 7374 7260 2c20 6569  Python `str`, ei
+000103c0: 7468 6572 2060 2775 6e6b 6e6f 776e 2760  ther `'unknown'`
+000103d0: 2c20 6027 7061 726b 2760 2c20 6027 7265  , `'park'`, `'re
+000103e0: 7472 7927 602c 2060 2773 6b69 7027 602c  try'`, `'skip'`,
+000103f0: 206f 7220 6027 7374 6f70 2760 2e0a 0a57   or `'stop'`...W
+00010400: 6869 6c73 7420 7468 6572 6520 6172 6520  hilst there are 
+00010410: 736f 6d65 2061 6476 616e 7461 6765 7320  some advantages 
+00010420: 6f66 2070 6572 7369 7374 656e 7420 7375  of persistent su
+00010430: 6273 6372 6970 7469 6f6e 732c 2069 6e20  bscriptions, in 
+00010440: 7061 7274 6963 756c 6172 2074 6865 0a70  particular the.p
+00010450: 726f 6365 7373 696e 6720 6f66 2072 6563  rocessing of rec
+00010460: 6f72 6465 6420 6576 656e 7473 2062 7920  orded events by 
+00010470: 6120 6772 6f75 7020 6f66 2063 6f6e 7375  a group of consu
+00010480: 6d65 7273 2c20 6279 2074 7261 636b 696e  mers, by trackin
+00010490: 6720 696e 2074 6865 2073 6572 7665 720a  g in the server.
+000104a0: 7468 6520 706f 7369 7469 6f6e 2069 6e20  the position in 
+000104b0: 7468 6520 636f 6d6d 6974 2073 6571 7565  the commit seque
+000104c0: 6e63 6520 6f66 2065 7665 6e74 7320 7468  nce of events th
+000104d0: 6174 2068 6176 6520 6265 656e 2070 726f  at have been pro
+000104e0: 6365 7373 6564 2c20 7468 6572 6520 6973  cessed, there is
+000104f0: 0a74 6865 2064 616e 6765 7220 6f66 2022  .the danger of "
+00010500: 6475 616c 2077 7269 7469 6e67 2220 696e  dual writing" in
+00010510: 2074 6865 2063 6f6e 7375 6d70 7469 6f6e   the consumption
+00010520: 206f 6620 6576 656e 7473 2e20 5265 6c69   of events. Reli
+00010530: 6162 696c 6974 7920 696e 2070 726f 6365  ability in proce
+00010540: 7373 696e 670a 6f66 2072 6563 6f72 6465  ssing.of recorde
+00010550: 6420 6576 656e 7473 2062 7920 6120 6772  d events by a gr
+00010560: 6f75 7020 6f66 2063 6f6e 7375 6d65 7273  oup of consumers
+00010570: 2077 696c 6c20 7265 6c79 2069 6e73 7465   will rely inste
+00010580: 6164 206f 6e20 6964 656d 706f 7465 6e74  ad on idempotent
+00010590: 2068 616e 646c 696e 670a 6f66 2064 7570   handling.of dup
+000105a0: 6c69 6361 7465 206d 6573 7361 6765 732c  licate messages,
+000105b0: 2061 6e64 2072 6573 696c 6965 6e63 6520   and resilience 
+000105c0: 746f 206f 7574 2d6f 662d 6f72 6465 7220  to out-of-order 
+000105d0: 6465 6c69 7665 7279 2e0a 0a23 2323 2047  delivery...### G
+000105e0: 6574 2073 7562 7363 7269 7074 696f 6e20  et subscription 
+000105f0: 696e 666f 0a0a 2a72 6571 7569 7265 7320  info..*requires 
+00010600: 6c65 6164 6572 2a0a 0a54 6865 2060 6765  leader*..The `ge
+00010610: 745f 7375 6273 6372 6970 7469 6f6e 5f69  t_subscription_i
+00010620: 6e66 6f28 2960 206d 6574 686f 6420 6361  nfo()` method ca
+00010630: 6e20 6265 2075 7365 6420 746f 2067 6574  n be used to get
+00010640: 2069 6e66 6f72 6d61 7469 6f6e 2066 6f72   information for
+00010650: 2061 0a70 6572 7369 7374 656e 7420 7375   a.persistent su
+00010660: 6273 6372 6970 7469 6f6e 2e0a 0a54 6869  bscription...Thi
+00010670: 7320 6d65 7468 6f64 2068 6173 206f 6e65  s method has one
+00010680: 2072 6571 7569 7265 6420 6172 6775 6d65   required argume
+00010690: 6e74 2c20 6067 726f 7570 5f6e 616d 6560  nt, `group_name`
+000106a0: 2c20 7768 6963 680a 7368 6f75 6c64 206d  , which.should m
+000106b0: 6174 6368 2074 6865 2076 616c 7565 206f  atch the value o
+000106c0: 6620 7468 6520 6172 6775 6d65 6e74 2075  f the argument u
+000106d0: 7365 6420 7768 656e 2063 616c 6c69 6e67  sed when calling
+000106e0: 2060 6372 6561 7465 5f73 7562 7363 7269   `create_subscri
+000106f0: 7074 696f 6e28 2960 2e0a 0a54 6869 7320  ption()`...This 
+00010700: 6d65 7468 6f64 2061 6c73 6f20 7461 6b65  method also take
+00010710: 7320 616e 206f 7074 696f 6e61 6c20 6074  s an optional `t
+00010720: 696d 656f 7574 6020 6172 6775 6d65 6e74  imeout` argument
+00010730: 2c20 7468 6174 0a69 7320 6578 7065 6374  , that.is expect
+00010740: 6564 2074 6f20 6265 2061 2050 7974 686f  ed to be a Pytho
+00010750: 6e20 6066 6c6f 6174 602c 2077 6869 6368  n `float`, which
+00010760: 2073 6574 7320 6120 6465 6164 6c69 6e65   sets a deadline
+00010770: 0a66 6f72 2074 6865 2063 6f6d 706c 6574  .for the complet
+00010780: 696f 6e20 6f66 2074 6865 2067 5250 4320  ion of the gRPC 
+00010790: 6f70 6572 6174 696f 6e2e 0a0a 6060 6070  operation...```p
+000107a0: 7974 686f 6e0a 7375 6273 6372 6970 7469  ython.subscripti
+000107b0: 6f6e 5f69 6e66 6f20 3d20 636c 6965 6e74  on_info = client
+000107c0: 2e67 6574 5f73 7562 7363 7269 7074 696f  .get_subscriptio
+000107d0: 6e5f 696e 666f 280a 2020 2020 6772 6f75  n_info(.    grou
+000107e0: 705f 6e61 6d65 3d67 726f 7570 5f6e 616d  p_name=group_nam
+000107f0: 652c 0a29 0a60 6060 0a0a 5468 6520 7265  e,.).```..The re
+00010800: 7475 726e 6564 2076 616c 7565 2069 7320  turned value is 
+00010810: 6120 6053 7562 7363 7269 7074 696f 6e49  a `SubscriptionI
+00010820: 6e66 6f60 206f 626a 6563 742e 0a0a 2323  nfo` object...##
+00010830: 2320 4c69 7374 2073 7562 7363 7269 7074  # List subscript
+00010840: 696f 6e73 0a0a 2a72 6571 7569 7265 7320  ions..*requires 
+00010850: 6c65 6164 6572 2a0a 0a54 6865 2060 6c69  leader*..The `li
+00010860: 7374 5f73 7562 7363 7269 7074 696f 6e73  st_subscriptions
+00010870: 2829 6020 6d65 7468 6f64 2063 616e 2062  ()` method can b
+00010880: 6520 7573 6564 2074 6f20 6765 7420 696e  e used to get in
+00010890: 666f 726d 6174 696f 6e20 666f 7220 616c  formation for al
+000108a0: 6c0a 6578 6973 7469 6e67 2070 6572 7369  l.existing persi
+000108b0: 7374 656e 7420 7375 6273 6372 6970 7469  stent subscripti
+000108c0: 6f6e 732e 0a0a 5468 6973 206d 6574 686f  ons...This metho
+000108d0: 6420 7461 6b65 7320 616e 206f 7074 696f  d takes an optio
+000108e0: 6e61 6c20 6074 696d 656f 7574 6020 6172  nal `timeout` ar
+000108f0: 6775 6d65 6e74 2c20 7468 6174 0a69 7320  gument, that.is 
+00010900: 6578 7065 6374 6564 2074 6f20 6265 2061  expected to be a
+00010910: 2050 7974 686f 6e20 6066 6c6f 6174 602c   Python `float`,
+00010920: 2077 6869 6368 2073 6574 7320 6120 6465   which sets a de
+00010930: 6164 6c69 6e65 0a66 6f72 2074 6865 2063  adline.for the c
+00010940: 6f6d 706c 6574 696f 6e20 6f66 2074 6865  ompletion of the
+00010950: 2067 5250 4320 6f70 6572 6174 696f 6e2e   gRPC operation.
+00010960: 0a0a 6060 6070 7974 686f 6e0a 7375 6273  ..```python.subs
+00010970: 6372 6970 7469 6f6e 7320 3d20 636c 6965  criptions = clie
+00010980: 6e74 2e6c 6973 745f 7375 6273 6372 6970  nt.list_subscrip
+00010990: 7469 6f6e 7328 290a 6060 600a 0a54 6865  tions().```..The
+000109a0: 2072 6574 7572 6e65 6420 7661 6c75 6520   returned value 
+000109b0: 6973 2061 206c 6973 7420 6f66 2060 5375  is a list of `Su
+000109c0: 6273 6372 6970 7469 6f6e 496e 666f 6020  bscriptionInfo` 
+000109d0: 6f62 6a65 6374 732e 0a0a 2323 2320 5570  objects...### Up
+000109e0: 6461 7465 2073 7562 7363 7269 7074 696f  date subscriptio
+000109f0: 6e0a 0a2a 7265 7175 6972 6573 206c 6561  n..*requires lea
+00010a00: 6465 722a 0a0a 5468 6520 6d65 7468 6f64  der*..The method
+00010a10: 2060 7570 6461 7465 5f73 7562 7363 7269   `update_subscri
+00010a20: 7074 696f 6e28 2960 2063 616e 2062 6520  ption()` can be 
+00010a30: 7573 6564 2074 6f20 7570 6461 7465 2061  used to update a
+00010a40: 0a22 7065 7273 6973 7465 6e74 2073 7562  ."persistent sub
+00010a50: 7363 7269 7074 696f 6e22 2e0a 0a54 6869  scription"...Thi
+00010a60: 7320 6d65 7468 6f64 2074 616b 6573 2061  s method takes a
+00010a70: 2072 6571 7569 7265 6420 6067 726f 7570   required `group
+00010a80: 5f6e 616d 6560 2061 7267 756d 656e 742c  _name` argument,
+00010a90: 2077 6869 6368 2069 7320 7468 650a 6e61   which is the.na
+00010aa0: 6d65 206f 6620 6120 2267 726f 7570 2220  me of a "group" 
+00010ab0: 6f66 2063 6f6e 7375 6d65 7273 206f 6620  of consumers of 
+00010ac0: 7468 6520 7375 6273 6372 6970 7469 6f6e  the subscription
+00010ad0: 2e0a 0a54 6869 7320 6d65 7468 6f64 2061  ...This method a
+00010ae0: 6c73 6f20 7461 6b65 7320 7468 7265 6520  lso takes three 
+00010af0: 6f70 7469 6f6e 616c 2061 7267 756d 656e  optional argumen
+00010b00: 7473 2c20 6066 726f 6d5f 656e 6460 2c20  ts, `from_end`, 
+00010b10: 6063 6f6d 6d69 745f 706f 7369 7469 6f6e  `commit_position
+00010b20: 602c 0a61 6e64 2060 7469 6d65 6f75 7460  `,.and `timeout`
+00010b30: 2e0a 0a54 6865 206f 7074 696f 6e61 6c20  ...The optional 
+00010b40: 6066 726f 6d5f 656e 6460 2061 7267 756d  `from_end` argum
+00010b50: 656e 7420 6361 6e20 6265 2075 7365 6420  ent can be used 
+00010b60: 746f 2073 7065 6369 6679 2074 6861 7420  to specify that 
+00010b70: 7468 6520 6772 6f75 7020 6f66 2063 6f6e  the group of con
+00010b80: 7375 6d65 7273 0a6f 6620 7468 6520 7375  sumers.of the su
+00010b90: 6273 6372 6970 7469 6f6e 2073 686f 756c  bscription shoul
+00010ba0: 6420 6f6e 6c79 2072 6563 6569 7665 2065  d only receive e
+00010bb0: 7665 6e74 7320 7468 6174 2077 6572 6520  vents that were 
+00010bc0: 7265 636f 7264 6564 2061 6674 6572 2074  recorded after t
+00010bd0: 6865 2073 7562 7363 7269 7074 696f 6e0a  he subscription.
+00010be0: 7761 7320 7570 6461 7465 642e 0a0a 416c  was updated...Al
+00010bf0: 7465 726e 6174 6976 656c 792c 2074 6865  ternatively, the
+00010c00: 206f 7074 696f 6e61 6c20 6063 6f6d 6d69   optional `commi
+00010c10: 745f 706f 7369 7469 6f6e 6020 6172 6775  t_position` argu
+00010c20: 6d65 6e74 2063 616e 2062 6520 7573 6564  ment can be used
+00010c30: 2074 6f20 7370 6563 6966 7920 6120 636f   to specify a co
+00010c40: 6d6d 6974 0a70 6f73 6974 696f 6e20 6672  mmit.position fr
+00010c50: 6f6d 2077 6869 6368 2063 6f6d 6d69 7420  om which commit 
+00010c60: 706f 7369 7469 6f6e 2074 6865 2067 726f  position the gro
+00010c70: 7570 206f 6620 636f 6e73 756d 6572 7320  up of consumers 
+00010c80: 6f66 2074 6865 2073 7562 7363 7269 7074  of the subscript
+00010c90: 696f 6e20 7368 6f75 6c64 0a72 6563 6569  ion should.recei
+00010ca0: 7665 2065 7665 6e74 732e 2050 6c65 6173  ve events. Pleas
+00010cb0: 6520 6e6f 7465 2c20 7468 6520 7265 636f  e note, the reco
+00010cc0: 7264 6564 2065 7665 6e74 2061 7420 7468  rded event at th
+00010cd0: 6520 7370 6563 6966 6965 6420 636f 6d6d  e specified comm
+00010ce0: 6974 2070 6f73 6974 696f 6e20 6d69 6768  it position migh
+00010cf0: 740a 6265 2069 6e63 6c75 6465 6420 696e  t.be included in
+00010d00: 2074 6865 2072 6563 6f72 6465 6420 6576   the recorded ev
+00010d10: 656e 7473 2072 6563 6569 7665 6420 6279  ents received by
+00010d20: 2074 6865 2067 726f 7570 206f 6620 636f   the group of co
+00010d30: 6e73 756d 6572 732e 0a0a 4966 206e 6569  nsumers...If nei
+00010d40: 7468 6572 2060 6672 6f6d 5f65 6e64 6020  ther `from_end` 
+00010d50: 6f72 2060 636f 6d6d 6974 5f70 6f73 6974  or `commit_posit
+00010d60: 696f 6e60 2061 7265 2073 7065 6369 6669  ion` are specifi
+00010d70: 6564 2c20 7468 6520 6772 6f75 7020 6f66  ed, the group of
+00010d80: 2063 6f6e 7375 6d65 7273 0a6f 6620 7468   consumers.of th
+00010d90: 6520 7375 6273 6372 6970 7469 6f6e 2077  e subscription w
+00010da0: 696c 6c20 706f 7465 6e74 6961 6c6c 7920  ill potentially 
+00010db0: 7265 6365 6976 6520 616c 6c20 7265 636f  receive all reco
+00010dc0: 7264 6564 2065 7665 6e74 7320 696e 2074  rded events in t
+00010dd0: 6865 2064 6174 6162 6173 652e 0a0a 506c  he database...Pl
+00010de0: 6561 7365 206e 6f74 652c 2074 6865 2066  ease note, the f
+00010df0: 696c 7465 7220 6f70 7469 6f6e 7320 616e  ilter options an
+00010e00: 6420 636f 6e73 756d 6572 2073 7472 6174  d consumer strat
+00010e10: 6567 7920 6361 6e6e 6f74 2062 6520 6164  egy cannot be ad
+00010e20: 6a75 7374 6564 2e0a 0a54 6865 206f 7074  justed...The opt
+00010e30: 696f 6e61 6c20 6074 696d 656f 7574 6020  ional `timeout` 
+00010e40: 6172 6775 6d65 6e74 2069 7320 6120 5079  argument is a Py
+00010e50: 7468 6f6e 2060 666c 6f61 7460 2077 6869  thon `float` whi
+00010e60: 6368 2073 6574 7320 610a 6465 6164 6c69  ch sets a.deadli
+00010e70: 6e65 2066 6f72 2074 6865 2063 6f6d 706c  ne for the compl
+00010e80: 6574 696f 6e20 6f66 2074 6865 2067 5250  etion of the gRP
+00010e90: 4320 6f70 6572 6174 696f 6e2e 0a0a 5468  C operation...Th
+00010ea0: 6520 6d65 7468 6f64 2060 7570 6461 7465  e method `update
+00010eb0: 5f73 7562 7363 7269 7074 696f 6e28 2960  _subscription()`
+00010ec0: 2064 6f65 7320 6e6f 7420 7265 7475 726e   does not return
+00010ed0: 2061 2076 616c 7565 2e0a 0a49 6e20 7468   a value...In th
+00010ee0: 6520 6578 616d 706c 6520 6265 6c6f 772c  e example below,
+00010ef0: 2061 2070 6572 7369 7374 656e 7420 7375   a persistent su
+00010f00: 6273 6372 6970 7469 6f6e 2069 7320 7570  bscription is up
+00010f10: 6461 7465 6420 746f 2072 756e 2066 726f  dated to run fro
+00010f20: 6d20 7468 6520 656e 6420 6f66 2074 6865  m the end of the
+00010f30: 0a64 6174 6162 6173 652e 0a0a 6060 6070  .database...```p
+00010f40: 7974 686f 6e0a 2320 4372 6561 7465 2061  ython.# Create a
+00010f50: 2070 6572 7369 7374 656e 7420 7375 6273   persistent subs
+00010f60: 6372 6970 7469 6f6e 2e0a 636c 6965 6e74  cription..client
+00010f70: 2e75 7064 6174 655f 7375 6273 6372 6970  .update_subscrip
+00010f80: 7469 6f6e 2867 726f 7570 5f6e 616d 653d  tion(group_name=
+00010f90: 6772 6f75 705f 6e61 6d65 2c20 6672 6f6d  group_name, from
+00010fa0: 5f65 6e64 3d54 7275 6529 0a60 6060 0a0a  _end=True).```..
+00010fb0: 2323 2320 4465 6c65 7465 2073 7562 7363  ### Delete subsc
+00010fc0: 7269 7074 696f 6e0a 0a2a 7265 7175 6972  ription..*requir
+00010fd0: 6573 206c 6561 6465 722a 0a0a 5468 6520  es leader*..The 
+00010fe0: 6064 656c 6574 655f 7375 6273 6372 6970  `delete_subscrip
+00010ff0: 7469 6f6e 2829 6020 6d65 7468 6f64 2063  tion()` method c
+00011000: 616e 2062 6520 7573 6564 2074 6f20 6465  an be used to de
+00011010: 6c65 7465 2061 2070 6572 7369 7374 656e  lete a persisten
+00011020: 740a 7375 6273 6372 6970 7469 6f6e 2e0a  t.subscription..
+00011030: 0a54 6869 7320 6d65 7468 6f64 2068 6173  .This method has
+00011040: 206f 6e65 2072 6571 7569 7265 6420 6172   one required ar
+00011050: 6775 6d65 6e74 2c20 6067 726f 7570 5f6e  gument, `group_n
+00011060: 616d 6560 2c20 7768 6963 680a 7368 6f75  ame`, which.shou
+00011070: 6c64 206d 6174 6368 2074 6865 2076 616c  ld match the val
+00011080: 7565 206f 6620 6172 6775 6d65 6e74 2075  ue of argument u
+00011090: 7365 6420 7768 656e 2063 616c 6c69 6e67  sed when calling
+000110a0: 2060 6372 6561 7465 5f73 7562 7363 7269   `create_subscri
+000110b0: 7074 696f 6e28 2960 2e0a 0a54 6869 7320  ption()`...This 
+000110c0: 6d65 7468 6f64 2061 6c73 6f20 7461 6b65  method also take
+000110d0: 7320 616e 206f 7074 696f 6e61 6c20 6074  s an optional `t
+000110e0: 696d 656f 7574 6020 6172 6775 6d65 6e74  imeout` argument
+000110f0: 2c20 7468 6174 0a69 7320 6578 7065 6374  , that.is expect
+00011100: 6564 2074 6f20 6265 2061 2050 7974 686f  ed to be a Pytho
+00011110: 6e20 6066 6c6f 6174 602c 2077 6869 6368  n `float`, which
+00011120: 2073 6574 7320 6120 6465 6164 6c69 6e65   sets a deadline
+00011130: 0a66 6f72 2074 6865 2063 6f6d 706c 6574  .for the complet
+00011140: 696f 6e20 6f66 2074 6865 2067 5250 4320  ion of the gRPC 
+00011150: 6f70 6572 6174 696f 6e2e 0a0a 6060 6070  operation...```p
+00011160: 7974 686f 6e0a 636c 6965 6e74 2e64 656c  ython.client.del
+00011170: 6574 655f 7375 6273 6372 6970 7469 6f6e  ete_subscription
+00011180: 280a 2020 2020 6772 6f75 705f 6e61 6d65  (.    group_name
+00011190: 3d67 726f 7570 5f6e 616d 652c 0a29 0a60  =group_name,.).`
+000111a0: 6060 0a0a 2323 2320 4372 6561 7465 2073  ``..### Create s
+000111b0: 7472 6561 6d20 7375 6273 6372 6970 7469  tream subscripti
+000111c0: 6f6e 0a0a 2a72 6571 7569 7265 7320 6c65  on..*requires le
+000111d0: 6164 6572 2a0a 0a54 6865 2060 6372 6561  ader*..The `crea
+000111e0: 7465 5f73 7472 6561 6d5f 7375 6273 6372  te_stream_subscr
+000111f0: 6970 7469 6f6e 2829 6020 6d65 7468 6f64  iption()` method
+00011200: 2063 616e 2062 6520 7573 6564 2074 6f20   can be used to 
+00011210: 6372 6561 7465 2061 2070 6572 7369 7374  create a persist
+00011220: 656e 740a 7375 6273 6372 6970 7469 6f6e  ent.subscription
+00011230: 2066 6f72 2061 2073 7472 6561 6d2e 0a0a   for a stream...
+00011240: 5468 6973 206d 6574 686f 6420 6861 7320  This method has 
+00011250: 7477 6f20 7265 7175 6972 6564 2061 7267  two required arg
+00011260: 756d 656e 7473 2c20 6067 726f 7570 5f6e  uments, `group_n
+00011270: 616d 6560 2061 6e64 2060 7374 7265 616d  ame` and `stream
+00011280: 5f6e 616d 6560 2e20 5468 650a 6067 726f  _name`. The.`gro
+00011290: 7570 5f6e 616d 6560 2061 7267 756d 656e  up_name` argumen
+000112a0: 7420 6e61 6d65 7320 7468 6520 6772 6f75  t names the grou
+000112b0: 7020 6f66 2063 6f6e 7375 6d65 7273 2074  p of consumers t
+000112c0: 6861 7420 7769 6c6c 2072 6563 6569 7665  hat will receive
+000112d0: 2065 7665 6e74 730a 6672 6f6d 2074 6869   events.from thi
+000112e0: 7320 7375 6273 6372 6970 7469 6f6e 2e20  s subscription. 
+000112f0: 5468 6520 6073 7472 6561 6d5f 6e61 6d65  The `stream_name
+00011300: 6020 6172 6775 6d65 6e74 2073 7065 6369  ` argument speci
+00011310: 6669 6573 2077 6869 6368 2073 7472 6561  fies which strea
+00011320: 6d0a 7468 6520 7375 6273 6372 6970 7469  m.the subscripti
+00011330: 6f6e 2077 696c 6c20 666f 6c6c 6f77 2e20  on will follow. 
+00011340: 5468 6520 7661 6c75 6573 206f 6620 626f  The values of bo
+00011350: 7468 2074 6865 7365 2061 7267 756d 656e  th these argumen
+00011360: 7473 2061 7265 2065 7870 6563 7465 640a  ts are expected.
+00011370: 746f 2062 6520 5079 7468 6f6e 2060 7374  to be Python `st
+00011380: 7260 206f 626a 6563 7473 2e0a 0a54 6865  r` objects...The
+00011390: 206d 6574 686f 6420 616c 736f 2074 616b   method also tak
+000113a0: 6573 2066 6f75 7220 6f70 7469 6f6e 616c  es four optional
+000113b0: 2061 7267 756d 656e 7473 2c20 6073 7472   arguments, `str
+000113c0: 6561 6d5f 706f 7369 7469 6f6e 602c 2060  eam_position`, `
+000113d0: 6672 6f6d 5f65 6e64 602c 0a60 636f 6e73  from_end`,.`cons
+000113e0: 756d 6572 5f73 7472 6174 6567 7960 2c20  umer_strategy`, 
+000113f0: 616e 6420 6074 696d 656f 7574 602e 0a0a  and `timeout`...
+00011400: 5468 6973 206f 7074 696f 6e61 6c20 6073  This optional `s
+00011410: 7472 6561 6d5f 706f 7369 7469 6f6e 6020  tream_position` 
+00011420: 6172 6775 6d65 6e74 2073 7065 6369 6669  argument specifi
+00011430: 6573 2061 2073 7472 6561 6d20 706f 7369  es a stream posi
+00011440: 7469 6f6e 2066 726f 6d0a 7768 6963 6820  tion from.which 
+00011450: 746f 2073 7562 7363 7269 6265 2e20 5468  to subscribe. Th
+00011460: 6520 7265 636f 7264 6564 2065 7665 6e74  e recorded event
+00011470: 2061 7420 7468 6973 2073 7472 6561 6d0a   at this stream.
+00011480: 706f 7369 7469 6f6e 2077 696c 6c20 6265  position will be
+00011490: 2072 6563 6569 7665 6420 7768 656e 2072   received when r
+000114a0: 6561 6469 6e67 2074 6865 2073 7562 7363  eading the subsc
+000114b0: 7269 7074 696f 6e2e 0a0a 5468 6973 206f  ription...This o
+000114c0: 7074 696f 6e61 6c20 6066 726f 6d5f 656e  ptional `from_en
+000114d0: 6460 2061 7267 756d 656e 7420 6973 2061  d` argument is a
+000114e0: 2050 7974 686f 6e20 6062 6f6f 6c60 2e0a   Python `bool`..
+000114f0: 4279 2064 6566 6175 6c74 2c20 7468 6520  By default, the 
+00011500: 7661 6c75 6520 6f66 2074 6869 7320 6172  value of this ar
+00011510: 6775 6d65 6e74 2069 7320 6046 616c 7365  gument is `False
+00011520: 602e 2049 6620 7468 6973 2061 7267 756d  `. If this argum
+00011530: 656e 7420 6973 2073 6574 0a74 6f20 6054  ent is set.to `T
+00011540: 7275 6560 2c20 7265 6164 696e 6720 6672  rue`, reading fr
+00011550: 6f6d 2074 6865 2073 7562 7363 7269 7074  om the subscript
+00011560: 696f 6e20 7769 6c6c 2072 6563 6569 7665  ion will receive
+00011570: 206f 6e6c 7920 6576 656e 7473 0a72 6563   only events.rec
+00011580: 6f72 6465 6420 6166 7465 7220 7468 6520  orded after the 
+00011590: 7375 6273 6372 6970 7469 6f6e 2077 6173  subscription was
+000115a0: 2063 7265 6174 6564 2e20 5468 6174 2069   created. That i
+000115b0: 732c 2069 7420 6973 206e 6f74 2069 6e63  s, it is not inc
+000115c0: 6c75 7369 7665 0a6f 6620 7468 6520 6375  lusive.of the cu
+000115d0: 7272 656e 7420 7374 7265 616d 2070 6f73  rrent stream pos
+000115e0: 6974 696f 6e2e 0a0a 5468 6520 6f70 7469  ition...The opti
+000115f0: 6f6e 616c 2060 636f 6e73 756d 6572 5f73  onal `consumer_s
+00011600: 7472 6174 6567 7960 2061 7267 756d 656e  trategy` argumen
+00011610: 7420 6973 2061 2050 7974 686f 6e20 6073  t is a Python `s
+00011620: 7472 6020 7468 6174 2064 6566 696e 6573  tr` that defines
+00011630: 0a74 6865 2063 6f6e 7375 6d65 7220 7374  .the consumer st
+00011640: 7261 7465 6779 2066 6f72 2074 6869 7320  rategy for this 
+00011650: 7065 7273 6973 7465 6e74 2073 7562 7363  persistent subsc
+00011660: 7269 7074 696f 6e2e 2054 6865 2076 616c  ription. The val
+00011670: 7565 206f 6620 7468 6973 2061 7267 756d  ue of this argum
+00011680: 656e 740a 6361 6e20 6265 2060 2744 6973  ent.can be `'Dis
+00011690: 7061 7463 6854 6f53 696e 676c 6527 602c  patchToSingle'`,
+000116a0: 2060 2752 6f75 6e64 526f 6269 6e27 602c   `'RoundRobin'`,
+000116b0: 2060 2750 696e 6e65 6427 602c 206f 7220   `'Pinned'`, or 
+000116c0: 6027 5069 6e6e 6564 4279 436f 7272 656c  `'PinnedByCorrel
+000116d0: 6174 696f 6e27 602e 2054 6865 0a64 6566  ation'`. The.def
+000116e0: 6175 6c74 2076 616c 7565 2069 7320 6027  ault value is `'
+000116f0: 4469 7370 6174 6368 546f 5369 6e67 6c65  DispatchToSingle
+00011700: 2760 2e0a 0a54 6869 7320 6d65 7468 6f64  '`...This method
+00011710: 2061 6c73 6f20 7461 6b65 7320 616e 206f   also takes an o
+00011720: 7074 696f 6e61 6c20 6074 696d 656f 7574  ptional `timeout
+00011730: 6020 6172 6775 6d65 6e74 2c20 7468 6174  ` argument, that
+00011740: 0a69 7320 6578 7065 6374 6564 2074 6f20  .is expected to 
+00011750: 6265 2061 2050 7974 686f 6e20 6066 6c6f  be a Python `flo
+00011760: 6174 602c 2077 6869 6368 2073 6574 7320  at`, which sets 
+00011770: 6120 6465 6164 6c69 6e65 0a66 6f72 2074  a deadline.for t
+00011780: 6865 2063 6f6d 706c 6574 696f 6e20 6f66  he completion of
+00011790: 2074 6865 2067 5250 4320 6f70 6572 6174   the gRPC operat
+000117a0: 696f 6e2e 0a0a 5468 6973 206d 6574 686f  ion...This metho
+000117b0: 6420 646f 6573 206e 6f74 2072 6574 7572  d does not retur
+000117c0: 6e20 6120 7661 6c75 652e 2045 7665 6e74  n a value. Event
+000117d0: 7320 6361 6e20 6265 2072 6563 6569 7665  s can be receive
+000117e0: 6420 6279 2069 7465 7261 7469 6e67 0a6f  d by iterating.o
+000117f0: 7665 7220 7468 6520 7661 6c75 6520 7265  ver the value re
+00011800: 7475 726e 6564 2062 7920 6361 6c6c 696e  turned by callin
+00011810: 6720 6072 6561 645f 7374 7265 616d 5f73  g `read_stream_s
+00011820: 7562 7363 7269 7074 696f 6e28 2960 2e0a  ubscription()`..
+00011830: 0a54 6865 2065 7861 6d70 6c65 2062 656c  .The example bel
+00011840: 6f77 2063 7265 6174 6573 2061 2070 6572  ow creates a per
+00011850: 7369 7374 656e 7420 7374 7265 616d 2073  sistent stream s
+00011860: 7562 7363 7269 7074 696f 6e20 6672 6f6d  ubscription from
+00011870: 2074 6865 2073 7461 7274 206f 6620 7468   the start of th
+00011880: 6520 7374 7265 616d 2e0a 0a60 6060 7079  e stream...```py
+00011890: 7468 6f6e 0a23 2043 7265 6174 6520 6120  thon.# Create a 
+000118a0: 7065 7273 6973 7465 6e74 2073 7472 6561  persistent strea
+000118b0: 6d20 7375 6273 6372 6970 7469 6f6e 2066  m subscription f
+000118c0: 726f 6d20 7374 6172 7420 6f66 2074 6865  rom start of the
+000118d0: 2073 7472 6561 6d2e 0a67 726f 7570 5f6e   stream..group_n
+000118e0: 616d 6531 203d 2066 2267 726f 7570 2d7b  ame1 = f"group-{
+000118f0: 7575 6964 3428 297d 220a 636c 6965 6e74  uuid4()}".client
+00011900: 2e63 7265 6174 655f 7374 7265 616d 5f73  .create_stream_s
+00011910: 7562 7363 7269 7074 696f 6e28 0a20 2020  ubscription(.   
+00011920: 2067 726f 7570 5f6e 616d 653d 6772 6f75   group_name=grou
+00011930: 705f 6e61 6d65 312c 0a20 2020 2073 7472  p_name1,.    str
+00011940: 6561 6d5f 6e61 6d65 3d73 7472 6561 6d5f  eam_name=stream_
+00011950: 6e61 6d65 322c 0a29 0a60 6060 0a0a 5468  name2,.).```..Th
+00011960: 6520 6578 616d 706c 6520 6265 6c6f 7720  e example below 
+00011970: 6372 6561 7465 7320 6120 7065 7273 6973  creates a persis
+00011980: 7465 6e74 2073 7472 6561 6d20 7375 6273  tent stream subs
+00011990: 6372 6970 7469 6f6e 2066 726f 6d20 6120  cription from a 
+000119a0: 7374 7265 616d 2070 6f73 6974 696f 6e2e  stream position.
+000119b0: 0a0a 6060 6070 7974 686f 6e0a 2320 4372  ..```python.# Cr
+000119c0: 6561 7465 2061 2070 6572 7369 7374 656e  eate a persisten
+000119d0: 7420 7374 7265 616d 2073 7562 7363 7269  t stream subscri
+000119e0: 7074 696f 6e20 6672 6f6d 2061 2073 7472  ption from a str
+000119f0: 6561 6d20 706f 7369 7469 6f6e 2e0a 6772  eam position..gr
+00011a00: 6f75 705f 6e61 6d65 3220 3d20 6622 6772  oup_name2 = f"gr
+00011a10: 6f75 702d 7b75 7569 6434 2829 7d22 0a63  oup-{uuid4()}".c
+00011a20: 6c69 656e 742e 6372 6561 7465 5f73 7472  lient.create_str
+00011a30: 6561 6d5f 7375 6273 6372 6970 7469 6f6e  eam_subscription
+00011a40: 280a 2020 2020 6772 6f75 705f 6e61 6d65  (.    group_name
+00011a50: 3d67 726f 7570 5f6e 616d 6532 2c0a 2020  =group_name2,.  
+00011a60: 2020 7374 7265 616d 5f6e 616d 653d 7374    stream_name=st
+00011a70: 7265 616d 5f6e 616d 6532 2c0a 2020 2020  ream_name2,.    
+00011a80: 7374 7265 616d 5f70 6f73 6974 696f 6e3d  stream_position=
+00011a90: 320a 290a 6060 600a 0a54 6865 2065 7861  2.).```..The exa
+00011aa0: 6d70 6c65 2062 656c 6f77 2063 7265 6174  mple below creat
+00011ab0: 6573 2061 2070 6572 7369 7374 656e 7420  es a persistent 
+00011ac0: 7374 7265 616d 2073 7562 7363 7269 7074  stream subscript
+00011ad0: 696f 6e20 6672 6f6d 2074 6865 2065 6e64  ion from the end
+00011ae0: 206f 6620 7468 6520 7374 7265 616d 2e0a   of the stream..
+00011af0: 0a60 6060 7079 7468 6f6e 0a23 2043 7265  .```python.# Cre
+00011b00: 6174 6520 6120 7065 7273 6973 7465 6e74  ate a persistent
+00011b10: 2073 7472 6561 6d20 7375 6273 6372 6970   stream subscrip
+00011b20: 7469 6f6e 2066 726f 6d20 656e 6420 6f66  tion from end of
+00011b30: 2074 6865 2073 7472 6561 6d2e 0a67 726f   the stream..gro
+00011b40: 7570 5f6e 616d 6533 203d 2066 2267 726f  up_name3 = f"gro
+00011b50: 7570 2d7b 7575 6964 3428 297d 220a 636c  up-{uuid4()}".cl
+00011b60: 6965 6e74 2e63 7265 6174 655f 7374 7265  ient.create_stre
+00011b70: 616d 5f73 7562 7363 7269 7074 696f 6e28  am_subscription(
+00011b80: 0a20 2020 2067 726f 7570 5f6e 616d 653d  .    group_name=
+00011b90: 6772 6f75 705f 6e61 6d65 332c 0a20 2020  group_name3,.   
+00011ba0: 2073 7472 6561 6d5f 6e61 6d65 3d73 7472   stream_name=str
+00011bb0: 6561 6d5f 6e61 6d65 322c 0a20 2020 2066  eam_name2,.    f
+00011bc0: 726f 6d5f 656e 643d 5472 7565 0a29 0a60  rom_end=True.).`
+00011bd0: 6060 0a0a 2323 2320 5265 6164 2073 7472  ``..### Read str
+00011be0: 6561 6d20 7375 6273 6372 6970 7469 6f6e  eam subscription
+00011bf0: 0a0a 2a72 6571 7569 7265 7320 6c65 6164  ..*requires lead
+00011c00: 6572 2a0a 0a54 6865 2060 7265 6164 5f73  er*..The `read_s
+00011c10: 7472 6561 6d5f 7375 6273 6372 6970 7469  tream_subscripti
+00011c20: 6f6e 2829 6020 6d65 7468 6f64 2063 616e  on()` method can
+00011c30: 2062 6520 7573 6564 2074 6f20 7265 6164   be used to read
+00011c40: 2061 2070 6572 7369 7374 656e 740a 7374   a persistent.st
+00011c50: 7265 616d 2073 7562 7363 7269 7074 696f  ream subscriptio
+00011c60: 6e2e 0a0a 5468 6973 206d 6574 686f 6420  n...This method 
+00011c70: 6861 7320 7477 6f20 7265 7175 6972 6564  has two required
+00011c80: 2061 7267 756d 656e 7473 2c20 6067 726f   arguments, `gro
+00011c90: 7570 5f6e 616d 6560 2061 6e64 2060 7374  up_name` and `st
+00011ca0: 7265 616d 5f6e 616d 6560 2c20 7768 6963  ream_name`, whic
+00011cb0: 680a 7368 6f75 6c64 206d 6174 6368 2074  h.should match t
+00011cc0: 6865 2076 616c 7565 7320 6f66 2061 7267  he values of arg
+00011cd0: 756d 656e 7473 2075 7365 6420 7768 656e  uments used when
+00011ce0: 2063 616c 6c69 6e67 2060 6372 6561 7465   calling `create
+00011cf0: 5f73 7472 6561 6d5f 7375 6273 6372 6970  _stream_subscrip
+00011d00: 7469 6f6e 2829 602e 0a0a 5468 6973 206d  tion()`...This m
+00011d10: 6574 686f 6420 616c 736f 2074 616b 6573  ethod also takes
+00011d20: 2061 6e20 6f70 7469 6f6e 616c 2060 7469   an optional `ti
+00011d30: 6d65 6f75 7460 2061 7267 756d 656e 742c  meout` argument,
+00011d40: 2074 6861 740a 6973 2065 7870 6563 7465   that.is expecte
+00011d50: 6420 746f 2062 6520 6120 5079 7468 6f6e  d to be a Python
+00011d60: 2060 666c 6f61 7460 2c20 7768 6963 6820   `float`, which 
+00011d70: 7365 7473 2061 2064 6561 646c 696e 650a  sets a deadline.
+00011d80: 666f 7220 7468 6520 636f 6d70 6c65 7469  for the completi
+00011d90: 6f6e 206f 6620 7468 6520 6752 5043 206f  on of the gRPC o
+00011da0: 7065 7261 7469 6f6e 2e0a 0a54 6869 7320  peration...This 
+00011db0: 6d65 7468 6f64 2072 6574 7572 6e73 2061  method returns a
+00011dc0: 2060 5065 7273 6973 7465 6e74 5375 6273   `PersistentSubs
+00011dd0: 6372 6970 7469 6f6e 6020 6f62 6a65 6374  cription` object
+00011de0: 2c20 7768 6963 6820 6973 2061 6e20 6974  , which is an it
+00011df0: 6572 6174 6f72 0a67 6976 696e 6720 6052  erator.giving `R
+00011e00: 6563 6f72 6465 6445 7665 6e74 6020 6f62  ecordedEvent` ob
+00011e10: 6a65 6374 732c 2074 6861 7420 616c 736f  jects, that also
+00011e20: 2068 6173 2060 6163 6b28 2960 2c20 606e   has `ack()`, `n
+00011e30: 6163 6b28 2960 2061 6e64 2060 7374 6f70  ack()` and `stop
+00011e40: 2829 600a 6d65 7468 6f64 732e 0a0a 6060  ()`.methods...``
+00011e50: 6070 7974 686f 6e0a 7375 6273 6372 6970  `python.subscrip
+00011e60: 7469 6f6e 203d 2063 6c69 656e 742e 7265  tion = client.re
+00011e70: 6164 5f73 7472 6561 6d5f 7375 6273 6372  ad_stream_subscr
+00011e80: 6970 7469 6f6e 280a 2020 2020 6772 6f75  iption(.    grou
+00011e90: 705f 6e61 6d65 3d67 726f 7570 5f6e 616d  p_name=group_nam
+00011ea0: 6531 2c0a 2020 2020 7374 7265 616d 5f6e  e1,.    stream_n
+00011eb0: 616d 653d 7374 7265 616d 5f6e 616d 6532  ame=stream_name2
+00011ec0: 2c0a 290a 6060 600a 0a54 6865 2065 7861  ,.).```..The exa
+00011ed0: 6d70 6c65 2062 656c 6f77 2069 7465 7261  mple below itera
+00011ee0: 7465 7320 6f76 6572 2074 6865 2073 7562  tes over the sub
+00011ef0: 7363 7269 7074 696f 6e20 6f62 6a65 6374  scription object
+00011f00: 2c20 616e 6420 6361 6c6c 7320 6061 636b  , and calls `ack
+00011f10: 2829 602e 0a54 6865 2066 6f72 206c 6f6f  ()`..The for loo
+00011f20: 7020 6272 6561 6b73 2077 6865 6e20 7765  p breaks when we
+00011f30: 2068 6176 6520 7265 6365 6976 6564 2074   have received t
+00011f40: 6865 206c 6173 7420 6576 656e 7420 696e  he last event in
+00011f50: 2074 6865 2073 7472 6561 6d2c 2073 6f0a   the stream, so.
+00011f60: 7468 6174 2077 6520 6361 6e20 6669 6e69  that we can fini
+00011f70: 7368 2074 6865 2065 7861 6d70 6c65 7320  sh the examples 
+00011f80: 696e 2074 6869 7320 646f 6375 6d65 6e74  in this document
+00011f90: 6174 696f 6e2e 0a0a 6060 6070 7974 686f  ation...```pytho
+00011fa0: 6e0a 6576 656e 7473 203d 205b 5d0a 666f  n.events = [].fo
+00011fb0: 7220 6576 656e 7420 696e 2073 7562 7363  r event in subsc
+00011fc0: 7269 7074 696f 6e3a 0a20 2020 2065 7665  ription:.    eve
+00011fd0: 6e74 732e 6170 7065 6e64 2865 7665 6e74  nts.append(event
+00011fe0: 290a 0a20 2020 2023 2041 636b 6e6f 776c  )..    # Acknowl
+00011ff0: 6564 6765 2074 6865 2072 6563 6569 7665  edge the receive
+00012000: 6420 6576 656e 742e 0a20 2020 2073 7562  d event..    sub
+00012010: 7363 7269 7074 696f 6e2e 6163 6b28 6576  scription.ack(ev
+00012020: 656e 745f 6964 3d65 7665 6e74 2e69 6429  ent_id=event.id)
+00012030: 0a0a 2020 2020 2320 5374 6f70 2077 6865  ..    # Stop whe
+00012040: 6e20 2765 7665 6e74 3131 2720 6861 7320  n 'event11' has 
+00012050: 6265 656e 2072 6563 6569 7665 642e 0a20  been received.. 
+00012060: 2020 2069 6620 6576 656e 742e 6964 203d     if event.id =
+00012070: 3d20 6576 656e 7431 312e 6964 3a0a 2020  = event11.id:.  
+00012080: 2020 2020 2020 7375 6273 6372 6970 7469        subscripti
+00012090: 6f6e 2e73 746f 7028 290a 6060 600a 0a57  on.stop().```..W
+000120a0: 6520 6361 6e20 6368 6563 6b20 7765 2072  e can check we r
+000120b0: 6563 6569 7665 6420 616c 6c20 7468 6520  eceived all the 
+000120c0: 6576 656e 7473 2074 6861 7420 7765 7265  events that were
+000120d0: 2061 7070 656e 6465 6420 746f 2060 7374   appended to `st
+000120e0: 7265 616d 5f6e 616d 6532 600a 696e 2074  ream_name2`.in t
+000120f0: 6865 2065 7861 6d70 6c65 7320 6162 6f76  he examples abov
+00012100: 652e 0a0a 6060 6070 7974 686f 6e0a 6173  e...```python.as
+00012110: 7365 7274 206c 656e 2865 7665 6e74 7329  sert len(events)
+00012120: 203d 3d20 340a 6173 7365 7274 2065 7665   == 4.assert eve
+00012130: 6e74 735b 305d 2e73 7472 6561 6d5f 6e61  nts[0].stream_na
+00012140: 6d65 203d 3d20 7374 7265 616d 5f6e 616d  me == stream_nam
+00012150: 6532 0a61 7373 6572 7420 6576 656e 7473  e2.assert events
+00012160: 5b30 5d2e 6964 203d 3d20 6576 656e 7434  [0].id == event4
+00012170: 2e69 640a 6173 7365 7274 2065 7665 6e74  .id.assert event
+00012180: 735b 315d 2e73 7472 6561 6d5f 6e61 6d65  s[1].stream_name
+00012190: 203d 3d20 7374 7265 616d 5f6e 616d 6532   == stream_name2
+000121a0: 0a61 7373 6572 7420 6576 656e 7473 5b31  .assert events[1
+000121b0: 5d2e 6964 203d 3d20 6576 656e 7435 2e69  ].id == event5.i
+000121c0: 640a 6173 7365 7274 2065 7665 6e74 735b  d.assert events[
+000121d0: 325d 2e73 7472 6561 6d5f 6e61 6d65 203d  2].stream_name =
+000121e0: 3d20 7374 7265 616d 5f6e 616d 6532 0a61  = stream_name2.a
+000121f0: 7373 6572 7420 6576 656e 7473 5b32 5d2e  ssert events[2].
+00012200: 6964 203d 3d20 6576 656e 7436 2e69 640a  id == event6.id.
+00012210: 6173 7365 7274 2065 7665 6e74 735b 335d  assert events[3]
+00012220: 2e73 7472 6561 6d5f 6e61 6d65 203d 3d20  .stream_name == 
+00012230: 7374 7265 616d 5f6e 616d 6532 0a61 7373  stream_name2.ass
+00012240: 6572 7420 6576 656e 7473 5b33 5d2e 6964  ert events[3].id
+00012250: 203d 3d20 6576 656e 7431 312e 6964 0a60   == event11.id.`
+00012260: 6060 0a0a 2323 2320 4765 7420 7374 7265  ``..### Get stre
+00012270: 616d 2073 7562 7363 7269 7074 696f 6e20  am subscription 
+00012280: 696e 666f 0a0a 2a72 6571 7569 7265 7320  info..*requires 
+00012290: 6c65 6164 6572 2a0a 0a54 6865 2060 6765  leader*..The `ge
+000122a0: 745f 7374 7265 616d 5f73 7562 7363 7269  t_stream_subscri
+000122b0: 7074 696f 6e5f 696e 666f 2829 6020 6d65  ption_info()` me
+000122c0: 7468 6f64 2063 616e 2062 6520 7573 6564  thod can be used
+000122d0: 2074 6f20 6765 7420 696e 666f 726d 6174   to get informat
+000122e0: 696f 6e20 666f 7220 610a 7065 7273 6973  ion for a.persis
+000122f0: 7465 6e74 2073 7562 7363 7269 7074 696f  tent subscriptio
+00012300: 6e20 666f 7220 6120 7374 7265 616d 2e0a  n for a stream..
+00012310: 0a54 6869 7320 6d65 7468 6f64 2068 6173  .This method has
+00012320: 2074 776f 2072 6571 7569 7265 6420 6172   two required ar
+00012330: 6775 6d65 6e74 732c 2060 6772 6f75 705f  guments, `group_
+00012340: 6e61 6d65 6020 616e 6420 6073 7472 6561  name` and `strea
+00012350: 6d5f 6e61 6d65 602c 2077 6869 6368 0a73  m_name`, which.s
+00012360: 686f 756c 6420 6d61 7463 6820 7468 6520  hould match the 
+00012370: 7661 6c75 6573 206f 6620 6172 6775 6d65  values of argume
+00012380: 6e74 7320 7573 6564 2077 6865 6e20 6361  nts used when ca
+00012390: 6c6c 696e 6720 6063 7265 6174 655f 7374  lling `create_st
+000123a0: 7265 616d 5f73 7562 7363 7269 7074 696f  ream_subscriptio
+000123b0: 6e28 2960 2e0a 0a54 6869 7320 6d65 7468  n()`...This meth
+000123c0: 6f64 2061 6c73 6f20 7461 6b65 7320 616e  od also takes an
+000123d0: 206f 7074 696f 6e61 6c20 6074 696d 656f   optional `timeo
+000123e0: 7574 6020 6172 6775 6d65 6e74 2c20 7468  ut` argument, th
+000123f0: 6174 0a69 7320 6578 7065 6374 6564 2074  at.is expected t
+00012400: 6f20 6265 2061 2050 7974 686f 6e20 6066  o be a Python `f
+00012410: 6c6f 6174 602c 2077 6869 6368 2073 6574  loat`, which set
+00012420: 7320 6120 6465 6164 6c69 6e65 0a66 6f72  s a deadline.for
+00012430: 2074 6865 2063 6f6d 706c 6574 696f 6e20   the completion 
+00012440: 6f66 2074 6865 2067 5250 4320 6f70 6572  of the gRPC oper
+00012450: 6174 696f 6e2e 0a0a 6060 6070 7974 686f  ation...```pytho
+00012460: 6e0a 7375 6273 6372 6970 7469 6f6e 5f69  n.subscription_i
+00012470: 6e66 6f20 3d20 636c 6965 6e74 2e67 6574  nfo = client.get
+00012480: 5f73 7472 6561 6d5f 7375 6273 6372 6970  _stream_subscrip
+00012490: 7469 6f6e 5f69 6e66 6f28 0a20 2020 2067  tion_info(.    g
+000124a0: 726f 7570 5f6e 616d 653d 6772 6f75 705f  roup_name=group_
+000124b0: 6e61 6d65 312c 0a20 2020 2073 7472 6561  name1,.    strea
+000124c0: 6d5f 6e61 6d65 3d73 7472 6561 6d5f 6e61  m_name=stream_na
+000124d0: 6d65 322c 0a29 0a60 6060 0a0a 5468 6520  me2,.).```..The 
+000124e0: 7265 7475 726e 6564 2076 616c 7565 2069  returned value i
+000124f0: 7320 6120 6053 7562 7363 7269 7074 696f  s a `Subscriptio
+00012500: 6e49 6e66 6f60 206f 626a 6563 742e 0a0a  nInfo` object...
+00012510: 2323 2320 4c69 7374 2073 7472 6561 6d20  ### List stream 
+00012520: 7375 6273 6372 6970 7469 6f6e 730a 0a2a  subscriptions..*
+00012530: 7265 7175 6972 6573 206c 6561 6465 722a  requires leader*
+00012540: 0a0a 5468 6520 606c 6973 745f 7374 7265  ..The `list_stre
+00012550: 616d 5f73 7562 7363 7269 7074 696f 6e73  am_subscriptions
+00012560: 2829 6020 6d65 7468 6f64 2063 616e 2062  ()` method can b
+00012570: 6520 7573 6564 2074 6f20 6765 7420 696e  e used to get in
+00012580: 666f 726d 6174 696f 6e20 666f 7220 616c  formation for al
+00012590: 6c0a 7468 6520 7065 7273 6973 7465 6e74  l.the persistent
+000125a0: 2073 7562 7363 7269 7074 696f 6e73 2066   subscriptions f
+000125b0: 6f72 2061 2073 7472 6561 6d2e 0a0a 5468  or a stream...Th
+000125c0: 6973 206d 6574 686f 6420 6861 7320 6f6e  is method has on
+000125d0: 6520 7265 7175 6972 6564 2061 7267 756d  e required argum
+000125e0: 656e 742c 2060 7374 7265 616d 5f6e 616d  ent, `stream_nam
+000125f0: 6560 2e0a 0a54 6869 7320 6d65 7468 6f64  e`...This method
+00012600: 2061 6c73 6f20 7461 6b65 7320 616e 206f   also takes an o
+00012610: 7074 696f 6e61 6c20 6074 696d 656f 7574  ptional `timeout
+00012620: 6020 6172 6775 6d65 6e74 2c20 7468 6174  ` argument, that
+00012630: 0a69 7320 6578 7065 6374 6564 2074 6f20  .is expected to 
+00012640: 6265 2061 2050 7974 686f 6e20 6066 6c6f  be a Python `flo
+00012650: 6174 602c 2077 6869 6368 2073 6574 7320  at`, which sets 
+00012660: 6120 6465 6164 6c69 6e65 0a66 6f72 2074  a deadline.for t
+00012670: 6865 2063 6f6d 706c 6574 696f 6e20 6f66  he completion of
+00012680: 2074 6865 2067 5250 4320 6f70 6572 6174   the gRPC operat
+00012690: 696f 6e2e 0a0a 6060 6070 7974 686f 6e0a  ion...```python.
+000126a0: 7375 6273 6372 6970 7469 6f6e 7320 3d20  subscriptions = 
+000126b0: 636c 6965 6e74 2e6c 6973 745f 7374 7265  client.list_stre
+000126c0: 616d 5f73 7562 7363 7269 7074 696f 6e73  am_subscriptions
+000126d0: 280a 2020 2020 7374 7265 616d 5f6e 616d  (.    stream_nam
+000126e0: 653d 7374 7265 616d 5f6e 616d 6532 2c0a  e=stream_name2,.
+000126f0: 290a 6060 600a 0a54 6865 2072 6574 7572  ).```..The retur
+00012700: 6e65 6420 7661 6c75 6520 6973 2061 206c  ned value is a l
+00012710: 6973 7420 6f66 2060 5375 6273 6372 6970  ist of `Subscrip
+00012720: 7469 6f6e 496e 666f 6020 6f62 6a65 6374  tionInfo` object
+00012730: 732e 0a0a 2323 2320 5570 6461 7465 2073  s...### Update s
+00012740: 7472 6561 6d20 7375 6273 6372 6970 7469  tream subscripti
+00012750: 6f6e 0a0a 2a72 6571 7569 7265 7320 6c65  on..*requires le
+00012760: 6164 6572 2a0a 0a54 6865 206d 6574 686f  ader*..The metho
+00012770: 6420 6075 7064 6174 655f 7374 7265 616d  d `update_stream
+00012780: 5f73 7562 7363 7269 7074 696f 6e28 2960  _subscription()`
+00012790: 2063 616e 2062 6520 7573 6564 2074 6f20   can be used to 
+000127a0: 7570 6461 7465 2061 0a70 6572 7369 7374  update a.persist
+000127b0: 656e 7420 7375 6273 6372 6970 7469 6f6e  ent subscription
+000127c0: 2066 6f72 2061 2073 7472 6561 6d2e 0a0a   for a stream...
+000127d0: 5468 6973 206d 6574 686f 6420 7461 6b65  This method take
+000127e0: 7320 6120 7265 7175 6972 6564 2060 6772  s a required `gr
+000127f0: 6f75 705f 6e61 6d65 6020 6172 6775 6d65  oup_name` argume
+00012800: 6e74 2c20 7768 6963 6820 6973 2074 6865  nt, which is the
+00012810: 0a6e 616d 6520 6f66 2061 2022 6772 6f75  .name of a "grou
+00012820: 7022 206f 6620 636f 6e73 756d 6572 7320  p" of consumers 
+00012830: 6f66 2074 6865 2073 7562 7363 7269 7074  of the subscript
+00012840: 696f 6e2c 2061 6e64 2061 2072 6571 7569  ion, and a requi
+00012850: 7265 640a 6073 7472 6561 6d5f 6e61 6d65  red.`stream_name
+00012860: 6020 6172 6775 6d65 6e74 2c20 7768 6963  ` argument, whic
+00012870: 6820 6973 2074 6865 206e 616d 6520 6f66  h is the name of
+00012880: 2061 2073 7472 6561 6d2e 0a0a 5468 6973   a stream...This
+00012890: 206d 6574 686f 6420 616c 736f 2074 616b   method also tak
+000128a0: 6573 2074 6872 6565 206f 7074 696f 6e61  es three optiona
+000128b0: 6c20 6172 6775 6d65 6e74 732c 2060 6672  l arguments, `fr
+000128c0: 6f6d 5f65 6e64 602c 2060 7374 7265 616d  om_end`, `stream
+000128d0: 5f70 6f73 6974 696f 6e60 2c0a 616e 6420  _position`,.and 
+000128e0: 6074 696d 656f 7574 602e 0a0a 5468 6520  `timeout`...The 
+000128f0: 6f70 7469 6f6e 616c 2060 6672 6f6d 5f65  optional `from_e
+00012900: 6e64 6020 6172 6775 6d65 6e74 2063 616e  nd` argument can
+00012910: 2062 6520 7573 6564 2074 6f20 7370 6563   be used to spec
+00012920: 6966 7920 7468 6174 2074 6865 2067 726f  ify that the gro
+00012930: 7570 206f 6620 636f 6e73 756d 6572 730a  up of consumers.
+00012940: 6f66 2074 6865 2073 7562 7363 7269 7074  of the subscript
+00012950: 696f 6e20 7368 6f75 6c64 206f 6e6c 7920  ion should only 
+00012960: 7265 6365 6976 6520 6576 656e 7473 2074  receive events t
+00012970: 6861 7420 7765 7265 2072 6563 6f72 6465  hat were recorde
+00012980: 6420 6166 7465 7220 7468 6520 7375 6273  d after the subs
+00012990: 6372 6970 7469 6f6e 0a77 6173 2075 7064  cription.was upd
+000129a0: 6174 6564 2e0a 0a41 6c74 6572 6e61 7469  ated...Alternati
+000129b0: 7665 6c79 2c20 7468 6520 6f70 7469 6f6e  vely, the option
+000129c0: 616c 2060 7374 7265 616d 5f70 6f73 6974  al `stream_posit
+000129d0: 696f 6e60 2061 7267 756d 656e 7420 6361  ion` argument ca
+000129e0: 6e20 6265 2075 7365 6420 746f 2073 7065  n be used to spe
+000129f0: 6369 6679 2061 2073 7472 6561 6d0a 706f  cify a stream.po
+00012a00: 7369 7469 6f6e 2066 726f 6d20 7768 6963  sition from whic
+00012a10: 6820 636f 6d6d 6974 2070 6f73 6974 696f  h commit positio
+00012a20: 6e20 7468 6520 6772 6f75 7020 6f66 2063  n the group of c
+00012a30: 6f6e 7375 6d65 7273 206f 6620 7468 6520  onsumers of the 
+00012a40: 7375 6273 6372 6970 7469 6f6e 2073 686f  subscription sho
+00012a50: 756c 640a 7265 6365 6976 6520 6576 656e  uld.receive even
+00012a60: 7473 2e20 506c 6561 7365 206e 6f74 652c  ts. Please note,
+00012a70: 2074 6865 2072 6563 6f72 6465 6420 6576   the recorded ev
+00012a80: 656e 7420 6174 2074 6865 2073 7065 6369  ent at the speci
+00012a90: 6669 6564 2073 7472 6561 6d20 706f 7369  fied stream posi
+00012aa0: 7469 6f6e 206d 6967 6874 0a62 6520 696e  tion might.be in
+00012ab0: 636c 7564 6564 2069 6e20 7468 6520 7265  cluded in the re
+00012ac0: 636f 7264 6564 2065 7665 6e74 7320 7265  corded events re
+00012ad0: 6365 6976 6564 2062 7920 7468 6520 6772  ceived by the gr
+00012ae0: 6f75 7020 6f66 2063 6f6e 7375 6d65 7273  oup of consumers
+00012af0: 2e0a 0a49 6620 6e65 6974 6865 7220 6066  ...If neither `f
+00012b00: 726f 6d5f 656e 6460 206f 7220 6063 6f6d  rom_end` or `com
+00012b10: 6d69 745f 706f 7369 7469 6f6e 6020 6172  mit_position` ar
+00012b20: 6520 7370 6563 6966 6965 642c 2074 6865  e specified, the
+00012b30: 2067 726f 7570 206f 6620 636f 6e73 756d   group of consum
+00012b40: 6572 730a 6f66 2074 6865 2073 7562 7363  ers.of the subsc
+00012b50: 7269 7074 696f 6e20 7769 6c6c 2070 6f74  ription will pot
+00012b60: 656e 7469 616c 6c79 2072 6563 6569 7665  entially receive
+00012b70: 2061 6c6c 2072 6563 6f72 6465 6420 6576   all recorded ev
+00012b80: 656e 7473 2069 6e20 7468 6520 7374 7265  ents in the stre
+00012b90: 616d 2e0a 0a50 6c65 6173 6520 6e6f 7465  am...Please note
+00012ba0: 2c20 7468 6520 636f 6e73 756d 6572 2073  , the consumer s
+00012bb0: 7472 6174 6567 7920 6361 6e6e 6f74 2062  trategy cannot b
+00012bc0: 6520 6164 6a75 7374 6564 2e0a 0a54 6865  e adjusted...The
+00012bd0: 206f 7074 696f 6e61 6c20 6074 696d 656f   optional `timeo
+00012be0: 7574 6020 6172 6775 6d65 6e74 2069 7320  ut` argument is 
+00012bf0: 6120 5079 7468 6f6e 2060 666c 6f61 7460  a Python `float`
+00012c00: 2077 6869 6368 2073 6574 7320 610a 6465   which sets a.de
+00012c10: 6164 6c69 6e65 2066 6f72 2074 6865 2063  adline for the c
+00012c20: 6f6d 706c 6574 696f 6e20 6f66 2074 6865  ompletion of the
+00012c30: 2067 5250 4320 6f70 6572 6174 696f 6e2e   gRPC operation.
+00012c40: 0a0a 5468 6520 6d65 7468 6f64 2060 7570  ..The method `up
+00012c50: 6461 7465 5f73 7472 6561 6d5f 7375 6273  date_stream_subs
+00012c60: 6372 6970 7469 6f6e 2829 6020 646f 6573  cription()` does
+00012c70: 206e 6f74 2072 6574 7572 6e20 6120 7661   not return a va
+00012c80: 6c75 652e 0a0a 496e 2074 6865 2065 7861  lue...In the exa
+00012c90: 6d70 6c65 2062 656c 6f77 2c20 6120 7065  mple below, a pe
+00012ca0: 7273 6973 7465 6e74 2073 7562 7363 7269  rsistent subscri
+00012cb0: 7074 696f 6e20 666f 7220 6120 7374 7265  ption for a stre
+00012cc0: 616d 2069 7320 7570 6461 7465 6420 746f  am is updated to
+00012cd0: 2072 756e 2066 726f 6d20 7468 650a 656e   run from the.en
+00012ce0: 6420 6f66 2074 6865 2073 7472 6561 6d2e  d of the stream.
+00012cf0: 0a0a 6060 6070 7974 686f 6e0a 2320 4372  ..```python.# Cr
+00012d00: 6561 7465 2061 2070 6572 7369 7374 656e  eate a persisten
+00012d10: 7420 7375 6273 6372 6970 7469 6f6e 2e0a  t subscription..
+00012d20: 636c 6965 6e74 2e75 7064 6174 655f 7374  client.update_st
+00012d30: 7265 616d 5f73 7562 7363 7269 7074 696f  ream_subscriptio
+00012d40: 6e28 0a20 2020 2067 726f 7570 5f6e 616d  n(.    group_nam
+00012d50: 653d 6772 6f75 705f 6e61 6d65 312c 0a20  e=group_name1,. 
+00012d60: 2020 2073 7472 6561 6d5f 6e61 6d65 3d73     stream_name=s
+00012d70: 7472 6561 6d5f 6e61 6d65 322c 0a20 2020  tream_name2,.   
+00012d80: 2066 726f 6d5f 656e 643d 5472 7565 2c0a   from_end=True,.
+00012d90: 290a 6060 600a 0a23 2323 2044 656c 6574  ).```..### Delet
+00012da0: 6520 7374 7265 616d 2073 7562 7363 7269  e stream subscri
+00012db0: 7074 696f 6e0a 0a2a 7265 7175 6972 6573  ption..*requires
+00012dc0: 206c 6561 6465 722a 0a0a 5468 6520 6064   leader*..The `d
+00012dd0: 656c 6574 655f 7374 7265 616d 5f73 7562  elete_stream_sub
+00012de0: 7363 7269 7074 696f 6e28 2960 206d 6574  scription()` met
+00012df0: 686f 6420 6361 6e20 6265 2075 7365 6420  hod can be used 
+00012e00: 746f 2064 656c 6574 6520 6120 7065 7273  to delete a pers
+00012e10: 6973 7465 6e74 0a73 7562 7363 7269 7074  istent.subscript
+00012e20: 696f 6e20 666f 7220 6120 7374 7265 616d  ion for a stream
+00012e30: 2e0a 0a54 6869 7320 6d65 7468 6f64 2068  ...This method h
+00012e40: 6173 2074 776f 2072 6571 7569 7265 6420  as two required 
+00012e50: 6172 6775 6d65 6e74 732c 2060 6772 6f75  arguments, `grou
+00012e60: 705f 6e61 6d65 6020 616e 6420 6073 7472  p_name` and `str
+00012e70: 6561 6d5f 6e61 6d65 602c 2077 6869 6368  eam_name`, which
+00012e80: 0a73 686f 756c 6420 6d61 7463 6820 7468  .should match th
+00012e90: 6520 7661 6c75 6573 206f 6620 6172 6775  e values of argu
+00012ea0: 6d65 6e74 7320 7573 6564 2077 6865 6e20  ments used when 
+00012eb0: 6361 6c6c 696e 6720 6063 7265 6174 655f  calling `create_
+00012ec0: 7374 7265 616d 5f73 7562 7363 7269 7074  stream_subscript
+00012ed0: 696f 6e28 2960 2e0a 0a54 6869 7320 6d65  ion()`...This me
+00012ee0: 7468 6f64 2061 6c73 6f20 7461 6b65 7320  thod also takes 
+00012ef0: 616e 206f 7074 696f 6e61 6c20 6074 696d  an optional `tim
+00012f00: 656f 7574 6020 6172 6775 6d65 6e74 2c20  eout` argument, 
+00012f10: 7468 6174 0a69 7320 6578 7065 6374 6564  that.is expected
+00012f20: 2074 6f20 6265 2061 2050 7974 686f 6e20   to be a Python 
+00012f30: 6066 6c6f 6174 602c 2077 6869 6368 2073  `float`, which s
+00012f40: 6574 7320 6120 6465 6164 6c69 6e65 0a66  ets a deadline.f
+00012f50: 6f72 2074 6865 2063 6f6d 706c 6574 696f  or the completio
+00012f60: 6e20 6f66 2074 6865 2067 5250 4320 6f70  n of the gRPC op
+00012f70: 6572 6174 696f 6e2e 0a0a 6060 6070 7974  eration...```pyt
+00012f80: 686f 6e0a 636c 6965 6e74 2e64 656c 6574  hon.client.delet
+00012f90: 655f 7374 7265 616d 5f73 7562 7363 7269  e_stream_subscri
+00012fa0: 7074 696f 6e28 0a20 2020 2067 726f 7570  ption(.    group
+00012fb0: 5f6e 616d 653d 6772 6f75 705f 6e61 6d65  _name=group_name
+00012fc0: 312c 0a20 2020 2073 7472 6561 6d5f 6e61  1,.    stream_na
+00012fd0: 6d65 3d73 7472 6561 6d5f 6e61 6d65 322c  me=stream_name2,
+00012fe0: 0a29 0a60 6060 0a0a 2323 2320 5065 7273  .).```..### Pers
+00012ff0: 6973 7465 6e74 2073 7562 7363 7269 7074  istent subscript
+00013000: 696f 6e20 636f 6e73 756d 6572 0a0a 5468  ion consumer..Th
+00013010: 6520 7265 6164 696e 6720 6f66 2061 2070  e reading of a p
+00013020: 6572 7369 7374 656e 7420 7375 6273 6372  ersistent subscr
+00013030: 6970 7469 6f6e 2063 616e 2062 6520 656e  iption can be en
+00013040: 6361 7073 756c 6174 6564 2069 6e20 6120  capsulated in a 
+00013050: 2263 6f6e 7375 6d65 7222 2074 6861 7420  "consumer" that 
+00013060: 6361 6c6c 730a 6120 2270 6f6c 6963 7922  calls.a "policy"
+00013070: 2066 756e 6374 696f 6e20 7768 656e 2061   function when a
+00013080: 2072 6563 6f72 6465 6420 6576 656e 7420   recorded event 
+00013090: 6973 2072 6563 6569 7665 6420 616e 6420  is received and 
+000130a0: 7468 656e 2061 7574 6f6d 6174 6963 616c  then automatical
+000130b0: 6c79 2063 616c 6c73 0a60 6163 6b28 2960  ly calls.`ack()`
+000130c0: 2069 6620 7468 6520 706f 6c69 6379 2066   if the policy f
+000130d0: 756e 6374 696f 6e20 7265 7475 726e 7320  unction returns 
+000130e0: 6e6f 726d 616c 6c79 2c20 616e 6420 606e  normally, and `n
+000130f0: 6163 6b28 2960 2069 6620 6974 2072 6169  ack()` if it rai
+00013100: 7365 7320 616e 2065 7863 6570 7469 6f6e  ses an exception
+00013110: 2c0a 7065 7268 6170 7320 7265 7472 7969  ,.perhaps retryi
+00013120: 6e67 2074 6865 2065 7665 6e74 2066 6f72  ng the event for
+00013130: 2061 2063 6572 7461 696e 206e 756d 6265   a certain numbe
+00013140: 7220 6f66 2074 696d 6573 2c20 616e 6420  r of times, and 
+00013150: 7468 656e 2070 6172 6b69 6e67 2074 6865  then parking the
+00013160: 2065 7665 6e74 2e0a 0a54 6865 2073 696d   event...The sim
+00013170: 706c 6520 6578 616d 706c 6520 6265 6c6f  ple example belo
+00013180: 7720 7368 6f77 7320 686f 7720 7468 6973  w shows how this
+00013190: 206d 6967 6874 2062 6520 646f 6e65 2e20   might be done. 
+000131a0: 5765 2063 616e 2073 6565 2074 6861 7420  We can see that 
+000131b0: 2765 7665 6e74 3131 2720 6973 0a61 636b  'event11' is.ack
+000131c0: 6e6f 776c 6564 6765 6420 6265 666f 7265  nowledged before
+000131d0: 2027 6576 656e 7435 2720 6973 2066 696e   'event5' is fin
+000131e0: 616c 6c79 2070 6172 6b65 642e 0a0a 0a60  ally parked....`
+000131f0: 6060 7079 7468 6f6e 0a61 636b 6564 5f65  ``python.acked_e
+00013200: 7665 6e74 7320 3d20 7b7d 0a6e 6163 6b65  vents = {}.nacke
+00013210: 645f 6576 656e 7473 203d 207b 7d0a 0a0a  d_events = {}...
+00013220: 636c 6173 7320 4578 616d 706c 6543 6f6e  class ExampleCon
+00013230: 7375 6d65 723a 0a20 2020 2064 6566 205f  sumer:.    def _
+00013240: 5f69 6e69 745f 5f28 7365 6c66 2c20 7375  _init__(self, su
+00013250: 6273 6372 6970 7469 6f6e 2c20 6d61 785f  bscription, max_
+00013260: 7265 7472 6965 732c 2066 696e 616c 5f61  retries, final_a
+00013270: 6374 696f 6e29 3a0a 2020 2020 2020 2020  ction):.        
+00013280: 7365 6c66 2e73 7562 7363 7269 7074 696f  self.subscriptio
+00013290: 6e20 3d20 7375 6273 6372 6970 7469 6f6e  n = subscription
+000132a0: 0a20 2020 2020 2020 2073 656c 662e 6d61  .        self.ma
+000132b0: 785f 7265 7472 6965 7320 3d20 6d61 785f  x_retries = max_
+000132c0: 7265 7472 6965 730a 2020 2020 2020 2020  retries.        
+000132d0: 7365 6c66 2e66 696e 616c 5f61 6374 696f  self.final_actio
+000132e0: 6e20 3d20 6669 6e61 6c5f 6163 7469 6f6e  n = final_action
+000132f0: 0a20 2020 2020 2020 2073 656c 662e 6572  .        self.er
+00013300: 726f 7220 3d20 4e6f 6e65 0a0a 2020 2020  ror = None..    
+00013310: 6465 6620 7275 6e28 7365 6c66 293a 0a20  def run(self):. 
+00013320: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
+00013330: 2020 2020 2020 2020 666f 7220 6576 656e          for even
+00013340: 7420 696e 2073 656c 662e 7375 6273 6372  t in self.subscr
+00013350: 6970 7469 6f6e 3a0a 2020 2020 2020 2020  iption:.        
+00013360: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
+00013370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013380: 2073 656c 662e 706f 6c69 6379 2865 7665   self.policy(eve
+00013390: 6e74 290a 2020 2020 2020 2020 2020 2020  nt).            
+000133a0: 2020 2020 6578 6365 7074 2045 7863 6570      except Excep
+000133b0: 7469 6f6e 3a0a 2020 2020 2020 2020 2020  tion:.          
+000133c0: 2020 2020 2020 2020 2020 6966 2065 7665            if eve
+000133d0: 6e74 2e72 6574 7279 5f63 6f75 6e74 203c  nt.retry_count <
+000133e0: 2073 656c 662e 6d61 785f 7265 7472 6965   self.max_retrie
+000133f0: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
+00013400: 2020 2020 2020 2020 2020 2061 6374 696f             actio
+00013410: 6e20 3d20 2272 6574 7279 220a 2020 2020  n = "retry".    
 00013420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013440: 207c 2054 6865 2076 616c 7565 206f 6620   | The value of 
-00013450: 7468 6520 2267 7270 632e 6b65 6570 616c  the "grpc.keepal
-00013460: 6976 655f 6d73 2220 6752 5043 2063 6861  ive_ms" gRPC cha
-00013470: 6e6e 656c 206f 7074 696f 6e2e 2020 2020  nnel option.    
-00013480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000134a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013430: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00013440: 2020 2020 2020 2020 2020 2020 2020 6163                ac
+00013450: 7469 6f6e 203d 2073 656c 662e 6669 6e61  tion = self.fina
+00013460: 6c5f 6163 7469 6f6e 0a20 2020 2020 2020  l_action.       
+00013470: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00013480: 662e 7375 6273 6372 6970 7469 6f6e 2e6e  f.subscription.n
+00013490: 6163 6b28 6576 656e 742e 6964 2c20 6163  ack(event.id, ac
+000134a0: 7469 6f6e 3d61 6374 696f 6e29 0a20 2020  tion=action).   
 000134b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000134c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000134d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000134e0: 2020 2020 207c 0a7c 204b 6565 7041 6c69       |.| KeepAli
-000134f0: 7665 5469 6d65 6f75 7420 2020 207c 2069  veTimeout    | i
-00013500: 6e74 6567 6572 2028 6465 6661 756c 743a  nteger (default:
-00013510: 2060 4e6f 6e65 6029 2020 2020 2020 2020   `None`)        
-00013520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013540: 2020 2020 207c 2054 6865 2076 616c 7565       | The value
-00013550: 206f 6620 7468 6520 2267 7270 632e 6b65   of the "grpc.ke
-00013560: 6570 616c 6976 655f 7469 6d65 6f75 745f  epalive_timeout_
-00013570: 6d73 2220 6752 5043 2063 6861 6e6e 656c  ms" gRPC channel
-00013580: 206f 7074 696f 6e2e 2020 2020 2020 2020   option.        
-00013590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000135a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000135b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000135c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000135d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000135e0: 2020 2020 2020 2020 207c 0a0a 0a48 6572           |...Her
-000135f0: 6520 6172 6520 736f 6d65 2065 7861 6d70  e are some examp
-00013600: 6c65 7320 6f66 2045 7665 6e74 5374 6f72  les of EventStor
-00013610: 6544 4220 636f 6e6e 6563 7469 6f6e 2073  eDB connection s
-00013620: 7472 696e 6720 5552 4973 2e0a 0a20 2020  tring URIs...   
-00013630: 2023 2047 6574 2063 6c75 7374 6572 2069   # Get cluster i
-00013640: 6e66 6f20 6672 6f6d 2073 6563 7572 6520  nfo from secure 
-00013650: 7365 7276 6572 2073 6f63 6b65 7420 6c6f  server socket lo
-00013660: 6361 6c68 6f73 743a 3231 3133 2c0a 2020  calhost:2113,.  
-00013670: 2020 2320 616e 6420 7573 6520 2261 646d    # and use "adm
-00013680: 696e 2220 616e 6420 2263 6861 6e67 6569  in" and "changei
-00013690: 7422 2061 7320 7573 6572 6e61 6d65 2061  t" as username a
-000136a0: 6e64 2070 6173 7377 6f72 640a 2020 2020  nd password.    
-000136b0: 2320 7768 656e 206d 616b 696e 6720 6361  # when making ca
-000136c0: 6c6c 7320 746f 2045 7665 6e74 5374 6f72  lls to EventStor
-000136d0: 6544 4220 4150 4920 6d65 7468 6f64 732e  eDB API methods.
-000136e0: 0a0a 2020 2020 6573 6462 3a2f 2f61 646d  ..    esdb://adm
-000136f0: 696e 3a63 6861 6e67 6569 7440 6c6f 6361  in:changeit@loca
-00013700: 6c68 6f73 743a 3231 3133 0a0a 0a20 2020  lhost:2113...   
-00013710: 2023 2047 6574 2063 6c75 7374 6572 2069   # Get cluster i
-00013720: 6e66 6f20 6672 6f6d 2069 6e73 6563 7572  nfo from insecur
-00013730: 6520 7365 7276 6572 2073 6f63 6b65 7420  e server socket 
-00013740: 3132 372e 302e 302e 313a 3231 3134 0a0a  127.0.0.1:2114..
-00013750: 2020 2020 6573 6462 3a2f 2f31 3237 2e30      esdb://127.0
-00013760: 2e30 2e31 3a32 3131 343f 546c 733d 6661  .0.1:2114?Tls=fa
-00013770: 6c73 650a 0a0a 2020 2020 2320 4765 7420  lse...    # Get 
-00013780: 636c 7573 7465 7220 696e 666f 2066 726f  cluster info fro
-00013790: 6d20 6164 6472 6573 7365 7320 696e 2027  m addresses in '
-000137a0: 4127 2072 6563 6f72 6473 2066 6f72 2063  A' records for c
-000137b0: 6c75 7374 6572 312e 6578 616d 706c 652e  luster1.example.
-000137c0: 636f 6d2c 0a20 2020 2023 2061 6e64 2075  com,.    # and u
-000137d0: 7365 2061 2064 6566 6175 6c74 2064 6561  se a default dea
-000137e0: 646c 696e 6520 666f 7220 6d61 6b69 6e67  dline for making
-000137f0: 2063 616c 6c73 2074 6f20 4576 656e 7453   calls to EventS
-00013800: 746f 7265 2041 5049 206d 6574 686f 642e  tore API method.
-00013810: 0a0a 2020 2020 6573 6462 2b64 6973 636f  ..    esdb+disco
-00013820: 7665 723a 2f2f 6164 6d69 6e3a 6368 616e  ver://admin:chan
-00013830: 6765 6974 4063 6c75 7374 6572 312e 6578  geit@cluster1.ex
-00013840: 616d 706c 652e 636f 6d3f 4465 6661 756c  ample.com?Defaul
-00013850: 7444 6561 646c 696e 653d 350a 0a0a 2020  tDeadline=5...  
-00013860: 2020 2320 4765 7420 636c 7573 7465 7220    # Get cluster 
-00013870: 696e 666f 2066 726f 6d20 6569 7468 6572  info from either
-00013880: 206c 6f63 616c 686f 7374 3a32 3131 3120   localhost:2111 
-00013890: 6f72 206c 6f63 616c 686f 7374 3a32 3131  or localhost:211
-000138a0: 3220 6f72 0a20 2020 2023 206c 6f63 616c  2 or.    # local
-000138b0: 686f 7374 3a32 3131 332c 2061 6e64 2074  host:2113, and t
-000138c0: 6865 6e20 636f 6e6e 6563 7420 746f 2061  hen connect to a
-000138d0: 2066 6f6c 6c6f 7765 7220 6e6f 6465 2069   follower node i
-000138e0: 6e20 7468 6520 636c 7573 7465 722e 0a0a  n the cluster...
-000138f0: 2020 2020 6573 6462 3a2f 2f61 646d 696e      esdb://admin
-00013900: 3a63 6861 6e67 6569 7440 6c6f 6361 6c68  :changeit@localh
-00013910: 6f73 743a 3231 3131 2c6c 6f63 616c 686f  ost:2111,localho
-00013920: 7374 3a32 3131 322c 6c6f 6361 6c68 6f73  st:2112,localhos
-00013930: 743a 3231 3133 3f4e 6f64 6550 7265 6665  t:2113?NodePrefe
-00013940: 7265 6e63 653d 666f 6c6c 6f77 6572 0a0a  rence=follower..
-00013950: 0a20 2020 2023 2047 6574 2063 6c75 7374  .    # Get clust
-00013960: 6572 2069 6e66 6f20 6672 6f6d 2061 6464  er info from add
-00013970: 7265 7373 6573 2069 6e20 2741 2720 7265  resses in 'A' re
-00013980: 636f 7264 7320 666f 7220 636c 7573 7465  cords for cluste
-00013990: 7231 2e65 7861 6d70 6c65 2e63 6f6d 2c0a  r1.example.com,.
-000139a0: 2020 2020 2320 616e 6420 636f 6e66 6967      # and config
-000139b0: 7572 6520 226b 6565 7020 616c 6976 6522  ure "keep alive"
-000139c0: 2074 696d 656f 7574 2061 6e64 2069 6e74   timeout and int
-000139d0: 6572 7661 6c20 696e 2074 6865 2067 5250  erval in the gRP
-000139e0: 4320 6368 616e 6e65 6c2e 0a0a 2020 2020  C channel...    
-000139f0: 6573 6462 2b64 6973 636f 7665 723a 2f2f  esdb+discover://
-00013a00: 6164 6d69 6e3a 6368 616e 6765 6974 4063  admin:changeit@c
-00013a10: 6c75 7374 6572 312e 6578 616d 706c 652e  luster1.example.
-00013a20: 636f 6d3f 4b65 6570 416c 6976 6549 6e74  com?KeepAliveInt
-00013a30: 6572 7661 6c3d 3130 3030 3026 4b65 6570  erval=10000&Keep
-00013a40: 416c 6976 6554 696d 656f 7574 3d31 3030  AliveTimeout=100
-00013a50: 3030 0a0a 0a50 6c65 6173 6520 6e6f 7465  00...Please note
-00013a60: 2c20 7468 6520 636c 6965 6e74 2069 7320  , the client is 
-00013a70: 696e 7365 6e73 6974 6976 6520 746f 2074  insensitive to t
-00013a80: 6865 2063 6173 6520 6f66 2066 6965 6c64  he case of field
-00013a90: 7320 616e 6420 7661 6c75 6573 2e20 4966  s and values. If
-00013aa0: 2066 6965 6c64 7320 6172 650a 7265 7065   fields are.repe
-00013ab0: 6174 6564 2069 6e20 7468 6520 7175 6572  ated in the quer
-00013ac0: 7920 7374 7269 6e67 2c20 7468 6520 7175  y string, the qu
-00013ad0: 6572 7920 7374 7269 6e67 2077 696c 6c20  ery string will 
-00013ae0: 6265 2070 6172 7365 6420 7769 7468 6f75  be parsed withou
-00013af0: 7420 6572 726f 722e 2048 6f77 6576 6572  t error. However
-00013b00: 2c0a 7468 6520 636f 6e6e 6563 7469 6f6e  ,.the connection
-00013b10: 206f 7074 696f 6e73 2075 7365 6420 6279   options used by
-00013b20: 2074 6865 2063 6c69 656e 7420 7769 6c6c   the client will
-00013b30: 2075 7365 2074 6865 2076 616c 7565 206f   use the value o
-00013b40: 6620 7468 6520 6669 7273 7420 6669 656c  f the first fiel
-00013b50: 642e 2041 6c6c 0a74 6865 206f 7468 6572  d. All.the other
-00013b60: 2066 6965 6c64 2d76 616c 7565 7320 696e   field-values in
-00013b70: 2074 6865 2071 7565 7279 2073 7472 696e   the query strin
-00013b80: 6720 7769 7468 2074 6865 2073 616d 6520  g with the same 
-00013b90: 6669 656c 6420 6e61 6d65 2077 696c 6c20  field name will 
-00013ba0: 6265 2069 676e 6f72 6564 2e0a 4669 656c  be ignored..Fiel
-00013bb0: 6473 2077 6974 686f 7574 2076 616c 7565  ds without value
-00013bc0: 7320 7769 6c6c 2061 6c73 6f20 6265 2069  s will also be i
-00013bd0: 676e 6f72 6564 2e0a 0a49 6620 7468 6520  gnored...If the 
-00013be0: 636c 6965 6e74 2773 206e 6f64 6520 7072  client's node pr
-00013bf0: 6566 6572 656e 6365 2069 7320 226c 6561  eference is "lea
-00013c00: 6465 7222 2061 6e64 2074 6865 206e 6f64  der" and the nod
-00013c10: 6520 6265 636f 6d65 7320 610a 2266 6f6c  e becomes a."fol
-00013c20: 6c6f 7765 7222 2c20 7468 6520 636c 6965  lower", the clie
-00013c30: 6e74 2077 696c 6c20 6174 7465 6d70 7420  nt will attempt 
-00013c40: 746f 2072 6563 6f6e 6e65 6374 2074 6f20  to reconnect to 
-00013c50: 7468 6520 6375 7272 656e 7420 6c65 6164  the current lead
-00013c60: 6572 2077 6865 6e20 6120 6d65 7468 6f64  er when a method
-00013c70: 0a69 7320 6361 6c6c 6564 2074 6861 7420  .is called that 
-00013c80: 6578 7065 6374 7320 746f 2063 616c 6c20  expects to call 
-00013c90: 6120 6c65 6164 6572 2e20 4d65 7468 6f64  a leader. Method
-00013ca0: 7320 7768 6963 6820 6d75 7461 7465 2074  s which mutate t
-00013cb0: 6865 2073 7461 7465 206f 6620 7468 6520  he state of the 
-00013cc0: 6461 7461 6261 7365 0a65 7870 6563 7420  database.expect 
-00013cd0: 746f 2063 616c 6c20 6120 6c65 6164 6572  to call a leader
-00013ce0: 2e20 466f 7220 7375 6368 206d 6574 686f  . For such metho
-00013cf0: 6473 2c20 7468 6520 4854 5450 2068 6561  ds, the HTTP hea
-00013d00: 6465 7222 7265 7175 6972 6573 2d6c 6561  der"requires-lea
-00013d10: 6465 7222 2069 7320 7365 7420 746f 0a22  der" is set to."
-00013d20: 7472 7565 222c 2061 6e64 2074 6869 7320  true", and this 
-00013d30: 6865 6164 6572 2069 7320 6f62 7365 7276  header is observ
-00013d40: 6564 2062 7920 7468 6520 7365 7276 6572  ed by the server
-00013d50: 2c20 616e 6420 736f 2061 206e 6f64 6520  , and so a node 
-00013d60: 7768 6963 6820 6973 206e 6f74 2061 206c  which is not a l
-00013d70: 6561 6465 720a 7468 6174 2072 6563 6569  eader.that recei
-00013d80: 7665 7320 7375 6368 2061 2072 6571 7565  ves such a reque
-00013d90: 7374 2077 696c 6c20 7265 7475 726e 2061  st will return a
-00013da0: 6e20 6572 726f 722e 2054 6869 7320 6572  n error. This er
-00013db0: 726f 7220 6973 2064 6574 6563 7465 6420  ror is detected 
-00013dc0: 6279 2074 6865 2063 6c69 656e 742c 0a77  by the client,.w
-00013dd0: 6869 6368 2077 696c 6c20 7468 656e 2063  hich will then c
-00013de0: 6c6f 7365 2074 6865 2063 7572 7265 6e74  lose the current
-00013df0: 2067 5250 4320 636f 6e6e 6563 7469 6f6e   gRPC connection
-00013e00: 2061 6e64 2063 7265 6174 6520 6120 6e65   and create a ne
-00013e10: 7720 636f 6e6e 6563 7469 6f6e 2074 6f20  w connection to 
-00013e20: 7468 650a 6c65 6164 6572 2e20 5468 6520  the.leader. The 
-00013e30: 7265 7175 6573 7420 7769 6c6c 2074 6865  request will the
-00013e40: 6e20 6265 2072 6574 7269 6564 2077 6974  n be retried wit
-00013e50: 6820 7468 6520 6c65 6164 6572 2e0a 0a49  h the leader...I
-00013e60: 6620 7468 6520 636c 6965 6e74 2773 206e  f the client's n
-00013e70: 6f64 6520 7072 6566 6572 656e 6365 2069  ode preference i
-00013e80: 7320 2266 6f6c 6c6f 7765 7222 2061 6e64  s "follower" and
-00013e90: 2074 6865 7265 2061 7265 206e 6f20 666f   there are no fo
-00013ea0: 6c6c 6f77 6572 0a6e 6f64 6573 2069 6e20  llower.nodes in 
-00013eb0: 7468 6520 636c 7573 7465 722c 2074 6865  the cluster, the
-00013ec0: 6e20 7468 6520 636c 6965 6e74 2077 696c  n the client wil
-00013ed0: 6c20 7261 6973 6520 616e 2065 7863 6570  l raise an excep
-00013ee0: 7469 6f6e 2e20 5369 6d69 6c61 726c 792c  tion. Similarly,
-00013ef0: 2069 6620 7468 650a 636c 6965 6e74 2773   if the.client's
-00013f00: 206e 6f64 6520 7072 6566 6572 656e 6365   node preference
-00013f10: 2069 7320 2272 6561 646f 6e6c 7972 6570   is "readonlyrep
-00013f20: 6c69 6361 2220 616e 6420 7468 6572 6520  lica" and there 
-00013f30: 6172 6520 6e6f 2072 6561 642d 6f6e 6c79  are no read-only
-00013f40: 2072 6570 6c69 6361 0a6e 6f64 6573 2069   replica.nodes i
-00013f50: 6e20 7468 6520 636c 7573 7465 722c 2074  n the cluster, t
-00013f60: 6865 6e20 7468 6520 636c 6965 6e74 2077  hen the client w
-00013f70: 696c 6c20 616c 736f 2072 6169 7365 2061  ill also raise a
-00013f80: 6e20 6578 6365 7074 696f 6e2e 0a0a 5468  n exception...Th
-00013f90: 6520 6752 5043 2063 6861 6e6e 656c 206f  e gRPC channel o
-00013fa0: 7074 696f 6e20 2267 7270 632e 6d61 785f  ption "grpc.max_
-00013fb0: 7265 6365 6976 655f 6d65 7373 6167 655f  receive_message_
-00013fc0: 6c65 6e67 7468 2220 6973 2061 7574 6f6d  length" is autom
-00013fd0: 6174 6963 616c 6c79 0a63 6f6e 6669 6775  atically.configu
-00013fe0: 7265 6420 746f 2074 6865 2076 616c 7565  red to the value
-00013ff0: 2060 3137 202a 2031 3032 3420 2a20 3130   `17 * 1024 * 10
-00014000: 3234 602e 2054 6869 7320 7661 6c75 6520  24`. This value 
-00014010: 6361 6e6e 6f74 2062 6520 6368 616e 6765  cannot be change
-00014020: 642e 0a0a 0a23 2323 2052 6567 756c 6172  d....### Regular
-00014030: 2065 7870 7265 7373 696f 6e20 6669 6c74   expression filt
-00014040: 6572 730a 0a54 6865 2066 696c 7465 7220  ers..The filter 
-00014050: 6172 6775 6d65 6e74 7320 696e 2060 7265  arguments in `re
-00014060: 6164 5f61 6c6c 5f65 7665 6e74 7328 2960  ad_all_events()`
-00014070: 2c20 6073 7562 7363 7269 6265 5f61 6c6c  , `subscribe_all
-00014080: 5f65 7665 6e74 7328 2960 2c0a 6063 7265  _events()`,.`cre
-00014090: 6174 655f 7375 6273 6372 6970 7469 6f6e  ate_subscription
-000140a0: 2829 6020 616e 6420 6067 6574 5f63 6f6d  ()` and `get_com
-000140b0: 6d69 745f 706f 7369 7469 6f6e 2829 6020  mit_position()` 
-000140c0: 6172 6520 6170 706c 6965 6420 746f 2074  are applied to t
-000140d0: 6865 2060 7479 7065 600a 6174 7472 6962  he `type`.attrib
-000140e0: 7574 6520 6f66 2072 6563 6f72 6465 6420  ute of recorded 
-000140f0: 6576 656e 7473 2e0a 0a54 6865 2064 6566  events...The def
-00014100: 6175 6c74 2076 616c 7565 206f 6620 7468  ault value of th
-00014110: 6520 6066 696c 7465 725f 6578 636c 7564  e `filter_exclud
-00014120: 6560 2061 7267 756d 656e 7473 2069 7320  e` arguments is 
-00014130: 6465 7369 676e 6564 2074 6f20 6578 636c  designed to excl
-00014140: 7564 650a 4576 656e 7453 746f 7265 4442  ude.EventStoreDB
-00014150: 2022 7379 7374 656d 2220 616e 6420 2270   "system" and "p
-00014160: 6572 7369 7374 656e 6365 2073 7562 7363  ersistence subsc
-00014170: 7269 7074 696f 6e20 636f 6e66 6967 2220  ription config" 
-00014180: 6576 656e 7473 2c20 7768 6963 680a 6f74  events, which.ot
-00014190: 6865 7277 6973 6520 776f 756c 6420 6265  herwise would be
-000141a0: 2069 6e63 6c75 6465 642e 2053 7973 7465   included. Syste
-000141b0: 6d20 6576 656e 7473 2067 656e 6572 6174  m events generat
-000141c0: 6564 2062 7920 4576 656e 7453 746f 7265  ed by EventStore
-000141d0: 4442 2061 6c6c 0a68 6176 6520 6074 7970  DB all.have `typ
-000141e0: 6560 2073 7472 696e 6773 2074 6861 7420  e` strings that 
-000141f0: 7374 6172 7420 7769 7468 2074 6865 2060  start with the `
-00014200: 2460 2073 6967 6e2e 2050 6572 7369 7374  $` sign. Persist
-00014210: 656e 6365 2073 7562 7363 7269 7074 696f  ence subscriptio
-00014220: 6e0a 6576 656e 7473 2067 656e 6572 6174  n.events generat
-00014230: 6564 2077 6865 6e20 6d61 6e69 7075 6c61  ed when manipula
-00014240: 7469 6e67 2070 6572 7369 7374 656e 6365  ting persistence
-00014250: 2073 7562 7363 7269 7074 696f 6e73 2061   subscriptions a
-00014260: 6c6c 2068 6176 6520 6074 7970 6560 0a73  ll have `type`.s
-00014270: 7472 696e 6773 2074 6861 7420 7374 6172  trings that star
-00014280: 7420 7769 7468 2060 5065 7273 6973 7465  t with `Persiste
-00014290: 6e74 436f 6e66 6967 602e 0a0a 466f 7220  ntConfig`...For 
-000142a0: 6578 616d 706c 652c 2074 6f20 6d61 7463  example, to matc
-000142b0: 6820 7468 6520 7479 7065 206f 6620 4576  h the type of Ev
-000142c0: 656e 7453 746f 7265 4442 2073 7973 7465  entStoreDB syste
-000142d0: 6d20 6576 656e 7473 2c20 7573 6520 7468  m events, use th
-000142e0: 6520 7265 6775 6c61 720a 6578 7072 6573  e regular.expres
-000142f0: 7369 6f6e 2060 7227 5c24 2e2b 2760 2e20  sion `r'\$.+'`. 
-00014300: 506c 6561 7365 206e 6f74 652c 2074 6865  Please note, the
-00014310: 2063 6f6e 7374 616e 7420 6045 5344 425f   constant `ESDB_
-00014320: 5359 5354 454d 5f45 5645 4e54 535f 5245  SYSTEM_EVENTS_RE
-00014330: 4745 5860 2069 730a 7365 7420 746f 2060  GEX` is.set to `
-00014340: 7227 5c24 2e2b 2760 2e20 596f 7520 6361  r'\$.+'`. You ca
-00014350: 6e20 696d 706f 7274 2074 6869 7320 7661  n import this va
-00014360: 6c75 650a 2860 6672 6f6d 2065 7364 6263  lue.(`from esdbc
-00014370: 6c69 656e 7420 696d 706f 7274 2045 5344  lient import ESD
-00014380: 425f 5359 5354 454d 5f45 5645 4e54 535f  B_SYSTEM_EVENTS_
-00014390: 5245 4745 5860 2920 616e 6420 7573 650a  REGEX`) and use.
-000143a0: 6974 2077 6865 6e20 6275 696c 6469 6e67  it when building
-000143b0: 206c 6f6e 6765 7220 7365 7175 656e 6365   longer sequence
-000143c0: 7320 6f66 2072 6567 756c 6172 2065 7870  s of regular exp
-000143d0: 7265 7373 696f 6e73 2e0a 0a53 696d 696c  ressions...Simil
-000143e0: 6172 6c79 2c20 746f 206d 6174 6368 2074  arly, to match t
-000143f0: 6865 2074 7970 6520 6f66 2045 7665 6e74  he type of Event
-00014400: 5374 6f72 6544 4220 7065 7273 6973 7465  StoreDB persiste
-00014410: 6e63 6520 7375 6273 6372 6970 7469 6f6e  nce subscription
-00014420: 2065 7665 6e74 732c 2075 7365 2074 6865   events, use the
-00014430: 0a72 6567 756c 6172 2065 7870 7265 7373  .regular express
-00014440: 696f 6e20 6072 2750 6572 7369 7374 656e  ion `r'Persisten
-00014450: 7443 6f6e 6669 675c 642b 2760 2e20 5468  tConfig\d+'`. Th
-00014460: 6520 636f 6e73 7461 6e74 2060 4553 4442  e constant `ESDB
-00014470: 5f50 4552 5349 5354 454e 545f 434f 4e46  _PERSISTENT_CONF
-00014480: 4947 5f45 5645 4e54 535f 5245 4745 5860  IG_EVENTS_REGEX`
-00014490: 0a69 7320 7365 7420 746f 2060 7227 5065  .is set to `r'Pe
-000144a0: 7273 6973 7465 6e74 436f 6e66 6967 5c64  rsistentConfig\d
-000144b0: 2b27 602e 2059 6f75 2063 616e 2061 6c73  +'`. You can als
-000144c0: 6f20 696d 706f 7274 2074 6869 7320 7661  o import this va
-000144d0: 6c75 650a 2860 6672 6f6d 2065 7364 6263  lue.(`from esdbc
-000144e0: 6c69 656e 7420 696d 706f 7274 2045 5344  lient import ESD
-000144f0: 425f 5045 5253 4953 5445 4e54 5f43 4f4e  B_PERSISTENT_CON
-00014500: 4649 475f 4556 454e 5453 5f52 4547 4558  FIG_EVENTS_REGEX
-00014510: 6029 2061 6e64 2075 7365 2069 7420 7768  `) and use it wh
-00014520: 656e 2062 7569 6c64 696e 670a 6c6f 6e67  en building.long
-00014530: 6572 2073 6571 7565 6e63 6573 206f 6620  er sequences of 
-00014540: 7265 6775 6c61 7220 6578 7072 6573 7369  regular expressi
-00014550: 6f6e 732e 0a0a 5468 6520 636f 6e73 7461  ons...The consta
-00014560: 6e74 2060 4445 4641 554c 545f 4558 434c  nt `DEFAULT_EXCL
-00014570: 5544 455f 4649 4c54 4552 6020 6973 2061  UDE_FILTER` is a
-00014580: 2073 6571 7565 6e63 6520 6f66 2072 6567   sequence of reg
-00014590: 756c 6172 2065 7870 7265 7373 696f 6e73  ular expressions
-000145a0: 2074 6861 7420 6d61 7463 680a 7468 6520   that match.the 
-000145b0: 6576 656e 7473 2074 6861 7420 4576 656e  events that Even
-000145c0: 7453 746f 7265 4442 2067 656e 6572 6174  tStoreDB generat
-000145d0: 6573 2069 6e74 6572 6e61 6c6c 792c 2065  es internally, e
-000145e0: 7665 6e74 7320 7468 6174 2061 7265 2065  vents that are e
-000145f0: 7874 7261 6e65 6f75 7320 746f 2074 686f  xtraneous to tho
-00014600: 7365 0a77 6869 6368 2079 6f75 2061 7070  se.which you app
-00014610: 656e 6420 7573 696e 6720 7468 6520 6061  end using the `a
-00014620: 7070 656e 645f 6576 656e 7473 2829 6020  ppend_events()` 
-00014630: 6d65 7468 6f64 2e0a 0a46 6f72 2065 7861  method...For exa
-00014640: 6d70 6c65 2c20 746f 2065 7863 6c75 6465  mple, to exclude
-00014650: 2073 7973 7465 6d20 6576 656e 7473 2061   system events a
-00014660: 6e64 2070 6572 7369 7374 656e 6365 2073  nd persistence s
-00014670: 7562 7363 7269 7074 696f 6e20 636f 6e66  ubscription conf
-00014680: 6967 7572 6174 696f 6e20 6576 656e 7473  iguration events
-00014690: 2c0a 616e 6420 736e 6170 7368 6f74 732c  ,.and snapshots,
-000146a0: 2079 6f75 206d 6967 6874 2075 7365 2074   you might use t
-000146b0: 6865 2073 6571 7565 6e63 6520 6044 4546  he sequence `DEF
-000146c0: 4155 4c54 5f45 5843 4c55 4445 5f46 494c  AULT_EXCLUDE_FIL
-000146d0: 5445 5220 2b20 5b27 2e2a 536e 6170 7368  TER + ['.*Snapsh
-000146e0: 6f74 275d 6020 6173 0a74 6865 2076 616c  ot']` as.the val
-000146f0: 7565 206f 6620 7468 6520 6066 696c 7465  ue of the `filte
-00014700: 725f 6578 636c 7564 6560 2061 7267 756d  r_exclude` argum
-00014710: 656e 7420 7768 656e 2063 616c 6c69 6e67  ent when calling
-00014720: 2060 7265 6164 5f61 6c6c 5f65 7665 6e74   `read_all_event
-00014730: 7328 2960 2c0a 6073 7562 7363 7269 6265  s()`,.`subscribe
-00014740: 5f61 6c6c 5f65 7665 6e74 7328 2960 2c20  _all_events()`, 
-00014750: 6063 7265 6174 655f 7375 6273 6372 6970  `create_subscrip
-00014760: 7469 6f6e 2829 6020 6f72 2060 6765 745f  tion()` or `get_
-00014770: 636f 6d6d 6974 5f70 6f73 6974 696f 6e28  commit_position(
-00014780: 2960 2e0a 0a23 2323 204e 6577 2065 7665  )`...### New eve
-00014790: 6e74 206f 626a 6563 7473 0a0a 5468 6520  nt objects..The 
-000147a0: 604e 6577 4576 656e 7460 2063 6c61 7373  `NewEvent` class
-000147b0: 2069 7320 7573 6564 2077 6865 6e20 6170   is used when ap
-000147c0: 7065 6e64 696e 6720 6576 656e 7473 2e0a  pending events..
-000147d0: 0a54 6865 2072 6571 7569 7265 6420 6172  .The required ar
-000147e0: 6775 6d65 6e74 2060 7479 7065 6020 6973  gument `type` is
-000147f0: 2061 2050 7974 686f 6e20 6073 7472 602c   a Python `str`,
-00014800: 2075 7365 6420 746f 2069 6e64 6963 6174   used to indicat
-00014810: 6520 7468 6520 7479 7065 206f 660a 7468  e the type of.th
-00014820: 6520 6576 656e 7420 7468 6174 2077 696c  e event that wil
-00014830: 6c20 6265 2072 6563 6f72 6465 642e 0a0a  l be recorded...
-00014840: 5468 6520 7265 7175 6972 6564 2061 7267  The required arg
-00014850: 756d 656e 7420 6064 6174 6160 2069 7320  ument `data` is 
-00014860: 6120 5079 7468 6f6e 2060 6279 7465 7360  a Python `bytes`
-00014870: 206f 626a 6563 742c 2075 7365 6420 746f   object, used to
-00014880: 2069 6e64 6963 6174 6520 7468 6520 6461   indicate the da
-00014890: 7461 206f 660a 7468 6520 6576 656e 7420  ta of.the event 
-000148a0: 7468 6174 2077 696c 6c20 6265 2072 6563  that will be rec
-000148b0: 6f72 6465 642e 0a0a 5468 6520 6f70 7469  orded...The opti
-000148c0: 6f6e 616c 2061 7267 756d 656e 7420 606d  onal argument `m
-000148d0: 6574 6164 6174 6160 2069 7320 6120 5079  etadata` is a Py
-000148e0: 7468 6f6e 2060 6279 7465 7360 206f 626a  thon `bytes` obj
-000148f0: 6563 742c 2075 7365 6420 746f 2069 6e64  ect, used to ind
-00014900: 6963 6174 6520 616e 790a 6d65 7461 6461  icate any.metada
-00014910: 7461 206f 6620 7468 6520 6576 656e 7420  ta of the event 
-00014920: 7468 6174 2077 696c 6c20 6265 2072 6563  that will be rec
-00014930: 6f72 6465 642e 2054 6865 2064 6566 6175  orded. The defau
-00014940: 6c74 2076 616c 7565 2069 7320 616e 2065  lt value is an e
-00014950: 6d70 7479 2060 6279 7465 7360 0a6f 626a  mpty `bytes`.obj
-00014960: 6563 742e 0a0a 5468 6520 6f70 7469 6f6e  ect...The option
-00014970: 616c 2061 7267 756d 656e 7420 6063 6f6e  al argument `con
-00014980: 7465 6e74 5f74 7970 6560 2069 7320 6120  tent_type` is a 
-00014990: 5079 7468 6f6e 2060 7374 7260 2c20 7573  Python `str`, us
-000149a0: 6564 2074 6f20 696e 6469 6361 7465 2074  ed to indicate t
-000149b0: 6865 0a74 7970 6520 6f66 2074 6865 2064  he.type of the d
-000149c0: 6174 6120 7468 6174 2077 696c 6c20 6265  ata that will be
-000149d0: 2072 6563 6f72 6465 6420 666f 7220 7468   recorded for th
-000149e0: 6973 2065 7665 6e74 2e20 5468 6520 6465  is event. The de
-000149f0: 6661 756c 7420 7661 6c75 6520 6973 0a60  fault value is.`
-00014a00: 6170 706c 6963 6174 696f 6e2f 6a73 6f6e  application/json
-00014a10: 602c 2077 6869 6368 2069 6e64 6963 6174  `, which indicat
-00014a20: 6573 2074 6861 7420 7468 6520 6064 6174  es that the `dat
-00014a30: 6160 2077 6173 2073 6572 6961 6c69 7365  a` was serialise
-00014a40: 6420 7573 696e 6720 4a53 4f4e 2e0a 416e  d using JSON..An
-00014a50: 2061 6c74 6572 6e61 7469 7665 2076 616c   alternative val
-00014a60: 7565 2066 6f72 2074 6869 7320 6172 6775  ue for this argu
-00014a70: 6d65 6e74 2069 7320 6061 7070 6c69 6361  ment is `applica
-00014a80: 7469 6f6e 2f6f 6374 6574 2d73 7472 6561  tion/octet-strea
-00014a90: 6d60 2e0a 0a54 6865 206f 7074 696f 6e61  m`...The optiona
-00014aa0: 6c20 6172 6775 6d65 6e74 2060 6964 6020  l argument `id` 
-00014ab0: 6973 2061 2050 7974 686f 6e20 6055 5549  is a Python `UUI
-00014ac0: 4460 206f 626a 6563 742c 2075 7365 6420  D` object, used 
-00014ad0: 746f 2073 7065 6369 6679 2074 6865 2075  to specify the u
-00014ae0: 6e69 7175 6520 4944 0a6f 6620 7468 6520  nique ID.of the 
-00014af0: 6576 656e 7420 7468 6174 2077 696c 6c20  event that will 
-00014b00: 6265 2072 6563 6f72 6465 642e 2054 6869  be recorded. Thi
-00014b10: 7320 7661 6c75 6520 7769 6c6c 2064 6566  s value will def
-00014b20: 6175 6c74 2074 6f20 6120 6e65 7720 7665  ault to a new ve
-00014b30: 7273 696f 6e2d 3420 5555 4944 2e0a 0a60  rsion-4 UUID...`
-00014b40: 6060 7079 7468 6f6e 0a6e 6577 5f65 7665  ``python.new_eve
-00014b50: 6e74 3120 3d20 4e65 7745 7665 6e74 280a  nt1 = NewEvent(.
-00014b60: 2020 2020 7479 7065 3d27 4f72 6465 7243      type='OrderC
-00014b70: 7265 6174 6564 272c 0a20 2020 2064 6174  reated',.    dat
-00014b80: 613d 6227 7b22 6e61 6d65 223a 2022 4772  a=b'{"name": "Gr
-00014b90: 6567 227d 272c 0a29 0a61 7373 6572 7420  eg"}',.).assert 
-00014ba0: 6e65 775f 6576 656e 7431 2e74 7970 6520  new_event1.type 
-00014bb0: 3d3d 2027 4f72 6465 7243 7265 6174 6564  == 'OrderCreated
-00014bc0: 270a 6173 7365 7274 206e 6577 5f65 7665  '.assert new_eve
-00014bd0: 6e74 312e 6461 7461 203d 3d20 6227 7b22  nt1.data == b'{"
-00014be0: 6e61 6d65 223a 2022 4772 6567 227d 270a  name": "Greg"}'.
-00014bf0: 6173 7365 7274 206e 6577 5f65 7665 6e74  assert new_event
-00014c00: 312e 6d65 7461 6461 7461 203d 3d20 6227  1.metadata == b'
-00014c10: 270a 6173 7365 7274 206e 6577 5f65 7665  '.assert new_eve
-00014c20: 6e74 312e 636f 6e74 656e 745f 7479 7065  nt1.content_type
-00014c30: 203d 3d20 2761 7070 6c69 6361 7469 6f6e   == 'application
-00014c40: 2f6a 736f 6e27 0a61 7373 6572 7420 6973  /json'.assert is
-00014c50: 696e 7374 616e 6365 286e 6577 5f65 7665  instance(new_eve
-00014c60: 6e74 312e 6964 2c20 5555 4944 290a 0a65  nt1.id, UUID)..e
-00014c70: 7665 6e74 5f69 6420 3d20 7575 6964 3428  vent_id = uuid4(
-00014c80: 290a 6e65 775f 6576 656e 7432 203d 204e  ).new_event2 = N
-00014c90: 6577 4576 656e 7428 0a20 2020 2074 7970  ewEvent(.    typ
-00014ca0: 653d 2749 6d61 6765 4372 6561 7465 6427  e='ImageCreated'
-00014cb0: 2c0a 2020 2020 6461 7461 3d62 2730 3130  ,.    data=b'010
-00014cc0: 3130 3130 3130 3130 3130 3127 2c0a 2020  10101010101',.  
-00014cd0: 2020 6d65 7461 6461 7461 3d62 277b 2261    metadata=b'{"a
-00014ce0: 223a 2031 7d27 2c0a 2020 2020 636f 6e74  ": 1}',.    cont
-00014cf0: 656e 745f 7479 7065 3d27 6170 706c 6963  ent_type='applic
-00014d00: 6174 696f 6e2f 6f63 7465 742d 7374 7265  ation/octet-stre
-00014d10: 616d 272c 0a20 2020 2069 643d 6576 656e  am',.    id=even
-00014d20: 745f 6964 2c0a 290a 6173 7365 7274 206e  t_id,.).assert n
-00014d30: 6577 5f65 7665 6e74 322e 7479 7065 203d  ew_event2.type =
-00014d40: 3d20 2749 6d61 6765 4372 6561 7465 6427  = 'ImageCreated'
-00014d50: 0a61 7373 6572 7420 6e65 775f 6576 656e  .assert new_even
-00014d60: 7432 2e64 6174 6120 3d3d 2062 2730 3130  t2.data == b'010
-00014d70: 3130 3130 3130 3130 3130 3127 0a61 7373  10101010101'.ass
-00014d80: 6572 7420 6e65 775f 6576 656e 7432 2e6d  ert new_event2.m
-00014d90: 6574 6164 6174 6120 3d3d 2062 277b 2261  etadata == b'{"a
-00014da0: 223a 2031 7d27 0a61 7373 6572 7420 6e65  ": 1}'.assert ne
-00014db0: 775f 6576 656e 7432 2e63 6f6e 7465 6e74  w_event2.content
-00014dc0: 5f74 7970 6520 3d3d 2027 6170 706c 6963  _type == 'applic
-00014dd0: 6174 696f 6e2f 6f63 7465 742d 7374 7265  ation/octet-stre
-00014de0: 616d 270a 6173 7365 7274 206e 6577 5f65  am'.assert new_e
-00014df0: 7665 6e74 322e 6964 203d 3d20 6576 656e  vent2.id == even
-00014e00: 745f 6964 0a60 6060 0a0a 2323 2320 5265  t_id.```..### Re
-00014e10: 636f 7264 6564 2065 7665 6e74 206f 626a  corded event obj
-00014e20: 6563 7473 0a0a 5468 6520 6052 6563 6f72  ects..The `Recor
-00014e30: 6465 6445 7665 6e74 6020 636c 6173 7320  dedEvent` class 
-00014e40: 6973 2075 7365 6420 7768 656e 2072 6561  is used when rea
-00014e50: 6469 6e67 2065 7665 6e74 732e 0a0a 5468  ding events...Th
-00014e60: 6520 6174 7472 6962 7574 6520 6074 7970  e attribute `typ
-00014e70: 6560 2069 7320 6120 5079 7468 6f6e 2060  e` is a Python `
-00014e80: 7374 7260 2c20 7573 6564 2074 6f20 696e  str`, used to in
-00014e90: 6469 6361 7465 2074 6865 2074 7970 6520  dicate the type 
-00014ea0: 6f66 2065 7665 6e74 0a74 6861 7420 7761  of event.that wa
-00014eb0: 7320 7265 636f 7264 6564 2e0a 0a54 6865  s recorded...The
-00014ec0: 2061 7474 7269 6275 7465 2060 6461 7461   attribute `data
-00014ed0: 6020 6973 2061 2050 7974 686f 6e20 6062  ` is a Python `b
-00014ee0: 7974 6573 6020 6f62 6a65 6374 2c20 7573  ytes` object, us
-00014ef0: 6564 2074 6f20 696e 6469 6361 7465 2074  ed to indicate t
-00014f00: 6865 2064 6174 6120 6f66 2074 6865 0a65  he data of the.e
-00014f10: 7665 6e74 2074 6861 7420 7761 7320 7265  vent that was re
-00014f20: 636f 7264 6564 2e0a 0a54 6865 2061 7474  corded...The att
-00014f30: 7269 6275 7465 2060 6d65 7461 6461 7461  ribute `metadata
-00014f40: 6020 6973 2061 2050 7974 686f 6e20 6062  ` is a Python `b
-00014f50: 7974 6573 6020 6f62 6a65 6374 2c20 7573  ytes` object, us
-00014f60: 6564 2074 6f20 696e 6469 6361 7465 2074  ed to indicate t
-00014f70: 6865 206d 6574 6164 6174 6120 6f66 0a74  he metadata of.t
-00014f80: 6865 2065 7665 6e74 2074 6861 7420 7761  he event that wa
-00014f90: 7320 7265 636f 7264 6564 2e0a 0a54 6865  s recorded...The
-00014fa0: 2061 7474 7269 6275 7465 2060 636f 6e74   attribute `cont
-00014fb0: 656e 745f 7479 7065 6020 6973 2061 2050  ent_type` is a P
-00014fc0: 7974 686f 6e20 6073 7472 602c 2075 7365  ython `str`, use
-00014fd0: 6420 746f 2069 6e64 6963 6174 6520 7468  d to indicate th
-00014fe0: 6520 7479 7065 206f 660a 6461 7461 2074  e type of.data t
-00014ff0: 6861 7420 7761 7320 7265 636f 7264 6564  hat was recorded
-00015000: 2066 6f72 2074 6869 7320 6576 656e 7420   for this event 
-00015010: 2875 7375 616c 6c79 2060 6170 706c 6963  (usually `applic
-00015020: 6174 696f 6e2f 6a73 6f6e 6020 746f 2069  ation/json` to i
-00015030: 6e64 6963 6174 6520 7468 6174 0a74 6869  ndicate that.thi
-00015040: 7320 6461 7461 2063 616e 2062 6520 7061  s data can be pa
-00015050: 7273 6564 2061 7320 4a53 4f4e 2c20 6275  rsed as JSON, bu
-00015060: 7420 616c 7465 726e 6174 6976 656c 7920  t alternatively 
-00015070: 6061 7070 6c69 6361 7469 6f6e 2f6f 6374  `application/oct
-00015080: 6574 2d73 7472 6561 6d60 2074 6f0a 696e  et-stream` to.in
-00015090: 6469 6361 7465 2074 6861 7420 6974 2069  dicate that it i
-000150a0: 7320 736f 6d65 7468 696e 6720 656c 7365  s something else
-000150b0: 292e 0a0a 5468 6520 6174 7472 6962 7574  )...The attribut
-000150c0: 6520 6069 6460 2069 7320 6120 5079 7468  e `id` is a Pyth
-000150d0: 6f6e 2060 5555 4944 6020 6f62 6a65 6374  on `UUID` object
-000150e0: 2c20 7573 6564 2074 6f20 696e 6469 6361  , used to indica
-000150f0: 7465 2074 6865 2075 6e69 7175 6520 4944  te the unique ID
-00015100: 206f 6620 7468 650a 6576 656e 7420 7468   of the.event th
-00015110: 6174 2077 6173 2072 6563 6f72 6465 642e  at was recorded.
-00015120: 2050 6c65 6173 6520 6e6f 7465 2c20 7768   Please note, wh
-00015130: 656e 2072 6563 6f72 6465 6420 6576 656e  en recorded even
-00015140: 7473 2061 7265 2072 6574 7572 6e65 6420  ts are returned 
-00015150: 6672 6f6d 2061 2063 616c 6c0a 746f 2060  from a call.to `
-00015160: 7265 6164 5f73 7472 6561 6d5f 6576 656e  read_stream_even
-00015170: 7473 2829 6020 696e 2045 7665 6e74 5374  ts()` in EventSt
-00015180: 6f72 6544 4220 7632 312e 3130 2c20 7468  oreDB v21.10, th
-00015190: 6520 636f 6d6d 6974 2070 6f73 6974 696f  e commit positio
-000151a0: 6e20 6973 206e 6f74 2061 6374 7561 6c6c  n is not actuall
-000151b0: 790a 7365 7420 696e 2074 6865 2072 6573  y.set in the res
-000151c0: 706f 6e73 652e 2054 6869 7320 6174 7472  ponse. This attr
-000151d0: 6962 7574 6520 6973 2074 7970 6564 2061  ibute is typed a
-000151e0: 7320 616e 206f 7074 696f 6e61 6c20 7661  s an optional va
-000151f0: 6c75 6520 2860 4f70 7469 6f6e 616c 5b55  lue (`Optional[U
-00015200: 5549 445d 6029 2c0a 616e 6420 696e 2074  UID]`),.and in t
-00015210: 6865 2063 6173 6520 6f66 2075 7369 6e67  he case of using
-00015220: 2045 7665 6e74 5374 6f72 6544 4220 7632   EventStoreDB v2
-00015230: 312e 3130 2074 6865 2076 616c 7565 206f  1.10 the value o
-00015240: 6620 7468 6973 2061 7474 7269 6275 7465  f this attribute
-00015250: 2077 696c 6c20 6265 2060 4e6f 6e65 600a   will be `None`.
-00015260: 7768 656e 2072 6561 6469 6e67 2072 6563  when reading rec
-00015270: 6f72 6465 6420 6576 656e 7473 2066 726f  orded events fro
-00015280: 6d20 6120 7374 7265 616d 2e20 5265 636f  m a stream. Reco
-00015290: 7264 6564 2065 7665 6e74 7320 7769 6c6c  rded events will
-000152a0: 2068 6f77 6576 6572 2068 6176 6520 7468   however have th
-000152b0: 6973 0a76 616c 7565 7320 7365 7420 7768  is.values set wh
-000152c0: 656e 2072 6561 6469 6e67 2072 6563 6f72  en reading recor
-000152d0: 6465 6420 6576 656e 7473 2066 726f 6d20  ded events from 
-000152e0: 6072 6561 645f 616c 6c5f 6576 656e 7473  `read_all_events
-000152f0: 2829 6020 616e 6420 6672 6f6d 2062 6f74  ()` and from bot
-00015300: 680a 6361 7463 682d 7570 2061 6e64 2070  h.catch-up and p
-00015310: 6572 7369 7374 656e 7420 7375 6273 6372  ersistent subscr
-00015320: 6970 7469 6f6e 732e 0a0a 5468 6520 6174  iptions...The at
-00015330: 7472 6962 7574 6520 6073 7472 6561 6d5f  tribute `stream_
-00015340: 6e61 6d65 6020 6973 2061 2050 7974 686f  name` is a Pytho
-00015350: 6e20 6073 7472 602c 2075 7365 6420 746f  n `str`, used to
-00015360: 2069 6e64 6963 6174 6520 7468 6520 6e61   indicate the na
-00015370: 6d65 206f 6620 7468 650a 7374 7265 616d  me of the.stream
-00015380: 2069 6e20 7768 6963 6820 7468 6520 6576   in which the ev
-00015390: 656e 7420 7761 7320 7265 636f 7264 6564  ent was recorded
-000153a0: 2e0a 0a54 6865 2061 7474 7269 6275 7465  ...The attribute
-000153b0: 2060 7374 7265 616d 5f70 6f73 6974 696f   `stream_positio
-000153c0: 6e60 2069 7320 6120 5079 7468 6f6e 2060  n` is a Python `
-000153d0: 696e 7460 2c20 7573 6564 2074 6f20 696e  int`, used to in
-000153e0: 6469 6361 7465 2074 6865 2070 6f73 6974  dicate the posit
-000153f0: 696f 6e20 696e 2074 6865 0a73 7472 6561  ion in the.strea
-00015400: 6d20 6174 2077 6869 6368 2074 6865 2065  m at which the e
-00015410: 7665 6e74 2077 6173 2072 6563 6f72 6465  vent was recorde
-00015420: 642e 0a0a 5468 6520 6174 7472 6962 7574  d...The attribut
-00015430: 6520 6063 6f6d 6d69 745f 706f 7369 7469  e `commit_positi
-00015440: 6f6e 6020 6973 2061 2050 7974 686f 6e20  on` is a Python 
-00015450: 6069 6e74 602c 2075 7365 6420 746f 2069  `int`, used to i
-00015460: 6e64 6963 6174 6520 7468 6520 636f 6d6d  ndicate the comm
-00015470: 6974 2070 6f73 6974 696f 6e0a 6174 2077  it position.at w
-00015480: 6869 6368 2074 6865 2065 7665 6e74 2077  hich the event w
-00015490: 6173 2072 6563 6f72 6465 642e 0a0a 6060  as recorded...``
-000154a0: 6070 7974 686f 6e0a 6672 6f6d 2065 7364  `python.from esd
-000154b0: 6263 6c69 656e 742e 6576 656e 7473 2069  bclient.events i
-000154c0: 6d70 6f72 7420 5265 636f 7264 6564 4576  mport RecordedEv
-000154d0: 656e 740a 0a72 6563 6f72 6465 645f 6576  ent..recorded_ev
-000154e0: 656e 7420 3d20 5265 636f 7264 6564 4576  ent = RecordedEv
-000154f0: 656e 7428 0a20 2020 2074 7970 653d 274f  ent(.    type='O
-00015500: 7264 6572 4372 6561 7465 6427 2c0a 2020  rderCreated',.  
-00015510: 2020 6461 7461 3d62 277b 7d27 2c0a 2020    data=b'{}',.  
-00015520: 2020 6d65 7461 6461 7461 3d62 2727 2c0a    metadata=b'',.
-00015530: 2020 2020 636f 6e74 656e 745f 7479 7065      content_type
-00015540: 3d27 6170 706c 6963 6174 696f 6e2f 6a73  ='application/js
-00015550: 6f6e 272c 0a20 2020 2069 643d 7575 6964  on',.    id=uuid
-00015560: 3428 292c 0a20 2020 2073 7472 6561 6d5f  4(),.    stream_
-00015570: 6e61 6d65 3d27 7374 7265 616d 3127 2c0a  name='stream1',.
-00015580: 2020 2020 7374 7265 616d 5f70 6f73 6974      stream_posit
-00015590: 696f 6e3d 302c 0a20 2020 2063 6f6d 6d69  ion=0,.    commi
-000155a0: 745f 706f 7369 7469 6f6e 3d35 3132 2c0a  t_position=512,.
-000155b0: 290a 6060 600a 0a23 2323 2041 7379 6e63  ).```..### Async
-000155c0: 696f 2063 6c69 656e 740a 0a54 6865 2060  io client..The `
-000155d0: 6573 6462 636c 6965 6e74 6020 7061 636b  esdbclient` pack
-000155e0: 6167 6520 616c 736f 2069 6e63 6c75 6465  age also include
-000155f0: 7320 616e 2065 6172 6c79 2076 6572 7369  s an early versi
-00015600: 6f6e 206f 6620 616e 2061 7379 6e63 6872  on of an asynchr
-00015610: 6f6e 6f75 7320 492f 4f0a 6752 5043 2050  onous I/O.gRPC P
-00015620: 7974 686f 6e20 636c 6965 6e74 2e20 4974  ython client. It
-00015630: 2066 6f6c 6c6f 7773 2065 7861 6374 6c79   follows exactly
-00015640: 2074 6865 2073 616d 6520 6265 6861 7669   the same behavi
-00015650: 6f72 7320 6173 2074 6865 206d 756c 7469  ors as the multi
-00015660: 7468 7265 6164 6564 0a60 4553 4442 436c  threaded.`ESDBCl
-00015670: 6965 6e74 602c 2062 7574 2075 7365 7320  ient`, but uses 
-00015680: 7468 6520 6067 7270 632e 6169 6f60 2070  the `grpc.aio` p
-00015690: 6163 6b61 6765 2061 6e64 2074 6865 2060  ackage and the `
-000156a0: 6173 796e 6369 6f60 206d 6f64 756c 652c  asyncio` module,
-000156b0: 2069 6e73 7465 6164 206f 660a 6067 7270   instead of.`grp
-000156c0: 6360 2061 6e64 2060 7468 7265 6164 696e  c` and `threadin
-000156d0: 6760 2e0a 0a54 6865 2060 6173 796e 6360  g`...The `async`
-000156e0: 2066 756e 6374 696f 6e20 6041 7379 6e63   function `Async
-000156f0: 696f 4553 4442 436c 6965 6e74 6020 636f  ioESDBClient` co
-00015700: 6e73 7472 7563 7473 2074 6865 2063 6c69  nstructs the cli
-00015710: 656e 742c 2061 6e64 2063 6f6e 6e65 6374  ent, and connect
-00015720: 7320 746f 0a61 2073 6572 7665 722e 2049  s to.a server. I
-00015730: 7420 6361 6e20 6265 2069 6d70 6f72 7465  t can be importe
-00015740: 6420 6672 6f6d 2060 6573 6462 636c 6965  d from `esdbclie
-00015750: 6e74 602c 2061 6e64 2063 616e 2062 6520  nt`, and can be 
-00015760: 6361 6c6c 6564 2077 6974 6820 7468 6520  called with the 
-00015770: 7361 6d65 0a61 7267 756d 656e 7473 2061  same.arguments a
-00015780: 7320 6045 5344 4243 6c69 656e 7460 2e20  s `ESDBClient`. 
-00015790: 4974 2073 7570 706f 7274 7320 626f 7468  It supports both
-000157a0: 2074 6865 2022 6573 6462 2220 616e 6420   the "esdb" and 
-000157b0: 7468 6520 2265 7364 622b 6469 7363 6f76  the "esdb+discov
-000157c0: 6572 220a 636f 6e6e 6563 7469 6f6e 2073  er".connection s
-000157d0: 7472 696e 6720 5552 4920 7363 6865 6d65  tring URI scheme
-000157e0: 732c 2061 6e64 2072 6563 6f6e 6e65 6374  s, and reconnect
-000157f0: 7320 616e 6420 7265 7472 6965 7320 6d65  s and retries me
-00015800: 7468 6f64 7320 7768 656e 2063 6f6e 6e65  thods when conne
-00015810: 6374 696f 6e0a 6973 7375 6573 2061 7265  ction.issues are
-00015820: 2065 6e63 6f75 6e74 6572 6564 2c20 6a75   encountered, ju
-00015830: 7374 206c 696b 6520 6045 5344 4243 6c69  st like `ESDBCli
-00015840: 656e 7460 2e0a 0a60 6060 7079 7468 6f6e  ent`...```python
-00015850: 0a66 726f 6d20 6573 6462 636c 6965 6e74  .from esdbclient
-00015860: 2069 6d70 6f72 7420 4173 796e 6369 6f45   import AsyncioE
-00015870: 5344 4243 6c69 656e 740a 6060 600a 0a54  SDBClient.```..T
-00015880: 6865 2061 7379 6e63 6872 6f6e 6f75 7320  he asynchronous 
-00015890: 492f 4f20 636c 6965 6e74 2068 6173 2060  I/O client has `
-000158a0: 6173 796e 6360 206d 6574 686f 6473 2060  async` methods `
-000158b0: 6170 7065 6e64 5f65 7665 6e74 7328 2960  append_events()`
-000158c0: 2c0a 6072 6561 645f 7374 7265 616d 5f65  ,.`read_stream_e
-000158d0: 7665 6e74 7328 2960 2c20 6072 6561 645f  vents()`, `read_
-000158e0: 616c 6c5f 6576 656e 7473 2829 602c 2060  all_events()`, `
-000158f0: 7375 6273 6372 6962 655f 616c 6c5f 6576  subscribe_all_ev
-00015900: 656e 7473 2829 602c 0a60 6465 6c65 7465  ents()`,.`delete
-00015910: 5f73 7472 6561 6d28 2960 2c20 6074 6f6d  _stream()`, `tom
-00015920: 6273 746f 6e65 5f73 7472 6561 6d28 2960  bstone_stream()`
-00015930: 2c20 616e 6420 6072 6563 6f6e 6e65 6374  , and `reconnect
-00015940: 2829 602e 0a0a 5468 6573 6520 6d65 7468  ()`...These meth
-00015950: 6f64 7320 6172 6520 6571 7569 7661 6c65  ods are equivale
-00015960: 6e74 2074 6f20 7468 6520 6d65 7468 6f64  nt to the method
-00015970: 7320 6f6e 2060 4553 4442 436c 6965 6e74  s on `ESDBClient
-00015980: 602e 2054 6865 7920 6861 7665 2074 6865  `. They have the
-00015990: 2073 616d 650a 6d65 7468 6f64 2073 6967   same.method sig
-000159a0: 6e61 7475 7265 732c 2061 6e64 2063 616e  natures, and can
-000159b0: 2062 6520 6361 6c6c 6564 2077 6974 6820   be called with 
-000159c0: 7468 6520 7361 6d65 2061 7267 756d 656e  the same argumen
-000159d0: 7473 2c20 746f 2074 6865 2073 616d 6520  ts, to the same 
-000159e0: 6566 6665 6374 2e0a 5468 6520 6d65 7468  effect..The meth
-000159f0: 6f64 7320 7768 6963 6820 6170 7065 6172  ods which appear
-00015a00: 206f 6e20 6045 5344 4243 6c69 656e 7460   on `ESDBClient`
-00015a10: 2062 7574 206e 6f74 206f 6e20 6041 7379   but not on `Asy
-00015a20: 6e63 696f 4553 4442 436c 6965 6e74 6020  ncioESDBClient` 
-00015a30: 7769 6c6c 2062 650a 6164 6465 6420 736f  will be.added so
-00015a40: 6f6e 2e0a 0a54 6865 2065 7861 6d70 6c65  on...The example
-00015a50: 2062 656c 6f77 2064 656d 6f6e 7374 7261   below demonstra
-00015a60: 7465 7320 7468 6520 6061 7070 656e 645f  tes the `append_
-00015a70: 6576 656e 7473 2829 602c 2060 7265 6164  events()`, `read
-00015a80: 5f73 7472 6561 6d5f 6576 656e 7473 2829  _stream_events()
-00015a90: 6020 616e 640a 6073 7562 7363 7269 6265  ` and.`subscribe
-00015aa0: 5f61 6c6c 5f65 7665 6e74 7328 2960 206d  _all_events()` m
-00015ab0: 6574 686f 6473 2e20 5468 6573 6520 6172  ethods. These ar
-00015ac0: 6520 7468 6520 6d6f 7374 2075 7365 6675  e the most usefu
-00015ad0: 6c20 6d65 7468 6f64 7320 666f 7220 7772  l methods for wr
-00015ae0: 6974 696e 670a 616e 2065 7665 6e74 2d73  iting.an event-s
-00015af0: 6f75 7263 6564 2061 7070 6c69 6361 7469  ourced applicati
-00015b00: 6f6e 2c20 616c 6c6f 7769 6e67 206e 6577  on, allowing new
-00015b10: 2061 6767 7265 6761 7465 2065 7665 6e74   aggregate event
-00015b20: 7320 746f 2062 6520 7265 636f 7264 6564  s to be recorded
-00015b30: 2c20 7468 650a 7265 636f 7264 6564 2065  , the.recorded e
-00015b40: 7665 6e74 7320 6f66 2061 6e20 6167 6772  vents of an aggr
-00015b50: 6567 6174 6520 746f 2062 6520 6f62 7461  egate to be obta
-00015b60: 696e 6564 2073 6f20 6167 6772 6567 6174  ined so aggregat
-00015b70: 6573 2063 616e 2062 6520 7265 636f 6e73  es can be recons
-00015b80: 7472 7563 7465 642c 0a61 6e64 2074 6865  tructed,.and the
-00015b90: 2073 7461 7465 206f 6620 616e 2061 7070   state of an app
-00015ba0: 6c69 6361 7469 6f6e 2074 6f20 7072 6f70  lication to prop
-00015bb0: 6167 6174 6564 2061 6e64 2070 726f 6365  agated and proce
-00015bc0: 7373 6564 2077 6974 6820 2265 7861 6374  ssed with "exact
-00015bd0: 6c79 2d6f 6e63 6522 0a73 656d 616e 7469  ly-once".semanti
-00015be0: 6373 2e0a 0a60 6060 7079 7468 6f6e 0a69  cs...```python.i
-00015bf0: 6d70 6f72 7420 6173 796e 6369 6f0a 0a61  mport asyncio..a
-00015c00: 7379 6e63 2064 6566 2064 656d 6f6e 7374  sync def demonst
-00015c10: 7261 7465 5f61 7379 6e63 696f 5f63 6c69  rate_asyncio_cli
-00015c20: 656e 7428 293a 0a0a 2020 2020 2320 436f  ent():..    # Co
-00015c30: 6e73 7472 7563 7420 636c 6965 6e74 2e0a  nstruct client..
-00015c40: 2020 2020 636c 6965 6e74 203d 2061 7761      client = awa
-00015c50: 6974 2041 7379 6e63 696f 4553 4442 436c  it AsyncioESDBCl
-00015c60: 6965 6e74 280a 2020 2020 2020 2020 7572  ient(.        ur
-00015c70: 693d 6f73 2e67 6574 656e 7628 2245 5344  i=os.getenv("ESD
-00015c80: 425f 5552 4922 292c 0a20 2020 2020 2020  B_URI"),.       
-00015c90: 2072 6f6f 745f 6365 7274 6966 6963 6174   root_certificat
-00015ca0: 6573 3d6f 732e 6765 7465 6e76 2822 4553  es=os.getenv("ES
-00015cb0: 4442 5f52 4f4f 545f 4345 5254 4946 4943  DB_ROOT_CERTIFIC
-00015cc0: 4154 4553 2229 2c0a 2020 2020 290a 0a20  ATES"),.    ).. 
-00015cd0: 2020 2023 2041 7070 656e 6420 6576 656e     # Append even
-00015ce0: 7473 2e0a 2020 2020 7374 7265 616d 5f6e  ts..    stream_n
-00015cf0: 616d 6520 3d20 7374 7228 7575 6964 3428  ame = str(uuid4(
-00015d00: 2929 0a20 2020 2065 7665 6e74 3120 3d20  )).    event1 = 
-00015d10: 4e65 7745 7665 6e74 2822 4f72 6465 7243  NewEvent("OrderC
-00015d20: 7265 6174 6564 222c 2064 6174 613d 6227  reated", data=b'
-00015d30: 7b7d 2729 0a20 2020 2065 7665 6e74 3220  {}').    event2 
-00015d40: 3d20 4e65 7745 7665 6e74 2822 4f72 6465  = NewEvent("Orde
-00015d50: 7255 7064 6174 6564 222c 2064 6174 613d  rUpdated", data=
-00015d60: 6227 7b7d 2729 0a20 2020 2065 7665 6e74  b'{}').    event
-00015d70: 3320 3d20 4e65 7745 7665 6e74 2822 4f72  3 = NewEvent("Or
-00015d80: 6465 7244 656c 6574 6564 222c 2064 6174  derDeleted", dat
-00015d90: 613d 6227 7b7d 2729 0a0a 2020 2020 6177  a=b'{}')..    aw
-00015da0: 6169 7420 636c 6965 6e74 2e61 7070 656e  ait client.appen
-00015db0: 645f 6576 656e 7473 280a 2020 2020 2020  d_events(.      
-00015dc0: 2020 7374 7265 616d 5f6e 616d 653d 7374    stream_name=st
-00015dd0: 7265 616d 5f6e 616d 652c 0a20 2020 2020  ream_name,.     
-00015de0: 2020 2065 7870 6563 7465 645f 706f 7369     expected_posi
-00015df0: 7469 6f6e 3d4e 6f6e 652c 0a20 2020 2020  tion=None,.     
-00015e00: 2020 2065 7665 6e74 733d 5b65 7665 6e74     events=[event
-00015e10: 312c 2065 7665 6e74 322c 2065 7665 6e74  1, event2, event
-00015e20: 335d 0a20 2020 2029 0a0a 2020 2020 2320  3].    )..    # 
-00015e30: 5265 6164 2073 7472 6561 6d20 6576 656e  Read stream even
-00015e40: 7473 2e0a 2020 2020 7265 636f 7264 6564  ts..    recorded
-00015e50: 203d 2061 7761 6974 2063 6c69 656e 742e   = await client.
-00015e60: 7265 6164 5f73 7472 6561 6d5f 6576 656e  read_stream_even
-00015e70: 7473 2873 7472 6561 6d5f 6e61 6d65 290a  ts(stream_name).
-00015e80: 2020 2020 6173 7365 7274 206c 656e 2872      assert len(r
-00015e90: 6563 6f72 6465 6429 203d 3d20 330a 2020  ecorded) == 3.  
-00015ea0: 2020 6173 7365 7274 2072 6563 6f72 6465    assert recorde
-00015eb0: 645b 305d 2e69 6420 3d3d 2065 7665 6e74  d[0].id == event
-00015ec0: 312e 6964 0a20 2020 2061 7373 6572 7420  1.id.    assert 
-00015ed0: 7265 636f 7264 6564 5b31 5d2e 6964 203d  recorded[1].id =
-00015ee0: 3d20 6576 656e 7432 2e69 640a 2020 2020  = event2.id.    
-00015ef0: 6173 7365 7274 2072 6563 6f72 6465 645b  assert recorded[
-00015f00: 325d 2e69 6420 3d3d 2065 7665 6e74 332e  2].id == event3.
-00015f10: 6964 0a0a 0a20 2020 2023 2053 7562 7363  id...    # Subsc
-00015f20: 7269 6265 2061 6c6c 2065 7665 6e74 732e  ribe all events.
-00015f30: 0a20 2020 2072 6563 6569 7665 6420 3d20  .    received = 
-00015f40: 5b5d 0a20 2020 2061 7379 6e63 2066 6f72  [].    async for
-00015f50: 2065 7665 6e74 2069 6e20 6177 6169 7420   event in await 
-00015f60: 636c 6965 6e74 2e73 7562 7363 7269 6265  client.subscribe
-00015f70: 5f61 6c6c 5f65 7665 6e74 7328 293a 0a20  _all_events():. 
-00015f80: 2020 2020 2020 2072 6563 6569 7665 642e         received.
-00015f90: 6170 7065 6e64 2865 7665 6e74 290a 2020  append(event).  
-00015fa0: 2020 2020 2020 6966 2065 7665 6e74 2e69        if event.i
-00015fb0: 6420 3d3d 2065 7665 6e74 332e 6964 3a0a  d == event3.id:.
-00015fc0: 2020 2020 2020 2020 2020 2020 6272 6561              brea
-00015fd0: 6b0a 2020 2020 6173 7365 7274 2072 6563  k.    assert rec
-00015fe0: 6569 7665 645b 2d33 5d2e 6964 203d 3d20  eived[-3].id == 
-00015ff0: 6576 656e 7431 2e69 640a 2020 2020 6173  event1.id.    as
-00016000: 7365 7274 2072 6563 6569 7665 645b 2d32  sert received[-2
-00016010: 5d2e 6964 203d 3d20 6576 656e 7432 2e69  ].id == event2.i
-00016020: 640a 2020 2020 6173 7365 7274 2072 6563  d.    assert rec
-00016030: 6569 7665 645b 2d31 5d2e 6964 203d 3d20  eived[-1].id == 
-00016040: 6576 656e 7433 2e69 640a 0a0a 2020 2020  event3.id...    
-00016050: 2320 436c 6f73 6520 7468 6520 636c 6965  # Close the clie
-00016060: 6e74 2e0a 2020 2020 6177 6169 7420 636c  nt..    await cl
-00016070: 6965 6e74 2e63 6c6f 7365 2829 0a0a 0a23  ient.close()...#
-00016080: 2052 756e 2074 6865 2064 656d 6f2e 0a61   Run the demo..a
-00016090: 7379 6e63 696f 2e67 6574 5f65 7665 6e74  syncio.get_event
-000160a0: 5f6c 6f6f 7028 292e 7275 6e5f 756e 7469  _loop().run_unti
-000160b0: 6c5f 636f 6d70 6c65 7465 280a 2020 2020  l_complete(.    
-000160c0: 6465 6d6f 6e73 7472 6174 655f 6173 796e  demonstrate_asyn
-000160d0: 6369 6f5f 636c 6965 6e74 2829 0a29 0a60  cio_client().).`
-000160e0: 6060 0a0a 2323 2043 6f6e 7472 6962 7574  ``..## Contribut
-000160f0: 6f72 730a 0a23 2323 2049 6e73 7461 6c6c  ors..### Install
-00016100: 2050 6f65 7472 790a 0a54 6865 2066 6972   Poetry..The fir
-00016110: 7374 2074 6869 6e67 2069 7320 746f 2063  st thing is to c
-00016120: 6865 636b 2079 6f75 2068 6176 6520 506f  heck you have Po
-00016130: 6574 7279 2069 6e73 7461 6c6c 6564 2e0a  etry installed..
-00016140: 0a20 2020 2024 2070 6f65 7472 7920 2d2d  .    $ poetry --
-00016150: 7665 7273 696f 6e0a 0a49 6620 796f 7520  version..If you 
-00016160: 646f 6e27 742c 2074 6865 6e20 706c 6561  don't, then plea
-00016170: 7365 205b 696e 7374 616c 6c20 506f 6574  se [install Poet
-00016180: 7279 5d28 6874 7470 733a 2f2f 7079 7468  ry](https://pyth
-00016190: 6f6e 2d70 6f65 7472 792e 6f72 672f 646f  on-poetry.org/do
-000161a0: 6373 2f23 696e 7374 616c 6c69 6e67 2d77  cs/#installing-w
-000161b0: 6974 682d 7468 652d 6f66 6669 6369 616c  ith-the-official
-000161c0: 2d69 6e73 7461 6c6c 6572 292e 0a0a 2020  -installer)...  
-000161d0: 2020 2420 6375 726c 202d 7353 4c20 6874    $ curl -sSL ht
-000161e0: 7470 733a 2f2f 696e 7374 616c 6c2e 7079  tps://install.py
-000161f0: 7468 6f6e 2d70 6f65 7472 792e 6f72 6720  thon-poetry.org 
-00016200: 7c20 7079 7468 6f6e 3320 2d0a 0a49 7420  | python3 -..It 
-00016210: 7769 6c6c 2068 656c 7020 746f 206d 616b  will help to mak
-00016220: 6520 7375 7265 2050 6f65 7472 7927 7320  e sure Poetry's 
-00016230: 6269 6e20 6469 7265 6374 6f72 7920 6973  bin directory is
-00016240: 2069 6e20 796f 7572 2060 5041 5448 6020   in your `PATH` 
-00016250: 656e 7669 726f 6e6d 656e 7420 7661 7269  environment vari
-00016260: 6162 6c65 2e0a 0a42 7574 2069 6e20 616e  able...But in an
-00016270: 7920 6361 7365 2c20 6d61 6b65 2073 7572  y case, make sur
-00016280: 6520 796f 7520 6b6e 6f77 2074 6865 2070  e you know the p
-00016290: 6174 6820 746f 2074 6865 2060 706f 6574  ath to the `poet
-000162a0: 7279 6020 6578 6563 7574 6162 6c65 2e20  ry` executable. 
-000162b0: 5468 6520 506f 6574 7279 0a69 6e73 7461  The Poetry.insta
-000162c0: 6c6c 6572 2074 656c 6c73 2079 6f75 2077  ller tells you w
-000162d0: 6865 7265 2069 7420 6861 7320 6265 656e  here it has been
-000162e0: 2069 6e73 7461 6c6c 6564 2c20 616e 6420   installed, and 
-000162f0: 686f 7720 746f 2063 6f6e 6669 6775 7265  how to configure
-00016300: 2079 6f75 7220 7368 656c 6c2e 0a0a 506c   your shell...Pl
-00016310: 6561 7365 2072 6566 6572 2074 6f20 7468  ease refer to th
-00016320: 6520 5b50 6f65 7472 7920 646f 6373 5d28  e [Poetry docs](
-00016330: 6874 7470 733a 2f2f 7079 7468 6f6e 2d70  https://python-p
-00016340: 6f65 7472 792e 6f72 672f 646f 6373 2f29  oetry.org/docs/)
-00016350: 2066 6f72 2067 7569 6461 6e63 6520 6f6e   for guidance on
-00016360: 0a75 7369 6e67 2050 6f65 7472 792e 0a0a  .using Poetry...
-00016370: 2323 2320 5365 7475 7020 666f 7220 5079  ### Setup for Py
-00016380: 4368 6172 6d20 7573 6572 730a 0a59 6f75  Charm users..You
-00016390: 2063 616e 2065 6173 696c 7920 6f62 7461   can easily obta
-000163a0: 696e 2074 6865 2070 726f 6a65 6374 2066  in the project f
-000163b0: 696c 6573 2075 7369 6e67 2050 7943 6861  iles using PyCha
-000163c0: 726d 2028 6d65 6e75 2022 4769 7420 3e20  rm (menu "Git > 
-000163d0: 436c 6f6e 652e 2e2e 2229 2e0a 5079 4368  Clone...")..PyCh
-000163e0: 6172 6d20 7769 6c6c 2074 6865 6e20 7573  arm will then us
-000163f0: 7561 6c6c 7920 7072 6f6d 7074 2079 6f75  ually prompt you
-00016400: 2074 6f20 6f70 656e 2074 6865 2070 726f   to open the pro
-00016410: 6a65 6374 2e0a 0a4f 7065 6e20 7468 6520  ject...Open the 
-00016420: 7072 6f6a 6563 7420 696e 2061 206e 6577  project in a new
-00016430: 2077 696e 646f 772e 2050 7943 6861 726d   window. PyCharm
-00016440: 2077 696c 6c20 7468 656e 2075 7375 616c   will then usual
-00016450: 6c79 2070 726f 6d70 7420 796f 7520 746f  ly prompt you to
-00016460: 2063 7265 6174 650a 6120 6e65 7720 7669   create.a new vi
-00016470: 7274 7561 6c20 656e 7669 726f 6e6d 656e  rtual environmen
-00016480: 742e 0a0a 4372 6561 7465 2061 206e 6577  t...Create a new
-00016490: 2050 6f65 7472 7920 7669 7274 7561 6c20   Poetry virtual 
-000164a0: 656e 7669 726f 6e6d 656e 7420 666f 7220  environment for 
-000164b0: 7468 6520 7072 6f6a 6563 742e 2049 6620  the project. If 
-000164c0: 5079 4368 6172 6d20 646f 6573 6e27 7420  PyCharm doesn't 
-000164d0: 616c 7265 6164 790a 6b6e 6f77 2077 6865  already.know whe
-000164e0: 7265 2079 6f75 7220 6070 6f65 7472 7960  re your `poetry`
-000164f0: 2065 7865 6375 7461 626c 6520 6973 2c20   executable is, 
-00016500: 7468 656e 2073 6574 2074 6865 2070 6174  then set the pat
-00016510: 6820 746f 2079 6f75 7220 6070 6f65 7472  h to your `poetr
-00016520: 7960 2065 7865 6375 7461 626c 650a 696e  y` executable.in
-00016530: 2074 6865 2022 4e65 7720 506f 6574 7279   the "New Poetry
-00016540: 2045 6e76 6972 6f6e 6d65 6e74 2220 666f   Environment" fo
-00016550: 726d 2069 6e70 7574 2066 6965 6c64 206c  rm input field l
-00016560: 6162 656c 6c65 6420 2250 6f65 7472 7920  abelled "Poetry 
-00016570: 6578 6563 7574 6162 6c65 222e 2049 6e20  executable". In 
-00016580: 7468 650a 224e 6577 2050 6f65 7472 7920  the."New Poetry 
-00016590: 456e 7669 726f 6e6d 656e 7422 2066 6f72  Environment" for
-000165a0: 6d2c 2079 6f75 2077 696c 6c20 616c 736f  m, you will also
-000165b0: 2068 6176 6520 7468 6520 6f70 706f 7274   have the opport
-000165c0: 756e 6974 7920 746f 2073 656c 6563 7420  unity to select 
-000165d0: 7768 6963 680a 5079 7468 6f6e 2065 7865  which.Python exe
-000165e0: 6375 7461 626c 6520 7769 6c6c 2062 6520  cutable will be 
-000165f0: 7573 6564 2062 7920 7468 6520 7669 7274  used by the virt
-00016600: 7561 6c20 656e 7669 726f 6e6d 656e 742e  ual environment.
-00016610: 0a0a 5079 4368 6172 6d20 7769 6c6c 2074  ..PyCharm will t
-00016620: 6865 6e20 6372 6561 7465 2061 206e 6577  hen create a new
-00016630: 2050 6f65 7472 7920 7669 7274 7561 6c20   Poetry virtual 
-00016640: 656e 7669 726f 6e6d 656e 7420 666f 7220  environment for 
-00016650: 796f 7572 2070 726f 6a65 6374 2c20 7573  your project, us
-00016660: 696e 670a 6120 7061 7274 6963 756c 6172  ing.a particular
-00016670: 2076 6572 7369 6f6e 206f 6620 5079 7468   version of Pyth
-00016680: 6f6e 2c20 616e 6420 616c 736f 2069 6e73  on, and also ins
-00016690: 7461 6c6c 2069 6e74 6f20 7468 6973 2076  tall into this v
-000166a0: 6972 7475 616c 2065 6e76 6972 6f6e 6d65  irtual environme
-000166b0: 6e74 2074 6865 0a70 726f 6a65 6374 2773  nt the.project's
-000166c0: 2070 6163 6b61 6765 2064 6570 656e 6465   package depende
-000166d0: 6e63 6965 7320 6163 636f 7264 696e 6720  ncies according 
-000166e0: 746f 2074 6865 2070 726f 6a65 6374 2773  to the project's
-000166f0: 2060 706f 6574 7279 2e6c 6f63 6b60 2066   `poetry.lock` f
-00016700: 696c 652e 0a0a 596f 7520 6361 6e20 6164  ile...You can ad
-00016710: 6420 6469 6666 6572 656e 7420 506f 6574  d different Poet
-00016720: 7279 2065 6e76 6972 6f6e 6d65 6e74 7320  ry environments 
-00016730: 666f 7220 6469 6666 6572 656e 7420 5079  for different Py
-00016740: 7468 6f6e 2076 6572 7369 6f6e 732c 2061  thon versions, a
-00016750: 6e64 2073 7769 7463 680a 6265 7477 6565  nd switch.betwee
-00016760: 6e20 7468 656d 2075 7369 6e67 2074 6865  n them using the
-00016770: 2022 5079 7468 6f6e 2049 6e74 6572 7072   "Python Interpr
-00016780: 6574 6572 2220 7365 7474 696e 6773 206f  eter" settings o
-00016790: 6620 5079 4368 6172 6d2e 2049 6620 796f  f PyCharm. If yo
-000167a0: 7520 7761 6e74 2074 6f20 7573 650a 6120  u want to use.a 
-000167b0: 7665 7273 696f 6e20 6f66 2050 7974 686f  version of Pytho
-000167c0: 6e20 7468 6174 2069 736e 2774 2069 6e73  n that isn't ins
-000167d0: 7461 6c6c 6564 2c20 6569 7468 6572 2075  talled, either u
-000167e0: 7365 2079 6f75 7220 6661 766f 7572 6974  se your favourit
-000167f0: 6520 7061 636b 6167 6520 6d61 6e61 6765  e package manage
-00016800: 722c 0a6f 7220 696e 7374 616c 6c20 5079  r,.or install Py
-00016810: 7468 6f6e 2062 7920 646f 776e 6c6f 6164  thon by download
-00016820: 696e 6720 616e 2069 6e73 7461 6c6c 6572  ing an installer
-00016830: 2066 6f72 2072 6563 656e 7420 7665 7273   for recent vers
-00016840: 696f 6e73 206f 6620 5079 7468 6f6e 2064  ions of Python d
-00016850: 6972 6563 746c 790a 6672 6f6d 2074 6865  irectly.from the
-00016860: 205b 5079 7468 6f6e 2077 6562 7369 7465   [Python website
-00016870: 5d28 6874 7470 733a 2f2f 7777 772e 7079  ](https://www.py
-00016880: 7468 6f6e 2e6f 7267 2f64 6f77 6e6c 6f61  thon.org/downloa
-00016890: 6473 2f29 2e0a 0a4f 6e63 6520 7072 6f6a  ds/)...Once proj
-000168a0: 6563 7420 6465 7065 6e64 656e 6369 6573  ect dependencies
-000168b0: 2068 6176 6520 6265 656e 2069 6e73 7461   have been insta
-000168c0: 6c6c 6564 2c20 796f 7520 7368 6f75 6c64  lled, you should
-000168d0: 2062 6520 6162 6c65 2074 6f20 7275 6e20   be able to run 
-000168e0: 7465 7374 730a 6672 6f6d 2077 6974 6869  tests.from withi
-000168f0: 6e20 5079 4368 6172 6d20 2872 6967 6874  n PyCharm (right
-00016900: 2d63 6c69 636b 206f 6e20 7468 6520 6074  -click on the `t
-00016910: 6573 7473 6020 666f 6c64 6572 2061 6e64  ests` folder and
-00016920: 2073 656c 6563 7420 7468 6520 2752 756e   select the 'Run
-00016930: 2720 6f70 7469 6f6e 292e 0a0a 4265 6361  ' option)...Beca
-00016940: 7573 6520 6f66 2061 2063 6f6e 666c 6963  use of a conflic
-00016950: 7420 6265 7477 6565 6e20 7079 7465 7374  t between pytest
-00016960: 2061 6e64 2050 7943 6861 726d 2773 2064   and PyCharm's d
-00016970: 6562 7567 6765 7220 616e 6420 7468 6520  ebugger and the 
-00016980: 636f 7665 7261 6765 2074 6f6f 6c2c 0a79  coverage tool,.y
-00016990: 6f75 206d 6179 206e 6565 6420 746f 2061  ou may need to a
-000169a0: 6464 2060 602d 2d6e 6f2d 636f 7660 6020  dd ``--no-cov`` 
-000169b0: 6173 2061 6e20 6f70 7469 6f6e 2074 6f20  as an option to 
-000169c0: 7468 6520 7465 7374 2072 756e 6e65 7220  the test runner 
-000169d0: 7465 6d70 6c61 7465 2e20 416c 7465 726e  template. Altern
-000169e0: 6174 6976 656c 792c 0a6a 7573 7420 7573  atively,.just us
-000169f0: 6520 7468 6520 5079 7468 6f6e 2053 7461  e the Python Sta
-00016a00: 6e64 6172 6420 4c69 6272 6172 7927 7320  ndard Library's 
-00016a10: 6060 756e 6974 7465 7374 6060 206d 6f64  ``unittest`` mod
-00016a20: 756c 652e 0a0a 596f 7520 7368 6f75 6c64  ule...You should
-00016a30: 2061 6c73 6f20 6265 2061 626c 6520 746f   also be able to
-00016a40: 206f 7065 6e20 6120 7465 726d 696e 616c   open a terminal
-00016a50: 2077 696e 646f 7720 696e 2050 7943 6861   window in PyCha
-00016a60: 726d 2c20 616e 6420 7275 6e20 7468 6520  rm, and run the 
-00016a70: 7072 6f6a 6563 7427 730a 4d61 6b65 6669  project's.Makefi
-00016a80: 6c65 2063 6f6d 6d61 6e64 7320 6672 6f6d  le commands from
-00016a90: 2074 6865 2063 6f6d 6d61 6e64 206c 696e   the command lin
-00016aa0: 6520 2873 6565 2062 656c 6f77 292e 0a0a  e (see below)...
-00016ab0: 2323 2320 5365 7475 7020 6672 6f6d 2063  ### Setup from c
-00016ac0: 6f6d 6d61 6e64 206c 696e 650a 0a4f 6274  ommand line..Obt
-00016ad0: 6169 6e20 7468 6520 7072 6f6a 6563 7420  ain the project 
-00016ae0: 6669 6c65 732c 2075 7369 6e67 2047 6974  files, using Git
-00016af0: 206f 7220 7375 6974 6162 6c65 2061 6c74   or suitable alt
-00016b00: 6572 6e61 7469 7665 2e0a 0a49 6e20 6120  ernative...In a 
-00016b10: 7465 726d 696e 616c 2061 7070 6c69 6361  terminal applica
-00016b20: 7469 6f6e 2c20 6368 616e 6765 2079 6f75  tion, change you
-00016b30: 7220 6375 7272 656e 7420 776f 726b 696e  r current workin
-00016b40: 6720 6469 7265 6374 6f72 790a 746f 2074  g directory.to t
-00016b50: 6865 2072 6f6f 7420 666f 6c64 6572 206f  he root folder o
-00016b60: 6620 7468 6520 7072 6f6a 6563 7420 6669  f the project fi
-00016b70: 6c65 732e 2054 6865 7265 2073 686f 756c  les. There shoul
-00016b80: 6420 6265 2061 204d 616b 6566 696c 650a  d be a Makefile.
-00016b90: 696e 2074 6869 7320 666f 6c64 6572 2e0a  in this folder..
-00016ba0: 0a55 7365 2074 6865 204d 616b 6566 696c  .Use the Makefil
-00016bb0: 6520 746f 2063 7265 6174 6520 6120 6e65  e to create a ne
-00016bc0: 7720 506f 6574 7279 2076 6972 7475 616c  w Poetry virtual
-00016bd0: 2065 6e76 6972 6f6e 6d65 6e74 2066 6f72   environment for
-00016be0: 2074 6865 0a70 726f 6a65 6374 2061 6e64   the.project and
-00016bf0: 2069 6e73 7461 6c6c 2074 6865 2070 726f   install the pro
-00016c00: 6a65 6374 2773 2070 6163 6b61 6765 2064  ject's package d
-00016c10: 6570 656e 6465 6e63 6965 7320 696e 746f  ependencies into
-00016c20: 2069 742c 0a75 7369 6e67 2074 6865 2066   it,.using the f
-00016c30: 6f6c 6c6f 7769 6e67 2063 6f6d 6d61 6e64  ollowing command
-00016c40: 2e0a 0a20 2020 2024 206d 616b 6520 696e  ...    $ make in
-00016c50: 7374 616c 6c2d 7061 636b 6167 6573 0a0a  stall-packages..
-00016c60: 4974 2773 2061 6c73 6f20 706f 7373 6962  It's also possib
-00016c70: 6c65 2074 6f20 616c 736f 2069 6e73 7461  le to also insta
-00016c80: 6c6c 2074 6865 2070 726f 6a65 6374 2069  ll the project i
-00016c90: 6e20 2765 6469 7461 626c 6520 6d6f 6465  n 'editable mode
-00016ca0: 272e 0a0a 2020 2020 2420 6d61 6b65 2069  '...    $ make i
-00016cb0: 6e73 7461 6c6c 0a0a 506c 6561 7365 206e  nstall..Please n
-00016cc0: 6f74 652c 2069 6620 796f 7520 6372 6561  ote, if you crea
-00016cd0: 7465 2074 6865 2076 6972 7475 616c 2065  te the virtual e
-00016ce0: 6e76 6972 6f6e 6d65 6e74 2069 6e20 7468  nvironment in th
-00016cf0: 6973 2077 6179 2c20 616e 6420 7468 656e  is way, and then
-00016d00: 2074 7279 2074 6f0a 6f70 656e 2074 6865   try to.open the
-00016d10: 2070 726f 6a65 6374 2069 6e20 5079 4368   project in PyCh
-00016d20: 6172 6d20 616e 6420 636f 6e66 6967 7572  arm and configur
-00016d30: 6520 7468 6520 7072 6f6a 6563 7420 746f  e the project to
-00016d40: 2075 7365 2074 6869 7320 7669 7274 7561   use this virtua
-00016d50: 6c0a 656e 7669 726f 6e6d 656e 7420 6173  l.environment as
-00016d60: 2061 6e20 2245 7869 7374 696e 6720 506f   an "Existing Po
-00016d70: 6574 7279 2045 6e76 6972 6f6e 6d65 6e74  etry Environment
-00016d80: 222c 2050 7943 6861 726d 2073 6f6d 6574  ", PyCharm somet
-00016d90: 696d 6573 2068 6173 2073 6f6d 650a 6973  imes has some.is
-00016da0: 7375 6573 2028 646f 6e27 7420 6b6e 6f77  sues (don't know
-00016db0: 2077 6879 2920 7768 6963 6820 6d69 6768   why) which migh
-00016dc0: 7420 6265 2070 726f 626c 656d 6174 6963  t be problematic
-00016dd0: 2e20 4966 2079 6f75 2065 6e63 6f75 6e74  . If you encount
-00016de0: 6572 2073 7563 680a 6973 7375 6573 2c20  er such.issues, 
-00016df0: 796f 7520 6361 6e20 7265 736f 6c76 6520  you can resolve 
-00016e00: 7468 6573 6520 6973 7375 6573 2062 7920  these issues by 
-00016e10: 6465 6c65 7469 6e67 2074 6865 2076 6972  deleting the vir
-00016e20: 7475 616c 2065 6e76 6972 6f6e 6d65 6e74  tual environment
-00016e30: 0a61 6e64 2063 7265 6174 696e 6720 7468  .and creating th
-00016e40: 6520 506f 6574 7279 2076 6972 7475 616c  e Poetry virtual
-00016e50: 2065 6e76 6972 6f6e 6d65 6e74 2075 7369   environment usi
-00016e60: 6e67 2050 7943 6861 726d 2028 7365 6520  ng PyCharm (see 
-00016e70: 6162 6f76 6529 2e0a 0a23 2323 2050 726f  above)...### Pro
-00016e80: 6a65 6374 204d 616b 6566 696c 6520 636f  ject Makefile co
-00016e90: 6d6d 616e 6473 0a0a 596f 7520 6361 6e20  mmands..You can 
-00016ea0: 7374 6172 7420 4576 656e 7453 746f 7265  start EventStore
-00016eb0: 4442 2075 7369 6e67 2074 6865 2066 6f6c  DB using the fol
-00016ec0: 6c6f 7769 6e67 2063 6f6d 6d61 6e64 2e0a  lowing command..
-00016ed0: 0a20 2020 2024 206d 616b 6520 7374 6172  .    $ make star
-00016ee0: 742d 6576 656e 7473 746f 7265 6462 0a0a  t-eventstoredb..
-00016ef0: 596f 7520 6361 6e20 7275 6e20 7465 7374  You can run test
-00016f00: 7320 7573 696e 6720 7468 6520 666f 6c6c  s using the foll
-00016f10: 6f77 696e 6720 636f 6d6d 616e 6420 286e  owing command (n
-00016f20: 6565 6473 2045 7665 6e74 5374 6f72 6544  eeds EventStoreD
-00016f30: 4220 746f 2062 6520 7275 6e6e 696e 6729  B to be running)
-00016f40: 2e0a 0a20 2020 2024 206d 616b 6520 7465  ...    $ make te
-00016f50: 7374 0a0a 596f 7520 6361 6e20 7374 6f70  st..You can stop
-00016f60: 2045 7665 6e74 5374 6f72 6544 4220 7573   EventStoreDB us
-00016f70: 696e 6720 7468 6520 666f 6c6c 6f77 696e  ing the followin
-00016f80: 6720 636f 6d6d 616e 642e 0a0a 2020 2020  g command...    
-00016f90: 2420 6d61 6b65 2073 746f 702d 6576 656e  $ make stop-even
-00016fa0: 7473 746f 7265 6462 0a0a 596f 7520 6361  tstoredb..You ca
-00016fb0: 6e20 6368 6563 6b20 7468 6520 666f 726d  n check the form
-00016fc0: 6174 7469 6e67 206f 6620 7468 6520 636f  atting of the co
-00016fd0: 6465 2075 7369 6e67 2074 6865 2066 6f6c  de using the fol
-00016fe0: 6c6f 7769 6e67 2063 6f6d 6d61 6e64 2e0a  lowing command..
-00016ff0: 0a20 2020 2024 206d 616b 6520 6c69 6e74  .    $ make lint
-00017000: 0a0a 596f 7520 6361 6e20 7265 666f 726d  ..You can reform
-00017010: 6174 2074 6865 2063 6f64 6520 7573 696e  at the code usin
-00017020: 6720 7468 6520 666f 6c6c 6f77 696e 6720  g the following 
-00017030: 636f 6d6d 616e 642e 0a0a 2020 2020 2420  command...    $ 
-00017040: 6d61 6b65 2066 6d74 0a0a 5465 7374 7320  make fmt..Tests 
-00017050: 6265 6c6f 6e67 2069 6e20 602e 2f74 6573  belong in `./tes
-00017060: 7473 602e 2043 6f64 652d 756e 6465 722d  ts`. Code-under-
-00017070: 7465 7374 2062 656c 6f6e 6773 2069 6e20  test belongs in 
-00017080: 602e 2f65 7364 6263 6c69 656e 7460 2e0a  `./esdbclient`..
-00017090: 0a45 6469 7420 7061 636b 6167 6520 6465  .Edit package de
-000170a0: 7065 6e64 656e 6369 6573 2069 6e20 6070  pendencies in `p
-000170b0: 7970 726f 6a65 6374 2e74 6f6d 6c60 2e20  yproject.toml`. 
-000170c0: 5570 6461 7465 2069 6e73 7461 6c6c 6564  Update installed
-000170d0: 2070 6163 6b61 6765 7320 2861 6e64 2074   packages (and t
-000170e0: 6865 0a60 706f 6574 7279 2e6c 6f63 6b60  he.`poetry.lock`
-000170f0: 2066 696c 6529 2075 7369 6e67 2074 6865   file) using the
-00017100: 2066 6f6c 6c6f 7769 6e67 2063 6f6d 6d61   following comma
-00017110: 6e64 2e0a 0a20 2020 2024 206d 616b 6520  nd...    $ make 
-00017120: 7570 6461 7465 2d70 6163 6b61 6765 730a  update-packages.
+000134c0: 2073 656c 662e 6166 7465 725f 6e61 636b   self.after_nack
+000134d0: 2865 7665 6e74 2c20 6163 7469 6f6e 290a  (event, action).
+000134e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000134f0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00013500: 2020 2020 2020 2020 2020 7365 6c66 2e73            self.s
+00013510: 7562 7363 7269 7074 696f 6e2e 6163 6b28  ubscription.ack(
+00013520: 6576 656e 742e 6964 290a 2020 2020 2020  event.id).      
+00013530: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00013540: 6c66 2e61 6674 6572 5f61 636b 2865 7665  lf.after_ack(eve
+00013550: 6e74 290a 2020 2020 2020 2020 6578 6365  nt).        exce
+00013560: 7074 2045 7863 6570 7469 6f6e 3a0a 2020  pt Exception:.  
+00013570: 2020 2020 2020 2020 2020 7365 6c66 2e73            self.s
+00013580: 7562 7363 7269 7074 696f 6e2e 7374 6f70  ubscription.stop
+00013590: 2829 0a20 2020 2020 2020 2020 2020 2072  ().            r
+000135a0: 6169 7365 0a0a 2020 2020 6465 6620 7374  aise..    def st
+000135b0: 6f70 2873 656c 6629 3a0a 2020 2020 2020  op(self):.      
+000135c0: 2020 7365 6c66 2e73 7562 7363 7269 7074    self.subscript
+000135d0: 696f 6e2e 7374 6f70 2829 0a0a 2020 2020  ion.stop()..    
+000135e0: 6465 6620 706f 6c69 6379 2873 656c 662c  def policy(self,
+000135f0: 2065 7665 6e74 293a 0a20 2020 2020 2020   event):.       
+00013600: 2023 2052 6169 7365 2061 6e20 6578 6365   # Raise an exce
+00013610: 7074 696f 6e20 7768 656e 2077 6520 7365  ption when we se
+00013620: 6520 2265 7665 6e74 3522 2e0a 2020 2020  e "event5"..    
+00013630: 2020 2020 6966 2065 7665 6e74 2e69 6420      if event.id 
+00013640: 3d3d 2065 7665 6e74 352e 6964 3a0a 2020  == event5.id:.  
+00013650: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00013660: 4578 6365 7074 696f 6e28 290a 0a20 2020  Exception()..   
+00013670: 2064 6566 2061 6674 6572 5f61 636b 2873   def after_ack(s
+00013680: 656c 662c 2065 7665 6e74 293a 0a20 2020  elf, event):.   
+00013690: 2020 2020 2023 2054 7261 636b 2072 6574       # Track ret
+000136a0: 7279 2063 6f75 6e74 206f 6620 6163 6b65  ry count of acke
+000136b0: 6420 6576 656e 7473 2e0a 2020 2020 2020  d events..      
+000136c0: 2020 6163 6b65 645f 6576 656e 7473 5b65    acked_events[e
+000136d0: 7665 6e74 2e69 645d 203d 2065 7665 6e74  vent.id] = event
+000136e0: 2e72 6574 7279 5f63 6f75 6e74 0a0a 2020  .retry_count..  
+000136f0: 2020 6465 6620 6166 7465 725f 6e61 636b    def after_nack
+00013700: 2873 656c 662c 2065 7665 6e74 2c20 6163  (self, event, ac
+00013710: 7469 6f6e 293a 0a20 2020 2020 2020 2023  tion):.        #
+00013720: 2054 7261 636b 2072 6574 7279 2063 6f75   Track retry cou
+00013730: 6e74 206f 6620 6e61 636b 6564 2065 7665  nt of nacked eve
+00013740: 6e74 732e 0a20 2020 2020 2020 206e 6163  nts..        nac
+00013750: 6b65 645f 6576 656e 7473 5b65 7665 6e74  ked_events[event
+00013760: 2e69 645d 203d 2065 7665 6e74 2e72 6574  .id] = event.ret
+00013770: 7279 5f63 6f75 6e74 0a0a 2020 2020 2020  ry_count..      
+00013780: 2020 6966 2061 6374 696f 6e20 3d3d 2073    if action == s
+00013790: 656c 662e 6669 6e61 6c5f 6163 7469 6f6e  elf.final_action
+000137a0: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
+000137b0: 5374 6f70 2074 6865 2063 6f6e 7375 6d65  Stop the consume
+000137c0: 722c 2073 6f20 7765 2063 616e 2063 6f6e  r, so we can con
+000137d0: 7469 6e75 6520 7769 7468 2074 6865 2065  tinue with the e
+000137e0: 7861 6d70 6c65 732e 0a20 2020 2020 2020  xamples..       
+000137f0: 2020 2020 2073 656c 662e 7374 6f70 2829       self.stop()
+00013800: 0a0a 0a23 2043 7265 6174 6520 7375 6273  ...# Create subs
+00013810: 6372 6970 7469 6f6e 2e0a 6772 6f75 705f  cription..group_
+00013820: 6e61 6d65 203d 2066 2267 726f 7570 2d7b  name = f"group-{
+00013830: 7575 6964 3428 297d 220a 636c 6965 6e74  uuid4()}".client
+00013840: 2e63 7265 6174 655f 7375 6273 6372 6970  .create_subscrip
+00013850: 7469 6f6e 2867 726f 7570 5f6e 616d 652c  tion(group_name,
+00013860: 2063 6f6d 6d69 745f 706f 7369 7469 6f6e   commit_position
+00013870: 3d63 6f6d 6d69 745f 706f 7369 7469 6f6e  =commit_position
+00013880: 3129 0a0a 2320 5265 6164 2073 7562 7363  1)..# Read subsc
+00013890: 7269 7074 696f 6e2e 0a73 7562 7363 7269  ription..subscri
+000138a0: 7074 696f 6e20 3d20 636c 6965 6e74 2e72  ption = client.r
+000138b0: 6561 645f 7375 6273 6372 6970 7469 6f6e  ead_subscription
+000138c0: 2867 726f 7570 5f6e 616d 6529 0a0a 2320  (group_name)..# 
+000138d0: 436f 6e73 7472 7563 7420 636f 6e73 756d  Construct consum
+000138e0: 6572 2e0a 636f 6e73 756d 6572 203d 2045  er..consumer = E
+000138f0: 7861 6d70 6c65 436f 6e73 756d 6572 280a  xampleConsumer(.
+00013900: 2020 2020 7375 6273 6372 6970 7469 6f6e      subscription
+00013910: 3d73 7562 7363 7269 7074 696f 6e2c 0a20  =subscription,. 
+00013920: 2020 206d 6178 5f72 6574 7269 6573 3d35     max_retries=5
+00013930: 2c0a 2020 2020 6669 6e61 6c5f 6163 7469  ,.    final_acti
+00013940: 6f6e 3d22 7061 726b 222c 0a29 0a0a 2320  on="park",.)..# 
+00013950: 5275 6e20 636f 6e73 756d 6572 2e0a 636f  Run consumer..co
+00013960: 6e73 756d 6572 2e72 756e 2829 0a0a 2320  nsumer.run()..# 
+00013970: 4368 6563 6b20 2765 7665 6e74 3131 2720  Check 'event11' 
+00013980: 7761 7320 6163 6b65 6420 616e 6420 6e65  was acked and ne
+00013990: 7665 7220 7265 7472 6965 642e 0a61 7373  ver retried..ass
+000139a0: 6572 7420 6163 6b65 645f 6576 656e 7473  ert acked_events
+000139b0: 5b65 7665 6e74 3131 2e69 645d 203d 3d20  [event11.id] == 
+000139c0: 300a 6173 7365 7274 2065 7665 6e74 3131  0.assert event11
+000139d0: 2e69 6420 6e6f 7420 696e 206e 6163 6b65  .id not in nacke
+000139e0: 645f 6576 656e 7473 0a0a 2320 4368 6563  d_events..# Chec
+000139f0: 6b20 2765 7665 6e74 3527 2077 6173 2072  k 'event5' was r
+00013a00: 6574 7269 6564 2066 6976 6520 7469 6d65  etried five time
+00013a10: 7320 616e 6420 6e65 7665 7220 6163 6b65  s and never acke
+00013a20: 642e 0a61 7373 6572 7420 6e61 636b 6564  d..assert nacked
+00013a30: 5f65 7665 6e74 735b 6576 656e 7435 2e69  _events[event5.i
+00013a40: 645d 203d 3d20 350a 6173 7365 7274 2065  d] == 5.assert e
+00013a50: 7665 6e74 352e 6964 206e 6f74 2069 6e20  vent5.id not in 
+00013a60: 6163 6b65 645f 6576 656e 7473 0a60 6060  acked_events.```
+00013a70: 0a0a 2323 2043 6f6e 6e65 6374 696f 6e0a  ..## Connection.
+00013a80: 0a23 2323 2052 6563 6f6e 6e65 6374 0a0a  .### Reconnect..
+00013a90: 5468 6520 6072 6563 6f6e 6e65 6374 2829  The `reconnect()
+00013aa0: 6020 6d65 7468 6f64 2063 616e 2062 6520  ` method can be 
+00013ab0: 7573 6564 2074 6f20 6d61 6e75 616c 6c79  used to manually
+00013ac0: 2072 6563 6f6e 6e65 6374 2074 6865 2063   reconnect the c
+00013ad0: 6c69 656e 7420 746f 2061 0a73 7569 7461  lient to a.suita
+00013ae0: 626c 6520 4576 656e 7453 746f 7265 4442  ble EventStoreDB
+00013af0: 206e 6f64 652e 2054 6869 7320 6d65 7468   node. This meth
+00013b00: 6f64 2075 7365 7320 7468 6520 7361 6d65  od uses the same
+00013b10: 2072 6f75 7469 6e65 2066 6f72 2072 6561   routine for rea
+00013b20: 6469 6e67 2074 6865 0a63 6c75 7374 6572  ding the.cluster
+00013b30: 206e 6f64 6520 7374 6174 6573 2061 6e64   node states and
+00013b40: 2074 6865 6e20 636f 6e6e 6563 7469 6e67   then connecting
+00013b50: 2074 6f20 6120 7375 6974 6162 6c65 206e   to a suitable n
+00013b60: 6f64 6520 6163 636f 7264 696e 6720 746f  ode according to
+00013b70: 2074 6865 0a63 6c69 656e 7427 7320 6e6f   the.client's no
+00013b80: 6465 2070 7265 6665 7265 6e63 6520 7468  de preference th
+00013b90: 6174 2069 7320 7370 6563 6966 6965 6420  at is specified 
+00013ba0: 696e 2074 6865 2063 6f6e 6e65 6374 696f  in the connectio
+00013bb0: 6e20 7374 7269 6e67 2055 5249 2077 6865  n string URI whe
+00013bc0: 6e0a 7468 6520 636c 6965 6e74 2069 7320  n.the client is 
+00013bd0: 636f 6e73 7472 7563 7465 642e 2054 6869  constructed. Thi
+00013be0: 7320 6d65 7468 6f64 2069 7320 7468 7265  s method is thre
+00013bf0: 6164 2d73 6166 652c 2061 6e64 2069 7420  ad-safe, and it 
+00013c00: 6973 2022 636f 6e73 6572 7661 7469 7665  is "conservative
+00013c10: 220a 696e 2074 6861 742c 2077 6865 6e20  ".in that, when 
+00013c20: 6974 2069 7320 6361 6c6c 6564 2062 7920  it is called by 
+00013c30: 7365 7665 7261 6c20 7468 7265 6164 7320  several threads 
+00013c40: 6174 2074 6865 2073 616d 6520 7469 6d65  at the same time
+00013c50: 2c20 6f6e 6c79 206f 6e65 0a72 6563 6f6e  , only one.recon
+00013c60: 6e65 6374 696f 6e20 7769 6c6c 206f 6363  nection will occ
+00013c70: 7572 2e20 436f 6e63 7572 7265 6e74 2061  ur. Concurrent a
+00013c80: 7474 656d 7074 7320 746f 2072 6563 6f6e  ttempts to recon
+00013c90: 6e65 6374 2077 696c 6c20 626c 6f63 6b20  nect will block 
+00013ca0: 756e 7469 6c0a 7468 6520 636c 6965 6e74  until.the client
+00013cb0: 2068 6173 2072 6563 6f6e 6e65 6374 6564   has reconnected
+00013cc0: 2073 7563 6365 7373 6675 6c6c 792c 2061   successfully, a
+00013cd0: 6e64 2074 6865 6e20 7468 6579 2077 696c  nd then they wil
+00013ce0: 6c20 616c 6c20 7265 7475 726e 206e 6f72  l all return nor
+00013cf0: 6d61 6c6c 792e 0a0a 6060 6070 7974 686f  mally...```pytho
+00013d00: 6e0a 636c 6965 6e74 2e72 6563 6f6e 6e65  n.client.reconne
+00013d10: 6374 2829 0a60 6060 0a0a 416e 2065 7861  ct().```..An exa
+00013d20: 6d70 6c65 206f 6620 7768 656e 2069 7420  mple of when it 
+00013d30: 6d69 6768 7420 6265 2064 6573 6972 6162  might be desirab
+00013d40: 6c65 2074 6f20 7265 636f 6e6e 6563 7420  le to reconnect 
+00013d50: 6d61 6e75 616c 6c79 2069 7320 7768 656e  manually is when
+00013d60: 2028 666f 7220 7065 7266 6f72 6d61 6e63   (for performanc
+00013d70: 650a 7265 6173 6f6e 7329 2074 6865 2063  e.reasons) the c
+00013d80: 6c69 656e 7427 7320 6e6f 6465 2070 7265  lient's node pre
+00013d90: 6665 7265 6e63 6520 6973 2074 6f20 6265  ference is to be
+00013da0: 2063 6f6e 6e65 6374 6564 2074 6f20 6120   connected to a 
+00013db0: 666f 6c6c 6f77 6572 206e 6f64 6520 696e  follower node in
+00013dc0: 2074 6865 0a63 6c75 7374 6572 2c20 616e   the.cluster, an
+00013dd0: 642c 2061 6674 6572 2061 2063 6c75 7374  d, after a clust
+00013de0: 6572 206c 6561 6465 7220 656c 6563 7469  er leader electi
+00013df0: 6f6e 2c20 7468 6520 666f 6c6c 6f77 6572  on, the follower
+00013e00: 2062 6563 6f6d 6573 2074 6865 206c 6561   becomes the lea
+00013e10: 6465 722e 0a52 6563 6f6e 6e65 6374 696e  der..Reconnectin
+00013e20: 6720 746f 2061 2066 6f6c 6c6f 7765 7220  g to a follower 
+00013e30: 6e6f 6465 2069 6e20 7468 6973 2063 6173  node in this cas
+00013e40: 6520 6973 2063 7572 7265 6e74 6c79 2062  e is currently b
+00013e50: 6579 6f6e 6420 7468 6520 6361 7061 6269  eyond the capabi
+00013e60: 6c69 7469 6573 206f 660a 7468 6973 2063  lities of.this c
+00013e70: 6c69 656e 742c 2062 7574 2074 6869 7320  lient, but this 
+00013e80: 6265 6861 7669 6f72 206d 6967 6874 2062  behavior might b
+00013e90: 6520 696d 706c 656d 656e 7465 6420 696e  e implemented in
+00013ea0: 2061 2066 7574 7572 6520 7265 6c65 6173   a future releas
+00013eb0: 652e 0a0a 506c 6561 7365 206e 6f74 652c  e...Please note,
+00013ec0: 206e 6561 726c 7920 616c 6c20 7468 6520   nearly all the 
+00013ed0: 636c 6965 6e74 206d 6574 686f 6473 2061  client methods a
+00013ee0: 7265 2064 6563 6f72 6174 6564 2077 6974  re decorated wit
+00013ef0: 6820 6040 6175 746f 7265 636f 6e6e 6563  h `@autoreconnec
+00013f00: 7460 2028 7768 6963 680a 6361 6c6c 7320  t` (which.calls 
+00013f10: 7468 6520 6072 6563 6f6e 6e65 6374 2829  the `reconnect()
+00013f20: 6020 6d65 7468 6f64 2077 6865 6e20 7468  ` method when th
+00013f30: 6520 636c 6965 6e74 2064 6574 6563 7473  e client detects
+00013f40: 2074 6861 7420 7265 636f 6e6e 6563 7469   that reconnecti
+00013f50: 6e67 2069 7320 7265 7175 6972 6564 290a  ng is required).
+00013f60: 616e 6420 6120 6040 7265 7472 7960 2064  and a `@retry` d
+00013f70: 6563 6f72 6174 6f72 2074 6861 7420 6d6f  ecorator that mo
+00013f80: 7265 2067 656e 6572 616c 6c79 2077 696c  re generally wil
+00013f90: 6c20 7265 7472 7920 6f70 6572 6174 696f  l retry operatio
+00013fa0: 6e73 2074 6861 7420 6661 696c 2064 7565  ns that fail due
+00013fb0: 2074 6f0a 636f 6e6e 6563 7469 6f6e 2069   to.connection i
+00013fc0: 7373 7565 732e 0a0a 5468 6520 6040 6175  ssues...The `@au
+00013fd0: 746f 7265 636f 6e6e 6563 7460 2064 6563  toreconnect` dec
+00013fe0: 6f72 6174 6f72 2077 696c 6c20 7265 636f  orator will reco
+00013ff0: 6e6e 6563 7420 746f 2061 2073 7569 7461  nnect to a suita
+00014000: 626c 6520 6e6f 6465 2069 6e20 7468 6520  ble node in the 
+00014010: 636c 7573 7465 7220 7768 656e 0a74 6865  cluster when.the
+00014020: 2073 6572 7665 7220 746f 2077 6869 6368   server to which
+00014030: 2074 6865 2063 6c69 656e 7420 6861 7320   the client has 
+00014040: 6265 656e 2063 6f6e 6e65 6374 6564 2068  been connected h
+00014050: 6173 2062 6563 6f6d 6520 756e 6176 6169  as become unavai
+00014060: 6c61 626c 652c 206f 7220 7768 656e 2074  lable, or when t
+00014070: 6865 0a63 6c69 656e 7427 7320 6752 5043  he.client's gRPC
+00014080: 2063 6861 6e6e 656c 2068 6170 7065 6e73   channel happens
+00014090: 2074 6f20 6861 7665 2062 6565 6e20 636c   to have been cl
+000140a0: 6f73 6564 2e20 5468 6520 636c 6965 6e74  osed. The client
+000140b0: 2077 696c 6c20 616c 736f 2072 6563 6f6e   will also recon
+000140c0: 6e65 6374 2077 6865 6e0a 6120 6d65 7468  nect when.a meth
+000140d0: 6f64 2069 7320 6361 6c6c 6564 2074 6861  od is called tha
+000140e0: 7420 7265 7175 6972 6573 2061 206c 6561  t requires a lea
+000140f0: 6465 722c 2061 6e64 2074 6865 2063 6c69  der, and the cli
+00014100: 656e 7427 7320 6e6f 6465 2070 7265 6665  ent's node prefe
+00014110: 7265 6e63 6520 6973 2074 6f20 6265 0a63  rence is to be.c
+00014120: 6f6e 6e65 6374 6564 2074 6f20 6120 6c65  onnected to a le
+00014130: 6164 6572 2c20 6275 7420 7468 6520 6e6f  ader, but the no
+00014140: 6465 2074 6861 7420 7468 6520 636c 6965  de that the clie
+00014150: 6e74 2068 6173 2062 6565 6e20 636f 6e6e  nt has been conn
+00014160: 6563 7465 6420 746f 2073 746f 7073 2062  ected to stops b
+00014170: 6569 6e67 0a74 6865 206c 6561 6465 722e  eing.the leader.
+00014180: 2049 6e20 7468 6973 2063 6173 652c 2074   In this case, t
+00014190: 6865 2063 6c69 656e 7420 7769 6c6c 2072  he client will r
+000141a0: 6563 6f6e 6e65 6374 2074 6f20 7468 6520  econnect to the 
+000141b0: 6375 7272 656e 7420 6c65 6164 6572 2e20  current leader. 
+000141c0: 4166 7465 720a 7265 636f 6e6e 6563 7469  After.reconnecti
+000141d0: 6e67 2c20 7468 6520 6661 696c 6564 206f  ng, the failed o
+000141e0: 7065 7261 7469 6f6e 2077 696c 6c20 6265  peration will be
+000141f0: 2072 6574 7269 6564 2e0a 0a54 6865 2060   retried...The `
+00014200: 4072 6574 7279 6020 6465 636f 7261 746f  @retry` decorato
+00014210: 7220 7265 7472 6965 7320 6f70 6572 6174  r retries operat
+00014220: 696f 6e73 2074 6861 7420 6861 7665 2066  ions that have f
+00014230: 6169 6c65 6420 6475 6520 746f 206d 6f72  ailed due to mor
+00014240: 6520 6765 6e65 7261 6c0a 636f 6e6e 6563  e general.connec
+00014250: 7469 6f6e 2069 7373 7565 732c 2073 7563  tion issues, suc
+00014260: 6820 6173 2061 2064 6561 646c 696e 6520  h as a deadline 
+00014270: 6265 696e 6720 7265 6163 6865 6420 2873  being reached (s
+00014280: 6f20 7468 6174 2074 6865 206f 7065 7261  o that the opera
+00014290: 7469 6f6e 2074 696d 6573 0a6f 7574 292c  tion times.out),
+000142a0: 206f 7220 696e 2063 6173 6520 7468 6520   or in case the 
+000142b0: 7365 7276 6572 2074 6872 6f77 7320 616e  server throws an
+000142c0: 2065 7863 6570 7469 6f6e 2077 6865 6e20   exception when 
+000142d0: 6861 6e64 6c69 6e67 2061 2063 6c69 656e  handling a clien
+000142e0: 7420 7265 7175 6573 742e 0a0a 506c 6561  t request...Plea
+000142f0: 7365 2061 6c73 6f20 6e6f 7465 2c20 7468  se also note, th
+00014300: 6520 6173 7065 6374 7320 6e6f 7420 636f  e aspects not co
+00014310: 7665 7265 6420 6279 2074 6865 2072 6563  vered by the rec
+00014320: 6f6e 6e65 6374 2061 6e64 2072 6574 7279  onnect and retry
+00014330: 2064 6563 6f72 6174 6f72 0a62 6568 6176   decorator.behav
+00014340: 696f 7572 7320 6861 7665 2074 6f20 646f  iours have to do
+00014350: 2077 6974 6820 6d65 7468 6f64 7320 7468   with methods th
+00014360: 6174 2072 6574 7572 6e20 6974 6572 6174  at return iterat
+00014370: 6f72 732e 2046 6f72 2065 7861 6d70 6c65  ors. For example
+00014380: 2c20 636f 6e73 6964 6572 0a74 6865 2060  , consider.the `
+00014390: 7265 6164 5f61 6c6c 5f65 7665 6e74 7328  read_all_events(
+000143a0: 2960 206d 6574 686f 642c 2077 6869 6368  )` method, which
+000143b0: 2072 6574 7572 6e73 2061 6e20 6974 6572   returns an iter
+000143c0: 6174 6f72 206f 6620 6052 6563 6f72 6465  ator of `Recorde
+000143d0: 6445 7665 6e74 6020 6f62 6a65 6374 732e  dEvent` objects.
+000143e0: 0a54 6865 206d 6574 686f 6420 6861 7320  .The method has 
+000143f0: 7265 7475 726e 6564 2061 6e64 2074 6865  returned and the
+00014400: 206d 6574 686f 6420 6465 636f 7261 746f   method decorato
+00014410: 7273 2068 6176 6520 7468 6572 6566 6f72  rs have therefor
+00014420: 6520 6578 6974 6564 2062 6566 6f72 6520  e exited before 
+00014430: 7468 650a 6974 6572 6174 696e 6720 6f66  the.iterating of
+00014440: 2074 6865 2072 6573 706f 6e73 6520 6265   the response be
+00014450: 6769 6e73 2e20 5468 6572 6566 6f72 652c  gins. Therefore,
+00014460: 2069 7420 6973 6e27 7420 706f 7373 6962   it isn't possib
+00014470: 6c65 2066 6f72 2074 6869 7320 6d65 7468  le for this meth
+00014480: 6f64 2074 6f0a 7472 6967 6765 7220 6120  od to.trigger a 
+00014490: 7265 636f 6e6e 6563 7469 6f6e 206f 7220  reconnection or 
+000144a0: 666f 7220 6974 2074 6f20 7265 7472 792c  for it to retry,
+000144b0: 2077 6865 6e20 7468 6520 7374 7265 616d   when the stream
+000144c0: 696e 6720 7265 7370 6f6e 7365 2073 6f6d  ing response som
+000144d0: 6568 6f77 2066 6169 6c73 2e0a 0a41 6e6f  ehow fails...Ano
+000144e0: 7468 6572 2065 7861 6d70 6c65 2069 7320  ther example is 
+000144f0: 7468 6520 2263 6174 6368 2d75 7022 2061  the "catch-up" a
+00014500: 6e64 2070 6572 7369 7374 656e 7420 7375  nd persistent su
+00014510: 6273 6372 6970 7469 6f6e 2072 6561 6420  bscription read 
+00014520: 6d65 7468 6f64 732c 2061 6c74 686f 7567  methods, althoug
+00014530: 680a 7769 7468 2074 6865 7365 206d 6574  h.with these met
+00014540: 686f 6473 2074 6865 7265 2069 7320 616e  hods there is an
+00014550: 2069 6e69 7469 616c 2022 636f 6e66 6972   initial "confir
+00014560: 6d61 7469 6f6e 2220 7265 7370 6f6e 7365  mation" response
+00014570: 2066 726f 6d20 7468 6520 7365 7276 6572   from the server
+00014580: 2077 6869 6368 0a69 7320 7265 6365 6976   which.is receiv
+00014590: 6564 2061 6e64 2063 6865 636b 6564 2062  ed and checked b
+000145a0: 7920 7468 6520 636c 6965 6e74 2062 6566  y the client bef
+000145b0: 6f72 6520 7468 6520 6d65 7468 6f64 2072  ore the method r
+000145c0: 6574 7572 6e73 2c20 736f 2069 6620 7468  eturns, so if th
+000145d0: 6520 7365 7276 6572 2069 730a 756e 6176  e server is.unav
+000145e0: 6169 6c61 626c 6520 7768 656e 2074 6865  ailable when the
+000145f0: 2063 616c 6c20 6973 206d 6164 652c 206f   call is made, o
+00014600: 7220 6966 2074 6865 2063 6861 6e6e 656c  r if the channel
+00014610: 2069 7320 736f 6d65 686f 7720 636c 6f73   is somehow clos
+00014620: 6564 2c20 6f72 2069 6620 7468 650a 7365  ed, or if the.se
+00014630: 7276 6572 2074 6872 6f77 7320 616e 2065  rver throws an e
+00014640: 7272 6f72 2066 6f72 2073 6f6d 6520 7265  rror for some re
+00014650: 6173 6f6e 2c20 7468 656e 2074 6865 2063  ason, then the c
+00014660: 6c69 656e 7420 7769 6c6c 2065 6974 6865  lient will eithe
+00014670: 7220 7265 636f 6e6e 6563 7420 616e 640a  r reconnect and.
+00014680: 7265 7472 792c 206f 7220 6d6f 7265 2073  retry, or more s
+00014690: 696d 706c 7920 6a75 7374 2072 6574 7279  imply just retry
+000146a0: 2074 6865 206f 7065 7261 7469 6f6e 2c20   the operation, 
+000146b0: 6163 636f 7264 696e 6720 7468 6520 7479  according the ty
+000146c0: 7065 206f 6620 6572 726f 7220 7468 6174  pe of error that
+000146d0: 0a77 6173 2065 6e63 6f75 6e74 6572 6564  .was encountered
+000146e0: 2e20 486f 7765 7665 722c 2061 6e20 6576  . However, an ev
+000146f0: 656e 742d 7072 6f63 6573 7369 6e67 2063  ent-processing c
+00014700: 6f6d 706f 6e65 6e74 2074 6861 7420 6974  omponent that it
+00014710: 6572 6174 6573 206f 7665 7220 610a 7375  erates over a.su
+00014720: 6363 6573 7366 756c 6c79 2072 6574 7572  ccessfully retur
+00014730: 6e65 6420 2263 6174 6368 2d75 7022 2073  ned "catch-up" s
+00014740: 7562 7363 7269 7074 696f 6e20 7265 7370  ubscription resp
+00014750: 6f6e 7365 2077 696c 6c20 6e65 6564 2074  onse will need t
+00014760: 6f20 6265 206d 6f6e 6974 6f72 6564 2066  o be monitored f
+00014770: 6f72 0a65 7272 6f72 732c 2061 6e64 2c20  or.errors, and, 
+00014780: 6966 2069 7420 6661 696c 7320 6166 7465  if it fails afte
+00014790: 7220 6974 2068 6173 2073 7461 7274 6564  r it has started
+000147a0: 2069 7465 7261 7469 6e67 206f 7665 7220   iterating over 
+000147b0: 7468 6520 7265 7370 6f6e 7365 2c20 7468  the response, th
+000147c0: 6520 6361 7463 682d 7570 0a73 7562 7363  e catch-up.subsc
+000147d0: 7269 7074 696f 6e20 7769 6c6c 206e 6565  ription will nee
+000147e0: 6420 746f 2062 6520 7265 7374 6172 7465  d to be restarte
+000147f0: 6420 6672 6f6d 2074 6865 2065 7665 6e74  d from the event
+00014800: 2d70 726f 6365 7373 696e 6720 636f 6d70  -processing comp
+00014810: 6f6e 656e 7427 7320 226c 6173 740a 7361  onent's "last.sa
+00014820: 7665 6420 636f 6d6d 6974 2070 6f73 6974  ved commit posit
+00014830: 696f 6e22 2e20 4966 2074 6865 2065 7665  ion". If the eve
+00014840: 6e74 2d70 726f 6365 7373 696e 6720 636f  nt-processing co
+00014850: 6d70 6f6e 656e 7420 6973 2072 6563 6f72  mponent is recor
+00014860: 6469 6e67 2074 6865 2063 6f6d 6d69 740a  ding the commit.
+00014870: 706f 7369 7469 6f6e 206f 6620 6561 6368  position of each
+00014880: 2072 6563 6f72 6465 6420 6576 656e 7420   recorded event 
+00014890: 6174 6f6d 6963 616c 6c79 2061 6c6f 6e67  atomically along
+000148a0: 2077 6974 6820 616e 7920 6e65 7720 7374   with any new st
+000148b0: 6174 6520 7468 6174 2072 6573 756c 7473  ate that results
+000148c0: 2066 726f 6d0a 7072 6f63 6573 7369 6e67   from.processing
+000148d0: 2074 6865 2072 6563 6f72 6465 6420 6576   the recorded ev
+000148e0: 656e 7473 2c20 616e 6420 7468 6520 636f  ents, and the co
+000148f0: 6d6d 6974 2070 6f73 6974 696f 6e73 2061  mmit positions a
+00014900: 7265 2072 6563 6f72 6465 6420 7769 7468  re recorded with
+00014910: 2061 2075 6e69 7175 656e 6573 730a 636f   a uniqueness.co
+00014920: 6e73 7472 6169 6e74 2c20 7468 656e 2074  nstraint, then t
+00014930: 6865 7265 2077 696c 6c20 6e6f 2064 616e  here will no dan
+00014940: 6765 7220 746f 2074 6865 2070 726f 6a65  ger to the proje
+00014950: 6374 6564 2073 7461 7465 2062 6563 6f6d  cted state becom
+00014960: 696e 6720 696e 636f 6e73 6973 7465 6e74  ing inconsistent
+00014970: 2064 7565 0a74 6f20 7468 6573 6520 636f   due.to these co
+00014980: 6e6e 6563 7469 6f6e 2069 7373 7565 732e  nnection issues.
+00014990: 2049 6e20 7468 6973 2063 6173 652c 2074   In this case, t
+000149a0: 6865 2063 6c69 656e 7420 7769 6c6c 2061  he client will a
+000149b0: 7574 6f6d 6174 6963 616c 6c79 2072 6563  utomatically rec
+000149c0: 6f6e 6e65 6374 2074 6f20 610a 6e6f 6465  onnect to a.node
+000149d0: 2069 6e20 7468 6520 636c 7573 7465 7220   in the cluster 
+000149e0: 7768 656e 2074 6865 2073 7562 7365 7175  when the subsequ
+000149f0: 656e 7420 6361 6c6c 2074 6f20 6120 6361  ent call to a ca
+00014a00: 7463 682d 7570 2073 7562 7363 7269 7074  tch-up subscript
+00014a10: 696f 6e20 6d65 7468 6f64 2069 7320 6d61  ion method is ma
+00014a20: 6465 2e0a 596f 7520 6a75 7374 206e 6565  de..You just nee
+00014a30: 6420 746f 2068 616e 646c 6520 7468 6520  d to handle the 
+00014a40: 6578 6365 7074 696f 6e20 7468 6174 206f  exception that o
+00014a50: 6363 7572 7320 6672 6f6d 2074 6865 2069  ccurs from the i
+00014a60: 7465 7261 746f 722c 2074 6865 6e20 7265  terator, then re
+00014a70: 6164 2079 6f75 7220 6c61 7374 0a73 6176  ad your last.sav
+00014a80: 6564 2063 6f6d 6d69 7420 706f 7369 7469  ed commit positi
+00014a90: 6f6e 2c20 616e 6420 7468 656e 2072 6573  on, and then res
+00014aa0: 7461 7274 2079 6f75 7220 6576 656e 742d  tart your event-
+00014ab0: 7072 6f63 6573 7369 6e67 2063 6f6d 706f  processing compo
+00014ac0: 6e65 6e74 2c20 7573 696e 6720 7468 6520  nent, using the 
+00014ad0: 7361 6d65 0a63 6c69 656e 7420 6f62 6a65  same.client obje
+00014ae0: 6374 2e20 5468 6520 636c 6965 6e74 2077  ct. The client w
+00014af0: 696c 6c20 7265 636f 6e6e 6563 7420 6966  ill reconnect if
+00014b00: 2074 6865 7265 2069 7320 6120 6e65 6564   there is a need
+00014b10: 2074 6f20 646f 2073 6f20 7768 656e 2074   to do so when t
+00014b20: 6865 2073 7562 7365 7175 656e 740a 6361  he subsequent.ca
+00014b30: 6c6c 2069 7320 6d61 6465 2e20 5369 6d69  ll is made. Simi
+00014b40: 6c61 726c 792c 2077 6865 6e20 7265 6164  larly, when read
+00014b50: 696e 6720 7065 7273 6973 7465 6e74 2073  ing persistent s
+00014b60: 7562 7363 7269 7074 696f 6e73 2c20 6966  ubscriptions, if
+00014b70: 2074 6865 7265 2061 7265 0a63 6f6e 6e65   there are.conne
+00014b80: 6374 6976 6974 7920 6973 7375 6573 2061  ctivity issues a
+00014b90: 6674 6572 2079 6f75 2068 6176 6520 7374  fter you have st
+00014ba0: 6172 7465 6420 6974 6572 6174 696e 6720  arted iterating 
+00014bb0: 6f76 6572 2061 2073 7563 6365 7373 6675  over a successfu
+00014bc0: 6c6c 7920 7265 6365 6976 6564 0a72 6573  lly received.res
+00014bd0: 706f 6e73 652c 2074 6865 6e20 7468 6520  ponse, then the 
+00014be0: 7365 7276 6572 2063 616c 6c20 7769 6c6c  server call will
+00014bf0: 206e 6565 6420 746f 2062 6520 7265 7374   need to be rest
+00014c00: 6172 7465 642e 2049 6e20 7468 6973 2063  arted. In this c
+00014c10: 6173 652c 2074 6865 2072 6563 6569 7665  ase, the receive
+00014c20: 640a 6576 656e 7473 2077 696c 6c20 7374  d.events will st
+00014c30: 6172 7420 7769 7468 2074 6865 206c 6173  art with the las
+00014c40: 7420 7361 7665 6420 6368 6563 6b70 6f69  t saved checkpoi
+00014c50: 6e74 206f 6e20 7468 6520 7365 7276 6572  nt on the server
+00014c60: 2028 706f 7465 6e74 6961 6c6c 7920 7265   (potentially re
+00014c70: 7475 726e 696e 670a 6576 656e 7473 2074  turning.events t
+00014c80: 6861 7420 7765 7265 2069 6e20 6661 6374  hat were in fact
+00014c90: 2073 7563 6365 7373 6675 6c6c 7920 7072   successfully pr
+00014ca0: 6f63 6573 7365 6429 2e0a 0a0a 2323 2320  ocessed)....### 
+00014cb0: 436c 6f73 650a 0a54 6865 2060 636c 6f73  Close..The `clos
+00014cc0: 6528 2960 206d 6574 686f 6420 6361 6e20  e()` method can 
+00014cd0: 6265 2075 7365 6420 746f 2063 6c65 616e  be used to clean
+00014ce0: 6c79 2063 6c6f 7365 2074 6865 2067 5250  ly close the gRP
+00014cf0: 4320 636f 6e6e 6563 7469 6f6e 2e0a 0a60  C connection...`
+00014d00: 6060 7079 7468 6f6e 0a63 6c69 656e 742e  ``python.client.
+00014d10: 636c 6f73 6528 290a 6060 600a 0a23 2320  close().```..## 
+00014d20: 4e6f 7465 730a 0a23 2323 2043 6f6e 6e65  Notes..### Conne
+00014d30: 6374 696f 6e20 7374 7269 6e67 730a 0a54  ction strings..T
+00014d40: 6865 2045 7665 6e74 5374 6f72 6544 4220  he EventStoreDB 
+00014d50: 636f 6e6e 6563 7469 6f6e 2073 7472 696e  connection strin
+00014d60: 6720 6973 2061 2055 5249 2074 6861 7420  g is a URI that 
+00014d70: 636f 6e66 6f72 6d73 2077 6974 6820 6f6e  conforms with on
+00014d80: 6520 6f66 2074 776f 2070 6f73 7369 626c  e of two possibl
+00014d90: 650a 7363 6865 6d65 732c 2065 6974 6865  e.schemes, eithe
+00014da0: 7220 7468 6520 2265 7364 6222 2073 6368  r the "esdb" sch
+00014db0: 656d 6520 6f72 2074 6865 2022 6573 6462  eme or the "esdb
+00014dc0: 2b64 6973 636f 7665 7222 2073 6368 656d  +discover" schem
+00014dd0: 652e 2054 6865 2073 796e 7461 7820 616e  e. The syntax an
+00014de0: 640a 7365 6d61 6e74 6963 7320 6f66 2074  d.semantics of t
+00014df0: 6865 2045 7665 6e74 5374 6f72 6544 4220  he EventStoreDB 
+00014e00: 5552 4920 7363 6865 6d65 7320 6172 6520  URI schemes are 
+00014e10: 6578 706c 6169 6e65 6420 6265 6c6f 772e  explained below.
+00014e20: 2054 6865 2073 796e 7461 7820 6973 0a64   The syntax is.d
+00014e30: 6566 696e 6564 2075 7369 6e67 205b 4542  efined using [EB
+00014e40: 4e46 5d28 6874 7470 733a 2f2f 656e 2e77  NF](https://en.w
+00014e50: 696b 6970 6564 6961 2e6f 7267 2f77 696b  ikipedia.org/wik
+00014e60: 692f 4578 7465 6e64 6564 5f42 6163 6b75  i/Extended_Backu
+00014e70: 73e2 8093 4e61 7572 5f66 6f72 6d29 2e0a  s...Naur_form)..
+00014e80: 0a54 6865 2022 6573 6462 2220 5552 4920  .The "esdb" URI 
+00014e90: 7363 6865 6d65 2063 616e 2062 6520 6465  scheme can be de
+00014ea0: 6669 6e65 6420 696e 2074 6865 2066 6f6c  fined in the fol
+00014eb0: 6c6f 7769 6e67 2077 6179 2e0a 0a20 2020  lowing way...   
+00014ec0: 2065 7364 622d 7572 6920 3d20 2265 7364   esdb-uri = "esd
+00014ed0: 623a 2f2f 2220 2c20 5b20 7573 6572 2d69  b://" , [ user-i
+00014ee0: 6e66 6f20 2c20 2240 2220 5d20 2c20 6772  nfo , "@" ] , gr
+00014ef0: 7063 2d74 6172 6765 742c 207b 2022 2c22  pc-target, { ","
+00014f00: 202c 2067 7270 632d 7461 7267 6574 207d   , grpc-target }
+00014f10: 202c 205b 2022 3f22 202c 2071 7565 7279   , [ "?" , query
+00014f20: 2d73 7472 696e 6720 5d20 3b0a 0a49 6e20  -string ] ;..In 
+00014f30: 7468 6520 2265 7364 6222 2055 5249 2073  the "esdb" URI s
+00014f40: 6368 656d 652c 2061 6674 6572 2074 6865  cheme, after the
+00014f50: 206f 7074 696f 6e61 6c20 7573 6572 2069   optional user i
+00014f60: 6e66 6f20 7374 7269 6e67 2c20 7468 6572  nfo string, ther
+00014f70: 6520 6d75 7374 2062 6520 6174 206c 6561  e must be at lea
+00014f80: 7374 0a6f 6e65 2067 5250 4320 7461 7267  st.one gRPC targ
+00014f90: 6574 2e20 4966 2074 6865 7265 2061 7265  et. If there are
+00014fa0: 2073 6576 6572 616c 2067 5250 4320 7461   several gRPC ta
+00014fb0: 7267 6574 732c 2074 6865 7920 6d75 7374  rgets, they must
+00014fc0: 2062 6520 7365 7061 7261 7465 6420 6672   be separated fr
+00014fd0: 6f6d 2065 6163 680a 6f74 6865 7220 7769  om each.other wi
+00014fe0: 7468 2074 6865 2022 2c22 2063 6861 7261  th the "," chara
+00014ff0: 6374 6572 2e20 4561 6368 2067 5250 4320  cter. Each gRPC 
+00015000: 7461 7267 6574 2073 686f 756c 6420 696e  target should in
+00015010: 6469 6361 7465 2061 6e20 4576 656e 7453  dicate an EventS
+00015020: 746f 7265 4442 2067 5250 430a 7365 7276  toreDB gRPC.serv
+00015030: 6572 2073 6f63 6b65 742c 2062 7920 7370  er socket, by sp
+00015040: 6563 6966 7969 6e67 2061 2068 6f73 7420  ecifying a host 
+00015050: 616e 6420 6120 706f 7274 206e 756d 6265  and a port numbe
+00015060: 7220 7365 7061 7261 7465 6420 7769 7468  r separated with
+00015070: 2074 6865 2022 3a22 2063 6861 7261 6374   the ":" charact
+00015080: 6572 2e0a 5468 6520 686f 7374 206d 6179  er..The host may
+00015090: 2062 6520 6120 686f 7374 6e61 6d65 2074   be a hostname t
+000150a0: 6861 7420 6361 6e20 6265 2072 6573 6f6c  hat can be resol
+000150b0: 7665 6420 746f 2061 6e20 4950 2061 6464  ved to an IP add
+000150c0: 7265 7373 2c20 6f72 2061 6e20 4950 2061  ress, or an IP a
+000150d0: 6464 7265 7373 2e0a 0a20 2020 2067 7270  ddress...    grp
+000150e0: 632d 7461 7267 6574 203d 2028 2068 6f73  c-target = ( hos
+000150f0: 746e 616d 6520 7c20 6970 2d61 6464 7265  tname | ip-addre
+00015100: 7373 2029 202c 2022 3a22 202c 2070 6f72  ss ) , ":" , por
+00015110: 742d 6e75 6d62 6572 203b 0a0a 0a54 6865  t-number ;...The
+00015120: 2022 6573 6462 2b64 6973 636f 7665 7222   "esdb+discover"
+00015130: 2055 5249 2073 6368 656d 6520 6361 6e20   URI scheme can 
+00015140: 6265 2064 6566 696e 6564 2069 6e20 7468  be defined in th
+00015150: 6520 666f 6c6c 6f77 696e 6720 7761 792e  e following way.
+00015160: 0a0a 2020 2020 6573 6462 2d64 6973 636f  ..    esdb-disco
+00015170: 7665 722d 7572 6920 3d20 2265 7364 622b  ver-uri = "esdb+
+00015180: 6469 7363 6f76 6572 3a2f 2f22 202c 205b  discover://" , [
+00015190: 2075 7365 722d 696e 666f 2c20 2240 2220   user-info, "@" 
+000151a0: 5d20 2c20 636c 7573 7465 722d 646f 6d61  ] , cluster-doma
+000151b0: 696e 6e61 6d65 202c 205b 2022 3f22 202c  inname , [ "?" ,
+000151c0: 2071 7565 7279 2d73 7472 696e 6720 5d20   query-string ] 
+000151d0: 3b0a 0a49 6e20 7468 6520 2265 7364 622b  ;..In the "esdb+
+000151e0: 6469 7363 6f76 6572 2220 5552 4920 7363  discover" URI sc
+000151f0: 6865 6d65 2c20 6166 7465 7220 7468 6520  heme, after the 
+00015200: 7573 6572 2069 6e66 6f20 7374 7269 6e67  user info string
+00015210: 2c20 7468 6572 6520 6d75 7374 2062 6520  , there must be 
+00015220: 6120 646f 6d61 696e 0a6e 616d 6520 7768  a domain.name wh
+00015230: 6963 6820 7368 6f75 6c64 2069 6465 6e74  ich should ident
+00015240: 6966 7920 6120 636c 7573 7465 7220 6f66  ify a cluster of
+00015250: 2045 7665 6e74 5374 6f72 6544 4220 7365   EventStoreDB se
+00015260: 7276 6572 732e 2054 6865 2063 6c69 656e  rvers. The clien
+00015270: 7420 7769 6c6c 2075 7365 2061 2044 4e53  t will use a DNS
+00015280: 0a73 6572 7665 7220 746f 2072 6573 6f6c  .server to resol
+00015290: 7665 2074 6865 2064 6f6d 6169 6e20 6e61  ve the domain na
+000152a0: 6d65 2074 6f20 6120 6c69 7374 206f 6620  me to a list of 
+000152b0: 6164 6472 6573 7365 7320 6f66 2045 7665  addresses of Eve
+000152c0: 6e74 5374 6f72 6544 4220 7365 7276 6572  ntStoreDB server
+000152d0: 732c 0a62 7920 7175 6572 7969 6e67 2066  s,.by querying f
+000152e0: 6f72 2027 4127 2072 6563 6f72 6473 2e20  or 'A' records. 
+000152f0: 496e 2074 6869 7320 6361 7365 2c20 7468  In this case, th
+00015300: 6520 706f 7274 206e 756d 6265 7220 2232  e port number "2
+00015310: 3131 3322 2077 696c 6c20 6265 2075 7365  113" will be use
+00015320: 6420 746f 0a63 6f6e 7374 7275 6374 2067  d to.construct g
+00015330: 5250 4320 7461 7267 6574 7320 6672 6f6d  RPC targets from
+00015340: 2074 6865 2061 6464 7265 7373 6573 206f   the addresses o
+00015350: 6274 6169 6e65 6420 6672 6f6d 2027 4127  btained from 'A'
+00015360: 2072 6563 6f72 6473 2070 726f 7669 6465   records provide
+00015370: 6420 6279 2074 6865 0a44 4e53 2073 6572  d by the.DNS ser
+00015380: 7665 722e 2054 6865 7265 666f 7265 2c20  ver. Therefore, 
+00015390: 6966 2079 6f75 2077 616e 7420 746f 2075  if you want to u
+000153a0: 7365 2074 6865 2022 6573 6462 2b64 6973  se the "esdb+dis
+000153b0: 636f 7665 7222 2055 5249 2073 6368 656d  cover" URI schem
+000153c0: 652c 2079 6f75 2077 696c 6c0a 6e65 6564  e, you will.need
+000153d0: 2074 6f20 636f 6e66 6967 7572 6520 444e   to configure DN
+000153e0: 5320 7768 656e 2073 6574 7469 6e67 2075  S when setting u
+000153f0: 7020 796f 7572 2045 7665 6e74 5374 6f72  p your EventStor
+00015400: 6544 4220 636c 7573 7465 722e 0a0a 5769  eDB cluster...Wi
+00015410: 7468 2062 6f74 6820 7468 6520 2265 7364  th both the "esd
+00015420: 6222 2061 6e64 2022 6573 6462 2b64 6973  b" and "esdb+dis
+00015430: 6f63 7665 7222 2055 5249 2073 6368 656d  ocver" URI schem
+00015440: 6573 2c20 7468 6520 636c 6965 6e74 2066  es, the client f
+00015450: 6972 7374 6c79 206f 6274 6169 6e73 0a61  irstly obtains.a
+00015460: 206c 6973 7420 6f66 2067 5250 4320 7461   list of gRPC ta
+00015470: 7267 6574 733a 2065 6974 6865 7220 6469  rgets: either di
+00015480: 7265 6374 6c79 2066 726f 6d20 2265 7364  rectly from "esd
+00015490: 6222 2063 6f6e 6e65 6374 696f 6e20 7374  b" connection st
+000154a0: 7269 6e67 733b 206f 7220 696e 6469 7265  rings; or indire
+000154b0: 6374 6c79 0a66 726f 6d20 2265 7364 622b  ctly.from "esdb+
+000154c0: 6469 7363 6f76 6572 2220 636f 6e6e 6563  discover" connec
+000154d0: 7469 6f6e 2073 7472 696e 6773 2076 6961  tion strings via
+000154e0: 2044 4e53 2e20 5468 6973 206c 6973 7420   DNS. This list 
+000154f0: 6f66 2074 6172 6765 7473 2069 7320 6b6e  of targets is kn
+00015500: 6f77 6e20 6173 2074 6865 0a22 676f 7373  own as the."goss
+00015510: 6970 2073 6565 6422 2e20 5468 6520 636c  ip seed". The cl
+00015520: 6965 6e74 2077 696c 6c20 7468 656e 2061  ient will then a
+00015530: 7474 656d 7074 2074 6f20 636f 6e6e 6563  ttempt to connec
+00015540: 7420 746f 2065 6163 6820 6752 5043 2074  t to each gRPC t
+00015550: 6172 6765 7420 696e 2074 7572 6e2c 0a61  arget in turn,.a
+00015560: 7474 656d 7074 696e 6720 746f 2063 616c  ttempting to cal
+00015570: 6c20 7468 6520 4576 656e 7453 746f 7265  l the EventStore
+00015580: 4442 2047 6f73 7369 7020 4150 4920 746f  DB Gossip API to
+00015590: 206f 6274 6169 6e20 696e 666f 726d 6174   obtain informat
+000155a0: 696f 6e20 6162 6f75 7420 7468 650a 4576  ion about the.Ev
+000155b0: 656e 7453 746f 7265 4442 2063 6c75 7374  entStoreDB clust
+000155c0: 6572 2e20 4120 6d65 6d62 6572 206f 6620  er. A member of 
+000155d0: 7468 6520 636c 7573 7465 7220 6973 2073  the cluster is s
+000155e0: 656c 6563 7465 6420 6279 2074 6865 2063  elected by the c
+000155f0: 6c69 656e 742c 2061 6363 6f72 6469 6e67  lient, according
+00015600: 0a74 6f20 7468 6520 226e 6f64 6520 7072  .to the "node pr
+00015610: 6566 6572 656e 6365 2220 6f70 7469 6f6e  eference" option
+00015620: 2e20 5468 6520 636c 6965 6e74 206d 6179  . The client may
+00015630: 2074 6865 6e20 6e65 6564 2074 6f20 636c   then need to cl
+00015640: 6f73 6520 6974 730a 636f 6e6e 6563 7469  ose its.connecti
+00015650: 6f6e 2061 6e64 2072 6563 6f6e 6e65 6374  on and reconnect
+00015660: 2074 6f20 7468 6520 7365 6c65 6374 6564   to the selected
+00015670: 2073 6572 7665 722e 0a0a 496e 2062 6f74   server...In bot
+00015680: 6820 7468 6520 2265 7364 6222 2061 6e64  h the "esdb" and
+00015690: 2022 6573 6462 2b64 6973 636f 7665 7222   "esdb+discover"
+000156a0: 2073 6368 656d 6573 2c20 7468 6520 5552   schemes, the UR
+000156b0: 4920 6d61 7920 696e 636c 7564 6520 6120  I may include a 
+000156c0: 7573 6572 2069 6e66 6f20 7374 7269 6e67  user info string
+000156d0: 2e0a 4966 2069 7420 6578 6973 7473 2069  ..If it exists i
+000156e0: 6e20 7468 6520 5552 492c 2074 6865 2075  n the URI, the u
+000156f0: 7365 7220 696e 666f 2073 7472 696e 6720  ser info string 
+00015700: 6d75 7374 2062 6520 7365 7061 7261 7465  must be separate
+00015710: 6420 6672 6f6d 2074 6865 2072 6573 7420  d from the rest 
+00015720: 6f66 2074 6865 2055 5249 0a77 6974 6820  of the URI.with 
+00015730: 7468 6520 2240 2220 6368 6172 6163 7465  the "@" characte
+00015740: 722e 2054 6865 2075 7365 7220 696e 666f  r. The user info
+00015750: 2073 7472 696e 6720 6d75 7374 2069 6e63   string must inc
+00015760: 6c75 6465 2061 2075 7365 726e 616d 6520  lude a username 
+00015770: 616e 6420 6120 7061 7373 776f 7264 2c0a  and a password,.
+00015780: 7365 7061 7261 7465 6420 7769 7468 2074  separated with t
+00015790: 6865 2022 3a22 2063 6861 7261 6374 6572  he ":" character
+000157a0: 2e0a 0a20 2020 2075 7365 722d 696e 666f  ...    user-info
+000157b0: 203d 2075 7365 726e 616d 6520 2c20 223a   = username , ":
+000157c0: 2220 2c20 7061 7373 776f 7264 203b 0a0a  " , password ;..
+000157d0: 5468 6520 7573 6572 2069 6e66 6f20 6973  The user info is
+000157e0: 2073 656e 7420 6279 2074 6865 2063 6c69   sent by the cli
+000157f0: 656e 7420 6173 2022 6361 6c6c 2063 7265  ent as "call cre
+00015800: 6465 6e74 6961 6c73 2220 696e 2065 6163  dentials" in eac
+00015810: 6820 6361 6c6c 2074 6f20 6120 2273 6563  h call to a "sec
+00015820: 7572 6522 0a73 6572 7665 722c 2069 6e20  ure".server, in 
+00015830: 6120 2262 6173 6963 2061 7574 6822 2061  a "basic auth" a
+00015840: 7574 686f 7269 7a61 7469 6f6e 2068 6561  uthorization hea
+00015850: 6465 722e 2054 6869 7320 6175 7468 6f72  der. This author
+00015860: 697a 6174 696f 6e20 6865 6164 6572 2069  ization header i
+00015870: 7320 7573 6564 2062 790a 7468 6520 7365  s used by.the se
+00015880: 7276 6572 2074 6f20 6175 7468 656e 7469  rver to authenti
+00015890: 6361 7465 2074 6865 2063 6c69 656e 742e  cate the client.
+000158a0: 2054 6865 2061 7574 686f 7269 7a61 7469   The authorizati
+000158b0: 6f6e 2068 6561 6465 7220 6973 206e 6f74  on header is not
+000158c0: 2073 656e 7420 746f 0a22 696e 7365 6375   sent to."insecu
+000158d0: 7265 2220 7365 7276 6572 732e 0a0a 496e  re" servers...In
+000158e0: 2062 6f74 6820 7468 6520 2265 7364 6222   both the "esdb"
+000158f0: 2061 6e64 2022 6573 6462 2b64 6973 636f   and "esdb+disco
+00015900: 7665 7222 2073 6368 656d 6573 2c20 7468  ver" schemes, th
+00015910: 6520 6f70 7469 6f6e 616c 2071 7565 7279  e optional query
+00015920: 2073 7472 696e 6720 6d75 7374 2062 6520   string must be 
+00015930: 6f6e 650a 6f72 206d 616e 7920 6669 656c  one.or many fiel
+00015940: 642d 7661 6c75 6520 6172 6775 6d65 6e74  d-value argument
+00015950: 732c 2073 6570 6172 6174 6564 2066 726f  s, separated fro
+00015960: 6d20 6561 6368 206f 7468 6572 2077 6974  m each other wit
+00015970: 6820 7468 6520 2226 2220 6368 6172 6163  h the "&" charac
+00015980: 7465 722e 0a0a 2020 2020 7175 6572 792d  ter...    query-
+00015990: 7374 7269 6e67 203d 2066 6965 6c64 2d76  string = field-v
+000159a0: 616c 7565 2c20 7b20 2226 222c 2066 6965  alue, { "&", fie
+000159b0: 6c64 2d76 616c 7565 207d 203b 0a0a 4561  ld-value } ;..Ea
+000159c0: 6368 2066 6965 6c64 2d76 616c 7565 2061  ch field-value a
+000159d0: 7267 756d 656e 7420 6d75 7374 2062 6520  rgument must be 
+000159e0: 6f6e 6520 6f66 2074 6865 2073 7570 706f  one of the suppo
+000159f0: 7274 6564 2066 6965 6c64 732c 2061 6e64  rted fields, and
+00015a00: 2061 6e0a 6170 7072 6f70 7269 6174 6520   an.appropriate 
+00015a10: 7661 6c75 652c 2073 6570 6172 6174 6564  value, separated
+00015a20: 2077 6974 6820 7468 6520 223d 2220 6368   with the "=" ch
+00015a30: 6172 6163 7465 722e 0a0a 2020 2020 6669  aracter...    fi
+00015a40: 656c 642d 7661 6c75 6520 3d20 2820 2254  eld-value = ( "T
+00015a50: 6c73 222c 2022 3d22 202c 2022 7472 7565  ls", "=" , "true
+00015a60: 2220 7c20 2266 616c 7365 2220 290a 2020  " | "false" ).  
+00015a70: 2020 2020 2020 2020 2020 2020 2020 7c20                | 
+00015a80: 2820 2254 6c73 5665 7269 6679 4365 7274  ( "TlsVerifyCert
+00015a90: 222c 2022 3d22 202c 2022 7472 7565 2220  ", "=" , "true" 
+00015aa0: 7c20 2266 616c 7365 2220 290a 2020 2020  | "false" ).    
+00015ab0: 2020 2020 2020 2020 2020 2020 7c20 2820              | ( 
+00015ac0: 2243 6f6e 6e65 6374 696f 6e4e 616d 6522  "ConnectionName"
+00015ad0: 2c20 223d 2220 2c20 7374 7269 6e67 2029  , "=" , string )
+00015ae0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00015af0: 207c 2028 2022 4e6f 6465 5072 6566 6572   | ( "NodePrefer
+00015b00: 656e 6365 222c 2022 3d22 202c 2022 6c65  ence", "=" , "le
+00015b10: 6164 6572 2220 7c20 2266 6f6c 6c6f 7765  ader" | "followe
+00015b20: 7222 207c 2022 7265 6164 6f6e 6c79 7265  r" | "readonlyre
+00015b30: 706c 6963 6122 207c 2022 7261 6e64 6f6d  plica" | "random
+00015b40: 2220 290a 2020 2020 2020 2020 2020 2020  " ).            
+00015b50: 2020 2020 7c20 2820 2244 6566 6175 6c74      | ( "Default
+00015b60: 4465 6164 6c69 6e65 222c 2022 3d22 202c  Deadline", "=" ,
+00015b70: 2069 6e74 6567 6572 2029 0a20 2020 2020   integer ).     
+00015b80: 2020 2020 2020 2020 2020 207c 2028 2022             | ( "
+00015b90: 476f 7373 6970 5469 6d65 6f75 7422 2c20  GossipTimeout", 
+00015ba0: 223d 2220 2c20 696e 7465 6765 7220 290a  "=" , integer ).
+00015bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015bc0: 7c20 2820 224d 6178 4469 7363 6f76 6572  | ( "MaxDiscover
+00015bd0: 4174 7465 6d70 7473 222c 2022 3d22 202c  Attempts", "=" ,
+00015be0: 2069 6e74 6567 6572 2029 0a20 2020 2020   integer ).     
+00015bf0: 2020 2020 2020 2020 2020 207c 2028 2022             | ( "
+00015c00: 4469 7363 6f76 6572 7949 6e74 6572 7661  DiscoveryInterva
+00015c10: 6c22 2c20 223d 2220 2c20 696e 7465 6765  l", "=" , intege
+00015c20: 7220 290a 2020 2020 2020 2020 2020 2020  r ).            
+00015c30: 2020 2020 7c20 2820 224d 6178 4469 7363      | ( "MaxDisc
+00015c40: 6f76 6572 4174 7465 6d70 7473 222c 2022  overAttempts", "
+00015c50: 3d22 202c 2069 6e74 6567 6572 2029 0a20  =" , integer ). 
+00015c60: 2020 2020 2020 2020 2020 2020 2020 207c                 |
+00015c70: 2028 2022 4b65 6570 416c 6976 6549 6e74   ( "KeepAliveInt
+00015c80: 6572 7661 6c22 2c20 223d 2220 2c20 696e  erval", "=" , in
+00015c90: 7465 6765 7220 290a 2020 2020 2020 2020  teger ).        
+00015ca0: 2020 2020 2020 2020 7c20 2820 224b 6565          | ( "Kee
+00015cb0: 7041 6c69 7665 496e 7465 7276 616c 222c  pAliveInterval",
+00015cc0: 2022 3d22 202c 2069 6e74 6567 6572 2029   "=" , integer )
+00015cd0: 203b 0a0a 5468 6520 7461 626c 6520 6265   ;..The table be
+00015ce0: 6c6f 7720 6465 7363 7269 6265 7320 7468  low describes th
+00015cf0: 6520 7175 6572 7920 6669 656c 642d 7661  e query field-va
+00015d00: 6c75 6573 2073 7570 706f 7274 6564 2062  lues supported b
+00015d10: 7920 7468 6973 2063 6c69 656e 742e 0a0a  y this client...
+00015d20: 7c20 4669 656c 6420 2020 2020 2020 2020  | Field         
+00015d30: 2020 2020 2020 7c20 5661 6c75 6520 2020        | Value   
+00015d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015d70: 2020 2020 2020 2020 2020 2020 2020 7c20                | 
+00015d80: 4465 7363 7269 7074 696f 6e20 2020 2020  Description     
+00015d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015e20: 2020 7c0a 7c2d 2d2d 2d2d 2d2d 2d2d 2d2d    |.|-----------
+00015e30: 2d2d 2d2d 2d2d 2d2d 2d2d 7c2d 2d2d 2d2d  ----------|-----
+00015e40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00015e50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00015e60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00015e70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00015e80: 2d2d 7c2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  --|-------------
+00015e90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00015ea0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00015eb0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00015ec0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00015ed0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00015ee0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00015ef0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00015f00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00015f10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00015f20: 2d2d 2d2d 2d2d 7c0a 7c20 546c 7320 2020  ------|.| Tls   
+00015f30: 2020 2020 2020 2020 2020 2020 2020 7c20                | 
+00015f40: 2274 7275 6522 2c20 2266 616c 7365 2220  "true", "false" 
+00015f50: 2864 6566 6175 6c74 3a20 2274 7275 6522  (default: "true"
+00015f60: 2920 2020 2020 2020 2020 2020 2020 2020  )               
+00015f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015f80: 2020 2020 2020 7c20 4966 2022 7472 7565        | If "true
+00015f90: 2220 7468 6520 636c 6965 6e74 2077 696c  " the client wil
+00015fa0: 6c20 6372 6561 7465 2061 2022 7365 6375  l create a "secu
+00015fb0: 7265 2220 6752 5043 2063 6861 6e6e 656c  re" gRPC channel
+00015fc0: 2e20 4966 2022 6661 6c73 6522 2074 6865  . If "false" the
+00015fd0: 2063 6c69 656e 7420 7769 6c6c 2063 7265   client will cre
+00015fe0: 6174 6520 616e 2022 696e 7365 6375 7265  ate an "insecure
+00015ff0: 2220 6752 5043 2063 6861 6e6e 656c 2e20  " gRPC channel. 
+00016000: 5468 6973 206d 7573 7420 6d61 7463 6820  This must match 
+00016010: 7468 6520 7365 7276 6572 2063 6f6e 6669  the server confi
+00016020: 6775 7261 7469 6f6e 2e20 7c0a 7c20 546c  guration. |.| Tl
+00016030: 7356 6572 6966 7943 6572 7420 2020 2020  sVerifyCert     
+00016040: 2020 7c20 2274 7275 6522 2c20 2266 616c    | "true", "fal
+00016050: 7365 2220 2864 6566 6175 6c74 3a20 2274  se" (default: "t
+00016060: 7275 6522 2920 2020 2020 2020 2020 2020  rue")           
+00016070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016080: 2020 2020 2020 2020 2020 7c20 5468 6973            | This
+00016090: 2076 616c 7565 2069 7320 6375 7272 656e   value is curren
+000160a0: 746c 7920 6967 6e6f 7265 642e 2020 2020  tly ignored.    
+000160b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000160c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000160d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000160e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000160f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016120: 2020 2020 2020 2020 2020 2020 2020 7c0a                |.
+00016130: 7c20 436f 6e6e 6563 7469 6f6e 4e61 6d65  | ConnectionName
+00016140: 2020 2020 2020 7c20 7374 7269 6e67 2028        | string (
+00016150: 6465 6661 756c 743a 2061 7574 6f2d 6765  default: auto-ge
+00016160: 6e65 7261 7465 6420 7665 7273 696f 6e2d  nerated version-
+00016170: 3420 5555 4944 2920 2020 2020 2020 2020  4 UUID)         
+00016180: 2020 2020 2020 2020 2020 2020 2020 7c20                | 
+00016190: 5365 6e74 2069 6e20 6361 6c6c 206d 6574  Sent in call met
+000161a0: 6164 6174 6120 666f 7220 6576 6572 7920  adata for every 
+000161b0: 6361 6c6c 2c20 746f 2069 6465 6e74 6966  call, to identif
+000161c0: 7920 7468 6520 636c 6965 6e74 2074 6f20  y the client to 
+000161d0: 7468 6520 636c 7573 7465 722e 2020 2020  the cluster.    
+000161e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000161f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016230: 2020 7c0a 7c20 4e6f 6465 5072 6566 6572    |.| NodePrefer
+00016240: 656e 6365 2020 2020 2020 7c20 226c 6561  ence      | "lea
+00016250: 6465 7222 2c20 2266 6f6c 6c6f 7765 7222  der", "follower"
+00016260: 2c20 2272 6561 646f 6e6c 7972 6570 6c69  , "readonlyrepli
+00016270: 6361 222c 2022 7261 6e64 6f6d 2220 2864  ca", "random" (d
+00016280: 6566 6175 6c74 3a20 226c 6561 6465 7222  efault: "leader"
+00016290: 2920 7c20 5468 6520 6e6f 6465 2073 7461  ) | The node sta
+000162a0: 7465 2070 7265 6665 7272 6564 2062 7920  te preferred by 
+000162b0: 7468 6520 636c 6965 6e74 2e20 5468 6520  the client. The 
+000162c0: 636c 6965 6e74 2077 696c 6c20 7365 6c65  client will sele
+000162d0: 6374 2061 206e 6f64 6520 6672 6f6d 2074  ct a node from t
+000162e0: 6865 2063 6c75 7374 6572 2069 6e66 6f20  he cluster info 
+000162f0: 7265 6365 6976 6564 2066 726f 6d20 7468  received from th
+00016300: 6520 476f 7373 6970 2041 5049 2061 6363  e Gossip API acc
+00016310: 6f72 6469 6e67 2074 6f20 7468 6973 2070  ording to this p
+00016320: 7265 6665 7265 6e63 652e 2020 2020 2020  reference.      
+00016330: 2020 2020 2020 7c0a 7c20 4465 6661 756c        |.| Defaul
+00016340: 7444 6561 646c 696e 6520 2020 2020 7c20  tDeadline     | 
+00016350: 696e 7465 6765 7220 2864 6566 6175 6c74  integer (default
+00016360: 3a20 604e 6f6e 6560 2920 2020 2020 2020  : `None`)       
+00016370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016390: 2020 2020 2020 7c20 5468 6520 6465 6661        | The defa
+000163a0: 756c 7420 7661 6c75 6520 2869 6e20 7365  ult value (in se
+000163b0: 636f 6e64 7329 206f 6620 7468 6520 6074  conds) of the `t
+000163c0: 696d 656f 7574 6020 6172 6775 6d65 6e74  imeout` argument
+000163d0: 206f 6620 636c 6965 6e74 2022 7772 6974   of client "writ
+000163e0: 6522 206d 6574 686f 6473 2073 7563 6820  e" methods such 
+000163f0: 6173 2060 6170 7065 6e64 5f65 7665 6e74  as `append_event
+00016400: 7328 2960 2e20 2020 2020 2020 2020 2020  s()`.           
+00016410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016430: 2020 2020 2020 2020 2020 7c0a 7c20 476f            |.| Go
+00016440: 7373 6970 5469 6d65 6f75 7420 2020 2020  ssipTimeout     
+00016450: 2020 7c20 696e 7465 6765 7220 2864 6566    | integer (def
+00016460: 6175 6c74 3a20 3529 2020 2020 2020 2020  ault: 5)        
+00016470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016490: 2020 2020 2020 2020 2020 7c20 5468 6520            | The 
+000164a0: 6465 6661 756c 7420 7661 6c75 6520 2869  default value (i
+000164b0: 6e20 7365 636f 6e64 7329 206f 6620 7468  n seconds) of th
+000164c0: 6520 6074 696d 656f 7574 6020 6172 6775  e `timeout` argu
+000164d0: 6d65 6e74 206f 6620 676f 7373 6970 2072  ment of gossip r
+000164e0: 6561 6420 6d65 7468 6f64 732c 2073 7563  ead methods, suc
+000164f0: 6820 6173 2060 7265 6164 5f67 6f73 7369  h as `read_gossi
+00016500: 7028 2960 2e20 2020 2020 2020 2020 2020  p()`.           
+00016510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016530: 2020 2020 2020 2020 2020 2020 2020 7c0a                |.
+00016540: 7c20 4d61 7844 6973 636f 7665 7241 7474  | MaxDiscoverAtt
+00016550: 656d 7074 7320 7c20 696e 7465 6765 7220  empts | integer 
+00016560: 2864 6566 6175 6c74 3a20 3130 2920 2020  (default: 10)   
+00016570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016590: 2020 2020 2020 2020 2020 2020 2020 7c20                | 
+000165a0: 5468 6520 6e75 6d62 6572 206f 6620 6174  The number of at
+000165b0: 7465 6d70 7473 2074 6f20 7265 6164 2067  tempts to read g
+000165c0: 6f73 7369 7020 7768 656e 2063 6f6e 6e65  ossip when conne
+000165d0: 6374 696e 6720 6f72 2072 6563 6f6e 6e65  cting or reconne
+000165e0: 6374 696e 6720 746f 2061 2063 6c75 7374  cting to a clust
+000165f0: 6572 206d 656d 6265 722e 2020 2020 2020  er member.      
+00016600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016640: 2020 7c0a 7c20 4469 7363 6f76 6572 7949    |.| DiscoveryI
+00016650: 6e74 6572 7661 6c20 2020 7c20 696e 7465  nterval   | inte
+00016660: 6765 7220 2864 6566 6175 6c74 3a20 3130  ger (default: 10
+00016670: 3029 2020 2020 2020 2020 2020 2020 2020  0)              
+00016680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000166a0: 2020 7c20 486f 7720 6c6f 6e67 2074 6f20    | How long to 
+000166b0: 7761 6974 2028 696e 206d 696c 6c69 7365  wait (in millise
+000166c0: 636f 6e64 7329 2062 6574 7765 656e 2067  conds) between g
+000166d0: 6f73 7369 7020 7265 7472 6965 732e 2020  ossip retries.  
+000166e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000166f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016740: 2020 2020 2020 7c0a 7c20 4b65 6570 416c        |.| KeepAl
+00016750: 6976 6549 6e74 6572 7661 6c20 2020 7c20  iveInterval   | 
+00016760: 696e 7465 6765 7220 2864 6566 6175 6c74  integer (default
+00016770: 3a20 604e 6f6e 6560 2920 2020 2020 2020  : `None`)       
+00016780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000167a0: 2020 2020 2020 7c20 5468 6520 7661 6c75        | The valu
+000167b0: 6520 6f66 2074 6865 2022 6772 7063 2e6b  e of the "grpc.k
+000167c0: 6565 7061 6c69 7665 5f6d 7322 2067 5250  eepalive_ms" gRP
+000167d0: 4320 6368 616e 6e65 6c20 6f70 7469 6f6e  C channel option
+000167e0: 2e20 2020 2020 2020 2020 2020 2020 2020  .               
+000167f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016840: 2020 2020 2020 2020 2020 7c0a 7c20 4b65            |.| Ke
+00016850: 6570 416c 6976 6554 696d 656f 7574 2020  epAliveTimeout  
+00016860: 2020 7c20 696e 7465 6765 7220 2864 6566    | integer (def
+00016870: 6175 6c74 3a20 604e 6f6e 6560 2920 2020  ault: `None`)   
+00016880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000168a0: 2020 2020 2020 2020 2020 7c20 5468 6520            | The 
+000168b0: 7661 6c75 6520 6f66 2074 6865 2022 6772  value of the "gr
+000168c0: 7063 2e6b 6565 7061 6c69 7665 5f74 696d  pc.keepalive_tim
+000168d0: 656f 7574 5f6d 7322 2067 5250 4320 6368  eout_ms" gRPC ch
+000168e0: 616e 6e65 6c20 6f70 7469 6f6e 2e20 2020  annel option.   
+000168f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016910: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016940: 2020 2020 2020 2020 2020 2020 2020 7c0a                |.
+00016950: 0a0a 4865 7265 2061 7265 2073 6f6d 6520  ..Here are some 
+00016960: 6578 616d 706c 6573 206f 6620 4576 656e  examples of Even
+00016970: 7453 746f 7265 4442 2063 6f6e 6e65 6374  tStoreDB connect
+00016980: 696f 6e20 7374 7269 6e67 2055 5249 732e  ion string URIs.
+00016990: 0a0a 2020 2020 2320 4765 7420 636c 7573  ..    # Get clus
+000169a0: 7465 7220 696e 666f 2066 726f 6d20 7365  ter info from se
+000169b0: 6375 7265 2073 6572 7665 7220 736f 636b  cure server sock
+000169c0: 6574 206c 6f63 616c 686f 7374 3a32 3131  et localhost:211
+000169d0: 332c 0a20 2020 2023 2061 6e64 2075 7365  3,.    # and use
+000169e0: 2022 6164 6d69 6e22 2061 6e64 2022 6368   "admin" and "ch
+000169f0: 616e 6765 6974 2220 6173 2075 7365 726e  angeit" as usern
+00016a00: 616d 6520 616e 6420 7061 7373 776f 7264  ame and password
+00016a10: 0a20 2020 2023 2077 6865 6e20 6d61 6b69  .    # when maki
+00016a20: 6e67 2063 616c 6c73 2074 6f20 4576 656e  ng calls to Even
+00016a30: 7453 746f 7265 4442 2041 5049 206d 6574  tStoreDB API met
+00016a40: 686f 6473 2e0a 0a20 2020 2065 7364 623a  hods...    esdb:
+00016a50: 2f2f 6164 6d69 6e3a 6368 616e 6765 6974  //admin:changeit
+00016a60: 406c 6f63 616c 686f 7374 3a32 3131 330a  @localhost:2113.
+00016a70: 0a0a 2020 2020 2320 4765 7420 636c 7573  ..    # Get clus
+00016a80: 7465 7220 696e 666f 2066 726f 6d20 696e  ter info from in
+00016a90: 7365 6375 7265 2073 6572 7665 7220 736f  secure server so
+00016aa0: 636b 6574 2031 3237 2e30 2e30 2e31 3a32  cket 127.0.0.1:2
+00016ab0: 3131 340a 0a20 2020 2065 7364 623a 2f2f  114..    esdb://
+00016ac0: 3132 372e 302e 302e 313a 3231 3134 3f54  127.0.0.1:2114?T
+00016ad0: 6c73 3d66 616c 7365 0a0a 0a20 2020 2023  ls=false...    #
+00016ae0: 2047 6574 2063 6c75 7374 6572 2069 6e66   Get cluster inf
+00016af0: 6f20 6672 6f6d 2061 6464 7265 7373 6573  o from addresses
+00016b00: 2069 6e20 2741 2720 7265 636f 7264 7320   in 'A' records 
+00016b10: 666f 7220 636c 7573 7465 7231 2e65 7861  for cluster1.exa
+00016b20: 6d70 6c65 2e63 6f6d 2c0a 2020 2020 2320  mple.com,.    # 
+00016b30: 616e 6420 7573 6520 6120 6465 6661 756c  and use a defaul
+00016b40: 7420 6465 6164 6c69 6e65 2066 6f72 206d  t deadline for m
+00016b50: 616b 696e 6720 6361 6c6c 7320 746f 2045  aking calls to E
+00016b60: 7665 6e74 5374 6f72 6520 4150 4920 6d65  ventStore API me
+00016b70: 7468 6f64 2e0a 0a20 2020 2065 7364 622b  thod...    esdb+
+00016b80: 6469 7363 6f76 6572 3a2f 2f61 646d 696e  discover://admin
+00016b90: 3a63 6861 6e67 6569 7440 636c 7573 7465  :changeit@cluste
+00016ba0: 7231 2e65 7861 6d70 6c65 2e63 6f6d 3f44  r1.example.com?D
+00016bb0: 6566 6175 6c74 4465 6164 6c69 6e65 3d35  efaultDeadline=5
+00016bc0: 0a0a 0a20 2020 2023 2047 6574 2063 6c75  ...    # Get clu
+00016bd0: 7374 6572 2069 6e66 6f20 6672 6f6d 2065  ster info from e
+00016be0: 6974 6865 7220 6c6f 6361 6c68 6f73 743a  ither localhost:
+00016bf0: 3231 3131 206f 7220 6c6f 6361 6c68 6f73  2111 or localhos
+00016c00: 743a 3231 3132 206f 720a 2020 2020 2320  t:2112 or.    # 
+00016c10: 6c6f 6361 6c68 6f73 743a 3231 3133 2c20  localhost:2113, 
+00016c20: 616e 6420 7468 656e 2063 6f6e 6e65 6374  and then connect
+00016c30: 2074 6f20 6120 666f 6c6c 6f77 6572 206e   to a follower n
+00016c40: 6f64 6520 696e 2074 6865 2063 6c75 7374  ode in the clust
+00016c50: 6572 2e0a 0a20 2020 2065 7364 623a 2f2f  er...    esdb://
+00016c60: 6164 6d69 6e3a 6368 616e 6765 6974 406c  admin:changeit@l
+00016c70: 6f63 616c 686f 7374 3a32 3131 312c 6c6f  ocalhost:2111,lo
+00016c80: 6361 6c68 6f73 743a 3231 3132 2c6c 6f63  calhost:2112,loc
+00016c90: 616c 686f 7374 3a32 3131 333f 4e6f 6465  alhost:2113?Node
+00016ca0: 5072 6566 6572 656e 6365 3d66 6f6c 6c6f  Preference=follo
+00016cb0: 7765 720a 0a0a 2020 2020 2320 4765 7420  wer...    # Get 
+00016cc0: 636c 7573 7465 7220 696e 666f 2066 726f  cluster info fro
+00016cd0: 6d20 6164 6472 6573 7365 7320 696e 2027  m addresses in '
+00016ce0: 4127 2072 6563 6f72 6473 2066 6f72 2063  A' records for c
+00016cf0: 6c75 7374 6572 312e 6578 616d 706c 652e  luster1.example.
+00016d00: 636f 6d2c 0a20 2020 2023 2061 6e64 2063  com,.    # and c
+00016d10: 6f6e 6669 6775 7265 2022 6b65 6570 2061  onfigure "keep a
+00016d20: 6c69 7665 2220 7469 6d65 6f75 7420 616e  live" timeout an
+00016d30: 6420 696e 7465 7276 616c 2069 6e20 7468  d interval in th
+00016d40: 6520 6752 5043 2063 6861 6e6e 656c 2e0a  e gRPC channel..
+00016d50: 0a20 2020 2065 7364 622b 6469 7363 6f76  .    esdb+discov
+00016d60: 6572 3a2f 2f61 646d 696e 3a63 6861 6e67  er://admin:chang
+00016d70: 6569 7440 636c 7573 7465 7231 2e65 7861  eit@cluster1.exa
+00016d80: 6d70 6c65 2e63 6f6d 3f4b 6565 7041 6c69  mple.com?KeepAli
+00016d90: 7665 496e 7465 7276 616c 3d31 3030 3030  veInterval=10000
+00016da0: 264b 6565 7041 6c69 7665 5469 6d65 6f75  &KeepAliveTimeou
+00016db0: 743d 3130 3030 300a 0a0a 506c 6561 7365  t=10000...Please
+00016dc0: 206e 6f74 652c 2074 6865 2063 6c69 656e   note, the clien
+00016dd0: 7420 6973 2069 6e73 656e 7369 7469 7665  t is insensitive
+00016de0: 2074 6f20 7468 6520 6361 7365 206f 6620   to the case of 
+00016df0: 6669 656c 6473 2061 6e64 2076 616c 7565  fields and value
+00016e00: 732e 2049 6620 6669 656c 6473 2061 7265  s. If fields are
+00016e10: 0a72 6570 6561 7465 6420 696e 2074 6865  .repeated in the
+00016e20: 2071 7565 7279 2073 7472 696e 672c 2074   query string, t
+00016e30: 6865 2071 7565 7279 2073 7472 696e 6720  he query string 
+00016e40: 7769 6c6c 2062 6520 7061 7273 6564 2077  will be parsed w
+00016e50: 6974 686f 7574 2065 7272 6f72 2e20 486f  ithout error. Ho
+00016e60: 7765 7665 722c 0a74 6865 2063 6f6e 6e65  wever,.the conne
+00016e70: 6374 696f 6e20 6f70 7469 6f6e 7320 7573  ction options us
+00016e80: 6564 2062 7920 7468 6520 636c 6965 6e74  ed by the client
+00016e90: 2077 696c 6c20 7573 6520 7468 6520 7661   will use the va
+00016ea0: 6c75 6520 6f66 2074 6865 2066 6972 7374  lue of the first
+00016eb0: 2066 6965 6c64 2e20 416c 6c0a 7468 6520   field. All.the 
+00016ec0: 6f74 6865 7220 6669 656c 642d 7661 6c75  other field-valu
+00016ed0: 6573 2069 6e20 7468 6520 7175 6572 7920  es in the query 
+00016ee0: 7374 7269 6e67 2077 6974 6820 7468 6520  string with the 
+00016ef0: 7361 6d65 2066 6965 6c64 206e 616d 6520  same field name 
+00016f00: 7769 6c6c 2062 6520 6967 6e6f 7265 642e  will be ignored.
+00016f10: 0a46 6965 6c64 7320 7769 7468 6f75 7420  .Fields without 
+00016f20: 7661 6c75 6573 2077 696c 6c20 616c 736f  values will also
+00016f30: 2062 6520 6967 6e6f 7265 642e 0a0a 4966   be ignored...If
+00016f40: 2074 6865 2063 6c69 656e 7427 7320 6e6f   the client's no
+00016f50: 6465 2070 7265 6665 7265 6e63 6520 6973  de preference is
+00016f60: 2022 6c65 6164 6572 2220 616e 6420 7468   "leader" and th
+00016f70: 6520 6e6f 6465 2062 6563 6f6d 6573 2061  e node becomes a
+00016f80: 0a22 666f 6c6c 6f77 6572 222c 2074 6865  ."follower", the
+00016f90: 2063 6c69 656e 7420 7769 6c6c 2061 7474   client will att
+00016fa0: 656d 7074 2074 6f20 7265 636f 6e6e 6563  empt to reconnec
+00016fb0: 7420 746f 2074 6865 2063 7572 7265 6e74  t to the current
+00016fc0: 206c 6561 6465 7220 7768 656e 2061 206d   leader when a m
+00016fd0: 6574 686f 640a 6973 2063 616c 6c65 6420  ethod.is called 
+00016fe0: 7468 6174 2065 7870 6563 7473 2074 6f20  that expects to 
+00016ff0: 6361 6c6c 2061 206c 6561 6465 722e 204d  call a leader. M
+00017000: 6574 686f 6473 2077 6869 6368 206d 7574  ethods which mut
+00017010: 6174 6520 7468 6520 7374 6174 6520 6f66  ate the state of
+00017020: 2074 6865 2064 6174 6162 6173 650a 6578   the database.ex
+00017030: 7065 6374 2074 6f20 6361 6c6c 2061 206c  pect to call a l
+00017040: 6561 6465 722e 2046 6f72 2073 7563 6820  eader. For such 
+00017050: 6d65 7468 6f64 732c 2074 6865 2048 5454  methods, the HTT
+00017060: 5020 6865 6164 6572 2272 6571 7569 7265  P header"require
+00017070: 732d 6c65 6164 6572 2220 6973 2073 6574  s-leader" is set
+00017080: 2074 6f0a 2274 7275 6522 2c20 616e 6420   to."true", and 
+00017090: 7468 6973 2068 6561 6465 7220 6973 206f  this header is o
+000170a0: 6273 6572 7665 6420 6279 2074 6865 2073  bserved by the s
+000170b0: 6572 7665 722c 2061 6e64 2073 6f20 6120  erver, and so a 
+000170c0: 6e6f 6465 2077 6869 6368 2069 7320 6e6f  node which is no
+000170d0: 7420 6120 6c65 6164 6572 0a74 6861 7420  t a leader.that 
+000170e0: 7265 6365 6976 6573 2073 7563 6820 6120  receives such a 
+000170f0: 7265 7175 6573 7420 7769 6c6c 2072 6574  request will ret
+00017100: 7572 6e20 616e 2065 7272 6f72 2e20 5468  urn an error. Th
+00017110: 6973 2065 7272 6f72 2069 7320 6465 7465  is error is dete
+00017120: 6374 6564 2062 7920 7468 6520 636c 6965  cted by the clie
+00017130: 6e74 2c0a 7768 6963 6820 7769 6c6c 2074  nt,.which will t
+00017140: 6865 6e20 636c 6f73 6520 7468 6520 6375  hen close the cu
+00017150: 7272 656e 7420 6752 5043 2063 6f6e 6e65  rrent gRPC conne
+00017160: 6374 696f 6e20 616e 6420 6372 6561 7465  ction and create
+00017170: 2061 206e 6577 2063 6f6e 6e65 6374 696f   a new connectio
+00017180: 6e20 746f 2074 6865 0a6c 6561 6465 722e  n to the.leader.
+00017190: 2054 6865 2072 6571 7565 7374 2077 696c   The request wil
+000171a0: 6c20 7468 656e 2062 6520 7265 7472 6965  l then be retrie
+000171b0: 6420 7769 7468 2074 6865 206c 6561 6465  d with the leade
+000171c0: 722e 0a0a 4966 2074 6865 2063 6c69 656e  r...If the clien
+000171d0: 7427 7320 6e6f 6465 2070 7265 6665 7265  t's node prefere
+000171e0: 6e63 6520 6973 2022 666f 6c6c 6f77 6572  nce is "follower
+000171f0: 2220 616e 6420 7468 6572 6520 6172 6520  " and there are 
+00017200: 6e6f 2066 6f6c 6c6f 7765 720a 6e6f 6465  no follower.node
+00017210: 7320 696e 2074 6865 2063 6c75 7374 6572  s in the cluster
+00017220: 2c20 7468 656e 2074 6865 2063 6c69 656e  , then the clien
+00017230: 7420 7769 6c6c 2072 6169 7365 2061 6e20  t will raise an 
+00017240: 6578 6365 7074 696f 6e2e 2053 696d 696c  exception. Simil
+00017250: 6172 6c79 2c20 6966 2074 6865 0a63 6c69  arly, if the.cli
+00017260: 656e 7427 7320 6e6f 6465 2070 7265 6665  ent's node prefe
+00017270: 7265 6e63 6520 6973 2022 7265 6164 6f6e  rence is "readon
+00017280: 6c79 7265 706c 6963 6122 2061 6e64 2074  lyreplica" and t
+00017290: 6865 7265 2061 7265 206e 6f20 7265 6164  here are no read
+000172a0: 2d6f 6e6c 7920 7265 706c 6963 610a 6e6f  -only replica.no
+000172b0: 6465 7320 696e 2074 6865 2063 6c75 7374  des in the clust
+000172c0: 6572 2c20 7468 656e 2074 6865 2063 6c69  er, then the cli
+000172d0: 656e 7420 7769 6c6c 2061 6c73 6f20 7261  ent will also ra
+000172e0: 6973 6520 616e 2065 7863 6570 7469 6f6e  ise an exception
+000172f0: 2e0a 0a54 6865 2067 5250 4320 6368 616e  ...The gRPC chan
+00017300: 6e65 6c20 6f70 7469 6f6e 2022 6772 7063  nel option "grpc
+00017310: 2e6d 6178 5f72 6563 6569 7665 5f6d 6573  .max_receive_mes
+00017320: 7361 6765 5f6c 656e 6774 6822 2069 7320  sage_length" is 
+00017330: 6175 746f 6d61 7469 6361 6c6c 790a 636f  automatically.co
+00017340: 6e66 6967 7572 6564 2074 6f20 7468 6520  nfigured to the 
+00017350: 7661 6c75 6520 6031 3720 2a20 3130 3234  value `17 * 1024
+00017360: 202a 2031 3032 3460 2e20 5468 6973 2076   * 1024`. This v
+00017370: 616c 7565 2063 616e 6e6f 7420 6265 2063  alue cannot be c
+00017380: 6861 6e67 6564 2e0a 0a0a 2323 2320 5265  hanged....### Re
+00017390: 6775 6c61 7220 6578 7072 6573 7369 6f6e  gular expression
+000173a0: 2066 696c 7465 7273 0a0a 5468 6520 6669   filters..The fi
+000173b0: 6c74 6572 2061 7267 756d 656e 7473 2069  lter arguments i
+000173c0: 6e20 6072 6561 645f 616c 6c5f 6576 656e  n `read_all_even
+000173d0: 7473 2829 602c 2060 7375 6273 6372 6962  ts()`, `subscrib
+000173e0: 655f 616c 6c5f 6576 656e 7473 2829 602c  e_all_events()`,
+000173f0: 0a60 6372 6561 7465 5f73 7562 7363 7269  .`create_subscri
+00017400: 7074 696f 6e28 2960 2061 6e64 2060 6765  ption()` and `ge
+00017410: 745f 636f 6d6d 6974 5f70 6f73 6974 696f  t_commit_positio
+00017420: 6e28 2960 2061 7265 2061 7070 6c69 6564  n()` are applied
+00017430: 2074 6f20 7468 6520 6074 7970 6560 0a61   to the `type`.a
+00017440: 7474 7269 6275 7465 206f 6620 7265 636f  ttribute of reco
+00017450: 7264 6564 2065 7665 6e74 732e 0a0a 5468  rded events...Th
+00017460: 6520 6465 6661 756c 7420 7661 6c75 6520  e default value 
+00017470: 6f66 2074 6865 2060 6669 6c74 6572 5f65  of the `filter_e
+00017480: 7863 6c75 6465 6020 6172 6775 6d65 6e74  xclude` argument
+00017490: 7320 6973 2064 6573 6967 6e65 6420 746f  s is designed to
+000174a0: 2065 7863 6c75 6465 0a45 7665 6e74 5374   exclude.EventSt
+000174b0: 6f72 6544 4220 2273 7973 7465 6d22 2061  oreDB "system" a
+000174c0: 6e64 2022 7065 7273 6973 7465 6e63 6520  nd "persistence 
+000174d0: 7375 6273 6372 6970 7469 6f6e 2063 6f6e  subscription con
+000174e0: 6669 6722 2065 7665 6e74 732c 2077 6869  fig" events, whi
+000174f0: 6368 0a6f 7468 6572 7769 7365 2077 6f75  ch.otherwise wou
+00017500: 6c64 2062 6520 696e 636c 7564 6564 2e20  ld be included. 
+00017510: 5379 7374 656d 2065 7665 6e74 7320 6765  System events ge
+00017520: 6e65 7261 7465 6420 6279 2045 7665 6e74  nerated by Event
+00017530: 5374 6f72 6544 4220 616c 6c0a 6861 7665  StoreDB all.have
+00017540: 2060 7479 7065 6020 7374 7269 6e67 7320   `type` strings 
+00017550: 7468 6174 2073 7461 7274 2077 6974 6820  that start with 
+00017560: 7468 6520 6024 6020 7369 676e 2e20 5065  the `$` sign. Pe
+00017570: 7273 6973 7465 6e63 6520 7375 6273 6372  rsistence subscr
+00017580: 6970 7469 6f6e 0a65 7665 6e74 7320 6765  iption.events ge
+00017590: 6e65 7261 7465 6420 7768 656e 206d 616e  nerated when man
+000175a0: 6970 756c 6174 696e 6720 7065 7273 6973  ipulating persis
+000175b0: 7465 6e63 6520 7375 6273 6372 6970 7469  tence subscripti
+000175c0: 6f6e 7320 616c 6c20 6861 7665 2060 7479  ons all have `ty
+000175d0: 7065 600a 7374 7269 6e67 7320 7468 6174  pe`.strings that
+000175e0: 2073 7461 7274 2077 6974 6820 6050 6572   start with `Per
+000175f0: 7369 7374 656e 7443 6f6e 6669 6760 2e0a  sistentConfig`..
+00017600: 0a46 6f72 2065 7861 6d70 6c65 2c20 746f  .For example, to
+00017610: 206d 6174 6368 2074 6865 2074 7970 6520   match the type 
+00017620: 6f66 2045 7665 6e74 5374 6f72 6544 4220  of EventStoreDB 
+00017630: 7379 7374 656d 2065 7665 6e74 732c 2075  system events, u
+00017640: 7365 2074 6865 2072 6567 756c 6172 0a65  se the regular.e
+00017650: 7870 7265 7373 696f 6e20 6072 275c 242e  xpression `r'\$.
+00017660: 2b27 602e 2050 6c65 6173 6520 6e6f 7465  +'`. Please note
+00017670: 2c20 7468 6520 636f 6e73 7461 6e74 2060  , the constant `
+00017680: 4553 4442 5f53 5953 5445 4d5f 4556 454e  ESDB_SYSTEM_EVEN
+00017690: 5453 5f52 4547 4558 6020 6973 0a73 6574  TS_REGEX` is.set
+000176a0: 2074 6f20 6072 275c 242e 2b27 602e 2059   to `r'\$.+'`. Y
+000176b0: 6f75 2063 616e 2069 6d70 6f72 7420 7468  ou can import th
+000176c0: 6973 2076 616c 7565 0a28 6066 726f 6d20  is value.(`from 
+000176d0: 6573 6462 636c 6965 6e74 2069 6d70 6f72  esdbclient impor
+000176e0: 7420 4553 4442 5f53 5953 5445 4d5f 4556  t ESDB_SYSTEM_EV
+000176f0: 454e 5453 5f52 4547 4558 6029 2061 6e64  ENTS_REGEX`) and
+00017700: 2075 7365 0a69 7420 7768 656e 2062 7569   use.it when bui
+00017710: 6c64 696e 6720 6c6f 6e67 6572 2073 6571  lding longer seq
+00017720: 7565 6e63 6573 206f 6620 7265 6775 6c61  uences of regula
+00017730: 7220 6578 7072 6573 7369 6f6e 732e 0a0a  r expressions...
+00017740: 5369 6d69 6c61 726c 792c 2074 6f20 6d61  Similarly, to ma
+00017750: 7463 6820 7468 6520 7479 7065 206f 6620  tch the type of 
+00017760: 4576 656e 7453 746f 7265 4442 2070 6572  EventStoreDB per
+00017770: 7369 7374 656e 6365 2073 7562 7363 7269  sistence subscri
+00017780: 7074 696f 6e20 6576 656e 7473 2c20 7573  ption events, us
+00017790: 6520 7468 650a 7265 6775 6c61 7220 6578  e the.regular ex
+000177a0: 7072 6573 7369 6f6e 2060 7227 5065 7273  pression `r'Pers
+000177b0: 6973 7465 6e74 436f 6e66 6967 5c64 2b27  istentConfig\d+'
+000177c0: 602e 2054 6865 2063 6f6e 7374 616e 7420  `. The constant 
+000177d0: 6045 5344 425f 5045 5253 4953 5445 4e54  `ESDB_PERSISTENT
+000177e0: 5f43 4f4e 4649 475f 4556 454e 5453 5f52  _CONFIG_EVENTS_R
+000177f0: 4547 4558 600a 6973 2073 6574 2074 6f20  EGEX`.is set to 
+00017800: 6072 2750 6572 7369 7374 656e 7443 6f6e  `r'PersistentCon
+00017810: 6669 675c 642b 2760 2e20 596f 7520 6361  fig\d+'`. You ca
+00017820: 6e20 616c 736f 2069 6d70 6f72 7420 7468  n also import th
+00017830: 6973 2076 616c 7565 0a28 6066 726f 6d20  is value.(`from 
+00017840: 6573 6462 636c 6965 6e74 2069 6d70 6f72  esdbclient impor
+00017850: 7420 4553 4442 5f50 4552 5349 5354 454e  t ESDB_PERSISTEN
+00017860: 545f 434f 4e46 4947 5f45 5645 4e54 535f  T_CONFIG_EVENTS_
+00017870: 5245 4745 5860 2920 616e 6420 7573 6520  REGEX`) and use 
+00017880: 6974 2077 6865 6e20 6275 696c 6469 6e67  it when building
+00017890: 0a6c 6f6e 6765 7220 7365 7175 656e 6365  .longer sequence
+000178a0: 7320 6f66 2072 6567 756c 6172 2065 7870  s of regular exp
+000178b0: 7265 7373 696f 6e73 2e0a 0a54 6865 2063  ressions...The c
+000178c0: 6f6e 7374 616e 7420 6044 4546 4155 4c54  onstant `DEFAULT
+000178d0: 5f45 5843 4c55 4445 5f46 494c 5445 5260  _EXCLUDE_FILTER`
+000178e0: 2069 7320 6120 7365 7175 656e 6365 206f   is a sequence o
+000178f0: 6620 7265 6775 6c61 7220 6578 7072 6573  f regular expres
+00017900: 7369 6f6e 7320 7468 6174 206d 6174 6368  sions that match
+00017910: 0a74 6865 2065 7665 6e74 7320 7468 6174  .the events that
+00017920: 2045 7665 6e74 5374 6f72 6544 4220 6765   EventStoreDB ge
+00017930: 6e65 7261 7465 7320 696e 7465 726e 616c  nerates internal
+00017940: 6c79 2c20 6576 656e 7473 2074 6861 7420  ly, events that 
+00017950: 6172 6520 6578 7472 616e 656f 7573 2074  are extraneous t
+00017960: 6f20 7468 6f73 650a 7768 6963 6820 796f  o those.which yo
+00017970: 7520 6170 7065 6e64 2075 7369 6e67 2074  u append using t
+00017980: 6865 2060 6170 7065 6e64 5f65 7665 6e74  he `append_event
+00017990: 7328 2960 206d 6574 686f 642e 0a0a 0a23  s()` method....#
+000179a0: 2323 204e 6577 2065 7665 6e74 206f 626a  ## New event obj
+000179b0: 6563 7473 0a0a 5468 6520 604e 6577 4576  ects..The `NewEv
+000179c0: 656e 7460 2063 6c61 7373 2069 7320 7573  ent` class is us
+000179d0: 6564 2077 6865 6e20 6170 7065 6e64 696e  ed when appendin
+000179e0: 6720 6576 656e 7473 2e0a 0a54 6865 2072  g events...The r
+000179f0: 6571 7569 7265 6420 6172 6775 6d65 6e74  equired argument
+00017a00: 2060 7479 7065 6020 6973 2061 2050 7974   `type` is a Pyt
+00017a10: 686f 6e20 6073 7472 602c 2075 7365 6420  hon `str`, used 
+00017a20: 746f 2069 6e64 6963 6174 6520 7468 6520  to indicate the 
+00017a30: 7479 7065 206f 660a 7468 6520 6576 656e  type of.the even
+00017a40: 7420 7468 6174 2077 696c 6c20 6265 2072  t that will be r
+00017a50: 6563 6f72 6465 642e 0a0a 5468 6520 7265  ecorded...The re
+00017a60: 7175 6972 6564 2061 7267 756d 656e 7420  quired argument 
+00017a70: 6064 6174 6160 2069 7320 6120 5079 7468  `data` is a Pyth
+00017a80: 6f6e 2060 6279 7465 7360 206f 626a 6563  on `bytes` objec
+00017a90: 742c 2075 7365 6420 746f 2069 6e64 6963  t, used to indic
+00017aa0: 6174 6520 7468 6520 6461 7461 206f 660a  ate the data of.
+00017ab0: 7468 6520 6576 656e 7420 7468 6174 2077  the event that w
+00017ac0: 696c 6c20 6265 2072 6563 6f72 6465 642e  ill be recorded.
+00017ad0: 0a0a 5468 6520 6f70 7469 6f6e 616c 2061  ..The optional a
+00017ae0: 7267 756d 656e 7420 606d 6574 6164 6174  rgument `metadat
+00017af0: 6160 2069 7320 6120 5079 7468 6f6e 2060  a` is a Python `
+00017b00: 6279 7465 7360 206f 626a 6563 742c 2075  bytes` object, u
+00017b10: 7365 6420 746f 2069 6e64 6963 6174 6520  sed to indicate 
+00017b20: 616e 790a 6d65 7461 6461 7461 206f 6620  any.metadata of 
+00017b30: 7468 6520 6576 656e 7420 7468 6174 2077  the event that w
+00017b40: 696c 6c20 6265 2072 6563 6f72 6465 642e  ill be recorded.
+00017b50: 2054 6865 2064 6566 6175 6c74 2076 616c   The default val
+00017b60: 7565 2069 7320 616e 2065 6d70 7479 2060  ue is an empty `
+00017b70: 6279 7465 7360 0a6f 626a 6563 742e 0a0a  bytes`.object...
+00017b80: 5468 6520 6f70 7469 6f6e 616c 2061 7267  The optional arg
+00017b90: 756d 656e 7420 6063 6f6e 7465 6e74 5f74  ument `content_t
+00017ba0: 7970 6560 2069 7320 6120 5079 7468 6f6e  ype` is a Python
+00017bb0: 2060 7374 7260 2c20 7573 6564 2074 6f20   `str`, used to 
+00017bc0: 696e 6469 6361 7465 2074 6865 0a74 7970  indicate the.typ
+00017bd0: 6520 6f66 2074 6865 2064 6174 6120 7468  e of the data th
+00017be0: 6174 2077 696c 6c20 6265 2072 6563 6f72  at will be recor
+00017bf0: 6465 6420 666f 7220 7468 6973 2065 7665  ded for this eve
+00017c00: 6e74 2e20 5468 6520 6465 6661 756c 7420  nt. The default 
+00017c10: 7661 6c75 6520 6973 0a60 6170 706c 6963  value is.`applic
+00017c20: 6174 696f 6e2f 6a73 6f6e 602c 2077 6869  ation/json`, whi
+00017c30: 6368 2069 6e64 6963 6174 6573 2074 6861  ch indicates tha
+00017c40: 7420 7468 6520 6064 6174 6160 2077 6173  t the `data` was
+00017c50: 2073 6572 6961 6c69 7365 6420 7573 696e   serialised usin
+00017c60: 6720 4a53 4f4e 2e0a 416e 2061 6c74 6572  g JSON..An alter
+00017c70: 6e61 7469 7665 2076 616c 7565 2066 6f72  native value for
+00017c80: 2074 6869 7320 6172 6775 6d65 6e74 2069   this argument i
+00017c90: 7320 6061 7070 6c69 6361 7469 6f6e 2f6f  s `application/o
+00017ca0: 6374 6574 2d73 7472 6561 6d60 2e0a 0a54  ctet-stream`...T
+00017cb0: 6865 206f 7074 696f 6e61 6c20 6172 6775  he optional argu
+00017cc0: 6d65 6e74 2060 6964 6020 6973 2061 2050  ment `id` is a P
+00017cd0: 7974 686f 6e20 6055 5549 4460 206f 626a  ython `UUID` obj
+00017ce0: 6563 742c 2075 7365 6420 746f 2073 7065  ect, used to spe
+00017cf0: 6369 6679 2074 6865 2075 6e69 7175 6520  cify the unique 
+00017d00: 4944 0a6f 6620 7468 6520 6576 656e 7420  ID.of the event 
+00017d10: 7468 6174 2077 696c 6c20 6265 2072 6563  that will be rec
+00017d20: 6f72 6465 642e 2054 6869 7320 7661 6c75  orded. This valu
+00017d30: 6520 7769 6c6c 2064 6566 6175 6c74 2074  e will default t
+00017d40: 6f20 6120 6e65 7720 7665 7273 696f 6e2d  o a new version-
+00017d50: 3420 5555 4944 2e0a 0a60 6060 7079 7468  4 UUID...```pyth
+00017d60: 6f6e 0a6e 6577 5f65 7665 6e74 3120 3d20  on.new_event1 = 
+00017d70: 4e65 7745 7665 6e74 280a 2020 2020 7479  NewEvent(.    ty
+00017d80: 7065 3d27 4f72 6465 7243 7265 6174 6564  pe='OrderCreated
+00017d90: 272c 0a20 2020 2064 6174 613d 6227 7b22  ',.    data=b'{"
+00017da0: 6e61 6d65 223a 2022 4772 6567 227d 272c  name": "Greg"}',
+00017db0: 0a29 0a61 7373 6572 7420 6e65 775f 6576  .).assert new_ev
+00017dc0: 656e 7431 2e74 7970 6520 3d3d 2027 4f72  ent1.type == 'Or
+00017dd0: 6465 7243 7265 6174 6564 270a 6173 7365  derCreated'.asse
+00017de0: 7274 206e 6577 5f65 7665 6e74 312e 6461  rt new_event1.da
+00017df0: 7461 203d 3d20 6227 7b22 6e61 6d65 223a  ta == b'{"name":
+00017e00: 2022 4772 6567 227d 270a 6173 7365 7274   "Greg"}'.assert
+00017e10: 206e 6577 5f65 7665 6e74 312e 6d65 7461   new_event1.meta
+00017e20: 6461 7461 203d 3d20 6227 270a 6173 7365  data == b''.asse
+00017e30: 7274 206e 6577 5f65 7665 6e74 312e 636f  rt new_event1.co
+00017e40: 6e74 656e 745f 7479 7065 203d 3d20 2761  ntent_type == 'a
+00017e50: 7070 6c69 6361 7469 6f6e 2f6a 736f 6e27  pplication/json'
+00017e60: 0a61 7373 6572 7420 6973 696e 7374 616e  .assert isinstan
+00017e70: 6365 286e 6577 5f65 7665 6e74 312e 6964  ce(new_event1.id
+00017e80: 2c20 5555 4944 290a 0a65 7665 6e74 5f69  , UUID)..event_i
+00017e90: 6420 3d20 7575 6964 3428 290a 6e65 775f  d = uuid4().new_
+00017ea0: 6576 656e 7432 203d 204e 6577 4576 656e  event2 = NewEven
+00017eb0: 7428 0a20 2020 2074 7970 653d 2749 6d61  t(.    type='Ima
+00017ec0: 6765 4372 6561 7465 6427 2c0a 2020 2020  geCreated',.    
+00017ed0: 6461 7461 3d62 2730 3130 3130 3130 3130  data=b'010101010
+00017ee0: 3130 3130 3127 2c0a 2020 2020 6d65 7461  10101',.    meta
+00017ef0: 6461 7461 3d62 277b 2261 223a 2031 7d27  data=b'{"a": 1}'
+00017f00: 2c0a 2020 2020 636f 6e74 656e 745f 7479  ,.    content_ty
+00017f10: 7065 3d27 6170 706c 6963 6174 696f 6e2f  pe='application/
+00017f20: 6f63 7465 742d 7374 7265 616d 272c 0a20  octet-stream',. 
+00017f30: 2020 2069 643d 6576 656e 745f 6964 2c0a     id=event_id,.
+00017f40: 290a 6173 7365 7274 206e 6577 5f65 7665  ).assert new_eve
+00017f50: 6e74 322e 7479 7065 203d 3d20 2749 6d61  nt2.type == 'Ima
+00017f60: 6765 4372 6561 7465 6427 0a61 7373 6572  geCreated'.asser
+00017f70: 7420 6e65 775f 6576 656e 7432 2e64 6174  t new_event2.dat
+00017f80: 6120 3d3d 2062 2730 3130 3130 3130 3130  a == b'010101010
+00017f90: 3130 3130 3127 0a61 7373 6572 7420 6e65  10101'.assert ne
+00017fa0: 775f 6576 656e 7432 2e6d 6574 6164 6174  w_event2.metadat
+00017fb0: 6120 3d3d 2062 277b 2261 223a 2031 7d27  a == b'{"a": 1}'
+00017fc0: 0a61 7373 6572 7420 6e65 775f 6576 656e  .assert new_even
+00017fd0: 7432 2e63 6f6e 7465 6e74 5f74 7970 6520  t2.content_type 
+00017fe0: 3d3d 2027 6170 706c 6963 6174 696f 6e2f  == 'application/
+00017ff0: 6f63 7465 742d 7374 7265 616d 270a 6173  octet-stream'.as
+00018000: 7365 7274 206e 6577 5f65 7665 6e74 322e  sert new_event2.
+00018010: 6964 203d 3d20 6576 656e 745f 6964 0a60  id == event_id.`
+00018020: 6060 0a0a 2323 2320 5265 636f 7264 6564  ``..### Recorded
+00018030: 2065 7665 6e74 206f 626a 6563 7473 0a0a   event objects..
+00018040: 5468 6520 6052 6563 6f72 6465 6445 7665  The `RecordedEve
+00018050: 6e74 6020 636c 6173 7320 6973 2075 7365  nt` class is use
+00018060: 6420 7768 656e 2072 6561 6469 6e67 2065  d when reading e
+00018070: 7665 6e74 732e 0a0a 5468 6520 6174 7472  vents...The attr
+00018080: 6962 7574 6520 6074 7970 6560 2069 7320  ibute `type` is 
+00018090: 6120 5079 7468 6f6e 2060 7374 7260 2c20  a Python `str`, 
+000180a0: 7573 6564 2074 6f20 696e 6469 6361 7465  used to indicate
+000180b0: 2074 6865 2074 7970 6520 6f66 2065 7665   the type of eve
+000180c0: 6e74 0a74 6861 7420 7761 7320 7265 636f  nt.that was reco
+000180d0: 7264 6564 2e0a 0a54 6865 2061 7474 7269  rded...The attri
+000180e0: 6275 7465 2060 6461 7461 6020 6973 2061  bute `data` is a
+000180f0: 2050 7974 686f 6e20 6062 7974 6573 6020   Python `bytes` 
+00018100: 6f62 6a65 6374 2c20 7573 6564 2074 6f20  object, used to 
+00018110: 696e 6469 6361 7465 2074 6865 2064 6174  indicate the dat
+00018120: 6120 6f66 2074 6865 0a65 7665 6e74 2074  a of the.event t
+00018130: 6861 7420 7761 7320 7265 636f 7264 6564  hat was recorded
+00018140: 2e0a 0a54 6865 2061 7474 7269 6275 7465  ...The attribute
+00018150: 2060 6d65 7461 6461 7461 6020 6973 2061   `metadata` is a
+00018160: 2050 7974 686f 6e20 6062 7974 6573 6020   Python `bytes` 
+00018170: 6f62 6a65 6374 2c20 7573 6564 2074 6f20  object, used to 
+00018180: 696e 6469 6361 7465 2074 6865 206d 6574  indicate the met
+00018190: 6164 6174 6120 6f66 0a74 6865 2065 7665  adata of.the eve
+000181a0: 6e74 2074 6861 7420 7761 7320 7265 636f  nt that was reco
+000181b0: 7264 6564 2e0a 0a54 6865 2061 7474 7269  rded...The attri
+000181c0: 6275 7465 2060 636f 6e74 656e 745f 7479  bute `content_ty
+000181d0: 7065 6020 6973 2061 2050 7974 686f 6e20  pe` is a Python 
+000181e0: 6073 7472 602c 2075 7365 6420 746f 2069  `str`, used to i
+000181f0: 6e64 6963 6174 6520 7468 6520 7479 7065  ndicate the type
+00018200: 206f 660a 6461 7461 2074 6861 7420 7761   of.data that wa
+00018210: 7320 7265 636f 7264 6564 2066 6f72 2074  s recorded for t
+00018220: 6869 7320 6576 656e 7420 2875 7375 616c  his event (usual
+00018230: 6c79 2060 6170 706c 6963 6174 696f 6e2f  ly `application/
+00018240: 6a73 6f6e 6020 746f 2069 6e64 6963 6174  json` to indicat
+00018250: 6520 7468 6174 0a74 6869 7320 6461 7461  e that.this data
+00018260: 2063 616e 2062 6520 7061 7273 6564 2061   can be parsed a
+00018270: 7320 4a53 4f4e 2c20 6275 7420 616c 7465  s JSON, but alte
+00018280: 726e 6174 6976 656c 7920 6061 7070 6c69  rnatively `appli
+00018290: 6361 7469 6f6e 2f6f 6374 6574 2d73 7472  cation/octet-str
+000182a0: 6561 6d60 2074 6f0a 696e 6469 6361 7465  eam` to.indicate
+000182b0: 2074 6861 7420 6974 2069 7320 736f 6d65   that it is some
+000182c0: 7468 696e 6720 656c 7365 292e 0a0a 5468  thing else)...Th
+000182d0: 6520 6174 7472 6962 7574 6520 6069 6460  e attribute `id`
+000182e0: 2069 7320 6120 5079 7468 6f6e 2060 5555   is a Python `UU
+000182f0: 4944 6020 6f62 6a65 6374 2c20 7573 6564  ID` object, used
+00018300: 2074 6f20 696e 6469 6361 7465 2074 6865   to indicate the
+00018310: 2075 6e69 7175 6520 4944 206f 6620 7468   unique ID of th
+00018320: 650a 6576 656e 7420 7468 6174 2077 6173  e.event that was
+00018330: 2072 6563 6f72 6465 642e 2050 6c65 6173   recorded. Pleas
+00018340: 6520 6e6f 7465 2c20 7768 656e 2072 6563  e note, when rec
+00018350: 6f72 6465 6420 6576 656e 7473 2061 7265  orded events are
+00018360: 2072 6574 7572 6e65 6420 6672 6f6d 2061   returned from a
+00018370: 2063 616c 6c0a 746f 2060 7265 6164 5f73   call.to `read_s
+00018380: 7472 6561 6d5f 6576 656e 7473 2829 6020  tream_events()` 
+00018390: 696e 2045 7665 6e74 5374 6f72 6544 4220  in EventStoreDB 
+000183a0: 7632 312e 3130 2c20 7468 6520 636f 6d6d  v21.10, the comm
+000183b0: 6974 2070 6f73 6974 696f 6e20 6973 206e  it position is n
+000183c0: 6f74 2061 6374 7561 6c6c 790a 7365 7420  ot actually.set 
+000183d0: 696e 2074 6865 2072 6573 706f 6e73 652e  in the response.
+000183e0: 2054 6869 7320 6174 7472 6962 7574 6520   This attribute 
+000183f0: 6973 2074 7970 6564 2061 7320 616e 206f  is typed as an o
+00018400: 7074 696f 6e61 6c20 7661 6c75 6520 2860  ptional value (`
+00018410: 4f70 7469 6f6e 616c 5b55 5549 445d 6029  Optional[UUID]`)
+00018420: 2c0a 616e 6420 696e 2074 6865 2063 6173  ,.and in the cas
+00018430: 6520 6f66 2075 7369 6e67 2045 7665 6e74  e of using Event
+00018440: 5374 6f72 6544 4220 7632 312e 3130 2074  StoreDB v21.10 t
+00018450: 6865 2076 616c 7565 206f 6620 7468 6973  he value of this
+00018460: 2061 7474 7269 6275 7465 2077 696c 6c20   attribute will 
+00018470: 6265 2060 4e6f 6e65 600a 7768 656e 2072  be `None`.when r
+00018480: 6561 6469 6e67 2072 6563 6f72 6465 6420  eading recorded 
+00018490: 6576 656e 7473 2066 726f 6d20 6120 7374  events from a st
+000184a0: 7265 616d 2e20 5265 636f 7264 6564 2065  ream. Recorded e
+000184b0: 7665 6e74 7320 7769 6c6c 2068 6f77 6576  vents will howev
+000184c0: 6572 2068 6176 6520 7468 6973 0a76 616c  er have this.val
+000184d0: 7565 7320 7365 7420 7768 656e 2072 6561  ues set when rea
+000184e0: 6469 6e67 2072 6563 6f72 6465 6420 6576  ding recorded ev
+000184f0: 656e 7473 2066 726f 6d20 6072 6561 645f  ents from `read_
+00018500: 616c 6c5f 6576 656e 7473 2829 6020 616e  all_events()` an
+00018510: 6420 6672 6f6d 2062 6f74 680a 6361 7463  d from both.catc
+00018520: 682d 7570 2061 6e64 2070 6572 7369 7374  h-up and persist
+00018530: 656e 7420 7375 6273 6372 6970 7469 6f6e  ent subscription
+00018540: 732e 0a0a 5468 6520 6174 7472 6962 7574  s...The attribut
+00018550: 6520 6073 7472 6561 6d5f 6e61 6d65 6020  e `stream_name` 
+00018560: 6973 2061 2050 7974 686f 6e20 6073 7472  is a Python `str
+00018570: 602c 2075 7365 6420 746f 2069 6e64 6963  `, used to indic
+00018580: 6174 6520 7468 6520 6e61 6d65 206f 6620  ate the name of 
+00018590: 7468 650a 7374 7265 616d 2069 6e20 7768  the.stream in wh
+000185a0: 6963 6820 7468 6520 6576 656e 7420 7761  ich the event wa
+000185b0: 7320 7265 636f 7264 6564 2e0a 0a54 6865  s recorded...The
+000185c0: 2061 7474 7269 6275 7465 2060 7374 7265   attribute `stre
+000185d0: 616d 5f70 6f73 6974 696f 6e60 2069 7320  am_position` is 
+000185e0: 6120 5079 7468 6f6e 2060 696e 7460 2c20  a Python `int`, 
+000185f0: 7573 6564 2074 6f20 696e 6469 6361 7465  used to indicate
+00018600: 2074 6865 2070 6f73 6974 696f 6e20 696e   the position in
+00018610: 2074 6865 0a73 7472 6561 6d20 6174 2077   the.stream at w
+00018620: 6869 6368 2074 6865 2065 7665 6e74 2077  hich the event w
+00018630: 6173 2072 6563 6f72 6465 642e 0a0a 5468  as recorded...Th
+00018640: 6520 6174 7472 6962 7574 6520 6063 6f6d  e attribute `com
+00018650: 6d69 745f 706f 7369 7469 6f6e 6020 6973  mit_position` is
+00018660: 2061 2050 7974 686f 6e20 6069 6e74 602c   a Python `int`,
+00018670: 2075 7365 6420 746f 2069 6e64 6963 6174   used to indicat
+00018680: 6520 7468 6520 636f 6d6d 6974 2070 6f73  e the commit pos
+00018690: 6974 696f 6e0a 6174 2077 6869 6368 2074  ition.at which t
+000186a0: 6865 2065 7665 6e74 2077 6173 2072 6563  he event was rec
+000186b0: 6f72 6465 642e 0a0a 6060 6070 7974 686f  orded...```pytho
+000186c0: 6e0a 6672 6f6d 2065 7364 6263 6c69 656e  n.from esdbclien
+000186d0: 742e 6576 656e 7473 2069 6d70 6f72 7420  t.events import 
+000186e0: 5265 636f 7264 6564 4576 656e 740a 0a72  RecordedEvent..r
+000186f0: 6563 6f72 6465 645f 6576 656e 7420 3d20  ecorded_event = 
+00018700: 5265 636f 7264 6564 4576 656e 7428 0a20  RecordedEvent(. 
+00018710: 2020 2074 7970 653d 274f 7264 6572 4372     type='OrderCr
+00018720: 6561 7465 6427 2c0a 2020 2020 6461 7461  eated',.    data
+00018730: 3d62 277b 7d27 2c0a 2020 2020 6d65 7461  =b'{}',.    meta
+00018740: 6461 7461 3d62 2727 2c0a 2020 2020 636f  data=b'',.    co
+00018750: 6e74 656e 745f 7479 7065 3d27 6170 706c  ntent_type='appl
+00018760: 6963 6174 696f 6e2f 6a73 6f6e 272c 0a20  ication/json',. 
+00018770: 2020 2069 643d 7575 6964 3428 292c 0a20     id=uuid4(),. 
+00018780: 2020 2073 7472 6561 6d5f 6e61 6d65 3d27     stream_name='
+00018790: 7374 7265 616d 3127 2c0a 2020 2020 7374  stream1',.    st
+000187a0: 7265 616d 5f70 6f73 6974 696f 6e3d 302c  ream_position=0,
+000187b0: 0a20 2020 2063 6f6d 6d69 745f 706f 7369  .    commit_posi
+000187c0: 7469 6f6e 3d35 3132 2c0a 290a 6060 600a  tion=512,.).```.
+000187d0: 0a23 2323 2041 7379 6e63 696f 2063 6c69  .### Asyncio cli
+000187e0: 656e 740a 0a54 6865 2060 6573 6462 636c  ent..The `esdbcl
+000187f0: 6965 6e74 6020 7061 636b 6167 6520 616c  ient` package al
+00018800: 736f 2069 6e63 6c75 6465 7320 616e 2065  so includes an e
+00018810: 6172 6c79 2076 6572 7369 6f6e 206f 6620  arly version of 
+00018820: 616e 2061 7379 6e63 6872 6f6e 6f75 7320  an asynchronous 
+00018830: 492f 4f0a 6752 5043 2050 7974 686f 6e20  I/O.gRPC Python 
+00018840: 636c 6965 6e74 2e20 4974 2066 6f6c 6c6f  client. It follo
+00018850: 7773 2065 7861 6374 6c79 2074 6865 2073  ws exactly the s
+00018860: 616d 6520 6265 6861 7669 6f72 7320 6173  ame behaviors as
+00018870: 2074 6865 206d 756c 7469 7468 7265 6164   the multithread
+00018880: 6564 0a60 4553 4442 436c 6965 6e74 602c  ed.`ESDBClient`,
+00018890: 2062 7574 2075 7365 7320 7468 6520 6067   but uses the `g
+000188a0: 7270 632e 6169 6f60 2070 6163 6b61 6765  rpc.aio` package
+000188b0: 2061 6e64 2074 6865 2060 6173 796e 6369   and the `asynci
+000188c0: 6f60 206d 6f64 756c 652c 2069 6e73 7465  o` module, inste
+000188d0: 6164 206f 660a 6067 7270 6360 2061 6e64  ad of.`grpc` and
+000188e0: 2060 7468 7265 6164 696e 6760 2e0a 0a54   `threading`...T
+000188f0: 6865 2060 6173 796e 6360 2066 756e 6374  he `async` funct
+00018900: 696f 6e20 6041 7379 6e63 696f 4553 4442  ion `AsyncioESDB
+00018910: 436c 6965 6e74 6020 636f 6e73 7472 7563  Client` construc
+00018920: 7473 2074 6865 2063 6c69 656e 742c 2061  ts the client, a
+00018930: 6e64 2063 6f6e 6e65 6374 7320 746f 0a61  nd connects to.a
+00018940: 2073 6572 7665 722e 2049 7420 6361 6e20   server. It can 
+00018950: 6265 2069 6d70 6f72 7465 6420 6672 6f6d  be imported from
+00018960: 2060 6573 6462 636c 6965 6e74 602c 2061   `esdbclient`, a
+00018970: 6e64 2063 616e 2062 6520 6361 6c6c 6564  nd can be called
+00018980: 2077 6974 6820 7468 6520 7361 6d65 0a61   with the same.a
+00018990: 7267 756d 656e 7473 2061 7320 6045 5344  rguments as `ESD
+000189a0: 4243 6c69 656e 7460 2e20 4974 2073 7570  BClient`. It sup
+000189b0: 706f 7274 7320 626f 7468 2074 6865 2022  ports both the "
+000189c0: 6573 6462 2220 616e 6420 7468 6520 2265  esdb" and the "e
+000189d0: 7364 622b 6469 7363 6f76 6572 220a 636f  sdb+discover".co
+000189e0: 6e6e 6563 7469 6f6e 2073 7472 696e 6720  nnection string 
+000189f0: 5552 4920 7363 6865 6d65 732c 2061 6e64  URI schemes, and
+00018a00: 2072 6563 6f6e 6e65 6374 7320 616e 6420   reconnects and 
+00018a10: 7265 7472 6965 7320 6d65 7468 6f64 7320  retries methods 
+00018a20: 7768 656e 2063 6f6e 6e65 6374 696f 6e0a  when connection.
+00018a30: 6973 7375 6573 2061 7265 2065 6e63 6f75  issues are encou
+00018a40: 6e74 6572 6564 2c20 6a75 7374 206c 696b  ntered, just lik
+00018a50: 6520 6045 5344 4243 6c69 656e 7460 2e0a  e `ESDBClient`..
+00018a60: 0a60 6060 7079 7468 6f6e 0a66 726f 6d20  .```python.from 
+00018a70: 6573 6462 636c 6965 6e74 2069 6d70 6f72  esdbclient impor
+00018a80: 7420 4173 796e 6369 6f45 5344 4243 6c69  t AsyncioESDBCli
+00018a90: 656e 740a 6060 600a 0a54 6865 2061 7379  ent.```..The asy
+00018aa0: 6e63 6872 6f6e 6f75 7320 492f 4f20 636c  nchronous I/O cl
+00018ab0: 6965 6e74 2068 6173 2060 6173 796e 6360  ient has `async`
+00018ac0: 206d 6574 686f 6473 2060 6170 7065 6e64   methods `append
+00018ad0: 5f65 7665 6e74 7328 2960 2c0a 6072 6561  _events()`,.`rea
+00018ae0: 645f 7374 7265 616d 5f65 7665 6e74 7328  d_stream_events(
+00018af0: 2960 2c20 6072 6561 645f 616c 6c5f 6576  )`, `read_all_ev
+00018b00: 656e 7473 2829 602c 2060 7375 6273 6372  ents()`, `subscr
+00018b10: 6962 655f 616c 6c5f 6576 656e 7473 2829  ibe_all_events()
+00018b20: 602c 0a60 6465 6c65 7465 5f73 7472 6561  `,.`delete_strea
+00018b30: 6d28 2960 2c20 6074 6f6d 6273 746f 6e65  m()`, `tombstone
+00018b40: 5f73 7472 6561 6d28 2960 2c20 616e 6420  _stream()`, and 
+00018b50: 6072 6563 6f6e 6e65 6374 2829 602e 0a0a  `reconnect()`...
+00018b60: 5468 6573 6520 6d65 7468 6f64 7320 6172  These methods ar
+00018b70: 6520 6571 7569 7661 6c65 6e74 2074 6f20  e equivalent to 
+00018b80: 7468 6520 6d65 7468 6f64 7320 6f6e 2060  the methods on `
+00018b90: 4553 4442 436c 6965 6e74 602e 2054 6865  ESDBClient`. The
+00018ba0: 7920 6861 7665 2074 6865 2073 616d 650a  y have the same.
+00018bb0: 6d65 7468 6f64 2073 6967 6e61 7475 7265  method signature
+00018bc0: 732c 2061 6e64 2063 616e 2062 6520 6361  s, and can be ca
+00018bd0: 6c6c 6564 2077 6974 6820 7468 6520 7361  lled with the sa
+00018be0: 6d65 2061 7267 756d 656e 7473 2c20 746f  me arguments, to
+00018bf0: 2074 6865 2073 616d 6520 6566 6665 6374   the same effect
+00018c00: 2e0a 5468 6520 6d65 7468 6f64 7320 7768  ..The methods wh
+00018c10: 6963 6820 6170 7065 6172 206f 6e20 6045  ich appear on `E
+00018c20: 5344 4243 6c69 656e 7460 2062 7574 206e  SDBClient` but n
+00018c30: 6f74 206f 6e20 6041 7379 6e63 696f 4553  ot on `AsyncioES
+00018c40: 4442 436c 6965 6e74 6020 7769 6c6c 2062  DBClient` will b
+00018c50: 650a 6164 6465 6420 736f 6f6e 2e0a 0a54  e.added soon...T
+00018c60: 6865 2065 7861 6d70 6c65 2062 656c 6f77  he example below
+00018c70: 2064 656d 6f6e 7374 7261 7465 7320 7468   demonstrates th
+00018c80: 6520 6061 7070 656e 645f 6576 656e 7473  e `append_events
+00018c90: 2829 602c 2060 7265 6164 5f73 7472 6561  ()`, `read_strea
+00018ca0: 6d5f 6576 656e 7473 2829 6020 616e 640a  m_events()` and.
+00018cb0: 6073 7562 7363 7269 6265 5f61 6c6c 5f65  `subscribe_all_e
+00018cc0: 7665 6e74 7328 2960 206d 6574 686f 6473  vents()` methods
+00018cd0: 2e20 5468 6573 6520 6172 6520 7468 6520  . These are the 
+00018ce0: 6d6f 7374 2075 7365 6675 6c20 6d65 7468  most useful meth
+00018cf0: 6f64 7320 666f 7220 7772 6974 696e 670a  ods for writing.
+00018d00: 616e 2065 7665 6e74 2d73 6f75 7263 6564  an event-sourced
+00018d10: 2061 7070 6c69 6361 7469 6f6e 2c20 616c   application, al
+00018d20: 6c6f 7769 6e67 206e 6577 2061 6767 7265  lowing new aggre
+00018d30: 6761 7465 2065 7665 6e74 7320 746f 2062  gate events to b
+00018d40: 6520 7265 636f 7264 6564 2c20 7468 650a  e recorded, the.
+00018d50: 7265 636f 7264 6564 2065 7665 6e74 7320  recorded events 
+00018d60: 6f66 2061 6e20 6167 6772 6567 6174 6520  of an aggregate 
+00018d70: 746f 2062 6520 6f62 7461 696e 6564 2073  to be obtained s
+00018d80: 6f20 6167 6772 6567 6174 6573 2063 616e  o aggregates can
+00018d90: 2062 6520 7265 636f 6e73 7472 7563 7465   be reconstructe
+00018da0: 642c 0a61 6e64 2074 6865 2073 7461 7465  d,.and the state
+00018db0: 206f 6620 616e 2061 7070 6c69 6361 7469   of an applicati
+00018dc0: 6f6e 2074 6f20 7072 6f70 6167 6174 6564  on to propagated
+00018dd0: 2061 6e64 2070 726f 6365 7373 6564 2077   and processed w
+00018de0: 6974 6820 2265 7861 6374 6c79 2d6f 6e63  ith "exactly-onc
+00018df0: 6522 0a73 656d 616e 7469 6373 2e0a 0a60  e".semantics...`
+00018e00: 6060 7079 7468 6f6e 0a69 6d70 6f72 7420  ``python.import 
+00018e10: 6173 796e 6369 6f0a 0a61 7379 6e63 2064  asyncio..async d
+00018e20: 6566 2064 656d 6f6e 7374 7261 7465 5f61  ef demonstrate_a
+00018e30: 7379 6e63 696f 5f63 6c69 656e 7428 293a  syncio_client():
+00018e40: 0a0a 2020 2020 2320 436f 6e73 7472 7563  ..    # Construc
+00018e50: 7420 636c 6965 6e74 2e0a 2020 2020 636c  t client..    cl
+00018e60: 6965 6e74 203d 2061 7761 6974 2041 7379  ient = await Asy
+00018e70: 6e63 696f 4553 4442 436c 6965 6e74 280a  ncioESDBClient(.
+00018e80: 2020 2020 2020 2020 7572 693d 6f73 2e67          uri=os.g
+00018e90: 6574 656e 7628 2245 5344 425f 5552 4922  etenv("ESDB_URI"
+00018ea0: 292c 0a20 2020 2020 2020 2072 6f6f 745f  ),.        root_
+00018eb0: 6365 7274 6966 6963 6174 6573 3d6f 732e  certificates=os.
+00018ec0: 6765 7465 6e76 2822 4553 4442 5f52 4f4f  getenv("ESDB_ROO
+00018ed0: 545f 4345 5254 4946 4943 4154 4553 2229  T_CERTIFICATES")
+00018ee0: 2c0a 2020 2020 290a 0a20 2020 2023 2041  ,.    )..    # A
+00018ef0: 7070 656e 6420 6576 656e 7473 2e0a 2020  ppend events..  
+00018f00: 2020 7374 7265 616d 5f6e 616d 6520 3d20    stream_name = 
+00018f10: 7374 7228 7575 6964 3428 2929 0a20 2020  str(uuid4()).   
+00018f20: 2065 7665 6e74 3120 3d20 4e65 7745 7665   event1 = NewEve
+00018f30: 6e74 2822 4f72 6465 7243 7265 6174 6564  nt("OrderCreated
+00018f40: 222c 2064 6174 613d 6227 7b7d 2729 0a20  ", data=b'{}'). 
+00018f50: 2020 2065 7665 6e74 3220 3d20 4e65 7745     event2 = NewE
+00018f60: 7665 6e74 2822 4f72 6465 7255 7064 6174  vent("OrderUpdat
+00018f70: 6564 222c 2064 6174 613d 6227 7b7d 2729  ed", data=b'{}')
+00018f80: 0a20 2020 2065 7665 6e74 3320 3d20 4e65  .    event3 = Ne
+00018f90: 7745 7665 6e74 2822 4f72 6465 7244 656c  wEvent("OrderDel
+00018fa0: 6574 6564 222c 2064 6174 613d 6227 7b7d  eted", data=b'{}
+00018fb0: 2729 0a0a 2020 2020 6177 6169 7420 636c  ')..    await cl
+00018fc0: 6965 6e74 2e61 7070 656e 645f 6576 656e  ient.append_even
+00018fd0: 7473 280a 2020 2020 2020 2020 7374 7265  ts(.        stre
+00018fe0: 616d 5f6e 616d 653d 7374 7265 616d 5f6e  am_name=stream_n
+00018ff0: 616d 652c 0a20 2020 2020 2020 2065 7870  ame,.        exp
+00019000: 6563 7465 645f 706f 7369 7469 6f6e 3d4e  ected_position=N
+00019010: 6f6e 652c 0a20 2020 2020 2020 2065 7665  one,.        eve
+00019020: 6e74 733d 5b65 7665 6e74 312c 2065 7665  nts=[event1, eve
+00019030: 6e74 322c 2065 7665 6e74 335d 0a20 2020  nt2, event3].   
+00019040: 2029 0a0a 2020 2020 2320 5265 6164 2073   )..    # Read s
+00019050: 7472 6561 6d20 6576 656e 7473 2e0a 2020  tream events..  
+00019060: 2020 7265 636f 7264 6564 203d 2061 7761    recorded = awa
+00019070: 6974 2063 6c69 656e 742e 7265 6164 5f73  it client.read_s
+00019080: 7472 6561 6d5f 6576 656e 7473 2873 7472  tream_events(str
+00019090: 6561 6d5f 6e61 6d65 290a 2020 2020 6173  eam_name).    as
+000190a0: 7365 7274 206c 656e 2872 6563 6f72 6465  sert len(recorde
+000190b0: 6429 203d 3d20 330a 2020 2020 6173 7365  d) == 3.    asse
+000190c0: 7274 2072 6563 6f72 6465 645b 305d 2e69  rt recorded[0].i
+000190d0: 6420 3d3d 2065 7665 6e74 312e 6964 0a20  d == event1.id. 
+000190e0: 2020 2061 7373 6572 7420 7265 636f 7264     assert record
+000190f0: 6564 5b31 5d2e 6964 203d 3d20 6576 656e  ed[1].id == even
+00019100: 7432 2e69 640a 2020 2020 6173 7365 7274  t2.id.    assert
+00019110: 2072 6563 6f72 6465 645b 325d 2e69 6420   recorded[2].id 
+00019120: 3d3d 2065 7665 6e74 332e 6964 0a0a 0a20  == event3.id... 
+00019130: 2020 2023 2053 7562 7363 7269 6265 2061     # Subscribe a
+00019140: 6c6c 2065 7665 6e74 732e 0a20 2020 2072  ll events..    r
+00019150: 6563 6569 7665 6420 3d20 5b5d 0a20 2020  eceived = [].   
+00019160: 2061 7379 6e63 2066 6f72 2065 7665 6e74   async for event
+00019170: 2069 6e20 6177 6169 7420 636c 6965 6e74   in await client
+00019180: 2e73 7562 7363 7269 6265 5f61 6c6c 5f65  .subscribe_all_e
+00019190: 7665 6e74 7328 293a 0a20 2020 2020 2020  vents():.       
+000191a0: 2072 6563 6569 7665 642e 6170 7065 6e64   received.append
+000191b0: 2865 7665 6e74 290a 2020 2020 2020 2020  (event).        
+000191c0: 6966 2065 7665 6e74 2e69 6420 3d3d 2065  if event.id == e
+000191d0: 7665 6e74 332e 6964 3a0a 2020 2020 2020  vent3.id:.      
+000191e0: 2020 2020 2020 6272 6561 6b0a 2020 2020        break.    
+000191f0: 6173 7365 7274 2072 6563 6569 7665 645b  assert received[
+00019200: 2d33 5d2e 6964 203d 3d20 6576 656e 7431  -3].id == event1
+00019210: 2e69 640a 2020 2020 6173 7365 7274 2072  .id.    assert r
+00019220: 6563 6569 7665 645b 2d32 5d2e 6964 203d  eceived[-2].id =
+00019230: 3d20 6576 656e 7432 2e69 640a 2020 2020  = event2.id.    
+00019240: 6173 7365 7274 2072 6563 6569 7665 645b  assert received[
+00019250: 2d31 5d2e 6964 203d 3d20 6576 656e 7433  -1].id == event3
+00019260: 2e69 640a 0a0a 2020 2020 2320 436c 6f73  .id...    # Clos
+00019270: 6520 7468 6520 636c 6965 6e74 2e0a 2020  e the client..  
+00019280: 2020 6177 6169 7420 636c 6965 6e74 2e63    await client.c
+00019290: 6c6f 7365 2829 0a0a 0a23 2052 756e 2074  lose()...# Run t
+000192a0: 6865 2064 656d 6f2e 0a61 7379 6e63 696f  he demo..asyncio
+000192b0: 2e67 6574 5f65 7665 6e74 5f6c 6f6f 7028  .get_event_loop(
+000192c0: 292e 7275 6e5f 756e 7469 6c5f 636f 6d70  ).run_until_comp
+000192d0: 6c65 7465 280a 2020 2020 6465 6d6f 6e73  lete(.    demons
+000192e0: 7472 6174 655f 6173 796e 6369 6f5f 636c  trate_asyncio_cl
+000192f0: 6965 6e74 2829 0a29 0a60 6060 0a0a 2323  ient().).```..##
+00019300: 2043 6f6e 7472 6962 7574 6f72 730a 0a23   Contributors..#
+00019310: 2323 2049 6e73 7461 6c6c 2050 6f65 7472  ## Install Poetr
+00019320: 790a 0a54 6865 2066 6972 7374 2074 6869  y..The first thi
+00019330: 6e67 2069 7320 746f 2063 6865 636b 2079  ng is to check y
+00019340: 6f75 2068 6176 6520 506f 6574 7279 2069  ou have Poetry i
+00019350: 6e73 7461 6c6c 6564 2e0a 0a20 2020 2024  nstalled...    $
+00019360: 2070 6f65 7472 7920 2d2d 7665 7273 696f   poetry --versio
+00019370: 6e0a 0a49 6620 796f 7520 646f 6e27 742c  n..If you don't,
+00019380: 2074 6865 6e20 706c 6561 7365 205b 696e   then please [in
+00019390: 7374 616c 6c20 506f 6574 7279 5d28 6874  stall Poetry](ht
+000193a0: 7470 733a 2f2f 7079 7468 6f6e 2d70 6f65  tps://python-poe
+000193b0: 7472 792e 6f72 672f 646f 6373 2f23 696e  try.org/docs/#in
+000193c0: 7374 616c 6c69 6e67 2d77 6974 682d 7468  stalling-with-th
+000193d0: 652d 6f66 6669 6369 616c 2d69 6e73 7461  e-official-insta
+000193e0: 6c6c 6572 292e 0a0a 2020 2020 2420 6375  ller)...    $ cu
+000193f0: 726c 202d 7353 4c20 6874 7470 733a 2f2f  rl -sSL https://
+00019400: 696e 7374 616c 6c2e 7079 7468 6f6e 2d70  install.python-p
+00019410: 6f65 7472 792e 6f72 6720 7c20 7079 7468  oetry.org | pyth
+00019420: 6f6e 3320 2d0a 0a49 7420 7769 6c6c 2068  on3 -..It will h
+00019430: 656c 7020 746f 206d 616b 6520 7375 7265  elp to make sure
+00019440: 2050 6f65 7472 7927 7320 6269 6e20 6469   Poetry's bin di
+00019450: 7265 6374 6f72 7920 6973 2069 6e20 796f  rectory is in yo
+00019460: 7572 2060 5041 5448 6020 656e 7669 726f  ur `PATH` enviro
+00019470: 6e6d 656e 7420 7661 7269 6162 6c65 2e0a  nment variable..
+00019480: 0a42 7574 2069 6e20 616e 7920 6361 7365  .But in any case
+00019490: 2c20 6d61 6b65 2073 7572 6520 796f 7520  , make sure you 
+000194a0: 6b6e 6f77 2074 6865 2070 6174 6820 746f  know the path to
+000194b0: 2074 6865 2060 706f 6574 7279 6020 6578   the `poetry` ex
+000194c0: 6563 7574 6162 6c65 2e20 5468 6520 506f  ecutable. The Po
+000194d0: 6574 7279 0a69 6e73 7461 6c6c 6572 2074  etry.installer t
+000194e0: 656c 6c73 2079 6f75 2077 6865 7265 2069  ells you where i
+000194f0: 7420 6861 7320 6265 656e 2069 6e73 7461  t has been insta
+00019500: 6c6c 6564 2c20 616e 6420 686f 7720 746f  lled, and how to
+00019510: 2063 6f6e 6669 6775 7265 2079 6f75 7220   configure your 
+00019520: 7368 656c 6c2e 0a0a 506c 6561 7365 2072  shell...Please r
+00019530: 6566 6572 2074 6f20 7468 6520 5b50 6f65  efer to the [Poe
+00019540: 7472 7920 646f 6373 5d28 6874 7470 733a  try docs](https:
+00019550: 2f2f 7079 7468 6f6e 2d70 6f65 7472 792e  //python-poetry.
+00019560: 6f72 672f 646f 6373 2f29 2066 6f72 2067  org/docs/) for g
+00019570: 7569 6461 6e63 6520 6f6e 0a75 7369 6e67  uidance on.using
+00019580: 2050 6f65 7472 792e 0a0a 2323 2320 5365   Poetry...### Se
+00019590: 7475 7020 666f 7220 5079 4368 6172 6d20  tup for PyCharm 
+000195a0: 7573 6572 730a 0a59 6f75 2063 616e 2065  users..You can e
+000195b0: 6173 696c 7920 6f62 7461 696e 2074 6865  asily obtain the
+000195c0: 2070 726f 6a65 6374 2066 696c 6573 2075   project files u
+000195d0: 7369 6e67 2050 7943 6861 726d 2028 6d65  sing PyCharm (me
+000195e0: 6e75 2022 4769 7420 3e20 436c 6f6e 652e  nu "Git > Clone.
+000195f0: 2e2e 2229 2e0a 5079 4368 6172 6d20 7769  ..")..PyCharm wi
+00019600: 6c6c 2074 6865 6e20 7573 7561 6c6c 7920  ll then usually 
+00019610: 7072 6f6d 7074 2079 6f75 2074 6f20 6f70  prompt you to op
+00019620: 656e 2074 6865 2070 726f 6a65 6374 2e0a  en the project..
+00019630: 0a4f 7065 6e20 7468 6520 7072 6f6a 6563  .Open the projec
+00019640: 7420 696e 2061 206e 6577 2077 696e 646f  t in a new windo
+00019650: 772e 2050 7943 6861 726d 2077 696c 6c20  w. PyCharm will 
+00019660: 7468 656e 2075 7375 616c 6c79 2070 726f  then usually pro
+00019670: 6d70 7420 796f 7520 746f 2063 7265 6174  mpt you to creat
+00019680: 650a 6120 6e65 7720 7669 7274 7561 6c20  e.a new virtual 
+00019690: 656e 7669 726f 6e6d 656e 742e 0a0a 4372  environment...Cr
+000196a0: 6561 7465 2061 206e 6577 2050 6f65 7472  eate a new Poetr
+000196b0: 7920 7669 7274 7561 6c20 656e 7669 726f  y virtual enviro
+000196c0: 6e6d 656e 7420 666f 7220 7468 6520 7072  nment for the pr
+000196d0: 6f6a 6563 742e 2049 6620 5079 4368 6172  oject. If PyChar
+000196e0: 6d20 646f 6573 6e27 7420 616c 7265 6164  m doesn't alread
+000196f0: 790a 6b6e 6f77 2077 6865 7265 2079 6f75  y.know where you
+00019700: 7220 6070 6f65 7472 7960 2065 7865 6375  r `poetry` execu
+00019710: 7461 626c 6520 6973 2c20 7468 656e 2073  table is, then s
+00019720: 6574 2074 6865 2070 6174 6820 746f 2079  et the path to y
+00019730: 6f75 7220 6070 6f65 7472 7960 2065 7865  our `poetry` exe
+00019740: 6375 7461 626c 650a 696e 2074 6865 2022  cutable.in the "
+00019750: 4e65 7720 506f 6574 7279 2045 6e76 6972  New Poetry Envir
+00019760: 6f6e 6d65 6e74 2220 666f 726d 2069 6e70  onment" form inp
+00019770: 7574 2066 6965 6c64 206c 6162 656c 6c65  ut field labelle
+00019780: 6420 2250 6f65 7472 7920 6578 6563 7574  d "Poetry execut
+00019790: 6162 6c65 222e 2049 6e20 7468 650a 224e  able". In the."N
+000197a0: 6577 2050 6f65 7472 7920 456e 7669 726f  ew Poetry Enviro
+000197b0: 6e6d 656e 7422 2066 6f72 6d2c 2079 6f75  nment" form, you
+000197c0: 2077 696c 6c20 616c 736f 2068 6176 6520   will also have 
+000197d0: 7468 6520 6f70 706f 7274 756e 6974 7920  the opportunity 
+000197e0: 746f 2073 656c 6563 7420 7768 6963 680a  to select which.
+000197f0: 5079 7468 6f6e 2065 7865 6375 7461 626c  Python executabl
+00019800: 6520 7769 6c6c 2062 6520 7573 6564 2062  e will be used b
+00019810: 7920 7468 6520 7669 7274 7561 6c20 656e  y the virtual en
+00019820: 7669 726f 6e6d 656e 742e 0a0a 5079 4368  vironment...PyCh
+00019830: 6172 6d20 7769 6c6c 2074 6865 6e20 6372  arm will then cr
+00019840: 6561 7465 2061 206e 6577 2050 6f65 7472  eate a new Poetr
+00019850: 7920 7669 7274 7561 6c20 656e 7669 726f  y virtual enviro
+00019860: 6e6d 656e 7420 666f 7220 796f 7572 2070  nment for your p
+00019870: 726f 6a65 6374 2c20 7573 696e 670a 6120  roject, using.a 
+00019880: 7061 7274 6963 756c 6172 2076 6572 7369  particular versi
+00019890: 6f6e 206f 6620 5079 7468 6f6e 2c20 616e  on of Python, an
+000198a0: 6420 616c 736f 2069 6e73 7461 6c6c 2069  d also install i
+000198b0: 6e74 6f20 7468 6973 2076 6972 7475 616c  nto this virtual
+000198c0: 2065 6e76 6972 6f6e 6d65 6e74 2074 6865   environment the
+000198d0: 0a70 726f 6a65 6374 2773 2070 6163 6b61  .project's packa
+000198e0: 6765 2064 6570 656e 6465 6e63 6965 7320  ge dependencies 
+000198f0: 6163 636f 7264 696e 6720 746f 2074 6865  according to the
+00019900: 2070 726f 6a65 6374 2773 2060 706f 6574   project's `poet
+00019910: 7279 2e6c 6f63 6b60 2066 696c 652e 0a0a  ry.lock` file...
+00019920: 596f 7520 6361 6e20 6164 6420 6469 6666  You can add diff
+00019930: 6572 656e 7420 506f 6574 7279 2065 6e76  erent Poetry env
+00019940: 6972 6f6e 6d65 6e74 7320 666f 7220 6469  ironments for di
+00019950: 6666 6572 656e 7420 5079 7468 6f6e 2076  fferent Python v
+00019960: 6572 7369 6f6e 732c 2061 6e64 2073 7769  ersions, and swi
+00019970: 7463 680a 6265 7477 6565 6e20 7468 656d  tch.between them
+00019980: 2075 7369 6e67 2074 6865 2022 5079 7468   using the "Pyth
+00019990: 6f6e 2049 6e74 6572 7072 6574 6572 2220  on Interpreter" 
+000199a0: 7365 7474 696e 6773 206f 6620 5079 4368  settings of PyCh
+000199b0: 6172 6d2e 2049 6620 796f 7520 7761 6e74  arm. If you want
+000199c0: 2074 6f20 7573 650a 6120 7665 7273 696f   to use.a versio
+000199d0: 6e20 6f66 2050 7974 686f 6e20 7468 6174  n of Python that
+000199e0: 2069 736e 2774 2069 6e73 7461 6c6c 6564   isn't installed
+000199f0: 2c20 6569 7468 6572 2075 7365 2079 6f75  , either use you
+00019a00: 7220 6661 766f 7572 6974 6520 7061 636b  r favourite pack
+00019a10: 6167 6520 6d61 6e61 6765 722c 0a6f 7220  age manager,.or 
+00019a20: 696e 7374 616c 6c20 5079 7468 6f6e 2062  install Python b
+00019a30: 7920 646f 776e 6c6f 6164 696e 6720 616e  y downloading an
+00019a40: 2069 6e73 7461 6c6c 6572 2066 6f72 2072   installer for r
+00019a50: 6563 656e 7420 7665 7273 696f 6e73 206f  ecent versions o
+00019a60: 6620 5079 7468 6f6e 2064 6972 6563 746c  f Python directl
+00019a70: 790a 6672 6f6d 2074 6865 205b 5079 7468  y.from the [Pyth
+00019a80: 6f6e 2077 6562 7369 7465 5d28 6874 7470  on website](http
+00019a90: 733a 2f2f 7777 772e 7079 7468 6f6e 2e6f  s://www.python.o
+00019aa0: 7267 2f64 6f77 6e6c 6f61 6473 2f29 2e0a  rg/downloads/)..
+00019ab0: 0a4f 6e63 6520 7072 6f6a 6563 7420 6465  .Once project de
+00019ac0: 7065 6e64 656e 6369 6573 2068 6176 6520  pendencies have 
+00019ad0: 6265 656e 2069 6e73 7461 6c6c 6564 2c20  been installed, 
+00019ae0: 796f 7520 7368 6f75 6c64 2062 6520 6162  you should be ab
+00019af0: 6c65 2074 6f20 7275 6e20 7465 7374 730a  le to run tests.
+00019b00: 6672 6f6d 2077 6974 6869 6e20 5079 4368  from within PyCh
+00019b10: 6172 6d20 2872 6967 6874 2d63 6c69 636b  arm (right-click
+00019b20: 206f 6e20 7468 6520 6074 6573 7473 6020   on the `tests` 
+00019b30: 666f 6c64 6572 2061 6e64 2073 656c 6563  folder and selec
+00019b40: 7420 7468 6520 2752 756e 2720 6f70 7469  t the 'Run' opti
+00019b50: 6f6e 292e 0a0a 4265 6361 7573 6520 6f66  on)...Because of
+00019b60: 2061 2063 6f6e 666c 6963 7420 6265 7477   a conflict betw
+00019b70: 6565 6e20 7079 7465 7374 2061 6e64 2050  een pytest and P
+00019b80: 7943 6861 726d 2773 2064 6562 7567 6765  yCharm's debugge
+00019b90: 7220 616e 6420 7468 6520 636f 7665 7261  r and the covera
+00019ba0: 6765 2074 6f6f 6c2c 0a79 6f75 206d 6179  ge tool,.you may
+00019bb0: 206e 6565 6420 746f 2061 6464 2060 602d   need to add ``-
+00019bc0: 2d6e 6f2d 636f 7660 6020 6173 2061 6e20  -no-cov`` as an 
+00019bd0: 6f70 7469 6f6e 2074 6f20 7468 6520 7465  option to the te
+00019be0: 7374 2072 756e 6e65 7220 7465 6d70 6c61  st runner templa
+00019bf0: 7465 2e20 416c 7465 726e 6174 6976 656c  te. Alternativel
+00019c00: 792c 0a6a 7573 7420 7573 6520 7468 6520  y,.just use the 
+00019c10: 5079 7468 6f6e 2053 7461 6e64 6172 6420  Python Standard 
+00019c20: 4c69 6272 6172 7927 7320 6060 756e 6974  Library's ``unit
+00019c30: 7465 7374 6060 206d 6f64 756c 652e 0a0a  test`` module...
+00019c40: 596f 7520 7368 6f75 6c64 2061 6c73 6f20  You should also 
+00019c50: 6265 2061 626c 6520 746f 206f 7065 6e20  be able to open 
+00019c60: 6120 7465 726d 696e 616c 2077 696e 646f  a terminal windo
+00019c70: 7720 696e 2050 7943 6861 726d 2c20 616e  w in PyCharm, an
+00019c80: 6420 7275 6e20 7468 6520 7072 6f6a 6563  d run the projec
+00019c90: 7427 730a 4d61 6b65 6669 6c65 2063 6f6d  t's.Makefile com
+00019ca0: 6d61 6e64 7320 6672 6f6d 2074 6865 2063  mands from the c
+00019cb0: 6f6d 6d61 6e64 206c 696e 6520 2873 6565  ommand line (see
+00019cc0: 2062 656c 6f77 292e 0a0a 2323 2320 5365   below)...### Se
+00019cd0: 7475 7020 6672 6f6d 2063 6f6d 6d61 6e64  tup from command
+00019ce0: 206c 696e 650a 0a4f 6274 6169 6e20 7468   line..Obtain th
+00019cf0: 6520 7072 6f6a 6563 7420 6669 6c65 732c  e project files,
+00019d00: 2075 7369 6e67 2047 6974 206f 7220 7375   using Git or su
+00019d10: 6974 6162 6c65 2061 6c74 6572 6e61 7469  itable alternati
+00019d20: 7665 2e0a 0a49 6e20 6120 7465 726d 696e  ve...In a termin
+00019d30: 616c 2061 7070 6c69 6361 7469 6f6e 2c20  al application, 
+00019d40: 6368 616e 6765 2079 6f75 7220 6375 7272  change your curr
+00019d50: 656e 7420 776f 726b 696e 6720 6469 7265  ent working dire
+00019d60: 6374 6f72 790a 746f 2074 6865 2072 6f6f  ctory.to the roo
+00019d70: 7420 666f 6c64 6572 206f 6620 7468 6520  t folder of the 
+00019d80: 7072 6f6a 6563 7420 6669 6c65 732e 2054  project files. T
+00019d90: 6865 7265 2073 686f 756c 6420 6265 2061  here should be a
+00019da0: 204d 616b 6566 696c 650a 696e 2074 6869   Makefile.in thi
+00019db0: 7320 666f 6c64 6572 2e0a 0a55 7365 2074  s folder...Use t
+00019dc0: 6865 204d 616b 6566 696c 6520 746f 2063  he Makefile to c
+00019dd0: 7265 6174 6520 6120 6e65 7720 506f 6574  reate a new Poet
+00019de0: 7279 2076 6972 7475 616c 2065 6e76 6972  ry virtual envir
+00019df0: 6f6e 6d65 6e74 2066 6f72 2074 6865 0a70  onment for the.p
+00019e00: 726f 6a65 6374 2061 6e64 2069 6e73 7461  roject and insta
+00019e10: 6c6c 2074 6865 2070 726f 6a65 6374 2773  ll the project's
+00019e20: 2070 6163 6b61 6765 2064 6570 656e 6465   package depende
+00019e30: 6e63 6965 7320 696e 746f 2069 742c 0a75  ncies into it,.u
+00019e40: 7369 6e67 2074 6865 2066 6f6c 6c6f 7769  sing the followi
+00019e50: 6e67 2063 6f6d 6d61 6e64 2e0a 0a20 2020  ng command...   
+00019e60: 2024 206d 616b 6520 696e 7374 616c 6c2d   $ make install-
+00019e70: 7061 636b 6167 6573 0a0a 4974 2773 2061  packages..It's a
+00019e80: 6c73 6f20 706f 7373 6962 6c65 2074 6f20  lso possible to 
+00019e90: 616c 736f 2069 6e73 7461 6c6c 2074 6865  also install the
+00019ea0: 2070 726f 6a65 6374 2069 6e20 2765 6469   project in 'edi
+00019eb0: 7461 626c 6520 6d6f 6465 272e 0a0a 2020  table mode'...  
+00019ec0: 2020 2420 6d61 6b65 2069 6e73 7461 6c6c    $ make install
+00019ed0: 0a0a 506c 6561 7365 206e 6f74 652c 2069  ..Please note, i
+00019ee0: 6620 796f 7520 6372 6561 7465 2074 6865  f you create the
+00019ef0: 2076 6972 7475 616c 2065 6e76 6972 6f6e   virtual environ
+00019f00: 6d65 6e74 2069 6e20 7468 6973 2077 6179  ment in this way
+00019f10: 2c20 616e 6420 7468 656e 2074 7279 2074  , and then try t
+00019f20: 6f0a 6f70 656e 2074 6865 2070 726f 6a65  o.open the proje
+00019f30: 6374 2069 6e20 5079 4368 6172 6d20 616e  ct in PyCharm an
+00019f40: 6420 636f 6e66 6967 7572 6520 7468 6520  d configure the 
+00019f50: 7072 6f6a 6563 7420 746f 2075 7365 2074  project to use t
+00019f60: 6869 7320 7669 7274 7561 6c0a 656e 7669  his virtual.envi
+00019f70: 726f 6e6d 656e 7420 6173 2061 6e20 2245  ronment as an "E
+00019f80: 7869 7374 696e 6720 506f 6574 7279 2045  xisting Poetry E
+00019f90: 6e76 6972 6f6e 6d65 6e74 222c 2050 7943  nvironment", PyC
+00019fa0: 6861 726d 2073 6f6d 6574 696d 6573 2068  harm sometimes h
+00019fb0: 6173 2073 6f6d 650a 6973 7375 6573 2028  as some.issues (
+00019fc0: 646f 6e27 7420 6b6e 6f77 2077 6879 2920  don't know why) 
+00019fd0: 7768 6963 6820 6d69 6768 7420 6265 2070  which might be p
+00019fe0: 726f 626c 656d 6174 6963 2e20 4966 2079  roblematic. If y
+00019ff0: 6f75 2065 6e63 6f75 6e74 6572 2073 7563  ou encounter suc
+0001a000: 680a 6973 7375 6573 2c20 796f 7520 6361  h.issues, you ca
+0001a010: 6e20 7265 736f 6c76 6520 7468 6573 6520  n resolve these 
+0001a020: 6973 7375 6573 2062 7920 6465 6c65 7469  issues by deleti
+0001a030: 6e67 2074 6865 2076 6972 7475 616c 2065  ng the virtual e
+0001a040: 6e76 6972 6f6e 6d65 6e74 0a61 6e64 2063  nvironment.and c
+0001a050: 7265 6174 696e 6720 7468 6520 506f 6574  reating the Poet
+0001a060: 7279 2076 6972 7475 616c 2065 6e76 6972  ry virtual envir
+0001a070: 6f6e 6d65 6e74 2075 7369 6e67 2050 7943  onment using PyC
+0001a080: 6861 726d 2028 7365 6520 6162 6f76 6529  harm (see above)
+0001a090: 2e0a 0a23 2323 2050 726f 6a65 6374 204d  ...### Project M
+0001a0a0: 616b 6566 696c 6520 636f 6d6d 616e 6473  akefile commands
+0001a0b0: 0a0a 596f 7520 6361 6e20 7374 6172 7420  ..You can start 
+0001a0c0: 4576 656e 7453 746f 7265 4442 2075 7369  EventStoreDB usi
+0001a0d0: 6e67 2074 6865 2066 6f6c 6c6f 7769 6e67  ng the following
+0001a0e0: 2063 6f6d 6d61 6e64 2e0a 0a20 2020 2024   command...    $
+0001a0f0: 206d 616b 6520 7374 6172 742d 6576 656e   make start-even
+0001a100: 7473 746f 7265 6462 0a0a 596f 7520 6361  tstoredb..You ca
+0001a110: 6e20 7275 6e20 7465 7374 7320 7573 696e  n run tests usin
+0001a120: 6720 7468 6520 666f 6c6c 6f77 696e 6720  g the following 
+0001a130: 636f 6d6d 616e 6420 286e 6565 6473 2045  command (needs E
+0001a140: 7665 6e74 5374 6f72 6544 4220 746f 2062  ventStoreDB to b
+0001a150: 6520 7275 6e6e 696e 6729 2e0a 0a20 2020  e running)...   
+0001a160: 2024 206d 616b 6520 7465 7374 0a0a 596f   $ make test..Yo
+0001a170: 7520 6361 6e20 7374 6f70 2045 7665 6e74  u can stop Event
+0001a180: 5374 6f72 6544 4220 7573 696e 6720 7468  StoreDB using th
+0001a190: 6520 666f 6c6c 6f77 696e 6720 636f 6d6d  e following comm
+0001a1a0: 616e 642e 0a0a 2020 2020 2420 6d61 6b65  and...    $ make
+0001a1b0: 2073 746f 702d 6576 656e 7473 746f 7265   stop-eventstore
+0001a1c0: 6462 0a0a 596f 7520 6361 6e20 6368 6563  db..You can chec
+0001a1d0: 6b20 7468 6520 666f 726d 6174 7469 6e67  k the formatting
+0001a1e0: 206f 6620 7468 6520 636f 6465 2075 7369   of the code usi
+0001a1f0: 6e67 2074 6865 2066 6f6c 6c6f 7769 6e67  ng the following
+0001a200: 2063 6f6d 6d61 6e64 2e0a 0a20 2020 2024   command...    $
+0001a210: 206d 616b 6520 6c69 6e74 0a0a 596f 7520   make lint..You 
+0001a220: 6361 6e20 7265 666f 726d 6174 2074 6865  can reformat the
+0001a230: 2063 6f64 6520 7573 696e 6720 7468 6520   code using the 
+0001a240: 666f 6c6c 6f77 696e 6720 636f 6d6d 616e  following comman
+0001a250: 642e 0a0a 2020 2020 2420 6d61 6b65 2066  d...    $ make f
+0001a260: 6d74 0a0a 5465 7374 7320 6265 6c6f 6e67  mt..Tests belong
+0001a270: 2069 6e20 602e 2f74 6573 7473 602e 2043   in `./tests`. C
+0001a280: 6f64 652d 756e 6465 722d 7465 7374 2062  ode-under-test b
+0001a290: 656c 6f6e 6773 2069 6e20 602e 2f65 7364  elongs in `./esd
+0001a2a0: 6263 6c69 656e 7460 2e0a 0a45 6469 7420  bclient`...Edit 
+0001a2b0: 7061 636b 6167 6520 6465 7065 6e64 656e  package dependen
+0001a2c0: 6369 6573 2069 6e20 6070 7970 726f 6a65  cies in `pyproje
+0001a2d0: 6374 2e74 6f6d 6c60 2e20 5570 6461 7465  ct.toml`. Update
+0001a2e0: 2069 6e73 7461 6c6c 6564 2070 6163 6b61   installed packa
+0001a2f0: 6765 7320 2861 6e64 2074 6865 0a60 706f  ges (and the.`po
+0001a300: 6574 7279 2e6c 6f63 6b60 2066 696c 6529  etry.lock` file)
+0001a310: 2075 7369 6e67 2074 6865 2066 6f6c 6c6f   using the follo
+0001a320: 7769 6e67 2063 6f6d 6d61 6e64 2e0a 0a20  wing command... 
+0001a330: 2020 2024 206d 616b 6520 7570 6461 7465     $ make update
+0001a340: 2d70 6163 6b61 6765 730a                 -packages.
```

### Comparing `esdbclient-1.0a4/esdbclient/__init__.py` & `esdbclient-1.0a5/esdbclient/__init__.py`

 * *Files identical despite different names*

### Comparing `esdbclient-1.0a4/esdbclient/asyncio_client.py` & `esdbclient-1.0a5/esdbclient/asyncio_client.py`

 * *Files identical despite different names*

### Comparing `esdbclient-1.0a4/esdbclient/client.py` & `esdbclient-1.0a5/esdbclient/client.py`

 * *Files 5% similar despite different names*

```diff
@@ -6,39 +6,38 @@
 from threading import Event, Lock
 from time import sleep
 from typing import (
     Any,
     Callable,
     Dict,
     Iterable,
-    Iterator,
     Optional,
     Sequence,
     Tuple,
     TypeVar,
     cast,
     overload,
 )
 
 import dns.exception
 import dns.resolver
 import grpc
-from grpc import CallCredentials, RpcError
+from grpc import CallCredentials
 
 from esdbclient.connection import (
     NODE_PREFERENCE_FOLLOWER,
     NODE_PREFERENCE_LEADER,
     NODE_PREFERENCE_RANDOM,
     NODE_PREFERENCE_REPLICA,
     URI_SCHEME_ESDB,
     URI_SCHEME_ESDB_DISCOVER,
     ConnectionSpec,
     ESDBConnection,
 )
-from esdbclient.esdbapibase import BasicAuthCallCredentials, handle_rpc_error
+from esdbclient.esdbapibase import BasicAuthCallCredentials
 from esdbclient.events import NewEvent, RecordedEvent
 from esdbclient.exceptions import (
     DiscoveryFailed,
     DNSError,
     FollowerNotFound,
     GossipSeedError,
     GrpcError,
@@ -52,18 +51,18 @@
     NODE_STATE_FOLLOWER,
     NODE_STATE_LEADER,
     NODE_STATE_REPLICA,
     ClusterMember,
 )
 from esdbclient.persistent import (
     ConsumerStrategy,
+    PersistentSubscription,
     SubscriptionInfo,
-    SubscriptionReadRequests,
-    SubscriptionReadResponse,
 )
+from esdbclient.streams import ReadResponse
 
 # Matches the 'type' of "system" events.
 ESDB_SYSTEM_EVENTS_REGEX = r"\$.+"
 # Matches the 'type' of "PersistentConfig" events.
 ESDB_PERSISTENT_CONFIG_EVENTS_REGEX = r"PersistentConfig\d+"
 
 DEFAULT_EXCLUDE_FILTER = (ESDB_SYSTEM_EVENTS_REGEX, ESDB_PERSISTENT_CONFIG_EVENTS_REGEX)
@@ -482,15 +481,15 @@
         commit_position: Optional[int] = None,
         backwards: bool = False,
         filter_exclude: Sequence[str] = DEFAULT_EXCLUDE_FILTER,
         filter_include: Sequence[str] = (),
         filter_by_stream_name: bool = False,
         limit: int = sys.maxsize,
         timeout: Optional[float] = None,
-    ) -> Iterable[RecordedEvent]:
+    ) -> ReadResponse:
         """
         Reads recorded events in "all streams" in the database.
         """
         return self._connection.streams.read(
             commit_position=commit_position,
             backwards=backwards,
             filter_exclude=filter_exclude,
@@ -606,52 +605,50 @@
     def subscribe_all_events(
         self,
         commit_position: Optional[int] = None,
         filter_exclude: Sequence[str] = DEFAULT_EXCLUDE_FILTER,
         filter_include: Sequence[str] = (),
         filter_by_stream_name: bool = False,
         timeout: Optional[float] = None,
-    ) -> Iterator[RecordedEvent]:
+    ) -> ReadResponse:
         """
         Starts a catch-up subscription, from which all
         recorded events in the database can be received.
         """
-        read_resp = self._connection.streams.read(
+        return self._connection.streams.read(
             commit_position=commit_position,
             filter_exclude=filter_exclude,
             filter_include=filter_include,
             filter_by_stream_name=filter_by_stream_name,
             subscribe=True,
             timeout=timeout,
             metadata=self._call_metadata,
             credentials=self._call_credentials,
         )
-        return CatchupSubscription(read_resp=read_resp)
 
     @retrygrpc
     @autoreconnect
     def subscribe_stream_events(
         self,
         stream_name: str,
         stream_position: Optional[int] = None,
         timeout: Optional[float] = None,
-    ) -> Iterator[RecordedEvent]:
+    ) -> ReadResponse:
         """
         Starts a catch-up subscription from which
         recorded events in a stream can be received.
         """
-        read_resp = self._connection.streams.read(
+        return self._connection.streams.read(
             stream_name=stream_name,
             stream_position=stream_position,
             subscribe=True,
             timeout=timeout,
             metadata=self._call_metadata,
             credentials=self._call_credentials,
         )
-        return CatchupSubscription(read_resp=read_resp)
 
     @overload
     def create_subscription(
         self,
         group_name: str,
         *,
         filter_exclude: Sequence[str] = DEFAULT_EXCLUDE_FILTER,
@@ -794,37 +791,43 @@
             metadata=self._call_metadata,
             credentials=self._call_credentials,
         )
 
     @retrygrpc
     @autoreconnect
     def read_subscription(
-        self, group_name: str, timeout: Optional[float] = None
-    ) -> Tuple[SubscriptionReadRequests, SubscriptionReadResponse]:
+        self, group_name: str, buffer_size: int = 100, timeout: Optional[float] = None
+    ) -> PersistentSubscription:
         """
         Reads a persistent subscription on all streams.
         """
         return self._connection.persistent_subscriptions.read(
             group_name=group_name,
+            buffer_size=buffer_size,
             timeout=timeout,
             metadata=self._call_metadata,
             credentials=self._call_credentials,
         )
 
     @retrygrpc
     @autoreconnect
     def read_stream_subscription(
-        self, group_name: str, stream_name: str, timeout: Optional[float] = None
-    ) -> Tuple[SubscriptionReadRequests, SubscriptionReadResponse]:
+        self,
+        group_name: str,
+        stream_name: str,
+        buffer_size: int = 100,
+        timeout: Optional[float] = None,
+    ) -> PersistentSubscription:
         """
         Reads a persistent subscription on one stream.
         """
         return self._connection.persistent_subscriptions.read(
             group_name=group_name,
             stream_name=stream_name,
+            buffer_size=buffer_size,
             timeout=timeout,
             metadata=self._call_metadata,
             credentials=self._call_credentials,
         )
 
     @retrygrpc
     @autoreconnect
@@ -882,14 +885,135 @@
         return self._connection.persistent_subscriptions.list(
             stream_name=stream_name,
             timeout=timeout,
             metadata=self._call_metadata,
             credentials=self._call_credentials,
         )
 
+    @overload
+    def update_subscription(
+        self,
+        group_name: str,
+        *,
+        timeout: Optional[float] = None,
+    ) -> None:
+        """
+        Signature for updating persistent subscription from start of database.
+        """
+
+    @overload
+    def update_subscription(
+        self,
+        group_name: str,
+        *,
+        commit_position: int,
+        timeout: Optional[float] = None,
+    ) -> None:
+        """
+        Signature for updating persistent subscription from a commit position.
+        """
+
+    @overload
+    def update_subscription(
+        self,
+        group_name: str,
+        *,
+        from_end: bool = True,
+        timeout: Optional[float] = None,
+    ) -> None:
+        """
+        Signature for updating persistent subscription from end of database.
+        """
+
+    @retrygrpc
+    @autoreconnect
+    def update_subscription(
+        self,
+        group_name: str,
+        from_end: bool = False,
+        commit_position: Optional[int] = None,
+        timeout: Optional[float] = None,
+    ) -> None:
+        """
+        Updates a persistent subscription on all streams.
+        """
+        timeout = timeout if timeout is not None else self._default_deadline
+
+        self._connection.persistent_subscriptions.update(
+            group_name=group_name,
+            from_end=from_end,
+            commit_position=commit_position,
+            timeout=timeout,
+            metadata=self._call_metadata,
+            credentials=self._call_credentials,
+        )
+
+    @overload
+    def update_stream_subscription(
+        self,
+        group_name: str,
+        stream_name: str,
+        *,
+        timeout: Optional[float] = None,
+    ) -> None:
+        """
+        Signature for updating stream subscription from start of stream.
+        """
+
+    @overload
+    def update_stream_subscription(
+        self,
+        group_name: str,
+        stream_name: str,
+        *,
+        stream_position: int,
+        timeout: Optional[float] = None,
+    ) -> None:
+        """
+        Signature for updating stream subscription from stream position.
+        """
+
+    @overload
+    def update_stream_subscription(
+        self,
+        group_name: str,
+        stream_name: str,
+        *,
+        from_end: bool = True,
+        timeout: Optional[float] = None,
+    ) -> None:
+        """
+        Signature for updating stream subscription from end of stream.
+        """
+
+    @retrygrpc
+    @autoreconnect
+    def update_stream_subscription(
+        self,
+        group_name: str,
+        stream_name: str,
+        from_end: bool = False,
+        stream_position: Optional[int] = None,
+        timeout: Optional[float] = None,
+    ) -> None:
+        """
+        Updates a persistent subscription on one stream.
+        """
+        timeout = timeout if timeout is not None else self._default_deadline
+
+        self._connection.persistent_subscriptions.update(
+            group_name=group_name,
+            stream_name=stream_name,
+            from_end=from_end,
+            stream_position=stream_position,
+            timeout=timeout,
+            metadata=self._call_metadata,
+            credentials=self._call_credentials,
+        )
+
     @retrygrpc
     @autoreconnect
     def delete_subscription(
         self, group_name: str, timeout: Optional[float] = None
     ) -> None:
         """
         Creates a persistent subscription on all streams.
@@ -960,28 +1084,7 @@
         except AttributeError:
             pass
         else:
             c.close()
 
     def __del__(self) -> None:
         self.close()
-
-
-class CatchupSubscription(Iterator[RecordedEvent]):
-    """
-    Encapsulates read response for a catch-up subscription.
-    """
-
-    def __init__(
-        self,
-        read_resp: Iterable[RecordedEvent],
-    ):
-        self.read_resp = iter(read_resp)
-
-    def __iter__(self) -> Iterator[RecordedEvent]:
-        return self
-
-    def __next__(self) -> RecordedEvent:
-        try:
-            return next(self.read_resp)
-        except RpcError as e:
-            raise handle_rpc_error(e) from e  # pragma: no cover
```

### Comparing `esdbclient-1.0a4/esdbclient/connection.py` & `esdbclient-1.0a5/esdbclient/connection.py`

 * *Files identical despite different names*

### Comparing `esdbclient-1.0a4/esdbclient/esdbapibase.py` & `esdbclient-1.0a5/esdbclient/esdbapibase.py`

 * *Files 4% similar despite different names*

```diff
@@ -3,14 +3,15 @@
 from typing import TYPE_CHECKING, Optional, Tuple
 
 import grpc
 from grpc import AuthMetadataContext, AuthMetadataPluginCallback, RpcError, StatusCode
 from grpc.aio import AioRpcError
 
 from esdbclient.exceptions import (
+    CancelledByClient,
     DeadlineExceeded,
     ESDBClientException,
     ExceptionThrownByHandler,
     GrpcError,
     NodeIsNotLeader,
     NotFound,
     ServiceUnavailable,
@@ -41,18 +42,23 @@
     Converts gRPC errors to client exceptions.
     """
     if isinstance(e, (grpc.Call, AioRpcError)):
         if e.code() == StatusCode.UNKNOWN and "Exception was thrown by handler" in str(
             e.details()
         ):
             return ExceptionThrownByHandler(e)
-        elif e.code() == StatusCode.UNAVAILABLE:
-            return ServiceUnavailable(e)
+        elif (
+            e.code() == StatusCode.CANCELLED
+            and e.details() == "Locally cancelled by application!"
+        ):
+            return CancelledByClient(e)
         elif e.code() == StatusCode.DEADLINE_EXCEEDED:
             return DeadlineExceeded(e)
+        elif e.code() == StatusCode.UNAVAILABLE:
+            return ServiceUnavailable(e)
         elif (
             e.code() == StatusCode.NOT_FOUND and e.details() == "Leader info available"
         ):
             return NodeIsNotLeader(e)
         elif e.code() == StatusCode.NOT_FOUND:
             return NotFound()
     return GrpcError(e)
```

### Comparing `esdbclient-1.0a4/esdbclient/events.py` & `esdbclient-1.0a5/esdbclient/events.py`

 * *Files 20% similar despite different names*

```diff
@@ -31,7 +31,8 @@
     data: bytes
     metadata: bytes
     content_type: str
     id: UUID
     stream_name: str
     stream_position: int
     commit_position: Optional[int]
+    retry_count: Optional[int] = None
```

### Comparing `esdbclient-1.0a4/esdbclient/exceptions.py` & `esdbclient-1.0a5/esdbclient/exceptions.py`

 * *Files 8% similar despite different names*

```diff
@@ -26,14 +26,20 @@
 
 class DeadlineExceeded(GrpcError):
     """
     Raised when gRPC operation times out.
     """
 
 
+class CancelledByClient(GrpcError):
+    """
+    Raised when gRPC operation is cancelled.
+    """
+
+
 class NodeIsNotLeader(ESDBClientException):
     """
     Raised when client attempts to write to a node that is not a leader.
     """
 
 
 class NotFound(ESDBClientException):
```

### Comparing `esdbclient-1.0a4/esdbclient/gossip.py` & `esdbclient-1.0a5/esdbclient/gossip.py`

 * *Files identical despite different names*

### Comparing `esdbclient-1.0a4/esdbclient/persistent.py` & `esdbclient-1.0a5/esdbclient/persistent.py`

 * *Files 12% similar despite different names*

```diff
@@ -1,57 +1,64 @@
 # -*- coding: utf-8 -*-
 import queue
 from dataclasses import dataclass
-from typing import Iterable, List, Optional, Sequence, Tuple, Union, overload
+from typing import Iterator, List, Optional, Sequence, Tuple, Union, overload
 from uuid import UUID
 
 import grpc
 from grpc import CallCredentials, RpcError, StatusCode
+from grpc._channel import _MultiThreadedRendezvous
 from typing_extensions import Literal
 
 from esdbclient.esdbapibase import ESDBService, Metadata, handle_rpc_error
 from esdbclient.events import RecordedEvent
 from esdbclient.exceptions import (
+    CancelledByClient,
     ESDBClientException,
     NodeIsNotLeader,
     SubscriptionConfirmationError,
 )
 from esdbclient.protos.Grpc import persistent_pb2, persistent_pb2_grpc, shared_pb2
 
 ConsumerStrategy = Literal[
     "DispatchToSingle", "RoundRobin", "Pinned", "PinnedByCorrelation"
 ]
 
 
-class BaseSubscriptionReadRequests:
-    def __init__(self, group_name: str, stream_name: Optional[str] = None) -> None:
+class BaseSubscriptionReadReqs:
+    def __init__(
+        self, group_name: str, stream_name: Optional[str] = None, buffer_size: int = 100
+    ) -> None:
         self.group_name = group_name
         self.stream_name = stream_name
+        assert isinstance(buffer_size, int) and buffer_size > 0, buffer_size
+        self._buffer_size = buffer_size
         self._has_requested_options = False
 
     def _construct_initial_read_req(self) -> persistent_pb2.ReadReq:
         options = persistent_pb2.ReadReq.Options(
             group_name=self.group_name,
-            buffer_size=100,
+            buffer_size=self._buffer_size,
             uuid_option=persistent_pb2.ReadReq.Options.UUIDOption(
                 # structured=shared_pb2.Empty(),
                 string=shared_pb2.Empty(),
             ),
         )
         # Decide 'stream_option'.
         if isinstance(self.stream_name, str):
             options.stream_identifier.CopyFrom(
                 shared_pb2.StreamIdentifier(stream_name=self.stream_name.encode("utf8"))
             )
         else:
             options.all.CopyFrom(shared_pb2.Empty())
         return persistent_pb2.ReadReq(options=options)
 
-    def _construct_ack_nack_read_req(
-        self, ids: List[shared_pb2.UUID], action: str
+    @staticmethod
+    def _construct_ack_or_nack_read_req(
+        ids: List[shared_pb2.UUID], action: str
     ) -> persistent_pb2.ReadReq:
         if action == "ack":
             return persistent_pb2.ReadReq(ack=persistent_pb2.ReadReq.Ack(ids=ids))
         else:
             if action == "unknown":
                 grpc_action = persistent_pb2.ReadReq.Nack.Unknown
             elif action == "park":
@@ -64,35 +71,35 @@
                 assert action == "stop"
                 grpc_action = persistent_pb2.ReadReq.Nack.Stop
             return persistent_pb2.ReadReq(
                 nack=persistent_pb2.ReadReq.Nack(ids=ids, action=grpc_action)
             )
 
 
-class BaseSubscriptionReadResponse:
-    def _construct_recorded_event(
-        self, response: persistent_pb2.ReadResp
-    ) -> RecordedEvent:
-        event = response.event.event
-        position_oneof = response.event.WhichOneof("position")
+class BasePersistentSubscription:
+    @staticmethod
+    def _construct_recorded_event(read_resp: persistent_pb2.ReadResp) -> RecordedEvent:
+        event = read_resp.event.event
+        position_oneof = read_resp.event.WhichOneof("position")
         if position_oneof == "commit_position":
-            commit_position = response.event.commit_position
+            commit_position = read_resp.event.commit_position
         else:  # pragma: no cover
             # We only get here with EventStoreDB < 22.10.
             assert position_oneof == "no_position", position_oneof
             commit_position = None
         recorded_event = RecordedEvent(
             id=UUID(event.id.string),
             type=event.metadata.get("type", ""),
             data=event.data,
             metadata=event.custom_metadata,
             content_type=event.metadata.get("content-type", ""),
             stream_name=event.stream_identifier.stream_name.decode("utf8"),
             stream_position=event.stream_revision,
             commit_position=commit_position,
+            retry_count=read_resp.event.retry_count,
         )
         return recorded_event
 
 
 @dataclass
 class SubscriptionInfo:
     event_source: str
@@ -158,15 +165,14 @@
         # Construct CreateReq.Options.
         options = persistent_pb2.CreateReq.Options(
             group_name=group_name,
             settings=settings,
         )
         # Decide 'stream_option'.
         if isinstance(stream_name, str):
-            # Todo: Support persistent subscription to a stream.
             stream_options = persistent_pb2.CreateReq.StreamOptions(
                 stream_identifier=shared_pb2.StreamIdentifier(
                     stream_name=stream_name.encode("utf8")
                 ),
             )
             # Decide 'revision_option'.
             if isinstance(stream_position, int):
@@ -237,16 +243,16 @@
                 no_filter = shared_pb2.Empty()
                 all_options.no_filter.CopyFrom(no_filter)
 
             options.all.CopyFrom(all_options)
         # Construct RPC request.
         return persistent_pb2.CreateReq(options=options)
 
+    @staticmethod
     def _construct_get_info_req(
-        self,
         group_name: str,
         stream_name: Optional[str] = None,
     ) -> persistent_pb2.GetInfoReq:
         if stream_name is None:
             options = persistent_pb2.GetInfoReq.Options(
                 all=shared_pb2.Empty(),
                 group_name=group_name,
@@ -256,31 +262,96 @@
                 stream_identifier=shared_pb2.StreamIdentifier(
                     stream_name=stream_name.encode("utf8")
                 ),
                 group_name=group_name,
             )
         return persistent_pb2.GetInfoReq(options=options)
 
-    def _construct_list_req(self, stream_name: Optional[str]) -> persistent_pb2.ListReq:
+    @staticmethod
+    def _construct_list_req(stream_name: Optional[str]) -> persistent_pb2.ListReq:
         if stream_name is None:
             options = persistent_pb2.ListReq.Options(
                 list_all_subscriptions=shared_pb2.Empty()
             )
         else:
             options = persistent_pb2.ListReq.Options(
                 list_for_stream=persistent_pb2.ListReq.StreamOption(
                     stream=shared_pb2.StreamIdentifier(
                         stream_name=stream_name.encode("utf8")
                     )
                 )
             )
         return persistent_pb2.ListReq(options=options)
 
+    def _construct_update_req(
+        self,
+        group_name: str,
+        stream_name: Optional[str] = None,
+        from_end: bool = False,
+        commit_position: Optional[int] = None,
+        stream_position: Optional[int] = None,
+    ) -> persistent_pb2.UpdateReq:
+        # Construct 'settings'.
+        settings = persistent_pb2.UpdateReq.Settings(
+            resolve_links=False,
+            extra_statistics=False,
+            max_retry_count=5,
+            min_checkpoint_count=10,  # server recorded position
+            max_checkpoint_count=10,  # server recorded position
+            max_subscriber_count=5,
+            live_buffer_size=1000,  # how many new events to hold in memory?
+            read_batch_size=8,  # how many events to read from DB records?
+            history_buffer_size=200,  # how many recorded events to hold in memory?
+            message_timeout_ms=1000,
+            checkpoint_after_ms=100,
+        )
+        # Construct UpdateReq.Options.
+        options = persistent_pb2.UpdateReq.Options(
+            group_name=group_name,
+            settings=settings,
+        )
+        # Decide 'stream_option'.
+        if isinstance(stream_name, str):
+            stream_options = persistent_pb2.UpdateReq.StreamOptions(
+                stream_identifier=shared_pb2.StreamIdentifier(
+                    stream_name=stream_name.encode("utf8")
+                ),
+            )
+            # Decide 'revision_option'.
+            if isinstance(stream_position, int):
+                stream_options.revision = stream_position
+            elif from_end is False:
+                stream_options.start.CopyFrom(shared_pb2.Empty())
+            else:
+                stream_options.end.CopyFrom(shared_pb2.Empty())
+            options.stream.CopyFrom(stream_options)
+        else:
+            if commit_position is not None:
+                all_options = persistent_pb2.UpdateReq.AllOptions(
+                    position=persistent_pb2.UpdateReq.Position(
+                        commit_position=commit_position,
+                        prepare_position=commit_position,
+                    ),
+                )
+            elif from_end:
+                all_options = persistent_pb2.UpdateReq.AllOptions(
+                    end=shared_pb2.Empty(),
+                )
+            else:
+                all_options = persistent_pb2.UpdateReq.AllOptions(
+                    start=shared_pb2.Empty(),
+                )
+
+            options.all.CopyFrom(all_options)
+        # Construct RPC request.
+        return persistent_pb2.UpdateReq(options=options)
+
+    @staticmethod
     def _construct_delete_req(
-        self, group_name: str, stream_name: Optional[str]
+        group_name: str, stream_name: Optional[str]
     ) -> persistent_pb2.DeleteReq:
         if stream_name is None:
             options = persistent_pb2.DeleteReq.Options(
                 all=shared_pb2.Empty(),
                 group_name=group_name,
             )
         else:
@@ -328,19 +399,24 @@
             outstanding_messages_count=s.outstanding_messages_count,
             named_consumer_strategy=s.named_consumer_strategy,
             max_subscriber_count=s.max_subscriber_count,
             parked_message_count=s.parked_message_count,
         )
 
 
-class SubscriptionReadRequests(BaseSubscriptionReadRequests):
-    def __init__(self, group_name: str, stream_name: Optional[str] = None) -> None:
-        super().__init__(group_name=group_name, stream_name=stream_name)
+class SubscriptionReadReqs(BaseSubscriptionReadReqs):
+    def __init__(
+        self, group_name: str, stream_name: Optional[str] = None, buffer_size: int = 100
+    ) -> None:
+        super().__init__(
+            group_name=group_name, stream_name=stream_name, buffer_size=buffer_size
+        )
         self.queue: queue.Queue[Tuple[UUID, str]] = queue.Queue()
         self.held: Optional[Tuple[UUID, str]] = None
+        self._is_stopped = True
 
     def __next__(self) -> persistent_pb2.ReadReq:
         if not self._has_requested_options:
             self._has_requested_options = True
             return self._construct_initial_read_req()
         else:
             # Send a response whenever there are 100 acks or nacks of
@@ -355,46 +431,56 @@
             while True:
                 try:
                     event_id, action = self.queue.get(timeout=0.1)
                     if current_action is None:
                         current_action = action
                     elif current_action != action:
                         self.held = (event_id, action)
-                        return self._construct_ack_nack_read_req(ids, current_action)
+                        return self._construct_ack_or_nack_read_req(ids, current_action)
                     ids.append(shared_pb2.UUID(string=str(event_id)))
-                    if len(ids) >= 100:
-                        return self._construct_ack_nack_read_req(ids, current_action)
-                except queue.Empty:
+                    if len(ids) >= self._buffer_size:
+                        return self._construct_ack_or_nack_read_req(ids, current_action)
+                except queue.Empty as e:
                     if len(ids) >= 1:
                         assert current_action is not None
-                        return self._construct_ack_nack_read_req(ids, current_action)
+                        return self._construct_ack_or_nack_read_req(ids, current_action)
+                    elif self._is_stopped:
+                        raise StopIteration() from e
                     else:  # pragma: no cover
                         pass
 
     def ack(self, event_id: UUID) -> None:
         self.queue.put((event_id, "ack"))
 
     def nack(
         self,
         event_id: UUID,
         action: Literal["unknown", "park", "retry", "skip", "stop"],
     ) -> None:
         assert action in ["unknown", "park", "retry", "skip", "stop"]
         self.queue.put((event_id, action))
 
+    def stop(self) -> None:
+        self._is_stopped = True
+
+
+class AsyncioPersistentSubscriptionsService(BasePersistentSubscriptionsService):
+    pass
+
 
-class SubscriptionReadResponse(BaseSubscriptionReadResponse):
+class PersistentSubscription(Iterator[RecordedEvent], BasePersistentSubscription):
     def __init__(
         self,
-        resp: Iterable[persistent_pb2.ReadResp],
+        reqs: SubscriptionReadReqs,
+        resps: _MultiThreadedRendezvous,
         group_name: str,
         stream_name: Optional[str],
     ):
-        self.resp = iter(resp)
-
+        self.reqs = reqs
+        self.resps = resps
         read_resp = self._get_next_read_resp()
         content_oneof = read_resp.WhichOneof("content")
 
         if content_oneof == "subscription_confirmation":
             confirmed_stream_name, _, confirmed_group_name = (
                 read_resp.subscription_confirmation.subscription_id.partition("::")
             )
@@ -403,37 +489,53 @@
             ):  # pragma: no cover
                 raise SubscriptionConfirmationError()
         else:  # pragma: no cover
             raise ESDBClientException(
                 f"Expected subscription confirmation, got: {read_resp}"
             )
 
-    def __iter__(self) -> "SubscriptionReadResponse":
+    def __iter__(self) -> Iterator[RecordedEvent]:
         return self
 
     def __next__(self) -> RecordedEvent:
         while True:
-            response = self._get_next_read_resp()
-            content_oneof = response.WhichOneof("content")
+            try:
+                read_resp = self._get_next_read_resp()
+            except CancelledByClient as e:
+                raise StopIteration() from e
+            content_oneof = read_resp.WhichOneof("content")
             if content_oneof == "event":
-                return self._construct_recorded_event(response)
+                return self._construct_recorded_event(read_resp)
             else:  # pragma: no cover
                 pass
 
     def _get_next_read_resp(self) -> persistent_pb2.ReadResp:
         try:
-            response = next(self.resp)
+            read_resp = next(self.resps)
         except RpcError as e:
             raise handle_rpc_error(e) from e
-        assert isinstance(response, persistent_pb2.ReadResp)
-        return response
+        assert isinstance(read_resp, persistent_pb2.ReadResp)
+        return read_resp
 
+    def stop(self) -> None:
+        self.reqs.stop()
+        self.resps.cancel()
 
-class AsyncioPersistentSubscriptionsService(BasePersistentSubscriptionsService):
-    pass
+    def ack(self, event_id: UUID) -> None:
+        self.reqs.ack(event_id)
+
+    def nack(
+        self,
+        event_id: UUID,
+        action: Literal["unknown", "park", "retry", "skip", "stop"],
+    ) -> None:
+        self.reqs.nack(event_id, action=action)
+
+    def __del__(self) -> None:
+        self.stop()
 
 
 class PersistentSubscriptionsService(BasePersistentSubscriptionsService):
     """
     Encapsulates the 'persistent.PersistentSubscriptions' gRPC service.
     """
 
@@ -511,33 +613,35 @@
             raise handle_rpc_error(e) from e
         assert isinstance(response, persistent_pb2.CreateResp)
 
     def read(
         self,
         group_name: str,
         stream_name: Optional[str] = None,
+        buffer_size: int = 100,
         timeout: Optional[float] = None,
         metadata: Optional[Metadata] = None,
         credentials: Optional[CallCredentials] = None,
-    ) -> Tuple[SubscriptionReadRequests, SubscriptionReadResponse]:
-        read_req = SubscriptionReadRequests(
+    ) -> PersistentSubscription:
+        read_reqs = SubscriptionReadReqs(
             group_name=group_name,
             stream_name=stream_name,
+            buffer_size=buffer_size,
         )
-        read_resp = self._stub.Read(
-            read_req,
+        read_resps: _MultiThreadedRendezvous = self._stub.Read(
+            read_reqs,
             timeout=timeout,
             metadata=self._metadata(metadata, requires_leader=True),
             credentials=credentials,
         )
-        return (
-            read_req,
-            SubscriptionReadResponse(
-                read_resp, group_name=group_name, stream_name=stream_name
-            ),
+        return PersistentSubscription(
+            reqs=read_reqs,
+            resps=read_resps,
+            group_name=group_name,
+            stream_name=stream_name,
         )
 
     def get_info(
         self,
         group_name: str,
         stream_name: Optional[str] = None,
         timeout: Optional[float] = None,
@@ -589,14 +693,75 @@
                 raise NodeIsNotLeader() from e
             else:
                 raise handle_rpc_error(e) from e
 
         assert isinstance(resp, persistent_pb2.ListResp)
         return self._construct_subscription_infos(resp)
 
+    @overload
+    def update(
+        self,
+        group_name: str,
+        *,
+        from_end: bool = False,
+        commit_position: Optional[int] = None,
+        timeout: Optional[float] = None,
+        metadata: Optional[Metadata] = None,
+        credentials: Optional[CallCredentials] = None,
+    ) -> None:
+        """
+        Signature for updating a persistent "all streams" subscription.
+        """
+
+    @overload
+    def update(
+        self,
+        group_name: str,
+        *,
+        stream_name: Optional[str] = None,
+        from_end: bool = False,
+        stream_position: Optional[int] = None,
+        timeout: Optional[float] = None,
+        metadata: Optional[Metadata] = None,
+        credentials: Optional[CallCredentials] = None,
+    ) -> None:
+        """
+        Signature for updating a persistent stream subscription.
+        """
+
+    def update(
+        self,
+        group_name: str,
+        stream_name: Optional[str] = None,
+        from_end: bool = False,
+        commit_position: Optional[int] = None,
+        stream_position: Optional[int] = None,
+        timeout: Optional[float] = None,
+        metadata: Optional[Metadata] = None,
+        credentials: Optional[CallCredentials] = None,
+    ) -> None:
+        request = self._construct_update_req(
+            group_name=group_name,
+            stream_name=stream_name,
+            from_end=from_end,
+            commit_position=commit_position,
+            stream_position=stream_position,
+        )
+        # Call 'Update' RPC.
+        try:
+            response = self._stub.Update(
+                request,
+                timeout=timeout,
+                metadata=self._metadata(metadata, requires_leader=True),
+                credentials=credentials,
+            )
+        except RpcError as e:
+            raise handle_rpc_error(e) from e
+        assert isinstance(response, persistent_pb2.UpdateResp)
+
     def delete(
         self,
         group_name: str,
         stream_name: Optional[str] = None,
         timeout: Optional[float] = None,
         metadata: Optional[Metadata] = None,
         credentials: Optional[CallCredentials] = None,
```

### Comparing `esdbclient-1.0a4/esdbclient/protos/Grpc/cluster_pb2.py` & `esdbclient-1.0a5/esdbclient/protos/Grpc/cluster_pb2.py`

 * *Files identical despite different names*

### Comparing `esdbclient-1.0a4/esdbclient/protos/Grpc/cluster_pb2.pyi` & `esdbclient-1.0a5/esdbclient/protos/Grpc/cluster_pb2.pyi`

 * *Files identical despite different names*

### Comparing `esdbclient-1.0a4/esdbclient/protos/Grpc/cluster_pb2_grpc.py` & `esdbclient-1.0a5/esdbclient/protos/Grpc/cluster_pb2_grpc.py`

 * *Files identical despite different names*

### Comparing `esdbclient-1.0a4/esdbclient/protos/Grpc/code_pb2.py` & `esdbclient-1.0a5/esdbclient/protos/Grpc/code_pb2.py`

 * *Files identical despite different names*

### Comparing `esdbclient-1.0a4/esdbclient/protos/Grpc/code_pb2.pyi` & `esdbclient-1.0a5/esdbclient/protos/Grpc/code_pb2.pyi`

 * *Files identical despite different names*

### Comparing `esdbclient-1.0a4/esdbclient/protos/Grpc/gossip_pb2.py` & `esdbclient-1.0a5/esdbclient/protos/Grpc/gossip_pb2.py`

 * *Files identical despite different names*

### Comparing `esdbclient-1.0a4/esdbclient/protos/Grpc/gossip_pb2.pyi` & `esdbclient-1.0a5/esdbclient/protos/Grpc/gossip_pb2.pyi`

 * *Files identical despite different names*

### Comparing `esdbclient-1.0a4/esdbclient/protos/Grpc/gossip_pb2_grpc.py` & `esdbclient-1.0a5/esdbclient/protos/Grpc/gossip_pb2_grpc.py`

 * *Files identical despite different names*

### Comparing `esdbclient-1.0a4/esdbclient/protos/Grpc/persistent_pb2.py` & `esdbclient-1.0a5/esdbclient/protos/Grpc/persistent_pb2.py`

 * *Files identical despite different names*

### Comparing `esdbclient-1.0a4/esdbclient/protos/Grpc/persistent_pb2.pyi` & `esdbclient-1.0a5/esdbclient/protos/Grpc/persistent_pb2.pyi`

 * *Files identical despite different names*

### Comparing `esdbclient-1.0a4/esdbclient/protos/Grpc/persistent_pb2_grpc.py` & `esdbclient-1.0a5/esdbclient/protos/Grpc/persistent_pb2_grpc.py`

 * *Files identical despite different names*

### Comparing `esdbclient-1.0a4/esdbclient/protos/Grpc/shared_pb2.py` & `esdbclient-1.0a5/esdbclient/protos/Grpc/shared_pb2.py`

 * *Files identical despite different names*

### Comparing `esdbclient-1.0a4/esdbclient/protos/Grpc/shared_pb2.pyi` & `esdbclient-1.0a5/esdbclient/protos/Grpc/shared_pb2.pyi`

 * *Files identical despite different names*

### Comparing `esdbclient-1.0a4/esdbclient/protos/Grpc/status_pb2.py` & `esdbclient-1.0a5/esdbclient/protos/Grpc/status_pb2.py`

 * *Files identical despite different names*

### Comparing `esdbclient-1.0a4/esdbclient/protos/Grpc/status_pb2.pyi` & `esdbclient-1.0a5/esdbclient/protos/Grpc/status_pb2.pyi`

 * *Files identical despite different names*

### Comparing `esdbclient-1.0a4/esdbclient/protos/Grpc/streams_pb2.py` & `esdbclient-1.0a5/esdbclient/protos/Grpc/streams_pb2.py`

 * *Files identical despite different names*

### Comparing `esdbclient-1.0a4/esdbclient/protos/Grpc/streams_pb2.pyi` & `esdbclient-1.0a5/esdbclient/protos/Grpc/streams_pb2.pyi`

 * *Files identical despite different names*

### Comparing `esdbclient-1.0a4/esdbclient/protos/Grpc/streams_pb2_grpc.py` & `esdbclient-1.0a5/esdbclient/protos/Grpc/streams_pb2_grpc.py`

 * *Files identical despite different names*

### Comparing `esdbclient-1.0a4/esdbclient/streams.py` & `esdbclient-1.0a5/esdbclient/streams.py`

 * *Files 1% similar despite different names*

```diff
@@ -11,21 +11,23 @@
     overload,
 )
 from uuid import UUID, uuid4
 
 import grpc.aio
 from google.protobuf import duration_pb2, empty_pb2
 from grpc import CallCredentials, RpcError, StatusCode
+from grpc._channel import _MultiThreadedRendezvous
 from typing_extensions import Literal
 
 from esdbclient.esdbapibase import ESDBService, Metadata, handle_rpc_error
 from esdbclient.events import NewEvent, RecordedEvent
 from esdbclient.exceptions import (
     AccessDeniedError,
     BadRequestError,
+    CancelledByClient,
     ESDBClientException,
     InvalidTransactionError,
     MaximumAppendSizeExceededError,
     NotFound,
     StreamIsDeleted,
     SubscriptionConfirmationError,
     TimeoutError,
@@ -70,15 +72,15 @@
                 raise SubscriptionConfirmationError(
                     f"Expected subscription confirmation, got: {read_resp}"
                 )
 
     def __aiter__(self) -> "AsyncioReadResponse":
         return self
 
-    async def __anext__(self) -> "RecordedEvent":
+    async def __anext__(self) -> RecordedEvent:
         while True:
             read_resp = await self._get_next_read_resp()
             content_oneof = read_resp.WhichOneof("content")
             if content_oneof == "event":
                 event = read_resp.event.event
                 position_oneof = read_resp.event.WhichOneof("position")
                 if position_oneof == "commit_position":
@@ -113,22 +115,22 @@
                 # 		AllStreamPosition last_all_stream_position = 7;
                 # 	}
                 #
                 # Todo: Not sure how to request to get first_stream_position,
                 #   last_stream_position, first_all_stream_position.
 
 
-class ReadResponse(Iterable[RecordedEvent]):
+class ReadResponse(Iterator[RecordedEvent]):
     def __init__(
         self,
-        read_resp_iter: Iterable[streams_pb2.ReadResp],
+        read_resps: _MultiThreadedRendezvous,
         stream_name: Optional[str],
         is_subscription: bool,
     ):
-        self.read_resp_iter = iter(read_resp_iter)
+        self.read_resps = read_resps
         self.stream_name = stream_name
         self.subscription_id: Optional[UUID] = None
         if is_subscription:
             read_resp = self._get_next_read_resp()
             content_oneof = read_resp.WhichOneof("content")
             if content_oneof == "confirmation":
                 pass
@@ -139,15 +141,18 @@
                 )
 
     def __iter__(self) -> "ReadResponse":
         return self
 
     def __next__(self) -> RecordedEvent:
         while True:
-            read_resp = self._get_next_read_resp()
+            try:
+                read_resp = self._get_next_read_resp()
+            except CancelledByClient as e:
+                raise StopIteration() from e
             content_oneof = read_resp.WhichOneof("content")
             if content_oneof == "event":
                 event = read_resp.event.event
                 position_oneof = read_resp.event.WhichOneof("position")
                 if position_oneof == "commit_position":
                     commit_position = read_resp.event.commit_position
                 else:  # pragma: no cover
@@ -181,27 +186,33 @@
                 # 	}
                 #
                 # Todo: Not sure how to request to get first_stream_position,
                 #   last_stream_position, first_all_stream_position.
 
     def _get_next_read_resp(self) -> streams_pb2.ReadResp:
         try:
-            read_resp = next(self.read_resp_iter)
+            read_resp = next(self.read_resps)
         except RpcError as e:
             if e.code() == StatusCode.FAILED_PRECONDITION:
                 details = e.details() or ""
                 if self.stream_name and details and "is deleted" in details:
                     raise StreamIsDeleted() from e
                 else:  # pragma: no cover
                     raise handle_rpc_error(e) from e
             else:
                 raise handle_rpc_error(e) from e
         assert isinstance(read_resp, streams_pb2.ReadResp)
         return read_resp
 
+    def stop(self) -> None:
+        self.read_resps.cancel()
+
+    def __del__(self) -> None:
+        self.stop()
+
 
 DEFAULT_BATCH_APPEND_REQUEST_DEADLINE = 315576000000
 
 # @dataclass
 # class BatchAppendRequest:
 #     stream_name: str
 #     expected_position: Optional[int]
@@ -762,30 +773,30 @@
         stream_name: Optional[str] = None,
         stream_position: Optional[int] = None,
         backwards: bool = False,
         limit: int = sys.maxsize,
         timeout: Optional[float] = None,
         metadata: Optional[Metadata] = None,
         credentials: Optional[CallCredentials] = None,
-    ) -> Iterable[RecordedEvent]:
+    ) -> ReadResponse:
         """
         Signature for reading events from a stream.
         """
 
     @overload
     def read(
         self,
         *,
         stream_name: Optional[str] = None,
         stream_position: Optional[int] = None,
         subscribe: Literal[True],
         timeout: Optional[float] = None,
         metadata: Optional[Metadata] = None,
         credentials: Optional[CallCredentials] = None,
-    ) -> Iterable[RecordedEvent]:
+    ) -> ReadResponse:
         """
         Signature for reading events from a stream with a catch-up subscription.
         """
 
     @overload
     def read(
         self,
@@ -795,15 +806,15 @@
         filter_exclude: Sequence[str] = (),
         filter_include: Sequence[str] = (),
         filter_by_stream_name: bool = False,
         limit: int = sys.maxsize,
         timeout: Optional[float] = None,
         metadata: Optional[Metadata] = None,
         credentials: Optional[CallCredentials] = None,
-    ) -> Iterable[RecordedEvent]:
+    ) -> ReadResponse:
         """
         Signature for reading all events.
         """
 
     @overload
     def read(
         self,
@@ -812,15 +823,15 @@
         filter_exclude: Sequence[str] = (),
         filter_include: Sequence[str] = (),
         filter_by_stream_name: bool = False,
         subscribe: Literal[True],
         timeout: Optional[float] = None,
         metadata: Optional[Metadata] = None,
         credentials: Optional[CallCredentials] = None,
-    ) -> Iterable[RecordedEvent]:
+    ) -> ReadResponse:
         """
         Signature for reading all events with a catch-up subscription.
         """
 
     def read(
         self,
         *,
@@ -832,15 +843,15 @@
         filter_include: Sequence[str] = (),
         filter_by_stream_name: bool = False,
         limit: int = sys.maxsize,
         subscribe: bool = False,
         timeout: Optional[float] = None,
         metadata: Optional[Metadata] = None,
         credentials: Optional[CallCredentials] = None,
-    ) -> Iterable[RecordedEvent]:
+    ) -> ReadResponse:
         """
         Constructs and sends a gRPC 'ReadReq' to the 'Read' rpc.
 
         Returns a generator which yields RecordedEvent objects.
         """
 
         # Construct read request.
```

### Comparing `esdbclient-1.0a4/pyproject.toml` & `esdbclient-1.0a5/pyproject.toml`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 [tool.poetry]
 name = "esdbclient"
-version = "1.0a4"
+version = "1.0a5"
 description = "Python gRPC Client for EventStoreDB"
 authors = [
     "John Bywater <john.bywater@appropriatesoftware.net>",
 ]
 license = "BSD 3-Clause"
 classifiers = [
     "Development Status :: 3 - Alpha",
@@ -37,16 +37,16 @@
 flake8-broken-line = "*"
 flake8-bugbear = "*"
 flake8-coding = "*"
 flake8-isort = "*"
 flake8-tidy-imports = "*"
 isort = "*"
 mypy = "*"
-pre-commit = "*"
-pre-commit-hooks = "*"
+#pre-commit = "*"
+#pre-commit-hooks = "*"
 pytest = "*"
 pytest-cov = "*"
 grpcio-tools = "*"
 grpc-stubs = "*"
 types-protobuf = "*"
 mypy-protobuf = "*"
 async-case = {version = "^10.1.0", python = "<=3.8"}
```

### Comparing `esdbclient-1.0a4/setup.py` & `esdbclient-1.0a5/setup.py`

 * *Files 10% similar despite different names*

```diff
@@ -14,15 +14,15 @@
 000000d0: 2e35 322e 2a27 2c0a 2027 7072 6f74 6f62  .52.*',. 'protob
 000000e0: 7566 3e3d 332e 3131 2e30 272c 0a20 2774  uf>=3.11.0',. 't
 000000f0: 7970 696e 675f 6578 7465 6e73 696f 6e73  yping_extensions
 00000100: 275d 0a0a 7365 7475 705f 6b77 6172 6773  ']..setup_kwargs
 00000110: 203d 207b 0a20 2020 2027 6e61 6d65 273a   = {.    'name':
 00000120: 2027 6573 6462 636c 6965 6e74 272c 0a20   'esdbclient',. 
 00000130: 2020 2027 7665 7273 696f 6e27 3a20 2731     'version': '1
-00000140: 2e30 6134 272c 0a20 2020 2027 6465 7363  .0a4',.    'desc
+00000140: 2e30 6135 272c 0a20 2020 2027 6465 7363  .0a5',.    'desc
 00000150: 7269 7074 696f 6e27 3a20 2750 7974 686f  ription': 'Pytho
 00000160: 6e20 6752 5043 2043 6c69 656e 7420 666f  n gRPC Client fo
 00000170: 7220 4576 656e 7453 746f 7265 4442 272c  r EventStoreDB',
 00000180: 0a20 2020 2027 6c6f 6e67 5f64 6573 6372  .    'long_descr
 00000190: 6970 7469 6f6e 273a 2027 2320 5079 7468  iption': '# Pyth
 000001a0: 6f6e 2067 5250 4320 436c 6965 6e74 2066  on gRPC Client f
 000001b0: 6f72 2045 7665 6e74 5374 6f72 6544 425c  or EventStoreDB\
@@ -96,6023 +96,6859 @@
 000005f0: 6e50 726f 6261 626c 7920 7468 6520 7468  nProbably the th
 00000600: 7265 6520 6d6f 7374 2075 7365 6675 6c20  ree most useful 
 00000610: 6d65 7468 6f64 7320 6f66 2060 4553 4442  methods of `ESDB
 00000620: 436c 6965 6e74 6020 6172 653a 5c6e 5c6e  Client` are:\n\n
 00000630: 2a20 6061 7070 656e 645f 6576 656e 7473  * `append_events
 00000640: 2829 6020 5468 6973 206d 6574 686f 6420  ()` This method 
 00000650: 6361 6e20 6265 2075 7365 6420 746f 2072  can be used to r
-00000660: 6563 6f72 645c 6e65 7665 6e74 7320 696e  ecord\nevents in
-00000670: 2061 2070 6172 7469 6375 6c61 7220 2273   a particular "s
+00000660: 6563 6f72 6420 6576 656e 7473 2069 6e20  ecord events in 
+00000670: 6120 7061 7274 6963 756c 6172 5c6e 2273  a particular\n"s
 00000680: 7472 6561 6d22 2e20 5468 6973 2069 7320  tream". This is 
-00000690: 7573 6566 756c 2077 6865 6e20 6578 6563  useful when exec
-000006a0: 7574 696e 6720 6120 636f 6d6d 616e 645c  uting a command\
-000006b0: 6e69 6e20 616e 2061 7070 6c69 6361 7469  nin an applicati
-000006c0: 6f6e 2e20 4569 7468 6572 2061 6c6c 206f  on. Either all o
-000006d0: 7220 6e6f 6e65 206f 6620 7468 6520 6576  r none of the ev
-000006e0: 656e 7473 2077 696c 6c20 6265 2072 6563  ents will be rec
-000006f0: 6f72 6465 642e 5c6e 5c6e 2a20 6072 6561  orded.\n\n* `rea
-00000700: 645f 7374 7265 616d 5f65 7665 6e74 7328  d_stream_events(
-00000710: 2960 2054 6869 7320 6d65 7468 6f64 2063  )` This method c
-00000720: 616e 2062 6520 7573 6564 2074 6f20 7265  an be used to re
-00000730: 7472 6965 7665 2061 6c6c 2074 6865 2072  trieve all the r
-00000740: 6563 6f72 6465 645c 6e65 7665 6e74 7320  ecorded\nevents 
-00000750: 696e 2061 2022 7374 7265 616d 222e 2054  in a "stream". T
-00000760: 6869 7320 6973 2075 7365 6675 6c20 666f  his is useful fo
-00000770: 7220 7265 636f 6e73 7472 7563 7469 6e67  r reconstructing
-00000780: 2061 6e20 6167 6772 6567 6174 6520 6265   an aggregate be
-00000790: 666f 7265 5c6e 6578 6563 7574 696e 6720  fore\nexecuting 
-000007a0: 6120 636f 6d6d 616e 6420 696e 2061 6e20  a command in an 
-000007b0: 6170 706c 6963 6174 696f 6e2e 5c6e 5c6e  application.\n\n
-000007c0: 2a20 6073 7562 7363 7269 6265 5f61 6c6c  * `subscribe_all
-000007d0: 5f65 7665 6e74 7328 2960 2054 6869 7320  _events()` This 
-000007e0: 6d65 7468 6f64 2063 616e 2062 6520 7573  method can be us
-000007f0: 6564 2074 6f20 7265 6365 6976 6520 616c  ed to receive al
-00000800: 6c20 7265 636f 7264 6564 5c6e 6576 656e  l recorded\neven
-00000810: 7473 2061 6372 6f73 7320 616c 6c20 2273  ts across all "s
-00000820: 7472 6561 6d73 222e 2054 6869 7320 6973  treams". This is
-00000830: 2075 7365 6675 6c20 696e 2065 7665 6e74   useful in event
-00000840: 2d70 726f 6365 7373 696e 6720 636f 6d70  -processing comp
-00000850: 6f6e 656e 7473 2c5c 6e61 6e64 2073 7570  onents,\nand sup
-00000860: 706f 7274 7320 7072 6f63 6573 7369 6e67  ports processing
-00000870: 2065 7665 6e74 7320 7769 7468 2022 6578   events with "ex
-00000880: 6163 746c 792d 6f6e 6365 2220 7365 6d61  actly-once" sema
-00000890: 6e74 6963 732e 5c6e 5c6e 5468 6520 6578  ntics.\n\nThe ex
-000008a0: 616d 706c 6520 6265 6c6f 7720 7573 6573  ample below uses
-000008b0: 2061 6e20 2269 6e73 6563 7572 6522 2045   an "insecure" E
-000008c0: 7665 6e74 5374 6f72 6544 4220 7365 7276  ventStoreDB serv
-000008d0: 6572 2072 756e 6e69 6e67 206c 6f63 616c  er running local
-000008e0: 6c79 206f 6e20 706f 7274 2032 3131 342e  ly on port 2114.
-000008f0: 5c6e 5c6e 6060 6070 7974 686f 6e5c 6e69  \n\n```python\ni
-00000900: 6d70 6f72 7420 6573 6462 636c 6965 6e74  mport esdbclient
-00000910: 2c20 7575 6964 5c6e 5c6e 5c6e 2320 436f  , uuid\n\n\n# Co
-00000920: 6e73 7472 7563 7420 4553 4442 436c 6965  nstruct ESDBClie
-00000930: 6e74 2077 6974 6820 616e 2045 7665 6e74  nt with an Event
-00000940: 5374 6f72 6544 4220 5552 492e 5c6e 5c6e  StoreDB URI.\n\n
-00000950: 636c 6965 6e74 203d 2065 7364 6263 6c69  client = esdbcli
-00000960: 656e 742e 4553 4442 436c 6965 6e74 2875  ent.ESDBClient(u
-00000970: 7269 3d22 6573 6462 3a2f 2f6c 6f63 616c  ri="esdb://local
-00000980: 686f 7374 3a32 3131 343f 546c 733d 6661  host:2114?Tls=fa
-00000990: 6c73 6522 295c 6e5c 6e5c 6e23 2041 7070  lse")\n\n\n# App
-000009a0: 656e 6420 6576 656e 7473 2074 6f20 6120  end events to a 
-000009b0: 6e65 7720 7374 7265 616d 2e5c 6e5c 6e73  new stream.\n\ns
-000009c0: 7472 6561 6d5f 6e61 6d65 203d 2073 7472  tream_name = str
-000009d0: 2875 7569 642e 7575 6964 3428 2929 5c6e  (uuid.uuid4())\n
-000009e0: 5c6e 6576 656e 7431 203d 2065 7364 6263  \nevent1 = esdbc
-000009f0: 6c69 656e 742e 4e65 7745 7665 6e74 2874  lient.NewEvent(t
-00000a00: 7970 653d 5c27 4f72 6465 7243 7265 6174  ype=\'OrderCreat
-00000a10: 6564 5c27 2c20 6461 7461 3d62 5c27 6461  ed\', data=b\'da
-00000a20: 7461 315c 2729 5c6e 5c6e 636c 6965 6e74  ta1\')\n\nclient
-00000a30: 2e61 7070 656e 645f 6576 656e 7473 285c  .append_events(\
-00000a40: 6e20 2020 2073 7472 6561 6d5f 6e61 6d65  n    stream_name
-00000a50: 3d73 7472 6561 6d5f 6e61 6d65 2c5c 6e20  =stream_name,\n 
-00000a60: 2020 2065 7870 6563 7465 645f 706f 7369     expected_posi
-00000a70: 7469 6f6e 3d4e 6f6e 652c 5c6e 2020 2020  tion=None,\n    
-00000a80: 6576 656e 7473 3d5b 6576 656e 7431 5d2c  events=[event1],
-00000a90: 5c6e 295c 6e5c 6e5c 6e23 2041 7070 656e  \n)\n\n\n# Appen
-00000aa0: 6420 6d6f 7265 2065 7665 6e74 7320 746f  d more events to
-00000ab0: 2061 6e20 6578 6973 7469 6e67 2073 7472   an existing str
-00000ac0: 6561 6d2e 5c6e 5c6e 6576 656e 7432 203d  eam.\n\nevent2 =
-00000ad0: 2065 7364 6263 6c69 656e 742e 4e65 7745   esdbclient.NewE
-00000ae0: 7665 6e74 2874 7970 653d 5c27 4f72 6465  vent(type=\'Orde
-00000af0: 7255 7064 6174 6564 5c27 2c20 6461 7461  rUpdated\', data
-00000b00: 3d62 5c27 6461 7461 325c 2729 5c6e 6576  =b\'data2\')\nev
-00000b10: 656e 7433 203d 2065 7364 6263 6c69 656e  ent3 = esdbclien
-00000b20: 742e 4e65 7745 7665 6e74 2874 7970 653d  t.NewEvent(type=
-00000b30: 5c27 4f72 6465 7244 656c 6574 6564 5c27  \'OrderDeleted\'
-00000b40: 2c20 6461 7461 3d62 5c27 6461 7461 335c  , data=b\'data3\
-00000b50: 2729 5c6e 5c6e 636c 6965 6e74 2e61 7070  ')\n\nclient.app
-00000b60: 656e 645f 6576 656e 7473 285c 6e20 2020  end_events(\n   
-00000b70: 2073 7472 6561 6d5f 6e61 6d65 3d73 7472   stream_name=str
-00000b80: 6561 6d5f 6e61 6d65 2c5c 6e20 2020 2065  eam_name,\n    e
-00000b90: 7870 6563 7465 645f 706f 7369 7469 6f6e  xpected_position
-00000ba0: 3d30 2c5c 6e20 2020 2065 7665 6e74 733d  =0,\n    events=
-00000bb0: 5b65 7665 6e74 322c 2065 7665 6e74 335d  [event2, event3]
-00000bc0: 2c5c 6e29 5c6e 5c6e 5c6e 2320 5265 6164  ,\n)\n\n\n# Read
-00000bd0: 2061 6c6c 2065 7665 6e74 7320 7265 636f   all events reco
-00000be0: 7264 6564 2069 6e20 6120 7374 7265 616d  rded in a stream
-00000bf0: 2e5c 6e5c 6e72 6563 6f72 6465 6420 3d20  .\n\nrecorded = 
-00000c00: 636c 6965 6e74 2e72 6561 645f 7374 7265  client.read_stre
-00000c10: 616d 5f65 7665 6e74 7328 5c6e 2020 2020  am_events(\n    
-00000c20: 7374 7265 616d 5f6e 616d 653d 7374 7265  stream_name=stre
-00000c30: 616d 5f6e 616d 655c 6e29 5c6e 5c6e 6173  am_name\n)\n\nas
-00000c40: 7365 7274 206c 656e 2872 6563 6f72 6465  sert len(recorde
-00000c50: 6429 203d 3d20 335c 6e61 7373 6572 7420  d) == 3\nassert 
-00000c60: 7265 636f 7264 6564 5b30 5d2e 6461 7461  recorded[0].data
-00000c70: 203d 3d20 6576 656e 7431 2e64 6174 615c   == event1.data\
-00000c80: 6e61 7373 6572 7420 7265 636f 7264 6564  nassert recorded
-00000c90: 5b31 5d2e 6461 7461 203d 3d20 6576 656e  [1].data == even
-00000ca0: 7432 2e64 6174 615c 6e61 7373 6572 7420  t2.data\nassert 
-00000cb0: 7265 636f 7264 6564 5b32 5d2e 6461 7461  recorded[2].data
-00000cc0: 203d 3d20 6576 656e 7433 2e64 6174 615c   == event3.data\
-00000cd0: 6e61 7373 6572 7420 7265 636f 7264 6564  nassert recorded
-00000ce0: 5b30 5d2e 7479 7065 203d 3d20 6576 656e  [0].type == even
-00000cf0: 7431 2e74 7970 655c 6e61 7373 6572 7420  t1.type\nassert 
-00000d00: 7265 636f 7264 6564 5b31 5d2e 7479 7065  recorded[1].type
-00000d10: 203d 3d20 6576 656e 7432 2e74 7970 655c   == event2.type\
-00000d20: 6e61 7373 6572 7420 7265 636f 7264 6564  nassert recorded
-00000d30: 5b32 5d2e 7479 7065 203d 3d20 6576 656e  [2].type == even
-00000d40: 7433 2e74 7970 655c 6e5c 6e5c 6e23 2049  t3.type\n\n\n# I
-00000d50: 6e20 616e 2065 7665 6e74 2d70 726f 6365  n an event-proce
-00000d60: 7373 696e 6720 636f 6d70 6f6e 656e 742c  ssing component,
-00000d70: 2075 7365 2061 2022 6361 7463 682d 7570   use a "catch-up
-00000d80: 2220 7375 6273 6372 6970 7469 6f6e 5c6e  " subscription\n
-00000d90: 2320 746f 2072 6563 6569 7665 2061 6c6c  # to receive all
-00000da0: 2065 7665 6e74 7320 6163 726f 7373 2061   events across a
-00000db0: 6c6c 2073 7472 6561 6d73 2c20 696e 636c  ll streams, incl
-00000dc0: 7564 696e 6720 6576 656e 7473 2074 6861  uding events tha
-00000dd0: 745c 6e23 2068 6176 6520 6e6f 7420 7965  t\n# have not ye
-00000de0: 7420 6265 656e 2072 6563 6f72 6465 642c  t been recorded,
-00000df0: 2073 7461 7274 696e 6720 6672 6f6d 2074   starting from t
-00000e00: 6865 2063 6f6d 706f 6e65 6e74 5c27 7320  he component\'s 
-00000e10: 6c61 7374 5c6e 2320 7361 7665 6420 2263  last\n# saved "c
-00000e20: 6f6d 6d69 7420 706f 7369 7469 6f6e 222e  ommit position".
-00000e30: 5c6e 5c6e 6c61 7374 5f73 6176 6564 5f63  \n\nlast_saved_c
-00000e40: 6f6d 6d69 745f 706f 7369 7469 6f6e 203d  ommit_position =
-00000e50: 2030 5c6e 5c6e 7375 6273 6372 6970 7469   0\n\nsubscripti
-00000e60: 6f6e 203d 2063 6c69 656e 742e 7375 6273  on = client.subs
-00000e70: 6372 6962 655f 616c 6c5f 6576 656e 7473  cribe_all_events
-00000e80: 285c 6e20 2020 2063 6f6d 6d69 745f 706f  (\n    commit_po
-00000e90: 7369 7469 6f6e 3d6c 6173 745f 7361 7665  sition=last_save
-00000ea0: 645f 636f 6d6d 6974 5f70 6f73 6974 696f  d_commit_positio
-00000eb0: 6e5c 6e29 5c6e 5c6e 2320 546f 2069 6d70  n\n)\n\n# To imp
-00000ec0: 6c65 6d65 6e74 2022 6578 6163 746c 792d  lement "exactly-
-00000ed0: 6f6e 6365 2220 7365 6d61 6e74 6963 732c  once" semantics,
-00000ee0: 2069 7465 7261 7465 206f 7665 7220 7468   iterate over th
-00000ef0: 655c 6e23 2022 6361 7463 682d 7570 2220  e\n# "catch-up" 
-00000f00: 7375 6273 6372 6970 7469 6f6e 2e20 5072  subscription. Pr
-00000f10: 6f63 6573 7320 6561 6368 2072 6563 6569  ocess each recei
-00000f20: 7665 6420 6576 656e 742c 5c6e 2320 696e  ved event,\n# in
-00000f30: 2074 7572 6e2c 2074 6872 6f75 6768 2061   turn, through a
-00000f40: 6e20 6576 656e 742d 7072 6f63 6573 7369  n event-processi
-00000f50: 6e67 2070 6f6c 6963 792e 2053 6176 6520  ng policy. Save 
-00000f60: 7468 655c 6e23 2076 616c 7565 206f 6620  the\n# value of 
-00000f70: 7468 6520 636f 6d6d 6974 5f70 6f73 6974  the commit_posit
-00000f80: 696f 6e20 6174 7472 6962 7574 6520 6f66  ion attribute of
-00000f90: 2074 6865 2070 726f 6365 7373 6564 5c6e   the processed\n
-00000fa0: 2320 6576 656e 7420 7769 7468 206e 6577  # event with new
-00000fb0: 2073 7461 7465 2067 656e 6572 6174 6564   state generated
-00000fc0: 2062 7920 7468 6520 706f 6c69 6379 2069   by the policy i
-00000fd0: 6e20 7468 6520 7361 6d65 5c6e 2320 6174  n the same\n# at
-00000fe0: 6f6d 6963 2074 7261 6e73 6163 7469 6f6e  omic transaction
-00000ff0: 2e20 5573 6520 7468 6520 6c61 7374 2073  . Use the last s
-00001000: 6176 6564 2022 636f 6d6d 6974 2070 6f73  aved "commit pos
-00001010: 6974 696f 6e22 5c6e 2320 7768 656e 2072  ition"\n# when r
-00001020: 6573 7461 7274 696e 6720 7468 6520 2263  estarting the "c
-00001030: 6174 6368 2d75 7022 2073 7562 7363 7269  atch-up" subscri
-00001040: 7074 696f 6e2e 5c6e 5c6e 7265 6365 6976  ption.\n\nreceiv
-00001050: 6564 203d 205b 5d5c 6e66 6f72 2065 7665  ed = []\nfor eve
-00001060: 6e74 2069 6e20 7375 6273 6372 6970 7469  nt in subscripti
-00001070: 6f6e 3a5c 6e20 2020 2072 6563 6569 7665  on:\n    receive
-00001080: 642e 6170 7065 6e64 2865 7665 6e74 295c  d.append(event)\
-00001090: 6e20 2020 2069 6620 6576 656e 742e 6964  n    if event.id
-000010a0: 203d 3d20 6576 656e 7433 2e69 643a 5c6e   == event3.id:\n
-000010b0: 2020 2020 2020 2020 6272 6561 6b5c 6e5c          break\n\
-000010c0: 6e61 7373 6572 7420 7265 6365 6976 6564  nassert received
-000010d0: 5b2d 335d 2e64 6174 6120 3d3d 2065 7665  [-3].data == eve
-000010e0: 6e74 312e 6461 7461 5c6e 6173 7365 7274  nt1.data\nassert
-000010f0: 2072 6563 6569 7665 645b 2d32 5d2e 6461   received[-2].da
-00001100: 7461 203d 3d20 6576 656e 7432 2e64 6174  ta == event2.dat
-00001110: 615c 6e61 7373 6572 7420 7265 6365 6976  a\nassert receiv
-00001120: 6564 5b2d 315d 2e64 6174 6120 3d3d 2065  ed[-1].data == e
-00001130: 7665 6e74 332e 6461 7461 5c6e 6173 7365  vent3.data\nasse
-00001140: 7274 2072 6563 6569 7665 645b 2d33 5d2e  rt received[-3].
-00001150: 7479 7065 203d 3d20 6576 656e 7431 2e74  type == event1.t
-00001160: 7970 655c 6e61 7373 6572 7420 7265 6365  ype\nassert rece
-00001170: 6976 6564 5b2d 325d 2e74 7970 6520 3d3d  ived[-2].type ==
-00001180: 2065 7665 6e74 322e 7479 7065 5c6e 6173   event2.type\nas
-00001190: 7365 7274 2072 6563 6569 7665 645b 2d31  sert received[-1
-000011a0: 5d2e 7479 7065 203d 3d20 6576 656e 7433  ].type == event3
-000011b0: 2e74 7970 655c 6e5c 6e61 7373 6572 7420  .type\n\nassert 
-000011c0: 7265 6365 6976 6564 5b2d 335d 2e63 6f6d  received[-3].com
-000011d0: 6d69 745f 706f 7369 7469 6f6e 203e 2030  mit_position > 0
-000011e0: 5c6e 6173 7365 7274 2072 6563 6569 7665  \nassert receive
-000011f0: 645b 2d32 5d2e 636f 6d6d 6974 5f70 6f73  d[-2].commit_pos
-00001200: 6974 696f 6e20 3e20 7265 6365 6976 6564  ition > received
-00001210: 5b2d 335d 2e63 6f6d 6d69 745f 706f 7369  [-3].commit_posi
-00001220: 7469 6f6e 5c6e 6173 7365 7274 2072 6563  tion\nassert rec
-00001230: 6569 7665 645b 2d31 5d2e 636f 6d6d 6974  eived[-1].commit
-00001240: 5f70 6f73 6974 696f 6e20 3e20 7265 6365  _position > rece
-00001250: 6976 6564 5b2d 325d 2e63 6f6d 6d69 745f  ived[-2].commit_
-00001260: 706f 7369 7469 6f6e 5c6e 5c6e 5c6e 2320  position\n\n\n# 
-00001270: 436c 6f73 6520 7468 6520 636c 6965 6e74  Close the client
-00001280: 2061 6674 6572 2075 7365 2e5c 6e5c 6e63   after use.\n\nc
-00001290: 6c69 656e 742e 636c 6f73 6528 295c 6e60  lient.close()\n`
-000012a0: 6060 5c6e 5c6e 5365 6520 6265 6c6f 7720  ``\n\nSee below 
-000012b0: 666f 7220 6d6f 7265 2064 6574 6169 6c73  for more details
-000012c0: 2e5c 6e5c 6e46 6f72 2061 6e20 6578 616d  .\n\nFor an exam
-000012d0: 706c 6520 6f66 2075 7361 6765 2c20 7365  ple of usage, se
-000012e0: 6520 7468 6520 5b65 7665 6e74 736f 7572  e the [eventsour
-000012f0: 6369 6e67 2d65 7665 6e74 7374 6f72 6564  cing-eventstored
-00001300: 625d 285c 6e68 7474 7073 3a2f 2f67 6974  b](\nhttps://git
-00001310: 6875 622e 636f 6d2f 7079 6576 656e 7473  hub.com/pyevents
-00001320: 6f75 7263 696e 672f 6576 656e 7473 6f75  ourcing/eventsou
-00001330: 7263 696e 672d 6576 656e 7473 746f 7265  rcing-eventstore
-00001340: 6462 2920 7061 636b 6167 652e 5c6e 5c6e  db) package.\n\n
-00001350: 2323 2054 6162 6c65 206f 6620 636f 6e74  ## Table of cont
-00001360: 656e 7473 5c6e 5c6e 3c21 2d2d 2054 4f43  ents\n\n<!-- TOC
-00001370: 202d 2d3e 5c6e 2a20 5b49 6e73 7461 6c6c   -->\n* [Install
-00001380: 2070 6163 6b61 6765 5d28 2369 6e73 7461   package](#insta
-00001390: 6c6c 2d70 6163 6b61 6765 295c 6e20 202a  ll-package)\n  *
-000013a0: 205b 4672 6f6d 2050 7950 495d 2823 6672   [From PyPI](#fr
-000013b0: 6f6d 2d70 7970 6929 5c6e 2020 2a20 5b57  om-pypi)\n  * [W
-000013c0: 6974 6820 506f 6574 7279 5d28 2377 6974  ith Poetry](#wit
-000013d0: 682d 706f 6574 7279 295c 6e2a 205b 4576  h-poetry)\n* [Ev
-000013e0: 656e 7453 746f 7265 4442 2073 6572 7665  entStoreDB serve
-000013f0: 725d 2823 6576 656e 7473 746f 7265 6462  r](#eventstoredb
-00001400: 2d73 6572 7665 7229 5c6e 2020 2a20 5b52  -server)\n  * [R
-00001410: 756e 2063 6f6e 7461 696e 6572 5d28 2372  un container](#r
-00001420: 756e 2d63 6f6e 7461 696e 6572 295c 6e20  un-container)\n 
-00001430: 202a 205b 5374 6f70 2063 6f6e 7461 696e   * [Stop contain
-00001440: 6572 5d28 2373 746f 702d 636f 6e74 6169  er](#stop-contai
-00001450: 6e65 7229 5c6e 2a20 5b45 7665 6e74 5374  ner)\n* [EventSt
-00001460: 6f72 6544 4220 636c 6965 6e74 5d28 2365  oreDB client](#e
-00001470: 7665 6e74 7374 6f72 6564 622d 636c 6965  ventstoredb-clie
-00001480: 6e74 295c 6e20 202a 205b 496d 706f 7274  nt)\n  * [Import
-00001490: 2063 6c61 7373 5d28 2369 6d70 6f72 742d   class](#import-
-000014a0: 636c 6173 7329 5c6e 2020 2a20 5b43 6f6e  class)\n  * [Con
-000014b0: 7374 7275 6374 2063 6c69 656e 745d 2823  struct client](#
-000014c0: 636f 6e73 7472 7563 742d 636c 6965 6e74  construct-client
-000014d0: 295c 6e2a 205b 5374 7265 616d 735d 2823  )\n* [Streams](#
-000014e0: 7374 7265 616d 7329 5c6e 2020 2a20 5b41  streams)\n  * [A
-000014f0: 7070 656e 6420 6576 656e 7473 5d28 2361  ppend events](#a
-00001500: 7070 656e 642d 6576 656e 7473 295c 6e20  ppend-events)\n 
-00001510: 202a 205b 4170 7065 6e64 2065 7665 6e74   * [Append event
-00001520: 5d28 2361 7070 656e 642d 6576 656e 7429  ](#append-event)
-00001530: 5c6e 2020 2a20 5b49 6465 6d70 6f74 656e  \n  * [Idempoten
-00001540: 7420 6170 7065 6e64 206f 7065 7261 7469  t append operati
-00001550: 6f6e 735d 2823 6964 656d 706f 7465 6e74  ons](#idempotent
-00001560: 2d61 7070 656e 642d 6f70 6572 6174 696f  -append-operatio
-00001570: 6e73 295c 6e20 202a 205b 5265 6164 2073  ns)\n  * [Read s
-00001580: 7472 6561 6d20 6576 656e 7473 5d28 2372  tream events](#r
-00001590: 6561 642d 7374 7265 616d 2d65 7665 6e74  ead-stream-event
-000015a0: 7329 5c6e 2020 2a20 5b52 6561 6420 616c  s)\n  * [Read al
-000015b0: 6c20 6576 656e 7473 5d28 2372 6561 642d  l events](#read-
-000015c0: 616c 6c2d 6576 656e 7473 295c 6e20 202a  all-events)\n  *
-000015d0: 205b 4765 7420 6375 7272 656e 7420 7374   [Get current st
-000015e0: 7265 616d 2070 6f73 6974 696f 6e5d 2823  ream position](#
-000015f0: 6765 742d 6375 7272 656e 742d 7374 7265  get-current-stre
-00001600: 616d 2d70 6f73 6974 696f 6e29 5c6e 2020  am-position)\n  
-00001610: 2a20 5b47 6574 2063 7572 7265 6e74 2063  * [Get current c
-00001620: 6f6d 6d69 7420 706f 7369 7469 6f6e 5d28  ommit position](
-00001630: 2367 6574 2d63 7572 7265 6e74 2d63 6f6d  #get-current-com
-00001640: 6d69 742d 706f 7369 7469 6f6e 295c 6e20  mit-position)\n 
-00001650: 202a 205b 4765 7420 7374 7265 616d 206d   * [Get stream m
-00001660: 6574 6164 6174 615d 2823 6765 742d 7374  etadata](#get-st
-00001670: 7265 616d 2d6d 6574 6164 6174 6129 5c6e  ream-metadata)\n
-00001680: 2020 2a20 5b53 6574 2073 7472 6561 6d20    * [Set stream 
-00001690: 6d65 7461 6461 7461 5d28 2373 6574 2d73  metadata](#set-s
-000016a0: 7472 6561 6d2d 6d65 7461 6461 7461 295c  tream-metadata)\
-000016b0: 6e20 202a 205b 4465 6c65 7465 2073 7472  n  * [Delete str
-000016c0: 6561 6d5d 2823 6465 6c65 7465 2d73 7472  eam](#delete-str
-000016d0: 6561 6d29 5c6e 2020 2a20 5b54 6f6d 6273  eam)\n  * [Tombs
-000016e0: 746f 6e65 2073 7472 6561 6d5d 2823 746f  tone stream](#to
-000016f0: 6d62 7374 6f6e 652d 7374 7265 616d 295c  mbstone-stream)\
-00001700: 6e2a 205b 4361 7463 682d 7570 2073 7562  n* [Catch-up sub
-00001710: 7363 7269 7074 696f 6e73 5d28 2363 6174  scriptions](#cat
-00001720: 6368 2d75 702d 7375 6273 6372 6970 7469  ch-up-subscripti
-00001730: 6f6e 7329 5c6e 2020 2a20 5b48 6f77 2074  ons)\n  * [How t
-00001740: 6f20 696d 706c 656d 656e 7420 6578 6163  o implement exac
-00001750: 746c 792d 6f6e 6365 2065 7665 6e74 2070  tly-once event p
-00001760: 726f 6365 7373 696e 675d 2823 686f 772d  rocessing](#how-
-00001770: 746f 2d69 6d70 6c65 6d65 6e74 2d65 7861  to-implement-exa
-00001780: 6374 6c79 2d6f 6e63 652d 6576 656e 742d  ctly-once-event-
-00001790: 7072 6f63 6573 7369 6e67 295c 6e20 202a  processing)\n  *
-000017a0: 205b 5375 6273 6372 6962 6520 616c 6c20   [Subscribe all 
-000017b0: 6576 656e 7473 5d28 2373 7562 7363 7269  events](#subscri
-000017c0: 6265 2d61 6c6c 2d65 7665 6e74 7329 5c6e  be-all-events)\n
-000017d0: 2020 2a20 5b53 7562 7363 7269 6265 2073    * [Subscribe s
-000017e0: 7472 6561 6d20 6576 656e 7473 5d28 2373  tream events](#s
-000017f0: 7562 7363 7269 6265 2d73 7472 6561 6d2d  ubscribe-stream-
-00001800: 6576 656e 7473 295c 6e2a 205b 5065 7273  events)\n* [Pers
-00001810: 6973 7465 6e74 2073 7562 7363 7269 7074  istent subscript
-00001820: 696f 6e73 5d28 2370 6572 7369 7374 656e  ions](#persisten
-00001830: 742d 7375 6273 6372 6970 7469 6f6e 7329  t-subscriptions)
-00001840: 5c6e 2020 2a20 5b43 7265 6174 6520 7375  \n  * [Create su
-00001850: 6273 6372 6970 7469 6f6e 5d28 2363 7265  bscription](#cre
-00001860: 6174 652d 7375 6273 6372 6970 7469 6f6e  ate-subscription
-00001870: 295c 6e20 202a 205b 5265 6164 2073 7562  )\n  * [Read sub
-00001880: 7363 7269 7074 696f 6e5d 2823 7265 6164  scription](#read
-00001890: 2d73 7562 7363 7269 7074 696f 6e29 5c6e  -subscription)\n
-000018a0: 2020 2a20 5b47 6574 2073 7562 7363 7269    * [Get subscri
-000018b0: 7074 696f 6e20 696e 666f 5d28 2367 6574  ption info](#get
-000018c0: 2d73 7562 7363 7269 7074 696f 6e2d 696e  -subscription-in
-000018d0: 666f 295c 6e20 202a 205b 4c69 7374 2073  fo)\n  * [List s
-000018e0: 7562 7363 7269 7074 696f 6e73 5d28 236c  ubscriptions](#l
-000018f0: 6973 742d 7375 6273 6372 6970 7469 6f6e  ist-subscription
-00001900: 7329 5c6e 2020 2a20 5b44 656c 6574 6520  s)\n  * [Delete 
-00001910: 7375 6273 6372 6970 7469 6f6e 5d28 2364  subscription](#d
-00001920: 656c 6574 652d 7375 6273 6372 6970 7469  elete-subscripti
-00001930: 6f6e 295c 6e20 202a 205b 4372 6561 7465  on)\n  * [Create
-00001940: 2073 7472 6561 6d20 7375 6273 6372 6970   stream subscrip
-00001950: 7469 6f6e 5d28 2363 7265 6174 652d 7374  tion](#create-st
-00001960: 7265 616d 2d73 7562 7363 7269 7074 696f  ream-subscriptio
-00001970: 6e29 5c6e 2020 2a20 5b52 6561 6420 7374  n)\n  * [Read st
-00001980: 7265 616d 2073 7562 7363 7269 7074 696f  ream subscriptio
-00001990: 6e5d 2823 7265 6164 2d73 7472 6561 6d2d  n](#read-stream-
-000019a0: 7375 6273 6372 6970 7469 6f6e 295c 6e20  subscription)\n 
-000019b0: 202a 205b 4765 7420 7374 7265 616d 2073   * [Get stream s
-000019c0: 7562 7363 7269 7074 696f 6e20 696e 666f  ubscription info
-000019d0: 5d28 2367 6574 2d73 7472 6561 6d2d 7375  ](#get-stream-su
-000019e0: 6273 6372 6970 7469 6f6e 2d69 6e66 6f29  bscription-info)
-000019f0: 5c6e 2020 2a20 5b4c 6973 7420 7374 7265  \n  * [List stre
-00001a00: 616d 2073 7562 7363 7269 7074 696f 6e73  am subscriptions
-00001a10: 5d28 236c 6973 742d 7374 7265 616d 2d73  ](#list-stream-s
-00001a20: 7562 7363 7269 7074 696f 6e73 295c 6e20  ubscriptions)\n 
-00001a30: 202a 205b 4465 6c65 7465 2073 7472 6561   * [Delete strea
-00001a40: 6d20 7375 6273 6372 6970 7469 6f6e 5d28  m subscription](
-00001a50: 2364 656c 6574 652d 7374 7265 616d 2d73  #delete-stream-s
-00001a60: 7562 7363 7269 7074 696f 6e29 5c6e 2a20  ubscription)\n* 
-00001a70: 5b43 6f6e 6e65 6374 696f 6e5d 2823 636f  [Connection](#co
-00001a80: 6e6e 6563 7469 6f6e 295c 6e20 202a 205b  nnection)\n  * [
-00001a90: 5265 636f 6e6e 6563 745d 2823 7265 636f  Reconnect](#reco
-00001aa0: 6e6e 6563 7429 5c6e 2020 2a20 5b43 6c6f  nnect)\n  * [Clo
-00001ab0: 7365 5d28 2363 6c6f 7365 295c 6e2a 205b  se](#close)\n* [
-00001ac0: 4e6f 7465 735d 2823 6e6f 7465 7329 5c6e  Notes](#notes)\n
-00001ad0: 2020 2a20 5b43 6f6e 6e65 6374 696f 6e20    * [Connection 
-00001ae0: 7374 7269 6e67 735d 2823 636f 6e6e 6563  strings](#connec
-00001af0: 7469 6f6e 2d73 7472 696e 6773 295c 6e20  tion-strings)\n 
-00001b00: 202a 205b 5265 6775 6c61 7220 6578 7072   * [Regular expr
-00001b10: 6573 7369 6f6e 2066 696c 7465 7273 5d28  ession filters](
-00001b20: 2372 6567 756c 6172 2d65 7870 7265 7373  #regular-express
-00001b30: 696f 6e2d 6669 6c74 6572 7329 5c6e 2020  ion-filters)\n  
-00001b40: 2a20 5b4e 6577 2065 7665 6e74 206f 626a  * [New event obj
-00001b50: 6563 7473 5d28 236e 6577 2d65 7665 6e74  ects](#new-event
-00001b60: 2d6f 626a 6563 7473 295c 6e20 202a 205b  -objects)\n  * [
-00001b70: 5265 636f 7264 6564 2065 7665 6e74 206f  Recorded event o
-00001b80: 626a 6563 7473 5d28 2372 6563 6f72 6465  bjects](#recorde
-00001b90: 642d 6576 656e 742d 6f62 6a65 6374 7329  d-event-objects)
-00001ba0: 5c6e 2020 2a20 5b41 7379 6e63 696f 2063  \n  * [Asyncio c
-00001bb0: 6c69 656e 745d 2823 6173 796e 6369 6f2d  lient](#asyncio-
-00001bc0: 636c 6965 6e74 295c 6e2a 205b 436f 6e74  client)\n* [Cont
-00001bd0: 7269 6275 746f 7273 5d28 2363 6f6e 7472  ributors](#contr
-00001be0: 6962 7574 6f72 7329 5c6e 2020 2a20 5b49  ibutors)\n  * [I
-00001bf0: 6e73 7461 6c6c 2050 6f65 7472 795d 2823  nstall Poetry](#
-00001c00: 696e 7374 616c 6c2d 706f 6574 7279 295c  install-poetry)\
-00001c10: 6e20 202a 205b 5365 7475 7020 666f 7220  n  * [Setup for 
-00001c20: 5079 4368 6172 6d20 7573 6572 735d 2823  PyCharm users](#
-00001c30: 7365 7475 702d 666f 722d 7079 6368 6172  setup-for-pychar
-00001c40: 6d2d 7573 6572 7329 5c6e 2020 2a20 5b53  m-users)\n  * [S
-00001c50: 6574 7570 2066 726f 6d20 636f 6d6d 616e  etup from comman
-00001c60: 6420 6c69 6e65 5d28 2373 6574 7570 2d66  d line](#setup-f
-00001c70: 726f 6d2d 636f 6d6d 616e 642d 6c69 6e65  rom-command-line
-00001c80: 295c 6e20 202a 205b 5072 6f6a 6563 7420  )\n  * [Project 
-00001c90: 4d61 6b65 6669 6c65 2063 6f6d 6d61 6e64  Makefile command
-00001ca0: 735d 2823 7072 6f6a 6563 742d 6d61 6b65  s](#project-make
-00001cb0: 6669 6c65 2d63 6f6d 6d61 6e64 7329 5c6e  file-commands)\n
-00001cc0: 3c21 2d2d 2054 4f43 202d 2d3e 5c6e 5c6e  <!-- TOC -->\n\n
-00001cd0: 2323 2049 6e73 7461 6c6c 2070 6163 6b61  ## Install packa
-00001ce0: 6765 5c6e 5c6e 4974 2069 7320 7265 636f  ge\n\nIt is reco
-00001cf0: 6d6d 656e 6465 6420 746f 2069 6e73 7461  mmended to insta
-00001d00: 6c6c 2050 7974 686f 6e20 7061 636b 6167  ll Python packag
-00001d10: 6573 2069 6e74 6f20 6120 5079 7468 6f6e  es into a Python
-00001d20: 2076 6972 7475 616c 2065 6e76 6972 6f6e   virtual environ
-00001d30: 6d65 6e74 2e5c 6e5c 6e23 2323 2046 726f  ment.\n\n### Fro
-00001d40: 6d20 5079 5049 5c6e 5c6e 596f 7520 6361  m PyPI\n\nYou ca
-00001d50: 6e20 7573 6520 7069 7020 746f 2069 6e73  n use pip to ins
-00001d60: 7461 6c6c 2074 6869 7320 7061 636b 6167  tall this packag
-00001d70: 6520 6469 7265 6374 6c79 2066 726f 6d5c  e directly from\
-00001d80: 6e5b 7468 6520 5079 7468 6f6e 2050 6163  n[the Python Pac
-00001d90: 6b61 6765 2049 6e64 6578 5d28 6874 7470  kage Index](http
-00001da0: 733a 2f2f 7079 7069 2e6f 7267 2f70 726f  s://pypi.org/pro
-00001db0: 6a65 6374 2f65 7364 6263 6c69 656e 742f  ject/esdbclient/
-00001dc0: 292e 5c6e 5c6e 2020 2020 2420 7069 7020  ).\n\n    $ pip 
-00001dd0: 696e 7374 616c 6c20 6573 6462 636c 6965  install esdbclie
-00001de0: 6e74 5c6e 5c6e 2323 2320 5769 7468 2050  nt\n\n### With P
-00001df0: 6f65 7472 795c 6e5c 6e59 6f75 2063 616e  oetry\n\nYou can
-00001e00: 2075 7365 2050 6f65 7472 7920 746f 2061   use Poetry to a
-00001e10: 6464 2074 6869 7320 7061 636b 6167 6520  dd this package 
-00001e20: 746f 2079 6f75 7220 7079 7072 6f6a 6563  to your pyprojec
-00001e30: 742e 746f 6d6c 2061 6e64 2069 6e73 7461  t.toml and insta
-00001e40: 6c6c 2069 742e 5c6e 5c6e 2020 2020 2420  ll it.\n\n    $ 
-00001e50: 706f 6574 7279 2061 6464 2065 7364 6263  poetry add esdbc
-00001e60: 6c69 656e 745c 6e5c 6e23 2320 4576 656e  lient\n\n## Even
-00001e70: 7453 746f 7265 4442 2073 6572 7665 725c  tStoreDB server\
-00001e80: 6e5c 6e54 6865 2045 7665 6e74 5374 6f72  n\nThe EventStor
-00001e90: 6544 4220 7365 7276 6572 2063 616e 2062  eDB server can b
-00001ea0: 6520 7275 6e20 6c6f 6361 6c6c 7920 7573  e run locally us
-00001eb0: 696e 6720 7468 6520 6f66 6669 6369 616c  ing the official
-00001ec0: 2044 6f63 6b65 7220 636f 6e74 6169 6e65   Docker containe
-00001ed0: 7220 696d 6167 652e 5c6e 5c6e 2323 2320  r image.\n\n### 
-00001ee0: 5275 6e20 636f 6e74 6169 6e65 725c 6e5c  Run container\n\
-00001ef0: 6e46 6f72 2064 6576 656c 6f70 6d65 6e74  nFor development
-00001f00: 2c20 796f 7520 6361 6e20 7275 6e20 6120  , you can run a 
-00001f10: 2273 6563 7572 6522 2045 7665 6e74 5374  "secure" EventSt
-00001f20: 6f72 6544 4220 7365 7276 6572 2075 7369  oreDB server usi
-00001f30: 6e67 2074 6865 2066 6f6c 6c6f 7769 6e67  ng the following
-00001f40: 2063 6f6d 6d61 6e64 2e5c 6e5c 6e20 2020   command.\n\n   
-00001f50: 2024 2064 6f63 6b65 7220 7275 6e20 2d64   $ docker run -d
-00001f60: 202d 2d6e 616d 6520 6576 656e 7473 746f   --name eventsto
-00001f70: 7265 6462 2d73 6563 7572 6520 2d69 7420  redb-secure -it 
-00001f80: 2d70 2032 3131 333a 3231 3133 202d 2d65  -p 2113:2113 --e
-00001f90: 6e76 2022 484f 4d45 3d2f 746d 7022 2065  nv "HOME=/tmp" e
-00001fa0: 7665 6e74 7374 6f72 652f 6576 656e 7473  ventstore/events
-00001fb0: 746f 7265 3a32 312e 3130 2e39 2d62 7573  tore:21.10.9-bus
-00001fc0: 7465 722d 736c 696d 202d 2d64 6576 5c6e  ter-slim --dev\n
-00001fd0: 5c6e 4173 2077 6520 7769 6c6c 2073 6565  \nAs we will see
-00001fe0: 2c20 7468 6520 636c 6965 6e74 206e 6565  , the client nee
-00001ff0: 6473 2061 6e20 4576 656e 7453 746f 7265  ds an EventStore
-00002000: 4442 2063 6f6e 6e65 6374 696f 6e20 7374  DB connection st
-00002010: 7269 6e67 2055 5249 2061 7320 7468 6520  ring URI as the 
-00002020: 7661 6c75 6520 6f66 5c6e 6974 7320 6075  value of\nits `u
-00002030: 7269 6020 636f 6e73 7472 7563 746f 7220  ri` constructor 
-00002040: 6172 6775 6d65 6e74 2e20 5365 6520 7468  argument. See th
-00002050: 6520 4e6f 7465 7320 7365 6374 696f 6e20  e Notes section 
-00002060: 6265 6c6f 7720 666f 7220 6465 7461 696c  below for detail
-00002070: 6564 2069 6e66 6f72 6d61 7469 6f6e 5c6e  ed information\n
-00002080: 6162 6f75 7420 4576 656e 7453 746f 7265  about EventStore
-00002090: 4442 2063 6f6e 6e65 6374 696f 6e20 7374  DB connection st
-000020a0: 7269 6e67 2055 5249 732e 5c6e 5c6e 5468  ring URIs.\n\nTh
-000020b0: 6520 636f 6e6e 6563 7469 6f6e 2073 7472  e connection str
-000020c0: 696e 6720 666f 7220 7468 6973 2022 7365  ing for this "se
-000020d0: 6375 7265 2220 4576 656e 7453 746f 7265  cure" EventStore
-000020e0: 4442 2073 6572 7665 7220 776f 756c 6420  DB server would 
-000020f0: 6265 3a5c 6e5c 6e20 2020 2065 7364 623a  be:\n\n    esdb:
-00002100: 2f2f 6164 6d69 6e3a 6368 616e 6765 6974  //admin:changeit
-00002110: 406c 6f63 616c 686f 7374 3a32 3131 335c  @localhost:2113\
-00002120: 6e5c 6e54 6f20 636f 6e6e 6563 7420 746f  n\nTo connect to
-00002130: 2061 2022 7365 6375 7265 2220 7365 7276   a "secure" serv
-00002140: 6572 2c20 796f 7520 7769 6c6c 2075 7375  er, you will usu
-00002150: 616c 6c79 206e 6565 6420 746f 2069 6e63  ally need to inc
-00002160: 6c75 6465 2061 2022 7573 6572 6e61 6d65  lude a "username
-00002170: 225c 6e61 6e64 2061 2022 7061 7373 776f  "\nand a "passwo
-00002180: 7264 2220 696e 2074 6865 2063 6f6e 6e65  rd" in the conne
-00002190: 6374 696f 6e20 7374 7269 6e67 2c20 736f  ction string, so
-000021a0: 2074 6861 7420 7468 6520 7365 7276 6572   that the server
-000021b0: 2063 616e 2061 7574 6865 6e74 6963 6174   can authenticat
-000021c0: 6520 7468 655c 6e63 6c69 656e 742e 2054  e the\nclient. T
-000021d0: 6865 2064 6566 6175 6c74 2075 7365 726e  he default usern
-000021e0: 616d 6520 6973 2022 6164 6d69 6e22 2061  ame is "admin" a
-000021f0: 6e64 2074 6865 2064 6566 6175 6c74 2070  nd the default p
-00002200: 6173 7377 6f72 6420 6973 2022 6368 616e  assword is "chan
-00002210: 6765 6974 222e 5c6e 5c6e 5768 656e 2063  geit".\n\nWhen c
-00002220: 6f6e 6e65 6374 696e 6720 746f 2061 2022  onnecting to a "
-00002230: 7365 6375 7265 2220 7365 7276 6572 2c20  secure" server, 
-00002240: 7468 6520 636c 6965 6e74 2061 6c73 6f20  the client also 
-00002250: 6e65 6564 7320 616e 2053 534c 2f54 4c53  needs an SSL/TLS
-00002260: 5c6e 6365 7274 6966 6963 6174 6520 6173  \ncertificate as
-00002270: 2074 6865 2076 616c 7565 206f 6620 6974   the value of it
-00002280: 7320 6072 6f6f 745f 6365 7274 6966 6963  s `root_certific
-00002290: 6174 6573 6020 636f 6e73 7472 7563 746f  ates` constructo
-000022a0: 7220 6172 6775 6d65 6e74 2e20 546f 2063  r argument. To c
-000022b0: 6f6e 6e65 6374 5c6e 746f 2061 2022 7365  onnect\nto a "se
-000022c0: 6375 7265 2220 7365 7276 6572 2079 6f75  cure" server you
-000022d0: 2077 696c 6c20 6e65 6564 2061 6e20 5353   will need an SS
-000022e0: 4c2f 544c 5320 6365 7274 6966 6963 6174  L/TLS certificat
-000022f0: 6520 736f 2074 6861 7420 7468 6520 636c  e so that the cl
-00002300: 6965 6e74 2063 616e 5c6e 6175 7468 656e  ient can\nauthen
-00002310: 7469 6361 7465 2074 6865 2073 6572 7665  ticate the serve
-00002320: 722e 2046 6f72 2064 6576 656c 6f70 6d65  r. For developme
-00002330: 6e74 2c20 796f 7520 6361 6e20 6569 7468  nt, you can eith
-00002340: 6572 2075 7365 2074 6865 2053 534c 2f54  er use the SSL/T
-00002350: 4c53 2063 6572 7469 6669 6361 7465 5c6e  LS certificate\n
-00002360: 6f66 2074 6865 2063 6572 7469 6669 6361  of the certifica
-00002370: 7465 2061 7574 686f 7269 7479 2075 7365  te authority use
-00002380: 6420 746f 2063 7265 6174 6520 7468 6520  d to create the 
-00002390: 7365 7276 6572 5c27 7320 6365 7274 6966  server\'s certif
-000023a0: 6963 6174 652c 206f 7220 7768 656e 2075  icate, or when u
-000023b0: 7369 6e67 2061 5c6e 7369 6e67 6c65 2d6e  sing a\nsingle-n
-000023c0: 6f64 6520 636c 7573 7465 722c 2079 6f75  ode cluster, you
-000023d0: 2063 616e 2075 7365 2074 6865 2073 6572   can use the ser
-000023e0: 7665 7220 6365 7274 6966 6963 6174 6520  ver certificate 
-000023f0: 6974 7365 6c66 2e20 596f 7520 6361 6e20  itself. You can 
-00002400: 6765 7420 7468 655c 6e73 6572 7665 7220  get the\nserver 
-00002410: 6365 7274 6966 6963 6174 6520 7769 7468  certificate with
-00002420: 2074 6865 2066 6f6c 6c6f 7769 6e67 2050   the following P
-00002430: 7974 686f 6e20 636f 6465 2e5c 6e5c 6e5c  ython code.\n\n\
-00002440: 6e60 6060 7079 7468 6f6e 5c6e 696d 706f  n```python\nimpo
-00002450: 7274 2073 736c 5c6e 5c6e 7365 7276 6572  rt ssl\n\nserver
-00002460: 5f63 6572 7469 6669 6361 7465 203d 2073  _certificate = s
-00002470: 736c 2e67 6574 5f73 6572 7665 725f 6365  sl.get_server_ce
-00002480: 7274 6966 6963 6174 6528 6164 6472 3d28  rtificate(addr=(
-00002490: 5c27 6c6f 6361 6c68 6f73 745c 272c 2032  \'localhost\', 2
-000024a0: 3131 3329 295c 6e60 6060 5c6e 5c6e 596f  113))\n```\n\nYo
-000024b0: 7520 6361 6e20 616c 736f 2073 7461 7274  u can also start
-000024c0: 2061 6e20 2269 6e73 6563 7572 6522 2073   an "insecure" s
-000024d0: 6572 7665 7220 7573 696e 6720 7468 6520  erver using the 
-000024e0: 666f 6c6c 6f77 696e 6720 636f 6d6d 616e  following comman
-000024f0: 642e 5c6e 5c6e 2020 2020 2420 646f 636b  d.\n\n    $ dock
-00002500: 6572 2072 756e 202d 6420 2d2d 6e61 6d65  er run -d --name
-00002510: 2065 7665 6e74 7374 6f72 6564 622d 696e   eventstoredb-in
-00002520: 7365 6375 7265 202d 6974 202d 7020 3231  secure -it -p 21
-00002530: 3134 3a32 3131 3320 6576 656e 7473 746f  14:2113 eventsto
-00002540: 7265 2f65 7665 6e74 7374 6f72 653a 3231  re/eventstore:21
-00002550: 2e31 302e 392d 6275 7374 6572 2d73 6c69  .10.9-buster-sli
-00002560: 6d20 2d2d 696e 7365 6375 7265 5c6e 5c6e  m --insecure\n\n
-00002570: 5468 6520 636f 6e6e 6563 7469 6f6e 2073  The connection s
-00002580: 7472 696e 6720 5552 4920 666f 7220 7468  tring URI for th
-00002590: 6973 2022 696e 7365 6375 7265 2220 7365  is "insecure" se
-000025a0: 7276 6572 2077 6f75 6c64 2062 653a 5c6e  rver would be:\n
-000025b0: 5c6e 2020 2020 6573 6462 3a2f 2f6c 6f63  \n    esdb://loc
-000025c0: 616c 686f 7374 3a32 3131 343f 546c 733d  alhost:2114?Tls=
-000025d0: 6661 6c73 655c 6e5c 6e41 7320 7765 2077  false\n\nAs we w
-000025e0: 696c 6c20 7365 652c 2077 6865 6e20 636f  ill see, when co
-000025f0: 6e6e 6563 7469 6e67 2074 6f20 616e 2022  nnecting to an "
-00002600: 696e 7365 6375 7265 2220 7365 7276 6572  insecure" server
-00002610: 2c20 7468 6572 6520 6973 206e 6f20 6e65  , there is no ne
-00002620: 6564 2074 6f20 696e 636c 7564 655c 6e61  ed to include\na
-00002630: 2022 7573 6572 6e61 6d65 2220 616e 6420   "username" and 
-00002640: 6120 2270 6173 7377 6f72 6422 2069 6e20  a "password" in 
-00002650: 7468 6520 636f 6e6e 6563 7469 6f6e 2073  the connection s
-00002660: 7472 696e 672e 2049 6620 796f 7520 646f  tring. If you do
-00002670: 2c20 7468 6573 6520 7661 6c75 6573 2077  , these values w
-00002680: 696c 6c5c 6e62 6520 6967 6e6f 7265 6420  ill\nbe ignored 
-00002690: 6279 2074 6865 2063 6c69 656e 742c 2073  by the client, s
-000026a0: 6f20 7468 6174 2074 6865 7920 7769 6c6c  o that they will
-000026b0: 206e 6f74 2062 6520 7365 6e74 2074 6f20   not be sent to 
-000026c0: 7468 6520 7365 7276 6572 206f 7665 7220  the server over 
-000026d0: 616e 5c6e 696e 7365 6375 7265 2063 6861  an\ninsecure cha
-000026e0: 6e6e 656c 2e5c 6e5c 6e50 6c65 6173 6520  nnel.\n\nPlease 
-000026f0: 6e6f 7465 2c20 7468 6520 2269 6e73 6563  note, the "insec
-00002700: 7572 6522 2063 6f6e 6e65 6374 696f 6e20  ure" connection 
-00002710: 7374 7269 6e67 2075 7365 7320 6120 7175  string uses a qu
-00002720: 6572 7920 7374 7269 6e67 2077 6974 6820  ery string with 
-00002730: 7468 6520 6669 656c 642d 7661 6c75 655c  the field-value\
-00002740: 6e60 546c 733d 6661 6c73 6560 2e20 5468  n`Tls=false`. Th
-00002750: 6520 7661 6c75 6520 6f66 2074 6869 7320  e value of this 
-00002760: 6669 656c 6420 6973 2062 7920 6465 6661  field is by defa
-00002770: 756c 7420 6074 7275 6560 2e20 5365 6520  ult `true`. See 
-00002780: 7468 6520 4e6f 7465 7320 7365 6374 696f  the Notes sectio
-00002790: 6e20 6265 6c6f 775c 6e66 6f72 206d 6f72  n below\nfor mor
-000027a0: 6520 696e 666f 726d 6174 696f 6e20 6162  e information ab
-000027b0: 6f75 7420 4576 656e 7453 746f 7265 4442  out EventStoreDB
-000027c0: 2063 6f6e 6e65 6374 696f 6e20 7374 7269   connection stri
-000027d0: 6e67 7320 616e 6420 7468 6520 6669 656c  ngs and the fiel
-000027e0: 6473 2074 6861 7420 6361 6e20 6265 5c6e  ds that can be\n
-000027f0: 7573 6564 2069 6e20 7468 6520 7175 6572  used in the quer
-00002800: 7920 7374 7269 6e67 2074 6f20 7370 6563  y string to spec
-00002810: 6966 7920 636f 6e6e 6563 7469 6f6e 206f  ify connection o
-00002820: 7074 696f 6e73 2e5c 6e5c 6e23 2323 2053  ptions.\n\n### S
-00002830: 746f 7020 636f 6e74 6169 6e65 725c 6e5c  top container\n\
-00002840: 6e54 6f20 7374 6f70 2061 6e64 2072 656d  nTo stop and rem
-00002850: 6f76 6520 7468 6520 2273 6563 7572 6522  ove the "secure"
-00002860: 2063 6f6e 7461 696e 6572 2c20 7573 6520   container, use 
-00002870: 7468 6520 666f 6c6c 6f77 696e 6720 446f  the following Do
-00002880: 636b 6572 2063 6f6d 6d61 6e64 732e 5c6e  cker commands.\n
-00002890: 5c6e 2020 2020 2420 646f 636b 6572 2073  \n    $ docker s
-000028a0: 746f 7020 6576 656e 7473 746f 7265 6462  top eventstoredb
-000028b0: 2d73 6563 7572 655c 6e5c 7424 2064 6f63  -secure\n\t$ doc
-000028c0: 6b65 7220 726d 2065 7665 6e74 7374 6f72  ker rm eventstor
-000028d0: 6564 622d 7365 6375 7265 5c6e 5c6e 546f  edb-secure\n\nTo
-000028e0: 2073 746f 7020 616e 6420 7265 6d6f 7665   stop and remove
-000028f0: 2074 6865 2022 696e 7365 6375 7265 2220   the "insecure" 
-00002900: 636f 6e74 6169 6e65 722c 2075 7365 2074  container, use t
-00002910: 6865 2066 6f6c 6c6f 7769 6e67 2044 6f63  he following Doc
-00002920: 6b65 7220 636f 6d6d 616e 6473 2e5c 6e5c  ker commands.\n\
-00002930: 6e20 2020 2024 2064 6f63 6b65 7220 7374  n    $ docker st
-00002940: 6f70 2065 7665 6e74 7374 6f72 6564 622d  op eventstoredb-
-00002950: 696e 7365 6375 7265 5c6e 5c74 2420 646f  insecure\n\t$ do
-00002960: 636b 6572 2072 6d20 6576 656e 7473 746f  cker rm eventsto
-00002970: 7265 6462 2d69 6e73 6563 7572 655c 6e5c  redb-insecure\n\
-00002980: 6e5c 6e23 2320 4576 656e 7453 746f 7265  n\n## EventStore
-00002990: 4442 2063 6c69 656e 745c 6e5c 6e54 6869  DB client\n\nThi
-000029a0: 7320 4576 656e 7453 746f 7265 4442 2063  s EventStoreDB c
-000029b0: 6c69 656e 7420 6973 2069 6d70 6c65 6d65  lient is impleme
-000029c0: 6e74 6564 2069 6e20 7468 6520 6065 7364  nted in the `esd
-000029d0: 6263 6c69 656e 7460 2070 6163 6b61 6765  bclient` package
-000029e0: 2077 6974 685c 6e74 6865 2060 4553 4442   with\nthe `ESDB
-000029f0: 436c 6965 6e74 6020 636c 6173 732e 5c6e  Client` class.\n
-00002a00: 5c6e 2323 2320 496d 706f 7274 2063 6c61  \n### Import cla
-00002a10: 7373 5c6e 5c6e 5468 6520 6045 5344 4243  ss\n\nThe `ESDBC
-00002a20: 6c69 656e 7460 2063 6c61 7373 2063 616e  lient` class can
-00002a30: 2062 6520 696d 706f 7274 6564 2066 726f   be imported fro
-00002a40: 6d20 7468 6520 6065 7364 6263 6c69 656e  m the `esdbclien
-00002a50: 7460 2070 6163 6b61 6765 2e5c 6e5c 6e60  t` package.\n\n`
-00002a60: 6060 7079 7468 6f6e 5c6e 6672 6f6d 2065  ``python\nfrom e
-00002a70: 7364 6263 6c69 656e 7420 696d 706f 7274  sdbclient import
-00002a80: 2045 5344 4243 6c69 656e 745c 6e60 6060   ESDBClient\n```
-00002a90: 5c6e 5c6e 2323 2320 436f 6e73 7472 7563  \n\n### Construc
-00002aa0: 7420 636c 6965 6e74 5c6e 5c6e 5468 6520  t client\n\nThe 
-00002ab0: 6045 5344 4243 6c69 656e 7460 2063 6c61  `ESDBClient` cla
-00002ac0: 7373 2063 616e 2062 6520 636f 6e73 7472  ss can be constr
-00002ad0: 7563 7465 6420 7769 7468 2061 2060 7572  ucted with a `ur
-00002ae0: 6960 2061 7267 756d 656e 742c 2077 6869  i` argument, whi
-00002af0: 6368 2069 7320 7265 7175 6972 6564 2e5c  ch is required.\
-00002b00: 6e41 6e64 2c20 746f 2063 6f6e 6e65 6374  nAnd, to connect
-00002b10: 2074 6f20 6120 2273 6563 7572 6522 2045   to a "secure" E
-00002b20: 7665 6e74 5374 6f72 6544 4220 7365 7276  ventStoreDB serv
-00002b30: 6572 2c20 7468 6520 6f70 7469 6f6e 616c  er, the optional
-00002b40: 2060 726f 6f74 5f63 6572 7469 6669 6361   `root_certifica
-00002b50: 7465 7360 5c6e 6172 6775 6d65 6e74 2069  tes`\nargument i
-00002b60: 7320 616c 736f 2072 6571 7569 7265 642e  s also required.
-00002b70: 5c6e 5c6e 5468 6520 6075 7269 6020 6172  \n\nThe `uri` ar
-00002b80: 6775 6d65 6e74 2069 7320 6578 7065 6374  gument is expect
-00002b90: 6564 2074 6f20 6265 2061 6e20 4576 656e  ed to be an Even
-00002ba0: 7453 746f 7265 4442 2063 6f6e 6e65 6374  tStoreDB connect
-00002bb0: 696f 6e20 7374 7269 6e67 2055 5249 2074  ion string URI t
-00002bc0: 6861 745c 6e63 6f6e 666f 726d 7320 7769  hat\nconforms wi
-00002bd0: 7468 2074 6865 2073 7461 6e64 6172 6420  th the standard 
-00002be0: 4576 656e 7453 746f 7265 4442 2022 6573  EventStoreDB "es
-00002bf0: 6462 2220 6f72 2022 6573 6462 2b64 6973  db" or "esdb+dis
-00002c00: 636f 7665 7222 2055 5249 2073 6368 656d  cover" URI schem
-00002c10: 6573 2e20 5468 655c 6e73 796e 7461 7820  es. The\nsyntax 
-00002c20: 616e 6420 7365 6d61 6e74 6963 7320 6f66  and semantics of
-00002c30: 2045 7665 6e74 5374 6f72 6544 4220 636f   EventStoreDB co
-00002c40: 6e6e 6563 7469 6f6e 2073 7472 696e 6773  nnection strings
-00002c50: 2061 7265 2065 7870 6c61 696e 6564 2069   are explained i
-00002c60: 6e20 7468 6520 4e6f 7465 735c 6e73 6563  n the Notes\nsec
-00002c70: 7469 6f6e 2062 656c 6f77 2e5c 6e5c 6e46  tion below.\n\nF
-00002c80: 6f72 2065 7861 6d70 6c65 2c20 7468 6520  or example, the 
-00002c90: 666f 6c6c 6f77 696e 6720 636f 6e6e 6563  following connec
-00002ca0: 7469 6f6e 2073 7472 696e 6720 7370 6563  tion string spec
-00002cb0: 6966 6965 7320 7468 6174 2074 6865 2063  ifies that the c
-00002cc0: 6c69 656e 7420 7368 6f75 6c64 5c6e 6174  lient should\nat
-00002cd0: 7465 6d70 7420 746f 2063 7265 6174 6520  tempt to create 
-00002ce0: 6120 2273 6563 7572 6522 2063 6f6e 6e65  a "secure" conne
-00002cf0: 6374 696f 6e20 746f 2070 6f72 7420 3231  ction to port 21
-00002d00: 3133 206f 6e20 226c 6f63 616c 686f 7374  13 on "localhost
-00002d10: 222c 2061 6e64 2075 7365 2074 6865 5c6e  ", and use the\n
-00002d20: 636c 6965 6e74 2063 7265 6465 6e74 6961  client credentia
-00002d30: 6c73 2022 7573 6572 6e61 6d65 2220 616e  ls "username" an
-00002d40: 6420 2270 6173 7377 6f72 6422 2077 6865  d "password" whe
-00002d50: 6e20 6d61 6b69 6e67 2063 616c 6c73 2074  n making calls t
-00002d60: 6f20 7468 6520 7365 7276 6572 2e5c 6e5c  o the server.\n\
-00002d70: 6e20 2020 2065 7364 623a 2f2f 7573 6572  n    esdb://user
-00002d80: 6e61 6d65 3a70 6173 7377 6f72 6440 6c6f  name:password@lo
-00002d90: 6361 6c68 6f73 743a 3231 3133 3f54 6c73  calhost:2113?Tls
-00002da0: 3d74 7275 655c 6e5c 6e54 6865 2063 6c69  =true\n\nThe cli
-00002db0: 656e 7420 6d75 7374 2062 6520 636f 6e66  ent must be conf
-00002dc0: 6967 7572 6564 2074 6f20 6372 6561 7465  igured to create
-00002dd0: 2061 2022 7365 6375 7265 2220 636f 6e6e   a "secure" conn
-00002de0: 6563 7469 6f6e 2074 6f20 6120 2273 6563  ection to a "sec
-00002df0: 7572 6522 2073 6572 7665 722c 5c6e 6f72  ure" server,\nor
-00002e00: 2061 6c74 6572 6e61 7469 7665 6c79 2061   alternatively a
-00002e10: 6e20 2269 6e73 6563 7572 6522 2063 6f6e  n "insecure" con
-00002e20: 6e65 6374 696f 6e20 746f 2061 6e20 2269  nection to an "i
-00002e30: 6e73 6563 7572 6522 2073 6572 7665 722e  nsecure" server.
-00002e40: 2042 7920 6465 6661 756c 742c 2074 6865   By default, the
-00002e50: 5c6e 636c 6965 6e74 2077 696c 6c20 6174  \nclient will at
-00002e60: 7465 6d70 7420 746f 2063 7265 6174 6520  tempt to create 
-00002e70: 6120 2273 6563 7572 6522 2063 6f6e 6e65  a "secure" conne
-00002e80: 6374 696f 6e2e 2041 6e64 2073 6f2c 2077  ction. And so, w
-00002e90: 6865 6e20 636f 6e6e 6563 7469 6e67 2074  hen connecting t
-00002ea0: 6f20 616e 5c6e 2269 6e73 6563 7572 6522  o an\n"insecure"
-00002eb0: 2073 6572 7665 722c 2074 6865 2063 6f6e   server, the con
-00002ec0: 6e65 6374 696f 6e20 7374 7269 6e67 206d  nection string m
-00002ed0: 7573 7420 7370 6563 6966 7920 7468 6174  ust specify that
-00002ee0: 2074 6865 2063 6c69 656e 7420 7368 6f75   the client shou
-00002ef0: 6c64 2061 7474 656d 7074 5c6e 746f 206d  ld attempt\nto m
-00002f00: 616b 6520 616e 2022 696e 7365 6375 7265  ake an "insecure
-00002f10: 2220 636f 6e6e 6563 7469 6f6e 2e5c 6e5c  " connection.\n\
-00002f20: 6e54 6865 2066 6f6c 6c6f 7769 6e67 2063  nThe following c
-00002f30: 6f6e 6e65 6374 696f 6e20 7374 7269 6e67  onnection string
-00002f40: 2073 7065 6369 6669 6573 2074 6861 7420   specifies that 
-00002f50: 7468 6520 636c 6965 6e74 2073 686f 756c  the client shoul
-00002f60: 645c 6e61 7474 656d 7074 2074 6f20 6372  d\nattempt to cr
-00002f70: 6561 7465 2061 6e20 2269 6e73 6563 7572  eate an "insecur
-00002f80: 6522 2063 6f6e 6e65 6374 696f 6e20 746f  e" connection to
-00002f90: 2070 6f72 7420 3231 3134 206f 6e20 226c   port 2114 on "l
-00002fa0: 6f63 616c 686f 7374 222e 5c6e 5768 656e  ocalhost".\nWhen
-00002fb0: 2063 6f6e 6e65 6374 696e 6720 746f 2061   connecting to a
-00002fc0: 6e20 2269 6e73 6563 7572 6522 2073 6572  n "insecure" ser
-00002fd0: 7665 722c 2074 6865 2063 6c69 656e 7420  ver, the client 
-00002fe0: 7769 6c6c 2069 676e 6f72 6520 616e 795c  will ignore any\
-00002ff0: 6e75 7365 726e 616d 6520 616e 6420 7061  nusername and pa
-00003000: 7373 776f 7264 2069 6e66 6f72 6d61 7469  ssword informati
-00003010: 6f6e 2069 6e63 6c75 6465 6420 696e 2074  on included in t
-00003020: 6865 2063 6f6e 6e65 6374 696f 6e20 7374  he connection st
-00003030: 7269 6e67 2c5c 6e73 6f20 7468 6174 2075  ring,\nso that u
-00003040: 7365 726e 616d 6573 2061 6e64 2070 6173  sernames and pas
-00003050: 7377 6f72 6473 2061 7265 206e 6f74 2073  swords are not s
-00003060: 656e 7420 6f76 6572 2061 6e20 2269 6e73  ent over an "ins
-00003070: 6563 7572 6522 2063 6f6e 6e65 6374 696f  ecure" connectio
-00003080: 6e2e 5c6e 5c6e 2020 2020 6573 6462 3a2f  n.\n\n    esdb:/
-00003090: 2f6c 6f63 616c 686f 7374 3a32 3131 343f  /localhost:2114?
-000030a0: 546c 733d 6661 6c73 655c 6e5c 6e50 6c65  Tls=false\n\nPle
-000030b0: 6173 6520 6e6f 7465 2c20 7468 6520 2269  ase note, the "i
-000030c0: 6e73 6563 7572 6522 2063 6f6e 6e65 6374  nsecure" connect
-000030d0: 696f 6e20 7374 7269 6e67 2075 7365 7320  ion string uses 
-000030e0: 6120 7175 6572 7920 7374 7269 6e67 2077  a query string w
-000030f0: 6974 6820 7468 6520 6669 656c 642d 7661  ith the field-va
-00003100: 6c75 655c 6e60 546c 733d 6661 6c73 6560  lue\n`Tls=false`
-00003110: 2e20 5468 6520 7661 6c75 6520 6f66 2074  . The value of t
-00003120: 6869 7320 6669 656c 6420 6973 2062 7920  his field is by 
-00003130: 6465 6661 756c 7420 6074 7275 6560 2e20  default `true`. 
-00003140: 556e 6c65 7373 2074 6865 2063 6f6e 6e65  Unless the conne
-00003150: 6374 696f 6e20 7374 7269 6e67 5c6e 5552  ction string\nUR
-00003160: 4920 696e 636c 7564 6573 2074 6865 2066  I includes the f
-00003170: 6965 6c64 2d76 616c 7565 2060 546c 733d  ield-value `Tls=
-00003180: 6661 6c73 6560 2069 6e20 7468 6520 7175  false` in the qu
-00003190: 6572 7920 7374 7269 6e67 2c20 7468 6520  ery string, the 
-000031a0: 6072 6f6f 745f 6365 7274 6966 6963 6174  `root_certificat
-000031b0: 6573 605c 6e63 6f6e 7374 7275 6374 6f72  es`\nconstructor
-000031c0: 2061 7267 756d 656e 7420 6973 2061 6c73   argument is als
-000031d0: 6f20 7265 7175 6972 6564 2e5c 6e5c 6e57  o required.\n\nW
-000031e0: 6865 6e20 636f 6e6e 6563 7469 6e67 2074  hen connecting t
-000031f0: 6f20 6120 2273 6563 7572 6522 2073 6572  o a "secure" ser
-00003200: 7665 722c 2074 6865 2060 726f 6f74 5f63  ver, the `root_c
-00003210: 6572 7469 6669 6361 7465 7360 2061 7267  ertificates` arg
-00003220: 756d 656e 7420 6973 2065 7870 6563 7465  ument is expecte
-00003230: 6420 746f 5c6e 6265 2061 2050 7974 686f  d to\nbe a Pytho
-00003240: 6e20 6073 7472 6020 636f 6e74 6169 6e69  n `str` containi
-00003250: 6e67 2050 454d 2065 6e63 6f64 6564 2053  ng PEM encoded S
-00003260: 534c 2f54 4c53 2072 6f6f 7420 6365 7274  SL/TLS root cert
-00003270: 6966 6963 6174 6573 2e20 5468 6973 2076  ificates. This v
-00003280: 616c 7565 2069 735c 6e70 6173 7365 6420  alue is\npassed 
-00003290: 6469 7265 6374 6c79 2074 6f20 6067 7270  directly to `grp
-000032a0: 632e 7373 6c5f 6368 616e 6e65 6c5f 6372  c.ssl_channel_cr
-000032b0: 6564 656e 7469 616c 7328 2960 2e20 4974  edentials()`. It
-000032c0: 2069 7320 7573 6564 2066 6f72 2061 7574   is used for aut
-000032d0: 6865 6e74 6963 6174 696e 6720 7468 655c  henticating the\
-000032e0: 6e73 6572 7665 7220 746f 2074 6865 2063  nserver to the c
-000032f0: 6c69 656e 742e 2049 7420 6973 2063 6f6d  lient. It is com
-00003300: 6d6f 6e6c 7920 7468 6520 6365 7274 6966  monly the certif
-00003310: 6963 6174 6520 6f66 2074 6865 2063 6572  icate of the cer
-00003320: 7469 6669 6361 7465 2061 7574 686f 7269  tificate authori
-00003330: 7479 2074 6861 745c 6e77 6173 2072 6573  ty that\nwas res
-00003340: 706f 6e73 6962 6c65 2066 6f72 2067 656e  ponsible for gen
-00003350: 6572 6174 696e 6720 7468 6520 5353 4c2f  erating the SSL/
-00003360: 544c 5320 6365 7274 6966 6963 6174 6520  TLS certificate 
-00003370: 7573 6564 2062 7920 7468 6520 4576 656e  used by the Even
-00003380: 7453 746f 7265 4442 2073 6572 7665 722e  tStoreDB server.
-00003390: 5c6e 4275 742c 2061 6c74 6572 6e61 7469  \nBut, alternati
-000033a0: 7665 6c79 2066 6f72 2064 6576 656c 6f70  vely for develop
-000033b0: 6d65 6e74 2c20 796f 7520 6361 6e20 7573  ment, you can us
-000033c0: 6520 7468 6520 7365 7276 6572 5c27 7320  e the server\'s 
-000033d0: 6365 7274 6966 6963 6174 6520 6974 7365  certificate itse
-000033e0: 6c66 2e5c 6e5c 6e49 6e20 7468 6520 6578  lf.\n\nIn the ex
-000033f0: 616d 706c 6520 6265 6c6f 772c 2074 6865  ample below, the
-00003400: 2063 6f6e 7374 7275 6374 6f72 2061 7267   constructor arg
-00003410: 756d 656e 7420 7661 6c75 6573 2061 7265  ument values are
-00003420: 2074 616b 656e 2066 726f 6d20 7468 6520   taken from the 
-00003430: 6f70 6572 6174 696e 675c 6e73 7973 7465  operating\nsyste
-00003440: 6d20 656e 7669 726f 6e6d 656e 742e 2054  m environment. T
-00003450: 6869 7320 6973 2061 2074 7970 6963 616c  his is a typical
-00003460: 2061 7272 616e 6765 6d65 6e74 2069 6e20   arrangement in 
-00003470: 6120 7072 6f64 7563 7469 6f6e 2065 6e76  a production env
-00003480: 6972 6f6e 6d65 6e74 2e20 4974 2069 735c  ironment. It is\
-00003490: 6e64 6f6e 6520 7468 6973 2077 6179 2068  ndone this way h
-000034a0: 6572 6520 736f 2074 6861 7420 7468 6520  ere so that the 
-000034b0: 636f 6465 2069 6e20 7468 6973 2064 6f63  code in this doc
-000034c0: 756d 656e 7461 7469 6f6e 2063 616e 2062  umentation can b
-000034d0: 6520 7465 7374 6564 2077 6974 6820 626f  e tested with bo
-000034e0: 7468 5c6e 6120 2273 6563 7572 6522 2061  th\na "secure" a
-000034f0: 6e64 2061 6e20 2269 6e73 6563 7572 6522  nd an "insecure"
-00003500: 2073 6572 7665 722e 5c6e 5c6e 6060 6070   server.\n\n```p
-00003510: 7974 686f 6e5c 6e69 6d70 6f72 7420 6f73  ython\nimport os
-00003520: 5c6e 5c6e 636c 6965 6e74 203d 2045 5344  \n\nclient = ESD
-00003530: 4243 6c69 656e 7428 5c6e 2020 2020 7572  BClient(\n    ur
-00003540: 693d 6f73 2e67 6574 656e 7628 2245 5344  i=os.getenv("ESD
-00003550: 425f 5552 4922 292c 5c6e 2020 2020 726f  B_URI"),\n    ro
-00003560: 6f74 5f63 6572 7469 6669 6361 7465 733d  ot_certificates=
-00003570: 6f73 2e67 6574 656e 7628 2245 5344 425f  os.getenv("ESDB_
-00003580: 524f 4f54 5f43 4552 5449 4649 4341 5445  ROOT_CERTIFICATE
-00003590: 5322 292c 5c6e 295c 6e60 6060 5c6e 5c6e  S"),\n)\n```\n\n
-000035a0: 5365 6520 7468 6520 4e6f 7465 7320 7365  See the Notes se
-000035b0: 6374 696f 6e20 6265 6c6f 7720 666f 7220  ction below for 
-000035c0: 6465 7461 696c 6564 2069 6e66 6f72 6d61  detailed informa
-000035d0: 7469 6f6e 2061 626f 7574 2045 7665 6e74  tion about Event
-000035e0: 5374 6f72 6544 4220 636f 6e6e 6563 7469  StoreDB connecti
-000035f0: 6f6e 5c6e 7374 7269 6e67 7320 616e 6420  on\nstrings and 
-00003600: 7468 6520 6669 656c 6473 2074 6861 7420  the fields that 
-00003610: 6361 6e20 6265 2075 7365 6420 696e 2074  can be used in t
-00003620: 6865 2071 7565 7279 2073 7472 696e 6720  he query string 
-00003630: 746f 2073 7065 6369 6679 2063 6f6e 6e65  to specify conne
-00003640: 6374 696f 6e5c 6e6f 7074 696f 6e73 2e5c  ction\noptions.\
-00003650: 6e5c 6e23 2320 5374 7265 616d 735c 6e5c  n\n## Streams\n\
-00003660: 6e49 6e20 4576 656e 7453 746f 7265 4442  nIn EventStoreDB
-00003670: 2c20 6120 2273 7472 6561 6d22 2069 7320  , a "stream" is 
-00003680: 6120 7365 7175 656e 6365 206f 6620 7265  a sequence of re
-00003690: 636f 7264 6564 2065 7665 6e74 7320 7468  corded events th
-000036a0: 6174 2061 6c6c 2068 6176 655c 6e74 6865  at all have\nthe
-000036b0: 2073 616d 6520 2273 7472 6561 6d20 6e61   same "stream na
-000036c0: 6d65 222e 2054 6865 7265 2077 696c 6c20  me". There will 
-000036d0: 6e6f 726d 616c 6c79 2062 6520 6d61 6e79  normally be many
-000036e0: 2073 7472 6561 6d73 2069 6e20 6120 6461   streams in a da
-000036f0: 7461 6261 7365 2e5c 6e45 6163 6820 7265  tabase.\nEach re
-00003700: 636f 7264 6564 2065 7665 6e74 2068 6173  corded event has
-00003710: 2061 2022 7374 7265 616d 2070 6f73 6974   a "stream posit
-00003720: 696f 6e22 2069 6e20 6974 7320 7374 7265  ion" in its stre
-00003730: 616d 2c20 616e 6420 6120 2263 6f6d 6d69  am, and a "commi
-00003740: 7420 706f 7369 7469 6f6e 225c 6e69 6e20  t position"\nin 
-00003750: 7468 6520 6461 7461 6261 7365 2e20 5468  the database. Th
-00003760: 6520 7374 7265 616d 2070 6f73 6974 696f  e stream positio
-00003770: 6e73 206f 6620 7468 6520 7265 636f 7264  ns of the record
-00003780: 6564 2065 7665 6e74 7320 696e 2061 2073  ed events in a s
-00003790: 7472 6561 6d20 6973 2061 2067 6170 6c65  tream is a gaple
-000037a0: 7373 5c6e 7365 7175 656e 6365 2073 7461  ss\nsequence sta
-000037b0: 7274 696e 6720 6672 6f6d 207a 6572 6f2e  rting from zero.
-000037c0: 2054 6865 2063 6f6d 6d69 7420 706f 7369   The commit posi
-000037d0: 7469 6f6e 7320 6f66 2074 6865 2072 6563  tions of the rec
-000037e0: 6f72 6465 6420 6576 656e 7473 2069 6e20  orded events in 
-000037f0: 7468 6520 6461 7461 6261 7365 5c6e 666f  the database\nfo
-00003800: 726d 2061 2073 6571 7565 6e63 6520 7468  rm a sequence th
-00003810: 6174 2069 7320 6e6f 7420 6761 706c 6573  at is not gaples
-00003820: 732e 5c6e 5c6e 5468 6520 6d65 7468 6f64  s.\n\nThe method
-00003830: 7320 6061 7070 656e 645f 6576 656e 7473  s `append_events
-00003840: 2829 602c 2060 7265 6164 5f73 7472 6561  ()`, `read_strea
-00003850: 6d5f 6576 656e 7473 2829 6020 616e 6420  m_events()` and 
-00003860: 6072 6561 645f 616c 6c5f 6576 656e 7473  `read_all_events
-00003870: 2829 6020 6361 6e5c 6e62 6520 7573 6564  ()` can\nbe used
-00003880: 2074 6f20 7265 636f 7264 2061 6e64 2072   to record and r
-00003890: 6561 6420 6576 656e 7473 2069 6e20 7468  ead events in th
-000038a0: 6520 6461 7461 6261 7365 2e5c 6e5c 6e23  e database.\n\n#
-000038b0: 2323 2041 7070 656e 6420 6576 656e 7473  ## Append events
-000038c0: 5c6e 5c6e 2a72 6571 7569 7265 7320 6c65  \n\n*requires le
-000038d0: 6164 6572 2a5c 6e5c 6e54 6865 2060 6170  ader*\n\nThe `ap
-000038e0: 7065 6e64 5f65 7665 6e74 7328 2960 206d  pend_events()` m
-000038f0: 6574 686f 6420 6361 6e20 6265 2075 7365  ethod can be use
-00003900: 6420 746f 2077 7269 7465 2061 2073 6571  d to write a seq
-00003910: 7565 6e63 6520 6f66 206e 6577 2065 7665  uence of new eve
-00003920: 6e74 7320 6174 6f6d 6963 616c 6c79 5c6e  nts atomically\n
-00003930: 746f 2061 2022 7374 7265 616d 222e 2057  to a "stream". W
-00003940: 7269 7469 6e67 206e 6577 2065 7665 6e74  riting new event
-00003950: 7320 6569 7468 6572 2063 7265 6174 6573  s either creates
-00003960: 2061 2073 7472 6561 6d2c 206f 7220 6170   a stream, or ap
-00003970: 7065 6e64 7320 6576 656e 7473 2074 6f20  pends events to 
-00003980: 7468 6520 656e 645c 6e6f 6620 6120 7374  the end\nof a st
-00003990: 7265 616d 2e20 5468 6973 206d 6574 686f  ream. This metho
-000039a0: 6420 6973 2069 6465 6d70 6f74 656e 7420  d is idempotent 
-000039b0: 2873 6565 2062 656c 6f77 292e 5c6e 5c6e  (see below).\n\n
-000039c0: 5468 6973 206d 6574 686f 6420 6361 6e20  This method can 
-000039d0: 6265 2075 7365 6420 746f 2072 6563 6f72  be used to recor
-000039e0: 6420 6174 6f6d 6963 616c 6c79 2061 6c6c  d atomically all
-000039f0: 2074 6865 206e 6577 5c6e 6576 656e 7473   the new\nevents
-00003a00: 2074 6861 7420 6172 6520 6765 6e65 7261   that are genera
-00003a10: 7465 6420 7768 656e 2065 7865 6375 7469  ted when executi
-00003a20: 6e67 2061 2063 6f6d 6d61 6e64 2069 6e20  ng a command in 
-00003a30: 616e 2061 7070 6c69 6361 7469 6f6e 2e5c  an application.\
-00003a40: 6e5c 6e54 6872 6565 2061 7267 756d 656e  n\nThree argumen
-00003a50: 7473 2061 7265 2072 6571 7569 7265 642c  ts are required,
-00003a60: 2060 7374 7265 616d 5f6e 616d 6560 2c20   `stream_name`, 
-00003a70: 6065 7870 6563 7465 645f 706f 7369 7469  `expected_positi
-00003a80: 6f6e 605c 6e61 6e64 2060 6576 656e 7473  on`\nand `events
-00003a90: 602e 5c6e 5c6e 5468 6520 6073 7472 6561  `.\n\nThe `strea
-00003aa0: 6d5f 6e61 6d65 6020 6172 6775 6d65 6e74  m_name` argument
-00003ab0: 2069 7320 7265 7175 6972 6564 2c20 616e   is required, an
-00003ac0: 6420 6973 2065 7870 6563 7465 6420 746f  d is expected to
-00003ad0: 2062 6520 6120 5079 7468 6f6e 5c6e 6073   be a Python\n`s
-00003ae0: 7472 6020 7468 6174 2075 6e69 7175 656c  tr` that uniquel
-00003af0: 7920 6964 656e 7469 6669 6573 2074 6865  y identifies the
-00003b00: 2073 7472 6561 6d20 696e 2074 6865 2064   stream in the d
-00003b10: 6174 6162 6173 652e 5c6e 5c6e 5468 6520  atabase.\n\nThe 
-00003b20: 6065 7870 6563 7465 645f 706f 7369 7469  `expected_positi
-00003b30: 6f6e 6020 6172 6775 6d65 6e74 2069 7320  on` argument is 
-00003b40: 7265 7175 6972 6564 2c20 6973 2065 7870  required, is exp
-00003b50: 6563 7465 6420 746f 2062 653a 2060 4e6f  ected to be: `No
-00003b60: 6e65 605c 6e69 6620 6576 656e 7473 2061  ne`\nif events a
-00003b70: 7265 2062 6569 6e67 2077 7269 7474 656e  re being written
-00003b80: 2074 6f20 6120 6e65 7720 7374 7265 616d   to a new stream
-00003b90: 2c20 616e 6420 6f74 6865 7277 6973 6520  , and otherwise 
-00003ba0: 616e 2050 7974 686f 6e20 6069 6e74 605c  an Python `int`\
-00003bb0: 6e65 7175 616c 2074 6f20 7468 6520 706f  nequal to the po
-00003bc0: 7369 7469 6f6e 2069 6e20 7468 6520 7374  sition in the st
-00003bd0: 7265 616d 206f 6620 7468 6520 6c61 7374  ream of the last
-00003be0: 2072 6563 6f72 6465 6420 6576 656e 7420   recorded event 
-00003bf0: 696e 2074 6865 2073 7472 6561 6d2e 5c6e  in the stream.\n
-00003c00: 5c6e 5468 6520 6065 7665 6e74 7360 2061  \nThe `events` a
-00003c10: 7267 756d 656e 7420 6973 2072 6571 7569  rgument is requi
-00003c20: 7265 642c 2061 6e64 2069 7320 6578 7065  red, and is expe
-00003c30: 6374 6564 2074 6f20 6265 2061 2073 6571  cted to be a seq
-00003c40: 7565 6e63 6520 6f66 206e 6577 5c6e 6576  uence of new\nev
-00003c50: 656e 7420 6f62 6a65 6374 7320 746f 2062  ent objects to b
-00003c60: 6520 6170 7065 6e64 6564 2074 6f20 7468  e appended to th
-00003c70: 6520 6e61 6d65 6420 7374 7265 616d 2e20  e named stream. 
-00003c80: 5468 6520 604e 6577 4576 656e 7460 2063  The `NewEvent` c
-00003c90: 6c61 7373 2073 686f 756c 645c 6e62 6520  lass should\nbe 
-00003ca0: 7573 6564 2074 6f20 636f 6e73 7472 7563  used to construc
-00003cb0: 7420 6e65 7720 6576 656e 7420 6f62 6a65  t new event obje
-00003cc0: 6374 7320 2873 6565 2062 656c 6f77 292e  cts (see below).
-00003cd0: 5c6e 5c6e 5468 6973 206d 6574 686f 6420  \n\nThis method 
-00003ce0: 7461 6b65 7320 616e 206f 7074 696f 6e61  takes an optiona
-00003cf0: 6c20 6074 696d 656f 7574 6020 6172 6775  l `timeout` argu
-00003d00: 6d65 6e74 2c20 7768 6963 6820 6973 2061  ment, which is a
-00003d10: 2050 7974 686f 6e20 6066 6c6f 6174 6020   Python `float` 
-00003d20: 7468 6174 2073 6574 735c 6e61 2064 6561  that sets\na dea
-00003d30: 646c 696e 6520 666f 7220 7468 6520 636f  dline for the co
-00003d40: 6d70 6c65 7469 6f6e 206f 6620 7468 6520  mpletion of the 
-00003d50: 6752 5043 206f 7065 7261 7469 6f6e 2e5c  gRPC operation.\
-00003d60: 6e5c 6e53 7472 6561 6d73 2061 7265 2063  n\nStreams are c
-00003d70: 7265 6174 6564 2062 7920 7772 6974 696e  reated by writin
-00003d80: 6720 6576 656e 7473 2e20 5468 6520 636f  g events. The co
-00003d90: 7272 6563 7420 7661 6c75 6520 6f66 2074  rrect value of t
-00003da0: 6865 2060 6578 7065 6374 6564 5f70 6f73  he `expected_pos
-00003db0: 6974 696f 6e60 5c6e 6172 6775 6d65 6e74  ition`\nargument
-00003dc0: 2077 6865 6e20 7772 6974 696e 6720 7468   when writing th
-00003dd0: 6520 6669 7273 7420 6576 656e 7420 6f66  e first event of
-00003de0: 2061 206e 6577 2073 7472 6561 6d20 6973   a new stream is
-00003df0: 2060 4e6f 6e65 602e 2050 6c65 6173 6520   `None`. Please 
-00003e00: 6e6f 7465 2c20 6974 2069 735c 6e6e 6f74  note, it is\nnot
-00003e10: 2070 6f73 7369 626c 6520 746f 2073 6f6d   possible to som
-00003e20: 6568 6f77 2063 7265 6174 6520 616e 2022  ehow create an "
-00003e30: 656d 7074 7922 2073 7472 6561 6d20 696e  empty" stream in
-00003e40: 2045 7665 6e74 5374 6f72 6544 422e 5c6e   EventStoreDB.\n
-00003e50: 5c6e 5468 6520 7374 7265 616d 2070 6f73  \nThe stream pos
-00003e60: 6974 696f 6e73 206f 6620 7265 636f 7264  itions of record
-00003e70: 6564 2065 7665 6e74 7320 696e 2061 2073  ed events in a s
-00003e80: 7472 6561 6d20 7374 6172 7420 6672 6f6d  tream start from
-00003e90: 207a 6572 6f2c 2061 6e64 2066 6f72 6d20   zero, and form 
-00003ea0: 6120 6761 706c 6573 735c 6e73 6571 7565  a gapless\nseque
-00003eb0: 6e63 6520 6f66 2069 6e74 6567 6572 732e  nce of integers.
-00003ec0: 2054 6865 2073 7472 6561 6d20 706f 7369   The stream posi
-00003ed0: 7469 6f6e 206f 6620 7468 6520 6669 7273  tion of the firs
-00003ee0: 7420 7265 636f 7264 6564 2065 7665 6e74  t recorded event
-00003ef0: 2069 6e20 6120 7374 7265 616d 2069 735c   in a stream is\
-00003f00: 6e60 3060 2e20 416e 6420 736f 2077 6865  n`0`. And so whe
-00003f10: 6e20 6170 7065 6e64 696e 6720 7468 6520  n appending the 
-00003f20: 7365 636f 6e64 206e 6577 2065 7665 6e74  second new event
-00003f30: 2074 6f20 6120 7374 7265 616d 2074 6861   to a stream tha
-00003f40: 7420 6861 7320 6f6e 6520 7265 636f 7264  t has one record
-00003f50: 6564 2065 7665 6e74 2c5c 6e74 6865 2063  ed event,\nthe c
-00003f60: 6f72 7265 6374 2076 616c 7565 206f 6620  orrect value of 
-00003f70: 7468 6520 6065 7870 6563 7465 645f 706f  the `expected_po
-00003f80: 7369 7469 6f6e 6020 6172 6775 6d65 6e74  sition` argument
-00003f90: 2069 7320 6030 602e 2053 696d 696c 6172   is `0`. Similar
-00003fa0: 6c79 2c20 7468 6520 7374 7265 616d 5c6e  ly, the stream\n
-00003fb0: 706f 7369 7469 6f6e 206f 6620 7468 6520  position of the 
-00003fc0: 7365 636f 6e64 2072 6563 6f72 6465 6420  second recorded 
-00003fd0: 6576 656e 7420 696e 2061 2073 7472 6561  event in a strea
-00003fe0: 6d20 6973 2060 3160 2c20 616e 6420 736f  m is `1`, and so
-00003ff0: 2077 6865 6e20 6170 7065 6e64 696e 6720   when appending 
-00004000: 7468 655c 6e74 6869 7264 206e 6577 2065  the\nthird new e
-00004010: 7665 6e74 2074 6f20 6120 7374 7265 616d  vent to a stream
-00004020: 2074 6861 7420 6861 7320 7477 6f20 7265   that has two re
-00004030: 636f 7264 6564 2065 7665 6e74 732c 2074  corded events, t
-00004040: 6865 2063 6f72 7265 6374 2076 616c 7565  he correct value
-00004050: 206f 6620 7468 655c 6e60 6578 7065 6374   of the\n`expect
-00004060: 6564 5f70 6f73 6974 696f 6e60 2061 7267  ed_position` arg
-00004070: 756d 656e 7420 6973 2060 3160 2e20 416e  ument is `1`. An
-00004080: 6420 736f 206f 6e2e 2e2e 2028 5468 6572  d so on... (Ther
-00004090: 6520 6973 2061 2074 6865 6f72 6574 6963  e is a theoretic
-000040a0: 616c 206d 6178 696d 756d 5c6e 6e75 6d62  al maximum\nnumb
-000040b0: 6572 206f 6620 7265 636f 7264 6564 2065  er of recorded e
-000040c0: 7665 6e74 7320 7468 6174 2061 6e79 2073  vents that any s
-000040d0: 7472 6561 6d20 6361 6e20 6861 7665 2c20  tream can have, 
-000040e0: 6275 7420 495c 276d 206e 6f74 2073 7572  but I\'m not sur
-000040f0: 6520 7768 6174 2069 7420 6973 3b5c 6e6d  e what it is;\nm
-00004100: 6179 6265 2039 2c32 3233 2c33 3732 2c30  aybe 9,223,372,0
-00004110: 3336 2c38 3534 2c37 3735 2c38 3037 2062  36,854,775,807 b
-00004120: 6563 6175 7365 2069 7420 6973 2069 6d70  ecause it is imp
-00004130: 6c65 6d65 6e74 6564 2061 7320 6120 606c  lemented as a `l
-00004140: 6f6e 6760 2069 6e20 4323 3f29 5c6e 5c6e  ong` in C#?)\n\n
-00004150: 4966 2074 6865 7265 2069 7320 6120 6d69  If there is a mi
-00004160: 736d 6174 6368 2062 6574 7765 656e 2074  smatch between t
-00004170: 6865 2067 6976 656e 2076 616c 7565 206f  he given value o
-00004180: 6620 7468 6520 6065 7870 6563 7465 645f  f the `expected_
-00004190: 706f 7369 7469 6f6e 6020 6172 6775 6d65  position` argume
-000041a0: 6e74 5c6e 616e 6420 7468 6520 706f 7369  nt\nand the posi
-000041b0: 7469 6f6e 206f 6620 7468 6520 6c61 7374  tion of the last
-000041c0: 2072 6563 6f72 6465 6420 6576 656e 7420   recorded event 
-000041d0: 696e 2061 2073 7472 6561 6d2c 2074 6865  in a stream, the
-000041e0: 6e20 616e 2060 4578 7065 6374 6564 506f  n an `ExpectedPo
-000041f0: 7369 7469 6f6e 4572 726f 7260 5c6e 6578  sitionError`\nex
-00004200: 6365 7074 696f 6e20 7769 6c6c 2062 6520  ception will be 
-00004210: 7261 6973 6564 2e20 5468 6973 2065 6666  raised. This eff
-00004220: 6563 7469 7665 6c79 2061 6363 6f6d 706c  ectively accompl
-00004230: 6973 6865 7320 6f70 7469 6d69 7374 6963  ishes optimistic
-00004240: 2063 6f6e 6375 7272 656e 6379 2063 6f6e   concurrency con
-00004250: 7472 6f6c 2e5c 6e5c 6e49 6620 796f 7520  trol.\n\nIf you 
-00004260: 7769 7368 2074 6f20 6469 7361 626c 6520  wish to disable 
-00004270: 6f70 7469 6d69 7374 6963 2063 6f6e 6375  optimistic concu
-00004280: 7272 656e 6379 2063 6f6e 7472 6f6c 2077  rrency control w
-00004290: 6865 6e20 6170 7065 6e64 696e 6720 6e65  hen appending ne
-000042a0: 7720 6576 656e 7473 2c20 796f 755c 6e63  w events, you\nc
-000042b0: 616e 2073 6574 2074 6865 2060 6578 7065  an set the `expe
-000042c0: 6374 6564 5f70 6f73 6974 696f 6e60 2074  cted_position` t
-000042d0: 6f20 6120 6e65 6761 7469 7665 2069 6e74  o a negative int
-000042e0: 6567 6572 2e5c 6e5c 6e49 6620 796f 7520  eger.\n\nIf you 
-000042f0: 6e65 6564 2074 6f20 6469 7363 6f76 6572  need to discover
-00004300: 2074 6865 2063 7572 7265 6e74 2070 6f73   the current pos
-00004310: 6974 696f 6e20 6f66 2074 6865 206c 6173  ition of the las
-00004320: 7420 7265 636f 7264 6564 2065 7665 6e74  t recorded event
-00004330: 2069 6e20 6120 7374 7265 616d 2c5c 6e79   in a stream,\ny
-00004340: 6f75 2063 616e 2075 7365 2074 6865 2060  ou can use the `
-00004350: 6765 745f 7374 7265 616d 5f70 6f73 6974  get_stream_posit
-00004360: 696f 6e28 2960 206d 6574 686f 6420 2873  ion()` method (s
-00004370: 6565 2062 656c 6f77 292e 5c6e 5c6e 506c  ee below).\n\nPl
-00004380: 6561 7365 206e 6f74 652c 2074 6865 2061  ease note, the a
-00004390: 7070 656e 6420 6576 656e 7473 206f 7065  ppend events ope
-000043a0: 7261 7469 6f6e 2069 7320 6174 6f6d 6963  ration is atomic
-000043b0: 2c20 736f 2074 6861 7420 6569 7468 6572  , so that either
-000043c0: 2061 6c6c 5c6e 6f72 206e 6f6e 6520 6f66   all\nor none of
-000043d0: 2074 6865 2067 6976 656e 206e 6577 2065   the given new e
-000043e0: 7665 6e74 7320 7769 6c6c 2062 6520 7265  vents will be re
-000043f0: 636f 7264 6564 2e20 4279 2064 6573 6967  corded. By desig
-00004400: 6e2c 2069 7420 6973 206f 6e6c 795c 6e70  n, it is only\np
-00004410: 6f73 7369 626c 6520 7769 7468 2045 7665  ossible with Eve
-00004420: 6e74 5374 6f72 6544 4220 746f 2061 746f  ntStoreDB to ato
-00004430: 6d69 6361 6c6c 7920 7265 636f 7264 206e  mically record n
-00004440: 6577 2065 7665 6e74 7320 696e 206f 6e65  ew events in one
-00004450: 2073 7472 6561 6d2e 5c6e 5c6e 496e 2074   stream.\n\nIn t
-00004460: 6865 2065 7861 6d70 6c65 2062 656c 6f77  he example below
-00004470: 2c20 6120 6e65 7720 6576 656e 7420 6973  , a new event is
-00004480: 2061 7070 656e 6465 6420 746f 2061 206e   appended to a n
-00004490: 6577 2073 7472 6561 6d2e 5c6e 5c6e 6060  ew stream.\n\n``
-000044a0: 6070 7974 686f 6e5c 6e66 726f 6d20 7575  `python\nfrom uu
-000044b0: 6964 2069 6d70 6f72 7420 7575 6964 345c  id import uuid4\
-000044c0: 6e5c 6e66 726f 6d20 6573 6462 636c 6965  n\nfrom esdbclie
-000044d0: 6e74 2069 6d70 6f72 7420 4e65 7745 7665  nt import NewEve
-000044e0: 6e74 5c6e 5c6e 2320 436f 6e73 7472 7563  nt\n\n# Construc
-000044f0: 7420 6e65 7720 6576 656e 7420 6f62 6a65  t new event obje
-00004500: 6374 2e5c 6e65 7665 6e74 3120 3d20 4e65  ct.\nevent1 = Ne
-00004510: 7745 7665 6e74 2874 7970 653d 5c27 4f72  wEvent(type=\'Or
-00004520: 6465 7243 7265 6174 6564 5c27 2c20 6461  derCreated\', da
-00004530: 7461 3d62 5c27 6461 7461 315c 2729 5c6e  ta=b\'data1\')\n
-00004540: 5c6e 2320 4465 6669 6e65 2073 7472 6561  \n# Define strea
-00004550: 6d20 6e61 6d65 2e5c 6e73 7472 6561 6d5f  m name.\nstream_
-00004560: 6e61 6d65 3120 3d20 7374 7228 7575 6964  name1 = str(uuid
-00004570: 3428 2929 5c6e 5c6e 2320 4170 7065 6e64  4())\n\n# Append
-00004580: 206c 6973 7420 6f66 2065 7665 6e74 7320   list of events 
-00004590: 746f 206e 6577 2073 7472 6561 6d2e 5c6e  to new stream.\n
-000045a0: 636f 6d6d 6974 5f70 6f73 6974 696f 6e31  commit_position1
-000045b0: 203d 2063 6c69 656e 742e 6170 7065 6e64   = client.append
-000045c0: 5f65 7665 6e74 7328 5c6e 2020 2020 7374  _events(\n    st
-000045d0: 7265 616d 5f6e 616d 653d 7374 7265 616d  ream_name=stream
-000045e0: 5f6e 616d 6531 2c5c 6e20 2020 2065 7870  _name1,\n    exp
-000045f0: 6563 7465 645f 706f 7369 7469 6f6e 3d4e  ected_position=N
-00004600: 6f6e 652c 5c6e 2020 2020 6576 656e 7473  one,\n    events
-00004610: 3d5b 6576 656e 7431 5d2c 5c6e 295c 6e60  =[event1],\n)\n`
-00004620: 6060 5c6e 5c6e 496e 2074 6865 2065 7861  ``\n\nIn the exa
-00004630: 6d70 6c65 2062 656c 6f77 2c20 7477 6f20  mple below, two 
-00004640: 7375 6273 6571 7565 6e74 2065 7665 6e74  subsequent event
-00004650: 7320 6172 6520 6170 7065 6e64 6564 2074  s are appended t
-00004660: 6f20 616e 2065 7869 7374 696e 675c 6e73  o an existing\ns
-00004670: 7472 6561 6d2e 5c6e 5c6e 6060 6070 7974  tream.\n\n```pyt
-00004680: 686f 6e5c 6e65 7665 6e74 3220 3d20 4e65  hon\nevent2 = Ne
-00004690: 7745 7665 6e74 2874 7970 653d 5c27 4f72  wEvent(type=\'Or
-000046a0: 6465 7255 7064 6174 6564 5c27 2c20 6461  derUpdated\', da
-000046b0: 7461 3d62 5c27 6461 7461 325c 2729 5c6e  ta=b\'data2\')\n
-000046c0: 6576 656e 7433 203d 204e 6577 4576 656e  event3 = NewEven
-000046d0: 7428 7479 7065 3d5c 274f 7264 6572 4465  t(type=\'OrderDe
-000046e0: 6c65 7465 645c 272c 2064 6174 613d 625c  leted\', data=b\
-000046f0: 2764 6174 6133 5c27 295c 6e5c 6e63 6f6d  'data3\')\n\ncom
-00004700: 6d69 745f 706f 7369 7469 6f6e 3220 3d20  mit_position2 = 
-00004710: 636c 6965 6e74 2e61 7070 656e 645f 6576  client.append_ev
-00004720: 656e 7473 285c 6e20 2020 2073 7472 6561  ents(\n    strea
-00004730: 6d5f 6e61 6d65 3d73 7472 6561 6d5f 6e61  m_name=stream_na
-00004740: 6d65 312c 5c6e 2020 2020 6578 7065 6374  me1,\n    expect
-00004750: 6564 5f70 6f73 6974 696f 6e3d 302c 5c6e  ed_position=0,\n
-00004760: 2020 2020 6576 656e 7473 3d5b 6576 656e      events=[even
-00004770: 7432 2c20 6576 656e 7433 5d2c 5c6e 295c  t2, event3],\n)\
-00004780: 6e60 6060 5c6e 5c6e 4966 2074 6865 206f  n```\n\nIf the o
-00004790: 7065 7261 7469 6f6e 2069 7320 7375 6363  peration is succ
-000047a0: 6573 7366 756c 2c20 7468 6973 206d 6574  essful, this met
-000047b0: 686f 6420 7265 7475 726e 7320 616e 2069  hod returns an i
-000047c0: 6e74 6567 6572 5c6e 7265 7072 6573 656e  nteger\nrepresen
-000047d0: 7469 6e67 2074 6865 206f 7665 7261 6c6c  ting the overall
-000047e0: 2022 636f 6d6d 6974 2070 6f73 6974 696f   "commit positio
-000047f0: 6e22 2061 7320 6974 2077 6173 2077 6865  n" as it was whe
-00004800: 6e20 7468 6520 6f70 6572 6174 696f 6e5c  n the operation\
-00004810: 6e77 6173 2063 6f6d 706c 6574 6564 2e20  nwas completed. 
-00004820: 4f74 6865 7277 6973 652c 2061 6e20 6578  Otherwise, an ex
-00004830: 6365 7074 696f 6e20 7769 6c6c 2062 6520  ception will be 
-00004840: 7261 6973 6564 2e5c 6e5c 6e41 2022 636f  raised.\n\nA "co
-00004850: 6d6d 6974 2070 6f73 6974 696f 6e22 2069  mmit position" i
-00004860: 7320 6120 6d6f 6e6f 746f 6e69 6361 6c6c  s a monotonicall
-00004870: 7920 696e 6372 6561 7369 6e67 2069 6e74  y increasing int
-00004880: 6567 6572 2072 6570 7265 7365 6e74 696e  eger representin
-00004890: 675c 6e74 6865 2070 6f73 6974 696f 6e20  g\nthe position 
-000048a0: 6f66 2074 6865 2072 6563 6f72 6465 6420  of the recorded 
-000048b0: 6576 656e 7420 696e 2061 2022 746f 7461  event in a "tota
-000048c0: 6c20 6f72 6465 7222 206f 6620 616c 6c20  l order" of all 
-000048d0: 7265 636f 7264 6564 5c6e 6576 656e 7473  recorded\nevents
-000048e0: 2069 6e20 7468 6520 6461 7461 6261 7365   in the database
-000048f0: 2061 6372 6f73 7320 616c 6c20 7374 7265   across all stre
-00004900: 616d 732e 2049 7420 6973 2074 6865 2061  ams. It is the a
-00004910: 6374 7561 6c20 706f 7369 7469 6f6e 5c6e  ctual position\n
-00004920: 6f66 2074 6865 2065 7665 6e74 2072 6563  of the event rec
-00004930: 6f72 6420 6f6e 2064 6973 6b2c 2061 6e64  ord on disk, and
-00004940: 2074 6865 7265 2061 7265 2075 7375 616c   there are usual
-00004950: 6c79 206c 6172 6765 2064 6966 6665 7265  ly large differe
-00004960: 6e63 6573 5c6e 6265 7477 6565 6e20 7375  nces\nbetween su
-00004970: 6363 6573 7369 7665 2063 6f6d 6d69 7473  ccessive commits
-00004980: 2e20 496e 2063 6f6e 7365 7175 656e 6365  . In consequence
-00004990: 2c20 7468 6520 7365 7175 656e 6365 206f  , the sequence o
-000049a0: 6620 636f 6d6d 6974 5c6e 706f 7369 7469  f commit\npositi
-000049b0: 6f6e 7320 6973 206e 6f74 2067 6170 6c65  ons is not gaple
-000049c0: 7373 2e20 496e 6465 6564 2c20 7468 6572  ss. Indeed, ther
-000049d0: 6520 6172 6520 7573 7561 6c6c 7920 6c61  e are usually la
-000049e0: 7267 6520 6469 6666 6572 656e 6365 735c  rge differences\
-000049f0: 6e62 6574 7765 656e 2074 6865 2063 6f6d  nbetween the com
-00004a00: 6d69 7420 706f 7369 7469 6f6e 7320 6f66  mit positions of
-00004a10: 2073 7563 6365 7373 6976 6520 7265 636f   successive reco
-00004a20: 7264 6564 2065 7665 6e74 732e 5c6e 5c6e  rded events.\n\n
-00004a30: 5468 6520 2263 6f6d 6d69 7420 706f 7369  The "commit posi
-00004a40: 7469 6f6e 2220 7265 7475 726e 6564 2062  tion" returned b
-00004a50: 7920 6061 7070 656e 645f 6576 656e 7473  y `append_events
-00004a60: 2829 6020 6973 2074 6861 7420 6f66 2074  ()` is that of t
-00004a70: 6865 206c 6173 745c 6e72 6563 6f72 6465  he last\nrecorde
-00004a80: 6420 6576 656e 7420 696e 2074 6865 2067  d event in the g
-00004a90: 6976 656e 2062 6174 6368 206f 6620 6e65  iven batch of ne
-00004aa0: 7720 6576 656e 7473 2e5c 6e5c 6e54 6865  w events.\n\nThe
-00004ab0: 2022 636f 6d6d 6974 2070 6f73 6974 696f   "commit positio
-00004ac0: 6e22 2072 6574 7572 6e65 6420 696e 2074  n" returned in t
-00004ad0: 6869 7320 7761 7920 6361 6e20 7468 6572  his way can ther
-00004ae0: 6566 6f72 6520 6265 2075 7365 6420 746f  efore be used to
-00004af0: 2077 6169 745c 6e66 6f72 2061 2064 6f77   wait\nfor a dow
-00004b00: 6e73 7472 6561 6d20 636f 6d70 6f6e 656e  nstream componen
-00004b10: 7420 746f 2068 6176 6520 7072 6f63 6573  t to have proces
-00004b20: 7365 6420 616c 6c20 7468 6520 6576 656e  sed all the even
-00004b30: 7473 2074 6861 7420 7765 7265 2072 6563  ts that were rec
-00004b40: 6f72 6465 642e 5c6e 5c6e 466f 7220 6578  orded.\n\nFor ex
-00004b50: 616d 706c 652c 2063 6f6e 7369 6465 7220  ample, consider 
-00004b60: 6120 7573 6572 2069 6e74 6572 6661 6365  a user interface
-00004b70: 2063 6f6d 6d61 6e64 2074 6861 7420 7265   command that re
-00004b80: 7375 6c74 7320 696e 2074 6865 2072 6563  sults in the rec
-00004b90: 6f72 6469 6e67 5c6e 6f66 206e 6577 2065  ording\nof new e
-00004ba0: 7665 6e74 732c 2061 6e64 2061 2071 7565  vents, and a que
-00004bb0: 7279 2069 6e74 6f20 616e 2065 7665 6e74  ry into an event
-00004bc0: 7561 6c6c 7920 636f 6e73 6973 7465 6e74  ually consistent
-00004bd0: 206d 6174 6572 6961 6c69 7a65 645c 6e76   materialized\nv
-00004be0: 6965 7720 696e 2061 2064 6f77 6e73 7472  iew in a downstr
-00004bf0: 6561 6d20 636f 6d70 6f6e 656e 7420 7468  eam component th
-00004c00: 6174 2069 7320 7570 6461 7465 6420 6672  at is updated fr
-00004c10: 6f6d 2074 6865 7365 2065 7665 6e74 732e  om these events.
-00004c20: 2049 6620 7468 6520 6e65 775c 6e65 7665   If the new\neve
-00004c30: 6e74 7320 6861 7665 206e 6f74 2079 6574  nts have not yet
-00004c40: 2062 6565 6e20 7072 6f63 6573 7365 642c   been processed,
-00004c50: 2074 6865 2076 6965 7720 776f 756c 6420   the view would 
-00004c60: 6265 2073 7461 6c65 2e20 5468 6520 2263  be stale. The "c
-00004c70: 6f6d 6d69 7420 706f 7369 7469 6f6e 225c  ommit position"\
-00004c80: 6e63 616e 2062 6520 7573 6564 2062 7920  ncan be used by 
-00004c90: 7468 6520 7573 6572 2069 6e74 6572 6661  the user interfa
-00004ca0: 6365 2074 6f20 706f 6c6c 2074 6865 2064  ce to poll the d
-00004cb0: 6f77 6e73 7472 6561 6d20 636f 6d70 6f6e  ownstream compon
-00004cc0: 656e 7420 756e 7469 6c20 6974 2068 6173  ent until it has
-00004cd0: 5c6e 7072 6f63 6573 7365 6420 7468 6f73  \nprocessed thos
-00004ce0: 6520 6e65 7720 6576 656e 7473 2c20 6166  e new events, af
-00004cf0: 7465 7220 7768 6963 6820 7469 6d65 2074  ter which time t
-00004d00: 6865 2076 6965 7720 7769 6c6c 206e 6f74  he view will not
-00004d10: 2062 6520 7374 616c 652e 5c6e 5c6e 5c6e   be stale.\n\n\n
-00004d20: 2323 2320 4170 7065 6e64 2065 7665 6e74  ### Append event
-00004d30: 5c6e 5c6e 2a72 6571 7569 7265 7320 6c65  \n\n*requires le
-00004d40: 6164 6572 2a5c 6e5c 6e54 6865 2060 6170  ader*\n\nThe `ap
-00004d50: 7065 6e64 5f65 7665 6e74 2829 6020 6d65  pend_event()` me
-00004d60: 7468 6f64 2063 616e 2062 6520 7573 6564  thod can be used
-00004d70: 2074 6f20 7772 6974 6520 6120 7369 6e67   to write a sing
-00004d80: 6c65 206e 6577 2065 7665 6e74 2074 6f20  le new event to 
-00004d90: 6120 7374 7265 616d 2e5c 6e5c 6e54 6872  a stream.\n\nThr
-00004da0: 6565 2061 7267 756d 656e 7473 2061 7265  ee arguments are
-00004db0: 2072 6571 7569 7265 642c 2060 7374 7265   required, `stre
-00004dc0: 616d 5f6e 616d 6560 2c20 6065 7870 6563  am_name`, `expec
-00004dd0: 7465 645f 706f 7369 7469 6f6e 6020 616e  ted_position` an
-00004de0: 6420 6065 7665 6e74 602e 5c6e 5c6e 5468  d `event`.\n\nTh
-00004df0: 6973 206d 6574 686f 6420 776f 726b 7320  is method works 
-00004e00: 696e 2074 6865 2073 616d 6520 7761 7920  in the same way 
-00004e10: 6173 2060 6170 7065 6e64 5f65 7665 6e74  as `append_event
-00004e20: 7328 2960 2c20 686f 7765 7665 7220 6065  s()`, however `e
-00004e30: 7665 6e74 6020 6973 2065 7870 6563 7465  vent` is expecte
-00004e40: 645c 6e74 6f20 6265 2061 2073 696e 676c  d\nto be a singl
-00004e50: 6520 604e 6577 4576 656e 7460 2e5c 6e5c  e `NewEvent`.\n\
-00004e60: 6e54 6869 7320 6d65 7468 6f64 2074 616b  nThis method tak
-00004e70: 6573 2061 6e20 6f70 7469 6f6e 616c 2060  es an optional `
-00004e80: 7469 6d65 6f75 7460 2061 7267 756d 656e  timeout` argumen
-00004e90: 742c 2077 6869 6368 2069 7320 6120 5079  t, which is a Py
-00004ea0: 7468 6f6e 2060 666c 6f61 7460 2074 6861  thon `float` tha
-00004eb0: 7420 7365 7473 5c6e 6120 6465 6164 6c69  t sets\na deadli
-00004ec0: 6e65 2066 6f72 2074 6865 2063 6f6d 706c  ne for the compl
-00004ed0: 6574 696f 6e20 6f66 2074 6865 2067 5250  etion of the gRP
-00004ee0: 4320 6f70 6572 6174 696f 6e2e 5c6e 5c6e  C operation.\n\n
-00004ef0: 5369 6e63 6520 7468 6520 6861 6e64 6c69  Since the handli
-00004f00: 6e67 206f 6620 6120 636f 6d6d 616e 6420  ng of a command 
-00004f10: 696e 2079 6f75 7220 6170 706c 6963 6174  in your applicat
-00004f20: 696f 6e20 6d61 7920 7265 7375 6c74 2069  ion may result i
-00004f30: 6e20 6f6e 6520 6f72 206d 616e 795c 6e6e  n one or many\nn
-00004f40: 6577 2065 7665 6e74 732c 2061 6e64 2074  ew events, and t
-00004f50: 6865 2072 6573 756c 7473 206f 6620 6861  he results of ha
-00004f60: 6e64 6c69 6e67 2061 2063 6f6d 6d61 6e64  ndling a command
-00004f70: 2073 686f 756c 6420 6265 2072 6563 6f72   should be recor
-00004f80: 6465 6420 6174 6f6d 6963 616c 6c79 2c5c  ded atomically,\
-00004f90: 6e61 6e64 2074 6865 2077 7269 7469 6e67  nand the writing
-00004fa0: 206f 6620 6e65 7720 6576 656e 7473 2067   of new events g
-00004fb0: 656e 6572 6174 6564 2062 7920 6120 636f  enerated by a co
-00004fc0: 6d6d 616e 6420 6861 6e64 6c65 7220 6973  mmand handler is
-00004fd0: 2075 7375 616c 6c79 2061 2063 6f6e 6365   usually a conce
-00004fe0: 726e 5c6e 7468 6174 2069 7320 6661 6374  rn\nthat is fact
-00004ff0: 6f72 6564 206f 7574 2061 6e64 2075 7365  ored out and use
-00005000: 6420 6576 6572 7977 6865 7265 2069 6e20  d everywhere in 
-00005010: 6120 7072 6f6a 6563 742c 2069 7420 6973  a project, it is
-00005020: 2071 7569 7465 2075 7375 616c 2069 6e20   quite usual in 
-00005030: 6120 7072 6f6a 6563 745c 6e74 6f20 6f6e  a project\nto on
-00005040: 6c79 2075 7365 2060 6170 7065 6e64 5f65  ly use `append_e
-00005050: 7665 6e74 7328 2960 2074 6f20 7265 636f  vents()` to reco
-00005060: 7264 206e 6577 2065 7665 6e74 732e 2046  rd new events. F
-00005070: 6f72 2074 6869 7320 7265 6173 6f6e 2c20  or this reason, 
-00005080: 616e 2065 7861 6d70 6c65 2069 735c 6e6e  an example is\nn
-00005090: 6f74 2070 726f 7669 6465 6420 6865 7265  ot provided here
-000050a0: 2e5c 6e5c 6e5c 6e23 2323 2049 6465 6d70  .\n\n\n### Idemp
-000050b0: 6f74 656e 7420 6170 7065 6e64 206f 7065  otent append ope
-000050c0: 7261 7469 6f6e 735c 6e5c 6e53 6f6d 6574  rations\n\nSomet
-000050d0: 696d 6573 2069 7420 6d61 7920 6861 7070  imes it may happ
-000050e0: 656e 2074 6861 7420 6120 6e65 7720 6576  en that a new ev
-000050f0: 656e 7420 6973 2073 7563 6365 7373 6675  ent is successfu
-00005100: 6c6c 7920 7265 636f 7264 6564 2061 6e64  lly recorded and
-00005110: 2074 6865 6e20 736f 6d65 686f 775c 6e74   then somehow\nt
-00005120: 6865 2063 6f6e 6e65 6374 696f 6e20 746f  he connection to
-00005130: 2074 6865 2064 6174 6162 6173 6520 6765   the database ge
-00005140: 7473 2069 6e74 6572 7275 7074 6564 2062  ts interrupted b
-00005150: 6566 6f72 6520 7468 6520 7375 6363 6573  efore the succes
-00005160: 7366 756c 2063 616c 6c20 6361 6e20 7265  sful call can re
-00005170: 7475 726e 5c6e 7375 6363 6573 7366 756c  turn\nsuccessful
-00005180: 6c79 2074 6f20 7468 6520 636c 6965 6e74  ly to the client
-00005190: 2e20 496e 2063 6173 6520 6f66 2061 6e20  . In case of an 
-000051a0: 6572 726f 7220 7768 656e 2061 7070 656e  error when appen
-000051b0: 6469 6e67 2061 6e20 6576 656e 742c 2069  ding an event, i
-000051c0: 7420 6d61 7920 6265 5c6e 6465 7369 7261  t may be\ndesira
-000051d0: 626c 6520 746f 2072 6574 7279 2061 7070  ble to retry app
-000051e0: 656e 6469 6e67 2074 6865 2073 616d 6520  ending the same 
-000051f0: 6576 656e 7420 6174 2074 6865 2073 616d  event at the sam
-00005200: 6520 706f 7369 7469 6f6e 2e20 4966 2074  e position. If t
-00005210: 6865 2065 7665 6e74 2077 6173 5c6e 696e  he event was\nin
-00005220: 2066 6163 7420 7375 6363 6573 7366 756c   fact successful
-00005230: 6c79 2072 6563 6f72 6465 642c 2069 7420  ly recorded, it 
-00005240: 6973 2063 6f6e 7665 6e69 656e 7420 666f  is convenient fo
-00005250: 7220 7468 6520 7265 7472 7920 746f 2072  r the retry to r
-00005260: 6574 7572 6e20 7375 6363 6573 7366 756c  eturn successful
-00005270: 6c79 5c6e 7769 7468 6f75 7420 7261 6973  ly\nwithout rais
-00005280: 696e 6720 616e 2065 7272 6f72 2064 7565  ing an error due
-00005290: 2074 6f20 6f70 7469 6d69 7374 6963 2063   to optimistic c
-000052a0: 6f6e 6375 7272 656e 6379 2063 6f6e 7472  oncurrency contr
-000052b0: 6f6c 2028 6173 2064 6573 6372 6962 6564  ol (as described
-000052c0: 2061 626f 7665 292e 5c6e 5c6e 5468 6520   above).\n\nThe 
-000052d0: 6578 616d 706c 6520 6265 6c6f 7720 7368  example below sh
-000052e0: 6f77 7320 7468 6520 6061 7070 656e 645f  ows the `append_
-000052f0: 6576 656e 7473 2829 6020 6d65 7468 6f64  events()` method
-00005300: 2062 6569 6e67 2063 616c 6c65 6420 6167   being called ag
-00005310: 6169 6e20 7769 7468 5c6e 6065 7665 6e74  ain with\n`event
-00005320: 3360 2061 6e64 2060 6578 7065 6374 6564  3` and `expected
-00005330: 5f70 6f73 6974 696f 6e3d 3260 2e20 5765  _position=2`. We
-00005340: 2063 616e 2073 6565 2074 6861 7420 7265   can see that re
-00005350: 7065 6174 696e 6720 7468 6520 6361 6c6c  peating the call
-00005360: 2074 6f5c 6e60 6170 7065 6e64 5f65 7665   to\n`append_eve
-00005370: 6e74 7328 2960 2072 6574 7572 6e73 2073  nts()` returns s
-00005380: 7563 6365 7373 6675 6c6c 792e 5c6e 5c6e  uccessfully.\n\n
-00005390: 6060 6070 7974 686f 6e5c 6e23 2052 6574  ```python\n# Ret
-000053a0: 7279 2061 7070 656e 6469 6e67 2065 7665  ry appending eve
-000053b0: 6e74 332e 5c6e 636f 6d6d 6974 5f70 6f73  nt3.\ncommit_pos
-000053c0: 6974 696f 6e5f 7265 7472 7920 3d20 636c  ition_retry = cl
-000053d0: 6965 6e74 2e61 7070 656e 645f 6576 656e  ient.append_even
-000053e0: 7473 285c 6e20 2020 2073 7472 6561 6d5f  ts(\n    stream_
-000053f0: 6e61 6d65 3d73 7472 6561 6d5f 6e61 6d65  name=stream_name
-00005400: 312c 5c6e 2020 2020 6578 7065 6374 6564  1,\n    expected
-00005410: 5f70 6f73 6974 696f 6e3d 302c 5c6e 2020  _position=0,\n  
-00005420: 2020 6576 656e 7473 3d5b 6576 656e 7432    events=[event2
-00005430: 2c20 6576 656e 7433 5d2c 5c6e 295c 6e60  , event3],\n)\n`
-00005440: 6060 5c6e 5c6e 5765 2063 616e 2073 6565  ``\n\nWe can see
-00005450: 2074 6861 7420 7468 6520 7361 6d65 2063   that the same c
-00005460: 6f6d 6d69 7420 706f 7369 7469 6f6e 2069  ommit position i
-00005470: 7320 7265 7475 726e 6564 2061 7320 6162  s returned as ab
-00005480: 6f76 652e 5c6e 5c6e 6060 6070 7974 686f  ove.\n\n```pytho
-00005490: 6e5c 6e61 7373 6572 7420 636f 6d6d 6974  n\nassert commit
-000054a0: 5f70 6f73 6974 696f 6e5f 7265 7472 7920  _position_retry 
-000054b0: 3d3d 2063 6f6d 6d69 745f 706f 7369 7469  == commit_positi
-000054c0: 6f6e 325c 6e60 6060 5c6e 5c6e 4279 2063  on2\n```\n\nBy c
-000054d0: 616c 6c69 6e67 2060 7265 6164 5f73 7472  alling `read_str
-000054e0: 6561 6d5f 6576 656e 7473 2829 602c 2077  eam_events()`, w
-000054f0: 6520 6361 6e20 616c 736f 2073 6565 2074  e can also see t
-00005500: 6865 2073 7472 6561 6d20 6861 7320 6265  he stream has be
-00005510: 656e 2075 6e63 6861 6e67 6564 5c6e 6465  en unchanged\nde
-00005520: 7370 6974 6520 7468 6520 6061 7070 656e  spite the `appen
-00005530: 645f 6576 656e 7473 2829 6020 6d65 7468  d_events()` meth
-00005540: 6f64 2068 6176 696e 6720 6265 656e 2063  od having been c
-00005550: 616c 6c65 6420 7477 6963 6520 7769 7468  alled twice with
-00005560: 2074 6865 2073 616d 6520 6172 6775 6d65   the same argume
-00005570: 6e74 732e 5c6e 5468 6174 2069 732c 2074  nts.\nThat is, t
-00005580: 6865 7265 2061 7265 2073 7469 6c6c 206f  here are still o
-00005590: 6e6c 7920 7468 7265 6520 6576 656e 7473  nly three events
-000055a0: 2069 6e20 7468 6520 7374 7265 616d 2e5c   in the stream.\
-000055b0: 6e5c 6e60 6060 7079 7468 6f6e 5c6e 6576  n\n```python\nev
-000055c0: 656e 7473 203d 2063 6c69 656e 742e 7265  ents = client.re
-000055d0: 6164 5f73 7472 6561 6d5f 6576 656e 7473  ad_stream_events
-000055e0: 285c 6e20 2020 2073 7472 6561 6d5f 6e61  (\n    stream_na
-000055f0: 6d65 3d73 7472 6561 6d5f 6e61 6d65 315c  me=stream_name1\
-00005600: 6e29 5c6e 5c6e 6173 7365 7274 206c 656e  n)\n\nassert len
-00005610: 2865 7665 6e74 7329 203d 3d20 335c 6e60  (events) == 3\n`
-00005620: 6060 5c6e 5c6e 5468 6973 2069 6465 6d70  ``\n\nThis idemp
-00005630: 6f74 656e 7420 6265 6861 7669 6f75 7220  otent behaviour 
-00005640: 6973 2061 6374 6976 6174 6564 2062 6563  is activated bec
-00005650: 6175 7365 2074 6865 2060 4e65 7745 7665  ause the `NewEve
-00005660: 6e74 6020 636c 6173 7320 6861 7320 616e  nt` class has an
-00005670: 2060 6964 605c 6e61 7474 7269 6275 7465   `id`\nattribute
-00005680: 2074 6861 742c 2062 7920 6465 6661 756c   that, by defaul
-00005690: 742c 2069 7320 6173 7369 676e 6564 2061  t, is assigned a
-000056a0: 206e 6577 2061 6e64 2075 6e69 7175 6520   new and unique 
-000056b0: 7665 7273 696f 6e2d 3420 5555 4944 2077  version-4 UUID w
-000056c0: 6865 6e20 616e 5c6e 696e 7374 616e 6365  hen an\ninstance
-000056d0: 206f 6620 604e 6577 4576 656e 7460 2069   of `NewEvent` i
-000056e0: 7320 636f 6e73 7472 7563 7465 642e 2049  s constructed. I
-000056f0: 6620 6576 656e 7473 2077 6974 6820 7468  f events with th
-00005700: 6520 7361 6d65 2060 6964 6020 6172 6520  e same `id` are 
-00005710: 6170 7065 6e64 6564 5c6e 6174 2074 6865  appended\nat the
-00005720: 2073 616d 6520 6065 7870 6563 7465 645f   same `expected_
-00005730: 706f 7369 7469 6f6e 602c 2074 6865 2073  position`, the s
-00005740: 7472 6561 6d20 7769 6c6c 2062 6520 756e  tream will be un
-00005750: 6368 616e 6765 642c 2074 6865 206f 7065  changed, the ope
-00005760: 7261 7469 6f6e 2077 696c 6c5c 6e63 6f6d  ration will\ncom
-00005770: 706c 6574 6520 7375 6363 6573 7366 756c  plete successful
-00005780: 6c79 2c20 616e 6420 7468 6520 7361 6d65  ly, and the same
-00005790: 2063 6f6d 6d69 7420 706f 7369 7469 6f6e   commit position
-000057a0: 2077 696c 6c20 6265 2072 6574 7572 6e65   will be returne
-000057b0: 6420 746f 2074 6865 2063 616c 6c65 722e  d to the caller.
-000057c0: 5c6e 5c6e 6060 6070 7974 686f 6e5c 6e66  \n\n```python\nf
-000057d0: 726f 6d20 7575 6964 2069 6d70 6f72 7420  rom uuid import 
-000057e0: 5555 4944 5c6e 5c6e 5c6e 6173 7365 7274  UUID\n\n\nassert
-000057f0: 2069 7369 6e73 7461 6e63 6528 6576 656e   isinstance(even
-00005800: 7431 2e69 642c 2055 5549 4429 5c6e 6173  t1.id, UUID)\nas
-00005810: 7365 7274 2069 7369 6e73 7461 6e63 6528  sert isinstance(
-00005820: 6576 656e 7432 2e69 642c 2055 5549 4429  event2.id, UUID)
-00005830: 5c6e 6173 7365 7274 2069 7369 6e73 7461  \nassert isinsta
-00005840: 6e63 6528 6576 656e 7433 2e69 642c 2055  nce(event3.id, U
-00005850: 5549 4429 5c6e 5c6e 6173 7365 7274 2065  UID)\n\nassert e
-00005860: 7665 6e74 312e 6964 2021 3d20 6576 656e  vent1.id != even
-00005870: 7432 2e69 645c 6e61 7373 6572 7420 6576  t2.id\nassert ev
-00005880: 656e 7432 2e69 6420 213d 2065 7665 6e74  ent2.id != event
-00005890: 332e 6964 5c6e 5c6e 6173 7365 7274 2065  3.id\n\nassert e
-000058a0: 7665 6e74 735b 305d 2e69 6420 3d3d 2065  vents[0].id == e
-000058b0: 7665 6e74 312e 6964 5c6e 6173 7365 7274  vent1.id\nassert
-000058c0: 2065 7665 6e74 735b 315d 2e69 6420 3d3d   events[1].id ==
-000058d0: 2065 7665 6e74 322e 6964 5c6e 6173 7365   event2.id\nasse
-000058e0: 7274 2065 7665 6e74 735b 325d 2e69 6420  rt events[2].id 
-000058f0: 3d3d 2065 7665 6e74 332e 6964 5c6e 6060  == event3.id\n``
-00005900: 605c 6e5c 6e49 7420 6973 2070 6f73 7369  `\n\nIt is possi
-00005910: 626c 6520 746f 2073 6574 2074 6865 2060  ble to set the `
-00005920: 6964 6020 636f 6e73 7472 7563 746f 7220  id` constructor 
-00005930: 6172 6775 6d65 6e74 206f 6620 604e 6577  argument of `New
-00005940: 4576 656e 7460 2077 6865 6e20 696e 7374  Event` when inst
-00005950: 616e 7469 6174 696e 675c 6e74 6865 2060  antiating\nthe `
-00005960: 4e65 7745 7665 6e74 6020 636c 6173 732c  NewEvent` class,
-00005970: 2062 7574 2069 6e20 7468 6520 6578 616d   but in the exam
-00005980: 706c 6573 2061 626f 7665 2077 6520 6861  ples above we ha
-00005990: 7665 2062 6565 6e20 7573 696e 6720 7468  ve been using th
-000059a0: 6520 6465 6661 756c 745c 6e62 6568 6176  e default\nbehav
-000059b0: 696f 7572 2c20 7768 6963 6820 6973 2074  iour, which is t
-000059c0: 6861 7420 7468 6520 6069 6460 2076 616c  hat the `id` val
-000059d0: 7565 2069 7320 6765 6e65 7261 7465 6420  ue is generated 
-000059e0: 7768 656e 2074 6865 2060 4e65 7745 7665  when the `NewEve
-000059f0: 6e74 6020 636c 6173 7320 6973 5c6e 696e  nt` class is\nin
-00005a00: 7374 616e 7469 6174 6564 2e5c 6e5c 6e5c  stantiated.\n\n\
-00005a10: 6e23 2323 2052 6561 6420 7374 7265 616d  n### Read stream
-00005a20: 2065 7665 6e74 735c 6e5c 6e54 6865 2060   events\n\nThe `
-00005a30: 7265 6164 5f73 7472 6561 6d5f 6576 656e  read_stream_even
-00005a40: 7473 2829 6020 6d65 7468 6f64 2063 616e  ts()` method can
-00005a50: 2062 6520 7573 6564 2074 6f20 6f62 7461   be used to obta
-00005a60: 696e 2074 6865 2072 6563 6f72 6465 6420  in the recorded 
-00005a70: 6576 656e 7473 2069 6e20 615c 6e73 7472  events in a\nstr
-00005a80: 6561 6d2e 2049 7420 7265 7475 726e 7320  eam. It returns 
-00005a90: 6120 7365 7175 656e 6365 206f 6620 7265  a sequence of re
-00005aa0: 636f 7264 6564 2065 7665 6e74 7320 6f62  corded events ob
-00005ab0: 6a65 6374 732e 2054 6865 2072 6563 6569  jects. The recei
-00005ac0: 7665 6420 7265 636f 7264 6564 2065 7665  ved recorded eve
-00005ad0: 6e74 5c6e 6f62 6a65 6374 2061 7265 2069  nt\nobject are i
-00005ae0: 6e73 7461 6e63 6573 206f 6620 7468 6520  nstances of the 
-00005af0: 6052 6563 6f72 6465 6445 7665 6e74 6020  `RecordedEvent` 
-00005b00: 636c 6173 7320 2873 6565 2062 656c 6f77  class (see below
-00005b10: 292e 5c6e 5c6e 5468 6973 206d 6574 686f  ).\n\nThis metho
-00005b20: 6420 6861 7320 6f6e 6520 7265 7175 6972  d has one requir
-00005b30: 6564 2061 7267 756d 656e 742c 2060 7374  ed argument, `st
-00005b40: 7265 616d 5f6e 616d 6560 2c20 7768 6963  ream_name`, whic
-00005b50: 6820 6973 2074 6865 206e 616d 6520 6f66  h is the name of
-00005b60: 5c6e 7468 6520 7374 7265 616d 2066 726f  \nthe stream fro
-00005b70: 6d20 7768 6963 6820 746f 2072 6561 6420  m which to read 
-00005b80: 6576 656e 7473 2e20 4279 2064 6566 6175  events. By defau
-00005b90: 6c74 2c20 7468 6520 7265 636f 7264 6564  lt, the recorded
-00005ba0: 2065 7665 6e74 7320 696e 2074 6865 5c6e   events in the\n
-00005bb0: 7374 7265 616d 2061 7265 2072 6574 7572  stream are retur
-00005bc0: 6e65 6420 696e 2074 6865 206f 7264 6572  ned in the order
-00005bd0: 2074 6865 7920 7765 7265 2072 6563 6f72   they were recor
-00005be0: 6465 642e 5c6e 5c6e 5468 6520 6d65 7468  ded.\n\nThe meth
-00005bf0: 6f64 2060 7265 6164 5f73 7472 6561 6d5f  od `read_stream_
-00005c00: 6576 656e 7473 2829 6020 616c 736f 2073  events()` also s
-00005c10: 7570 706f 7274 7320 666f 7572 206f 7074  upports four opt
-00005c20: 696f 6e61 6c20 6172 6775 6d65 6e74 732c  ional arguments,
-00005c30: 5c6e 6073 7472 6561 6d5f 706f 7369 7469  \n`stream_positi
-00005c40: 6f6e 602c 2060 6261 636b 7761 7264 7360  on`, `backwards`
-00005c50: 2c20 606c 696d 6974 602c 2061 6e64 2060  , `limit`, and `
-00005c60: 7469 6d65 6f75 7460 2e5c 6e5c 6e54 6865  timeout`.\n\nThe
-00005c70: 206f 7074 696f 6e61 6c20 6073 7472 6561   optional `strea
-00005c80: 6d5f 706f 7369 7469 6f6e 6020 6172 6775  m_position` argu
-00005c90: 6d65 6e74 2069 7320 616e 206f 7074 696f  ment is an optio
-00005ca0: 6e61 6c20 696e 7465 6765 7220 7468 6174  nal integer that
-00005cb0: 2063 616e 2062 6520 7573 6564 2074 6f5c   can be used to\
-00005cc0: 6e69 6e64 6963 6174 6520 7468 6520 706f  nindicate the po
-00005cd0: 7369 7469 6f6e 2069 6e20 7468 6520 7374  sition in the st
-00005ce0: 7265 616d 2066 726f 6d20 7768 6963 6820  ream from which 
-00005cf0: 746f 2073 7461 7274 2072 6561 6469 6e67  to start reading
-00005d00: 2e20 5468 6973 2061 7267 756d 656e 7420  . This argument 
-00005d10: 6973 5c6e 604e 6f6e 6560 2062 7920 6465  is\n`None` by de
-00005d20: 6661 756c 742c 2077 6869 6368 206d 6561  fault, which mea
-00005d30: 6e73 2074 6865 2073 7472 6561 6d20 7769  ns the stream wi
-00005d40: 6c6c 2062 6520 7265 6164 2065 6974 6865  ll be read eithe
-00005d50: 7220 6672 6f6d 2074 6865 2073 7461 7274  r from the start
-00005d60: 206f 6620 7468 655c 6e73 7472 6561 6d20   of the\nstream 
-00005d70: 2874 6865 2064 6566 6175 6c74 2062 6568  (the default beh
-00005d80: 6176 696f 7572 292c 206f 7220 6672 6f6d  aviour), or from
-00005d90: 2074 6865 2065 6e64 206f 6620 7468 6520   the end of the 
-00005da0: 7374 7265 616d 2069 6620 6062 6163 6b77  stream if `backw
-00005db0: 6172 6473 6020 6973 5c6e 6054 7275 6560  ards` is\n`True`
-00005dc0: 2028 7365 6520 6265 6c6f 7729 2e20 5768   (see below). Wh
-00005dd0: 656e 2072 6561 6469 6e67 2061 2073 7472  en reading a str
-00005de0: 6561 6d20 6672 6f6d 2061 2073 7065 6369  eam from a speci
-00005df0: 6669 6320 706f 7369 7469 6f6e 2069 6e20  fic position in 
-00005e00: 7468 6520 7374 7265 616d 2c20 7468 655c  the stream, the\
-00005e10: 6e72 6563 6f72 6465 6420 6576 656e 7420  nrecorded event 
-00005e20: 6174 2074 6861 7420 706f 7369 7469 6f6e  at that position
-00005e30: 2077 696c 6c20 6265 2069 6e63 6c75 6465   will be include
-00005e40: 642c 2062 6f74 6820 7768 656e 2072 6561  d, both when rea
-00005e50: 6469 6e67 2066 6f72 7761 7264 735c 6e66  ding forwards\nf
-00005e60: 726f 6d20 7468 6174 2070 6f73 6974 696f  rom that positio
-00005e70: 6e2c 2061 6e64 2077 6865 6e20 7265 6164  n, and when read
-00005e80: 696e 6720 6261 636b 7761 7264 7320 6672  ing backwards fr
-00005e90: 6f6d 2074 6861 7420 706f 7369 7469 6f6e  om that position
-00005ea0: 2e5c 6e5c 6e54 6865 206f 7074 696f 6e61  .\n\nThe optiona
-00005eb0: 6c20 6062 6163 6b77 6172 6473 6020 6172  l `backwards` ar
-00005ec0: 6775 6d65 6e74 2069 7320 6120 626f 6f6c  gument is a bool
-00005ed0: 6561 6e2c 2062 7920 6465 6661 756c 7420  ean, by default 
-00005ee0: 6046 616c 7365 602c 2077 6869 6368 206d  `False`, which m
-00005ef0: 6561 6e73 2074 6865 5c6e 7374 7265 616d  eans the\nstream
-00005f00: 2077 696c 6c20 6265 2072 6561 6420 666f   will be read fo
-00005f10: 7277 6172 6473 2062 7920 6465 6661 756c  rwards by defaul
-00005f20: 742c 2073 6f20 7468 6174 2065 7665 6e74  t, so that event
-00005f30: 7320 6172 6520 7265 7475 726e 6564 2069  s are returned i
-00005f40: 6e20 7468 655c 6e6f 7264 6572 2074 6865  n the\norder the
-00005f50: 7920 7765 7265 2061 7070 656e 6465 642c  y were appended,
-00005f60: 2049 6620 6062 6163 6b77 6172 6473 6020   If `backwards` 
-00005f70: 6973 2060 5472 7565 602c 2074 6865 2073  is `True`, the s
-00005f80: 7472 6561 6d20 7769 6c6c 2062 6520 7265  tream will be re
-00005f90: 6164 5c6e 6261 636b 7761 7264 732c 2073  ad\nbackwards, s
-00005fa0: 6f20 7468 6174 2065 7665 6e74 7320 6172  o that events ar
-00005fb0: 6520 7265 7475 726e 6564 2069 6e20 7265  e returned in re
-00005fc0: 7665 7273 6520 6f72 6465 722e 5c6e 5c6e  verse order.\n\n
-00005fd0: 5468 6520 6f70 7469 6f6e 616c 2060 6c69  The optional `li
-00005fe0: 6d69 7460 2061 7267 756d 656e 7420 6973  mit` argument is
-00005ff0: 2061 6e20 696e 7465 6765 7220 7768 6963   an integer whic
-00006000: 6820 6c69 6d69 7473 2074 6865 206e 756d  h limits the num
-00006010: 6265 7220 6f66 2065 7665 6e74 7320 7468  ber of events th
-00006020: 6174 2077 696c 6c5c 6e62 6520 7265 7475  at will\nbe retu
-00006030: 726e 6564 2e20 5468 6520 6465 6661 756c  rned. The defaul
-00006040: 7420 7661 6c75 6520 6973 2060 7379 732e  t value is `sys.
-00006050: 6d61 7869 6e74 602e 5c6e 5c6e 5468 6520  maxint`.\n\nThe 
-00006060: 6f70 7469 6f6e 616c 2060 7469 6d65 6f75  optional `timeou
-00006070: 7460 2061 7267 756d 656e 7420 6973 2061  t` argument is a
-00006080: 2050 7974 686f 6e20 6066 6c6f 6174 6020   Python `float` 
-00006090: 7768 6963 6820 7365 7473 2061 2064 6561  which sets a dea
-000060a0: 646c 696e 6520 666f 725c 6e74 6865 2063  dline for\nthe c
-000060b0: 6f6d 706c 6574 696f 6e20 6f66 2074 6865  ompletion of the
-000060c0: 2067 5250 4320 6f70 6572 6174 696f 6e2e   gRPC operation.
-000060d0: 5c6e 5c6e 5468 6520 6578 616d 706c 6520  \n\nThe example 
-000060e0: 6265 6c6f 7720 7368 6f77 7320 686f 7720  below shows how 
-000060f0: 746f 2072 6561 6420 7468 6520 7265 636f  to read the reco
-00006100: 7264 6564 2065 7665 6e74 7320 6f66 2061  rded events of a
-00006110: 2073 7472 6561 6d5c 6e66 6f72 7761 7264   stream\nforward
-00006120: 7320 6672 6f6d 2074 6865 2073 7461 7274  s from the start
-00006130: 206f 6620 7468 6520 7374 7265 616d 2074   of the stream t
-00006140: 6f20 7468 6520 656e 6420 6f66 2074 6865  o the end of the
-00006150: 2073 7472 6561 6d2e 2054 6865 5c6e 6e61   stream. The\nna
-00006160: 6d65 206f 6620 6120 7374 7265 616d 2069  me of a stream i
-00006170: 7320 6769 7665 6e20 7768 656e 2063 616c  s given when cal
-00006180: 6c69 6e67 2074 6865 206d 6574 686f 642e  ling the method.
-00006190: 5c6e 5c6e 6060 6070 7974 686f 6e5c 6e65  \n\n```python\ne
-000061a0: 7665 6e74 7320 3d20 636c 6965 6e74 2e72  vents = client.r
-000061b0: 6561 645f 7374 7265 616d 5f65 7665 6e74  ead_stream_event
-000061c0: 7328 5c6e 2020 2020 7374 7265 616d 5f6e  s(\n    stream_n
-000061d0: 616d 653d 7374 7265 616d 5f6e 616d 6531  ame=stream_name1
-000061e0: 5c6e 295c 6e60 6060 5c6e 5c6e 4e6f 7720  \n)\n```\n\nNow 
-000061f0: 7468 6174 2077 6520 6861 7665 2061 2073  that we have a s
-00006200: 6571 7565 6e63 6520 6f66 2065 7665 6e74  equence of event
-00006210: 206f 626a 6563 7473 2c20 7765 2063 616e   objects, we can
-00006220: 2063 6865 636b 2077 6520 676f 7420 7468   check we got th
-00006230: 655c 6e74 6872 6565 2065 7665 6e74 7320  e\nthree events 
-00006240: 7468 6174 2077 6572 6520 6170 7065 6e64  that were append
-00006250: 6564 2074 6f20 7468 6520 7374 7265 616d  ed to the stream
-00006260: 2c20 616e 6420 7468 6174 2074 6865 7920  , and that they 
-00006270: 6172 655c 6e6f 7264 6572 6564 2065 7861  are\nordered exa
-00006280: 6374 6c79 2061 7320 7468 6579 2077 6572  ctly as they wer
-00006290: 6520 6170 7065 6e64 6564 2e5c 6e5c 6e60  e appended.\n\n`
-000062a0: 6060 7079 7468 6f6e 5c6e 6173 7365 7274  ``python\nassert
-000062b0: 206c 656e 2865 7665 6e74 7329 203d 3d20   len(events) == 
-000062c0: 335c 6e5c 6e61 7373 6572 7420 6576 656e  3\n\nassert even
-000062d0: 7473 5b30 5d2e 7374 7265 616d 5f6e 616d  ts[0].stream_nam
-000062e0: 6520 3d3d 2073 7472 6561 6d5f 6e61 6d65  e == stream_name
-000062f0: 315c 6e61 7373 6572 7420 6576 656e 7473  1\nassert events
-00006300: 5b30 5d2e 7374 7265 616d 5f70 6f73 6974  [0].stream_posit
-00006310: 696f 6e20 3d3d 2030 5c6e 6173 7365 7274  ion == 0\nassert
-00006320: 2065 7665 6e74 735b 305d 2e74 7970 6520   events[0].type 
-00006330: 3d3d 2065 7665 6e74 312e 7479 7065 5c6e  == event1.type\n
-00006340: 6173 7365 7274 2065 7665 6e74 735b 305d  assert events[0]
-00006350: 2e64 6174 6120 3d3d 2065 7665 6e74 312e  .data == event1.
-00006360: 6461 7461 5c6e 5c6e 6173 7365 7274 2065  data\n\nassert e
-00006370: 7665 6e74 735b 315d 2e73 7472 6561 6d5f  vents[1].stream_
-00006380: 6e61 6d65 203d 3d20 7374 7265 616d 5f6e  name == stream_n
-00006390: 616d 6531 5c6e 6173 7365 7274 2065 7665  ame1\nassert eve
-000063a0: 6e74 735b 315d 2e73 7472 6561 6d5f 706f  nts[1].stream_po
-000063b0: 7369 7469 6f6e 203d 3d20 315c 6e61 7373  sition == 1\nass
-000063c0: 6572 7420 6576 656e 7473 5b31 5d2e 7479  ert events[1].ty
-000063d0: 7065 203d 3d20 6576 656e 7432 2e74 7970  pe == event2.typ
-000063e0: 655c 6e61 7373 6572 7420 6576 656e 7473  e\nassert events
-000063f0: 5b31 5d2e 6461 7461 203d 3d20 6576 656e  [1].data == even
-00006400: 7432 2e64 6174 615c 6e5c 6e61 7373 6572  t2.data\n\nasser
-00006410: 7420 6576 656e 7473 5b32 5d2e 7374 7265  t events[2].stre
-00006420: 616d 5f6e 616d 6520 3d3d 2073 7472 6561  am_name == strea
-00006430: 6d5f 6e61 6d65 315c 6e61 7373 6572 7420  m_name1\nassert 
-00006440: 6576 656e 7473 5b32 5d2e 7374 7265 616d  events[2].stream
-00006450: 5f70 6f73 6974 696f 6e20 3d3d 2032 5c6e  _position == 2\n
-00006460: 6173 7365 7274 2065 7665 6e74 735b 325d  assert events[2]
-00006470: 2e74 7970 6520 3d3d 2065 7665 6e74 332e  .type == event3.
-00006480: 7479 7065 5c6e 6173 7365 7274 2065 7665  type\nassert eve
-00006490: 6e74 735b 325d 2e64 6174 6120 3d3d 2065  nts[2].data == e
-000064a0: 7665 6e74 332e 6461 7461 5c6e 6060 605c  vent3.data\n```\
-000064b0: 6e5c 6e54 6865 2065 7861 6d70 6c65 2062  n\nThe example b
-000064c0: 656c 6f77 2073 686f 7773 2068 6f77 2074  elow shows how t
-000064d0: 6f20 7265 6164 2072 6563 6f72 6465 6420  o read recorded 
-000064e0: 6576 656e 7473 2069 6e20 6120 7374 7265  events in a stre
-000064f0: 616d 2066 6f72 7761 7264 7320 6672 6f6d  am forwards from
-00006500: 5c6e 6120 7370 6563 6966 6963 2073 7472  \na specific str
-00006510: 6561 6d20 706f 7369 7469 6f6e 2074 6f20  eam position to 
-00006520: 7468 6520 656e 6420 6f66 2074 6865 2073  the end of the s
-00006530: 7472 6561 6d2e 5c6e 5c6e 6060 6070 7974  tream.\n\n```pyt
-00006540: 686f 6e5c 6e65 7665 6e74 7320 3d20 636c  hon\nevents = cl
-00006550: 6965 6e74 2e72 6561 645f 7374 7265 616d  ient.read_stream
-00006560: 5f65 7665 6e74 7328 5c6e 2020 2020 7374  _events(\n    st
-00006570: 7265 616d 5f6e 616d 653d 7374 7265 616d  ream_name=stream
-00006580: 5f6e 616d 6531 2c5c 6e20 2020 2073 7472  _name1,\n    str
-00006590: 6561 6d5f 706f 7369 7469 6f6e 3d31 2c5c  eam_position=1,\
-000065a0: 6e29 5c6e 5c6e 6173 7365 7274 206c 656e  n)\n\nassert len
-000065b0: 2865 7665 6e74 7329 203d 3d20 325c 6e5c  (events) == 2\n\
-000065c0: 6e61 7373 6572 7420 6576 656e 7473 5b30  nassert events[0
-000065d0: 5d2e 7374 7265 616d 5f6e 616d 6520 3d3d  ].stream_name ==
-000065e0: 2073 7472 6561 6d5f 6e61 6d65 315c 6e61   stream_name1\na
-000065f0: 7373 6572 7420 6576 656e 7473 5b30 5d2e  ssert events[0].
-00006600: 7374 7265 616d 5f70 6f73 6974 696f 6e20  stream_position 
-00006610: 3d3d 2031 5c6e 6173 7365 7274 2065 7665  == 1\nassert eve
-00006620: 6e74 735b 305d 2e74 7970 6520 3d3d 2065  nts[0].type == e
-00006630: 7665 6e74 322e 7479 7065 5c6e 6173 7365  vent2.type\nasse
-00006640: 7274 2065 7665 6e74 735b 305d 2e64 6174  rt events[0].dat
-00006650: 6120 3d3d 2065 7665 6e74 322e 6461 7461  a == event2.data
-00006660: 5c6e 5c6e 6173 7365 7274 2065 7665 6e74  \n\nassert event
-00006670: 735b 315d 2e73 7472 6561 6d5f 6e61 6d65  s[1].stream_name
-00006680: 203d 3d20 7374 7265 616d 5f6e 616d 6531   == stream_name1
-00006690: 5c6e 6173 7365 7274 2065 7665 6e74 735b  \nassert events[
-000066a0: 315d 2e73 7472 6561 6d5f 706f 7369 7469  1].stream_positi
-000066b0: 6f6e 203d 3d20 325c 6e61 7373 6572 7420  on == 2\nassert 
-000066c0: 6576 656e 7473 5b31 5d2e 7479 7065 203d  events[1].type =
-000066d0: 3d20 6576 656e 7433 2e74 7970 655c 6e61  = event3.type\na
-000066e0: 7373 6572 7420 6576 656e 7473 5b31 5d2e  ssert events[1].
-000066f0: 6461 7461 203d 3d20 6576 656e 7433 2e64  data == event3.d
-00006700: 6174 615c 6e60 6060 5c6e 5c6e 5468 6520  ata\n```\n\nThe 
-00006710: 6578 616d 706c 6520 6265 6c6f 7720 7368  example below sh
-00006720: 6f77 7320 686f 7720 746f 2072 6561 6420  ows how to read 
-00006730: 7468 6520 7265 636f 7264 6564 2065 7665  the recorded eve
-00006740: 6e74 7320 696e 2061 2073 7472 6561 6d20  nts in a stream 
-00006750: 6261 636b 7761 7264 7320 6672 6f6d 5c6e  backwards from\n
-00006760: 7468 6520 656e 6420 6f66 2074 6865 2073  the end of the s
-00006770: 7472 6561 6d20 746f 2074 6865 2073 7461  tream to the sta
-00006780: 7274 206f 6620 7468 6520 7374 7265 616d  rt of the stream
-00006790: 2e5c 6e5c 6e60 6060 7079 7468 6f6e 5c6e  .\n\n```python\n
-000067a0: 6576 656e 7473 203d 2063 6c69 656e 742e  events = client.
-000067b0: 7265 6164 5f73 7472 6561 6d5f 6576 656e  read_stream_even
-000067c0: 7473 285c 6e20 2020 2073 7472 6561 6d5f  ts(\n    stream_
-000067d0: 6e61 6d65 3d73 7472 6561 6d5f 6e61 6d65  name=stream_name
-000067e0: 312c 5c6e 2020 2020 6261 636b 7761 7264  1,\n    backward
-000067f0: 733d 5472 7565 2c5c 6e29 5c6e 5c6e 6173  s=True,\n)\n\nas
-00006800: 7365 7274 206c 656e 2865 7665 6e74 7329  sert len(events)
-00006810: 203d 3d20 335c 6e5c 6e61 7373 6572 7420   == 3\n\nassert 
-00006820: 6576 656e 7473 5b30 5d2e 7374 7265 616d  events[0].stream
-00006830: 5f6e 616d 6520 3d3d 2073 7472 6561 6d5f  _name == stream_
-00006840: 6e61 6d65 315c 6e61 7373 6572 7420 6576  name1\nassert ev
-00006850: 656e 7473 5b30 5d2e 7374 7265 616d 5f70  ents[0].stream_p
-00006860: 6f73 6974 696f 6e20 3d3d 2032 5c6e 6173  osition == 2\nas
-00006870: 7365 7274 2065 7665 6e74 735b 305d 2e74  sert events[0].t
-00006880: 7970 6520 3d3d 2065 7665 6e74 332e 7479  ype == event3.ty
-00006890: 7065 5c6e 6173 7365 7274 2065 7665 6e74  pe\nassert event
-000068a0: 735b 305d 2e64 6174 6120 3d3d 2065 7665  s[0].data == eve
-000068b0: 6e74 332e 6461 7461 5c6e 5c6e 6173 7365  nt3.data\n\nasse
-000068c0: 7274 2065 7665 6e74 735b 315d 2e73 7472  rt events[1].str
-000068d0: 6561 6d5f 6e61 6d65 203d 3d20 7374 7265  eam_name == stre
-000068e0: 616d 5f6e 616d 6531 5c6e 6173 7365 7274  am_name1\nassert
-000068f0: 2065 7665 6e74 735b 315d 2e73 7472 6561   events[1].strea
-00006900: 6d5f 706f 7369 7469 6f6e 203d 3d20 315c  m_position == 1\
-00006910: 6e61 7373 6572 7420 6576 656e 7473 5b31  nassert events[1
-00006920: 5d2e 7479 7065 203d 3d20 6576 656e 7432  ].type == event2
-00006930: 2e74 7970 655c 6e61 7373 6572 7420 6576  .type\nassert ev
-00006940: 656e 7473 5b31 5d2e 6461 7461 203d 3d20  ents[1].data == 
-00006950: 6576 656e 7432 2e64 6174 615c 6e60 6060  event2.data\n```
-00006960: 5c6e 5c6e 5468 6520 6578 616d 706c 6520  \n\nThe example 
-00006970: 6265 6c6f 7720 7368 6f77 7320 686f 7720  below shows how 
-00006980: 746f 2072 6561 6420 6120 6c69 6d69 7465  to read a limite
-00006990: 6420 6e75 6d62 6572 2028 7477 6f29 206f  d number (two) o
-000069a0: 6620 7468 6520 7265 636f 7264 6564 2065  f the recorded e
-000069b0: 7665 6e74 735c 6e69 6e20 6120 7374 7265  vents\nin a stre
-000069c0: 616d 2066 6f72 7761 7264 7320 6672 6f6d  am forwards from
-000069d0: 2074 6865 2073 7461 7274 206f 6620 7468   the start of th
-000069e0: 6520 7374 7265 616d 2e5c 6e5c 6e60 6060  e stream.\n\n```
-000069f0: 7079 7468 6f6e 5c6e 6576 656e 7473 203d  python\nevents =
-00006a00: 2063 6c69 656e 742e 7265 6164 5f73 7472   client.read_str
-00006a10: 6561 6d5f 6576 656e 7473 285c 6e20 2020  eam_events(\n   
-00006a20: 2073 7472 6561 6d5f 6e61 6d65 3d73 7472   stream_name=str
-00006a30: 6561 6d5f 6e61 6d65 312c 5c6e 2020 2020  eam_name1,\n    
-00006a40: 6c69 6d69 743d 322c 5c6e 295c 6e5c 6e61  limit=2,\n)\n\na
-00006a50: 7373 6572 7420 6c65 6e28 6576 656e 7473  ssert len(events
-00006a60: 2920 3d3d 2032 5c6e 5c6e 6173 7365 7274  ) == 2\n\nassert
-00006a70: 2065 7665 6e74 735b 305d 2e73 7472 6561   events[0].strea
-00006a80: 6d5f 6e61 6d65 203d 3d20 7374 7265 616d  m_name == stream
-00006a90: 5f6e 616d 6531 5c6e 6173 7365 7274 2065  _name1\nassert e
-00006aa0: 7665 6e74 735b 305d 2e73 7472 6561 6d5f  vents[0].stream_
-00006ab0: 706f 7369 7469 6f6e 203d 3d20 305c 6e61  position == 0\na
-00006ac0: 7373 6572 7420 6576 656e 7473 5b30 5d2e  ssert events[0].
-00006ad0: 7479 7065 203d 3d20 6576 656e 7431 2e74  type == event1.t
-00006ae0: 7970 655c 6e61 7373 6572 7420 6576 656e  ype\nassert even
-00006af0: 7473 5b30 5d2e 6461 7461 203d 3d20 6576  ts[0].data == ev
-00006b00: 656e 7431 2e64 6174 615c 6e5c 6e61 7373  ent1.data\n\nass
-00006b10: 6572 7420 6576 656e 7473 5b31 5d2e 7374  ert events[1].st
-00006b20: 7265 616d 5f6e 616d 6520 3d3d 2073 7472  ream_name == str
-00006b30: 6561 6d5f 6e61 6d65 315c 6e61 7373 6572  eam_name1\nasser
-00006b40: 7420 6576 656e 7473 5b31 5d2e 7374 7265  t events[1].stre
-00006b50: 616d 5f70 6f73 6974 696f 6e20 3d3d 2031  am_position == 1
-00006b60: 5c6e 6173 7365 7274 2065 7665 6e74 735b  \nassert events[
-00006b70: 315d 2e74 7970 6520 3d3d 2065 7665 6e74  1].type == event
-00006b80: 322e 7479 7065 5c6e 6173 7365 7274 2065  2.type\nassert e
-00006b90: 7665 6e74 735b 315d 2e64 6174 6120 3d3d  vents[1].data ==
-00006ba0: 2065 7665 6e74 322e 6461 7461 5c6e 6060   event2.data\n``
-00006bb0: 605c 6e5c 6e54 6865 2065 7861 6d70 6c65  `\n\nThe example
-00006bc0: 2062 656c 6f77 2073 686f 7773 2068 6f77   below shows how
-00006bd0: 2074 6f20 7265 6164 2061 206c 696d 6974   to read a limit
-00006be0: 6564 206e 756d 6265 7220 286f 6e65 2920  ed number (one) 
-00006bf0: 6f66 2074 6865 2072 6563 6f72 6465 645c  of the recorded\
-00006c00: 6e65 7665 6e74 7320 696e 2061 2073 7472  nevents in a str
-00006c10: 6561 6d20 6261 636b 7761 7264 7320 6672  eam backwards fr
-00006c20: 6f6d 2061 2067 6976 656e 2073 7472 6561  om a given strea
-00006c30: 6d20 706f 7369 7469 6f6e 2e5c 6e5c 6e60  m position.\n\n`
-00006c40: 6060 7079 7468 6f6e 5c6e 6576 656e 7473  ``python\nevents
-00006c50: 203d 2063 6c69 656e 742e 7265 6164 5f73   = client.read_s
-00006c60: 7472 6561 6d5f 6576 656e 7473 285c 6e20  tream_events(\n 
-00006c70: 2020 2073 7472 6561 6d5f 6e61 6d65 3d73     stream_name=s
-00006c80: 7472 6561 6d5f 6e61 6d65 312c 5c6e 2020  tream_name1,\n  
-00006c90: 2020 7374 7265 616d 5f70 6f73 6974 696f    stream_positio
-00006ca0: 6e3d 322c 5c6e 2020 2020 6261 636b 7761  n=2,\n    backwa
-00006cb0: 7264 733d 5472 7565 2c5c 6e20 2020 206c  rds=True,\n    l
-00006cc0: 696d 6974 3d31 2c5c 6e29 5c6e 5c6e 6173  imit=1,\n)\n\nas
-00006cd0: 7365 7274 206c 656e 2865 7665 6e74 7329  sert len(events)
-00006ce0: 203d 3d20 315c 6e5c 6e61 7373 6572 7420   == 1\n\nassert 
-00006cf0: 6576 656e 7473 5b30 5d2e 7374 7265 616d  events[0].stream
-00006d00: 5f6e 616d 6520 3d3d 2073 7472 6561 6d5f  _name == stream_
-00006d10: 6e61 6d65 315c 6e61 7373 6572 7420 6576  name1\nassert ev
-00006d20: 656e 7473 5b30 5d2e 7374 7265 616d 5f70  ents[0].stream_p
-00006d30: 6f73 6974 696f 6e20 3d3d 2032 5c6e 6173  osition == 2\nas
-00006d40: 7365 7274 2065 7665 6e74 735b 305d 2e74  sert events[0].t
-00006d50: 7970 6520 3d3d 2065 7665 6e74 332e 7479  ype == event3.ty
-00006d60: 7065 5c6e 6173 7365 7274 2065 7665 6e74  pe\nassert event
-00006d70: 735b 305d 2e64 6174 6120 3d3d 2065 7665  s[0].data == eve
-00006d80: 6e74 332e 6461 7461 5c6e 6060 605c 6e5c  nt3.data\n```\n\
-00006d90: 6e23 2323 2052 6561 6420 616c 6c20 6576  n### Read all ev
-00006da0: 656e 7473 5c6e 5c6e 5468 6520 6d65 7468  ents\n\nThe meth
-00006db0: 6f64 2060 7265 6164 5f61 6c6c 5f65 7665  od `read_all_eve
-00006dc0: 6e74 7328 2960 2063 616e 2062 6520 7573  nts()` can be us
-00006dd0: 6564 2074 6f20 7265 6164 2061 6c6c 2072  ed to read all r
-00006de0: 6563 6f72 6465 6420 6576 656e 7473 5c6e  ecorded events\n
-00006df0: 696e 2074 6865 2064 6174 6162 6173 6520  in the database 
-00006e00: 696e 2074 6865 206f 7264 6572 2074 6865  in the order the
-00006e10: 7920 7765 7265 2072 6563 6f72 6465 642e  y were recorded.
-00006e20: 2049 7420 7265 7475 726e 7320 616e 2069   It returns an i
-00006e30: 7465 7261 626c 6520 6f66 5c6e 6576 656e  terable of\neven
-00006e40: 7473 2074 6861 7420 6861 7665 2062 6565  ts that have bee
-00006e50: 6e20 7265 636f 7264 6564 2069 6e20 7468  n recorded in th
-00006e60: 6520 6461 7461 6261 7365 2e20 4974 6572  e database. Iter
-00006e70: 6174 696e 6720 6f76 6572 2074 6869 7320  ating over this 
-00006e80: 6974 6572 6162 6c65 5c6e 6f62 6a65 6374  iterable\nobject
-00006e90: 2077 696c 6c20 7374 6f70 2077 6865 6e20   will stop when 
-00006ea0: 6974 2068 6173 2079 6965 6c64 6564 2074  it has yielded t
-00006eb0: 6865 206c 6173 7420 7265 636f 7264 6564  he last recorded
-00006ec0: 2065 7665 6e74 2e20 5468 6520 7265 6365   event. The rece
-00006ed0: 6976 6564 5c6e 7265 636f 7264 6564 2065  ived\nrecorded e
-00006ee0: 7665 6e74 206f 626a 6563 7420 6172 6520  vent object are 
-00006ef0: 696e 7374 616e 6365 7320 6f66 2074 6865  instances of the
-00006f00: 2060 5265 636f 7264 6564 4576 656e 7460   `RecordedEvent`
-00006f10: 2063 6c61 7373 2028 7365 6520 6265 6c6f   class (see belo
-00006f20: 7729 2e5c 6e5c 6e54 6869 7320 6d65 7468  w).\n\nThis meth
-00006f30: 6f64 2073 7570 706f 7274 7320 7365 7665  od supports seve
-00006f40: 6e20 6f70 7469 6f6e 616c 2061 7267 756d  n optional argum
-00006f50: 656e 7473 2c20 6063 6f6d 6d69 745f 706f  ents, `commit_po
-00006f60: 7369 7469 6f6e 602c 2060 6261 636b 7761  sition`, `backwa
-00006f70: 7264 7360 2c5c 6e60 6669 6c74 6572 5f65  rds`,\n`filter_e
-00006f80: 7863 6c75 6465 602c 2060 6669 6c74 6572  xclude`, `filter
-00006f90: 5f69 6e63 6c75 6465 602c 2060 6669 6c74  _include`, `filt
-00006fa0: 6572 5f62 795f 7374 7265 616d 5f6e 616d  er_by_stream_nam
-00006fb0: 6560 2c20 606c 696d 6974 602c 2061 6e64  e`, `limit`, and
-00006fc0: 2060 7469 6d65 6f75 7460 2e5c 6e5c 6e54   `timeout`.\n\nT
-00006fd0: 6865 206f 7074 696f 6e61 6c20 6063 6f6d  he optional `com
-00006fe0: 6d69 745f 706f 7369 7469 6f6e 6020 6172  mit_position` ar
-00006ff0: 6775 6d65 6e74 2069 7320 616e 206f 7074  gument is an opt
-00007000: 696f 6e61 6c20 696e 7465 6765 7220 7468  ional integer th
-00007010: 6174 2063 616e 2062 6520 7573 6564 2074  at can be used t
-00007020: 6f5c 6e73 7065 6369 6679 2074 6865 2063  o\nspecify the c
-00007030: 6f6d 6d69 7420 706f 7369 7469 6f6e 2066  ommit position f
-00007040: 726f 6d20 7768 6963 6820 746f 2073 7461  rom which to sta
-00007050: 7274 2072 6561 6469 6e67 2e20 5468 6973  rt reading. This
-00007060: 2061 7267 756d 656e 7420 6973 2060 4e6f   argument is `No
-00007070: 6e65 6020 6279 5c6e 6465 6661 756c 742c  ne` by\ndefault,
-00007080: 206d 6561 6e69 6e67 2074 6861 7420 616c   meaning that al
-00007090: 6c20 7468 6520 6576 656e 7473 2077 696c  l the events wil
-000070a0: 6c20 6265 2072 6561 6420 6569 7468 6572  l be read either
-000070b0: 2066 726f 6d20 7468 6520 7374 6172 742c   from the start,
-000070c0: 206f 725c 6e66 726f 6d20 7468 6520 656e   or\nfrom the en
-000070d0: 6420 6966 2060 6261 636b 7761 7264 7360  d if `backwards`
-000070e0: 2069 7320 6054 7275 6560 2028 7365 6520   is `True` (see 
-000070f0: 6265 6c6f 7729 2e20 506c 6561 7365 206e  below). Please n
-00007100: 6f74 652c 2069 6620 7370 6563 6966 6965  ote, if specifie
-00007110: 642c 5c6e 7468 6520 7370 6563 6966 6965  d,\nthe specifie
-00007120: 6420 706f 7369 7469 6f6e 206d 7573 7420  d position must 
-00007130: 6265 2061 6e20 6163 7475 616c 6c79 2065  be an actually e
-00007140: 7869 7374 696e 6720 636f 6d6d 6974 2070  xisting commit p
-00007150: 6f73 6974 696f 6e2c 2062 6563 6175 7365  osition, because
-00007160: 5c6e 616e 7920 6f74 6865 7220 6e75 6d62  \nany other numb
-00007170: 6572 2077 696c 6c20 7265 7375 6c74 2069  er will result i
-00007180: 6e20 6120 7365 7276 6572 2065 7272 6f72  n a server error
-00007190: 2028 6174 206c 6561 7374 2069 6e20 4576   (at least in Ev
-000071a0: 656e 7453 746f 7265 4442 2076 3231 2e31  entStoreDB v21.1
-000071b0: 3029 2e5c 6e5c 6e54 6865 206f 7074 696f  0).\n\nThe optio
-000071c0: 6e61 6c20 6062 6163 6b77 6172 6473 6020  nal `backwards` 
-000071d0: 6172 6775 6d65 6e74 2069 7320 6120 626f  argument is a bo
-000071e0: 6f6c 6561 6e20 7768 6963 6820 6973 2062  olean which is b
-000071f0: 7920 6465 6661 756c 7420 6046 616c 7365  y default `False
-00007200: 6020 6d65 616e 696e 6720 7468 655c 6e65  ` meaning the\ne
-00007210: 7665 6e74 7320 7769 6c6c 2062 6520 7265  vents will be re
-00007220: 6164 2066 6f72 7761 7264 7320 6279 2064  ad forwards by d
-00007230: 6566 6175 6c74 2c20 736f 2074 6861 7420  efault, so that 
-00007240: 6576 656e 7473 2061 7265 2072 6574 7572  events are retur
-00007250: 6e65 6420 696e 2074 6865 5c6e 6f72 6465  ned in the\norde
-00007260: 7220 7468 6579 2077 6572 6520 636f 6d6d  r they were comm
-00007270: 6974 7465 642c 2049 6620 6062 6163 6b77  itted, If `backw
-00007280: 6172 6473 6020 6973 2060 5472 7565 602c  ards` is `True`,
-00007290: 2074 6865 2065 7665 6e74 7320 7769 6c6c   the events will
-000072a0: 2062 6520 7265 6164 5c6e 6261 636b 7761   be read\nbackwa
-000072b0: 7264 732c 2073 6f20 7468 6174 2065 7665  rds, so that eve
-000072c0: 6e74 7320 6172 6520 7265 7475 726e 6564  nts are returned
-000072d0: 2069 6e20 7265 7665 7273 6520 6f72 6465   in reverse orde
-000072e0: 722e 5c6e 5c6e 5468 6520 6f70 7469 6f6e  r.\n\nThe option
-000072f0: 616c 2060 6669 6c74 6572 5f65 7863 6c75  al `filter_exclu
-00007300: 6465 6020 6172 6775 6d65 6e74 2069 7320  de` argument is 
-00007310: 6120 7365 7175 656e 6365 206f 6620 7265  a sequence of re
-00007320: 6775 6c61 7220 6578 7072 6573 7369 6f6e  gular expression
-00007330: 7320 7468 6174 5c6e 6d61 7463 6820 7265  s that\nmatch re
-00007340: 636f 7264 6564 2065 7665 6e74 7320 7468  corded events th
-00007350: 6174 2073 686f 756c 6420 6e6f 7420 6265  at should not be
-00007360: 2069 6e63 6c75 6465 642e 2054 6869 7320   included. This 
-00007370: 6172 6775 6d65 6e74 2069 7320 6967 6e6f  argument is igno
-00007380: 7265 645c 6e69 6620 6066 696c 7465 725f  red\nif `filter_
-00007390: 696e 636c 7564 6560 2069 7320 7365 7420  include` is set 
-000073a0: 746f 2061 206e 6f6e 2d65 6d70 7479 2073  to a non-empty s
-000073b0: 6571 7565 6e63 652e 2042 7920 6465 6661  equence. By defa
-000073c0: 756c 742c 2074 6869 7320 6172 6775 6d65  ult, this argume
-000073d0: 6e74 2069 7320 7365 745c 6e74 6f20 6d61  nt is set\nto ma
-000073e0: 7463 6820 7468 6520 6576 656e 7420 7479  tch the event ty
-000073f0: 7065 7320 6f66 2022 7379 7374 656d 2065  pes of "system e
-00007400: 7665 6e74 7322 2c20 736f 2074 6861 7420  vents", so that 
-00007410: 4576 656e 7453 746f 7265 4442 2073 7973  EventStoreDB sys
-00007420: 7465 6d20 6576 656e 7473 5c6e 7769 6c6c  tem events\nwill
-00007430: 206e 6f74 206e 6f72 6d61 6c6c 7920 6265   not normally be
-00007440: 2069 6e63 6c75 6465 642e 2053 6565 2074   included. See t
-00007450: 6865 204e 6f74 6573 2073 6563 7469 6f6e  he Notes section
-00007460: 2062 656c 6f77 2066 6f72 206d 6f72 6520   below for more 
-00007470: 696e 666f 726d 6174 696f 6e5c 6e61 626f  information\nabo
-00007480: 7574 2066 696c 7465 7220 6578 7072 6573  ut filter expres
-00007490: 7369 6f6e 732e 5c6e 5c6e 5468 6520 6f70  sions.\n\nThe op
-000074a0: 7469 6f6e 616c 2060 6669 6c74 6572 5f69  tional `filter_i
-000074b0: 6e63 6c75 6465 6020 6172 6775 6d65 6e74  nclude` argument
-000074c0: 2069 7320 6120 7365 7175 656e 6365 206f   is a sequence o
-000074d0: 6620 7265 6775 6c61 7220 6578 7072 6573  f regular expres
-000074e0: 7369 6f6e 735c 6e74 6861 7420 6d61 7463  sions\nthat matc
-000074f0: 6820 7265 636f 7264 6564 2065 7665 6e74  h recorded event
-00007500: 7320 7468 6174 2073 686f 756c 6420 6265  s that should be
-00007510: 2069 6e63 6c75 6465 642e 2042 7920 6465   included. By de
-00007520: 6661 756c 742c 2074 6869 7320 6172 6775  fault, this argu
-00007530: 6d65 6e74 5c6e 6973 2061 6e20 656d 7074  ment\nis an empt
-00007540: 7920 7475 706c 652e 2049 6620 7468 6973  y tuple. If this
-00007550: 2061 7267 756d 656e 7420 6973 2073 6574   argument is set
-00007560: 2074 6f20 6120 6e6f 6e2d 656d 7074 7920   to a non-empty 
-00007570: 7365 7175 656e 6365 2c20 7468 655c 6e60  sequence, the\n`
-00007580: 6669 6c74 6572 5f65 7863 6c75 6465 6020  filter_exclude` 
-00007590: 6172 6775 6d65 6e74 2069 7320 6967 6e6f  argument is igno
-000075a0: 7265 642e 5c6e 5c6e 5468 6520 6f70 7469  red.\n\nThe opti
-000075b0: 6f6e 616c 2060 6669 6c74 6572 5f62 795f  onal `filter_by_
-000075c0: 7374 7265 616d 5f6e 616d 6560 2061 7267  stream_name` arg
-000075d0: 756d 656e 7420 6973 2061 2062 6f6f 6c65  ument is a boole
-000075e0: 616e 2076 616c 7565 2074 6861 7420 696e  an value that in
-000075f0: 6469 6361 7465 7320 7768 6574 6865 725c  dicates whether\
-00007600: 6e74 6865 2066 696c 7465 7220 7769 6c6c  nthe filter will
-00007610: 2061 7070 6c79 2074 6f20 6576 656e 7420   apply to event 
-00007620: 7479 7065 7320 6f72 2073 7472 6561 6d20  types or stream 
-00007630: 6e61 6d65 732e 2042 7920 6465 6661 756c  names. By defaul
-00007640: 742c 2074 6869 7320 7661 6c75 6520 6973  t, this value is
-00007650: 2060 4661 6c73 6560 5c6e 616e 6420 736f   `False`\nand so
-00007660: 2074 6865 2066 696c 7465 7269 6e67 2077   the filtering w
-00007670: 696c 6c20 6170 706c 7920 746f 2074 6865  ill apply to the
-00007680: 2065 7665 6e74 2074 7970 6520 7374 7269   event type stri
-00007690: 6e67 7320 6f66 2072 6563 6f72 6465 6420  ngs of recorded 
-000076a0: 6576 656e 7473 2e5c 6e5c 6e54 6865 206f  events.\n\nThe o
-000076b0: 7074 696f 6e61 6c20 606c 696d 6974 6020  ptional `limit` 
-000076c0: 6172 6775 6d65 6e74 2069 7320 616e 2069  argument is an i
-000076d0: 6e74 6567 6572 2077 6869 6368 206c 696d  nteger which lim
-000076e0: 6974 7320 7468 6520 6e75 6d62 6572 206f  its the number o
-000076f0: 6620 6576 656e 7473 2074 6861 7420 7769  f events that wi
-00007700: 6c6c 5c6e 6265 2072 6574 7572 6e65 642e  ll\nbe returned.
-00007710: 2054 6865 2064 6566 6175 6c74 2076 616c   The default val
-00007720: 7565 2069 7320 6073 7973 2e6d 6178 696e  ue is `sys.maxin
-00007730: 7460 2e5c 6e5c 6e54 6865 206f 7074 696f  t`.\n\nThe optio
-00007740: 6e61 6c20 6074 696d 656f 7574 6020 6172  nal `timeout` ar
-00007750: 6775 6d65 6e74 2069 7320 6120 5079 7468  gument is a Pyth
-00007760: 6f6e 2060 666c 6f61 7460 2077 6869 6368  on `float` which
-00007770: 2073 6574 7320 615c 6e64 6561 646c 696e   sets a\ndeadlin
-00007780: 6520 666f 7220 7468 6520 636f 6d70 6c65  e for the comple
-00007790: 7469 6f6e 206f 6620 7468 6520 6752 5043  tion of the gRPC
-000077a0: 206f 7065 7261 7469 6f6e 2e5c 6e5c 6e54   operation.\n\nT
-000077b0: 6865 2066 696c 7465 7269 6e67 206f 6620  he filtering of 
-000077c0: 6576 656e 7473 2069 7320 646f 6e65 206f  events is done o
-000077d0: 6e20 7468 6520 4576 656e 7453 746f 7265  n the EventStore
-000077e0: 4442 2073 6572 7665 722e 2054 6865 5c6e  DB server. The\n
-000077f0: 606c 696d 6974 6020 6172 6775 6d65 6e74  `limit` argument
-00007800: 2069 7320 6170 706c 6965 6420 6f6e 2074   is applied on t
-00007810: 6865 2073 6572 7665 7220 6166 7465 7220  he server after 
-00007820: 6669 6c74 6572 696e 672e 2053 6565 2062  filtering. See b
-00007830: 656c 6f77 2066 6f72 5c6e 6d6f 7265 2069  elow for\nmore i
-00007840: 6e66 6f72 6d61 7469 6f6e 2061 626f 7574  nformation about
-00007850: 2066 696c 7465 7220 7265 6775 6c61 7220   filter regular 
-00007860: 6578 7072 6573 7369 6f6e 732e 5c6e 5c6e  expressions.\n\n
-00007870: 5768 656e 2072 6561 6469 6e67 2066 6f72  When reading for
-00007880: 7761 7264 7320 6672 6f6d 2061 2073 7065  wards from a spe
-00007890: 6369 6669 6320 636f 6d6d 6974 2070 6f73  cific commit pos
-000078a0: 6974 696f 6e2c 2074 6865 2065 7665 6e74  ition, the event
-000078b0: 2061 7420 7468 6520 7370 6563 6966 6965   at the specifie
-000078c0: 645c 6e70 6f73 6974 696f 6e20 5749 4c4c  d\nposition WILL
-000078d0: 2062 6520 696e 636c 7564 6564 2e20 486f   be included. Ho
-000078e0: 7765 7665 722c 2077 6865 6e20 7265 6164  wever, when read
-000078f0: 696e 6720 6261 636b 7761 7264 732c 2074  ing backwards, t
-00007900: 6865 2065 7665 6e74 2061 7420 7468 655c  he event at the\
-00007910: 6e73 7065 6369 6669 6564 2070 6f73 6974  nspecified posit
-00007920: 696f 6e20 7769 6c6c 204e 4f54 2062 6520  ion will NOT be 
-00007930: 696e 636c 7564 6564 2e20 2854 6869 7320  included. (This 
-00007940: 6e6f 6e2d 696e 636c 7573 6976 6520 6265  non-inclusive be
-00007950: 6861 7669 6f75 722c 206f 6620 6578 636c  haviour, of excl
-00007960: 7564 696e 675c 6e74 6865 2073 7065 6369  uding\nthe speci
-00007970: 6669 6564 2063 6f6d 6d69 7420 706f 7369  fied commit posi
-00007980: 7469 6f6e 2077 6865 6e20 7265 6164 696e  tion when readin
-00007990: 6720 616c 6c20 7374 7265 616d 7320 6261  g all streams ba
-000079a0: 636b 7761 7264 732c 2064 6966 6665 7273  ckwards, differs
-000079b0: 2066 726f 6d20 7468 655c 6e62 6568 6176   from the\nbehav
-000079c0: 696f 7572 2077 6865 6e20 7265 6164 696e  iour when readin
-000079d0: 6720 6120 7374 7265 616d 2062 6163 6b77  g a stream backw
-000079e0: 6172 6473 2066 726f 6d20 6120 7370 6563  ards from a spec
-000079f0: 6966 6963 2073 7472 6561 6d20 706f 7369  ific stream posi
-00007a00: 7469 6f6e 2e29 5c6e 5c6e 5468 6520 6578  tion.)\n\nThe ex
-00007a10: 616d 706c 6520 6265 6c6f 7720 7368 6f77  ample below show
-00007a20: 7320 686f 7720 746f 2072 6561 6420 616c  s how to read al
-00007a30: 6c20 6576 656e 7473 2069 6e20 7468 6520  l events in the 
-00007a40: 6461 7461 6261 7365 2069 6e20 7468 655c  database in the\
-00007a50: 6e6f 7264 6572 2074 6865 7920 7765 7265  norder they were
-00007a60: 2072 6563 6f72 6465 642e 5c6e 5c6e 6060   recorded.\n\n``
-00007a70: 6070 7974 686f 6e5c 6e65 7665 6e74 7320  `python\nevents 
-00007a80: 3d20 6c69 7374 2863 6c69 656e 742e 7265  = list(client.re
-00007a90: 6164 5f61 6c6c 5f65 7665 6e74 7328 2929  ad_all_events())
-00007aa0: 5c6e 5c6e 6173 7365 7274 206c 656e 2865  \n\nassert len(e
-00007ab0: 7665 6e74 7329 203e 3d20 335c 6e60 6060  vents) >= 3\n```
-00007ac0: 5c6e 5c6e 5468 6520 6578 616d 706c 6520  \n\nThe example 
-00007ad0: 6265 6c6f 7720 7368 6f77 7320 686f 7720  below shows how 
-00007ae0: 746f 2072 6561 6420 616c 6c20 7265 636f  to read all reco
-00007af0: 7264 6564 2065 7665 6e74 7320 6672 6f6d  rded events from
-00007b00: 2061 2073 7065 6369 6669 6320 636f 6d6d   a specific comm
-00007b10: 6974 2070 6f73 6974 696f 6e2e 5c6e 5c6e  it position.\n\n
-00007b20: 6060 6070 7974 686f 6e5c 6e65 7665 6e74  ```python\nevent
-00007b30: 7320 3d20 6c69 7374 285c 6e20 2020 2063  s = list(\n    c
-00007b40: 6c69 656e 742e 7265 6164 5f61 6c6c 5f65  lient.read_all_e
-00007b50: 7665 6e74 7328 5c6e 2020 2020 2020 2020  vents(\n        
-00007b60: 636f 6d6d 6974 5f70 6f73 6974 696f 6e3d  commit_position=
-00007b70: 636f 6d6d 6974 5f70 6f73 6974 696f 6e31  commit_position1
-00007b80: 5c6e 2020 2020 295c 6e29 5c6e 5c6e 6173  \n    )\n)\n\nas
-00007b90: 7365 7274 206c 656e 2865 7665 6e74 7329  sert len(events)
-00007ba0: 203d 3d20 335c 6e5c 6e61 7373 6572 7420   == 3\n\nassert 
-00007bb0: 6576 656e 7473 5b30 5d2e 7374 7265 616d  events[0].stream
-00007bc0: 5f6e 616d 6520 3d3d 2073 7472 6561 6d5f  _name == stream_
-00007bd0: 6e61 6d65 315c 6e61 7373 6572 7420 6576  name1\nassert ev
-00007be0: 656e 7473 5b30 5d2e 7374 7265 616d 5f70  ents[0].stream_p
-00007bf0: 6f73 6974 696f 6e20 3d3d 2030 5c6e 6173  osition == 0\nas
-00007c00: 7365 7274 2065 7665 6e74 735b 305d 2e74  sert events[0].t
-00007c10: 7970 6520 3d3d 2065 7665 6e74 312e 7479  ype == event1.ty
-00007c20: 7065 5c6e 6173 7365 7274 2065 7665 6e74  pe\nassert event
-00007c30: 735b 305d 2e64 6174 6120 3d3d 2065 7665  s[0].data == eve
-00007c40: 6e74 312e 6461 7461 5c6e 5c6e 6173 7365  nt1.data\n\nasse
-00007c50: 7274 2065 7665 6e74 735b 315d 2e73 7472  rt events[1].str
-00007c60: 6561 6d5f 6e61 6d65 203d 3d20 7374 7265  eam_name == stre
-00007c70: 616d 5f6e 616d 6531 5c6e 6173 7365 7274  am_name1\nassert
-00007c80: 2065 7665 6e74 735b 315d 2e73 7472 6561   events[1].strea
-00007c90: 6d5f 706f 7369 7469 6f6e 203d 3d20 315c  m_position == 1\
-00007ca0: 6e61 7373 6572 7420 6576 656e 7473 5b31  nassert events[1
-00007cb0: 5d2e 7479 7065 203d 3d20 6576 656e 7432  ].type == event2
-00007cc0: 2e74 7970 655c 6e61 7373 6572 7420 6576  .type\nassert ev
-00007cd0: 656e 7473 5b31 5d2e 6461 7461 203d 3d20  ents[1].data == 
-00007ce0: 6576 656e 7432 2e64 6174 615c 6e5c 6e61  event2.data\n\na
-00007cf0: 7373 6572 7420 6576 656e 7473 5b32 5d2e  ssert events[2].
-00007d00: 7374 7265 616d 5f6e 616d 6520 3d3d 2073  stream_name == s
-00007d10: 7472 6561 6d5f 6e61 6d65 315c 6e61 7373  tream_name1\nass
-00007d20: 6572 7420 6576 656e 7473 5b32 5d2e 7374  ert events[2].st
-00007d30: 7265 616d 5f70 6f73 6974 696f 6e20 3d3d  ream_position ==
-00007d40: 2032 5c6e 6173 7365 7274 2065 7665 6e74   2\nassert event
-00007d50: 735b 325d 2e74 7970 6520 3d3d 2065 7665  s[2].type == eve
-00007d60: 6e74 332e 7479 7065 5c6e 6173 7365 7274  nt3.type\nassert
-00007d70: 2065 7665 6e74 735b 325d 2e64 6174 6120   events[2].data 
-00007d80: 3d3d 2065 7665 6e74 332e 6461 7461 5c6e  == event3.data\n
-00007d90: 6060 605c 6e5c 6e54 6865 2065 7861 6d70  ```\n\nThe examp
-00007da0: 6c65 2062 656c 6f77 2073 686f 7773 2068  le below shows h
-00007db0: 6f77 2074 6f20 7265 6164 2061 6c6c 2072  ow to read all r
-00007dc0: 6563 6f72 6465 6420 6576 656e 7473 2069  ecorded events i
-00007dd0: 6e20 7265 7665 7273 6520 6f72 6465 722e  n reverse order.
-00007de0: 5c6e 5c6e 6060 6070 7974 686f 6e5c 6e65  \n\n```python\ne
-00007df0: 7665 6e74 7320 3d20 6c69 7374 285c 6e20  vents = list(\n 
-00007e00: 2020 2063 6c69 656e 742e 7265 6164 5f61     client.read_a
-00007e10: 6c6c 5f65 7665 6e74 7328 5c6e 2020 2020  ll_events(\n    
-00007e20: 2020 2020 6261 636b 7761 7264 733d 5472      backwards=Tr
-00007e30: 7565 5c6e 2020 2020 295c 6e29 5c6e 5c6e  ue\n    )\n)\n\n
-00007e40: 6173 7365 7274 206c 656e 2865 7665 6e74  assert len(event
-00007e50: 7329 203e 3d20 335c 6e5c 6e61 7373 6572  s) >= 3\n\nasser
-00007e60: 7420 6576 656e 7473 5b30 5d2e 7374 7265  t events[0].stre
-00007e70: 616d 5f6e 616d 6520 3d3d 2073 7472 6561  am_name == strea
-00007e80: 6d5f 6e61 6d65 315c 6e61 7373 6572 7420  m_name1\nassert 
-00007e90: 6576 656e 7473 5b30 5d2e 7374 7265 616d  events[0].stream
-00007ea0: 5f70 6f73 6974 696f 6e20 3d3d 2032 5c6e  _position == 2\n
-00007eb0: 6173 7365 7274 2065 7665 6e74 735b 305d  assert events[0]
-00007ec0: 2e74 7970 6520 3d3d 2065 7665 6e74 332e  .type == event3.
-00007ed0: 7479 7065 5c6e 6173 7365 7274 2065 7665  type\nassert eve
-00007ee0: 6e74 735b 305d 2e64 6174 6120 3d3d 2065  nts[0].data == e
-00007ef0: 7665 6e74 332e 6461 7461 5c6e 5c6e 6173  vent3.data\n\nas
-00007f00: 7365 7274 2065 7665 6e74 735b 315d 2e73  sert events[1].s
-00007f10: 7472 6561 6d5f 6e61 6d65 203d 3d20 7374  tream_name == st
-00007f20: 7265 616d 5f6e 616d 6531 5c6e 6173 7365  ream_name1\nasse
-00007f30: 7274 2065 7665 6e74 735b 315d 2e73 7472  rt events[1].str
-00007f40: 6561 6d5f 706f 7369 7469 6f6e 203d 3d20  eam_position == 
-00007f50: 315c 6e61 7373 6572 7420 6576 656e 7473  1\nassert events
-00007f60: 5b31 5d2e 7479 7065 203d 3d20 6576 656e  [1].type == even
-00007f70: 7432 2e74 7970 655c 6e61 7373 6572 7420  t2.type\nassert 
-00007f80: 6576 656e 7473 5b31 5d2e 6461 7461 203d  events[1].data =
-00007f90: 3d20 6576 656e 7432 2e64 6174 615c 6e5c  = event2.data\n\
-00007fa0: 6e61 7373 6572 7420 6576 656e 7473 5b32  nassert events[2
-00007fb0: 5d2e 7374 7265 616d 5f6e 616d 6520 3d3d  ].stream_name ==
-00007fc0: 2073 7472 6561 6d5f 6e61 6d65 315c 6e61   stream_name1\na
-00007fd0: 7373 6572 7420 6576 656e 7473 5b32 5d2e  ssert events[2].
-00007fe0: 7374 7265 616d 5f70 6f73 6974 696f 6e20  stream_position 
-00007ff0: 3d3d 2030 5c6e 6173 7365 7274 2065 7665  == 0\nassert eve
-00008000: 6e74 735b 325d 2e74 7970 6520 3d3d 2065  nts[2].type == e
-00008010: 7665 6e74 312e 7479 7065 5c6e 6173 7365  vent1.type\nasse
-00008020: 7274 2065 7665 6e74 735b 325d 2e64 6174  rt events[2].dat
-00008030: 6120 3d3d 2065 7665 6e74 312e 6461 7461  a == event1.data
-00008040: 5c6e 6060 605c 6e5c 6e54 6865 2065 7861  \n```\n\nThe exa
-00008050: 6d70 6c65 2062 656c 6f77 2073 686f 7773  mple below shows
-00008060: 2068 6f77 2074 6f20 7265 6164 2061 206c   how to read a l
-00008070: 696d 6974 6564 206e 756d 6265 7220 286f  imited number (o
-00008080: 6e65 2920 6f66 2074 6865 2072 6563 6f72  ne) of the recor
-00008090: 6465 6420 6576 656e 7473 5c6e 696e 2074  ded events\nin t
-000080a0: 6865 2064 6174 6162 6173 6520 666f 7277  he database forw
-000080b0: 6172 6473 2066 726f 6d20 6120 7370 6563  ards from a spec
-000080c0: 6966 6963 2063 6f6d 6d69 7420 706f 7369  ific commit posi
-000080d0: 7469 6f6e 2e20 506c 6561 7365 206e 6f74  tion. Please not
-000080e0: 652c 2077 6865 6e20 7265 6164 696e 675c  e, when reading\
-000080f0: 6e61 6c6c 2065 7665 6e74 7320 666f 7277  nall events forw
-00008100: 6172 6473 2066 726f 6d20 6120 7370 6563  ards from a spec
-00008110: 6966 6963 2063 6f6d 6d69 7420 706f 7369  ific commit posi
-00008120: 7469 6f6e 2c20 7468 6520 6576 656e 7420  tion, the event 
-00008130: 6174 2074 6865 2073 7065 6369 6669 6564  at the specified
-00008140: 5c6e 706f 7369 7469 6f6e 2057 494c 4c20  \nposition WILL 
-00008150: 6265 2069 6e63 6c75 6465 642e 5c6e 5c6e  be included.\n\n
-00008160: 5c6e 6060 6070 7974 686f 6e5c 6e65 7665  \n```python\neve
-00008170: 6e74 7320 3d20 6c69 7374 285c 6e20 2020  nts = list(\n   
-00008180: 2063 6c69 656e 742e 7265 6164 5f61 6c6c   client.read_all
-00008190: 5f65 7665 6e74 7328 5c6e 2020 2020 2020  _events(\n      
-000081a0: 2020 636f 6d6d 6974 5f70 6f73 6974 696f    commit_positio
-000081b0: 6e3d 636f 6d6d 6974 5f70 6f73 6974 696f  n=commit_positio
-000081c0: 6e31 2c5c 6e20 2020 2020 2020 206c 696d  n1,\n        lim
-000081d0: 6974 3d31 2c5c 6e20 2020 2029 5c6e 295c  it=1,\n    )\n)\
-000081e0: 6e5c 6e61 7373 6572 7420 6c65 6e28 6576  n\nassert len(ev
-000081f0: 656e 7473 2920 3d3d 2031 5c6e 5c6e 6173  ents) == 1\n\nas
-00008200: 7365 7274 2065 7665 6e74 735b 305d 2e73  sert events[0].s
-00008210: 7472 6561 6d5f 6e61 6d65 203d 3d20 7374  tream_name == st
-00008220: 7265 616d 5f6e 616d 6531 5c6e 6173 7365  ream_name1\nasse
-00008230: 7274 2065 7665 6e74 735b 305d 2e73 7472  rt events[0].str
-00008240: 6561 6d5f 706f 7369 7469 6f6e 203d 3d20  eam_position == 
-00008250: 305c 6e61 7373 6572 7420 6576 656e 7473  0\nassert events
-00008260: 5b30 5d2e 7479 7065 203d 3d20 6576 656e  [0].type == even
-00008270: 7431 2e74 7970 655c 6e61 7373 6572 7420  t1.type\nassert 
-00008280: 6576 656e 7473 5b30 5d2e 6461 7461 203d  events[0].data =
-00008290: 3d20 6576 656e 7431 2e64 6174 615c 6e5c  = event1.data\n\
-000082a0: 6e61 7373 6572 7420 6576 656e 7473 5b30  nassert events[0
-000082b0: 5d2e 636f 6d6d 6974 5f70 6f73 6974 696f  ].commit_positio
-000082c0: 6e20 3d3d 2063 6f6d 6d69 745f 706f 7369  n == commit_posi
-000082d0: 7469 6f6e 315c 6e60 6060 5c6e 5c6e 5468  tion1\n```\n\nTh
-000082e0: 6520 6578 616d 706c 6520 6265 6c6f 7720  e example below 
-000082f0: 7368 6f77 7320 686f 7720 746f 2072 6561  shows how to rea
-00008300: 6420 6120 6c69 6d69 7465 6420 6e75 6d62  d a limited numb
-00008310: 6572 2028 6f6e 6529 206f 6620 7468 6520  er (one) of the 
-00008320: 7265 636f 7264 6564 2065 7665 6e74 735c  recorded events\
-00008330: 6e69 6e20 7468 6520 6461 7461 6261 7365  nin the database
-00008340: 2062 6163 6b77 6172 6473 2066 726f 6d20   backwards from 
-00008350: 7468 6520 656e 642e 2054 6869 7320 6769  the end. This gi
-00008360: 7665 7320 7468 6520 6c61 7374 2072 6563  ves the last rec
-00008370: 6f72 6465 6420 6576 656e 742e 5c6e 5c6e  orded event.\n\n
-00008380: 6060 6070 7974 686f 6e5c 6e65 7665 6e74  ```python\nevent
-00008390: 7320 3d20 6c69 7374 285c 6e20 2020 2063  s = list(\n    c
-000083a0: 6c69 656e 742e 7265 6164 5f61 6c6c 5f65  lient.read_all_e
-000083b0: 7665 6e74 7328 5c6e 2020 2020 2020 2020  vents(\n        
-000083c0: 6261 636b 7761 7264 733d 5472 7565 2c5c  backwards=True,\
-000083d0: 6e20 2020 2020 2020 206c 696d 6974 3d31  n        limit=1
-000083e0: 2c5c 6e20 2020 2029 5c6e 295c 6e5c 6e61  ,\n    )\n)\n\na
-000083f0: 7373 6572 7420 6c65 6e28 6576 656e 7473  ssert len(events
-00008400: 2920 3d3d 2031 5c6e 5c6e 6173 7365 7274  ) == 1\n\nassert
-00008410: 2065 7665 6e74 735b 305d 2e73 7472 6561   events[0].strea
-00008420: 6d5f 6e61 6d65 203d 3d20 7374 7265 616d  m_name == stream
-00008430: 5f6e 616d 6531 5c6e 6173 7365 7274 2065  _name1\nassert e
-00008440: 7665 6e74 735b 305d 2e73 7472 6561 6d5f  vents[0].stream_
-00008450: 706f 7369 7469 6f6e 203d 3d20 325c 6e61  position == 2\na
-00008460: 7373 6572 7420 6576 656e 7473 5b30 5d2e  ssert events[0].
-00008470: 7479 7065 203d 3d20 6576 656e 7433 2e74  type == event3.t
-00008480: 7970 655c 6e61 7373 6572 7420 6576 656e  ype\nassert even
-00008490: 7473 5b30 5d2e 6461 7461 203d 3d20 6576  ts[0].data == ev
-000084a0: 656e 7433 2e64 6174 615c 6e60 6060 5c6e  ent3.data\n```\n
-000084b0: 5c6e 5468 6520 6578 616d 706c 6520 6265  \nThe example be
-000084c0: 6c6f 7720 7368 6f77 7320 686f 7720 746f  low shows how to
-000084d0: 2072 6561 6420 6120 6c69 6d69 7465 6420   read a limited 
-000084e0: 6e75 6d62 6572 2028 6f6e 6529 206f 6620  number (one) of 
-000084f0: 7468 6520 7265 636f 7264 6564 2065 7665  the recorded eve
-00008500: 6e74 735c 6e69 6e20 7468 6520 6461 7461  nts\nin the data
-00008510: 6261 7365 2062 6163 6b77 6172 6473 2066  base backwards f
-00008520: 726f 6d20 6120 7370 6563 6966 6963 2063  rom a specific c
-00008530: 6f6d 6d69 7420 706f 7369 7469 6f6e 2e20  ommit position. 
-00008540: 506c 6561 7365 206e 6f74 652c 2077 6865  Please note, whe
-00008550: 6e20 7265 6164 696e 675c 6e61 6c6c 2065  n reading\nall e
-00008560: 7665 6e74 7320 6261 636b 7761 7264 7320  vents backwards 
-00008570: 6672 6f6d 2061 2073 7065 6369 6669 6320  from a specific 
-00008580: 636f 6d6d 6974 2070 6f73 6974 696f 6e2c  commit position,
-00008590: 2074 6865 2065 7665 6e74 2061 7420 7468   the event at th
-000085a0: 6520 7370 6563 6966 6965 645c 6e70 6f73  e specified\npos
-000085b0: 6974 696f 6e20 5749 4c4c 204e 4f54 2062  ition WILL NOT b
-000085c0: 6520 696e 636c 7564 6564 2e5c 6e5c 6e60  e included.\n\n`
-000085d0: 6060 7079 7468 6f6e 5c6e 6576 656e 7473  ``python\nevents
-000085e0: 203d 206c 6973 7428 5c6e 2020 2020 636c   = list(\n    cl
-000085f0: 6965 6e74 2e72 6561 645f 616c 6c5f 6576  ient.read_all_ev
-00008600: 656e 7473 285c 6e20 2020 2020 2020 2063  ents(\n        c
-00008610: 6f6d 6d69 745f 706f 7369 7469 6f6e 3d63  ommit_position=c
-00008620: 6f6d 6d69 745f 706f 7369 7469 6f6e 322c  ommit_position2,
-00008630: 5c6e 2020 2020 2020 2020 6261 636b 7761  \n        backwa
-00008640: 7264 733d 5472 7565 2c5c 6e20 2020 2020  rds=True,\n     
-00008650: 2020 206c 696d 6974 3d31 2c5c 6e20 2020     limit=1,\n   
-00008660: 2029 5c6e 295c 6e5c 6e61 7373 6572 7420   )\n)\n\nassert 
-00008670: 6c65 6e28 6576 656e 7473 2920 3d3d 2031  len(events) == 1
-00008680: 5c6e 5c6e 6173 7365 7274 2065 7665 6e74  \n\nassert event
-00008690: 735b 305d 2e63 6f6d 6d69 745f 706f 7369  s[0].commit_posi
-000086a0: 7469 6f6e 203c 2063 6f6d 6d69 745f 706f  tion < commit_po
-000086b0: 7369 7469 6f6e 325c 6e60 6060 5c6e 5c6e  sition2\n```\n\n
-000086c0: 5c6e 2323 2320 4765 7420 6375 7272 656e  \n### Get curren
-000086d0: 7420 7374 7265 616d 2070 6f73 6974 696f  t stream positio
-000086e0: 6e5c 6e5c 6e54 6865 2060 6765 745f 7374  n\n\nThe `get_st
-000086f0: 7265 616d 5f70 6f73 6974 696f 6e28 2960  ream_position()`
-00008700: 206d 6574 686f 6420 6361 6e20 6265 2075   method can be u
-00008710: 7365 6420 746f 5c6e 6765 7420 7468 6520  sed to\nget the 
-00008720: 2273 7472 6561 6d20 706f 7369 7469 6f6e  "stream position
-00008730: 2220 6f66 2074 6865 206c 6173 7420 7265  " of the last re
-00008740: 636f 7264 6564 2065 7665 6e74 2069 6e20  corded event in 
-00008750: 6120 7374 7265 616d 2e5c 6e5c 6e54 6869  a stream.\n\nThi
-00008760: 7320 6d65 7468 6f64 2068 6173 2061 2060  s method has a `
-00008770: 7374 7265 616d 5f6e 616d 6560 2061 7267  stream_name` arg
-00008780: 756d 656e 742c 2077 6869 6368 2069 7320  ument, which is 
-00008790: 7265 7175 6972 6564 2e5c 6e5c 6e54 6869  required.\n\nThi
-000087a0: 7320 6d65 7468 6f64 2061 6c73 6f20 7461  s method also ta
-000087b0: 6b65 7320 616e 206f 7074 696f 6e61 6c20  kes an optional 
-000087c0: 6074 696d 656f 7574 6020 6172 6775 6d65  `timeout` argume
-000087d0: 6e74 2c20 7468 6174 5c6e 6973 2065 7870  nt, that\nis exp
-000087e0: 6563 7465 6420 746f 2062 6520 6120 5079  ected to be a Py
-000087f0: 7468 6f6e 2060 666c 6f61 7460 2c20 7768  thon `float`, wh
-00008800: 6963 6820 7365 7473 2061 2064 6561 646c  ich sets a deadl
-00008810: 696e 655c 6e66 6f72 2074 6865 2063 6f6d  ine\nfor the com
-00008820: 706c 6574 696f 6e20 6f66 2074 6865 2067  pletion of the g
-00008830: 5250 4320 6f70 6572 6174 696f 6e2e 5c6e  RPC operation.\n
-00008840: 5c6e 5468 6520 7365 7175 656e 6365 206f  \nThe sequence o
-00008850: 6620 706f 7369 7469 6f6e 7320 696e 2061  f positions in a
-00008860: 2073 7472 6561 6d20 6973 2067 6170 6c65   stream is gaple
-00008870: 7373 2e20 4974 2069 7320 7a65 726f 2d62  ss. It is zero-b
-00008880: 6173 6564 2c5c 6e73 6f20 7468 6174 2061  ased,\nso that a
-00008890: 2073 7472 6561 6d20 7769 7468 206f 6e65   stream with one
-000088a0: 2072 6563 6f72 6465 6420 6576 656e 7420   recorded event 
-000088b0: 6861 7320 6120 6375 7272 656e 7420 7374  has a current st
-000088c0: 7265 616d 5c6e 706f 7369 7469 6f6e 206f  ream\nposition o
-000088d0: 6620 6030 602e 2054 6865 2063 7572 7265  f `0`. The curre
-000088e0: 6e74 2073 7472 6561 6d20 706f 7369 7469  nt stream positi
-000088f0: 6f6e 2069 7320 6031 6020 7768 656e 2061  on is `1` when a
-00008900: 2073 7472 6561 6d20 6861 735c 6e74 776f   stream has\ntwo
-00008910: 2065 7665 6e74 732c 2061 6e64 2069 7420   events, and it 
-00008920: 6973 2060 3260 2077 6865 6e20 7468 6572  is `2` when ther
-00008930: 6520 6172 6520 6576 656e 7473 2c20 616e  e are events, an
-00008940: 6420 736f 206f 6e2e 5c6e 5c6e 496e 2074  d so on.\n\nIn t
-00008950: 6865 2065 7861 6d70 6c65 2062 656c 6f77  he example below
-00008960: 2c20 7468 6520 6375 7272 656e 7420 7374  , the current st
-00008970: 7265 616d 2070 6f73 6974 696f 6e20 6973  ream position is
-00008980: 206f 6274 6169 6e65 6420 6f66 2074 6865   obtained of the
-00008990: 5c6e 7374 7265 616d 2074 6f20 7768 6963  \nstream to whic
-000089a0: 6820 6576 656e 7473 2077 6572 6520 6170  h events were ap
-000089b0: 7065 6e64 6564 2069 6e20 7468 6520 6578  pended in the ex
-000089c0: 616d 706c 6573 2061 626f 7665 2e5c 6e42  amples above.\nB
-000089d0: 6563 6175 7365 2074 6865 2073 6571 7565  ecause the seque
-000089e0: 6e63 6520 6f66 2073 7472 6561 6d20 706f  nce of stream po
-000089f0: 7369 7469 6f6e 7320 6973 207a 6572 6f2d  sitions is zero-
-00008a00: 6261 7365 642c 2061 6e64 2062 6563 6175  based, and becau
-00008a10: 7365 5c6e 7468 7265 6520 6576 656e 7473  se\nthree events
-00008a20: 2077 6572 6520 6170 7065 6e64 6564 2c20   were appended, 
-00008a30: 736f 2074 6865 2063 7572 7265 6e74 2073  so the current s
-00008a40: 7472 6561 6d20 706f 7369 7469 6f6e 2069  tream position i
-00008a50: 7320 6032 602e 5c6e 5c6e 6060 6070 7974  s `2`.\n\n```pyt
-00008a60: 686f 6e5c 6e73 7472 6561 6d5f 706f 7369  hon\nstream_posi
-00008a70: 7469 6f6e 203d 2063 6c69 656e 742e 6765  tion = client.ge
-00008a80: 745f 7374 7265 616d 5f70 6f73 6974 696f  t_stream_positio
-00008a90: 6e28 5c6e 2020 2020 7374 7265 616d 5f6e  n(\n    stream_n
-00008aa0: 616d 653d 7374 7265 616d 5f6e 616d 6531  ame=stream_name1
-00008ab0: 5c6e 295c 6e5c 6e61 7373 6572 7420 7374  \n)\n\nassert st
-00008ac0: 7265 616d 5f70 6f73 6974 696f 6e20 3d3d  ream_position ==
-00008ad0: 2032 5c6e 6060 605c 6e5c 6e49 6620 6120   2\n```\n\nIf a 
-00008ae0: 7374 7265 616d 2064 6f65 7320 6e6f 7420  stream does not 
-00008af0: 6578 6973 742c 2074 6865 2072 6574 7572  exist, the retur
-00008b00: 6e65 6420 7374 7265 616d 2070 6f73 6974  ned stream posit
-00008b10: 696f 6e20 7661 6c75 6520 6973 2060 4e6f  ion value is `No
-00008b20: 6e65 602c 5c6e 7768 6963 6820 6d61 7463  ne`,\nwhich matc
-00008b30: 6865 7320 7468 6520 7265 7175 6972 6564  hes the required
-00008b40: 2065 7870 6563 7465 6420 706f 7369 7469   expected positi
-00008b50: 6f6e 2077 6865 6e20 6170 7065 6e64 696e  on when appendin
-00008b60: 6720 7468 6520 6669 7273 7420 6576 656e  g the first even
-00008b70: 745c 6e6f 6620 6120 6e65 7720 7374 7265  t\nof a new stre
-00008b80: 616d 2028 7365 6520 6162 6f76 6529 2e5c  am (see above).\
-00008b90: 6e5c 6e60 6060 7079 7468 6f6e 5c6e 7374  n\n```python\nst
-00008ba0: 7265 616d 5f70 6f73 6974 696f 6e20 3d20  ream_position = 
-00008bb0: 636c 6965 6e74 2e67 6574 5f73 7472 6561  client.get_strea
-00008bc0: 6d5f 706f 7369 7469 6f6e 285c 6e20 2020  m_position(\n   
-00008bd0: 2073 7472 6561 6d5f 6e61 6d65 3d73 7472   stream_name=str
-00008be0: 2875 7569 6434 2829 295c 6e29 5c6e 5c6e  (uuid4())\n)\n\n
-00008bf0: 6173 7365 7274 2073 7472 6561 6d5f 706f  assert stream_po
-00008c00: 7369 7469 6f6e 203d 3d20 4e6f 6e65 5c6e  sition == None\n
-00008c10: 6060 605c 6e5c 6e54 6869 7320 6d65 7468  ```\n\nThis meth
-00008c20: 6f64 2074 616b 6573 2061 6e20 6f70 7469  od takes an opti
-00008c30: 6f6e 616c 2061 7267 756d 656e 7420 6074  onal argument `t
-00008c40: 696d 656f 7574 6020 7768 6963 6820 6973  imeout` which is
-00008c50: 2061 2050 7974 686f 6e20 6066 6c6f 6174   a Python `float
-00008c60: 6020 7468 6174 2073 6574 735c 6e61 2064  ` that sets\na d
-00008c70: 6561 646c 696e 6520 666f 7220 7468 6520  eadline for the 
-00008c80: 636f 6d70 6c65 7469 6f6e 206f 6620 7468  completion of th
-00008c90: 6520 6752 5043 206f 7065 7261 7469 6f6e  e gRPC operation
-00008ca0: 2e5c 6e5c 6e5c 6e23 2323 2047 6574 2063  .\n\n\n### Get c
-00008cb0: 7572 7265 6e74 2063 6f6d 6d69 7420 706f  urrent commit po
-00008cc0: 7369 7469 6f6e 5c6e 5c6e 5468 6520 6d65  sition\n\nThe me
-00008cd0: 7468 6f64 2060 6765 745f 636f 6d6d 6974  thod `get_commit
-00008ce0: 5f70 6f73 6974 696f 6e28 2960 2063 616e  _position()` can
-00008cf0: 2062 6520 7573 6564 2074 6f20 6765 7420   be used to get 
-00008d00: 7468 6520 6375 7272 656e 745c 6e63 6f6d  the current\ncom
-00008d10: 6d69 7420 706f 7369 7469 6f6e 206f 6620  mit position of 
-00008d20: 7468 6520 6461 7461 6261 7365 2e5c 6e5c  the database.\n\
-00008d30: 6e60 6060 7079 7468 6f6e 5c6e 636f 6d6d  n```python\ncomm
-00008d40: 6974 5f70 6f73 6974 696f 6e20 3d20 636c  it_position = cl
-00008d50: 6965 6e74 2e67 6574 5f63 6f6d 6d69 745f  ient.get_commit_
-00008d60: 706f 7369 7469 6f6e 2829 5c6e 6060 605c  position()\n```\
-00008d70: 6e5c 6e54 6869 7320 6d65 7468 6f64 2074  n\nThis method t
-00008d80: 616b 6573 2061 6e20 6f70 7469 6f6e 616c  akes an optional
-00008d90: 2061 7267 756d 656e 7420 6074 696d 656f   argument `timeo
-00008da0: 7574 6020 7768 6963 6820 6973 2061 2050  ut` which is a P
-00008db0: 7974 686f 6e20 6066 6c6f 6174 6020 7468  ython `float` th
-00008dc0: 6174 2073 6574 735c 6e61 2064 6561 646c  at sets\na deadl
-00008dd0: 696e 6520 666f 7220 7468 6520 636f 6d70  ine for the comp
-00008de0: 6c65 7469 6f6e 206f 6620 7468 6520 6752  letion of the gR
-00008df0: 5043 206f 7065 7261 7469 6f6e 2e5c 6e5c  PC operation.\n\
-00008e00: 6e54 6869 7320 6d65 7468 6f64 2063 616e  nThis method can
-00008e10: 2062 6520 7573 6566 756c 2074 6f20 6d65   be useful to me
-00008e20: 6173 7572 6520 7072 6f67 7265 7373 206f  asure progress o
-00008e30: 6620 6120 646f 776e 7374 7265 616d 2063  f a downstream c
-00008e40: 6f6d 706f 6e65 6e74 5c6e 7468 6174 2069  omponent\nthat i
-00008e50: 7320 7072 6f63 6573 7369 6e67 2061 6c6c  s processing all
-00008e60: 2072 6563 6f72 6465 6420 6576 656e 7473   recorded events
-00008e70: 2c20 6279 2063 6f6d 7061 7269 6e67 2074  , by comparing t
-00008e80: 6865 2063 7572 7265 6e74 2063 6f6d 6d69  he current commi
-00008e90: 745c 6e70 6f73 6974 696f 6e20 7769 7468  t\nposition with
-00008ea0: 2074 6865 2072 6563 6f72 6465 6420 636f   the recorded co
-00008eb0: 6d6d 6974 2070 6f73 6974 696f 6e20 6f66  mmit position of
-00008ec0: 2074 6865 206c 6173 7420 7375 6363 6573   the last succes
-00008ed0: 7366 756c 6c79 2070 726f 6365 7373 6564  sfully processed
-00008ee0: 5c6e 6576 656e 7420 696e 2061 2064 6f77  \nevent in a dow
-00008ef0: 6e73 7472 6561 6d20 636f 6d70 6f6e 656e  nstream componen
-00008f00: 742e 5c6e 5c6e 5468 6520 7661 6c75 6520  t.\n\nThe value 
-00008f10: 6f66 2074 6865 2060 636f 6d6d 6974 5f70  of the `commit_p
-00008f20: 6f73 6974 696f 6e60 2061 7267 756d 656e  osition` argumen
-00008f30: 7420 7768 656e 2072 6561 6469 6e67 2065  t when reading e
-00008f40: 7665 6e74 7320 6569 7468 6572 2062 7920  vents either by 
-00008f50: 7573 696e 675c 6e74 6865 2060 7265 6164  using\nthe `read
-00008f60: 5f61 6c6c 5f65 7665 6e74 7328 2960 206d  _all_events()` m
-00008f70: 6574 686f 6420 6f72 2062 7920 7573 696e  ethod or by usin
-00008f80: 6720 6120 6361 7463 682d 7570 2073 7562  g a catch-up sub
-00008f90: 7363 7269 7074 696f 6e20 776f 756c 6420  scription would 
-00008fa0: 7573 7561 6c6c 795c 6e62 6520 6465 7465  usually\nbe dete
-00008fb0: 726d 696e 6564 2062 7920 7468 6520 7265  rmined by the re
-00008fc0: 636f 7264 6564 2063 6f6d 6d69 7420 706f  corded commit po
-00008fd0: 7369 7469 6f6e 206f 6620 7468 6520 6c61  sition of the la
-00008fe0: 7374 2073 7563 6365 7373 6675 6c6c 7920  st successfully 
-00008ff0: 7072 6f63 6573 7365 645c 6e65 7665 6e74  processed\nevent
-00009000: 2069 6e20 6120 646f 776e 7374 7265 616d   in a downstream
-00009010: 2063 6f6d 706f 6e65 6e74 2e5c 6e5c 6e5c   component.\n\n\
-00009020: 6e23 2323 2047 6574 2073 7472 6561 6d20  n### Get stream 
-00009030: 6d65 7461 6461 7461 5c6e 5c6e 5468 6520  metadata\n\nThe 
-00009040: 6d65 7468 6f64 2060 6765 745f 7374 7265  method `get_stre
-00009050: 616d 5f6d 6574 6164 6174 6128 2960 2067  am_metadata()` g
-00009060: 6574 7320 7468 6520 6d65 7461 6461 7461  ets the metadata
-00009070: 2066 6f72 2061 2073 7472 6561 6d2c 2061   for a stream, a
-00009080: 6c6f 6e67 5c6e 7769 7468 2074 6865 2076  long\nwith the v
-00009090: 6572 7369 6f6e 206f 6620 7468 6520 7374  ersion of the st
-000090a0: 7265 616d 206d 6574 6164 6174 612e 5c6e  ream metadata.\n
-000090b0: 5c6e 6060 6070 7974 686f 6e5c 6e6d 6574  \n```python\nmet
-000090c0: 6164 6174 612c 206d 6574 6164 6174 615f  adata, metadata_
-000090d0: 7665 7273 696f 6e20 3d20 636c 6965 6e74  version = client
-000090e0: 2e67 6574 5f73 7472 6561 6d5f 6d65 7461  .get_stream_meta
-000090f0: 6461 7461 2873 7472 6561 6d5f 6e61 6d65  data(stream_name
-00009100: 3d73 7472 6561 6d5f 6e61 6d65 3129 5c6e  =stream_name1)\n
-00009110: 6060 605c 6e5c 6e54 6865 2072 6574 7572  ```\n\nThe retur
-00009120: 6e65 6420 606d 6574 6164 6174 6160 2076  ned `metadata` v
-00009130: 616c 7565 2069 7320 6120 5079 7468 6f6e  alue is a Python
-00009140: 2060 6469 6374 602e 2054 6865 2072 6574   `dict`. The ret
-00009150: 7572 6e65 6420 606d 6574 6164 6174 615f  urned `metadata_
-00009160: 7665 7273 696f 6e60 5c6e 7661 6c75 6520  version`\nvalue 
-00009170: 6973 2065 6974 6865 7220 616e 2060 696e  is either an `in
-00009180: 7460 2c20 6f72 2060 4e6f 6e65 6020 6966  t`, or `None` if
-00009190: 2074 6865 2073 7472 6561 6d20 646f 6573   the stream does
-000091a0: 206e 6f74 2065 7869 7374 2e20 5468 6573   not exist. Thes
-000091b0: 6520 7661 6c75 6573 2063 616e 5c6e 6265  e values can\nbe
-000091c0: 2070 6173 7365 6420 696e 746f 2060 7365   passed into `se
-000091d0: 745f 7374 7265 616d 5f6d 6574 6164 6174  t_stream_metadat
-000091e0: 6128 2960 2e5c 6e5c 6e5c 6e23 2323 2053  a()`.\n\n\n### S
-000091f0: 6574 2073 7472 6561 6d20 6d65 7461 6461  et stream metada
-00009200: 7461 5c6e 5c6e 2a72 6571 7569 7265 7320  ta\n\n*requires 
-00009210: 6c65 6164 6572 2a5c 6e5c 6e54 6865 206d  leader*\n\nThe m
-00009220: 6574 686f 6420 6073 6574 5f73 7472 6561  ethod `set_strea
-00009230: 6d5f 6d65 7461 6461 7461 2829 6020 7365  m_metadata()` se
-00009240: 7473 2074 6865 206d 6574 6164 6174 6120  ts the metadata 
-00009250: 666f 7220 6120 7374 7265 616d 2c20 616c  for a stream, al
-00009260: 6f6e 675c 6e77 6974 6820 7468 6520 7665  ong\nwith the ve
-00009270: 7273 696f 6e20 6f66 2074 6865 2073 7472  rsion of the str
-00009280: 6561 6d20 6d65 7461 6461 7461 2e5c 6e5c  eam metadata.\n\
-00009290: 6e60 6060 7079 7468 6f6e 5c6e 6d65 7461  n```python\nmeta
-000092a0: 6461 7461 5b22 666f 6f22 5d20 3d20 2262  data["foo"] = "b
-000092b0: 6172 225c 6e5c 6e63 6c69 656e 742e 7365  ar"\n\nclient.se
-000092c0: 745f 7374 7265 616d 5f6d 6574 6164 6174  t_stream_metadat
-000092d0: 6128 5c6e 2020 2020 7374 7265 616d 5f6e  a(\n    stream_n
-000092e0: 616d 653d 7374 7265 616d 5f6e 616d 6531  ame=stream_name1
-000092f0: 2c5c 6e20 2020 206d 6574 6164 6174 613d  ,\n    metadata=
-00009300: 6d65 7461 6461 7461 2c5c 6e20 2020 2065  metadata,\n    e
-00009310: 7870 6563 7465 645f 706f 7369 7469 6f6e  xpected_position
-00009320: 3d6d 6574 6164 6174 615f 7665 7273 696f  =metadata_versio
-00009330: 6e2c 5c6e 295c 6e60 6060 5c6e 5c6e 5468  n,\n)\n```\n\nTh
-00009340: 6520 6065 7870 6563 7465 645f 706f 7369  e `expected_posi
-00009350: 7469 6f6e 6020 6172 6775 6d65 6e74 2073  tion` argument s
-00009360: 686f 756c 6420 6265 2074 6865 2063 7572  hould be the cur
-00009370: 7265 6e74 2076 6572 7369 6f6e 206f 6620  rent version of 
-00009380: 7468 6520 7374 7265 616d 206d 6574 6164  the stream metad
-00009390: 6174 612e 5c6e 5c6e 506c 6561 7365 2072  ata.\n\nPlease r
-000093a0: 6566 6572 2074 6f20 7468 6520 4576 656e  efer to the Even
-000093b0: 7453 746f 7265 4442 2064 6f63 756d 656e  tStoreDB documen
-000093c0: 7461 7469 6f6e 2066 6f72 206d 6f72 6520  tation for more 
-000093d0: 696e 666f 726d 6174 696f 6e20 6162 6f75  information abou
-000093e0: 7420 7374 7265 616d 5c6e 6d65 7461 6461  t stream\nmetada
-000093f0: 7461 2e5c 6e5c 6e23 2323 2044 656c 6574  ta.\n\n### Delet
-00009400: 6520 7374 7265 616d 5c6e 5c6e 2a72 6571  e stream\n\n*req
-00009410: 7569 7265 7320 6c65 6164 6572 2a5c 6e5c  uires leader*\n\
-00009420: 6e54 6865 206d 6574 686f 6420 6064 656c  nThe method `del
-00009430: 6574 655f 7374 7265 616d 2829 6020 6361  ete_stream()` ca
-00009440: 6e20 6265 2075 7365 6420 746f 2022 6465  n be used to "de
-00009450: 6c65 7465 2220 6120 7374 7265 616d 2e5c  lete" a stream.\
-00009460: 6e5c 6e60 6060 7079 7468 6f6e 5c6e 636f  n\n```python\nco
-00009470: 6d6d 6974 5f70 6f73 6974 696f 6e20 3d20  mmit_position = 
-00009480: 636c 6965 6e74 2e64 656c 6574 655f 7374  client.delete_st
-00009490: 7265 616d 2873 7472 6561 6d5f 6e61 6d65  ream(stream_name
-000094a0: 3d73 7472 6561 6d5f 6e61 6d65 312c 2065  =stream_name1, e
-000094b0: 7870 6563 7465 645f 706f 7369 7469 6f6e  xpected_position
-000094c0: 3d32 295c 6e60 6060 5c6e 5c6e 4166 7465  =2)\n```\n\nAfte
-000094d0: 7220 6465 6c65 7469 6e67 2061 2073 7472  r deleting a str
-000094e0: 6561 6d2c 2069 745c 2773 2073 7469 6c6c  eam, it\'s still
-000094f0: 2070 6f73 7369 626c 6520 746f 2061 7070   possible to app
-00009500: 656e 6420 6e65 7720 6576 656e 7473 2e20  end new events. 
-00009510: 5265 6164 696e 6720 6672 6f6d 2061 5c6e  Reading from a\n
-00009520: 6465 6c65 7465 6420 7374 7265 616d 2077  deleted stream w
-00009530: 696c 6c20 7265 7475 726e 206f 6e6c 7920  ill return only 
-00009540: 6576 656e 7473 2074 6861 7420 6861 7665  events that have
-00009550: 2062 6565 6e20 6170 7065 6e64 6564 2061   been appended a
-00009560: 6674 6572 2069 7420 7761 735c 6e64 656c  fter it was\ndel
-00009570: 6574 6564 2e5c 6e5c 6e23 2323 2054 6f6d  eted.\n\n### Tom
-00009580: 6273 746f 6e65 2073 7472 6561 6d5c 6e5c  bstone stream\n\
-00009590: 6e2a 7265 7175 6972 6573 206c 6561 6465  n*requires leade
-000095a0: 722a 5c6e 5c6e 5468 6520 6d65 7468 6f64  r*\n\nThe method
-000095b0: 2060 746f 6d62 7374 6f6e 655f 7374 7265   `tombstone_stre
-000095c0: 616d 2829 6020 6361 6e20 6265 2075 7365  am()` can be use
-000095d0: 6420 746f 2022 746f 6d62 7374 6f6e 6522  d to "tombstone"
-000095e0: 2061 2073 7472 6561 6d2e 5c6e 5c6e 6060   a stream.\n\n``
-000095f0: 6070 7974 686f 6e5c 6e63 6f6d 6d69 745f  `python\ncommit_
-00009600: 706f 7369 7469 6f6e 203d 2063 6c69 656e  position = clien
-00009610: 742e 746f 6d62 7374 6f6e 655f 7374 7265  t.tombstone_stre
-00009620: 616d 2873 7472 6561 6d5f 6e61 6d65 3d73  am(stream_name=s
-00009630: 7472 6561 6d5f 6e61 6d65 312c 2065 7870  tream_name1, exp
-00009640: 6563 7465 645f 706f 7369 7469 6f6e 3d32  ected_position=2
-00009650: 295c 6e60 6060 5c6e 5c6e 4166 7465 7220  )\n```\n\nAfter 
-00009660: 746f 6d62 7374 6f6e 696e 6720 6120 7374  tombstoning a st
-00009670: 7265 616d 2c20 6974 5c27 7320 6e6f 7420  ream, it\'s not 
-00009680: 706f 7373 6962 6c65 2074 6f20 6170 7065  possible to appe
-00009690: 6e64 206e 6577 2065 7665 6e74 732e 5c6e  nd new events.\n
-000096a0: 5c6e 5c6e 2323 2043 6174 6368 2d75 7020  \n\n## Catch-up 
-000096b0: 7375 6273 6372 6970 7469 6f6e 735c 6e5c  subscriptions\n\
-000096c0: 6e22 4361 7463 682d 7570 2220 7375 6273  n"Catch-up" subs
-000096d0: 6372 6970 7469 6f6e 7320 6361 6e20 6265  criptions can be
-000096e0: 2075 7365 6420 746f 2072 6563 6569 7665   used to receive
-000096f0: 2065 7665 6e74 7320 7468 6174 2068 6176   events that hav
-00009700: 6520 6265 656e 2072 6563 6f72 6465 645c  e been recorded\
-00009710: 6e69 6e20 7468 6520 6461 7461 6261 7365  nin the database
-00009720: 2c20 616e 6420 616c 736f 2065 7665 6e74  , and also event
-00009730: 7320 7468 6174 2061 7265 2072 6563 6f72  s that are recor
-00009740: 6465 6420 6166 7465 7220 6120 7375 6273  ded after a subs
-00009750: 6372 6970 7469 6f6e 2077 6173 2073 7461  cription was sta
-00009760: 7274 6564 2e5c 6e5c 6e54 6865 206d 6574  rted.\n\nThe met
-00009770: 686f 6420 6073 7562 7363 7269 6265 5f61  hod `subscribe_a
-00009780: 6c6c 5f65 7665 6e74 7328 2960 2073 7461  ll_events()` sta
-00009790: 7274 7320 6120 6361 7463 682d 7570 2073  rts a catch-up s
-000097a0: 7562 7363 7269 7074 696f 6e20 746f 2072  ubscription to r
-000097b0: 6563 6569 7665 2061 6c6c 5c6e 6576 656e  eceive all\neven
-000097c0: 7473 2074 6861 7420 6861 7665 2062 6565  ts that have bee
-000097d0: 6e20 616e 6420 7769 6c6c 2062 6520 7265  n and will be re
-000097e0: 636f 7264 6564 2069 6e20 7468 6520 6461  corded in the da
-000097f0: 7461 6261 7365 2e20 5468 6520 6d65 7468  tabase. The meth
-00009800: 6f64 5c6e 6073 7562 7363 7269 6265 5f73  od\n`subscribe_s
-00009810: 7472 6561 6d5f 6576 656e 7473 2829 6020  tream_events()` 
-00009820: 7374 6172 7473 2061 2063 6174 6368 2d75  starts a catch-u
-00009830: 7020 7375 6273 6372 6970 7469 6f6e 2074  p subscription t
-00009840: 6f20 7265 6365 6976 6520 6576 656e 7473  o receive events
-00009850: 2066 726f 6d5c 6e61 2073 7065 6369 6669   from\na specifi
-00009860: 6320 7374 7265 616d 2e5c 6e5c 6e43 6174  c stream.\n\nCat
-00009870: 6368 2d75 7020 7375 6273 6372 6970 7469  ch-up subscripti
-00009880: 6f6e 7320 656e 6361 7073 756c 6174 6520  ons encapsulate 
-00009890: 6120 7374 7265 616d 696e 6720 6752 5043  a streaming gRPC
-000098a0: 2063 616c 6c20 7768 6963 6820 6973 5c6e   call which is\n
-000098b0: 6b65 7074 206f 7065 6e20 6279 2074 6865  kept open by the
-000098c0: 2073 6572 7665 722c 2077 6974 6820 6e65   server, with ne
-000098d0: 776c 7920 7265 636f 7264 6564 2065 7665  wly recorded eve
-000098e0: 6e74 7320 7365 6e74 2074 6f20 7468 6520  nts sent to the 
-000098f0: 636c 6965 6e74 5c6e 6173 2074 6865 2063  client\nas the c
-00009900: 6c69 656e 7420 6974 6572 6174 6573 206f  lient iterates o
-00009910: 7665 7220 7468 6520 7375 6273 6372 6970  ver the subscrip
-00009920: 7469 6f6e 2072 6573 706f 6e73 652e 5c6e  tion response.\n
-00009930: 5c6e 4d61 6e79 2063 6174 6368 2d75 7020  \nMany catch-up 
-00009940: 7375 6273 6372 6970 7469 6f6e 7320 6361  subscriptions ca
-00009950: 6e20 6265 2063 7265 6174 6564 2c20 636f  n be created, co
-00009960: 6e63 7572 7265 6e74 6c79 206f 7220 7375  ncurrently or su
-00009970: 6363 6573 7369 7665 6c79 2c20 616e 6420  ccessively, and 
-00009980: 616c 6c5c 6e77 696c 6c20 7265 6365 6976  all\nwill receiv
-00009990: 6520 616c 6c20 7468 6520 7265 636f 7264  e all the record
-000099a0: 6564 2065 7665 6e74 7320 7468 6579 2068  ed events they h
-000099b0: 6176 6520 6265 656e 2072 6571 7565 7374  ave been request
-000099c0: 6564 2074 6f20 7265 6365 6976 652e 5c6e  ed to receive.\n
-000099d0: 5c6e 5468 6520 7265 6365 6976 6564 2072  \nThe received r
-000099e0: 6563 6f72 6465 6420 6576 656e 7420 6f62  ecorded event ob
-000099f0: 6a65 6374 2061 7265 2069 6e73 7461 6e63  ject are instanc
-00009a00: 6573 206f 6620 7468 6520 6052 6563 6f72  es of the `Recor
-00009a10: 6465 6445 7665 6e74 6020 636c 6173 735c  dedEvent` class\
-00009a20: 6e28 7365 6520 6265 6c6f 7729 2e5c 6e5c  n(see below).\n\
-00009a30: 6e23 2323 2048 6f77 2074 6f20 696d 706c  n### How to impl
-00009a40: 656d 656e 7420 6578 6163 746c 792d 6f6e  ement exactly-on
-00009a50: 6365 2065 7665 6e74 2070 726f 6365 7373  ce event process
-00009a60: 696e 675c 6e5c 6e54 6865 2063 6f6d 6d69  ing\n\nThe commi
-00009a70: 7420 706f 7369 7469 6f6e 7320 6f66 2072  t positions of r
-00009a80: 6563 6f72 6465 6420 6576 656e 7473 2074  ecorded events t
-00009a90: 6861 7420 6172 6520 7265 6365 6976 6564  hat are received
-00009aa0: 2061 6e64 2070 726f 6365 7373 6564 2062   and processed b
-00009ab0: 7920 615c 6e64 6f77 6e73 7472 6561 6d20  y a\ndownstream 
-00009ac0: 636f 6d70 6f6e 656e 7420 6172 6520 7573  component are us
-00009ad0: 6566 756c 6c79 2072 6563 6f72 6465 6420  efully recorded 
-00009ae0: 6279 2074 6865 2064 6f77 6e73 7472 6561  by the downstrea
-00009af0: 6d20 636f 6d70 6f6e 656e 7420 736f 2074  m component so t
-00009b00: 6861 745c 6e74 6865 2063 6f6d 6d69 7420  hat\nthe commit 
-00009b10: 706f 7369 7469 6f6e 206f 6620 6c61 7374  position of last
-00009b20: 2070 726f 6365 7373 6564 2065 7665 6e74   processed event
-00009b30: 2063 616e 2062 6520 6465 7465 726d 696e   can be determin
-00009b40: 6564 2e5c 6e5c 6e54 6865 206c 6173 7420  ed.\n\nThe last 
-00009b50: 7265 636f 7264 6564 2063 6f6d 6d69 7420  recorded commit 
-00009b60: 706f 7369 7469 6f6e 2063 616e 2062 6520  position can be 
-00009b70: 7573 6564 2074 6f20 7370 6563 6966 7920  used to specify 
-00009b80: 7468 6520 636f 6d6d 6974 2070 6f73 6974  the commit posit
-00009b90: 696f 6e20 6672 6f6d 2077 6869 6368 5c6e  ion from which\n
-00009ba0: 746f 2073 7562 7363 7269 6265 2077 6865  to subscribe whe
-00009bb0: 6e20 7072 6f63 6573 7369 6e67 2069 7320  n processing is 
-00009bc0: 7265 7375 6d65 642e 2053 696e 6365 2074  resumed. Since t
-00009bd0: 6869 7320 636f 6d6d 6974 2070 6f73 6974  his commit posit
-00009be0: 696f 6e20 7769 6c6c 2072 6570 7265 7365  ion will represe
-00009bf0: 6e74 2074 6865 5c6e 706f 7369 7469 6f6e  nt the\nposition
-00009c00: 206f 6620 7468 6520 6c61 7374 2073 7563   of the last suc
-00009c10: 6365 7373 6675 6c6c 7920 7072 6f63 6573  cessfully proces
-00009c20: 7365 6420 6576 656e 7420 696e 2061 2064  sed event in a d
-00009c30: 6f77 6e73 7472 6561 6d20 636f 6d70 6f6e  ownstream compon
-00009c40: 656e 742c 2073 6f20 6974 5c6e 7769 6c6c  ent, so it\nwill
-00009c50: 2062 6520 7573 7561 6c20 746f 2077 616e   be usual to wan
-00009c60: 7420 7468 6520 6e65 7874 2065 7665 6e74  t the next event
-00009c70: 2061 6674 6572 2074 6869 7320 706f 7369   after this posi
-00009c80: 7469 6f6e 2c20 6265 6361 7573 6520 7468  tion, because th
-00009c90: 6174 2069 7320 7468 6520 6e65 7874 5c6e  at is the next\n
-00009ca0: 6576 656e 7420 7468 6174 2068 6173 206e  event that has n
-00009cb0: 6f74 2079 6574 2062 6565 6e20 7072 6f63  ot yet been proc
-00009cc0: 6573 7365 642e 2046 6f72 2074 6869 7320  essed. For this 
-00009cd0: 7265 6173 6f6e 2c20 7768 656e 2073 7562  reason, when sub
-00009ce0: 7363 7269 6269 6e67 2066 6f72 2065 7665  scribing for eve
-00009cf0: 6e74 735c 6e66 726f 6d20 6120 7370 6563  nts\nfrom a spec
-00009d00: 6966 6963 2063 6f6d 6d69 7420 706f 7369  ific commit posi
-00009d10: 7469 6f6e 2075 7369 6e67 2061 2063 6174  tion using a cat
-00009d20: 6368 2d75 7020 7375 6273 6372 6970 7469  ch-up subscripti
-00009d30: 6f6e 2069 6e20 4576 656e 7453 746f 7265  on in EventStore
-00009d40: 4442 2c20 7468 655c 6e72 6563 6f72 6465  DB, the\nrecorde
-00009d50: 6420 6576 656e 7420 6174 2074 6865 2073  d event at the s
-00009d60: 7065 6369 6669 6564 2063 6f6d 6d69 7420  pecified commit 
-00009d70: 706f 7369 7469 6f6e 2077 696c 6c20 4e4f  position will NO
-00009d80: 5420 6265 2069 6e63 6c75 6465 6420 696e  T be included in
-00009d90: 2074 6865 2073 6571 7565 6e63 655c 6e6f   the sequence\no
-00009da0: 6620 7265 636f 7264 6564 2065 7665 6e74  f recorded event
-00009db0: 7320 7468 6174 2061 7265 2072 6563 6569  s that are recei
-00009dc0: 7665 642e 5c6e 5c6e 546f 2061 6363 6f6d  ved.\n\nTo accom
-00009dd0: 706c 6973 6820 2265 7861 6374 6c79 2d6f  plish "exactly-o
-00009de0: 6e63 6522 2070 726f 6365 7373 696e 6720  nce" processing 
-00009df0: 6f66 2072 6563 6f72 6465 6420 6576 656e  of recorded even
-00009e00: 7473 2069 6e20 6120 646f 776e 7374 7265  ts in a downstre
-00009e10: 616d 5c6e 636f 6d70 6f6e 656e 7420 7768  am\ncomponent wh
-00009e20: 656e 2075 7369 6e67 2061 2063 6174 6368  en using a catch
-00009e30: 2d75 7020 7375 6273 6372 6970 7469 6f6e  -up subscription
-00009e40: 2c20 7468 6520 636f 6d6d 6974 2070 6f73  , the commit pos
-00009e50: 6974 696f 6e20 6f66 2061 2072 6563 6f72  ition of a recor
-00009e60: 6465 645c 6e65 7665 6e74 2073 686f 756c  ded\nevent shoul
-00009e70: 6420 6265 2072 6563 6f72 6465 6420 6174  d be recorded at
-00009e80: 6f6d 6963 616c 6c79 2061 6e64 2075 6e69  omically and uni
-00009e90: 7175 656c 7920 616c 6f6e 6720 7769 7468  quely along with
-00009ea0: 2074 6865 2072 6573 756c 7420 6f66 2070   the result of p
-00009eb0: 726f 6365 7373 696e 675c 6e72 6563 6f72  rocessing\nrecor
-00009ec0: 6465 6420 6576 656e 7473 2c20 666f 7220  ded events, for 
-00009ed0: 6578 616d 706c 6520 696e 2074 6865 2073  example in the s
-00009ee0: 616d 6520 6461 7461 6261 7365 2061 7320  ame database as 
-00009ef0: 6d61 7465 7269 616c 6973 6564 2076 6965  materialised vie
-00009f00: 7773 2077 6865 6e5c 6e69 6d70 6c65 6d65  ws when\nimpleme
-00009f10: 6e74 696e 6720 6576 656e 7475 616c 6c79  nting eventually
-00009f20: 2d63 6f6e 7369 7374 656e 7420 4351 5253  -consistent CQRS
-00009f30: 2c20 6f72 2069 6e20 7468 6520 7361 6d65  , or in the same
-00009f40: 2064 6174 6162 6173 6520 6173 2061 2064   database as a d
-00009f50: 6f77 6e73 7472 6561 6d5c 6e61 6e61 6c79  ownstream\nanaly
-00009f60: 7469 6373 206f 7220 7265 706f 7274 696e  tics or reportin
-00009f70: 6720 6f72 2061 7263 6869 7669 6e67 2061  g or archiving a
-00009f80: 7070 6c69 6361 7469 6f6e 2e20 4279 2072  pplication. By r
-00009f90: 6563 6f72 6469 6e67 2074 6865 2063 6f6d  ecording the com
-00009fa0: 6d69 7420 706f 7369 7469 6f6e 5c6e 6f66  mit position\nof
-00009fb0: 2072 6563 6f72 6465 6420 6576 656e 7473   recorded events
-00009fc0: 2061 746f 6d69 6361 6c6c 7920 7769 7468   atomically with
-00009fd0: 2074 6865 206e 6577 2073 7461 7465 2074   the new state t
-00009fe0: 6861 7420 7265 7375 6c74 7320 6672 6f6d  hat results from
-00009ff0: 2070 726f 6365 7373 696e 675c 6e72 6563   processing\nrec
-0000a000: 6f72 6465 6420 6576 656e 7473 2c20 2264  orded events, "d
-0000a010: 7561 6c20 7772 6974 696e 6722 2069 6e20  ual writing" in 
-0000a020: 7468 6520 636f 6e73 756d 7074 696f 6e20  the consumption 
-0000a030: 6f66 2072 6563 6f72 6465 6420 6576 656e  of recorded even
-0000a040: 7473 2063 616e 2062 655c 6e61 766f 6964  ts can be\navoid
-0000a050: 6564 2e20 4279 2061 6c73 6f20 7265 636f  ed. By also reco
-0000a060: 7264 696e 6720 7468 6520 636f 6d6d 6974  rding the commit
-0000a070: 2070 6f73 6974 696f 6e20 756e 6971 7565   position unique
-0000a080: 6c79 2c20 7468 6520 6e65 7720 7374 6174  ly, the new stat
-0000a090: 6520 6361 6e6e 6f74 2062 655c 6e72 6563  e cannot be\nrec
-0000a0a0: 6f72 6465 6420 7477 6963 652c 2061 6e64  orded twice, and
-0000a0b0: 2068 656e 6365 2074 6865 2072 6563 6f72   hence the recor
-0000a0c0: 6465 6420 7374 6174 6520 6f66 2074 6865  ded state of the
-0000a0d0: 2064 6f77 6e73 7472 6561 6d20 636f 6d70   downstream comp
-0000a0e0: 6f6e 656e 7420 7769 6c6c 2062 655c 6e75  onent will be\nu
-0000a0f0: 7064 6174 6564 206f 6e6c 7920 6f6e 6365  pdated only once
-0000a100: 2066 6f72 2061 6e79 2072 6563 6f72 6465   for any recorde
-0000a110: 6420 6576 656e 742e 2042 7920 7573 696e  d event. By usin
-0000a120: 6720 7468 6520 6772 6561 7465 7374 2072  g the greatest r
-0000a130: 6563 6f72 6465 6420 636f 6d6d 6974 5c6e  ecorded commit\n
-0000a140: 706f 7369 7469 6f6e 2074 6f20 7265 7375  position to resu
-0000a150: 6d65 2061 2063 6174 6368 2d75 7020 7375  me a catch-up su
-0000a160: 6273 6372 6970 7469 6f6e 2c20 616c 6c20  bscription, all 
-0000a170: 7265 636f 7264 6564 2065 7665 6e74 7320  recorded events 
-0000a180: 7769 6c6c 2065 7665 6e74 7561 6c6c 795c  will eventually\
-0000a190: 6e62 6520 7072 6f63 6573 7365 642e 2054  nbe processed. T
-0000a1a0: 6865 2063 6f6d 6269 6e61 7469 6f6e 206f  he combination o
-0000a1b0: 6620 7468 6520 2261 742d 6d6f 7374 2d6f  f the "at-most-o
-0000a1c0: 6e63 6522 2063 6f6e 6469 7469 6f6e 2061  nce" condition a
-0000a1d0: 6e64 2074 6865 2022 6174 2d6c 6561 7374  nd the "at-least
-0000a1e0: 2d6f 6e63 6522 5c6e 636f 6e64 6974 696f  -once"\nconditio
-0000a1f0: 6e20 6769 7665 7320 7468 6520 2265 7861  n gives the "exa
-0000a200: 6374 6c79 2d6f 6e63 6522 2063 6f6e 6469  ctly-once" condi
-0000a210: 7469 6f6e 2e5c 6e5c 6e54 6865 2064 616e  tion.\n\nThe dan
-0000a220: 6765 7220 7769 7468 2022 6475 616c 2077  ger with "dual w
-0000a230: 7269 7469 6e67 2220 696e 2074 6865 2063  riting" in the c
-0000a240: 6f6e 7375 6d70 7469 6f6e 206f 6620 7265  onsumption of re
-0000a250: 636f 7264 6564 2065 7665 6e74 7320 6973  corded events is
-0000a260: 2074 6861 7420 6966 2061 5c6e 7265 636f   that if a\nreco
-0000a270: 7264 6564 2065 7665 6e74 2069 7320 7375  rded event is su
-0000a280: 6363 6573 7366 756c 6c79 2070 726f 6365  ccessfully proce
-0000a290: 7373 6564 2061 6e64 206e 6577 2073 7461  ssed and new sta
-0000a2a0: 7465 2072 6563 6f72 6465 6420 6174 6f6d  te recorded atom
-0000a2b0: 6963 616c 6c79 2069 6e20 6f6e 655c 6e74  ically in one\nt
-0000a2c0: 7261 6e73 6163 7469 6f6e 2077 6974 6820  ransaction with 
-0000a2d0: 7468 6520 636f 6d6d 6974 2070 6f73 6974  the commit posit
-0000a2e0: 696f 6e20 7265 636f 7264 6564 2069 6e20  ion recorded in 
-0000a2f0: 6120 7365 7061 7261 7465 2074 7261 6e73  a separate trans
-0000a300: 6163 7469 6f6e 2c20 6f6e 6520 6d61 795c  action, one may\
-0000a310: 6e68 6170 7065 6e20 616e 6420 6e6f 7420  nhappen and not 
-0000a320: 7468 6520 6f74 6865 722e 2049 6620 7468  the other. If th
-0000a330: 6520 6e65 7720 7374 6174 6520 6973 2072  e new state is r
-0000a340: 6563 6f72 6465 6420 6275 7420 7468 6520  ecorded but the 
-0000a350: 706f 7369 7469 6f6e 2069 7320 6c6f 7374  position is lost
-0000a360: 2c5c 6e61 6e64 2074 6865 6e20 7468 6520  ,\nand then the 
-0000a370: 7072 6f63 6573 7369 6e67 2069 7320 7374  processing is st
-0000a380: 6f70 7065 6420 616e 6420 7265 7375 6d65  opped and resume
-0000a390: 642c 2074 6865 2072 6563 6f72 6465 6420  d, the recorded 
-0000a3a0: 6576 656e 7420 6d61 7920 6265 2070 726f  event may be pro
-0000a3b0: 6365 7373 6564 5c6e 7477 6963 652e 204f  cessed\ntwice. O
-0000a3c0: 6e20 7468 6520 6f74 6865 7220 6861 6e64  n the other hand
-0000a3d0: 2c20 6966 2074 6865 2063 6f6d 6d69 7420  , if the commit 
-0000a3e0: 706f 7369 7469 6f6e 2069 7320 7265 636f  position is reco
-0000a3f0: 7264 6564 2062 7574 2074 6865 206e 6577  rded but the new
-0000a400: 2073 7461 7465 2069 735c 6e6c 6f73 742c   state is\nlost,
-0000a410: 2074 6865 2072 6563 6f72 6465 6420 6576   the recorded ev
-0000a420: 656e 7420 6d61 7920 6566 6665 6374 6976  ent may effectiv
-0000a430: 656c 7920 6e6f 7420 6265 2070 726f 6365  ely not be proce
-0000a440: 7373 6564 2061 7420 616c 6c2e 2042 7920  ssed at all. By 
-0000a450: 6569 7468 6572 5c6e 7072 6f63 6573 7369  either\nprocessi
-0000a460: 6e67 2061 6e20 6576 656e 7420 6d6f 7265  ng an event more
-0000a470: 2074 6861 6e20 6f6e 6365 2c20 6f72 2062   than once, or b
-0000a480: 7920 6661 696c 696e 6720 746f 2070 726f  y failing to pro
-0000a490: 6365 7373 2061 6e20 6576 656e 742c 2074  cess an event, t
-0000a4a0: 6865 2072 6563 6f72 6465 645c 6e73 7461  he recorded\nsta
-0000a4b0: 7465 206f 6620 7468 6520 646f 776e 7374  te of the downst
-0000a4c0: 7265 616d 2063 6f6d 706f 6e65 6e74 206d  ream component m
-0000a4d0: 6967 6874 2062 6520 696e 6163 6375 7261  ight be inaccura
-0000a4e0: 7465 2c20 6f72 2070 6f73 7369 626c 7920  te, or possibly 
-0000a4f0: 696e 636f 6e73 6973 7465 6e74 2c20 616e  inconsistent, an
-0000a500: 645c 6e70 6572 6861 7073 2063 6174 6173  d\nperhaps catas
-0000a510: 7472 6f70 6869 6361 6c6c 7920 736f 2e20  trophically so. 
-0000a520: 5375 6368 2063 6f6e 7365 7175 656e 6365  Such consequence
-0000a530: 7320 6d61 7920 6f72 206d 6179 206e 6f74  s may or may not
-0000a540: 206d 6174 7465 7220 696e 2079 6f75 7220   matter in your 
-0000a550: 7369 7475 6174 696f 6e2e 5c6e 4275 7420  situation.\nBut 
-0000a560: 736f 6d65 7469 6d65 7320 696e 636f 6e73  sometimes incons
-0000a570: 6973 7465 6e63 6965 7320 6d61 7920 6861  istencies may ha
-0000a580: 6c74 2070 726f 6365 7373 696e 6720 756e  lt processing un
-0000a590: 7469 6c20 7468 6520 6973 7375 6520 6973  til the issue is
-0000a5a0: 2072 6573 6f6c 7665 642e 2059 6f75 2063   resolved. You c
-0000a5b0: 616e 5c6e 6176 6f69 6420 2264 7561 6c20  an\navoid "dual 
-0000a5c0: 7772 6974 696e 6722 2069 6e20 7468 6520  writing" in the 
-0000a5d0: 636f 6e73 756d 7074 696f 6e20 6f66 2065  consumption of e
-0000a5e0: 7665 6e74 7320 6279 2061 746f 6d69 6361  vents by atomica
-0000a5f0: 6c6c 7920 7265 636f 7264 696e 6720 7468  lly recording th
-0000a600: 6520 636f 6d6d 6974 5c6e 706f 7369 7469  e commit\npositi
-0000a610: 6f6e 206f 6620 6120 7265 636f 7264 6564  on of a recorded
-0000a620: 2065 7665 6e74 2061 6c6f 6e67 2077 6974   event along wit
-0000a630: 6820 7468 6520 6e65 7720 7374 6174 6520  h the new state 
-0000a640: 7468 6174 2072 6573 756c 7473 2066 726f  that results fro
-0000a650: 6d20 7072 6f63 6573 7369 6e67 2074 6861  m processing tha
-0000a660: 745c 6e65 7665 6e74 2069 6e20 7468 6520  t\nevent in the 
-0000a670: 7361 6d65 2061 746f 6d69 6320 7472 616e  same atomic tran
-0000a680: 7361 6374 696f 6e2e 2042 7920 6d61 6b69  saction. By maki
-0000a690: 6e67 2074 6865 2072 6563 6f72 6469 6e67  ng the recording
-0000a6a0: 206f 6620 7468 6520 636f 6d6d 6974 2070   of the commit p
-0000a6b0: 6f73 6974 696f 6e73 5c6e 756e 6971 7565  ositions\nunique
-0000a6c0: 2c20 736f 2074 6861 7420 7472 616e 7361  , so that transa
-0000a6d0: 6374 696f 6e73 2077 696c 6c20 6265 2072  ctions will be r
-0000a6e0: 6f6c 6c65 6420 6261 636b 2077 6865 6e20  olled back when 
-0000a6f0: 7468 6572 6520 6973 2061 2063 6f6e 666c  there is a confl
-0000a700: 6963 742c 2079 6f75 2077 696c 6c5c 6e70  ict, you will\np
-0000a710: 7265 7665 6e74 2074 6865 2072 6573 756c  revent the resul
-0000a720: 7473 206f 6620 616e 7920 6475 706c 6963  ts of any duplic
-0000a730: 6174 6520 7072 6f63 6573 7369 6e67 206f  ate processing o
-0000a740: 6620 6120 7265 636f 7264 6564 2065 7665  f a recorded eve
-0000a750: 6e74 2062 6569 6e67 2063 6f6d 6d69 7474  nt being committ
-0000a760: 6564 2e5c 6e5c 6e52 6563 6f72 6465 6420  ed.\n\nRecorded 
-0000a770: 6576 656e 7473 2072 6563 6569 7665 6420  events received 
-0000a780: 6672 6f6d 2061 2063 6174 6368 2d75 7020  from a catch-up 
-0000a790: 7375 6273 6372 6970 7469 6f6e 2063 616e  subscription can
-0000a7a0: 6e6f 7420 6265 2061 636b 6e6f 776c 6564  not be acknowled
-0000a7b0: 6765 6420 6261 636b 5c6e 746f 2074 6865  ged back\nto the
-0000a7c0: 2045 7665 6e74 5374 6f72 6544 4220 7365   EventStoreDB se
-0000a7d0: 7276 6572 2e20 4163 6b6e 6f77 6c65 6467  rver. Acknowledg
-0000a7e0: 696e 6720 6576 656e 7473 2c20 686f 7765  ing events, howe
-0000a7f0: 7665 722c 2069 7320 616e 2061 7370 6563  ver, is an aspec
-0000a800: 7420 6f66 2022 7065 7273 6973 7465 6e74  t of "persistent
-0000a810: 5c6e 7375 6273 6372 6970 7469 6f6e 7322  \nsubscriptions"
-0000a820: 2028 7365 6520 6265 6c6f 7729 2e20 486f   (see below). Ho
-0000a830: 7069 6e67 2074 6f20 7265 6c79 206f 6e20  ping to rely on 
-0000a840: 6163 6b6e 6f77 6c65 6467 696e 6720 6576  acknowledging ev
-0000a850: 656e 7473 2074 6f20 616e 2075 7073 7472  ents to an upstr
-0000a860: 6561 6d5c 6e63 6f6d 706f 6e65 6e74 2069  eam\ncomponent i
-0000a870: 7320 616e 2065 7861 6d70 6c65 206f 6620  s an example of 
-0000a880: 6475 616c 2077 7269 7469 6e67 2e5c 6e5c  dual writing.\n\
-0000a890: 6e23 2323 2053 7562 7363 7269 6265 2061  n### Subscribe a
-0000a8a0: 6c6c 2065 7665 6e74 735c 6e5c 6e54 6865  ll events\n\nThe
-0000a8b0: 6073 7562 7363 7269 6265 5f61 6c6c 5f65  `subscribe_all_e
-0000a8c0: 7665 6e74 7328 2960 206d 6574 686f 6420  vents()` method 
-0000a8d0: 6361 6e20 6265 2075 7365 6420 746f 2073  can be used to s
-0000a8e0: 7461 7274 2061 2022 6361 7463 682d 7570  tart a "catch-up
-0000a8f0: 2220 7375 6273 6372 6970 7469 6f6e 5c6e  " subscription\n
-0000a900: 7468 6174 2063 616e 2072 6574 7572 6e20  that can return 
-0000a910: 6576 656e 7473 2066 726f 6d20 616c 6c20  events from all 
-0000a920: 7374 7265 616d 7320 696e 2074 6865 2064  streams in the d
-0000a930: 6174 6162 6173 652e 5c6e 5c6e 5468 6973  atabase.\n\nThis
-0000a940: 206d 6574 686f 6420 6361 6e20 6265 2075   method can be u
-0000a950: 7365 6420 6279 2061 2064 6f77 6e73 7472  sed by a downstr
-0000a960: 6561 6d20 636f 6d70 6f6e 656e 745c 6e74  eam component\nt
-0000a970: 6f20 7072 6f63 6573 7320 7265 636f 7264  o process record
-0000a980: 6564 2065 7665 6e74 7320 7769 7468 2065  ed events with e
-0000a990: 7861 6374 6c79 2d6f 6e63 6520 7365 6d61  xactly-once sema
-0000a9a0: 6e74 6963 732e 5c6e 5c6e 5468 6973 206d  ntics.\n\nThis m
-0000a9b0: 6574 686f 6420 7461 6b65 7320 616e 206f  ethod takes an o
-0000a9c0: 7074 696f 6e61 6c20 6063 6f6d 6d69 745f  ptional `commit_
-0000a9d0: 706f 7369 7469 6f6e 6020 6172 6775 6d65  position` argume
-0000a9e0: 6e74 2c20 7768 6963 6820 6361 6e20 6265  nt, which can be
-0000a9f0: 5c6e 7573 6564 2074 6f20 7370 6563 6966  \nused to specif
-0000aa00: 7920 6120 636f 6d6d 6974 2070 6f73 6974  y a commit posit
-0000aa10: 696f 6e20 6672 6f6d 2077 6869 6368 2074  ion from which t
-0000aa20: 6f20 7375 6273 6372 6962 652e 2054 6865  o subscribe. The
-0000aa30: 2064 6566 6175 6c74 5c6e 7661 6c75 6520   default\nvalue 
-0000aa40: 6973 2060 4e6f 6e65 602c 2077 6869 6368  is `None`, which
-0000aa50: 206d 6561 6e73 2074 6865 2073 7562 7363   means the subsc
-0000aa60: 7269 7074 696f 6e20 7769 6c6c 206f 7065  ription will ope
-0000aa70: 7261 7465 2066 726f 6d20 7468 6520 6669  rate from the fi
-0000aa80: 7273 745c 6e72 6563 6f72 6465 6420 6576  rst\nrecorded ev
-0000aa90: 656e 7420 696e 2074 6865 2064 6174 6162  ent in the datab
-0000aaa0: 6173 652e 2049 6620 6120 636f 6d6d 6974  ase. If a commit
-0000aab0: 2070 6f73 6974 696f 6e20 6973 2067 6976   position is giv
-0000aac0: 656e 2c20 6974 206d 7573 7420 6d61 7463  en, it must matc
-0000aad0: 685c 6e61 6e20 6163 7475 616c 6c79 2065  h\nan actually e
-0000aae0: 7869 7374 696e 6720 636f 6d6d 6974 2070  xisting commit p
-0000aaf0: 6f73 6974 696f 6e20 696e 2074 6865 2064  osition in the d
-0000ab00: 6174 6162 6173 652e 2054 6865 2072 6563  atabase. The rec
-0000ab10: 6f64 6564 2065 7665 6e74 7320 7468 6174  oded events that
-0000ab20: 5c6e 6172 6520 6f62 7461 696e 6564 2077  \nare obtained w
-0000ab30: 696c 6c20 6e6f 7420 696e 636c 7564 6520  ill not include 
-0000ab40: 7468 6520 6576 656e 7420 7265 636f 7264  the event record
-0000ab50: 6564 2061 7420 7468 6174 2063 6f6d 6d69  ed at that commi
-0000ab60: 7420 706f 7369 7469 6f6e 2e5c 6e5c 6e54  t position.\n\nT
-0000ab70: 6869 7320 6d65 7468 6f64 2061 6c73 6f20  his method also 
-0000ab80: 7461 6b65 7320 666f 7572 206f 7468 6572  takes four other
-0000ab90: 206f 7074 696f 6e61 6c20 6172 6775 6d65   optional argume
-0000aba0: 6e74 732c 2060 6669 6c74 6572 5f65 7863  nts, `filter_exc
-0000abb0: 6c75 6465 602c 5c6e 6066 696c 7465 725f  lude`,\n`filter_
-0000abc0: 696e 636c 7564 6560 2c20 6066 696c 7465  include`, `filte
-0000abd0: 725f 6279 5f73 7472 6561 6d5f 6e61 6d65  r_by_stream_name
-0000abe0: 602c 2061 6e64 2060 7469 6d65 6f75 7460  `, and `timeout`
-0000abf0: 2e5c 6e5c 6e54 6865 206f 7074 696f 6e61  .\n\nThe optiona
-0000ac00: 6c20 6172 6775 6d65 6e74 2060 6669 6c74  l argument `filt
-0000ac10: 6572 5f65 7863 6c75 6465 6020 6973 2061  er_exclude` is a
-0000ac20: 2073 6571 7565 6e63 6520 6f66 2072 6567   sequence of reg
-0000ac30: 756c 6172 2065 7870 7265 7373 696f 6e73  ular expressions
-0000ac40: 2074 6861 745c 6e6d 6174 6368 2072 6563   that\nmatch rec
-0000ac50: 6f72 6465 6420 6576 656e 7473 2074 6861  orded events tha
-0000ac60: 7420 7368 6f75 6c64 206e 6f74 2062 6520  t should not be 
-0000ac70: 696e 636c 7564 6564 2e20 5468 6973 2061  included. This a
-0000ac80: 7267 756d 656e 7420 6973 2069 676e 6f72  rgument is ignor
-0000ac90: 6564 5c6e 6966 2060 6669 6c74 6572 5f69  ed\nif `filter_i
-0000aca0: 6e63 6c75 6465 6020 6973 2073 6574 2074  nclude` is set t
-0000acb0: 6f20 6120 6e6f 6e2d 656d 7074 7920 7365  o a non-empty se
-0000acc0: 7175 656e 6365 2e20 4279 2064 6566 6175  quence. By defau
-0000acd0: 6c74 2c20 7468 6973 2061 7267 756d 656e  lt, this argumen
-0000ace0: 7420 6973 2073 6574 5c6e 746f 206d 6174  t is set\nto mat
-0000acf0: 6368 2074 6865 2065 7665 6e74 2074 7970  ch the event typ
-0000ad00: 6573 206f 6620 2273 7973 7465 6d20 6576  es of "system ev
-0000ad10: 656e 7473 222c 2073 6f20 7468 6174 2045  ents", so that E
-0000ad20: 7665 6e74 5374 6f72 6544 4220 7379 7374  ventStoreDB syst
-0000ad30: 656d 2065 7665 6e74 735c 6e77 696c 6c20  em events\nwill 
-0000ad40: 6e6f 7420 6e6f 726d 616c 6c79 2062 6520  not normally be 
-0000ad50: 696e 636c 7564 6564 2e20 5365 6520 7468  included. See th
-0000ad60: 6520 4e6f 7465 7320 7365 6374 696f 6e20  e Notes section 
-0000ad70: 6265 6c6f 7720 666f 7220 6d6f 7265 2069  below for more i
-0000ad80: 6e66 6f72 6d61 7469 6f6e 5c6e 6162 6f75  nformation\nabou
-0000ad90: 7420 6669 6c74 6572 2065 7870 7265 7373  t filter express
-0000ada0: 696f 6e73 2e5c 6e5c 6e54 6865 206f 7074  ions.\n\nThe opt
-0000adb0: 696f 6e61 6c20 6172 6775 6d65 6e74 2060  ional argument `
-0000adc0: 6669 6c74 6572 5f69 6e63 6c75 6465 6020  filter_include` 
-0000add0: 6973 2061 2073 6571 7565 6e63 6520 6f66  is a sequence of
-0000ade0: 2072 6567 756c 6172 2065 7870 7265 7373   regular express
-0000adf0: 696f 6e73 5c6e 7468 6174 206d 6174 6368  ions\nthat match
-0000ae00: 2072 6563 6f72 6465 6420 6576 656e 7473   recorded events
-0000ae10: 2074 6861 7420 7368 6f75 6c64 2062 6520   that should be 
-0000ae20: 696e 636c 7564 6564 2e20 4279 2064 6566  included. By def
-0000ae30: 6175 6c74 2c20 7468 6973 2061 7267 756d  ault, this argum
-0000ae40: 656e 745c 6e69 7320 616e 2065 6d70 7479  ent\nis an empty
-0000ae50: 2074 7570 6c65 2e20 4966 2074 6869 7320   tuple. If this 
-0000ae60: 6172 6775 6d65 6e74 2069 7320 7365 7420  argument is set 
-0000ae70: 746f 2061 206e 6f6e 2d65 6d70 7479 2073  to a non-empty s
-0000ae80: 6571 7565 6e63 652c 2074 6865 5c6e 6066  equence, the\n`f
-0000ae90: 696c 7465 725f 6578 636c 7564 6560 2061  ilter_exclude` a
-0000aea0: 7267 756d 656e 7420 6973 2069 676e 6f72  rgument is ignor
-0000aeb0: 6564 2e5c 6e5c 6e54 6865 206f 7074 696f  ed.\n\nThe optio
-0000aec0: 6e61 6c20 6172 6775 6d65 6e74 2060 6669  nal argument `fi
-0000aed0: 6c74 6572 5f62 795f 7374 7265 616d 5f6e  lter_by_stream_n
-0000aee0: 616d 6560 2069 7320 6120 626f 6f6c 6561  ame` is a boolea
-0000aef0: 6e20 7661 6c75 6520 7468 6174 2069 6e64  n value that ind
-0000af00: 6963 6174 6573 2077 6865 7468 6572 5c6e  icates whether\n
-0000af10: 7468 6520 6669 6c74 6572 2077 696c 6c20  the filter will 
-0000af20: 6170 706c 7920 746f 2065 7665 6e74 2074  apply to event t
-0000af30: 7970 6573 206f 7220 7374 7265 616d 206e  ypes or stream n
-0000af40: 616d 6573 2e20 4279 2064 6566 6175 6c74  ames. By default
-0000af50: 2c20 7468 6973 2076 616c 7565 2069 7320  , this value is 
-0000af60: 6046 616c 7365 605c 6e61 6e64 2073 6f20  `False`\nand so 
-0000af70: 7468 6520 6669 6c74 6572 696e 6720 7769  the filtering wi
-0000af80: 6c6c 2061 7070 6c79 2074 6f20 7468 6520  ll apply to the 
-0000af90: 6576 656e 7420 7479 7065 2073 7472 696e  event type strin
-0000afa0: 6773 206f 6620 7265 636f 7264 6564 2065  gs of recorded e
-0000afb0: 7665 6e74 732e 5c6e 5c6e 506c 6561 7365  vents.\n\nPlease
-0000afc0: 206e 6f74 652c 2074 6865 2066 696c 7465   note, the filte
-0000afd0: 7269 6e67 2068 6170 7065 6e73 206f 6e20  ring happens on 
-0000afe0: 7468 6520 4576 656e 7453 746f 7265 4442  the EventStoreDB
-0000aff0: 2073 6572 7665 722c 2061 6e64 2074 6865   server, and the
-0000b000: 5c6e 606c 696d 6974 6020 6172 6775 6d65  \n`limit` argume
-0000b010: 6e74 2069 7320 6170 706c 6965 6420 6f6e  nt is applied on
-0000b020: 2074 6865 2073 6572 7665 7220 6166 7465   the server afte
-0000b030: 7220 6669 6c74 6572 696e 672e 2053 6565  r filtering. See
-0000b040: 2062 656c 6f77 2066 6f72 5c6e 6d6f 7265   below for\nmore
-0000b050: 2069 6e66 6f72 6d61 7469 6f6e 2061 626f   information abo
-0000b060: 7574 2066 696c 7465 7220 7265 6775 6c61  ut filter regula
-0000b070: 7220 6578 7072 6573 7369 6f6e 732e 5c6e  r expressions.\n
-0000b080: 5c6e 5468 6520 6f70 7469 6f6e 616c 2060  \nThe optional `
-0000b090: 7469 6d65 6f75 7460 2061 7267 756d 656e  timeout` argumen
-0000b0a0: 7420 6973 2061 2050 7974 686f 6e20 6066  t is a Python `f
-0000b0b0: 6c6f 6174 6020 7768 6963 6820 7365 7473  loat` which sets
-0000b0c0: 2061 5c6e 6465 6164 6c69 6e65 2066 6f72   a\ndeadline for
-0000b0d0: 2074 6865 2063 6f6d 706c 6574 696f 6e20   the completion 
-0000b0e0: 6f66 2074 6865 2067 5250 4320 6f70 6572  of the gRPC oper
-0000b0f0: 6174 696f 6e2e 5c6e 5c6e 5468 6973 206d  ation.\n\nThis m
-0000b100: 6574 686f 6420 7265 7475 726e 7320 6120  ethod returns a 
-0000b110: 5079 7468 6f6e 2069 7465 7261 746f 7220  Python iterator 
-0000b120: 7468 6174 2079 6965 6c64 7320 7265 636f  that yields reco
-0000b130: 7264 6564 2065 7665 6e74 732c 2069 6e63  rded events, inc
-0000b140: 6c75 6469 6e67 2065 7665 6e74 735c 6e74  luding events\nt
-0000b150: 6861 7420 6172 6520 7265 636f 7264 6564  hat are recorded
-0000b160: 2061 6674 6572 2074 6865 2073 7562 7363   after the subsc
-0000b170: 7269 7074 696f 6e20 7761 7320 6372 6561  ription was crea
-0000b180: 7465 642e 2049 7465 7261 7469 6e67 206f  ted. Iterating o
-0000b190: 7665 7220 7468 6973 206f 626a 6563 7420  ver this object 
-0000b1a0: 7769 6c6c 5c6e 7468 6572 6566 6f72 6520  will\ntherefore 
-0000b1b0: 6e6f 7420 7374 6f70 2c20 756e 6c65 7373  not stop, unless
-0000b1c0: 2074 6865 2063 6f6e 6e65 6374 696f 6e20   the connection 
-0000b1d0: 746f 2074 6865 2064 6174 6162 6173 6520  to the database 
-0000b1e0: 6973 206c 6f73 742e 2054 6865 2063 616c  is lost. The cal
-0000b1f0: 6c20 7769 6c6c 5c6e 6265 2065 6e64 6564  l will\nbe ended
-0000b200: 2077 6865 6e20 7468 6520 6974 6572 6174   when the iterat
-0000b210: 6f72 206f 626a 6563 7420 6973 2064 656c  or object is del
-0000b220: 6574 6564 2066 726f 6d20 6d65 6d6f 7279  eted from memory
-0000b230: 2c20 7768 6963 6820 7769 6c6c 2068 6170  , which will hap
-0000b240: 7065 6e20 7768 656e 2074 6865 5c6e 6974  pen when the\nit
-0000b250: 6572 6174 6f72 206f 626a 6563 7420 676f  erator object go
-0000b260: 6573 206f 7574 206f 6620 7363 6f70 6520  es out of scope 
-0000b270: 6f72 2069 7320 6578 706c 6963 6974 6c79  or is explicitly
-0000b280: 2064 656c 6574 6564 2028 7365 6520 6265   deleted (see be
-0000b290: 6c6f 7729 2e20 5468 6520 6361 6c6c 5c6e  low). The call\n
-0000b2a0: 6d61 7920 616c 736f 2062 6520 636c 6f73  may also be clos
-0000b2b0: 6564 2062 7920 7468 6520 7365 7276 6572  ed by the server
-0000b2c0: 2e5c 6e5c 6e54 6865 2073 7562 7363 7269  .\n\nThe subscri
-0000b2d0: 7074 696f 6e20 6f62 6a65 6374 2063 616e  ption object can
-0000b2e0: 2062 6520 7573 6564 2064 6972 6563 746c   be used directl
-0000b2f0: 792c 2062 7574 2069 7420 6d69 6768 7420  y, but it might 
-0000b300: 6265 2075 7365 6420 7769 7468 696e 2061  be used within a
-0000b310: 2074 6872 6561 6465 645c 6e6c 6f6f 7020   threaded\nloop 
-0000b320: 6465 6469 6361 7465 6420 746f 2072 6563  dedicated to rec
-0000b330: 6569 7669 6e67 2065 7665 6e74 7320 7468  eiving events th
-0000b340: 6174 2063 616e 2062 6520 7374 6f70 7065  at can be stoppe
-0000b350: 6420 696e 2061 2063 6f6e 7472 6f6c 6c65  d in a controlle
-0000b360: 6420 7761 792c 2077 6974 685c 6e72 6563  d way, with\nrec
-0000b370: 6f72 6465 6420 6576 656e 7473 2070 7574  orded events put
-0000b380: 206f 6e20 6120 7175 6575 6520 666f 7220   on a queue for 
-0000b390: 7072 6f63 6573 7369 6e67 2069 6e20 6120  processing in a 
-0000b3a0: 6469 6666 6572 656e 7420 7468 7265 6164  different thread
-0000b3b0: 2e20 5468 6973 2070 6163 6b61 6765 5c6e  . This package\n
-0000b3c0: 646f 6573 6e5c 2774 2070 726f 7669 6465  doesn\'t provide
-0000b3d0: 2073 7563 6820 6120 7468 7265 6164 6564   such a threaded
-0000b3e0: 206f 7220 7175 6575 696e 6720 6f62 6a65   or queuing obje
-0000b3f0: 6374 2063 6c61 7373 2e20 4a75 7374 206d  ct class. Just m
-0000b400: 616b 6520 7375 7265 2074 6f20 7265 636f  ake sure to reco
-0000b410: 6e73 7472 7563 745c 6e74 6865 2073 7562  nstruct\nthe sub
-0000b420: 7363 7269 7074 696f 6e20 2861 6e64 2074  scription (and t
-0000b430: 6865 2071 7565 7565 2920 7573 696e 6720  he queue) using 
-0000b440: 7468 6520 6c61 7374 2072 6563 6f72 6465  the last recorde
-0000b450: 6420 636f 6d6d 6974 2070 6f73 6974 696f  d commit positio
-0000b460: 6e20 7768 656e 2072 6573 756d 696e 675c  n when resuming\
-0000b470: 6e74 6865 2073 7562 7363 7269 7074 696f  nthe subscriptio
-0000b480: 6e20 6166 7465 7220 616e 2065 7272 6f72  n after an error
-0000b490: 2c20 746f 2062 6520 7375 7265 2061 6c6c  , to be sure all
-0000b4a0: 2065 7665 6e74 7320 6172 6520 7072 6f63   events are proc
-0000b4b0: 6573 7365 6420 6f6e 6365 2e5c 6e5c 6e54  essed once.\n\nT
-0000b4c0: 6865 2065 7861 6d70 6c65 2062 656c 6f77  he example below
-0000b4d0: 2073 686f 7773 2068 6f77 2074 6f20 7375   shows how to su
-0000b4e0: 6273 6372 6962 6520 746f 2072 6563 6569  bscribe to recei
-0000b4f0: 7665 2061 6c6c 2072 6563 6f72 6465 645c  ve all recorded\
-0000b500: 6e65 7665 6e74 7320 6672 6f6d 2074 6865  nevents from the
-0000b510: 2073 7461 7274 2c20 616e 6420 7468 656e   start, and then
-0000b520: 2072 6573 756d 696e 6720 6672 6f6d 2061   resuming from a
-0000b530: 2073 7065 6369 6669 6320 636f 6d6d 6974   specific commit
-0000b540: 2070 6f73 6974 696f 6e2e 5c6e 5468 7265   position.\nThre
-0000b550: 6520 616c 7265 6164 792d 7265 636f 7264  e already-record
-0000b560: 6564 2065 7665 6e74 7320 6172 6520 7265  ed events are re
-0000b570: 6365 6976 6564 2c20 616e 6420 7468 656e  ceived, and then
-0000b580: 2074 6872 6565 206e 6577 2065 7665 6e74   three new event
-0000b590: 7320 6172 655c 6e72 6563 6f72 6465 642c  s are\nrecorded,
-0000b5a0: 2077 6869 6368 2061 7265 2074 6865 6e20   which are then 
-0000b5b0: 7265 6365 6976 6564 2076 6961 2074 6865  received via the
-0000b5c0: 2073 7562 7363 7269 7074 696f 6e2e 5c6e   subscription.\n
-0000b5d0: 5c6e 6060 6070 7974 686f 6e5c 6e5c 6e23  \n```python\n\n#
-0000b5e0: 2041 7070 656e 6420 616e 2065 7665 6e74   Append an event
-0000b5f0: 2074 6f20 6120 6e65 7720 7374 7265 616d   to a new stream
-0000b600: 2e5c 6e73 7472 6561 6d5f 6e61 6d65 3220  .\nstream_name2 
-0000b610: 3d20 7374 7228 7575 6964 3428 2929 5c6e  = str(uuid4())\n
-0000b620: 6576 656e 7434 203d 204e 6577 4576 656e  event4 = NewEven
-0000b630: 7428 7479 7065 3d5c 274f 7264 6572 4372  t(type=\'OrderCr
-0000b640: 6561 7465 645c 272c 2064 6174 613d 625c  eated\', data=b\
-0000b650: 2764 6174 6134 5c27 295c 6e63 6c69 656e  'data4\')\nclien
-0000b660: 742e 6170 7065 6e64 5f65 7665 6e74 7328  t.append_events(
-0000b670: 5c6e 2020 2020 7374 7265 616d 5f6e 616d  \n    stream_nam
-0000b680: 653d 7374 7265 616d 5f6e 616d 6532 2c5c  e=stream_name2,\
-0000b690: 6e20 2020 2065 7870 6563 7465 645f 706f  n    expected_po
-0000b6a0: 7369 7469 6f6e 3d4e 6f6e 652c 5c6e 2020  sition=None,\n  
-0000b6b0: 2020 6576 656e 7473 3d5b 6576 656e 7434    events=[event4
-0000b6c0: 5d2c 5c6e 295c 6e5c 6e23 2053 7562 7363  ],\n)\n\n# Subsc
-0000b6d0: 7269 6265 2066 726f 6d20 7468 6520 6669  ribe from the fi
-0000b6e0: 7273 7420 7265 636f 7264 6564 2065 7665  rst recorded eve
-0000b6f0: 6e74 2069 6e20 7468 6520 6461 7461 6261  nt in the databa
-0000b700: 7365 2e5c 6e73 7562 7363 7269 7074 696f  se.\nsubscriptio
-0000b710: 6e20 3d20 636c 6965 6e74 2e73 7562 7363  n = client.subsc
-0000b720: 7269 6265 5f61 6c6c 5f65 7665 6e74 7328  ribe_all_events(
-0000b730: 295c 6e72 6563 6569 7665 645f 6576 656e  )\nreceived_even
-0000b740: 7473 203d 205b 5d5c 6e5c 6e23 2050 726f  ts = []\n\n# Pro
-0000b750: 6365 7373 2065 7665 6e74 7320 7265 6365  cess events rece
-0000b760: 6976 6564 2066 726f 6d20 7468 6520 6361  ived from the ca
-0000b770: 7463 682d 7570 2073 7562 7363 7269 7074  tch-up subscript
-0000b780: 696f 6e2e 5c6e 666f 7220 6576 656e 7420  ion.\nfor event 
-0000b790: 696e 2073 7562 7363 7269 7074 696f 6e3a  in subscription:
-0000b7a0: 5c6e 2020 2020 6c61 7374 5f63 6f6d 6d69  \n    last_commi
-0000b7b0: 745f 706f 7369 7469 6f6e 203d 2065 7665  t_position = eve
-0000b7c0: 6e74 2e63 6f6d 6d69 745f 706f 7369 7469  nt.commit_positi
-0000b7d0: 6f6e 5c6e 2020 2020 7265 6365 6976 6564  on\n    received
-0000b7e0: 5f65 7665 6e74 732e 6170 7065 6e64 2865  _events.append(e
-0000b7f0: 7665 6e74 295c 6e20 2020 2069 6620 6576  vent)\n    if ev
-0000b800: 656e 742e 6964 203d 3d20 6576 656e 7434  ent.id == event4
-0000b810: 2e69 643a 5c6e 2020 2020 2020 2020 6272  .id:\n        br
-0000b820: 6561 6b5c 6e5c 6e61 7373 6572 7420 7265  eak\n\nassert re
-0000b830: 6365 6976 6564 5f65 7665 6e74 735b 2d34  ceived_events[-4
-0000b840: 5d2e 6964 203d 3d20 6576 656e 7431 2e69  ].id == event1.i
-0000b850: 645c 6e61 7373 6572 7420 7265 6365 6976  d\nassert receiv
-0000b860: 6564 5f65 7665 6e74 735b 2d33 5d2e 6964  ed_events[-3].id
-0000b870: 203d 3d20 6576 656e 7432 2e69 645c 6e61   == event2.id\na
-0000b880: 7373 6572 7420 7265 6365 6976 6564 5f65  ssert received_e
-0000b890: 7665 6e74 735b 2d32 5d2e 6964 203d 3d20  vents[-2].id == 
-0000b8a0: 6576 656e 7433 2e69 645c 6e61 7373 6572  event3.id\nasser
-0000b8b0: 7420 7265 6365 6976 6564 5f65 7665 6e74  t received_event
-0000b8c0: 735b 2d31 5d2e 6964 203d 3d20 6576 656e  s[-1].id == even
-0000b8d0: 7434 2e69 645c 6e5c 6e23 2041 7070 656e  t4.id\n\n# Appen
-0000b8e0: 6420 7375 6273 6571 7565 6e74 2065 7665  d subsequent eve
-0000b8f0: 6e74 7320 746f 2074 6865 2073 7472 6561  nts to the strea
-0000b900: 6d2e 5c6e 6576 656e 7435 203d 204e 6577  m.\nevent5 = New
-0000b910: 4576 656e 7428 7479 7065 3d5c 274f 7264  Event(type=\'Ord
-0000b920: 6572 5570 6461 7465 645c 272c 2064 6174  erUpdated\', dat
-0000b930: 613d 625c 2764 6174 6135 5c27 295c 6e63  a=b\'data5\')\nc
-0000b940: 6c69 656e 742e 6170 7065 6e64 5f65 7665  lient.append_eve
-0000b950: 6e74 7328 5c6e 2020 2020 7374 7265 616d  nts(\n    stream
-0000b960: 5f6e 616d 653d 7374 7265 616d 5f6e 616d  _name=stream_nam
-0000b970: 6532 2c5c 6e20 2020 2065 7870 6563 7465  e2,\n    expecte
-0000b980: 645f 706f 7369 7469 6f6e 3d30 2c5c 6e20  d_position=0,\n 
-0000b990: 2020 2065 7665 6e74 733d 5b65 7665 6e74     events=[event
-0000b9a0: 355d 2c5c 6e29 5c6e 5c6e 2320 5265 6365  5],\n)\n\n# Rece
-0000b9b0: 6976 6520 7375 6273 6571 7565 6e74 2065  ive subsequent e
-0000b9c0: 7665 6e74 7320 6672 6f6d 2074 6865 2073  vents from the s
-0000b9d0: 7562 7363 7269 7074 696f 6e2e 5c6e 666f  ubscription.\nfo
-0000b9e0: 7220 6576 656e 7420 696e 2073 7562 7363  r event in subsc
-0000b9f0: 7269 7074 696f 6e3a 5c6e 2020 2020 6c61  ription:\n    la
-0000ba00: 7374 5f63 6f6d 6d69 745f 706f 7369 7469  st_commit_positi
-0000ba10: 6f6e 203d 2065 7665 6e74 2e63 6f6d 6d69  on = event.commi
-0000ba20: 745f 706f 7369 7469 6f6e 5c6e 2020 2020  t_position\n    
-0000ba30: 7265 6365 6976 6564 5f65 7665 6e74 732e  received_events.
-0000ba40: 6170 7065 6e64 2865 7665 6e74 295c 6e20  append(event)\n 
-0000ba50: 2020 2069 6620 6576 656e 742e 6964 203d     if event.id =
-0000ba60: 3d20 6576 656e 7435 2e69 643a 5c6e 2020  = event5.id:\n  
-0000ba70: 2020 2020 2020 6272 6561 6b5c 6e5c 6e5c        break\n\n\
-0000ba80: 6e61 7373 6572 7420 7265 6365 6976 6564  nassert received
-0000ba90: 5f65 7665 6e74 735b 2d35 5d2e 6964 203d  _events[-5].id =
-0000baa0: 3d20 6576 656e 7431 2e69 645c 6e61 7373  = event1.id\nass
-0000bab0: 6572 7420 7265 6365 6976 6564 5f65 7665  ert received_eve
-0000bac0: 6e74 735b 2d34 5d2e 6964 203d 3d20 6576  nts[-4].id == ev
-0000bad0: 656e 7432 2e69 645c 6e61 7373 6572 7420  ent2.id\nassert 
-0000bae0: 7265 6365 6976 6564 5f65 7665 6e74 735b  received_events[
-0000baf0: 2d33 5d2e 6964 203d 3d20 6576 656e 7433  -3].id == event3
-0000bb00: 2e69 645c 6e61 7373 6572 7420 7265 6365  .id\nassert rece
-0000bb10: 6976 6564 5f65 7665 6e74 735b 2d32 5d2e  ived_events[-2].
-0000bb20: 6964 203d 3d20 6576 656e 7434 2e69 645c  id == event4.id\
-0000bb30: 6e61 7373 6572 7420 7265 6365 6976 6564  nassert received
-0000bb40: 5f65 7665 6e74 735b 2d31 5d2e 6964 203d  _events[-1].id =
-0000bb50: 3d20 6576 656e 7435 2e69 645c 6e5c 6e5c  = event5.id\n\n\
-0000bb60: 6e23 2041 7070 656e 6420 6d6f 7265 2065  n# Append more e
-0000bb70: 7665 6e74 7320 746f 2074 6865 2073 7472  vents to the str
-0000bb80: 6561 6d2e 5c6e 6576 656e 7436 203d 204e  eam.\nevent6 = N
-0000bb90: 6577 4576 656e 7428 7479 7065 3d5c 274f  ewEvent(type=\'O
-0000bba0: 7264 6572 4465 6c65 7465 645c 272c 2064  rderDeleted\', d
-0000bbb0: 6174 613d 625c 2764 6174 6136 5c27 295c  ata=b\'data6\')\
-0000bbc0: 6e63 6c69 656e 742e 6170 7065 6e64 5f65  nclient.append_e
-0000bbd0: 7665 6e74 7328 5c6e 2020 2020 7374 7265  vents(\n    stre
-0000bbe0: 616d 5f6e 616d 653d 7374 7265 616d 5f6e  am_name=stream_n
-0000bbf0: 616d 6532 2c5c 6e20 2020 2065 7870 6563  ame2,\n    expec
-0000bc00: 7465 645f 706f 7369 7469 6f6e 3d31 2c5c  ted_position=1,\
-0000bc10: 6e20 2020 2065 7665 6e74 733d 5b65 7665  n    events=[eve
-0000bc20: 6e74 365d 2c5c 6e29 5c6e 5c6e 5c6e 2320  nt6],\n)\n\n\n# 
-0000bc30: 5265 7375 6d65 2073 7562 7363 7269 6269  Resume subscribi
-0000bc40: 6e67 2066 726f 6d20 7468 6520 6c61 7374  ng from the last
-0000bc50: 2063 6f6d 6d69 7420 706f 7369 7469 6f6e   commit position
-0000bc60: 2e5c 6e73 7562 7363 7269 7074 696f 6e20  .\nsubscription 
-0000bc70: 3d20 636c 6965 6e74 2e73 7562 7363 7269  = client.subscri
-0000bc80: 6265 5f61 6c6c 5f65 7665 6e74 7328 5c6e  be_all_events(\n
-0000bc90: 2020 2020 636f 6d6d 6974 5f70 6f73 6974      commit_posit
-0000bca0: 696f 6e3d 6c61 7374 5f63 6f6d 6d69 745f  ion=last_commit_
-0000bcb0: 706f 7369 7469 6f6e 5c6e 295c 6e5c 6e5c  position\n)\n\n\
-0000bcc0: 6e23 2043 6174 6368 2075 7020 6279 2072  n# Catch up by r
-0000bcd0: 6563 6569 7669 6e67 2074 6865 206e 6577  eceiving the new
-0000bce0: 2065 7665 6e74 2066 726f 6d20 7468 6520   event from the 
-0000bcf0: 7375 6273 6372 6970 7469 6f6e 2e5c 6e66  subscription.\nf
-0000bd00: 6f72 2065 7665 6e74 2069 6e20 7375 6273  or event in subs
-0000bd10: 6372 6970 7469 6f6e 3a5c 6e20 2020 2072  cription:\n    r
-0000bd20: 6563 6569 7665 645f 6576 656e 7473 2e61  eceived_events.a
-0000bd30: 7070 656e 6428 6576 656e 7429 5c6e 2020  ppend(event)\n  
-0000bd40: 2020 6966 2065 7665 6e74 2e69 6420 3d3d    if event.id ==
-0000bd50: 2065 7665 6e74 362e 6964 3a5c 6e20 2020   event6.id:\n   
-0000bd60: 2020 2020 2062 7265 616b 5c6e 5c6e 6173       break\n\nas
-0000bd70: 7365 7274 2072 6563 6569 7665 645f 6576  sert received_ev
-0000bd80: 656e 7473 5b2d 365d 2e69 6420 3d3d 2065  ents[-6].id == e
-0000bd90: 7665 6e74 312e 6964 5c6e 6173 7365 7274  vent1.id\nassert
-0000bda0: 2072 6563 6569 7665 645f 6576 656e 7473   received_events
-0000bdb0: 5b2d 355d 2e69 6420 3d3d 2065 7665 6e74  [-5].id == event
-0000bdc0: 322e 6964 5c6e 6173 7365 7274 2072 6563  2.id\nassert rec
-0000bdd0: 6569 7665 645f 6576 656e 7473 5b2d 345d  eived_events[-4]
-0000bde0: 2e69 6420 3d3d 2065 7665 6e74 332e 6964  .id == event3.id
-0000bdf0: 5c6e 6173 7365 7274 2072 6563 6569 7665  \nassert receive
-0000be00: 645f 6576 656e 7473 5b2d 335d 2e69 6420  d_events[-3].id 
-0000be10: 3d3d 2065 7665 6e74 342e 6964 5c6e 6173  == event4.id\nas
-0000be20: 7365 7274 2072 6563 6569 7665 645f 6576  sert received_ev
-0000be30: 656e 7473 5b2d 325d 2e69 6420 3d3d 2065  ents[-2].id == e
-0000be40: 7665 6e74 352e 6964 5c6e 6173 7365 7274  vent5.id\nassert
-0000be50: 2072 6563 6569 7665 645f 6576 656e 7473   received_events
-0000be60: 5b2d 315d 2e69 6420 3d3d 2065 7665 6e74  [-1].id == event
-0000be70: 362e 6964 5c6e 5c6e 5c6e 2320 4170 7065  6.id\n\n\n# Appe
-0000be80: 6e64 2074 6872 6565 206d 6f72 6520 6576  nd three more ev
-0000be90: 656e 7473 2074 6f20 6120 6e65 7720 7374  ents to a new st
-0000bea0: 7265 616d 2e5c 6e73 7472 6561 6d5f 6e61  ream.\nstream_na
-0000beb0: 6d65 3320 3d20 7374 7228 7575 6964 3428  me3 = str(uuid4(
-0000bec0: 2929 5c6e 6576 656e 7437 203d 204e 6577  ))\nevent7 = New
-0000bed0: 4576 656e 7428 7479 7065 3d5c 274f 7264  Event(type=\'Ord
-0000bee0: 6572 4372 6561 7465 645c 272c 2064 6174  erCreated\', dat
-0000bef0: 613d 625c 2764 6174 6137 5c27 295c 6e65  a=b\'data7\')\ne
-0000bf00: 7665 6e74 3820 3d20 4e65 7745 7665 6e74  vent8 = NewEvent
-0000bf10: 2874 7970 653d 5c27 4f72 6465 7255 7064  (type=\'OrderUpd
-0000bf20: 6174 6564 5c27 2c20 6461 7461 3d62 5c27  ated\', data=b\'
-0000bf30: 6461 7461 385c 2729 5c6e 6576 656e 7439  data8\')\nevent9
-0000bf40: 203d 204e 6577 4576 656e 7428 7479 7065   = NewEvent(type
-0000bf50: 3d5c 274f 7264 6572 4465 6c65 7465 645c  =\'OrderDeleted\
-0000bf60: 272c 2064 6174 613d 625c 2764 6174 6139  ', data=b\'data9
-0000bf70: 5c27 295c 6e5c 6e63 6c69 656e 742e 6170  \')\n\nclient.ap
-0000bf80: 7065 6e64 5f65 7665 6e74 7328 5c6e 2020  pend_events(\n  
-0000bf90: 2020 7374 7265 616d 5f6e 616d 653d 7374    stream_name=st
-0000bfa0: 7265 616d 5f6e 616d 6533 2c5c 6e20 2020  ream_name3,\n   
-0000bfb0: 2065 7870 6563 7465 645f 706f 7369 7469   expected_positi
-0000bfc0: 6f6e 3d4e 6f6e 652c 5c6e 2020 2020 6576  on=None,\n    ev
-0000bfd0: 656e 7473 3d5b 6576 656e 7437 2c20 6576  ents=[event7, ev
-0000bfe0: 656e 7438 2c20 6576 656e 7439 5d2c 5c6e  ent8, event9],\n
-0000bff0: 295c 6e5c 6e23 2052 6563 6569 7665 2074  )\n\n# Receive t
-0000c000: 6865 2074 6872 6565 206e 6577 2065 7665  he three new eve
-0000c010: 6e74 7320 6672 6f6d 2074 6865 2072 6573  nts from the res
-0000c020: 756d 6564 2073 7562 7363 7269 7074 696f  umed subscriptio
-0000c030: 6e2e 5c6e 666f 7220 6576 656e 7420 696e  n.\nfor event in
-0000c040: 2073 7562 7363 7269 7074 696f 6e3a 5c6e   subscription:\n
-0000c050: 2020 2020 7265 6365 6976 6564 5f65 7665      received_eve
-0000c060: 6e74 732e 6170 7065 6e64 2865 7665 6e74  nts.append(event
-0000c070: 295c 6e20 2020 2069 6620 6576 656e 742e  )\n    if event.
-0000c080: 6964 203d 3d20 6576 656e 7439 2e69 643a  id == event9.id:
-0000c090: 5c6e 2020 2020 2020 2020 6272 6561 6b5c  \n        break\
-0000c0a0: 6e5c 6e61 7373 6572 7420 7265 6365 6976  n\nassert receiv
-0000c0b0: 6564 5f65 7665 6e74 735b 2d39 5d2e 6964  ed_events[-9].id
-0000c0c0: 203d 3d20 6576 656e 7431 2e69 645c 6e61   == event1.id\na
-0000c0d0: 7373 6572 7420 7265 6365 6976 6564 5f65  ssert received_e
-0000c0e0: 7665 6e74 735b 2d38 5d2e 6964 203d 3d20  vents[-8].id == 
-0000c0f0: 6576 656e 7432 2e69 645c 6e61 7373 6572  event2.id\nasser
-0000c100: 7420 7265 6365 6976 6564 5f65 7665 6e74  t received_event
-0000c110: 735b 2d37 5d2e 6964 203d 3d20 6576 656e  s[-7].id == even
-0000c120: 7433 2e69 645c 6e61 7373 6572 7420 7265  t3.id\nassert re
-0000c130: 6365 6976 6564 5f65 7665 6e74 735b 2d36  ceived_events[-6
-0000c140: 5d2e 6964 203d 3d20 6576 656e 7434 2e69  ].id == event4.i
-0000c150: 645c 6e61 7373 6572 7420 7265 6365 6976  d\nassert receiv
-0000c160: 6564 5f65 7665 6e74 735b 2d35 5d2e 6964  ed_events[-5].id
-0000c170: 203d 3d20 6576 656e 7435 2e69 645c 6e61   == event5.id\na
-0000c180: 7373 6572 7420 7265 6365 6976 6564 5f65  ssert received_e
-0000c190: 7665 6e74 735b 2d34 5d2e 6964 203d 3d20  vents[-4].id == 
-0000c1a0: 6576 656e 7436 2e69 645c 6e61 7373 6572  event6.id\nasser
-0000c1b0: 7420 7265 6365 6976 6564 5f65 7665 6e74  t received_event
-0000c1c0: 735b 2d33 5d2e 6964 203d 3d20 6576 656e  s[-3].id == even
-0000c1d0: 7437 2e69 645c 6e61 7373 6572 7420 7265  t7.id\nassert re
-0000c1e0: 6365 6976 6564 5f65 7665 6e74 735b 2d32  ceived_events[-2
-0000c1f0: 5d2e 6964 203d 3d20 6576 656e 7438 2e69  ].id == event8.i
-0000c200: 645c 6e61 7373 6572 7420 7265 6365 6976  d\nassert receiv
-0000c210: 6564 5f65 7665 6e74 735b 2d31 5d2e 6964  ed_events[-1].id
-0000c220: 203d 3d20 6576 656e 7439 2e69 645c 6e60   == event9.id\n`
-0000c230: 6060 5c6e 5c6e 5468 6520 6361 7463 682d  ``\n\nThe catch-
-0000c240: 7570 2073 7562 7363 7269 7074 696f 6e20  up subscription 
-0000c250: 6361 6c6c 2069 7320 656e 6465 6420 6173  call is ended as
-0000c260: 2073 6f6f 6e20 6173 2074 6865 2073 7562   soon as the sub
-0000c270: 7363 7269 7074 696f 6e20 6f62 6a65 6374  scription object
-0000c280: 5c6e 676f 6573 206f 7574 206f 6620 7363  \ngoes out of sc
-0000c290: 6f70 6520 6f72 2069 7320 6578 706c 6963  ope or is explic
-0000c2a0: 6974 6c79 2064 656c 6574 6564 2066 726f  itly deleted fro
-0000c2b0: 6d20 6d65 6d6f 7279 2e5c 6e5c 6e60 6060  m memory.\n\n```
-0000c2c0: 7079 7468 6f6e 5c6e 2320 456e 6420 7468  python\n# End th
-0000c2d0: 6520 7375 6273 6372 6970 7469 6f6e 2e5c  e subscription.\
-0000c2e0: 6e64 656c 2073 7562 7363 7269 7074 696f  ndel subscriptio
-0000c2f0: 6e5c 6e60 6060 5c6e 5c6e 2323 2320 5375  n\n```\n\n### Su
-0000c300: 6273 6372 6962 6520 7374 7265 616d 2065  bscribe stream e
-0000c310: 7665 6e74 735c 6e5c 6e54 6865 6073 7562  vents\n\nThe`sub
-0000c320: 7363 7269 6265 5f73 7472 6561 6d5f 6576  scribe_stream_ev
-0000c330: 656e 7473 2829 6020 6d65 7468 6f64 2063  ents()` method c
-0000c340: 616e 2062 6520 7573 6564 2074 6f20 7374  an be used to st
-0000c350: 6172 7420 6120 2263 6174 6368 2d75 7022  art a "catch-up"
-0000c360: 2073 7562 7363 7269 7074 696f 6e5c 6e74   subscription\nt
-0000c370: 6861 7420 6361 6e20 7265 7475 726e 2065  hat can return e
-0000c380: 7665 6e74 7320 7468 6174 2061 7265 2072  vents that are r
-0000c390: 6563 6f72 6465 6420 696e 2061 2073 696e  ecorded in a sin
-0000c3a0: 676c 6520 7374 7265 616d 2e5c 6e5c 6e54  gle stream.\n\nT
-0000c3b0: 6869 7320 6d65 7468 6f64 2074 616b 6573  his method takes
-0000c3c0: 2061 2072 6571 7569 7265 6420 6073 7472   a required `str
-0000c3d0: 6561 6d5f 6e61 6d65 6020 6172 6775 6d65  eam_name` argume
-0000c3e0: 6e74 2c20 7768 6963 6820 7370 6563 6966  nt, which specif
-0000c3f0: 6965 7320 7468 6520 6e61 6d65 206f 6620  ies the name of 
-0000c400: 7468 6520 7374 7265 616d 5c6e 6672 6f6d  the stream\nfrom
-0000c410: 2077 6869 6368 2072 6563 6f72 6465 6420   which recorded 
-0000c420: 6576 656e 7473 2077 696c 6c20 6265 2072  events will be r
-0000c430: 6563 6569 7665 642e 5c6e 5c6e 5468 6973  eceived.\n\nThis
-0000c440: 206d 6574 686f 6420 616c 736f 2074 616b   method also tak
-0000c450: 6573 2074 776f 206f 7074 696f 6e61 6c20  es two optional 
-0000c460: 6172 6775 6d65 6e74 732c 2060 7374 7265  arguments, `stre
-0000c470: 616d 5f70 6f73 6974 696f 6e60 2c20 616e  am_position`, an
-0000c480: 6420 6074 696d 656f 7574 602e 5c6e 5c6e  d `timeout`.\n\n
-0000c490: 5468 6520 6f70 7469 6f6e 616c 2060 7374  The optional `st
-0000c4a0: 7265 616d 5f70 6f73 6974 696f 6e60 2061  ream_position` a
-0000c4b0: 7267 756d 656e 7420 7370 6563 6966 6965  rgument specifie
-0000c4c0: 7320 6120 706f 7369 7469 6f6e 2069 6e20  s a position in 
-0000c4d0: 7468 6520 7374 7265 616d 2066 726f 6d20  the stream from 
-0000c4e0: 7768 6963 685c 6e72 6563 6f72 6465 6420  which\nrecorded 
-0000c4f0: 6576 656e 7473 2077 696c 6c20 6265 2072  events will be r
-0000c500: 6563 6569 7665 642e 2054 6865 2065 7665  eceived. The eve
-0000c510: 6e74 2061 7420 7468 6520 7370 6563 6966  nt at the specif
-0000c520: 6965 6420 7374 7265 616d 2070 6f73 6974  ied stream posit
-0000c530: 696f 6e20 7769 6c6c 206e 6f74 5c6e 6265  ion will not\nbe
-0000c540: 2069 6e63 6c75 6465 642e 5c6e 5c6e 5468   included.\n\nTh
-0000c550: 6520 6f70 7469 6f6e 616c 2060 7469 6d65  e optional `time
-0000c560: 6f75 7460 2061 7267 756d 656e 7420 6973  out` argument is
-0000c570: 2061 2050 7974 686f 6e20 6066 6c6f 6174   a Python `float
-0000c580: 6020 7468 6174 2073 6574 735c 6e61 2064  ` that sets\na d
-0000c590: 6561 646c 696e 6520 666f 7220 7468 6520  eadline for the 
-0000c5a0: 636f 6d70 6c65 7469 6f6e 206f 6620 7468  completion of th
-0000c5b0: 6520 6752 5043 206f 7065 7261 7469 6f6e  e gRPC operation
-0000c5c0: 2e5c 6e5c 6e54 6865 2065 7861 6d70 6c65  .\n\nThe example
-0000c5d0: 2062 656c 6f77 2073 686f 7773 2068 6f77   below shows how
-0000c5e0: 2074 6f20 7374 6172 7420 6120 6361 7463   to start a catc
-0000c5f0: 682d 7570 2073 7562 7363 7269 7074 696f  h-up subscriptio
-0000c600: 6e20 746f 2061 2073 7472 6561 6d2e 5c6e  n to a stream.\n
-0000c610: 5c6e 6060 6070 7974 686f 6e5c 6e5c 6e23  \n```python\n\n#
-0000c620: 2053 7562 7363 7269 6265 2074 6f20 6576   Subscribe to ev
-0000c630: 656e 7473 2066 726f 6d20 7374 7265 616d  ents from stream
-0000c640: 322c 2066 726f 6d20 7468 6520 7374 6172  2, from the star
-0000c650: 742e 5c6e 7375 6273 6372 6970 7469 6f6e  t.\nsubscription
-0000c660: 203d 2063 6c69 656e 742e 7375 6273 6372   = client.subscr
-0000c670: 6962 655f 7374 7265 616d 5f65 7665 6e74  ibe_stream_event
-0000c680: 7328 7374 7265 616d 5f6e 616d 653d 7374  s(stream_name=st
-0000c690: 7265 616d 5f6e 616d 6532 295c 6e5c 6e23  ream_name2)\n\n#
-0000c6a0: 2052 6561 6420 6672 6f6d 2074 6865 2073   Read from the s
-0000c6b0: 7562 7363 7269 7074 696f 6e2e 5c6e 6576  ubscription.\nev
-0000c6c0: 656e 7473 203d 205b 5d5c 6e66 6f72 2065  ents = []\nfor e
-0000c6d0: 7665 6e74 2069 6e20 7375 6273 6372 6970  vent in subscrip
-0000c6e0: 7469 6f6e 3a5c 6e20 2020 2065 7665 6e74  tion:\n    event
-0000c6f0: 732e 6170 7065 6e64 2865 7665 6e74 295c  s.append(event)\
-0000c700: 6e20 2020 2069 6620 6576 656e 742e 6964  n    if event.id
-0000c710: 203d 3d20 6576 656e 7436 2e69 643a 5c6e   == event6.id:\n
-0000c720: 2020 2020 2020 2020 6272 6561 6b5c 6e5c          break\n\
-0000c730: 6e23 2043 6865 636b 2077 6520 676f 7420  n# Check we got 
-0000c740: 6576 656e 7473 206f 6e6c 7920 6672 6f6d  events only from
-0000c750: 2073 7472 6561 6d32 2e5c 6e61 7373 6572   stream2.\nasser
-0000c760: 7420 6c65 6e28 6576 656e 7473 2920 3d3d  t len(events) ==
-0000c770: 2033 5c6e 6576 656e 7473 5b30 5d2e 7374   3\nevents[0].st
-0000c780: 7265 616d 5f6e 616d 6520 3d3d 2073 7472  ream_name == str
-0000c790: 6561 6d5f 6e61 6d65 325c 6e65 7665 6e74  eam_name2\nevent
-0000c7a0: 735b 315d 2e73 7472 6561 6d5f 6e61 6d65  s[1].stream_name
-0000c7b0: 203d 3d20 7374 7265 616d 5f6e 616d 6532   == stream_name2
-0000c7c0: 5c6e 6576 656e 7473 5b32 5d2e 7374 7265  \nevents[2].stre
-0000c7d0: 616d 5f6e 616d 6520 3d3d 2073 7472 6561  am_name == strea
-0000c7e0: 6d5f 6e61 6d65 325c 6e5c 6e23 2041 7070  m_name2\n\n# App
-0000c7f0: 656e 6420 616e 6f74 6865 7220 6576 656e  end another even
-0000c800: 7420 746f 2073 7472 6561 6d33 2e5c 6e65  t to stream3.\ne
-0000c810: 7665 6e74 3130 203d 204e 6577 4576 656e  vent10 = NewEven
-0000c820: 7428 7479 7065 3d22 4f72 6465 7255 6e64  t(type="OrderUnd
-0000c830: 656c 6574 6564 222c 2064 6174 613d 625c  eleted", data=b\
-0000c840: 2764 6174 6131 305c 2729 5c6e 636c 6965  'data10\')\nclie
-0000c850: 6e74 2e61 7070 656e 645f 6576 656e 7473  nt.append_events
-0000c860: 285c 6e20 2020 2073 7472 6561 6d5f 6e61  (\n    stream_na
-0000c870: 6d65 3d73 7472 6561 6d5f 6e61 6d65 332c  me=stream_name3,
-0000c880: 5c6e 2020 2020 6578 7065 6374 6564 5f70  \n    expected_p
-0000c890: 6f73 6974 696f 6e3d 322c 5c6e 2020 2020  osition=2,\n    
-0000c8a0: 6576 656e 7473 3d5b 6576 656e 7431 305d  events=[event10]
-0000c8b0: 2c5c 6e29 5c6e 5c6e 2320 4170 7065 6e64  ,\n)\n\n# Append
-0000c8c0: 2061 6e6f 7468 6572 2065 7665 6e74 2074   another event t
-0000c8d0: 6f20 7374 7265 616d 322e 5c6e 6576 656e  o stream2.\neven
-0000c8e0: 7431 3120 3d20 4e65 7745 7665 6e74 2874  t11 = NewEvent(t
-0000c8f0: 7970 653d 224f 7264 6572 556e 6465 6c65  ype="OrderUndele
-0000c900: 7465 6422 2c20 6461 7461 3d62 5c27 6461  ted", data=b\'da
-0000c910: 7461 3131 5c27 295c 6e63 6c69 656e 742e  ta11\')\nclient.
-0000c920: 6170 7065 6e64 5f65 7665 6e74 7328 5c6e  append_events(\n
-0000c930: 2020 2020 7374 7265 616d 5f6e 616d 653d      stream_name=
-0000c940: 7374 7265 616d 5f6e 616d 6532 2c5c 6e20  stream_name2,\n 
-0000c950: 2020 2065 7870 6563 7465 645f 706f 7369     expected_posi
-0000c960: 7469 6f6e 3d32 2c5c 6e20 2020 2065 7665  tion=2,\n    eve
-0000c970: 6e74 733d 5b65 7665 6e74 3131 5d5c 6e29  nts=[event11]\n)
-0000c980: 5c6e 5c6e 2320 436f 6e74 696e 7565 2072  \n\n# Continue r
-0000c990: 6561 6469 6e67 2066 726f 6d20 7468 6520  eading from the 
-0000c9a0: 7375 6273 6372 6970 7469 6f6e 2e5c 6e66  subscription.\nf
-0000c9b0: 6f72 2065 7665 6e74 2069 6e20 7375 6273  or event in subs
-0000c9c0: 6372 6970 7469 6f6e 3a5c 6e20 2020 2065  cription:\n    e
-0000c9d0: 7665 6e74 732e 6170 7065 6e64 2865 7665  vents.append(eve
-0000c9e0: 6e74 295c 6e20 2020 2069 6620 6576 656e  nt)\n    if even
-0000c9f0: 742e 6964 203d 3d20 6576 656e 7431 312e  t.id == event11.
-0000ca00: 6964 3a5c 6e20 2020 2020 2020 2062 7265  id:\n        bre
-0000ca10: 616b 5c6e 5c6e 2320 4368 6563 6b20 7765  ak\n\n# Check we
-0000ca20: 2067 6f74 2065 7665 6e74 7320 6f6e 6c79   got events only
-0000ca30: 2066 726f 6d20 7374 7265 616d 322e 5c6e   from stream2.\n
-0000ca40: 6173 7365 7274 206c 656e 2865 7665 6e74  assert len(event
-0000ca50: 7329 203d 3d20 345c 6e65 7665 6e74 735b  s) == 4\nevents[
-0000ca60: 305d 2e73 7472 6561 6d5f 6e61 6d65 203d  0].stream_name =
-0000ca70: 3d20 7374 7265 616d 5f6e 616d 6532 5c6e  = stream_name2\n
-0000ca80: 6576 656e 7473 5b31 5d2e 7374 7265 616d  events[1].stream
-0000ca90: 5f6e 616d 6520 3d3d 2073 7472 6561 6d5f  _name == stream_
-0000caa0: 6e61 6d65 325c 6e65 7665 6e74 735b 325d  name2\nevents[2]
-0000cab0: 2e73 7472 6561 6d5f 6e61 6d65 203d 3d20  .stream_name == 
-0000cac0: 7374 7265 616d 5f6e 616d 6532 5c6e 6576  stream_name2\nev
-0000cad0: 656e 7473 5b33 5d2e 7374 7265 616d 5f6e  ents[3].stream_n
-0000cae0: 616d 6520 3d3d 2073 7472 6561 6d5f 6e61  ame == stream_na
-0000caf0: 6d65 325c 6e60 6060 5c6e 5c6e 5468 6520  me2\n```\n\nThe 
-0000cb00: 6578 616d 706c 6520 6265 6c6f 7720 7368  example below sh
-0000cb10: 6f77 7320 686f 7720 746f 2073 7461 7274  ows how to start
-0000cb20: 2061 2063 6174 6368 2d75 7020 7375 6273   a catch-up subs
-0000cb30: 6372 6970 7469 6f6e 2074 6f20 6120 7374  cription to a st
-0000cb40: 7265 616d 2066 726f 6d20 615c 6e73 7065  ream from a\nspe
-0000cb50: 6369 6669 6320 7374 7265 616d 2070 6f73  cific stream pos
-0000cb60: 6974 696f 6e2e 5c6e 5c6e 6060 6070 7974  ition.\n\n```pyt
-0000cb70: 686f 6e5c 6e5c 6e23 2053 7562 7363 7269  hon\n\n# Subscri
-0000cb80: 6265 2074 6f20 6576 656e 7473 2066 726f  be to events fro
-0000cb90: 6d20 7374 7265 616d 322c 2066 726f 6d20  m stream2, from 
-0000cba0: 7468 6520 7374 6172 742e 5c6e 7375 6273  the start.\nsubs
-0000cbb0: 6372 6970 7469 6f6e 203d 2063 6c69 656e  cription = clien
-0000cbc0: 742e 7375 6273 6372 6962 655f 7374 7265  t.subscribe_stre
-0000cbd0: 616d 5f65 7665 6e74 7328 5c6e 2020 2020  am_events(\n    
-0000cbe0: 7374 7265 616d 5f6e 616d 653d 7374 7265  stream_name=stre
-0000cbf0: 616d 5f6e 616d 6532 2c5c 6e20 2020 2073  am_name2,\n    s
-0000cc00: 7472 6561 6d5f 706f 7369 7469 6f6e 3d31  tream_position=1
-0000cc10: 2c5c 6e29 5c6e 5c6e 2320 5265 6164 2065  ,\n)\n\n# Read e
-0000cc20: 7665 6e74 2066 726f 6d20 7468 6520 7375  vent from the su
-0000cc30: 6273 6372 6970 7469 6f6e 2e5c 6e65 7665  bscription.\neve
-0000cc40: 6e74 7320 3d20 5b5d 5c6e 666f 7220 6576  nts = []\nfor ev
-0000cc50: 656e 7420 696e 2073 7562 7363 7269 7074  ent in subscript
-0000cc60: 696f 6e3a 5c6e 2020 2020 6576 656e 7473  ion:\n    events
-0000cc70: 2e61 7070 656e 6428 6576 656e 7429 5c6e  .append(event)\n
-0000cc80: 2020 2020 6966 2065 7665 6e74 2e69 6420      if event.id 
-0000cc90: 3d3d 2065 7665 6e74 3131 2e69 643a 5c6e  == event11.id:\n
-0000cca0: 2020 2020 2020 2020 6272 6561 6b5c 6e5c          break\n\
-0000ccb0: 6e23 2043 6865 636b 2077 6520 676f 7420  n# Check we got 
-0000ccc0: 6576 656e 7473 206f 6e6c 7920 6166 7465  events only afte
-0000ccd0: 7220 706f 7369 7469 6f6e 2031 2e5c 6e61  r position 1.\na
-0000cce0: 7373 6572 7420 6c65 6e28 6576 656e 7473  ssert len(events
-0000ccf0: 2920 3d3d 2032 5c6e 6576 656e 7473 5b30  ) == 2\nevents[0
-0000cd00: 5d2e 6964 203d 3d20 6576 656e 7436 2e69  ].id == event6.i
-0000cd10: 645c 6e65 7665 6e74 735b 305d 2e73 7472  d\nevents[0].str
-0000cd20: 6561 6d5f 706f 7369 7469 6f6e 203d 3d20  eam_position == 
-0000cd30: 325c 6e65 7665 6e74 735b 305d 2e73 7472  2\nevents[0].str
-0000cd40: 6561 6d5f 6e61 6d65 203d 3d20 7374 7265  eam_name == stre
-0000cd50: 616d 5f6e 616d 6532 5c6e 6576 656e 7473  am_name2\nevents
-0000cd60: 5b31 5d2e 6964 203d 3d20 6576 656e 7431  [1].id == event1
-0000cd70: 312e 6964 5c6e 6576 656e 7473 5b31 5d2e  1.id\nevents[1].
-0000cd80: 7374 7265 616d 5f70 6f73 6974 696f 6e20  stream_position 
-0000cd90: 3d3d 2033 5c6e 6576 656e 7473 5b31 5d2e  == 3\nevents[1].
-0000cda0: 7374 7265 616d 5f6e 616d 6520 3d3d 2073  stream_name == s
-0000cdb0: 7472 6561 6d5f 6e61 6d65 325c 6e60 6060  tream_name2\n```
-0000cdc0: 5c6e 5c6e 2323 2050 6572 7369 7374 656e  \n\n## Persisten
-0000cdd0: 7420 7375 6273 6372 6970 7469 6f6e 735c  t subscriptions\
-0000cde0: 6e5c 6e23 2323 2043 7265 6174 6520 7375  n\n### Create su
-0000cdf0: 6273 6372 6970 7469 6f6e 5c6e 5c6e 2a72  bscription\n\n*r
-0000ce00: 6571 7569 7265 7320 6c65 6164 6572 2a5c  equires leader*\
-0000ce10: 6e5c 6e54 6865 206d 6574 686f 6420 6063  n\nThe method `c
-0000ce20: 7265 6174 655f 7375 6273 6372 6970 7469  reate_subscripti
-0000ce30: 6f6e 2829 6020 6361 6e20 6265 2075 7365  on()` can be use
-0000ce40: 6420 746f 2063 7265 6174 6520 615c 6e22  d to create a\n"
-0000ce50: 7065 7273 6973 7465 6e74 2073 7562 7363  persistent subsc
-0000ce60: 7269 7074 696f 6e22 2074 6f20 4576 656e  ription" to Even
-0000ce70: 7453 746f 7265 4442 2e5c 6e5c 6e54 6869  tStoreDB.\n\nThi
-0000ce80: 7320 6d65 7468 6f64 2074 616b 6573 2061  s method takes a
-0000ce90: 2072 6571 7569 7265 6420 6067 726f 7570   required `group
-0000cea0: 5f6e 616d 6560 2061 7267 756d 656e 742c  _name` argument,
-0000ceb0: 2077 6869 6368 2069 7320 7468 655c 6e6e   which is the\nn
-0000cec0: 616d 6520 6f66 2061 2022 6772 6f75 7022  ame of a "group"
-0000ced0: 206f 6620 636f 6e73 756d 6572 7320 6f66   of consumers of
-0000cee0: 2074 6865 2073 7562 7363 7269 7074 696f   the subscriptio
-0000cef0: 6e2e 5c6e 5c6e 5468 6973 206d 6574 686f  n.\n\nThis metho
-0000cf00: 6420 616c 736f 2074 616b 6573 2073 6576  d also takes sev
-0000cf10: 656e 206f 7074 696f 6e61 6c20 6172 6775  en optional argu
-0000cf20: 6d65 6e74 732c 2060 6672 6f6d 5f65 6e64  ments, `from_end
-0000cf30: 602c 2060 636f 6d6d 6974 5f70 6f73 6974  `, `commit_posit
-0000cf40: 696f 6e60 2c5c 6e60 6669 6c74 6572 5f65  ion`,\n`filter_e
-0000cf50: 7863 6c75 6465 602c 2060 6669 6c74 6572  xclude`, `filter
-0000cf60: 5f69 6e63 6c75 6465 602c 2060 6669 6c74  _include`, `filt
-0000cf70: 6572 5f62 795f 7374 7265 616d 5f6e 616d  er_by_stream_nam
-0000cf80: 6560 2c20 6063 6f6e 7375 6d65 725f 7374  e`, `consumer_st
-0000cf90: 7261 7465 6779 602c 5c6e 616e 6420 6074  rategy`,\nand `t
-0000cfa0: 696d 656f 7574 602e 5c6e 5c6e 5468 6520  imeout`.\n\nThe 
-0000cfb0: 6f70 7469 6f6e 616c 2060 6672 6f6d 5f65  optional `from_e
-0000cfc0: 6e64 6020 6172 6775 6d65 6e74 2063 616e  nd` argument can
-0000cfd0: 2062 6520 7573 6564 2074 6f20 7370 6563   be used to spec
-0000cfe0: 6966 7920 7468 6174 2074 6865 2067 726f  ify that the gro
-0000cff0: 7570 206f 6620 636f 6e73 756d 6572 735c  up of consumers\
-0000d000: 6e6f 6620 7468 6520 7375 6273 6372 6970  nof the subscrip
-0000d010: 7469 6f6e 2073 686f 756c 6420 6f6e 6c79  tion should only
-0000d020: 2072 6563 6569 7665 2065 7665 6e74 7320   receive events 
-0000d030: 7468 6174 2077 6572 6520 7265 636f 7264  that were record
-0000d040: 6564 2061 6674 6572 2074 6865 2073 7562  ed after the sub
-0000d050: 7363 7269 7074 696f 6e5c 6e77 6173 2063  scription\nwas c
-0000d060: 7265 6174 6564 2e5c 6e5c 6e41 6c74 6572  reated.\n\nAlter
-0000d070: 6e61 7469 7665 6c79 2c20 7468 6520 6f70  natively, the op
-0000d080: 7469 6f6e 616c 2060 636f 6d6d 6974 5f70  tional `commit_p
-0000d090: 6f73 6974 696f 6e60 2061 7267 756d 656e  osition` argumen
-0000d0a0: 7420 6361 6e20 6265 2075 7365 6420 746f  t can be used to
-0000d0b0: 2073 7065 6369 6679 2061 2063 6f6d 6d69   specify a commi
-0000d0c0: 745c 6e70 6f73 6974 696f 6e20 6672 6f6d  t\nposition from
-0000d0d0: 2077 6869 6368 2063 6f6d 6d69 7420 706f   which commit po
-0000d0e0: 7369 7469 6f6e 2074 6865 2067 726f 7570  sition the group
-0000d0f0: 206f 6620 636f 6e73 756d 6572 7320 6f66   of consumers of
-0000d100: 2074 6865 2073 7562 7363 7269 7074 696f   the subscriptio
-0000d110: 6e20 7368 6f75 6c64 5c6e 7265 6365 6976  n should\nreceiv
-0000d120: 6520 6576 656e 7473 2e20 506c 6561 7365  e events. Please
-0000d130: 206e 6f74 652c 2074 6865 2072 6563 6f72   note, the recor
-0000d140: 6465 6420 6576 656e 7420 6174 2074 6865  ded event at the
-0000d150: 2073 7065 6369 6669 6564 2063 6f6d 6d69   specified commi
-0000d160: 7420 706f 7369 7469 6f6e 206d 6967 6874  t position might
-0000d170: 5c6e 6265 2069 6e63 6c75 6465 6420 696e  \nbe included in
-0000d180: 2074 6865 2072 6563 6f72 6465 6420 6576   the recorded ev
-0000d190: 656e 7473 2072 6563 6569 7665 6420 6279  ents received by
-0000d1a0: 2074 6865 2067 726f 7570 206f 6620 636f   the group of co
-0000d1b0: 6e73 756d 6572 732e 5c6e 5c6e 4966 206e  nsumers.\n\nIf n
-0000d1c0: 6569 7468 6572 2060 6672 6f6d 5f65 6e64  either `from_end
-0000d1d0: 6020 6f72 2060 636f 6d6d 6974 5f70 6f73  ` or `commit_pos
-0000d1e0: 6974 696f 6e60 2061 7265 2073 7065 6369  ition` are speci
-0000d1f0: 6669 6564 2c20 7468 6520 6772 6f75 7020  fied, the group 
-0000d200: 6f66 2063 6f6e 7375 6d65 7273 5c6e 6f66  of consumers\nof
-0000d210: 2074 6865 2073 7562 7363 7269 7074 696f   the subscriptio
-0000d220: 6e20 7769 6c6c 2070 6f74 656e 7469 616c  n will potential
-0000d230: 6c79 2072 6563 6569 7665 2061 6c6c 2072  ly receive all r
-0000d240: 6563 6f72 6465 6420 6576 656e 7473 2069  ecorded events i
-0000d250: 6e20 7468 6520 6461 7461 6261 7365 2e5c  n the database.\
-0000d260: 6e5c 6e54 6865 206f 7074 696f 6e61 6c20  n\nThe optional 
-0000d270: 6066 696c 7465 725f 6578 636c 7564 6560  `filter_exclude`
-0000d280: 2061 7267 756d 656e 7420 6973 2061 2073   argument is a s
-0000d290: 6571 7565 6e63 6520 6f66 2072 6567 756c  equence of regul
-0000d2a0: 6172 2065 7870 7265 7373 696f 6e73 2074  ar expressions t
-0000d2b0: 6861 745c 6e6d 6174 6368 2072 6563 6f72  hat\nmatch recor
-0000d2c0: 6465 6420 6576 656e 7473 2074 6861 7420  ded events that 
-0000d2d0: 7368 6f75 6c64 206e 6f74 2062 6520 696e  should not be in
-0000d2e0: 636c 7564 6564 2e20 5468 6973 2061 7267  cluded. This arg
-0000d2f0: 756d 656e 7420 6973 2069 676e 6f72 6564  ument is ignored
-0000d300: 5c6e 6966 2060 6669 6c74 6572 5f69 6e63  \nif `filter_inc
-0000d310: 6c75 6465 6020 6973 2073 6574 2074 6f20  lude` is set to 
-0000d320: 6120 6e6f 6e2d 656d 7074 7920 7365 7175  a non-empty sequ
-0000d330: 656e 6365 2e20 4279 2064 6566 6175 6c74  ence. By default
-0000d340: 2c20 7468 6973 2061 7267 756d 656e 7420  , this argument 
-0000d350: 6973 2073 6574 5c6e 746f 206d 6174 6368  is set\nto match
-0000d360: 2074 6865 2065 7665 6e74 2074 7970 6573   the event types
-0000d370: 206f 6620 2273 7973 7465 6d20 6576 656e   of "system even
-0000d380: 7473 222c 2073 6f20 7468 6174 2045 7665  ts", so that Eve
-0000d390: 6e74 5374 6f72 6544 4220 7379 7374 656d  ntStoreDB system
-0000d3a0: 2065 7665 6e74 735c 6e77 696c 6c20 6e6f   events\nwill no
-0000d3b0: 7420 6e6f 726d 616c 6c79 2062 6520 7265  t normally be re
-0000d3c0: 6365 6976 6564 2e20 5365 6520 7468 6520  ceived. See the 
-0000d3d0: 4e6f 7465 7320 7365 6374 696f 6e20 6265  Notes section be
-0000d3e0: 6c6f 7720 666f 7220 6d6f 7265 2069 6e66  low for more inf
-0000d3f0: 6f72 6d61 7469 6f6e 5c6e 6162 6f75 7420  ormation\nabout 
-0000d400: 6669 6c74 6572 2065 7870 7265 7373 696f  filter expressio
-0000d410: 6e73 2e5c 6e5c 6e54 6865 206f 7074 696f  ns.\n\nThe optio
-0000d420: 6e61 6c20 6066 696c 7465 725f 696e 636c  nal `filter_incl
-0000d430: 7564 6560 2061 7267 756d 656e 7420 6973  ude` argument is
-0000d440: 2061 2073 6571 7565 6e63 6520 6f66 2072   a sequence of r
-0000d450: 6567 756c 6172 2065 7870 7265 7373 696f  egular expressio
-0000d460: 6e73 5c6e 7468 6174 206d 6174 6368 2072  ns\nthat match r
-0000d470: 6563 6f72 6465 6420 6576 656e 7473 2074  ecorded events t
-0000d480: 6861 7420 7368 6f75 6c64 2062 6520 7265  hat should be re
-0000d490: 6365 6976 6564 2e20 4279 2064 6566 6175  ceived. By defau
-0000d4a0: 6c74 2c20 7468 6973 2061 7267 756d 656e  lt, this argumen
-0000d4b0: 745c 6e69 7320 616e 2065 6d70 7479 2074  t\nis an empty t
-0000d4c0: 7570 6c65 2e20 4966 2074 6869 7320 6172  uple. If this ar
-0000d4d0: 6775 6d65 6e74 2069 7320 7365 7420 746f  gument is set to
-0000d4e0: 2061 206e 6f6e 2d65 6d70 7479 2073 6571   a non-empty seq
-0000d4f0: 7565 6e63 652c 2074 6865 5c6e 6066 696c  uence, the\n`fil
-0000d500: 7465 725f 6578 636c 7564 6560 2061 7267  ter_exclude` arg
-0000d510: 756d 656e 7420 6973 2069 676e 6f72 6564  ument is ignored
-0000d520: 2e5c 6e5c 6e54 6865 206f 7074 696f 6e61  .\n\nThe optiona
-0000d530: 6c20 6066 696c 7465 725f 6279 5f73 7472  l `filter_by_str
-0000d540: 6561 6d5f 6e61 6d65 6020 6172 6775 6d65  eam_name` argume
-0000d550: 6e74 2069 7320 6120 626f 6f6c 6561 6e20  nt is a boolean 
-0000d560: 7661 6c75 6520 7468 6174 2069 6e64 6963  value that indic
-0000d570: 6174 6573 2077 6865 7468 6572 5c6e 7468  ates whether\nth
-0000d580: 6520 6669 6c74 6572 2077 696c 6c20 6170  e filter will ap
-0000d590: 706c 7920 746f 2065 7665 6e74 2074 7970  ply to event typ
-0000d5a0: 6573 206f 7220 7374 7265 616d 206e 616d  es or stream nam
-0000d5b0: 6573 2e20 4279 2064 6566 6175 6c74 2c20  es. By default, 
-0000d5c0: 7468 6973 2076 616c 7565 2069 7320 6046  this value is `F
-0000d5d0: 616c 7365 605c 6e61 6e64 2073 6f20 7468  alse`\nand so th
-0000d5e0: 6520 6669 6c74 6572 696e 6720 7769 6c6c  e filtering will
-0000d5f0: 2061 7070 6c79 2074 6f20 7468 6520 6576   apply to the ev
-0000d600: 656e 7420 7479 7065 2073 7472 696e 6773  ent type strings
-0000d610: 206f 6620 7265 636f 7264 6564 2065 7665   of recorded eve
-0000d620: 6e74 732e 5c6e 5c6e 5468 6520 6f70 7469  nts.\n\nThe opti
-0000d630: 6f6e 616c 2060 636f 6e73 756d 6572 5f73  onal `consumer_s
-0000d640: 7472 6174 6567 7960 2061 7267 756d 656e  trategy` argumen
-0000d650: 7420 6973 2061 2050 7974 686f 6e20 6073  t is a Python `s
-0000d660: 7472 6020 7468 6174 2064 6566 696e 6573  tr` that defines
-0000d670: 5c6e 7468 6520 636f 6e73 756d 6572 2073  \nthe consumer s
-0000d680: 7472 6174 6567 7920 666f 7220 7468 6973  trategy for this
-0000d690: 2070 6572 7369 7374 656e 7420 7375 6273   persistent subs
-0000d6a0: 6372 6970 7469 6f6e 2e20 5468 6520 7661  cription. The va
-0000d6b0: 6c75 6520 6f66 2074 6869 7320 6172 6775  lue of this argu
-0000d6c0: 6d65 6e74 5c6e 6361 6e20 6265 2060 5c27  ment\ncan be `\'
-0000d6d0: 4469 7370 6174 6368 546f 5369 6e67 6c65  DispatchToSingle
-0000d6e0: 5c27 602c 2060 5c27 526f 756e 6452 6f62  \'`, `\'RoundRob
-0000d6f0: 696e 5c27 602c 2060 5c27 5069 6e6e 6564  in\'`, `\'Pinned
-0000d700: 5c27 602c 206f 7220 605c 2750 696e 6e65  \'`, or `\'Pinne
-0000d710: 6442 7943 6f72 7265 6c61 7469 6f6e 5c27  dByCorrelation\'
-0000d720: 602e 2054 6865 5c6e 6465 6661 756c 7420  `. The\ndefault 
-0000d730: 7661 6c75 6520 6973 2060 5c27 4469 7370  value is `\'Disp
-0000d740: 6174 6368 546f 5369 6e67 6c65 5c27 602e  atchToSingle\'`.
-0000d750: 5c6e 5c6e 5468 6520 6f70 7469 6f6e 616c  \n\nThe optional
-0000d760: 2060 7469 6d65 6f75 7460 2061 7267 756d   `timeout` argum
-0000d770: 656e 7420 6973 2061 2050 7974 686f 6e20  ent is a Python 
-0000d780: 6066 6c6f 6174 6020 7768 6963 6820 7365  `float` which se
-0000d790: 7473 2061 5c6e 6465 6164 6c69 6e65 2066  ts a\ndeadline f
-0000d7a0: 6f72 2074 6865 2063 6f6d 706c 6574 696f  or the completio
-0000d7b0: 6e20 6f66 2074 6865 2067 5250 4320 6f70  n of the gRPC op
-0000d7c0: 6572 6174 696f 6e2e 5c6e 5c6e 5468 6520  eration.\n\nThe 
-0000d7d0: 6d65 7468 6f64 2060 6372 6561 7465 5f73  method `create_s
-0000d7e0: 7562 7363 7269 7074 696f 6e28 2960 2064  ubscription()` d
-0000d7f0: 6f65 7320 6e6f 7420 7265 7475 726e 2061  oes not return a
-0000d800: 2076 616c 7565 2c20 6265 6361 7573 655c   value, because\
-0000d810: 6e72 6563 6f72 6465 6420 6576 656e 7473  nrecorded events
-0000d820: 2061 7265 206f 6274 6169 6e65 6420 6279   are obtained by
-0000d830: 2074 6865 2067 726f 7570 206f 6620 636f   the group of co
-0000d840: 6e73 756d 6572 7320 6f66 2074 6865 2073  nsumers of the s
-0000d850: 7562 7363 7269 7074 696f 6e5c 6e75 7369  ubscription\nusi
-0000d860: 6e67 2074 6865 2060 7265 6164 5f73 7562  ng the `read_sub
-0000d870: 7363 7269 7074 696f 6e28 2960 206d 6574  scription()` met
-0000d880: 686f 642e 5c6e 5c6e 496e 2074 6865 2065  hod.\n\nIn the e
-0000d890: 7861 6d70 6c65 2062 656c 6f77 2c20 6120  xample below, a 
-0000d8a0: 7065 7273 6973 7465 6e74 2073 7562 7363  persistent subsc
-0000d8b0: 7269 7074 696f 6e20 6973 2063 7265 6174  ription is creat
-0000d8c0: 6564 2e5c 6e5c 6e60 6060 7079 7468 6f6e  ed.\n\n```python
-0000d8d0: 5c6e 2320 4372 6561 7465 2061 2070 6572  \n# Create a per
-0000d8e0: 7369 7374 656e 7420 7375 6273 6372 6970  sistent subscrip
-0000d8f0: 7469 6f6e 2e5c 6e67 726f 7570 5f6e 616d  tion.\ngroup_nam
-0000d900: 6520 3d20 6622 6772 6f75 702d 7b75 7569  e = f"group-{uui
-0000d910: 6434 2829 7d22 5c6e 636c 6965 6e74 2e63  d4()}"\nclient.c
-0000d920: 7265 6174 655f 7375 6273 6372 6970 7469  reate_subscripti
-0000d930: 6f6e 2867 726f 7570 5f6e 616d 653d 6772  on(group_name=gr
-0000d940: 6f75 705f 6e61 6d65 295c 6e60 6060 5c6e  oup_name)\n```\n
-0000d950: 5c6e 2323 2320 5265 6164 2073 7562 7363  \n### Read subsc
-0000d960: 7269 7074 696f 6e5c 6e5c 6e2a 7265 7175  ription\n\n*requ
-0000d970: 6972 6573 206c 6561 6465 722a 5c6e 5c6e  ires leader*\n\n
-0000d980: 5468 6520 6d65 7468 6f64 2060 7265 6164  The method `read
-0000d990: 5f73 7562 7363 7269 7074 696f 6e28 2960  _subscription()`
-0000d9a0: 2063 616e 2062 6520 7573 6564 2062 7920   can be used by 
-0000d9b0: 6120 6772 6f75 7020 6f66 2063 6f6e 7375  a group of consu
-0000d9c0: 6d65 7273 2074 6f20 7265 6365 6976 655c  mers to receive\
-0000d9d0: 6e72 6563 6f72 6465 6420 6576 656e 7473  nrecorded events
-0000d9e0: 2066 726f 6d20 6120 7065 7273 6973 7465   from a persiste
-0000d9f0: 6e74 2073 7562 7363 7269 7074 696f 6e20  nt subscription 
-0000da00: 6372 6561 7465 6420 7573 696e 6720 6063  created using `c
-0000da10: 7265 6174 655f 7375 6273 6372 6970 7469  reate_subscripti
-0000da20: 6f6e 602e 5c6e 5c6e 5468 6973 206d 6574  on`.\n\nThis met
-0000da30: 686f 6420 7461 6b65 7320 6120 7265 7175  hod takes a requ
-0000da40: 6972 6564 2060 6772 6f75 705f 6e61 6d65  ired `group_name
-0000da50: 6020 6172 6775 6d65 6e74 2c20 7768 6963  ` argument, whic
-0000da60: 6820 6973 5c6e 7468 6520 6e61 6d65 206f  h is\nthe name o
-0000da70: 6620 6120 2267 726f 7570 2220 6f66 2063  f a "group" of c
-0000da80: 6f6e 7375 6d65 7273 206f 6620 7468 6520  onsumers of the 
-0000da90: 7375 6273 6372 6970 7469 6f6e 2073 7065  subscription spe
-0000daa0: 6369 6669 6564 5c6e 7768 656e 2060 6372  cified\nwhen `cr
-0000dab0: 6561 7465 5f73 7562 7363 7269 7074 696f  eate_subscriptio
-0000dac0: 6e28 2960 2077 6173 2063 616c 6c65 642e  n()` was called.
-0000dad0: 5c6e 5c6e 5468 6973 206d 6574 686f 6420  \n\nThis method 
-0000dae0: 616c 736f 2074 616b 6573 2061 6e20 6f70  also takes an op
-0000daf0: 7469 6f6e 616c 2060 7469 6d65 6f75 7460  tional `timeout`
-0000db00: 2061 7267 756d 656e 742c 2074 6861 745c   argument, that\
-0000db10: 6e69 7320 6578 7065 6374 6564 2074 6f20  nis expected to 
-0000db20: 6265 2061 2050 7974 686f 6e20 6066 6c6f  be a Python `flo
-0000db30: 6174 602c 2077 6869 6368 2073 6574 7320  at`, which sets 
-0000db40: 6120 6465 6164 6c69 6e65 5c6e 666f 7220  a deadline\nfor 
-0000db50: 7468 6520 636f 6d70 6c65 7469 6f6e 206f  the completion o
-0000db60: 6620 7468 6520 6752 5043 206f 7065 7261  f the gRPC opera
-0000db70: 7469 6f6e 2e5c 6e5c 6e54 6869 7320 6d65  tion.\n\nThis me
-0000db80: 7468 6f64 2072 6574 7572 6e73 2061 2032  thod returns a 2
-0000db90: 2d74 7570 6c65 3a20 6120 2272 6561 6420  -tuple: a "read 
-0000dba0: 7265 7175 6573 7422 206f 626a 6563 7420  request" object 
-0000dbb0: 616e 6420 6120 2272 6561 6420 7265 7370  and a "read resp
-0000dbc0: 6f6e 7365 2220 6f62 6a65 6374 2e5c 6e5c  onse" object.\n\
-0000dbd0: 6e60 6060 7079 7468 6f6e 5c6e 7265 6164  n```python\nread
-0000dbe0: 5f72 6571 2c20 7265 6164 5f72 6573 7020  _req, read_resp 
-0000dbf0: 3d20 636c 6965 6e74 2e72 6561 645f 7375  = client.read_su
-0000dc00: 6273 6372 6970 7469 6f6e 2867 726f 7570  bscription(group
-0000dc10: 5f6e 616d 653d 6772 6f75 705f 6e61 6d65  _name=group_name
-0000dc20: 295c 6e60 6060 5c6e 5c6e 5468 6520 2272  )\n```\n\nThe "r
-0000dc30: 6561 6420 7265 7370 6f6e 7365 2220 6f62  ead response" ob
-0000dc40: 6a65 6374 2069 7320 616e 2069 7465 7261  ject is an itera
-0000dc50: 746f 7220 7468 6174 2079 6965 6c64 7320  tor that yields 
-0000dc60: 7265 636f 7264 6564 2065 7665 6e74 7320  recorded events 
-0000dc70: 6672 6f6d 5c6e 7468 6520 7370 6563 6966  from\nthe specif
-0000dc80: 6965 6420 636f 6d6d 6974 2070 6f73 6974  ied commit posit
-0000dc90: 696f 6e2e 5c6e 5c6e 5468 6520 2272 6561  ion.\n\nThe "rea
-0000dca0: 6420 7265 7175 6573 7422 206f 626a 6563  d request" objec
-0000dcb0: 7420 6861 7320 616e 2060 6163 6b28 2960  t has an `ack()`
-0000dcc0: 206d 6574 686f 6420 7468 6174 2073 686f   method that sho
-0000dcd0: 756c 6420 6265 2075 7365 6420 6279 2061  uld be used by a
-0000dce0: 2063 6f6e 7375 6d65 725c 6e69 6e20 6120   consumer\nin a 
-0000dcf0: 6772 6f75 7020 746f 2061 636b 6e6f 776c  group to acknowl
-0000dd00: 6564 6765 2074 6f20 7468 6520 7365 7276  edge to the serv
-0000dd10: 6572 2074 6861 7420 6974 2068 6173 2072  er that it has r
-0000dd20: 6563 6569 7665 6420 616e 6420 7375 6363  eceived and succ
-0000dd30: 6573 7366 756c 6c79 5c6e 7072 6f63 6573  essfully\nproces
-0000dd40: 7365 6420 6120 7265 636f 7264 6564 2065  sed a recorded e
-0000dd50: 7665 6e74 2e20 5468 6973 2077 696c 6c20  vent. This will 
-0000dd60: 7072 6576 656e 7420 7468 6174 2072 6563  prevent that rec
-0000dd70: 6f72 6465 6420 6576 656e 7420 6265 696e  orded event bein
-0000dd80: 6720 7265 6365 6976 6564 5c6e 6279 2061  g received\nby a
-0000dd90: 6e6f 7468 6572 2063 6f6e 7375 6d65 7220  nother consumer 
-0000dda0: 696e 2074 6865 2073 616d 6520 6772 6f75  in the same grou
-0000ddb0: 702e 2054 6865 2060 6163 6b28 2960 206d  p. The `ack()` m
-0000ddc0: 6574 686f 6420 7461 6b65 7320 616e 2060  ethod takes an `
-0000ddd0: 6576 656e 745f 6964 605c 6e61 7267 756d  event_id`\nargum
-0000dde0: 656e 742c 2077 6869 6368 2069 7320 7468  ent, which is th
-0000ddf0: 6520 4944 206f 6620 7468 6520 7265 636f  e ID of the reco
-0000de00: 7264 6564 2065 7665 6e74 2074 6861 7420  rded event that 
-0000de10: 6861 7320 6265 656e 2072 6563 6569 7665  has been receive
-0000de20: 642e 5c6e 5c6e 5468 6520 2272 6561 6420  d.\n\nThe "read 
-0000de30: 7265 7175 6573 7422 206f 626a 6563 7420  request" object 
-0000de40: 616c 736f 2068 6173 2061 6e20 606e 6163  also has an `nac
-0000de50: 6b28 2960 206d 6574 686f 6420 7468 6174  k()` method that
-0000de60: 2073 686f 756c 6420 6265 2075 7365 6420   should be used 
-0000de70: 6279 2061 2063 6f6e 7375 6d65 725c 6e69  by a consumer\ni
-0000de80: 6e20 6120 6772 6f75 7020 746f 206e 6567  n a group to neg
-0000de90: 6174 6976 656c 7920 6163 6b6e 6f77 6c65  atively acknowle
-0000dea0: 6467 6520 746f 2074 6865 2073 6572 7665  dge to the serve
-0000deb0: 7220 7468 6174 2069 7420 6861 7320 7265  r that it has re
-0000dec0: 6365 6976 6564 2062 7574 206e 6f74 5c6e  ceived but not\n
-0000ded0: 7375 6363 6573 7366 756c 6c79 2070 726f  successfully pro
-0000dee0: 6365 7373 6564 2061 2072 6563 6f72 6465  cessed a recorde
-0000def0: 6420 6576 656e 742e 2054 6865 2060 6e61  d event. The `na
-0000df00: 636b 2829 6020 6d65 7468 6f64 2074 616b  ck()` method tak
-0000df10: 6573 2061 6e20 6065 7665 6e74 5f69 6460  es an `event_id`
-0000df20: 5c6e 6172 6775 6d65 6e74 2c20 7768 6963  \nargument, whic
-0000df30: 6820 6973 2074 6865 2049 4420 6f66 2074  h is the ID of t
-0000df40: 6865 2072 6563 6f72 6465 6420 6576 656e  he recorded even
-0000df50: 7420 7468 6174 2068 6173 2062 6565 6e20  t that has been 
-0000df60: 7265 6365 6976 6564 2c20 616e 6420 616e  received, and an
-0000df70: 5c6e 6061 6374 696f 6e60 2061 7267 756d  \n`action` argum
-0000df80: 656e 742c 2077 6869 6368 2073 686f 756c  ent, which shoul
-0000df90: 6420 6265 2061 2050 7974 686f 6e20 6073  d be a Python `s
-0000dfa0: 7472 602c 2065 6974 6865 7220 605c 2775  tr`, either `\'u
-0000dfb0: 6e6b 6e6f 776e 5c27 602c 2060 5c27 7061  nknown\'`, `\'pa
-0000dfc0: 726b 5c27 602c 5c6e 605c 2772 6574 7279  rk\'`,\n`\'retry
-0000dfd0: 5c27 602c 2060 5c27 736b 6970 5c27 602c  \'`, `\'skip\'`,
-0000dfe0: 206f 7220 605c 2773 746f 705c 2760 2e5c   or `\'stop\'`.\
-0000dff0: 6e5c 6e54 6865 2065 7861 6d70 6c65 2062  n\nThe example b
-0000e000: 656c 6f77 2069 7465 7261 7465 7320 6f76  elow iterates ov
-0000e010: 6572 2074 6865 2022 7265 6164 2072 6573  er the "read res
-0000e020: 706f 6e73 6522 206f 626a 6563 742c 2061  ponse" object, a
-0000e030: 6e64 2063 616c 6c73 2060 6163 6b28 2960  nd calls `ack()`
-0000e040: 5c6e 6f6e 2074 6865 2022 7265 6164 2072  \non the "read r
-0000e050: 6573 706f 6e73 6522 206f 626a 6563 742e  esponse" object.
-0000e060: 2054 6865 2066 6f72 206c 6f6f 7020 6272   The for loop br
-0000e070: 6561 6b73 2077 6865 6e20 7765 2068 6176  eaks when we hav
-0000e080: 6520 7265 6365 6976 6564 5c6e 7468 6520  e received\nthe 
-0000e090: 6c61 7374 2065 7665 6e74 2c20 736f 2074  last event, so t
-0000e0a0: 6861 7420 7765 2063 616e 2063 6f6e 7469  hat we can conti
-0000e0b0: 6e75 6520 7769 7468 2074 6865 2065 7861  nue with the exa
-0000e0c0: 6d70 6c65 7320 6265 6c6f 772e 5c6e 5c6e  mples below.\n\n
-0000e0d0: 6060 6070 7974 686f 6e5c 6e65 7665 6e74  ```python\nevent
-0000e0e0: 7320 3d20 5b5d 5c6e 666f 7220 6576 656e  s = []\nfor even
-0000e0f0: 7420 696e 2072 6561 645f 7265 7370 3a5c  t in read_resp:\
-0000e100: 6e20 2020 2065 7665 6e74 732e 6170 7065  n    events.appe
-0000e110: 6e64 2865 7665 6e74 295c 6e5c 6e20 2020  nd(event)\n\n   
-0000e120: 2023 2041 636b 6e6f 776c 6564 6765 2074   # Acknowledge t
-0000e130: 6865 2072 6563 6569 7665 6420 6576 656e  he received even
-0000e140: 742e 5c6e 2020 2020 7265 6164 5f72 6571  t.\n    read_req
-0000e150: 2e61 636b 2865 7665 6e74 5f69 643d 6576  .ack(event_id=ev
-0000e160: 656e 742e 6964 295c 6e5c 6e20 2020 2023  ent.id)\n\n    #
-0000e170: 2042 7265 616b 2077 6865 6e20 7468 6520   Break when the 
-0000e180: 6c61 7374 2065 7665 6e74 2068 6173 2062  last event has b
-0000e190: 6565 6e20 7265 6365 6976 6564 2e5c 6e20  een received.\n 
-0000e1a0: 2020 2069 6620 6576 656e 742e 6964 203d     if event.id =
-0000e1b0: 3d20 6576 656e 7431 312e 6964 3a5c 6e20  = event11.id:\n 
-0000e1c0: 2020 2020 2020 2062 7265 616b 5c6e 6060         break\n``
-0000e1d0: 605c 6e5c 6e54 6865 2072 6563 6569 7665  `\n\nThe receive
-0000e1e0: 6420 6576 656e 7473 2061 7265 2074 6865  d events are the
-0000e1f0: 2065 7665 6e74 7320 7765 2061 7070 656e   events we appen
-0000e200: 6465 6420 6162 6f76 652e 5c6e 5c6e 6060  ded above.\n\n``
-0000e210: 6070 7974 686f 6e5c 6e61 7373 6572 7420  `python\nassert 
-0000e220: 6576 656e 7473 5b2d 3131 5d2e 6964 203d  events[-11].id =
-0000e230: 3d20 6576 656e 7431 2e69 645c 6e61 7373  = event1.id\nass
-0000e240: 6572 7420 6576 656e 7473 5b2d 3130 5d2e  ert events[-10].
-0000e250: 6964 203d 3d20 6576 656e 7432 2e69 645c  id == event2.id\
-0000e260: 6e61 7373 6572 7420 6576 656e 7473 5b2d  nassert events[-
-0000e270: 395d 2e69 6420 3d3d 2065 7665 6e74 332e  9].id == event3.
-0000e280: 6964 5c6e 6173 7365 7274 2065 7665 6e74  id\nassert event
-0000e290: 735b 2d38 5d2e 6964 203d 3d20 6576 656e  s[-8].id == even
-0000e2a0: 7434 2e69 645c 6e61 7373 6572 7420 6576  t4.id\nassert ev
-0000e2b0: 656e 7473 5b2d 375d 2e69 6420 3d3d 2065  ents[-7].id == e
-0000e2c0: 7665 6e74 352e 6964 5c6e 6173 7365 7274  vent5.id\nassert
-0000e2d0: 2065 7665 6e74 735b 2d36 5d2e 6964 203d   events[-6].id =
-0000e2e0: 3d20 6576 656e 7436 2e69 645c 6e61 7373  = event6.id\nass
-0000e2f0: 6572 7420 6576 656e 7473 5b2d 355d 2e69  ert events[-5].i
-0000e300: 6420 3d3d 2065 7665 6e74 372e 6964 5c6e  d == event7.id\n
-0000e310: 6173 7365 7274 2065 7665 6e74 735b 2d34  assert events[-4
-0000e320: 5d2e 6964 203d 3d20 6576 656e 7438 2e69  ].id == event8.i
-0000e330: 645c 6e61 7373 6572 7420 6576 656e 7473  d\nassert events
-0000e340: 5b2d 335d 2e69 6420 3d3d 2065 7665 6e74  [-3].id == event
-0000e350: 392e 6964 5c6e 6173 7365 7274 2065 7665  9.id\nassert eve
-0000e360: 6e74 735b 2d32 5d2e 6964 203d 3d20 6576  nts[-2].id == ev
-0000e370: 656e 7431 302e 6964 5c6e 6173 7365 7274  ent10.id\nassert
-0000e380: 2065 7665 6e74 735b 2d31 5d2e 6964 203d   events[-1].id =
-0000e390: 3d20 6576 656e 7431 312e 6964 5c6e 6060  = event11.id\n``
-0000e3a0: 605c 6e5c 6e54 6865 2022 7265 6164 2072  `\n\nThe "read r
-0000e3b0: 6571 7565 7374 2220 6f62 6a65 6374 2061  equest" object a
-0000e3c0: 6c73 6f20 6861 7320 616e 2060 6e61 636b  lso has an `nack
-0000e3d0: 2829 6020 6d65 7468 6f64 2074 6861 7420  ()` method that 
-0000e3e0: 6361 6e20 6265 2075 7365 6420 6279 2061  can be used by a
-0000e3f0: 2063 6f6e 7375 6d65 725c 6e69 6e20 6120   consumer\nin a 
-0000e400: 6772 6f75 7020 746f 2061 636b 6e6f 776c  group to acknowl
-0000e410: 6564 6765 2074 6f20 7468 6520 7365 7276  edge to the serv
-0000e420: 6572 2074 6861 7420 6974 2068 6173 2066  er that it has f
-0000e430: 6169 6c65 6420 7375 6363 6573 7366 756c  ailed successful
-0000e440: 6c79 2074 6f5c 6e70 726f 6365 7373 2061  ly to\nprocess a
-0000e450: 2072 6563 6f72 6465 6420 6576 656e 742e   recorded event.
-0000e460: 2054 6869 7320 7769 6c6c 2061 6c6c 6f77   This will allow
-0000e470: 2074 6861 7420 7265 636f 7264 6564 2065   that recorded e
-0000e480: 7665 6e74 2074 6f20 6265 2072 6563 6569  vent to be recei
-0000e490: 7665 645c 6e62 7920 7468 6973 206f 7220  ved\nby this or 
-0000e4a0: 616e 6f74 6865 7220 636f 6e73 756d 6572  another consumer
-0000e4b0: 2069 6e20 7468 6520 7361 6d65 2067 726f   in the same gro
-0000e4c0: 7570 2e5c 6e5c 6e49 7420 6d69 6768 7420  up.\n\nIt might 
-0000e4d0: 6265 206d 6f72 6520 7573 6566 756c 2074  be more useful t
-0000e4e0: 6f20 656e 6361 7073 756c 6174 6520 7468  o encapsulate th
-0000e4f0: 6520 7265 7175 6573 7420 616e 6420 7265  e request and re
-0000e500: 7370 6f6e 7365 206f 626a 6563 7473 2061  sponse objects a
-0000e510: 6e64 2074 6f20 6974 6572 6174 655c 6e6f  nd to iterate\no
-0000e520: 7665 7220 7468 6520 2272 6561 6420 7265  ver the "read re
-0000e530: 7370 6f6e 7365 2220 696e 2061 2073 6570  sponse" in a sep
-0000e540: 6172 6174 6520 7468 7265 6164 2c20 746f  arate thread, to
-0000e550: 2063 616c 6c20 6261 636b 2074 6f20 6120   call back to a 
-0000e560: 6861 6e64 6c65 7220 6675 6e63 7469 6f6e  handler function
-0000e570: 2077 6865 6e5c 6e61 2072 6563 6f72 6465   when\na recorde
-0000e580: 6420 6576 656e 7420 6973 2072 6563 6569  d event is recei
-0000e590: 7665 642c 2061 6e64 2063 616c 6c20 6061  ved, and call `a
-0000e5a0: 636b 2829 6020 6966 2074 6865 2068 616e  ck()` if the han
-0000e5b0: 646c 6572 2064 6f65 7320 6e6f 7420 7261  dler does not ra
-0000e5c0: 6973 6520 616e 5c6e 6578 6365 7074 696f  ise an\nexceptio
-0000e5d0: 6e2c 2061 6e64 2074 6f20 6361 6c6c 2060  n, and to call `
-0000e5e0: 6e61 636b 2829 6020 6966 2061 6e20 6578  nack()` if an ex
-0000e5f0: 6365 7074 696f 6e20 6973 2072 6169 7365  ception is raise
-0000e600: 642e 2054 6865 2065 7861 6d70 6c65 2062  d. The example b
-0000e610: 656c 6f77 2073 686f 7773 2068 6f77 5c6e  elow shows how\n
-0000e620: 7468 6973 206d 6967 6874 2062 6520 646f  this might be do
-0000e630: 6e65 2e5c 6e5c 6e60 6060 7079 7468 6f6e  ne.\n\n```python
-0000e640: 5c6e 6672 6f6d 2074 6872 6561 6469 6e67  \nfrom threading
-0000e650: 2069 6d70 6f72 7420 5468 7265 6164 5c6e   import Thread\n
-0000e660: 5c6e 5c6e 636c 6173 7320 5375 6273 6372  \n\nclass Subscr
-0000e670: 6970 7469 6f6e 5265 6164 6572 3a5c 6e20  iptionReader:\n 
-0000e680: 2020 2064 6566 205f 5f69 6e69 745f 5f28     def __init__(
-0000e690: 7365 6c66 2c20 636c 6965 6e74 2c20 6772  self, client, gr
-0000e6a0: 6f75 705f 6e61 6d65 2c20 6361 6c6c 6261  oup_name, callba
-0000e6b0: 636b 293a 5c6e 2020 2020 2020 2020 7365  ck):\n        se
-0000e6c0: 6c66 2e63 6c69 656e 7420 3d20 636c 6965  lf.client = clie
-0000e6d0: 6e74 5c6e 2020 2020 2020 2020 7365 6c66  nt\n        self
-0000e6e0: 2e67 726f 7570 5f6e 616d 6520 3d20 6772  .group_name = gr
-0000e6f0: 6f75 705f 6e61 6d65 5c6e 2020 2020 2020  oup_name\n      
-0000e700: 2020 7365 6c66 2e63 616c 6c62 6163 6b20    self.callback 
-0000e710: 3d20 6361 6c6c 6261 636b 5c6e 2020 2020  = callback\n    
-0000e720: 2020 2020 7365 6c66 2e74 6872 6561 6420      self.thread 
-0000e730: 3d20 5468 7265 6164 2874 6172 6765 743d  = Thread(target=
-0000e740: 7365 6c66 2e72 6561 645f 7375 6273 6372  self.read_subscr
-0000e750: 6970 7469 6f6e 2c20 6461 656d 6f6e 3d54  iption, daemon=T
-0000e760: 7275 6529 5c6e 2020 2020 2020 2020 7365  rue)\n        se
-0000e770: 6c66 2e65 7272 6f72 203d 204e 6f6e 655c  lf.error = None\
-0000e780: 6e5c 6e20 2020 2064 6566 2073 7461 7274  n\n    def start
-0000e790: 2873 656c 6629 3a5c 6e20 2020 2020 2020  (self):\n       
-0000e7a0: 2073 656c 662e 7468 7265 6164 2e73 7461   self.thread.sta
-0000e7b0: 7274 2829 5c6e 5c6e 2020 2020 6465 6620  rt()\n\n    def 
-0000e7c0: 6a6f 696e 2873 656c 6629 3a5c 6e20 2020  join(self):\n   
-0000e7d0: 2020 2020 2073 656c 662e 7468 7265 6164       self.thread
-0000e7e0: 2e6a 6f69 6e28 295c 6e5c 6e20 2020 2064  .join()\n\n    d
-0000e7f0: 6566 2072 6561 645f 7375 6273 6372 6970  ef read_subscrip
-0000e800: 7469 6f6e 2873 656c 6629 3a5c 6e20 2020  tion(self):\n   
-0000e810: 2020 2020 2072 6571 2c20 7265 7370 203d       req, resp =
-0000e820: 2073 656c 662e 636c 6965 6e74 2e72 6561   self.client.rea
-0000e830: 645f 7375 6273 6372 6970 7469 6f6e 2867  d_subscription(g
-0000e840: 726f 7570 5f6e 616d 653d 7365 6c66 2e67  roup_name=self.g
-0000e850: 726f 7570 5f6e 616d 6529 5c6e 2020 2020  roup_name)\n    
-0000e860: 2020 2020 666f 7220 6576 656e 7420 696e      for event in
-0000e870: 2072 6573 703a 5c6e 2020 2020 2020 2020   resp:\n        
-0000e880: 2020 2020 7472 793a 5c6e 2020 2020 2020      try:\n      
-0000e890: 2020 2020 2020 2020 2020 7365 6c66 2e63            self.c
-0000e8a0: 616c 6c62 6163 6b28 6576 656e 7429 5c6e  allback(event)\n
-0000e8b0: 2020 2020 2020 2020 2020 2020 6578 6365              exce
-0000e8c0: 7074 2045 7863 6570 7469 6f6e 2061 7320  pt Exception as 
-0000e8d0: 653a 5c6e 2020 2020 2020 2020 2020 2020  e:\n            
-0000e8e0: 2020 2020 2320 7265 712e 6e61 636b 2865      # req.nack(e
-0000e8f0: 7665 6e74 2e69 6429 2020 2320 6e6f 7420  vent.id)  # not 
-0000e900: 7965 7420 696d 706c 656d 656e 7465 642e  yet implemented.
-0000e910: 2e2e 2e5c 6e20 2020 2020 2020 2020 2020  ...\n           
-0000e920: 2020 2020 2073 656c 662e 6572 726f 7220       self.error 
-0000e930: 3d20 655c 6e20 2020 2020 2020 2020 2020  = e\n           
-0000e940: 2020 2020 2062 7265 616b 5c6e 2020 2020       break\n    
-0000e950: 2020 2020 2020 2020 656c 7365 3a5c 6e20          else:\n 
-0000e960: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0000e970: 6571 2e61 636b 2865 7665 6e74 2e69 6429  eq.ack(event.id)
-0000e980: 5c6e 5c6e 5c6e 2320 4372 6561 7465 2061  \n\n\n# Create a
-0000e990: 6e6f 7468 6572 2070 6572 7369 7374 656e  nother persisten
-0000e9a0: 7420 7375 6273 6372 6970 7469 6f6e 2e5c  t subscription.\
-0000e9b0: 6e67 726f 7570 5f6e 616d 6520 3d20 6622  ngroup_name = f"
-0000e9c0: 6772 6f75 702d 7b75 7569 6434 2829 7d22  group-{uuid4()}"
-0000e9d0: 5c6e 636c 6965 6e74 2e63 7265 6174 655f  \nclient.create_
-0000e9e0: 7375 6273 6372 6970 7469 6f6e 2867 726f  subscription(gro
-0000e9f0: 7570 5f6e 616d 653d 6772 6f75 705f 6e61  up_name=group_na
-0000ea00: 6d65 295c 6e5c 6e65 7665 6e74 7320 3d20  me)\n\nevents = 
-0000ea10: 5b5d 5c6e 5c6e 6465 6620 6861 6e64 6c65  []\n\ndef handle
-0000ea20: 5f65 7665 6e74 2865 7665 6e74 293a 5c6e  _event(event):\n
-0000ea30: 2020 2020 6576 656e 7473 2e61 7070 656e      events.appen
-0000ea40: 6428 6576 656e 7429 5c6e 2020 2020 6966  d(event)\n    if
-0000ea50: 2065 7665 6e74 2e69 6420 3d3d 2065 7665   event.id == eve
-0000ea60: 6e74 3131 2e69 643a 5c6e 2020 2020 2020  nt11.id:\n      
-0000ea70: 2020 7261 6973 6520 4578 6365 7074 696f    raise Exceptio
-0000ea80: 6e28 295c 6e5c 6e5c 6e72 6561 6465 7220  n()\n\n\nreader 
-0000ea90: 3d20 5375 6273 6372 6970 7469 6f6e 5265  = SubscriptionRe
-0000eaa0: 6164 6572 285c 6e20 2020 2063 6c69 656e  ader(\n    clien
-0000eab0: 743d 636c 6965 6e74 2c5c 6e20 2020 2067  t=client,\n    g
-0000eac0: 726f 7570 5f6e 616d 653d 6772 6f75 705f  roup_name=group_
-0000ead0: 6e61 6d65 2c5c 6e20 2020 2063 616c 6c62  name,\n    callb
-0000eae0: 6163 6b3d 6861 6e64 6c65 5f65 7665 6e74  ack=handle_event
-0000eaf0: 5c6e 295c 6e5c 6e72 6561 6465 722e 7374  \n)\n\nreader.st
-0000eb00: 6172 7428 295c 6e72 6561 6465 722e 6a6f  art()\nreader.jo
-0000eb10: 696e 2829 5c6e 5c6e 6173 7365 7274 2065  in()\n\nassert e
-0000eb20: 7665 6e74 735b 2d31 5d2e 6964 203d 3d20  vents[-1].id == 
-0000eb30: 6576 656e 7431 312e 6964 5c6e 6060 605c  event11.id\n```\
-0000eb40: 6e5c 6e50 6c65 6173 6520 6e6f 7465 2c20  n\nPlease note, 
-0000eb50: 7768 656e 2070 726f 6365 7373 696e 6720  when processing 
-0000eb60: 6576 656e 7473 2069 6e20 6120 646f 776e  events in a down
-0000eb70: 7374 7265 616d 2063 6f6d 706f 6e65 6e74  stream component
-0000eb80: 2c20 7468 6520 636f 6d6d 6974 2070 6f73  , the commit pos
-0000eb90: 6974 696f 6e20 6f66 5c6e 7468 6520 6c61  ition of\nthe la
-0000eba0: 7374 2073 7563 6365 7373 6675 6c6c 7920  st successfully 
-0000ebb0: 7072 6f63 6573 7365 6420 6576 656e 7420  processed event 
-0000ebc0: 6973 2075 7365 6675 6c6c 7920 7265 636f  is usefully reco
-0000ebd0: 7264 6564 2062 7920 7468 6520 646f 776e  rded by the down
-0000ebe0: 7374 7265 616d 2063 6f6d 706f 6e65 6e74  stream component
-0000ebf0: 5c6e 736f 2074 6861 7420 7468 6520 636f  \nso that the co
-0000ec00: 6d6d 6974 2070 6f73 6974 696f 6e20 6361  mmit position ca
-0000ec10: 6e20 6265 2064 6574 6572 6d69 6e65 6420  n be determined 
-0000ec20: 6279 2074 6865 2064 6f77 6e73 7472 6561  by the downstrea
-0000ec30: 6d20 636f 6d70 6f6e 656e 7420 6672 6f6d  m component from
-0000ec40: 2069 7473 206f 776e 5c6e 7265 636f 7264   its own\nrecord
-0000ec50: 6564 2077 6865 6e20 6974 2069 7320 7265  ed when it is re
-0000ec60: 7374 6172 7465 642e 2054 6869 7320 636f  started. This co
-0000ec70: 6d6d 6974 2070 6f73 6974 696f 6e20 6361  mmit position ca
-0000ec80: 6e20 6265 2075 7365 6420 746f 2073 7065  n be used to spe
-0000ec90: 6369 6679 2074 6865 2063 6f6d 6d69 745c  cify the commit\
-0000eca0: 6e70 6f73 6974 696f 6e20 6672 6f6d 2077  nposition from w
-0000ecb0: 6869 6368 2074 6f20 7375 6273 6372 6962  hich to subscrib
-0000ecc0: 652e 2053 696e 6365 2074 6869 7320 636f  e. Since this co
-0000ecd0: 6d6d 6974 2070 6f73 6974 696f 6e20 7265  mmit position re
-0000ece0: 7072 6573 656e 7473 2074 6865 2070 6f73  presents the pos
-0000ecf0: 6974 696f 6e20 6f66 5c6e 7468 6520 6c61  ition of\nthe la
-0000ed00: 7374 2073 7563 6365 7373 6675 6c6c 7920  st successfully 
-0000ed10: 7072 6f63 6573 7365 6420 6576 656e 7420  processed event 
-0000ed20: 696e 2061 2064 6f77 6e73 7472 6561 6d20  in a downstream 
-0000ed30: 636f 6d70 6f6e 656e 742c 2073 6f20 6974  component, so it
-0000ed40: 2077 696c 6c20 6265 2075 7375 616c 2074   will be usual t
-0000ed50: 6f5c 6e77 616e 7420 746f 2072 6561 6420  o\nwant to read 
-0000ed60: 6672 6f6d 2074 6865 206e 6578 7420 6576  from the next ev
-0000ed70: 656e 7420 6166 7465 7220 7468 6973 2070  ent after this p
-0000ed80: 6f73 6974 696f 6e2c 2062 6563 6175 7365  osition, because
-0000ed90: 2074 6861 7420 6973 2074 6865 206e 6578   that is the nex
-0000eda0: 7420 6576 656e 745c 6e74 6861 7420 6e65  t event\nthat ne
-0000edb0: 6564 7320 746f 2062 6520 7072 6f63 6573  eds to be proces
-0000edc0: 7365 642e 2048 6f77 6576 6572 2c20 7768  sed. However, wh
-0000edd0: 656e 2073 7562 7363 7269 6269 6e67 2066  en subscribing f
-0000ede0: 6f72 2065 7665 6e74 7320 7573 696e 6720  or events using 
-0000edf0: 6120 7065 7273 6973 7465 6e74 5c6e 7375  a persistent\nsu
-0000ee00: 6273 6372 6970 7469 6f6e 2069 6e20 4576  bscription in Ev
-0000ee10: 656e 7453 746f 7265 4442 2c20 7468 6520  entStoreDB, the 
-0000ee20: 6576 656e 7420 6174 2074 6865 2073 7065  event at the spe
-0000ee30: 6369 6669 6564 2063 6f6d 6d69 7420 706f  cified commit po
-0000ee40: 7369 7469 6f6e 204d 4159 2062 6520 7265  sition MAY be re
-0000ee50: 7475 726e 6564 5c6e 6173 2074 6865 2066  turned\nas the f
-0000ee60: 6972 7374 2065 7665 6e74 2069 6e20 7468  irst event in th
-0000ee70: 6520 7265 6365 6976 6564 2073 6571 7565  e received seque
-0000ee80: 6e63 6520 6f66 2072 6563 6f72 6465 6420  nce of recorded 
-0000ee90: 6576 656e 7473 2c20 616e 6420 736f 2069  events, and so i
-0000eea0: 7420 6d61 795c 6e62 6520 6e65 6365 7373  t may\nbe necess
-0000eeb0: 6172 7920 746f 2063 6865 636b 2074 6865  ary to check the
-0000eec0: 2063 6f6d 6d69 7420 706f 7369 7469 6f6e   commit position
-0000eed0: 206f 6620 7468 6520 7265 6365 6976 6564   of the received
-0000eee0: 2065 7665 6e74 7320 616e 6420 746f 2064   events and to d
-0000eef0: 6973 6361 7264 5c6e 616e 7920 2072 6563  iscard\nany  rec
-0000ef00: 6f72 6465 6420 6576 656e 7420 6f62 6a65  orded event obje
-0000ef10: 6374 2074 6861 7420 6861 7320 6120 636f  ct that has a co
-0000ef20: 6d6d 6974 2070 6f73 6974 696f 6e20 6571  mmit position eq
-0000ef30: 7561 6c20 746f 2074 6865 2063 6f6d 6d69  ual to the commi
-0000ef40: 7420 706f 7369 7469 6f6e 5c6e 7370 6563  t position\nspec
-0000ef50: 6966 6965 6420 696e 2074 6865 2072 6571  ified in the req
-0000ef60: 7565 7374 2e5c 6e5c 6e57 6869 6c73 7420  uest.\n\nWhilst 
-0000ef70: 7468 6572 6520 6172 6520 736f 6d65 2061  there are some a
-0000ef80: 6476 616e 7461 6765 7320 6f66 2070 6572  dvantages of per
-0000ef90: 7369 7374 656e 7420 7375 6273 6372 6970  sistent subscrip
-0000efa0: 7469 6f6e 732c 2069 6e20 7061 7274 6963  tions, in partic
-0000efb0: 756c 6172 2074 6865 5c6e 7072 6f63 6573  ular the\nproces
-0000efc0: 7369 6e67 206f 6620 7265 636f 7264 6564  sing of recorded
-0000efd0: 2065 7665 6e74 7320 6279 2061 2067 726f   events by a gro
-0000efe0: 7570 206f 6620 636f 6e73 756d 6572 732c  up of consumers,
-0000eff0: 2062 7920 7472 6163 6b69 6e67 2069 6e20   by tracking in 
-0000f000: 7468 655c 6e75 7073 7472 6561 6d20 7365  the\nupstream se
-0000f010: 7276 6572 2074 6865 2070 6f73 6974 696f  rver the positio
-0000f020: 6e20 696e 2074 6865 2063 6f6d 6d69 7420  n in the commit 
-0000f030: 7365 7175 656e 6365 206f 6620 6576 656e  sequence of even
-0000f040: 7473 2074 6861 7420 6861 7665 2062 6565  ts that have bee
-0000f050: 6e20 7072 6f63 6573 7365 642c 5c6e 7468  n processed,\nth
-0000f060: 6572 6520 6973 2061 2064 616e 6765 7220  ere is a danger 
-0000f070: 6f66 2022 6475 616c 2077 7269 7469 6e67  of "dual writing
-0000f080: 2220 696e 2074 6865 2063 6f6e 7375 6d70  " in the consump
-0000f090: 7469 6f6e 206f 6620 6576 656e 7473 2e20  tion of events. 
-0000f0a0: 5265 6c69 6162 696c 6974 795c 6e69 6e20  Reliability\nin 
-0000f0b0: 7072 6f63 6573 7369 6e67 206f 6620 7265  processing of re
-0000f0c0: 636f 7264 6564 2065 7665 6e74 7320 6279  corded events by
-0000f0d0: 2061 2067 726f 7570 206f 6620 636f 6e73   a group of cons
-0000f0e0: 756d 6572 7320 7769 6c6c 2072 656c 7920  umers will rely 
-0000f0f0: 696e 7374 6561 6420 6f6e 5c6e 6964 656d  instead on\nidem
-0000f100: 706f 7465 6e74 2068 616e 646c 696e 6720  potent handling 
-0000f110: 6f66 2064 7570 6c69 6361 7465 206d 6573  of duplicate mes
-0000f120: 7361 6765 732c 2061 6e64 2072 6573 696c  sages, and resil
-0000f130: 6965 6e63 6520 746f 206f 7574 2d6f 662d  ience to out-of-
-0000f140: 6f72 6465 7220 6465 6c69 7665 7279 2e5c  order delivery.\
-0000f150: 6e5c 6e23 2323 2047 6574 2073 7562 7363  n\n### Get subsc
-0000f160: 7269 7074 696f 6e20 696e 666f 5c6e 5c6e  ription info\n\n
-0000f170: 2a72 6571 7569 7265 7320 6c65 6164 6572  *requires leader
-0000f180: 2a5c 6e5c 6e54 6865 2060 6765 745f 7375  *\n\nThe `get_su
-0000f190: 6273 6372 6970 7469 6f6e 5f69 6e66 6f28  bscription_info(
-0000f1a0: 2960 206d 6574 686f 6420 6361 6e20 6265  )` method can be
-0000f1b0: 2075 7365 6420 746f 2067 6574 2069 6e66   used to get inf
-0000f1c0: 6f72 6d61 7469 6f6e 2066 6f72 2061 5c6e  ormation for a\n
-0000f1d0: 7065 7273 6973 7465 6e74 2073 7562 7363  persistent subsc
-0000f1e0: 7269 7074 696f 6e2e 5c6e 5c6e 5468 6973  ription.\n\nThis
-0000f1f0: 206d 6574 686f 6420 6861 7320 6f6e 6520   method has one 
-0000f200: 7265 7175 6972 6564 2061 7267 756d 656e  required argumen
-0000f210: 742c 2060 6772 6f75 705f 6e61 6d65 602c  t, `group_name`,
-0000f220: 2077 6869 6368 5c6e 7368 6f75 6c64 206d   which\nshould m
-0000f230: 6174 6368 2074 6865 2076 616c 7565 206f  atch the value o
-0000f240: 6620 7468 6520 6172 6775 6d65 6e74 2075  f the argument u
-0000f250: 7365 6420 7768 656e 2063 616c 6c69 6e67  sed when calling
-0000f260: 2060 6372 6561 7465 5f73 7562 7363 7269   `create_subscri
-0000f270: 7074 696f 6e28 2960 2e5c 6e5c 6e54 6869  ption()`.\n\nThi
-0000f280: 7320 6d65 7468 6f64 2061 6c73 6f20 7461  s method also ta
-0000f290: 6b65 7320 616e 206f 7074 696f 6e61 6c20  kes an optional 
-0000f2a0: 6074 696d 656f 7574 6020 6172 6775 6d65  `timeout` argume
-0000f2b0: 6e74 2c20 7468 6174 5c6e 6973 2065 7870  nt, that\nis exp
-0000f2c0: 6563 7465 6420 746f 2062 6520 6120 5079  ected to be a Py
-0000f2d0: 7468 6f6e 2060 666c 6f61 7460 2c20 7768  thon `float`, wh
-0000f2e0: 6963 6820 7365 7473 2061 2064 6561 646c  ich sets a deadl
-0000f2f0: 696e 655c 6e66 6f72 2074 6865 2063 6f6d  ine\nfor the com
-0000f300: 706c 6574 696f 6e20 6f66 2074 6865 2067  pletion of the g
-0000f310: 5250 4320 6f70 6572 6174 696f 6e2e 5c6e  RPC operation.\n
-0000f320: 5c6e 6060 6070 7974 686f 6e5c 6e73 7562  \n```python\nsub
-0000f330: 7363 7269 7074 696f 6e5f 696e 666f 203d  scription_info =
-0000f340: 2063 6c69 656e 742e 6765 745f 7375 6273   client.get_subs
-0000f350: 6372 6970 7469 6f6e 5f69 6e66 6f28 5c6e  cription_info(\n
-0000f360: 2020 2020 6772 6f75 705f 6e61 6d65 3d67      group_name=g
-0000f370: 726f 7570 5f6e 616d 652c 5c6e 295c 6e60  roup_name,\n)\n`
-0000f380: 6060 5c6e 5c6e 5468 6520 7265 7475 726e  ``\n\nThe return
-0000f390: 6564 2076 616c 7565 2069 7320 6120 6053  ed value is a `S
-0000f3a0: 7562 7363 7269 7074 696f 6e49 6e66 6f60  ubscriptionInfo`
-0000f3b0: 206f 626a 6563 742e 5c6e 5c6e 2323 2320   object.\n\n### 
-0000f3c0: 4c69 7374 2073 7562 7363 7269 7074 696f  List subscriptio
-0000f3d0: 6e73 5c6e 5c6e 2a72 6571 7569 7265 7320  ns\n\n*requires 
-0000f3e0: 6c65 6164 6572 2a5c 6e5c 6e54 6865 2060  leader*\n\nThe `
-0000f3f0: 6c69 7374 5f73 7562 7363 7269 7074 696f  list_subscriptio
-0000f400: 6e73 2829 6020 6d65 7468 6f64 2063 616e  ns()` method can
-0000f410: 2062 6520 7573 6564 2074 6f20 6765 7420   be used to get 
-0000f420: 696e 666f 726d 6174 696f 6e20 666f 7220  information for 
-0000f430: 616c 6c5c 6e65 7869 7374 696e 6720 7065  all\nexisting pe
-0000f440: 7273 6973 7465 6e74 2073 7562 7363 7269  rsistent subscri
-0000f450: 7074 696f 6e73 2e5c 6e5c 6e54 6869 7320  ptions.\n\nThis 
-0000f460: 6d65 7468 6f64 2074 616b 6573 2061 6e20  method takes an 
-0000f470: 6f70 7469 6f6e 616c 2060 7469 6d65 6f75  optional `timeou
-0000f480: 7460 2061 7267 756d 656e 742c 2074 6861  t` argument, tha
-0000f490: 745c 6e69 7320 6578 7065 6374 6564 2074  t\nis expected t
-0000f4a0: 6f20 6265 2061 2050 7974 686f 6e20 6066  o be a Python `f
-0000f4b0: 6c6f 6174 602c 2077 6869 6368 2073 6574  loat`, which set
-0000f4c0: 7320 6120 6465 6164 6c69 6e65 5c6e 666f  s a deadline\nfo
-0000f4d0: 7220 7468 6520 636f 6d70 6c65 7469 6f6e  r the completion
-0000f4e0: 206f 6620 7468 6520 6752 5043 206f 7065   of the gRPC ope
-0000f4f0: 7261 7469 6f6e 2e5c 6e5c 6e60 6060 7079  ration.\n\n```py
-0000f500: 7468 6f6e 5c6e 7375 6273 6372 6970 7469  thon\nsubscripti
-0000f510: 6f6e 7320 3d20 636c 6965 6e74 2e6c 6973  ons = client.lis
-0000f520: 745f 7375 6273 6372 6970 7469 6f6e 7328  t_subscriptions(
-0000f530: 295c 6e60 6060 5c6e 5c6e 5468 6520 7265  )\n```\n\nThe re
-0000f540: 7475 726e 6564 2076 616c 7565 2069 7320  turned value is 
-0000f550: 6120 6c69 7374 206f 6620 6053 7562 7363  a list of `Subsc
-0000f560: 7269 7074 696f 6e49 6e66 6f60 206f 626a  riptionInfo` obj
-0000f570: 6563 7473 2e5c 6e5c 6e23 2323 2044 656c  ects.\n\n### Del
-0000f580: 6574 6520 7375 6273 6372 6970 7469 6f6e  ete subscription
-0000f590: 5c6e 5c6e 2a72 6571 7569 7265 7320 6c65  \n\n*requires le
-0000f5a0: 6164 6572 2a5c 6e5c 6e54 6865 2060 6465  ader*\n\nThe `de
-0000f5b0: 6c65 7465 5f73 7562 7363 7269 7074 696f  lete_subscriptio
-0000f5c0: 6e28 2960 206d 6574 686f 6420 6361 6e20  n()` method can 
-0000f5d0: 6265 2075 7365 6420 746f 2064 656c 6574  be used to delet
-0000f5e0: 6520 6120 7065 7273 6973 7465 6e74 5c6e  e a persistent\n
-0000f5f0: 7375 6273 6372 6970 7469 6f6e 2e5c 6e5c  subscription.\n\
-0000f600: 6e54 6869 7320 6d65 7468 6f64 2068 6173  nThis method has
-0000f610: 206f 6e65 2072 6571 7569 7265 6420 6172   one required ar
-0000f620: 6775 6d65 6e74 2c20 6067 726f 7570 5f6e  gument, `group_n
-0000f630: 616d 6560 2c20 7768 6963 685c 6e73 686f  ame`, which\nsho
-0000f640: 756c 6420 6d61 7463 6820 7468 6520 7661  uld match the va
-0000f650: 6c75 6520 6f66 2061 7267 756d 656e 7420  lue of argument 
-0000f660: 7573 6564 2077 6865 6e20 6361 6c6c 696e  used when callin
-0000f670: 6720 6063 7265 6174 655f 7375 6273 6372  g `create_subscr
-0000f680: 6970 7469 6f6e 2829 602e 5c6e 5c6e 5468  iption()`.\n\nTh
-0000f690: 6973 206d 6574 686f 6420 616c 736f 2074  is method also t
-0000f6a0: 616b 6573 2061 6e20 6f70 7469 6f6e 616c  akes an optional
-0000f6b0: 2060 7469 6d65 6f75 7460 2061 7267 756d   `timeout` argum
-0000f6c0: 656e 742c 2074 6861 745c 6e69 7320 6578  ent, that\nis ex
-0000f6d0: 7065 6374 6564 2074 6f20 6265 2061 2050  pected to be a P
-0000f6e0: 7974 686f 6e20 6066 6c6f 6174 602c 2077  ython `float`, w
-0000f6f0: 6869 6368 2073 6574 7320 6120 6465 6164  hich sets a dead
-0000f700: 6c69 6e65 5c6e 666f 7220 7468 6520 636f  line\nfor the co
-0000f710: 6d70 6c65 7469 6f6e 206f 6620 7468 6520  mpletion of the 
-0000f720: 6752 5043 206f 7065 7261 7469 6f6e 2e5c  gRPC operation.\
-0000f730: 6e5c 6e60 6060 7079 7468 6f6e 5c6e 636c  n\n```python\ncl
-0000f740: 6965 6e74 2e64 656c 6574 655f 7375 6273  ient.delete_subs
-0000f750: 6372 6970 7469 6f6e 285c 6e20 2020 2067  cription(\n    g
-0000f760: 726f 7570 5f6e 616d 653d 6772 6f75 705f  roup_name=group_
-0000f770: 6e61 6d65 2c5c 6e29 5c6e 6060 605c 6e5c  name,\n)\n```\n\
-0000f780: 6e23 2323 2043 7265 6174 6520 7374 7265  n### Create stre
-0000f790: 616d 2073 7562 7363 7269 7074 696f 6e5c  am subscription\
-0000f7a0: 6e5c 6e2a 7265 7175 6972 6573 206c 6561  n\n*requires lea
-0000f7b0: 6465 722a 5c6e 5c6e 5468 6520 6063 7265  der*\n\nThe `cre
-0000f7c0: 6174 655f 7374 7265 616d 5f73 7562 7363  ate_stream_subsc
-0000f7d0: 7269 7074 696f 6e28 2960 206d 6574 686f  ription()` metho
-0000f7e0: 6420 6361 6e20 6265 2075 7365 6420 746f  d can be used to
-0000f7f0: 2063 7265 6174 6520 6120 7065 7273 6973   create a persis
-0000f800: 7465 6e74 5c6e 7375 6273 6372 6970 7469  tent\nsubscripti
-0000f810: 6f6e 2066 6f72 2061 2073 7472 6561 6d2e  on for a stream.
-0000f820: 5c6e 5c6e 5468 6973 206d 6574 686f 6420  \n\nThis method 
-0000f830: 6861 7320 7477 6f20 7265 7175 6972 6564  has two required
-0000f840: 2061 7267 756d 656e 7473 2c20 6067 726f   arguments, `gro
-0000f850: 7570 5f6e 616d 6560 2061 6e64 2060 7374  up_name` and `st
-0000f860: 7265 616d 5f6e 616d 6560 2e20 5468 655c  ream_name`. The\
-0000f870: 6e60 6772 6f75 705f 6e61 6d65 6020 6172  n`group_name` ar
-0000f880: 6775 6d65 6e74 206e 616d 6573 2074 6865  gument names the
-0000f890: 2067 726f 7570 206f 6620 636f 6e73 756d   group of consum
-0000f8a0: 6572 7320 7468 6174 2077 696c 6c20 7265  ers that will re
-0000f8b0: 6365 6976 6520 6576 656e 7473 5c6e 6672  ceive events\nfr
-0000f8c0: 6f6d 2074 6869 7320 7375 6273 6372 6970  om this subscrip
-0000f8d0: 7469 6f6e 2e20 5468 6520 6073 7472 6561  tion. The `strea
-0000f8e0: 6d5f 6e61 6d65 6020 6172 6775 6d65 6e74  m_name` argument
-0000f8f0: 2073 7065 6369 6669 6573 2077 6869 6368   specifies which
-0000f900: 2073 7472 6561 6d5c 6e74 6865 2073 7562   stream\nthe sub
-0000f910: 7363 7269 7074 696f 6e20 7769 6c6c 2066  scription will f
-0000f920: 6f6c 6c6f 772e 2054 6865 2076 616c 7565  ollow. The value
-0000f930: 7320 6f66 2062 6f74 6820 7468 6573 6520  s of both these 
-0000f940: 6172 6775 6d65 6e74 7320 6172 6520 6578  arguments are ex
-0000f950: 7065 6374 6564 5c6e 746f 2062 6520 5079  pected\nto be Py
-0000f960: 7468 6f6e 2060 7374 7260 206f 626a 6563  thon `str` objec
-0000f970: 7473 2e5c 6e5c 6e54 6865 206d 6574 686f  ts.\n\nThe metho
-0000f980: 6420 616c 736f 2074 616b 6573 2066 6f75  d also takes fou
-0000f990: 7220 6f70 7469 6f6e 616c 2061 7267 756d  r optional argum
-0000f9a0: 656e 7473 2c20 6073 7472 6561 6d5f 706f  ents, `stream_po
-0000f9b0: 7369 7469 6f6e 602c 2060 6672 6f6d 5f65  sition`, `from_e
-0000f9c0: 6e64 602c 5c6e 6063 6f6e 7375 6d65 725f  nd`,\n`consumer_
-0000f9d0: 7374 7261 7465 6779 602c 2061 6e64 2060  strategy`, and `
-0000f9e0: 7469 6d65 6f75 7460 2e5c 6e5c 6e54 6869  timeout`.\n\nThi
-0000f9f0: 7320 6f70 7469 6f6e 616c 2060 7374 7265  s optional `stre
-0000fa00: 616d 5f70 6f73 6974 696f 6e60 2061 7267  am_position` arg
-0000fa10: 756d 656e 7420 7370 6563 6966 6965 7320  ument specifies 
-0000fa20: 6120 7374 7265 616d 2070 6f73 6974 696f  a stream positio
-0000fa30: 6e20 6672 6f6d 5c6e 7768 6963 6820 746f  n from\nwhich to
-0000fa40: 2073 7562 7363 7269 6265 2e20 5468 6520   subscribe. The 
-0000fa50: 7265 636f 7264 6564 2065 7665 6e74 2061  recorded event a
-0000fa60: 7420 7468 6973 2073 7472 6561 6d5c 6e70  t this stream\np
-0000fa70: 6f73 6974 696f 6e20 7769 6c6c 2062 6520  osition will be 
-0000fa80: 7265 6365 6976 6564 2077 6865 6e20 7265  received when re
-0000fa90: 6164 696e 6720 7468 6520 7375 6273 6372  ading the subscr
-0000faa0: 6970 7469 6f6e 2e5c 6e5c 6e54 6869 7320  iption.\n\nThis 
-0000fab0: 6f70 7469 6f6e 616c 2060 6672 6f6d 5f65  optional `from_e
-0000fac0: 6e64 6020 6172 6775 6d65 6e74 2069 7320  nd` argument is 
-0000fad0: 6120 5079 7468 6f6e 2060 626f 6f6c 602e  a Python `bool`.
-0000fae0: 5c6e 4279 2064 6566 6175 6c74 2c20 7468  \nBy default, th
-0000faf0: 6520 7661 6c75 6520 6f66 2074 6869 7320  e value of this 
-0000fb00: 6172 6775 6d65 6e74 2069 7320 4661 6c73  argument is Fals
-0000fb10: 652e 2049 6620 7468 6973 2061 7267 756d  e. If this argum
-0000fb20: 656e 7420 6973 2073 6574 5c6e 746f 2061  ent is set\nto a
-0000fb30: 2054 7275 6520 7661 6c75 652c 2072 6561   True value, rea
-0000fb40: 6469 6e67 2066 726f 6d20 7468 6520 7375  ding from the su
-0000fb50: 6273 6372 6970 7469 6f6e 2077 696c 6c20  bscription will 
-0000fb60: 7265 6365 6976 6520 6f6e 6c79 2065 7665  receive only eve
-0000fb70: 6e74 735c 6e72 6563 6f72 6465 6420 6166  nts\nrecorded af
-0000fb80: 7465 7220 7468 6520 7375 6273 6372 6970  ter the subscrip
-0000fb90: 7469 6f6e 2077 6173 2063 7265 6174 6564  tion was created
-0000fba0: 2e20 5468 6174 2069 732c 2069 7420 6973  . That is, it is
-0000fbb0: 206e 6f74 2069 6e63 6c75 7369 7665 5c6e   not inclusive\n
-0000fbc0: 6f66 2074 6865 2063 7572 7265 6e74 2073  of the current s
-0000fbd0: 7472 6561 6d20 706f 7369 7469 6f6e 2e5c  tream position.\
-0000fbe0: 6e5c 6e54 6865 206f 7074 696f 6e61 6c20  n\nThe optional 
-0000fbf0: 6063 6f6e 7375 6d65 725f 7374 7261 7465  `consumer_strate
-0000fc00: 6779 6020 6172 6775 6d65 6e74 2069 7320  gy` argument is 
-0000fc10: 6120 5079 7468 6f6e 2060 7374 7260 2074  a Python `str` t
-0000fc20: 6861 7420 6465 6669 6e65 735c 6e74 6865  hat defines\nthe
-0000fc30: 2063 6f6e 7375 6d65 7220 7374 7261 7465   consumer strate
-0000fc40: 6779 2066 6f72 2074 6869 7320 7065 7273  gy for this pers
-0000fc50: 6973 7465 6e74 2073 7562 7363 7269 7074  istent subscript
-0000fc60: 696f 6e2e 2054 6865 2076 616c 7565 206f  ion. The value o
-0000fc70: 6620 7468 6973 2061 7267 756d 656e 745c  f this argument\
-0000fc80: 6e63 616e 2062 6520 605c 2744 6973 7061  ncan be `\'Dispa
-0000fc90: 7463 6854 6f53 696e 676c 655c 2760 2c20  tchToSingle\'`, 
-0000fca0: 605c 2752 6f75 6e64 526f 6269 6e5c 2760  `\'RoundRobin\'`
-0000fcb0: 2c20 605c 2750 696e 6e65 645c 2760 2c20  , `\'Pinned\'`, 
-0000fcc0: 6f72 2060 5c27 5069 6e6e 6564 4279 436f  or `\'PinnedByCo
-0000fcd0: 7272 656c 6174 696f 6e5c 2760 2e20 5468  rrelation\'`. Th
-0000fce0: 655c 6e64 6566 6175 6c74 2076 616c 7565  e\ndefault value
-0000fcf0: 2069 7320 605c 2744 6973 7061 7463 6854   is `\'DispatchT
-0000fd00: 6f53 696e 676c 655c 2760 2e5c 6e5c 6e54  oSingle\'`.\n\nT
-0000fd10: 6869 7320 6d65 7468 6f64 2061 6c73 6f20  his method also 
-0000fd20: 7461 6b65 7320 616e 206f 7074 696f 6e61  takes an optiona
-0000fd30: 6c20 6074 696d 656f 7574 6020 6172 6775  l `timeout` argu
-0000fd40: 6d65 6e74 2c20 7468 6174 5c6e 6973 2065  ment, that\nis e
-0000fd50: 7870 6563 7465 6420 746f 2062 6520 6120  xpected to be a 
-0000fd60: 5079 7468 6f6e 2060 666c 6f61 7460 2c20  Python `float`, 
-0000fd70: 7768 6963 6820 7365 7473 2061 2064 6561  which sets a dea
-0000fd80: 646c 696e 655c 6e66 6f72 2074 6865 2063  dline\nfor the c
-0000fd90: 6f6d 706c 6574 696f 6e20 6f66 2074 6865  ompletion of the
-0000fda0: 2067 5250 4320 6f70 6572 6174 696f 6e2e   gRPC operation.
-0000fdb0: 5c6e 5c6e 5468 6973 206d 6574 686f 6420  \n\nThis method 
-0000fdc0: 646f 6573 206e 6f74 2072 6574 7572 6e20  does not return 
-0000fdd0: 6120 7661 6c75 652e 2045 7665 6e74 7320  a value. Events 
-0000fde0: 6361 6e20 6265 2072 6563 6569 7665 6420  can be received 
-0000fdf0: 6279 2069 7465 7261 7469 6e67 5c6e 6f76  by iterating\nov
-0000fe00: 6572 2074 6865 2076 616c 7565 2072 6574  er the value ret
-0000fe10: 7572 6e65 6420 6279 2063 616c 6c69 6e67  urned by calling
-0000fe20: 2060 7265 6164 5f73 7472 6561 6d5f 7375   `read_stream_su
-0000fe30: 6273 6372 6970 7469 6f6e 2829 6020 2873  bscription()` (s
-0000fe40: 6565 2062 656c 6f77 292e 5c6e 5c6e 5468  ee below).\n\nTh
-0000fe50: 6520 6578 616d 706c 6520 6265 6c6f 7720  e example below 
-0000fe60: 6372 6561 7465 7320 6120 7065 7273 6973  creates a persis
-0000fe70: 7465 6e74 2073 7472 6561 6d20 7375 6273  tent stream subs
-0000fe80: 6372 6970 7469 6f6e 2066 726f 6d20 7468  cription from th
-0000fe90: 6520 7374 6172 7420 6f66 2074 6865 2073  e start of the s
-0000fea0: 7472 6561 6d2e 5c6e 5c6e 6060 6070 7974  tream.\n\n```pyt
-0000feb0: 686f 6e5c 6e23 2043 7265 6174 6520 6120  hon\n# Create a 
-0000fec0: 7065 7273 6973 7465 6e74 2073 7472 6561  persistent strea
-0000fed0: 6d20 7375 6273 6372 6970 7469 6f6e 2066  m subscription f
-0000fee0: 726f 6d20 7374 6172 7420 6f66 2074 6865  rom start of the
-0000fef0: 2073 7472 6561 6d2e 5c6e 6772 6f75 705f   stream.\ngroup_
-0000ff00: 6e61 6d65 3120 3d20 6622 6772 6f75 702d  name1 = f"group-
-0000ff10: 7b75 7569 6434 2829 7d22 5c6e 636c 6965  {uuid4()}"\nclie
-0000ff20: 6e74 2e63 7265 6174 655f 7374 7265 616d  nt.create_stream
-0000ff30: 5f73 7562 7363 7269 7074 696f 6e28 5c6e  _subscription(\n
-0000ff40: 2020 2020 6772 6f75 705f 6e61 6d65 3d67      group_name=g
-0000ff50: 726f 7570 5f6e 616d 6531 2c5c 6e20 2020  roup_name1,\n   
-0000ff60: 2073 7472 6561 6d5f 6e61 6d65 3d73 7472   stream_name=str
-0000ff70: 6561 6d5f 6e61 6d65 322c 5c6e 295c 6e60  eam_name2,\n)\n`
-0000ff80: 6060 5c6e 5c6e 5468 6520 6578 616d 706c  ``\n\nThe exampl
-0000ff90: 6520 6265 6c6f 7720 6372 6561 7465 7320  e below creates 
-0000ffa0: 6120 7065 7273 6973 7465 6e74 2073 7472  a persistent str
-0000ffb0: 6561 6d20 7375 6273 6372 6970 7469 6f6e  eam subscription
-0000ffc0: 2066 726f 6d20 6120 7374 7265 616d 2070   from a stream p
-0000ffd0: 6f73 6974 696f 6e2e 5c6e 5c6e 6060 6070  osition.\n\n```p
-0000ffe0: 7974 686f 6e5c 6e23 2043 7265 6174 6520  ython\n# Create 
-0000fff0: 6120 7065 7273 6973 7465 6e74 2073 7472  a persistent str
-00010000: 6561 6d20 7375 6273 6372 6970 7469 6f6e  eam subscription
-00010010: 2066 726f 6d20 6120 7374 7265 616d 2070   from a stream p
-00010020: 6f73 6974 696f 6e2e 5c6e 6772 6f75 705f  osition.\ngroup_
-00010030: 6e61 6d65 3220 3d20 6622 6772 6f75 702d  name2 = f"group-
-00010040: 7b75 7569 6434 2829 7d22 5c6e 636c 6965  {uuid4()}"\nclie
-00010050: 6e74 2e63 7265 6174 655f 7374 7265 616d  nt.create_stream
-00010060: 5f73 7562 7363 7269 7074 696f 6e28 5c6e  _subscription(\n
-00010070: 2020 2020 6772 6f75 705f 6e61 6d65 3d67      group_name=g
-00010080: 726f 7570 5f6e 616d 6532 2c5c 6e20 2020  roup_name2,\n   
-00010090: 2073 7472 6561 6d5f 6e61 6d65 3d73 7472   stream_name=str
-000100a0: 6561 6d5f 6e61 6d65 322c 5c6e 2020 2020  eam_name2,\n    
-000100b0: 7374 7265 616d 5f70 6f73 6974 696f 6e3d  stream_position=
-000100c0: 325c 6e29 5c6e 6060 605c 6e5c 6e54 6865  2\n)\n```\n\nThe
-000100d0: 2065 7861 6d70 6c65 2062 656c 6f77 2063   example below c
-000100e0: 7265 6174 6573 2061 2070 6572 7369 7374  reates a persist
-000100f0: 656e 7420 7374 7265 616d 2073 7562 7363  ent stream subsc
-00010100: 7269 7074 696f 6e20 6672 6f6d 2074 6865  ription from the
-00010110: 2065 6e64 206f 6620 7468 6520 7374 7265   end of the stre
-00010120: 616d 2e5c 6e5c 6e60 6060 7079 7468 6f6e  am.\n\n```python
-00010130: 5c6e 2320 4372 6561 7465 2061 2070 6572  \n# Create a per
-00010140: 7369 7374 656e 7420 7374 7265 616d 2073  sistent stream s
-00010150: 7562 7363 7269 7074 696f 6e20 6672 6f6d  ubscription from
-00010160: 2065 6e64 206f 6620 7468 6520 7374 7265   end of the stre
-00010170: 616d 2e5c 6e67 726f 7570 5f6e 616d 6533  am.\ngroup_name3
-00010180: 203d 2066 2267 726f 7570 2d7b 7575 6964   = f"group-{uuid
-00010190: 3428 297d 225c 6e63 6c69 656e 742e 6372  4()}"\nclient.cr
-000101a0: 6561 7465 5f73 7472 6561 6d5f 7375 6273  eate_stream_subs
-000101b0: 6372 6970 7469 6f6e 285c 6e20 2020 2067  cription(\n    g
-000101c0: 726f 7570 5f6e 616d 653d 6772 6f75 705f  roup_name=group_
-000101d0: 6e61 6d65 332c 5c6e 2020 2020 7374 7265  name3,\n    stre
-000101e0: 616d 5f6e 616d 653d 7374 7265 616d 5f6e  am_name=stream_n
-000101f0: 616d 6532 2c5c 6e20 2020 2066 726f 6d5f  ame2,\n    from_
-00010200: 656e 643d 5472 7565 5c6e 295c 6e60 6060  end=True\n)\n```
-00010210: 5c6e 5c6e 2323 2320 5265 6164 2073 7472  \n\n### Read str
-00010220: 6561 6d20 7375 6273 6372 6970 7469 6f6e  eam subscription
-00010230: 5c6e 5c6e 2a72 6571 7569 7265 7320 6c65  \n\n*requires le
-00010240: 6164 6572 2a5c 6e5c 6e54 6865 2060 7265  ader*\n\nThe `re
-00010250: 6164 5f73 7472 6561 6d5f 7375 6273 6372  ad_stream_subscr
-00010260: 6970 7469 6f6e 2829 6020 6d65 7468 6f64  iption()` method
-00010270: 2063 616e 2062 6520 7573 6564 2074 6f20   can be used to 
-00010280: 6372 6561 7465 2061 2070 6572 7369 7374  create a persist
-00010290: 656e 745c 6e73 7562 7363 7269 7074 696f  ent\nsubscriptio
-000102a0: 6e20 666f 7220 6120 7374 7265 616d 2e5c  n for a stream.\
-000102b0: 6e5c 6e54 6869 7320 6d65 7468 6f64 2068  n\nThis method h
-000102c0: 6173 2074 776f 2072 6571 7569 7265 6420  as two required 
-000102d0: 6172 6775 6d65 6e74 732c 2060 6772 6f75  arguments, `grou
-000102e0: 705f 6e61 6d65 6020 616e 6420 6073 7472  p_name` and `str
-000102f0: 6561 6d5f 6e61 6d65 602c 2077 6869 6368  eam_name`, which
-00010300: 5c6e 7368 6f75 6c64 206d 6174 6368 2074  \nshould match t
-00010310: 6865 2076 616c 7565 7320 6f66 2061 7267  he values of arg
-00010320: 756d 656e 7473 2075 7365 6420 7768 656e  uments used when
-00010330: 2063 616c 6c69 6e67 2060 6372 6561 7465   calling `create
-00010340: 5f73 7472 6561 6d5f 7375 6273 6372 6970  _stream_subscrip
-00010350: 7469 6f6e 2829 602e 5c6e 5c6e 5468 6973  tion()`.\n\nThis
-00010360: 206d 6574 686f 6420 616c 736f 2074 616b   method also tak
-00010370: 6573 2061 6e20 6f70 7469 6f6e 616c 2060  es an optional `
-00010380: 7469 6d65 6f75 7460 2061 7267 756d 656e  timeout` argumen
-00010390: 742c 2074 6861 745c 6e69 7320 6578 7065  t, that\nis expe
-000103a0: 6374 6564 2074 6f20 6265 2061 2050 7974  cted to be a Pyt
-000103b0: 686f 6e20 6066 6c6f 6174 602c 2077 6869  hon `float`, whi
-000103c0: 6368 2073 6574 7320 6120 6465 6164 6c69  ch sets a deadli
-000103d0: 6e65 5c6e 666f 7220 7468 6520 636f 6d70  ne\nfor the comp
-000103e0: 6c65 7469 6f6e 206f 6620 7468 6520 6752  letion of the gR
-000103f0: 5043 206f 7065 7261 7469 6f6e 2e5c 6e5c  PC operation.\n\
-00010400: 6e4a 7573 7420 6c69 6b65 2060 7265 6164  nJust like `read
-00010410: 5f73 7562 7363 7269 7074 696f 6e60 2c20  _subscription`, 
-00010420: 7468 6973 206d 6574 686f 6420 7265 7475  this method retu
-00010430: 726e 7320 6120 322d 7475 706c 653a 2061  rns a 2-tuple: a
-00010440: 2022 7265 6164 2072 6571 7565 7374 2220   "read request" 
-00010450: 6f62 6a65 6374 5c6e 616e 6420 6120 2272  object\nand a "r
-00010460: 6561 6420 7265 7370 6f6e 7365 2220 6f62  ead response" ob
-00010470: 6a65 6374 2e5c 6e5c 6e60 6060 7079 7468  ject.\n\n```pyth
-00010480: 6f6e 5c6e 7265 6164 5f72 6571 2c20 7265  on\nread_req, re
-00010490: 6164 5f72 6573 7020 3d20 636c 6965 6e74  ad_resp = client
-000104a0: 2e72 6561 645f 7374 7265 616d 5f73 7562  .read_stream_sub
-000104b0: 7363 7269 7074 696f 6e28 5c6e 2020 2020  scription(\n    
-000104c0: 6772 6f75 705f 6e61 6d65 3d67 726f 7570  group_name=group
-000104d0: 5f6e 616d 6531 2c5c 6e20 2020 2073 7472  _name1,\n    str
-000104e0: 6561 6d5f 6e61 6d65 3d73 7472 6561 6d5f  eam_name=stream_
-000104f0: 6e61 6d65 322c 5c6e 295c 6e60 6060 5c6e  name2,\n)\n```\n
-00010500: 5c6e 5468 6520 6578 616d 706c 6520 6265  \nThe example be
-00010510: 6c6f 7720 6974 6572 6174 6573 206f 7665  low iterates ove
-00010520: 7220 7468 6520 2272 6561 6420 7265 7370  r the "read resp
-00010530: 6f6e 7365 2220 6f62 6a65 6374 2c20 616e  onse" object, an
-00010540: 6420 6361 6c6c 7320 6061 636b 2829 605c  d calls `ack()`\
-00010550: 6e6f 6e20 7468 6520 2272 6561 6420 7265  non the "read re
-00010560: 7370 6f6e 7365 2220 6f62 6a65 6374 2e20  sponse" object. 
-00010570: 5468 6520 666f 7220 6c6f 6f70 2062 7265  The for loop bre
-00010580: 616b 7320 7768 656e 2077 6520 6861 7665  aks when we have
-00010590: 2072 6563 6569 7665 645c 6e74 6865 206c   received\nthe l
-000105a0: 6173 7420 6576 656e 7420 696e 2074 6865  ast event in the
-000105b0: 2073 7472 6561 6d2c 2073 6f20 7468 6174   stream, so that
-000105c0: 2077 6520 6361 6e20 6669 6e69 7368 2074   we can finish t
-000105d0: 6865 2065 7861 6d70 6c65 7320 696e 2074  he examples in t
-000105e0: 6869 735c 6e64 6f63 756d 656e 7461 7469  his\ndocumentati
-000105f0: 6f6e 2e5c 6e5c 6e60 6060 7079 7468 6f6e  on.\n\n```python
-00010600: 5c6e 6576 656e 7473 203d 205b 5d5c 6e66  \nevents = []\nf
-00010610: 6f72 2065 7665 6e74 2069 6e20 7265 6164  or event in read
-00010620: 5f72 6573 703a 5c6e 2020 2020 6576 656e  _resp:\n    even
-00010630: 7473 2e61 7070 656e 6428 6576 656e 7429  ts.append(event)
-00010640: 5c6e 5c6e 2020 2020 2320 4163 6b6e 6f77  \n\n    # Acknow
-00010650: 6c65 6467 6520 7468 6520 7265 6365 6976  ledge the receiv
-00010660: 6564 2065 7665 6e74 2e5c 6e20 2020 2072  ed event.\n    r
-00010670: 6561 645f 7265 712e 6163 6b28 6576 656e  ead_req.ack(even
-00010680: 745f 6964 3d65 7665 6e74 2e69 6429 5c6e  t_id=event.id)\n
-00010690: 5c6e 2020 2020 2320 4272 6561 6b20 7768  \n    # Break wh
-000106a0: 656e 2074 6865 206c 6173 7420 6576 656e  en the last even
-000106b0: 7420 6861 7320 6265 656e 2072 6563 6569  t has been recei
-000106c0: 7665 642e 5c6e 2020 2020 6966 2065 7665  ved.\n    if eve
-000106d0: 6e74 2e69 6420 3d3d 2065 7665 6e74 3131  nt.id == event11
-000106e0: 2e69 643a 5c6e 2020 2020 2020 2020 6272  .id:\n        br
-000106f0: 6561 6b5c 6e60 6060 5c6e 5c6e 5765 2063  eak\n```\n\nWe c
-00010700: 616e 2063 6865 636b 2077 6520 7265 6365  an check we rece
-00010710: 6976 6564 2061 6c6c 2074 6865 2065 7665  ived all the eve
-00010720: 6e74 7320 7468 6174 2077 6572 6520 6170  nts that were ap
-00010730: 7065 6e64 6564 2074 6f20 6073 7472 6561  pended to `strea
-00010740: 6d5f 6e61 6d65 3260 5c6e 696e 2074 6865  m_name2`\nin the
-00010750: 2065 7861 6d70 6c65 7320 6162 6f76 652e   examples above.
-00010760: 5c6e 5c6e 6060 6070 7974 686f 6e5c 6e61  \n\n```python\na
-00010770: 7373 6572 7420 6c65 6e28 6576 656e 7473  ssert len(events
-00010780: 2920 3d3d 2034 5c6e 6173 7365 7274 2065  ) == 4\nassert e
-00010790: 7665 6e74 735b 305d 2e73 7472 6561 6d5f  vents[0].stream_
-000107a0: 6e61 6d65 203d 3d20 7374 7265 616d 5f6e  name == stream_n
-000107b0: 616d 6532 5c6e 6173 7365 7274 2065 7665  ame2\nassert eve
-000107c0: 6e74 735b 305d 2e69 6420 3d3d 2065 7665  nts[0].id == eve
-000107d0: 6e74 342e 6964 5c6e 6173 7365 7274 2065  nt4.id\nassert e
-000107e0: 7665 6e74 735b 315d 2e73 7472 6561 6d5f  vents[1].stream_
-000107f0: 6e61 6d65 203d 3d20 7374 7265 616d 5f6e  name == stream_n
-00010800: 616d 6532 5c6e 6173 7365 7274 2065 7665  ame2\nassert eve
-00010810: 6e74 735b 315d 2e69 6420 3d3d 2065 7665  nts[1].id == eve
-00010820: 6e74 352e 6964 5c6e 6173 7365 7274 2065  nt5.id\nassert e
-00010830: 7665 6e74 735b 325d 2e73 7472 6561 6d5f  vents[2].stream_
-00010840: 6e61 6d65 203d 3d20 7374 7265 616d 5f6e  name == stream_n
-00010850: 616d 6532 5c6e 6173 7365 7274 2065 7665  ame2\nassert eve
-00010860: 6e74 735b 325d 2e69 6420 3d3d 2065 7665  nts[2].id == eve
-00010870: 6e74 362e 6964 5c6e 6173 7365 7274 2065  nt6.id\nassert e
-00010880: 7665 6e74 735b 335d 2e73 7472 6561 6d5f  vents[3].stream_
-00010890: 6e61 6d65 203d 3d20 7374 7265 616d 5f6e  name == stream_n
-000108a0: 616d 6532 5c6e 6173 7365 7274 2065 7665  ame2\nassert eve
-000108b0: 6e74 735b 335d 2e69 6420 3d3d 2065 7665  nts[3].id == eve
-000108c0: 6e74 3131 2e69 645c 6e60 6060 5c6e 5c6e  nt11.id\n```\n\n
-000108d0: 2323 2320 4765 7420 7374 7265 616d 2073  ### Get stream s
-000108e0: 7562 7363 7269 7074 696f 6e20 696e 666f  ubscription info
-000108f0: 5c6e 5c6e 2a72 6571 7569 7265 7320 6c65  \n\n*requires le
-00010900: 6164 6572 2a5c 6e5c 6e54 6865 2060 6765  ader*\n\nThe `ge
-00010910: 745f 7374 7265 616d 5f73 7562 7363 7269  t_stream_subscri
-00010920: 7074 696f 6e5f 696e 666f 2829 6020 6d65  ption_info()` me
-00010930: 7468 6f64 2063 616e 2062 6520 7573 6564  thod can be used
-00010940: 2074 6f20 6765 7420 696e 666f 726d 6174   to get informat
-00010950: 696f 6e20 666f 7220 615c 6e70 6572 7369  ion for a\npersi
-00010960: 7374 656e 7420 7375 6273 6372 6970 7469  stent subscripti
-00010970: 6f6e 2066 6f72 2061 2073 7472 6561 6d2e  on for a stream.
-00010980: 5c6e 5c6e 5468 6973 206d 6574 686f 6420  \n\nThis method 
-00010990: 6861 7320 7477 6f20 7265 7175 6972 6564  has two required
-000109a0: 2061 7267 756d 656e 7473 2c20 6067 726f   arguments, `gro
-000109b0: 7570 5f6e 616d 6560 2061 6e64 2060 7374  up_name` and `st
-000109c0: 7265 616d 5f6e 616d 6560 2c20 7768 6963  ream_name`, whic
-000109d0: 685c 6e73 686f 756c 6420 6d61 7463 6820  h\nshould match 
-000109e0: 7468 6520 7661 6c75 6573 206f 6620 6172  the values of ar
-000109f0: 6775 6d65 6e74 7320 7573 6564 2077 6865  guments used whe
-00010a00: 6e20 6361 6c6c 696e 6720 6063 7265 6174  n calling `creat
-00010a10: 655f 7374 7265 616d 5f73 7562 7363 7269  e_stream_subscri
-00010a20: 7074 696f 6e28 2960 2e5c 6e5c 6e54 6869  ption()`.\n\nThi
-00010a30: 7320 6d65 7468 6f64 2061 6c73 6f20 7461  s method also ta
-00010a40: 6b65 7320 616e 206f 7074 696f 6e61 6c20  kes an optional 
-00010a50: 6074 696d 656f 7574 6020 6172 6775 6d65  `timeout` argume
-00010a60: 6e74 2c20 7468 6174 5c6e 6973 2065 7870  nt, that\nis exp
-00010a70: 6563 7465 6420 746f 2062 6520 6120 5079  ected to be a Py
-00010a80: 7468 6f6e 2060 666c 6f61 7460 2c20 7768  thon `float`, wh
-00010a90: 6963 6820 7365 7473 2061 2064 6561 646c  ich sets a deadl
-00010aa0: 696e 655c 6e66 6f72 2074 6865 2063 6f6d  ine\nfor the com
-00010ab0: 706c 6574 696f 6e20 6f66 2074 6865 2067  pletion of the g
-00010ac0: 5250 4320 6f70 6572 6174 696f 6e2e 5c6e  RPC operation.\n
-00010ad0: 5c6e 6060 6070 7974 686f 6e5c 6e73 7562  \n```python\nsub
-00010ae0: 7363 7269 7074 696f 6e5f 696e 666f 203d  scription_info =
-00010af0: 2063 6c69 656e 742e 6765 745f 7374 7265   client.get_stre
-00010b00: 616d 5f73 7562 7363 7269 7074 696f 6e5f  am_subscription_
-00010b10: 696e 666f 285c 6e20 2020 2067 726f 7570  info(\n    group
-00010b20: 5f6e 616d 653d 6772 6f75 705f 6e61 6d65  _name=group_name
-00010b30: 312c 5c6e 2020 2020 7374 7265 616d 5f6e  1,\n    stream_n
-00010b40: 616d 653d 7374 7265 616d 5f6e 616d 6532  ame=stream_name2
-00010b50: 2c5c 6e29 5c6e 6060 605c 6e5c 6e54 6865  ,\n)\n```\n\nThe
-00010b60: 2072 6574 7572 6e65 6420 7661 6c75 6520   returned value 
-00010b70: 6973 2061 2060 5375 6273 6372 6970 7469  is a `Subscripti
-00010b80: 6f6e 496e 666f 6020 6f62 6a65 6374 2e5c  onInfo` object.\
-00010b90: 6e5c 6e23 2323 204c 6973 7420 7374 7265  n\n### List stre
-00010ba0: 616d 2073 7562 7363 7269 7074 696f 6e73  am subscriptions
-00010bb0: 5c6e 5c6e 2a72 6571 7569 7265 7320 6c65  \n\n*requires le
-00010bc0: 6164 6572 2a5c 6e5c 6e54 6865 2060 6c69  ader*\n\nThe `li
-00010bd0: 7374 5f73 7472 6561 6d5f 7375 6273 6372  st_stream_subscr
-00010be0: 6970 7469 6f6e 7328 2960 206d 6574 686f  iptions()` metho
-00010bf0: 6420 6361 6e20 6265 2075 7365 6420 746f  d can be used to
-00010c00: 2067 6574 2069 6e66 6f72 6d61 7469 6f6e   get information
-00010c10: 2066 6f72 2061 6c6c 5c6e 7468 6520 7065   for all\nthe pe
-00010c20: 7273 6973 7465 6e74 2073 7562 7363 7269  rsistent subscri
-00010c30: 7074 696f 6e73 2066 6f72 2061 2073 7472  ptions for a str
-00010c40: 6561 6d2e 5c6e 5c6e 5468 6973 206d 6574  eam.\n\nThis met
-00010c50: 686f 6420 6861 7320 6f6e 6520 7265 7175  hod has one requ
-00010c60: 6972 6564 2061 7267 756d 656e 742c 2060  ired argument, `
-00010c70: 7374 7265 616d 5f6e 616d 6560 2e5c 6e5c  stream_name`.\n\
-00010c80: 6e54 6869 7320 6d65 7468 6f64 2061 6c73  nThis method als
-00010c90: 6f20 7461 6b65 7320 616e 206f 7074 696f  o takes an optio
-00010ca0: 6e61 6c20 6074 696d 656f 7574 6020 6172  nal `timeout` ar
-00010cb0: 6775 6d65 6e74 2c20 7468 6174 5c6e 6973  gument, that\nis
-00010cc0: 2065 7870 6563 7465 6420 746f 2062 6520   expected to be 
-00010cd0: 6120 5079 7468 6f6e 2060 666c 6f61 7460  a Python `float`
-00010ce0: 2c20 7768 6963 6820 7365 7473 2061 2064  , which sets a d
-00010cf0: 6561 646c 696e 655c 6e66 6f72 2074 6865  eadline\nfor the
-00010d00: 2063 6f6d 706c 6574 696f 6e20 6f66 2074   completion of t
-00010d10: 6865 2067 5250 4320 6f70 6572 6174 696f  he gRPC operatio
-00010d20: 6e2e 5c6e 5c6e 6060 6070 7974 686f 6e5c  n.\n\n```python\
-00010d30: 6e73 7562 7363 7269 7074 696f 6e73 203d  nsubscriptions =
-00010d40: 2063 6c69 656e 742e 6c69 7374 5f73 7472   client.list_str
-00010d50: 6561 6d5f 7375 6273 6372 6970 7469 6f6e  eam_subscription
-00010d60: 7328 5c6e 2020 2020 7374 7265 616d 5f6e  s(\n    stream_n
-00010d70: 616d 653d 7374 7265 616d 5f6e 616d 6532  ame=stream_name2
-00010d80: 2c5c 6e29 5c6e 6060 605c 6e5c 6e54 6865  ,\n)\n```\n\nThe
-00010d90: 2072 6574 7572 6e65 6420 7661 6c75 6520   returned value 
-00010da0: 6973 2061 206c 6973 7420 6f66 2060 5375  is a list of `Su
-00010db0: 6273 6372 6970 7469 6f6e 496e 666f 6020  bscriptionInfo` 
-00010dc0: 6f62 6a65 6374 732e 5c6e 5c6e 2323 2320  objects.\n\n### 
-00010dd0: 4465 6c65 7465 2073 7472 6561 6d20 7375  Delete stream su
-00010de0: 6273 6372 6970 7469 6f6e 5c6e 5c6e 2a72  bscription\n\n*r
-00010df0: 6571 7569 7265 7320 6c65 6164 6572 2a5c  equires leader*\
-00010e00: 6e5c 6e54 6865 2060 6465 6c65 7465 5f73  n\nThe `delete_s
-00010e10: 7472 6561 6d5f 7375 6273 6372 6970 7469  tream_subscripti
-00010e20: 6f6e 2829 6020 6d65 7468 6f64 2063 616e  on()` method can
-00010e30: 2062 6520 7573 6564 2074 6f20 6465 6c65   be used to dele
-00010e40: 7465 2061 2070 6572 7369 7374 656e 745c  te a persistent\
-00010e50: 6e73 7562 7363 7269 7074 696f 6e20 666f  nsubscription fo
-00010e60: 7220 6120 7374 7265 616d 2e5c 6e5c 6e54  r a stream.\n\nT
-00010e70: 6869 7320 6d65 7468 6f64 2068 6173 2074  his method has t
-00010e80: 776f 2072 6571 7569 7265 6420 6172 6775  wo required argu
-00010e90: 6d65 6e74 732c 2060 6772 6f75 705f 6e61  ments, `group_na
-00010ea0: 6d65 6020 616e 6420 6073 7472 6561 6d5f  me` and `stream_
-00010eb0: 6e61 6d65 602c 2077 6869 6368 5c6e 7368  name`, which\nsh
-00010ec0: 6f75 6c64 206d 6174 6368 2074 6865 2076  ould match the v
-00010ed0: 616c 7565 7320 6f66 2061 7267 756d 656e  alues of argumen
-00010ee0: 7473 2075 7365 6420 7768 656e 2063 616c  ts used when cal
-00010ef0: 6c69 6e67 2060 6372 6561 7465 5f73 7472  ling `create_str
-00010f00: 6561 6d5f 7375 6273 6372 6970 7469 6f6e  eam_subscription
-00010f10: 2829 602e 5c6e 5c6e 5468 6973 206d 6574  ()`.\n\nThis met
-00010f20: 686f 6420 616c 736f 2074 616b 6573 2061  hod also takes a
-00010f30: 6e20 6f70 7469 6f6e 616c 2060 7469 6d65  n optional `time
-00010f40: 6f75 7460 2061 7267 756d 656e 742c 2074  out` argument, t
-00010f50: 6861 745c 6e69 7320 6578 7065 6374 6564  hat\nis expected
-00010f60: 2074 6f20 6265 2061 2050 7974 686f 6e20   to be a Python 
-00010f70: 6066 6c6f 6174 602c 2077 6869 6368 2073  `float`, which s
-00010f80: 6574 7320 6120 6465 6164 6c69 6e65 5c6e  ets a deadline\n
-00010f90: 666f 7220 7468 6520 636f 6d70 6c65 7469  for the completi
-00010fa0: 6f6e 206f 6620 7468 6520 6752 5043 206f  on of the gRPC o
-00010fb0: 7065 7261 7469 6f6e 2e5c 6e5c 6e60 6060  peration.\n\n```
-00010fc0: 7079 7468 6f6e 5c6e 636c 6965 6e74 2e64  python\nclient.d
-00010fd0: 656c 6574 655f 7374 7265 616d 5f73 7562  elete_stream_sub
-00010fe0: 7363 7269 7074 696f 6e28 5c6e 2020 2020  scription(\n    
-00010ff0: 6772 6f75 705f 6e61 6d65 3d67 726f 7570  group_name=group
-00011000: 5f6e 616d 6531 2c5c 6e20 2020 2073 7472  _name1,\n    str
-00011010: 6561 6d5f 6e61 6d65 3d73 7472 6561 6d5f  eam_name=stream_
-00011020: 6e61 6d65 322c 5c6e 295c 6e60 6060 5c6e  name2,\n)\n```\n
-00011030: 5c6e 2323 2043 6f6e 6e65 6374 696f 6e5c  \n## Connection\
-00011040: 6e5c 6e23 2323 2052 6563 6f6e 6e65 6374  n\n### Reconnect
-00011050: 5c6e 5c6e 5468 6520 6072 6563 6f6e 6e65  \n\nThe `reconne
-00011060: 6374 2829 6020 6d65 7468 6f64 2063 616e  ct()` method can
-00011070: 2062 6520 7573 6564 2074 6f20 6d61 6e75   be used to manu
-00011080: 616c 6c79 2072 6563 6f6e 6e65 6374 2074  ally reconnect t
-00011090: 6865 2063 6c69 656e 7420 746f 2061 5c6e  he client to a\n
-000110a0: 7375 6974 6162 6c65 2045 7665 6e74 5374  suitable EventSt
-000110b0: 6f72 6544 4220 6e6f 6465 2e20 5468 6973  oreDB node. This
-000110c0: 206d 6574 686f 6420 7573 6573 2074 6865   method uses the
-000110d0: 2073 616d 6520 726f 7574 696e 6520 666f   same routine fo
-000110e0: 7220 7265 6164 696e 6720 7468 655c 6e63  r reading the\nc
-000110f0: 6c75 7374 6572 206e 6f64 6520 7374 6174  luster node stat
-00011100: 6573 2061 6e64 2074 6865 6e20 636f 6e6e  es and then conn
-00011110: 6563 7469 6e67 2074 6f20 6120 7375 6974  ecting to a suit
-00011120: 6162 6c65 206e 6f64 6520 6163 636f 7264  able node accord
-00011130: 696e 6720 746f 2074 6865 5c6e 636c 6965  ing to the\nclie
-00011140: 6e74 5c27 7320 6e6f 6465 2070 7265 6665  nt\'s node prefe
-00011150: 7265 6e63 6520 7468 6174 2069 7320 7370  rence that is sp
-00011160: 6563 6966 6965 6420 696e 2074 6865 2063  ecified in the c
-00011170: 6f6e 6e65 6374 696f 6e20 7374 7269 6e67  onnection string
-00011180: 2055 5249 2077 6865 6e5c 6e74 6865 2063   URI when\nthe c
-00011190: 6c69 656e 7420 6973 2063 6f6e 7374 7275  lient is constru
-000111a0: 6374 6564 2e20 5468 6973 206d 6574 686f  cted. This metho
-000111b0: 6420 6973 2074 6872 6561 642d 7361 6665  d is thread-safe
-000111c0: 2c20 616e 6420 6974 2069 7320 2263 6f6e  , and it is "con
-000111d0: 7365 7276 6174 6976 6522 5c6e 696e 2074  servative"\nin t
-000111e0: 6861 742c 2077 6865 6e20 6974 2069 7320  hat, when it is 
-000111f0: 6361 6c6c 6564 2062 7920 7365 7665 7261  called by severa
-00011200: 6c20 7468 7265 6164 7320 6174 2074 6865  l threads at the
-00011210: 2073 616d 6520 7469 6d65 2c20 6f6e 6c79   same time, only
-00011220: 206f 6e65 5c6e 7265 636f 6e6e 6563 7469   one\nreconnecti
-00011230: 6f6e 2077 696c 6c20 6f63 6375 722e 2043  on will occur. C
-00011240: 6f6e 6375 7272 656e 7420 6174 7465 6d70  oncurrent attemp
-00011250: 7473 2074 6f20 7265 636f 6e6e 6563 7420  ts to reconnect 
-00011260: 7769 6c6c 2062 6c6f 636b 2075 6e74 696c  will block until
-00011270: 5c6e 7468 6520 636c 6965 6e74 2068 6173  \nthe client has
-00011280: 2072 6563 6f6e 6e65 6374 6564 2073 7563   reconnected suc
-00011290: 6365 7373 6675 6c6c 792c 2061 6e64 2074  cessfully, and t
-000112a0: 6865 6e20 7468 6579 2077 696c 6c20 616c  hen they will al
-000112b0: 6c20 7265 7475 726e 206e 6f72 6d61 6c6c  l return normall
-000112c0: 792e 5c6e 5c6e 6060 6070 7974 686f 6e5c  y.\n\n```python\
-000112d0: 6e63 6c69 656e 742e 7265 636f 6e6e 6563  nclient.reconnec
-000112e0: 7428 295c 6e60 6060 5c6e 5c6e 416e 2065  t()\n```\n\nAn e
-000112f0: 7861 6d70 6c65 206f 6620 7768 656e 2069  xample of when i
-00011300: 7420 6d69 6768 7420 6265 2064 6573 6972  t might be desir
-00011310: 6162 6c65 2074 6f20 7265 636f 6e6e 6563  able to reconnec
-00011320: 7420 6d61 6e75 616c 6c79 2069 7320 7768  t manually is wh
-00011330: 656e 2028 666f 7220 7065 7266 6f72 6d61  en (for performa
-00011340: 6e63 655c 6e72 6561 736f 6e73 2920 7468  nce\nreasons) th
-00011350: 6520 636c 6965 6e74 5c27 7320 6e6f 6465  e client\'s node
-00011360: 2070 7265 6665 7265 6e63 6520 6973 2074   preference is t
-00011370: 6f20 6265 2063 6f6e 6e65 6374 6564 2074  o be connected t
-00011380: 6f20 6120 666f 6c6c 6f77 6572 206e 6f64  o a follower nod
-00011390: 6520 696e 2074 6865 5c6e 636c 7573 7465  e in the\ncluste
-000113a0: 722c 2061 6e64 2c20 6166 7465 7220 6120  r, and, after a 
-000113b0: 636c 7573 7465 7220 6c65 6164 6572 2065  cluster leader e
-000113c0: 6c65 6374 696f 6e2c 2074 6865 2066 6f6c  lection, the fol
-000113d0: 6c6f 7765 7220 6265 636f 6d65 7320 7468  lower becomes th
-000113e0: 6520 6c65 6164 6572 2e5c 6e52 6563 6f6e  e leader.\nRecon
-000113f0: 6e65 6374 696e 6720 746f 2061 2066 6f6c  necting to a fol
-00011400: 6c6f 7765 7220 6e6f 6465 2069 6e20 7468  lower node in th
-00011410: 6973 2063 6173 6520 6973 2063 7572 7265  is case is curre
-00011420: 6e74 6c79 2062 6579 6f6e 6420 7468 6520  ntly beyond the 
-00011430: 6361 7061 6269 6c69 7469 6573 206f 665c  capabilities of\
-00011440: 6e74 6869 7320 636c 6965 6e74 2c20 6275  nthis client, bu
-00011450: 7420 7468 6973 2062 6568 6176 696f 7220  t this behavior 
-00011460: 6d69 6768 7420 6265 2069 6d70 6c65 6d65  might be impleme
-00011470: 6e74 6564 2069 6e20 6120 6675 7475 7265  nted in a future
-00011480: 2072 656c 6561 7365 2e5c 6e5c 6e50 6c65   release.\n\nPle
-00011490: 6173 6520 6e6f 7465 2c20 6e65 6172 6c79  ase note, nearly
-000114a0: 2061 6c6c 2074 6865 2063 6c69 656e 7420   all the client 
-000114b0: 6d65 7468 6f64 7320 6172 6520 6465 636f  methods are deco
-000114c0: 7261 7465 6420 7769 7468 2060 4061 7574  rated with `@aut
-000114d0: 6f72 6563 6f6e 6e65 6374 6020 2877 6869  oreconnect` (whi
-000114e0: 6368 5c6e 6361 6c6c 7320 7468 6520 6072  ch\ncalls the `r
-000114f0: 6563 6f6e 6e65 6374 2829 6020 6d65 7468  econnect()` meth
-00011500: 6f64 2077 6865 6e20 7468 6520 636c 6965  od when the clie
-00011510: 6e74 2064 6574 6563 7473 2074 6861 7420  nt detects that 
-00011520: 7265 636f 6e6e 6563 7469 6e67 2069 7320  reconnecting is 
-00011530: 7265 7175 6972 6564 295c 6e61 6e64 2061  required)\nand a
-00011540: 2060 4072 6574 7279 6020 6465 636f 7261   `@retry` decora
-00011550: 746f 7220 7468 6174 206d 6f72 6520 6765  tor that more ge
-00011560: 6e65 7261 6c6c 7920 7769 6c6c 2072 6574  nerally will ret
-00011570: 7279 206f 7065 7261 7469 6f6e 7320 7468  ry operations th
-00011580: 6174 2066 6169 6c20 6475 6520 746f 5c6e  at fail due to\n
-00011590: 636f 6e6e 6563 7469 6f6e 2069 7373 7565  connection issue
-000115a0: 732e 5c6e 5c6e 5468 6520 6040 6175 746f  s.\n\nThe `@auto
-000115b0: 7265 636f 6e6e 6563 7460 2064 6563 6f72  reconnect` decor
-000115c0: 6174 6f72 2077 696c 6c20 7265 636f 6e6e  ator will reconn
-000115d0: 6563 7420 746f 2061 2073 7569 7461 626c  ect to a suitabl
-000115e0: 6520 6e6f 6465 2069 6e20 7468 6520 636c  e node in the cl
-000115f0: 7573 7465 7220 7768 656e 5c6e 7468 6520  uster when\nthe 
-00011600: 7365 7276 6572 2074 6f20 7768 6963 6820  server to which 
-00011610: 7468 6520 636c 6965 6e74 2068 6173 2062  the client has b
-00011620: 6565 6e20 636f 6e6e 6563 7465 6420 6861  een connected ha
-00011630: 7320 6265 636f 6d65 2075 6e61 7661 696c  s become unavail
-00011640: 6162 6c65 2c20 6f72 2077 6865 6e20 7468  able, or when th
-00011650: 655c 6e63 6c69 656e 745c 2773 2067 5250  e\nclient\'s gRP
-00011660: 4320 6368 616e 6e65 6c20 6861 7070 656e  C channel happen
-00011670: 7320 746f 2068 6176 6520 6265 656e 2063  s to have been c
-00011680: 6c6f 7365 642e 2054 6865 2063 6c69 656e  losed. The clien
-00011690: 7420 7769 6c6c 2061 6c73 6f20 7265 636f  t will also reco
-000116a0: 6e6e 6563 7420 7768 656e 5c6e 6120 6d65  nnect when\na me
-000116b0: 7468 6f64 2069 7320 6361 6c6c 6564 2074  thod is called t
-000116c0: 6861 7420 7265 7175 6972 6573 2061 206c  hat requires a l
-000116d0: 6561 6465 722c 2061 6e64 2074 6865 2063  eader, and the c
-000116e0: 6c69 656e 745c 2773 206e 6f64 6520 7072  lient\'s node pr
-000116f0: 6566 6572 656e 6365 2069 7320 746f 2062  eference is to b
-00011700: 655c 6e63 6f6e 6e65 6374 6564 2074 6f20  e\nconnected to 
-00011710: 6120 6c65 6164 6572 2c20 6275 7420 7468  a leader, but th
-00011720: 6520 6e6f 6465 2074 6861 7420 7468 6520  e node that the 
-00011730: 636c 6965 6e74 2068 6173 2062 6565 6e20  client has been 
-00011740: 636f 6e6e 6563 7465 6420 746f 2073 746f  connected to sto
-00011750: 7073 2062 6569 6e67 5c6e 7468 6520 6c65  ps being\nthe le
-00011760: 6164 6572 2e20 496e 2074 6869 7320 6361  ader. In this ca
-00011770: 7365 2c20 7468 6520 636c 6965 6e74 2077  se, the client w
-00011780: 696c 6c20 7265 636f 6e6e 6563 7420 746f  ill reconnect to
-00011790: 2074 6865 2063 7572 7265 6e74 206c 6561   the current lea
-000117a0: 6465 722e 2041 6674 6572 5c6e 7265 636f  der. After\nreco
-000117b0: 6e6e 6563 7469 6e67 2c20 7468 6520 6661  nnecting, the fa
-000117c0: 696c 6564 206f 7065 7261 7469 6f6e 2077  iled operation w
-000117d0: 696c 6c20 6265 2072 6574 7269 6564 2e5c  ill be retried.\
-000117e0: 6e5c 6e54 6865 2060 4072 6574 7279 6020  n\nThe `@retry` 
-000117f0: 6465 636f 7261 746f 7220 7265 7472 6965  decorator retrie
-00011800: 7320 6f70 6572 6174 696f 6e73 2074 6861  s operations tha
-00011810: 7420 6861 7665 2066 6169 6c65 6420 6475  t have failed du
-00011820: 6520 746f 206d 6f72 6520 6765 6e65 7261  e to more genera
-00011830: 6c5c 6e63 6f6e 6e65 6374 696f 6e20 6973  l\nconnection is
-00011840: 7375 6573 2c20 7375 6368 2061 7320 6120  sues, such as a 
-00011850: 6465 6164 6c69 6e65 2062 6569 6e67 2072  deadline being r
-00011860: 6561 6368 6564 2028 736f 2074 6861 7420  eached (so that 
-00011870: 7468 6520 6f70 6572 6174 696f 6e20 7469  the operation ti
-00011880: 6d65 735c 6e6f 7574 292c 206f 7220 696e  mes\nout), or in
-00011890: 2063 6173 6520 7468 6520 7365 7276 6572   case the server
-000118a0: 2074 6872 6f77 7320 616e 2065 7863 6570   throws an excep
-000118b0: 7469 6f6e 2077 6865 6e20 6861 6e64 6c69  tion when handli
-000118c0: 6e67 2061 2063 6c69 656e 7420 7265 7175  ng a client requ
-000118d0: 6573 742e 5c6e 5c6e 506c 6561 7365 2061  est.\n\nPlease a
-000118e0: 6c73 6f20 6e6f 7465 2c20 7468 6520 6173  lso note, the as
-000118f0: 7065 6374 7320 6e6f 7420 636f 7665 7265  pects not covere
-00011900: 6420 6279 2074 6865 2072 6563 6f6e 6e65  d by the reconne
-00011910: 6374 2061 6e64 2072 6574 7279 2064 6563  ct and retry dec
-00011920: 6f72 6174 6f72 5c6e 6265 6861 7669 6f75  orator\nbehaviou
-00011930: 7273 2068 6176 6520 746f 2064 6f20 7769  rs have to do wi
-00011940: 7468 206d 6574 686f 6473 2074 6861 7420  th methods that 
-00011950: 7265 7475 726e 2069 7465 7261 746f 7273  return iterators
-00011960: 2e20 466f 7220 6578 616d 706c 652c 2063  . For example, c
-00011970: 6f6e 7369 6465 725c 6e74 6865 2060 7265  onsider\nthe `re
-00011980: 6164 5f61 6c6c 5f65 7665 6e74 7328 2960  ad_all_events()`
-00011990: 206d 6574 686f 642c 2077 6869 6368 2072   method, which r
-000119a0: 6574 7572 6e73 2061 6e20 6974 6572 6174  eturns an iterat
-000119b0: 6f72 206f 6620 6052 6563 6f72 6465 6445  or of `RecordedE
-000119c0: 7665 6e74 6020 6f62 6a65 6374 732e 5c6e  vent` objects.\n
-000119d0: 5468 6520 6d65 7468 6f64 2068 6173 2072  The method has r
-000119e0: 6574 7572 6e65 6420 616e 6420 7468 6520  eturned and the 
-000119f0: 6d65 7468 6f64 2064 6563 6f72 6174 6f72  method decorator
-00011a00: 7320 6861 7665 2074 6865 7265 666f 7265  s have therefore
-00011a10: 2065 7869 7465 6420 6265 666f 7265 2074   exited before t
-00011a20: 6865 5c6e 6974 6572 6174 696e 6720 6f66  he\niterating of
-00011a30: 2074 6865 2072 6573 706f 6e73 6520 6265   the response be
-00011a40: 6769 6e73 2e20 5468 6572 6566 6f72 652c  gins. Therefore,
-00011a50: 2069 7420 6973 6e5c 2774 2070 6f73 7369   it isn\'t possi
-00011a60: 626c 6520 666f 7220 7468 6973 206d 6574  ble for this met
-00011a70: 686f 6420 746f 5c6e 7472 6967 6765 7220  hod to\ntrigger 
-00011a80: 6120 7265 636f 6e6e 6563 7469 6f6e 206f  a reconnection o
-00011a90: 7220 666f 7220 6974 2074 6f20 7265 7472  r for it to retr
-00011aa0: 792c 2077 6865 6e20 7468 6520 7374 7265  y, when the stre
-00011ab0: 616d 696e 6720 7265 7370 6f6e 7365 2073  aming response s
-00011ac0: 6f6d 6568 6f77 2066 6169 6c73 2e5c 6e5c  omehow fails.\n\
-00011ad0: 6e41 6e6f 7468 6572 2065 7861 6d70 6c65  nAnother example
-00011ae0: 2069 7320 7468 6520 2263 6174 6368 2d75   is the "catch-u
-00011af0: 7022 2061 6e64 2070 6572 7369 7374 656e  p" and persisten
-00011b00: 7420 7375 6273 6372 6970 7469 6f6e 2072  t subscription r
-00011b10: 6561 6420 6d65 7468 6f64 732c 2061 6c74  ead methods, alt
-00011b20: 686f 7567 685c 6e77 6974 6820 7468 6573  hough\nwith thes
-00011b30: 6520 6d65 7468 6f64 7320 7468 6572 6520  e methods there 
-00011b40: 6973 2061 6e20 696e 6974 6961 6c20 2263  is an initial "c
-00011b50: 6f6e 6669 726d 6174 696f 6e22 2072 6573  onfirmation" res
-00011b60: 706f 6e73 6520 6672 6f6d 2074 6865 2073  ponse from the s
-00011b70: 6572 7665 7220 7768 6963 685c 6e69 7320  erver which\nis 
-00011b80: 7265 6365 6976 6564 2061 6e64 2063 6865  received and che
-00011b90: 636b 6564 2062 7920 7468 6520 636c 6965  cked by the clie
-00011ba0: 6e74 2062 6566 6f72 6520 7468 6520 6d65  nt before the me
-00011bb0: 7468 6f64 2072 6574 7572 6e73 2c20 736f  thod returns, so
-00011bc0: 2069 6620 7468 6520 7365 7276 6572 2069   if the server i
-00011bd0: 735c 6e75 6e61 7661 696c 6162 6c65 2077  s\nunavailable w
-00011be0: 6865 6e20 7468 6520 6361 6c6c 2069 7320  hen the call is 
-00011bf0: 6d61 6465 2c20 6f72 2069 6620 7468 6520  made, or if the 
-00011c00: 6368 616e 6e65 6c20 6973 2073 6f6d 6568  channel is someh
-00011c10: 6f77 2063 6c6f 7365 642c 206f 7220 6966  ow closed, or if
-00011c20: 2074 6865 5c6e 7365 7276 6572 2074 6872   the\nserver thr
-00011c30: 6f77 7320 616e 2065 7272 6f72 2066 6f72  ows an error for
-00011c40: 2073 6f6d 6520 7265 6173 6f6e 2c20 7468   some reason, th
-00011c50: 656e 2074 6865 2063 6c69 656e 7420 7769  en the client wi
-00011c60: 6c6c 2065 6974 6865 7220 7265 636f 6e6e  ll either reconn
-00011c70: 6563 7420 616e 645c 6e72 6574 7279 2c20  ect and\nretry, 
-00011c80: 6f72 206d 6f72 6520 7369 6d70 6c79 206a  or more simply j
-00011c90: 7573 7420 7265 7472 7920 7468 6520 6f70  ust retry the op
-00011ca0: 6572 6174 696f 6e2c 2061 6363 6f72 6469  eration, accordi
-00011cb0: 6e67 2074 6865 2074 7970 6520 6f66 2065  ng the type of e
-00011cc0: 7272 6f72 2074 6861 745c 6e77 6173 2065  rror that\nwas e
-00011cd0: 6e63 6f75 6e74 6572 6564 2e20 486f 7765  ncountered. Howe
-00011ce0: 7665 722c 2061 6e20 6576 656e 742d 7072  ver, an event-pr
-00011cf0: 6f63 6573 7369 6e67 2063 6f6d 706f 6e65  ocessing compone
-00011d00: 6e74 2074 6861 7420 6974 6572 6174 6573  nt that iterates
-00011d10: 206f 7665 7220 615c 6e73 7563 6365 7373   over a\nsuccess
-00011d20: 6675 6c6c 7920 7265 7475 726e 6564 2022  fully returned "
-00011d30: 6361 7463 682d 7570 2220 7375 6273 6372  catch-up" subscr
-00011d40: 6970 7469 6f6e 2072 6573 706f 6e73 6520  iption response 
-00011d50: 7769 6c6c 206e 6565 6420 746f 2062 6520  will need to be 
-00011d60: 6d6f 6e69 746f 7265 6420 666f 725c 6e65  monitored for\ne
-00011d70: 7272 6f72 732c 2061 6e64 2c20 6966 2069  rrors, and, if i
-00011d80: 7420 6661 696c 7320 6166 7465 7220 6974  t fails after it
-00011d90: 2068 6173 2073 7461 7274 6564 2069 7465   has started ite
-00011da0: 7261 7469 6e67 206f 7665 7220 7468 6520  rating over the 
-00011db0: 7265 7370 6f6e 7365 2c20 7468 6520 6361  response, the ca
-00011dc0: 7463 682d 7570 5c6e 7375 6273 6372 6970  tch-up\nsubscrip
-00011dd0: 7469 6f6e 2077 696c 6c20 6e65 6564 2074  tion will need t
-00011de0: 6f20 6265 2072 6573 7461 7274 6564 2066  o be restarted f
-00011df0: 726f 6d20 7468 6520 6576 656e 742d 7072  rom the event-pr
-00011e00: 6f63 6573 7369 6e67 2063 6f6d 706f 6e65  ocessing compone
-00011e10: 6e74 5c27 7320 226c 6173 745c 6e73 6176  nt\'s "last\nsav
-00011e20: 6564 2063 6f6d 6d69 7420 706f 7369 7469  ed commit positi
-00011e30: 6f6e 222e 2049 6620 7468 6520 6576 656e  on". If the even
-00011e40: 742d 7072 6f63 6573 7369 6e67 2063 6f6d  t-processing com
-00011e50: 706f 6e65 6e74 2069 7320 7265 636f 7264  ponent is record
-00011e60: 696e 6720 7468 6520 636f 6d6d 6974 5c6e  ing the commit\n
-00011e70: 706f 7369 7469 6f6e 206f 6620 6561 6368  position of each
-00011e80: 2072 6563 6f72 6465 6420 6576 656e 7420   recorded event 
-00011e90: 6174 6f6d 6963 616c 6c79 2061 6c6f 6e67  atomically along
-00011ea0: 2077 6974 6820 616e 7920 6e65 7720 7374   with any new st
-00011eb0: 6174 6520 7468 6174 2072 6573 756c 7473  ate that results
-00011ec0: 2066 726f 6d5c 6e70 726f 6365 7373 696e   from\nprocessin
-00011ed0: 6720 7468 6520 7265 636f 7264 6564 2065  g the recorded e
-00011ee0: 7665 6e74 732c 2061 6e64 2074 6865 2063  vents, and the c
-00011ef0: 6f6d 6d69 7420 706f 7369 7469 6f6e 7320  ommit positions 
-00011f00: 6172 6520 7265 636f 7264 6564 2077 6974  are recorded wit
-00011f10: 6820 6120 756e 6971 7565 6e65 7373 5c6e  h a uniqueness\n
-00011f20: 636f 6e73 7472 6169 6e74 2c20 7468 656e  constraint, then
-00011f30: 2074 6865 7265 2077 696c 6c20 6e6f 2064   there will no d
-00011f40: 616e 6765 7220 746f 2074 6865 2070 726f  anger to the pro
-00011f50: 6a65 6374 6564 2073 7461 7465 2062 6563  jected state bec
-00011f60: 6f6d 696e 6720 696e 636f 6e73 6973 7465  oming inconsiste
-00011f70: 6e74 2064 7565 5c6e 746f 2074 6865 7365  nt due\nto these
-00011f80: 2063 6f6e 6e65 6374 696f 6e20 6973 7375   connection issu
-00011f90: 6573 2e20 496e 2074 6869 7320 6361 7365  es. In this case
-00011fa0: 2c20 7468 6520 636c 6965 6e74 2077 696c  , the client wil
-00011fb0: 6c20 6175 746f 6d61 7469 6361 6c6c 7920  l automatically 
-00011fc0: 7265 636f 6e6e 6563 7420 746f 2061 5c6e  reconnect to a\n
-00011fd0: 6e6f 6465 2069 6e20 7468 6520 636c 7573  node in the clus
-00011fe0: 7465 7220 7768 656e 2074 6865 2073 7562  ter when the sub
-00011ff0: 7365 7175 656e 7420 6361 6c6c 2074 6f20  sequent call to 
-00012000: 6120 6361 7463 682d 7570 2073 7562 7363  a catch-up subsc
-00012010: 7269 7074 696f 6e20 6d65 7468 6f64 2069  ription method i
-00012020: 7320 6d61 6465 2e5c 6e59 6f75 206a 7573  s made.\nYou jus
-00012030: 7420 6e65 6564 2074 6f20 6861 6e64 6c65  t need to handle
-00012040: 2074 6865 2065 7863 6570 7469 6f6e 2074   the exception t
-00012050: 6861 7420 6f63 6375 7273 2066 726f 6d20  hat occurs from 
-00012060: 7468 6520 6974 6572 6174 6f72 2c20 7468  the iterator, th
-00012070: 656e 2072 6561 6420 796f 7572 206c 6173  en read your las
-00012080: 745c 6e73 6176 6564 2063 6f6d 6d69 7420  t\nsaved commit 
-00012090: 706f 7369 7469 6f6e 2c20 616e 6420 7468  position, and th
-000120a0: 656e 2072 6573 7461 7274 2079 6f75 7220  en restart your 
-000120b0: 6576 656e 742d 7072 6f63 6573 7369 6e67  event-processing
-000120c0: 2063 6f6d 706f 6e65 6e74 2c20 7573 696e   component, usin
-000120d0: 6720 7468 6520 7361 6d65 5c6e 636c 6965  g the same\nclie
-000120e0: 6e74 206f 626a 6563 742e 2054 6865 2063  nt object. The c
-000120f0: 6c69 656e 7420 7769 6c6c 2072 6563 6f6e  lient will recon
-00012100: 6e65 6374 2069 6620 7468 6572 6520 6973  nect if there is
-00012110: 2061 206e 6565 6420 746f 2064 6f20 736f   a need to do so
-00012120: 2077 6865 6e20 7468 6520 7375 6273 6571   when the subseq
-00012130: 7565 6e74 5c6e 6361 6c6c 2069 7320 6d61  uent\ncall is ma
-00012140: 6465 2e20 5369 6d69 6c61 726c 792c 2077  de. Similarly, w
-00012150: 6865 6e20 7265 6164 696e 6720 7065 7273  hen reading pers
-00012160: 6973 7465 6e74 2073 7562 7363 7269 7074  istent subscript
-00012170: 696f 6e73 2c20 6966 2074 6865 7265 2061  ions, if there a
-00012180: 7265 5c6e 636f 6e6e 6563 7469 7669 7479  re\nconnectivity
-00012190: 2069 7373 7565 7320 6166 7465 7220 796f   issues after yo
-000121a0: 7520 6861 7665 2073 7461 7274 6564 2069  u have started i
-000121b0: 7465 7261 7469 6e67 206f 7665 7220 6120  terating over a 
-000121c0: 7375 6363 6573 7366 756c 6c79 2072 6563  successfully rec
-000121d0: 6569 7665 645c 6e72 6573 706f 6e73 652c  eived\nresponse,
-000121e0: 2074 6865 6e20 7468 6520 7365 7276 6572   then the server
-000121f0: 2063 616c 6c20 7769 6c6c 206e 6565 6420   call will need 
-00012200: 746f 2062 6520 7265 7374 6172 7465 642e  to be restarted.
-00012210: 2049 6e20 7468 6973 2063 6173 652c 2074   In this case, t
-00012220: 6865 2072 6563 6569 7665 645c 6e65 7665  he received\neve
-00012230: 6e74 7320 7769 6c6c 2073 7461 7274 2077  nts will start w
-00012240: 6974 6820 7468 6520 6c61 7374 2073 6176  ith the last sav
-00012250: 6564 2063 6865 636b 706f 696e 7420 6f6e  ed checkpoint on
-00012260: 2074 6865 2073 6572 7665 7220 2870 6f74   the server (pot
-00012270: 656e 7469 616c 6c79 2072 6574 7572 6e69  entially returni
-00012280: 6e67 5c6e 6576 656e 7473 2074 6861 7420  ng\nevents that 
-00012290: 7765 7265 2069 6e20 6661 6374 2073 7563  were in fact suc
-000122a0: 6365 7373 6675 6c6c 7920 7072 6f63 6573  cessfully proces
-000122b0: 7365 6429 2e5c 6e5c 6e5c 6e23 2323 2043  sed).\n\n\n### C
-000122c0: 6c6f 7365 5c6e 5c6e 5468 6520 6063 6c6f  lose\n\nThe `clo
-000122d0: 7365 2829 6020 6d65 7468 6f64 2063 616e  se()` method can
-000122e0: 2062 6520 7573 6564 2074 6f20 636c 6561   be used to clea
-000122f0: 6e6c 7920 636c 6f73 6520 7468 6520 6752  nly close the gR
-00012300: 5043 2063 6f6e 6e65 6374 696f 6e2e 5c6e  PC connection.\n
-00012310: 5c6e 6060 6070 7974 686f 6e5c 6e63 6c69  \n```python\ncli
-00012320: 656e 742e 636c 6f73 6528 295c 6e60 6060  ent.close()\n```
-00012330: 5c6e 5c6e 2323 204e 6f74 6573 5c6e 5c6e  \n\n## Notes\n\n
-00012340: 2323 2320 436f 6e6e 6563 7469 6f6e 2073  ### Connection s
-00012350: 7472 696e 6773 5c6e 5c6e 5468 6520 4576  trings\n\nThe Ev
-00012360: 656e 7453 746f 7265 4442 2063 6f6e 6e65  entStoreDB conne
-00012370: 6374 696f 6e20 7374 7269 6e67 2069 7320  ction string is 
-00012380: 6120 5552 4920 7468 6174 2063 6f6e 666f  a URI that confo
-00012390: 726d 7320 7769 7468 206f 6e65 206f 6620  rms with one of 
-000123a0: 7477 6f20 706f 7373 6962 6c65 5c6e 7363  two possible\nsc
-000123b0: 6865 6d65 732c 2065 6974 6865 7220 7468  hemes, either th
-000123c0: 6520 2265 7364 6222 2073 6368 656d 6520  e "esdb" scheme 
-000123d0: 6f72 2074 6865 2022 6573 6462 2b64 6973  or the "esdb+dis
-000123e0: 636f 7665 7222 2073 6368 656d 652e 2054  cover" scheme. T
-000123f0: 6865 2073 796e 7461 7820 616e 645c 6e73  he syntax and\ns
-00012400: 656d 616e 7469 6373 206f 6620 7468 6520  emantics of the 
-00012410: 4576 656e 7453 746f 7265 4442 2055 5249  EventStoreDB URI
-00012420: 2073 6368 656d 6573 2061 7265 2065 7870   schemes are exp
-00012430: 6c61 696e 6564 2062 656c 6f77 2e20 5468  lained below. Th
-00012440: 6520 7379 6e74 6178 2069 735c 6e64 6566  e syntax is\ndef
-00012450: 696e 6564 2075 7369 6e67 205b 4542 4e46  ined using [EBNF
-00012460: 5d28 6874 7470 733a 2f2f 656e 2e77 696b  ](https://en.wik
-00012470: 6970 6564 6961 2e6f 7267 2f77 696b 692f  ipedia.org/wiki/
-00012480: 4578 7465 6e64 6564 5f42 6163 6b75 73e2  Extended_Backus.
-00012490: 8093 4e61 7572 5f66 6f72 6d29 2e5c 6e5c  ..Naur_form).\n\
-000124a0: 6e54 6865 2022 6573 6462 2220 5552 4920  nThe "esdb" URI 
-000124b0: 7363 6865 6d65 2063 616e 2062 6520 6465  scheme can be de
-000124c0: 6669 6e65 6420 696e 2074 6865 2066 6f6c  fined in the fol
-000124d0: 6c6f 7769 6e67 2077 6179 2e5c 6e5c 6e20  lowing way.\n\n 
-000124e0: 2020 2065 7364 622d 7572 6920 3d20 2265     esdb-uri = "e
-000124f0: 7364 623a 2f2f 2220 2c20 5b20 7573 6572  sdb://" , [ user
-00012500: 2d69 6e66 6f20 2c20 2240 2220 5d20 2c20  -info , "@" ] , 
-00012510: 6772 7063 2d74 6172 6765 742c 207b 2022  grpc-target, { "
-00012520: 2c22 202c 2067 7270 632d 7461 7267 6574  ," , grpc-target
-00012530: 207d 202c 205b 2022 3f22 202c 2071 7565   } , [ "?" , que
-00012540: 7279 2d73 7472 696e 6720 5d20 3b5c 6e5c  ry-string ] ;\n\
-00012550: 6e49 6e20 7468 6520 2265 7364 6222 2055  nIn the "esdb" U
-00012560: 5249 2073 6368 656d 652c 2061 6674 6572  RI scheme, after
-00012570: 2074 6865 206f 7074 696f 6e61 6c20 7573   the optional us
-00012580: 6572 2069 6e66 6f20 7374 7269 6e67 2c20  er info string, 
-00012590: 7468 6572 6520 6d75 7374 2062 6520 6174  there must be at
-000125a0: 206c 6561 7374 5c6e 6f6e 6520 6752 5043   least\none gRPC
-000125b0: 2074 6172 6765 742e 2049 6620 7468 6572   target. If ther
-000125c0: 6520 6172 6520 7365 7665 7261 6c20 6752  e are several gR
-000125d0: 5043 2074 6172 6765 7473 2c20 7468 6579  PC targets, they
-000125e0: 206d 7573 7420 6265 2073 6570 6172 6174   must be separat
-000125f0: 6564 2066 726f 6d20 6561 6368 5c6e 6f74  ed from each\not
-00012600: 6865 7220 7769 7468 2074 6865 2022 2c22  her with the ","
-00012610: 2063 6861 7261 6374 6572 2e20 4561 6368   character. Each
-00012620: 2067 5250 4320 7461 7267 6574 2073 686f   gRPC target sho
-00012630: 756c 6420 696e 6469 6361 7465 2061 6e20  uld indicate an 
-00012640: 4576 656e 7453 746f 7265 4442 2067 5250  EventStoreDB gRP
-00012650: 435c 6e73 6572 7665 7220 736f 636b 6574  C\nserver socket
-00012660: 2c20 6279 2073 7065 6369 6679 696e 6720  , by specifying 
-00012670: 6120 686f 7374 2061 6e64 2061 2070 6f72  a host and a por
-00012680: 7420 6e75 6d62 6572 2073 6570 6172 6174  t number separat
-00012690: 6564 2077 6974 6820 7468 6520 223a 2220  ed with the ":" 
-000126a0: 6368 6172 6163 7465 722e 5c6e 5468 6520  character.\nThe 
-000126b0: 686f 7374 206d 6179 2062 6520 6120 686f  host may be a ho
-000126c0: 7374 6e61 6d65 2074 6861 7420 6361 6e20  stname that can 
-000126d0: 6265 2072 6573 6f6c 7665 6420 746f 2061  be resolved to a
-000126e0: 6e20 4950 2061 6464 7265 7373 2c20 6f72  n IP address, or
-000126f0: 2061 6e20 4950 2061 6464 7265 7373 2e5c   an IP address.\
-00012700: 6e5c 6e20 2020 2067 7270 632d 7461 7267  n\n    grpc-targ
-00012710: 6574 203d 2028 2068 6f73 746e 616d 6520  et = ( hostname 
-00012720: 7c20 6970 2d61 6464 7265 7373 2029 202c  | ip-address ) ,
-00012730: 2022 3a22 202c 2070 6f72 742d 6e75 6d62   ":" , port-numb
-00012740: 6572 203b 5c6e 5c6e 5c6e 5468 6520 2265  er ;\n\n\nThe "e
-00012750: 7364 622b 6469 7363 6f76 6572 2220 5552  sdb+discover" UR
-00012760: 4920 7363 6865 6d65 2063 616e 2062 6520  I scheme can be 
-00012770: 6465 6669 6e65 6420 696e 2074 6865 2066  defined in the f
-00012780: 6f6c 6c6f 7769 6e67 2077 6179 2e5c 6e5c  ollowing way.\n\
-00012790: 6e20 2020 2065 7364 622d 6469 7363 6f76  n    esdb-discov
-000127a0: 6572 2d75 7269 203d 2022 6573 6462 2b64  er-uri = "esdb+d
-000127b0: 6973 636f 7665 723a 2f2f 2220 2c20 5b20  iscover://" , [ 
-000127c0: 7573 6572 2d69 6e66 6f2c 2022 4022 205d  user-info, "@" ]
-000127d0: 202c 2063 6c75 7374 6572 2d64 6f6d 6169   , cluster-domai
-000127e0: 6e6e 616d 6520 2c20 5b20 223f 2220 2c20  nname , [ "?" , 
-000127f0: 7175 6572 792d 7374 7269 6e67 205d 203b  query-string ] ;
-00012800: 5c6e 5c6e 496e 2074 6865 2022 6573 6462  \n\nIn the "esdb
-00012810: 2b64 6973 636f 7665 7222 2055 5249 2073  +discover" URI s
-00012820: 6368 656d 652c 2061 6674 6572 2074 6865  cheme, after the
-00012830: 2075 7365 7220 696e 666f 2073 7472 696e   user info strin
-00012840: 672c 2074 6865 7265 206d 7573 7420 6265  g, there must be
-00012850: 2061 2064 6f6d 6169 6e5c 6e6e 616d 6520   a domain\nname 
-00012860: 7768 6963 6820 7368 6f75 6c64 2069 6465  which should ide
-00012870: 6e74 6966 7920 6120 636c 7573 7465 7220  ntify a cluster 
-00012880: 6f66 2045 7665 6e74 5374 6f72 6544 4220  of EventStoreDB 
-00012890: 7365 7276 6572 732e 2054 6865 2063 6c69  servers. The cli
-000128a0: 656e 7420 7769 6c6c 2075 7365 2061 2044  ent will use a D
-000128b0: 4e53 5c6e 7365 7276 6572 2074 6f20 7265  NS\nserver to re
-000128c0: 736f 6c76 6520 7468 6520 646f 6d61 696e  solve the domain
-000128d0: 206e 616d 6520 746f 2061 206c 6973 7420   name to a list 
-000128e0: 6f66 2061 6464 7265 7373 6573 206f 6620  of addresses of 
-000128f0: 4576 656e 7453 746f 7265 4442 2073 6572  EventStoreDB ser
-00012900: 7665 7273 2c5c 6e62 7920 7175 6572 7969  vers,\nby queryi
-00012910: 6e67 2066 6f72 205c 2741 5c27 2072 6563  ng for \'A\' rec
-00012920: 6f72 6473 2e20 496e 2074 6869 7320 6361  ords. In this ca
-00012930: 7365 2c20 7468 6520 706f 7274 206e 756d  se, the port num
-00012940: 6265 7220 2232 3131 3322 2077 696c 6c20  ber "2113" will 
-00012950: 6265 2075 7365 6420 746f 5c6e 636f 6e73  be used to\ncons
-00012960: 7472 7563 7420 6752 5043 2074 6172 6765  truct gRPC targe
-00012970: 7473 2066 726f 6d20 7468 6520 6164 6472  ts from the addr
-00012980: 6573 7365 7320 6f62 7461 696e 6564 2066  esses obtained f
-00012990: 726f 6d20 5c27 415c 2720 7265 636f 7264  rom \'A\' record
-000129a0: 7320 7072 6f76 6964 6564 2062 7920 7468  s provided by th
-000129b0: 655c 6e44 4e53 2073 6572 7665 722e 2054  e\nDNS server. T
-000129c0: 6865 7265 666f 7265 2c20 6966 2079 6f75  herefore, if you
-000129d0: 2077 616e 7420 746f 2075 7365 2074 6865   want to use the
-000129e0: 2022 6573 6462 2b64 6973 636f 7665 7222   "esdb+discover"
-000129f0: 2055 5249 2073 6368 656d 652c 2079 6f75   URI scheme, you
-00012a00: 2077 696c 6c5c 6e6e 6565 6420 746f 2063   will\nneed to c
-00012a10: 6f6e 6669 6775 7265 2044 4e53 2077 6865  onfigure DNS whe
-00012a20: 6e20 7365 7474 696e 6720 7570 2079 6f75  n setting up you
-00012a30: 7220 4576 656e 7453 746f 7265 4442 2063  r EventStoreDB c
-00012a40: 6c75 7374 6572 2e5c 6e5c 6e57 6974 6820  luster.\n\nWith 
-00012a50: 626f 7468 2074 6865 2022 6573 6462 2220  both the "esdb" 
-00012a60: 616e 6420 2265 7364 622b 6469 736f 6376  and "esdb+disocv
-00012a70: 6572 2220 5552 4920 7363 6865 6d65 732c  er" URI schemes,
-00012a80: 2074 6865 2063 6c69 656e 7420 6669 7273   the client firs
-00012a90: 746c 7920 6f62 7461 696e 735c 6e61 206c  tly obtains\na l
-00012aa0: 6973 7420 6f66 2067 5250 4320 7461 7267  ist of gRPC targ
-00012ab0: 6574 733a 2065 6974 6865 7220 6469 7265  ets: either dire
-00012ac0: 6374 6c79 2066 726f 6d20 2265 7364 6222  ctly from "esdb"
-00012ad0: 2063 6f6e 6e65 6374 696f 6e20 7374 7269   connection stri
-00012ae0: 6e67 733b 206f 7220 696e 6469 7265 6374  ngs; or indirect
-00012af0: 6c79 5c6e 6672 6f6d 2022 6573 6462 2b64  ly\nfrom "esdb+d
-00012b00: 6973 636f 7665 7222 2063 6f6e 6e65 6374  iscover" connect
-00012b10: 696f 6e20 7374 7269 6e67 7320 7669 6120  ion strings via 
-00012b20: 444e 532e 2054 6869 7320 6c69 7374 206f  DNS. This list o
-00012b30: 6620 7461 7267 6574 7320 6973 206b 6e6f  f targets is kno
-00012b40: 776e 2061 7320 7468 655c 6e22 676f 7373  wn as the\n"goss
-00012b50: 6970 2073 6565 6422 2e20 5468 6520 636c  ip seed". The cl
-00012b60: 6965 6e74 2077 696c 6c20 7468 656e 2061  ient will then a
-00012b70: 7474 656d 7074 2074 6f20 636f 6e6e 6563  ttempt to connec
-00012b80: 7420 746f 2065 6163 6820 6752 5043 2074  t to each gRPC t
-00012b90: 6172 6765 7420 696e 2074 7572 6e2c 5c6e  arget in turn,\n
-00012ba0: 6174 7465 6d70 7469 6e67 2074 6f20 6361  attempting to ca
-00012bb0: 6c6c 2074 6865 2045 7665 6e74 5374 6f72  ll the EventStor
-00012bc0: 6544 4220 476f 7373 6970 2041 5049 2074  eDB Gossip API t
-00012bd0: 6f20 6f62 7461 696e 2069 6e66 6f72 6d61  o obtain informa
-00012be0: 7469 6f6e 2061 626f 7574 2074 6865 5c6e  tion about the\n
-00012bf0: 4576 656e 7453 746f 7265 4442 2063 6c75  EventStoreDB clu
-00012c00: 7374 6572 2e20 4120 6d65 6d62 6572 206f  ster. A member o
-00012c10: 6620 7468 6520 636c 7573 7465 7220 6973  f the cluster is
-00012c20: 2073 656c 6563 7465 6420 6279 2074 6865   selected by the
-00012c30: 2063 6c69 656e 742c 2061 6363 6f72 6469   client, accordi
-00012c40: 6e67 5c6e 746f 2074 6865 2022 6e6f 6465  ng\nto the "node
-00012c50: 2070 7265 6665 7265 6e63 6522 206f 7074   preference" opt
-00012c60: 696f 6e20 2873 6565 2062 656c 6f77 292e  ion (see below).
-00012c70: 2054 6865 2063 6c69 656e 7420 6d61 7920   The client may 
-00012c80: 7468 656e 206e 6565 6420 746f 2063 6c6f  then need to clo
-00012c90: 7365 2069 7473 5c6e 636f 6e6e 6563 7469  se its\nconnecti
-00012ca0: 6f6e 2061 6e64 2072 6563 6f6e 6e65 6374  on and reconnect
-00012cb0: 2074 6f20 7468 6520 7365 6c65 6374 6564   to the selected
-00012cc0: 2073 6572 7665 722e 5c6e 5c6e 496e 2062   server.\n\nIn b
-00012cd0: 6f74 6820 7468 6520 2265 7364 6222 2061  oth the "esdb" a
-00012ce0: 6e64 2022 6573 6462 2b64 6973 636f 7665  nd "esdb+discove
-00012cf0: 7222 2073 6368 656d 6573 2c20 7468 6520  r" schemes, the 
-00012d00: 5552 4920 6d61 7920 696e 636c 7564 6520  URI may include 
-00012d10: 6120 7573 6572 2069 6e66 6f20 7374 7269  a user info stri
-00012d20: 6e67 2e5c 6e49 6620 6974 2065 7869 7374  ng.\nIf it exist
-00012d30: 7320 696e 2074 6865 2055 5249 2c20 7468  s in the URI, th
-00012d40: 6520 7573 6572 2069 6e66 6f20 7374 7269  e user info stri
-00012d50: 6e67 206d 7573 7420 6265 2073 6570 6172  ng must be separ
-00012d60: 6174 6564 2066 726f 6d20 7468 6520 7265  ated from the re
-00012d70: 7374 206f 6620 7468 6520 5552 495c 6e77  st of the URI\nw
-00012d80: 6974 6820 7468 6520 2240 2220 6368 6172  ith the "@" char
-00012d90: 6163 7465 722e 2054 6865 2075 7365 7220  acter. The user 
-00012da0: 696e 666f 2073 7472 696e 6720 6d75 7374  info string must
-00012db0: 2069 6e63 6c75 6465 2061 2075 7365 726e   include a usern
-00012dc0: 616d 6520 616e 6420 6120 7061 7373 776f  ame and a passwo
-00012dd0: 7264 2c5c 6e73 6570 6172 6174 6564 2077  rd,\nseparated w
-00012de0: 6974 6820 7468 6520 223a 2220 6368 6172  ith the ":" char
-00012df0: 6163 7465 722e 5c6e 5c6e 2020 2020 7573  acter.\n\n    us
-00012e00: 6572 2d69 6e66 6f20 3d20 7573 6572 6e61  er-info = userna
-00012e10: 6d65 202c 2022 3a22 202c 2070 6173 7377  me , ":" , passw
-00012e20: 6f72 6420 3b5c 6e5c 6e54 6865 2075 7365  ord ;\n\nThe use
-00012e30: 7220 696e 666f 2069 7320 7365 6e74 2062  r info is sent b
-00012e40: 7920 7468 6520 636c 6965 6e74 2061 7320  y the client as 
-00012e50: 2263 616c 6c20 6372 6564 656e 7469 616c  "call credential
-00012e60: 7322 2069 6e20 6561 6368 2063 616c 6c20  s" in each call 
-00012e70: 746f 2061 2022 7365 6375 7265 225c 6e73  to a "secure"\ns
-00012e80: 6572 7665 722c 2069 6e20 6120 2262 6173  erver, in a "bas
-00012e90: 6963 2061 7574 6822 2061 7574 686f 7269  ic auth" authori
-00012ea0: 7a61 7469 6f6e 2068 6561 6465 722e 2054  zation header. T
-00012eb0: 6869 7320 6175 7468 6f72 697a 6174 696f  his authorizatio
-00012ec0: 6e20 6865 6164 6572 2069 7320 7573 6564  n header is used
-00012ed0: 2062 795c 6e74 6865 2073 6572 7665 7220   by\nthe server 
-00012ee0: 746f 2061 7574 6865 6e74 6963 6174 6520  to authenticate 
-00012ef0: 7468 6520 636c 6965 6e74 2e20 5468 6520  the client. The 
-00012f00: 6175 7468 6f72 697a 6174 696f 6e20 6865  authorization he
-00012f10: 6164 6572 2069 7320 6e6f 7420 7365 6e74  ader is not sent
-00012f20: 2074 6f5c 6e22 696e 7365 6375 7265 2220   to\n"insecure" 
-00012f30: 7365 7276 6572 732e 5c6e 5c6e 496e 2062  servers.\n\nIn b
-00012f40: 6f74 6820 7468 6520 2265 7364 6222 2061  oth the "esdb" a
-00012f50: 6e64 2022 6573 6462 2b64 6973 636f 7665  nd "esdb+discove
-00012f60: 7222 2073 6368 656d 6573 2c20 7468 6520  r" schemes, the 
-00012f70: 6f70 7469 6f6e 616c 2071 7565 7279 2073  optional query s
-00012f80: 7472 696e 6720 6d75 7374 2062 6520 6f6e  tring must be on
-00012f90: 655c 6e6f 7220 6d61 6e79 2066 6965 6c64  e\nor many field
-00012fa0: 2d76 616c 7565 2061 7267 756d 656e 7473  -value arguments
-00012fb0: 2c20 7365 7061 7261 7465 6420 6672 6f6d  , separated from
-00012fc0: 2065 6163 6820 6f74 6865 7220 7769 7468   each other with
-00012fd0: 2074 6865 2022 2622 2063 6861 7261 6374   the "&" charact
-00012fe0: 6572 2e5c 6e5c 6e20 2020 2071 7565 7279  er.\n\n    query
-00012ff0: 2d73 7472 696e 6720 3d20 6669 656c 642d  -string = field-
-00013000: 7661 6c75 652c 207b 2022 2622 2c20 6669  value, { "&", fi
-00013010: 656c 642d 7661 6c75 6520 7d20 3b5c 6e5c  eld-value } ;\n\
-00013020: 6e45 6163 6820 6669 656c 642d 7661 6c75  nEach field-valu
-00013030: 6520 6172 6775 6d65 6e74 206d 7573 7420  e argument must 
-00013040: 6265 206f 6e65 206f 6620 7468 6520 7375  be one of the su
-00013050: 7070 6f72 7465 6420 6669 656c 6473 2c20  pported fields, 
-00013060: 616e 6420 616e 5c6e 6170 7072 6f70 7269  and an\nappropri
-00013070: 6174 6520 7661 6c75 652c 2073 6570 6172  ate value, separ
-00013080: 6174 6564 2077 6974 6820 7468 6520 223d  ated with the "=
-00013090: 2220 6368 6172 6163 7465 722e 5c6e 5c6e  " character.\n\n
-000130a0: 2020 2020 6669 656c 642d 7661 6c75 6520      field-value 
-000130b0: 3d20 2820 2254 6c73 222c 2022 3d22 202c  = ( "Tls", "=" ,
-000130c0: 2022 7472 7565 2220 7c20 2266 616c 7365   "true" | "false
-000130d0: 2220 295c 6e20 2020 2020 2020 2020 2020  " )\n           
-000130e0: 2020 2020 207c 2028 2022 546c 7356 6572       | ( "TlsVer
-000130f0: 6966 7943 6572 7422 2c20 223d 2220 2c20  ifyCert", "=" , 
-00013100: 2274 7275 6522 207c 2022 6661 6c73 6522  "true" | "false"
-00013110: 2029 5c6e 2020 2020 2020 2020 2020 2020   )\n            
-00013120: 2020 2020 7c20 2820 2243 6f6e 6e65 6374      | ( "Connect
-00013130: 696f 6e4e 616d 6522 2c20 223d 2220 2c20  ionName", "=" , 
-00013140: 7374 7269 6e67 2029 5c6e 2020 2020 2020  string )\n      
-00013150: 2020 2020 2020 2020 2020 7c20 2820 224e            | ( "N
-00013160: 6f64 6550 7265 6665 7265 6e63 6522 2c20  odePreference", 
-00013170: 223d 2220 2c20 226c 6561 6465 7222 207c  "=" , "leader" |
-00013180: 2022 666f 6c6c 6f77 6572 2220 7c20 2272   "follower" | "r
-00013190: 6561 646f 6e6c 7972 6570 6c69 6361 2220  eadonlyreplica" 
-000131a0: 7c20 2272 616e 646f 6d22 2029 5c6e 2020  | "random" )\n  
-000131b0: 2020 2020 2020 2020 2020 2020 2020 7c20                | 
-000131c0: 2820 2244 6566 6175 6c74 4465 6164 6c69  ( "DefaultDeadli
-000131d0: 6e65 222c 2022 3d22 202c 2069 6e74 6567  ne", "=" , integ
-000131e0: 6572 2029 5c6e 2020 2020 2020 2020 2020  er )\n          
-000131f0: 2020 2020 2020 7c20 2820 2247 6f73 7369        | ( "Gossi
-00013200: 7054 696d 656f 7574 222c 2022 3d22 202c  pTimeout", "=" ,
-00013210: 2069 6e74 6567 6572 2029 5c6e 2020 2020   integer )\n    
-00013220: 2020 2020 2020 2020 2020 2020 7c20 2820              | ( 
-00013230: 224d 6178 4469 7363 6f76 6572 4174 7465  "MaxDiscoverAtte
-00013240: 6d70 7473 222c 2022 3d22 202c 2069 6e74  mpts", "=" , int
-00013250: 6567 6572 2029 5c6e 2020 2020 2020 2020  eger )\n        
-00013260: 2020 2020 2020 2020 7c20 2820 2244 6973          | ( "Dis
-00013270: 636f 7665 7279 496e 7465 7276 616c 222c  coveryInterval",
-00013280: 2022 3d22 202c 2069 6e74 6567 6572 2029   "=" , integer )
-00013290: 5c6e 2020 2020 2020 2020 2020 2020 2020  \n              
-000132a0: 2020 7c20 2820 224d 6178 4469 7363 6f76    | ( "MaxDiscov
-000132b0: 6572 4174 7465 6d70 7473 222c 2022 3d22  erAttempts", "="
-000132c0: 202c 2069 6e74 6567 6572 2029 5c6e 2020   , integer )\n  
-000132d0: 2020 2020 2020 2020 2020 2020 2020 7c20                | 
-000132e0: 2820 224b 6565 7041 6c69 7665 496e 7465  ( "KeepAliveInte
-000132f0: 7276 616c 222c 2022 3d22 202c 2069 6e74  rval", "=" , int
-00013300: 6567 6572 2029 5c6e 2020 2020 2020 2020  eger )\n        
-00013310: 2020 2020 2020 2020 7c20 2820 224b 6565          | ( "Kee
-00013320: 7041 6c69 7665 496e 7465 7276 616c 222c  pAliveInterval",
-00013330: 2022 3d22 202c 2069 6e74 6567 6572 2029   "=" , integer )
-00013340: 203b 5c6e 5c6e 5468 6520 7461 626c 6520   ;\n\nThe table 
-00013350: 6265 6c6f 7720 6465 7363 7269 6265 7320  below describes 
-00013360: 7468 6520 7175 6572 7920 6669 656c 642d  the query field-
-00013370: 7661 6c75 6573 2073 7570 706f 7274 6564  values supported
-00013380: 2062 7920 7468 6973 2063 6c69 656e 742e   by this client.
-00013390: 5c6e 5c6e 7c20 4669 656c 6420 2020 2020  \n\n| Field     
-000133a0: 2020 2020 2020 2020 2020 7c20 5661 6c75            | Valu
-000133b0: 6520 2020 2020 2020 2020 2020 2020 2020  e               
-000133c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000133d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000133e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000133f0: 2020 7c20 4465 7363 7269 7074 696f 6e20    | Description 
-00013400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013490: 2020 2020 2020 7c5c 6e7c 2d2d 2d2d 2d2d        |\n|------
-000134a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d7c  ---------------|
-000134b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000134c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000134d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000134e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000134f0: 2d2d 2d2d 2d2d 2d7c 2d2d 2d2d 2d2d 2d2d  -------|--------
-00013500: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00013510: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00013520: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00013530: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00013540: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00013550: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00013560: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00013570: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00013580: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00013590: 2d2d 2d2d 2d2d 2d2d 2d2d 2d7c 5c6e 7c20  -----------|\n| 
-000135a0: 546c 7320 2020 2020 2020 2020 2020 2020  Tls             
-000135b0: 2020 2020 7c20 2274 7275 6522 2c20 2266      | "true", "f
-000135c0: 616c 7365 2220 2864 6566 6175 6c74 3a20  alse" (default: 
-000135d0: 2274 7275 6522 2920 2020 2020 2020 2020  "true")         
-000135e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000135f0: 2020 2020 2020 2020 2020 2020 7c20 4966              | If
-00013600: 2022 7472 7565 2220 7468 6520 636c 6965   "true" the clie
-00013610: 6e74 2077 696c 6c20 6372 6561 7465 2061  nt will create a
-00013620: 2022 7365 6375 7265 2220 6752 5043 2063   "secure" gRPC c
-00013630: 6861 6e6e 656c 2e20 4966 2022 6661 6c73  hannel. If "fals
-00013640: 6522 2074 6865 2063 6c69 656e 7420 7769  e" the client wi
-00013650: 6c6c 2063 7265 6174 6520 616e 2022 696e  ll create an "in
-00013660: 7365 6375 7265 2220 6752 5043 2063 6861  secure" gRPC cha
-00013670: 6e6e 656c 2e20 5468 6973 206d 7573 7420  nnel. This must 
-00013680: 6d61 7463 6820 7468 6520 7365 7276 6572  match the server
-00013690: 2063 6f6e 6669 6775 7261 7469 6f6e 2e20   configuration. 
-000136a0: 7c5c 6e7c 2054 6c73 5665 7269 6679 4365  |\n| TlsVerifyCe
-000136b0: 7274 2020 2020 2020 207c 2022 7472 7565  rt       | "true
-000136c0: 222c 2022 6661 6c73 6522 2028 6465 6661  ", "false" (defa
-000136d0: 756c 743a 2022 7472 7565 2229 2020 2020  ult: "true")    
-000136e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000136f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013700: 207c 2054 6869 7320 7661 6c75 6520 6973   | This value is
-00013710: 2063 7572 7265 6e74 6c79 2069 676e 6f72   currently ignor
-00013720: 6564 2e20 2020 2020 2020 2020 2020 2020  ed.             
-00013730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000137a0: 2020 2020 207c 5c6e 7c20 436f 6e6e 6563       |\n| Connec
-000137b0: 7469 6f6e 4e61 6d65 2020 2020 2020 7c20  tionName      | 
-000137c0: 7374 7269 6e67 2028 6465 6661 756c 743a  string (default:
-000137d0: 2061 7574 6f2d 6765 6e65 7261 7465 6420   auto-generated 
-000137e0: 7665 7273 696f 6e2d 3420 5555 4944 2920  version-4 UUID) 
-000137f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013800: 2020 2020 2020 7c20 5365 6e74 2069 6e20        | Sent in 
-00013810: 6361 6c6c 206d 6574 6164 6174 6120 666f  call metadata fo
-00013820: 7220 6576 6572 7920 6361 6c6c 2c20 746f  r every call, to
-00013830: 2069 6465 6e74 6966 7920 7468 6520 636c   identify the cl
-00013840: 6965 6e74 2074 6f20 7468 6520 636c 7573  ient to the clus
-00013850: 7465 722e 2020 2020 2020 2020 2020 2020  ter.            
-00013860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000138a0: 2020 2020 2020 2020 2020 7c5c 6e7c 204e            |\n| N
-000138b0: 6f64 6550 7265 6665 7265 6e63 6520 2020  odePreference   
-000138c0: 2020 207c 2022 6c65 6164 6572 222c 2022     | "leader", "
-000138d0: 666f 6c6c 6f77 6572 222c 2022 7265 6164  follower", "read
-000138e0: 6f6e 6c79 7265 706c 6963 6122 2c20 2272  onlyreplica", "r
-000138f0: 616e 646f 6d22 2028 6465 6661 756c 743a  andom" (default:
-00013900: 2022 6c65 6164 6572 2229 207c 2054 6865   "leader") | The
-00013910: 206e 6f64 6520 7374 6174 6520 7072 6566   node state pref
-00013920: 6572 7265 6420 6279 2074 6865 2063 6c69  erred by the cli
-00013930: 656e 742e 2054 6865 2063 6c69 656e 7420  ent. The client 
-00013940: 7769 6c6c 2073 656c 6563 7420 6120 6e6f  will select a no
-00013950: 6465 2066 726f 6d20 7468 6520 636c 7573  de from the clus
-00013960: 7465 7220 696e 666f 2072 6563 6569 7665  ter info receive
-00013970: 6420 6672 6f6d 2074 6865 2047 6f73 7369  d from the Gossi
-00013980: 7020 4150 4920 6163 636f 7264 696e 6720  p API according 
-00013990: 746f 2074 6869 7320 7072 6566 6572 656e  to this preferen
-000139a0: 6365 2e20 2020 2020 2020 2020 2020 207c  ce.            |
-000139b0: 5c6e 7c20 4465 6661 756c 7444 6561 646c  \n| DefaultDeadl
-000139c0: 696e 6520 2020 2020 7c20 696e 7465 6765  ine     | intege
-000139d0: 7220 2864 6566 6175 6c74 3a20 604e 6f6e  r (default: `Non
-000139e0: 6560 2920 2020 2020 2020 2020 2020 2020  e`)             
-000139f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013a10: 7c20 5468 6520 6465 6661 756c 7420 7661  | The default va
-00013a20: 6c75 6520 2869 6e20 7365 636f 6e64 7329  lue (in seconds)
-00013a30: 206f 6620 7468 6520 6074 696d 656f 7574   of the `timeout
-00013a40: 6020 6172 6775 6d65 6e74 206f 6620 636c  ` argument of cl
-00013a50: 6965 6e74 2022 7772 6974 6522 206d 6574  ient "write" met
-00013a60: 686f 6473 2073 7563 6820 6173 2060 6170  hods such as `ap
-00013a70: 7065 6e64 5f65 7665 6e74 7328 2960 2e20  pend_events()`. 
-00013a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013ab0: 2020 2020 7c5c 6e7c 2047 6f73 7369 7054      |\n| GossipT
-00013ac0: 696d 656f 7574 2020 2020 2020 207c 2069  imeout       | i
-00013ad0: 6e74 6567 6572 2028 6465 6661 756c 743a  nteger (default:
-00013ae0: 2035 2920 2020 2020 2020 2020 2020 2020   5)             
-00013af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013b10: 2020 2020 207c 2054 6865 2064 6566 6175       | The defau
-00013b20: 6c74 2076 616c 7565 2028 696e 2073 6563  lt value (in sec
-00013b30: 6f6e 6473 2920 6f66 2074 6865 2060 7469  onds) of the `ti
-00013b40: 6d65 6f75 7460 2061 7267 756d 656e 7420  meout` argument 
-00013b50: 6f66 2067 6f73 7369 7020 7265 6164 206d  of gossip read m
-00013b60: 6574 686f 6473 2c20 7375 6368 2061 7320  ethods, such as 
-00013b70: 6072 6561 645f 676f 7373 6970 2829 602e  `read_gossip()`.
-00013b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013bb0: 2020 2020 2020 2020 207c 5c6e 7c20 4d61           |\n| Ma
-00013bc0: 7844 6973 636f 7665 7241 7474 656d 7074  xDiscoverAttempt
-00013bd0: 7320 7c20 696e 7465 6765 7220 2864 6566  s | integer (def
-00013be0: 6175 6c74 3a20 3130 2920 2020 2020 2020  ault: 10)       
-00013bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013c10: 2020 2020 2020 2020 2020 7c20 5468 6520            | The 
-00013c20: 6e75 6d62 6572 206f 6620 6174 7465 6d70  number of attemp
-00013c30: 7473 2074 6f20 7265 6164 2067 6f73 7369  ts to read gossi
-00013c40: 7020 7768 656e 2063 6f6e 6e65 6374 696e  p when connectin
-00013c50: 6720 6f72 2072 6563 6f6e 6e65 6374 696e  g or reconnectin
-00013c60: 6720 746f 2061 2063 6c75 7374 6572 206d  g to a cluster m
-00013c70: 656d 6265 722e 2020 2020 2020 2020 2020  ember.          
-00013c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013cb0: 2020 2020 2020 2020 2020 2020 2020 7c5c                |\
-00013cc0: 6e7c 2044 6973 636f 7665 7279 496e 7465  n| DiscoveryInte
-00013cd0: 7276 616c 2020 207c 2069 6e74 6567 6572  rval   | integer
-00013ce0: 2028 6465 6661 756c 743a 2031 3030 2920   (default: 100) 
-00013cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013d10: 2020 2020 2020 2020 2020 2020 2020 207c                 |
-00013d20: 2048 6f77 206c 6f6e 6720 746f 2077 6169   How long to wai
-00013d30: 7420 2869 6e20 6d69 6c6c 6973 6563 6f6e  t (in millisecon
-00013d40: 6473 2920 6265 7477 6565 6e20 676f 7373  ds) between goss
-00013d50: 6970 2072 6574 7269 6573 2e20 2020 2020  ip retries.     
-00013d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013dc0: 2020 207c 5c6e 7c20 4b65 6570 416c 6976     |\n| KeepAliv
-00013dd0: 6549 6e74 6572 7661 6c20 2020 7c20 696e  eInterval   | in
-00013de0: 7465 6765 7220 2864 6566 6175 6c74 3a20  teger (default: 
-00013df0: 604e 6f6e 6560 2920 2020 2020 2020 2020  `None`)         
-00013e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013e20: 2020 2020 7c20 5468 6520 7661 6c75 6520      | The value 
-00013e30: 6f66 2074 6865 2022 6772 7063 2e6b 6565  of the "grpc.kee
-00013e40: 7061 6c69 7665 5f6d 7322 2067 5250 4320  palive_ms" gRPC 
-00013e50: 6368 616e 6e65 6c20 6f70 7469 6f6e 2e20  channel option. 
-00013e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000690: 7573 6566 756c 2066 6f72 2065 7861 6d70  useful for examp
+000006a0: 6c65 2077 6865 6e20 6578 6563 7574 696e  le when executin
+000006b0: 6720 6120 636f 6d6d 616e 6420 696e 2061  g a command in a
+000006c0: 6e20 6170 706c 6963 6174 696f 6e5c 6e74  n application\nt
+000006d0: 6861 7420 6d75 7461 7465 7320 616e 2061  hat mutates an a
+000006e0: 6767 7265 6761 7465 2e20 5468 6973 206d  ggregate. This m
+000006f0: 6574 686f 6420 6973 2022 6174 6f6d 6963  ethod is "atomic
+00000700: 2220 696e 2074 6861 7420 6569 7468 6572  " in that either
+00000710: 2061 6c6c 206f 7220 6e6f 6e65 206f 665c   all or none of\
+00000720: 6e74 6865 2065 7665 6e74 7320 7769 6c6c  nthe events will
+00000730: 2062 6520 7265 636f 7264 6564 2e5c 6e5c   be recorded.\n\
+00000740: 6e2a 2060 7265 6164 5f73 7472 6561 6d5f  n* `read_stream_
+00000750: 6576 656e 7473 2829 6020 5468 6973 206d  events()` This m
+00000760: 6574 686f 6420 6361 6e20 6265 2075 7365  ethod can be use
+00000770: 6420 746f 2072 6574 7269 6576 6520 616c  d to retrieve al
+00000780: 6c20 7468 6520 7265 636f 7264 6564 5c6e  l the recorded\n
+00000790: 6576 656e 7473 2069 6e20 6120 2273 7472  events in a "str
+000007a0: 6561 6d22 2e20 5468 6973 2069 7320 7573  eam". This is us
+000007b0: 6566 756c 2066 6f72 2065 7861 6d70 6c65  eful for example
+000007c0: 2077 6865 6e20 7265 636f 6e73 7472 7563   when reconstruc
+000007d0: 7469 6e67 2061 6e20 6167 6772 6567 6174  ting an aggregat
+000007e0: 655c 6e62 6566 6f72 6520 6578 6563 7574  e\nbefore execut
+000007f0: 696e 6720 6120 636f 6d6d 616e 6420 696e  ing a command in
+00000800: 2061 6e20 6170 706c 6963 6174 696f 6e2e   an application.
+00000810: 5c6e 5c6e 2a20 6073 7562 7363 7269 6265  \n\n* `subscribe
+00000820: 5f61 6c6c 5f65 7665 6e74 7328 2960 2054  _all_events()` T
+00000830: 6869 7320 6d65 7468 6f64 2063 616e 2062  his method can b
+00000840: 6520 7573 6564 2074 6f20 7265 6365 6976  e used to receiv
+00000850: 6520 616c 6c20 7265 636f 7264 6564 5c6e  e all recorded\n
+00000860: 6576 656e 7473 2061 6372 6f73 7320 616c  events across al
+00000870: 6c20 2273 7472 6561 6d73 222e 2054 6869  l "streams". Thi
+00000880: 7320 6973 2075 7365 6675 6c20 696e 2064  s is useful in d
+00000890: 6f77 6e73 7472 6561 6d20 6576 656e 742d  ownstream event-
+000008a0: 7072 6f63 6573 7369 6e67 5c6e 636f 6d70  processing\ncomp
+000008b0: 6f6e 656e 7473 2c20 616e 6420 7375 7070  onents, and supp
+000008c0: 6f72 7473 2070 726f 6365 7373 696e 6720  orts processing 
+000008d0: 6576 656e 7473 2077 6974 6820 2265 7861  events with "exa
+000008e0: 6374 6c79 2d6f 6e63 6522 2073 656d 616e  ctly-once" seman
+000008f0: 7469 6373 2028 7365 6520 6265 6c6f 7729  tics (see below)
+00000900: 2e5c 6e5c 6e54 6865 2065 7861 6d70 6c65  .\n\nThe example
+00000910: 2062 656c 6f77 2075 7365 7320 616e 2022   below uses an "
+00000920: 696e 7365 6375 7265 2220 4576 656e 7453  insecure" EventS
+00000930: 746f 7265 4442 2073 6572 7665 7220 7275  toreDB server ru
+00000940: 6e6e 696e 6720 6c6f 6361 6c6c 7920 6f6e  nning locally on
+00000950: 2070 6f72 7420 3231 3134 2e5c 6e5c 6e60   port 2114.\n\n`
+00000960: 6060 7079 7468 6f6e 5c6e 696d 706f 7274  ``python\nimport
+00000970: 2065 7364 6263 6c69 656e 742c 2075 7569   esdbclient, uui
+00000980: 645c 6e5c 6e5c 6e23 2043 6f6e 7374 7275  d\n\n\n# Constru
+00000990: 6374 2045 5344 4243 6c69 656e 7420 7769  ct ESDBClient wi
+000009a0: 7468 2061 6e20 4576 656e 7453 746f 7265  th an EventStore
+000009b0: 4442 2055 5249 2e5c 6e5c 6e63 6c69 656e  DB URI.\n\nclien
+000009c0: 7420 3d20 6573 6462 636c 6965 6e74 2e45  t = esdbclient.E
+000009d0: 5344 4243 6c69 656e 7428 7572 693d 2265  SDBClient(uri="e
+000009e0: 7364 623a 2f2f 6c6f 6361 6c68 6f73 743a  sdb://localhost:
+000009f0: 3231 3134 3f54 6c73 3d66 616c 7365 2229  2114?Tls=false")
+00000a00: 5c6e 5c6e 5c6e 2320 4170 7065 6e64 2065  \n\n\n# Append e
+00000a10: 7665 6e74 7320 746f 2061 206e 6577 2073  vents to a new s
+00000a20: 7472 6561 6d2e 5c6e 5c6e 7374 7265 616d  tream.\n\nstream
+00000a30: 5f6e 616d 6520 3d20 7374 7228 7575 6964  _name = str(uuid
+00000a40: 2e75 7569 6434 2829 295c 6e5c 6e65 7665  .uuid4())\n\neve
+00000a50: 6e74 3120 3d20 6573 6462 636c 6965 6e74  nt1 = esdbclient
+00000a60: 2e4e 6577 4576 656e 7428 7479 7065 3d5c  .NewEvent(type=\
+00000a70: 274f 7264 6572 4372 6561 7465 645c 272c  'OrderCreated\',
+00000a80: 2064 6174 613d 625c 2764 6174 6131 5c27   data=b\'data1\'
+00000a90: 295c 6e5c 6e63 6c69 656e 742e 6170 7065  )\n\nclient.appe
+00000aa0: 6e64 5f65 7665 6e74 7328 5c6e 2020 2020  nd_events(\n    
+00000ab0: 7374 7265 616d 5f6e 616d 653d 7374 7265  stream_name=stre
+00000ac0: 616d 5f6e 616d 652c 5c6e 2020 2020 6578  am_name,\n    ex
+00000ad0: 7065 6374 6564 5f70 6f73 6974 696f 6e3d  pected_position=
+00000ae0: 4e6f 6e65 2c5c 6e20 2020 2065 7665 6e74  None,\n    event
+00000af0: 733d 5b65 7665 6e74 315d 2c5c 6e29 5c6e  s=[event1],\n)\n
+00000b00: 5c6e 5c6e 2320 4170 7065 6e64 206d 6f72  \n\n# Append mor
+00000b10: 6520 6576 656e 7473 2074 6f20 616e 2065  e events to an e
+00000b20: 7869 7374 696e 6720 7374 7265 616d 2e5c  xisting stream.\
+00000b30: 6e5c 6e65 7665 6e74 3220 3d20 6573 6462  n\nevent2 = esdb
+00000b40: 636c 6965 6e74 2e4e 6577 4576 656e 7428  client.NewEvent(
+00000b50: 7479 7065 3d5c 274f 7264 6572 5570 6461  type=\'OrderUpda
+00000b60: 7465 645c 272c 2064 6174 613d 625c 2764  ted\', data=b\'d
+00000b70: 6174 6132 5c27 295c 6e65 7665 6e74 3320  ata2\')\nevent3 
+00000b80: 3d20 6573 6462 636c 6965 6e74 2e4e 6577  = esdbclient.New
+00000b90: 4576 656e 7428 7479 7065 3d5c 274f 7264  Event(type=\'Ord
+00000ba0: 6572 4465 6c65 7465 645c 272c 2064 6174  erDeleted\', dat
+00000bb0: 613d 625c 2764 6174 6133 5c27 295c 6e5c  a=b\'data3\')\n\
+00000bc0: 6e63 6c69 656e 742e 6170 7065 6e64 5f65  nclient.append_e
+00000bd0: 7665 6e74 7328 5c6e 2020 2020 7374 7265  vents(\n    stre
+00000be0: 616d 5f6e 616d 653d 7374 7265 616d 5f6e  am_name=stream_n
+00000bf0: 616d 652c 5c6e 2020 2020 6578 7065 6374  ame,\n    expect
+00000c00: 6564 5f70 6f73 6974 696f 6e3d 302c 5c6e  ed_position=0,\n
+00000c10: 2020 2020 6576 656e 7473 3d5b 6576 656e      events=[even
+00000c20: 7432 2c20 6576 656e 7433 5d2c 5c6e 295c  t2, event3],\n)\
+00000c30: 6e5c 6e5c 6e23 2052 6561 6420 616c 6c20  n\n\n# Read all 
+00000c40: 6576 656e 7473 2072 6563 6f72 6465 6420  events recorded 
+00000c50: 696e 2061 2073 7472 6561 6d2e 5c6e 5c6e  in a stream.\n\n
+00000c60: 7265 636f 7264 6564 203d 2063 6c69 656e  recorded = clien
+00000c70: 742e 7265 6164 5f73 7472 6561 6d5f 6576  t.read_stream_ev
+00000c80: 656e 7473 285c 6e20 2020 2073 7472 6561  ents(\n    strea
+00000c90: 6d5f 6e61 6d65 3d73 7472 6561 6d5f 6e61  m_name=stream_na
+00000ca0: 6d65 5c6e 295c 6e5c 6e61 7373 6572 7420  me\n)\n\nassert 
+00000cb0: 6c65 6e28 7265 636f 7264 6564 2920 3d3d  len(recorded) ==
+00000cc0: 2033 5c6e 6173 7365 7274 2072 6563 6f72   3\nassert recor
+00000cd0: 6465 645b 305d 2e64 6174 6120 3d3d 2065  ded[0].data == e
+00000ce0: 7665 6e74 312e 6461 7461 5c6e 6173 7365  vent1.data\nasse
+00000cf0: 7274 2072 6563 6f72 6465 645b 315d 2e64  rt recorded[1].d
+00000d00: 6174 6120 3d3d 2065 7665 6e74 322e 6461  ata == event2.da
+00000d10: 7461 5c6e 6173 7365 7274 2072 6563 6f72  ta\nassert recor
+00000d20: 6465 645b 325d 2e64 6174 6120 3d3d 2065  ded[2].data == e
+00000d30: 7665 6e74 332e 6461 7461 5c6e 6173 7365  vent3.data\nasse
+00000d40: 7274 2072 6563 6f72 6465 645b 305d 2e74  rt recorded[0].t
+00000d50: 7970 6520 3d3d 2065 7665 6e74 312e 7479  ype == event1.ty
+00000d60: 7065 5c6e 6173 7365 7274 2072 6563 6f72  pe\nassert recor
+00000d70: 6465 645b 315d 2e74 7970 6520 3d3d 2065  ded[1].type == e
+00000d80: 7665 6e74 322e 7479 7065 5c6e 6173 7365  vent2.type\nasse
+00000d90: 7274 2072 6563 6f72 6465 645b 325d 2e74  rt recorded[2].t
+00000da0: 7970 6520 3d3d 2065 7665 6e74 332e 7479  ype == event3.ty
+00000db0: 7065 5c6e 5c6e 5c6e 2320 496e 2061 6e20  pe\n\n\n# In an 
+00000dc0: 6576 656e 742d 7072 6f63 6573 7369 6e67  event-processing
+00000dd0: 2063 6f6d 706f 6e65 6e74 2c20 7573 6520   component, use 
+00000de0: 6120 2263 6174 6368 2d75 7022 2073 7562  a "catch-up" sub
+00000df0: 7363 7269 7074 696f 6e5c 6e23 2074 6f20  scription\n# to 
+00000e00: 7265 6365 6976 6520 616c 6c20 6576 656e  receive all even
+00000e10: 7473 2061 6372 6f73 7320 616c 6c20 7374  ts across all st
+00000e20: 7265 616d 732c 2069 6e63 6c75 6469 6e67  reams, including
+00000e30: 2065 7665 6e74 7320 7468 6174 5c6e 2320   events that\n# 
+00000e40: 6861 7665 206e 6f74 2079 6574 2062 6565  have not yet bee
+00000e50: 6e20 7265 636f 7264 6564 2c20 7374 6172  n recorded, star
+00000e60: 7469 6e67 2066 726f 6d20 7468 6520 636f  ting from the co
+00000e70: 6d70 6f6e 656e 745c 2773 206c 6173 745c  mponent\'s last\
+00000e80: 6e23 2073 6176 6564 2022 636f 6d6d 6974  n# saved "commit
+00000e90: 2070 6f73 6974 696f 6e22 2e5c 6e5c 6e6c   position".\n\nl
+00000ea0: 6173 745f 7361 7665 645f 636f 6d6d 6974  ast_saved_commit
+00000eb0: 5f70 6f73 6974 696f 6e20 3d20 305c 6e5c  _position = 0\n\
+00000ec0: 6e73 7562 7363 7269 7074 696f 6e20 3d20  nsubscription = 
+00000ed0: 636c 6965 6e74 2e73 7562 7363 7269 6265  client.subscribe
+00000ee0: 5f61 6c6c 5f65 7665 6e74 7328 5c6e 2020  _all_events(\n  
+00000ef0: 2020 636f 6d6d 6974 5f70 6f73 6974 696f    commit_positio
+00000f00: 6e3d 6c61 7374 5f73 6176 6564 5f63 6f6d  n=last_saved_com
+00000f10: 6d69 745f 706f 7369 7469 6f6e 5c6e 295c  mit_position\n)\
+00000f20: 6e5c 6e23 2054 6f20 696d 706c 656d 656e  n\n# To implemen
+00000f30: 7420 2265 7861 6374 6c79 2d6f 6e63 6522  t "exactly-once"
+00000f40: 2073 656d 616e 7469 6373 2c20 6974 6572   semantics, iter
+00000f50: 6174 6520 6f76 6572 2074 6865 5c6e 2320  ate over the\n# 
+00000f60: 2263 6174 6368 2d75 7022 2073 7562 7363  "catch-up" subsc
+00000f70: 7269 7074 696f 6e2e 2050 726f 6365 7373  ription. Process
+00000f80: 2065 6163 6820 7265 6365 6976 6564 2065   each received e
+00000f90: 7665 6e74 2c5c 6e23 2069 6e20 7475 726e  vent,\n# in turn
+00000fa0: 2c20 7468 726f 7567 6820 616e 2065 7665  , through an eve
+00000fb0: 6e74 2d70 726f 6365 7373 696e 6720 706f  nt-processing po
+00000fc0: 6c69 6379 2e20 5361 7665 2074 6865 5c6e  licy. Save the\n
+00000fd0: 2320 7661 6c75 6520 6f66 2074 6865 2063  # value of the c
+00000fe0: 6f6d 6d69 745f 706f 7369 7469 6f6e 2061  ommit_position a
+00000ff0: 7474 7269 6275 7465 206f 6620 7468 6520  ttribute of the 
+00001000: 7072 6f63 6573 7365 645c 6e23 2065 7665  processed\n# eve
+00001010: 6e74 2077 6974 6820 6e65 7720 7374 6174  nt with new stat
+00001020: 6520 6765 6e65 7261 7465 6420 6279 2074  e generated by t
+00001030: 6865 2070 6f6c 6963 7920 696e 2074 6865  he policy in the
+00001040: 2073 616d 655c 6e23 2061 746f 6d69 6320   same\n# atomic 
+00001050: 7472 616e 7361 6374 696f 6e2e 2055 7365  transaction. Use
+00001060: 2074 6865 206c 6173 7420 7361 7665 6420   the last saved 
+00001070: 2263 6f6d 6d69 7420 706f 7369 7469 6f6e  "commit position
+00001080: 225c 6e23 2077 6865 6e20 7265 7374 6172  "\n# when restar
+00001090: 7469 6e67 2074 6865 2022 6361 7463 682d  ting the "catch-
+000010a0: 7570 2220 7375 6273 6372 6970 7469 6f6e  up" subscription
+000010b0: 2e5c 6e5c 6e72 6563 6569 7665 6420 3d20  .\n\nreceived = 
+000010c0: 5b5d 5c6e 666f 7220 6576 656e 7420 696e  []\nfor event in
+000010d0: 2073 7562 7363 7269 7074 696f 6e3a 5c6e   subscription:\n
+000010e0: 2020 2020 7265 6365 6976 6564 2e61 7070      received.app
+000010f0: 656e 6428 6576 656e 7429 5c6e 2020 2020  end(event)\n    
+00001100: 6966 2065 7665 6e74 2e69 6420 3d3d 2065  if event.id == e
+00001110: 7665 6e74 332e 6964 3a5c 6e20 2020 2020  vent3.id:\n     
+00001120: 2020 2062 7265 616b 5c6e 5c6e 6173 7365     break\n\nasse
+00001130: 7274 2072 6563 6569 7665 645b 2d33 5d2e  rt received[-3].
+00001140: 6461 7461 203d 3d20 6576 656e 7431 2e64  data == event1.d
+00001150: 6174 615c 6e61 7373 6572 7420 7265 6365  ata\nassert rece
+00001160: 6976 6564 5b2d 325d 2e64 6174 6120 3d3d  ived[-2].data ==
+00001170: 2065 7665 6e74 322e 6461 7461 5c6e 6173   event2.data\nas
+00001180: 7365 7274 2072 6563 6569 7665 645b 2d31  sert received[-1
+00001190: 5d2e 6461 7461 203d 3d20 6576 656e 7433  ].data == event3
+000011a0: 2e64 6174 615c 6e61 7373 6572 7420 7265  .data\nassert re
+000011b0: 6365 6976 6564 5b2d 335d 2e74 7970 6520  ceived[-3].type 
+000011c0: 3d3d 2065 7665 6e74 312e 7479 7065 5c6e  == event1.type\n
+000011d0: 6173 7365 7274 2072 6563 6569 7665 645b  assert received[
+000011e0: 2d32 5d2e 7479 7065 203d 3d20 6576 656e  -2].type == even
+000011f0: 7432 2e74 7970 655c 6e61 7373 6572 7420  t2.type\nassert 
+00001200: 7265 6365 6976 6564 5b2d 315d 2e74 7970  received[-1].typ
+00001210: 6520 3d3d 2065 7665 6e74 332e 7479 7065  e == event3.type
+00001220: 5c6e 5c6e 6173 7365 7274 2072 6563 6569  \n\nassert recei
+00001230: 7665 645b 2d33 5d2e 636f 6d6d 6974 5f70  ved[-3].commit_p
+00001240: 6f73 6974 696f 6e20 3e20 305c 6e61 7373  osition > 0\nass
+00001250: 6572 7420 7265 6365 6976 6564 5b2d 325d  ert received[-2]
+00001260: 2e63 6f6d 6d69 745f 706f 7369 7469 6f6e  .commit_position
+00001270: 203e 2072 6563 6569 7665 645b 2d33 5d2e   > received[-3].
+00001280: 636f 6d6d 6974 5f70 6f73 6974 696f 6e5c  commit_position\
+00001290: 6e61 7373 6572 7420 7265 6365 6976 6564  nassert received
+000012a0: 5b2d 315d 2e63 6f6d 6d69 745f 706f 7369  [-1].commit_posi
+000012b0: 7469 6f6e 203e 2072 6563 6569 7665 645b  tion > received[
+000012c0: 2d32 5d2e 636f 6d6d 6974 5f70 6f73 6974  -2].commit_posit
+000012d0: 696f 6e5c 6e5c 6e5c 6e23 2043 6c6f 7365  ion\n\n\n# Close
+000012e0: 2074 6865 2063 6c69 656e 7420 6166 7465   the client afte
+000012f0: 7220 7573 652e 5c6e 5c6e 636c 6965 6e74  r use.\n\nclient
+00001300: 2e63 6c6f 7365 2829 5c6e 6060 605c 6e5c  .close()\n```\n\
+00001310: 6e53 6565 2062 656c 6f77 2066 6f72 206d  nSee below for m
+00001320: 6f72 6520 6465 7461 696c 732e 5c6e 5c6e  ore details.\n\n
+00001330: 466f 7220 616e 2065 7861 6d70 6c65 206f  For an example o
+00001340: 6620 7573 6167 652c 2073 6565 2074 6865  f usage, see the
+00001350: 205b 6576 656e 7473 6f75 7263 696e 672d   [eventsourcing-
+00001360: 6576 656e 7473 746f 7265 6462 5d28 5c6e  eventstoredb](\n
+00001370: 6874 7470 733a 2f2f 6769 7468 7562 2e63  https://github.c
+00001380: 6f6d 2f70 7965 7665 6e74 736f 7572 6369  om/pyeventsourci
+00001390: 6e67 2f65 7665 6e74 736f 7572 6369 6e67  ng/eventsourcing
+000013a0: 2d65 7665 6e74 7374 6f72 6564 6229 2070  -eventstoredb) p
+000013b0: 6163 6b61 6765 2e5c 6e5c 6e23 2320 5461  ackage.\n\n## Ta
+000013c0: 626c 6520 6f66 2063 6f6e 7465 6e74 735c  ble of contents\
+000013d0: 6e5c 6e3c 212d 2d20 544f 4320 2d2d 3e5c  n\n<!-- TOC -->\
+000013e0: 6e2a 205b 496e 7374 616c 6c20 7061 636b  n* [Install pack
+000013f0: 6167 655d 2823 696e 7374 616c 6c2d 7061  age](#install-pa
+00001400: 636b 6167 6529 5c6e 2020 2a20 5b46 726f  ckage)\n  * [Fro
+00001410: 6d20 5079 5049 5d28 2366 726f 6d2d 7079  m PyPI](#from-py
+00001420: 7069 295c 6e20 202a 205b 5769 7468 2050  pi)\n  * [With P
+00001430: 6f65 7472 795d 2823 7769 7468 2d70 6f65  oetry](#with-poe
+00001440: 7472 7929 5c6e 2a20 5b45 7665 6e74 5374  try)\n* [EventSt
+00001450: 6f72 6544 4220 7365 7276 6572 5d28 2365  oreDB server](#e
+00001460: 7665 6e74 7374 6f72 6564 622d 7365 7276  ventstoredb-serv
+00001470: 6572 295c 6e20 202a 205b 5275 6e20 636f  er)\n  * [Run co
+00001480: 6e74 6169 6e65 725d 2823 7275 6e2d 636f  ntainer](#run-co
+00001490: 6e74 6169 6e65 7229 5c6e 2020 2a20 5b53  ntainer)\n  * [S
+000014a0: 746f 7020 636f 6e74 6169 6e65 725d 2823  top container](#
+000014b0: 7374 6f70 2d63 6f6e 7461 696e 6572 295c  stop-container)\
+000014c0: 6e2a 205b 4576 656e 7453 746f 7265 4442  n* [EventStoreDB
+000014d0: 2063 6c69 656e 745d 2823 6576 656e 7473   client](#events
+000014e0: 746f 7265 6462 2d63 6c69 656e 7429 5c6e  toredb-client)\n
+000014f0: 2020 2a20 5b49 6d70 6f72 7420 636c 6173    * [Import clas
+00001500: 735d 2823 696d 706f 7274 2d63 6c61 7373  s](#import-class
+00001510: 295c 6e20 202a 205b 436f 6e73 7472 7563  )\n  * [Construc
+00001520: 7420 636c 6965 6e74 5d28 2363 6f6e 7374  t client](#const
+00001530: 7275 6374 2d63 6c69 656e 7429 5c6e 2a20  ruct-client)\n* 
+00001540: 5b53 7472 6561 6d73 5d28 2373 7472 6561  [Streams](#strea
+00001550: 6d73 295c 6e20 202a 205b 4170 7065 6e64  ms)\n  * [Append
+00001560: 2065 7665 6e74 735d 2823 6170 7065 6e64   events](#append
+00001570: 2d65 7665 6e74 7329 5c6e 2020 2a20 5b41  -events)\n  * [A
+00001580: 7070 656e 6420 6576 656e 745d 2823 6170  ppend event](#ap
+00001590: 7065 6e64 2d65 7665 6e74 295c 6e20 202a  pend-event)\n  *
+000015a0: 205b 4964 656d 706f 7465 6e74 2061 7070   [Idempotent app
+000015b0: 656e 6420 6f70 6572 6174 696f 6e73 5d28  end operations](
+000015c0: 2369 6465 6d70 6f74 656e 742d 6170 7065  #idempotent-appe
+000015d0: 6e64 2d6f 7065 7261 7469 6f6e 7329 5c6e  nd-operations)\n
+000015e0: 2020 2a20 5b52 6561 6420 7374 7265 616d    * [Read stream
+000015f0: 2065 7665 6e74 735d 2823 7265 6164 2d73   events](#read-s
+00001600: 7472 6561 6d2d 6576 656e 7473 295c 6e20  tream-events)\n 
+00001610: 202a 205b 486f 7720 746f 2069 6d70 6c65   * [How to imple
+00001620: 6d65 6e74 2073 6e61 7073 686f 7474 696e  ment snapshottin
+00001630: 6720 7769 7468 2045 7665 6e74 5374 6f72  g with EventStor
+00001640: 6544 425d 2823 686f 772d 746f 2d69 6d70  eDB](#how-to-imp
+00001650: 6c65 6d65 6e74 2d73 6e61 7073 686f 7474  lement-snapshott
+00001660: 696e 672d 7769 7468 2d65 7665 6e74 7374  ing-with-eventst
+00001670: 6f72 6564 6229 5c6e 2020 2a20 5b52 6561  oredb)\n  * [Rea
+00001680: 6420 616c 6c20 6576 656e 7473 5d28 2372  d all events](#r
+00001690: 6561 642d 616c 6c2d 6576 656e 7473 295c  ead-all-events)\
+000016a0: 6e20 202a 205b 4765 7420 6375 7272 656e  n  * [Get curren
+000016b0: 7420 7374 7265 616d 2070 6f73 6974 696f  t stream positio
+000016c0: 6e5d 2823 6765 742d 6375 7272 656e 742d  n](#get-current-
+000016d0: 7374 7265 616d 2d70 6f73 6974 696f 6e29  stream-position)
+000016e0: 5c6e 2020 2a20 5b47 6574 2063 7572 7265  \n  * [Get curre
+000016f0: 6e74 2063 6f6d 6d69 7420 706f 7369 7469  nt commit positi
+00001700: 6f6e 5d28 2367 6574 2d63 7572 7265 6e74  on](#get-current
+00001710: 2d63 6f6d 6d69 742d 706f 7369 7469 6f6e  -commit-position
+00001720: 295c 6e20 202a 205b 4765 7420 7374 7265  )\n  * [Get stre
+00001730: 616d 206d 6574 6164 6174 615d 2823 6765  am metadata](#ge
+00001740: 742d 7374 7265 616d 2d6d 6574 6164 6174  t-stream-metadat
+00001750: 6129 5c6e 2020 2a20 5b53 6574 2073 7472  a)\n  * [Set str
+00001760: 6561 6d20 6d65 7461 6461 7461 5d28 2373  eam metadata](#s
+00001770: 6574 2d73 7472 6561 6d2d 6d65 7461 6461  et-stream-metada
+00001780: 7461 295c 6e20 202a 205b 4465 6c65 7465  ta)\n  * [Delete
+00001790: 2073 7472 6561 6d5d 2823 6465 6c65 7465   stream](#delete
+000017a0: 2d73 7472 6561 6d29 5c6e 2020 2a20 5b54  -stream)\n  * [T
+000017b0: 6f6d 6273 746f 6e65 2073 7472 6561 6d5d  ombstone stream]
+000017c0: 2823 746f 6d62 7374 6f6e 652d 7374 7265  (#tombstone-stre
+000017d0: 616d 295c 6e2a 205b 4361 7463 682d 7570  am)\n* [Catch-up
+000017e0: 2073 7562 7363 7269 7074 696f 6e73 5d28   subscriptions](
+000017f0: 2363 6174 6368 2d75 702d 7375 6273 6372  #catch-up-subscr
+00001800: 6970 7469 6f6e 7329 5c6e 2020 2a20 5b48  iptions)\n  * [H
+00001810: 6f77 2074 6f20 696d 706c 656d 656e 7420  ow to implement 
+00001820: 6578 6163 746c 792d 6f6e 6365 2065 7665  exactly-once eve
+00001830: 6e74 2070 726f 6365 7373 696e 675d 2823  nt processing](#
+00001840: 686f 772d 746f 2d69 6d70 6c65 6d65 6e74  how-to-implement
+00001850: 2d65 7861 6374 6c79 2d6f 6e63 652d 6576  -exactly-once-ev
+00001860: 656e 742d 7072 6f63 6573 7369 6e67 295c  ent-processing)\
+00001870: 6e20 202a 205b 5375 6273 6372 6962 6520  n  * [Subscribe 
+00001880: 616c 6c20 6576 656e 7473 5d28 2373 7562  all events](#sub
+00001890: 7363 7269 6265 2d61 6c6c 2d65 7665 6e74  scribe-all-event
+000018a0: 7329 5c6e 2020 2a20 5b53 7562 7363 7269  s)\n  * [Subscri
+000018b0: 6265 2073 7472 6561 6d20 6576 656e 7473  be stream events
+000018c0: 5d28 2373 7562 7363 7269 6265 2d73 7472  ](#subscribe-str
+000018d0: 6561 6d2d 6576 656e 7473 295c 6e2a 205b  eam-events)\n* [
+000018e0: 5065 7273 6973 7465 6e74 2073 7562 7363  Persistent subsc
+000018f0: 7269 7074 696f 6e73 5d28 2370 6572 7369  riptions](#persi
+00001900: 7374 656e 742d 7375 6273 6372 6970 7469  stent-subscripti
+00001910: 6f6e 7329 5c6e 2020 2a20 5b43 7265 6174  ons)\n  * [Creat
+00001920: 6520 7375 6273 6372 6970 7469 6f6e 5d28  e subscription](
+00001930: 2363 7265 6174 652d 7375 6273 6372 6970  #create-subscrip
+00001940: 7469 6f6e 295c 6e20 202a 205b 5265 6164  tion)\n  * [Read
+00001950: 2073 7562 7363 7269 7074 696f 6e5d 2823   subscription](#
+00001960: 7265 6164 2d73 7562 7363 7269 7074 696f  read-subscriptio
+00001970: 6e29 5c6e 2020 2a20 5b47 6574 2073 7562  n)\n  * [Get sub
+00001980: 7363 7269 7074 696f 6e20 696e 666f 5d28  scription info](
+00001990: 2367 6574 2d73 7562 7363 7269 7074 696f  #get-subscriptio
+000019a0: 6e2d 696e 666f 295c 6e20 202a 205b 4c69  n-info)\n  * [Li
+000019b0: 7374 2073 7562 7363 7269 7074 696f 6e73  st subscriptions
+000019c0: 5d28 236c 6973 742d 7375 6273 6372 6970  ](#list-subscrip
+000019d0: 7469 6f6e 7329 5c6e 2020 2a20 5b44 656c  tions)\n  * [Del
+000019e0: 6574 6520 7375 6273 6372 6970 7469 6f6e  ete subscription
+000019f0: 5d28 2364 656c 6574 652d 7375 6273 6372  ](#delete-subscr
+00001a00: 6970 7469 6f6e 295c 6e20 202a 205b 5570  iption)\n  * [Up
+00001a10: 6461 7465 2073 7562 7363 7269 7074 696f  date subscriptio
+00001a20: 6e5d 2823 7570 6461 7465 2d73 7562 7363  n](#update-subsc
+00001a30: 7269 7074 696f 6e29 5c6e 2020 2a20 5b43  ription)\n  * [C
+00001a40: 7265 6174 6520 7374 7265 616d 2073 7562  reate stream sub
+00001a50: 7363 7269 7074 696f 6e5d 2823 6372 6561  scription](#crea
+00001a60: 7465 2d73 7472 6561 6d2d 7375 6273 6372  te-stream-subscr
+00001a70: 6970 7469 6f6e 295c 6e20 202a 205b 5265  iption)\n  * [Re
+00001a80: 6164 2073 7472 6561 6d20 7375 6273 6372  ad stream subscr
+00001a90: 6970 7469 6f6e 5d28 2372 6561 642d 7374  iption](#read-st
+00001aa0: 7265 616d 2d73 7562 7363 7269 7074 696f  ream-subscriptio
+00001ab0: 6e29 5c6e 2020 2a20 5b47 6574 2073 7472  n)\n  * [Get str
+00001ac0: 6561 6d20 7375 6273 6372 6970 7469 6f6e  eam subscription
+00001ad0: 2069 6e66 6f5d 2823 6765 742d 7374 7265   info](#get-stre
+00001ae0: 616d 2d73 7562 7363 7269 7074 696f 6e2d  am-subscription-
+00001af0: 696e 666f 295c 6e20 202a 205b 4c69 7374  info)\n  * [List
+00001b00: 2073 7472 6561 6d20 7375 6273 6372 6970   stream subscrip
+00001b10: 7469 6f6e 735d 2823 6c69 7374 2d73 7472  tions](#list-str
+00001b20: 6561 6d2d 7375 6273 6372 6970 7469 6f6e  eam-subscription
+00001b30: 7329 5c6e 2020 2a20 5b55 7064 6174 6520  s)\n  * [Update 
+00001b40: 7374 7265 616d 2073 7562 7363 7269 7074  stream subscript
+00001b50: 696f 6e5d 2823 7570 6461 7465 2d73 7472  ion](#update-str
+00001b60: 6561 6d2d 7375 6273 6372 6970 7469 6f6e  eam-subscription
+00001b70: 295c 6e20 202a 205b 4465 6c65 7465 2073  )\n  * [Delete s
+00001b80: 7472 6561 6d20 7375 6273 6372 6970 7469  tream subscripti
+00001b90: 6f6e 5d28 2364 656c 6574 652d 7374 7265  on](#delete-stre
+00001ba0: 616d 2d73 7562 7363 7269 7074 696f 6e29  am-subscription)
+00001bb0: 5c6e 2020 2a20 5b50 6572 7369 7374 656e  \n  * [Persisten
+00001bc0: 7420 7375 6273 6372 6970 7469 6f6e 2063  t subscription c
+00001bd0: 6f6e 7375 6d65 725d 2823 7065 7273 6973  onsumer](#persis
+00001be0: 7465 6e74 2d73 7562 7363 7269 7074 696f  tent-subscriptio
+00001bf0: 6e2d 636f 6e73 756d 6572 295c 6e2a 205b  n-consumer)\n* [
+00001c00: 436f 6e6e 6563 7469 6f6e 5d28 2363 6f6e  Connection](#con
+00001c10: 6e65 6374 696f 6e29 5c6e 2020 2a20 5b52  nection)\n  * [R
+00001c20: 6563 6f6e 6e65 6374 5d28 2372 6563 6f6e  econnect](#recon
+00001c30: 6e65 6374 295c 6e20 202a 205b 436c 6f73  nect)\n  * [Clos
+00001c40: 655d 2823 636c 6f73 6529 5c6e 2a20 5b4e  e](#close)\n* [N
+00001c50: 6f74 6573 5d28 236e 6f74 6573 295c 6e20  otes](#notes)\n 
+00001c60: 202a 205b 436f 6e6e 6563 7469 6f6e 2073   * [Connection s
+00001c70: 7472 696e 6773 5d28 2363 6f6e 6e65 6374  trings](#connect
+00001c80: 696f 6e2d 7374 7269 6e67 7329 5c6e 2020  ion-strings)\n  
+00001c90: 2a20 5b52 6567 756c 6172 2065 7870 7265  * [Regular expre
+00001ca0: 7373 696f 6e20 6669 6c74 6572 735d 2823  ssion filters](#
+00001cb0: 7265 6775 6c61 722d 6578 7072 6573 7369  regular-expressi
+00001cc0: 6f6e 2d66 696c 7465 7273 295c 6e20 202a  on-filters)\n  *
+00001cd0: 205b 4e65 7720 6576 656e 7420 6f62 6a65   [New event obje
+00001ce0: 6374 735d 2823 6e65 772d 6576 656e 742d  cts](#new-event-
+00001cf0: 6f62 6a65 6374 7329 5c6e 2020 2a20 5b52  objects)\n  * [R
+00001d00: 6563 6f72 6465 6420 6576 656e 7420 6f62  ecorded event ob
+00001d10: 6a65 6374 735d 2823 7265 636f 7264 6564  jects](#recorded
+00001d20: 2d65 7665 6e74 2d6f 626a 6563 7473 295c  -event-objects)\
+00001d30: 6e20 202a 205b 4173 796e 6369 6f20 636c  n  * [Asyncio cl
+00001d40: 6965 6e74 5d28 2361 7379 6e63 696f 2d63  ient](#asyncio-c
+00001d50: 6c69 656e 7429 5c6e 2a20 5b43 6f6e 7472  lient)\n* [Contr
+00001d60: 6962 7574 6f72 735d 2823 636f 6e74 7269  ibutors](#contri
+00001d70: 6275 746f 7273 295c 6e20 202a 205b 496e  butors)\n  * [In
+00001d80: 7374 616c 6c20 506f 6574 7279 5d28 2369  stall Poetry](#i
+00001d90: 6e73 7461 6c6c 2d70 6f65 7472 7929 5c6e  nstall-poetry)\n
+00001da0: 2020 2a20 5b53 6574 7570 2066 6f72 2050    * [Setup for P
+00001db0: 7943 6861 726d 2075 7365 7273 5d28 2373  yCharm users](#s
+00001dc0: 6574 7570 2d66 6f72 2d70 7963 6861 726d  etup-for-pycharm
+00001dd0: 2d75 7365 7273 295c 6e20 202a 205b 5365  -users)\n  * [Se
+00001de0: 7475 7020 6672 6f6d 2063 6f6d 6d61 6e64  tup from command
+00001df0: 206c 696e 655d 2823 7365 7475 702d 6672   line](#setup-fr
+00001e00: 6f6d 2d63 6f6d 6d61 6e64 2d6c 696e 6529  om-command-line)
+00001e10: 5c6e 2020 2a20 5b50 726f 6a65 6374 204d  \n  * [Project M
+00001e20: 616b 6566 696c 6520 636f 6d6d 616e 6473  akefile commands
+00001e30: 5d28 2370 726f 6a65 6374 2d6d 616b 6566  ](#project-makef
+00001e40: 696c 652d 636f 6d6d 616e 6473 295c 6e3c  ile-commands)\n<
+00001e50: 212d 2d20 544f 4320 2d2d 3e5c 6e5c 6e23  !-- TOC -->\n\n#
+00001e60: 2320 496e 7374 616c 6c20 7061 636b 6167  # Install packag
+00001e70: 655c 6e5c 6e49 7420 6973 2072 6563 6f6d  e\n\nIt is recom
+00001e80: 6d65 6e64 6564 2074 6f20 696e 7374 616c  mended to instal
+00001e90: 6c20 5079 7468 6f6e 2070 6163 6b61 6765  l Python package
+00001ea0: 7320 696e 746f 2061 2050 7974 686f 6e20  s into a Python 
+00001eb0: 7669 7274 7561 6c20 656e 7669 726f 6e6d  virtual environm
+00001ec0: 656e 742e 5c6e 5c6e 2323 2320 4672 6f6d  ent.\n\n### From
+00001ed0: 2050 7950 495c 6e5c 6e59 6f75 2063 616e   PyPI\n\nYou can
+00001ee0: 2075 7365 2070 6970 2074 6f20 696e 7374   use pip to inst
+00001ef0: 616c 6c20 7468 6973 2070 6163 6b61 6765  all this package
+00001f00: 2064 6972 6563 746c 7920 6672 6f6d 5c6e   directly from\n
+00001f10: 5b74 6865 2050 7974 686f 6e20 5061 636b  [the Python Pack
+00001f20: 6167 6520 496e 6465 785d 2868 7474 7073  age Index](https
+00001f30: 3a2f 2f70 7970 692e 6f72 672f 7072 6f6a  ://pypi.org/proj
+00001f40: 6563 742f 6573 6462 636c 6965 6e74 2f29  ect/esdbclient/)
+00001f50: 2e5c 6e5c 6e20 2020 2024 2070 6970 2069  .\n\n    $ pip i
+00001f60: 6e73 7461 6c6c 2065 7364 6263 6c69 656e  nstall esdbclien
+00001f70: 745c 6e5c 6e23 2323 2057 6974 6820 506f  t\n\n### With Po
+00001f80: 6574 7279 5c6e 5c6e 596f 7520 6361 6e20  etry\n\nYou can 
+00001f90: 7573 6520 506f 6574 7279 2074 6f20 6164  use Poetry to ad
+00001fa0: 6420 7468 6973 2070 6163 6b61 6765 2074  d this package t
+00001fb0: 6f20 796f 7572 2070 7970 726f 6a65 6374  o your pyproject
+00001fc0: 2e74 6f6d 6c20 616e 6420 696e 7374 616c  .toml and instal
+00001fd0: 6c20 6974 2e5c 6e5c 6e20 2020 2024 2070  l it.\n\n    $ p
+00001fe0: 6f65 7472 7920 6164 6420 6573 6462 636c  oetry add esdbcl
+00001ff0: 6965 6e74 5c6e 5c6e 2323 2045 7665 6e74  ient\n\n## Event
+00002000: 5374 6f72 6544 4220 7365 7276 6572 5c6e  StoreDB server\n
+00002010: 5c6e 5468 6520 4576 656e 7453 746f 7265  \nThe EventStore
+00002020: 4442 2073 6572 7665 7220 6361 6e20 6265  DB server can be
+00002030: 2072 756e 206c 6f63 616c 6c79 2075 7369   run locally usi
+00002040: 6e67 2074 6865 206f 6666 6963 6961 6c20  ng the official 
+00002050: 446f 636b 6572 2063 6f6e 7461 696e 6572  Docker container
+00002060: 2069 6d61 6765 2e5c 6e5c 6e23 2323 2052   image.\n\n### R
+00002070: 756e 2063 6f6e 7461 696e 6572 5c6e 5c6e  un container\n\n
+00002080: 466f 7220 6465 7665 6c6f 706d 656e 742c  For development,
+00002090: 2079 6f75 2063 616e 2072 756e 2061 2022   you can run a "
+000020a0: 7365 6375 7265 2220 4576 656e 7453 746f  secure" EventSto
+000020b0: 7265 4442 2073 6572 7665 7220 7573 696e  reDB server usin
+000020c0: 6720 7468 6520 666f 6c6c 6f77 696e 6720  g the following 
+000020d0: 636f 6d6d 616e 642e 5c6e 5c6e 2020 2020  command.\n\n    
+000020e0: 2420 646f 636b 6572 2072 756e 202d 6420  $ docker run -d 
+000020f0: 2d2d 6e61 6d65 2065 7665 6e74 7374 6f72  --name eventstor
+00002100: 6564 622d 7365 6375 7265 202d 6974 202d  edb-secure -it -
+00002110: 7020 3231 3133 3a32 3131 3320 2d2d 656e  p 2113:2113 --en
+00002120: 7620 2248 4f4d 453d 2f74 6d70 2220 6576  v "HOME=/tmp" ev
+00002130: 656e 7473 746f 7265 2f65 7665 6e74 7374  entstore/eventst
+00002140: 6f72 653a 3231 2e31 302e 392d 6275 7374  ore:21.10.9-bust
+00002150: 6572 2d73 6c69 6d20 2d2d 6465 765c 6e5c  er-slim --dev\n\
+00002160: 6e41 7320 7765 2077 696c 6c20 7365 652c  nAs we will see,
+00002170: 2074 6865 2063 6c69 656e 7420 6e65 6564   the client need
+00002180: 7320 616e 2045 7665 6e74 5374 6f72 6544  s an EventStoreD
+00002190: 4220 636f 6e6e 6563 7469 6f6e 2073 7472  B connection str
+000021a0: 696e 6720 5552 4920 6173 2074 6865 2076  ing URI as the v
+000021b0: 616c 7565 206f 665c 6e69 7473 2060 7572  alue of\nits `ur
+000021c0: 6960 2063 6f6e 7374 7275 6374 6f72 2061  i` constructor a
+000021d0: 7267 756d 656e 742e 2053 6565 2074 6865  rgument. See the
+000021e0: 204e 6f74 6573 2073 6563 7469 6f6e 2062   Notes section b
+000021f0: 656c 6f77 2066 6f72 2064 6574 6169 6c65  elow for detaile
+00002200: 6420 696e 666f 726d 6174 696f 6e5c 6e61  d information\na
+00002210: 626f 7574 2045 7665 6e74 5374 6f72 6544  bout EventStoreD
+00002220: 4220 636f 6e6e 6563 7469 6f6e 2073 7472  B connection str
+00002230: 696e 6720 5552 4973 2e5c 6e5c 6e54 6865  ing URIs.\n\nThe
+00002240: 2063 6f6e 6e65 6374 696f 6e20 7374 7269   connection stri
+00002250: 6e67 2066 6f72 2074 6869 7320 2273 6563  ng for this "sec
+00002260: 7572 6522 2045 7665 6e74 5374 6f72 6544  ure" EventStoreD
+00002270: 4220 7365 7276 6572 2077 6f75 6c64 2062  B server would b
+00002280: 653a 5c6e 5c6e 2020 2020 6573 6462 3a2f  e:\n\n    esdb:/
+00002290: 2f61 646d 696e 3a63 6861 6e67 6569 7440  /admin:changeit@
+000022a0: 6c6f 6361 6c68 6f73 743a 3231 3133 5c6e  localhost:2113\n
+000022b0: 5c6e 546f 2063 6f6e 6e65 6374 2074 6f20  \nTo connect to 
+000022c0: 6120 2273 6563 7572 6522 2073 6572 7665  a "secure" serve
+000022d0: 722c 2079 6f75 2077 696c 6c20 7573 7561  r, you will usua
+000022e0: 6c6c 7920 6e65 6564 2074 6f20 696e 636c  lly need to incl
+000022f0: 7564 6520 6120 2275 7365 726e 616d 6522  ude a "username"
+00002300: 5c6e 616e 6420 6120 2270 6173 7377 6f72  \nand a "passwor
+00002310: 6422 2069 6e20 7468 6520 636f 6e6e 6563  d" in the connec
+00002320: 7469 6f6e 2073 7472 696e 672c 2073 6f20  tion string, so 
+00002330: 7468 6174 2074 6865 2073 6572 7665 7220  that the server 
+00002340: 6361 6e20 6175 7468 656e 7469 6361 7465  can authenticate
+00002350: 2074 6865 5c6e 636c 6965 6e74 2e20 5468   the\nclient. Th
+00002360: 6520 6465 6661 756c 7420 7573 6572 6e61  e default userna
+00002370: 6d65 2069 7320 2261 646d 696e 2220 616e  me is "admin" an
+00002380: 6420 7468 6520 6465 6661 756c 7420 7061  d the default pa
+00002390: 7373 776f 7264 2069 7320 2263 6861 6e67  ssword is "chang
+000023a0: 6569 7422 2e5c 6e5c 6e57 6865 6e20 636f  eit".\n\nWhen co
+000023b0: 6e6e 6563 7469 6e67 2074 6f20 6120 2273  nnecting to a "s
+000023c0: 6563 7572 6522 2073 6572 7665 722c 2074  ecure" server, t
+000023d0: 6865 2063 6c69 656e 7420 616c 736f 206e  he client also n
+000023e0: 6565 6473 2061 6e20 5353 4c2f 544c 535c  eeds an SSL/TLS\
+000023f0: 6e63 6572 7469 6669 6361 7465 2061 7320  ncertificate as 
+00002400: 7468 6520 7661 6c75 6520 6f66 2069 7473  the value of its
+00002410: 2060 726f 6f74 5f63 6572 7469 6669 6361   `root_certifica
+00002420: 7465 7360 2063 6f6e 7374 7275 6374 6f72  tes` constructor
+00002430: 2061 7267 756d 656e 742e 2054 6f20 636f   argument. To co
+00002440: 6e6e 6563 745c 6e74 6f20 6120 2273 6563  nnect\nto a "sec
+00002450: 7572 6522 2073 6572 7665 7220 796f 7520  ure" server you 
+00002460: 7769 6c6c 206e 6565 6420 616e 2053 534c  will need an SSL
+00002470: 2f54 4c53 2063 6572 7469 6669 6361 7465  /TLS certificate
+00002480: 2073 6f20 7468 6174 2074 6865 2063 6c69   so that the cli
+00002490: 656e 7420 6361 6e5c 6e61 7574 6865 6e74  ent can\nauthent
+000024a0: 6963 6174 6520 7468 6520 7365 7276 6572  icate the server
+000024b0: 2e20 466f 7220 6465 7665 6c6f 706d 656e  . For developmen
+000024c0: 742c 2079 6f75 2063 616e 2065 6974 6865  t, you can eithe
+000024d0: 7220 7573 6520 7468 6520 5353 4c2f 544c  r use the SSL/TL
+000024e0: 5320 6365 7274 6966 6963 6174 655c 6e6f  S certificate\no
+000024f0: 6620 7468 6520 6365 7274 6966 6963 6174  f the certificat
+00002500: 6520 6175 7468 6f72 6974 7920 7573 6564  e authority used
+00002510: 2074 6f20 6372 6561 7465 2074 6865 2073   to create the s
+00002520: 6572 7665 725c 2773 2063 6572 7469 6669  erver\'s certifi
+00002530: 6361 7465 2c20 6f72 2077 6865 6e20 7573  cate, or when us
+00002540: 696e 6720 615c 6e73 696e 676c 652d 6e6f  ing a\nsingle-no
+00002550: 6465 2063 6c75 7374 6572 2c20 796f 7520  de cluster, you 
+00002560: 6361 6e20 7573 6520 7468 6520 7365 7276  can use the serv
+00002570: 6572 2063 6572 7469 6669 6361 7465 2069  er certificate i
+00002580: 7473 656c 662e 2059 6f75 2063 616e 2067  tself. You can g
+00002590: 6574 2074 6865 5c6e 7365 7276 6572 2063  et the\nserver c
+000025a0: 6572 7469 6669 6361 7465 2077 6974 6820  ertificate with 
+000025b0: 7468 6520 666f 6c6c 6f77 696e 6720 5079  the following Py
+000025c0: 7468 6f6e 2063 6f64 652e 5c6e 5c6e 5c6e  thon code.\n\n\n
+000025d0: 6060 6070 7974 686f 6e5c 6e69 6d70 6f72  ```python\nimpor
+000025e0: 7420 7373 6c5c 6e5c 6e73 6572 7665 725f  t ssl\n\nserver_
+000025f0: 6365 7274 6966 6963 6174 6520 3d20 7373  certificate = ss
+00002600: 6c2e 6765 745f 7365 7276 6572 5f63 6572  l.get_server_cer
+00002610: 7469 6669 6361 7465 2861 6464 723d 285c  tificate(addr=(\
+00002620: 276c 6f63 616c 686f 7374 5c27 2c20 3231  'localhost\', 21
+00002630: 3133 2929 5c6e 6060 605c 6e5c 6e59 6f75  13))\n```\n\nYou
+00002640: 2063 616e 2061 6c73 6f20 7374 6172 7420   can also start 
+00002650: 616e 2022 696e 7365 6375 7265 2220 7365  an "insecure" se
+00002660: 7276 6572 2075 7369 6e67 2074 6865 2066  rver using the f
+00002670: 6f6c 6c6f 7769 6e67 2063 6f6d 6d61 6e64  ollowing command
+00002680: 2e5c 6e5c 6e20 2020 2024 2064 6f63 6b65  .\n\n    $ docke
+00002690: 7220 7275 6e20 2d64 202d 2d6e 616d 6520  r run -d --name 
+000026a0: 6576 656e 7473 746f 7265 6462 2d69 6e73  eventstoredb-ins
+000026b0: 6563 7572 6520 2d69 7420 2d70 2032 3131  ecure -it -p 211
+000026c0: 343a 3231 3133 2065 7665 6e74 7374 6f72  4:2113 eventstor
+000026d0: 652f 6576 656e 7473 746f 7265 3a32 312e  e/eventstore:21.
+000026e0: 3130 2e39 2d62 7573 7465 722d 736c 696d  10.9-buster-slim
+000026f0: 202d 2d69 6e73 6563 7572 655c 6e5c 6e54   --insecure\n\nT
+00002700: 6865 2063 6f6e 6e65 6374 696f 6e20 7374  he connection st
+00002710: 7269 6e67 2055 5249 2066 6f72 2074 6869  ring URI for thi
+00002720: 7320 2269 6e73 6563 7572 6522 2073 6572  s "insecure" ser
+00002730: 7665 7220 776f 756c 6420 6265 3a5c 6e5c  ver would be:\n\
+00002740: 6e20 2020 2065 7364 623a 2f2f 6c6f 6361  n    esdb://loca
+00002750: 6c68 6f73 743a 3231 3134 3f54 6c73 3d66  lhost:2114?Tls=f
+00002760: 616c 7365 5c6e 5c6e 4173 2077 6520 7769  alse\n\nAs we wi
+00002770: 6c6c 2073 6565 2c20 7768 656e 2063 6f6e  ll see, when con
+00002780: 6e65 6374 696e 6720 746f 2061 6e20 2269  necting to an "i
+00002790: 6e73 6563 7572 6522 2073 6572 7665 722c  nsecure" server,
+000027a0: 2074 6865 7265 2069 7320 6e6f 206e 6565   there is no nee
+000027b0: 6420 746f 2069 6e63 6c75 6465 5c6e 6120  d to include\na 
+000027c0: 2275 7365 726e 616d 6522 2061 6e64 2061  "username" and a
+000027d0: 2022 7061 7373 776f 7264 2220 696e 2074   "password" in t
+000027e0: 6865 2063 6f6e 6e65 6374 696f 6e20 7374  he connection st
+000027f0: 7269 6e67 2e20 4966 2079 6f75 2064 6f2c  ring. If you do,
+00002800: 2074 6865 7365 2076 616c 7565 7320 7769   these values wi
+00002810: 6c6c 5c6e 6265 2069 676e 6f72 6564 2062  ll\nbe ignored b
+00002820: 7920 7468 6520 636c 6965 6e74 2c20 736f  y the client, so
+00002830: 2074 6861 7420 7468 6579 2077 696c 6c20   that they will 
+00002840: 6e6f 7420 6265 2073 656e 7420 746f 2074  not be sent to t
+00002850: 6865 2073 6572 7665 7220 6f76 6572 2061  he server over a
+00002860: 6e5c 6e69 6e73 6563 7572 6520 6368 616e  n\ninsecure chan
+00002870: 6e65 6c2e 5c6e 5c6e 506c 6561 7365 206e  nel.\n\nPlease n
+00002880: 6f74 652c 2074 6865 2022 696e 7365 6375  ote, the "insecu
+00002890: 7265 2220 636f 6e6e 6563 7469 6f6e 2073  re" connection s
+000028a0: 7472 696e 6720 7573 6573 2061 2071 7565  tring uses a que
+000028b0: 7279 2073 7472 696e 6720 7769 7468 2074  ry string with t
+000028c0: 6865 2066 6965 6c64 2d76 616c 7565 5c6e  he field-value\n
+000028d0: 6054 6c73 3d66 616c 7365 602e 2054 6865  `Tls=false`. The
+000028e0: 2076 616c 7565 206f 6620 7468 6973 2066   value of this f
+000028f0: 6965 6c64 2069 7320 6279 2064 6566 6175  ield is by defau
+00002900: 6c74 2060 7472 7565 602e 2053 6565 2074  lt `true`. See t
+00002910: 6865 204e 6f74 6573 2073 6563 7469 6f6e  he Notes section
+00002920: 2062 656c 6f77 5c6e 666f 7220 6d6f 7265   below\nfor more
+00002930: 2069 6e66 6f72 6d61 7469 6f6e 2061 626f   information abo
+00002940: 7574 2045 7665 6e74 5374 6f72 6544 4220  ut EventStoreDB 
+00002950: 636f 6e6e 6563 7469 6f6e 2073 7472 696e  connection strin
+00002960: 6773 2061 6e64 2074 6865 2066 6965 6c64  gs and the field
+00002970: 7320 7468 6174 2063 616e 2062 655c 6e75  s that can be\nu
+00002980: 7365 6420 696e 2074 6865 2071 7565 7279  sed in the query
+00002990: 2073 7472 696e 6720 746f 2073 7065 6369   string to speci
+000029a0: 6679 2063 6f6e 6e65 6374 696f 6e20 6f70  fy connection op
+000029b0: 7469 6f6e 732e 5c6e 5c6e 2323 2320 5374  tions.\n\n### St
+000029c0: 6f70 2063 6f6e 7461 696e 6572 5c6e 5c6e  op container\n\n
+000029d0: 546f 2073 746f 7020 616e 6420 7265 6d6f  To stop and remo
+000029e0: 7665 2074 6865 2022 7365 6375 7265 2220  ve the "secure" 
+000029f0: 636f 6e74 6169 6e65 722c 2075 7365 2074  container, use t
+00002a00: 6865 2066 6f6c 6c6f 7769 6e67 2044 6f63  he following Doc
+00002a10: 6b65 7220 636f 6d6d 616e 6473 2e5c 6e5c  ker commands.\n\
+00002a20: 6e20 2020 2024 2064 6f63 6b65 7220 7374  n    $ docker st
+00002a30: 6f70 2065 7665 6e74 7374 6f72 6564 622d  op eventstoredb-
+00002a40: 7365 6375 7265 5c6e 5c74 2420 646f 636b  secure\n\t$ dock
+00002a50: 6572 2072 6d20 6576 656e 7473 746f 7265  er rm eventstore
+00002a60: 6462 2d73 6563 7572 655c 6e5c 6e54 6f20  db-secure\n\nTo 
+00002a70: 7374 6f70 2061 6e64 2072 656d 6f76 6520  stop and remove 
+00002a80: 7468 6520 2269 6e73 6563 7572 6522 2063  the "insecure" c
+00002a90: 6f6e 7461 696e 6572 2c20 7573 6520 7468  ontainer, use th
+00002aa0: 6520 666f 6c6c 6f77 696e 6720 446f 636b  e following Dock
+00002ab0: 6572 2063 6f6d 6d61 6e64 732e 5c6e 5c6e  er commands.\n\n
+00002ac0: 2020 2020 2420 646f 636b 6572 2073 746f      $ docker sto
+00002ad0: 7020 6576 656e 7473 746f 7265 6462 2d69  p eventstoredb-i
+00002ae0: 6e73 6563 7572 655c 6e5c 7424 2064 6f63  nsecure\n\t$ doc
+00002af0: 6b65 7220 726d 2065 7665 6e74 7374 6f72  ker rm eventstor
+00002b00: 6564 622d 696e 7365 6375 7265 5c6e 5c6e  edb-insecure\n\n
+00002b10: 5c6e 2323 2045 7665 6e74 5374 6f72 6544  \n## EventStoreD
+00002b20: 4220 636c 6965 6e74 5c6e 5c6e 5468 6973  B client\n\nThis
+00002b30: 2045 7665 6e74 5374 6f72 6544 4220 636c   EventStoreDB cl
+00002b40: 6965 6e74 2069 7320 696d 706c 656d 656e  ient is implemen
+00002b50: 7465 6420 696e 2074 6865 2060 6573 6462  ted in the `esdb
+00002b60: 636c 6965 6e74 6020 7061 636b 6167 6520  client` package 
+00002b70: 7769 7468 5c6e 7468 6520 6045 5344 4243  with\nthe `ESDBC
+00002b80: 6c69 656e 7460 2063 6c61 7373 2e5c 6e5c  lient` class.\n\
+00002b90: 6e23 2323 2049 6d70 6f72 7420 636c 6173  n### Import clas
+00002ba0: 735c 6e5c 6e54 6865 2060 4553 4442 436c  s\n\nThe `ESDBCl
+00002bb0: 6965 6e74 6020 636c 6173 7320 6361 6e20  ient` class can 
+00002bc0: 6265 2069 6d70 6f72 7465 6420 6672 6f6d  be imported from
+00002bd0: 2074 6865 2060 6573 6462 636c 6965 6e74   the `esdbclient
+00002be0: 6020 7061 636b 6167 652e 5c6e 5c6e 6060  ` package.\n\n``
+00002bf0: 6070 7974 686f 6e5c 6e66 726f 6d20 6573  `python\nfrom es
+00002c00: 6462 636c 6965 6e74 2069 6d70 6f72 7420  dbclient import 
+00002c10: 4553 4442 436c 6965 6e74 5c6e 6060 605c  ESDBClient\n```\
+00002c20: 6e5c 6e23 2323 2043 6f6e 7374 7275 6374  n\n### Construct
+00002c30: 2063 6c69 656e 745c 6e5c 6e54 6865 2060   client\n\nThe `
+00002c40: 4553 4442 436c 6965 6e74 6020 636c 6173  ESDBClient` clas
+00002c50: 7320 6361 6e20 6265 2063 6f6e 7374 7275  s can be constru
+00002c60: 6374 6564 2077 6974 6820 6120 6075 7269  cted with a `uri
+00002c70: 6020 6172 6775 6d65 6e74 2c20 7768 6963  ` argument, whic
+00002c80: 6820 6973 2072 6571 7569 7265 642e 5c6e  h is required.\n
+00002c90: 416e 642c 2074 6f20 636f 6e6e 6563 7420  And, to connect 
+00002ca0: 746f 2061 2022 7365 6375 7265 2220 4576  to a "secure" Ev
+00002cb0: 656e 7453 746f 7265 4442 2073 6572 7665  entStoreDB serve
+00002cc0: 722c 2074 6865 206f 7074 696f 6e61 6c20  r, the optional 
+00002cd0: 6072 6f6f 745f 6365 7274 6966 6963 6174  `root_certificat
+00002ce0: 6573 605c 6e61 7267 756d 656e 7420 6973  es`\nargument is
+00002cf0: 2061 6c73 6f20 7265 7175 6972 6564 2e5c   also required.\
+00002d00: 6e5c 6e54 6865 2060 7572 6960 2061 7267  n\nThe `uri` arg
+00002d10: 756d 656e 7420 6973 2065 7870 6563 7465  ument is expecte
+00002d20: 6420 746f 2062 6520 616e 2045 7665 6e74  d to be an Event
+00002d30: 5374 6f72 6544 4220 636f 6e6e 6563 7469  StoreDB connecti
+00002d40: 6f6e 2073 7472 696e 6720 5552 4920 7468  on string URI th
+00002d50: 6174 5c6e 636f 6e66 6f72 6d73 2077 6974  at\nconforms wit
+00002d60: 6820 7468 6520 7374 616e 6461 7264 2045  h the standard E
+00002d70: 7665 6e74 5374 6f72 6544 4220 2265 7364  ventStoreDB "esd
+00002d80: 6222 206f 7220 2265 7364 622b 6469 7363  b" or "esdb+disc
+00002d90: 6f76 6572 2220 5552 4920 7363 6865 6d65  over" URI scheme
+00002da0: 732e 2054 6865 5c6e 7379 6e74 6178 2061  s. The\nsyntax a
+00002db0: 6e64 2073 656d 616e 7469 6373 206f 6620  nd semantics of 
+00002dc0: 4576 656e 7453 746f 7265 4442 2063 6f6e  EventStoreDB con
+00002dd0: 6e65 6374 696f 6e20 7374 7269 6e67 7320  nection strings 
+00002de0: 6172 6520 6578 706c 6169 6e65 6420 696e  are explained in
+00002df0: 2074 6865 204e 6f74 6573 5c6e 7365 6374   the Notes\nsect
+00002e00: 696f 6e20 6265 6c6f 772e 5c6e 5c6e 466f  ion below.\n\nFo
+00002e10: 7220 6578 616d 706c 652c 2074 6865 2066  r example, the f
+00002e20: 6f6c 6c6f 7769 6e67 2063 6f6e 6e65 6374  ollowing connect
+00002e30: 696f 6e20 7374 7269 6e67 2073 7065 6369  ion string speci
+00002e40: 6669 6573 2074 6861 7420 7468 6520 636c  fies that the cl
+00002e50: 6965 6e74 2073 686f 756c 645c 6e61 7474  ient should\natt
+00002e60: 656d 7074 2074 6f20 6372 6561 7465 2061  empt to create a
+00002e70: 2022 7365 6375 7265 2220 636f 6e6e 6563   "secure" connec
+00002e80: 7469 6f6e 2074 6f20 706f 7274 2032 3131  tion to port 211
+00002e90: 3320 6f6e 2022 6c6f 6361 6c68 6f73 7422  3 on "localhost"
+00002ea0: 2c20 616e 6420 7573 6520 7468 655c 6e63  , and use the\nc
+00002eb0: 6c69 656e 7420 6372 6564 656e 7469 616c  lient credential
+00002ec0: 7320 2275 7365 726e 616d 6522 2061 6e64  s "username" and
+00002ed0: 2022 7061 7373 776f 7264 2220 7768 656e   "password" when
+00002ee0: 206d 616b 696e 6720 6361 6c6c 7320 746f   making calls to
+00002ef0: 2074 6865 2073 6572 7665 722e 5c6e 5c6e   the server.\n\n
+00002f00: 2020 2020 6573 6462 3a2f 2f75 7365 726e      esdb://usern
+00002f10: 616d 653a 7061 7373 776f 7264 406c 6f63  ame:password@loc
+00002f20: 616c 686f 7374 3a32 3131 333f 546c 733d  alhost:2113?Tls=
+00002f30: 7472 7565 5c6e 5c6e 5468 6520 636c 6965  true\n\nThe clie
+00002f40: 6e74 206d 7573 7420 6265 2063 6f6e 6669  nt must be confi
+00002f50: 6775 7265 6420 746f 2063 7265 6174 6520  gured to create 
+00002f60: 6120 2273 6563 7572 6522 2063 6f6e 6e65  a "secure" conne
+00002f70: 6374 696f 6e20 746f 2061 2022 7365 6375  ction to a "secu
+00002f80: 7265 2220 7365 7276 6572 2c5c 6e6f 7220  re" server,\nor 
+00002f90: 616c 7465 726e 6174 6976 656c 7920 616e  alternatively an
+00002fa0: 2022 696e 7365 6375 7265 2220 636f 6e6e   "insecure" conn
+00002fb0: 6563 7469 6f6e 2074 6f20 616e 2022 696e  ection to an "in
+00002fc0: 7365 6375 7265 2220 7365 7276 6572 2e20  secure" server. 
+00002fd0: 4279 2064 6566 6175 6c74 2c20 7468 655c  By default, the\
+00002fe0: 6e63 6c69 656e 7420 7769 6c6c 2061 7474  nclient will att
+00002ff0: 656d 7074 2074 6f20 6372 6561 7465 2061  empt to create a
+00003000: 2022 7365 6375 7265 2220 636f 6e6e 6563   "secure" connec
+00003010: 7469 6f6e 2e20 416e 6420 736f 2c20 7768  tion. And so, wh
+00003020: 656e 2063 6f6e 6e65 6374 696e 6720 746f  en connecting to
+00003030: 2061 6e5c 6e22 696e 7365 6375 7265 2220   an\n"insecure" 
+00003040: 7365 7276 6572 2c20 7468 6520 636f 6e6e  server, the conn
+00003050: 6563 7469 6f6e 2073 7472 696e 6720 6d75  ection string mu
+00003060: 7374 2073 7065 6369 6679 2074 6861 7420  st specify that 
+00003070: 7468 6520 636c 6965 6e74 2073 686f 756c  the client shoul
+00003080: 6420 6174 7465 6d70 745c 6e74 6f20 6d61  d attempt\nto ma
+00003090: 6b65 2061 6e20 2269 6e73 6563 7572 6522  ke an "insecure"
+000030a0: 2063 6f6e 6e65 6374 696f 6e2e 5c6e 5c6e   connection.\n\n
+000030b0: 5468 6520 666f 6c6c 6f77 696e 6720 636f  The following co
+000030c0: 6e6e 6563 7469 6f6e 2073 7472 696e 6720  nnection string 
+000030d0: 7370 6563 6966 6965 7320 7468 6174 2074  specifies that t
+000030e0: 6865 2063 6c69 656e 7420 7368 6f75 6c64  he client should
+000030f0: 5c6e 6174 7465 6d70 7420 746f 2063 7265  \nattempt to cre
+00003100: 6174 6520 616e 2022 696e 7365 6375 7265  ate an "insecure
+00003110: 2220 636f 6e6e 6563 7469 6f6e 2074 6f20  " connection to 
+00003120: 706f 7274 2032 3131 3420 6f6e 2022 6c6f  port 2114 on "lo
+00003130: 6361 6c68 6f73 7422 2e5c 6e57 6865 6e20  calhost".\nWhen 
+00003140: 636f 6e6e 6563 7469 6e67 2074 6f20 616e  connecting to an
+00003150: 2022 696e 7365 6375 7265 2220 7365 7276   "insecure" serv
+00003160: 6572 2c20 7468 6520 636c 6965 6e74 2077  er, the client w
+00003170: 696c 6c20 6967 6e6f 7265 2061 6e79 5c6e  ill ignore any\n
+00003180: 7573 6572 6e61 6d65 2061 6e64 2070 6173  username and pas
+00003190: 7377 6f72 6420 696e 666f 726d 6174 696f  sword informatio
+000031a0: 6e20 696e 636c 7564 6564 2069 6e20 7468  n included in th
+000031b0: 6520 636f 6e6e 6563 7469 6f6e 2073 7472  e connection str
+000031c0: 696e 672c 5c6e 736f 2074 6861 7420 7573  ing,\nso that us
+000031d0: 6572 6e61 6d65 7320 616e 6420 7061 7373  ernames and pass
+000031e0: 776f 7264 7320 6172 6520 6e6f 7420 7365  words are not se
+000031f0: 6e74 206f 7665 7220 616e 2022 696e 7365  nt over an "inse
+00003200: 6375 7265 2220 636f 6e6e 6563 7469 6f6e  cure" connection
+00003210: 2e5c 6e5c 6e20 2020 2065 7364 623a 2f2f  .\n\n    esdb://
+00003220: 6c6f 6361 6c68 6f73 743a 3231 3134 3f54  localhost:2114?T
+00003230: 6c73 3d66 616c 7365 5c6e 5c6e 506c 6561  ls=false\n\nPlea
+00003240: 7365 206e 6f74 652c 2074 6865 2022 696e  se note, the "in
+00003250: 7365 6375 7265 2220 636f 6e6e 6563 7469  secure" connecti
+00003260: 6f6e 2073 7472 696e 6720 7573 6573 2061  on string uses a
+00003270: 2071 7565 7279 2073 7472 696e 6720 7769   query string wi
+00003280: 7468 2074 6865 2066 6965 6c64 2d76 616c  th the field-val
+00003290: 7565 5c6e 6054 6c73 3d66 616c 7365 602e  ue\n`Tls=false`.
+000032a0: 2054 6865 2076 616c 7565 206f 6620 7468   The value of th
+000032b0: 6973 2066 6965 6c64 2069 7320 6279 2064  is field is by d
+000032c0: 6566 6175 6c74 2060 7472 7565 602e 2055  efault `true`. U
+000032d0: 6e6c 6573 7320 7468 6520 636f 6e6e 6563  nless the connec
+000032e0: 7469 6f6e 2073 7472 696e 675c 6e55 5249  tion string\nURI
+000032f0: 2069 6e63 6c75 6465 7320 7468 6520 6669   includes the fi
+00003300: 656c 642d 7661 6c75 6520 6054 6c73 3d66  eld-value `Tls=f
+00003310: 616c 7365 6020 696e 2074 6865 2071 7565  alse` in the que
+00003320: 7279 2073 7472 696e 672c 2074 6865 2060  ry string, the `
+00003330: 726f 6f74 5f63 6572 7469 6669 6361 7465  root_certificate
+00003340: 7360 5c6e 636f 6e73 7472 7563 746f 7220  s`\nconstructor 
+00003350: 6172 6775 6d65 6e74 2069 7320 616c 736f  argument is also
+00003360: 2072 6571 7569 7265 642e 5c6e 5c6e 5768   required.\n\nWh
+00003370: 656e 2063 6f6e 6e65 6374 696e 6720 746f  en connecting to
+00003380: 2061 2022 7365 6375 7265 2220 7365 7276   a "secure" serv
+00003390: 6572 2c20 7468 6520 6072 6f6f 745f 6365  er, the `root_ce
+000033a0: 7274 6966 6963 6174 6573 6020 6172 6775  rtificates` argu
+000033b0: 6d65 6e74 2069 7320 6578 7065 6374 6564  ment is expected
+000033c0: 2074 6f5c 6e62 6520 6120 5079 7468 6f6e   to\nbe a Python
+000033d0: 2060 7374 7260 2063 6f6e 7461 696e 696e   `str` containin
+000033e0: 6720 5045 4d20 656e 636f 6465 6420 5353  g PEM encoded SS
+000033f0: 4c2f 544c 5320 726f 6f74 2063 6572 7469  L/TLS root certi
+00003400: 6669 6361 7465 732e 2054 6869 7320 7661  ficates. This va
+00003410: 6c75 6520 6973 5c6e 7061 7373 6564 2064  lue is\npassed d
+00003420: 6972 6563 746c 7920 746f 2060 6772 7063  irectly to `grpc
+00003430: 2e73 736c 5f63 6861 6e6e 656c 5f63 7265  .ssl_channel_cre
+00003440: 6465 6e74 6961 6c73 2829 602e 2049 7420  dentials()`. It 
+00003450: 6973 2075 7365 6420 666f 7220 6175 7468  is used for auth
+00003460: 656e 7469 6361 7469 6e67 2074 6865 5c6e  enticating the\n
+00003470: 7365 7276 6572 2074 6f20 7468 6520 636c  server to the cl
+00003480: 6965 6e74 2e20 4974 2069 7320 636f 6d6d  ient. It is comm
+00003490: 6f6e 6c79 2074 6865 2063 6572 7469 6669  only the certifi
+000034a0: 6361 7465 206f 6620 7468 6520 6365 7274  cate of the cert
+000034b0: 6966 6963 6174 6520 6175 7468 6f72 6974  ificate authorit
+000034c0: 7920 7468 6174 5c6e 7761 7320 7265 7370  y that\nwas resp
+000034d0: 6f6e 7369 626c 6520 666f 7220 6765 6e65  onsible for gene
+000034e0: 7261 7469 6e67 2074 6865 2053 534c 2f54  rating the SSL/T
+000034f0: 4c53 2063 6572 7469 6669 6361 7465 2075  LS certificate u
+00003500: 7365 6420 6279 2074 6865 2045 7665 6e74  sed by the Event
+00003510: 5374 6f72 6544 4220 7365 7276 6572 2e5c  StoreDB server.\
+00003520: 6e42 7574 2c20 616c 7465 726e 6174 6976  nBut, alternativ
+00003530: 656c 7920 666f 7220 6465 7665 6c6f 706d  ely for developm
+00003540: 656e 742c 2079 6f75 2063 616e 2075 7365  ent, you can use
+00003550: 2074 6865 2073 6572 7665 725c 2773 2063   the server\'s c
+00003560: 6572 7469 6669 6361 7465 2069 7473 656c  ertificate itsel
+00003570: 662e 5c6e 5c6e 496e 2074 6865 2065 7861  f.\n\nIn the exa
+00003580: 6d70 6c65 2062 656c 6f77 2c20 7468 6520  mple below, the 
+00003590: 636f 6e73 7472 7563 746f 7220 6172 6775  constructor argu
+000035a0: 6d65 6e74 2076 616c 7565 7320 6172 6520  ment values are 
+000035b0: 7461 6b65 6e20 6672 6f6d 2074 6865 206f  taken from the o
+000035c0: 7065 7261 7469 6e67 5c6e 7379 7374 656d  perating\nsystem
+000035d0: 2065 6e76 6972 6f6e 6d65 6e74 2e20 5468   environment. Th
+000035e0: 6973 2069 7320 6120 7479 7069 6361 6c20  is is a typical 
+000035f0: 6172 7261 6e67 656d 656e 7420 696e 2061  arrangement in a
+00003600: 2070 726f 6475 6374 696f 6e20 656e 7669   production envi
+00003610: 726f 6e6d 656e 742e 2049 7420 6973 5c6e  ronment. It is\n
+00003620: 646f 6e65 2074 6869 7320 7761 7920 6865  done this way he
+00003630: 7265 2073 6f20 7468 6174 2074 6865 2063  re so that the c
+00003640: 6f64 6520 696e 2074 6869 7320 646f 6375  ode in this docu
+00003650: 6d65 6e74 6174 696f 6e20 6361 6e20 6265  mentation can be
+00003660: 2074 6573 7465 6420 7769 7468 2062 6f74   tested with bot
+00003670: 685c 6e61 2022 7365 6375 7265 2220 616e  h\na "secure" an
+00003680: 6420 616e 2022 696e 7365 6375 7265 2220  d an "insecure" 
+00003690: 7365 7276 6572 2e5c 6e5c 6e60 6060 7079  server.\n\n```py
+000036a0: 7468 6f6e 5c6e 696d 706f 7274 206f 735c  thon\nimport os\
+000036b0: 6e5c 6e63 6c69 656e 7420 3d20 4553 4442  n\nclient = ESDB
+000036c0: 436c 6965 6e74 285c 6e20 2020 2075 7269  Client(\n    uri
+000036d0: 3d6f 732e 6765 7465 6e76 2822 4553 4442  =os.getenv("ESDB
+000036e0: 5f55 5249 2229 2c5c 6e20 2020 2072 6f6f  _URI"),\n    roo
+000036f0: 745f 6365 7274 6966 6963 6174 6573 3d6f  t_certificates=o
+00003700: 732e 6765 7465 6e76 2822 4553 4442 5f52  s.getenv("ESDB_R
+00003710: 4f4f 545f 4345 5254 4946 4943 4154 4553  OOT_CERTIFICATES
+00003720: 2229 2c5c 6e29 5c6e 6060 605c 6e5c 6e53  "),\n)\n```\n\nS
+00003730: 6565 2074 6865 204e 6f74 6573 2073 6563  ee the Notes sec
+00003740: 7469 6f6e 2062 656c 6f77 2066 6f72 2064  tion below for d
+00003750: 6574 6169 6c65 6420 696e 666f 726d 6174  etailed informat
+00003760: 696f 6e20 6162 6f75 7420 4576 656e 7453  ion about EventS
+00003770: 746f 7265 4442 2063 6f6e 6e65 6374 696f  toreDB connectio
+00003780: 6e5c 6e73 7472 696e 6773 2061 6e64 2074  n\nstrings and t
+00003790: 6865 2066 6965 6c64 7320 7468 6174 2063  he fields that c
+000037a0: 616e 2062 6520 7573 6564 2069 6e20 7468  an be used in th
+000037b0: 6520 7175 6572 7920 7374 7269 6e67 2074  e query string t
+000037c0: 6f20 7370 6563 6966 7920 636f 6e6e 6563  o specify connec
+000037d0: 7469 6f6e 5c6e 6f70 7469 6f6e 732e 5c6e  tion\noptions.\n
+000037e0: 5c6e 2323 2053 7472 6561 6d73 5c6e 5c6e  \n## Streams\n\n
+000037f0: 496e 2045 7665 6e74 5374 6f72 6544 422c  In EventStoreDB,
+00003800: 2061 2022 7374 7265 616d 2220 6973 2061   a "stream" is a
+00003810: 2073 6571 7565 6e63 6520 6f66 2072 6563   sequence of rec
+00003820: 6f72 6465 6420 6576 656e 7473 2074 6861  orded events tha
+00003830: 7420 616c 6c20 6861 7665 5c6e 7468 6520  t all have\nthe 
+00003840: 7361 6d65 2022 7374 7265 616d 206e 616d  same "stream nam
+00003850: 6522 2e20 5468 6572 6520 7769 6c6c 206e  e". There will n
+00003860: 6f72 6d61 6c6c 7920 6265 206d 616e 7920  ormally be many 
+00003870: 7374 7265 616d 7320 696e 2061 2064 6174  streams in a dat
+00003880: 6162 6173 652e 5c6e 4561 6368 2072 6563  abase.\nEach rec
+00003890: 6f72 6465 6420 6576 656e 7420 6861 7320  orded event has 
+000038a0: 6120 2273 7472 6561 6d20 706f 7369 7469  a "stream positi
+000038b0: 6f6e 2220 696e 2069 7473 2073 7472 6561  on" in its strea
+000038c0: 6d2c 2061 6e64 2061 2022 636f 6d6d 6974  m, and a "commit
+000038d0: 2070 6f73 6974 696f 6e22 5c6e 696e 2074   position"\nin t
+000038e0: 6865 2064 6174 6162 6173 652e 2054 6865  he database. The
+000038f0: 2073 7472 6561 6d20 706f 7369 7469 6f6e   stream position
+00003900: 7320 6f66 2074 6865 2072 6563 6f72 6465  s of the recorde
+00003910: 6420 6576 656e 7473 2069 6e20 6120 7374  d events in a st
+00003920: 7265 616d 2069 7320 6120 6761 706c 6573  ream is a gaples
+00003930: 735c 6e73 6571 7565 6e63 6520 7374 6172  s\nsequence star
+00003940: 7469 6e67 2066 726f 6d20 7a65 726f 2e20  ting from zero. 
+00003950: 5468 6520 636f 6d6d 6974 2070 6f73 6974  The commit posit
+00003960: 696f 6e73 206f 6620 7468 6520 7265 636f  ions of the reco
+00003970: 7264 6564 2065 7665 6e74 7320 696e 2074  rded events in t
+00003980: 6865 2064 6174 6162 6173 655c 6e66 6f72  he database\nfor
+00003990: 6d20 6120 7365 7175 656e 6365 2074 6861  m a sequence tha
+000039a0: 7420 6973 206e 6f74 2067 6170 6c65 7373  t is not gapless
+000039b0: 2e5c 6e5c 6e54 6865 206d 6574 686f 6473  .\n\nThe methods
+000039c0: 2060 6170 7065 6e64 5f65 7665 6e74 7328   `append_events(
+000039d0: 2960 2c20 6072 6561 645f 7374 7265 616d  )`, `read_stream
+000039e0: 5f65 7665 6e74 7328 2960 2061 6e64 2060  _events()` and `
+000039f0: 7265 6164 5f61 6c6c 5f65 7665 6e74 7328  read_all_events(
+00003a00: 2960 2063 616e 5c6e 6265 2075 7365 6420  )` can\nbe used 
+00003a10: 746f 2072 6563 6f72 6420 616e 6420 7265  to record and re
+00003a20: 6164 2065 7665 6e74 7320 696e 2074 6865  ad events in the
+00003a30: 2064 6174 6162 6173 652e 5c6e 5c6e 2323   database.\n\n##
+00003a40: 2320 4170 7065 6e64 2065 7665 6e74 735c  # Append events\
+00003a50: 6e5c 6e2a 7265 7175 6972 6573 206c 6561  n\n*requires lea
+00003a60: 6465 722a 5c6e 5c6e 5468 6520 6061 7070  der*\n\nThe `app
+00003a70: 656e 645f 6576 656e 7473 2829 6020 6d65  end_events()` me
+00003a80: 7468 6f64 2063 616e 2062 6520 7573 6564  thod can be used
+00003a90: 2074 6f20 7772 6974 6520 6120 7365 7175   to write a sequ
+00003aa0: 656e 6365 206f 6620 6e65 7720 6576 656e  ence of new even
+00003ab0: 7473 2061 746f 6d69 6361 6c6c 795c 6e74  ts atomically\nt
+00003ac0: 6f20 6120 2273 7472 6561 6d22 2e20 5772  o a "stream". Wr
+00003ad0: 6974 696e 6720 6e65 7720 6576 656e 7473  iting new events
+00003ae0: 2065 6974 6865 7220 6372 6561 7465 7320   either creates 
+00003af0: 6120 7374 7265 616d 2c20 6f72 2061 7070  a stream, or app
+00003b00: 656e 6473 2065 7665 6e74 7320 746f 2074  ends events to t
+00003b10: 6865 2065 6e64 5c6e 6f66 2061 2073 7472  he end\nof a str
+00003b20: 6561 6d2e 2054 6869 7320 6d65 7468 6f64  eam. This method
+00003b30: 2069 7320 6964 656d 706f 7465 6e74 2e5c   is idempotent.\
+00003b40: 6e5c 6e54 6869 7320 6d65 7468 6f64 2063  n\nThis method c
+00003b50: 616e 2062 6520 7573 6564 2074 6f20 7265  an be used to re
+00003b60: 636f 7264 2061 746f 6d69 6361 6c6c 7920  cord atomically 
+00003b70: 616c 6c20 7468 6520 6e65 775c 6e65 7665  all the new\neve
+00003b80: 6e74 7320 7468 6174 2061 7265 2067 656e  nts that are gen
+00003b90: 6572 6174 6564 2077 6865 6e20 6578 6563  erated when exec
+00003ba0: 7574 696e 6720 6120 636f 6d6d 616e 6420  uting a command 
+00003bb0: 696e 2061 6e20 6170 706c 6963 6174 696f  in an applicatio
+00003bc0: 6e2e 5c6e 5c6e 5468 7265 6520 6172 6775  n.\n\nThree argu
+00003bd0: 6d65 6e74 7320 6172 6520 7265 7175 6972  ments are requir
+00003be0: 6564 2c20 6073 7472 6561 6d5f 6e61 6d65  ed, `stream_name
+00003bf0: 602c 2060 6578 7065 6374 6564 5f70 6f73  `, `expected_pos
+00003c00: 6974 696f 6e60 5c6e 616e 6420 6065 7665  ition`\nand `eve
+00003c10: 6e74 7360 2e5c 6e5c 6e54 6865 2060 7374  nts`.\n\nThe `st
+00003c20: 7265 616d 5f6e 616d 6560 2061 7267 756d  ream_name` argum
+00003c30: 656e 7420 6973 2072 6571 7569 7265 642c  ent is required,
+00003c40: 2061 6e64 2069 7320 6578 7065 6374 6564   and is expected
+00003c50: 2074 6f20 6265 2061 2050 7974 686f 6e5c   to be a Python\
+00003c60: 6e60 7374 7260 2074 6861 7420 756e 6971  n`str` that uniq
+00003c70: 7565 6c79 2069 6465 6e74 6966 6965 7320  uely identifies 
+00003c80: 7468 6520 7374 7265 616d 2069 6e20 7468  the stream in th
+00003c90: 6520 6461 7461 6261 7365 2e5c 6e5c 6e54  e database.\n\nT
+00003ca0: 6865 2060 6578 7065 6374 6564 5f70 6f73  he `expected_pos
+00003cb0: 6974 696f 6e60 2061 7267 756d 656e 7420  ition` argument 
+00003cc0: 6973 2072 6571 7569 7265 642c 2069 7320  is required, is 
+00003cd0: 6578 7065 6374 6564 2074 6f20 6265 3a20  expected to be: 
+00003ce0: 604e 6f6e 6560 5c6e 6966 2065 7665 6e74  `None`\nif event
+00003cf0: 7320 6172 6520 6265 696e 6720 7772 6974  s are being writ
+00003d00: 7465 6e20 746f 2061 206e 6577 2073 7472  ten to a new str
+00003d10: 6561 6d2c 2061 6e64 206f 7468 6572 7769  eam, and otherwi
+00003d20: 7365 2061 6e20 5079 7468 6f6e 2060 696e  se an Python `in
+00003d30: 7460 5c6e 6571 7561 6c20 746f 2074 6865  t`\nequal to the
+00003d40: 2070 6f73 6974 696f 6e20 696e 2074 6865   position in the
+00003d50: 2073 7472 6561 6d20 6f66 2074 6865 206c   stream of the l
+00003d60: 6173 7420 7265 636f 7264 6564 2065 7665  ast recorded eve
+00003d70: 6e74 2069 6e20 7468 6520 7374 7265 616d  nt in the stream
+00003d80: 2e5c 6e5c 6e54 6865 2060 6576 656e 7473  .\n\nThe `events
+00003d90: 6020 6172 6775 6d65 6e74 2069 7320 7265  ` argument is re
+00003da0: 7175 6972 6564 2c20 616e 6420 6973 2065  quired, and is e
+00003db0: 7870 6563 7465 6420 746f 2062 6520 6120  xpected to be a 
+00003dc0: 7365 7175 656e 6365 206f 6620 6e65 775c  sequence of new\
+00003dd0: 6e65 7665 6e74 206f 626a 6563 7473 2074  nevent objects t
+00003de0: 6f20 6265 2061 7070 656e 6465 6420 746f  o be appended to
+00003df0: 2074 6865 206e 616d 6564 2073 7472 6561   the named strea
+00003e00: 6d2e 2054 6865 2060 4e65 7745 7665 6e74  m. The `NewEvent
+00003e10: 6020 636c 6173 7320 7368 6f75 6c64 5c6e  ` class should\n
+00003e20: 6265 2075 7365 6420 746f 2063 6f6e 7374  be used to const
+00003e30: 7275 6374 206e 6577 2065 7665 6e74 206f  ruct new event o
+00003e40: 626a 6563 7473 2028 7365 6520 7468 6520  bjects (see the 
+00003e50: 4e6f 7465 7320 7365 6374 696f 6e20 6265  Notes section be
+00003e60: 6c6f 7720 666f 7220 6465 7461 696c 735c  low for details\
+00003e70: 6e6f 6620 7468 6973 2063 6c61 7373 292e  nof this class).
+00003e80: 5c6e 5c6e 5468 6973 206d 6574 686f 6420  \n\nThis method 
+00003e90: 7461 6b65 7320 616e 206f 7074 696f 6e61  takes an optiona
+00003ea0: 6c20 6074 696d 656f 7574 6020 6172 6775  l `timeout` argu
+00003eb0: 6d65 6e74 2c20 7768 6963 6820 6973 2061  ment, which is a
+00003ec0: 2050 7974 686f 6e20 6066 6c6f 6174 6020   Python `float` 
+00003ed0: 7468 6174 2073 6574 735c 6e61 2064 6561  that sets\na dea
+00003ee0: 646c 696e 6520 666f 7220 7468 6520 636f  dline for the co
+00003ef0: 6d70 6c65 7469 6f6e 206f 6620 7468 6520  mpletion of the 
+00003f00: 6752 5043 206f 7065 7261 7469 6f6e 2e5c  gRPC operation.\
+00003f10: 6e5c 6e53 7472 6561 6d73 2061 7265 2063  n\nStreams are c
+00003f20: 7265 6174 6564 2062 7920 7772 6974 696e  reated by writin
+00003f30: 6720 6576 656e 7473 2e20 5468 6520 636f  g events. The co
+00003f40: 7272 6563 7420 7661 6c75 6520 6f66 2074  rrect value of t
+00003f50: 6865 2060 6578 7065 6374 6564 5f70 6f73  he `expected_pos
+00003f60: 6974 696f 6e60 5c6e 6172 6775 6d65 6e74  ition`\nargument
+00003f70: 2077 6865 6e20 7772 6974 696e 6720 7468   when writing th
+00003f80: 6520 6669 7273 7420 6576 656e 7420 6f66  e first event of
+00003f90: 2061 206e 6577 2073 7472 6561 6d20 6973   a new stream is
+00003fa0: 2060 4e6f 6e65 602e 2050 6c65 6173 6520   `None`. Please 
+00003fb0: 6e6f 7465 2c20 6974 2069 735c 6e6e 6f74  note, it is\nnot
+00003fc0: 2070 6f73 7369 626c 6520 746f 2073 6f6d   possible to som
+00003fd0: 6568 6f77 2063 7265 6174 6520 616e 2022  ehow create an "
+00003fe0: 656d 7074 7922 2073 7472 6561 6d20 696e  empty" stream in
+00003ff0: 2045 7665 6e74 5374 6f72 6544 422e 5c6e   EventStoreDB.\n
+00004000: 5c6e 5468 6520 7374 7265 616d 2070 6f73  \nThe stream pos
+00004010: 6974 696f 6e73 206f 6620 7265 636f 7264  itions of record
+00004020: 6564 2065 7665 6e74 7320 696e 2061 2073  ed events in a s
+00004030: 7472 6561 6d20 7374 6172 7420 6672 6f6d  tream start from
+00004040: 207a 6572 6f2c 2061 6e64 2066 6f72 6d20   zero, and form 
+00004050: 6120 6761 706c 6573 735c 6e73 6571 7565  a gapless\nseque
+00004060: 6e63 6520 6f66 2069 6e74 6567 6572 732e  nce of integers.
+00004070: 2054 6865 2073 7472 6561 6d20 706f 7369   The stream posi
+00004080: 7469 6f6e 206f 6620 7468 6520 6669 7273  tion of the firs
+00004090: 7420 7265 636f 7264 6564 2065 7665 6e74  t recorded event
+000040a0: 2069 6e20 6120 7374 7265 616d 2069 735c   in a stream is\
+000040b0: 6e60 3060 2e20 416e 6420 736f 2077 6865  n`0`. And so whe
+000040c0: 6e20 6170 7065 6e64 696e 6720 7468 6520  n appending the 
+000040d0: 7365 636f 6e64 206e 6577 2065 7665 6e74  second new event
+000040e0: 2074 6f20 6120 7374 7265 616d 2074 6861   to a stream tha
+000040f0: 7420 6861 7320 6f6e 6520 7265 636f 7264  t has one record
+00004100: 6564 2065 7665 6e74 2c5c 6e74 6865 2063  ed event,\nthe c
+00004110: 6f72 7265 6374 2076 616c 7565 206f 6620  orrect value of 
+00004120: 7468 6520 6065 7870 6563 7465 645f 706f  the `expected_po
+00004130: 7369 7469 6f6e 6020 6172 6775 6d65 6e74  sition` argument
+00004140: 2069 7320 6030 602e 2053 696d 696c 6172   is `0`. Similar
+00004150: 6c79 2c20 7468 6520 7374 7265 616d 5c6e  ly, the stream\n
+00004160: 706f 7369 7469 6f6e 206f 6620 7468 6520  position of the 
+00004170: 7365 636f 6e64 2072 6563 6f72 6465 6420  second recorded 
+00004180: 6576 656e 7420 696e 2061 2073 7472 6561  event in a strea
+00004190: 6d20 6973 2060 3160 2c20 616e 6420 736f  m is `1`, and so
+000041a0: 2077 6865 6e20 6170 7065 6e64 696e 6720   when appending 
+000041b0: 7468 655c 6e74 6869 7264 206e 6577 2065  the\nthird new e
+000041c0: 7665 6e74 2074 6f20 6120 7374 7265 616d  vent to a stream
+000041d0: 2074 6861 7420 6861 7320 7477 6f20 7265   that has two re
+000041e0: 636f 7264 6564 2065 7665 6e74 732c 2074  corded events, t
+000041f0: 6865 2063 6f72 7265 6374 2076 616c 7565  he correct value
+00004200: 206f 6620 7468 655c 6e60 6578 7065 6374   of the\n`expect
+00004210: 6564 5f70 6f73 6974 696f 6e60 2061 7267  ed_position` arg
+00004220: 756d 656e 7420 6973 2060 3160 2e20 416e  ument is `1`. An
+00004230: 6420 736f 206f 6e2e 2e2e 5c6e 5c6e 4966  d so on...\n\nIf
+00004240: 2074 6865 7265 2069 7320 6120 6d69 736d   there is a mism
+00004250: 6174 6368 2062 6574 7765 656e 2074 6865  atch between the
+00004260: 2067 6976 656e 2076 616c 7565 206f 6620   given value of 
+00004270: 7468 6520 6065 7870 6563 7465 645f 706f  the `expected_po
+00004280: 7369 7469 6f6e 6020 6172 6775 6d65 6e74  sition` argument
+00004290: 5c6e 616e 6420 7468 6520 706f 7369 7469  \nand the positi
+000042a0: 6f6e 206f 6620 7468 6520 6c61 7374 2072  on of the last r
+000042b0: 6563 6f72 6465 6420 6576 656e 7420 696e  ecorded event in
+000042c0: 2061 2073 7472 6561 6d2c 2074 6865 6e20   a stream, then 
+000042d0: 616e 2060 4578 7065 6374 6564 506f 7369  an `ExpectedPosi
+000042e0: 7469 6f6e 4572 726f 7260 5c6e 6578 6365  tionError`\nexce
+000042f0: 7074 696f 6e20 7769 6c6c 2062 6520 7261  ption will be ra
+00004300: 6973 6564 2e20 5468 6973 2065 6666 6563  ised. This effec
+00004310: 7469 7665 6c79 2061 6363 6f6d 706c 6973  tively accomplis
+00004320: 6865 7320 6f70 7469 6d69 7374 6963 2063  hes optimistic c
+00004330: 6f6e 6375 7272 656e 6379 2063 6f6e 7472  oncurrency contr
+00004340: 6f6c 2e5c 6e5c 6e49 6620 796f 7520 7769  ol.\n\nIf you wi
+00004350: 7368 2074 6f20 6469 7361 626c 6520 6f70  sh to disable op
+00004360: 7469 6d69 7374 6963 2063 6f6e 6375 7272  timistic concurr
+00004370: 656e 6379 2063 6f6e 7472 6f6c 2077 6865  ency control whe
+00004380: 6e20 6170 7065 6e64 696e 6720 6e65 7720  n appending new 
+00004390: 6576 656e 7473 2c20 796f 755c 6e63 616e  events, you\ncan
+000043a0: 2073 6574 2074 6865 2060 6578 7065 6374   set the `expect
+000043b0: 6564 5f70 6f73 6974 696f 6e60 2074 6f20  ed_position` to 
+000043c0: 6120 6e65 6761 7469 7665 2069 6e74 6567  a negative integ
+000043d0: 6572 2e5c 6e5c 6e49 6620 796f 7520 6e65  er.\n\nIf you ne
+000043e0: 6564 2074 6f20 6469 7363 6f76 6572 2074  ed to discover t
+000043f0: 6865 2063 7572 7265 6e74 2070 6f73 6974  he current posit
+00004400: 696f 6e20 6f66 2074 6865 206c 6173 7420  ion of the last 
+00004410: 7265 636f 7264 6564 2065 7665 6e74 2069  recorded event i
+00004420: 6e20 6120 7374 7265 616d 2c5c 6e79 6f75  n a stream,\nyou
+00004430: 2063 616e 2075 7365 2074 6865 2060 6765   can use the `ge
+00004440: 745f 7374 7265 616d 5f70 6f73 6974 696f  t_stream_positio
+00004450: 6e28 2960 206d 6574 686f 642e 5c6e 5c6e  n()` method.\n\n
+00004460: 506c 6561 7365 206e 6f74 652c 2074 6865  Please note, the
+00004470: 2061 7070 656e 6420 6576 656e 7473 206f   append events o
+00004480: 7065 7261 7469 6f6e 2069 7320 6174 6f6d  peration is atom
+00004490: 6963 2c20 736f 2074 6861 7420 6569 7468  ic, so that eith
+000044a0: 6572 2061 6c6c 5c6e 6f72 206e 6f6e 6520  er all\nor none 
+000044b0: 6f66 2074 6865 2067 6976 656e 206e 6577  of the given new
+000044c0: 2065 7665 6e74 7320 7769 6c6c 2062 6520   events will be 
+000044d0: 7265 636f 7264 6564 2e20 4279 2064 6573  recorded. By des
+000044e0: 6967 6e2c 2069 7420 6973 206f 6e6c 795c  ign, it is only\
+000044f0: 6e70 6f73 7369 626c 6520 7769 7468 2045  npossible with E
+00004500: 7665 6e74 5374 6f72 6544 4220 746f 2061  ventStoreDB to a
+00004510: 746f 6d69 6361 6c6c 7920 7265 636f 7264  tomically record
+00004520: 206e 6577 2065 7665 6e74 7320 696e 206f   new events in o
+00004530: 6e65 2073 7472 6561 6d2e 5c6e 5c6e 496e  ne stream.\n\nIn
+00004540: 2074 6865 2065 7861 6d70 6c65 2062 656c   the example bel
+00004550: 6f77 2c20 6120 6e65 7720 6576 656e 7420  ow, a new event 
+00004560: 6973 2061 7070 656e 6465 6420 746f 2061  is appended to a
+00004570: 206e 6577 2073 7472 6561 6d2e 5c6e 5c6e   new stream.\n\n
+00004580: 6060 6070 7974 686f 6e5c 6e66 726f 6d20  ```python\nfrom 
+00004590: 7575 6964 2069 6d70 6f72 7420 7575 6964  uuid import uuid
+000045a0: 345c 6e5c 6e66 726f 6d20 6573 6462 636c  4\n\nfrom esdbcl
+000045b0: 6965 6e74 2069 6d70 6f72 7420 4e65 7745  ient import NewE
+000045c0: 7665 6e74 5c6e 5c6e 2320 436f 6e73 7472  vent\n\n# Constr
+000045d0: 7563 7420 6e65 7720 6576 656e 7420 6f62  uct new event ob
+000045e0: 6a65 6374 2e5c 6e65 7665 6e74 3120 3d20  ject.\nevent1 = 
+000045f0: 4e65 7745 7665 6e74 2874 7970 653d 5c27  NewEvent(type=\'
+00004600: 4f72 6465 7243 7265 6174 6564 5c27 2c20  OrderCreated\', 
+00004610: 6461 7461 3d62 5c27 6461 7461 315c 2729  data=b\'data1\')
+00004620: 5c6e 5c6e 2320 4465 6669 6e65 2073 7472  \n\n# Define str
+00004630: 6561 6d20 6e61 6d65 2e5c 6e73 7472 6561  eam name.\nstrea
+00004640: 6d5f 6e61 6d65 3120 3d20 7374 7228 7575  m_name1 = str(uu
+00004650: 6964 3428 2929 5c6e 5c6e 2320 4170 7065  id4())\n\n# Appe
+00004660: 6e64 206c 6973 7420 6f66 2065 7665 6e74  nd list of event
+00004670: 7320 746f 206e 6577 2073 7472 6561 6d2e  s to new stream.
+00004680: 5c6e 636f 6d6d 6974 5f70 6f73 6974 696f  \ncommit_positio
+00004690: 6e31 203d 2063 6c69 656e 742e 6170 7065  n1 = client.appe
+000046a0: 6e64 5f65 7665 6e74 7328 5c6e 2020 2020  nd_events(\n    
+000046b0: 7374 7265 616d 5f6e 616d 653d 7374 7265  stream_name=stre
+000046c0: 616d 5f6e 616d 6531 2c5c 6e20 2020 2065  am_name1,\n    e
+000046d0: 7870 6563 7465 645f 706f 7369 7469 6f6e  xpected_position
+000046e0: 3d4e 6f6e 652c 5c6e 2020 2020 6576 656e  =None,\n    even
+000046f0: 7473 3d5b 6576 656e 7431 5d2c 5c6e 295c  ts=[event1],\n)\
+00004700: 6e60 6060 5c6e 5c6e 496e 2074 6865 2065  n```\n\nIn the e
+00004710: 7861 6d70 6c65 2062 656c 6f77 2c20 7477  xample below, tw
+00004720: 6f20 7375 6273 6571 7565 6e74 2065 7665  o subsequent eve
+00004730: 6e74 7320 6172 6520 6170 7065 6e64 6564  nts are appended
+00004740: 2074 6f20 616e 2065 7869 7374 696e 675c   to an existing\
+00004750: 6e73 7472 6561 6d2e 5c6e 5c6e 6060 6070  nstream.\n\n```p
+00004760: 7974 686f 6e5c 6e65 7665 6e74 3220 3d20  ython\nevent2 = 
+00004770: 4e65 7745 7665 6e74 2874 7970 653d 5c27  NewEvent(type=\'
+00004780: 4f72 6465 7255 7064 6174 6564 5c27 2c20  OrderUpdated\', 
+00004790: 6461 7461 3d62 5c27 6461 7461 325c 2729  data=b\'data2\')
+000047a0: 5c6e 6576 656e 7433 203d 204e 6577 4576  \nevent3 = NewEv
+000047b0: 656e 7428 7479 7065 3d5c 274f 7264 6572  ent(type=\'Order
+000047c0: 4465 6c65 7465 645c 272c 2064 6174 613d  Deleted\', data=
+000047d0: 625c 2764 6174 6133 5c27 295c 6e5c 6e63  b\'data3\')\n\nc
+000047e0: 6f6d 6d69 745f 706f 7369 7469 6f6e 3220  ommit_position2 
+000047f0: 3d20 636c 6965 6e74 2e61 7070 656e 645f  = client.append_
+00004800: 6576 656e 7473 285c 6e20 2020 2073 7472  events(\n    str
+00004810: 6561 6d5f 6e61 6d65 3d73 7472 6561 6d5f  eam_name=stream_
+00004820: 6e61 6d65 312c 5c6e 2020 2020 6578 7065  name1,\n    expe
+00004830: 6374 6564 5f70 6f73 6974 696f 6e3d 302c  cted_position=0,
+00004840: 5c6e 2020 2020 6576 656e 7473 3d5b 6576  \n    events=[ev
+00004850: 656e 7432 2c20 6576 656e 7433 5d2c 5c6e  ent2, event3],\n
+00004860: 295c 6e60 6060 5c6e 5c6e 4966 2074 6865  )\n```\n\nIf the
+00004870: 206f 7065 7261 7469 6f6e 2069 7320 7375   operation is su
+00004880: 6363 6573 7366 756c 2c20 7468 6973 206d  ccessful, this m
+00004890: 6574 686f 6420 7265 7475 726e 7320 616e  ethod returns an
+000048a0: 2069 6e74 6567 6572 5c6e 7265 7072 6573   integer\nrepres
+000048b0: 656e 7469 6e67 2074 6865 2064 6174 6162  enting the datab
+000048c0: 6173 6520 2263 6f6d 6d69 7420 706f 7369  ase "commit posi
+000048d0: 7469 6f6e 2220 6173 2069 7420 7761 7320  tion" as it was 
+000048e0: 7768 656e 2074 6865 206f 7065 7261 7469  when the operati
+000048f0: 6f6e 5c6e 7761 7320 636f 6d70 6c65 7465  on\nwas complete
+00004900: 642e 5c6e 5c6e 4120 2263 6f6d 6d69 7420  d.\n\nA "commit 
+00004910: 706f 7369 7469 6f6e 2220 6973 2061 206d  position" is a m
+00004920: 6f6e 6f74 6f6e 6963 616c 6c79 2069 6e63  onotonically inc
+00004930: 7265 6173 696e 6720 696e 7465 6765 7220  reasing integer 
+00004940: 7265 7072 6573 656e 7469 6e67 5c6e 7468  representing\nth
+00004950: 6520 706f 7369 7469 6f6e 206f 6620 7468  e position of th
+00004960: 6520 7265 636f 7264 6564 2065 7665 6e74  e recorded event
+00004970: 2069 6e20 6120 2274 6f74 616c 206f 7264   in a "total ord
+00004980: 6572 2220 6f66 2061 6c6c 2072 6563 6f72  er" of all recor
+00004990: 6465 645c 6e65 7665 6e74 7320 696e 2074  ded\nevents in t
+000049a0: 6865 2064 6174 6162 6173 6520 6163 726f  he database acro
+000049b0: 7373 2061 6c6c 2073 7472 6561 6d73 2e20  ss all streams. 
+000049c0: 4974 2069 7320 7468 6520 6163 7475 616c  It is the actual
+000049d0: 2070 6f73 6974 696f 6e5c 6e6f 6620 7468   position\nof th
+000049e0: 6520 6576 656e 7420 7265 636f 7264 206f  e event record o
+000049f0: 6e20 6469 736b 2e20 496e 2063 6f6e 7365  n disk. In conse
+00004a00: 7175 656e 6365 2c20 7468 6520 7365 7175  quence, the sequ
+00004a10: 656e 6365 206f 6620 636f 6d6d 6974 5c6e  ence of commit\n
+00004a20: 706f 7369 7469 6f6e 7320 6973 206e 6f74  positions is not
+00004a30: 2067 6170 6c65 7373 2e20 496e 6465 6564   gapless. Indeed
+00004a40: 2c20 7468 6572 6520 6172 6520 7573 7561  , there are usua
+00004a50: 6c6c 7920 6c61 7267 6520 6469 6666 6572  lly large differ
+00004a60: 656e 6365 735c 6e62 6574 7765 656e 2074  ences\nbetween t
+00004a70: 6865 2063 6f6d 6d69 7420 706f 7369 7469  he commit positi
+00004a80: 6f6e 7320 6f66 2073 7563 6365 7373 6976  ons of successiv
+00004a90: 6520 7265 636f 7264 6564 2065 7665 6e74  e recorded event
+00004aa0: 732e 5c6e 5c6e 5468 6520 2263 6f6d 6d69  s.\n\nThe "commi
+00004ab0: 7420 706f 7369 7469 6f6e 2220 7265 7475  t position" retu
+00004ac0: 726e 6564 2062 7920 6061 7070 656e 645f  rned by `append_
+00004ad0: 6576 656e 7473 2829 6020 6973 2074 6861  events()` is tha
+00004ae0: 7420 6f66 2074 6865 206c 6173 745c 6e72  t of the last\nr
+00004af0: 6563 6f72 6465 6420 6576 656e 7420 696e  ecorded event in
+00004b00: 2074 6865 2067 6976 656e 2062 6174 6368   the given batch
+00004b10: 206f 6620 6e65 7720 6576 656e 7473 2e5c   of new events.\
+00004b20: 6e5c 6e54 6865 2022 636f 6d6d 6974 2070  n\nThe "commit p
+00004b30: 6f73 6974 696f 6e22 2072 6574 7572 6e65  osition" returne
+00004b40: 6420 696e 2074 6869 7320 7761 7920 6361  d in this way ca
+00004b50: 6e20 7468 6572 6566 6f72 6520 6265 2075  n therefore be u
+00004b60: 7365 6420 746f 2077 6169 745c 6e66 6f72  sed to wait\nfor
+00004b70: 2061 2064 6f77 6e73 7472 6561 6d20 636f   a downstream co
+00004b80: 6d70 6f6e 656e 7420 746f 2068 6176 6520  mponent to have 
+00004b90: 7072 6f63 6573 7365 6420 616c 6c20 7468  processed all th
+00004ba0: 6520 6576 656e 7473 2074 6861 7420 7765  e events that we
+00004bb0: 7265 2072 6563 6f72 6465 642e 5c6e 5c6e  re recorded.\n\n
+00004bc0: 466f 7220 6578 616d 706c 652c 2063 6f6e  For example, con
+00004bd0: 7369 6465 7220 6120 7573 6572 2069 6e74  sider a user int
+00004be0: 6572 6661 6365 2063 6f6d 6d61 6e64 2074  erface command t
+00004bf0: 6861 7420 7265 7375 6c74 7320 696e 2074  hat results in t
+00004c00: 6865 2072 6563 6f72 6469 6e67 5c6e 6f66  he recording\nof
+00004c10: 206e 6577 2065 7665 6e74 732c 2061 6e64   new events, and
+00004c20: 2061 2071 7565 7279 2069 6e74 6f20 616e   a query into an
+00004c30: 2065 7665 6e74 7561 6c6c 7920 636f 6e73   eventually cons
+00004c40: 6973 7465 6e74 206d 6174 6572 6961 6c69  istent materiali
+00004c50: 7a65 645c 6e76 6965 7720 696e 2061 2064  zed\nview in a d
+00004c60: 6f77 6e73 7472 6561 6d20 636f 6d70 6f6e  ownstream compon
+00004c70: 656e 7420 7468 6174 2069 7320 7570 6461  ent that is upda
+00004c80: 7465 6420 6672 6f6d 2074 6865 7365 2065  ted from these e
+00004c90: 7665 6e74 732e 2049 6620 7468 6520 6e65  vents. If the ne
+00004ca0: 775c 6e65 7665 6e74 7320 6861 7665 206e  w\nevents have n
+00004cb0: 6f74 2079 6574 2062 6565 6e20 7072 6f63  ot yet been proc
+00004cc0: 6573 7365 642c 2074 6865 2076 6965 7720  essed, the view 
+00004cd0: 776f 756c 6420 6265 2073 7461 6c65 2e20  would be stale. 
+00004ce0: 5468 6520 2263 6f6d 6d69 7420 706f 7369  The "commit posi
+00004cf0: 7469 6f6e 225c 6e63 616e 2062 6520 7573  tion"\ncan be us
+00004d00: 6564 2062 7920 7468 6520 7573 6572 2069  ed by the user i
+00004d10: 6e74 6572 6661 6365 2074 6f20 706f 6c6c  nterface to poll
+00004d20: 2074 6865 2064 6f77 6e73 7472 6561 6d20   the downstream 
+00004d30: 636f 6d70 6f6e 656e 7420 756e 7469 6c20  component until 
+00004d40: 6974 2068 6173 5c6e 7072 6f63 6573 7365  it has\nprocesse
+00004d50: 6420 7468 6f73 6520 6e65 7720 6576 656e  d those new even
+00004d60: 7473 2c20 6166 7465 7220 7768 6963 6820  ts, after which 
+00004d70: 7469 6d65 2074 6865 2076 6965 7720 7769  time the view wi
+00004d80: 6c6c 206e 6f74 2062 6520 7374 616c 652e  ll not be stale.
+00004d90: 5c6e 5c6e 5c6e 2323 2320 4170 7065 6e64  \n\n\n### Append
+00004da0: 2065 7665 6e74 5c6e 5c6e 2a72 6571 7569   event\n\n*requi
+00004db0: 7265 7320 6c65 6164 6572 2a5c 6e5c 6e54  res leader*\n\nT
+00004dc0: 6865 2060 6170 7065 6e64 5f65 7665 6e74  he `append_event
+00004dd0: 2829 6020 6d65 7468 6f64 2063 616e 2062  ()` method can b
+00004de0: 6520 7573 6564 2074 6f20 7772 6974 6520  e used to write 
+00004df0: 6120 7369 6e67 6c65 206e 6577 2065 7665  a single new eve
+00004e00: 6e74 2074 6f20 6120 7374 7265 616d 2e5c  nt to a stream.\
+00004e10: 6e5c 6e54 6872 6565 2061 7267 756d 656e  n\nThree argumen
+00004e20: 7473 2061 7265 2072 6571 7569 7265 642c  ts are required,
+00004e30: 2060 7374 7265 616d 5f6e 616d 6560 2c20   `stream_name`, 
+00004e40: 6065 7870 6563 7465 645f 706f 7369 7469  `expected_positi
+00004e50: 6f6e 6020 616e 6420 6065 7665 6e74 602e  on` and `event`.
+00004e60: 5c6e 5c6e 5468 6973 206d 6574 686f 6420  \n\nThis method 
+00004e70: 776f 726b 7320 696e 2074 6865 2073 616d  works in the sam
+00004e80: 6520 7761 7920 6173 2060 6170 7065 6e64  e way as `append
+00004e90: 5f65 7665 6e74 7328 2960 2c20 686f 7765  _events()`, howe
+00004ea0: 7665 7220 6065 7665 6e74 6020 6973 2065  ver `event` is e
+00004eb0: 7870 6563 7465 645c 6e74 6f20 6265 2061  xpected\nto be a
+00004ec0: 2073 696e 676c 6520 604e 6577 4576 656e   single `NewEven
+00004ed0: 7460 2e5c 6e5c 6e54 6869 7320 6d65 7468  t`.\n\nThis meth
+00004ee0: 6f64 2074 616b 6573 2061 6e20 6f70 7469  od takes an opti
+00004ef0: 6f6e 616c 2060 7469 6d65 6f75 7460 2061  onal `timeout` a
+00004f00: 7267 756d 656e 742c 2077 6869 6368 2069  rgument, which i
+00004f10: 7320 6120 5079 7468 6f6e 2060 666c 6f61  s a Python `floa
+00004f20: 7460 2074 6861 7420 7365 7473 5c6e 6120  t` that sets\na 
+00004f30: 6465 6164 6c69 6e65 2066 6f72 2074 6865  deadline for the
+00004f40: 2063 6f6d 706c 6574 696f 6e20 6f66 2074   completion of t
+00004f50: 6865 2067 5250 4320 6f70 6572 6174 696f  he gRPC operatio
+00004f60: 6e2e 5c6e 5c6e 4966 2074 6865 206f 7065  n.\n\nIf the ope
+00004f70: 7261 7469 6f6e 2069 7320 7375 6363 6573  ration is succes
+00004f80: 7366 756c 2c20 7468 6973 206d 6574 686f  sful, this metho
+00004f90: 6420 7265 7475 726e 7320 616e 2069 6e74  d returns an int
+00004fa0: 6567 6572 5c6e 7265 7072 6573 656e 7469  eger\nrepresenti
+00004fb0: 6e67 2074 6865 2064 6174 6162 6173 6520  ng the database 
+00004fc0: 2263 6f6d 6d69 7420 706f 7369 7469 6f6e  "commit position
+00004fd0: 2220 6173 2069 7420 7761 7320 7768 656e  " as it was when
+00004fe0: 2074 6865 206f 7065 7261 7469 6f6e 5c6e   the operation\n
+00004ff0: 7761 7320 636f 6d70 6c65 7465 642e 5c6e  was completed.\n
+00005000: 5c6e 5369 6e63 6520 7468 6520 6861 6e64  \nSince the hand
+00005010: 6c69 6e67 206f 6620 6120 636f 6d6d 616e  ling of a comman
+00005020: 6420 696e 2079 6f75 7220 6170 706c 6963  d in your applic
+00005030: 6174 696f 6e20 6d61 7920 7265 7375 6c74  ation may result
+00005040: 2069 6e20 6f6e 6520 6f72 206d 616e 795c   in one or many\
+00005050: 6e6e 6577 2065 7665 6e74 732c 2061 6e64  nnew events, and
+00005060: 2074 6865 2072 6573 756c 7473 206f 6620   the results of 
+00005070: 6861 6e64 6c69 6e67 2061 2063 6f6d 6d61  handling a comma
+00005080: 6e64 2073 686f 756c 6420 6265 2072 6563  nd should be rec
+00005090: 6f72 6465 6420 6174 6f6d 6963 616c 6c79  orded atomically
+000050a0: 2c5c 6e61 6e64 2074 6865 2077 7269 7469  ,\nand the writi
+000050b0: 6e67 206f 6620 6e65 7720 6576 656e 7473  ng of new events
+000050c0: 2067 656e 6572 6174 6564 2062 7920 6120   generated by a 
+000050d0: 636f 6d6d 616e 6420 6861 6e64 6c65 7220  command handler 
+000050e0: 6973 2075 7375 616c 6c79 2061 2063 6f6e  is usually a con
+000050f0: 6365 726e 5c6e 7468 6174 2069 7320 6661  cern\nthat is fa
+00005100: 6374 6f72 6564 206f 7574 2061 6e64 2075  ctored out and u
+00005110: 7365 6420 6576 6572 7977 6865 7265 2069  sed everywhere i
+00005120: 6e20 6120 7072 6f6a 6563 742c 2069 7420  n a project, it 
+00005130: 6973 206d 6f72 6520 7573 7561 6c20 696e  is more usual in
+00005140: 2061 2070 726f 6a65 6374 5c6e 746f 2075   a project\nto u
+00005150: 7365 2060 6170 7065 6e64 5f65 7665 6e74  se `append_event
+00005160: 7328 2960 2074 6f20 7265 636f 7264 206e  s()` to record n
+00005170: 6577 2065 7665 6e74 732e 2048 6f77 6576  ew events. Howev
+00005180: 6572 2c20 7468 6973 206d 6574 686f 6420  er, this method 
+00005190: 6d61 7920 6f63 6361 7369 6f6e 616c 6c79  may occasionally
+000051a0: 5c6e 6265 2075 7365 6675 6c2c 2061 6e64  \nbe useful, and
+000051b0: 2069 6e64 6565 6420 6974 2069 7320 7573   indeed it is us
+000051c0: 6564 2062 7920 6073 6574 5f73 7472 6561  ed by `set_strea
+000051d0: 6d5f 6d65 7461 6461 7461 2829 602e 5c6e  m_metadata()`.\n
+000051e0: 5c6e 5c6e 2323 2320 4964 656d 706f 7465  \n\n### Idempote
+000051f0: 6e74 2061 7070 656e 6420 6f70 6572 6174  nt append operat
+00005200: 696f 6e73 5c6e 5c6e 536f 6d65 7469 6d65  ions\n\nSometime
+00005210: 7320 6974 206d 6179 2068 6170 7065 6e20  s it may happen 
+00005220: 7468 6174 2c20 7768 656e 2063 616c 6c69  that, when calli
+00005230: 6e67 2060 6170 7065 6e64 5f65 7665 6e74  ng `append_event
+00005240: 7328 2960 206f 7220 6061 7070 656e 645f  s()` or `append_
+00005250: 6576 656e 7428 2960 2c5c 6e74 6865 206e  event()`,\nthe n
+00005260: 6577 2065 7665 6e74 7320 6172 6520 7375  ew events are su
+00005270: 6363 6573 7366 756c 6c79 2072 6563 6f72  ccessfully recor
+00005280: 6465 642c 2062 7574 2074 6865 6e20 736f  ded, but then so
+00005290: 6d65 686f 7720 7468 6520 636f 6e6e 6563  mehow the connec
+000052a0: 7469 6f6e 2074 6f20 7468 655c 6e64 6174  tion to the\ndat
+000052b0: 6162 6173 6520 6765 7473 2069 6e74 6572  abase gets inter
+000052c0: 7275 7074 6564 2062 6566 6f72 6520 7468  rupted before th
+000052d0: 6520 7375 6363 6573 7366 756c 2063 616c  e successful cal
+000052e0: 6c20 6361 6e20 7265 7475 726e 2073 7563  l can return suc
+000052f0: 6365 7373 6675 6c6c 7920 746f 5c6e 7468  cessfully to\nth
+00005300: 6520 636c 6965 6e74 2e20 496e 2063 6173  e client. In cas
+00005310: 6520 6f66 2061 6e20 6572 726f 7220 7768  e of an error wh
+00005320: 656e 2061 7070 656e 6469 6e67 2061 6e20  en appending an 
+00005330: 6576 656e 742c 2069 7420 6973 2064 6573  event, it is des
+00005340: 6972 6162 6c65 2074 6f5c 6e72 6574 7279  irable to\nretry
+00005350: 2061 7070 656e 6469 6e67 2074 6865 2073   appending the s
+00005360: 616d 6520 6576 656e 7420 6174 2074 6865  ame event at the
+00005370: 2073 616d 6520 706f 7369 7469 6f6e 2e20   same position. 
+00005380: 4966 2074 6865 2065 7665 6e74 2077 6173  If the event was
+00005390: 2069 6e20 6661 6374 5c6e 7375 6363 6573   in fact\nsucces
+000053a0: 7366 756c 6c79 2072 6563 6f72 6465 642c  sfully recorded,
+000053b0: 2069 7420 6973 2063 6f6e 7665 6e69 656e   it is convenien
+000053c0: 7420 666f 7220 7468 6520 7265 7472 6965  t for the retrie
+000053d0: 6420 6f70 6572 6174 696f 6e20 746f 2072  d operation to r
+000053e0: 6574 7572 6e5c 6e73 7563 6365 7373 6675  eturn\nsuccessfu
+000053f0: 6c6c 7920 7769 7468 6f75 7420 7261 6973  lly without rais
+00005400: 696e 6720 616e 2065 7272 6f72 2064 7565  ing an error due
+00005410: 2074 6f20 6f70 7469 6d69 7374 6963 2063   to optimistic c
+00005420: 6f6e 6375 7272 656e 6379 2063 6f6e 7472  oncurrency contr
+00005430: 6f6c 5c6e 2861 7320 6465 7363 7269 6265  ol\n(as describe
+00005440: 6420 6162 6f76 6529 2e5c 6e5c 6e54 6865  d above).\n\nThe
+00005450: 2065 7861 6d70 6c65 2062 656c 6f77 2073   example below s
+00005460: 686f 7773 2074 6865 2060 6170 7065 6e64  hows the `append
+00005470: 5f65 7665 6e74 7328 2960 206d 6574 686f  _events()` metho
+00005480: 6420 6265 696e 6720 6361 6c6c 6564 2061  d being called a
+00005490: 6761 696e 2077 6974 685c 6e60 6576 656e  gain with\n`even
+000054a0: 7433 6020 616e 6420 6065 7870 6563 7465  t3` and `expecte
+000054b0: 645f 706f 7369 7469 6f6e 3d32 602e 2057  d_position=2`. W
+000054c0: 6520 6361 6e20 7365 6520 7468 6174 2072  e can see that r
+000054d0: 6570 6561 7469 6e67 2074 6865 2063 616c  epeating the cal
+000054e0: 6c20 746f 5c6e 6061 7070 656e 645f 6576  l to\n`append_ev
+000054f0: 656e 7473 2829 6020 7265 7475 726e 7320  ents()` returns 
+00005500: 7375 6363 6573 7366 756c 6c79 2e5c 6e5c  successfully.\n\
+00005510: 6e60 6060 7079 7468 6f6e 5c6e 2320 5265  n```python\n# Re
+00005520: 7472 7920 6170 7065 6e64 696e 6720 6576  try appending ev
+00005530: 656e 7433 2e5c 6e63 6f6d 6d69 745f 706f  ent3.\ncommit_po
+00005540: 7369 7469 6f6e 5f72 6574 7279 203d 2063  sition_retry = c
+00005550: 6c69 656e 742e 6170 7065 6e64 5f65 7665  lient.append_eve
+00005560: 6e74 7328 5c6e 2020 2020 7374 7265 616d  nts(\n    stream
+00005570: 5f6e 616d 653d 7374 7265 616d 5f6e 616d  _name=stream_nam
+00005580: 6531 2c5c 6e20 2020 2065 7870 6563 7465  e1,\n    expecte
+00005590: 645f 706f 7369 7469 6f6e 3d30 2c5c 6e20  d_position=0,\n 
+000055a0: 2020 2065 7665 6e74 733d 5b65 7665 6e74     events=[event
+000055b0: 322c 2065 7665 6e74 335d 2c5c 6e29 5c6e  2, event3],\n)\n
+000055c0: 6060 605c 6e5c 6e57 6520 6361 6e20 7365  ```\n\nWe can se
+000055d0: 6520 7468 6174 2074 6865 2073 616d 6520  e that the same 
+000055e0: 636f 6d6d 6974 2070 6f73 6974 696f 6e20  commit position 
+000055f0: 6973 2072 6574 7572 6e65 6420 6173 2061  is returned as a
+00005600: 626f 7665 2e5c 6e5c 6e60 6060 7079 7468  bove.\n\n```pyth
+00005610: 6f6e 5c6e 6173 7365 7274 2063 6f6d 6d69  on\nassert commi
+00005620: 745f 706f 7369 7469 6f6e 5f72 6574 7279  t_position_retry
+00005630: 203d 3d20 636f 6d6d 6974 5f70 6f73 6974   == commit_posit
+00005640: 696f 6e32 5c6e 6060 605c 6e5c 6e42 7920  ion2\n```\n\nBy 
+00005650: 6361 6c6c 696e 6720 6072 6561 645f 7374  calling `read_st
+00005660: 7265 616d 5f65 7665 6e74 7328 2960 2c20  ream_events()`, 
+00005670: 7765 2063 616e 2061 6c73 6f20 7365 6520  we can also see 
+00005680: 7468 6520 7374 7265 616d 2068 6173 2062  the stream has b
+00005690: 6565 6e20 756e 6368 616e 6765 645c 6e64  een unchanged\nd
+000056a0: 6573 7069 7465 2074 6865 2060 6170 7065  espite the `appe
+000056b0: 6e64 5f65 7665 6e74 7328 2960 206d 6574  nd_events()` met
+000056c0: 686f 6420 6861 7669 6e67 2062 6565 6e20  hod having been 
+000056d0: 6361 6c6c 6564 2074 7769 6365 2077 6974  called twice wit
+000056e0: 6820 7468 6520 7361 6d65 2061 7267 756d  h the same argum
+000056f0: 656e 7473 2e5c 6e54 6861 7420 6973 2c20  ents.\nThat is, 
+00005700: 7468 6572 6520 6172 6520 7374 696c 6c20  there are still 
+00005710: 6f6e 6c79 2074 6872 6565 2065 7665 6e74  only three event
+00005720: 7320 696e 2074 6865 2073 7472 6561 6d2e  s in the stream.
+00005730: 5c6e 5c6e 6060 6070 7974 686f 6e5c 6e65  \n\n```python\ne
+00005740: 7665 6e74 7320 3d20 636c 6965 6e74 2e72  vents = client.r
+00005750: 6561 645f 7374 7265 616d 5f65 7665 6e74  ead_stream_event
+00005760: 7328 5c6e 2020 2020 7374 7265 616d 5f6e  s(\n    stream_n
+00005770: 616d 653d 7374 7265 616d 5f6e 616d 6531  ame=stream_name1
+00005780: 5c6e 295c 6e5c 6e61 7373 6572 7420 6c65  \n)\n\nassert le
+00005790: 6e28 6576 656e 7473 2920 3d3d 2033 5c6e  n(events) == 3\n
+000057a0: 6060 605c 6e5c 6e54 6869 7320 6964 656d  ```\n\nThis idem
+000057b0: 706f 7465 6e74 2062 6568 6176 696f 7572  potent behaviour
+000057c0: 2069 7320 6163 7469 7661 7465 6420 6265   is activated be
+000057d0: 6361 7573 6520 7468 6520 604e 6577 4576  cause the `NewEv
+000057e0: 656e 7460 2063 6c61 7373 2068 6173 2061  ent` class has a
+000057f0: 6e20 6069 6460 5c6e 6174 7472 6962 7574  n `id`\nattribut
+00005800: 6520 7468 6174 2c20 6279 2064 6566 6175  e that, by defau
+00005810: 6c74 2c20 6973 2061 7373 6967 6e65 6420  lt, is assigned 
+00005820: 6120 6e65 7720 616e 6420 756e 6971 7565  a new and unique
+00005830: 2076 6572 7369 6f6e 2d34 2055 5549 4420   version-4 UUID 
+00005840: 7768 656e 2061 6e5c 6e69 6e73 7461 6e63  when an\ninstanc
+00005850: 6520 6f66 2060 4e65 7745 7665 6e74 6020  e of `NewEvent` 
+00005860: 6973 2063 6f6e 7374 7275 6374 6564 2e20  is constructed. 
+00005870: 4966 2065 7665 6e74 7320 7769 7468 2074  If events with t
+00005880: 6865 2073 616d 6520 6069 6460 2061 7265  he same `id` are
+00005890: 2061 7070 656e 6465 645c 6e61 7420 7468   appended\nat th
+000058a0: 6520 7361 6d65 2060 6578 7065 6374 6564  e same `expected
+000058b0: 5f70 6f73 6974 696f 6e60 2c20 7468 6520  _position`, the 
+000058c0: 7374 7265 616d 2077 696c 6c20 6265 2075  stream will be u
+000058d0: 6e63 6861 6e67 6564 2c20 7468 6520 6f70  nchanged, the op
+000058e0: 6572 6174 696f 6e20 7769 6c6c 5c6e 636f  eration will\nco
+000058f0: 6d70 6c65 7465 2073 7563 6365 7373 6675  mplete successfu
+00005900: 6c6c 792c 2061 6e64 2074 6865 2073 616d  lly, and the sam
+00005910: 6520 636f 6d6d 6974 2070 6f73 6974 696f  e commit positio
+00005920: 6e20 7769 6c6c 2062 6520 7265 7475 726e  n will be return
+00005930: 6564 2074 6f20 7468 6520 6361 6c6c 6572  ed to the caller
+00005940: 2e5c 6e5c 6e60 6060 7079 7468 6f6e 5c6e  .\n\n```python\n
+00005950: 6672 6f6d 2075 7569 6420 696d 706f 7274  from uuid import
+00005960: 2055 5549 445c 6e5c 6e5c 6e61 7373 6572   UUID\n\n\nasser
+00005970: 7420 6973 696e 7374 616e 6365 2865 7665  t isinstance(eve
+00005980: 6e74 312e 6964 2c20 5555 4944 295c 6e61  nt1.id, UUID)\na
+00005990: 7373 6572 7420 6973 696e 7374 616e 6365  ssert isinstance
+000059a0: 2865 7665 6e74 322e 6964 2c20 5555 4944  (event2.id, UUID
+000059b0: 295c 6e61 7373 6572 7420 6973 696e 7374  )\nassert isinst
+000059c0: 616e 6365 2865 7665 6e74 332e 6964 2c20  ance(event3.id, 
+000059d0: 5555 4944 295c 6e5c 6e61 7373 6572 7420  UUID)\n\nassert 
+000059e0: 6576 656e 7431 2e69 6420 213d 2065 7665  event1.id != eve
+000059f0: 6e74 322e 6964 5c6e 6173 7365 7274 2065  nt2.id\nassert e
+00005a00: 7665 6e74 322e 6964 2021 3d20 6576 656e  vent2.id != even
+00005a10: 7433 2e69 645c 6e5c 6e61 7373 6572 7420  t3.id\n\nassert 
+00005a20: 6576 656e 7473 5b30 5d2e 6964 203d 3d20  events[0].id == 
+00005a30: 6576 656e 7431 2e69 645c 6e61 7373 6572  event1.id\nasser
+00005a40: 7420 6576 656e 7473 5b31 5d2e 6964 203d  t events[1].id =
+00005a50: 3d20 6576 656e 7432 2e69 645c 6e61 7373  = event2.id\nass
+00005a60: 6572 7420 6576 656e 7473 5b32 5d2e 6964  ert events[2].id
+00005a70: 203d 3d20 6576 656e 7433 2e69 645c 6e60   == event3.id\n`
+00005a80: 6060 5c6e 5c6e 4974 2069 7320 706f 7373  ``\n\nIt is poss
+00005a90: 6962 6c65 2074 6f20 7365 7420 7468 6520  ible to set the 
+00005aa0: 6069 6460 2063 6f6e 7374 7275 6374 6f72  `id` constructor
+00005ab0: 2061 7267 756d 656e 7420 6f66 2060 4e65   argument of `Ne
+00005ac0: 7745 7665 6e74 6020 7768 656e 2069 6e73  wEvent` when ins
+00005ad0: 7461 6e74 6961 7469 6e67 5c6e 7468 6520  tantiating\nthe 
+00005ae0: 604e 6577 4576 656e 7460 2063 6c61 7373  `NewEvent` class
+00005af0: 2c20 6275 7420 696e 2074 6865 2065 7861  , but in the exa
+00005b00: 6d70 6c65 7320 6162 6f76 6520 7765 2068  mples above we h
+00005b10: 6176 6520 6265 656e 2075 7369 6e67 2074  ave been using t
+00005b20: 6865 2064 6566 6175 6c74 5c6e 6265 6861  he default\nbeha
+00005b30: 7669 6f75 722c 2077 6869 6368 2069 7320  viour, which is 
+00005b40: 7468 6174 2074 6865 2060 6964 6020 7661  that the `id` va
+00005b50: 6c75 6520 6973 2067 656e 6572 6174 6564  lue is generated
+00005b60: 2077 6865 6e20 7468 6520 604e 6577 4576   when the `NewEv
+00005b70: 656e 7460 2063 6c61 7373 2069 735c 6e69  ent` class is\ni
+00005b80: 6e73 7461 6e74 6961 7465 642e 5c6e 5c6e  nstantiated.\n\n
+00005b90: 5c6e 2323 2320 5265 6164 2073 7472 6561  \n### Read strea
+00005ba0: 6d20 6576 656e 7473 5c6e 5c6e 5468 6520  m events\n\nThe 
+00005bb0: 6072 6561 645f 7374 7265 616d 5f65 7665  `read_stream_eve
+00005bc0: 6e74 7328 2960 206d 6574 686f 6420 6361  nts()` method ca
+00005bd0: 6e20 6265 2075 7365 6420 746f 206f 6274  n be used to obt
+00005be0: 6169 6e20 7468 6520 7265 636f 7264 6564  ain the recorded
+00005bf0: 2065 7665 6e74 7320 696e 2061 5c6e 7374   events in a\nst
+00005c00: 7265 616d 2e20 4974 2072 6574 7572 6e73  ream. It returns
+00005c10: 2061 2073 6571 7565 6e63 6520 6f66 2072   a sequence of r
+00005c20: 6563 6f72 6465 6420 6576 656e 7473 206f  ecorded events o
+00005c30: 626a 6563 7473 2e20 5468 6520 7265 6365  bjects. The rece
+00005c40: 6976 6564 2072 6563 6f72 6465 6420 6576  ived recorded ev
+00005c50: 656e 745c 6e6f 626a 6563 7420 6172 6520  ent\nobject are 
+00005c60: 696e 7374 616e 6365 7320 6f66 2074 6865  instances of the
+00005c70: 2060 5265 636f 7264 6564 4576 656e 7460   `RecordedEvent`
+00005c80: 2063 6c61 7373 2028 7365 6520 7468 6520   class (see the 
+00005c90: 4e6f 7465 7320 7365 6374 696f 6e20 6265  Notes section be
+00005ca0: 6c6f 7720 666f 725c 6e64 6574 6169 6c73  low for\ndetails
+00005cb0: 206f 6620 7468 6973 2063 6c61 7373 292e   of this class).
+00005cc0: 5c6e 5c6e 5468 6973 206d 6574 686f 6420  \n\nThis method 
+00005cd0: 6861 7320 6f6e 6520 7265 7175 6972 6564  has one required
+00005ce0: 2061 7267 756d 656e 742c 2060 7374 7265   argument, `stre
+00005cf0: 616d 5f6e 616d 6560 2c20 7768 6963 6820  am_name`, which 
+00005d00: 6973 2074 6865 206e 616d 6520 6f66 5c6e  is the name of\n
+00005d10: 7468 6520 7374 7265 616d 2066 726f 6d20  the stream from 
+00005d20: 7768 6963 6820 746f 2072 6561 6420 6576  which to read ev
+00005d30: 656e 7473 2e20 4279 2064 6566 6175 6c74  ents. By default
+00005d40: 2c20 7468 6520 7265 636f 7264 6564 2065  , the recorded e
+00005d50: 7665 6e74 7320 696e 2074 6865 5c6e 7374  vents in the\nst
+00005d60: 7265 616d 2061 7265 2072 6574 7572 6e65  ream are returne
+00005d70: 6420 696e 2074 6865 206f 7264 6572 2074  d in the order t
+00005d80: 6865 7920 7765 7265 2072 6563 6f72 6465  hey were recorde
+00005d90: 642e 5c6e 5c6e 5468 6520 6d65 7468 6f64  d.\n\nThe method
+00005da0: 2060 7265 6164 5f73 7472 6561 6d5f 6576   `read_stream_ev
+00005db0: 656e 7473 2829 6020 616c 736f 2073 7570  ents()` also sup
+00005dc0: 706f 7274 7320 666f 7572 206f 7074 696f  ports four optio
+00005dd0: 6e61 6c20 6172 6775 6d65 6e74 732c 5c6e  nal arguments,\n
+00005de0: 6073 7472 6561 6d5f 706f 7369 7469 6f6e  `stream_position
+00005df0: 602c 2060 6261 636b 7761 7264 7360 2c20  `, `backwards`, 
+00005e00: 606c 696d 6974 602c 2061 6e64 2060 7469  `limit`, and `ti
+00005e10: 6d65 6f75 7460 2e5c 6e5c 6e54 6865 206f  meout`.\n\nThe o
+00005e20: 7074 696f 6e61 6c20 6073 7472 6561 6d5f  ptional `stream_
+00005e30: 706f 7369 7469 6f6e 6020 6172 6775 6d65  position` argume
+00005e40: 6e74 2069 7320 616e 206f 7074 696f 6e61  nt is an optiona
+00005e50: 6c20 696e 7465 6765 7220 7468 6174 2063  l integer that c
+00005e60: 616e 2062 6520 7573 6564 2074 6f5c 6e69  an be used to\ni
+00005e70: 6e64 6963 6174 6520 7468 6520 706f 7369  ndicate the posi
+00005e80: 7469 6f6e 2069 6e20 7468 6520 7374 7265  tion in the stre
+00005e90: 616d 2066 726f 6d20 7768 6963 6820 746f  am from which to
+00005ea0: 2073 7461 7274 2072 6561 6469 6e67 2e20   start reading. 
+00005eb0: 5468 6973 2061 7267 756d 656e 7420 6973  This argument is
+00005ec0: 5c6e 604e 6f6e 6560 2062 7920 6465 6661  \n`None` by defa
+00005ed0: 756c 742c 2077 6869 6368 206d 6561 6e73  ult, which means
+00005ee0: 2074 6865 2073 7472 6561 6d20 7769 6c6c   the stream will
+00005ef0: 2062 6520 7265 6164 2065 6974 6865 7220   be read either 
+00005f00: 6672 6f6d 2074 6865 2073 7461 7274 206f  from the start o
+00005f10: 6620 7468 655c 6e73 7472 6561 6d20 2874  f the\nstream (t
+00005f20: 6865 2064 6566 6175 6c74 2062 6568 6176  he default behav
+00005f30: 696f 7572 292c 206f 7220 6672 6f6d 2074  iour), or from t
+00005f40: 6865 2065 6e64 206f 6620 7468 6520 7374  he end of the st
+00005f50: 7265 616d 2069 6620 6062 6163 6b77 6172  ream if `backwar
+00005f60: 6473 6020 6973 5c6e 6054 7275 6560 2e20  ds` is\n`True`. 
+00005f70: 5768 656e 2072 6561 6469 6e67 2061 2073  When reading a s
+00005f80: 7472 6561 6d20 6672 6f6d 2061 2073 7065  tream from a spe
+00005f90: 6369 6669 6320 706f 7369 7469 6f6e 2069  cific position i
+00005fa0: 6e20 7468 6520 7374 7265 616d 2c20 7468  n the stream, th
+00005fb0: 655c 6e72 6563 6f72 6465 6420 6576 656e  e\nrecorded even
+00005fc0: 7420 6174 2074 6861 7420 706f 7369 7469  t at that positi
+00005fd0: 6f6e 2077 696c 6c20 6265 2069 6e63 6c75  on will be inclu
+00005fe0: 6465 642c 2062 6f74 6820 7768 656e 2072  ded, both when r
+00005ff0: 6561 6469 6e67 2066 6f72 7761 7264 735c  eading forwards\
+00006000: 6e66 726f 6d20 7468 6174 2070 6f73 6974  nfrom that posit
+00006010: 696f 6e2c 2061 6e64 2077 6865 6e20 7265  ion, and when re
+00006020: 6164 696e 6720 6261 636b 7761 7264 7320  ading backwards 
+00006030: 6672 6f6d 2074 6861 7420 706f 7369 7469  from that positi
+00006040: 6f6e 2e5c 6e5c 6e54 6865 206f 7074 696f  on.\n\nThe optio
+00006050: 6e61 6c20 6062 6163 6b77 6172 6473 6020  nal `backwards` 
+00006060: 6172 6775 6d65 6e74 2069 7320 6120 5079  argument is a Py
+00006070: 7468 6f6e 2060 626f 6f6c 602e 2054 6865  thon `bool`. The
+00006080: 2064 6566 6175 6c74 2069 7320 6046 616c   default is `Fal
+00006090: 7365 602c 2077 6869 6368 5c6e 6d65 616e  se`, which\nmean
+000060a0: 7320 7468 6520 7374 7265 616d 2077 696c  s the stream wil
+000060b0: 6c20 6265 2072 6561 6420 666f 7277 6172  l be read forwar
+000060c0: 6473 2062 7920 6465 6661 756c 742c 2073  ds by default, s
+000060d0: 6f20 7468 6174 2065 7665 6e74 7320 6172  o that events ar
+000060e0: 6520 7265 7475 726e 6564 2069 6e20 7468  e returned in th
+000060f0: 655c 6e6f 7264 6572 2074 6865 7920 7765  e\norder they we
+00006100: 7265 2061 7070 656e 6465 642c 2049 6620  re appended, If 
+00006110: 6062 6163 6b77 6172 6473 6020 6973 2060  `backwards` is `
+00006120: 5472 7565 602c 2074 6865 2065 7665 6e74  True`, the event
+00006130: 7320 6172 6520 7265 7475 726e 6564 2069  s are returned i
+00006140: 6e20 7265 7665 7273 655c 6e6f 7264 6572  n reverse\norder
+00006150: 2e5c 6e5c 6e54 6865 206f 7074 696f 6e61  .\n\nThe optiona
+00006160: 6c20 606c 696d 6974 6020 6172 6775 6d65  l `limit` argume
+00006170: 6e74 2069 7320 616e 2069 6e74 6567 6572  nt is an integer
+00006180: 2077 6869 6368 2072 6573 7472 6963 7473   which restricts
+00006190: 2074 6865 206e 756d 6265 7220 6f66 2065   the number of e
+000061a0: 7665 6e74 7320 7468 6174 5c6e 7769 6c6c  vents that\nwill
+000061b0: 2062 6520 7265 7475 726e 6564 2e20 5468   be returned. Th
+000061c0: 6520 6465 6661 756c 7420 7661 6c75 6520  e default value 
+000061d0: 6973 2060 7379 732e 6d61 7869 6e74 602e  is `sys.maxint`.
+000061e0: 5c6e 5c6e 5468 6520 6f70 7469 6f6e 616c  \n\nThe optional
+000061f0: 2060 7469 6d65 6f75 7460 2061 7267 756d   `timeout` argum
+00006200: 656e 7420 6973 2061 2050 7974 686f 6e20  ent is a Python 
+00006210: 6066 6c6f 6174 6020 7768 6963 6820 7365  `float` which se
+00006220: 7473 2061 2064 6561 646c 696e 6520 666f  ts a deadline fo
+00006230: 725c 6e74 6865 2063 6f6d 706c 6574 696f  r\nthe completio
+00006240: 6e20 6f66 2074 6865 2067 5250 4320 6f70  n of the gRPC op
+00006250: 6572 6174 696f 6e2e 5c6e 5c6e 5468 6520  eration.\n\nThe 
+00006260: 6578 616d 706c 6520 6265 6c6f 7720 7368  example below sh
+00006270: 6f77 7320 686f 7720 746f 2072 6561 6420  ows how to read 
+00006280: 7468 6520 7265 636f 7264 6564 2065 7665  the recorded eve
+00006290: 6e74 7320 6f66 2061 2073 7472 6561 6d5c  nts of a stream\
+000062a0: 6e66 6f72 7761 7264 7320 6672 6f6d 2074  nforwards from t
+000062b0: 6865 2073 7461 7274 206f 6620 7468 6520  he start of the 
+000062c0: 7374 7265 616d 2074 6f20 7468 6520 656e  stream to the en
+000062d0: 6420 6f66 2074 6865 2073 7472 6561 6d2e  d of the stream.
+000062e0: 2054 6865 5c6e 6e61 6d65 206f 6620 6120   The\nname of a 
+000062f0: 7374 7265 616d 2069 7320 6769 7665 6e20  stream is given 
+00006300: 7768 656e 2063 616c 6c69 6e67 2074 6865  when calling the
+00006310: 206d 6574 686f 642e 5c6e 5c6e 6060 6070   method.\n\n```p
+00006320: 7974 686f 6e5c 6e65 7665 6e74 7320 3d20  ython\nevents = 
+00006330: 636c 6965 6e74 2e72 6561 645f 7374 7265  client.read_stre
+00006340: 616d 5f65 7665 6e74 7328 5c6e 2020 2020  am_events(\n    
+00006350: 7374 7265 616d 5f6e 616d 653d 7374 7265  stream_name=stre
+00006360: 616d 5f6e 616d 6531 5c6e 295c 6e60 6060  am_name1\n)\n```
+00006370: 5c6e 5c6e 4e6f 7720 7468 6174 2077 6520  \n\nNow that we 
+00006380: 6861 7665 2061 2073 6571 7565 6e63 6520  have a sequence 
+00006390: 6f66 2065 7665 6e74 206f 626a 6563 7473  of event objects
+000063a0: 2c20 7765 2063 616e 2063 6865 636b 2077  , we can check w
+000063b0: 6520 676f 7420 7468 655c 6e74 6872 6565  e got the\nthree
+000063c0: 2065 7665 6e74 7320 7468 6174 2077 6572   events that wer
+000063d0: 6520 6170 7065 6e64 6564 2074 6f20 7468  e appended to th
+000063e0: 6520 7374 7265 616d 2c20 616e 6420 7468  e stream, and th
+000063f0: 6174 2074 6865 7920 6172 655c 6e6f 7264  at they are\nord
+00006400: 6572 6564 2065 7861 6374 6c79 2061 7320  ered exactly as 
+00006410: 7468 6579 2077 6572 6520 6170 7065 6e64  they were append
+00006420: 6564 2e5c 6e5c 6e60 6060 7079 7468 6f6e  ed.\n\n```python
+00006430: 5c6e 6173 7365 7274 206c 656e 2865 7665  \nassert len(eve
+00006440: 6e74 7329 203d 3d20 335c 6e5c 6e61 7373  nts) == 3\n\nass
+00006450: 6572 7420 6576 656e 7473 5b30 5d2e 7374  ert events[0].st
+00006460: 7265 616d 5f6e 616d 6520 3d3d 2073 7472  ream_name == str
+00006470: 6561 6d5f 6e61 6d65 315c 6e61 7373 6572  eam_name1\nasser
+00006480: 7420 6576 656e 7473 5b30 5d2e 7374 7265  t events[0].stre
+00006490: 616d 5f70 6f73 6974 696f 6e20 3d3d 2030  am_position == 0
+000064a0: 5c6e 6173 7365 7274 2065 7665 6e74 735b  \nassert events[
+000064b0: 305d 2e74 7970 6520 3d3d 2065 7665 6e74  0].type == event
+000064c0: 312e 7479 7065 5c6e 6173 7365 7274 2065  1.type\nassert e
+000064d0: 7665 6e74 735b 305d 2e64 6174 6120 3d3d  vents[0].data ==
+000064e0: 2065 7665 6e74 312e 6461 7461 5c6e 5c6e   event1.data\n\n
+000064f0: 6173 7365 7274 2065 7665 6e74 735b 315d  assert events[1]
+00006500: 2e73 7472 6561 6d5f 6e61 6d65 203d 3d20  .stream_name == 
+00006510: 7374 7265 616d 5f6e 616d 6531 5c6e 6173  stream_name1\nas
+00006520: 7365 7274 2065 7665 6e74 735b 315d 2e73  sert events[1].s
+00006530: 7472 6561 6d5f 706f 7369 7469 6f6e 203d  tream_position =
+00006540: 3d20 315c 6e61 7373 6572 7420 6576 656e  = 1\nassert even
+00006550: 7473 5b31 5d2e 7479 7065 203d 3d20 6576  ts[1].type == ev
+00006560: 656e 7432 2e74 7970 655c 6e61 7373 6572  ent2.type\nasser
+00006570: 7420 6576 656e 7473 5b31 5d2e 6461 7461  t events[1].data
+00006580: 203d 3d20 6576 656e 7432 2e64 6174 615c   == event2.data\
+00006590: 6e5c 6e61 7373 6572 7420 6576 656e 7473  n\nassert events
+000065a0: 5b32 5d2e 7374 7265 616d 5f6e 616d 6520  [2].stream_name 
+000065b0: 3d3d 2073 7472 6561 6d5f 6e61 6d65 315c  == stream_name1\
+000065c0: 6e61 7373 6572 7420 6576 656e 7473 5b32  nassert events[2
+000065d0: 5d2e 7374 7265 616d 5f70 6f73 6974 696f  ].stream_positio
+000065e0: 6e20 3d3d 2032 5c6e 6173 7365 7274 2065  n == 2\nassert e
+000065f0: 7665 6e74 735b 325d 2e74 7970 6520 3d3d  vents[2].type ==
+00006600: 2065 7665 6e74 332e 7479 7065 5c6e 6173   event3.type\nas
+00006610: 7365 7274 2065 7665 6e74 735b 325d 2e64  sert events[2].d
+00006620: 6174 6120 3d3d 2065 7665 6e74 332e 6461  ata == event3.da
+00006630: 7461 5c6e 6060 605c 6e5c 6e54 6865 2065  ta\n```\n\nThe e
+00006640: 7861 6d70 6c65 2062 656c 6f77 2073 686f  xample below sho
+00006650: 7773 2068 6f77 2074 6f20 7265 6164 2072  ws how to read r
+00006660: 6563 6f72 6465 6420 6576 656e 7473 2069  ecorded events i
+00006670: 6e20 6120 7374 7265 616d 2066 6f72 7761  n a stream forwa
+00006680: 7264 7320 6672 6f6d 5c6e 6120 7370 6563  rds from\na spec
+00006690: 6966 6963 2073 7472 6561 6d20 706f 7369  ific stream posi
+000066a0: 7469 6f6e 2074 6f20 7468 6520 656e 6420  tion to the end 
+000066b0: 6f66 2074 6865 2073 7472 6561 6d2e 5c6e  of the stream.\n
+000066c0: 5c6e 6060 6070 7974 686f 6e5c 6e65 7665  \n```python\neve
+000066d0: 6e74 7320 3d20 636c 6965 6e74 2e72 6561  nts = client.rea
+000066e0: 645f 7374 7265 616d 5f65 7665 6e74 7328  d_stream_events(
+000066f0: 5c6e 2020 2020 7374 7265 616d 5f6e 616d  \n    stream_nam
+00006700: 653d 7374 7265 616d 5f6e 616d 6531 2c5c  e=stream_name1,\
+00006710: 6e20 2020 2073 7472 6561 6d5f 706f 7369  n    stream_posi
+00006720: 7469 6f6e 3d31 2c5c 6e29 5c6e 5c6e 6173  tion=1,\n)\n\nas
+00006730: 7365 7274 206c 656e 2865 7665 6e74 7329  sert len(events)
+00006740: 203d 3d20 325c 6e5c 6e61 7373 6572 7420   == 2\n\nassert 
+00006750: 6576 656e 7473 5b30 5d2e 7374 7265 616d  events[0].stream
+00006760: 5f6e 616d 6520 3d3d 2073 7472 6561 6d5f  _name == stream_
+00006770: 6e61 6d65 315c 6e61 7373 6572 7420 6576  name1\nassert ev
+00006780: 656e 7473 5b30 5d2e 7374 7265 616d 5f70  ents[0].stream_p
+00006790: 6f73 6974 696f 6e20 3d3d 2031 5c6e 6173  osition == 1\nas
+000067a0: 7365 7274 2065 7665 6e74 735b 305d 2e74  sert events[0].t
+000067b0: 7970 6520 3d3d 2065 7665 6e74 322e 7479  ype == event2.ty
+000067c0: 7065 5c6e 6173 7365 7274 2065 7665 6e74  pe\nassert event
+000067d0: 735b 305d 2e64 6174 6120 3d3d 2065 7665  s[0].data == eve
+000067e0: 6e74 322e 6461 7461 5c6e 5c6e 6173 7365  nt2.data\n\nasse
+000067f0: 7274 2065 7665 6e74 735b 315d 2e73 7472  rt events[1].str
+00006800: 6561 6d5f 6e61 6d65 203d 3d20 7374 7265  eam_name == stre
+00006810: 616d 5f6e 616d 6531 5c6e 6173 7365 7274  am_name1\nassert
+00006820: 2065 7665 6e74 735b 315d 2e73 7472 6561   events[1].strea
+00006830: 6d5f 706f 7369 7469 6f6e 203d 3d20 325c  m_position == 2\
+00006840: 6e61 7373 6572 7420 6576 656e 7473 5b31  nassert events[1
+00006850: 5d2e 7479 7065 203d 3d20 6576 656e 7433  ].type == event3
+00006860: 2e74 7970 655c 6e61 7373 6572 7420 6576  .type\nassert ev
+00006870: 656e 7473 5b31 5d2e 6461 7461 203d 3d20  ents[1].data == 
+00006880: 6576 656e 7433 2e64 6174 615c 6e60 6060  event3.data\n```
+00006890: 5c6e 5c6e 5468 6520 6578 616d 706c 6520  \n\nThe example 
+000068a0: 6265 6c6f 7720 7368 6f77 7320 686f 7720  below shows how 
+000068b0: 746f 2072 6561 6420 7468 6520 7265 636f  to read the reco
+000068c0: 7264 6564 2065 7665 6e74 7320 696e 2061  rded events in a
+000068d0: 2073 7472 6561 6d20 6261 636b 7761 7264   stream backward
+000068e0: 7320 6672 6f6d 5c6e 7468 6520 656e 6420  s from\nthe end 
+000068f0: 6f66 2074 6865 2073 7472 6561 6d20 746f  of the stream to
+00006900: 2074 6865 2073 7461 7274 206f 6620 7468   the start of th
+00006910: 6520 7374 7265 616d 2e5c 6e5c 6e60 6060  e stream.\n\n```
+00006920: 7079 7468 6f6e 5c6e 6576 656e 7473 203d  python\nevents =
+00006930: 2063 6c69 656e 742e 7265 6164 5f73 7472   client.read_str
+00006940: 6561 6d5f 6576 656e 7473 285c 6e20 2020  eam_events(\n   
+00006950: 2073 7472 6561 6d5f 6e61 6d65 3d73 7472   stream_name=str
+00006960: 6561 6d5f 6e61 6d65 312c 5c6e 2020 2020  eam_name1,\n    
+00006970: 6261 636b 7761 7264 733d 5472 7565 2c5c  backwards=True,\
+00006980: 6e29 5c6e 5c6e 6173 7365 7274 206c 656e  n)\n\nassert len
+00006990: 2865 7665 6e74 7329 203d 3d20 335c 6e5c  (events) == 3\n\
+000069a0: 6e61 7373 6572 7420 6576 656e 7473 5b30  nassert events[0
+000069b0: 5d2e 7374 7265 616d 5f6e 616d 6520 3d3d  ].stream_name ==
+000069c0: 2073 7472 6561 6d5f 6e61 6d65 315c 6e61   stream_name1\na
+000069d0: 7373 6572 7420 6576 656e 7473 5b30 5d2e  ssert events[0].
+000069e0: 7374 7265 616d 5f70 6f73 6974 696f 6e20  stream_position 
+000069f0: 3d3d 2032 5c6e 6173 7365 7274 2065 7665  == 2\nassert eve
+00006a00: 6e74 735b 305d 2e74 7970 6520 3d3d 2065  nts[0].type == e
+00006a10: 7665 6e74 332e 7479 7065 5c6e 6173 7365  vent3.type\nasse
+00006a20: 7274 2065 7665 6e74 735b 305d 2e64 6174  rt events[0].dat
+00006a30: 6120 3d3d 2065 7665 6e74 332e 6461 7461  a == event3.data
+00006a40: 5c6e 5c6e 6173 7365 7274 2065 7665 6e74  \n\nassert event
+00006a50: 735b 315d 2e73 7472 6561 6d5f 6e61 6d65  s[1].stream_name
+00006a60: 203d 3d20 7374 7265 616d 5f6e 616d 6531   == stream_name1
+00006a70: 5c6e 6173 7365 7274 2065 7665 6e74 735b  \nassert events[
+00006a80: 315d 2e73 7472 6561 6d5f 706f 7369 7469  1].stream_positi
+00006a90: 6f6e 203d 3d20 315c 6e61 7373 6572 7420  on == 1\nassert 
+00006aa0: 6576 656e 7473 5b31 5d2e 7479 7065 203d  events[1].type =
+00006ab0: 3d20 6576 656e 7432 2e74 7970 655c 6e61  = event2.type\na
+00006ac0: 7373 6572 7420 6576 656e 7473 5b31 5d2e  ssert events[1].
+00006ad0: 6461 7461 203d 3d20 6576 656e 7432 2e64  data == event2.d
+00006ae0: 6174 615c 6e60 6060 5c6e 5c6e 5468 6520  ata\n```\n\nThe 
+00006af0: 6578 616d 706c 6520 6265 6c6f 7720 7368  example below sh
+00006b00: 6f77 7320 686f 7720 746f 2072 6561 6420  ows how to read 
+00006b10: 6120 6c69 6d69 7465 6420 6e75 6d62 6572  a limited number
+00006b20: 2028 7477 6f29 206f 6620 7468 6520 7265   (two) of the re
+00006b30: 636f 7264 6564 2065 7665 6e74 735c 6e69  corded events\ni
+00006b40: 6e20 6120 7374 7265 616d 2066 6f72 7761  n a stream forwa
+00006b50: 7264 7320 6672 6f6d 2074 6865 2073 7461  rds from the sta
+00006b60: 7274 206f 6620 7468 6520 7374 7265 616d  rt of the stream
+00006b70: 2e5c 6e5c 6e60 6060 7079 7468 6f6e 5c6e  .\n\n```python\n
+00006b80: 6576 656e 7473 203d 2063 6c69 656e 742e  events = client.
+00006b90: 7265 6164 5f73 7472 6561 6d5f 6576 656e  read_stream_even
+00006ba0: 7473 285c 6e20 2020 2073 7472 6561 6d5f  ts(\n    stream_
+00006bb0: 6e61 6d65 3d73 7472 6561 6d5f 6e61 6d65  name=stream_name
+00006bc0: 312c 5c6e 2020 2020 6c69 6d69 743d 322c  1,\n    limit=2,
+00006bd0: 5c6e 295c 6e5c 6e61 7373 6572 7420 6c65  \n)\n\nassert le
+00006be0: 6e28 6576 656e 7473 2920 3d3d 2032 5c6e  n(events) == 2\n
+00006bf0: 5c6e 6173 7365 7274 2065 7665 6e74 735b  \nassert events[
+00006c00: 305d 2e73 7472 6561 6d5f 6e61 6d65 203d  0].stream_name =
+00006c10: 3d20 7374 7265 616d 5f6e 616d 6531 5c6e  = stream_name1\n
+00006c20: 6173 7365 7274 2065 7665 6e74 735b 305d  assert events[0]
+00006c30: 2e73 7472 6561 6d5f 706f 7369 7469 6f6e  .stream_position
+00006c40: 203d 3d20 305c 6e61 7373 6572 7420 6576   == 0\nassert ev
+00006c50: 656e 7473 5b30 5d2e 7479 7065 203d 3d20  ents[0].type == 
+00006c60: 6576 656e 7431 2e74 7970 655c 6e61 7373  event1.type\nass
+00006c70: 6572 7420 6576 656e 7473 5b30 5d2e 6461  ert events[0].da
+00006c80: 7461 203d 3d20 6576 656e 7431 2e64 6174  ta == event1.dat
+00006c90: 615c 6e5c 6e61 7373 6572 7420 6576 656e  a\n\nassert even
+00006ca0: 7473 5b31 5d2e 7374 7265 616d 5f6e 616d  ts[1].stream_nam
+00006cb0: 6520 3d3d 2073 7472 6561 6d5f 6e61 6d65  e == stream_name
+00006cc0: 315c 6e61 7373 6572 7420 6576 656e 7473  1\nassert events
+00006cd0: 5b31 5d2e 7374 7265 616d 5f70 6f73 6974  [1].stream_posit
+00006ce0: 696f 6e20 3d3d 2031 5c6e 6173 7365 7274  ion == 1\nassert
+00006cf0: 2065 7665 6e74 735b 315d 2e74 7970 6520   events[1].type 
+00006d00: 3d3d 2065 7665 6e74 322e 7479 7065 5c6e  == event2.type\n
+00006d10: 6173 7365 7274 2065 7665 6e74 735b 315d  assert events[1]
+00006d20: 2e64 6174 6120 3d3d 2065 7665 6e74 322e  .data == event2.
+00006d30: 6461 7461 5c6e 6060 605c 6e5c 6e54 6865  data\n```\n\nThe
+00006d40: 2065 7861 6d70 6c65 2062 656c 6f77 2073   example below s
+00006d50: 686f 7773 2068 6f77 2074 6f20 7265 6164  hows how to read
+00006d60: 2061 206c 696d 6974 6564 206e 756d 6265   a limited numbe
+00006d70: 7220 286f 6e65 2920 6f66 2074 6865 2072  r (one) of the r
+00006d80: 6563 6f72 6465 645c 6e65 7665 6e74 7320  ecorded\nevents 
+00006d90: 696e 2061 2073 7472 6561 6d20 6261 636b  in a stream back
+00006da0: 7761 7264 7320 6672 6f6d 2061 2067 6976  wards from a giv
+00006db0: 656e 2073 7472 6561 6d20 706f 7369 7469  en stream positi
+00006dc0: 6f6e 2e5c 6e5c 6e60 6060 7079 7468 6f6e  on.\n\n```python
+00006dd0: 5c6e 6576 656e 7473 203d 2063 6c69 656e  \nevents = clien
+00006de0: 742e 7265 6164 5f73 7472 6561 6d5f 6576  t.read_stream_ev
+00006df0: 656e 7473 285c 6e20 2020 2073 7472 6561  ents(\n    strea
+00006e00: 6d5f 6e61 6d65 3d73 7472 6561 6d5f 6e61  m_name=stream_na
+00006e10: 6d65 312c 5c6e 2020 2020 7374 7265 616d  me1,\n    stream
+00006e20: 5f70 6f73 6974 696f 6e3d 322c 5c6e 2020  _position=2,\n  
+00006e30: 2020 6261 636b 7761 7264 733d 5472 7565    backwards=True
+00006e40: 2c5c 6e20 2020 206c 696d 6974 3d31 2c5c  ,\n    limit=1,\
+00006e50: 6e29 5c6e 5c6e 6173 7365 7274 206c 656e  n)\n\nassert len
+00006e60: 2865 7665 6e74 7329 203d 3d20 315c 6e5c  (events) == 1\n\
+00006e70: 6e61 7373 6572 7420 6576 656e 7473 5b30  nassert events[0
+00006e80: 5d2e 7374 7265 616d 5f6e 616d 6520 3d3d  ].stream_name ==
+00006e90: 2073 7472 6561 6d5f 6e61 6d65 315c 6e61   stream_name1\na
+00006ea0: 7373 6572 7420 6576 656e 7473 5b30 5d2e  ssert events[0].
+00006eb0: 7374 7265 616d 5f70 6f73 6974 696f 6e20  stream_position 
+00006ec0: 3d3d 2032 5c6e 6173 7365 7274 2065 7665  == 2\nassert eve
+00006ed0: 6e74 735b 305d 2e74 7970 6520 3d3d 2065  nts[0].type == e
+00006ee0: 7665 6e74 332e 7479 7065 5c6e 6173 7365  vent3.type\nasse
+00006ef0: 7274 2065 7665 6e74 735b 305d 2e64 6174  rt events[0].dat
+00006f00: 6120 3d3d 2065 7665 6e74 332e 6461 7461  a == event3.data
+00006f10: 5c6e 6060 605c 6e5c 6e54 6865 2060 7265  \n```\n\nThe `re
+00006f20: 6164 5f73 7472 6561 6d5f 6576 656e 7473  ad_stream_events
+00006f30: 2829 6020 6d65 7468 6f64 2077 696c 6c20  ()` method will 
+00006f40: 7261 6973 6520 6120 604e 6f74 466f 756e  raise a `NotFoun
+00006f50: 6460 2065 7863 6570 7469 6f6e 2069 6620  d` exception if 
+00006f60: 7468 6520 7374 7265 616d 5c6e 646f 6573  the stream\ndoes
+00006f70: 206e 6f74 2065 7869 7374 2e5c 6e5c 6e60   not exist.\n\n`
+00006f80: 6060 7079 7468 6f6e 5c6e 6672 6f6d 2065  ``python\nfrom e
+00006f90: 7364 6263 6c69 656e 742e 6578 6365 7074  sdbclient.except
+00006fa0: 696f 6e73 2069 6d70 6f72 7420 4e6f 7446  ions import NotF
+00006fb0: 6f75 6e64 5c6e 5c6e 5c6e 7472 793a 5c6e  ound\n\n\ntry:\n
+00006fc0: 2020 2020 636c 6965 6e74 2e72 6561 645f      client.read_
+00006fd0: 7374 7265 616d 5f65 7665 6e74 7328 5c27  stream_events(\'
+00006fe0: 6e6f 742d 612d 7374 7265 616d 5c27 295c  not-a-stream\')\
+00006ff0: 6e65 7863 6570 7420 4e6f 7446 6f75 6e64  nexcept NotFound
+00007000: 3a5c 6e20 2020 2070 6173 7320 2023 2054  :\n    pass  # T
+00007010: 6865 2073 7472 6561 6d20 5c27 6e6f 742d  he stream \'not-
+00007020: 612d 7374 7265 616d 5c27 2064 6f65 7320  a-stream\' does 
+00007030: 6e6f 7420 6578 6973 742e 5c6e 656c 7365  not exist.\nelse
+00007040: 3a5c 6e20 2020 2072 6169 7365 2045 7863  :\n    raise Exc
+00007050: 6570 7469 6f6e 2822 5368 6f75 6c64 6e5c  eption("Shouldn\
+00007060: 2774 2067 6574 2068 6572 6522 295c 6e60  't get here")\n`
+00007070: 6060 5c6e 5c6e 2323 2320 486f 7720 746f  ``\n\n### How to
+00007080: 2069 6d70 6c65 6d65 6e74 2073 6e61 7073   implement snaps
+00007090: 686f 7474 696e 6720 7769 7468 2045 7665  hotting with Eve
+000070a0: 6e74 5374 6f72 6544 425c 6e5c 6e45 7665  ntStoreDB\n\nEve
+000070b0: 6e74 2d73 6f75 7263 6564 2061 6767 7265  nt-sourced aggre
+000070c0: 6761 7465 7320 6172 6520 7479 7069 6361  gates are typica
+000070d0: 6c6c 7920 7265 636f 6e73 7472 7563 7465  lly reconstructe
+000070e0: 6420 6672 6f6d 2072 6563 6f72 6465 6420  d from recorded 
+000070f0: 6576 656e 7473 2062 7920 6361 6c6c 696e  events by callin
+00007100: 675c 6e61 206d 7574 6174 6f72 2066 756e  g\na mutator fun
+00007110: 6374 696f 6e20 666f 7220 6561 6368 2072  ction for each r
+00007120: 6563 6f72 6465 6420 6576 656e 742c 2065  ecorded event, e
+00007130: 766f 6c76 696e 6720 6672 6f6d 2061 6e20  volving from an 
+00007140: 696e 6974 6961 6c20 7374 6174 655c 6e60  initial state\n`
+00007150: 4e6f 6e65 6020 746f 2074 6865 2063 7572  None` to the cur
+00007160: 7265 6e74 2073 7461 7465 206f 6620 7468  rent state of th
+00007170: 6520 6167 6772 6567 6174 652e 2054 6865  e aggregate. The
+00007180: 2066 756e 6374 696f 6e20 6067 6574 5f61   function `get_a
+00007190: 6767 7265 6761 7465 2829 6020 7368 6f77  ggregate()` show
+000071a0: 735c 6e68 6f77 2074 6869 7320 6361 6e20  s\nhow this can 
+000071b0: 6265 2064 6f6e 652e 2054 6865 2061 6767  be done. The agg
+000071c0: 7265 6761 7465 2049 4420 6973 2075 7365  regate ID is use
+000071d0: 6420 6173 2061 2073 7472 6561 6d20 6e61  d as a stream na
+000071e0: 6d65 2e20 5468 6520 6578 6365 7074 696f  me. The exceptio
+000071f0: 6e5c 6e60 4167 6772 6567 6174 654e 6f74  n\n`AggregateNot
+00007200: 466f 756e 6460 2069 7320 7261 6973 6564  Found` is raised
+00007210: 2069 6620 7468 6520 6167 6772 6567 6174   if the aggregat
+00007220: 6520 7374 7265 616d 2069 7320 6e6f 7420  e stream is not 
+00007230: 666f 756e 642e 5c6e 5c6e 6060 6070 7974  found.\n\n```pyt
+00007240: 686f 6e5c 6e64 6566 2067 6574 5f61 6767  hon\ndef get_agg
+00007250: 7265 6761 7465 2861 6767 7265 6761 7465  regate(aggregate
+00007260: 5f69 642c 206d 7574 6174 6f72 5f66 756e  _id, mutator_fun
+00007270: 6329 3a5c 6e20 2020 2073 7472 6561 6d5f  c):\n    stream_
+00007280: 6e61 6d65 203d 2061 6767 7265 6761 7465  name = aggregate
+00007290: 5f69 645c 6e5c 6e20 2020 2023 2047 6574  _id\n\n    # Get
+000072a0: 2072 6563 6f72 6465 6420 6576 656e 7473   recorded events
+000072b0: 2e5c 6e20 2020 2074 7279 3a5c 6e20 2020  .\n    try:\n   
+000072c0: 2020 2020 2065 7665 6e74 7320 3d20 636c       events = cl
+000072d0: 6965 6e74 2e72 6561 645f 7374 7265 616d  ient.read_stream
+000072e0: 5f65 7665 6e74 7328 5c6e 2020 2020 2020  _events(\n      
+000072f0: 2020 2020 2020 7374 7265 616d 5f6e 616d        stream_nam
+00007300: 653d 7374 7265 616d 5f6e 616d 652c 5c6e  e=stream_name,\n
+00007310: 2020 2020 2020 2020 2020 2020 7374 7265              stre
+00007320: 616d 5f70 6f73 6974 696f 6e3d 4e6f 6e65  am_position=None
+00007330: 5c6e 2020 2020 2020 2020 295c 6e20 2020  \n        )\n   
+00007340: 2065 7863 6570 7420 4e6f 7446 6f75 6e64   except NotFound
+00007350: 2061 7320 653a 5c6e 2020 2020 2020 2020   as e:\n        
+00007360: 7261 6973 6520 4167 6772 6567 6174 654e  raise AggregateN
+00007370: 6f74 466f 756e 6428 6167 6772 6567 6174  otFound(aggregat
+00007380: 655f 6964 2920 6672 6f6d 2065 5c6e 2020  e_id) from e\n  
+00007390: 2020 656c 7365 3a5c 6e20 2020 2020 2020    else:\n       
+000073a0: 2023 2052 6563 6f6e 7374 7275 6374 2061   # Reconstruct a
+000073b0: 6767 7265 6761 7465 2066 726f 6d20 7265  ggregate from re
+000073c0: 636f 7264 6564 2065 7665 6e74 732e 5c6e  corded events.\n
+000073d0: 2020 2020 2020 2020 6167 6772 6567 6174          aggregat
+000073e0: 6520 3d20 4e6f 6e65 5c6e 2020 2020 2020  e = None\n      
+000073f0: 2020 666f 7220 6576 656e 7420 696e 2065    for event in e
+00007400: 7665 6e74 733a 5c6e 2020 2020 2020 2020  vents:\n        
+00007410: 2020 2020 6167 6772 6567 6174 6520 3d20      aggregate = 
+00007420: 6d75 7461 746f 725f 6675 6e63 2861 6767  mutator_func(agg
+00007430: 7265 6761 7465 2c20 6576 656e 7429 5c6e  regate, event)\n
+00007440: 2020 2020 2020 2020 7265 7475 726e 2061          return a
+00007450: 6767 7265 6761 7465 5c6e 5c6e 5c6e 636c  ggregate\n\n\ncl
+00007460: 6173 7320 4167 6772 6567 6174 654e 6f74  ass AggregateNot
+00007470: 466f 756e 6428 4578 6365 7074 696f 6e29  Found(Exception)
+00007480: 3a5c 6e20 2020 2022 2222 5261 6973 6564  :\n    """Raised
+00007490: 2077 6865 6e20 616e 2061 6767 7265 6761   when an aggrega
+000074a0: 7465 2069 7320 6e6f 7420 666f 756e 642e  te is not found.
+000074b0: 2222 225c 6e60 6060 5c6e 5c6e 536e 6170  """\n```\n\nSnap
+000074c0: 7368 6f74 7320 6361 6e20 696d 7072 6f76  shots can improv
+000074d0: 6520 7468 6520 7065 7266 6f72 6d61 6e63  e the performanc
+000074e0: 6520 6f66 2061 6767 7265 6761 7465 7320  e of aggregates 
+000074f0: 7468 6174 2077 6f75 6c64 206f 7468 6572  that would other
+00007500: 7769 7365 2062 655c 6e72 6563 6f6e 7374  wise be\nreconst
+00007510: 7275 6374 6564 2066 726f 6d20 7665 7279  ructed from very
+00007520: 206c 6f6e 6720 7374 7265 616d 732e 2048   long streams. H
+00007530: 6f77 6576 6572 2c20 6974 2069 7320 6765  owever, it is ge
+00007540: 6e65 7261 6c6c 7920 7265 636f 6d6d 656e  nerally recommen
+00007550: 6465 6420 746f 5c6e 6465 7369 676e 2061  ded to\ndesign a
+00007560: 6767 7265 6761 7465 7320 746f 2068 6176  ggregates to hav
+00007570: 6520 6120 6669 6e69 7465 206c 6966 6563  e a finite lifec
+00007580: 7963 6c65 2c20 616e 6420 6865 6e63 6520  ycle, and hence 
+00007590: 7265 6c61 7469 7665 6c79 2073 686f 7274  relatively short
+000075a0: 2073 7472 6561 6d73 2c5c 6e74 6865 7265   streams,\nthere
+000075b0: 6279 2061 766f 6964 696e 6720 7468 6520  by avoiding the 
+000075c0: 6e65 6564 2066 6f72 2073 6e61 7073 686f  need for snapsho
+000075d0: 7474 696e 672e 2054 6869 7320 2268 6f77  tting. This "how
+000075e0: 2074 6f22 2073 6563 7469 6f6e 2069 7320   to" section is 
+000075f0: 696e 7465 6e64 6564 5c6e 6d65 7265 6c79  intended\nmerely
+00007600: 2074 6f20 7368 6f77 2068 6f77 2073 6e61   to show how sna
+00007610: 7073 686f 7474 696e 6720 6f66 2061 6767  pshotting of agg
+00007620: 7265 6761 7465 7320 6361 6e20 6265 2069  regates can be i
+00007630: 6d70 6c65 6d65 6e74 6564 2077 6974 6820  mplemented with 
+00007640: 4576 656e 7453 746f 7265 4442 5c6e 7573  EventStoreDB\nus
+00007650: 696e 6720 7468 6973 2050 7974 686f 6e20  ing this Python 
+00007660: 636c 6965 6e74 2e5c 6e5c 6e53 6e61 7073  client.\n\nSnaps
+00007670: 686f 7474 696e 6720 6f66 2061 6767 7265  hotting of aggre
+00007680: 6761 7465 7320 6361 6e20 6265 2069 6d70  gates can be imp
+00007690: 6c65 6d65 6e74 6564 2062 7920 7265 636f  lemented by reco
+000076a0: 7264 696e 6720 7468 6520 6375 7272 656e  rding the curren
+000076b0: 7420 7374 6174 6520 6f66 5c6e 616e 2061  t state of\nan a
+000076c0: 6767 7265 6761 7465 2061 7320 6120 6e65  ggregate as a ne
+000076d0: 7720 6576 656e 742e 5c6e 5c6e 4966 2061  w event.\n\nIf a
+000076e0: 6e20 6167 6772 6567 6174 6520 6f62 6a65  n aggregate obje
+000076f0: 6374 2068 6173 2061 2076 6572 7369 6f6e  ct has a version
+00007700: 206e 756d 6265 7220 7468 6174 2063 6f72   number that cor
+00007710: 7265 7370 6f6e 6473 2074 6f20 7468 6520  responds to the 
+00007720: 7374 7265 616d 2070 6f73 6974 696f 6e20  stream position 
+00007730: 6f66 5c6e 7468 6520 6c61 7374 2065 7665  of\nthe last eve
+00007740: 6e74 2074 6861 7420 7761 7320 7573 6564  nt that was used
+00007750: 2074 6f20 7265 636f 6e73 7472 7563 7420   to reconstruct 
+00007760: 7468 6520 6167 6772 6567 6174 652c 2061  the aggregate, a
+00007770: 6e64 2074 6869 7320 7665 7273 696f 6e20  nd this version 
+00007780: 6e75 6d62 6572 5c6e 6973 2072 6563 6f72  number\nis recor
+00007790: 6465 6420 696e 2074 6865 2073 6e61 7073  ded in the snaps
+000077a0: 686f 7420 6d65 7461 6461 7461 2c20 7468  hot metadata, th
+000077b0: 656e 2061 6e79 2065 7665 6e74 7320 7468  en any events th
+000077c0: 6174 2061 7265 2072 6563 6f72 6465 6420  at are recorded 
+000077d0: 6166 7465 7220 7468 655c 6e73 6e61 7073  after the\nsnaps
+000077e0: 686f 7420 6361 6e20 6265 2073 656c 6563  hot can be selec
+000077f0: 7465 6420 7573 696e 6720 7468 6973 2076  ted using this v
+00007800: 6572 7369 6f6e 206e 756d 6265 722e 2054  ersion number. T
+00007810: 6865 2061 6767 7265 6761 7465 2063 616e  he aggregate can
+00007820: 2074 6865 6e20 6265 5c6e 7265 636f 6e73   then be\nrecons
+00007830: 7472 7563 7465 6420 6672 6f6d 2074 6865  tructed from the
+00007840: 206c 6173 7420 736e 6170 7368 6f74 2061   last snapshot a
+00007850: 6e64 2061 6e79 2073 7562 7365 7175 656e  nd any subsequen
+00007860: 7420 6576 656e 7473 2c20 7769 7468 6f75  t events, withou
+00007870: 7420 6861 7669 6e67 5c6e 746f 2072 6570  t having\nto rep
+00007880: 6c61 7920 7468 6520 656e 7469 7265 2068  lay the entire h
+00007890: 6973 746f 7279 2e5c 6e5c 6e57 6520 7769  istory.\n\nWe wi
+000078a0: 6c6c 2075 7365 2061 2073 6570 6172 6174  ll use a separat
+000078b0: 6520 7374 7265 616d 2066 6f72 2061 6e20  e stream for an 
+000078c0: 6167 6772 6567 6174 655c 2773 2073 6e61  aggregate\'s sna
+000078d0: 7073 686f 7473 2074 6861 7420 6973 206e  pshots that is n
+000078e0: 616d 6564 2061 6674 6572 2074 6865 5c6e  amed after the\n
+000078f0: 7374 7265 616d 2075 7365 6420 666f 7220  stream used for 
+00007900: 7265 636f 7264 696e 6720 6974 7320 6576  recording its ev
+00007910: 656e 7473 2e20 5468 6520 6e61 6d65 206f  ents. The name o
+00007920: 6620 7468 6520 736e 6170 7368 6f74 2073  f the snapshot s
+00007930: 7472 6561 6d20 7769 6c6c 2062 655c 6e63  tream will be\nc
+00007940: 6f6e 7374 7275 6374 6564 2062 7920 7072  onstructed by pr
+00007950: 6566 6978 696e 6720 7468 6520 6167 6772  efixing the aggr
+00007960: 6567 6174 655c 2773 2073 7472 6561 6d20  egate\'s stream 
+00007970: 6e61 6d65 2077 6974 6820 605c 2724 736e  name with `\'$sn
+00007980: 6170 7368 6f74 2d5c 2760 2e5c 6e5c 6e60  apshot-\'`.\n\n`
+00007990: 6060 7079 7468 6f6e 5c6e 534e 4150 5348  ``python\nSNAPSH
+000079a0: 4f54 5f50 5245 4649 5820 3d20 5c27 2473  OT_PREFIX = \'$s
+000079b0: 6e61 7073 686f 742d 5c27 5c6e 5c6e 6465  napshot-\'\n\nde
+000079c0: 6620 6d61 6b65 5f73 6e61 7073 686f 745f  f make_snapshot_
+000079d0: 7374 7265 616d 5f6e 616d 6528 7374 7265  stream_name(stre
+000079e0: 616d 5f6e 616d 6529 3a5c 6e20 2020 2072  am_name):\n    r
+000079f0: 6574 7572 6e20 665c 277b 534e 4150 5348  eturn f\'{SNAPSH
+00007a00: 4f54 5f50 5245 4649 587d 7b73 7472 6561  OT_PREFIX}{strea
+00007a10: 6d5f 6e61 6d65 7d5c 275c 6e5c 6e5c 6e64  m_name}\'\n\n\nd
+00007a20: 6566 2073 7472 6970 5f73 6e61 7073 686f  ef strip_snapsho
+00007a30: 745f 7374 7265 616d 5f6e 616d 6528 736e  t_stream_name(sn
+00007a40: 6170 7368 6f74 5f73 7472 6561 6d5f 6e61  apshot_stream_na
+00007a50: 6d65 293a 5c6e 2020 2020 7265 7475 726e  me):\n    return
+00007a60: 2073 6e61 7073 686f 745f 7374 7265 616d   snapshot_stream
+00007a70: 5f6e 616d 652e 6c73 7472 6970 2853 4e41  _name.lstrip(SNA
+00007a80: 5053 484f 545f 5052 4546 4958 295c 6e60  PSHOT_PREFIX)\n`
+00007a90: 6060 5c6e 5c6e 4c65 745c 2773 2072 6564  ``\n\nLet\'s red
+00007aa0: 6566 696e 6520 7468 6520 6067 6574 5f61  efine the `get_a
+00007ab0: 6767 7265 6761 7465 2829 6020 6675 6e63  ggregate()` func
+00007ac0: 7469 6f6e 2c20 736f 2074 6861 7420 6974  tion, so that it
+00007ad0: 206c 6f6f 6b73 2066 6f72 2061 2073 6e61   looks for a sna
+00007ae0: 7073 686f 7420 6576 656e 742c 5c6e 7468  pshot event,\nth
+00007af0: 656e 2073 656c 6563 7473 2073 7562 7365  en selects subse
+00007b00: 7175 656e 7420 6167 6772 6567 6174 6520  quent aggregate 
+00007b10: 6576 656e 7473 2c20 616e 6420 7468 656e  events, and then
+00007b20: 2063 616c 6c73 2061 206d 7574 6174 6f72   calls a mutator
+00007b30: 2066 756e 6374 696f 6e20 666f 7220 6561   function for ea
+00007b40: 6368 5c6e 7265 636f 7264 6564 2065 7665  ch\nrecorded eve
+00007b50: 6e74 2e20 5765 2077 696c 6c20 7573 6520  nt. We will use 
+00007b60: 4a53 4f4e 2074 6f20 7365 7269 616c 697a  JSON to serializ
+00007b70: 6520 616e 6420 6465 7365 7269 616c 697a  e and deserializ
+00007b80: 6520 5079 7468 6f6e 2060 6469 6374 6020  e Python `dict` 
+00007b90: 6f62 6a65 6374 732e 5c6e 5c6e 4e6f 7469  objects.\n\nNoti
+00007ba0: 6365 2074 6861 7420 7468 6520 6167 6772  ce that the aggr
+00007bb0: 6567 6174 6520 6576 656e 7473 2061 7265  egate events are
+00007bc0: 2072 6561 6420 6672 6f6d 2061 2073 7472   read from a str
+00007bd0: 6561 6d20 666f 7220 6167 6772 6567 6174  eam for aggregat
+00007be0: 655c 6e65 7665 6e74 732c 2077 6869 6c73  e\nevents, whils
+00007bf0: 7420 7468 6520 736e 6170 7368 6f74 2069  t the snapshot i
+00007c00: 7320 7265 6164 2066 726f 6d20 6120 7365  s read from a se
+00007c10: 7061 7261 7465 2073 7472 6561 6d20 666f  parate stream fo
+00007c20: 7220 6167 6772 6567 6174 6520 736e 6170  r aggregate snap
+00007c30: 7368 6f74 732e 5c6e 5c6e 6060 6070 7974  shots.\n\n```pyt
+00007c40: 686f 6e5c 6e69 6d70 6f72 7420 6a73 6f6e  hon\nimport json
+00007c50: 5c6e 5c6e 5c6e 6465 6620 6765 745f 6167  \n\n\ndef get_ag
+00007c60: 6772 6567 6174 6528 6167 6772 6567 6174  gregate(aggregat
+00007c70: 655f 6964 2c20 6d75 7461 746f 725f 6675  e_id, mutator_fu
+00007c80: 6e63 293a 5c6e 2020 2020 7374 7265 616d  nc):\n    stream
+00007c90: 5f6e 616d 6520 3d20 6167 6772 6567 6174  _name = aggregat
+00007ca0: 655f 6964 5c6e 2020 2020 7265 636f 7264  e_id\n    record
+00007cb0: 6564 5f65 7665 6e74 7320 3d20 5b5d 5c6e  ed_events = []\n
+00007cc0: 5c6e 2020 2020 2320 4c6f 6f6b 2066 6f72  \n    # Look for
+00007cd0: 2061 2073 6e61 7073 686f 742e 5c6e 2020   a snapshot.\n  
+00007ce0: 2020 7472 793a 5c6e 2020 2020 2020 2020    try:\n        
+00007cf0: 736e 6170 7368 6f74 7320 3d20 636c 6965  snapshots = clie
+00007d00: 6e74 2e72 6561 645f 7374 7265 616d 5f65  nt.read_stream_e
+00007d10: 7665 6e74 7328 5c6e 2020 2020 2020 2020  vents(\n        
+00007d20: 2020 2020 7374 7265 616d 5f6e 616d 653d      stream_name=
+00007d30: 6d61 6b65 5f73 6e61 7073 686f 745f 7374  make_snapshot_st
+00007d40: 7265 616d 5f6e 616d 6528 7374 7265 616d  ream_name(stream
+00007d50: 5f6e 616d 6529 2c5c 6e20 2020 2020 2020  _name),\n       
+00007d60: 2020 2020 2062 6163 6b77 6172 6473 3d54       backwards=T
+00007d70: 7275 652c 5c6e 2020 2020 2020 2020 2020  rue,\n          
+00007d80: 2020 6c69 6d69 743d 315c 6e20 2020 2020    limit=1\n     
+00007d90: 2020 2029 5c6e 2020 2020 6578 6365 7074     )\n    except
+00007da0: 204e 6f74 466f 756e 643a 5c6e 2020 2020   NotFound:\n    
+00007db0: 2020 2020 7374 7265 616d 5f70 6f73 6974      stream_posit
+00007dc0: 696f 6e20 3d20 4e6f 6e65 5c6e 2020 2020  ion = None\n    
+00007dd0: 656c 7365 3a5c 6e20 2020 2020 2020 2073  else:\n        s
+00007de0: 6e61 7073 686f 7420 3d20 736e 6170 7368  napshot = snapsh
+00007df0: 6f74 735b 305d 5c6e 2020 2020 2020 2020  ots[0]\n        
+00007e00: 7374 7265 616d 5f70 6f73 6974 696f 6e20  stream_position 
+00007e10: 3d20 6465 7365 7269 616c 697a 6528 736e  = deserialize(sn
+00007e20: 6170 7368 6f74 2e6d 6574 6164 6174 6129  apshot.metadata)
+00007e30: 5b5c 2776 6572 7369 6f6e 5c27 5d20 2b20  [\'version\'] + 
+00007e40: 315c 6e20 2020 2020 2020 2072 6563 6f72  1\n        recor
+00007e50: 6465 645f 6576 656e 7473 2e61 7070 656e  ded_events.appen
+00007e60: 6428 736e 6170 7368 6f74 295c 6e5c 6e20  d(snapshot)\n\n 
+00007e70: 2020 2023 2047 6574 2073 7562 7365 7175     # Get subsequ
+00007e80: 656e 7420 6576 656e 7473 2e5c 6e20 2020  ent events.\n   
+00007e90: 2074 7279 3a5c 6e20 2020 2020 2020 2065   try:\n        e
+00007ea0: 7665 6e74 7320 3d20 636c 6965 6e74 2e72  vents = client.r
+00007eb0: 6561 645f 7374 7265 616d 5f65 7665 6e74  ead_stream_event
+00007ec0: 7328 5c6e 2020 2020 2020 2020 2020 2020  s(\n            
+00007ed0: 7374 7265 616d 5f6e 616d 653d 7374 7265  stream_name=stre
+00007ee0: 616d 5f6e 616d 652c 5c6e 2020 2020 2020  am_name,\n      
+00007ef0: 2020 2020 2020 7374 7265 616d 5f70 6f73        stream_pos
+00007f00: 6974 696f 6e3d 7374 7265 616d 5f70 6f73  ition=stream_pos
+00007f10: 6974 696f 6e5c 6e20 2020 2020 2020 2029  ition\n        )
+00007f20: 5c6e 2020 2020 6578 6365 7074 204e 6f74  \n    except Not
+00007f30: 466f 756e 6420 6173 2065 3a5c 6e20 2020  Found as e:\n   
+00007f40: 2020 2020 2072 6169 7365 2041 6767 7265       raise Aggre
+00007f50: 6761 7465 4e6f 7446 6f75 6e64 2861 6767  gateNotFound(agg
+00007f60: 7265 6761 7465 5f69 6429 2066 726f 6d20  regate_id) from 
+00007f70: 655c 6e20 2020 2065 6c73 653a 5c6e 2020  e\n    else:\n  
+00007f80: 2020 2020 2020 7265 636f 7264 6564 5f65        recorded_e
+00007f90: 7665 6e74 7320 2b3d 2065 7665 6e74 735c  vents += events\
+00007fa0: 6e5c 6e20 2020 2023 2052 6563 6f6e 7374  n\n    # Reconst
+00007fb0: 7275 6374 2061 6767 7265 6761 7465 2066  ruct aggregate f
+00007fc0: 726f 6d20 7265 636f 7264 6564 2065 7665  rom recorded eve
+00007fd0: 6e74 732e 5c6e 2020 2020 6167 6772 6567  nts.\n    aggreg
+00007fe0: 6174 6520 3d20 4e6f 6e65 5c6e 2020 2020  ate = None\n    
+00007ff0: 666f 7220 6576 656e 7420 696e 2072 6563  for event in rec
+00008000: 6f72 6465 645f 6576 656e 7473 3a5c 6e20  orded_events:\n 
+00008010: 2020 2020 2020 2061 6767 7265 6761 7465         aggregate
+00008020: 203d 206d 7574 6174 6f72 5f66 756e 6328   = mutator_func(
+00008030: 6167 6772 6567 6174 652c 2065 7665 6e74  aggregate, event
+00008040: 295c 6e5c 6e20 2020 2072 6574 7572 6e20  )\n\n    return 
+00008050: 6167 6772 6567 6174 655c 6e5c 6e5c 6e64  aggregate\n\n\nd
+00008060: 6566 2073 6572 6961 6c69 7a65 2864 293a  ef serialize(d):
+00008070: 5c6e 2020 2020 7265 7475 726e 206a 736f  \n    return jso
+00008080: 6e2e 6475 6d70 7328 6429 2e65 6e63 6f64  n.dumps(d).encod
+00008090: 6528 295c 6e5c 6e5c 6e64 6566 2064 6573  e()\n\n\ndef des
+000080a0: 6572 6961 6c69 7a65 2873 293a 5c6e 2020  erialize(s):\n  
+000080b0: 2020 7265 7475 726e 206a 736f 6e2e 6c6f    return json.lo
+000080c0: 6164 7328 732e 6465 636f 6465 2829 295c  ads(s.decode())\
+000080d0: 6e60 6060 5c6e 5c6e 546f 2073 686f 7720  n```\n\nTo show 
+000080e0: 686f 7720 7468 6973 2063 616e 2062 6520  how this can be 
+000080f0: 7573 6564 2c20 6c65 745c 2773 2064 6566  used, let\'s def
+00008100: 696e 6520 616e 2022 696d 6d75 7461 626c  ine an "immutabl
+00008110: 6522 2060 446f 6760 2061 6767 7265 6761  e" `Dog` aggrega
+00008120: 7465 2063 6c61 7373 2c20 7769 7468 5c6e  te class, with\n
+00008130: 6174 7472 6962 7574 6573 2060 6e61 6d65  attributes `name
+00008140: 6020 616e 6420 6074 7269 636b 7360 2e20  ` and `tricks`. 
+00008150: 5468 6520 6174 7472 6962 7574 6573 2060  The attributes `
+00008160: 6964 6020 616e 6420 6076 6572 7369 6f6e  id` and `version
+00008170: 6020 7769 6c6c 2069 6e64 6963 6174 6520  ` will indicate 
+00008180: 616e 5c6e 6167 6772 6567 6174 6520 6f62  an\naggregate ob
+00008190: 6a65 6374 5c27 7320 4944 2061 6e64 2076  ject\'s ID and v
+000081a0: 6572 7369 6f6e 206e 756d 6265 722e 2054  ersion number. T
+000081b0: 6865 2061 7474 7269 6275 7465 2060 6973  he attribute `is
+000081c0: 5f66 726f 6d5f 736e 6170 7368 6f74 6020  _from_snapshot` 
+000081d0: 6973 2061 6464 6564 5c6e 6865 7265 206d  is added\nhere m
+000081e0: 6572 656c 7920 746f 2064 656d 6f6e 7374  erely to demonst
+000081f0: 7261 7465 2062 656c 6f77 2077 6865 6e20  rate below when 
+00008200: 616e 2061 6767 7265 6761 7465 206f 626a  an aggregate obj
+00008210: 6563 7420 6861 7320 6265 656e 2072 6563  ect has been rec
+00008220: 6f6e 7374 7275 6374 6564 2075 7369 6e67  onstructed using
+00008230: 5c6e 6120 736e 6170 7368 6f74 2e5c 6e5c  \na snapshot.\n\
+00008240: 6e60 6060 7079 7468 6f6e 5c6e 6672 6f6d  n```python\nfrom
+00008250: 2064 6174 6163 6c61 7373 6573 2069 6d70   dataclasses imp
+00008260: 6f72 7420 6461 7461 636c 6173 735c 6e5c  ort dataclass\n\
+00008270: 6e5c 6e40 6461 7461 636c 6173 7328 6672  n\n@dataclass(fr
+00008280: 6f7a 656e 3d54 7275 6529 5c6e 636c 6173  ozen=True)\nclas
+00008290: 7320 4167 6772 6567 6174 653a 5c6e 2020  s Aggregate:\n  
+000082a0: 2020 6964 3a20 7374 725c 6e20 2020 2076    id: str\n    v
+000082b0: 6572 7369 6f6e 3a20 696e 745c 6e20 2020  ersion: int\n   
+000082c0: 2069 735f 6672 6f6d 5f73 6e61 7073 686f   is_from_snapsho
+000082d0: 743a 2062 6f6f 6c5c 6e5c 6e5c 6e40 6461  t: bool\n\n\n@da
+000082e0: 7461 636c 6173 7328 6672 6f7a 656e 3d54  taclass(frozen=T
+000082f0: 7275 6529 5c6e 636c 6173 7320 446f 6728  rue)\nclass Dog(
+00008300: 4167 6772 6567 6174 6529 3a5c 6e20 2020  Aggregate):\n   
+00008310: 206e 616d 653a 2073 7472 5c6e 2020 2020   name: str\n    
+00008320: 7472 6963 6b73 3a20 6c69 7374 5c6e 5c6e  tricks: list\n\n
+00008330: 6060 605c 6e5c 6e4c 6574 5c27 7320 616c  ```\n\nLet\'s al
+00008340: 736f 2064 6566 696e 6520 6120 6d75 7461  so define a muta
+00008350: 746f 7220 6675 6e63 7469 6f6e 2060 6d75  tor function `mu
+00008360: 7461 7465 5f64 6f67 2829 6020 7468 6174  tate_dog()` that
+00008370: 2063 616e 2065 766f 6c76 6520 7468 6520   can evolve the 
+00008380: 7374 6174 6520 6f66 2061 5c6e 6044 6f67  state of a\n`Dog
+00008390: 6020 6167 6772 6567 6174 6520 6769 7665  ` aggregate give
+000083a0: 6e20 7661 7269 6f75 7320 6469 6666 6572  n various differ
+000083b0: 656e 7420 7479 7065 7320 6f66 2065 7665  ent types of eve
+000083c0: 6e74 732c 2060 5c27 446f 6752 6567 6973  nts, `\'DogRegis
+000083d0: 7465 7265 645c 2760 2c5c 6e60 5c27 446f  tered\'`,\n`\'Do
+000083e0: 674c 6561 726e 6564 5472 6963 6b5c 2760  gLearnedTrick\'`
+000083f0: 2c20 616e 6420 605c 2724 536e 6170 7368  , and `\'$Snapsh
+00008400: 6f74 605c 272e 2054 6865 2073 6e61 7073  ot`\'. The snaps
+00008410: 686f 7420 6576 656e 7420 7479 7065 2069  hot event type i
+00008420: 7320 7072 6566 6978 6564 2077 6974 685c  s prefixed with\
+00008430: 6e60 5c27 245c 2760 2073 6f20 7468 6174  n`\'$\'` so that
+00008440: 2069 7420 6361 6e20 6265 2066 696c 7465   it can be filte
+00008450: 7265 6420 6f75 7420 7768 656e 2072 6561  red out when rea
+00008460: 6469 6e67 2061 6c6c 2065 7665 6e74 7320  ding all events 
+00008470: 6672 6f6d 2074 6865 2064 6174 6162 6173  from the databas
+00008480: 652e 5c6e 5c6e 6060 6070 7974 686f 6e5c  e.\n\n```python\
+00008490: 6e64 6566 206d 7574 6174 655f 646f 6728  ndef mutate_dog(
+000084a0: 646f 672c 2065 7665 6e74 293a 5c6e 2020  dog, event):\n  
+000084b0: 2020 6461 7461 203d 2064 6573 6572 6961    data = deseria
+000084c0: 6c69 7a65 2865 7665 6e74 2e64 6174 6129  lize(event.data)
+000084d0: 5c6e 2020 2020 6966 2065 7665 6e74 2e74  \n    if event.t
+000084e0: 7970 6520 3d3d 205c 2744 6f67 5265 6769  ype == \'DogRegi
+000084f0: 7374 6572 6564 5c27 3a5c 6e20 2020 2020  stered\':\n     
+00008500: 2020 2072 6574 7572 6e20 446f 6728 5c6e     return Dog(\n
+00008510: 2020 2020 2020 2020 2020 2020 6964 3d65              id=e
+00008520: 7665 6e74 2e73 7472 6561 6d5f 6e61 6d65  vent.stream_name
+00008530: 2c5c 6e20 2020 2020 2020 2020 2020 2076  ,\n            v
+00008540: 6572 7369 6f6e 3d65 7665 6e74 2e73 7472  ersion=event.str
+00008550: 6561 6d5f 706f 7369 7469 6f6e 2c5c 6e20  eam_position,\n 
+00008560: 2020 2020 2020 2020 2020 2069 735f 6672             is_fr
+00008570: 6f6d 5f73 6e61 7073 686f 743d 4661 6c73  om_snapshot=Fals
+00008580: 652c 5c6e 2020 2020 2020 2020 2020 2020  e,\n            
+00008590: 6e61 6d65 3d64 6174 615b 5c27 6e61 6d65  name=data[\'name
+000085a0: 5c27 5d2c 5c6e 2020 2020 2020 2020 2020  \'],\n          
+000085b0: 2020 7472 6963 6b73 3d5b 5d2c 5c6e 2020    tricks=[],\n  
+000085c0: 2020 2020 2020 295c 6e20 2020 2065 6c69        )\n    eli
+000085d0: 6620 6576 656e 742e 7479 7065 203d 3d20  f event.type == 
+000085e0: 5c27 446f 674c 6561 726e 6564 5472 6963  \'DogLearnedTric
+000085f0: 6b5c 273a 5c6e 2020 2020 2020 2020 6173  k\':\n        as
+00008600: 7365 7274 2065 7665 6e74 2e73 7472 6561  sert event.strea
+00008610: 6d5f 706f 7369 7469 6f6e 203d 3d20 646f  m_position == do
+00008620: 672e 7665 7273 696f 6e20 2b20 315c 6e20  g.version + 1\n 
+00008630: 2020 2020 2020 2061 7373 6572 7420 6576         assert ev
+00008640: 656e 742e 7374 7265 616d 5f6e 616d 6520  ent.stream_name 
+00008650: 3d3d 2064 6f67 2e69 645c 6e20 2020 2020  == dog.id\n     
+00008660: 2020 2072 6574 7572 6e20 446f 6728 5c6e     return Dog(\n
+00008670: 2020 2020 2020 2020 2020 2020 6964 3d64              id=d
+00008680: 6f67 2e69 642c 5c6e 2020 2020 2020 2020  og.id,\n        
+00008690: 2020 2020 7665 7273 696f 6e3d 6576 656e      version=even
+000086a0: 742e 7374 7265 616d 5f70 6f73 6974 696f  t.stream_positio
+000086b0: 6e2c 5c6e 2020 2020 2020 2020 2020 2020  n,\n            
+000086c0: 6973 5f66 726f 6d5f 736e 6170 7368 6f74  is_from_snapshot
+000086d0: 3d64 6f67 2e69 735f 6672 6f6d 5f73 6e61  =dog.is_from_sna
+000086e0: 7073 686f 742c 5c6e 2020 2020 2020 2020  pshot,\n        
+000086f0: 2020 2020 6e61 6d65 3d64 6f67 2e6e 616d      name=dog.nam
+00008700: 652c 5c6e 2020 2020 2020 2020 2020 2020  e,\n            
+00008710: 7472 6963 6b73 3d64 6f67 2e74 7269 636b  tricks=dog.trick
+00008720: 7320 2b20 5b64 6174 615b 5c27 7472 6963  s + [data[\'tric
+00008730: 6b5c 275d 5d2c 5c6e 2020 2020 2020 2020  k\']],\n        
+00008740: 295c 6e20 2020 2065 6c69 6620 6576 656e  )\n    elif even
+00008750: 742e 7479 7065 203d 3d20 5c27 2453 6e61  t.type == \'$Sna
+00008760: 7073 686f 745c 273a 5c6e 2020 2020 2020  pshot\':\n      
+00008770: 2020 7265 7475 726e 2044 6f67 285c 6e20    return Dog(\n 
+00008780: 2020 2020 2020 2020 2020 2069 643d 7374             id=st
+00008790: 7269 705f 736e 6170 7368 6f74 5f73 7472  rip_snapshot_str
+000087a0: 6561 6d5f 6e61 6d65 2865 7665 6e74 2e73  eam_name(event.s
+000087b0: 7472 6561 6d5f 6e61 6d65 292c 5c6e 2020  tream_name),\n  
+000087c0: 2020 2020 2020 2020 2020 7665 7273 696f            versio
+000087d0: 6e3d 6465 7365 7269 616c 697a 6528 6576  n=deserialize(ev
+000087e0: 656e 742e 6d65 7461 6461 7461 295b 5c27  ent.metadata)[\'
+000087f0: 7665 7273 696f 6e5c 275d 2c5c 6e20 2020  version\'],\n   
+00008800: 2020 2020 2020 2020 2069 735f 6672 6f6d           is_from
+00008810: 5f73 6e61 7073 686f 743d 5472 7565 2c5c  _snapshot=True,\
+00008820: 6e20 2020 2020 2020 2020 2020 206e 616d  n            nam
+00008830: 653d 6461 7461 5b5c 276e 616d 655c 275d  e=data[\'name\']
+00008840: 2c5c 6e20 2020 2020 2020 2020 2020 2074  ,\n            t
+00008850: 7269 636b 733d 6461 7461 5b5c 2774 7269  ricks=data[\'tri
+00008860: 636b 735c 275d 2c5c 6e20 2020 2020 2020  cks\'],\n       
+00008870: 2029 5c6e 2020 2020 656c 7365 3a5c 6e20   )\n    else:\n 
+00008880: 2020 2020 2020 2072 6169 7365 2045 7863         raise Exc
+00008890: 6570 7469 6f6e 2866 2255 6e6b 6e6f 776e  eption(f"Unknown
+000088a0: 2065 7665 6e74 2074 7970 653a 207b 6576   event type: {ev
+000088b0: 656e 742e 7479 7065 7d22 295c 6e60 6060  ent.type}")\n```
+000088c0: 5c6e 5c6e 466f 7220 636f 6e76 656e 6965  \n\nFor convenie
+000088d0: 6e63 652c 206c 6574 5c27 7320 616c 736f  nce, let\'s also
+000088e0: 2064 6566 696e 6520 6120 6067 6574 5f64   define a `get_d
+000088f0: 6f67 2829 6020 6675 6e63 7469 6f6e 2074  og()` function t
+00008900: 6861 7420 6361 6c6c 7320 6067 6574 5f61  hat calls `get_a
+00008910: 6767 7265 6761 7465 2829 605c 6e77 6974  ggregate()`\nwit
+00008920: 6820 7468 6520 606d 7574 6174 655f 646f  h the `mutate_do
+00008930: 6728 2960 2066 756e 6374 696f 6e20 6173  g()` function as
+00008940: 2074 6865 2060 6d75 7461 746f 725f 6675   the `mutator_fu
+00008950: 6e63 6020 6172 6775 6d65 6e74 2e5c 6e5c  nc` argument.\n\
+00008960: 6e60 6060 7079 7468 6f6e 5c6e 6465 6620  n```python\ndef 
+00008970: 6765 745f 646f 6728 646f 675f 6964 293a  get_dog(dog_id):
+00008980: 5c6e 2020 2020 7265 7475 726e 2067 6574  \n    return get
+00008990: 5f61 6767 7265 6761 7465 285c 6e20 2020  _aggregate(\n   
+000089a0: 2020 2020 2061 6767 7265 6761 7465 5f69       aggregate_i
+000089b0: 643d 646f 675f 6964 2c5c 6e20 2020 2020  d=dog_id,\n     
+000089c0: 2020 206d 7574 6174 6f72 5f66 756e 633d     mutator_func=
+000089d0: 6d75 7461 7465 5f64 6f67 2c5c 6e20 2020  mutate_dog,\n   
+000089e0: 2029 5c6e 6060 605c 6e5c 6e57 6520 6361   )\n```\n\nWe ca
+000089f0: 6e20 616c 736f 2064 6566 696e 6520 736f  n also define so
+00008a00: 6d65 2022 636f 6d6d 616e 6422 2066 756e  me "command" fun
+00008a10: 6374 696f 6e73 2074 6861 7420 6170 7065  ctions that appe
+00008a20: 6e64 206e 6577 2065 7665 6e74 7320 746f  nd new events to
+00008a30: 2074 6865 5c6e 6461 7461 6261 7365 2e20   the\ndatabase. 
+00008a40: 5468 6520 6072 6567 6973 7465 725f 646f  The `register_do
+00008a50: 6728 2960 2066 756e 6374 696f 6e20 6170  g()` function ap
+00008a60: 7065 6e64 7320 6120 6044 6f67 5265 6769  pends a `DogRegi
+00008a70: 7374 6572 6564 6020 6576 656e 742e 2054  stered` event. T
+00008a80: 6865 5c6e 6072 6563 6f72 645f 7472 6963  he\n`record_tric
+00008a90: 6b5f 6c65 6172 6e65 6428 2960 2061 7070  k_learned()` app
+00008aa0: 656e 6473 2061 2060 446f 674c 6561 726e  ends a `DogLearn
+00008ab0: 6564 5472 6963 6b60 2065 7665 6e74 2e20  edTrick` event. 
+00008ac0: 5468 6520 6675 6e63 7469 6f6e 5c6e 6073  The function\n`s
+00008ad0: 6e61 7073 686f 745f 646f 6728 2960 2061  napshot_dog()` a
+00008ae0: 7070 656e 6473 2061 2060 2453 6e61 7073  ppends a `$Snaps
+00008af0: 686f 7460 2065 7665 6e74 2e20 4e6f 7469  hot` event. Noti
+00008b00: 6365 2074 6861 7420 7468 655c 6e60 7265  ce that the\n`re
+00008b10: 636f 7264 5f74 7269 636b 5f6c 6561 726e  cord_trick_learn
+00008b20: 6564 2829 6020 616e 6420 6073 6e61 7073  ed()` and `snaps
+00008b30: 686f 745f 646f 6728 2960 2066 756e 6374  hot_dog()` funct
+00008b40: 696f 6e73 2075 7365 2060 6765 745f 646f  ions use `get_do
+00008b50: 6728 2960 2e5c 6e5c 6e4e 6f74 6963 6520  g()`.\n\nNotice 
+00008b60: 616c 736f 2074 6861 7420 7468 6520 6044  also that the `D
+00008b70: 6f67 5265 6769 7374 6572 6564 6020 616e  ogRegistered` an
+00008b80: 6420 6044 6f67 4c65 6172 6e65 6454 7269  d `DogLearnedTri
+00008b90: 636b 6020 6576 656e 7473 2061 7265 2061  ck` events are a
+00008ba0: 7070 656e 6465 6420 746f 2061 5c6e 7374  ppended to a\nst
+00008bb0: 7265 616d 2066 6f72 2061 6767 7265 6761  ream for aggrega
+00008bc0: 7465 2065 7665 6e74 732c 2077 6869 6c73  te events, whils
+00008bd0: 7420 7468 6520 6024 536e 6170 7368 6f74  t the `$Snapshot
+00008be0: 6020 6973 2061 7070 656e 6465 6420 746f  ` is appended to
+00008bf0: 2061 2073 6570 6172 6174 6520 7374 7265   a separate stre
+00008c00: 616d 5c6e 666f 7220 6167 6772 6567 6174  am\nfor aggregat
+00008c10: 6520 736e 6170 7368 6f74 732e 2054 6865  e snapshots. The
+00008c20: 2073 6e61 7073 686f 7420 6576 656e 7420   snapshot event 
+00008c30: 7479 7065 2069 7320 7072 6566 6978 6564  type is prefixed
+00008c40: 2077 6974 6820 605c 2724 5c27 6020 736f   with `\'$\'` so
+00008c50: 2074 6861 7420 6974 2063 616e 5c6e 6265   that it can\nbe
+00008c60: 2066 696c 7465 7265 6420 6f75 7420 7768   filtered out wh
+00008c70: 656e 2072 6561 6469 6e67 2061 6c6c 2065  en reading all e
+00008c80: 7665 6e74 7320 6672 6f6d 2074 6865 2064  vents from the d
+00008c90: 6174 6162 6173 652e 5c6e 5c6e 6060 6070  atabase.\n\n```p
+00008ca0: 7974 686f 6e5c 6e64 6566 2072 6567 6973  ython\ndef regis
+00008cb0: 7465 725f 646f 6728 6e61 6d65 293a 5c6e  ter_dog(name):\n
+00008cc0: 2020 2020 646f 675f 6964 203d 2073 7472      dog_id = str
+00008cd0: 2875 7569 6434 2829 295c 6e20 2020 2065  (uuid4())\n    e
+00008ce0: 7665 6e74 203d 204e 6577 4576 656e 7428  vent = NewEvent(
+00008cf0: 5c6e 2020 2020 2020 2020 7479 7065 3d5c  \n        type=\
+00008d00: 2744 6f67 5265 6769 7374 6572 6564 5c27  'DogRegistered\'
+00008d10: 2c5c 6e20 2020 2020 2020 2064 6174 613d  ,\n        data=
+00008d20: 7365 7269 616c 697a 6528 7b5c 276e 616d  serialize({\'nam
+00008d30: 655c 273a 206e 616d 657d 292c 5c6e 2020  e\': name}),\n  
+00008d40: 2020 295c 6e20 2020 2063 6c69 656e 742e    )\n    client.
+00008d50: 6170 7065 6e64 5f65 7665 6e74 285c 6e20  append_event(\n 
+00008d60: 2020 2020 2020 2073 7472 6561 6d5f 6e61         stream_na
+00008d70: 6d65 3d64 6f67 5f69 642c 5c6e 2020 2020  me=dog_id,\n    
+00008d80: 2020 2020 6578 7065 6374 6564 5f70 6f73      expected_pos
+00008d90: 6974 696f 6e3d 4e6f 6e65 2c5c 6e20 2020  ition=None,\n   
+00008da0: 2020 2020 2065 7665 6e74 3d65 7665 6e74       event=event
+00008db0: 2c5c 6e20 2020 2029 5c6e 2020 2020 7265  ,\n    )\n    re
+00008dc0: 7475 726e 2064 6f67 5f69 645c 6e5c 6e5c  turn dog_id\n\n\
+00008dd0: 6e64 6566 2072 6563 6f72 645f 7472 6963  ndef record_tric
+00008de0: 6b5f 6c65 6172 6e65 6428 646f 675f 6964  k_learned(dog_id
+00008df0: 2c20 7472 6963 6b29 3a5c 6e20 2020 2064  , trick):\n    d
+00008e00: 6f67 203d 2067 6574 5f64 6f67 2864 6f67  og = get_dog(dog
+00008e10: 5f69 6429 5c6e 2020 2020 6576 656e 7420  _id)\n    event 
+00008e20: 3d20 4e65 7745 7665 6e74 285c 6e20 2020  = NewEvent(\n   
+00008e30: 2020 2020 2074 7970 653d 5c27 446f 674c       type=\'DogL
+00008e40: 6561 726e 6564 5472 6963 6b5c 272c 5c6e  earnedTrick\',\n
+00008e50: 2020 2020 2020 2020 6461 7461 3d73 6572          data=ser
+00008e60: 6961 6c69 7a65 287b 5c27 7472 6963 6b5c  ialize({\'trick\
+00008e70: 273a 2074 7269 636b 7d29 2c5c 6e20 2020  ': trick}),\n   
+00008e80: 2029 5c6e 2020 2020 636c 6965 6e74 2e61   )\n    client.a
+00008e90: 7070 656e 645f 6576 656e 7428 5c6e 2020  ppend_event(\n  
+00008ea0: 2020 2020 2020 7374 7265 616d 5f6e 616d        stream_nam
+00008eb0: 653d 646f 675f 6964 2c5c 6e20 2020 2020  e=dog_id,\n     
+00008ec0: 2020 2065 7870 6563 7465 645f 706f 7369     expected_posi
+00008ed0: 7469 6f6e 3d64 6f67 2e76 6572 7369 6f6e  tion=dog.version
+00008ee0: 2c5c 6e20 2020 2020 2020 2065 7665 6e74  ,\n        event
+00008ef0: 3d65 7665 6e74 2c5c 6e20 2020 2029 5c6e  =event,\n    )\n
+00008f00: 5c6e 5c6e 6465 6620 736e 6170 7368 6f74  \n\ndef snapshot
+00008f10: 5f64 6f67 2864 6f67 5f69 6429 3a5c 6e20  _dog(dog_id):\n 
+00008f20: 2020 2064 6f67 203d 2067 6574 5f64 6f67     dog = get_dog
+00008f30: 2864 6f67 5f69 6429 5c6e 2020 2020 6576  (dog_id)\n    ev
+00008f40: 656e 7420 3d20 4e65 7745 7665 6e74 285c  ent = NewEvent(\
+00008f50: 6e20 2020 2020 2020 2074 7970 653d 5c27  n        type=\'
+00008f60: 2453 6e61 7073 686f 745c 272c 5c6e 2020  $Snapshot\',\n  
+00008f70: 2020 2020 2020 6461 7461 3d73 6572 6961        data=seria
+00008f80: 6c69 7a65 287b 5c27 6e61 6d65 5c27 3a20  lize({\'name\': 
+00008f90: 646f 672e 6e61 6d65 2c20 5c27 7472 6963  dog.name, \'tric
+00008fa0: 6b73 5c27 3a20 646f 672e 7472 6963 6b73  ks\': dog.tricks
+00008fb0: 7d29 2c5c 6e20 2020 2020 2020 206d 6574  }),\n        met
+00008fc0: 6164 6174 613d 7365 7269 616c 697a 6528  adata=serialize(
+00008fd0: 7b5c 2776 6572 7369 6f6e 5c27 3a20 646f  {\'version\': do
+00008fe0: 672e 7665 7273 696f 6e7d 292c 5c6e 2020  g.version}),\n  
+00008ff0: 2020 295c 6e20 2020 2063 6c69 656e 742e    )\n    client.
+00009000: 6170 7065 6e64 5f65 7665 6e74 285c 6e20  append_event(\n 
+00009010: 2020 2020 2020 2073 7472 6561 6d5f 6e61         stream_na
+00009020: 6d65 3d6d 616b 655f 736e 6170 7368 6f74  me=make_snapshot
+00009030: 5f73 7472 6561 6d5f 6e61 6d65 2864 6f67  _stream_name(dog
+00009040: 5f69 6429 2c5c 6e20 2020 2020 2020 2065  _id),\n        e
+00009050: 7870 6563 7465 645f 706f 7369 7469 6f6e  xpected_position
+00009060: 3d2d 312c 5c6e 2020 2020 2020 2020 6576  =-1,\n        ev
+00009070: 656e 743d 6576 656e 742c 5c6e 2020 2020  ent=event,\n    
+00009080: 295c 6e60 6060 5c6e 5c6e 4e6f 7720 7765  )\n```\n\nNow we
+00009090: 2063 616e 2072 6567 6973 7465 7220 6120   can register a 
+000090a0: 6e65 7720 646f 672c 2061 6e64 2072 6563  new dog, and rec
+000090b0: 6f72 6420 7468 6174 2073 6f6d 6520 7472  ord that some tr
+000090c0: 6963 6b73 2068 6176 6520 6265 656e 206c  icks have been l
+000090d0: 6561 726e 6564 2e5c 6e5c 6e60 6060 7079  earned.\n\n```py
+000090e0: 7468 6f6e 5c6e 2320 5265 6769 7374 6572  thon\n# Register
+000090f0: 2061 206e 6577 2064 6f67 2e5c 6e64 6f67   a new dog.\ndog
+00009100: 5f69 6420 3d20 7265 6769 7374 6572 5f64  _id = register_d
+00009110: 6f67 285c 2746 6964 6f5c 2729 5c6e 5c6e  og(\'Fido\')\n\n
+00009120: 646f 6720 3d20 6765 745f 646f 6728 646f  dog = get_dog(do
+00009130: 675f 6964 295c 6e61 7373 6572 7420 646f  g_id)\nassert do
+00009140: 672e 6e61 6d65 203d 3d20 5c27 4669 646f  g.name == \'Fido
+00009150: 5c27 5c6e 6173 7365 7274 2064 6f67 2e74  \'\nassert dog.t
+00009160: 7269 636b 7320 3d3d 205b 5d5c 6e61 7373  ricks == []\nass
+00009170: 6572 7420 646f 672e 7665 7273 696f 6e20  ert dog.version 
+00009180: 3d3d 2030 5c6e 6173 7365 7274 2064 6f67  == 0\nassert dog
+00009190: 2e69 735f 6672 6f6d 5f73 6e61 7073 686f  .is_from_snapsho
+000091a0: 7420 6973 2046 616c 7365 5c6e 5c6e 5c6e  t is False\n\n\n
+000091b0: 2320 5265 636f 7264 2074 6861 7420 5c27  # Record that \'
+000091c0: 4669 646f 5c27 206c 6561 726e 6564 2061  Fido\' learned a
+000091d0: 206e 6577 2074 7269 636b 2e5c 6e72 6563   new trick.\nrec
+000091e0: 6f72 645f 7472 6963 6b5f 6c65 6172 6e65  ord_trick_learne
+000091f0: 6428 646f 675f 6964 2c20 7472 6963 6b3d  d(dog_id, trick=
+00009200: 5c27 726f 6c6c 206f 7665 725c 2729 5c6e  \'roll over\')\n
+00009210: 5c6e 646f 6720 3d20 6765 745f 646f 6728  \ndog = get_dog(
+00009220: 646f 675f 6964 295c 6e61 7373 6572 7420  dog_id)\nassert 
+00009230: 646f 672e 6e61 6d65 203d 3d20 5c27 4669  dog.name == \'Fi
+00009240: 646f 5c27 5c6e 6173 7365 7274 2064 6f67  do\'\nassert dog
+00009250: 2e74 7269 636b 7320 3d3d 205b 5c27 726f  .tricks == [\'ro
+00009260: 6c6c 206f 7665 725c 275d 5c6e 6173 7365  ll over\']\nasse
+00009270: 7274 2064 6f67 2e76 6572 7369 6f6e 203d  rt dog.version =
+00009280: 3d20 315c 6e61 7373 6572 7420 646f 672e  = 1\nassert dog.
+00009290: 6973 5f66 726f 6d5f 736e 6170 7368 6f74  is_from_snapshot
+000092a0: 2069 7320 4661 6c73 655c 6e5c 6e5c 6e23   is False\n\n\n#
+000092b0: 2052 6563 6f72 6420 7468 6174 205c 2746   Record that \'F
+000092c0: 6964 6f5c 2720 6c65 6172 6e65 6420 616e  ido\' learned an
+000092d0: 6f74 6865 7220 6e65 7720 7472 6963 6b2e  other new trick.
+000092e0: 5c6e 7265 636f 7264 5f74 7269 636b 5f6c  \nrecord_trick_l
+000092f0: 6561 726e 6564 2864 6f67 5f69 642c 2074  earned(dog_id, t
+00009300: 7269 636b 3d5c 2766 6574 6368 2062 616c  rick=\'fetch bal
+00009310: 6c5c 2729 5c6e 5c6e 646f 6720 3d20 6765  l\')\n\ndog = ge
+00009320: 745f 646f 6728 646f 675f 6964 295c 6e61  t_dog(dog_id)\na
+00009330: 7373 6572 7420 646f 672e 6e61 6d65 203d  ssert dog.name =
+00009340: 3d20 5c27 4669 646f 5c27 5c6e 6173 7365  = \'Fido\'\nasse
+00009350: 7274 2064 6f67 2e74 7269 636b 7320 3d3d  rt dog.tricks ==
+00009360: 205b 5c27 726f 6c6c 206f 7665 725c 272c   [\'roll over\',
+00009370: 205c 2766 6574 6368 2062 616c 6c5c 275d   \'fetch ball\']
+00009380: 5c6e 6173 7365 7274 2064 6f67 2e76 6572  \nassert dog.ver
+00009390: 7369 6f6e 203d 3d20 325c 6e61 7373 6572  sion == 2\nasser
+000093a0: 7420 646f 672e 6973 5f66 726f 6d5f 736e  t dog.is_from_sn
+000093b0: 6170 7368 6f74 2069 7320 4661 6c73 655c  apshot is False\
+000093c0: 6e60 6060 5c6e 5c6e 4166 7465 7220 7765  n```\n\nAfter we
+000093d0: 2063 616c 6c20 6073 6e61 7073 686f 745f   call `snapshot_
+000093e0: 646f 6728 2960 2c20 7468 6520 6067 6574  dog()`, the `get
+000093f0: 5f64 6f67 2829 6020 6675 6e63 7469 6f6e  _dog()` function
+00009400: 2077 696c 6c20 7265 7475 726e 2061 2060   will return a `
+00009410: 446f 6760 5c6e 6f62 6a65 6374 2074 6861  Dog`\nobject tha
+00009420: 7420 6861 7320 6265 656e 2063 6f6e 7374  t has been const
+00009430: 7275 6374 6564 2075 7369 6e67 2074 6865  ructed using the
+00009440: 2060 2453 6e61 7073 686f 7460 2065 7665   `$Snapshot` eve
+00009450: 6e74 2e5c 6e5c 6e60 6060 7079 7468 6f6e  nt.\n\n```python
+00009460: 5c6e 2320 536e 6170 7368 6f74 205c 2746  \n# Snapshot \'F
+00009470: 6964 6f5c 272e 5c6e 736e 6170 7368 6f74  ido\'.\nsnapshot
+00009480: 5f64 6f67 2864 6f67 5f69 6429 5c6e 5c6e  _dog(dog_id)\n\n
+00009490: 646f 6720 3d20 6765 745f 646f 6728 646f  dog = get_dog(do
+000094a0: 675f 6964 295c 6e61 7373 6572 7420 646f  g_id)\nassert do
+000094b0: 672e 6e61 6d65 203d 3d20 5c27 4669 646f  g.name == \'Fido
+000094c0: 5c27 5c6e 6173 7365 7274 2064 6f67 2e74  \'\nassert dog.t
+000094d0: 7269 636b 7320 3d3d 205b 5c27 726f 6c6c  ricks == [\'roll
+000094e0: 206f 7665 725c 272c 205c 2766 6574 6368   over\', \'fetch
+000094f0: 2062 616c 6c5c 275d 5c6e 6173 7365 7274   ball\']\nassert
+00009500: 2064 6f67 2e76 6572 7369 6f6e 203d 3d20   dog.version == 
+00009510: 325c 6e61 7373 6572 7420 646f 672e 6973  2\nassert dog.is
+00009520: 5f66 726f 6d5f 736e 6170 7368 6f74 2069  _from_snapshot i
+00009530: 7320 5472 7565 5c6e 6060 605c 6e5c 6e57  s True\n```\n\nW
+00009540: 6520 6361 6e20 636f 6e74 696e 7565 2074  e can continue t
+00009550: 6f20 6576 6f6c 7665 2074 6865 2073 7461  o evolve the sta
+00009560: 7465 206f 6620 7468 6520 6044 6f67 6020  te of the `Dog` 
+00009570: 6167 6772 6567 6174 652c 2075 7369 6e67  aggregate, using
+00009580: 5c6e 7468 6520 736e 6170 7368 6f74 2062  \nthe snapshot b
+00009590: 6f74 6820 6475 7269 6e67 2074 6865 2063  oth during the c
+000095a0: 616c 6c20 7468 6520 6072 6563 6f72 645f  all the `record_
+000095b0: 7472 6963 6b5f 6c65 6172 6e65 6428 2960  trick_learned()`
+000095c0: 2061 6e64 5c6e 7768 656e 2063 616c 6c69   and\nwhen calli
+000095d0: 6e67 2060 6765 745f 646f 6728 2960 2e5c  ng `get_dog()`.\
+000095e0: 6e5c 6e60 6060 7079 7468 6f6e 5c6e 7265  n\n```python\nre
+000095f0: 636f 7264 5f74 7269 636b 5f6c 6561 726e  cord_trick_learn
+00009600: 6564 2864 6f67 5f69 642c 2074 7269 636b  ed(dog_id, trick
+00009610: 3d5c 2773 6974 5c27 295c 6e5c 6e64 6f67  =\'sit\')\n\ndog
+00009620: 203d 2067 6574 5f64 6f67 2864 6f67 5f69   = get_dog(dog_i
+00009630: 6429 5c6e 6173 7365 7274 2064 6f67 2e6e  d)\nassert dog.n
+00009640: 616d 6520 3d3d 205c 2746 6964 6f5c 275c  ame == \'Fido\'\
+00009650: 6e61 7373 6572 7420 646f 672e 7472 6963  nassert dog.tric
+00009660: 6b73 203d 3d20 5b5c 2772 6f6c 6c20 6f76  ks == [\'roll ov
+00009670: 6572 5c27 2c20 5c27 6665 7463 6820 6261  er\', \'fetch ba
+00009680: 6c6c 5c27 2c20 5c27 7369 745c 275d 5c6e  ll\', \'sit\']\n
+00009690: 6173 7365 7274 2064 6f67 2e76 6572 7369  assert dog.versi
+000096a0: 6f6e 203d 3d20 335c 6e61 7373 6572 7420  on == 3\nassert 
+000096b0: 646f 672e 6973 5f66 726f 6d5f 736e 6170  dog.is_from_snap
+000096c0: 7368 6f74 2069 7320 5472 7565 5c6e 6060  shot is True\n``
+000096d0: 605c 6e5c 6e57 6520 6361 6e20 7365 6520  `\n\nWe can see 
+000096e0: 6672 6f6d 2074 6865 2060 6973 5f66 726f  from the `is_fro
+000096f0: 6d5f 736e 6170 7368 6f74 6020 6174 7472  m_snapshot` attr
+00009700: 6962 7574 6520 7468 6174 2074 6865 2060  ibute that the `
+00009710: 446f 6760 206f 626a 6563 7420 7761 7320  Dog` object was 
+00009720: 696e 6465 6564 5c6e 7265 636f 6e73 7472  indeed\nreconstr
+00009730: 7563 7465 6420 6672 6f6d 2074 6865 2073  ucted from the s
+00009740: 6e61 7073 686f 742e 5c6e 5c6e 5c6e 2323  napshot.\n\n\n##
+00009750: 2320 5265 6164 2061 6c6c 2065 7665 6e74  # Read all event
+00009760: 735c 6e5c 6e54 6865 206d 6574 686f 6420  s\n\nThe method 
+00009770: 6072 6561 645f 616c 6c5f 6576 656e 7473  `read_all_events
+00009780: 2829 6020 6361 6e20 6265 2075 7365 6420  ()` can be used 
+00009790: 746f 2072 6561 6420 616c 6c20 7265 636f  to read all reco
+000097a0: 7264 6564 2065 7665 6e74 735c 6e69 6e20  rded events\nin 
+000097b0: 7468 6520 6461 7461 6261 7365 2069 6e20  the database in 
+000097c0: 7468 6520 6f72 6465 7220 7468 6579 2077  the order they w
+000097d0: 6572 6520 7265 636f 7264 6564 2e20 4974  ere recorded. It
+000097e0: 2072 6574 7572 6e73 2061 6e20 6974 6572   returns an iter
+000097f0: 6162 6c65 206f 665c 6e65 7665 6e74 7320  able of\nevents 
+00009800: 7468 6174 2068 6176 6520 6265 656e 2072  that have been r
+00009810: 6563 6f72 6465 6420 696e 2074 6865 2064  ecorded in the d
+00009820: 6174 6162 6173 652e 2049 7465 7261 7469  atabase. Iterati
+00009830: 6e67 206f 7665 7220 7468 6973 2069 7465  ng over this ite
+00009840: 7261 626c 655c 6e6f 626a 6563 7420 7769  rable\nobject wi
+00009850: 6c6c 2073 746f 7020 7768 656e 2069 7420  ll stop when it 
+00009860: 6861 7320 7969 656c 6465 6420 7468 6520  has yielded the 
+00009870: 6c61 7374 2072 6563 6f72 6465 6420 6576  last recorded ev
+00009880: 656e 742e 2054 6865 2072 6563 6569 7665  ent. The receive
+00009890: 645c 6e72 6563 6f72 6465 6420 6576 656e  d\nrecorded even
+000098a0: 7420 6f62 6a65 6374 2061 7265 2069 6e73  t object are ins
+000098b0: 7461 6e63 6573 206f 6620 7468 6520 6052  tances of the `R
+000098c0: 6563 6f72 6465 6445 7665 6e74 6020 636c  ecordedEvent` cl
+000098d0: 6173 7320 2873 6565 2074 6865 5c6e 4e6f  ass (see the\nNo
+000098e0: 7465 7320 7365 6374 696f 6e20 6265 6c6f  tes section belo
+000098f0: 7720 666f 7220 6465 7461 696c 7320 6f66  w for details of
+00009900: 2074 6869 7320 636c 6173 7329 2e5c 6e5c   this class).\n\
+00009910: 6e54 6869 7320 6d65 7468 6f64 2073 7570  nThis method sup
+00009920: 706f 7274 7320 7365 7665 6e20 6f70 7469  ports seven opti
+00009930: 6f6e 616c 2061 7267 756d 656e 7473 2c20  onal arguments, 
+00009940: 6063 6f6d 6d69 745f 706f 7369 7469 6f6e  `commit_position
+00009950: 602c 2060 6261 636b 7761 7264 7360 2c5c  `, `backwards`,\
+00009960: 6e60 6669 6c74 6572 5f65 7863 6c75 6465  n`filter_exclude
+00009970: 602c 2060 6669 6c74 6572 5f69 6e63 6c75  `, `filter_inclu
+00009980: 6465 602c 2060 6669 6c74 6572 5f62 795f  de`, `filter_by_
+00009990: 7374 7265 616d 5f6e 616d 6560 2c20 606c  stream_name`, `l
+000099a0: 696d 6974 602c 2061 6e64 2060 7469 6d65  imit`, and `time
+000099b0: 6f75 7460 2e5c 6e5c 6e54 6865 206f 7074  out`.\n\nThe opt
+000099c0: 696f 6e61 6c20 6063 6f6d 6d69 745f 706f  ional `commit_po
+000099d0: 7369 7469 6f6e 6020 6172 6775 6d65 6e74  sition` argument
+000099e0: 2069 7320 616e 206f 7074 696f 6e61 6c20   is an optional 
+000099f0: 696e 7465 6765 7220 7468 6174 2063 616e  integer that can
+00009a00: 2062 6520 7573 6564 2074 6f5c 6e73 7065   be used to\nspe
+00009a10: 6369 6679 2074 6865 2063 6f6d 6d69 7420  cify the commit 
+00009a20: 706f 7369 7469 6f6e 2066 726f 6d20 7768  position from wh
+00009a30: 6963 6820 746f 2073 7461 7274 2072 6561  ich to start rea
+00009a40: 6469 6e67 2e20 5468 6973 2061 7267 756d  ding. This argum
+00009a50: 656e 7420 6973 2060 4e6f 6e65 6020 6279  ent is `None` by
+00009a60: 5c6e 6465 6661 756c 742c 206d 6561 6e69  \ndefault, meani
+00009a70: 6e67 2074 6861 7420 616c 6c20 7468 6520  ng that all the 
+00009a80: 6576 656e 7473 2077 696c 6c20 6265 2072  events will be r
+00009a90: 6561 6420 6569 7468 6572 2066 726f 6d20  ead either from 
+00009aa0: 7468 6520 7374 6172 742c 206f 725c 6e66  the start, or\nf
+00009ab0: 726f 6d20 7468 6520 656e 6420 6966 2060  rom the end if `
+00009ac0: 6261 636b 7761 7264 7360 2069 7320 6054  backwards` is `T
+00009ad0: 7275 6560 2e20 506c 6561 7365 206e 6f74  rue`. Please not
+00009ae0: 652c 2069 6620 6120 636f 6d6d 6974 2070  e, if a commit p
+00009af0: 6f73 6974 696f 6e20 6973 2073 7065 6369  osition is speci
+00009b00: 6669 6564 2c5c 6e69 7420 6d75 7374 2062  fied,\nit must b
+00009b10: 6520 616e 2061 6374 7561 6c6c 7920 6578  e an actually ex
+00009b20: 6973 7469 6e67 2063 6f6d 6d69 7420 706f  isting commit po
+00009b30: 7369 7469 6f6e 2069 6e20 7468 6520 6461  sition in the da
+00009b40: 7461 6261 7365 2e5c 6e41 6e79 206f 7468  tabase.\nAny oth
+00009b50: 6572 206e 756d 6265 7220 7769 6c6c 2072  er number will r
+00009b60: 6573 756c 7420 696e 2061 2073 6572 7665  esult in a serve
+00009b70: 7220 6572 726f 7220 2861 7420 6c65 6173  r error (at leas
+00009b80: 7420 696e 2045 7665 6e74 5374 6f72 6544  t in EventStoreD
+00009b90: 4220 7632 312e 3130 292e 5c6e 5c6e 5468  B v21.10).\n\nTh
+00009ba0: 6520 6f70 7469 6f6e 616c 2060 6261 636b  e optional `back
+00009bb0: 7761 7264 7360 2061 7267 756d 656e 7420  wards` argument 
+00009bc0: 6973 2061 2050 7974 686f 6e20 6062 6f6f  is a Python `boo
+00009bd0: 6c60 2e20 5468 6520 6465 6661 756c 7420  l`. The default 
+00009be0: 6973 2060 4661 6c73 6560 2c20 7768 6963  is `False`, whic
+00009bf0: 685c 6e6d 6561 6e73 2074 6865 2064 6174  h\nmeans the dat
+00009c00: 6162 6173 6520 7769 6c6c 2062 6520 7265  abase will be re
+00009c10: 6164 2066 6f72 7761 7264 7320 6279 2064  ad forwards by d
+00009c20: 6566 6175 6c74 2c20 736f 2074 6861 7420  efault, so that 
+00009c30: 6576 656e 7473 2061 7265 2072 6574 7572  events are retur
+00009c40: 6e65 6420 696e 2074 6865 5c6e 6f72 6465  ned in the\norde
+00009c50: 7220 7468 6579 2077 6572 6520 7265 636f  r they were reco
+00009c60: 7264 6564 2c20 4966 2060 6261 636b 7761  rded, If `backwa
+00009c70: 7264 7360 2069 7320 6054 7275 6560 2c20  rds` is `True`, 
+00009c80: 7468 6520 6576 656e 7473 2061 7265 2072  the events are r
+00009c90: 6574 7572 6e65 6420 696e 2072 6576 6572  eturned in rever
+00009ca0: 7365 5c6e 6f72 6465 722e 5c6e 5c6e 5468  se\norder.\n\nTh
+00009cb0: 6520 6f70 7469 6f6e 616c 2060 6669 6c74  e optional `filt
+00009cc0: 6572 5f65 7863 6c75 6465 6020 6172 6775  er_exclude` argu
+00009cd0: 6d65 6e74 2069 7320 6120 7365 7175 656e  ment is a sequen
+00009ce0: 6365 206f 6620 7265 6775 6c61 7220 6578  ce of regular ex
+00009cf0: 7072 6573 7369 6f6e 7320 7468 6174 5c6e  pressions that\n
+00009d00: 6d61 7463 6820 7265 636f 7264 6564 2065  match recorded e
+00009d10: 7665 6e74 7320 7468 6174 2073 686f 756c  vents that shoul
+00009d20: 6420 6e6f 7420 6265 2069 6e63 6c75 6465  d not be include
+00009d30: 642e 2054 6869 7320 6172 6775 6d65 6e74  d. This argument
+00009d40: 2069 7320 6967 6e6f 7265 645c 6e69 6620   is ignored\nif 
+00009d50: 6066 696c 7465 725f 696e 636c 7564 6560  `filter_include`
+00009d60: 2069 7320 7365 7420 746f 2061 206e 6f6e   is set to a non
+00009d70: 2d65 6d70 7479 2073 6571 7565 6e63 652e  -empty sequence.
+00009d80: 2042 7920 6465 6661 756c 742c 2074 6869   By default, thi
+00009d90: 7320 6172 6775 6d65 6e74 2069 7320 7365  s argument is se
+00009da0: 745c 6e74 6f20 6d61 7463 6820 7468 6520  t\nto match the 
+00009db0: 6576 656e 7420 7479 7065 7320 6f66 2022  event types of "
+00009dc0: 7379 7374 656d 2065 7665 6e74 7322 2c20  system events", 
+00009dd0: 736f 2074 6861 7420 4576 656e 7453 746f  so that EventSto
+00009de0: 7265 4442 2073 7973 7465 6d20 6576 656e  reDB system even
+00009df0: 7473 5c6e 7769 6c6c 206e 6f74 206e 6f72  ts\nwill not nor
+00009e00: 6d61 6c6c 7920 6265 2069 6e63 6c75 6465  mally be include
+00009e10: 642e 2053 6565 2074 6865 204e 6f74 6573  d. See the Notes
+00009e20: 2073 6563 7469 6f6e 2062 656c 6f77 2066   section below f
+00009e30: 6f72 206d 6f72 6520 696e 666f 726d 6174  or more informat
+00009e40: 696f 6e5c 6e61 626f 7574 2066 696c 7465  ion\nabout filte
+00009e50: 7220 6578 7072 6573 7369 6f6e 732e 5c6e  r expressions.\n
+00009e60: 5c6e 5468 6520 6f70 7469 6f6e 616c 2060  \nThe optional `
+00009e70: 6669 6c74 6572 5f69 6e63 6c75 6465 6020  filter_include` 
+00009e80: 6172 6775 6d65 6e74 2069 7320 6120 7365  argument is a se
+00009e90: 7175 656e 6365 206f 6620 7265 6775 6c61  quence of regula
+00009ea0: 7220 6578 7072 6573 7369 6f6e 735c 6e74  r expressions\nt
+00009eb0: 6861 7420 6d61 7463 6820 7265 636f 7264  hat match record
+00009ec0: 6564 2065 7665 6e74 7320 7468 6174 2073  ed events that s
+00009ed0: 686f 756c 6420 6265 2069 6e63 6c75 6465  hould be include
+00009ee0: 642e 2042 7920 6465 6661 756c 742c 2074  d. By default, t
+00009ef0: 6869 7320 6172 6775 6d65 6e74 5c6e 6973  his argument\nis
+00009f00: 2061 6e20 656d 7074 7920 7475 706c 652e   an empty tuple.
+00009f10: 2049 6620 7468 6973 2061 7267 756d 656e   If this argumen
+00009f20: 7420 6973 2073 6574 2074 6f20 6120 6e6f  t is set to a no
+00009f30: 6e2d 656d 7074 7920 7365 7175 656e 6365  n-empty sequence
+00009f40: 2c20 7468 655c 6e60 6669 6c74 6572 5f65  , the\n`filter_e
+00009f50: 7863 6c75 6465 6020 6172 6775 6d65 6e74  xclude` argument
+00009f60: 2069 7320 6967 6e6f 7265 642e 5c6e 5c6e   is ignored.\n\n
+00009f70: 5468 6520 6f70 7469 6f6e 616c 2060 6669  The optional `fi
+00009f80: 6c74 6572 5f62 795f 7374 7265 616d 5f6e  lter_by_stream_n
+00009f90: 616d 6560 2061 7267 756d 656e 7420 6973  ame` argument is
+00009fa0: 2061 2050 7974 686f 6e20 6062 6f6f 6c60   a Python `bool`
+00009fb0: 2074 6861 7420 696e 6469 6361 7465 7320   that indicates 
+00009fc0: 7768 6574 6865 725c 6e74 6865 2066 696c  whether\nthe fil
+00009fd0: 7465 7220 7769 6c6c 2061 7070 6c79 2074  ter will apply t
+00009fe0: 6f20 6576 656e 7420 7479 7065 7320 6f72  o event types or
+00009ff0: 2073 7472 6561 6d20 6e61 6d65 732e 2042   stream names. B
+0000a000: 7920 6465 6661 756c 742c 2074 6869 7320  y default, this 
+0000a010: 7661 6c75 6520 6973 2060 4661 6c73 6560  value is `False`
+0000a020: 5c6e 616e 6420 736f 2074 6865 2066 696c  \nand so the fil
+0000a030: 7465 7269 6e67 2077 696c 6c20 6170 706c  tering will appl
+0000a040: 7920 746f 2074 6865 2065 7665 6e74 2074  y to the event t
+0000a050: 7970 6520 7374 7269 6e67 7320 6f66 2072  ype strings of r
+0000a060: 6563 6f72 6465 6420 6576 656e 7473 2e5c  ecorded events.\
+0000a070: 6e5c 6e54 6865 206f 7074 696f 6e61 6c20  n\nThe optional 
+0000a080: 606c 696d 6974 6020 6172 6775 6d65 6e74  `limit` argument
+0000a090: 2069 7320 616e 2069 6e74 6567 6572 2077   is an integer w
+0000a0a0: 6869 6368 2072 6573 7472 6963 7473 2074  hich restricts t
+0000a0b0: 6865 206e 756d 6265 7220 6f66 2065 7665  he number of eve
+0000a0c0: 6e74 7320 7468 6174 5c6e 7769 6c6c 2062  nts that\nwill b
+0000a0d0: 6520 7265 7475 726e 6564 2e20 5468 6520  e returned. The 
+0000a0e0: 6465 6661 756c 7420 7661 6c75 6520 6973  default value is
+0000a0f0: 2060 7379 732e 6d61 7869 6e74 602e 5c6e   `sys.maxint`.\n
+0000a100: 5c6e 5468 6520 6f70 7469 6f6e 616c 2060  \nThe optional `
+0000a110: 7469 6d65 6f75 7460 2061 7267 756d 656e  timeout` argumen
+0000a120: 7420 6973 2061 2050 7974 686f 6e20 6066  t is a Python `f
+0000a130: 6c6f 6174 6020 7768 6963 6820 7365 7473  loat` which sets
+0000a140: 2061 5c6e 6465 6164 6c69 6e65 2066 6f72   a\ndeadline for
+0000a150: 2074 6865 2063 6f6d 706c 6574 696f 6e20   the completion 
+0000a160: 6f66 2074 6865 2067 5250 4320 6f70 6572  of the gRPC oper
+0000a170: 6174 696f 6e2e 5c6e 5c6e 5468 6520 6669  ation.\n\nThe fi
+0000a180: 6c74 6572 696e 6720 6f66 2065 7665 6e74  ltering of event
+0000a190: 7320 6973 2064 6f6e 6520 6f6e 2074 6865  s is done on the
+0000a1a0: 2045 7665 6e74 5374 6f72 6544 4220 7365   EventStoreDB se
+0000a1b0: 7276 6572 2e20 5468 655c 6e60 6c69 6d69  rver. The\n`limi
+0000a1c0: 7460 2061 7267 756d 656e 7420 6973 2061  t` argument is a
+0000a1d0: 7070 6c69 6564 206f 6e20 7468 6520 7365  pplied on the se
+0000a1e0: 7276 6572 2061 6674 6572 2066 696c 7465  rver after filte
+0000a1f0: 7269 6e67 2e5c 6e5c 6e57 6865 6e20 7265  ring.\n\nWhen re
+0000a200: 6164 696e 6720 666f 7277 6172 6473 2066  ading forwards f
+0000a210: 726f 6d20 6120 7370 6563 6966 6963 2063  rom a specific c
+0000a220: 6f6d 6d69 7420 706f 7369 7469 6f6e 2c20  ommit position, 
+0000a230: 7468 6520 6576 656e 7420 6174 2074 6865  the event at the
+0000a240: 2073 7065 6369 6669 6564 5c6e 706f 7369   specified\nposi
+0000a250: 7469 6f6e 2057 494c 4c20 6265 2069 6e63  tion WILL be inc
+0000a260: 6c75 6465 642e 2048 6f77 6576 6572 2c20  luded. However, 
+0000a270: 7768 656e 2072 6561 6469 6e67 2062 6163  when reading bac
+0000a280: 6b77 6172 6473 2c20 7468 6520 6576 656e  kwards, the even
+0000a290: 7420 6174 2074 6865 5c6e 7370 6563 6966  t at the\nspecif
+0000a2a0: 6965 6420 706f 7369 7469 6f6e 2077 696c  ied position wil
+0000a2b0: 6c20 4e4f 5420 6265 2069 6e63 6c75 6465  l NOT be include
+0000a2c0: 642e 2028 5468 6973 206e 6f6e 2d69 6e63  d. (This non-inc
+0000a2d0: 6c75 7369 7665 2062 6568 6176 696f 7572  lusive behaviour
+0000a2e0: 2c20 6f66 2065 7863 6c75 6469 6e67 5c6e  , of excluding\n
+0000a2f0: 7468 6520 7370 6563 6966 6965 6420 636f  the specified co
+0000a300: 6d6d 6974 2070 6f73 6974 696f 6e20 7768  mmit position wh
+0000a310: 656e 2072 6561 6469 6e67 2061 6c6c 2073  en reading all s
+0000a320: 7472 6561 6d73 2062 6163 6b77 6172 6473  treams backwards
+0000a330: 2c20 6469 6666 6572 7320 6672 6f6d 2074  , differs from t
+0000a340: 6865 5c6e 6265 6861 7669 6f75 7220 7768  he\nbehaviour wh
+0000a350: 656e 2072 6561 6469 6e67 2061 2073 7472  en reading a str
+0000a360: 6561 6d20 6261 636b 7761 7264 7320 6672  eam backwards fr
+0000a370: 6f6d 2061 2073 7065 6369 6669 6320 7374  om a specific st
+0000a380: 7265 616d 2070 6f73 6974 696f 6e2e 295c  ream position.)\
+0000a390: 6e5c 6e54 6865 2065 7861 6d70 6c65 2062  n\nThe example b
+0000a3a0: 656c 6f77 2073 686f 7773 2068 6f77 2074  elow shows how t
+0000a3b0: 6f20 7265 6164 2061 6c6c 2065 7665 6e74  o read all event
+0000a3c0: 7320 696e 2074 6865 2064 6174 6162 6173  s in the databas
+0000a3d0: 6520 696e 2074 6865 5c6e 6f72 6465 7220  e in the\norder 
+0000a3e0: 7468 6579 2077 6572 6520 7265 636f 7264  they were record
+0000a3f0: 6564 2e5c 6e5c 6e60 6060 7079 7468 6f6e  ed.\n\n```python
+0000a400: 5c6e 6576 656e 7473 203d 206c 6973 7428  \nevents = list(
+0000a410: 636c 6965 6e74 2e72 6561 645f 616c 6c5f  client.read_all_
+0000a420: 6576 656e 7473 2829 295c 6e5c 6e61 7373  events())\n\nass
+0000a430: 6572 7420 6c65 6e28 6576 656e 7473 2920  ert len(events) 
+0000a440: 3e3d 2033 5c6e 6060 605c 6e5c 6e54 6865  >= 3\n```\n\nThe
+0000a450: 2065 7861 6d70 6c65 2062 656c 6f77 2073   example below s
+0000a460: 686f 7773 2068 6f77 2074 6f20 7265 6164  hows how to read
+0000a470: 2061 6c6c 2072 6563 6f72 6465 6420 6576   all recorded ev
+0000a480: 656e 7473 2066 726f 6d20 6120 7370 6563  ents from a spec
+0000a490: 6966 6963 2063 6f6d 6d69 7420 706f 7369  ific commit posi
+0000a4a0: 7469 6f6e 2e5c 6e5c 6e60 6060 7079 7468  tion.\n\n```pyth
+0000a4b0: 6f6e 5c6e 6576 656e 7473 203d 206c 6973  on\nevents = lis
+0000a4c0: 7428 5c6e 2020 2020 636c 6965 6e74 2e72  t(\n    client.r
+0000a4d0: 6561 645f 616c 6c5f 6576 656e 7473 285c  ead_all_events(\
+0000a4e0: 6e20 2020 2020 2020 2063 6f6d 6d69 745f  n        commit_
+0000a4f0: 706f 7369 7469 6f6e 3d63 6f6d 6d69 745f  position=commit_
+0000a500: 706f 7369 7469 6f6e 315c 6e20 2020 2029  position1\n    )
+0000a510: 5c6e 295c 6e5c 6e61 7373 6572 7420 6c65  \n)\n\nassert le
+0000a520: 6e28 6576 656e 7473 2920 3d3d 2037 5c6e  n(events) == 7\n
+0000a530: 5c6e 6173 7365 7274 2065 7665 6e74 735b  \nassert events[
+0000a540: 305d 2e73 7472 6561 6d5f 6e61 6d65 203d  0].stream_name =
+0000a550: 3d20 7374 7265 616d 5f6e 616d 6531 5c6e  = stream_name1\n
+0000a560: 6173 7365 7274 2065 7665 6e74 735b 305d  assert events[0]
+0000a570: 2e73 7472 6561 6d5f 706f 7369 7469 6f6e  .stream_position
+0000a580: 203d 3d20 305c 6e61 7373 6572 7420 6576   == 0\nassert ev
+0000a590: 656e 7473 5b30 5d2e 7479 7065 203d 3d20  ents[0].type == 
+0000a5a0: 6576 656e 7431 2e74 7970 655c 6e61 7373  event1.type\nass
+0000a5b0: 6572 7420 6576 656e 7473 5b30 5d2e 6461  ert events[0].da
+0000a5c0: 7461 203d 3d20 6576 656e 7431 2e64 6174  ta == event1.dat
+0000a5d0: 615c 6e5c 6e61 7373 6572 7420 6576 656e  a\n\nassert even
+0000a5e0: 7473 5b31 5d2e 7374 7265 616d 5f6e 616d  ts[1].stream_nam
+0000a5f0: 6520 3d3d 2073 7472 6561 6d5f 6e61 6d65  e == stream_name
+0000a600: 315c 6e61 7373 6572 7420 6576 656e 7473  1\nassert events
+0000a610: 5b31 5d2e 7374 7265 616d 5f70 6f73 6974  [1].stream_posit
+0000a620: 696f 6e20 3d3d 2031 5c6e 6173 7365 7274  ion == 1\nassert
+0000a630: 2065 7665 6e74 735b 315d 2e74 7970 6520   events[1].type 
+0000a640: 3d3d 2065 7665 6e74 322e 7479 7065 5c6e  == event2.type\n
+0000a650: 6173 7365 7274 2065 7665 6e74 735b 315d  assert events[1]
+0000a660: 2e64 6174 6120 3d3d 2065 7665 6e74 322e  .data == event2.
+0000a670: 6461 7461 5c6e 5c6e 6173 7365 7274 2065  data\n\nassert e
+0000a680: 7665 6e74 735b 325d 2e73 7472 6561 6d5f  vents[2].stream_
+0000a690: 6e61 6d65 203d 3d20 7374 7265 616d 5f6e  name == stream_n
+0000a6a0: 616d 6531 5c6e 6173 7365 7274 2065 7665  ame1\nassert eve
+0000a6b0: 6e74 735b 325d 2e73 7472 6561 6d5f 706f  nts[2].stream_po
+0000a6c0: 7369 7469 6f6e 203d 3d20 325c 6e61 7373  sition == 2\nass
+0000a6d0: 6572 7420 6576 656e 7473 5b32 5d2e 7479  ert events[2].ty
+0000a6e0: 7065 203d 3d20 6576 656e 7433 2e74 7970  pe == event3.typ
+0000a6f0: 655c 6e61 7373 6572 7420 6576 656e 7473  e\nassert events
+0000a700: 5b32 5d2e 6461 7461 203d 3d20 6576 656e  [2].data == even
+0000a710: 7433 2e64 6174 615c 6e5c 6e61 7373 6572  t3.data\n\nasser
+0000a720: 7420 6576 656e 7473 5b33 5d2e 7479 7065  t events[3].type
+0000a730: 203d 3d20 2244 6f67 5265 6769 7374 6572   == "DogRegister
+0000a740: 6564 225c 6e61 7373 6572 7420 6576 656e  ed"\nassert even
+0000a750: 7473 5b34 5d2e 7479 7065 203d 3d20 2244  ts[4].type == "D
+0000a760: 6f67 4c65 6172 6e65 6454 7269 636b 225c  ogLearnedTrick"\
+0000a770: 6e61 7373 6572 7420 6576 656e 7473 5b35  nassert events[5
+0000a780: 5d2e 7479 7065 203d 3d20 2244 6f67 4c65  ].type == "DogLe
+0000a790: 6172 6e65 6454 7269 636b 225c 6e61 7373  arnedTrick"\nass
+0000a7a0: 6572 7420 6576 656e 7473 5b36 5d2e 7479  ert events[6].ty
+0000a7b0: 7065 203d 3d20 2244 6f67 4c65 6172 6e65  pe == "DogLearne
+0000a7c0: 6454 7269 636b 225c 6e60 6060 5c6e 5c6e  dTrick"\n```\n\n
+0000a7d0: 5468 6520 6578 616d 706c 6520 6265 6c6f  The example belo
+0000a7e0: 7720 7368 6f77 7320 686f 7720 746f 2072  w shows how to r
+0000a7f0: 6561 6420 616c 6c20 7265 636f 7264 6564  ead all recorded
+0000a800: 2065 7665 6e74 7320 696e 2072 6576 6572   events in rever
+0000a810: 7365 206f 7264 6572 2e5c 6e5c 6e60 6060  se order.\n\n```
+0000a820: 7079 7468 6f6e 5c6e 6576 656e 7473 203d  python\nevents =
+0000a830: 206c 6973 7428 5c6e 2020 2020 636c 6965   list(\n    clie
+0000a840: 6e74 2e72 6561 645f 616c 6c5f 6576 656e  nt.read_all_even
+0000a850: 7473 285c 6e20 2020 2020 2020 2062 6163  ts(\n        bac
+0000a860: 6b77 6172 6473 3d54 7275 655c 6e20 2020  kwards=True\n   
+0000a870: 2029 5c6e 295c 6e5c 6e61 7373 6572 7420   )\n)\n\nassert 
+0000a880: 6c65 6e28 6576 656e 7473 2920 3e3d 2033  len(events) >= 3
+0000a890: 5c6e 5c6e 6173 7365 7274 2065 7665 6e74  \n\nassert event
+0000a8a0: 735b 305d 2e74 7970 6520 3d3d 2022 446f  s[0].type == "Do
+0000a8b0: 674c 6561 726e 6564 5472 6963 6b22 5c6e  gLearnedTrick"\n
+0000a8c0: 6173 7365 7274 2065 7665 6e74 735b 315d  assert events[1]
+0000a8d0: 2e74 7970 6520 3d3d 2022 446f 674c 6561  .type == "DogLea
+0000a8e0: 726e 6564 5472 6963 6b22 5c6e 6173 7365  rnedTrick"\nasse
+0000a8f0: 7274 2065 7665 6e74 735b 325d 2e74 7970  rt events[2].typ
+0000a900: 6520 3d3d 2022 446f 674c 6561 726e 6564  e == "DogLearned
+0000a910: 5472 6963 6b22 5c6e 6173 7365 7274 2065  Trick"\nassert e
+0000a920: 7665 6e74 735b 335d 2e74 7970 6520 3d3d  vents[3].type ==
+0000a930: 2022 446f 6752 6567 6973 7465 7265 6422   "DogRegistered"
+0000a940: 5c6e 5c6e 6173 7365 7274 2065 7665 6e74  \n\nassert event
+0000a950: 735b 345d 2e73 7472 6561 6d5f 6e61 6d65  s[4].stream_name
+0000a960: 203d 3d20 7374 7265 616d 5f6e 616d 6531   == stream_name1
+0000a970: 5c6e 6173 7365 7274 2065 7665 6e74 735b  \nassert events[
+0000a980: 345d 2e73 7472 6561 6d5f 706f 7369 7469  4].stream_positi
+0000a990: 6f6e 203d 3d20 325c 6e61 7373 6572 7420  on == 2\nassert 
+0000a9a0: 6576 656e 7473 5b34 5d2e 7479 7065 203d  events[4].type =
+0000a9b0: 3d20 6576 656e 7433 2e74 7970 655c 6e61  = event3.type\na
+0000a9c0: 7373 6572 7420 6576 656e 7473 5b34 5d2e  ssert events[4].
+0000a9d0: 6461 7461 203d 3d20 6576 656e 7433 2e64  data == event3.d
+0000a9e0: 6174 615c 6e5c 6e61 7373 6572 7420 6576  ata\n\nassert ev
+0000a9f0: 656e 7473 5b35 5d2e 7374 7265 616d 5f6e  ents[5].stream_n
+0000aa00: 616d 6520 3d3d 2073 7472 6561 6d5f 6e61  ame == stream_na
+0000aa10: 6d65 315c 6e61 7373 6572 7420 6576 656e  me1\nassert even
+0000aa20: 7473 5b35 5d2e 7374 7265 616d 5f70 6f73  ts[5].stream_pos
+0000aa30: 6974 696f 6e20 3d3d 2031 5c6e 6173 7365  ition == 1\nasse
+0000aa40: 7274 2065 7665 6e74 735b 355d 2e74 7970  rt events[5].typ
+0000aa50: 6520 3d3d 2065 7665 6e74 322e 7479 7065  e == event2.type
+0000aa60: 5c6e 6173 7365 7274 2065 7665 6e74 735b  \nassert events[
+0000aa70: 355d 2e64 6174 6120 3d3d 2065 7665 6e74  5].data == event
+0000aa80: 322e 6461 7461 5c6e 5c6e 6173 7365 7274  2.data\n\nassert
+0000aa90: 2065 7665 6e74 735b 365d 2e73 7472 6561   events[6].strea
+0000aaa0: 6d5f 6e61 6d65 203d 3d20 7374 7265 616d  m_name == stream
+0000aab0: 5f6e 616d 6531 5c6e 6173 7365 7274 2065  _name1\nassert e
+0000aac0: 7665 6e74 735b 365d 2e73 7472 6561 6d5f  vents[6].stream_
+0000aad0: 706f 7369 7469 6f6e 203d 3d20 305c 6e61  position == 0\na
+0000aae0: 7373 6572 7420 6576 656e 7473 5b36 5d2e  ssert events[6].
+0000aaf0: 7479 7065 203d 3d20 6576 656e 7431 2e74  type == event1.t
+0000ab00: 7970 655c 6e61 7373 6572 7420 6576 656e  ype\nassert even
+0000ab10: 7473 5b36 5d2e 6461 7461 203d 3d20 6576  ts[6].data == ev
+0000ab20: 656e 7431 2e64 6174 615c 6e5c 6e60 6060  ent1.data\n\n```
+0000ab30: 5c6e 5c6e 5468 6520 6578 616d 706c 6520  \n\nThe example 
+0000ab40: 6265 6c6f 7720 7368 6f77 7320 686f 7720  below shows how 
+0000ab50: 746f 2072 6561 6420 6120 6c69 6d69 7465  to read a limite
+0000ab60: 6420 6e75 6d62 6572 2028 6f6e 6529 206f  d number (one) o
+0000ab70: 6620 7468 6520 7265 636f 7264 6564 2065  f the recorded e
+0000ab80: 7665 6e74 735c 6e69 6e20 7468 6520 6461  vents\nin the da
+0000ab90: 7461 6261 7365 2066 6f72 7761 7264 7320  tabase forwards 
+0000aba0: 6672 6f6d 2061 2073 7065 6369 6669 6320  from a specific 
+0000abb0: 636f 6d6d 6974 2070 6f73 6974 696f 6e2e  commit position.
+0000abc0: 2050 6c65 6173 6520 6e6f 7465 2c20 7768   Please note, wh
+0000abd0: 656e 2072 6561 6469 6e67 5c6e 616c 6c20  en reading\nall 
+0000abe0: 6576 656e 7473 2066 6f72 7761 7264 7320  events forwards 
+0000abf0: 6672 6f6d 2061 2073 7065 6369 6669 6320  from a specific 
+0000ac00: 636f 6d6d 6974 2070 6f73 6974 696f 6e2c  commit position,
+0000ac10: 2074 6865 2065 7665 6e74 2061 7420 7468   the event at th
+0000ac20: 6520 7370 6563 6966 6965 645c 6e70 6f73  e specified\npos
+0000ac30: 6974 696f 6e20 5749 4c4c 2062 6520 696e  ition WILL be in
+0000ac40: 636c 7564 6564 2e5c 6e5c 6e5c 6e60 6060  cluded.\n\n\n```
+0000ac50: 7079 7468 6f6e 5c6e 6576 656e 7473 203d  python\nevents =
+0000ac60: 206c 6973 7428 5c6e 2020 2020 636c 6965   list(\n    clie
+0000ac70: 6e74 2e72 6561 645f 616c 6c5f 6576 656e  nt.read_all_even
+0000ac80: 7473 285c 6e20 2020 2020 2020 2063 6f6d  ts(\n        com
+0000ac90: 6d69 745f 706f 7369 7469 6f6e 3d63 6f6d  mit_position=com
+0000aca0: 6d69 745f 706f 7369 7469 6f6e 312c 5c6e  mit_position1,\n
+0000acb0: 2020 2020 2020 2020 6c69 6d69 743d 312c          limit=1,
+0000acc0: 5c6e 2020 2020 295c 6e29 5c6e 5c6e 6173  \n    )\n)\n\nas
+0000acd0: 7365 7274 206c 656e 2865 7665 6e74 7329  sert len(events)
+0000ace0: 203d 3d20 315c 6e5c 6e61 7373 6572 7420   == 1\n\nassert 
+0000acf0: 6576 656e 7473 5b30 5d2e 7374 7265 616d  events[0].stream
+0000ad00: 5f6e 616d 6520 3d3d 2073 7472 6561 6d5f  _name == stream_
+0000ad10: 6e61 6d65 315c 6e61 7373 6572 7420 6576  name1\nassert ev
+0000ad20: 656e 7473 5b30 5d2e 7374 7265 616d 5f70  ents[0].stream_p
+0000ad30: 6f73 6974 696f 6e20 3d3d 2030 5c6e 6173  osition == 0\nas
+0000ad40: 7365 7274 2065 7665 6e74 735b 305d 2e74  sert events[0].t
+0000ad50: 7970 6520 3d3d 2065 7665 6e74 312e 7479  ype == event1.ty
+0000ad60: 7065 5c6e 6173 7365 7274 2065 7665 6e74  pe\nassert event
+0000ad70: 735b 305d 2e64 6174 6120 3d3d 2065 7665  s[0].data == eve
+0000ad80: 6e74 312e 6461 7461 5c6e 5c6e 6173 7365  nt1.data\n\nasse
+0000ad90: 7274 2065 7665 6e74 735b 305d 2e63 6f6d  rt events[0].com
+0000ada0: 6d69 745f 706f 7369 7469 6f6e 203d 3d20  mit_position == 
+0000adb0: 636f 6d6d 6974 5f70 6f73 6974 696f 6e31  commit_position1
+0000adc0: 5c6e 6060 605c 6e5c 6e54 6865 2065 7861  \n```\n\nThe exa
+0000add0: 6d70 6c65 2062 656c 6f77 2073 686f 7773  mple below shows
+0000ade0: 2068 6f77 2074 6f20 7265 6164 2061 206c   how to read a l
+0000adf0: 696d 6974 6564 206e 756d 6265 7220 286f  imited number (o
+0000ae00: 6e65 2920 6f66 2074 6865 2072 6563 6f72  ne) of the recor
+0000ae10: 6465 6420 6576 656e 7473 5c6e 696e 2074  ded events\nin t
+0000ae20: 6865 2064 6174 6162 6173 6520 6261 636b  he database back
+0000ae30: 7761 7264 7320 6672 6f6d 2074 6865 2065  wards from the e
+0000ae40: 6e64 2e20 5468 6973 2067 6976 6573 2074  nd. This gives t
+0000ae50: 6865 206c 6173 7420 7265 636f 7264 6564  he last recorded
+0000ae60: 2065 7665 6e74 2e5c 6e5c 6e60 6060 7079   event.\n\n```py
+0000ae70: 7468 6f6e 5c6e 6576 656e 7473 203d 206c  thon\nevents = l
+0000ae80: 6973 7428 5c6e 2020 2020 636c 6965 6e74  ist(\n    client
+0000ae90: 2e72 6561 645f 616c 6c5f 6576 656e 7473  .read_all_events
+0000aea0: 285c 6e20 2020 2020 2020 2062 6163 6b77  (\n        backw
+0000aeb0: 6172 6473 3d54 7275 652c 5c6e 2020 2020  ards=True,\n    
+0000aec0: 2020 2020 6c69 6d69 743d 312c 5c6e 2020      limit=1,\n  
+0000aed0: 2020 295c 6e29 5c6e 5c6e 6173 7365 7274    )\n)\n\nassert
+0000aee0: 206c 656e 2865 7665 6e74 7329 203d 3d20   len(events) == 
+0000aef0: 315c 6e5c 6e61 7373 6572 7420 6576 656e  1\n\nassert even
+0000af00: 7473 5b30 5d2e 7479 7065 203d 3d20 2244  ts[0].type == "D
+0000af10: 6f67 4c65 6172 6e65 6454 7269 636b 225c  ogLearnedTrick"\
+0000af20: 6e60 6060 5c6e 5c6e 5468 6520 6578 616d  n```\n\nThe exam
+0000af30: 706c 6520 6265 6c6f 7720 7368 6f77 7320  ple below shows 
+0000af40: 686f 7720 746f 2072 6561 6420 6120 6c69  how to read a li
+0000af50: 6d69 7465 6420 6e75 6d62 6572 2028 6f6e  mited number (on
+0000af60: 6529 206f 6620 7468 6520 7265 636f 7264  e) of the record
+0000af70: 6564 2065 7665 6e74 735c 6e69 6e20 7468  ed events\nin th
+0000af80: 6520 6461 7461 6261 7365 2062 6163 6b77  e database backw
+0000af90: 6172 6473 2066 726f 6d20 6120 7370 6563  ards from a spec
+0000afa0: 6966 6963 2063 6f6d 6d69 7420 706f 7369  ific commit posi
+0000afb0: 7469 6f6e 2e20 506c 6561 7365 206e 6f74  tion. Please not
+0000afc0: 652c 2077 6865 6e20 7265 6164 696e 675c  e, when reading\
+0000afd0: 6e61 6c6c 2065 7665 6e74 7320 6261 636b  nall events back
+0000afe0: 7761 7264 7320 6672 6f6d 2061 2073 7065  wards from a spe
+0000aff0: 6369 6669 6320 636f 6d6d 6974 2070 6f73  cific commit pos
+0000b000: 6974 696f 6e2c 2074 6865 2065 7665 6e74  ition, the event
+0000b010: 2061 7420 7468 6520 7370 6563 6966 6965   at the specifie
+0000b020: 645c 6e70 6f73 6974 696f 6e20 5749 4c4c  d\nposition WILL
+0000b030: 204e 4f54 2062 6520 696e 636c 7564 6564   NOT be included
+0000b040: 2e5c 6e5c 6e60 6060 7079 7468 6f6e 5c6e  .\n\n```python\n
+0000b050: 6576 656e 7473 203d 206c 6973 7428 5c6e  events = list(\n
+0000b060: 2020 2020 636c 6965 6e74 2e72 6561 645f      client.read_
+0000b070: 616c 6c5f 6576 656e 7473 285c 6e20 2020  all_events(\n   
+0000b080: 2020 2020 2063 6f6d 6d69 745f 706f 7369       commit_posi
+0000b090: 7469 6f6e 3d63 6f6d 6d69 745f 706f 7369  tion=commit_posi
+0000b0a0: 7469 6f6e 322c 5c6e 2020 2020 2020 2020  tion2,\n        
+0000b0b0: 6261 636b 7761 7264 733d 5472 7565 2c5c  backwards=True,\
+0000b0c0: 6e20 2020 2020 2020 206c 696d 6974 3d31  n        limit=1
+0000b0d0: 2c5c 6e20 2020 2029 5c6e 295c 6e5c 6e61  ,\n    )\n)\n\na
+0000b0e0: 7373 6572 7420 6c65 6e28 6576 656e 7473  ssert len(events
+0000b0f0: 2920 3d3d 2031 5c6e 5c6e 6173 7365 7274  ) == 1\n\nassert
+0000b100: 2065 7665 6e74 735b 305d 2e63 6f6d 6d69   events[0].commi
+0000b110: 745f 706f 7369 7469 6f6e 203c 2063 6f6d  t_position < com
+0000b120: 6d69 745f 706f 7369 7469 6f6e 325c 6e60  mit_position2\n`
+0000b130: 6060 5c6e 5c6e 5c6e 2323 2320 4765 7420  ``\n\n\n### Get 
+0000b140: 6375 7272 656e 7420 7374 7265 616d 2070  current stream p
+0000b150: 6f73 6974 696f 6e5c 6e5c 6e54 6865 2060  osition\n\nThe `
+0000b160: 6765 745f 7374 7265 616d 5f70 6f73 6974  get_stream_posit
+0000b170: 696f 6e28 2960 206d 6574 686f 6420 6361  ion()` method ca
+0000b180: 6e20 6265 2075 7365 6420 746f 5c6e 6765  n be used to\nge
+0000b190: 7420 7468 6520 2273 7472 6561 6d20 706f  t the "stream po
+0000b1a0: 7369 7469 6f6e 2220 6f66 2074 6865 206c  sition" of the l
+0000b1b0: 6173 7420 7265 636f 7264 6564 2065 7665  ast recorded eve
+0000b1c0: 6e74 2069 6e20 6120 7374 7265 616d 2e5c  nt in a stream.\
+0000b1d0: 6e5c 6e54 6869 7320 6d65 7468 6f64 2068  n\nThis method h
+0000b1e0: 6173 2061 2060 7374 7265 616d 5f6e 616d  as a `stream_nam
+0000b1f0: 6560 2061 7267 756d 656e 742c 2077 6869  e` argument, whi
+0000b200: 6368 2069 7320 7265 7175 6972 6564 2e5c  ch is required.\
+0000b210: 6e5c 6e54 6869 7320 6d65 7468 6f64 2061  n\nThis method a
+0000b220: 6c73 6f20 7461 6b65 7320 616e 206f 7074  lso takes an opt
+0000b230: 696f 6e61 6c20 6074 696d 656f 7574 6020  ional `timeout` 
+0000b240: 6172 6775 6d65 6e74 2c20 7468 6174 5c6e  argument, that\n
+0000b250: 6973 2065 7870 6563 7465 6420 746f 2062  is expected to b
+0000b260: 6520 6120 5079 7468 6f6e 2060 666c 6f61  e a Python `floa
+0000b270: 7460 2c20 7768 6963 6820 7365 7473 2061  t`, which sets a
+0000b280: 2064 6561 646c 696e 655c 6e66 6f72 2074   deadline\nfor t
+0000b290: 6865 2063 6f6d 706c 6574 696f 6e20 6f66  he completion of
+0000b2a0: 2074 6865 2067 5250 4320 6f70 6572 6174   the gRPC operat
+0000b2b0: 696f 6e2e 5c6e 5c6e 5468 6520 7365 7175  ion.\n\nThe sequ
+0000b2c0: 656e 6365 206f 6620 706f 7369 7469 6f6e  ence of position
+0000b2d0: 7320 696e 2061 2073 7472 6561 6d20 6973  s in a stream is
+0000b2e0: 2067 6170 6c65 7373 2e20 4974 2069 7320   gapless. It is 
+0000b2f0: 7a65 726f 2d62 6173 6564 2c5c 6e73 6f20  zero-based,\nso 
+0000b300: 7468 6174 2061 2073 7472 6561 6d20 7769  that a stream wi
+0000b310: 7468 206f 6e65 2072 6563 6f72 6465 6420  th one recorded 
+0000b320: 6576 656e 7420 6861 7320 6120 6375 7272  event has a curr
+0000b330: 656e 7420 7374 7265 616d 5c6e 706f 7369  ent stream\nposi
+0000b340: 7469 6f6e 206f 6620 6030 602e 2054 6865  tion of `0`. The
+0000b350: 2063 7572 7265 6e74 2073 7472 6561 6d20   current stream 
+0000b360: 706f 7369 7469 6f6e 2069 7320 6031 6020  position is `1` 
+0000b370: 7768 656e 2061 2073 7472 6561 6d20 6861  when a stream ha
+0000b380: 735c 6e74 776f 2065 7665 6e74 732c 2061  s\ntwo events, a
+0000b390: 6e64 2069 7420 6973 2060 3260 2077 6865  nd it is `2` whe
+0000b3a0: 6e20 7468 6572 6520 6172 6520 6576 656e  n there are even
+0000b3b0: 7473 2c20 616e 6420 736f 206f 6e2e 5c6e  ts, and so on.\n
+0000b3c0: 5c6e 496e 2074 6865 2065 7861 6d70 6c65  \nIn the example
+0000b3d0: 2062 656c 6f77 2c20 7468 6520 6375 7272   below, the curr
+0000b3e0: 656e 7420 7374 7265 616d 2070 6f73 6974  ent stream posit
+0000b3f0: 696f 6e20 6973 206f 6274 6169 6e65 6420  ion is obtained 
+0000b400: 6f66 2074 6865 5c6e 7374 7265 616d 2074  of the\nstream t
+0000b410: 6f20 7768 6963 6820 6576 656e 7473 2077  o which events w
+0000b420: 6572 6520 6170 7065 6e64 6564 2069 6e20  ere appended in 
+0000b430: 7468 6520 6578 616d 706c 6573 2061 626f  the examples abo
+0000b440: 7665 2e5c 6e42 6563 6175 7365 2074 6865  ve.\nBecause the
+0000b450: 2073 6571 7565 6e63 6520 6f66 2073 7472   sequence of str
+0000b460: 6561 6d20 706f 7369 7469 6f6e 7320 6973  eam positions is
+0000b470: 207a 6572 6f2d 6261 7365 642c 2061 6e64   zero-based, and
+0000b480: 2062 6563 6175 7365 5c6e 7468 7265 6520   because\nthree 
+0000b490: 6576 656e 7473 2077 6572 6520 6170 7065  events were appe
+0000b4a0: 6e64 6564 2c20 736f 2074 6865 2063 7572  nded, so the cur
+0000b4b0: 7265 6e74 2073 7472 6561 6d20 706f 7369  rent stream posi
+0000b4c0: 7469 6f6e 2069 7320 6032 602e 5c6e 5c6e  tion is `2`.\n\n
+0000b4d0: 6060 6070 7974 686f 6e5c 6e73 7472 6561  ```python\nstrea
+0000b4e0: 6d5f 706f 7369 7469 6f6e 203d 2063 6c69  m_position = cli
+0000b4f0: 656e 742e 6765 745f 7374 7265 616d 5f70  ent.get_stream_p
+0000b500: 6f73 6974 696f 6e28 5c6e 2020 2020 7374  osition(\n    st
+0000b510: 7265 616d 5f6e 616d 653d 7374 7265 616d  ream_name=stream
+0000b520: 5f6e 616d 6531 5c6e 295c 6e5c 6e61 7373  _name1\n)\n\nass
+0000b530: 6572 7420 7374 7265 616d 5f70 6f73 6974  ert stream_posit
+0000b540: 696f 6e20 3d3d 2032 5c6e 6060 605c 6e5c  ion == 2\n```\n\
+0000b550: 6e49 6620 6120 7374 7265 616d 2064 6f65  nIf a stream doe
+0000b560: 7320 6e6f 7420 6578 6973 742c 2074 6865  s not exist, the
+0000b570: 2072 6574 7572 6e65 6420 7374 7265 616d   returned stream
+0000b580: 2070 6f73 6974 696f 6e20 7661 6c75 6520   position value 
+0000b590: 6973 2060 4e6f 6e65 602c 5c6e 7768 6963  is `None`,\nwhic
+0000b5a0: 6820 6d61 7463 6865 7320 7468 6520 7265  h matches the re
+0000b5b0: 7175 6972 6564 2065 7870 6563 7465 6420  quired expected 
+0000b5c0: 706f 7369 7469 6f6e 2077 6865 6e20 6170  position when ap
+0000b5d0: 7065 6e64 696e 6720 7468 6520 6669 7273  pending the firs
+0000b5e0: 7420 6576 656e 745c 6e6f 6620 6120 6e65  t event\nof a ne
+0000b5f0: 7720 7374 7265 616d 2028 7365 6520 6162  w stream (see ab
+0000b600: 6f76 6529 2e5c 6e5c 6e60 6060 7079 7468  ove).\n\n```pyth
+0000b610: 6f6e 5c6e 7374 7265 616d 5f70 6f73 6974  on\nstream_posit
+0000b620: 696f 6e20 3d20 636c 6965 6e74 2e67 6574  ion = client.get
+0000b630: 5f73 7472 6561 6d5f 706f 7369 7469 6f6e  _stream_position
+0000b640: 285c 6e20 2020 2073 7472 6561 6d5f 6e61  (\n    stream_na
+0000b650: 6d65 3d73 7472 2875 7569 6434 2829 295c  me=str(uuid4())\
+0000b660: 6e29 5c6e 5c6e 6173 7365 7274 2073 7472  n)\n\nassert str
+0000b670: 6561 6d5f 706f 7369 7469 6f6e 203d 3d20  eam_position == 
+0000b680: 4e6f 6e65 5c6e 6060 605c 6e5c 6e54 6869  None\n```\n\nThi
+0000b690: 7320 6d65 7468 6f64 2074 616b 6573 2061  s method takes a
+0000b6a0: 6e20 6f70 7469 6f6e 616c 2061 7267 756d  n optional argum
+0000b6b0: 656e 7420 6074 696d 656f 7574 6020 7768  ent `timeout` wh
+0000b6c0: 6963 6820 6973 2061 2050 7974 686f 6e20  ich is a Python 
+0000b6d0: 6066 6c6f 6174 6020 7468 6174 2073 6574  `float` that set
+0000b6e0: 735c 6e61 2064 6561 646c 696e 6520 666f  s\na deadline fo
+0000b6f0: 7220 7468 6520 636f 6d70 6c65 7469 6f6e  r the completion
+0000b700: 206f 6620 7468 6520 6752 5043 206f 7065   of the gRPC ope
+0000b710: 7261 7469 6f6e 2e5c 6e5c 6e5c 6e23 2323  ration.\n\n\n###
+0000b720: 2047 6574 2063 7572 7265 6e74 2063 6f6d   Get current com
+0000b730: 6d69 7420 706f 7369 7469 6f6e 5c6e 5c6e  mit position\n\n
+0000b740: 5468 6520 6d65 7468 6f64 2060 6765 745f  The method `get_
+0000b750: 636f 6d6d 6974 5f70 6f73 6974 696f 6e28  commit_position(
+0000b760: 2960 2063 616e 2062 6520 7573 6564 2074  )` can be used t
+0000b770: 6f20 6765 7420 7468 6520 6375 7272 656e  o get the curren
+0000b780: 745c 6e63 6f6d 6d69 7420 706f 7369 7469  t\ncommit positi
+0000b790: 6f6e 206f 6620 7468 6520 6461 7461 6261  on of the databa
+0000b7a0: 7365 2e5c 6e5c 6e60 6060 7079 7468 6f6e  se.\n\n```python
+0000b7b0: 5c6e 636f 6d6d 6974 5f70 6f73 6974 696f  \ncommit_positio
+0000b7c0: 6e20 3d20 636c 6965 6e74 2e67 6574 5f63  n = client.get_c
+0000b7d0: 6f6d 6d69 745f 706f 7369 7469 6f6e 2829  ommit_position()
+0000b7e0: 5c6e 6060 605c 6e5c 6e54 6869 7320 6d65  \n```\n\nThis me
+0000b7f0: 7468 6f64 2074 616b 6573 2061 6e20 6f70  thod takes an op
+0000b800: 7469 6f6e 616c 2061 7267 756d 656e 7420  tional argument 
+0000b810: 6074 696d 656f 7574 6020 7768 6963 6820  `timeout` which 
+0000b820: 6973 2061 2050 7974 686f 6e20 6066 6c6f  is a Python `flo
+0000b830: 6174 6020 7468 6174 2073 6574 735c 6e61  at` that sets\na
+0000b840: 2064 6561 646c 696e 6520 666f 7220 7468   deadline for th
+0000b850: 6520 636f 6d70 6c65 7469 6f6e 206f 6620  e completion of 
+0000b860: 7468 6520 6752 5043 206f 7065 7261 7469  the gRPC operati
+0000b870: 6f6e 2e5c 6e5c 6e54 6869 7320 6d65 7468  on.\n\nThis meth
+0000b880: 6f64 2063 616e 2062 6520 7573 6566 756c  od can be useful
+0000b890: 2074 6f20 6d65 6173 7572 6520 7072 6f67   to measure prog
+0000b8a0: 7265 7373 206f 6620 6120 646f 776e 7374  ress of a downst
+0000b8b0: 7265 616d 2063 6f6d 706f 6e65 6e74 5c6e  ream component\n
+0000b8c0: 7468 6174 2069 7320 7072 6f63 6573 7369  that is processi
+0000b8d0: 6e67 2061 6c6c 2072 6563 6f72 6465 6420  ng all recorded 
+0000b8e0: 6576 656e 7473 2c20 6279 2063 6f6d 7061  events, by compa
+0000b8f0: 7269 6e67 2074 6865 2063 7572 7265 6e74  ring the current
+0000b900: 2063 6f6d 6d69 745c 6e70 6f73 6974 696f   commit\npositio
+0000b910: 6e20 7769 7468 2074 6865 2072 6563 6f72  n with the recor
+0000b920: 6465 6420 636f 6d6d 6974 2070 6f73 6974  ded commit posit
+0000b930: 696f 6e20 6f66 2074 6865 206c 6173 7420  ion of the last 
+0000b940: 7375 6363 6573 7366 756c 6c79 2070 726f  successfully pro
+0000b950: 6365 7373 6564 5c6e 6576 656e 7420 696e  cessed\nevent in
+0000b960: 2061 2064 6f77 6e73 7472 6561 6d20 636f   a downstream co
+0000b970: 6d70 6f6e 656e 742e 5c6e 5c6e 5468 6520  mponent.\n\nThe 
+0000b980: 7661 6c75 6520 6f66 2074 6865 2060 636f  value of the `co
+0000b990: 6d6d 6974 5f70 6f73 6974 696f 6e60 2061  mmit_position` a
+0000b9a0: 7267 756d 656e 7420 7768 656e 2072 6561  rgument when rea
+0000b9b0: 6469 6e67 2065 7665 6e74 7320 6569 7468  ding events eith
+0000b9c0: 6572 2062 7920 7573 696e 675c 6e74 6865  er by using\nthe
+0000b9d0: 2060 7265 6164 5f61 6c6c 5f65 7665 6e74   `read_all_event
+0000b9e0: 7328 2960 206d 6574 686f 6420 6f72 2062  s()` method or b
+0000b9f0: 7920 7573 696e 6720 6120 6361 7463 682d  y using a catch-
+0000ba00: 7570 2073 7562 7363 7269 7074 696f 6e20  up subscription 
+0000ba10: 776f 756c 6420 7573 7561 6c6c 795c 6e62  would usually\nb
+0000ba20: 6520 6465 7465 726d 696e 6564 2062 7920  e determined by 
+0000ba30: 7468 6520 7265 636f 7264 6564 2063 6f6d  the recorded com
+0000ba40: 6d69 7420 706f 7369 7469 6f6e 206f 6620  mit position of 
+0000ba50: 7468 6520 6c61 7374 2073 7563 6365 7373  the last success
+0000ba60: 6675 6c6c 7920 7072 6f63 6573 7365 645c  fully processed\
+0000ba70: 6e65 7665 6e74 2069 6e20 6120 646f 776e  nevent in a down
+0000ba80: 7374 7265 616d 2063 6f6d 706f 6e65 6e74  stream component
+0000ba90: 2e5c 6e5c 6e5c 6e23 2323 2047 6574 2073  .\n\n\n### Get s
+0000baa0: 7472 6561 6d20 6d65 7461 6461 7461 5c6e  tream metadata\n
+0000bab0: 5c6e 5468 6520 6d65 7468 6f64 2060 6765  \nThe method `ge
+0000bac0: 745f 7374 7265 616d 5f6d 6574 6164 6174  t_stream_metadat
+0000bad0: 6128 2960 2067 6574 7320 7468 6520 6d65  a()` gets the me
+0000bae0: 7461 6461 7461 2066 6f72 2061 2073 7472  tadata for a str
+0000baf0: 6561 6d2c 2061 6c6f 6e67 5c6e 7769 7468  eam, along\nwith
+0000bb00: 2074 6865 2076 6572 7369 6f6e 206f 6620   the version of 
+0000bb10: 7468 6520 7374 7265 616d 206d 6574 6164  the stream metad
+0000bb20: 6174 612e 5c6e 5c6e 6060 6070 7974 686f  ata.\n\n```pytho
+0000bb30: 6e5c 6e6d 6574 6164 6174 612c 206d 6574  n\nmetadata, met
+0000bb40: 6164 6174 615f 7665 7273 696f 6e20 3d20  adata_version = 
+0000bb50: 636c 6965 6e74 2e67 6574 5f73 7472 6561  client.get_strea
+0000bb60: 6d5f 6d65 7461 6461 7461 2873 7472 6561  m_metadata(strea
+0000bb70: 6d5f 6e61 6d65 3d73 7472 6561 6d5f 6e61  m_name=stream_na
+0000bb80: 6d65 3129 5c6e 6060 605c 6e5c 6e54 6865  me1)\n```\n\nThe
+0000bb90: 2072 6574 7572 6e65 6420 606d 6574 6164   returned `metad
+0000bba0: 6174 6160 2076 616c 7565 2069 7320 6120  ata` value is a 
+0000bbb0: 5079 7468 6f6e 2060 6469 6374 602e 2054  Python `dict`. T
+0000bbc0: 6865 2072 6574 7572 6e65 6420 606d 6574  he returned `met
+0000bbd0: 6164 6174 615f 7665 7273 696f 6e60 5c6e  adata_version`\n
+0000bbe0: 7661 6c75 6520 6973 2065 6974 6865 7220  value is either 
+0000bbf0: 616e 2060 696e 7460 2c20 6f72 2060 4e6f  an `int`, or `No
+0000bc00: 6e65 6020 6966 2074 6865 2073 7472 6561  ne` if the strea
+0000bc10: 6d20 646f 6573 206e 6f74 2065 7869 7374  m does not exist
+0000bc20: 2e20 5468 6573 6520 7661 6c75 6573 2063  . These values c
+0000bc30: 616e 5c6e 6265 2070 6173 7365 6420 696e  an\nbe passed in
+0000bc40: 746f 2060 7365 745f 7374 7265 616d 5f6d  to `set_stream_m
+0000bc50: 6574 6164 6174 6128 2960 2e5c 6e5c 6e5c  etadata()`.\n\n\
+0000bc60: 6e23 2323 2053 6574 2073 7472 6561 6d20  n### Set stream 
+0000bc70: 6d65 7461 6461 7461 5c6e 5c6e 2a72 6571  metadata\n\n*req
+0000bc80: 7569 7265 7320 6c65 6164 6572 2a5c 6e5c  uires leader*\n\
+0000bc90: 6e54 6865 206d 6574 686f 6420 6073 6574  nThe method `set
+0000bca0: 5f73 7472 6561 6d5f 6d65 7461 6461 7461  _stream_metadata
+0000bcb0: 2829 6020 7365 7473 2074 6865 206d 6574  ()` sets the met
+0000bcc0: 6164 6174 6120 666f 7220 6120 7374 7265  adata for a stre
+0000bcd0: 616d 2c20 616c 6f6e 675c 6e77 6974 6820  am, along\nwith 
+0000bce0: 7468 6520 7665 7273 696f 6e20 6f66 2074  the version of t
+0000bcf0: 6865 2073 7472 6561 6d20 6d65 7461 6461  he stream metada
+0000bd00: 7461 2e5c 6e5c 6e60 6060 7079 7468 6f6e  ta.\n\n```python
+0000bd10: 5c6e 6d65 7461 6461 7461 5b22 666f 6f22  \nmetadata["foo"
+0000bd20: 5d20 3d20 2262 6172 225c 6e5c 6e63 6c69  ] = "bar"\n\ncli
+0000bd30: 656e 742e 7365 745f 7374 7265 616d 5f6d  ent.set_stream_m
+0000bd40: 6574 6164 6174 6128 5c6e 2020 2020 7374  etadata(\n    st
+0000bd50: 7265 616d 5f6e 616d 653d 7374 7265 616d  ream_name=stream
+0000bd60: 5f6e 616d 6531 2c5c 6e20 2020 206d 6574  _name1,\n    met
+0000bd70: 6164 6174 613d 6d65 7461 6461 7461 2c5c  adata=metadata,\
+0000bd80: 6e20 2020 2065 7870 6563 7465 645f 706f  n    expected_po
+0000bd90: 7369 7469 6f6e 3d6d 6574 6164 6174 615f  sition=metadata_
+0000bda0: 7665 7273 696f 6e2c 5c6e 295c 6e60 6060  version,\n)\n```
+0000bdb0: 5c6e 5c6e 5468 6520 6065 7870 6563 7465  \n\nThe `expecte
+0000bdc0: 645f 706f 7369 7469 6f6e 6020 6172 6775  d_position` argu
+0000bdd0: 6d65 6e74 2073 686f 756c 6420 6265 2074  ment should be t
+0000bde0: 6865 2063 7572 7265 6e74 2076 6572 7369  he current versi
+0000bdf0: 6f6e 206f 6620 7468 6520 7374 7265 616d  on of the stream
+0000be00: 206d 6574 6164 6174 612e 5c6e 5c6e 506c   metadata.\n\nPl
+0000be10: 6561 7365 2072 6566 6572 2074 6f20 7468  ease refer to th
+0000be20: 6520 4576 656e 7453 746f 7265 4442 2064  e EventStoreDB d
+0000be30: 6f63 756d 656e 7461 7469 6f6e 2066 6f72  ocumentation for
+0000be40: 206d 6f72 6520 696e 666f 726d 6174 696f   more informatio
+0000be50: 6e20 6162 6f75 7420 7374 7265 616d 5c6e  n about stream\n
+0000be60: 6d65 7461 6461 7461 2e5c 6e5c 6e23 2323  metadata.\n\n###
+0000be70: 2044 656c 6574 6520 7374 7265 616d 5c6e   Delete stream\n
+0000be80: 5c6e 2a72 6571 7569 7265 7320 6c65 6164  \n*requires lead
+0000be90: 6572 2a5c 6e5c 6e54 6865 206d 6574 686f  er*\n\nThe metho
+0000bea0: 6420 6064 656c 6574 655f 7374 7265 616d  d `delete_stream
+0000beb0: 2829 6020 6361 6e20 6265 2075 7365 6420  ()` can be used 
+0000bec0: 746f 2022 6465 6c65 7465 2220 6120 7374  to "delete" a st
+0000bed0: 7265 616d 2e5c 6e5c 6e60 6060 7079 7468  ream.\n\n```pyth
+0000bee0: 6f6e 5c6e 636f 6d6d 6974 5f70 6f73 6974  on\ncommit_posit
+0000bef0: 696f 6e20 3d20 636c 6965 6e74 2e64 656c  ion = client.del
+0000bf00: 6574 655f 7374 7265 616d 2873 7472 6561  ete_stream(strea
+0000bf10: 6d5f 6e61 6d65 3d73 7472 6561 6d5f 6e61  m_name=stream_na
+0000bf20: 6d65 312c 2065 7870 6563 7465 645f 706f  me1, expected_po
+0000bf30: 7369 7469 6f6e 3d32 295c 6e60 6060 5c6e  sition=2)\n```\n
+0000bf40: 5c6e 4166 7465 7220 6465 6c65 7469 6e67  \nAfter deleting
+0000bf50: 2061 2073 7472 6561 6d2c 2069 745c 2773   a stream, it\'s
+0000bf60: 2073 7469 6c6c 2070 6f73 7369 626c 6520   still possible 
+0000bf70: 746f 2061 7070 656e 6420 6e65 7720 6576  to append new ev
+0000bf80: 656e 7473 2e20 5265 6164 696e 6720 6672  ents. Reading fr
+0000bf90: 6f6d 2061 5c6e 6465 6c65 7465 6420 7374  om a\ndeleted st
+0000bfa0: 7265 616d 2077 696c 6c20 7265 7475 726e  ream will return
+0000bfb0: 206f 6e6c 7920 6576 656e 7473 2074 6861   only events tha
+0000bfc0: 7420 6861 7665 2062 6565 6e20 6170 7065  t have been appe
+0000bfd0: 6e64 6564 2061 6674 6572 2069 7420 7761  nded after it wa
+0000bfe0: 735c 6e64 656c 6574 6564 2e5c 6e5c 6e23  s\ndeleted.\n\n#
+0000bff0: 2323 2054 6f6d 6273 746f 6e65 2073 7472  ## Tombstone str
+0000c000: 6561 6d5c 6e5c 6e2a 7265 7175 6972 6573  eam\n\n*requires
+0000c010: 206c 6561 6465 722a 5c6e 5c6e 5468 6520   leader*\n\nThe 
+0000c020: 6d65 7468 6f64 2060 746f 6d62 7374 6f6e  method `tombston
+0000c030: 655f 7374 7265 616d 2829 6020 6361 6e20  e_stream()` can 
+0000c040: 6265 2075 7365 6420 746f 2022 746f 6d62  be used to "tomb
+0000c050: 7374 6f6e 6522 2061 2073 7472 6561 6d2e  stone" a stream.
+0000c060: 5c6e 5c6e 6060 6070 7974 686f 6e5c 6e63  \n\n```python\nc
+0000c070: 6f6d 6d69 745f 706f 7369 7469 6f6e 203d  ommit_position =
+0000c080: 2063 6c69 656e 742e 746f 6d62 7374 6f6e   client.tombston
+0000c090: 655f 7374 7265 616d 2873 7472 6561 6d5f  e_stream(stream_
+0000c0a0: 6e61 6d65 3d73 7472 6561 6d5f 6e61 6d65  name=stream_name
+0000c0b0: 312c 2065 7870 6563 7465 645f 706f 7369  1, expected_posi
+0000c0c0: 7469 6f6e 3d32 295c 6e60 6060 5c6e 5c6e  tion=2)\n```\n\n
+0000c0d0: 4166 7465 7220 746f 6d62 7374 6f6e 696e  After tombstonin
+0000c0e0: 6720 6120 7374 7265 616d 2c20 6974 5c27  g a stream, it\'
+0000c0f0: 7320 6e6f 7420 706f 7373 6962 6c65 2074  s not possible t
+0000c100: 6f20 6170 7065 6e64 206e 6577 2065 7665  o append new eve
+0000c110: 6e74 732e 5c6e 5c6e 5c6e 2323 2043 6174  nts.\n\n\n## Cat
+0000c120: 6368 2d75 7020 7375 6273 6372 6970 7469  ch-up subscripti
+0000c130: 6f6e 735c 6e5c 6e22 4361 7463 682d 7570  ons\n\n"Catch-up
+0000c140: 2220 7375 6273 6372 6970 7469 6f6e 7320  " subscriptions 
+0000c150: 6361 6e20 6265 2075 7365 6420 746f 2072  can be used to r
+0000c160: 6563 6569 7665 2065 7665 6e74 7320 7468  eceive events th
+0000c170: 6174 2068 6176 6520 6265 656e 2072 6563  at have been rec
+0000c180: 6f72 6465 645c 6e69 6e20 7468 6520 6461  orded\nin the da
+0000c190: 7461 6261 7365 2c20 616e 6420 616c 736f  tabase, and also
+0000c1a0: 2065 7665 6e74 7320 7468 6174 2061 7265   events that are
+0000c1b0: 2072 6563 6f72 6465 6420 6166 7465 7220   recorded after 
+0000c1c0: 6120 7375 6273 6372 6970 7469 6f6e 2077  a subscription w
+0000c1d0: 6173 2073 7461 7274 6564 2e5c 6e5c 6e54  as started.\n\nT
+0000c1e0: 6865 206d 6574 686f 6420 6073 7562 7363  he method `subsc
+0000c1f0: 7269 6265 5f61 6c6c 5f65 7665 6e74 7328  ribe_all_events(
+0000c200: 2960 2073 7461 7274 7320 6120 6361 7463  )` starts a catc
+0000c210: 682d 7570 2073 7562 7363 7269 7074 696f  h-up subscriptio
+0000c220: 6e20 746f 2072 6563 6569 7665 2061 6c6c  n to receive all
+0000c230: 5c6e 6576 656e 7473 2074 6861 7420 6861  \nevents that ha
+0000c240: 7665 2062 6565 6e20 616e 6420 7769 6c6c  ve been and will
+0000c250: 2062 6520 7265 636f 7264 6564 2069 6e20   be recorded in 
+0000c260: 7468 6520 6461 7461 6261 7365 2e20 5468  the database. Th
+0000c270: 6520 6d65 7468 6f64 5c6e 6073 7562 7363  e method\n`subsc
+0000c280: 7269 6265 5f73 7472 6561 6d5f 6576 656e  ribe_stream_even
+0000c290: 7473 2829 6020 7374 6172 7473 2061 2063  ts()` starts a c
+0000c2a0: 6174 6368 2d75 7020 7375 6273 6372 6970  atch-up subscrip
+0000c2b0: 7469 6f6e 2074 6f20 7265 6365 6976 6520  tion to receive 
+0000c2c0: 6576 656e 7473 2066 726f 6d5c 6e61 2073  events from\na s
+0000c2d0: 7065 6369 6669 6320 7374 7265 616d 2e5c  pecific stream.\
+0000c2e0: 6e5c 6e43 6174 6368 2d75 7020 7375 6273  n\nCatch-up subs
+0000c2f0: 6372 6970 7469 6f6e 7320 656e 6361 7073  criptions encaps
+0000c300: 756c 6174 6520 6120 7374 7265 616d 696e  ulate a streamin
+0000c310: 6720 6752 5043 2063 616c 6c20 7768 6963  g gRPC call whic
+0000c320: 6820 6973 5c6e 6b65 7074 206f 7065 6e20  h is\nkept open 
+0000c330: 6279 2074 6865 2073 6572 7665 722c 2077  by the server, w
+0000c340: 6974 6820 6e65 776c 7920 7265 636f 7264  ith newly record
+0000c350: 6564 2065 7665 6e74 7320 7365 6e74 2074  ed events sent t
+0000c360: 6f20 7468 6520 636c 6965 6e74 5c6e 6173  o the client\nas
+0000c370: 2074 6865 2063 6c69 656e 7420 6974 6572   the client iter
+0000c380: 6174 6573 206f 7665 7220 7468 6520 7375  ates over the su
+0000c390: 6273 6372 6970 7469 6f6e 2072 6573 706f  bscription respo
+0000c3a0: 6e73 652e 5c6e 5c6e 4d61 6e79 2063 6174  nse.\n\nMany cat
+0000c3b0: 6368 2d75 7020 7375 6273 6372 6970 7469  ch-up subscripti
+0000c3c0: 6f6e 7320 6361 6e20 6265 2063 7265 6174  ons can be creat
+0000c3d0: 6564 2c20 636f 6e63 7572 7265 6e74 6c79  ed, concurrently
+0000c3e0: 206f 7220 7375 6363 6573 7369 7665 6c79   or successively
+0000c3f0: 2c20 616e 6420 616c 6c5c 6e77 696c 6c20  , and all\nwill 
+0000c400: 7265 6365 6976 6520 616c 6c20 7468 6520  receive all the 
+0000c410: 7265 636f 7264 6564 2065 7665 6e74 7320  recorded events 
+0000c420: 7468 6579 2068 6176 6520 6265 656e 2072  they have been r
+0000c430: 6571 7565 7374 6564 2074 6f20 7265 6365  equested to rece
+0000c440: 6976 652e 5c6e 5c6e 5468 6520 7265 6365  ive.\n\nThe rece
+0000c450: 6976 6564 2072 6563 6f72 6465 6420 6576  ived recorded ev
+0000c460: 656e 7420 6f62 6a65 6374 2061 7265 2069  ent object are i
+0000c470: 6e73 7461 6e63 6573 206f 6620 7468 6520  nstances of the 
+0000c480: 6052 6563 6f72 6465 6445 7665 6e74 6020  `RecordedEvent` 
+0000c490: 636c 6173 735c 6e28 7365 6520 7468 6520  class\n(see the 
+0000c4a0: 4e6f 7465 7320 7365 6374 696f 6e20 6265  Notes section be
+0000c4b0: 6c6f 7720 666f 7220 6465 7461 696c 7320  low for details 
+0000c4c0: 6f66 2074 6869 7320 636c 6173 7329 2e5c  of this class).\
+0000c4d0: 6e5c 6e23 2323 2048 6f77 2074 6f20 696d  n\n### How to im
+0000c4e0: 706c 656d 656e 7420 6578 6163 746c 792d  plement exactly-
+0000c4f0: 6f6e 6365 2065 7665 6e74 2070 726f 6365  once event proce
+0000c500: 7373 696e 675c 6e5c 6e54 6865 2063 6f6d  ssing\n\nThe com
+0000c510: 6d69 7420 706f 7369 7469 6f6e 7320 6f66  mit positions of
+0000c520: 2072 6563 6f72 6465 6420 6576 656e 7473   recorded events
+0000c530: 2074 6861 7420 6172 6520 7265 6365 6976   that are receiv
+0000c540: 6564 2061 6e64 2070 726f 6365 7373 6564  ed and processed
+0000c550: 2062 7920 615c 6e64 6f77 6e73 7472 6561   by a\ndownstrea
+0000c560: 6d20 636f 6d70 6f6e 656e 7420 6172 6520  m component are 
+0000c570: 7573 6566 756c 6c79 2072 6563 6f72 6465  usefully recorde
+0000c580: 6420 6279 2074 6865 2064 6f77 6e73 7472  d by the downstr
+0000c590: 6561 6d20 636f 6d70 6f6e 656e 7420 736f  eam component so
+0000c5a0: 2074 6861 745c 6e74 6865 2063 6f6d 6d69   that\nthe commi
+0000c5b0: 7420 706f 7369 7469 6f6e 206f 6620 6c61  t position of la
+0000c5c0: 7374 2070 726f 6365 7373 6564 2065 7665  st processed eve
+0000c5d0: 6e74 2063 616e 2062 6520 6465 7465 726d  nt can be determ
+0000c5e0: 696e 6564 2e5c 6e5c 6e54 6865 206c 6173  ined.\n\nThe las
+0000c5f0: 7420 7265 636f 7264 6564 2063 6f6d 6d69  t recorded commi
+0000c600: 7420 706f 7369 7469 6f6e 2063 616e 2062  t position can b
+0000c610: 6520 7573 6564 2074 6f20 7370 6563 6966  e used to specif
+0000c620: 7920 7468 6520 636f 6d6d 6974 2070 6f73  y the commit pos
+0000c630: 6974 696f 6e20 6672 6f6d 2077 6869 6368  ition from which
+0000c640: 5c6e 746f 2073 7562 7363 7269 6265 2077  \nto subscribe w
+0000c650: 6865 6e20 7072 6f63 6573 7369 6e67 2069  hen processing i
+0000c660: 7320 7265 7375 6d65 642e 2053 696e 6365  s resumed. Since
+0000c670: 2074 6869 7320 636f 6d6d 6974 2070 6f73   this commit pos
+0000c680: 6974 696f 6e20 7769 6c6c 2072 6570 7265  ition will repre
+0000c690: 7365 6e74 2074 6865 5c6e 706f 7369 7469  sent the\npositi
+0000c6a0: 6f6e 206f 6620 7468 6520 6c61 7374 2073  on of the last s
+0000c6b0: 7563 6365 7373 6675 6c6c 7920 7072 6f63  uccessfully proc
+0000c6c0: 6573 7365 6420 6576 656e 7420 696e 2061  essed event in a
+0000c6d0: 2064 6f77 6e73 7472 6561 6d20 636f 6d70   downstream comp
+0000c6e0: 6f6e 656e 742c 2073 6f20 6974 5c6e 7769  onent, so it\nwi
+0000c6f0: 6c6c 2062 6520 7573 7561 6c20 746f 2077  ll be usual to w
+0000c700: 616e 7420 7468 6520 6e65 7874 2065 7665  ant the next eve
+0000c710: 6e74 2061 6674 6572 2074 6869 7320 706f  nt after this po
+0000c720: 7369 7469 6f6e 2c20 6265 6361 7573 6520  sition, because 
+0000c730: 7468 6174 2069 7320 7468 6520 6e65 7874  that is the next
+0000c740: 5c6e 6576 656e 7420 7468 6174 2068 6173  \nevent that has
+0000c750: 206e 6f74 2079 6574 2062 6565 6e20 7072   not yet been pr
+0000c760: 6f63 6573 7365 642e 2046 6f72 2074 6869  ocessed. For thi
+0000c770: 7320 7265 6173 6f6e 2c20 7768 656e 2073  s reason, when s
+0000c780: 7562 7363 7269 6269 6e67 2066 6f72 2065  ubscribing for e
+0000c790: 7665 6e74 735c 6e66 726f 6d20 6120 7370  vents\nfrom a sp
+0000c7a0: 6563 6966 6963 2063 6f6d 6d69 7420 706f  ecific commit po
+0000c7b0: 7369 7469 6f6e 2075 7369 6e67 2061 2063  sition using a c
+0000c7c0: 6174 6368 2d75 7020 7375 6273 6372 6970  atch-up subscrip
+0000c7d0: 7469 6f6e 2069 6e20 4576 656e 7453 746f  tion in EventSto
+0000c7e0: 7265 4442 2c20 7468 655c 6e72 6563 6f72  reDB, the\nrecor
+0000c7f0: 6465 6420 6576 656e 7420 6174 2074 6865  ded event at the
+0000c800: 2073 7065 6369 6669 6564 2063 6f6d 6d69   specified commi
+0000c810: 7420 706f 7369 7469 6f6e 2077 696c 6c20  t position will 
+0000c820: 4e4f 5420 6265 2069 6e63 6c75 6465 6420  NOT be included 
+0000c830: 696e 2074 6865 2073 6571 7565 6e63 655c  in the sequence\
+0000c840: 6e6f 6620 7265 636f 7264 6564 2065 7665  nof recorded eve
+0000c850: 6e74 7320 7468 6174 2061 7265 2072 6563  nts that are rec
+0000c860: 6569 7665 642e 5c6e 5c6e 546f 2061 6363  eived.\n\nTo acc
+0000c870: 6f6d 706c 6973 6820 2265 7861 6374 6c79  omplish "exactly
+0000c880: 2d6f 6e63 6522 2070 726f 6365 7373 696e  -once" processin
+0000c890: 6720 6f66 2072 6563 6f72 6465 6420 6576  g of recorded ev
+0000c8a0: 656e 7473 2069 6e20 6120 646f 776e 7374  ents in a downst
+0000c8b0: 7265 616d 5c6e 636f 6d70 6f6e 656e 7420  ream\ncomponent 
+0000c8c0: 7768 656e 2075 7369 6e67 2061 2063 6174  when using a cat
+0000c8d0: 6368 2d75 7020 7375 6273 6372 6970 7469  ch-up subscripti
+0000c8e0: 6f6e 2c20 7468 6520 636f 6d6d 6974 2070  on, the commit p
+0000c8f0: 6f73 6974 696f 6e20 6f66 2061 2072 6563  osition of a rec
+0000c900: 6f72 6465 645c 6e65 7665 6e74 2073 686f  orded\nevent sho
+0000c910: 756c 6420 6265 2072 6563 6f72 6465 6420  uld be recorded 
+0000c920: 6174 6f6d 6963 616c 6c79 2061 6e64 2075  atomically and u
+0000c930: 6e69 7175 656c 7920 616c 6f6e 6720 7769  niquely along wi
+0000c940: 7468 2074 6865 2072 6573 756c 7420 6f66  th the result of
+0000c950: 2070 726f 6365 7373 696e 675c 6e72 6563   processing\nrec
+0000c960: 6f72 6465 6420 6576 656e 7473 2c20 666f  orded events, fo
+0000c970: 7220 6578 616d 706c 6520 696e 2074 6865  r example in the
+0000c980: 2073 616d 6520 6461 7461 6261 7365 2061   same database a
+0000c990: 7320 6d61 7465 7269 616c 6973 6564 2076  s materialised v
+0000c9a0: 6965 7773 2077 6865 6e5c 6e69 6d70 6c65  iews when\nimple
+0000c9b0: 6d65 6e74 696e 6720 6576 656e 7475 616c  menting eventual
+0000c9c0: 6c79 2d63 6f6e 7369 7374 656e 7420 4351  ly-consistent CQ
+0000c9d0: 5253 2c20 6f72 2069 6e20 7468 6520 7361  RS, or in the sa
+0000c9e0: 6d65 2064 6174 6162 6173 6520 6173 2061  me database as a
+0000c9f0: 2064 6f77 6e73 7472 6561 6d5c 6e61 6e61   downstream\nana
+0000ca00: 6c79 7469 6373 206f 7220 7265 706f 7274  lytics or report
+0000ca10: 696e 6720 6f72 2061 7263 6869 7669 6e67  ing or archiving
+0000ca20: 2061 7070 6c69 6361 7469 6f6e 2e20 4279   application. By
+0000ca30: 2072 6563 6f72 6469 6e67 2074 6865 2063   recording the c
+0000ca40: 6f6d 6d69 7420 706f 7369 7469 6f6e 5c6e  ommit position\n
+0000ca50: 6f66 2072 6563 6f72 6465 6420 6576 656e  of recorded even
+0000ca60: 7473 2061 746f 6d69 6361 6c6c 7920 7769  ts atomically wi
+0000ca70: 7468 2074 6865 206e 6577 2073 7461 7465  th the new state
+0000ca80: 2074 6861 7420 7265 7375 6c74 7320 6672   that results fr
+0000ca90: 6f6d 2070 726f 6365 7373 696e 675c 6e72  om processing\nr
+0000caa0: 6563 6f72 6465 6420 6576 656e 7473 2c20  ecorded events, 
+0000cab0: 2264 7561 6c20 7772 6974 696e 6722 2069  "dual writing" i
+0000cac0: 6e20 7468 6520 636f 6e73 756d 7074 696f  n the consumptio
+0000cad0: 6e20 6f66 2072 6563 6f72 6465 6420 6576  n of recorded ev
+0000cae0: 656e 7473 2063 616e 2062 655c 6e61 766f  ents can be\navo
+0000caf0: 6964 6564 2e20 4279 2061 6c73 6f20 7265  ided. By also re
+0000cb00: 636f 7264 696e 6720 7468 6520 636f 6d6d  cording the comm
+0000cb10: 6974 2070 6f73 6974 696f 6e20 756e 6971  it position uniq
+0000cb20: 7565 6c79 2c20 7468 6520 6e65 7720 7374  uely, the new st
+0000cb30: 6174 6520 6361 6e6e 6f74 2062 655c 6e72  ate cannot be\nr
+0000cb40: 6563 6f72 6465 6420 7477 6963 652c 2061  ecorded twice, a
+0000cb50: 6e64 2068 656e 6365 2074 6865 2072 6563  nd hence the rec
+0000cb60: 6f72 6465 6420 7374 6174 6520 6f66 2074  orded state of t
+0000cb70: 6865 2064 6f77 6e73 7472 6561 6d20 636f  he downstream co
+0000cb80: 6d70 6f6e 656e 7420 7769 6c6c 2062 655c  mponent will be\
+0000cb90: 6e75 7064 6174 6564 206f 6e6c 7920 6f6e  nupdated only on
+0000cba0: 6365 2066 6f72 2061 6e79 2072 6563 6f72  ce for any recor
+0000cbb0: 6465 6420 6576 656e 742e 2042 7920 7573  ded event. By us
+0000cbc0: 696e 6720 7468 6520 6772 6561 7465 7374  ing the greatest
+0000cbd0: 2072 6563 6f72 6465 6420 636f 6d6d 6974   recorded commit
+0000cbe0: 5c6e 706f 7369 7469 6f6e 2074 6f20 7265  \nposition to re
+0000cbf0: 7375 6d65 2061 2063 6174 6368 2d75 7020  sume a catch-up 
+0000cc00: 7375 6273 6372 6970 7469 6f6e 2c20 616c  subscription, al
+0000cc10: 6c20 7265 636f 7264 6564 2065 7665 6e74  l recorded event
+0000cc20: 7320 7769 6c6c 2065 7665 6e74 7561 6c6c  s will eventuall
+0000cc30: 795c 6e62 6520 7072 6f63 6573 7365 642e  y\nbe processed.
+0000cc40: 2054 6865 2063 6f6d 6269 6e61 7469 6f6e   The combination
+0000cc50: 206f 6620 7468 6520 2261 742d 6d6f 7374   of the "at-most
+0000cc60: 2d6f 6e63 6522 2063 6f6e 6469 7469 6f6e  -once" condition
+0000cc70: 2061 6e64 2074 6865 2022 6174 2d6c 6561   and the "at-lea
+0000cc80: 7374 2d6f 6e63 6522 5c6e 636f 6e64 6974  st-once"\ncondit
+0000cc90: 696f 6e20 6769 7665 7320 7468 6520 2265  ion gives the "e
+0000cca0: 7861 6374 6c79 2d6f 6e63 6522 2063 6f6e  xactly-once" con
+0000ccb0: 6469 7469 6f6e 2e5c 6e5c 6e54 6865 2064  dition.\n\nThe d
+0000ccc0: 616e 6765 7220 7769 7468 2022 6475 616c  anger with "dual
+0000ccd0: 2077 7269 7469 6e67 2220 696e 2074 6865   writing" in the
+0000cce0: 2063 6f6e 7375 6d70 7469 6f6e 206f 6620   consumption of 
+0000ccf0: 7265 636f 7264 6564 2065 7665 6e74 7320  recorded events 
+0000cd00: 6973 2074 6861 7420 6966 2061 5c6e 7265  is that if a\nre
+0000cd10: 636f 7264 6564 2065 7665 6e74 2069 7320  corded event is 
+0000cd20: 7375 6363 6573 7366 756c 6c79 2070 726f  successfully pro
+0000cd30: 6365 7373 6564 2061 6e64 206e 6577 2073  cessed and new s
+0000cd40: 7461 7465 2072 6563 6f72 6465 6420 6174  tate recorded at
+0000cd50: 6f6d 6963 616c 6c79 2069 6e20 6f6e 655c  omically in one\
+0000cd60: 6e74 7261 6e73 6163 7469 6f6e 2077 6974  ntransaction wit
+0000cd70: 6820 7468 6520 636f 6d6d 6974 2070 6f73  h the commit pos
+0000cd80: 6974 696f 6e20 7265 636f 7264 6564 2069  ition recorded i
+0000cd90: 6e20 6120 7365 7061 7261 7465 2074 7261  n a separate tra
+0000cda0: 6e73 6163 7469 6f6e 2c20 6f6e 6520 6d61  nsaction, one ma
+0000cdb0: 795c 6e68 6170 7065 6e20 616e 6420 6e6f  y\nhappen and no
+0000cdc0: 7420 7468 6520 6f74 6865 722e 2049 6620  t the other. If 
+0000cdd0: 7468 6520 6e65 7720 7374 6174 6520 6973  the new state is
+0000cde0: 2072 6563 6f72 6465 6420 6275 7420 7468   recorded but th
+0000cdf0: 6520 706f 7369 7469 6f6e 2069 7320 6c6f  e position is lo
+0000ce00: 7374 2c5c 6e61 6e64 2074 6865 6e20 7468  st,\nand then th
+0000ce10: 6520 7072 6f63 6573 7369 6e67 2069 7320  e processing is 
+0000ce20: 7374 6f70 7065 6420 616e 6420 7265 7375  stopped and resu
+0000ce30: 6d65 642c 2074 6865 2072 6563 6f72 6465  med, the recorde
+0000ce40: 6420 6576 656e 7420 6d61 7920 6265 2070  d event may be p
+0000ce50: 726f 6365 7373 6564 5c6e 7477 6963 652e  rocessed\ntwice.
+0000ce60: 204f 6e20 7468 6520 6f74 6865 7220 6861   On the other ha
+0000ce70: 6e64 2c20 6966 2074 6865 2063 6f6d 6d69  nd, if the commi
+0000ce80: 7420 706f 7369 7469 6f6e 2069 7320 7265  t position is re
+0000ce90: 636f 7264 6564 2062 7574 2074 6865 206e  corded but the n
+0000cea0: 6577 2073 7461 7465 2069 735c 6e6c 6f73  ew state is\nlos
+0000ceb0: 742c 2074 6865 2072 6563 6f72 6465 6420  t, the recorded 
+0000cec0: 6576 656e 7420 6d61 7920 6566 6665 6374  event may effect
+0000ced0: 6976 656c 7920 6e6f 7420 6265 2070 726f  ively not be pro
+0000cee0: 6365 7373 6564 2061 7420 616c 6c2e 2042  cessed at all. B
+0000cef0: 7920 6569 7468 6572 5c6e 7072 6f63 6573  y either\nproces
+0000cf00: 7369 6e67 2061 6e20 6576 656e 7420 6d6f  sing an event mo
+0000cf10: 7265 2074 6861 6e20 6f6e 6365 2c20 6f72  re than once, or
+0000cf20: 2062 7920 6661 696c 696e 6720 746f 2070   by failing to p
+0000cf30: 726f 6365 7373 2061 6e20 6576 656e 742c  rocess an event,
+0000cf40: 2074 6865 2072 6563 6f72 6465 645c 6e73   the recorded\ns
+0000cf50: 7461 7465 206f 6620 7468 6520 646f 776e  tate of the down
+0000cf60: 7374 7265 616d 2063 6f6d 706f 6e65 6e74  stream component
+0000cf70: 206d 6967 6874 2062 6520 696e 6163 6375   might be inaccu
+0000cf80: 7261 7465 2c20 6f72 2070 6f73 7369 626c  rate, or possibl
+0000cf90: 7920 696e 636f 6e73 6973 7465 6e74 2c20  y inconsistent, 
+0000cfa0: 616e 645c 6e70 6572 6861 7073 2063 6174  and\nperhaps cat
+0000cfb0: 6173 7472 6f70 6869 6361 6c6c 7920 736f  astrophically so
+0000cfc0: 2e20 5375 6368 2063 6f6e 7365 7175 656e  . Such consequen
+0000cfd0: 6365 7320 6d61 7920 6f72 206d 6179 206e  ces may or may n
+0000cfe0: 6f74 206d 6174 7465 7220 696e 2079 6f75  ot matter in you
+0000cff0: 7220 7369 7475 6174 696f 6e2e 5c6e 4275  r situation.\nBu
+0000d000: 7420 736f 6d65 7469 6d65 7320 696e 636f  t sometimes inco
+0000d010: 6e73 6973 7465 6e63 6965 7320 6d61 7920  nsistencies may 
+0000d020: 6861 6c74 2070 726f 6365 7373 696e 6720  halt processing 
+0000d030: 756e 7469 6c20 7468 6520 6973 7375 6520  until the issue 
+0000d040: 6973 2072 6573 6f6c 7665 642e 2059 6f75  is resolved. You
+0000d050: 2063 616e 5c6e 6176 6f69 6420 2264 7561   can\navoid "dua
+0000d060: 6c20 7772 6974 696e 6722 2069 6e20 7468  l writing" in th
+0000d070: 6520 636f 6e73 756d 7074 696f 6e20 6f66  e consumption of
+0000d080: 2065 7665 6e74 7320 6279 2061 746f 6d69   events by atomi
+0000d090: 6361 6c6c 7920 7265 636f 7264 696e 6720  cally recording 
+0000d0a0: 7468 6520 636f 6d6d 6974 5c6e 706f 7369  the commit\nposi
+0000d0b0: 7469 6f6e 206f 6620 6120 7265 636f 7264  tion of a record
+0000d0c0: 6564 2065 7665 6e74 2061 6c6f 6e67 2077  ed event along w
+0000d0d0: 6974 6820 7468 6520 6e65 7720 7374 6174  ith the new stat
+0000d0e0: 6520 7468 6174 2072 6573 756c 7473 2066  e that results f
+0000d0f0: 726f 6d20 7072 6f63 6573 7369 6e67 2074  rom processing t
+0000d100: 6861 745c 6e65 7665 6e74 2069 6e20 7468  hat\nevent in th
+0000d110: 6520 7361 6d65 2061 746f 6d69 6320 7472  e same atomic tr
+0000d120: 616e 7361 6374 696f 6e2e 2042 7920 6d61  ansaction. By ma
+0000d130: 6b69 6e67 2074 6865 2072 6563 6f72 6469  king the recordi
+0000d140: 6e67 206f 6620 7468 6520 636f 6d6d 6974  ng of the commit
+0000d150: 2070 6f73 6974 696f 6e73 5c6e 756e 6971   positions\nuniq
+0000d160: 7565 2c20 736f 2074 6861 7420 7472 616e  ue, so that tran
+0000d170: 7361 6374 696f 6e73 2077 696c 6c20 6265  sactions will be
+0000d180: 2072 6f6c 6c65 6420 6261 636b 2077 6865   rolled back whe
+0000d190: 6e20 7468 6572 6520 6973 2061 2063 6f6e  n there is a con
+0000d1a0: 666c 6963 742c 2079 6f75 2077 696c 6c5c  flict, you will\
+0000d1b0: 6e70 7265 7665 6e74 2074 6865 2072 6573  nprevent the res
+0000d1c0: 756c 7473 206f 6620 616e 7920 6475 706c  ults of any dupl
+0000d1d0: 6963 6174 6520 7072 6f63 6573 7369 6e67  icate processing
+0000d1e0: 206f 6620 6120 7265 636f 7264 6564 2065   of a recorded e
+0000d1f0: 7665 6e74 2062 6569 6e67 2063 6f6d 6d69  vent being commi
+0000d200: 7474 6564 2e5c 6e5c 6e52 6563 6f72 6465  tted.\n\nRecorde
+0000d210: 6420 6576 656e 7473 2072 6563 6569 7665  d events receive
+0000d220: 6420 6672 6f6d 2061 2063 6174 6368 2d75  d from a catch-u
+0000d230: 7020 7375 6273 6372 6970 7469 6f6e 2063  p subscription c
+0000d240: 616e 6e6f 7420 6265 2061 636b 6e6f 776c  annot be acknowl
+0000d250: 6564 6765 6420 6261 636b 5c6e 746f 2074  edged back\nto t
+0000d260: 6865 2045 7665 6e74 5374 6f72 6544 4220  he EventStoreDB 
+0000d270: 7365 7276 6572 2e20 4163 6b6e 6f77 6c65  server. Acknowle
+0000d280: 6467 696e 6720 6576 656e 7473 2c20 686f  dging events, ho
+0000d290: 7765 7665 722c 2069 7320 616e 2061 7370  wever, is an asp
+0000d2a0: 6563 7420 6f66 2022 7065 7273 6973 7465  ect of "persiste
+0000d2b0: 6e74 5c6e 7375 6273 6372 6970 7469 6f6e  nt\nsubscription
+0000d2c0: 7322 2e20 486f 7069 6e67 2074 6f20 7265  s". Hoping to re
+0000d2d0: 6c79 206f 6e20 6163 6b6e 6f77 6c65 6467  ly on acknowledg
+0000d2e0: 696e 6720 6576 656e 7473 2074 6f20 616e  ing events to an
+0000d2f0: 2075 7073 7472 6561 6d5c 6e63 6f6d 706f   upstream\ncompo
+0000d300: 6e65 6e74 2069 7320 616e 2065 7861 6d70  nent is an examp
+0000d310: 6c65 206f 6620 6475 616c 2077 7269 7469  le of dual writi
+0000d320: 6e67 2e5c 6e5c 6e23 2323 2053 7562 7363  ng.\n\n### Subsc
+0000d330: 7269 6265 2061 6c6c 2065 7665 6e74 735c  ribe all events\
+0000d340: 6e5c 6e54 6865 6073 7562 7363 7269 6265  n\nThe`subscribe
+0000d350: 5f61 6c6c 5f65 7665 6e74 7328 2960 206d  _all_events()` m
+0000d360: 6574 686f 6420 6361 6e20 6265 2075 7365  ethod can be use
+0000d370: 6420 746f 2073 7461 7274 2061 2022 6361  d to start a "ca
+0000d380: 7463 682d 7570 2220 7375 6273 6372 6970  tch-up" subscrip
+0000d390: 7469 6f6e 5c6e 7468 6174 2063 616e 2072  tion\nthat can r
+0000d3a0: 6574 7572 6e20 6576 656e 7473 2066 726f  eturn events fro
+0000d3b0: 6d20 616c 6c20 7374 7265 616d 7320 696e  m all streams in
+0000d3c0: 2074 6865 2064 6174 6162 6173 652e 5c6e   the database.\n
+0000d3d0: 5c6e 5468 6973 206d 6574 686f 6420 6361  \nThis method ca
+0000d3e0: 6e20 6265 2075 7365 6420 6279 2061 2064  n be used by a d
+0000d3f0: 6f77 6e73 7472 6561 6d20 636f 6d70 6f6e  ownstream compon
+0000d400: 656e 745c 6e74 6f20 7072 6f63 6573 7320  ent\nto process 
+0000d410: 7265 636f 7264 6564 2065 7665 6e74 7320  recorded events 
+0000d420: 7769 7468 2065 7861 6374 6c79 2d6f 6e63  with exactly-onc
+0000d430: 6520 7365 6d61 6e74 6963 732e 5c6e 5c6e  e semantics.\n\n
+0000d440: 5468 6973 206d 6574 686f 6420 7461 6b65  This method take
+0000d450: 7320 616e 206f 7074 696f 6e61 6c20 6063  s an optional `c
+0000d460: 6f6d 6d69 745f 706f 7369 7469 6f6e 6020  ommit_position` 
+0000d470: 6172 6775 6d65 6e74 2c20 7768 6963 6820  argument, which 
+0000d480: 6361 6e20 6265 5c6e 7573 6564 2074 6f20  can be\nused to 
+0000d490: 7370 6563 6966 7920 6120 636f 6d6d 6974  specify a commit
+0000d4a0: 2070 6f73 6974 696f 6e20 6672 6f6d 2077   position from w
+0000d4b0: 6869 6368 2074 6f20 7375 6273 6372 6962  hich to subscrib
+0000d4c0: 652e 2054 6865 2064 6566 6175 6c74 5c6e  e. The default\n
+0000d4d0: 7661 6c75 6520 6973 2060 4e6f 6e65 602c  value is `None`,
+0000d4e0: 2077 6869 6368 206d 6561 6e73 2074 6865   which means the
+0000d4f0: 2073 7562 7363 7269 7074 696f 6e20 7769   subscription wi
+0000d500: 6c6c 206f 7065 7261 7465 2066 726f 6d20  ll operate from 
+0000d510: 7468 6520 6669 7273 745c 6e72 6563 6f72  the first\nrecor
+0000d520: 6465 6420 6576 656e 7420 696e 2074 6865  ded event in the
+0000d530: 2064 6174 6162 6173 652e 2049 6620 6120   database. If a 
+0000d540: 636f 6d6d 6974 2070 6f73 6974 696f 6e20  commit position 
+0000d550: 6973 2067 6976 656e 2c20 6974 206d 7573  is given, it mus
+0000d560: 7420 6d61 7463 685c 6e61 6e20 6163 7475  t match\nan actu
+0000d570: 616c 6c79 2065 7869 7374 696e 6720 636f  ally existing co
+0000d580: 6d6d 6974 2070 6f73 6974 696f 6e20 696e  mmit position in
+0000d590: 2074 6865 2064 6174 6162 6173 652e 2054   the database. T
+0000d5a0: 6865 2072 6563 6f64 6564 2065 7665 6e74  he recoded event
+0000d5b0: 7320 7468 6174 5c6e 6172 6520 6f62 7461  s that\nare obta
+0000d5c0: 696e 6564 2077 696c 6c20 6e6f 7420 696e  ined will not in
+0000d5d0: 636c 7564 6520 7468 6520 6576 656e 7420  clude the event 
+0000d5e0: 7265 636f 7264 6564 2061 7420 7468 6174  recorded at that
+0000d5f0: 2063 6f6d 6d69 7420 706f 7369 7469 6f6e   commit position
+0000d600: 2e5c 6e5c 6e54 6869 7320 6d65 7468 6f64  .\n\nThis method
+0000d610: 2061 6c73 6f20 7461 6b65 7320 666f 7572   also takes four
+0000d620: 206f 7468 6572 206f 7074 696f 6e61 6c20   other optional 
+0000d630: 6172 6775 6d65 6e74 732c 2060 6669 6c74  arguments, `filt
+0000d640: 6572 5f65 7863 6c75 6465 602c 5c6e 6066  er_exclude`,\n`f
+0000d650: 696c 7465 725f 696e 636c 7564 6560 2c20  ilter_include`, 
+0000d660: 6066 696c 7465 725f 6279 5f73 7472 6561  `filter_by_strea
+0000d670: 6d5f 6e61 6d65 602c 2061 6e64 2060 7469  m_name`, and `ti
+0000d680: 6d65 6f75 7460 2e5c 6e5c 6e54 6865 206f  meout`.\n\nThe o
+0000d690: 7074 696f 6e61 6c20 6172 6775 6d65 6e74  ptional argument
+0000d6a0: 2060 6669 6c74 6572 5f65 7863 6c75 6465   `filter_exclude
+0000d6b0: 6020 6973 2061 2073 6571 7565 6e63 6520  ` is a sequence 
+0000d6c0: 6f66 2072 6567 756c 6172 2065 7870 7265  of regular expre
+0000d6d0: 7373 696f 6e73 2074 6861 745c 6e6d 6174  ssions that\nmat
+0000d6e0: 6368 2072 6563 6f72 6465 6420 6576 656e  ch recorded even
+0000d6f0: 7473 2074 6861 7420 7368 6f75 6c64 206e  ts that should n
+0000d700: 6f74 2062 6520 696e 636c 7564 6564 2e20  ot be included. 
+0000d710: 5468 6973 2061 7267 756d 656e 7420 6973  This argument is
+0000d720: 2069 676e 6f72 6564 5c6e 6966 2060 6669   ignored\nif `fi
+0000d730: 6c74 6572 5f69 6e63 6c75 6465 6020 6973  lter_include` is
+0000d740: 2073 6574 2074 6f20 6120 6e6f 6e2d 656d   set to a non-em
+0000d750: 7074 7920 7365 7175 656e 6365 2e20 4279  pty sequence. By
+0000d760: 2064 6566 6175 6c74 2c20 7468 6973 2061   default, this a
+0000d770: 7267 756d 656e 7420 6973 2073 6574 5c6e  rgument is set\n
+0000d780: 746f 206d 6174 6368 2074 6865 2065 7665  to match the eve
+0000d790: 6e74 2074 7970 6573 206f 6620 2273 7973  nt types of "sys
+0000d7a0: 7465 6d20 6576 656e 7473 222c 2073 6f20  tem events", so 
+0000d7b0: 7468 6174 2045 7665 6e74 5374 6f72 6544  that EventStoreD
+0000d7c0: 4220 7379 7374 656d 2065 7665 6e74 735c  B system events\
+0000d7d0: 6e77 696c 6c20 6e6f 7420 6e6f 726d 616c  nwill not normal
+0000d7e0: 6c79 2062 6520 696e 636c 7564 6564 2e20  ly be included. 
+0000d7f0: 5365 6520 7468 6520 4e6f 7465 7320 7365  See the Notes se
+0000d800: 6374 696f 6e20 6265 6c6f 7720 666f 7220  ction below for 
+0000d810: 6d6f 7265 2069 6e66 6f72 6d61 7469 6f6e  more information
+0000d820: 5c6e 6162 6f75 7420 6669 6c74 6572 2065  \nabout filter e
+0000d830: 7870 7265 7373 696f 6e73 2e5c 6e5c 6e54  xpressions.\n\nT
+0000d840: 6865 206f 7074 696f 6e61 6c20 6172 6775  he optional argu
+0000d850: 6d65 6e74 2060 6669 6c74 6572 5f69 6e63  ment `filter_inc
+0000d860: 6c75 6465 6020 6973 2061 2073 6571 7565  lude` is a seque
+0000d870: 6e63 6520 6f66 2072 6567 756c 6172 2065  nce of regular e
+0000d880: 7870 7265 7373 696f 6e73 5c6e 7468 6174  xpressions\nthat
+0000d890: 206d 6174 6368 2072 6563 6f72 6465 6420   match recorded 
+0000d8a0: 6576 656e 7473 2074 6861 7420 7368 6f75  events that shou
+0000d8b0: 6c64 2062 6520 696e 636c 7564 6564 2e20  ld be included. 
+0000d8c0: 4279 2064 6566 6175 6c74 2c20 7468 6973  By default, this
+0000d8d0: 2061 7267 756d 656e 745c 6e69 7320 616e   argument\nis an
+0000d8e0: 2065 6d70 7479 2074 7570 6c65 2e20 4966   empty tuple. If
+0000d8f0: 2074 6869 7320 6172 6775 6d65 6e74 2069   this argument i
+0000d900: 7320 7365 7420 746f 2061 206e 6f6e 2d65  s set to a non-e
+0000d910: 6d70 7479 2073 6571 7565 6e63 652c 2074  mpty sequence, t
+0000d920: 6865 5c6e 6066 696c 7465 725f 6578 636c  he\n`filter_excl
+0000d930: 7564 6560 2061 7267 756d 656e 7420 6973  ude` argument is
+0000d940: 2069 676e 6f72 6564 2e5c 6e5c 6e54 6865   ignored.\n\nThe
+0000d950: 206f 7074 696f 6e61 6c20 6172 6775 6d65   optional argume
+0000d960: 6e74 2060 6669 6c74 6572 5f62 795f 7374  nt `filter_by_st
+0000d970: 7265 616d 5f6e 616d 6560 2069 7320 6120  ream_name` is a 
+0000d980: 5079 7468 6f6e 2060 626f 6f6c 6020 7468  Python `bool` th
+0000d990: 6174 2069 6e64 6963 6174 6573 2077 6865  at indicates whe
+0000d9a0: 7468 6572 5c6e 7468 6520 6669 6c74 6572  ther\nthe filter
+0000d9b0: 2077 696c 6c20 6170 706c 7920 746f 2065   will apply to e
+0000d9c0: 7665 6e74 2074 7970 6573 206f 7220 7374  vent types or st
+0000d9d0: 7265 616d 206e 616d 6573 2e20 4279 2064  ream names. By d
+0000d9e0: 6566 6175 6c74 2c20 7468 6973 2076 616c  efault, this val
+0000d9f0: 7565 2069 7320 6046 616c 7365 605c 6e61  ue is `False`\na
+0000da00: 6e64 2073 6f20 7468 6520 6669 6c74 6572  nd so the filter
+0000da10: 696e 6720 7769 6c6c 2061 7070 6c79 2074  ing will apply t
+0000da20: 6f20 7468 6520 6576 656e 7420 7479 7065  o the event type
+0000da30: 2073 7472 696e 6773 206f 6620 7265 636f   strings of reco
+0000da40: 7264 6564 2065 7665 6e74 732e 5c6e 5c6e  rded events.\n\n
+0000da50: 506c 6561 7365 206e 6f74 652c 2074 6865  Please note, the
+0000da60: 2066 696c 7465 7269 6e67 2068 6170 7065   filtering happe
+0000da70: 6e73 206f 6e20 7468 6520 4576 656e 7453  ns on the EventS
+0000da80: 746f 7265 4442 2073 6572 7665 722c 2061  toreDB server, a
+0000da90: 6e64 2074 6865 5c6e 606c 696d 6974 6020  nd the\n`limit` 
+0000daa0: 6172 6775 6d65 6e74 2069 7320 6170 706c  argument is appl
+0000dab0: 6965 6420 6f6e 2074 6865 2073 6572 7665  ied on the serve
+0000dac0: 7220 6166 7465 7220 6669 6c74 6572 696e  r after filterin
+0000dad0: 672e 5c6e 5c6e 5468 6520 6f70 7469 6f6e  g.\n\nThe option
+0000dae0: 616c 2060 7469 6d65 6f75 7460 2061 7267  al `timeout` arg
+0000daf0: 756d 656e 7420 6973 2061 2050 7974 686f  ument is a Pytho
+0000db00: 6e20 6066 6c6f 6174 6020 7768 6963 6820  n `float` which 
+0000db10: 7365 7473 2061 5c6e 6465 6164 6c69 6e65  sets a\ndeadline
+0000db20: 2066 6f72 2074 6865 2063 6f6d 706c 6574   for the complet
+0000db30: 696f 6e20 6f66 2074 6865 2067 5250 4320  ion of the gRPC 
+0000db40: 6f70 6572 6174 696f 6e2e 5c6e 5c6e 5468  operation.\n\nTh
+0000db50: 6973 206d 6574 686f 6420 7265 7475 726e  is method return
+0000db60: 7320 6120 5079 7468 6f6e 2069 7465 7261  s a Python itera
+0000db70: 746f 7220 7468 6174 2079 6965 6c64 7320  tor that yields 
+0000db80: 7265 636f 7264 6564 2065 7665 6e74 732c  recorded events,
+0000db90: 2069 6e63 6c75 6469 6e67 2065 7665 6e74   including event
+0000dba0: 735c 6e74 6861 7420 6172 6520 7265 636f  s\nthat are reco
+0000dbb0: 7264 6564 2061 6674 6572 2074 6865 2073  rded after the s
+0000dbc0: 7562 7363 7269 7074 696f 6e20 7761 7320  ubscription was 
+0000dbd0: 6372 6561 7465 642e 2049 7465 7261 7469  created. Iterati
+0000dbe0: 6e67 206f 7665 7220 7468 6973 206f 626a  ng over this obj
+0000dbf0: 6563 7420 7769 6c6c 5c6e 7468 6572 6566  ect will\ntheref
+0000dc00: 6f72 6520 6e6f 7420 7374 6f70 2c20 756e  ore not stop, un
+0000dc10: 6c65 7373 2074 6865 2063 6f6e 6e65 6374  less the connect
+0000dc20: 696f 6e20 746f 2074 6865 2064 6174 6162  ion to the datab
+0000dc30: 6173 6520 6973 206c 6f73 742e 2054 6865  ase is lost. The
+0000dc40: 2063 616c 6c20 7769 6c6c 5c6e 6265 2065   call will\nbe e
+0000dc50: 6e64 6564 2077 6865 6e20 7468 6520 6974  nded when the it
+0000dc60: 6572 6174 6f72 206f 626a 6563 7420 6973  erator object is
+0000dc70: 2064 656c 6574 6564 2066 726f 6d20 6d65   deleted from me
+0000dc80: 6d6f 7279 2c20 7768 6963 6820 7769 6c6c  mory, which will
+0000dc90: 2068 6170 7065 6e20 7768 656e 2074 6865   happen when the
+0000dca0: 5c6e 6974 6572 6174 6f72 206f 626a 6563  \niterator objec
+0000dcb0: 7420 676f 6573 206f 7574 206f 6620 7363  t goes out of sc
+0000dcc0: 6f70 6520 6f72 2069 7320 6578 706c 6963  ope or is explic
+0000dcd0: 6974 6c79 2064 656c 6574 6564 2e20 5468  itly deleted. Th
+0000dce0: 6520 6361 6c6c 206d 6179 2061 6c73 6f20  e call may also 
+0000dcf0: 6265 5c6e 636c 6f73 6564 2062 7920 7468  be\nclosed by th
+0000dd00: 6520 7365 7276 6572 2e5c 6e5c 6e54 6865  e server.\n\nThe
+0000dd10: 2073 7562 7363 7269 7074 696f 6e20 6f62   subscription ob
+0000dd20: 6a65 6374 2063 616e 2062 6520 7573 6564  ject can be used
+0000dd30: 2064 6972 6563 746c 792c 2062 7574 2069   directly, but i
+0000dd40: 7420 6d69 6768 7420 6265 2075 7365 6420  t might be used 
+0000dd50: 7769 7468 696e 2061 2074 6872 6561 6465  within a threade
+0000dd60: 645c 6e6c 6f6f 7020 6465 6469 6361 7465  d\nloop dedicate
+0000dd70: 6420 746f 2072 6563 6569 7669 6e67 2065  d to receiving e
+0000dd80: 7665 6e74 7320 7468 6174 2063 616e 2062  vents that can b
+0000dd90: 6520 7374 6f70 7065 6420 696e 2061 2063  e stopped in a c
+0000dda0: 6f6e 7472 6f6c 6c65 6420 7761 792c 2077  ontrolled way, w
+0000ddb0: 6974 685c 6e72 6563 6f72 6465 6420 6576  ith\nrecorded ev
+0000ddc0: 656e 7473 2070 7574 206f 6e20 6120 7175  ents put on a qu
+0000ddd0: 6575 6520 666f 7220 7072 6f63 6573 7369  eue for processi
+0000dde0: 6e67 2069 6e20 6120 6469 6666 6572 656e  ng in a differen
+0000ddf0: 7420 7468 7265 6164 2e20 5468 6973 2070  t thread. This p
+0000de00: 6163 6b61 6765 5c6e 646f 6573 6e5c 2774  ackage\ndoesn\'t
+0000de10: 2070 726f 7669 6465 2073 7563 6820 6120   provide such a 
+0000de20: 7468 7265 6164 6564 206f 7220 7175 6575  threaded or queu
+0000de30: 696e 6720 6f62 6a65 6374 2063 6c61 7373  ing object class
+0000de40: 2e20 4a75 7374 206d 616b 6520 7375 7265  . Just make sure
+0000de50: 2074 6f20 7265 636f 6e73 7472 7563 745c   to reconstruct\
+0000de60: 6e74 6865 2073 7562 7363 7269 7074 696f  nthe subscriptio
+0000de70: 6e20 2861 6e64 2074 6865 2071 7565 7565  n (and the queue
+0000de80: 2920 7573 696e 6720 7468 6520 6c61 7374  ) using the last
+0000de90: 2072 6563 6f72 6465 6420 636f 6d6d 6974   recorded commit
+0000dea0: 2070 6f73 6974 696f 6e20 7768 656e 2072   position when r
+0000deb0: 6573 756d 696e 675c 6e74 6865 2073 7562  esuming\nthe sub
+0000dec0: 7363 7269 7074 696f 6e20 6166 7465 7220  scription after 
+0000ded0: 616e 2065 7272 6f72 2c20 746f 2062 6520  an error, to be 
+0000dee0: 7375 7265 2061 6c6c 2065 7665 6e74 7320  sure all events 
+0000def0: 6172 6520 7072 6f63 6573 7365 6420 6f6e  are processed on
+0000df00: 6365 2e5c 6e5c 6e54 6865 2065 7861 6d70  ce.\n\nThe examp
+0000df10: 6c65 2062 656c 6f77 2073 686f 7773 2068  le below shows h
+0000df20: 6f77 2074 6f20 7375 6273 6372 6962 6520  ow to subscribe 
+0000df30: 746f 2072 6563 6569 7665 2061 6c6c 2072  to receive all r
+0000df40: 6563 6f72 6465 645c 6e65 7665 6e74 7320  ecorded\nevents 
+0000df50: 6672 6f6d 2074 6865 2073 7461 7274 2c20  from the start, 
+0000df60: 616e 6420 7468 656e 2072 6573 756d 696e  and then resumin
+0000df70: 6720 6672 6f6d 2061 2073 7065 6369 6669  g from a specifi
+0000df80: 6320 636f 6d6d 6974 2070 6f73 6974 696f  c commit positio
+0000df90: 6e2e 5c6e 5468 7265 6520 616c 7265 6164  n.\nThree alread
+0000dfa0: 792d 7265 636f 7264 6564 2065 7665 6e74  y-recorded event
+0000dfb0: 7320 6172 6520 7265 6365 6976 6564 2c20  s are received, 
+0000dfc0: 616e 6420 7468 656e 2074 6872 6565 206e  and then three n
+0000dfd0: 6577 2065 7665 6e74 7320 6172 655c 6e72  ew events are\nr
+0000dfe0: 6563 6f72 6465 642c 2077 6869 6368 2061  ecorded, which a
+0000dff0: 7265 2074 6865 6e20 7265 6365 6976 6564  re then received
+0000e000: 2076 6961 2074 6865 2073 7562 7363 7269   via the subscri
+0000e010: 7074 696f 6e2e 5c6e 5c6e 6060 6070 7974  ption.\n\n```pyt
+0000e020: 686f 6e5c 6e5c 6e23 2041 7070 656e 6420  hon\n\n# Append 
+0000e030: 616e 2065 7665 6e74 2074 6f20 6120 6e65  an event to a ne
+0000e040: 7720 7374 7265 616d 2e5c 6e73 7472 6561  w stream.\nstrea
+0000e050: 6d5f 6e61 6d65 3220 3d20 7374 7228 7575  m_name2 = str(uu
+0000e060: 6964 3428 2929 5c6e 6576 656e 7434 203d  id4())\nevent4 =
+0000e070: 204e 6577 4576 656e 7428 7479 7065 3d5c   NewEvent(type=\
+0000e080: 274f 7264 6572 4372 6561 7465 645c 272c  'OrderCreated\',
+0000e090: 2064 6174 613d 625c 2764 6174 6134 5c27   data=b\'data4\'
+0000e0a0: 295c 6e63 6c69 656e 742e 6170 7065 6e64  )\nclient.append
+0000e0b0: 5f65 7665 6e74 7328 5c6e 2020 2020 7374  _events(\n    st
+0000e0c0: 7265 616d 5f6e 616d 653d 7374 7265 616d  ream_name=stream
+0000e0d0: 5f6e 616d 6532 2c5c 6e20 2020 2065 7870  _name2,\n    exp
+0000e0e0: 6563 7465 645f 706f 7369 7469 6f6e 3d4e  ected_position=N
+0000e0f0: 6f6e 652c 5c6e 2020 2020 6576 656e 7473  one,\n    events
+0000e100: 3d5b 6576 656e 7434 5d2c 5c6e 295c 6e5c  =[event4],\n)\n\
+0000e110: 6e23 2053 7562 7363 7269 6265 2066 726f  n# Subscribe fro
+0000e120: 6d20 7468 6520 6669 7273 7420 7265 636f  m the first reco
+0000e130: 7264 6564 2065 7665 6e74 2069 6e20 7468  rded event in th
+0000e140: 6520 6461 7461 6261 7365 2e5c 6e73 7562  e database.\nsub
+0000e150: 7363 7269 7074 696f 6e20 3d20 636c 6965  scription = clie
+0000e160: 6e74 2e73 7562 7363 7269 6265 5f61 6c6c  nt.subscribe_all
+0000e170: 5f65 7665 6e74 7328 295c 6e72 6563 6569  _events()\nrecei
+0000e180: 7665 645f 6576 656e 7473 203d 205b 5d5c  ved_events = []\
+0000e190: 6e5c 6e23 2050 726f 6365 7373 2065 7665  n\n# Process eve
+0000e1a0: 6e74 7320 7265 6365 6976 6564 2066 726f  nts received fro
+0000e1b0: 6d20 7468 6520 6361 7463 682d 7570 2073  m the catch-up s
+0000e1c0: 7562 7363 7269 7074 696f 6e2e 5c6e 666f  ubscription.\nfo
+0000e1d0: 7220 6576 656e 7420 696e 2073 7562 7363  r event in subsc
+0000e1e0: 7269 7074 696f 6e3a 5c6e 2020 2020 6c61  ription:\n    la
+0000e1f0: 7374 5f63 6f6d 6d69 745f 706f 7369 7469  st_commit_positi
+0000e200: 6f6e 203d 2065 7665 6e74 2e63 6f6d 6d69  on = event.commi
+0000e210: 745f 706f 7369 7469 6f6e 5c6e 2020 2020  t_position\n    
+0000e220: 7265 6365 6976 6564 5f65 7665 6e74 732e  received_events.
+0000e230: 6170 7065 6e64 2865 7665 6e74 295c 6e20  append(event)\n 
+0000e240: 2020 2069 6620 6576 656e 742e 6964 203d     if event.id =
+0000e250: 3d20 6576 656e 7434 2e69 643a 5c6e 2020  = event4.id:\n  
+0000e260: 2020 2020 2020 6272 6561 6b5c 6e5c 6e61        break\n\na
+0000e270: 7373 6572 7420 7265 6365 6976 6564 5f65  ssert received_e
+0000e280: 7665 6e74 735b 2d38 5d2e 6964 203d 3d20  vents[-8].id == 
+0000e290: 6576 656e 7431 2e69 645c 6e61 7373 6572  event1.id\nasser
+0000e2a0: 7420 7265 6365 6976 6564 5f65 7665 6e74  t received_event
+0000e2b0: 735b 2d37 5d2e 6964 203d 3d20 6576 656e  s[-7].id == even
+0000e2c0: 7432 2e69 645c 6e61 7373 6572 7420 7265  t2.id\nassert re
+0000e2d0: 6365 6976 6564 5f65 7665 6e74 735b 2d36  ceived_events[-6
+0000e2e0: 5d2e 6964 203d 3d20 6576 656e 7433 2e69  ].id == event3.i
+0000e2f0: 645c 6e61 7373 6572 7420 7265 6365 6976  d\nassert receiv
+0000e300: 6564 5f65 7665 6e74 735b 2d35 5d2e 7479  ed_events[-5].ty
+0000e310: 7065 203d 3d20 2244 6f67 5265 6769 7374  pe == "DogRegist
+0000e320: 6572 6564 225c 6e61 7373 6572 7420 7265  ered"\nassert re
+0000e330: 6365 6976 6564 5f65 7665 6e74 735b 2d34  ceived_events[-4
+0000e340: 5d2e 7479 7065 203d 3d20 2244 6f67 4c65  ].type == "DogLe
+0000e350: 6172 6e65 6454 7269 636b 225c 6e61 7373  arnedTrick"\nass
+0000e360: 6572 7420 7265 6365 6976 6564 5f65 7665  ert received_eve
+0000e370: 6e74 735b 2d33 5d2e 7479 7065 203d 3d20  nts[-3].type == 
+0000e380: 2244 6f67 4c65 6172 6e65 6454 7269 636b  "DogLearnedTrick
+0000e390: 225c 6e61 7373 6572 7420 7265 6365 6976  "\nassert receiv
+0000e3a0: 6564 5f65 7665 6e74 735b 2d32 5d2e 7479  ed_events[-2].ty
+0000e3b0: 7065 203d 3d20 2244 6f67 4c65 6172 6e65  pe == "DogLearne
+0000e3c0: 6454 7269 636b 225c 6e61 7373 6572 7420  dTrick"\nassert 
+0000e3d0: 7265 6365 6976 6564 5f65 7665 6e74 735b  received_events[
+0000e3e0: 2d31 5d2e 6964 203d 3d20 6576 656e 7434  -1].id == event4
+0000e3f0: 2e69 645c 6e5c 6e23 2041 7070 656e 6420  .id\n\n# Append 
+0000e400: 7375 6273 6571 7565 6e74 2065 7665 6e74  subsequent event
+0000e410: 7320 746f 2074 6865 2073 7472 6561 6d2e  s to the stream.
+0000e420: 5c6e 6576 656e 7435 203d 204e 6577 4576  \nevent5 = NewEv
+0000e430: 656e 7428 7479 7065 3d5c 274f 7264 6572  ent(type=\'Order
+0000e440: 5570 6461 7465 645c 272c 2064 6174 613d  Updated\', data=
+0000e450: 625c 2764 6174 6135 5c27 295c 6e63 6c69  b\'data5\')\ncli
+0000e460: 656e 742e 6170 7065 6e64 5f65 7665 6e74  ent.append_event
+0000e470: 7328 5c6e 2020 2020 7374 7265 616d 5f6e  s(\n    stream_n
+0000e480: 616d 653d 7374 7265 616d 5f6e 616d 6532  ame=stream_name2
+0000e490: 2c5c 6e20 2020 2065 7870 6563 7465 645f  ,\n    expected_
+0000e4a0: 706f 7369 7469 6f6e 3d30 2c5c 6e20 2020  position=0,\n   
+0000e4b0: 2065 7665 6e74 733d 5b65 7665 6e74 355d   events=[event5]
+0000e4c0: 2c5c 6e29 5c6e 5c6e 2320 5265 6365 6976  ,\n)\n\n# Receiv
+0000e4d0: 6520 7375 6273 6571 7565 6e74 2065 7665  e subsequent eve
+0000e4e0: 6e74 7320 6672 6f6d 2074 6865 2073 7562  nts from the sub
+0000e4f0: 7363 7269 7074 696f 6e2e 5c6e 666f 7220  scription.\nfor 
+0000e500: 6576 656e 7420 696e 2073 7562 7363 7269  event in subscri
+0000e510: 7074 696f 6e3a 5c6e 2020 2020 6c61 7374  ption:\n    last
+0000e520: 5f63 6f6d 6d69 745f 706f 7369 7469 6f6e  _commit_position
+0000e530: 203d 2065 7665 6e74 2e63 6f6d 6d69 745f   = event.commit_
+0000e540: 706f 7369 7469 6f6e 5c6e 2020 2020 7265  position\n    re
+0000e550: 6365 6976 6564 5f65 7665 6e74 732e 6170  ceived_events.ap
+0000e560: 7065 6e64 2865 7665 6e74 295c 6e20 2020  pend(event)\n   
+0000e570: 2069 6620 6576 656e 742e 6964 203d 3d20   if event.id == 
+0000e580: 6576 656e 7435 2e69 643a 5c6e 2020 2020  event5.id:\n    
+0000e590: 2020 2020 6272 6561 6b5c 6e5c 6e5c 6e5c      break\n\n\n\
+0000e5a0: 6e61 7373 6572 7420 7265 6365 6976 6564  nassert received
+0000e5b0: 5f65 7665 6e74 735b 2d32 5d2e 6964 203d  _events[-2].id =
+0000e5c0: 3d20 6576 656e 7434 2e69 645c 6e61 7373  = event4.id\nass
+0000e5d0: 6572 7420 7265 6365 6976 6564 5f65 7665  ert received_eve
+0000e5e0: 6e74 735b 2d31 5d2e 6964 203d 3d20 6576  nts[-1].id == ev
+0000e5f0: 656e 7435 2e69 645c 6e5c 6e5c 6e23 2041  ent5.id\n\n\n# A
+0000e600: 7070 656e 6420 6d6f 7265 2065 7665 6e74  ppend more event
+0000e610: 7320 746f 2074 6865 2073 7472 6561 6d2e  s to the stream.
+0000e620: 5c6e 6576 656e 7436 203d 204e 6577 4576  \nevent6 = NewEv
+0000e630: 656e 7428 7479 7065 3d5c 274f 7264 6572  ent(type=\'Order
+0000e640: 4465 6c65 7465 645c 272c 2064 6174 613d  Deleted\', data=
+0000e650: 625c 2764 6174 6136 5c27 295c 6e63 6c69  b\'data6\')\ncli
+0000e660: 656e 742e 6170 7065 6e64 5f65 7665 6e74  ent.append_event
+0000e670: 7328 5c6e 2020 2020 7374 7265 616d 5f6e  s(\n    stream_n
+0000e680: 616d 653d 7374 7265 616d 5f6e 616d 6532  ame=stream_name2
+0000e690: 2c5c 6e20 2020 2065 7870 6563 7465 645f  ,\n    expected_
+0000e6a0: 706f 7369 7469 6f6e 3d31 2c5c 6e20 2020  position=1,\n   
+0000e6b0: 2065 7665 6e74 733d 5b65 7665 6e74 365d   events=[event6]
+0000e6c0: 2c5c 6e29 5c6e 5c6e 5c6e 2320 5265 7375  ,\n)\n\n\n# Resu
+0000e6d0: 6d65 2073 7562 7363 7269 6269 6e67 2066  me subscribing f
+0000e6e0: 726f 6d20 7468 6520 6c61 7374 2063 6f6d  rom the last com
+0000e6f0: 6d69 7420 706f 7369 7469 6f6e 2e5c 6e73  mit position.\ns
+0000e700: 7562 7363 7269 7074 696f 6e20 3d20 636c  ubscription = cl
+0000e710: 6965 6e74 2e73 7562 7363 7269 6265 5f61  ient.subscribe_a
+0000e720: 6c6c 5f65 7665 6e74 7328 5c6e 2020 2020  ll_events(\n    
+0000e730: 636f 6d6d 6974 5f70 6f73 6974 696f 6e3d  commit_position=
+0000e740: 6c61 7374 5f63 6f6d 6d69 745f 706f 7369  last_commit_posi
+0000e750: 7469 6f6e 5c6e 295c 6e5c 6e5c 6e23 2043  tion\n)\n\n\n# C
+0000e760: 6174 6368 2075 7020 6279 2072 6563 6569  atch up by recei
+0000e770: 7669 6e67 2074 6865 206e 6577 2065 7665  ving the new eve
+0000e780: 6e74 2066 726f 6d20 7468 6520 7375 6273  nt from the subs
+0000e790: 6372 6970 7469 6f6e 2e5c 6e66 6f72 2065  cription.\nfor e
+0000e7a0: 7665 6e74 2069 6e20 7375 6273 6372 6970  vent in subscrip
+0000e7b0: 7469 6f6e 3a5c 6e20 2020 2072 6563 6569  tion:\n    recei
+0000e7c0: 7665 645f 6576 656e 7473 2e61 7070 656e  ved_events.appen
+0000e7d0: 6428 6576 656e 7429 5c6e 2020 2020 6966  d(event)\n    if
+0000e7e0: 2065 7665 6e74 2e69 6420 3d3d 2065 7665   event.id == eve
+0000e7f0: 6e74 362e 6964 3a5c 6e20 2020 2020 2020  nt6.id:\n       
+0000e800: 2062 7265 616b 5c6e 5c6e 6173 7365 7274   break\n\nassert
+0000e810: 2072 6563 6569 7665 645f 6576 656e 7473   received_events
+0000e820: 5b2d 335d 2e69 6420 3d3d 2065 7665 6e74  [-3].id == event
+0000e830: 342e 6964 5c6e 6173 7365 7274 2072 6563  4.id\nassert rec
+0000e840: 6569 7665 645f 6576 656e 7473 5b2d 325d  eived_events[-2]
+0000e850: 2e69 6420 3d3d 2065 7665 6e74 352e 6964  .id == event5.id
+0000e860: 5c6e 6173 7365 7274 2072 6563 6569 7665  \nassert receive
+0000e870: 645f 6576 656e 7473 5b2d 315d 2e69 6420  d_events[-1].id 
+0000e880: 3d3d 2065 7665 6e74 362e 6964 5c6e 5c6e  == event6.id\n\n
+0000e890: 5c6e 2320 4170 7065 6e64 2074 6872 6565  \n# Append three
+0000e8a0: 206d 6f72 6520 6576 656e 7473 2074 6f20   more events to 
+0000e8b0: 6120 6e65 7720 7374 7265 616d 2e5c 6e73  a new stream.\ns
+0000e8c0: 7472 6561 6d5f 6e61 6d65 3320 3d20 7374  tream_name3 = st
+0000e8d0: 7228 7575 6964 3428 2929 5c6e 6576 656e  r(uuid4())\neven
+0000e8e0: 7437 203d 204e 6577 4576 656e 7428 7479  t7 = NewEvent(ty
+0000e8f0: 7065 3d5c 274f 7264 6572 4372 6561 7465  pe=\'OrderCreate
+0000e900: 645c 272c 2064 6174 613d 625c 2764 6174  d\', data=b\'dat
+0000e910: 6137 5c27 295c 6e65 7665 6e74 3820 3d20  a7\')\nevent8 = 
+0000e920: 4e65 7745 7665 6e74 2874 7970 653d 5c27  NewEvent(type=\'
+0000e930: 4f72 6465 7255 7064 6174 6564 5c27 2c20  OrderUpdated\', 
+0000e940: 6461 7461 3d62 5c27 6461 7461 385c 2729  data=b\'data8\')
+0000e950: 5c6e 6576 656e 7439 203d 204e 6577 4576  \nevent9 = NewEv
+0000e960: 656e 7428 7479 7065 3d5c 274f 7264 6572  ent(type=\'Order
+0000e970: 4465 6c65 7465 645c 272c 2064 6174 613d  Deleted\', data=
+0000e980: 625c 2764 6174 6139 5c27 295c 6e5c 6e63  b\'data9\')\n\nc
+0000e990: 6c69 656e 742e 6170 7065 6e64 5f65 7665  lient.append_eve
+0000e9a0: 6e74 7328 5c6e 2020 2020 7374 7265 616d  nts(\n    stream
+0000e9b0: 5f6e 616d 653d 7374 7265 616d 5f6e 616d  _name=stream_nam
+0000e9c0: 6533 2c5c 6e20 2020 2065 7870 6563 7465  e3,\n    expecte
+0000e9d0: 645f 706f 7369 7469 6f6e 3d4e 6f6e 652c  d_position=None,
+0000e9e0: 5c6e 2020 2020 6576 656e 7473 3d5b 6576  \n    events=[ev
+0000e9f0: 656e 7437 2c20 6576 656e 7438 2c20 6576  ent7, event8, ev
+0000ea00: 656e 7439 5d2c 5c6e 295c 6e5c 6e23 2052  ent9],\n)\n\n# R
+0000ea10: 6563 6569 7665 2074 6865 2074 6872 6565  eceive the three
+0000ea20: 206e 6577 2065 7665 6e74 7320 6672 6f6d   new events from
+0000ea30: 2074 6865 2072 6573 756d 6564 2073 7562   the resumed sub
+0000ea40: 7363 7269 7074 696f 6e2e 5c6e 666f 7220  scription.\nfor 
+0000ea50: 6576 656e 7420 696e 2073 7562 7363 7269  event in subscri
+0000ea60: 7074 696f 6e3a 5c6e 2020 2020 7265 6365  ption:\n    rece
+0000ea70: 6976 6564 5f65 7665 6e74 732e 6170 7065  ived_events.appe
+0000ea80: 6e64 2865 7665 6e74 295c 6e20 2020 2069  nd(event)\n    i
+0000ea90: 6620 6576 656e 742e 6964 203d 3d20 6576  f event.id == ev
+0000eaa0: 656e 7439 2e69 643a 5c6e 2020 2020 2020  ent9.id:\n      
+0000eab0: 2020 6272 6561 6b5c 6e5c 6e61 7373 6572    break\n\nasser
+0000eac0: 7420 7265 6365 6976 6564 5f65 7665 6e74  t received_event
+0000ead0: 735b 2d36 5d2e 6964 203d 3d20 6576 656e  s[-6].id == even
+0000eae0: 7434 2e69 645c 6e61 7373 6572 7420 7265  t4.id\nassert re
+0000eaf0: 6365 6976 6564 5f65 7665 6e74 735b 2d35  ceived_events[-5
+0000eb00: 5d2e 6964 203d 3d20 6576 656e 7435 2e69  ].id == event5.i
+0000eb10: 645c 6e61 7373 6572 7420 7265 6365 6976  d\nassert receiv
+0000eb20: 6564 5f65 7665 6e74 735b 2d34 5d2e 6964  ed_events[-4].id
+0000eb30: 203d 3d20 6576 656e 7436 2e69 645c 6e61   == event6.id\na
+0000eb40: 7373 6572 7420 7265 6365 6976 6564 5f65  ssert received_e
+0000eb50: 7665 6e74 735b 2d33 5d2e 6964 203d 3d20  vents[-3].id == 
+0000eb60: 6576 656e 7437 2e69 645c 6e61 7373 6572  event7.id\nasser
+0000eb70: 7420 7265 6365 6976 6564 5f65 7665 6e74  t received_event
+0000eb80: 735b 2d32 5d2e 6964 203d 3d20 6576 656e  s[-2].id == even
+0000eb90: 7438 2e69 645c 6e61 7373 6572 7420 7265  t8.id\nassert re
+0000eba0: 6365 6976 6564 5f65 7665 6e74 735b 2d31  ceived_events[-1
+0000ebb0: 5d2e 6964 203d 3d20 6576 656e 7439 2e69  ].id == event9.i
+0000ebc0: 645c 6e60 6060 5c6e 5c6e 5468 6520 6361  d\n```\n\nThe ca
+0000ebd0: 7463 682d 7570 2073 7562 7363 7269 7074  tch-up subscript
+0000ebe0: 696f 6e20 6361 6c6c 2069 7320 656e 6465  ion call is ende
+0000ebf0: 6420 6173 2073 6f6f 6e20 6173 2074 6865  d as soon as the
+0000ec00: 2073 7562 7363 7269 7074 696f 6e20 6f62   subscription ob
+0000ec10: 6a65 6374 5c6e 676f 6573 206f 7574 206f  ject\ngoes out o
+0000ec20: 6620 7363 6f70 6520 6f72 2069 7320 6578  f scope or is ex
+0000ec30: 706c 6963 6974 6c79 2064 656c 6574 6564  plicitly deleted
+0000ec40: 2066 726f 6d20 6d65 6d6f 7279 2e5c 6e5c   from memory.\n\
+0000ec50: 6e60 6060 7079 7468 6f6e 5c6e 2320 456e  n```python\n# En
+0000ec60: 6420 7468 6520 7375 6273 6372 6970 7469  d the subscripti
+0000ec70: 6f6e 2e5c 6e64 656c 2073 7562 7363 7269  on.\ndel subscri
+0000ec80: 7074 696f 6e5c 6e60 6060 5c6e 5c6e 2323  ption\n```\n\n##
+0000ec90: 2320 5375 6273 6372 6962 6520 7374 7265  # Subscribe stre
+0000eca0: 616d 2065 7665 6e74 735c 6e5c 6e54 6865  am events\n\nThe
+0000ecb0: 6073 7562 7363 7269 6265 5f73 7472 6561  `subscribe_strea
+0000ecc0: 6d5f 6576 656e 7473 2829 6020 6d65 7468  m_events()` meth
+0000ecd0: 6f64 2063 616e 2062 6520 7573 6564 2074  od can be used t
+0000ece0: 6f20 7374 6172 7420 6120 2263 6174 6368  o start a "catch
+0000ecf0: 2d75 7022 2073 7562 7363 7269 7074 696f  -up" subscriptio
+0000ed00: 6e5c 6e74 6861 7420 6361 6e20 7265 7475  n\nthat can retu
+0000ed10: 726e 2065 7665 6e74 7320 7468 6174 2061  rn events that a
+0000ed20: 7265 2072 6563 6f72 6465 6420 696e 2061  re recorded in a
+0000ed30: 2073 696e 676c 6520 7374 7265 616d 2e5c   single stream.\
+0000ed40: 6e5c 6e54 6869 7320 6d65 7468 6f64 2074  n\nThis method t
+0000ed50: 616b 6573 2061 2072 6571 7569 7265 6420  akes a required 
+0000ed60: 6073 7472 6561 6d5f 6e61 6d65 6020 6172  `stream_name` ar
+0000ed70: 6775 6d65 6e74 2c20 7768 6963 6820 7370  gument, which sp
+0000ed80: 6563 6966 6965 7320 7468 6520 6e61 6d65  ecifies the name
+0000ed90: 206f 6620 7468 6520 7374 7265 616d 5c6e   of the stream\n
+0000eda0: 6672 6f6d 2077 6869 6368 2072 6563 6f72  from which recor
+0000edb0: 6465 6420 6576 656e 7473 2077 696c 6c20  ded events will 
+0000edc0: 6265 2072 6563 6569 7665 642e 5c6e 5c6e  be received.\n\n
+0000edd0: 5468 6973 206d 6574 686f 6420 616c 736f  This method also
+0000ede0: 2074 616b 6573 2074 776f 206f 7074 696f   takes two optio
+0000edf0: 6e61 6c20 6172 6775 6d65 6e74 732c 2060  nal arguments, `
+0000ee00: 7374 7265 616d 5f70 6f73 6974 696f 6e60  stream_position`
+0000ee10: 2c20 616e 6420 6074 696d 656f 7574 602e  , and `timeout`.
+0000ee20: 5c6e 5c6e 5468 6520 6f70 7469 6f6e 616c  \n\nThe optional
+0000ee30: 2060 7374 7265 616d 5f70 6f73 6974 696f   `stream_positio
+0000ee40: 6e60 2061 7267 756d 656e 7420 7370 6563  n` argument spec
+0000ee50: 6966 6965 7320 6120 706f 7369 7469 6f6e  ifies a position
+0000ee60: 2069 6e20 7468 6520 7374 7265 616d 2066   in the stream f
+0000ee70: 726f 6d20 7768 6963 685c 6e72 6563 6f72  rom which\nrecor
+0000ee80: 6465 6420 6576 656e 7473 2077 696c 6c20  ded events will 
+0000ee90: 6265 2072 6563 6569 7665 642e 2054 6865  be received. The
+0000eea0: 2065 7665 6e74 2061 7420 7468 6520 7370   event at the sp
+0000eeb0: 6563 6966 6965 6420 7374 7265 616d 2070  ecified stream p
+0000eec0: 6f73 6974 696f 6e20 7769 6c6c 206e 6f74  osition will not
+0000eed0: 5c6e 6265 2069 6e63 6c75 6465 642e 5c6e  \nbe included.\n
+0000eee0: 5c6e 5468 6520 6f70 7469 6f6e 616c 2060  \nThe optional `
+0000eef0: 7469 6d65 6f75 7460 2061 7267 756d 656e  timeout` argumen
+0000ef00: 7420 6973 2061 2050 7974 686f 6e20 6066  t is a Python `f
+0000ef10: 6c6f 6174 6020 7468 6174 2073 6574 735c  loat` that sets\
+0000ef20: 6e61 2064 6561 646c 696e 6520 666f 7220  na deadline for 
+0000ef30: 7468 6520 636f 6d70 6c65 7469 6f6e 206f  the completion o
+0000ef40: 6620 7468 6520 6752 5043 206f 7065 7261  f the gRPC opera
+0000ef50: 7469 6f6e 2e5c 6e5c 6e54 6865 2065 7861  tion.\n\nThe exa
+0000ef60: 6d70 6c65 2062 656c 6f77 2073 686f 7773  mple below shows
+0000ef70: 2068 6f77 2074 6f20 7374 6172 7420 6120   how to start a 
+0000ef80: 6361 7463 682d 7570 2073 7562 7363 7269  catch-up subscri
+0000ef90: 7074 696f 6e20 746f 2061 2073 7472 6561  ption to a strea
+0000efa0: 6d2e 5c6e 5c6e 6060 6070 7974 686f 6e5c  m.\n\n```python\
+0000efb0: 6e5c 6e23 2053 7562 7363 7269 6265 2074  n\n# Subscribe t
+0000efc0: 6f20 6576 656e 7473 2066 726f 6d20 7374  o events from st
+0000efd0: 7265 616d 322c 2066 726f 6d20 7468 6520  ream2, from the 
+0000efe0: 7374 6172 742e 5c6e 7375 6273 6372 6970  start.\nsubscrip
+0000eff0: 7469 6f6e 203d 2063 6c69 656e 742e 7375  tion = client.su
+0000f000: 6273 6372 6962 655f 7374 7265 616d 5f65  bscribe_stream_e
+0000f010: 7665 6e74 7328 7374 7265 616d 5f6e 616d  vents(stream_nam
+0000f020: 653d 7374 7265 616d 5f6e 616d 6532 295c  e=stream_name2)\
+0000f030: 6e5c 6e23 2052 6561 6420 6672 6f6d 2074  n\n# Read from t
+0000f040: 6865 2073 7562 7363 7269 7074 696f 6e2e  he subscription.
+0000f050: 5c6e 6576 656e 7473 203d 205b 5d5c 6e66  \nevents = []\nf
+0000f060: 6f72 2065 7665 6e74 2069 6e20 7375 6273  or event in subs
+0000f070: 6372 6970 7469 6f6e 3a5c 6e20 2020 2065  cription:\n    e
+0000f080: 7665 6e74 732e 6170 7065 6e64 2865 7665  vents.append(eve
+0000f090: 6e74 295c 6e20 2020 2069 6620 6576 656e  nt)\n    if even
+0000f0a0: 742e 6964 203d 3d20 6576 656e 7436 2e69  t.id == event6.i
+0000f0b0: 643a 5c6e 2020 2020 2020 2020 6272 6561  d:\n        brea
+0000f0c0: 6b5c 6e5c 6e23 2043 6865 636b 2077 6520  k\n\n# Check we 
+0000f0d0: 676f 7420 6576 656e 7473 206f 6e6c 7920  got events only 
+0000f0e0: 6672 6f6d 2073 7472 6561 6d32 2e5c 6e61  from stream2.\na
+0000f0f0: 7373 6572 7420 6c65 6e28 6576 656e 7473  ssert len(events
+0000f100: 2920 3d3d 2033 5c6e 6576 656e 7473 5b30  ) == 3\nevents[0
+0000f110: 5d2e 7374 7265 616d 5f6e 616d 6520 3d3d  ].stream_name ==
+0000f120: 2073 7472 6561 6d5f 6e61 6d65 325c 6e65   stream_name2\ne
+0000f130: 7665 6e74 735b 315d 2e73 7472 6561 6d5f  vents[1].stream_
+0000f140: 6e61 6d65 203d 3d20 7374 7265 616d 5f6e  name == stream_n
+0000f150: 616d 6532 5c6e 6576 656e 7473 5b32 5d2e  ame2\nevents[2].
+0000f160: 7374 7265 616d 5f6e 616d 6520 3d3d 2073  stream_name == s
+0000f170: 7472 6561 6d5f 6e61 6d65 325c 6e5c 6e23  tream_name2\n\n#
+0000f180: 2041 7070 656e 6420 616e 6f74 6865 7220   Append another 
+0000f190: 6576 656e 7420 746f 2073 7472 6561 6d33  event to stream3
+0000f1a0: 2e5c 6e65 7665 6e74 3130 203d 204e 6577  .\nevent10 = New
+0000f1b0: 4576 656e 7428 7479 7065 3d22 4f72 6465  Event(type="Orde
+0000f1c0: 7255 6e64 656c 6574 6564 222c 2064 6174  rUndeleted", dat
+0000f1d0: 613d 625c 2764 6174 6131 305c 2729 5c6e  a=b\'data10\')\n
+0000f1e0: 636c 6965 6e74 2e61 7070 656e 645f 6576  client.append_ev
+0000f1f0: 656e 7473 285c 6e20 2020 2073 7472 6561  ents(\n    strea
+0000f200: 6d5f 6e61 6d65 3d73 7472 6561 6d5f 6e61  m_name=stream_na
+0000f210: 6d65 332c 5c6e 2020 2020 6578 7065 6374  me3,\n    expect
+0000f220: 6564 5f70 6f73 6974 696f 6e3d 322c 5c6e  ed_position=2,\n
+0000f230: 2020 2020 6576 656e 7473 3d5b 6576 656e      events=[even
+0000f240: 7431 305d 2c5c 6e29 5c6e 5c6e 2320 4170  t10],\n)\n\n# Ap
+0000f250: 7065 6e64 2061 6e6f 7468 6572 2065 7665  pend another eve
+0000f260: 6e74 2074 6f20 7374 7265 616d 322e 5c6e  nt to stream2.\n
+0000f270: 6576 656e 7431 3120 3d20 4e65 7745 7665  event11 = NewEve
+0000f280: 6e74 2874 7970 653d 224f 7264 6572 556e  nt(type="OrderUn
+0000f290: 6465 6c65 7465 6422 2c20 6461 7461 3d62  deleted", data=b
+0000f2a0: 5c27 6461 7461 3131 5c27 295c 6e63 6c69  \'data11\')\ncli
+0000f2b0: 656e 742e 6170 7065 6e64 5f65 7665 6e74  ent.append_event
+0000f2c0: 7328 5c6e 2020 2020 7374 7265 616d 5f6e  s(\n    stream_n
+0000f2d0: 616d 653d 7374 7265 616d 5f6e 616d 6532  ame=stream_name2
+0000f2e0: 2c5c 6e20 2020 2065 7870 6563 7465 645f  ,\n    expected_
+0000f2f0: 706f 7369 7469 6f6e 3d32 2c5c 6e20 2020  position=2,\n   
+0000f300: 2065 7665 6e74 733d 5b65 7665 6e74 3131   events=[event11
+0000f310: 5d5c 6e29 5c6e 5c6e 2320 436f 6e74 696e  ]\n)\n\n# Contin
+0000f320: 7565 2072 6561 6469 6e67 2066 726f 6d20  ue reading from 
+0000f330: 7468 6520 7375 6273 6372 6970 7469 6f6e  the subscription
+0000f340: 2e5c 6e66 6f72 2065 7665 6e74 2069 6e20  .\nfor event in 
+0000f350: 7375 6273 6372 6970 7469 6f6e 3a5c 6e20  subscription:\n 
+0000f360: 2020 2065 7665 6e74 732e 6170 7065 6e64     events.append
+0000f370: 2865 7665 6e74 295c 6e20 2020 2069 6620  (event)\n    if 
+0000f380: 6576 656e 742e 6964 203d 3d20 6576 656e  event.id == even
+0000f390: 7431 312e 6964 3a5c 6e20 2020 2020 2020  t11.id:\n       
+0000f3a0: 2062 7265 616b 5c6e 5c6e 2320 4368 6563   break\n\n# Chec
+0000f3b0: 6b20 7765 2067 6f74 2065 7665 6e74 7320  k we got events 
+0000f3c0: 6f6e 6c79 2066 726f 6d20 7374 7265 616d  only from stream
+0000f3d0: 322e 5c6e 6173 7365 7274 206c 656e 2865  2.\nassert len(e
+0000f3e0: 7665 6e74 7329 203d 3d20 345c 6e65 7665  vents) == 4\neve
+0000f3f0: 6e74 735b 305d 2e73 7472 6561 6d5f 6e61  nts[0].stream_na
+0000f400: 6d65 203d 3d20 7374 7265 616d 5f6e 616d  me == stream_nam
+0000f410: 6532 5c6e 6576 656e 7473 5b31 5d2e 7374  e2\nevents[1].st
+0000f420: 7265 616d 5f6e 616d 6520 3d3d 2073 7472  ream_name == str
+0000f430: 6561 6d5f 6e61 6d65 325c 6e65 7665 6e74  eam_name2\nevent
+0000f440: 735b 325d 2e73 7472 6561 6d5f 6e61 6d65  s[2].stream_name
+0000f450: 203d 3d20 7374 7265 616d 5f6e 616d 6532   == stream_name2
+0000f460: 5c6e 6576 656e 7473 5b33 5d2e 7374 7265  \nevents[3].stre
+0000f470: 616d 5f6e 616d 6520 3d3d 2073 7472 6561  am_name == strea
+0000f480: 6d5f 6e61 6d65 325c 6e60 6060 5c6e 5c6e  m_name2\n```\n\n
+0000f490: 5468 6520 6578 616d 706c 6520 6265 6c6f  The example belo
+0000f4a0: 7720 7368 6f77 7320 686f 7720 746f 2073  w shows how to s
+0000f4b0: 7461 7274 2061 2063 6174 6368 2d75 7020  tart a catch-up 
+0000f4c0: 7375 6273 6372 6970 7469 6f6e 2074 6f20  subscription to 
+0000f4d0: 6120 7374 7265 616d 2066 726f 6d20 615c  a stream from a\
+0000f4e0: 6e73 7065 6369 6669 6320 7374 7265 616d  nspecific stream
+0000f4f0: 2070 6f73 6974 696f 6e2e 5c6e 5c6e 6060   position.\n\n``
+0000f500: 6070 7974 686f 6e5c 6e5c 6e23 2053 7562  `python\n\n# Sub
+0000f510: 7363 7269 6265 2074 6f20 6576 656e 7473  scribe to events
+0000f520: 2066 726f 6d20 7374 7265 616d 322c 2066   from stream2, f
+0000f530: 726f 6d20 7468 6520 7374 6172 742e 5c6e  rom the start.\n
+0000f540: 7375 6273 6372 6970 7469 6f6e 203d 2063  subscription = c
+0000f550: 6c69 656e 742e 7375 6273 6372 6962 655f  lient.subscribe_
+0000f560: 7374 7265 616d 5f65 7665 6e74 7328 5c6e  stream_events(\n
+0000f570: 2020 2020 7374 7265 616d 5f6e 616d 653d      stream_name=
+0000f580: 7374 7265 616d 5f6e 616d 6532 2c5c 6e20  stream_name2,\n 
+0000f590: 2020 2073 7472 6561 6d5f 706f 7369 7469     stream_positi
+0000f5a0: 6f6e 3d31 2c5c 6e29 5c6e 5c6e 2320 5265  on=1,\n)\n\n# Re
+0000f5b0: 6164 2065 7665 6e74 2066 726f 6d20 7468  ad event from th
+0000f5c0: 6520 7375 6273 6372 6970 7469 6f6e 2e5c  e subscription.\
+0000f5d0: 6e65 7665 6e74 7320 3d20 5b5d 5c6e 666f  nevents = []\nfo
+0000f5e0: 7220 6576 656e 7420 696e 2073 7562 7363  r event in subsc
+0000f5f0: 7269 7074 696f 6e3a 5c6e 2020 2020 6576  ription:\n    ev
+0000f600: 656e 7473 2e61 7070 656e 6428 6576 656e  ents.append(even
+0000f610: 7429 5c6e 2020 2020 6966 2065 7665 6e74  t)\n    if event
+0000f620: 2e69 6420 3d3d 2065 7665 6e74 3131 2e69  .id == event11.i
+0000f630: 643a 5c6e 2020 2020 2020 2020 6272 6561  d:\n        brea
+0000f640: 6b5c 6e5c 6e23 2043 6865 636b 2077 6520  k\n\n# Check we 
+0000f650: 676f 7420 6576 656e 7473 206f 6e6c 7920  got events only 
+0000f660: 6166 7465 7220 706f 7369 7469 6f6e 2031  after position 1
+0000f670: 2e5c 6e61 7373 6572 7420 6c65 6e28 6576  .\nassert len(ev
+0000f680: 656e 7473 2920 3d3d 2032 5c6e 6576 656e  ents) == 2\neven
+0000f690: 7473 5b30 5d2e 6964 203d 3d20 6576 656e  ts[0].id == even
+0000f6a0: 7436 2e69 645c 6e65 7665 6e74 735b 305d  t6.id\nevents[0]
+0000f6b0: 2e73 7472 6561 6d5f 706f 7369 7469 6f6e  .stream_position
+0000f6c0: 203d 3d20 325c 6e65 7665 6e74 735b 305d   == 2\nevents[0]
+0000f6d0: 2e73 7472 6561 6d5f 6e61 6d65 203d 3d20  .stream_name == 
+0000f6e0: 7374 7265 616d 5f6e 616d 6532 5c6e 6576  stream_name2\nev
+0000f6f0: 656e 7473 5b31 5d2e 6964 203d 3d20 6576  ents[1].id == ev
+0000f700: 656e 7431 312e 6964 5c6e 6576 656e 7473  ent11.id\nevents
+0000f710: 5b31 5d2e 7374 7265 616d 5f70 6f73 6974  [1].stream_posit
+0000f720: 696f 6e20 3d3d 2033 5c6e 6576 656e 7473  ion == 3\nevents
+0000f730: 5b31 5d2e 7374 7265 616d 5f6e 616d 6520  [1].stream_name 
+0000f740: 3d3d 2073 7472 6561 6d5f 6e61 6d65 325c  == stream_name2\
+0000f750: 6e60 6060 5c6e 5c6e 2323 2050 6572 7369  n```\n\n## Persi
+0000f760: 7374 656e 7420 7375 6273 6372 6970 7469  stent subscripti
+0000f770: 6f6e 735c 6e5c 6e23 2323 2043 7265 6174  ons\n\n### Creat
+0000f780: 6520 7375 6273 6372 6970 7469 6f6e 5c6e  e subscription\n
+0000f790: 5c6e 2a72 6571 7569 7265 7320 6c65 6164  \n*requires lead
+0000f7a0: 6572 2a5c 6e5c 6e54 6865 206d 6574 686f  er*\n\nThe metho
+0000f7b0: 6420 6063 7265 6174 655f 7375 6273 6372  d `create_subscr
+0000f7c0: 6970 7469 6f6e 2829 6020 6361 6e20 6265  iption()` can be
+0000f7d0: 2075 7365 6420 746f 2063 7265 6174 6520   used to create 
+0000f7e0: 615c 6e22 7065 7273 6973 7465 6e74 2073  a\n"persistent s
+0000f7f0: 7562 7363 7269 7074 696f 6e22 2074 6f20  ubscription" to 
+0000f800: 4576 656e 7453 746f 7265 4442 2e5c 6e5c  EventStoreDB.\n\
+0000f810: 6e54 6869 7320 6d65 7468 6f64 2074 616b  nThis method tak
+0000f820: 6573 2061 2072 6571 7569 7265 6420 6067  es a required `g
+0000f830: 726f 7570 5f6e 616d 6560 2061 7267 756d  roup_name` argum
+0000f840: 656e 742c 2077 6869 6368 2069 7320 7468  ent, which is th
+0000f850: 655c 6e6e 616d 6520 6f66 2061 2022 6772  e\nname of a "gr
+0000f860: 6f75 7022 206f 6620 636f 6e73 756d 6572  oup" of consumer
+0000f870: 7320 6f66 2074 6865 2073 7562 7363 7269  s of the subscri
+0000f880: 7074 696f 6e2e 5c6e 5c6e 5468 6973 206d  ption.\n\nThis m
+0000f890: 6574 686f 6420 616c 736f 2074 616b 6573  ethod also takes
+0000f8a0: 2073 6576 656e 206f 7074 696f 6e61 6c20   seven optional 
+0000f8b0: 6172 6775 6d65 6e74 732c 2060 6672 6f6d  arguments, `from
+0000f8c0: 5f65 6e64 602c 2060 636f 6d6d 6974 5f70  _end`, `commit_p
+0000f8d0: 6f73 6974 696f 6e60 2c5c 6e60 6669 6c74  osition`,\n`filt
+0000f8e0: 6572 5f65 7863 6c75 6465 602c 2060 6669  er_exclude`, `fi
+0000f8f0: 6c74 6572 5f69 6e63 6c75 6465 602c 2060  lter_include`, `
+0000f900: 6669 6c74 6572 5f62 795f 7374 7265 616d  filter_by_stream
+0000f910: 5f6e 616d 6560 2c20 6063 6f6e 7375 6d65  _name`, `consume
+0000f920: 725f 7374 7261 7465 6779 602c 5c6e 616e  r_strategy`,\nan
+0000f930: 6420 6074 696d 656f 7574 602e 5c6e 5c6e  d `timeout`.\n\n
+0000f940: 5468 6520 6f70 7469 6f6e 616c 2060 6672  The optional `fr
+0000f950: 6f6d 5f65 6e64 6020 6172 6775 6d65 6e74  om_end` argument
+0000f960: 2063 616e 2062 6520 7573 6564 2074 6f20   can be used to 
+0000f970: 7370 6563 6966 7920 7468 6174 2074 6865  specify that the
+0000f980: 2067 726f 7570 206f 6620 636f 6e73 756d   group of consum
+0000f990: 6572 735c 6e6f 6620 7468 6520 7375 6273  ers\nof the subs
+0000f9a0: 6372 6970 7469 6f6e 2073 686f 756c 6420  cription should 
+0000f9b0: 6f6e 6c79 2072 6563 6569 7665 2065 7665  only receive eve
+0000f9c0: 6e74 7320 7468 6174 2077 6572 6520 7265  nts that were re
+0000f9d0: 636f 7264 6564 2061 6674 6572 2074 6865  corded after the
+0000f9e0: 2073 7562 7363 7269 7074 696f 6e5c 6e77   subscription\nw
+0000f9f0: 6173 2063 7265 6174 6564 2e5c 6e5c 6e41  as created.\n\nA
+0000fa00: 6c74 6572 6e61 7469 7665 6c79 2c20 7468  lternatively, th
+0000fa10: 6520 6f70 7469 6f6e 616c 2060 636f 6d6d  e optional `comm
+0000fa20: 6974 5f70 6f73 6974 696f 6e60 2061 7267  it_position` arg
+0000fa30: 756d 656e 7420 6361 6e20 6265 2075 7365  ument can be use
+0000fa40: 6420 746f 2073 7065 6369 6679 2061 2063  d to specify a c
+0000fa50: 6f6d 6d69 745c 6e70 6f73 6974 696f 6e20  ommit\nposition 
+0000fa60: 6672 6f6d 2077 6869 6368 2063 6f6d 6d69  from which commi
+0000fa70: 7420 706f 7369 7469 6f6e 2074 6865 2067  t position the g
+0000fa80: 726f 7570 206f 6620 636f 6e73 756d 6572  roup of consumer
+0000fa90: 7320 6f66 2074 6865 2073 7562 7363 7269  s of the subscri
+0000faa0: 7074 696f 6e20 7368 6f75 6c64 5c6e 7265  ption should\nre
+0000fab0: 6365 6976 6520 6576 656e 7473 2e20 506c  ceive events. Pl
+0000fac0: 6561 7365 206e 6f74 652c 2074 6865 2072  ease note, the r
+0000fad0: 6563 6f72 6465 6420 6576 656e 7420 6174  ecorded event at
+0000fae0: 2074 6865 2073 7065 6369 6669 6564 2063   the specified c
+0000faf0: 6f6d 6d69 7420 706f 7369 7469 6f6e 206d  ommit position m
+0000fb00: 6967 6874 5c6e 6265 2069 6e63 6c75 6465  ight\nbe include
+0000fb10: 6420 696e 2074 6865 2072 6563 6f72 6465  d in the recorde
+0000fb20: 6420 6576 656e 7473 2072 6563 6569 7665  d events receive
+0000fb30: 6420 6279 2074 6865 2067 726f 7570 206f  d by the group o
+0000fb40: 6620 636f 6e73 756d 6572 732e 5c6e 5c6e  f consumers.\n\n
+0000fb50: 4966 206e 6569 7468 6572 2060 6672 6f6d  If neither `from
+0000fb60: 5f65 6e64 6020 6f72 2060 636f 6d6d 6974  _end` or `commit
+0000fb70: 5f70 6f73 6974 696f 6e60 2061 7265 2073  _position` are s
+0000fb80: 7065 6369 6669 6564 2c20 7468 6520 6772  pecified, the gr
+0000fb90: 6f75 7020 6f66 2063 6f6e 7375 6d65 7273  oup of consumers
+0000fba0: 5c6e 6f66 2074 6865 2073 7562 7363 7269  \nof the subscri
+0000fbb0: 7074 696f 6e20 7769 6c6c 2070 6f74 656e  ption will poten
+0000fbc0: 7469 616c 6c79 2072 6563 6569 7665 2061  tially receive a
+0000fbd0: 6c6c 2072 6563 6f72 6465 6420 6576 656e  ll recorded even
+0000fbe0: 7473 2069 6e20 7468 6520 6461 7461 6261  ts in the databa
+0000fbf0: 7365 2e5c 6e5c 6e54 6865 206f 7074 696f  se.\n\nThe optio
+0000fc00: 6e61 6c20 6066 696c 7465 725f 6578 636c  nal `filter_excl
+0000fc10: 7564 6560 2061 7267 756d 656e 7420 6973  ude` argument is
+0000fc20: 2061 2073 6571 7565 6e63 6520 6f66 2072   a sequence of r
+0000fc30: 6567 756c 6172 2065 7870 7265 7373 696f  egular expressio
+0000fc40: 6e73 2074 6861 745c 6e6d 6174 6368 2072  ns that\nmatch r
+0000fc50: 6563 6f72 6465 6420 6576 656e 7473 2074  ecorded events t
+0000fc60: 6861 7420 7368 6f75 6c64 206e 6f74 2062  hat should not b
+0000fc70: 6520 696e 636c 7564 6564 2e20 5468 6973  e included. This
+0000fc80: 2061 7267 756d 656e 7420 6973 2069 676e   argument is ign
+0000fc90: 6f72 6564 5c6e 6966 2060 6669 6c74 6572  ored\nif `filter
+0000fca0: 5f69 6e63 6c75 6465 6020 6973 2073 6574  _include` is set
+0000fcb0: 2074 6f20 6120 6e6f 6e2d 656d 7074 7920   to a non-empty 
+0000fcc0: 7365 7175 656e 6365 2e20 4279 2064 6566  sequence. By def
+0000fcd0: 6175 6c74 2c20 7468 6973 2061 7267 756d  ault, this argum
+0000fce0: 656e 7420 6973 2073 6574 5c6e 746f 206d  ent is set\nto m
+0000fcf0: 6174 6368 2074 6865 2065 7665 6e74 2074  atch the event t
+0000fd00: 7970 6573 206f 6620 2273 7973 7465 6d20  ypes of "system 
+0000fd10: 6576 656e 7473 222c 2073 6f20 7468 6174  events", so that
+0000fd20: 2045 7665 6e74 5374 6f72 6544 4220 7379   EventStoreDB sy
+0000fd30: 7374 656d 2065 7665 6e74 735c 6e77 696c  stem events\nwil
+0000fd40: 6c20 6e6f 7420 6e6f 726d 616c 6c79 2062  l not normally b
+0000fd50: 6520 7265 6365 6976 6564 2e20 5365 6520  e received. See 
+0000fd60: 7468 6520 4e6f 7465 7320 7365 6374 696f  the Notes sectio
+0000fd70: 6e20 6265 6c6f 7720 666f 7220 6d6f 7265  n below for more
+0000fd80: 2069 6e66 6f72 6d61 7469 6f6e 5c6e 6162   information\nab
+0000fd90: 6f75 7420 6669 6c74 6572 2065 7870 7265  out filter expre
+0000fda0: 7373 696f 6e73 2e5c 6e5c 6e54 6865 206f  ssions.\n\nThe o
+0000fdb0: 7074 696f 6e61 6c20 6066 696c 7465 725f  ptional `filter_
+0000fdc0: 696e 636c 7564 6560 2061 7267 756d 656e  include` argumen
+0000fdd0: 7420 6973 2061 2073 6571 7565 6e63 6520  t is a sequence 
+0000fde0: 6f66 2072 6567 756c 6172 2065 7870 7265  of regular expre
+0000fdf0: 7373 696f 6e73 5c6e 7468 6174 206d 6174  ssions\nthat mat
+0000fe00: 6368 2072 6563 6f72 6465 6420 6576 656e  ch recorded even
+0000fe10: 7473 2074 6861 7420 7368 6f75 6c64 2062  ts that should b
+0000fe20: 6520 7265 6365 6976 6564 2e20 4279 2064  e received. By d
+0000fe30: 6566 6175 6c74 2c20 7468 6973 2061 7267  efault, this arg
+0000fe40: 756d 656e 745c 6e69 7320 616e 2065 6d70  ument\nis an emp
+0000fe50: 7479 2074 7570 6c65 2e20 4966 2074 6869  ty tuple. If thi
+0000fe60: 7320 6172 6775 6d65 6e74 2069 7320 7365  s argument is se
+0000fe70: 7420 746f 2061 206e 6f6e 2d65 6d70 7479  t to a non-empty
+0000fe80: 2073 6571 7565 6e63 652c 2074 6865 5c6e   sequence, the\n
+0000fe90: 6066 696c 7465 725f 6578 636c 7564 6560  `filter_exclude`
+0000fea0: 2061 7267 756d 656e 7420 6973 2069 676e   argument is ign
+0000feb0: 6f72 6564 2e5c 6e5c 6e54 6865 206f 7074  ored.\n\nThe opt
+0000fec0: 696f 6e61 6c20 6066 696c 7465 725f 6279  ional `filter_by
+0000fed0: 5f73 7472 6561 6d5f 6e61 6d65 6020 6172  _stream_name` ar
+0000fee0: 6775 6d65 6e74 2069 7320 6120 5079 7468  gument is a Pyth
+0000fef0: 6f6e 2060 626f 6f6c 6020 7468 6174 2069  on `bool` that i
+0000ff00: 6e64 6963 6174 6573 2077 6865 7468 6572  ndicates whether
+0000ff10: 5c6e 7468 6520 6669 6c74 6572 2077 696c  \nthe filter wil
+0000ff20: 6c20 6170 706c 7920 746f 2065 7665 6e74  l apply to event
+0000ff30: 2074 7970 6573 206f 7220 7374 7265 616d   types or stream
+0000ff40: 206e 616d 6573 2e20 4279 2064 6566 6175   names. By defau
+0000ff50: 6c74 2c20 7468 6973 2076 616c 7565 2069  lt, this value i
+0000ff60: 7320 6046 616c 7365 605c 6e61 6e64 2073  s `False`\nand s
+0000ff70: 6f20 7468 6520 6669 6c74 6572 696e 6720  o the filtering 
+0000ff80: 7769 6c6c 2061 7070 6c79 2074 6f20 7468  will apply to th
+0000ff90: 6520 6576 656e 7420 7479 7065 2073 7472  e event type str
+0000ffa0: 696e 6773 206f 6620 7265 636f 7264 6564  ings of recorded
+0000ffb0: 2065 7665 6e74 732e 5c6e 5c6e 5468 6520   events.\n\nThe 
+0000ffc0: 6f70 7469 6f6e 616c 2060 636f 6e73 756d  optional `consum
+0000ffd0: 6572 5f73 7472 6174 6567 7960 2061 7267  er_strategy` arg
+0000ffe0: 756d 656e 7420 6973 2061 2050 7974 686f  ument is a Pytho
+0000fff0: 6e20 6073 7472 6020 7468 6174 2064 6566  n `str` that def
+00010000: 696e 6573 5c6e 7468 6520 636f 6e73 756d  ines\nthe consum
+00010010: 6572 2073 7472 6174 6567 7920 666f 7220  er strategy for 
+00010020: 7468 6973 2070 6572 7369 7374 656e 7420  this persistent 
+00010030: 7375 6273 6372 6970 7469 6f6e 2e20 5468  subscription. Th
+00010040: 6520 7661 6c75 6520 6f66 2074 6869 7320  e value of this 
+00010050: 6172 6775 6d65 6e74 5c6e 6361 6e20 6265  argument\ncan be
+00010060: 2060 5c27 4469 7370 6174 6368 546f 5369   `\'DispatchToSi
+00010070: 6e67 6c65 5c27 602c 2060 5c27 526f 756e  ngle\'`, `\'Roun
+00010080: 6452 6f62 696e 5c27 602c 2060 5c27 5069  dRobin\'`, `\'Pi
+00010090: 6e6e 6564 5c27 602c 206f 7220 605c 2750  nned\'`, or `\'P
+000100a0: 696e 6e65 6442 7943 6f72 7265 6c61 7469  innedByCorrelati
+000100b0: 6f6e 5c27 602e 2054 6865 5c6e 6465 6661  on\'`. The\ndefa
+000100c0: 756c 7420 7661 6c75 6520 6973 2060 5c27  ult value is `\'
+000100d0: 4469 7370 6174 6368 546f 5369 6e67 6c65  DispatchToSingle
+000100e0: 5c27 602e 5c6e 5c6e 5468 6520 6f70 7469  \'`.\n\nThe opti
+000100f0: 6f6e 616c 2060 7469 6d65 6f75 7460 2061  onal `timeout` a
+00010100: 7267 756d 656e 7420 6973 2061 2050 7974  rgument is a Pyt
+00010110: 686f 6e20 6066 6c6f 6174 6020 7768 6963  hon `float` whic
+00010120: 6820 7365 7473 2061 5c6e 6465 6164 6c69  h sets a\ndeadli
+00010130: 6e65 2066 6f72 2074 6865 2063 6f6d 706c  ne for the compl
+00010140: 6574 696f 6e20 6f66 2074 6865 2067 5250  etion of the gRP
+00010150: 4320 6f70 6572 6174 696f 6e2e 5c6e 5c6e  C operation.\n\n
+00010160: 5468 6520 6d65 7468 6f64 2060 6372 6561  The method `crea
+00010170: 7465 5f73 7562 7363 7269 7074 696f 6e28  te_subscription(
+00010180: 2960 2064 6f65 7320 6e6f 7420 7265 7475  )` does not retu
+00010190: 726e 2061 2076 616c 7565 2c20 6265 6361  rn a value, beca
+000101a0: 7573 655c 6e72 6563 6f72 6465 6420 6576  use\nrecorded ev
+000101b0: 656e 7473 2061 7265 206f 6274 6169 6e65  ents are obtaine
+000101c0: 6420 6279 2074 6865 2067 726f 7570 206f  d by the group o
+000101d0: 6620 636f 6e73 756d 6572 7320 6f66 2074  f consumers of t
+000101e0: 6865 2073 7562 7363 7269 7074 696f 6e5c  he subscription\
+000101f0: 6e75 7369 6e67 2074 6865 2060 7265 6164  nusing the `read
+00010200: 5f73 7562 7363 7269 7074 696f 6e28 2960  _subscription()`
+00010210: 206d 6574 686f 642e 5c6e 5c6e 496e 2074   method.\n\nIn t
+00010220: 6865 2065 7861 6d70 6c65 2062 656c 6f77  he example below
+00010230: 2c20 6120 7065 7273 6973 7465 6e74 2073  , a persistent s
+00010240: 7562 7363 7269 7074 696f 6e20 6973 2063  ubscription is c
+00010250: 7265 6174 6564 2e5c 6e5c 6e60 6060 7079  reated.\n\n```py
+00010260: 7468 6f6e 5c6e 2320 4372 6561 7465 2061  thon\n# Create a
+00010270: 2070 6572 7369 7374 656e 7420 7375 6273   persistent subs
+00010280: 6372 6970 7469 6f6e 2e5c 6e67 726f 7570  cription.\ngroup
+00010290: 5f6e 616d 6520 3d20 6622 6772 6f75 702d  _name = f"group-
+000102a0: 7b75 7569 6434 2829 7d22 5c6e 636c 6965  {uuid4()}"\nclie
+000102b0: 6e74 2e63 7265 6174 655f 7375 6273 6372  nt.create_subscr
+000102c0: 6970 7469 6f6e 2867 726f 7570 5f6e 616d  iption(group_nam
+000102d0: 653d 6772 6f75 705f 6e61 6d65 295c 6e60  e=group_name)\n`
+000102e0: 6060 5c6e 5c6e 2323 2320 5265 6164 2073  ``\n\n### Read s
+000102f0: 7562 7363 7269 7074 696f 6e5c 6e5c 6e2a  ubscription\n\n*
+00010300: 7265 7175 6972 6573 206c 6561 6465 722a  requires leader*
+00010310: 5c6e 5c6e 5468 6520 6d65 7468 6f64 2060  \n\nThe method `
+00010320: 7265 6164 5f73 7562 7363 7269 7074 696f  read_subscriptio
+00010330: 6e28 2960 2063 616e 2062 6520 7573 6564  n()` can be used
+00010340: 2062 7920 6120 6772 6f75 7020 6f66 2063   by a group of c
+00010350: 6f6e 7375 6d65 7273 2074 6f20 7265 6365  onsumers to rece
+00010360: 6976 655c 6e72 6563 6f72 6465 6420 6576  ive\nrecorded ev
+00010370: 656e 7473 2066 726f 6d20 6120 7065 7273  ents from a pers
+00010380: 6973 7465 6e74 2073 7562 7363 7269 7074  istent subscript
+00010390: 696f 6e20 6372 6561 7465 6420 7573 696e  ion created usin
+000103a0: 6720 6063 7265 6174 655f 7375 6273 6372  g `create_subscr
+000103b0: 6970 7469 6f6e 602e 5c6e 5c6e 5468 6973  iption`.\n\nThis
+000103c0: 206d 6574 686f 6420 7461 6b65 7320 6120   method takes a 
+000103d0: 7265 7175 6972 6564 2060 6772 6f75 705f  required `group_
+000103e0: 6e61 6d65 6020 6172 6775 6d65 6e74 2c20  name` argument, 
+000103f0: 7768 6963 6820 6973 5c6e 7468 6520 6e61  which is\nthe na
+00010400: 6d65 206f 6620 6120 2267 726f 7570 2220  me of a "group" 
+00010410: 6f66 2063 6f6e 7375 6d65 7273 206f 6620  of consumers of 
+00010420: 7468 6520 7375 6273 6372 6970 7469 6f6e  the subscription
+00010430: 2073 7065 6369 6669 6564 5c6e 7768 656e   specified\nwhen
+00010440: 2060 6372 6561 7465 5f73 7562 7363 7269   `create_subscri
+00010450: 7074 696f 6e28 2960 2077 6173 2063 616c  ption()` was cal
+00010460: 6c65 642e 5c6e 5c6e 5468 6973 206d 6574  led.\n\nThis met
+00010470: 686f 6420 616c 736f 2074 616b 6573 2061  hod also takes a
+00010480: 6e20 6f70 7469 6f6e 616c 2060 7469 6d65  n optional `time
+00010490: 6f75 7460 2061 7267 756d 656e 742c 2074  out` argument, t
+000104a0: 6861 745c 6e69 7320 6578 7065 6374 6564  hat\nis expected
+000104b0: 2074 6f20 6265 2061 2050 7974 686f 6e20   to be a Python 
+000104c0: 6066 6c6f 6174 602c 2077 6869 6368 2073  `float`, which s
+000104d0: 6574 7320 6120 6465 6164 6c69 6e65 5c6e  ets a deadline\n
+000104e0: 666f 7220 7468 6520 636f 6d70 6c65 7469  for the completi
+000104f0: 6f6e 206f 6620 7468 6520 6752 5043 206f  on of the gRPC o
+00010500: 7065 7261 7469 6f6e 2e5c 6e5c 6e54 6869  peration.\n\nThi
+00010510: 7320 6d65 7468 6f64 2072 6574 7572 6e73  s method returns
+00010520: 2061 2060 5065 7273 6973 7465 6e74 5375   a `PersistentSu
+00010530: 6273 6372 6970 7469 6f6e 6020 6f62 6a65  bscription` obje
+00010540: 6374 2c20 7768 6963 6820 6973 2061 6e20  ct, which is an 
+00010550: 6974 6572 6174 6f72 5c6e 6769 7669 6e67  iterator\ngiving
+00010560: 2060 5265 636f 7264 6564 4576 656e 7460   `RecordedEvent`
+00010570: 206f 626a 6563 7473 2c20 7468 6174 2061   objects, that a
+00010580: 6c73 6f20 6861 7320 6061 636b 2829 602c  lso has `ack()`,
+00010590: 2060 6e61 636b 2829 6020 616e 6420 6073   `nack()` and `s
+000105a0: 746f 7028 2960 5c6e 6d65 7468 6f64 732e  top()`\nmethods.
+000105b0: 5c6e 5c6e 6060 6070 7974 686f 6e5c 6e73  \n\n```python\ns
+000105c0: 7562 7363 7269 7074 696f 6e20 3d20 636c  ubscription = cl
+000105d0: 6965 6e74 2e72 6561 645f 7375 6273 6372  ient.read_subscr
+000105e0: 6970 7469 6f6e 2867 726f 7570 5f6e 616d  iption(group_nam
+000105f0: 653d 6772 6f75 705f 6e61 6d65 295c 6e60  e=group_name)\n`
+00010600: 6060 5c6e 5c6e 5468 6520 6061 636b 2829  ``\n\nThe `ack()
+00010610: 6020 6d65 7468 6f64 2073 686f 756c 6420  ` method should 
+00010620: 6265 2075 7365 6420 6279 2061 2063 6f6e  be used by a con
+00010630: 7375 6d65 7220 746f 2069 6e64 6963 6174  sumer to indicat
+00010640: 6520 746f 2074 6865 2073 6572 7665 7220  e to the server 
+00010650: 7468 6174 2069 745c 6e68 6173 2072 6563  that it\nhas rec
+00010660: 6569 7665 6420 616e 6420 7375 6363 6573  eived and succes
+00010670: 7366 756c 6c79 2070 726f 6365 7373 6564  sfully processed
+00010680: 2061 2072 6563 6f72 6465 6420 6576 656e   a recorded even
+00010690: 742e 2054 6869 7320 7769 6c6c 2070 7265  t. This will pre
+000106a0: 7665 6e74 2074 6861 745c 6e72 6563 6f72  vent that\nrecor
+000106b0: 6465 6420 6576 656e 7420 6265 696e 6720  ded event being 
+000106c0: 7265 6365 6976 6564 2062 7920 616e 6f74  received by anot
+000106d0: 6865 7220 636f 6e73 756d 6572 2069 6e20  her consumer in 
+000106e0: 7468 6520 7361 6d65 2067 726f 7570 2e20  the same group. 
+000106f0: 5468 6520 6061 636b 2829 605c 6e6d 6574  The `ack()`\nmet
+00010700: 686f 6420 7461 6b65 7320 616e 2060 6576  hod takes an `ev
+00010710: 656e 745f 6964 6020 6172 6775 6d65 6e74  ent_id` argument
+00010720: 2c20 7768 6963 6820 6973 2074 6865 2049  , which is the I
+00010730: 4420 6f66 2074 6865 2072 6563 6f72 6465  D of the recorde
+00010740: 6420 6576 656e 7420 7468 6174 5c6e 6861  d event that\nha
+00010750: 7320 6265 656e 2072 6563 6569 7665 642e  s been received.
+00010760: 5c6e 5c6e 5468 6520 6578 616d 706c 6520  \n\nThe example 
+00010770: 6265 6c6f 7720 6974 6572 6174 6573 206f  below iterates o
+00010780: 7665 7220 7468 6520 7375 6273 6372 6970  ver the subscrip
+00010790: 7469 6f6e 206f 626a 6563 742c 2061 6e64  tion object, and
+000107a0: 2063 616c 6c73 2060 6163 6b28 2960 2e20   calls `ack()`. 
+000107b0: 5468 655c 6e60 7374 6f70 2829 6020 6d65  The\n`stop()` me
+000107c0: 7468 6f64 2069 7320 6361 6c6c 6564 2077  thod is called w
+000107d0: 6865 6e20 7765 2068 6176 6520 7265 6365  hen we have rece
+000107e0: 6976 6564 2074 6865 206c 6173 7420 6576  ived the last ev
+000107f0: 656e 742c 2073 6f20 7468 6174 2077 6520  ent, so that we 
+00010800: 6361 6e5c 6e63 6f6e 7469 6e75 6520 7769  can\ncontinue wi
+00010810: 7468 2074 6865 2065 7861 6d70 6c65 7320  th the examples 
+00010820: 6265 6c6f 772e 5c6e 5c6e 6060 6070 7974  below.\n\n```pyt
+00010830: 686f 6e5c 6e65 7665 6e74 7320 3d20 5b5d  hon\nevents = []
+00010840: 5c6e 666f 7220 6576 656e 7420 696e 2073  \nfor event in s
+00010850: 7562 7363 7269 7074 696f 6e3a 5c6e 2020  ubscription:\n  
+00010860: 2020 6576 656e 7473 2e61 7070 656e 6428    events.append(
+00010870: 6576 656e 7429 5c6e 5c6e 2020 2020 2320  event)\n\n    # 
+00010880: 4163 6b6e 6f77 6c65 6467 6520 7468 6520  Acknowledge the 
+00010890: 7265 6365 6976 6564 2065 7665 6e74 2e5c  received event.\
+000108a0: 6e20 2020 2073 7562 7363 7269 7074 696f  n    subscriptio
+000108b0: 6e2e 6163 6b28 6576 656e 745f 6964 3d65  n.ack(event_id=e
+000108c0: 7665 6e74 2e69 6429 5c6e 5c6e 2020 2020  vent.id)\n\n    
+000108d0: 2320 4272 6561 6b20 7768 656e 2074 6865  # Break when the
+000108e0: 206c 6173 7420 6576 656e 7420 6861 7320   last event has 
+000108f0: 6265 656e 2072 6563 6569 7665 642e 5c6e  been received.\n
+00010900: 2020 2020 6966 2065 7665 6e74 2e69 6420      if event.id 
+00010910: 3d3d 2065 7665 6e74 3131 2e69 643a 5c6e  == event11.id:\n
+00010920: 2020 2020 2020 2020 7375 6273 6372 6970          subscrip
+00010930: 7469 6f6e 2e73 746f 7028 295c 6e60 6060  tion.stop()\n```
+00010940: 5c6e 5c6e 5468 6520 7265 6365 6976 6564  \n\nThe received
+00010950: 2065 7665 6e74 7320 6172 6520 7468 6520   events are the 
+00010960: 6576 656e 7473 2077 6520 6170 7065 6e64  events we append
+00010970: 6564 2061 626f 7665 2e5c 6e5c 6e60 6060  ed above.\n\n```
+00010980: 7079 7468 6f6e 5c6e 6173 7365 7274 2065  python\nassert e
+00010990: 7665 6e74 735b 2d31 355d 2e69 6420 3d3d  vents[-15].id ==
+000109a0: 2065 7665 6e74 312e 6964 5c6e 6173 7365   event1.id\nasse
+000109b0: 7274 2065 7665 6e74 735b 2d31 345d 2e69  rt events[-14].i
+000109c0: 6420 3d3d 2065 7665 6e74 322e 6964 5c6e  d == event2.id\n
+000109d0: 6173 7365 7274 2065 7665 6e74 735b 2d31  assert events[-1
+000109e0: 335d 2e69 6420 3d3d 2065 7665 6e74 332e  3].id == event3.
+000109f0: 6964 5c6e 6173 7365 7274 2065 7665 6e74  id\nassert event
+00010a00: 735b 2d31 325d 2e74 7970 6520 3d3d 2022  s[-12].type == "
+00010a10: 446f 6752 6567 6973 7465 7265 6422 5c6e  DogRegistered"\n
+00010a20: 6173 7365 7274 2065 7665 6e74 735b 2d31  assert events[-1
+00010a30: 315d 2e74 7970 6520 3d3d 2022 446f 674c  1].type == "DogL
+00010a40: 6561 726e 6564 5472 6963 6b22 5c6e 6173  earnedTrick"\nas
+00010a50: 7365 7274 2065 7665 6e74 735b 2d31 305d  sert events[-10]
+00010a60: 2e74 7970 6520 3d3d 2022 446f 674c 6561  .type == "DogLea
+00010a70: 726e 6564 5472 6963 6b22 5c6e 6173 7365  rnedTrick"\nasse
+00010a80: 7274 2065 7665 6e74 735b 2d39 5d2e 7479  rt events[-9].ty
+00010a90: 7065 203d 3d20 2244 6f67 4c65 6172 6e65  pe == "DogLearne
+00010aa0: 6454 7269 636b 225c 6e61 7373 6572 7420  dTrick"\nassert 
+00010ab0: 6576 656e 7473 5b2d 385d 2e69 6420 3d3d  events[-8].id ==
+00010ac0: 2065 7665 6e74 342e 6964 5c6e 6173 7365   event4.id\nasse
+00010ad0: 7274 2065 7665 6e74 735b 2d37 5d2e 6964  rt events[-7].id
+00010ae0: 203d 3d20 6576 656e 7435 2e69 645c 6e61   == event5.id\na
+00010af0: 7373 6572 7420 6576 656e 7473 5b2d 365d  ssert events[-6]
+00010b00: 2e69 6420 3d3d 2065 7665 6e74 362e 6964  .id == event6.id
+00010b10: 5c6e 6173 7365 7274 2065 7665 6e74 735b  \nassert events[
+00010b20: 2d35 5d2e 6964 203d 3d20 6576 656e 7437  -5].id == event7
+00010b30: 2e69 645c 6e61 7373 6572 7420 6576 656e  .id\nassert even
+00010b40: 7473 5b2d 345d 2e69 6420 3d3d 2065 7665  ts[-4].id == eve
+00010b50: 6e74 382e 6964 5c6e 6173 7365 7274 2065  nt8.id\nassert e
+00010b60: 7665 6e74 735b 2d33 5d2e 6964 203d 3d20  vents[-3].id == 
+00010b70: 6576 656e 7439 2e69 645c 6e61 7373 6572  event9.id\nasser
+00010b80: 7420 6576 656e 7473 5b2d 325d 2e69 6420  t events[-2].id 
+00010b90: 3d3d 2065 7665 6e74 3130 2e69 645c 6e61  == event10.id\na
+00010ba0: 7373 6572 7420 6576 656e 7473 5b2d 315d  ssert events[-1]
+00010bb0: 2e69 6420 3d3d 2065 7665 6e74 3131 2e69  .id == event11.i
+00010bc0: 645c 6e60 6060 5c6e 5c6e 5468 6520 2273  d\n```\n\nThe "s
+00010bd0: 7562 7363 7269 7074 696f 6e22 206f 626a  ubscription" obj
+00010be0: 6563 7420 616c 736f 2068 6173 2061 6e20  ect also has an 
+00010bf0: 606e 6163 6b28 2960 206d 6574 686f 6420  `nack()` method 
+00010c00: 7468 6174 2073 686f 756c 6420 6265 2075  that should be u
+00010c10: 7365 6420 6279 2061 2063 6f6e 7375 6d65  sed by a consume
+00010c20: 725c 6e74 6f20 6e65 6761 7469 7665 6c79  r\nto negatively
+00010c30: 2061 636b 6e6f 776c 6564 6765 2074 6f20   acknowledge to 
+00010c40: 7468 6520 7365 7276 6572 2074 6861 7420  the server that 
+00010c50: 6974 2068 6173 2072 6563 6569 7665 6420  it has received 
+00010c60: 6275 7420 6e6f 7420 7375 6363 6573 7366  but not successf
+00010c70: 756c 6c79 5c6e 7072 6f63 6573 7365 6420  ully\nprocessed 
+00010c80: 6120 7265 636f 7264 6564 2065 7665 6e74  a recorded event
+00010c90: 2e20 5468 6520 606e 6163 6b28 2960 206d  . The `nack()` m
+00010ca0: 6574 686f 6420 7461 6b65 7320 616e 2060  ethod takes an `
+00010cb0: 6576 656e 745f 6964 6020 6172 6775 6d65  event_id` argume
+00010cc0: 6e74 2c20 7768 6963 6820 6973 5c6e 7468  nt, which is\nth
+00010cd0: 6520 4944 206f 6620 7468 6520 7265 636f  e ID of the reco
+00010ce0: 7264 6564 2065 7665 6e74 2074 6861 7420  rded event that 
+00010cf0: 6861 7320 6265 656e 2072 6563 6569 7665  has been receive
+00010d00: 642c 2061 6e64 2061 6e20 6061 6374 696f  d, and an `actio
+00010d10: 6e60 2061 7267 756d 656e 742c 2077 6869  n` argument, whi
+00010d20: 6368 5c6e 7368 6f75 6c64 2062 6520 6120  ch\nshould be a 
+00010d30: 5079 7468 6f6e 2060 7374 7260 2c20 6569  Python `str`, ei
+00010d40: 7468 6572 2060 5c27 756e 6b6e 6f77 6e5c  ther `\'unknown\
+00010d50: 2760 2c20 605c 2770 6172 6b5c 2760 2c20  '`, `\'park\'`, 
+00010d60: 605c 2772 6574 7279 5c27 602c 2060 5c27  `\'retry\'`, `\'
+00010d70: 736b 6970 5c27 602c 206f 7220 605c 2773  skip\'`, or `\'s
+00010d80: 746f 705c 2760 2e5c 6e5c 6e57 6869 6c73  top\'`.\n\nWhils
+00010d90: 7420 7468 6572 6520 6172 6520 736f 6d65  t there are some
+00010da0: 2061 6476 616e 7461 6765 7320 6f66 2070   advantages of p
+00010db0: 6572 7369 7374 656e 7420 7375 6273 6372  ersistent subscr
+00010dc0: 6970 7469 6f6e 732c 2069 6e20 7061 7274  iptions, in part
+00010dd0: 6963 756c 6172 2074 6865 5c6e 7072 6f63  icular the\nproc
+00010de0: 6573 7369 6e67 206f 6620 7265 636f 7264  essing of record
+00010df0: 6564 2065 7665 6e74 7320 6279 2061 2067  ed events by a g
+00010e00: 726f 7570 206f 6620 636f 6e73 756d 6572  roup of consumer
+00010e10: 732c 2062 7920 7472 6163 6b69 6e67 2069  s, by tracking i
+00010e20: 6e20 7468 6520 7365 7276 6572 5c6e 7468  n the server\nth
+00010e30: 6520 706f 7369 7469 6f6e 2069 6e20 7468  e position in th
+00010e40: 6520 636f 6d6d 6974 2073 6571 7565 6e63  e commit sequenc
+00010e50: 6520 6f66 2065 7665 6e74 7320 7468 6174  e of events that
+00010e60: 2068 6176 6520 6265 656e 2070 726f 6365   have been proce
+00010e70: 7373 6564 2c20 7468 6572 6520 6973 5c6e  ssed, there is\n
+00010e80: 7468 6520 6461 6e67 6572 206f 6620 2264  the danger of "d
+00010e90: 7561 6c20 7772 6974 696e 6722 2069 6e20  ual writing" in 
+00010ea0: 7468 6520 636f 6e73 756d 7074 696f 6e20  the consumption 
+00010eb0: 6f66 2065 7665 6e74 732e 2052 656c 6961  of events. Relia
+00010ec0: 6269 6c69 7479 2069 6e20 7072 6f63 6573  bility in proces
+00010ed0: 7369 6e67 5c6e 6f66 2072 6563 6f72 6465  sing\nof recorde
+00010ee0: 6420 6576 656e 7473 2062 7920 6120 6772  d events by a gr
+00010ef0: 6f75 7020 6f66 2063 6f6e 7375 6d65 7273  oup of consumers
+00010f00: 2077 696c 6c20 7265 6c79 2069 6e73 7465   will rely inste
+00010f10: 6164 206f 6e20 6964 656d 706f 7465 6e74  ad on idempotent
+00010f20: 2068 616e 646c 696e 675c 6e6f 6620 6475   handling\nof du
+00010f30: 706c 6963 6174 6520 6d65 7373 6167 6573  plicate messages
+00010f40: 2c20 616e 6420 7265 7369 6c69 656e 6365  , and resilience
+00010f50: 2074 6f20 6f75 742d 6f66 2d6f 7264 6572   to out-of-order
+00010f60: 2064 656c 6976 6572 792e 5c6e 5c6e 2323   delivery.\n\n##
+00010f70: 2320 4765 7420 7375 6273 6372 6970 7469  # Get subscripti
+00010f80: 6f6e 2069 6e66 6f5c 6e5c 6e2a 7265 7175  on info\n\n*requ
+00010f90: 6972 6573 206c 6561 6465 722a 5c6e 5c6e  ires leader*\n\n
+00010fa0: 5468 6520 6067 6574 5f73 7562 7363 7269  The `get_subscri
+00010fb0: 7074 696f 6e5f 696e 666f 2829 6020 6d65  ption_info()` me
+00010fc0: 7468 6f64 2063 616e 2062 6520 7573 6564  thod can be used
+00010fd0: 2074 6f20 6765 7420 696e 666f 726d 6174   to get informat
+00010fe0: 696f 6e20 666f 7220 615c 6e70 6572 7369  ion for a\npersi
+00010ff0: 7374 656e 7420 7375 6273 6372 6970 7469  stent subscripti
+00011000: 6f6e 2e5c 6e5c 6e54 6869 7320 6d65 7468  on.\n\nThis meth
+00011010: 6f64 2068 6173 206f 6e65 2072 6571 7569  od has one requi
+00011020: 7265 6420 6172 6775 6d65 6e74 2c20 6067  red argument, `g
+00011030: 726f 7570 5f6e 616d 6560 2c20 7768 6963  roup_name`, whic
+00011040: 685c 6e73 686f 756c 6420 6d61 7463 6820  h\nshould match 
+00011050: 7468 6520 7661 6c75 6520 6f66 2074 6865  the value of the
+00011060: 2061 7267 756d 656e 7420 7573 6564 2077   argument used w
+00011070: 6865 6e20 6361 6c6c 696e 6720 6063 7265  hen calling `cre
+00011080: 6174 655f 7375 6273 6372 6970 7469 6f6e  ate_subscription
+00011090: 2829 602e 5c6e 5c6e 5468 6973 206d 6574  ()`.\n\nThis met
+000110a0: 686f 6420 616c 736f 2074 616b 6573 2061  hod also takes a
+000110b0: 6e20 6f70 7469 6f6e 616c 2060 7469 6d65  n optional `time
+000110c0: 6f75 7460 2061 7267 756d 656e 742c 2074  out` argument, t
+000110d0: 6861 745c 6e69 7320 6578 7065 6374 6564  hat\nis expected
+000110e0: 2074 6f20 6265 2061 2050 7974 686f 6e20   to be a Python 
+000110f0: 6066 6c6f 6174 602c 2077 6869 6368 2073  `float`, which s
+00011100: 6574 7320 6120 6465 6164 6c69 6e65 5c6e  ets a deadline\n
+00011110: 666f 7220 7468 6520 636f 6d70 6c65 7469  for the completi
+00011120: 6f6e 206f 6620 7468 6520 6752 5043 206f  on of the gRPC o
+00011130: 7065 7261 7469 6f6e 2e5c 6e5c 6e60 6060  peration.\n\n```
+00011140: 7079 7468 6f6e 5c6e 7375 6273 6372 6970  python\nsubscrip
+00011150: 7469 6f6e 5f69 6e66 6f20 3d20 636c 6965  tion_info = clie
+00011160: 6e74 2e67 6574 5f73 7562 7363 7269 7074  nt.get_subscript
+00011170: 696f 6e5f 696e 666f 285c 6e20 2020 2067  ion_info(\n    g
+00011180: 726f 7570 5f6e 616d 653d 6772 6f75 705f  roup_name=group_
+00011190: 6e61 6d65 2c5c 6e29 5c6e 6060 605c 6e5c  name,\n)\n```\n\
+000111a0: 6e54 6865 2072 6574 7572 6e65 6420 7661  nThe returned va
+000111b0: 6c75 6520 6973 2061 2060 5375 6273 6372  lue is a `Subscr
+000111c0: 6970 7469 6f6e 496e 666f 6020 6f62 6a65  iptionInfo` obje
+000111d0: 6374 2e5c 6e5c 6e23 2323 204c 6973 7420  ct.\n\n### List 
+000111e0: 7375 6273 6372 6970 7469 6f6e 735c 6e5c  subscriptions\n\
+000111f0: 6e2a 7265 7175 6972 6573 206c 6561 6465  n*requires leade
+00011200: 722a 5c6e 5c6e 5468 6520 606c 6973 745f  r*\n\nThe `list_
+00011210: 7375 6273 6372 6970 7469 6f6e 7328 2960  subscriptions()`
+00011220: 206d 6574 686f 6420 6361 6e20 6265 2075   method can be u
+00011230: 7365 6420 746f 2067 6574 2069 6e66 6f72  sed to get infor
+00011240: 6d61 7469 6f6e 2066 6f72 2061 6c6c 5c6e  mation for all\n
+00011250: 6578 6973 7469 6e67 2070 6572 7369 7374  existing persist
+00011260: 656e 7420 7375 6273 6372 6970 7469 6f6e  ent subscription
+00011270: 732e 5c6e 5c6e 5468 6973 206d 6574 686f  s.\n\nThis metho
+00011280: 6420 7461 6b65 7320 616e 206f 7074 696f  d takes an optio
+00011290: 6e61 6c20 6074 696d 656f 7574 6020 6172  nal `timeout` ar
+000112a0: 6775 6d65 6e74 2c20 7468 6174 5c6e 6973  gument, that\nis
+000112b0: 2065 7870 6563 7465 6420 746f 2062 6520   expected to be 
+000112c0: 6120 5079 7468 6f6e 2060 666c 6f61 7460  a Python `float`
+000112d0: 2c20 7768 6963 6820 7365 7473 2061 2064  , which sets a d
+000112e0: 6561 646c 696e 655c 6e66 6f72 2074 6865  eadline\nfor the
+000112f0: 2063 6f6d 706c 6574 696f 6e20 6f66 2074   completion of t
+00011300: 6865 2067 5250 4320 6f70 6572 6174 696f  he gRPC operatio
+00011310: 6e2e 5c6e 5c6e 6060 6070 7974 686f 6e5c  n.\n\n```python\
+00011320: 6e73 7562 7363 7269 7074 696f 6e73 203d  nsubscriptions =
+00011330: 2063 6c69 656e 742e 6c69 7374 5f73 7562   client.list_sub
+00011340: 7363 7269 7074 696f 6e73 2829 5c6e 6060  scriptions()\n``
+00011350: 605c 6e5c 6e54 6865 2072 6574 7572 6e65  `\n\nThe returne
+00011360: 6420 7661 6c75 6520 6973 2061 206c 6973  d value is a lis
+00011370: 7420 6f66 2060 5375 6273 6372 6970 7469  t of `Subscripti
+00011380: 6f6e 496e 666f 6020 6f62 6a65 6374 732e  onInfo` objects.
+00011390: 5c6e 5c6e 2323 2320 5570 6461 7465 2073  \n\n### Update s
+000113a0: 7562 7363 7269 7074 696f 6e5c 6e5c 6e2a  ubscription\n\n*
+000113b0: 7265 7175 6972 6573 206c 6561 6465 722a  requires leader*
+000113c0: 5c6e 5c6e 5468 6520 6d65 7468 6f64 2060  \n\nThe method `
+000113d0: 7570 6461 7465 5f73 7562 7363 7269 7074  update_subscript
+000113e0: 696f 6e28 2960 2063 616e 2062 6520 7573  ion()` can be us
+000113f0: 6564 2074 6f20 7570 6461 7465 2061 5c6e  ed to update a\n
+00011400: 2270 6572 7369 7374 656e 7420 7375 6273  "persistent subs
+00011410: 6372 6970 7469 6f6e 222e 5c6e 5c6e 5468  cription".\n\nTh
+00011420: 6973 206d 6574 686f 6420 7461 6b65 7320  is method takes 
+00011430: 6120 7265 7175 6972 6564 2060 6772 6f75  a required `grou
+00011440: 705f 6e61 6d65 6020 6172 6775 6d65 6e74  p_name` argument
+00011450: 2c20 7768 6963 6820 6973 2074 6865 5c6e  , which is the\n
+00011460: 6e61 6d65 206f 6620 6120 2267 726f 7570  name of a "group
+00011470: 2220 6f66 2063 6f6e 7375 6d65 7273 206f  " of consumers o
+00011480: 6620 7468 6520 7375 6273 6372 6970 7469  f the subscripti
+00011490: 6f6e 2e5c 6e5c 6e54 6869 7320 6d65 7468  on.\n\nThis meth
+000114a0: 6f64 2061 6c73 6f20 7461 6b65 7320 7468  od also takes th
+000114b0: 7265 6520 6f70 7469 6f6e 616c 2061 7267  ree optional arg
+000114c0: 756d 656e 7473 2c20 6066 726f 6d5f 656e  uments, `from_en
+000114d0: 6460 2c20 6063 6f6d 6d69 745f 706f 7369  d`, `commit_posi
+000114e0: 7469 6f6e 602c 5c6e 616e 6420 6074 696d  tion`,\nand `tim
+000114f0: 656f 7574 602e 5c6e 5c6e 5468 6520 6f70  eout`.\n\nThe op
+00011500: 7469 6f6e 616c 2060 6672 6f6d 5f65 6e64  tional `from_end
+00011510: 6020 6172 6775 6d65 6e74 2063 616e 2062  ` argument can b
+00011520: 6520 7573 6564 2074 6f20 7370 6563 6966  e used to specif
+00011530: 7920 7468 6174 2074 6865 2067 726f 7570  y that the group
+00011540: 206f 6620 636f 6e73 756d 6572 735c 6e6f   of consumers\no
+00011550: 6620 7468 6520 7375 6273 6372 6970 7469  f the subscripti
+00011560: 6f6e 2073 686f 756c 6420 6f6e 6c79 2072  on should only r
+00011570: 6563 6569 7665 2065 7665 6e74 7320 7468  eceive events th
+00011580: 6174 2077 6572 6520 7265 636f 7264 6564  at were recorded
+00011590: 2061 6674 6572 2074 6865 2073 7562 7363   after the subsc
+000115a0: 7269 7074 696f 6e5c 6e77 6173 2075 7064  ription\nwas upd
+000115b0: 6174 6564 2e5c 6e5c 6e41 6c74 6572 6e61  ated.\n\nAlterna
+000115c0: 7469 7665 6c79 2c20 7468 6520 6f70 7469  tively, the opti
+000115d0: 6f6e 616c 2060 636f 6d6d 6974 5f70 6f73  onal `commit_pos
+000115e0: 6974 696f 6e60 2061 7267 756d 656e 7420  ition` argument 
+000115f0: 6361 6e20 6265 2075 7365 6420 746f 2073  can be used to s
+00011600: 7065 6369 6679 2061 2063 6f6d 6d69 745c  pecify a commit\
+00011610: 6e70 6f73 6974 696f 6e20 6672 6f6d 2077  nposition from w
+00011620: 6869 6368 2063 6f6d 6d69 7420 706f 7369  hich commit posi
+00011630: 7469 6f6e 2074 6865 2067 726f 7570 206f  tion the group o
+00011640: 6620 636f 6e73 756d 6572 7320 6f66 2074  f consumers of t
+00011650: 6865 2073 7562 7363 7269 7074 696f 6e20  he subscription 
+00011660: 7368 6f75 6c64 5c6e 7265 6365 6976 6520  should\nreceive 
+00011670: 6576 656e 7473 2e20 506c 6561 7365 206e  events. Please n
+00011680: 6f74 652c 2074 6865 2072 6563 6f72 6465  ote, the recorde
+00011690: 6420 6576 656e 7420 6174 2074 6865 2073  d event at the s
+000116a0: 7065 6369 6669 6564 2063 6f6d 6d69 7420  pecified commit 
+000116b0: 706f 7369 7469 6f6e 206d 6967 6874 5c6e  position might\n
+000116c0: 6265 2069 6e63 6c75 6465 6420 696e 2074  be included in t
+000116d0: 6865 2072 6563 6f72 6465 6420 6576 656e  he recorded even
+000116e0: 7473 2072 6563 6569 7665 6420 6279 2074  ts received by t
+000116f0: 6865 2067 726f 7570 206f 6620 636f 6e73  he group of cons
+00011700: 756d 6572 732e 5c6e 5c6e 4966 206e 6569  umers.\n\nIf nei
+00011710: 7468 6572 2060 6672 6f6d 5f65 6e64 6020  ther `from_end` 
+00011720: 6f72 2060 636f 6d6d 6974 5f70 6f73 6974  or `commit_posit
+00011730: 696f 6e60 2061 7265 2073 7065 6369 6669  ion` are specifi
+00011740: 6564 2c20 7468 6520 6772 6f75 7020 6f66  ed, the group of
+00011750: 2063 6f6e 7375 6d65 7273 5c6e 6f66 2074   consumers\nof t
+00011760: 6865 2073 7562 7363 7269 7074 696f 6e20  he subscription 
+00011770: 7769 6c6c 2070 6f74 656e 7469 616c 6c79  will potentially
+00011780: 2072 6563 6569 7665 2061 6c6c 2072 6563   receive all rec
+00011790: 6f72 6465 6420 6576 656e 7473 2069 6e20  orded events in 
+000117a0: 7468 6520 6461 7461 6261 7365 2e5c 6e5c  the database.\n\
+000117b0: 6e50 6c65 6173 6520 6e6f 7465 2c20 7468  nPlease note, th
+000117c0: 6520 6669 6c74 6572 206f 7074 696f 6e73  e filter options
+000117d0: 2061 6e64 2063 6f6e 7375 6d65 7220 7374   and consumer st
+000117e0: 7261 7465 6779 2063 616e 6e6f 7420 6265  rategy cannot be
+000117f0: 2061 646a 7573 7465 642e 5c6e 5c6e 5468   adjusted.\n\nTh
+00011800: 6520 6f70 7469 6f6e 616c 2060 7469 6d65  e optional `time
+00011810: 6f75 7460 2061 7267 756d 656e 7420 6973  out` argument is
+00011820: 2061 2050 7974 686f 6e20 6066 6c6f 6174   a Python `float
+00011830: 6020 7768 6963 6820 7365 7473 2061 5c6e  ` which sets a\n
+00011840: 6465 6164 6c69 6e65 2066 6f72 2074 6865  deadline for the
+00011850: 2063 6f6d 706c 6574 696f 6e20 6f66 2074   completion of t
+00011860: 6865 2067 5250 4320 6f70 6572 6174 696f  he gRPC operatio
+00011870: 6e2e 5c6e 5c6e 5468 6520 6d65 7468 6f64  n.\n\nThe method
+00011880: 2060 7570 6461 7465 5f73 7562 7363 7269   `update_subscri
+00011890: 7074 696f 6e28 2960 2064 6f65 7320 6e6f  ption()` does no
+000118a0: 7420 7265 7475 726e 2061 2076 616c 7565  t return a value
+000118b0: 2e5c 6e5c 6e49 6e20 7468 6520 6578 616d  .\n\nIn the exam
+000118c0: 706c 6520 6265 6c6f 772c 2061 2070 6572  ple below, a per
+000118d0: 7369 7374 656e 7420 7375 6273 6372 6970  sistent subscrip
+000118e0: 7469 6f6e 2069 7320 7570 6461 7465 6420  tion is updated 
+000118f0: 746f 2072 756e 2066 726f 6d20 7468 6520  to run from the 
+00011900: 656e 6420 6f66 2074 6865 5c6e 6461 7461  end of the\ndata
+00011910: 6261 7365 2e5c 6e5c 6e60 6060 7079 7468  base.\n\n```pyth
+00011920: 6f6e 5c6e 2320 4372 6561 7465 2061 2070  on\n# Create a p
+00011930: 6572 7369 7374 656e 7420 7375 6273 6372  ersistent subscr
+00011940: 6970 7469 6f6e 2e5c 6e63 6c69 656e 742e  iption.\nclient.
+00011950: 7570 6461 7465 5f73 7562 7363 7269 7074  update_subscript
+00011960: 696f 6e28 6772 6f75 705f 6e61 6d65 3d67  ion(group_name=g
+00011970: 726f 7570 5f6e 616d 652c 2066 726f 6d5f  roup_name, from_
+00011980: 656e 643d 5472 7565 295c 6e60 6060 5c6e  end=True)\n```\n
+00011990: 5c6e 2323 2320 4465 6c65 7465 2073 7562  \n### Delete sub
+000119a0: 7363 7269 7074 696f 6e5c 6e5c 6e2a 7265  scription\n\n*re
+000119b0: 7175 6972 6573 206c 6561 6465 722a 5c6e  quires leader*\n
+000119c0: 5c6e 5468 6520 6064 656c 6574 655f 7375  \nThe `delete_su
+000119d0: 6273 6372 6970 7469 6f6e 2829 6020 6d65  bscription()` me
+000119e0: 7468 6f64 2063 616e 2062 6520 7573 6564  thod can be used
+000119f0: 2074 6f20 6465 6c65 7465 2061 2070 6572   to delete a per
+00011a00: 7369 7374 656e 745c 6e73 7562 7363 7269  sistent\nsubscri
+00011a10: 7074 696f 6e2e 5c6e 5c6e 5468 6973 206d  ption.\n\nThis m
+00011a20: 6574 686f 6420 6861 7320 6f6e 6520 7265  ethod has one re
+00011a30: 7175 6972 6564 2061 7267 756d 656e 742c  quired argument,
+00011a40: 2060 6772 6f75 705f 6e61 6d65 602c 2077   `group_name`, w
+00011a50: 6869 6368 5c6e 7368 6f75 6c64 206d 6174  hich\nshould mat
+00011a60: 6368 2074 6865 2076 616c 7565 206f 6620  ch the value of 
+00011a70: 6172 6775 6d65 6e74 2075 7365 6420 7768  argument used wh
+00011a80: 656e 2063 616c 6c69 6e67 2060 6372 6561  en calling `crea
+00011a90: 7465 5f73 7562 7363 7269 7074 696f 6e28  te_subscription(
+00011aa0: 2960 2e5c 6e5c 6e54 6869 7320 6d65 7468  )`.\n\nThis meth
+00011ab0: 6f64 2061 6c73 6f20 7461 6b65 7320 616e  od also takes an
+00011ac0: 206f 7074 696f 6e61 6c20 6074 696d 656f   optional `timeo
+00011ad0: 7574 6020 6172 6775 6d65 6e74 2c20 7468  ut` argument, th
+00011ae0: 6174 5c6e 6973 2065 7870 6563 7465 6420  at\nis expected 
+00011af0: 746f 2062 6520 6120 5079 7468 6f6e 2060  to be a Python `
+00011b00: 666c 6f61 7460 2c20 7768 6963 6820 7365  float`, which se
+00011b10: 7473 2061 2064 6561 646c 696e 655c 6e66  ts a deadline\nf
+00011b20: 6f72 2074 6865 2063 6f6d 706c 6574 696f  or the completio
+00011b30: 6e20 6f66 2074 6865 2067 5250 4320 6f70  n of the gRPC op
+00011b40: 6572 6174 696f 6e2e 5c6e 5c6e 6060 6070  eration.\n\n```p
+00011b50: 7974 686f 6e5c 6e63 6c69 656e 742e 6465  ython\nclient.de
+00011b60: 6c65 7465 5f73 7562 7363 7269 7074 696f  lete_subscriptio
+00011b70: 6e28 5c6e 2020 2020 6772 6f75 705f 6e61  n(\n    group_na
+00011b80: 6d65 3d67 726f 7570 5f6e 616d 652c 5c6e  me=group_name,\n
+00011b90: 295c 6e60 6060 5c6e 5c6e 2323 2320 4372  )\n```\n\n### Cr
+00011ba0: 6561 7465 2073 7472 6561 6d20 7375 6273  eate stream subs
+00011bb0: 6372 6970 7469 6f6e 5c6e 5c6e 2a72 6571  cription\n\n*req
+00011bc0: 7569 7265 7320 6c65 6164 6572 2a5c 6e5c  uires leader*\n\
+00011bd0: 6e54 6865 2060 6372 6561 7465 5f73 7472  nThe `create_str
+00011be0: 6561 6d5f 7375 6273 6372 6970 7469 6f6e  eam_subscription
+00011bf0: 2829 6020 6d65 7468 6f64 2063 616e 2062  ()` method can b
+00011c00: 6520 7573 6564 2074 6f20 6372 6561 7465  e used to create
+00011c10: 2061 2070 6572 7369 7374 656e 745c 6e73   a persistent\ns
+00011c20: 7562 7363 7269 7074 696f 6e20 666f 7220  ubscription for 
+00011c30: 6120 7374 7265 616d 2e5c 6e5c 6e54 6869  a stream.\n\nThi
+00011c40: 7320 6d65 7468 6f64 2068 6173 2074 776f  s method has two
+00011c50: 2072 6571 7569 7265 6420 6172 6775 6d65   required argume
+00011c60: 6e74 732c 2060 6772 6f75 705f 6e61 6d65  nts, `group_name
+00011c70: 6020 616e 6420 6073 7472 6561 6d5f 6e61  ` and `stream_na
+00011c80: 6d65 602e 2054 6865 5c6e 6067 726f 7570  me`. The\n`group
+00011c90: 5f6e 616d 6560 2061 7267 756d 656e 7420  _name` argument 
+00011ca0: 6e61 6d65 7320 7468 6520 6772 6f75 7020  names the group 
+00011cb0: 6f66 2063 6f6e 7375 6d65 7273 2074 6861  of consumers tha
+00011cc0: 7420 7769 6c6c 2072 6563 6569 7665 2065  t will receive e
+00011cd0: 7665 6e74 735c 6e66 726f 6d20 7468 6973  vents\nfrom this
+00011ce0: 2073 7562 7363 7269 7074 696f 6e2e 2054   subscription. T
+00011cf0: 6865 2060 7374 7265 616d 5f6e 616d 6560  he `stream_name`
+00011d00: 2061 7267 756d 656e 7420 7370 6563 6966   argument specif
+00011d10: 6965 7320 7768 6963 6820 7374 7265 616d  ies which stream
+00011d20: 5c6e 7468 6520 7375 6273 6372 6970 7469  \nthe subscripti
+00011d30: 6f6e 2077 696c 6c20 666f 6c6c 6f77 2e20  on will follow. 
+00011d40: 5468 6520 7661 6c75 6573 206f 6620 626f  The values of bo
+00011d50: 7468 2074 6865 7365 2061 7267 756d 656e  th these argumen
+00011d60: 7473 2061 7265 2065 7870 6563 7465 645c  ts are expected\
+00011d70: 6e74 6f20 6265 2050 7974 686f 6e20 6073  nto be Python `s
+00011d80: 7472 6020 6f62 6a65 6374 732e 5c6e 5c6e  tr` objects.\n\n
+00011d90: 5468 6520 6d65 7468 6f64 2061 6c73 6f20  The method also 
+00011da0: 7461 6b65 7320 666f 7572 206f 7074 696f  takes four optio
+00011db0: 6e61 6c20 6172 6775 6d65 6e74 732c 2060  nal arguments, `
+00011dc0: 7374 7265 616d 5f70 6f73 6974 696f 6e60  stream_position`
+00011dd0: 2c20 6066 726f 6d5f 656e 6460 2c5c 6e60  , `from_end`,\n`
+00011de0: 636f 6e73 756d 6572 5f73 7472 6174 6567  consumer_strateg
+00011df0: 7960 2c20 616e 6420 6074 696d 656f 7574  y`, and `timeout
+00011e00: 602e 5c6e 5c6e 5468 6973 206f 7074 696f  `.\n\nThis optio
+00011e10: 6e61 6c20 6073 7472 6561 6d5f 706f 7369  nal `stream_posi
+00011e20: 7469 6f6e 6020 6172 6775 6d65 6e74 2073  tion` argument s
+00011e30: 7065 6369 6669 6573 2061 2073 7472 6561  pecifies a strea
+00011e40: 6d20 706f 7369 7469 6f6e 2066 726f 6d5c  m position from\
+00011e50: 6e77 6869 6368 2074 6f20 7375 6273 6372  nwhich to subscr
+00011e60: 6962 652e 2054 6865 2072 6563 6f72 6465  ibe. The recorde
+00011e70: 6420 6576 656e 7420 6174 2074 6869 7320  d event at this 
+00011e80: 7374 7265 616d 5c6e 706f 7369 7469 6f6e  stream\nposition
+00011e90: 2077 696c 6c20 6265 2072 6563 6569 7665   will be receive
+00011ea0: 6420 7768 656e 2072 6561 6469 6e67 2074  d when reading t
+00011eb0: 6865 2073 7562 7363 7269 7074 696f 6e2e  he subscription.
+00011ec0: 5c6e 5c6e 5468 6973 206f 7074 696f 6e61  \n\nThis optiona
+00011ed0: 6c20 6066 726f 6d5f 656e 6460 2061 7267  l `from_end` arg
+00011ee0: 756d 656e 7420 6973 2061 2050 7974 686f  ument is a Pytho
+00011ef0: 6e20 6062 6f6f 6c60 2e5c 6e42 7920 6465  n `bool`.\nBy de
+00011f00: 6661 756c 742c 2074 6865 2076 616c 7565  fault, the value
+00011f10: 206f 6620 7468 6973 2061 7267 756d 656e   of this argumen
+00011f20: 7420 6973 2060 4661 6c73 6560 2e20 4966  t is `False`. If
+00011f30: 2074 6869 7320 6172 6775 6d65 6e74 2069   this argument i
+00011f40: 7320 7365 745c 6e74 6f20 6054 7275 6560  s set\nto `True`
+00011f50: 2c20 7265 6164 696e 6720 6672 6f6d 2074  , reading from t
+00011f60: 6865 2073 7562 7363 7269 7074 696f 6e20  he subscription 
+00011f70: 7769 6c6c 2072 6563 6569 7665 206f 6e6c  will receive onl
+00011f80: 7920 6576 656e 7473 5c6e 7265 636f 7264  y events\nrecord
+00011f90: 6564 2061 6674 6572 2074 6865 2073 7562  ed after the sub
+00011fa0: 7363 7269 7074 696f 6e20 7761 7320 6372  scription was cr
+00011fb0: 6561 7465 642e 2054 6861 7420 6973 2c20  eated. That is, 
+00011fc0: 6974 2069 7320 6e6f 7420 696e 636c 7573  it is not inclus
+00011fd0: 6976 655c 6e6f 6620 7468 6520 6375 7272  ive\nof the curr
+00011fe0: 656e 7420 7374 7265 616d 2070 6f73 6974  ent stream posit
+00011ff0: 696f 6e2e 5c6e 5c6e 5468 6520 6f70 7469  ion.\n\nThe opti
+00012000: 6f6e 616c 2060 636f 6e73 756d 6572 5f73  onal `consumer_s
+00012010: 7472 6174 6567 7960 2061 7267 756d 656e  trategy` argumen
+00012020: 7420 6973 2061 2050 7974 686f 6e20 6073  t is a Python `s
+00012030: 7472 6020 7468 6174 2064 6566 696e 6573  tr` that defines
+00012040: 5c6e 7468 6520 636f 6e73 756d 6572 2073  \nthe consumer s
+00012050: 7472 6174 6567 7920 666f 7220 7468 6973  trategy for this
+00012060: 2070 6572 7369 7374 656e 7420 7375 6273   persistent subs
+00012070: 6372 6970 7469 6f6e 2e20 5468 6520 7661  cription. The va
+00012080: 6c75 6520 6f66 2074 6869 7320 6172 6775  lue of this argu
+00012090: 6d65 6e74 5c6e 6361 6e20 6265 2060 5c27  ment\ncan be `\'
+000120a0: 4469 7370 6174 6368 546f 5369 6e67 6c65  DispatchToSingle
+000120b0: 5c27 602c 2060 5c27 526f 756e 6452 6f62  \'`, `\'RoundRob
+000120c0: 696e 5c27 602c 2060 5c27 5069 6e6e 6564  in\'`, `\'Pinned
+000120d0: 5c27 602c 206f 7220 605c 2750 696e 6e65  \'`, or `\'Pinne
+000120e0: 6442 7943 6f72 7265 6c61 7469 6f6e 5c27  dByCorrelation\'
+000120f0: 602e 2054 6865 5c6e 6465 6661 756c 7420  `. The\ndefault 
+00012100: 7661 6c75 6520 6973 2060 5c27 4469 7370  value is `\'Disp
+00012110: 6174 6368 546f 5369 6e67 6c65 5c27 602e  atchToSingle\'`.
+00012120: 5c6e 5c6e 5468 6973 206d 6574 686f 6420  \n\nThis method 
+00012130: 616c 736f 2074 616b 6573 2061 6e20 6f70  also takes an op
+00012140: 7469 6f6e 616c 2060 7469 6d65 6f75 7460  tional `timeout`
+00012150: 2061 7267 756d 656e 742c 2074 6861 745c   argument, that\
+00012160: 6e69 7320 6578 7065 6374 6564 2074 6f20  nis expected to 
+00012170: 6265 2061 2050 7974 686f 6e20 6066 6c6f  be a Python `flo
+00012180: 6174 602c 2077 6869 6368 2073 6574 7320  at`, which sets 
+00012190: 6120 6465 6164 6c69 6e65 5c6e 666f 7220  a deadline\nfor 
+000121a0: 7468 6520 636f 6d70 6c65 7469 6f6e 206f  the completion o
+000121b0: 6620 7468 6520 6752 5043 206f 7065 7261  f the gRPC opera
+000121c0: 7469 6f6e 2e5c 6e5c 6e54 6869 7320 6d65  tion.\n\nThis me
+000121d0: 7468 6f64 2064 6f65 7320 6e6f 7420 7265  thod does not re
+000121e0: 7475 726e 2061 2076 616c 7565 2e20 4576  turn a value. Ev
+000121f0: 656e 7473 2063 616e 2062 6520 7265 6365  ents can be rece
+00012200: 6976 6564 2062 7920 6974 6572 6174 696e  ived by iteratin
+00012210: 675c 6e6f 7665 7220 7468 6520 7661 6c75  g\nover the valu
+00012220: 6520 7265 7475 726e 6564 2062 7920 6361  e returned by ca
+00012230: 6c6c 696e 6720 6072 6561 645f 7374 7265  lling `read_stre
+00012240: 616d 5f73 7562 7363 7269 7074 696f 6e28  am_subscription(
+00012250: 2960 2e5c 6e5c 6e54 6865 2065 7861 6d70  )`.\n\nThe examp
+00012260: 6c65 2062 656c 6f77 2063 7265 6174 6573  le below creates
+00012270: 2061 2070 6572 7369 7374 656e 7420 7374   a persistent st
+00012280: 7265 616d 2073 7562 7363 7269 7074 696f  ream subscriptio
+00012290: 6e20 6672 6f6d 2074 6865 2073 7461 7274  n from the start
+000122a0: 206f 6620 7468 6520 7374 7265 616d 2e5c   of the stream.\
+000122b0: 6e5c 6e60 6060 7079 7468 6f6e 5c6e 2320  n\n```python\n# 
+000122c0: 4372 6561 7465 2061 2070 6572 7369 7374  Create a persist
+000122d0: 656e 7420 7374 7265 616d 2073 7562 7363  ent stream subsc
+000122e0: 7269 7074 696f 6e20 6672 6f6d 2073 7461  ription from sta
+000122f0: 7274 206f 6620 7468 6520 7374 7265 616d  rt of the stream
+00012300: 2e5c 6e67 726f 7570 5f6e 616d 6531 203d  .\ngroup_name1 =
+00012310: 2066 2267 726f 7570 2d7b 7575 6964 3428   f"group-{uuid4(
+00012320: 297d 225c 6e63 6c69 656e 742e 6372 6561  )}"\nclient.crea
+00012330: 7465 5f73 7472 6561 6d5f 7375 6273 6372  te_stream_subscr
+00012340: 6970 7469 6f6e 285c 6e20 2020 2067 726f  iption(\n    gro
+00012350: 7570 5f6e 616d 653d 6772 6f75 705f 6e61  up_name=group_na
+00012360: 6d65 312c 5c6e 2020 2020 7374 7265 616d  me1,\n    stream
+00012370: 5f6e 616d 653d 7374 7265 616d 5f6e 616d  _name=stream_nam
+00012380: 6532 2c5c 6e29 5c6e 6060 605c 6e5c 6e54  e2,\n)\n```\n\nT
+00012390: 6865 2065 7861 6d70 6c65 2062 656c 6f77  he example below
+000123a0: 2063 7265 6174 6573 2061 2070 6572 7369   creates a persi
+000123b0: 7374 656e 7420 7374 7265 616d 2073 7562  stent stream sub
+000123c0: 7363 7269 7074 696f 6e20 6672 6f6d 2061  scription from a
+000123d0: 2073 7472 6561 6d20 706f 7369 7469 6f6e   stream position
+000123e0: 2e5c 6e5c 6e60 6060 7079 7468 6f6e 5c6e  .\n\n```python\n
+000123f0: 2320 4372 6561 7465 2061 2070 6572 7369  # Create a persi
+00012400: 7374 656e 7420 7374 7265 616d 2073 7562  stent stream sub
+00012410: 7363 7269 7074 696f 6e20 6672 6f6d 2061  scription from a
+00012420: 2073 7472 6561 6d20 706f 7369 7469 6f6e   stream position
+00012430: 2e5c 6e67 726f 7570 5f6e 616d 6532 203d  .\ngroup_name2 =
+00012440: 2066 2267 726f 7570 2d7b 7575 6964 3428   f"group-{uuid4(
+00012450: 297d 225c 6e63 6c69 656e 742e 6372 6561  )}"\nclient.crea
+00012460: 7465 5f73 7472 6561 6d5f 7375 6273 6372  te_stream_subscr
+00012470: 6970 7469 6f6e 285c 6e20 2020 2067 726f  iption(\n    gro
+00012480: 7570 5f6e 616d 653d 6772 6f75 705f 6e61  up_name=group_na
+00012490: 6d65 322c 5c6e 2020 2020 7374 7265 616d  me2,\n    stream
+000124a0: 5f6e 616d 653d 7374 7265 616d 5f6e 616d  _name=stream_nam
+000124b0: 6532 2c5c 6e20 2020 2073 7472 6561 6d5f  e2,\n    stream_
+000124c0: 706f 7369 7469 6f6e 3d32 5c6e 295c 6e60  position=2\n)\n`
+000124d0: 6060 5c6e 5c6e 5468 6520 6578 616d 706c  ``\n\nThe exampl
+000124e0: 6520 6265 6c6f 7720 6372 6561 7465 7320  e below creates 
+000124f0: 6120 7065 7273 6973 7465 6e74 2073 7472  a persistent str
+00012500: 6561 6d20 7375 6273 6372 6970 7469 6f6e  eam subscription
+00012510: 2066 726f 6d20 7468 6520 656e 6420 6f66   from the end of
+00012520: 2074 6865 2073 7472 6561 6d2e 5c6e 5c6e   the stream.\n\n
+00012530: 6060 6070 7974 686f 6e5c 6e23 2043 7265  ```python\n# Cre
+00012540: 6174 6520 6120 7065 7273 6973 7465 6e74  ate a persistent
+00012550: 2073 7472 6561 6d20 7375 6273 6372 6970   stream subscrip
+00012560: 7469 6f6e 2066 726f 6d20 656e 6420 6f66  tion from end of
+00012570: 2074 6865 2073 7472 6561 6d2e 5c6e 6772   the stream.\ngr
+00012580: 6f75 705f 6e61 6d65 3320 3d20 6622 6772  oup_name3 = f"gr
+00012590: 6f75 702d 7b75 7569 6434 2829 7d22 5c6e  oup-{uuid4()}"\n
+000125a0: 636c 6965 6e74 2e63 7265 6174 655f 7374  client.create_st
+000125b0: 7265 616d 5f73 7562 7363 7269 7074 696f  ream_subscriptio
+000125c0: 6e28 5c6e 2020 2020 6772 6f75 705f 6e61  n(\n    group_na
+000125d0: 6d65 3d67 726f 7570 5f6e 616d 6533 2c5c  me=group_name3,\
+000125e0: 6e20 2020 2073 7472 6561 6d5f 6e61 6d65  n    stream_name
+000125f0: 3d73 7472 6561 6d5f 6e61 6d65 322c 5c6e  =stream_name2,\n
+00012600: 2020 2020 6672 6f6d 5f65 6e64 3d54 7275      from_end=Tru
+00012610: 655c 6e29 5c6e 6060 605c 6e5c 6e23 2323  e\n)\n```\n\n###
+00012620: 2052 6561 6420 7374 7265 616d 2073 7562   Read stream sub
+00012630: 7363 7269 7074 696f 6e5c 6e5c 6e2a 7265  scription\n\n*re
+00012640: 7175 6972 6573 206c 6561 6465 722a 5c6e  quires leader*\n
+00012650: 5c6e 5468 6520 6072 6561 645f 7374 7265  \nThe `read_stre
+00012660: 616d 5f73 7562 7363 7269 7074 696f 6e28  am_subscription(
+00012670: 2960 206d 6574 686f 6420 6361 6e20 6265  )` method can be
+00012680: 2075 7365 6420 746f 2072 6561 6420 6120   used to read a 
+00012690: 7065 7273 6973 7465 6e74 5c6e 7374 7265  persistent\nstre
+000126a0: 616d 2073 7562 7363 7269 7074 696f 6e2e  am subscription.
+000126b0: 5c6e 5c6e 5468 6973 206d 6574 686f 6420  \n\nThis method 
+000126c0: 6861 7320 7477 6f20 7265 7175 6972 6564  has two required
+000126d0: 2061 7267 756d 656e 7473 2c20 6067 726f   arguments, `gro
+000126e0: 7570 5f6e 616d 6560 2061 6e64 2060 7374  up_name` and `st
+000126f0: 7265 616d 5f6e 616d 6560 2c20 7768 6963  ream_name`, whic
+00012700: 685c 6e73 686f 756c 6420 6d61 7463 6820  h\nshould match 
+00012710: 7468 6520 7661 6c75 6573 206f 6620 6172  the values of ar
+00012720: 6775 6d65 6e74 7320 7573 6564 2077 6865  guments used whe
+00012730: 6e20 6361 6c6c 696e 6720 6063 7265 6174  n calling `creat
+00012740: 655f 7374 7265 616d 5f73 7562 7363 7269  e_stream_subscri
+00012750: 7074 696f 6e28 2960 2e5c 6e5c 6e54 6869  ption()`.\n\nThi
+00012760: 7320 6d65 7468 6f64 2061 6c73 6f20 7461  s method also ta
+00012770: 6b65 7320 616e 206f 7074 696f 6e61 6c20  kes an optional 
+00012780: 6074 696d 656f 7574 6020 6172 6775 6d65  `timeout` argume
+00012790: 6e74 2c20 7468 6174 5c6e 6973 2065 7870  nt, that\nis exp
+000127a0: 6563 7465 6420 746f 2062 6520 6120 5079  ected to be a Py
+000127b0: 7468 6f6e 2060 666c 6f61 7460 2c20 7768  thon `float`, wh
+000127c0: 6963 6820 7365 7473 2061 2064 6561 646c  ich sets a deadl
+000127d0: 696e 655c 6e66 6f72 2074 6865 2063 6f6d  ine\nfor the com
+000127e0: 706c 6574 696f 6e20 6f66 2074 6865 2067  pletion of the g
+000127f0: 5250 4320 6f70 6572 6174 696f 6e2e 5c6e  RPC operation.\n
+00012800: 5c6e 5468 6973 206d 6574 686f 6420 7265  \nThis method re
+00012810: 7475 726e 7320 6120 6050 6572 7369 7374  turns a `Persist
+00012820: 656e 7453 7562 7363 7269 7074 696f 6e60  entSubscription`
+00012830: 206f 626a 6563 742c 2077 6869 6368 2069   object, which i
+00012840: 7320 616e 2069 7465 7261 746f 725c 6e67  s an iterator\ng
+00012850: 6976 696e 6720 6052 6563 6f72 6465 6445  iving `RecordedE
+00012860: 7665 6e74 6020 6f62 6a65 6374 732c 2074  vent` objects, t
+00012870: 6861 7420 616c 736f 2068 6173 2060 6163  hat also has `ac
+00012880: 6b28 2960 2c20 606e 6163 6b28 2960 2061  k()`, `nack()` a
+00012890: 6e64 2060 7374 6f70 2829 605c 6e6d 6574  nd `stop()`\nmet
+000128a0: 686f 6473 2e5c 6e5c 6e60 6060 7079 7468  hods.\n\n```pyth
+000128b0: 6f6e 5c6e 7375 6273 6372 6970 7469 6f6e  on\nsubscription
+000128c0: 203d 2063 6c69 656e 742e 7265 6164 5f73   = client.read_s
+000128d0: 7472 6561 6d5f 7375 6273 6372 6970 7469  tream_subscripti
+000128e0: 6f6e 285c 6e20 2020 2067 726f 7570 5f6e  on(\n    group_n
+000128f0: 616d 653d 6772 6f75 705f 6e61 6d65 312c  ame=group_name1,
+00012900: 5c6e 2020 2020 7374 7265 616d 5f6e 616d  \n    stream_nam
+00012910: 653d 7374 7265 616d 5f6e 616d 6532 2c5c  e=stream_name2,\
+00012920: 6e29 5c6e 6060 605c 6e5c 6e54 6865 2065  n)\n```\n\nThe e
+00012930: 7861 6d70 6c65 2062 656c 6f77 2069 7465  xample below ite
+00012940: 7261 7465 7320 6f76 6572 2074 6865 2073  rates over the s
+00012950: 7562 7363 7269 7074 696f 6e20 6f62 6a65  ubscription obje
+00012960: 6374 2c20 616e 6420 6361 6c6c 7320 6061  ct, and calls `a
+00012970: 636b 2829 602e 5c6e 5468 6520 666f 7220  ck()`.\nThe for 
+00012980: 6c6f 6f70 2062 7265 616b 7320 7768 656e  loop breaks when
+00012990: 2077 6520 6861 7665 2072 6563 6569 7665   we have receive
+000129a0: 6420 7468 6520 6c61 7374 2065 7665 6e74  d the last event
+000129b0: 2069 6e20 7468 6520 7374 7265 616d 2c20   in the stream, 
+000129c0: 736f 5c6e 7468 6174 2077 6520 6361 6e20  so\nthat we can 
+000129d0: 6669 6e69 7368 2074 6865 2065 7861 6d70  finish the examp
+000129e0: 6c65 7320 696e 2074 6869 7320 646f 6375  les in this docu
+000129f0: 6d65 6e74 6174 696f 6e2e 5c6e 5c6e 6060  mentation.\n\n``
+00012a00: 6070 7974 686f 6e5c 6e65 7665 6e74 7320  `python\nevents 
+00012a10: 3d20 5b5d 5c6e 666f 7220 6576 656e 7420  = []\nfor event 
+00012a20: 696e 2073 7562 7363 7269 7074 696f 6e3a  in subscription:
+00012a30: 5c6e 2020 2020 6576 656e 7473 2e61 7070  \n    events.app
+00012a40: 656e 6428 6576 656e 7429 5c6e 5c6e 2020  end(event)\n\n  
+00012a50: 2020 2320 4163 6b6e 6f77 6c65 6467 6520    # Acknowledge 
+00012a60: 7468 6520 7265 6365 6976 6564 2065 7665  the received eve
+00012a70: 6e74 2e5c 6e20 2020 2073 7562 7363 7269  nt.\n    subscri
+00012a80: 7074 696f 6e2e 6163 6b28 6576 656e 745f  ption.ack(event_
+00012a90: 6964 3d65 7665 6e74 2e69 6429 5c6e 5c6e  id=event.id)\n\n
+00012aa0: 2020 2020 2320 5374 6f70 2077 6865 6e20      # Stop when 
+00012ab0: 5c27 6576 656e 7431 315c 2720 6861 7320  \'event11\' has 
+00012ac0: 6265 656e 2072 6563 6569 7665 642e 5c6e  been received.\n
+00012ad0: 2020 2020 6966 2065 7665 6e74 2e69 6420      if event.id 
+00012ae0: 3d3d 2065 7665 6e74 3131 2e69 643a 5c6e  == event11.id:\n
+00012af0: 2020 2020 2020 2020 7375 6273 6372 6970          subscrip
+00012b00: 7469 6f6e 2e73 746f 7028 295c 6e60 6060  tion.stop()\n```
+00012b10: 5c6e 5c6e 5765 2063 616e 2063 6865 636b  \n\nWe can check
+00012b20: 2077 6520 7265 6365 6976 6564 2061 6c6c   we received all
+00012b30: 2074 6865 2065 7665 6e74 7320 7468 6174   the events that
+00012b40: 2077 6572 6520 6170 7065 6e64 6564 2074   were appended t
+00012b50: 6f20 6073 7472 6561 6d5f 6e61 6d65 3260  o `stream_name2`
+00012b60: 5c6e 696e 2074 6865 2065 7861 6d70 6c65  \nin the example
+00012b70: 7320 6162 6f76 652e 5c6e 5c6e 6060 6070  s above.\n\n```p
+00012b80: 7974 686f 6e5c 6e61 7373 6572 7420 6c65  ython\nassert le
+00012b90: 6e28 6576 656e 7473 2920 3d3d 2034 5c6e  n(events) == 4\n
+00012ba0: 6173 7365 7274 2065 7665 6e74 735b 305d  assert events[0]
+00012bb0: 2e73 7472 6561 6d5f 6e61 6d65 203d 3d20  .stream_name == 
+00012bc0: 7374 7265 616d 5f6e 616d 6532 5c6e 6173  stream_name2\nas
+00012bd0: 7365 7274 2065 7665 6e74 735b 305d 2e69  sert events[0].i
+00012be0: 6420 3d3d 2065 7665 6e74 342e 6964 5c6e  d == event4.id\n
+00012bf0: 6173 7365 7274 2065 7665 6e74 735b 315d  assert events[1]
+00012c00: 2e73 7472 6561 6d5f 6e61 6d65 203d 3d20  .stream_name == 
+00012c10: 7374 7265 616d 5f6e 616d 6532 5c6e 6173  stream_name2\nas
+00012c20: 7365 7274 2065 7665 6e74 735b 315d 2e69  sert events[1].i
+00012c30: 6420 3d3d 2065 7665 6e74 352e 6964 5c6e  d == event5.id\n
+00012c40: 6173 7365 7274 2065 7665 6e74 735b 325d  assert events[2]
+00012c50: 2e73 7472 6561 6d5f 6e61 6d65 203d 3d20  .stream_name == 
+00012c60: 7374 7265 616d 5f6e 616d 6532 5c6e 6173  stream_name2\nas
+00012c70: 7365 7274 2065 7665 6e74 735b 325d 2e69  sert events[2].i
+00012c80: 6420 3d3d 2065 7665 6e74 362e 6964 5c6e  d == event6.id\n
+00012c90: 6173 7365 7274 2065 7665 6e74 735b 335d  assert events[3]
+00012ca0: 2e73 7472 6561 6d5f 6e61 6d65 203d 3d20  .stream_name == 
+00012cb0: 7374 7265 616d 5f6e 616d 6532 5c6e 6173  stream_name2\nas
+00012cc0: 7365 7274 2065 7665 6e74 735b 335d 2e69  sert events[3].i
+00012cd0: 6420 3d3d 2065 7665 6e74 3131 2e69 645c  d == event11.id\
+00012ce0: 6e60 6060 5c6e 5c6e 2323 2320 4765 7420  n```\n\n### Get 
+00012cf0: 7374 7265 616d 2073 7562 7363 7269 7074  stream subscript
+00012d00: 696f 6e20 696e 666f 5c6e 5c6e 2a72 6571  ion info\n\n*req
+00012d10: 7569 7265 7320 6c65 6164 6572 2a5c 6e5c  uires leader*\n\
+00012d20: 6e54 6865 2060 6765 745f 7374 7265 616d  nThe `get_stream
+00012d30: 5f73 7562 7363 7269 7074 696f 6e5f 696e  _subscription_in
+00012d40: 666f 2829 6020 6d65 7468 6f64 2063 616e  fo()` method can
+00012d50: 2062 6520 7573 6564 2074 6f20 6765 7420   be used to get 
+00012d60: 696e 666f 726d 6174 696f 6e20 666f 7220  information for 
+00012d70: 615c 6e70 6572 7369 7374 656e 7420 7375  a\npersistent su
+00012d80: 6273 6372 6970 7469 6f6e 2066 6f72 2061  bscription for a
+00012d90: 2073 7472 6561 6d2e 5c6e 5c6e 5468 6973   stream.\n\nThis
+00012da0: 206d 6574 686f 6420 6861 7320 7477 6f20   method has two 
+00012db0: 7265 7175 6972 6564 2061 7267 756d 656e  required argumen
+00012dc0: 7473 2c20 6067 726f 7570 5f6e 616d 6560  ts, `group_name`
+00012dd0: 2061 6e64 2060 7374 7265 616d 5f6e 616d   and `stream_nam
+00012de0: 6560 2c20 7768 6963 685c 6e73 686f 756c  e`, which\nshoul
+00012df0: 6420 6d61 7463 6820 7468 6520 7661 6c75  d match the valu
+00012e00: 6573 206f 6620 6172 6775 6d65 6e74 7320  es of arguments 
+00012e10: 7573 6564 2077 6865 6e20 6361 6c6c 696e  used when callin
+00012e20: 6720 6063 7265 6174 655f 7374 7265 616d  g `create_stream
+00012e30: 5f73 7562 7363 7269 7074 696f 6e28 2960  _subscription()`
+00012e40: 2e5c 6e5c 6e54 6869 7320 6d65 7468 6f64  .\n\nThis method
+00012e50: 2061 6c73 6f20 7461 6b65 7320 616e 206f   also takes an o
+00012e60: 7074 696f 6e61 6c20 6074 696d 656f 7574  ptional `timeout
+00012e70: 6020 6172 6775 6d65 6e74 2c20 7468 6174  ` argument, that
+00012e80: 5c6e 6973 2065 7870 6563 7465 6420 746f  \nis expected to
+00012e90: 2062 6520 6120 5079 7468 6f6e 2060 666c   be a Python `fl
+00012ea0: 6f61 7460 2c20 7768 6963 6820 7365 7473  oat`, which sets
+00012eb0: 2061 2064 6561 646c 696e 655c 6e66 6f72   a deadline\nfor
+00012ec0: 2074 6865 2063 6f6d 706c 6574 696f 6e20   the completion 
+00012ed0: 6f66 2074 6865 2067 5250 4320 6f70 6572  of the gRPC oper
+00012ee0: 6174 696f 6e2e 5c6e 5c6e 6060 6070 7974  ation.\n\n```pyt
+00012ef0: 686f 6e5c 6e73 7562 7363 7269 7074 696f  hon\nsubscriptio
+00012f00: 6e5f 696e 666f 203d 2063 6c69 656e 742e  n_info = client.
+00012f10: 6765 745f 7374 7265 616d 5f73 7562 7363  get_stream_subsc
+00012f20: 7269 7074 696f 6e5f 696e 666f 285c 6e20  ription_info(\n 
+00012f30: 2020 2067 726f 7570 5f6e 616d 653d 6772     group_name=gr
+00012f40: 6f75 705f 6e61 6d65 312c 5c6e 2020 2020  oup_name1,\n    
+00012f50: 7374 7265 616d 5f6e 616d 653d 7374 7265  stream_name=stre
+00012f60: 616d 5f6e 616d 6532 2c5c 6e29 5c6e 6060  am_name2,\n)\n``
+00012f70: 605c 6e5c 6e54 6865 2072 6574 7572 6e65  `\n\nThe returne
+00012f80: 6420 7661 6c75 6520 6973 2061 2060 5375  d value is a `Su
+00012f90: 6273 6372 6970 7469 6f6e 496e 666f 6020  bscriptionInfo` 
+00012fa0: 6f62 6a65 6374 2e5c 6e5c 6e23 2323 204c  object.\n\n### L
+00012fb0: 6973 7420 7374 7265 616d 2073 7562 7363  ist stream subsc
+00012fc0: 7269 7074 696f 6e73 5c6e 5c6e 2a72 6571  riptions\n\n*req
+00012fd0: 7569 7265 7320 6c65 6164 6572 2a5c 6e5c  uires leader*\n\
+00012fe0: 6e54 6865 2060 6c69 7374 5f73 7472 6561  nThe `list_strea
+00012ff0: 6d5f 7375 6273 6372 6970 7469 6f6e 7328  m_subscriptions(
+00013000: 2960 206d 6574 686f 6420 6361 6e20 6265  )` method can be
+00013010: 2075 7365 6420 746f 2067 6574 2069 6e66   used to get inf
+00013020: 6f72 6d61 7469 6f6e 2066 6f72 2061 6c6c  ormation for all
+00013030: 5c6e 7468 6520 7065 7273 6973 7465 6e74  \nthe persistent
+00013040: 2073 7562 7363 7269 7074 696f 6e73 2066   subscriptions f
+00013050: 6f72 2061 2073 7472 6561 6d2e 5c6e 5c6e  or a stream.\n\n
+00013060: 5468 6973 206d 6574 686f 6420 6861 7320  This method has 
+00013070: 6f6e 6520 7265 7175 6972 6564 2061 7267  one required arg
+00013080: 756d 656e 742c 2060 7374 7265 616d 5f6e  ument, `stream_n
+00013090: 616d 6560 2e5c 6e5c 6e54 6869 7320 6d65  ame`.\n\nThis me
+000130a0: 7468 6f64 2061 6c73 6f20 7461 6b65 7320  thod also takes 
+000130b0: 616e 206f 7074 696f 6e61 6c20 6074 696d  an optional `tim
+000130c0: 656f 7574 6020 6172 6775 6d65 6e74 2c20  eout` argument, 
+000130d0: 7468 6174 5c6e 6973 2065 7870 6563 7465  that\nis expecte
+000130e0: 6420 746f 2062 6520 6120 5079 7468 6f6e  d to be a Python
+000130f0: 2060 666c 6f61 7460 2c20 7768 6963 6820   `float`, which 
+00013100: 7365 7473 2061 2064 6561 646c 696e 655c  sets a deadline\
+00013110: 6e66 6f72 2074 6865 2063 6f6d 706c 6574  nfor the complet
+00013120: 696f 6e20 6f66 2074 6865 2067 5250 4320  ion of the gRPC 
+00013130: 6f70 6572 6174 696f 6e2e 5c6e 5c6e 6060  operation.\n\n``
+00013140: 6070 7974 686f 6e5c 6e73 7562 7363 7269  `python\nsubscri
+00013150: 7074 696f 6e73 203d 2063 6c69 656e 742e  ptions = client.
+00013160: 6c69 7374 5f73 7472 6561 6d5f 7375 6273  list_stream_subs
+00013170: 6372 6970 7469 6f6e 7328 5c6e 2020 2020  criptions(\n    
+00013180: 7374 7265 616d 5f6e 616d 653d 7374 7265  stream_name=stre
+00013190: 616d 5f6e 616d 6532 2c5c 6e29 5c6e 6060  am_name2,\n)\n``
+000131a0: 605c 6e5c 6e54 6865 2072 6574 7572 6e65  `\n\nThe returne
+000131b0: 6420 7661 6c75 6520 6973 2061 206c 6973  d value is a lis
+000131c0: 7420 6f66 2060 5375 6273 6372 6970 7469  t of `Subscripti
+000131d0: 6f6e 496e 666f 6020 6f62 6a65 6374 732e  onInfo` objects.
+000131e0: 5c6e 5c6e 2323 2320 5570 6461 7465 2073  \n\n### Update s
+000131f0: 7472 6561 6d20 7375 6273 6372 6970 7469  tream subscripti
+00013200: 6f6e 5c6e 5c6e 2a72 6571 7569 7265 7320  on\n\n*requires 
+00013210: 6c65 6164 6572 2a5c 6e5c 6e54 6865 206d  leader*\n\nThe m
+00013220: 6574 686f 6420 6075 7064 6174 655f 7374  ethod `update_st
+00013230: 7265 616d 5f73 7562 7363 7269 7074 696f  ream_subscriptio
+00013240: 6e28 2960 2063 616e 2062 6520 7573 6564  n()` can be used
+00013250: 2074 6f20 7570 6461 7465 2061 5c6e 7065   to update a\npe
+00013260: 7273 6973 7465 6e74 2073 7562 7363 7269  rsistent subscri
+00013270: 7074 696f 6e20 666f 7220 6120 7374 7265  ption for a stre
+00013280: 616d 2e5c 6e5c 6e54 6869 7320 6d65 7468  am.\n\nThis meth
+00013290: 6f64 2074 616b 6573 2061 2072 6571 7569  od takes a requi
+000132a0: 7265 6420 6067 726f 7570 5f6e 616d 6560  red `group_name`
+000132b0: 2061 7267 756d 656e 742c 2077 6869 6368   argument, which
+000132c0: 2069 7320 7468 655c 6e6e 616d 6520 6f66   is the\nname of
+000132d0: 2061 2022 6772 6f75 7022 206f 6620 636f   a "group" of co
+000132e0: 6e73 756d 6572 7320 6f66 2074 6865 2073  nsumers of the s
+000132f0: 7562 7363 7269 7074 696f 6e2c 2061 6e64  ubscription, and
+00013300: 2061 2072 6571 7569 7265 645c 6e60 7374   a required\n`st
+00013310: 7265 616d 5f6e 616d 6560 2061 7267 756d  ream_name` argum
+00013320: 656e 742c 2077 6869 6368 2069 7320 7468  ent, which is th
+00013330: 6520 6e61 6d65 206f 6620 6120 7374 7265  e name of a stre
+00013340: 616d 2e5c 6e5c 6e54 6869 7320 6d65 7468  am.\n\nThis meth
+00013350: 6f64 2061 6c73 6f20 7461 6b65 7320 7468  od also takes th
+00013360: 7265 6520 6f70 7469 6f6e 616c 2061 7267  ree optional arg
+00013370: 756d 656e 7473 2c20 6066 726f 6d5f 656e  uments, `from_en
+00013380: 6460 2c20 6073 7472 6561 6d5f 706f 7369  d`, `stream_posi
+00013390: 7469 6f6e 602c 5c6e 616e 6420 6074 696d  tion`,\nand `tim
+000133a0: 656f 7574 602e 5c6e 5c6e 5468 6520 6f70  eout`.\n\nThe op
+000133b0: 7469 6f6e 616c 2060 6672 6f6d 5f65 6e64  tional `from_end
+000133c0: 6020 6172 6775 6d65 6e74 2063 616e 2062  ` argument can b
+000133d0: 6520 7573 6564 2074 6f20 7370 6563 6966  e used to specif
+000133e0: 7920 7468 6174 2074 6865 2067 726f 7570  y that the group
+000133f0: 206f 6620 636f 6e73 756d 6572 735c 6e6f   of consumers\no
+00013400: 6620 7468 6520 7375 6273 6372 6970 7469  f the subscripti
+00013410: 6f6e 2073 686f 756c 6420 6f6e 6c79 2072  on should only r
+00013420: 6563 6569 7665 2065 7665 6e74 7320 7468  eceive events th
+00013430: 6174 2077 6572 6520 7265 636f 7264 6564  at were recorded
+00013440: 2061 6674 6572 2074 6865 2073 7562 7363   after the subsc
+00013450: 7269 7074 696f 6e5c 6e77 6173 2075 7064  ription\nwas upd
+00013460: 6174 6564 2e5c 6e5c 6e41 6c74 6572 6e61  ated.\n\nAlterna
+00013470: 7469 7665 6c79 2c20 7468 6520 6f70 7469  tively, the opti
+00013480: 6f6e 616c 2060 7374 7265 616d 5f70 6f73  onal `stream_pos
+00013490: 6974 696f 6e60 2061 7267 756d 656e 7420  ition` argument 
+000134a0: 6361 6e20 6265 2075 7365 6420 746f 2073  can be used to s
+000134b0: 7065 6369 6679 2061 2073 7472 6561 6d5c  pecify a stream\
+000134c0: 6e70 6f73 6974 696f 6e20 6672 6f6d 2077  nposition from w
+000134d0: 6869 6368 2063 6f6d 6d69 7420 706f 7369  hich commit posi
+000134e0: 7469 6f6e 2074 6865 2067 726f 7570 206f  tion the group o
+000134f0: 6620 636f 6e73 756d 6572 7320 6f66 2074  f consumers of t
+00013500: 6865 2073 7562 7363 7269 7074 696f 6e20  he subscription 
+00013510: 7368 6f75 6c64 5c6e 7265 6365 6976 6520  should\nreceive 
+00013520: 6576 656e 7473 2e20 506c 6561 7365 206e  events. Please n
+00013530: 6f74 652c 2074 6865 2072 6563 6f72 6465  ote, the recorde
+00013540: 6420 6576 656e 7420 6174 2074 6865 2073  d event at the s
+00013550: 7065 6369 6669 6564 2073 7472 6561 6d20  pecified stream 
+00013560: 706f 7369 7469 6f6e 206d 6967 6874 5c6e  position might\n
+00013570: 6265 2069 6e63 6c75 6465 6420 696e 2074  be included in t
+00013580: 6865 2072 6563 6f72 6465 6420 6576 656e  he recorded even
+00013590: 7473 2072 6563 6569 7665 6420 6279 2074  ts received by t
+000135a0: 6865 2067 726f 7570 206f 6620 636f 6e73  he group of cons
+000135b0: 756d 6572 732e 5c6e 5c6e 4966 206e 6569  umers.\n\nIf nei
+000135c0: 7468 6572 2060 6672 6f6d 5f65 6e64 6020  ther `from_end` 
+000135d0: 6f72 2060 636f 6d6d 6974 5f70 6f73 6974  or `commit_posit
+000135e0: 696f 6e60 2061 7265 2073 7065 6369 6669  ion` are specifi
+000135f0: 6564 2c20 7468 6520 6772 6f75 7020 6f66  ed, the group of
+00013600: 2063 6f6e 7375 6d65 7273 5c6e 6f66 2074   consumers\nof t
+00013610: 6865 2073 7562 7363 7269 7074 696f 6e20  he subscription 
+00013620: 7769 6c6c 2070 6f74 656e 7469 616c 6c79  will potentially
+00013630: 2072 6563 6569 7665 2061 6c6c 2072 6563   receive all rec
+00013640: 6f72 6465 6420 6576 656e 7473 2069 6e20  orded events in 
+00013650: 7468 6520 7374 7265 616d 2e5c 6e5c 6e50  the stream.\n\nP
+00013660: 6c65 6173 6520 6e6f 7465 2c20 7468 6520  lease note, the 
+00013670: 636f 6e73 756d 6572 2073 7472 6174 6567  consumer strateg
+00013680: 7920 6361 6e6e 6f74 2062 6520 6164 6a75  y cannot be adju
+00013690: 7374 6564 2e5c 6e5c 6e54 6865 206f 7074  sted.\n\nThe opt
+000136a0: 696f 6e61 6c20 6074 696d 656f 7574 6020  ional `timeout` 
+000136b0: 6172 6775 6d65 6e74 2069 7320 6120 5079  argument is a Py
+000136c0: 7468 6f6e 2060 666c 6f61 7460 2077 6869  thon `float` whi
+000136d0: 6368 2073 6574 7320 615c 6e64 6561 646c  ch sets a\ndeadl
+000136e0: 696e 6520 666f 7220 7468 6520 636f 6d70  ine for the comp
+000136f0: 6c65 7469 6f6e 206f 6620 7468 6520 6752  letion of the gR
+00013700: 5043 206f 7065 7261 7469 6f6e 2e5c 6e5c  PC operation.\n\
+00013710: 6e54 6865 206d 6574 686f 6420 6075 7064  nThe method `upd
+00013720: 6174 655f 7374 7265 616d 5f73 7562 7363  ate_stream_subsc
+00013730: 7269 7074 696f 6e28 2960 2064 6f65 7320  ription()` does 
+00013740: 6e6f 7420 7265 7475 726e 2061 2076 616c  not return a val
+00013750: 7565 2e5c 6e5c 6e49 6e20 7468 6520 6578  ue.\n\nIn the ex
+00013760: 616d 706c 6520 6265 6c6f 772c 2061 2070  ample below, a p
+00013770: 6572 7369 7374 656e 7420 7375 6273 6372  ersistent subscr
+00013780: 6970 7469 6f6e 2066 6f72 2061 2073 7472  iption for a str
+00013790: 6561 6d20 6973 2075 7064 6174 6564 2074  eam is updated t
+000137a0: 6f20 7275 6e20 6672 6f6d 2074 6865 5c6e  o run from the\n
+000137b0: 656e 6420 6f66 2074 6865 2073 7472 6561  end of the strea
+000137c0: 6d2e 5c6e 5c6e 6060 6070 7974 686f 6e5c  m.\n\n```python\
+000137d0: 6e23 2043 7265 6174 6520 6120 7065 7273  n# Create a pers
+000137e0: 6973 7465 6e74 2073 7562 7363 7269 7074  istent subscript
+000137f0: 696f 6e2e 5c6e 636c 6965 6e74 2e75 7064  ion.\nclient.upd
+00013800: 6174 655f 7374 7265 616d 5f73 7562 7363  ate_stream_subsc
+00013810: 7269 7074 696f 6e28 5c6e 2020 2020 6772  ription(\n    gr
+00013820: 6f75 705f 6e61 6d65 3d67 726f 7570 5f6e  oup_name=group_n
+00013830: 616d 6531 2c5c 6e20 2020 2073 7472 6561  ame1,\n    strea
+00013840: 6d5f 6e61 6d65 3d73 7472 6561 6d5f 6e61  m_name=stream_na
+00013850: 6d65 322c 5c6e 2020 2020 6672 6f6d 5f65  me2,\n    from_e
+00013860: 6e64 3d54 7275 652c 5c6e 295c 6e60 6060  nd=True,\n)\n```
+00013870: 5c6e 5c6e 2323 2320 4465 6c65 7465 2073  \n\n### Delete s
+00013880: 7472 6561 6d20 7375 6273 6372 6970 7469  tream subscripti
+00013890: 6f6e 5c6e 5c6e 2a72 6571 7569 7265 7320  on\n\n*requires 
+000138a0: 6c65 6164 6572 2a5c 6e5c 6e54 6865 2060  leader*\n\nThe `
+000138b0: 6465 6c65 7465 5f73 7472 6561 6d5f 7375  delete_stream_su
+000138c0: 6273 6372 6970 7469 6f6e 2829 6020 6d65  bscription()` me
+000138d0: 7468 6f64 2063 616e 2062 6520 7573 6564  thod can be used
+000138e0: 2074 6f20 6465 6c65 7465 2061 2070 6572   to delete a per
+000138f0: 7369 7374 656e 745c 6e73 7562 7363 7269  sistent\nsubscri
+00013900: 7074 696f 6e20 666f 7220 6120 7374 7265  ption for a stre
+00013910: 616d 2e5c 6e5c 6e54 6869 7320 6d65 7468  am.\n\nThis meth
+00013920: 6f64 2068 6173 2074 776f 2072 6571 7569  od has two requi
+00013930: 7265 6420 6172 6775 6d65 6e74 732c 2060  red arguments, `
+00013940: 6772 6f75 705f 6e61 6d65 6020 616e 6420  group_name` and 
+00013950: 6073 7472 6561 6d5f 6e61 6d65 602c 2077  `stream_name`, w
+00013960: 6869 6368 5c6e 7368 6f75 6c64 206d 6174  hich\nshould mat
+00013970: 6368 2074 6865 2076 616c 7565 7320 6f66  ch the values of
+00013980: 2061 7267 756d 656e 7473 2075 7365 6420   arguments used 
+00013990: 7768 656e 2063 616c 6c69 6e67 2060 6372  when calling `cr
+000139a0: 6561 7465 5f73 7472 6561 6d5f 7375 6273  eate_stream_subs
+000139b0: 6372 6970 7469 6f6e 2829 602e 5c6e 5c6e  cription()`.\n\n
+000139c0: 5468 6973 206d 6574 686f 6420 616c 736f  This method also
+000139d0: 2074 616b 6573 2061 6e20 6f70 7469 6f6e   takes an option
+000139e0: 616c 2060 7469 6d65 6f75 7460 2061 7267  al `timeout` arg
+000139f0: 756d 656e 742c 2074 6861 745c 6e69 7320  ument, that\nis 
+00013a00: 6578 7065 6374 6564 2074 6f20 6265 2061  expected to be a
+00013a10: 2050 7974 686f 6e20 6066 6c6f 6174 602c   Python `float`,
+00013a20: 2077 6869 6368 2073 6574 7320 6120 6465   which sets a de
+00013a30: 6164 6c69 6e65 5c6e 666f 7220 7468 6520  adline\nfor the 
+00013a40: 636f 6d70 6c65 7469 6f6e 206f 6620 7468  completion of th
+00013a50: 6520 6752 5043 206f 7065 7261 7469 6f6e  e gRPC operation
+00013a60: 2e5c 6e5c 6e60 6060 7079 7468 6f6e 5c6e  .\n\n```python\n
+00013a70: 636c 6965 6e74 2e64 656c 6574 655f 7374  client.delete_st
+00013a80: 7265 616d 5f73 7562 7363 7269 7074 696f  ream_subscriptio
+00013a90: 6e28 5c6e 2020 2020 6772 6f75 705f 6e61  n(\n    group_na
+00013aa0: 6d65 3d67 726f 7570 5f6e 616d 6531 2c5c  me=group_name1,\
+00013ab0: 6e20 2020 2073 7472 6561 6d5f 6e61 6d65  n    stream_name
+00013ac0: 3d73 7472 6561 6d5f 6e61 6d65 322c 5c6e  =stream_name2,\n
+00013ad0: 295c 6e60 6060 5c6e 5c6e 2323 2320 5065  )\n```\n\n### Pe
+00013ae0: 7273 6973 7465 6e74 2073 7562 7363 7269  rsistent subscri
+00013af0: 7074 696f 6e20 636f 6e73 756d 6572 5c6e  ption consumer\n
+00013b00: 5c6e 5468 6520 7265 6164 696e 6720 6f66  \nThe reading of
+00013b10: 2061 2070 6572 7369 7374 656e 7420 7375   a persistent su
+00013b20: 6273 6372 6970 7469 6f6e 2063 616e 2062  bscription can b
+00013b30: 6520 656e 6361 7073 756c 6174 6564 2069  e encapsulated i
+00013b40: 6e20 6120 2263 6f6e 7375 6d65 7222 2074  n a "consumer" t
+00013b50: 6861 7420 6361 6c6c 735c 6e61 2022 706f  hat calls\na "po
+00013b60: 6c69 6379 2220 6675 6e63 7469 6f6e 2077  licy" function w
+00013b70: 6865 6e20 6120 7265 636f 7264 6564 2065  hen a recorded e
+00013b80: 7665 6e74 2069 7320 7265 6365 6976 6564  vent is received
+00013b90: 2061 6e64 2074 6865 6e20 6175 746f 6d61   and then automa
+00013ba0: 7469 6361 6c6c 7920 6361 6c6c 735c 6e60  tically calls\n`
+00013bb0: 6163 6b28 2960 2069 6620 7468 6520 706f  ack()` if the po
+00013bc0: 6c69 6379 2066 756e 6374 696f 6e20 7265  licy function re
+00013bd0: 7475 726e 7320 6e6f 726d 616c 6c79 2c20  turns normally, 
+00013be0: 616e 6420 606e 6163 6b28 2960 2069 6620  and `nack()` if 
+00013bf0: 6974 2072 6169 7365 7320 616e 2065 7863  it raises an exc
+00013c00: 6570 7469 6f6e 2c5c 6e70 6572 6861 7073  eption,\nperhaps
+00013c10: 2072 6574 7279 696e 6720 7468 6520 6576   retrying the ev
+00013c20: 656e 7420 666f 7220 6120 6365 7274 6169  ent for a certai
+00013c30: 6e20 6e75 6d62 6572 206f 6620 7469 6d65  n number of time
+00013c40: 732c 2061 6e64 2074 6865 6e20 7061 726b  s, and then park
+00013c50: 696e 6720 7468 6520 6576 656e 742e 5c6e  ing the event.\n
+00013c60: 5c6e 5468 6520 7369 6d70 6c65 2065 7861  \nThe simple exa
+00013c70: 6d70 6c65 2062 656c 6f77 2073 686f 7773  mple below shows
+00013c80: 2068 6f77 2074 6869 7320 6d69 6768 7420   how this might 
+00013c90: 6265 2064 6f6e 652e 2057 6520 6361 6e20  be done. We can 
+00013ca0: 7365 6520 7468 6174 205c 2765 7665 6e74  see that \'event
+00013cb0: 3131 5c27 2069 735c 6e61 636b 6e6f 776c  11\' is\nacknowl
+00013cc0: 6564 6765 6420 6265 666f 7265 205c 2765  edged before \'e
+00013cd0: 7665 6e74 355c 2720 6973 2066 696e 616c  vent5\' is final
+00013ce0: 6c79 2070 6172 6b65 642e 5c6e 5c6e 5c6e  ly parked.\n\n\n
+00013cf0: 6060 6070 7974 686f 6e5c 6e61 636b 6564  ```python\nacked
+00013d00: 5f65 7665 6e74 7320 3d20 7b7d 5c6e 6e61  _events = {}\nna
+00013d10: 636b 6564 5f65 7665 6e74 7320 3d20 7b7d  cked_events = {}
+00013d20: 5c6e 5c6e 5c6e 636c 6173 7320 4578 616d  \n\n\nclass Exam
+00013d30: 706c 6543 6f6e 7375 6d65 723a 5c6e 2020  pleConsumer:\n  
+00013d40: 2020 6465 6620 5f5f 696e 6974 5f5f 2873    def __init__(s
+00013d50: 656c 662c 2073 7562 7363 7269 7074 696f  elf, subscriptio
+00013d60: 6e2c 206d 6178 5f72 6574 7269 6573 2c20  n, max_retries, 
+00013d70: 6669 6e61 6c5f 6163 7469 6f6e 293a 5c6e  final_action):\n
+00013d80: 2020 2020 2020 2020 7365 6c66 2e73 7562          self.sub
+00013d90: 7363 7269 7074 696f 6e20 3d20 7375 6273  scription = subs
+00013da0: 6372 6970 7469 6f6e 5c6e 2020 2020 2020  cription\n      
+00013db0: 2020 7365 6c66 2e6d 6178 5f72 6574 7269    self.max_retri
+00013dc0: 6573 203d 206d 6178 5f72 6574 7269 6573  es = max_retries
+00013dd0: 5c6e 2020 2020 2020 2020 7365 6c66 2e66  \n        self.f
+00013de0: 696e 616c 5f61 6374 696f 6e20 3d20 6669  inal_action = fi
+00013df0: 6e61 6c5f 6163 7469 6f6e 5c6e 2020 2020  nal_action\n    
+00013e00: 2020 2020 7365 6c66 2e65 7272 6f72 203d      self.error =
+00013e10: 204e 6f6e 655c 6e5c 6e20 2020 2064 6566   None\n\n    def
+00013e20: 2072 756e 2873 656c 6629 3a5c 6e20 2020   run(self):\n   
+00013e30: 2020 2020 2074 7279 3a5c 6e20 2020 2020       try:\n     
+00013e40: 2020 2020 2020 2066 6f72 2065 7665 6e74         for event
+00013e50: 2069 6e20 7365 6c66 2e73 7562 7363 7269   in self.subscri
+00013e60: 7074 696f 6e3a 5c6e 2020 2020 2020 2020  ption:\n        
+00013e70: 2020 2020 2020 2020 7472 793a 5c6e 2020          try:\n  
 00013e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013ec0: 2020 2020 2020 2020 7c5c 6e7c 204b 6565          |\n| Kee
-00013ed0: 7041 6c69 7665 5469 6d65 6f75 7420 2020  pAliveTimeout   
-00013ee0: 207c 2069 6e74 6567 6572 2028 6465 6661   | integer (defa
-00013ef0: 756c 743a 2060 4e6f 6e65 6029 2020 2020  ult: `None`)    
-00013f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013f20: 2020 2020 2020 2020 207c 2054 6865 2076           | The v
-00013f30: 616c 7565 206f 6620 7468 6520 2267 7270  alue of the "grp
-00013f40: 632e 6b65 6570 616c 6976 655f 7469 6d65  c.keepalive_time
-00013f50: 6f75 745f 6d73 2220 6752 5043 2063 6861  out_ms" gRPC cha
-00013f60: 6e6e 656c 206f 7074 696f 6e2e 2020 2020  nnel option.    
-00013f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013e90: 2020 7365 6c66 2e70 6f6c 6963 7928 6576    self.policy(ev
+00013ea0: 656e 7429 5c6e 2020 2020 2020 2020 2020  ent)\n          
+00013eb0: 2020 2020 2020 6578 6365 7074 2045 7863        except Exc
+00013ec0: 6570 7469 6f6e 3a5c 6e20 2020 2020 2020  eption:\n       
+00013ed0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00013ee0: 6576 656e 742e 7265 7472 795f 636f 756e  event.retry_coun
+00013ef0: 7420 3c20 7365 6c66 2e6d 6178 5f72 6574  t < self.max_ret
+00013f00: 7269 6573 3a5c 6e20 2020 2020 2020 2020  ries:\n         
+00013f10: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+00013f20: 6374 696f 6e20 3d20 2272 6574 7279 225c  ction = "retry"\
+00013f30: 6e20 2020 2020 2020 2020 2020 2020 2020  n               
+00013f40: 2020 2020 2065 6c73 653a 5c6e 2020 2020       else:\n    
+00013f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013f60: 2020 2020 6163 7469 6f6e 203d 2073 656c      action = sel
+00013f70: 662e 6669 6e61 6c5f 6163 7469 6f6e 5c6e  f.final_action\n
 00013f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013fc0: 2020 2020 2020 2020 2020 2020 207c 5c6e               |\n
-00013fd0: 5c6e 5c6e 4865 7265 2061 7265 2073 6f6d  \n\nHere are som
-00013fe0: 6520 6578 616d 706c 6573 206f 6620 4576  e examples of Ev
-00013ff0: 656e 7453 746f 7265 4442 2063 6f6e 6e65  entStoreDB conne
-00014000: 6374 696f 6e20 7374 7269 6e67 2055 5249  ction string URI
-00014010: 732e 5c6e 5c6e 2020 2020 2320 4765 7420  s.\n\n    # Get 
-00014020: 636c 7573 7465 7220 696e 666f 2066 726f  cluster info fro
-00014030: 6d20 7365 6375 7265 2073 6572 7665 7220  m secure server 
-00014040: 736f 636b 6574 206c 6f63 616c 686f 7374  socket localhost
-00014050: 3a32 3131 332c 5c6e 2020 2020 2320 616e  :2113,\n    # an
-00014060: 6420 7573 6520 2261 646d 696e 2220 616e  d use "admin" an
-00014070: 6420 2263 6861 6e67 6569 7422 2061 7320  d "changeit" as 
-00014080: 7573 6572 6e61 6d65 2061 6e64 2070 6173  username and pas
-00014090: 7377 6f72 645c 6e20 2020 2023 2077 6865  sword\n    # whe
-000140a0: 6e20 6d61 6b69 6e67 2063 616c 6c73 2074  n making calls t
-000140b0: 6f20 4576 656e 7453 746f 7265 4442 2041  o EventStoreDB A
-000140c0: 5049 206d 6574 686f 6473 2e5c 6e5c 6e20  PI methods.\n\n 
-000140d0: 2020 2065 7364 623a 2f2f 6164 6d69 6e3a     esdb://admin:
-000140e0: 6368 616e 6765 6974 406c 6f63 616c 686f  changeit@localho
-000140f0: 7374 3a32 3131 335c 6e5c 6e5c 6e20 2020  st:2113\n\n\n   
-00014100: 2023 2047 6574 2063 6c75 7374 6572 2069   # Get cluster i
-00014110: 6e66 6f20 6672 6f6d 2069 6e73 6563 7572  nfo from insecur
-00014120: 6520 7365 7276 6572 2073 6f63 6b65 7420  e server socket 
-00014130: 3132 372e 302e 302e 313a 3231 3134 5c6e  127.0.0.1:2114\n
-00014140: 5c6e 2020 2020 6573 6462 3a2f 2f31 3237  \n    esdb://127
-00014150: 2e30 2e30 2e31 3a32 3131 343f 546c 733d  .0.0.1:2114?Tls=
-00014160: 6661 6c73 655c 6e5c 6e5c 6e20 2020 2023  false\n\n\n    #
-00014170: 2047 6574 2063 6c75 7374 6572 2069 6e66   Get cluster inf
-00014180: 6f20 6672 6f6d 2061 6464 7265 7373 6573  o from addresses
-00014190: 2069 6e20 5c27 415c 2720 7265 636f 7264   in \'A\' record
-000141a0: 7320 666f 7220 636c 7573 7465 7231 2e65  s for cluster1.e
-000141b0: 7861 6d70 6c65 2e63 6f6d 2c5c 6e20 2020  xample.com,\n   
-000141c0: 2023 2061 6e64 2075 7365 2061 2064 6566   # and use a def
-000141d0: 6175 6c74 2064 6561 646c 696e 6520 666f  ault deadline fo
-000141e0: 7220 6d61 6b69 6e67 2063 616c 6c73 2074  r making calls t
-000141f0: 6f20 4576 656e 7453 746f 7265 2041 5049  o EventStore API
-00014200: 206d 6574 686f 642e 5c6e 5c6e 2020 2020   method.\n\n    
-00014210: 6573 6462 2b64 6973 636f 7665 723a 2f2f  esdb+discover://
-00014220: 6164 6d69 6e3a 6368 616e 6765 6974 4063  admin:changeit@c
-00014230: 6c75 7374 6572 312e 6578 616d 706c 652e  luster1.example.
-00014240: 636f 6d3f 4465 6661 756c 7444 6561 646c  com?DefaultDeadl
-00014250: 696e 653d 355c 6e5c 6e5c 6e20 2020 2023  ine=5\n\n\n    #
-00014260: 2047 6574 2063 6c75 7374 6572 2069 6e66   Get cluster inf
-00014270: 6f20 6672 6f6d 2065 6974 6865 7220 6c6f  o from either lo
-00014280: 6361 6c68 6f73 743a 3231 3131 206f 7220  calhost:2111 or 
-00014290: 6c6f 6361 6c68 6f73 743a 3231 3132 206f  localhost:2112 o
-000142a0: 725c 6e20 2020 2023 206c 6f63 616c 686f  r\n    # localho
-000142b0: 7374 3a32 3131 332c 2061 6e64 2074 6865  st:2113, and the
-000142c0: 6e20 636f 6e6e 6563 7420 746f 2061 2066  n connect to a f
-000142d0: 6f6c 6c6f 7765 7220 6e6f 6465 2069 6e20  ollower node in 
-000142e0: 7468 6520 636c 7573 7465 722e 5c6e 5c6e  the cluster.\n\n
-000142f0: 2020 2020 6573 6462 3a2f 2f61 646d 696e      esdb://admin
-00014300: 3a63 6861 6e67 6569 7440 6c6f 6361 6c68  :changeit@localh
-00014310: 6f73 743a 3231 3131 2c6c 6f63 616c 686f  ost:2111,localho
-00014320: 7374 3a32 3131 322c 6c6f 6361 6c68 6f73  st:2112,localhos
-00014330: 743a 3231 3133 3f4e 6f64 6550 7265 6665  t:2113?NodePrefe
-00014340: 7265 6e63 653d 666f 6c6c 6f77 6572 5c6e  rence=follower\n
-00014350: 5c6e 5c6e 2020 2020 2320 4765 7420 636c  \n\n    # Get cl
-00014360: 7573 7465 7220 696e 666f 2066 726f 6d20  uster info from 
-00014370: 6164 6472 6573 7365 7320 696e 205c 2741  addresses in \'A
-00014380: 5c27 2072 6563 6f72 6473 2066 6f72 2063  \' records for c
-00014390: 6c75 7374 6572 312e 6578 616d 706c 652e  luster1.example.
-000143a0: 636f 6d2c 5c6e 2020 2020 2320 616e 6420  com,\n    # and 
-000143b0: 636f 6e66 6967 7572 6520 226b 6565 7020  configure "keep 
-000143c0: 616c 6976 6522 2074 696d 656f 7574 2061  alive" timeout a
-000143d0: 6e64 2069 6e74 6572 7661 6c20 696e 2074  nd interval in t
-000143e0: 6865 2067 5250 4320 6368 616e 6e65 6c2e  he gRPC channel.
-000143f0: 5c6e 5c6e 2020 2020 6573 6462 2b64 6973  \n\n    esdb+dis
-00014400: 636f 7665 723a 2f2f 6164 6d69 6e3a 6368  cover://admin:ch
-00014410: 616e 6765 6974 4063 6c75 7374 6572 312e  angeit@cluster1.
-00014420: 6578 616d 706c 652e 636f 6d3f 4b65 6570  example.com?Keep
-00014430: 416c 6976 6549 6e74 6572 7661 6c3d 3130  AliveInterval=10
-00014440: 3030 3026 4b65 6570 416c 6976 6554 696d  000&KeepAliveTim
-00014450: 656f 7574 3d31 3030 3030 5c6e 5c6e 5c6e  eout=10000\n\n\n
-00014460: 506c 6561 7365 206e 6f74 652c 2074 6865  Please note, the
-00014470: 2063 6c69 656e 7420 6973 2069 6e73 656e   client is insen
-00014480: 7369 7469 7665 2074 6f20 7468 6520 6361  sitive to the ca
-00014490: 7365 206f 6620 6669 656c 6473 2061 6e64  se of fields and
-000144a0: 2076 616c 7565 732e 2049 6620 6669 656c   values. If fiel
-000144b0: 6473 2061 7265 5c6e 7265 7065 6174 6564  ds are\nrepeated
-000144c0: 2069 6e20 7468 6520 7175 6572 7920 7374   in the query st
-000144d0: 7269 6e67 2c20 7468 6520 7175 6572 7920  ring, the query 
-000144e0: 7374 7269 6e67 2077 696c 6c20 6265 2070  string will be p
-000144f0: 6172 7365 6420 7769 7468 6f75 7420 6572  arsed without er
-00014500: 726f 722e 2048 6f77 6576 6572 2c5c 6e74  ror. However,\nt
-00014510: 6865 2063 6f6e 6e65 6374 696f 6e20 6f70  he connection op
-00014520: 7469 6f6e 7320 7573 6564 2062 7920 7468  tions used by th
-00014530: 6520 636c 6965 6e74 2077 696c 6c20 7573  e client will us
-00014540: 6520 7468 6520 7661 6c75 6520 6f66 2074  e the value of t
-00014550: 6865 2066 6972 7374 2066 6965 6c64 2e20  he first field. 
-00014560: 416c 6c5c 6e74 6865 206f 7468 6572 2066  All\nthe other f
-00014570: 6965 6c64 2d76 616c 7565 7320 696e 2074  ield-values in t
-00014580: 6865 2071 7565 7279 2073 7472 696e 6720  he query string 
-00014590: 7769 7468 2074 6865 2073 616d 6520 6669  with the same fi
-000145a0: 656c 6420 6e61 6d65 2077 696c 6c20 6265  eld name will be
-000145b0: 2069 676e 6f72 6564 2e5c 6e46 6965 6c64   ignored.\nField
-000145c0: 7320 7769 7468 6f75 7420 7661 6c75 6573  s without values
-000145d0: 2077 696c 6c20 616c 736f 2062 6520 6967   will also be ig
-000145e0: 6e6f 7265 642e 5c6e 5c6e 4966 2074 6865  nored.\n\nIf the
-000145f0: 2063 6c69 656e 745c 2773 206e 6f64 6520   client\'s node 
-00014600: 7072 6566 6572 656e 6365 2069 7320 226c  preference is "l
-00014610: 6561 6465 7222 2061 6e64 2074 6865 206e  eader" and the n
-00014620: 6f64 6520 6265 636f 6d65 7320 615c 6e22  ode becomes a\n"
-00014630: 666f 6c6c 6f77 6572 222c 2074 6865 2063  follower", the c
-00014640: 6c69 656e 7420 7769 6c6c 2061 7474 656d  lient will attem
-00014650: 7074 2074 6f20 7265 636f 6e6e 6563 7420  pt to reconnect 
-00014660: 746f 2074 6865 2063 7572 7265 6e74 206c  to the current l
-00014670: 6561 6465 7220 7768 656e 2061 206d 6574  eader when a met
-00014680: 686f 645c 6e69 7320 6361 6c6c 6564 2074  hod\nis called t
-00014690: 6861 7420 6578 7065 6374 7320 746f 2063  hat expects to c
-000146a0: 616c 6c20 6120 6c65 6164 6572 2e20 4d65  all a leader. Me
-000146b0: 7468 6f64 7320 7768 6963 6820 6d75 7461  thods which muta
-000146c0: 7465 2074 6865 2073 7461 7465 206f 6620  te the state of 
-000146d0: 7468 6520 6461 7461 6261 7365 5c6e 6578  the database\nex
-000146e0: 7065 6374 2074 6f20 6361 6c6c 2061 206c  pect to call a l
-000146f0: 6561 6465 722e 2046 6f72 2073 7563 6820  eader. For such 
-00014700: 6d65 7468 6f64 732c 2074 6865 2048 5454  methods, the HTT
-00014710: 5020 6865 6164 6572 2272 6571 7569 7265  P header"require
-00014720: 732d 6c65 6164 6572 2220 6973 2073 6574  s-leader" is set
-00014730: 2074 6f5c 6e22 7472 7565 222c 2061 6e64   to\n"true", and
-00014740: 2074 6869 7320 6865 6164 6572 2069 7320   this header is 
-00014750: 6f62 7365 7276 6564 2062 7920 7468 6520  observed by the 
-00014760: 7365 7276 6572 2c20 616e 6420 736f 2061  server, and so a
-00014770: 206e 6f64 6520 7768 6963 6820 6973 206e   node which is n
-00014780: 6f74 2061 206c 6561 6465 725c 6e74 6861  ot a leader\ntha
-00014790: 7420 7265 6365 6976 6573 2073 7563 6820  t receives such 
-000147a0: 6120 7265 7175 6573 7420 7769 6c6c 2072  a request will r
-000147b0: 6574 7572 6e20 616e 2065 7272 6f72 2e20  eturn an error. 
-000147c0: 5468 6973 2065 7272 6f72 2069 7320 6465  This error is de
-000147d0: 7465 6374 6564 2062 7920 7468 6520 636c  tected by the cl
-000147e0: 6965 6e74 2c5c 6e77 6869 6368 2077 696c  ient,\nwhich wil
-000147f0: 6c20 7468 656e 2063 6c6f 7365 2074 6865  l then close the
-00014800: 2063 7572 7265 6e74 2067 5250 4320 636f   current gRPC co
-00014810: 6e6e 6563 7469 6f6e 2061 6e64 2063 7265  nnection and cre
-00014820: 6174 6520 6120 6e65 7720 636f 6e6e 6563  ate a new connec
-00014830: 7469 6f6e 2074 6f20 7468 655c 6e6c 6561  tion to the\nlea
-00014840: 6465 722e 2054 6865 2072 6571 7565 7374  der. The request
-00014850: 2077 696c 6c20 7468 656e 2062 6520 7265   will then be re
-00014860: 7472 6965 6420 7769 7468 2074 6865 206c  tried with the l
-00014870: 6561 6465 722e 5c6e 5c6e 4966 2074 6865  eader.\n\nIf the
-00014880: 2063 6c69 656e 745c 2773 206e 6f64 6520   client\'s node 
-00014890: 7072 6566 6572 656e 6365 2069 7320 2266  preference is "f
-000148a0: 6f6c 6c6f 7765 7222 2061 6e64 2074 6865  ollower" and the
-000148b0: 7265 2061 7265 206e 6f20 666f 6c6c 6f77  re are no follow
-000148c0: 6572 5c6e 6e6f 6465 7320 696e 2074 6865  er\nnodes in the
-000148d0: 2063 6c75 7374 6572 2c20 7468 656e 2074   cluster, then t
-000148e0: 6865 2063 6c69 656e 7420 7769 6c6c 2072  he client will r
-000148f0: 6169 7365 2061 6e20 6578 6365 7074 696f  aise an exceptio
-00014900: 6e2e 2053 696d 696c 6172 6c79 2c20 6966  n. Similarly, if
-00014910: 2074 6865 5c6e 636c 6965 6e74 5c27 7320   the\nclient\'s 
-00014920: 6e6f 6465 2070 7265 6665 7265 6e63 6520  node preference 
-00014930: 6973 2022 7265 6164 6f6e 6c79 7265 706c  is "readonlyrepl
-00014940: 6963 6122 2061 6e64 2074 6865 7265 2061  ica" and there a
-00014950: 7265 206e 6f20 7265 6164 2d6f 6e6c 7920  re no read-only 
-00014960: 7265 706c 6963 615c 6e6e 6f64 6573 2069  replica\nnodes i
-00014970: 6e20 7468 6520 636c 7573 7465 722c 2074  n the cluster, t
-00014980: 6865 6e20 7468 6520 636c 6965 6e74 2077  hen the client w
-00014990: 696c 6c20 616c 736f 2072 6169 7365 2061  ill also raise a
-000149a0: 6e20 6578 6365 7074 696f 6e2e 5c6e 5c6e  n exception.\n\n
-000149b0: 5468 6520 6752 5043 2063 6861 6e6e 656c  The gRPC channel
-000149c0: 206f 7074 696f 6e20 2267 7270 632e 6d61   option "grpc.ma
-000149d0: 785f 7265 6365 6976 655f 6d65 7373 6167  x_receive_messag
-000149e0: 655f 6c65 6e67 7468 2220 6973 2061 7574  e_length" is aut
-000149f0: 6f6d 6174 6963 616c 6c79 5c6e 636f 6e66  omatically\nconf
-00014a00: 6967 7572 6564 2074 6f20 7468 6520 7661  igured to the va
-00014a10: 6c75 6520 6031 3720 2a20 3130 3234 202a  lue `17 * 1024 *
-00014a20: 2031 3032 3460 2e20 5468 6973 2076 616c   1024`. This val
-00014a30: 7565 2063 616e 6e6f 7420 6265 2063 6861  ue cannot be cha
-00014a40: 6e67 6564 2e5c 6e5c 6e5c 6e23 2323 2052  nged.\n\n\n### R
-00014a50: 6567 756c 6172 2065 7870 7265 7373 696f  egular expressio
-00014a60: 6e20 6669 6c74 6572 735c 6e5c 6e54 6865  n filters\n\nThe
-00014a70: 2066 696c 7465 7220 6172 6775 6d65 6e74   filter argument
-00014a80: 7320 696e 2060 7265 6164 5f61 6c6c 5f65  s in `read_all_e
-00014a90: 7665 6e74 7328 2960 2c20 6073 7562 7363  vents()`, `subsc
-00014aa0: 7269 6265 5f61 6c6c 5f65 7665 6e74 7328  ribe_all_events(
-00014ab0: 2960 2c5c 6e60 6372 6561 7465 5f73 7562  )`,\n`create_sub
-00014ac0: 7363 7269 7074 696f 6e28 2960 2061 6e64  scription()` and
-00014ad0: 2060 6765 745f 636f 6d6d 6974 5f70 6f73   `get_commit_pos
-00014ae0: 6974 696f 6e28 2960 2061 7265 2061 7070  ition()` are app
-00014af0: 6c69 6564 2074 6f20 7468 6520 6074 7970  lied to the `typ
-00014b00: 6560 5c6e 6174 7472 6962 7574 6520 6f66  e`\nattribute of
-00014b10: 2072 6563 6f72 6465 6420 6576 656e 7473   recorded events
-00014b20: 2e5c 6e5c 6e54 6865 2064 6566 6175 6c74  .\n\nThe default
-00014b30: 2076 616c 7565 206f 6620 7468 6520 6066   value of the `f
-00014b40: 696c 7465 725f 6578 636c 7564 6560 2061  ilter_exclude` a
-00014b50: 7267 756d 656e 7473 2069 7320 6465 7369  rguments is desi
-00014b60: 676e 6564 2074 6f20 6578 636c 7564 655c  gned to exclude\
-00014b70: 6e45 7665 6e74 5374 6f72 6544 4220 2273  nEventStoreDB "s
-00014b80: 7973 7465 6d22 2061 6e64 2022 7065 7273  ystem" and "pers
-00014b90: 6973 7465 6e63 6520 7375 6273 6372 6970  istence subscrip
-00014ba0: 7469 6f6e 2063 6f6e 6669 6722 2065 7665  tion config" eve
-00014bb0: 6e74 732c 2077 6869 6368 5c6e 6f74 6865  nts, which\nothe
-00014bc0: 7277 6973 6520 776f 756c 6420 6265 2069  rwise would be i
-00014bd0: 6e63 6c75 6465 642e 2053 7973 7465 6d20  ncluded. System 
-00014be0: 6576 656e 7473 2067 656e 6572 6174 6564  events generated
-00014bf0: 2062 7920 4576 656e 7453 746f 7265 4442   by EventStoreDB
-00014c00: 2061 6c6c 5c6e 6861 7665 2060 7479 7065   all\nhave `type
-00014c10: 6020 7374 7269 6e67 7320 7468 6174 2073  ` strings that s
-00014c20: 7461 7274 2077 6974 6820 7468 6520 6024  tart with the `$
-00014c30: 6020 7369 676e 2e20 5065 7273 6973 7465  ` sign. Persiste
-00014c40: 6e63 6520 7375 6273 6372 6970 7469 6f6e  nce subscription
-00014c50: 5c6e 6576 656e 7473 2067 656e 6572 6174  \nevents generat
-00014c60: 6564 2077 6865 6e20 6d61 6e69 7075 6c61  ed when manipula
-00014c70: 7469 6e67 2070 6572 7369 7374 656e 6365  ting persistence
-00014c80: 2073 7562 7363 7269 7074 696f 6e73 2061   subscriptions a
-00014c90: 6c6c 2068 6176 6520 6074 7970 6560 5c6e  ll have `type`\n
-00014ca0: 7374 7269 6e67 7320 7468 6174 2073 7461  strings that sta
-00014cb0: 7274 2077 6974 6820 6050 6572 7369 7374  rt with `Persist
-00014cc0: 656e 7443 6f6e 6669 6760 2e5c 6e5c 6e46  entConfig`.\n\nF
-00014cd0: 6f72 2065 7861 6d70 6c65 2c20 746f 206d  or example, to m
-00014ce0: 6174 6368 2074 6865 2074 7970 6520 6f66  atch the type of
-00014cf0: 2045 7665 6e74 5374 6f72 6544 4220 7379   EventStoreDB sy
-00014d00: 7374 656d 2065 7665 6e74 732c 2075 7365  stem events, use
-00014d10: 2074 6865 2072 6567 756c 6172 5c6e 6578   the regular\nex
-00014d20: 7072 6573 7369 6f6e 2060 725c 275c 5c24  pression `r\'\\$
-00014d30: 2e2b 5c27 602e 2050 6c65 6173 6520 6e6f  .+\'`. Please no
-00014d40: 7465 2c20 7468 6520 636f 6e73 7461 6e74  te, the constant
-00014d50: 2060 4553 4442 5f53 5953 5445 4d5f 4556   `ESDB_SYSTEM_EV
-00014d60: 454e 5453 5f52 4547 4558 6020 6973 5c6e  ENTS_REGEX` is\n
-00014d70: 7365 7420 746f 2060 725c 275c 5c24 2e2b  set to `r\'\\$.+
-00014d80: 5c27 602e 2059 6f75 2063 616e 2069 6d70  \'`. You can imp
-00014d90: 6f72 7420 7468 6973 2076 616c 7565 5c6e  ort this value\n
-00014da0: 2860 6672 6f6d 2065 7364 6263 6c69 656e  (`from esdbclien
-00014db0: 7420 696d 706f 7274 2045 5344 425f 5359  t import ESDB_SY
-00014dc0: 5354 454d 5f45 5645 4e54 535f 5245 4745  STEM_EVENTS_REGE
-00014dd0: 5860 2920 616e 6420 7573 655c 6e69 7420  X`) and use\nit 
-00014de0: 7768 656e 2062 7569 6c64 696e 6720 6c6f  when building lo
-00014df0: 6e67 6572 2073 6571 7565 6e63 6573 206f  nger sequences o
-00014e00: 6620 7265 6775 6c61 7220 6578 7072 6573  f regular expres
-00014e10: 7369 6f6e 732e 5c6e 5c6e 5369 6d69 6c61  sions.\n\nSimila
-00014e20: 726c 792c 2074 6f20 6d61 7463 6820 7468  rly, to match th
-00014e30: 6520 7479 7065 206f 6620 4576 656e 7453  e type of EventS
-00014e40: 746f 7265 4442 2070 6572 7369 7374 656e  toreDB persisten
-00014e50: 6365 2073 7562 7363 7269 7074 696f 6e20  ce subscription 
-00014e60: 6576 656e 7473 2c20 7573 6520 7468 655c  events, use the\
-00014e70: 6e72 6567 756c 6172 2065 7870 7265 7373  nregular express
-00014e80: 696f 6e20 6072 5c27 5065 7273 6973 7465  ion `r\'Persiste
-00014e90: 6e74 436f 6e66 6967 5c5c 642b 5c27 602e  ntConfig\\d+\'`.
-00014ea0: 2054 6865 2063 6f6e 7374 616e 7420 6045   The constant `E
-00014eb0: 5344 425f 5045 5253 4953 5445 4e54 5f43  SDB_PERSISTENT_C
-00014ec0: 4f4e 4649 475f 4556 454e 5453 5f52 4547  ONFIG_EVENTS_REG
-00014ed0: 4558 605c 6e69 7320 7365 7420 746f 2060  EX`\nis set to `
-00014ee0: 725c 2750 6572 7369 7374 656e 7443 6f6e  r\'PersistentCon
-00014ef0: 6669 675c 5c64 2b5c 2760 2e20 596f 7520  fig\\d+\'`. You 
-00014f00: 6361 6e20 616c 736f 2069 6d70 6f72 7420  can also import 
-00014f10: 7468 6973 2076 616c 7565 5c6e 2860 6672  this value\n(`fr
-00014f20: 6f6d 2065 7364 6263 6c69 656e 7420 696d  om esdbclient im
-00014f30: 706f 7274 2045 5344 425f 5045 5253 4953  port ESDB_PERSIS
-00014f40: 5445 4e54 5f43 4f4e 4649 475f 4556 454e  TENT_CONFIG_EVEN
-00014f50: 5453 5f52 4547 4558 6029 2061 6e64 2075  TS_REGEX`) and u
-00014f60: 7365 2069 7420 7768 656e 2062 7569 6c64  se it when build
-00014f70: 696e 675c 6e6c 6f6e 6765 7220 7365 7175  ing\nlonger sequ
-00014f80: 656e 6365 7320 6f66 2072 6567 756c 6172  ences of regular
-00014f90: 2065 7870 7265 7373 696f 6e73 2e5c 6e5c   expressions.\n\
-00014fa0: 6e54 6865 2063 6f6e 7374 616e 7420 6044  nThe constant `D
-00014fb0: 4546 4155 4c54 5f45 5843 4c55 4445 5f46  EFAULT_EXCLUDE_F
-00014fc0: 494c 5445 5260 2069 7320 6120 7365 7175  ILTER` is a sequ
-00014fd0: 656e 6365 206f 6620 7265 6775 6c61 7220  ence of regular 
-00014fe0: 6578 7072 6573 7369 6f6e 7320 7468 6174  expressions that
-00014ff0: 206d 6174 6368 5c6e 7468 6520 6576 656e   match\nthe even
-00015000: 7473 2074 6861 7420 4576 656e 7453 746f  ts that EventSto
-00015010: 7265 4442 2067 656e 6572 6174 6573 2069  reDB generates i
-00015020: 6e74 6572 6e61 6c6c 792c 2065 7665 6e74  nternally, event
-00015030: 7320 7468 6174 2061 7265 2065 7874 7261  s that are extra
-00015040: 6e65 6f75 7320 746f 2074 686f 7365 5c6e  neous to those\n
-00015050: 7768 6963 6820 796f 7520 6170 7065 6e64  which you append
-00015060: 2075 7369 6e67 2074 6865 2060 6170 7065   using the `appe
-00015070: 6e64 5f65 7665 6e74 7328 2960 206d 6574  nd_events()` met
-00015080: 686f 642e 5c6e 5c6e 466f 7220 6578 616d  hod.\n\nFor exam
-00015090: 706c 652c 2074 6f20 6578 636c 7564 6520  ple, to exclude 
-000150a0: 7379 7374 656d 2065 7665 6e74 7320 616e  system events an
-000150b0: 6420 7065 7273 6973 7465 6e63 6520 7375  d persistence su
-000150c0: 6273 6372 6970 7469 6f6e 2063 6f6e 6669  bscription confi
-000150d0: 6775 7261 7469 6f6e 2065 7665 6e74 732c  guration events,
-000150e0: 5c6e 616e 6420 736e 6170 7368 6f74 732c  \nand snapshots,
-000150f0: 2079 6f75 206d 6967 6874 2075 7365 2074   you might use t
-00015100: 6865 2073 6571 7565 6e63 6520 6044 4546  he sequence `DEF
-00015110: 4155 4c54 5f45 5843 4c55 4445 5f46 494c  AULT_EXCLUDE_FIL
-00015120: 5445 5220 2b20 5b5c 272e 2a53 6e61 7073  TER + [\'.*Snaps
-00015130: 686f 745c 275d 6020 6173 5c6e 7468 6520  hot\']` as\nthe 
-00015140: 7661 6c75 6520 6f66 2074 6865 2060 6669  value of the `fi
-00015150: 6c74 6572 5f65 7863 6c75 6465 6020 6172  lter_exclude` ar
-00015160: 6775 6d65 6e74 2077 6865 6e20 6361 6c6c  gument when call
-00015170: 696e 6720 6072 6561 645f 616c 6c5f 6576  ing `read_all_ev
-00015180: 656e 7473 2829 602c 5c6e 6073 7562 7363  ents()`,\n`subsc
-00015190: 7269 6265 5f61 6c6c 5f65 7665 6e74 7328  ribe_all_events(
-000151a0: 2960 2c20 6063 7265 6174 655f 7375 6273  )`, `create_subs
-000151b0: 6372 6970 7469 6f6e 2829 6020 6f72 2060  cription()` or `
-000151c0: 6765 745f 636f 6d6d 6974 5f70 6f73 6974  get_commit_posit
-000151d0: 696f 6e28 2960 2e5c 6e5c 6e23 2323 204e  ion()`.\n\n### N
-000151e0: 6577 2065 7665 6e74 206f 626a 6563 7473  ew event objects
-000151f0: 5c6e 5c6e 5468 6520 604e 6577 4576 656e  \n\nThe `NewEven
-00015200: 7460 2063 6c61 7373 2069 7320 7573 6564  t` class is used
-00015210: 2077 6865 6e20 6170 7065 6e64 696e 6720   when appending 
-00015220: 6576 656e 7473 2e5c 6e5c 6e54 6865 2072  events.\n\nThe r
-00015230: 6571 7569 7265 6420 6172 6775 6d65 6e74  equired argument
-00015240: 2060 7479 7065 6020 6973 2061 2050 7974   `type` is a Pyt
-00015250: 686f 6e20 6073 7472 602c 2075 7365 6420  hon `str`, used 
-00015260: 746f 2069 6e64 6963 6174 6520 7468 6520  to indicate the 
-00015270: 7479 7065 206f 665c 6e74 6865 2065 7665  type of\nthe eve
-00015280: 6e74 2074 6861 7420 7769 6c6c 2062 6520  nt that will be 
-00015290: 7265 636f 7264 6564 2e5c 6e5c 6e54 6865  recorded.\n\nThe
-000152a0: 2072 6571 7569 7265 6420 6172 6775 6d65   required argume
-000152b0: 6e74 2060 6461 7461 6020 6973 2061 2050  nt `data` is a P
-000152c0: 7974 686f 6e20 6062 7974 6573 6020 6f62  ython `bytes` ob
-000152d0: 6a65 6374 2c20 7573 6564 2074 6f20 696e  ject, used to in
-000152e0: 6469 6361 7465 2074 6865 2064 6174 6120  dicate the data 
-000152f0: 6f66 5c6e 7468 6520 6576 656e 7420 7468  of\nthe event th
-00015300: 6174 2077 696c 6c20 6265 2072 6563 6f72  at will be recor
-00015310: 6465 642e 5c6e 5c6e 5468 6520 6f70 7469  ded.\n\nThe opti
-00015320: 6f6e 616c 2061 7267 756d 656e 7420 606d  onal argument `m
-00015330: 6574 6164 6174 6160 2069 7320 6120 5079  etadata` is a Py
-00015340: 7468 6f6e 2060 6279 7465 7360 206f 626a  thon `bytes` obj
-00015350: 6563 742c 2075 7365 6420 746f 2069 6e64  ect, used to ind
-00015360: 6963 6174 6520 616e 795c 6e6d 6574 6164  icate any\nmetad
-00015370: 6174 6120 6f66 2074 6865 2065 7665 6e74  ata of the event
-00015380: 2074 6861 7420 7769 6c6c 2062 6520 7265   that will be re
-00015390: 636f 7264 6564 2e20 5468 6520 6465 6661  corded. The defa
-000153a0: 756c 7420 7661 6c75 6520 6973 2061 6e20  ult value is an 
-000153b0: 656d 7074 7920 6062 7974 6573 605c 6e6f  empty `bytes`\no
-000153c0: 626a 6563 742e 5c6e 5c6e 5468 6520 6f70  bject.\n\nThe op
-000153d0: 7469 6f6e 616c 2061 7267 756d 656e 7420  tional argument 
-000153e0: 6063 6f6e 7465 6e74 5f74 7970 6560 2069  `content_type` i
-000153f0: 7320 6120 5079 7468 6f6e 2060 7374 7260  s a Python `str`
-00015400: 2c20 7573 6564 2074 6f20 696e 6469 6361  , used to indica
-00015410: 7465 2074 6865 5c6e 7479 7065 206f 6620  te the\ntype of 
-00015420: 7468 6520 6461 7461 2074 6861 7420 7769  the data that wi
-00015430: 6c6c 2062 6520 7265 636f 7264 6564 2066  ll be recorded f
-00015440: 6f72 2074 6869 7320 6576 656e 742e 2054  or this event. T
-00015450: 6865 2064 6566 6175 6c74 2076 616c 7565  he default value
-00015460: 2069 735c 6e60 6170 706c 6963 6174 696f   is\n`applicatio
-00015470: 6e2f 6a73 6f6e 602c 2077 6869 6368 2069  n/json`, which i
-00015480: 6e64 6963 6174 6573 2074 6861 7420 7468  ndicates that th
-00015490: 6520 6064 6174 6160 2077 6173 2073 6572  e `data` was ser
-000154a0: 6961 6c69 7365 6420 7573 696e 6720 4a53  ialised using JS
-000154b0: 4f4e 2e5c 6e41 6e20 616c 7465 726e 6174  ON.\nAn alternat
-000154c0: 6976 6520 7661 6c75 6520 666f 7220 7468  ive value for th
-000154d0: 6973 2061 7267 756d 656e 7420 6973 2060  is argument is `
-000154e0: 6170 706c 6963 6174 696f 6e2f 6f63 7465  application/octe
-000154f0: 742d 7374 7265 616d 602e 5c6e 5c6e 5468  t-stream`.\n\nTh
-00015500: 6520 6f70 7469 6f6e 616c 2061 7267 756d  e optional argum
-00015510: 656e 7420 6069 6460 2069 7320 6120 5079  ent `id` is a Py
-00015520: 7468 6f6e 2060 5555 4944 6020 6f62 6a65  thon `UUID` obje
-00015530: 6374 2c20 7573 6564 2074 6f20 7370 6563  ct, used to spec
-00015540: 6966 7920 7468 6520 756e 6971 7565 2049  ify the unique I
-00015550: 445c 6e6f 6620 7468 6520 6576 656e 7420  D\nof the event 
-00015560: 7468 6174 2077 696c 6c20 6265 2072 6563  that will be rec
-00015570: 6f72 6465 642e 2054 6869 7320 7661 6c75  orded. This valu
-00015580: 6520 7769 6c6c 2064 6566 6175 6c74 2074  e will default t
-00015590: 6f20 6120 6e65 7720 7665 7273 696f 6e2d  o a new version-
-000155a0: 3420 5555 4944 2e5c 6e5c 6e60 6060 7079  4 UUID.\n\n```py
-000155b0: 7468 6f6e 5c6e 6e65 775f 6576 656e 7431  thon\nnew_event1
-000155c0: 203d 204e 6577 4576 656e 7428 5c6e 2020   = NewEvent(\n  
-000155d0: 2020 7479 7065 3d5c 274f 7264 6572 4372    type=\'OrderCr
-000155e0: 6561 7465 645c 272c 5c6e 2020 2020 6461  eated\',\n    da
-000155f0: 7461 3d62 5c27 7b22 6e61 6d65 223a 2022  ta=b\'{"name": "
-00015600: 4772 6567 227d 5c27 2c5c 6e29 5c6e 6173  Greg"}\',\n)\nas
-00015610: 7365 7274 206e 6577 5f65 7665 6e74 312e  sert new_event1.
-00015620: 7479 7065 203d 3d20 5c27 4f72 6465 7243  type == \'OrderC
-00015630: 7265 6174 6564 5c27 5c6e 6173 7365 7274  reated\'\nassert
-00015640: 206e 6577 5f65 7665 6e74 312e 6461 7461   new_event1.data
-00015650: 203d 3d20 625c 277b 226e 616d 6522 3a20   == b\'{"name": 
-00015660: 2247 7265 6722 7d5c 275c 6e61 7373 6572  "Greg"}\'\nasser
-00015670: 7420 6e65 775f 6576 656e 7431 2e6d 6574  t new_event1.met
-00015680: 6164 6174 6120 3d3d 2062 5c27 5c27 5c6e  adata == b\'\'\n
-00015690: 6173 7365 7274 206e 6577 5f65 7665 6e74  assert new_event
-000156a0: 312e 636f 6e74 656e 745f 7479 7065 203d  1.content_type =
-000156b0: 3d20 5c27 6170 706c 6963 6174 696f 6e2f  = \'application/
-000156c0: 6a73 6f6e 5c27 5c6e 6173 7365 7274 2069  json\'\nassert i
-000156d0: 7369 6e73 7461 6e63 6528 6e65 775f 6576  sinstance(new_ev
-000156e0: 656e 7431 2e69 642c 2055 5549 4429 5c6e  ent1.id, UUID)\n
-000156f0: 5c6e 6576 656e 745f 6964 203d 2075 7569  \nevent_id = uui
-00015700: 6434 2829 5c6e 6e65 775f 6576 656e 7432  d4()\nnew_event2
-00015710: 203d 204e 6577 4576 656e 7428 5c6e 2020   = NewEvent(\n  
-00015720: 2020 7479 7065 3d5c 2749 6d61 6765 4372    type=\'ImageCr
-00015730: 6561 7465 645c 272c 5c6e 2020 2020 6461  eated\',\n    da
-00015740: 7461 3d62 5c27 3031 3031 3031 3031 3031  ta=b\'0101010101
-00015750: 3031 3031 5c27 2c5c 6e20 2020 206d 6574  0101\',\n    met
-00015760: 6164 6174 613d 625c 277b 2261 223a 2031  adata=b\'{"a": 1
-00015770: 7d5c 272c 5c6e 2020 2020 636f 6e74 656e  }\',\n    conten
-00015780: 745f 7479 7065 3d5c 2761 7070 6c69 6361  t_type=\'applica
-00015790: 7469 6f6e 2f6f 6374 6574 2d73 7472 6561  tion/octet-strea
-000157a0: 6d5c 272c 5c6e 2020 2020 6964 3d65 7665  m\',\n    id=eve
-000157b0: 6e74 5f69 642c 5c6e 295c 6e61 7373 6572  nt_id,\n)\nasser
-000157c0: 7420 6e65 775f 6576 656e 7432 2e74 7970  t new_event2.typ
-000157d0: 6520 3d3d 205c 2749 6d61 6765 4372 6561  e == \'ImageCrea
-000157e0: 7465 645c 275c 6e61 7373 6572 7420 6e65  ted\'\nassert ne
-000157f0: 775f 6576 656e 7432 2e64 6174 6120 3d3d  w_event2.data ==
-00015800: 2062 5c27 3031 3031 3031 3031 3031 3031   b\'010101010101
-00015810: 3031 5c27 5c6e 6173 7365 7274 206e 6577  01\'\nassert new
-00015820: 5f65 7665 6e74 322e 6d65 7461 6461 7461  _event2.metadata
-00015830: 203d 3d20 625c 277b 2261 223a 2031 7d5c   == b\'{"a": 1}\
-00015840: 275c 6e61 7373 6572 7420 6e65 775f 6576  '\nassert new_ev
-00015850: 656e 7432 2e63 6f6e 7465 6e74 5f74 7970  ent2.content_typ
-00015860: 6520 3d3d 205c 2761 7070 6c69 6361 7469  e == \'applicati
-00015870: 6f6e 2f6f 6374 6574 2d73 7472 6561 6d5c  on/octet-stream\
-00015880: 275c 6e61 7373 6572 7420 6e65 775f 6576  '\nassert new_ev
-00015890: 656e 7432 2e69 6420 3d3d 2065 7665 6e74  ent2.id == event
-000158a0: 5f69 645c 6e60 6060 5c6e 5c6e 2323 2320  _id\n```\n\n### 
-000158b0: 5265 636f 7264 6564 2065 7665 6e74 206f  Recorded event o
-000158c0: 626a 6563 7473 5c6e 5c6e 5468 6520 6052  bjects\n\nThe `R
-000158d0: 6563 6f72 6465 6445 7665 6e74 6020 636c  ecordedEvent` cl
-000158e0: 6173 7320 6973 2075 7365 6420 7768 656e  ass is used when
-000158f0: 2072 6561 6469 6e67 2065 7665 6e74 732e   reading events.
-00015900: 5c6e 5c6e 5468 6520 6174 7472 6962 7574  \n\nThe attribut
-00015910: 6520 6074 7970 6560 2069 7320 6120 5079  e `type` is a Py
-00015920: 7468 6f6e 2060 7374 7260 2c20 7573 6564  thon `str`, used
-00015930: 2074 6f20 696e 6469 6361 7465 2074 6865   to indicate the
-00015940: 2074 7970 6520 6f66 2065 7665 6e74 5c6e   type of event\n
-00015950: 7468 6174 2077 6173 2072 6563 6f72 6465  that was recorde
-00015960: 642e 5c6e 5c6e 5468 6520 6174 7472 6962  d.\n\nThe attrib
-00015970: 7574 6520 6064 6174 6160 2069 7320 6120  ute `data` is a 
-00015980: 5079 7468 6f6e 2060 6279 7465 7360 206f  Python `bytes` o
-00015990: 626a 6563 742c 2075 7365 6420 746f 2069  bject, used to i
-000159a0: 6e64 6963 6174 6520 7468 6520 6461 7461  ndicate the data
-000159b0: 206f 6620 7468 655c 6e65 7665 6e74 2074   of the\nevent t
-000159c0: 6861 7420 7761 7320 7265 636f 7264 6564  hat was recorded
-000159d0: 2e5c 6e5c 6e54 6865 2061 7474 7269 6275  .\n\nThe attribu
-000159e0: 7465 2060 6d65 7461 6461 7461 6020 6973  te `metadata` is
-000159f0: 2061 2050 7974 686f 6e20 6062 7974 6573   a Python `bytes
-00015a00: 6020 6f62 6a65 6374 2c20 7573 6564 2074  ` object, used t
-00015a10: 6f20 696e 6469 6361 7465 2074 6865 206d  o indicate the m
-00015a20: 6574 6164 6174 6120 6f66 5c6e 7468 6520  etadata of\nthe 
-00015a30: 6576 656e 7420 7468 6174 2077 6173 2072  event that was r
-00015a40: 6563 6f72 6465 642e 5c6e 5c6e 5468 6520  ecorded.\n\nThe 
-00015a50: 6174 7472 6962 7574 6520 6063 6f6e 7465  attribute `conte
-00015a60: 6e74 5f74 7970 6560 2069 7320 6120 5079  nt_type` is a Py
-00015a70: 7468 6f6e 2060 7374 7260 2c20 7573 6564  thon `str`, used
-00015a80: 2074 6f20 696e 6469 6361 7465 2074 6865   to indicate the
-00015a90: 2074 7970 6520 6f66 5c6e 6461 7461 2074   type of\ndata t
-00015aa0: 6861 7420 7761 7320 7265 636f 7264 6564  hat was recorded
-00015ab0: 2066 6f72 2074 6869 7320 6576 656e 7420   for this event 
-00015ac0: 2875 7375 616c 6c79 2060 6170 706c 6963  (usually `applic
-00015ad0: 6174 696f 6e2f 6a73 6f6e 6020 746f 2069  ation/json` to i
-00015ae0: 6e64 6963 6174 6520 7468 6174 5c6e 7468  ndicate that\nth
-00015af0: 6973 2064 6174 6120 6361 6e20 6265 2070  is data can be p
-00015b00: 6172 7365 6420 6173 204a 534f 4e2c 2062  arsed as JSON, b
-00015b10: 7574 2061 6c74 6572 6e61 7469 7665 6c79  ut alternatively
-00015b20: 2060 6170 706c 6963 6174 696f 6e2f 6f63   `application/oc
-00015b30: 7465 742d 7374 7265 616d 6020 746f 5c6e  tet-stream` to\n
-00015b40: 696e 6469 6361 7465 2074 6861 7420 6974  indicate that it
-00015b50: 2069 7320 736f 6d65 7468 696e 6720 656c   is something el
-00015b60: 7365 292e 5c6e 5c6e 5468 6520 6174 7472  se).\n\nThe attr
-00015b70: 6962 7574 6520 6069 6460 2069 7320 6120  ibute `id` is a 
-00015b80: 5079 7468 6f6e 2060 5555 4944 6020 6f62  Python `UUID` ob
-00015b90: 6a65 6374 2c20 7573 6564 2074 6f20 696e  ject, used to in
-00015ba0: 6469 6361 7465 2074 6865 2075 6e69 7175  dicate the uniqu
-00015bb0: 6520 4944 206f 6620 7468 655c 6e65 7665  e ID of the\neve
-00015bc0: 6e74 2074 6861 7420 7761 7320 7265 636f  nt that was reco
-00015bd0: 7264 6564 2e20 506c 6561 7365 206e 6f74  rded. Please not
-00015be0: 652c 2077 6865 6e20 7265 636f 7264 6564  e, when recorded
-00015bf0: 2065 7665 6e74 7320 6172 6520 7265 7475   events are retu
-00015c00: 726e 6564 2066 726f 6d20 6120 6361 6c6c  rned from a call
-00015c10: 5c6e 746f 2060 7265 6164 5f73 7472 6561  \nto `read_strea
-00015c20: 6d5f 6576 656e 7473 2829 6020 696e 2045  m_events()` in E
-00015c30: 7665 6e74 5374 6f72 6544 4220 7632 312e  ventStoreDB v21.
-00015c40: 3130 2c20 7468 6520 636f 6d6d 6974 2070  10, the commit p
-00015c50: 6f73 6974 696f 6e20 6973 206e 6f74 2061  osition is not a
-00015c60: 6374 7561 6c6c 795c 6e73 6574 2069 6e20  ctually\nset in 
-00015c70: 7468 6520 7265 7370 6f6e 7365 2e20 5468  the response. Th
-00015c80: 6973 2061 7474 7269 6275 7465 2069 7320  is attribute is 
-00015c90: 7479 7065 6420 6173 2061 6e20 6f70 7469  typed as an opti
-00015ca0: 6f6e 616c 2076 616c 7565 2028 604f 7074  onal value (`Opt
-00015cb0: 696f 6e61 6c5b 5555 4944 5d60 292c 5c6e  ional[UUID]`),\n
-00015cc0: 616e 6420 696e 2074 6865 2063 6173 6520  and in the case 
-00015cd0: 6f66 2075 7369 6e67 2045 7665 6e74 5374  of using EventSt
-00015ce0: 6f72 6544 4220 7632 312e 3130 2074 6865  oreDB v21.10 the
-00015cf0: 2076 616c 7565 206f 6620 7468 6973 2061   value of this a
-00015d00: 7474 7269 6275 7465 2077 696c 6c20 6265  ttribute will be
-00015d10: 2060 4e6f 6e65 605c 6e77 6865 6e20 7265   `None`\nwhen re
-00015d20: 6164 696e 6720 7265 636f 7264 6564 2065  ading recorded e
-00015d30: 7665 6e74 7320 6672 6f6d 2061 2073 7472  vents from a str
-00015d40: 6561 6d2e 2052 6563 6f72 6465 6420 6576  eam. Recorded ev
-00015d50: 656e 7473 2077 696c 6c20 686f 7765 7665  ents will howeve
-00015d60: 7220 6861 7665 2074 6869 735c 6e76 616c  r have this\nval
-00015d70: 7565 7320 7365 7420 7768 656e 2072 6561  ues set when rea
-00015d80: 6469 6e67 2072 6563 6f72 6465 6420 6576  ding recorded ev
-00015d90: 656e 7473 2066 726f 6d20 6072 6561 645f  ents from `read_
-00015da0: 616c 6c5f 6576 656e 7473 2829 6020 616e  all_events()` an
-00015db0: 6420 6672 6f6d 2062 6f74 685c 6e63 6174  d from both\ncat
-00015dc0: 6368 2d75 7020 616e 6420 7065 7273 6973  ch-up and persis
-00015dd0: 7465 6e74 2073 7562 7363 7269 7074 696f  tent subscriptio
-00015de0: 6e73 2e5c 6e5c 6e54 6865 2061 7474 7269  ns.\n\nThe attri
-00015df0: 6275 7465 2060 7374 7265 616d 5f6e 616d  bute `stream_nam
-00015e00: 6560 2069 7320 6120 5079 7468 6f6e 2060  e` is a Python `
-00015e10: 7374 7260 2c20 7573 6564 2074 6f20 696e  str`, used to in
-00015e20: 6469 6361 7465 2074 6865 206e 616d 6520  dicate the name 
-00015e30: 6f66 2074 6865 5c6e 7374 7265 616d 2069  of the\nstream i
-00015e40: 6e20 7768 6963 6820 7468 6520 6576 656e  n which the even
-00015e50: 7420 7761 7320 7265 636f 7264 6564 2e5c  t was recorded.\
-00015e60: 6e5c 6e54 6865 2061 7474 7269 6275 7465  n\nThe attribute
-00015e70: 2060 7374 7265 616d 5f70 6f73 6974 696f   `stream_positio
-00015e80: 6e60 2069 7320 6120 5079 7468 6f6e 2060  n` is a Python `
-00015e90: 696e 7460 2c20 7573 6564 2074 6f20 696e  int`, used to in
-00015ea0: 6469 6361 7465 2074 6865 2070 6f73 6974  dicate the posit
-00015eb0: 696f 6e20 696e 2074 6865 5c6e 7374 7265  ion in the\nstre
-00015ec0: 616d 2061 7420 7768 6963 6820 7468 6520  am at which the 
-00015ed0: 6576 656e 7420 7761 7320 7265 636f 7264  event was record
-00015ee0: 6564 2e5c 6e5c 6e54 6865 2061 7474 7269  ed.\n\nThe attri
-00015ef0: 6275 7465 2060 636f 6d6d 6974 5f70 6f73  bute `commit_pos
-00015f00: 6974 696f 6e60 2069 7320 6120 5079 7468  ition` is a Pyth
-00015f10: 6f6e 2060 696e 7460 2c20 7573 6564 2074  on `int`, used t
-00015f20: 6f20 696e 6469 6361 7465 2074 6865 2063  o indicate the c
-00015f30: 6f6d 6d69 7420 706f 7369 7469 6f6e 5c6e  ommit position\n
-00015f40: 6174 2077 6869 6368 2074 6865 2065 7665  at which the eve
-00015f50: 6e74 2077 6173 2072 6563 6f72 6465 642e  nt was recorded.
-00015f60: 5c6e 5c6e 6060 6070 7974 686f 6e5c 6e66  \n\n```python\nf
-00015f70: 726f 6d20 6573 6462 636c 6965 6e74 2e65  rom esdbclient.e
-00015f80: 7665 6e74 7320 696d 706f 7274 2052 6563  vents import Rec
-00015f90: 6f72 6465 6445 7665 6e74 5c6e 5c6e 7265  ordedEvent\n\nre
-00015fa0: 636f 7264 6564 5f65 7665 6e74 203d 2052  corded_event = R
-00015fb0: 6563 6f72 6465 6445 7665 6e74 285c 6e20  ecordedEvent(\n 
-00015fc0: 2020 2074 7970 653d 5c27 4f72 6465 7243     type=\'OrderC
-00015fd0: 7265 6174 6564 5c27 2c5c 6e20 2020 2064  reated\',\n    d
-00015fe0: 6174 613d 625c 277b 7d5c 272c 5c6e 2020  ata=b\'{}\',\n  
-00015ff0: 2020 6d65 7461 6461 7461 3d62 5c27 5c27    metadata=b\'\'
-00016000: 2c5c 6e20 2020 2063 6f6e 7465 6e74 5f74  ,\n    content_t
-00016010: 7970 653d 5c27 6170 706c 6963 6174 696f  ype=\'applicatio
-00016020: 6e2f 6a73 6f6e 5c27 2c5c 6e20 2020 2069  n/json\',\n    i
-00016030: 643d 7575 6964 3428 292c 5c6e 2020 2020  d=uuid4(),\n    
-00016040: 7374 7265 616d 5f6e 616d 653d 5c27 7374  stream_name=\'st
-00016050: 7265 616d 315c 272c 5c6e 2020 2020 7374  ream1\',\n    st
-00016060: 7265 616d 5f70 6f73 6974 696f 6e3d 302c  ream_position=0,
-00016070: 5c6e 2020 2020 636f 6d6d 6974 5f70 6f73  \n    commit_pos
-00016080: 6974 696f 6e3d 3531 322c 5c6e 295c 6e60  ition=512,\n)\n`
-00016090: 6060 5c6e 5c6e 2323 2320 4173 796e 6369  ``\n\n### Asynci
-000160a0: 6f20 636c 6965 6e74 5c6e 5c6e 5468 6520  o client\n\nThe 
-000160b0: 6065 7364 6263 6c69 656e 7460 2070 6163  `esdbclient` pac
-000160c0: 6b61 6765 2061 6c73 6f20 696e 636c 7564  kage also includ
-000160d0: 6573 2061 6e20 6561 726c 7920 7665 7273  es an early vers
-000160e0: 696f 6e20 6f66 2061 6e20 6173 796e 6368  ion of an asynch
-000160f0: 726f 6e6f 7573 2049 2f4f 5c6e 6752 5043  ronous I/O\ngRPC
-00016100: 2050 7974 686f 6e20 636c 6965 6e74 2e20   Python client. 
-00016110: 4974 2066 6f6c 6c6f 7773 2065 7861 6374  It follows exact
-00016120: 6c79 2074 6865 2073 616d 6520 6265 6861  ly the same beha
-00016130: 7669 6f72 7320 6173 2074 6865 206d 756c  viors as the mul
-00016140: 7469 7468 7265 6164 6564 5c6e 6045 5344  tithreaded\n`ESD
-00016150: 4243 6c69 656e 7460 2c20 6275 7420 7573  BClient`, but us
-00016160: 6573 2074 6865 2060 6772 7063 2e61 696f  es the `grpc.aio
-00016170: 6020 7061 636b 6167 6520 616e 6420 7468  ` package and th
-00016180: 6520 6061 7379 6e63 696f 6020 6d6f 6475  e `asyncio` modu
-00016190: 6c65 2c20 696e 7374 6561 6420 6f66 5c6e  le, instead of\n
-000161a0: 6067 7270 6360 2061 6e64 2060 7468 7265  `grpc` and `thre
-000161b0: 6164 696e 6760 2e5c 6e5c 6e54 6865 2060  ading`.\n\nThe `
-000161c0: 6173 796e 6360 2066 756e 6374 696f 6e20  async` function 
-000161d0: 6041 7379 6e63 696f 4553 4442 436c 6965  `AsyncioESDBClie
-000161e0: 6e74 6020 636f 6e73 7472 7563 7473 2074  nt` constructs t
-000161f0: 6865 2063 6c69 656e 742c 2061 6e64 2063  he client, and c
-00016200: 6f6e 6e65 6374 7320 746f 5c6e 6120 7365  onnects to\na se
-00016210: 7276 6572 2e20 4974 2063 616e 2062 6520  rver. It can be 
-00016220: 696d 706f 7274 6564 2066 726f 6d20 6065  imported from `e
-00016230: 7364 6263 6c69 656e 7460 2c20 616e 6420  sdbclient`, and 
-00016240: 6361 6e20 6265 2063 616c 6c65 6420 7769  can be called wi
-00016250: 7468 2074 6865 2073 616d 655c 6e61 7267  th the same\narg
-00016260: 756d 656e 7473 2061 7320 6045 5344 4243  uments as `ESDBC
-00016270: 6c69 656e 7460 2e20 4974 2073 7570 706f  lient`. It suppo
-00016280: 7274 7320 626f 7468 2074 6865 2022 6573  rts both the "es
-00016290: 6462 2220 616e 6420 7468 6520 2265 7364  db" and the "esd
-000162a0: 622b 6469 7363 6f76 6572 225c 6e63 6f6e  b+discover"\ncon
-000162b0: 6e65 6374 696f 6e20 7374 7269 6e67 2055  nection string U
-000162c0: 5249 2073 6368 656d 6573 2c20 616e 6420  RI schemes, and 
-000162d0: 7265 636f 6e6e 6563 7473 2061 6e64 2072  reconnects and r
-000162e0: 6574 7269 6573 206d 6574 686f 6473 2077  etries methods w
-000162f0: 6865 6e20 636f 6e6e 6563 7469 6f6e 5c6e  hen connection\n
-00016300: 6973 7375 6573 2061 7265 2065 6e63 6f75  issues are encou
-00016310: 6e74 6572 6564 2c20 6a75 7374 206c 696b  ntered, just lik
-00016320: 6520 6045 5344 4243 6c69 656e 7460 2e5c  e `ESDBClient`.\
-00016330: 6e5c 6e60 6060 7079 7468 6f6e 5c6e 6672  n\n```python\nfr
-00016340: 6f6d 2065 7364 6263 6c69 656e 7420 696d  om esdbclient im
-00016350: 706f 7274 2041 7379 6e63 696f 4553 4442  port AsyncioESDB
-00016360: 436c 6965 6e74 5c6e 6060 605c 6e5c 6e54  Client\n```\n\nT
-00016370: 6865 2061 7379 6e63 6872 6f6e 6f75 7320  he asynchronous 
-00016380: 492f 4f20 636c 6965 6e74 2068 6173 2060  I/O client has `
-00016390: 6173 796e 6360 206d 6574 686f 6473 2060  async` methods `
-000163a0: 6170 7065 6e64 5f65 7665 6e74 7328 2960  append_events()`
-000163b0: 2c5c 6e60 7265 6164 5f73 7472 6561 6d5f  ,\n`read_stream_
-000163c0: 6576 656e 7473 2829 602c 2060 7265 6164  events()`, `read
-000163d0: 5f61 6c6c 5f65 7665 6e74 7328 2960 2c20  _all_events()`, 
-000163e0: 6073 7562 7363 7269 6265 5f61 6c6c 5f65  `subscribe_all_e
-000163f0: 7665 6e74 7328 2960 2c5c 6e60 6465 6c65  vents()`,\n`dele
-00016400: 7465 5f73 7472 6561 6d28 2960 2c20 6074  te_stream()`, `t
-00016410: 6f6d 6273 746f 6e65 5f73 7472 6561 6d28  ombstone_stream(
-00016420: 2960 2c20 616e 6420 6072 6563 6f6e 6e65  )`, and `reconne
-00016430: 6374 2829 602e 5c6e 5c6e 5468 6573 6520  ct()`.\n\nThese 
-00016440: 6d65 7468 6f64 7320 6172 6520 6571 7569  methods are equi
-00016450: 7661 6c65 6e74 2074 6f20 7468 6520 6d65  valent to the me
-00016460: 7468 6f64 7320 6f6e 2060 4553 4442 436c  thods on `ESDBCl
-00016470: 6965 6e74 602e 2054 6865 7920 6861 7665  ient`. They have
-00016480: 2074 6865 2073 616d 655c 6e6d 6574 686f   the same\nmetho
-00016490: 6420 7369 676e 6174 7572 6573 2c20 616e  d signatures, an
-000164a0: 6420 6361 6e20 6265 2063 616c 6c65 6420  d can be called 
-000164b0: 7769 7468 2074 6865 2073 616d 6520 6172  with the same ar
-000164c0: 6775 6d65 6e74 732c 2074 6f20 7468 6520  guments, to the 
-000164d0: 7361 6d65 2065 6666 6563 742e 5c6e 5468  same effect.\nTh
-000164e0: 6520 6d65 7468 6f64 7320 7768 6963 6820  e methods which 
-000164f0: 6170 7065 6172 206f 6e20 6045 5344 4243  appear on `ESDBC
-00016500: 6c69 656e 7460 2062 7574 206e 6f74 206f  lient` but not o
-00016510: 6e20 6041 7379 6e63 696f 4553 4442 436c  n `AsyncioESDBCl
-00016520: 6965 6e74 6020 7769 6c6c 2062 655c 6e61  ient` will be\na
-00016530: 6464 6564 2073 6f6f 6e2e 5c6e 5c6e 5468  dded soon.\n\nTh
-00016540: 6520 6578 616d 706c 6520 6265 6c6f 7720  e example below 
-00016550: 6465 6d6f 6e73 7472 6174 6573 2074 6865  demonstrates the
-00016560: 2060 6170 7065 6e64 5f65 7665 6e74 7328   `append_events(
-00016570: 2960 2c20 6072 6561 645f 7374 7265 616d  )`, `read_stream
-00016580: 5f65 7665 6e74 7328 2960 2061 6e64 5c6e  _events()` and\n
-00016590: 6073 7562 7363 7269 6265 5f61 6c6c 5f65  `subscribe_all_e
-000165a0: 7665 6e74 7328 2960 206d 6574 686f 6473  vents()` methods
-000165b0: 2e20 5468 6573 6520 6172 6520 7468 6520  . These are the 
-000165c0: 6d6f 7374 2075 7365 6675 6c20 6d65 7468  most useful meth
-000165d0: 6f64 7320 666f 7220 7772 6974 696e 675c  ods for writing\
-000165e0: 6e61 6e20 6576 656e 742d 736f 7572 6365  nan event-source
-000165f0: 6420 6170 706c 6963 6174 696f 6e2c 2061  d application, a
-00016600: 6c6c 6f77 696e 6720 6e65 7720 6167 6772  llowing new aggr
-00016610: 6567 6174 6520 6576 656e 7473 2074 6f20  egate events to 
-00016620: 6265 2072 6563 6f72 6465 642c 2074 6865  be recorded, the
-00016630: 5c6e 7265 636f 7264 6564 2065 7665 6e74  \nrecorded event
-00016640: 7320 6f66 2061 6e20 6167 6772 6567 6174  s of an aggregat
-00016650: 6520 746f 2062 6520 6f62 7461 696e 6564  e to be obtained
-00016660: 2073 6f20 6167 6772 6567 6174 6573 2063   so aggregates c
-00016670: 616e 2062 6520 7265 636f 6e73 7472 7563  an be reconstruc
-00016680: 7465 642c 5c6e 616e 6420 7468 6520 7374  ted,\nand the st
-00016690: 6174 6520 6f66 2061 6e20 6170 706c 6963  ate of an applic
-000166a0: 6174 696f 6e20 746f 2070 726f 7061 6761  ation to propaga
-000166b0: 7465 6420 616e 6420 7072 6f63 6573 7365  ted and processe
-000166c0: 6420 7769 7468 2022 6578 6163 746c 792d  d with "exactly-
-000166d0: 6f6e 6365 225c 6e73 656d 616e 7469 6373  once"\nsemantics
-000166e0: 2e5c 6e5c 6e60 6060 7079 7468 6f6e 5c6e  .\n\n```python\n
-000166f0: 696d 706f 7274 2061 7379 6e63 696f 5c6e  import asyncio\n
-00016700: 5c6e 6173 796e 6320 6465 6620 6465 6d6f  \nasync def demo
-00016710: 6e73 7472 6174 655f 6173 796e 6369 6f5f  nstrate_asyncio_
-00016720: 636c 6965 6e74 2829 3a5c 6e5c 6e20 2020  client():\n\n   
-00016730: 2023 2043 6f6e 7374 7275 6374 2063 6c69   # Construct cli
-00016740: 656e 742e 5c6e 2020 2020 636c 6965 6e74  ent.\n    client
-00016750: 203d 2061 7761 6974 2041 7379 6e63 696f   = await Asyncio
-00016760: 4553 4442 436c 6965 6e74 285c 6e20 2020  ESDBClient(\n   
-00016770: 2020 2020 2075 7269 3d6f 732e 6765 7465       uri=os.gete
-00016780: 6e76 2822 4553 4442 5f55 5249 2229 2c5c  nv("ESDB_URI"),\
-00016790: 6e20 2020 2020 2020 2072 6f6f 745f 6365  n        root_ce
-000167a0: 7274 6966 6963 6174 6573 3d6f 732e 6765  rtificates=os.ge
-000167b0: 7465 6e76 2822 4553 4442 5f52 4f4f 545f  tenv("ESDB_ROOT_
-000167c0: 4345 5254 4946 4943 4154 4553 2229 2c5c  CERTIFICATES"),\
-000167d0: 6e20 2020 2029 5c6e 5c6e 2020 2020 2320  n    )\n\n    # 
-000167e0: 4170 7065 6e64 2065 7665 6e74 732e 5c6e  Append events.\n
-000167f0: 2020 2020 7374 7265 616d 5f6e 616d 6520      stream_name 
-00016800: 3d20 7374 7228 7575 6964 3428 2929 5c6e  = str(uuid4())\n
-00016810: 2020 2020 6576 656e 7431 203d 204e 6577      event1 = New
-00016820: 4576 656e 7428 224f 7264 6572 4372 6561  Event("OrderCrea
-00016830: 7465 6422 2c20 6461 7461 3d62 5c27 7b7d  ted", data=b\'{}
-00016840: 5c27 295c 6e20 2020 2065 7665 6e74 3220  \')\n    event2 
-00016850: 3d20 4e65 7745 7665 6e74 2822 4f72 6465  = NewEvent("Orde
-00016860: 7255 7064 6174 6564 222c 2064 6174 613d  rUpdated", data=
-00016870: 625c 277b 7d5c 2729 5c6e 2020 2020 6576  b\'{}\')\n    ev
-00016880: 656e 7433 203d 204e 6577 4576 656e 7428  ent3 = NewEvent(
-00016890: 224f 7264 6572 4465 6c65 7465 6422 2c20  "OrderDeleted", 
-000168a0: 6461 7461 3d62 5c27 7b7d 5c27 295c 6e5c  data=b\'{}\')\n\
-000168b0: 6e20 2020 2061 7761 6974 2063 6c69 656e  n    await clien
-000168c0: 742e 6170 7065 6e64 5f65 7665 6e74 7328  t.append_events(
-000168d0: 5c6e 2020 2020 2020 2020 7374 7265 616d  \n        stream
-000168e0: 5f6e 616d 653d 7374 7265 616d 5f6e 616d  _name=stream_nam
-000168f0: 652c 5c6e 2020 2020 2020 2020 6578 7065  e,\n        expe
-00016900: 6374 6564 5f70 6f73 6974 696f 6e3d 4e6f  cted_position=No
-00016910: 6e65 2c5c 6e20 2020 2020 2020 2065 7665  ne,\n        eve
-00016920: 6e74 733d 5b65 7665 6e74 312c 2065 7665  nts=[event1, eve
-00016930: 6e74 322c 2065 7665 6e74 335d 5c6e 2020  nt2, event3]\n  
-00016940: 2020 295c 6e5c 6e20 2020 2023 2052 6561    )\n\n    # Rea
-00016950: 6420 7374 7265 616d 2065 7665 6e74 732e  d stream events.
-00016960: 5c6e 2020 2020 7265 636f 7264 6564 203d  \n    recorded =
-00016970: 2061 7761 6974 2063 6c69 656e 742e 7265   await client.re
-00016980: 6164 5f73 7472 6561 6d5f 6576 656e 7473  ad_stream_events
-00016990: 2873 7472 6561 6d5f 6e61 6d65 295c 6e20  (stream_name)\n 
-000169a0: 2020 2061 7373 6572 7420 6c65 6e28 7265     assert len(re
-000169b0: 636f 7264 6564 2920 3d3d 2033 5c6e 2020  corded) == 3\n  
-000169c0: 2020 6173 7365 7274 2072 6563 6f72 6465    assert recorde
-000169d0: 645b 305d 2e69 6420 3d3d 2065 7665 6e74  d[0].id == event
-000169e0: 312e 6964 5c6e 2020 2020 6173 7365 7274  1.id\n    assert
-000169f0: 2072 6563 6f72 6465 645b 315d 2e69 6420   recorded[1].id 
-00016a00: 3d3d 2065 7665 6e74 322e 6964 5c6e 2020  == event2.id\n  
-00016a10: 2020 6173 7365 7274 2072 6563 6f72 6465    assert recorde
-00016a20: 645b 325d 2e69 6420 3d3d 2065 7665 6e74  d[2].id == event
-00016a30: 332e 6964 5c6e 5c6e 5c6e 2020 2020 2320  3.id\n\n\n    # 
-00016a40: 5375 6273 6372 6962 6520 616c 6c20 6576  Subscribe all ev
-00016a50: 656e 7473 2e5c 6e20 2020 2072 6563 6569  ents.\n    recei
-00016a60: 7665 6420 3d20 5b5d 5c6e 2020 2020 6173  ved = []\n    as
-00016a70: 796e 6320 666f 7220 6576 656e 7420 696e  ync for event in
-00016a80: 2061 7761 6974 2063 6c69 656e 742e 7375   await client.su
-00016a90: 6273 6372 6962 655f 616c 6c5f 6576 656e  bscribe_all_even
-00016aa0: 7473 2829 3a5c 6e20 2020 2020 2020 2072  ts():\n        r
-00016ab0: 6563 6569 7665 642e 6170 7065 6e64 2865  eceived.append(e
-00016ac0: 7665 6e74 295c 6e20 2020 2020 2020 2069  vent)\n        i
-00016ad0: 6620 6576 656e 742e 6964 203d 3d20 6576  f event.id == ev
-00016ae0: 656e 7433 2e69 643a 5c6e 2020 2020 2020  ent3.id:\n      
-00016af0: 2020 2020 2020 6272 6561 6b5c 6e20 2020        break\n   
-00016b00: 2061 7373 6572 7420 7265 6365 6976 6564   assert received
-00016b10: 5b2d 335d 2e69 6420 3d3d 2065 7665 6e74  [-3].id == event
-00016b20: 312e 6964 5c6e 2020 2020 6173 7365 7274  1.id\n    assert
-00016b30: 2072 6563 6569 7665 645b 2d32 5d2e 6964   received[-2].id
-00016b40: 203d 3d20 6576 656e 7432 2e69 645c 6e20   == event2.id\n 
-00016b50: 2020 2061 7373 6572 7420 7265 6365 6976     assert receiv
-00016b60: 6564 5b2d 315d 2e69 6420 3d3d 2065 7665  ed[-1].id == eve
-00016b70: 6e74 332e 6964 5c6e 5c6e 5c6e 2020 2020  nt3.id\n\n\n    
-00016b80: 2320 436c 6f73 6520 7468 6520 636c 6965  # Close the clie
-00016b90: 6e74 2e5c 6e20 2020 2061 7761 6974 2063  nt.\n    await c
-00016ba0: 6c69 656e 742e 636c 6f73 6528 295c 6e5c  lient.close()\n\
-00016bb0: 6e5c 6e23 2052 756e 2074 6865 2064 656d  n\n# Run the dem
-00016bc0: 6f2e 5c6e 6173 796e 6369 6f2e 6765 745f  o.\nasyncio.get_
-00016bd0: 6576 656e 745f 6c6f 6f70 2829 2e72 756e  event_loop().run
-00016be0: 5f75 6e74 696c 5f63 6f6d 706c 6574 6528  _until_complete(
-00016bf0: 5c6e 2020 2020 6465 6d6f 6e73 7472 6174  \n    demonstrat
-00016c00: 655f 6173 796e 6369 6f5f 636c 6965 6e74  e_asyncio_client
-00016c10: 2829 5c6e 295c 6e60 6060 5c6e 5c6e 2323  ()\n)\n```\n\n##
-00016c20: 2043 6f6e 7472 6962 7574 6f72 735c 6e5c   Contributors\n\
-00016c30: 6e23 2323 2049 6e73 7461 6c6c 2050 6f65  n### Install Poe
-00016c40: 7472 795c 6e5c 6e54 6865 2066 6972 7374  try\n\nThe first
-00016c50: 2074 6869 6e67 2069 7320 746f 2063 6865   thing is to che
-00016c60: 636b 2079 6f75 2068 6176 6520 506f 6574  ck you have Poet
-00016c70: 7279 2069 6e73 7461 6c6c 6564 2e5c 6e5c  ry installed.\n\
-00016c80: 6e20 2020 2024 2070 6f65 7472 7920 2d2d  n    $ poetry --
-00016c90: 7665 7273 696f 6e5c 6e5c 6e49 6620 796f  version\n\nIf yo
-00016ca0: 7520 646f 6e5c 2774 2c20 7468 656e 2070  u don\'t, then p
-00016cb0: 6c65 6173 6520 5b69 6e73 7461 6c6c 2050  lease [install P
-00016cc0: 6f65 7472 795d 2868 7474 7073 3a2f 2f70  oetry](https://p
-00016cd0: 7974 686f 6e2d 706f 6574 7279 2e6f 7267  ython-poetry.org
-00016ce0: 2f64 6f63 732f 2369 6e73 7461 6c6c 696e  /docs/#installin
-00016cf0: 672d 7769 7468 2d74 6865 2d6f 6666 6963  g-with-the-offic
-00016d00: 6961 6c2d 696e 7374 616c 6c65 7229 2e5c  ial-installer).\
-00016d10: 6e5c 6e20 2020 2024 2063 7572 6c20 2d73  n\n    $ curl -s
-00016d20: 534c 2068 7474 7073 3a2f 2f69 6e73 7461  SL https://insta
-00016d30: 6c6c 2e70 7974 686f 6e2d 706f 6574 7279  ll.python-poetry
-00016d40: 2e6f 7267 207c 2070 7974 686f 6e33 202d  .org | python3 -
-00016d50: 5c6e 5c6e 4974 2077 696c 6c20 6865 6c70  \n\nIt will help
-00016d60: 2074 6f20 6d61 6b65 2073 7572 6520 506f   to make sure Po
-00016d70: 6574 7279 5c27 7320 6269 6e20 6469 7265  etry\'s bin dire
-00016d80: 6374 6f72 7920 6973 2069 6e20 796f 7572  ctory is in your
-00016d90: 2060 5041 5448 6020 656e 7669 726f 6e6d   `PATH` environm
-00016da0: 656e 7420 7661 7269 6162 6c65 2e5c 6e5c  ent variable.\n\
-00016db0: 6e42 7574 2069 6e20 616e 7920 6361 7365  nBut in any case
-00016dc0: 2c20 6d61 6b65 2073 7572 6520 796f 7520  , make sure you 
-00016dd0: 6b6e 6f77 2074 6865 2070 6174 6820 746f  know the path to
-00016de0: 2074 6865 2060 706f 6574 7279 6020 6578   the `poetry` ex
-00016df0: 6563 7574 6162 6c65 2e20 5468 6520 506f  ecutable. The Po
-00016e00: 6574 7279 5c6e 696e 7374 616c 6c65 7220  etry\ninstaller 
-00016e10: 7465 6c6c 7320 796f 7520 7768 6572 6520  tells you where 
-00016e20: 6974 2068 6173 2062 6565 6e20 696e 7374  it has been inst
-00016e30: 616c 6c65 642c 2061 6e64 2068 6f77 2074  alled, and how t
-00016e40: 6f20 636f 6e66 6967 7572 6520 796f 7572  o configure your
-00016e50: 2073 6865 6c6c 2e5c 6e5c 6e50 6c65 6173   shell.\n\nPleas
-00016e60: 6520 7265 6665 7220 746f 2074 6865 205b  e refer to the [
-00016e70: 506f 6574 7279 2064 6f63 735d 2868 7474  Poetry docs](htt
-00016e80: 7073 3a2f 2f70 7974 686f 6e2d 706f 6574  ps://python-poet
-00016e90: 7279 2e6f 7267 2f64 6f63 732f 2920 666f  ry.org/docs/) fo
-00016ea0: 7220 6775 6964 616e 6365 206f 6e5c 6e75  r guidance on\nu
-00016eb0: 7369 6e67 2050 6f65 7472 792e 5c6e 5c6e  sing Poetry.\n\n
-00016ec0: 2323 2320 5365 7475 7020 666f 7220 5079  ### Setup for Py
-00016ed0: 4368 6172 6d20 7573 6572 735c 6e5c 6e59  Charm users\n\nY
-00016ee0: 6f75 2063 616e 2065 6173 696c 7920 6f62  ou can easily ob
-00016ef0: 7461 696e 2074 6865 2070 726f 6a65 6374  tain the project
-00016f00: 2066 696c 6573 2075 7369 6e67 2050 7943   files using PyC
-00016f10: 6861 726d 2028 6d65 6e75 2022 4769 7420  harm (menu "Git 
-00016f20: 3e20 436c 6f6e 652e 2e2e 2229 2e5c 6e50  > Clone...").\nP
-00016f30: 7943 6861 726d 2077 696c 6c20 7468 656e  yCharm will then
-00016f40: 2075 7375 616c 6c79 2070 726f 6d70 7420   usually prompt 
-00016f50: 796f 7520 746f 206f 7065 6e20 7468 6520  you to open the 
-00016f60: 7072 6f6a 6563 742e 5c6e 5c6e 4f70 656e  project.\n\nOpen
-00016f70: 2074 6865 2070 726f 6a65 6374 2069 6e20   the project in 
-00016f80: 6120 6e65 7720 7769 6e64 6f77 2e20 5079  a new window. Py
-00016f90: 4368 6172 6d20 7769 6c6c 2074 6865 6e20  Charm will then 
-00016fa0: 7573 7561 6c6c 7920 7072 6f6d 7074 2079  usually prompt y
-00016fb0: 6f75 2074 6f20 6372 6561 7465 5c6e 6120  ou to create\na 
-00016fc0: 6e65 7720 7669 7274 7561 6c20 656e 7669  new virtual envi
-00016fd0: 726f 6e6d 656e 742e 5c6e 5c6e 4372 6561  ronment.\n\nCrea
-00016fe0: 7465 2061 206e 6577 2050 6f65 7472 7920  te a new Poetry 
-00016ff0: 7669 7274 7561 6c20 656e 7669 726f 6e6d  virtual environm
-00017000: 656e 7420 666f 7220 7468 6520 7072 6f6a  ent for the proj
-00017010: 6563 742e 2049 6620 5079 4368 6172 6d20  ect. If PyCharm 
-00017020: 646f 6573 6e5c 2774 2061 6c72 6561 6479  doesn\'t already
-00017030: 5c6e 6b6e 6f77 2077 6865 7265 2079 6f75  \nknow where you
-00017040: 7220 6070 6f65 7472 7960 2065 7865 6375  r `poetry` execu
-00017050: 7461 626c 6520 6973 2c20 7468 656e 2073  table is, then s
-00017060: 6574 2074 6865 2070 6174 6820 746f 2079  et the path to y
-00017070: 6f75 7220 6070 6f65 7472 7960 2065 7865  our `poetry` exe
-00017080: 6375 7461 626c 655c 6e69 6e20 7468 6520  cutable\nin the 
-00017090: 224e 6577 2050 6f65 7472 7920 456e 7669  "New Poetry Envi
-000170a0: 726f 6e6d 656e 7422 2066 6f72 6d20 696e  ronment" form in
-000170b0: 7075 7420 6669 656c 6420 6c61 6265 6c6c  put field labell
-000170c0: 6564 2022 506f 6574 7279 2065 7865 6375  ed "Poetry execu
-000170d0: 7461 626c 6522 2e20 496e 2074 6865 5c6e  table". In the\n
-000170e0: 224e 6577 2050 6f65 7472 7920 456e 7669  "New Poetry Envi
-000170f0: 726f 6e6d 656e 7422 2066 6f72 6d2c 2079  ronment" form, y
-00017100: 6f75 2077 696c 6c20 616c 736f 2068 6176  ou will also hav
-00017110: 6520 7468 6520 6f70 706f 7274 756e 6974  e the opportunit
-00017120: 7920 746f 2073 656c 6563 7420 7768 6963  y to select whic
-00017130: 685c 6e50 7974 686f 6e20 6578 6563 7574  h\nPython execut
-00017140: 6162 6c65 2077 696c 6c20 6265 2075 7365  able will be use
-00017150: 6420 6279 2074 6865 2076 6972 7475 616c  d by the virtual
-00017160: 2065 6e76 6972 6f6e 6d65 6e74 2e5c 6e5c   environment.\n\
-00017170: 6e50 7943 6861 726d 2077 696c 6c20 7468  nPyCharm will th
-00017180: 656e 2063 7265 6174 6520 6120 6e65 7720  en create a new 
-00017190: 506f 6574 7279 2076 6972 7475 616c 2065  Poetry virtual e
-000171a0: 6e76 6972 6f6e 6d65 6e74 2066 6f72 2079  nvironment for y
-000171b0: 6f75 7220 7072 6f6a 6563 742c 2075 7369  our project, usi
-000171c0: 6e67 5c6e 6120 7061 7274 6963 756c 6172  ng\na particular
-000171d0: 2076 6572 7369 6f6e 206f 6620 5079 7468   version of Pyth
-000171e0: 6f6e 2c20 616e 6420 616c 736f 2069 6e73  on, and also ins
-000171f0: 7461 6c6c 2069 6e74 6f20 7468 6973 2076  tall into this v
-00017200: 6972 7475 616c 2065 6e76 6972 6f6e 6d65  irtual environme
-00017210: 6e74 2074 6865 5c6e 7072 6f6a 6563 745c  nt the\nproject\
-00017220: 2773 2070 6163 6b61 6765 2064 6570 656e  's package depen
-00017230: 6465 6e63 6965 7320 6163 636f 7264 696e  dencies accordin
-00017240: 6720 746f 2074 6865 2070 726f 6a65 6374  g to the project
-00017250: 5c27 7320 6070 6f65 7472 792e 6c6f 636b  \'s `poetry.lock
-00017260: 6020 6669 6c65 2e5c 6e5c 6e59 6f75 2063  ` file.\n\nYou c
-00017270: 616e 2061 6464 2064 6966 6665 7265 6e74  an add different
-00017280: 2050 6f65 7472 7920 656e 7669 726f 6e6d   Poetry environm
-00017290: 656e 7473 2066 6f72 2064 6966 6665 7265  ents for differe
-000172a0: 6e74 2050 7974 686f 6e20 7665 7273 696f  nt Python versio
-000172b0: 6e73 2c20 616e 6420 7377 6974 6368 5c6e  ns, and switch\n
-000172c0: 6265 7477 6565 6e20 7468 656d 2075 7369  between them usi
-000172d0: 6e67 2074 6865 2022 5079 7468 6f6e 2049  ng the "Python I
-000172e0: 6e74 6572 7072 6574 6572 2220 7365 7474  nterpreter" sett
-000172f0: 696e 6773 206f 6620 5079 4368 6172 6d2e  ings of PyCharm.
-00017300: 2049 6620 796f 7520 7761 6e74 2074 6f20   If you want to 
-00017310: 7573 655c 6e61 2076 6572 7369 6f6e 206f  use\na version o
-00017320: 6620 5079 7468 6f6e 2074 6861 7420 6973  f Python that is
-00017330: 6e5c 2774 2069 6e73 7461 6c6c 6564 2c20  n\'t installed, 
-00017340: 6569 7468 6572 2075 7365 2079 6f75 7220  either use your 
-00017350: 6661 766f 7572 6974 6520 7061 636b 6167  favourite packag
-00017360: 6520 6d61 6e61 6765 722c 5c6e 6f72 2069  e manager,\nor i
-00017370: 6e73 7461 6c6c 2050 7974 686f 6e20 6279  nstall Python by
-00017380: 2064 6f77 6e6c 6f61 6469 6e67 2061 6e20   downloading an 
-00017390: 696e 7374 616c 6c65 7220 666f 7220 7265  installer for re
-000173a0: 6365 6e74 2076 6572 7369 6f6e 7320 6f66  cent versions of
-000173b0: 2050 7974 686f 6e20 6469 7265 6374 6c79   Python directly
-000173c0: 5c6e 6672 6f6d 2074 6865 205b 5079 7468  \nfrom the [Pyth
-000173d0: 6f6e 2077 6562 7369 7465 5d28 6874 7470  on website](http
-000173e0: 733a 2f2f 7777 772e 7079 7468 6f6e 2e6f  s://www.python.o
-000173f0: 7267 2f64 6f77 6e6c 6f61 6473 2f29 2e5c  rg/downloads/).\
-00017400: 6e5c 6e4f 6e63 6520 7072 6f6a 6563 7420  n\nOnce project 
-00017410: 6465 7065 6e64 656e 6369 6573 2068 6176  dependencies hav
-00017420: 6520 6265 656e 2069 6e73 7461 6c6c 6564  e been installed
-00017430: 2c20 796f 7520 7368 6f75 6c64 2062 6520  , you should be 
-00017440: 6162 6c65 2074 6f20 7275 6e20 7465 7374  able to run test
-00017450: 735c 6e66 726f 6d20 7769 7468 696e 2050  s\nfrom within P
-00017460: 7943 6861 726d 2028 7269 6768 742d 636c  yCharm (right-cl
-00017470: 6963 6b20 6f6e 2074 6865 2060 7465 7374  ick on the `test
-00017480: 7360 2066 6f6c 6465 7220 616e 6420 7365  s` folder and se
-00017490: 6c65 6374 2074 6865 205c 2752 756e 5c27  lect the \'Run\'
-000174a0: 206f 7074 696f 6e29 2e5c 6e5c 6e42 6563   option).\n\nBec
-000174b0: 6175 7365 206f 6620 6120 636f 6e66 6c69  ause of a confli
-000174c0: 6374 2062 6574 7765 656e 2070 7974 6573  ct between pytes
-000174d0: 7420 616e 6420 5079 4368 6172 6d5c 2773  t and PyCharm\'s
-000174e0: 2064 6562 7567 6765 7220 616e 6420 7468   debugger and th
-000174f0: 6520 636f 7665 7261 6765 2074 6f6f 6c2c  e coverage tool,
-00017500: 5c6e 796f 7520 6d61 7920 6e65 6564 2074  \nyou may need t
-00017510: 6f20 6164 6420 6060 2d2d 6e6f 2d63 6f76  o add ``--no-cov
-00017520: 6060 2061 7320 616e 206f 7074 696f 6e20  `` as an option 
-00017530: 746f 2074 6865 2074 6573 7420 7275 6e6e  to the test runn
-00017540: 6572 2074 656d 706c 6174 652e 2041 6c74  er template. Alt
-00017550: 6572 6e61 7469 7665 6c79 2c5c 6e6a 7573  ernatively,\njus
-00017560: 7420 7573 6520 7468 6520 5079 7468 6f6e  t use the Python
-00017570: 2053 7461 6e64 6172 6420 4c69 6272 6172   Standard Librar
-00017580: 795c 2773 2060 6075 6e69 7474 6573 7460  y\'s ``unittest`
-00017590: 6020 6d6f 6475 6c65 2e5c 6e5c 6e59 6f75  ` module.\n\nYou
-000175a0: 2073 686f 756c 6420 616c 736f 2062 6520   should also be 
-000175b0: 6162 6c65 2074 6f20 6f70 656e 2061 2074  able to open a t
-000175c0: 6572 6d69 6e61 6c20 7769 6e64 6f77 2069  erminal window i
-000175d0: 6e20 5079 4368 6172 6d2c 2061 6e64 2072  n PyCharm, and r
-000175e0: 756e 2074 6865 2070 726f 6a65 6374 5c27  un the project\'
-000175f0: 735c 6e4d 616b 6566 696c 6520 636f 6d6d  s\nMakefile comm
-00017600: 616e 6473 2066 726f 6d20 7468 6520 636f  ands from the co
-00017610: 6d6d 616e 6420 6c69 6e65 2028 7365 6520  mmand line (see 
-00017620: 6265 6c6f 7729 2e5c 6e5c 6e23 2323 2053  below).\n\n### S
-00017630: 6574 7570 2066 726f 6d20 636f 6d6d 616e  etup from comman
-00017640: 6420 6c69 6e65 5c6e 5c6e 4f62 7461 696e  d line\n\nObtain
-00017650: 2074 6865 2070 726f 6a65 6374 2066 696c   the project fil
-00017660: 6573 2c20 7573 696e 6720 4769 7420 6f72  es, using Git or
-00017670: 2073 7569 7461 626c 6520 616c 7465 726e   suitable altern
-00017680: 6174 6976 652e 5c6e 5c6e 496e 2061 2074  ative.\n\nIn a t
-00017690: 6572 6d69 6e61 6c20 6170 706c 6963 6174  erminal applicat
-000176a0: 696f 6e2c 2063 6861 6e67 6520 796f 7572  ion, change your
-000176b0: 2063 7572 7265 6e74 2077 6f72 6b69 6e67   current working
-000176c0: 2064 6972 6563 746f 7279 5c6e 746f 2074   directory\nto t
-000176d0: 6865 2072 6f6f 7420 666f 6c64 6572 206f  he root folder o
-000176e0: 6620 7468 6520 7072 6f6a 6563 7420 6669  f the project fi
-000176f0: 6c65 732e 2054 6865 7265 2073 686f 756c  les. There shoul
-00017700: 6420 6265 2061 204d 616b 6566 696c 655c  d be a Makefile\
-00017710: 6e69 6e20 7468 6973 2066 6f6c 6465 722e  nin this folder.
-00017720: 5c6e 5c6e 5573 6520 7468 6520 4d61 6b65  \n\nUse the Make
-00017730: 6669 6c65 2074 6f20 6372 6561 7465 2061  file to create a
-00017740: 206e 6577 2050 6f65 7472 7920 7669 7274   new Poetry virt
-00017750: 7561 6c20 656e 7669 726f 6e6d 656e 7420  ual environment 
-00017760: 666f 7220 7468 655c 6e70 726f 6a65 6374  for the\nproject
-00017770: 2061 6e64 2069 6e73 7461 6c6c 2074 6865   and install the
-00017780: 2070 726f 6a65 6374 5c27 7320 7061 636b   project\'s pack
-00017790: 6167 6520 6465 7065 6e64 656e 6369 6573  age dependencies
-000177a0: 2069 6e74 6f20 6974 2c5c 6e75 7369 6e67   into it,\nusing
-000177b0: 2074 6865 2066 6f6c 6c6f 7769 6e67 2063   the following c
-000177c0: 6f6d 6d61 6e64 2e5c 6e5c 6e20 2020 2024  ommand.\n\n    $
-000177d0: 206d 616b 6520 696e 7374 616c 6c2d 7061   make install-pa
-000177e0: 636b 6167 6573 5c6e 5c6e 4974 5c27 7320  ckages\n\nIt\'s 
-000177f0: 616c 736f 2070 6f73 7369 626c 6520 746f  also possible to
-00017800: 2061 6c73 6f20 696e 7374 616c 6c20 7468   also install th
-00017810: 6520 7072 6f6a 6563 7420 696e 205c 2765  e project in \'e
-00017820: 6469 7461 626c 6520 6d6f 6465 5c27 2e5c  ditable mode\'.\
-00017830: 6e5c 6e20 2020 2024 206d 616b 6520 696e  n\n    $ make in
-00017840: 7374 616c 6c5c 6e5c 6e50 6c65 6173 6520  stall\n\nPlease 
-00017850: 6e6f 7465 2c20 6966 2079 6f75 2063 7265  note, if you cre
-00017860: 6174 6520 7468 6520 7669 7274 7561 6c20  ate the virtual 
-00017870: 656e 7669 726f 6e6d 656e 7420 696e 2074  environment in t
-00017880: 6869 7320 7761 792c 2061 6e64 2074 6865  his way, and the
-00017890: 6e20 7472 7920 746f 5c6e 6f70 656e 2074  n try to\nopen t
-000178a0: 6865 2070 726f 6a65 6374 2069 6e20 5079  he project in Py
-000178b0: 4368 6172 6d20 616e 6420 636f 6e66 6967  Charm and config
-000178c0: 7572 6520 7468 6520 7072 6f6a 6563 7420  ure the project 
-000178d0: 746f 2075 7365 2074 6869 7320 7669 7274  to use this virt
-000178e0: 7561 6c5c 6e65 6e76 6972 6f6e 6d65 6e74  ual\nenvironment
-000178f0: 2061 7320 616e 2022 4578 6973 7469 6e67   as an "Existing
-00017900: 2050 6f65 7472 7920 456e 7669 726f 6e6d   Poetry Environm
-00017910: 656e 7422 2c20 5079 4368 6172 6d20 736f  ent", PyCharm so
-00017920: 6d65 7469 6d65 7320 6861 7320 736f 6d65  metimes has some
-00017930: 5c6e 6973 7375 6573 2028 646f 6e5c 2774  \nissues (don\'t
-00017940: 206b 6e6f 7720 7768 7929 2077 6869 6368   know why) which
-00017950: 206d 6967 6874 2062 6520 7072 6f62 6c65   might be proble
-00017960: 6d61 7469 632e 2049 6620 796f 7520 656e  matic. If you en
-00017970: 636f 756e 7465 7220 7375 6368 5c6e 6973  counter such\nis
-00017980: 7375 6573 2c20 796f 7520 6361 6e20 7265  sues, you can re
-00017990: 736f 6c76 6520 7468 6573 6520 6973 7375  solve these issu
-000179a0: 6573 2062 7920 6465 6c65 7469 6e67 2074  es by deleting t
-000179b0: 6865 2076 6972 7475 616c 2065 6e76 6972  he virtual envir
-000179c0: 6f6e 6d65 6e74 5c6e 616e 6420 6372 6561  onment\nand crea
-000179d0: 7469 6e67 2074 6865 2050 6f65 7472 7920  ting the Poetry 
-000179e0: 7669 7274 7561 6c20 656e 7669 726f 6e6d  virtual environm
-000179f0: 656e 7420 7573 696e 6720 5079 4368 6172  ent using PyChar
-00017a00: 6d20 2873 6565 2061 626f 7665 292e 5c6e  m (see above).\n
-00017a10: 5c6e 2323 2320 5072 6f6a 6563 7420 4d61  \n### Project Ma
-00017a20: 6b65 6669 6c65 2063 6f6d 6d61 6e64 735c  kefile commands\
-00017a30: 6e5c 6e59 6f75 2063 616e 2073 7461 7274  n\nYou can start
-00017a40: 2045 7665 6e74 5374 6f72 6544 4220 7573   EventStoreDB us
-00017a50: 696e 6720 7468 6520 666f 6c6c 6f77 696e  ing the followin
-00017a60: 6720 636f 6d6d 616e 642e 5c6e 5c6e 2020  g command.\n\n  
-00017a70: 2020 2420 6d61 6b65 2073 7461 7274 2d65    $ make start-e
-00017a80: 7665 6e74 7374 6f72 6564 625c 6e5c 6e59  ventstoredb\n\nY
-00017a90: 6f75 2063 616e 2072 756e 2074 6573 7473  ou can run tests
-00017aa0: 2075 7369 6e67 2074 6865 2066 6f6c 6c6f   using the follo
-00017ab0: 7769 6e67 2063 6f6d 6d61 6e64 2028 6e65  wing command (ne
-00017ac0: 6564 7320 4576 656e 7453 746f 7265 4442  eds EventStoreDB
-00017ad0: 2074 6f20 6265 2072 756e 6e69 6e67 292e   to be running).
-00017ae0: 5c6e 5c6e 2020 2020 2420 6d61 6b65 2074  \n\n    $ make t
-00017af0: 6573 745c 6e5c 6e59 6f75 2063 616e 2073  est\n\nYou can s
-00017b00: 746f 7020 4576 656e 7453 746f 7265 4442  top EventStoreDB
-00017b10: 2075 7369 6e67 2074 6865 2066 6f6c 6c6f   using the follo
-00017b20: 7769 6e67 2063 6f6d 6d61 6e64 2e5c 6e5c  wing command.\n\
-00017b30: 6e20 2020 2024 206d 616b 6520 7374 6f70  n    $ make stop
-00017b40: 2d65 7665 6e74 7374 6f72 6564 625c 6e5c  -eventstoredb\n\
-00017b50: 6e59 6f75 2063 616e 2063 6865 636b 2074  nYou can check t
-00017b60: 6865 2066 6f72 6d61 7474 696e 6720 6f66  he formatting of
-00017b70: 2074 6865 2063 6f64 6520 7573 696e 6720   the code using 
-00017b80: 7468 6520 666f 6c6c 6f77 696e 6720 636f  the following co
-00017b90: 6d6d 616e 642e 5c6e 5c6e 2020 2020 2420  mmand.\n\n    $ 
-00017ba0: 6d61 6b65 206c 696e 745c 6e5c 6e59 6f75  make lint\n\nYou
-00017bb0: 2063 616e 2072 6566 6f72 6d61 7420 7468   can reformat th
-00017bc0: 6520 636f 6465 2075 7369 6e67 2074 6865  e code using the
-00017bd0: 2066 6f6c 6c6f 7769 6e67 2063 6f6d 6d61   following comma
-00017be0: 6e64 2e5c 6e5c 6e20 2020 2024 206d 616b  nd.\n\n    $ mak
-00017bf0: 6520 666d 745c 6e5c 6e54 6573 7473 2062  e fmt\n\nTests b
-00017c00: 656c 6f6e 6720 696e 2060 2e2f 7465 7374  elong in `./test
-00017c10: 7360 2e20 436f 6465 2d75 6e64 6572 2d74  s`. Code-under-t
-00017c20: 6573 7420 6265 6c6f 6e67 7320 696e 2060  est belongs in `
-00017c30: 2e2f 6573 6462 636c 6965 6e74 602e 5c6e  ./esdbclient`.\n
-00017c40: 5c6e 4564 6974 2070 6163 6b61 6765 2064  \nEdit package d
-00017c50: 6570 656e 6465 6e63 6965 7320 696e 2060  ependencies in `
-00017c60: 7079 7072 6f6a 6563 742e 746f 6d6c 602e  pyproject.toml`.
-00017c70: 2055 7064 6174 6520 696e 7374 616c 6c65   Update installe
-00017c80: 6420 7061 636b 6167 6573 2028 616e 6420  d packages (and 
-00017c90: 7468 655c 6e60 706f 6574 7279 2e6c 6f63  the\n`poetry.loc
-00017ca0: 6b60 2066 696c 6529 2075 7369 6e67 2074  k` file) using t
-00017cb0: 6865 2066 6f6c 6c6f 7769 6e67 2063 6f6d  he following com
-00017cc0: 6d61 6e64 2e5c 6e5c 6e20 2020 2024 206d  mand.\n\n    $ m
-00017cd0: 616b 6520 7570 6461 7465 2d70 6163 6b61  ake update-packa
-00017ce0: 6765 735c 6e27 2c0a 2020 2020 2761 7574  ges\n',.    'aut
-00017cf0: 686f 7227 3a20 274a 6f68 6e20 4279 7761  hor': 'John Bywa
-00017d00: 7465 7227 2c0a 2020 2020 2761 7574 686f  ter',.    'autho
-00017d10: 725f 656d 6169 6c27 3a20 276a 6f68 6e2e  r_email': 'john.
-00017d20: 6279 7761 7465 7240 6170 7072 6f70 7269  bywater@appropri
-00017d30: 6174 6573 6f66 7477 6172 652e 6e65 7427  atesoftware.net'
-00017d40: 2c0a 2020 2020 276d 6169 6e74 6169 6e65  ,.    'maintaine
-00017d50: 7227 3a20 274e 6f6e 6527 2c0a 2020 2020  r': 'None',.    
-00017d60: 276d 6169 6e74 6169 6e65 725f 656d 6169  'maintainer_emai
-00017d70: 6c27 3a20 274e 6f6e 6527 2c0a 2020 2020  l': 'None',.    
-00017d80: 2775 726c 273a 2027 6874 7470 733a 2f2f  'url': 'https://
-00017d90: 6769 7468 7562 2e63 6f6d 2f70 7965 7665  github.com/pyeve
-00017da0: 6e74 736f 7572 6369 6e67 2f65 7364 6263  ntsourcing/esdbc
-00017db0: 6c69 656e 7427 2c0a 2020 2020 2770 6163  lient',.    'pac
-00017dc0: 6b61 6765 7327 3a20 7061 636b 6167 6573  kages': packages
-00017dd0: 2c0a 2020 2020 2770 6163 6b61 6765 5f64  ,.    'package_d
-00017de0: 6174 6127 3a20 7061 636b 6167 655f 6461  ata': package_da
-00017df0: 7461 2c0a 2020 2020 2769 6e73 7461 6c6c  ta,.    'install
-00017e00: 5f72 6571 7569 7265 7327 3a20 696e 7374  _requires': inst
-00017e10: 616c 6c5f 7265 7175 6972 6573 2c0a 2020  all_requires,.  
-00017e20: 2020 2770 7974 686f 6e5f 7265 7175 6972    'python_requir
-00017e30: 6573 273a 2027 3e3d 332e 372c 3c34 2e30  es': '>=3.7,<4.0
-00017e40: 272c 0a7d 0a0a 0a73 6574 7570 282a 2a73  ',.}...setup(**s
-00017e50: 6574 7570 5f6b 7761 7267 7329 0a         etup_kwargs).
+00013f90: 2020 2020 7365 6c66 2e73 7562 7363 7269      self.subscri
+00013fa0: 7074 696f 6e2e 6e61 636b 2865 7665 6e74  ption.nack(event
+00013fb0: 2e69 642c 2061 6374 696f 6e3d 6163 7469  .id, action=acti
+00013fc0: 6f6e 295c 6e20 2020 2020 2020 2020 2020  on)\n           
+00013fd0: 2020 2020 2020 2020 2073 656c 662e 6166           self.af
+00013fe0: 7465 725f 6e61 636b 2865 7665 6e74 2c20  ter_nack(event, 
+00013ff0: 6163 7469 6f6e 295c 6e20 2020 2020 2020  action)\n       
+00014000: 2020 2020 2020 2020 2065 6c73 653a 5c6e           else:\n
+00014010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014020: 2020 2020 7365 6c66 2e73 7562 7363 7269      self.subscri
+00014030: 7074 696f 6e2e 6163 6b28 6576 656e 742e  ption.ack(event.
+00014040: 6964 295c 6e20 2020 2020 2020 2020 2020  id)\n           
+00014050: 2020 2020 2020 2020 2073 656c 662e 6166           self.af
+00014060: 7465 725f 6163 6b28 6576 656e 7429 5c6e  ter_ack(event)\n
+00014070: 2020 2020 2020 2020 6578 6365 7074 2045          except E
+00014080: 7863 6570 7469 6f6e 3a5c 6e20 2020 2020  xception:\n     
+00014090: 2020 2020 2020 2073 656c 662e 7375 6273         self.subs
+000140a0: 6372 6970 7469 6f6e 2e73 746f 7028 295c  cription.stop()\
+000140b0: 6e20 2020 2020 2020 2020 2020 2072 6169  n            rai
+000140c0: 7365 5c6e 5c6e 2020 2020 6465 6620 7374  se\n\n    def st
+000140d0: 6f70 2873 656c 6629 3a5c 6e20 2020 2020  op(self):\n     
+000140e0: 2020 2073 656c 662e 7375 6273 6372 6970     self.subscrip
+000140f0: 7469 6f6e 2e73 746f 7028 295c 6e5c 6e20  tion.stop()\n\n 
+00014100: 2020 2064 6566 2070 6f6c 6963 7928 7365     def policy(se
+00014110: 6c66 2c20 6576 656e 7429 3a5c 6e20 2020  lf, event):\n   
+00014120: 2020 2020 2023 2052 6169 7365 2061 6e20       # Raise an 
+00014130: 6578 6365 7074 696f 6e20 7768 656e 2077  exception when w
+00014140: 6520 7365 6520 2265 7665 6e74 3522 2e5c  e see "event5".\
+00014150: 6e20 2020 2020 2020 2069 6620 6576 656e  n        if even
+00014160: 742e 6964 203d 3d20 6576 656e 7435 2e69  t.id == event5.i
+00014170: 643a 5c6e 2020 2020 2020 2020 2020 2020  d:\n            
+00014180: 7261 6973 6520 4578 6365 7074 696f 6e28  raise Exception(
+00014190: 295c 6e5c 6e20 2020 2064 6566 2061 6674  )\n\n    def aft
+000141a0: 6572 5f61 636b 2873 656c 662c 2065 7665  er_ack(self, eve
+000141b0: 6e74 293a 5c6e 2020 2020 2020 2020 2320  nt):\n        # 
+000141c0: 5472 6163 6b20 7265 7472 7920 636f 756e  Track retry coun
+000141d0: 7420 6f66 2061 636b 6564 2065 7665 6e74  t of acked event
+000141e0: 732e 5c6e 2020 2020 2020 2020 6163 6b65  s.\n        acke
+000141f0: 645f 6576 656e 7473 5b65 7665 6e74 2e69  d_events[event.i
+00014200: 645d 203d 2065 7665 6e74 2e72 6574 7279  d] = event.retry
+00014210: 5f63 6f75 6e74 5c6e 5c6e 2020 2020 6465  _count\n\n    de
+00014220: 6620 6166 7465 725f 6e61 636b 2873 656c  f after_nack(sel
+00014230: 662c 2065 7665 6e74 2c20 6163 7469 6f6e  f, event, action
+00014240: 293a 5c6e 2020 2020 2020 2020 2320 5472  ):\n        # Tr
+00014250: 6163 6b20 7265 7472 7920 636f 756e 7420  ack retry count 
+00014260: 6f66 206e 6163 6b65 6420 6576 656e 7473  of nacked events
+00014270: 2e5c 6e20 2020 2020 2020 206e 6163 6b65  .\n        nacke
+00014280: 645f 6576 656e 7473 5b65 7665 6e74 2e69  d_events[event.i
+00014290: 645d 203d 2065 7665 6e74 2e72 6574 7279  d] = event.retry
+000142a0: 5f63 6f75 6e74 5c6e 5c6e 2020 2020 2020  _count\n\n      
+000142b0: 2020 6966 2061 6374 696f 6e20 3d3d 2073    if action == s
+000142c0: 656c 662e 6669 6e61 6c5f 6163 7469 6f6e  elf.final_action
+000142d0: 3a5c 6e20 2020 2020 2020 2020 2020 2023  :\n            #
+000142e0: 2053 746f 7020 7468 6520 636f 6e73 756d   Stop the consum
+000142f0: 6572 2c20 736f 2077 6520 6361 6e20 636f  er, so we can co
+00014300: 6e74 696e 7565 2077 6974 6820 7468 6520  ntinue with the 
+00014310: 6578 616d 706c 6573 2e5c 6e20 2020 2020  examples.\n     
+00014320: 2020 2020 2020 2073 656c 662e 7374 6f70         self.stop
+00014330: 2829 5c6e 5c6e 5c6e 2320 4372 6561 7465  ()\n\n\n# Create
+00014340: 2073 7562 7363 7269 7074 696f 6e2e 5c6e   subscription.\n
+00014350: 6772 6f75 705f 6e61 6d65 203d 2066 2267  group_name = f"g
+00014360: 726f 7570 2d7b 7575 6964 3428 297d 225c  roup-{uuid4()}"\
+00014370: 6e63 6c69 656e 742e 6372 6561 7465 5f73  nclient.create_s
+00014380: 7562 7363 7269 7074 696f 6e28 6772 6f75  ubscription(grou
+00014390: 705f 6e61 6d65 2c20 636f 6d6d 6974 5f70  p_name, commit_p
+000143a0: 6f73 6974 696f 6e3d 636f 6d6d 6974 5f70  osition=commit_p
+000143b0: 6f73 6974 696f 6e31 295c 6e5c 6e23 2052  osition1)\n\n# R
+000143c0: 6561 6420 7375 6273 6372 6970 7469 6f6e  ead subscription
+000143d0: 2e5c 6e73 7562 7363 7269 7074 696f 6e20  .\nsubscription 
+000143e0: 3d20 636c 6965 6e74 2e72 6561 645f 7375  = client.read_su
+000143f0: 6273 6372 6970 7469 6f6e 2867 726f 7570  bscription(group
+00014400: 5f6e 616d 6529 5c6e 5c6e 2320 436f 6e73  _name)\n\n# Cons
+00014410: 7472 7563 7420 636f 6e73 756d 6572 2e5c  truct consumer.\
+00014420: 6e63 6f6e 7375 6d65 7220 3d20 4578 616d  nconsumer = Exam
+00014430: 706c 6543 6f6e 7375 6d65 7228 5c6e 2020  pleConsumer(\n  
+00014440: 2020 7375 6273 6372 6970 7469 6f6e 3d73    subscription=s
+00014450: 7562 7363 7269 7074 696f 6e2c 5c6e 2020  ubscription,\n  
+00014460: 2020 6d61 785f 7265 7472 6965 733d 352c    max_retries=5,
+00014470: 5c6e 2020 2020 6669 6e61 6c5f 6163 7469  \n    final_acti
+00014480: 6f6e 3d22 7061 726b 222c 5c6e 295c 6e5c  on="park",\n)\n\
+00014490: 6e23 2052 756e 2063 6f6e 7375 6d65 722e  n# Run consumer.
+000144a0: 5c6e 636f 6e73 756d 6572 2e72 756e 2829  \nconsumer.run()
+000144b0: 5c6e 5c6e 2320 4368 6563 6b20 5c27 6576  \n\n# Check \'ev
+000144c0: 656e 7431 315c 2720 7761 7320 6163 6b65  ent11\' was acke
+000144d0: 6420 616e 6420 6e65 7665 7220 7265 7472  d and never retr
+000144e0: 6965 642e 5c6e 6173 7365 7274 2061 636b  ied.\nassert ack
+000144f0: 6564 5f65 7665 6e74 735b 6576 656e 7431  ed_events[event1
+00014500: 312e 6964 5d20 3d3d 2030 5c6e 6173 7365  1.id] == 0\nasse
+00014510: 7274 2065 7665 6e74 3131 2e69 6420 6e6f  rt event11.id no
+00014520: 7420 696e 206e 6163 6b65 645f 6576 656e  t in nacked_even
+00014530: 7473 5c6e 5c6e 2320 4368 6563 6b20 5c27  ts\n\n# Check \'
+00014540: 6576 656e 7435 5c27 2077 6173 2072 6574  event5\' was ret
+00014550: 7269 6564 2066 6976 6520 7469 6d65 7320  ried five times 
+00014560: 616e 6420 6e65 7665 7220 6163 6b65 642e  and never acked.
+00014570: 5c6e 6173 7365 7274 206e 6163 6b65 645f  \nassert nacked_
+00014580: 6576 656e 7473 5b65 7665 6e74 352e 6964  events[event5.id
+00014590: 5d20 3d3d 2035 5c6e 6173 7365 7274 2065  ] == 5\nassert e
+000145a0: 7665 6e74 352e 6964 206e 6f74 2069 6e20  vent5.id not in 
+000145b0: 6163 6b65 645f 6576 656e 7473 5c6e 6060  acked_events\n``
+000145c0: 605c 6e5c 6e23 2320 436f 6e6e 6563 7469  `\n\n## Connecti
+000145d0: 6f6e 5c6e 5c6e 2323 2320 5265 636f 6e6e  on\n\n### Reconn
+000145e0: 6563 745c 6e5c 6e54 6865 2060 7265 636f  ect\n\nThe `reco
+000145f0: 6e6e 6563 7428 2960 206d 6574 686f 6420  nnect()` method 
+00014600: 6361 6e20 6265 2075 7365 6420 746f 206d  can be used to m
+00014610: 616e 7561 6c6c 7920 7265 636f 6e6e 6563  anually reconnec
+00014620: 7420 7468 6520 636c 6965 6e74 2074 6f20  t the client to 
+00014630: 615c 6e73 7569 7461 626c 6520 4576 656e  a\nsuitable Even
+00014640: 7453 746f 7265 4442 206e 6f64 652e 2054  tStoreDB node. T
+00014650: 6869 7320 6d65 7468 6f64 2075 7365 7320  his method uses 
+00014660: 7468 6520 7361 6d65 2072 6f75 7469 6e65  the same routine
+00014670: 2066 6f72 2072 6561 6469 6e67 2074 6865   for reading the
+00014680: 5c6e 636c 7573 7465 7220 6e6f 6465 2073  \ncluster node s
+00014690: 7461 7465 7320 616e 6420 7468 656e 2063  tates and then c
+000146a0: 6f6e 6e65 6374 696e 6720 746f 2061 2073  onnecting to a s
+000146b0: 7569 7461 626c 6520 6e6f 6465 2061 6363  uitable node acc
+000146c0: 6f72 6469 6e67 2074 6f20 7468 655c 6e63  ording to the\nc
+000146d0: 6c69 656e 745c 2773 206e 6f64 6520 7072  lient\'s node pr
+000146e0: 6566 6572 656e 6365 2074 6861 7420 6973  eference that is
+000146f0: 2073 7065 6369 6669 6564 2069 6e20 7468   specified in th
+00014700: 6520 636f 6e6e 6563 7469 6f6e 2073 7472  e connection str
+00014710: 696e 6720 5552 4920 7768 656e 5c6e 7468  ing URI when\nth
+00014720: 6520 636c 6965 6e74 2069 7320 636f 6e73  e client is cons
+00014730: 7472 7563 7465 642e 2054 6869 7320 6d65  tructed. This me
+00014740: 7468 6f64 2069 7320 7468 7265 6164 2d73  thod is thread-s
+00014750: 6166 652c 2061 6e64 2069 7420 6973 2022  afe, and it is "
+00014760: 636f 6e73 6572 7661 7469 7665 225c 6e69  conservative"\ni
+00014770: 6e20 7468 6174 2c20 7768 656e 2069 7420  n that, when it 
+00014780: 6973 2063 616c 6c65 6420 6279 2073 6576  is called by sev
+00014790: 6572 616c 2074 6872 6561 6473 2061 7420  eral threads at 
+000147a0: 7468 6520 7361 6d65 2074 696d 652c 206f  the same time, o
+000147b0: 6e6c 7920 6f6e 655c 6e72 6563 6f6e 6e65  nly one\nreconne
+000147c0: 6374 696f 6e20 7769 6c6c 206f 6363 7572  ction will occur
+000147d0: 2e20 436f 6e63 7572 7265 6e74 2061 7474  . Concurrent att
+000147e0: 656d 7074 7320 746f 2072 6563 6f6e 6e65  empts to reconne
+000147f0: 6374 2077 696c 6c20 626c 6f63 6b20 756e  ct will block un
+00014800: 7469 6c5c 6e74 6865 2063 6c69 656e 7420  til\nthe client 
+00014810: 6861 7320 7265 636f 6e6e 6563 7465 6420  has reconnected 
+00014820: 7375 6363 6573 7366 756c 6c79 2c20 616e  successfully, an
+00014830: 6420 7468 656e 2074 6865 7920 7769 6c6c  d then they will
+00014840: 2061 6c6c 2072 6574 7572 6e20 6e6f 726d   all return norm
+00014850: 616c 6c79 2e5c 6e5c 6e60 6060 7079 7468  ally.\n\n```pyth
+00014860: 6f6e 5c6e 636c 6965 6e74 2e72 6563 6f6e  on\nclient.recon
+00014870: 6e65 6374 2829 5c6e 6060 605c 6e5c 6e41  nect()\n```\n\nA
+00014880: 6e20 6578 616d 706c 6520 6f66 2077 6865  n example of whe
+00014890: 6e20 6974 206d 6967 6874 2062 6520 6465  n it might be de
+000148a0: 7369 7261 626c 6520 746f 2072 6563 6f6e  sirable to recon
+000148b0: 6e65 6374 206d 616e 7561 6c6c 7920 6973  nect manually is
+000148c0: 2077 6865 6e20 2866 6f72 2070 6572 666f   when (for perfo
+000148d0: 726d 616e 6365 5c6e 7265 6173 6f6e 7329  rmance\nreasons)
+000148e0: 2074 6865 2063 6c69 656e 745c 2773 206e   the client\'s n
+000148f0: 6f64 6520 7072 6566 6572 656e 6365 2069  ode preference i
+00014900: 7320 746f 2062 6520 636f 6e6e 6563 7465  s to be connecte
+00014910: 6420 746f 2061 2066 6f6c 6c6f 7765 7220  d to a follower 
+00014920: 6e6f 6465 2069 6e20 7468 655c 6e63 6c75  node in the\nclu
+00014930: 7374 6572 2c20 616e 642c 2061 6674 6572  ster, and, after
+00014940: 2061 2063 6c75 7374 6572 206c 6561 6465   a cluster leade
+00014950: 7220 656c 6563 7469 6f6e 2c20 7468 6520  r election, the 
+00014960: 666f 6c6c 6f77 6572 2062 6563 6f6d 6573  follower becomes
+00014970: 2074 6865 206c 6561 6465 722e 5c6e 5265   the leader.\nRe
+00014980: 636f 6e6e 6563 7469 6e67 2074 6f20 6120  connecting to a 
+00014990: 666f 6c6c 6f77 6572 206e 6f64 6520 696e  follower node in
+000149a0: 2074 6869 7320 6361 7365 2069 7320 6375   this case is cu
+000149b0: 7272 656e 746c 7920 6265 796f 6e64 2074  rrently beyond t
+000149c0: 6865 2063 6170 6162 696c 6974 6965 7320  he capabilities 
+000149d0: 6f66 5c6e 7468 6973 2063 6c69 656e 742c  of\nthis client,
+000149e0: 2062 7574 2074 6869 7320 6265 6861 7669   but this behavi
+000149f0: 6f72 206d 6967 6874 2062 6520 696d 706c  or might be impl
+00014a00: 656d 656e 7465 6420 696e 2061 2066 7574  emented in a fut
+00014a10: 7572 6520 7265 6c65 6173 652e 5c6e 5c6e  ure release.\n\n
+00014a20: 506c 6561 7365 206e 6f74 652c 206e 6561  Please note, nea
+00014a30: 726c 7920 616c 6c20 7468 6520 636c 6965  rly all the clie
+00014a40: 6e74 206d 6574 686f 6473 2061 7265 2064  nt methods are d
+00014a50: 6563 6f72 6174 6564 2077 6974 6820 6040  ecorated with `@
+00014a60: 6175 746f 7265 636f 6e6e 6563 7460 2028  autoreconnect` (
+00014a70: 7768 6963 685c 6e63 616c 6c73 2074 6865  which\ncalls the
+00014a80: 2060 7265 636f 6e6e 6563 7428 2960 206d   `reconnect()` m
+00014a90: 6574 686f 6420 7768 656e 2074 6865 2063  ethod when the c
+00014aa0: 6c69 656e 7420 6465 7465 6374 7320 7468  lient detects th
+00014ab0: 6174 2072 6563 6f6e 6e65 6374 696e 6720  at reconnecting 
+00014ac0: 6973 2072 6571 7569 7265 6429 5c6e 616e  is required)\nan
+00014ad0: 6420 6120 6040 7265 7472 7960 2064 6563  d a `@retry` dec
+00014ae0: 6f72 6174 6f72 2074 6861 7420 6d6f 7265  orator that more
+00014af0: 2067 656e 6572 616c 6c79 2077 696c 6c20   generally will 
+00014b00: 7265 7472 7920 6f70 6572 6174 696f 6e73  retry operations
+00014b10: 2074 6861 7420 6661 696c 2064 7565 2074   that fail due t
+00014b20: 6f5c 6e63 6f6e 6e65 6374 696f 6e20 6973  o\nconnection is
+00014b30: 7375 6573 2e5c 6e5c 6e54 6865 2060 4061  sues.\n\nThe `@a
+00014b40: 7574 6f72 6563 6f6e 6e65 6374 6020 6465  utoreconnect` de
+00014b50: 636f 7261 746f 7220 7769 6c6c 2072 6563  corator will rec
+00014b60: 6f6e 6e65 6374 2074 6f20 6120 7375 6974  onnect to a suit
+00014b70: 6162 6c65 206e 6f64 6520 696e 2074 6865  able node in the
+00014b80: 2063 6c75 7374 6572 2077 6865 6e5c 6e74   cluster when\nt
+00014b90: 6865 2073 6572 7665 7220 746f 2077 6869  he server to whi
+00014ba0: 6368 2074 6865 2063 6c69 656e 7420 6861  ch the client ha
+00014bb0: 7320 6265 656e 2063 6f6e 6e65 6374 6564  s been connected
+00014bc0: 2068 6173 2062 6563 6f6d 6520 756e 6176   has become unav
+00014bd0: 6169 6c61 626c 652c 206f 7220 7768 656e  ailable, or when
+00014be0: 2074 6865 5c6e 636c 6965 6e74 5c27 7320   the\nclient\'s 
+00014bf0: 6752 5043 2063 6861 6e6e 656c 2068 6170  gRPC channel hap
+00014c00: 7065 6e73 2074 6f20 6861 7665 2062 6565  pens to have bee
+00014c10: 6e20 636c 6f73 6564 2e20 5468 6520 636c  n closed. The cl
+00014c20: 6965 6e74 2077 696c 6c20 616c 736f 2072  ient will also r
+00014c30: 6563 6f6e 6e65 6374 2077 6865 6e5c 6e61  econnect when\na
+00014c40: 206d 6574 686f 6420 6973 2063 616c 6c65   method is calle
+00014c50: 6420 7468 6174 2072 6571 7569 7265 7320  d that requires 
+00014c60: 6120 6c65 6164 6572 2c20 616e 6420 7468  a leader, and th
+00014c70: 6520 636c 6965 6e74 5c27 7320 6e6f 6465  e client\'s node
+00014c80: 2070 7265 6665 7265 6e63 6520 6973 2074   preference is t
+00014c90: 6f20 6265 5c6e 636f 6e6e 6563 7465 6420  o be\nconnected 
+00014ca0: 746f 2061 206c 6561 6465 722c 2062 7574  to a leader, but
+00014cb0: 2074 6865 206e 6f64 6520 7468 6174 2074   the node that t
+00014cc0: 6865 2063 6c69 656e 7420 6861 7320 6265  he client has be
+00014cd0: 656e 2063 6f6e 6e65 6374 6564 2074 6f20  en connected to 
+00014ce0: 7374 6f70 7320 6265 696e 675c 6e74 6865  stops being\nthe
+00014cf0: 206c 6561 6465 722e 2049 6e20 7468 6973   leader. In this
+00014d00: 2063 6173 652c 2074 6865 2063 6c69 656e   case, the clien
+00014d10: 7420 7769 6c6c 2072 6563 6f6e 6e65 6374  t will reconnect
+00014d20: 2074 6f20 7468 6520 6375 7272 656e 7420   to the current 
+00014d30: 6c65 6164 6572 2e20 4166 7465 725c 6e72  leader. After\nr
+00014d40: 6563 6f6e 6e65 6374 696e 672c 2074 6865  econnecting, the
+00014d50: 2066 6169 6c65 6420 6f70 6572 6174 696f   failed operatio
+00014d60: 6e20 7769 6c6c 2062 6520 7265 7472 6965  n will be retrie
+00014d70: 642e 5c6e 5c6e 5468 6520 6040 7265 7472  d.\n\nThe `@retr
+00014d80: 7960 2064 6563 6f72 6174 6f72 2072 6574  y` decorator ret
+00014d90: 7269 6573 206f 7065 7261 7469 6f6e 7320  ries operations 
+00014da0: 7468 6174 2068 6176 6520 6661 696c 6564  that have failed
+00014db0: 2064 7565 2074 6f20 6d6f 7265 2067 656e   due to more gen
+00014dc0: 6572 616c 5c6e 636f 6e6e 6563 7469 6f6e  eral\nconnection
+00014dd0: 2069 7373 7565 732c 2073 7563 6820 6173   issues, such as
+00014de0: 2061 2064 6561 646c 696e 6520 6265 696e   a deadline bein
+00014df0: 6720 7265 6163 6865 6420 2873 6f20 7468  g reached (so th
+00014e00: 6174 2074 6865 206f 7065 7261 7469 6f6e  at the operation
+00014e10: 2074 696d 6573 5c6e 6f75 7429 2c20 6f72   times\nout), or
+00014e20: 2069 6e20 6361 7365 2074 6865 2073 6572   in case the ser
+00014e30: 7665 7220 7468 726f 7773 2061 6e20 6578  ver throws an ex
+00014e40: 6365 7074 696f 6e20 7768 656e 2068 616e  ception when han
+00014e50: 646c 696e 6720 6120 636c 6965 6e74 2072  dling a client r
+00014e60: 6571 7565 7374 2e5c 6e5c 6e50 6c65 6173  equest.\n\nPleas
+00014e70: 6520 616c 736f 206e 6f74 652c 2074 6865  e also note, the
+00014e80: 2061 7370 6563 7473 206e 6f74 2063 6f76   aspects not cov
+00014e90: 6572 6564 2062 7920 7468 6520 7265 636f  ered by the reco
+00014ea0: 6e6e 6563 7420 616e 6420 7265 7472 7920  nnect and retry 
+00014eb0: 6465 636f 7261 746f 725c 6e62 6568 6176  decorator\nbehav
+00014ec0: 696f 7572 7320 6861 7665 2074 6f20 646f  iours have to do
+00014ed0: 2077 6974 6820 6d65 7468 6f64 7320 7468   with methods th
+00014ee0: 6174 2072 6574 7572 6e20 6974 6572 6174  at return iterat
+00014ef0: 6f72 732e 2046 6f72 2065 7861 6d70 6c65  ors. For example
+00014f00: 2c20 636f 6e73 6964 6572 5c6e 7468 6520  , consider\nthe 
+00014f10: 6072 6561 645f 616c 6c5f 6576 656e 7473  `read_all_events
+00014f20: 2829 6020 6d65 7468 6f64 2c20 7768 6963  ()` method, whic
+00014f30: 6820 7265 7475 726e 7320 616e 2069 7465  h returns an ite
+00014f40: 7261 746f 7220 6f66 2060 5265 636f 7264  rator of `Record
+00014f50: 6564 4576 656e 7460 206f 626a 6563 7473  edEvent` objects
+00014f60: 2e5c 6e54 6865 206d 6574 686f 6420 6861  .\nThe method ha
+00014f70: 7320 7265 7475 726e 6564 2061 6e64 2074  s returned and t
+00014f80: 6865 206d 6574 686f 6420 6465 636f 7261  he method decora
+00014f90: 746f 7273 2068 6176 6520 7468 6572 6566  tors have theref
+00014fa0: 6f72 6520 6578 6974 6564 2062 6566 6f72  ore exited befor
+00014fb0: 6520 7468 655c 6e69 7465 7261 7469 6e67  e the\niterating
+00014fc0: 206f 6620 7468 6520 7265 7370 6f6e 7365   of the response
+00014fd0: 2062 6567 696e 732e 2054 6865 7265 666f   begins. Therefo
+00014fe0: 7265 2c20 6974 2069 736e 5c27 7420 706f  re, it isn\'t po
+00014ff0: 7373 6962 6c65 2066 6f72 2074 6869 7320  ssible for this 
+00015000: 6d65 7468 6f64 2074 6f5c 6e74 7269 6767  method to\ntrigg
+00015010: 6572 2061 2072 6563 6f6e 6e65 6374 696f  er a reconnectio
+00015020: 6e20 6f72 2066 6f72 2069 7420 746f 2072  n or for it to r
+00015030: 6574 7279 2c20 7768 656e 2074 6865 2073  etry, when the s
+00015040: 7472 6561 6d69 6e67 2072 6573 706f 6e73  treaming respons
+00015050: 6520 736f 6d65 686f 7720 6661 696c 732e  e somehow fails.
+00015060: 5c6e 5c6e 416e 6f74 6865 7220 6578 616d  \n\nAnother exam
+00015070: 706c 6520 6973 2074 6865 2022 6361 7463  ple is the "catc
+00015080: 682d 7570 2220 616e 6420 7065 7273 6973  h-up" and persis
+00015090: 7465 6e74 2073 7562 7363 7269 7074 696f  tent subscriptio
+000150a0: 6e20 7265 6164 206d 6574 686f 6473 2c20  n read methods, 
+000150b0: 616c 7468 6f75 6768 5c6e 7769 7468 2074  although\nwith t
+000150c0: 6865 7365 206d 6574 686f 6473 2074 6865  hese methods the
+000150d0: 7265 2069 7320 616e 2069 6e69 7469 616c  re is an initial
+000150e0: 2022 636f 6e66 6972 6d61 7469 6f6e 2220   "confirmation" 
+000150f0: 7265 7370 6f6e 7365 2066 726f 6d20 7468  response from th
+00015100: 6520 7365 7276 6572 2077 6869 6368 5c6e  e server which\n
+00015110: 6973 2072 6563 6569 7665 6420 616e 6420  is received and 
+00015120: 6368 6563 6b65 6420 6279 2074 6865 2063  checked by the c
+00015130: 6c69 656e 7420 6265 666f 7265 2074 6865  lient before the
+00015140: 206d 6574 686f 6420 7265 7475 726e 732c   method returns,
+00015150: 2073 6f20 6966 2074 6865 2073 6572 7665   so if the serve
+00015160: 7220 6973 5c6e 756e 6176 6169 6c61 626c  r is\nunavailabl
+00015170: 6520 7768 656e 2074 6865 2063 616c 6c20  e when the call 
+00015180: 6973 206d 6164 652c 206f 7220 6966 2074  is made, or if t
+00015190: 6865 2063 6861 6e6e 656c 2069 7320 736f  he channel is so
+000151a0: 6d65 686f 7720 636c 6f73 6564 2c20 6f72  mehow closed, or
+000151b0: 2069 6620 7468 655c 6e73 6572 7665 7220   if the\nserver 
+000151c0: 7468 726f 7773 2061 6e20 6572 726f 7220  throws an error 
+000151d0: 666f 7220 736f 6d65 2072 6561 736f 6e2c  for some reason,
+000151e0: 2074 6865 6e20 7468 6520 636c 6965 6e74   then the client
+000151f0: 2077 696c 6c20 6569 7468 6572 2072 6563   will either rec
+00015200: 6f6e 6e65 6374 2061 6e64 5c6e 7265 7472  onnect and\nretr
+00015210: 792c 206f 7220 6d6f 7265 2073 696d 706c  y, or more simpl
+00015220: 7920 6a75 7374 2072 6574 7279 2074 6865  y just retry the
+00015230: 206f 7065 7261 7469 6f6e 2c20 6163 636f   operation, acco
+00015240: 7264 696e 6720 7468 6520 7479 7065 206f  rding the type o
+00015250: 6620 6572 726f 7220 7468 6174 5c6e 7761  f error that\nwa
+00015260: 7320 656e 636f 756e 7465 7265 642e 2048  s encountered. H
+00015270: 6f77 6576 6572 2c20 616e 2065 7665 6e74  owever, an event
+00015280: 2d70 726f 6365 7373 696e 6720 636f 6d70  -processing comp
+00015290: 6f6e 656e 7420 7468 6174 2069 7465 7261  onent that itera
+000152a0: 7465 7320 6f76 6572 2061 5c6e 7375 6363  tes over a\nsucc
+000152b0: 6573 7366 756c 6c79 2072 6574 7572 6e65  essfully returne
+000152c0: 6420 2263 6174 6368 2d75 7022 2073 7562  d "catch-up" sub
+000152d0: 7363 7269 7074 696f 6e20 7265 7370 6f6e  scription respon
+000152e0: 7365 2077 696c 6c20 6e65 6564 2074 6f20  se will need to 
+000152f0: 6265 206d 6f6e 6974 6f72 6564 2066 6f72  be monitored for
+00015300: 5c6e 6572 726f 7273 2c20 616e 642c 2069  \nerrors, and, i
+00015310: 6620 6974 2066 6169 6c73 2061 6674 6572  f it fails after
+00015320: 2069 7420 6861 7320 7374 6172 7465 6420   it has started 
+00015330: 6974 6572 6174 696e 6720 6f76 6572 2074  iterating over t
+00015340: 6865 2072 6573 706f 6e73 652c 2074 6865  he response, the
+00015350: 2063 6174 6368 2d75 705c 6e73 7562 7363   catch-up\nsubsc
+00015360: 7269 7074 696f 6e20 7769 6c6c 206e 6565  ription will nee
+00015370: 6420 746f 2062 6520 7265 7374 6172 7465  d to be restarte
+00015380: 6420 6672 6f6d 2074 6865 2065 7665 6e74  d from the event
+00015390: 2d70 726f 6365 7373 696e 6720 636f 6d70  -processing comp
+000153a0: 6f6e 656e 745c 2773 2022 6c61 7374 5c6e  onent\'s "last\n
+000153b0: 7361 7665 6420 636f 6d6d 6974 2070 6f73  saved commit pos
+000153c0: 6974 696f 6e22 2e20 4966 2074 6865 2065  ition". If the e
+000153d0: 7665 6e74 2d70 726f 6365 7373 696e 6720  vent-processing 
+000153e0: 636f 6d70 6f6e 656e 7420 6973 2072 6563  component is rec
+000153f0: 6f72 6469 6e67 2074 6865 2063 6f6d 6d69  ording the commi
+00015400: 745c 6e70 6f73 6974 696f 6e20 6f66 2065  t\nposition of e
+00015410: 6163 6820 7265 636f 7264 6564 2065 7665  ach recorded eve
+00015420: 6e74 2061 746f 6d69 6361 6c6c 7920 616c  nt atomically al
+00015430: 6f6e 6720 7769 7468 2061 6e79 206e 6577  ong with any new
+00015440: 2073 7461 7465 2074 6861 7420 7265 7375   state that resu
+00015450: 6c74 7320 6672 6f6d 5c6e 7072 6f63 6573  lts from\nproces
+00015460: 7369 6e67 2074 6865 2072 6563 6f72 6465  sing the recorde
+00015470: 6420 6576 656e 7473 2c20 616e 6420 7468  d events, and th
+00015480: 6520 636f 6d6d 6974 2070 6f73 6974 696f  e commit positio
+00015490: 6e73 2061 7265 2072 6563 6f72 6465 6420  ns are recorded 
+000154a0: 7769 7468 2061 2075 6e69 7175 656e 6573  with a uniquenes
+000154b0: 735c 6e63 6f6e 7374 7261 696e 742c 2074  s\nconstraint, t
+000154c0: 6865 6e20 7468 6572 6520 7769 6c6c 206e  hen there will n
+000154d0: 6f20 6461 6e67 6572 2074 6f20 7468 6520  o danger to the 
+000154e0: 7072 6f6a 6563 7465 6420 7374 6174 6520  projected state 
+000154f0: 6265 636f 6d69 6e67 2069 6e63 6f6e 7369  becoming inconsi
+00015500: 7374 656e 7420 6475 655c 6e74 6f20 7468  stent due\nto th
+00015510: 6573 6520 636f 6e6e 6563 7469 6f6e 2069  ese connection i
+00015520: 7373 7565 732e 2049 6e20 7468 6973 2063  ssues. In this c
+00015530: 6173 652c 2074 6865 2063 6c69 656e 7420  ase, the client 
+00015540: 7769 6c6c 2061 7574 6f6d 6174 6963 616c  will automatical
+00015550: 6c79 2072 6563 6f6e 6e65 6374 2074 6f20  ly reconnect to 
+00015560: 615c 6e6e 6f64 6520 696e 2074 6865 2063  a\nnode in the c
+00015570: 6c75 7374 6572 2077 6865 6e20 7468 6520  luster when the 
+00015580: 7375 6273 6571 7565 6e74 2063 616c 6c20  subsequent call 
+00015590: 746f 2061 2063 6174 6368 2d75 7020 7375  to a catch-up su
+000155a0: 6273 6372 6970 7469 6f6e 206d 6574 686f  bscription metho
+000155b0: 6420 6973 206d 6164 652e 5c6e 596f 7520  d is made.\nYou 
+000155c0: 6a75 7374 206e 6565 6420 746f 2068 616e  just need to han
+000155d0: 646c 6520 7468 6520 6578 6365 7074 696f  dle the exceptio
+000155e0: 6e20 7468 6174 206f 6363 7572 7320 6672  n that occurs fr
+000155f0: 6f6d 2074 6865 2069 7465 7261 746f 722c  om the iterator,
+00015600: 2074 6865 6e20 7265 6164 2079 6f75 7220   then read your 
+00015610: 6c61 7374 5c6e 7361 7665 6420 636f 6d6d  last\nsaved comm
+00015620: 6974 2070 6f73 6974 696f 6e2c 2061 6e64  it position, and
+00015630: 2074 6865 6e20 7265 7374 6172 7420 796f   then restart yo
+00015640: 7572 2065 7665 6e74 2d70 726f 6365 7373  ur event-process
+00015650: 696e 6720 636f 6d70 6f6e 656e 742c 2075  ing component, u
+00015660: 7369 6e67 2074 6865 2073 616d 655c 6e63  sing the same\nc
+00015670: 6c69 656e 7420 6f62 6a65 6374 2e20 5468  lient object. Th
+00015680: 6520 636c 6965 6e74 2077 696c 6c20 7265  e client will re
+00015690: 636f 6e6e 6563 7420 6966 2074 6865 7265  connect if there
+000156a0: 2069 7320 6120 6e65 6564 2074 6f20 646f   is a need to do
+000156b0: 2073 6f20 7768 656e 2074 6865 2073 7562   so when the sub
+000156c0: 7365 7175 656e 745c 6e63 616c 6c20 6973  sequent\ncall is
+000156d0: 206d 6164 652e 2053 696d 696c 6172 6c79   made. Similarly
+000156e0: 2c20 7768 656e 2072 6561 6469 6e67 2070  , when reading p
+000156f0: 6572 7369 7374 656e 7420 7375 6273 6372  ersistent subscr
+00015700: 6970 7469 6f6e 732c 2069 6620 7468 6572  iptions, if ther
+00015710: 6520 6172 655c 6e63 6f6e 6e65 6374 6976  e are\nconnectiv
+00015720: 6974 7920 6973 7375 6573 2061 6674 6572  ity issues after
+00015730: 2079 6f75 2068 6176 6520 7374 6172 7465   you have starte
+00015740: 6420 6974 6572 6174 696e 6720 6f76 6572  d iterating over
+00015750: 2061 2073 7563 6365 7373 6675 6c6c 7920   a successfully 
+00015760: 7265 6365 6976 6564 5c6e 7265 7370 6f6e  received\nrespon
+00015770: 7365 2c20 7468 656e 2074 6865 2073 6572  se, then the ser
+00015780: 7665 7220 6361 6c6c 2077 696c 6c20 6e65  ver call will ne
+00015790: 6564 2074 6f20 6265 2072 6573 7461 7274  ed to be restart
+000157a0: 6564 2e20 496e 2074 6869 7320 6361 7365  ed. In this case
+000157b0: 2c20 7468 6520 7265 6365 6976 6564 5c6e  , the received\n
+000157c0: 6576 656e 7473 2077 696c 6c20 7374 6172  events will star
+000157d0: 7420 7769 7468 2074 6865 206c 6173 7420  t with the last 
+000157e0: 7361 7665 6420 6368 6563 6b70 6f69 6e74  saved checkpoint
+000157f0: 206f 6e20 7468 6520 7365 7276 6572 2028   on the server (
+00015800: 706f 7465 6e74 6961 6c6c 7920 7265 7475  potentially retu
+00015810: 726e 696e 675c 6e65 7665 6e74 7320 7468  rning\nevents th
+00015820: 6174 2077 6572 6520 696e 2066 6163 7420  at were in fact 
+00015830: 7375 6363 6573 7366 756c 6c79 2070 726f  successfully pro
+00015840: 6365 7373 6564 292e 5c6e 5c6e 5c6e 2323  cessed).\n\n\n##
+00015850: 2320 436c 6f73 655c 6e5c 6e54 6865 2060  # Close\n\nThe `
+00015860: 636c 6f73 6528 2960 206d 6574 686f 6420  close()` method 
+00015870: 6361 6e20 6265 2075 7365 6420 746f 2063  can be used to c
+00015880: 6c65 616e 6c79 2063 6c6f 7365 2074 6865  leanly close the
+00015890: 2067 5250 4320 636f 6e6e 6563 7469 6f6e   gRPC connection
+000158a0: 2e5c 6e5c 6e60 6060 7079 7468 6f6e 5c6e  .\n\n```python\n
+000158b0: 636c 6965 6e74 2e63 6c6f 7365 2829 5c6e  client.close()\n
+000158c0: 6060 605c 6e5c 6e23 2320 4e6f 7465 735c  ```\n\n## Notes\
+000158d0: 6e5c 6e23 2323 2043 6f6e 6e65 6374 696f  n\n### Connectio
+000158e0: 6e20 7374 7269 6e67 735c 6e5c 6e54 6865  n strings\n\nThe
+000158f0: 2045 7665 6e74 5374 6f72 6544 4220 636f   EventStoreDB co
+00015900: 6e6e 6563 7469 6f6e 2073 7472 696e 6720  nnection string 
+00015910: 6973 2061 2055 5249 2074 6861 7420 636f  is a URI that co
+00015920: 6e66 6f72 6d73 2077 6974 6820 6f6e 6520  nforms with one 
+00015930: 6f66 2074 776f 2070 6f73 7369 626c 655c  of two possible\
+00015940: 6e73 6368 656d 6573 2c20 6569 7468 6572  nschemes, either
+00015950: 2074 6865 2022 6573 6462 2220 7363 6865   the "esdb" sche
+00015960: 6d65 206f 7220 7468 6520 2265 7364 622b  me or the "esdb+
+00015970: 6469 7363 6f76 6572 2220 7363 6865 6d65  discover" scheme
+00015980: 2e20 5468 6520 7379 6e74 6178 2061 6e64  . The syntax and
+00015990: 5c6e 7365 6d61 6e74 6963 7320 6f66 2074  \nsemantics of t
+000159a0: 6865 2045 7665 6e74 5374 6f72 6544 4220  he EventStoreDB 
+000159b0: 5552 4920 7363 6865 6d65 7320 6172 6520  URI schemes are 
+000159c0: 6578 706c 6169 6e65 6420 6265 6c6f 772e  explained below.
+000159d0: 2054 6865 2073 796e 7461 7820 6973 5c6e   The syntax is\n
+000159e0: 6465 6669 6e65 6420 7573 696e 6720 5b45  defined using [E
+000159f0: 424e 465d 2868 7474 7073 3a2f 2f65 6e2e  BNF](https://en.
+00015a00: 7769 6b69 7065 6469 612e 6f72 672f 7769  wikipedia.org/wi
+00015a10: 6b69 2f45 7874 656e 6465 645f 4261 636b  ki/Extended_Back
+00015a20: 7573 e280 934e 6175 725f 666f 726d 292e  us...Naur_form).
+00015a30: 5c6e 5c6e 5468 6520 2265 7364 6222 2055  \n\nThe "esdb" U
+00015a40: 5249 2073 6368 656d 6520 6361 6e20 6265  RI scheme can be
+00015a50: 2064 6566 696e 6564 2069 6e20 7468 6520   defined in the 
+00015a60: 666f 6c6c 6f77 696e 6720 7761 792e 5c6e  following way.\n
+00015a70: 5c6e 2020 2020 6573 6462 2d75 7269 203d  \n    esdb-uri =
+00015a80: 2022 6573 6462 3a2f 2f22 202c 205b 2075   "esdb://" , [ u
+00015a90: 7365 722d 696e 666f 202c 2022 4022 205d  ser-info , "@" ]
+00015aa0: 202c 2067 7270 632d 7461 7267 6574 2c20   , grpc-target, 
+00015ab0: 7b20 222c 2220 2c20 6772 7063 2d74 6172  { "," , grpc-tar
+00015ac0: 6765 7420 7d20 2c20 5b20 223f 2220 2c20  get } , [ "?" , 
+00015ad0: 7175 6572 792d 7374 7269 6e67 205d 203b  query-string ] ;
+00015ae0: 5c6e 5c6e 496e 2074 6865 2022 6573 6462  \n\nIn the "esdb
+00015af0: 2220 5552 4920 7363 6865 6d65 2c20 6166  " URI scheme, af
+00015b00: 7465 7220 7468 6520 6f70 7469 6f6e 616c  ter the optional
+00015b10: 2075 7365 7220 696e 666f 2073 7472 696e   user info strin
+00015b20: 672c 2074 6865 7265 206d 7573 7420 6265  g, there must be
+00015b30: 2061 7420 6c65 6173 745c 6e6f 6e65 2067   at least\none g
+00015b40: 5250 4320 7461 7267 6574 2e20 4966 2074  RPC target. If t
+00015b50: 6865 7265 2061 7265 2073 6576 6572 616c  here are several
+00015b60: 2067 5250 4320 7461 7267 6574 732c 2074   gRPC targets, t
+00015b70: 6865 7920 6d75 7374 2062 6520 7365 7061  hey must be sepa
+00015b80: 7261 7465 6420 6672 6f6d 2065 6163 685c  rated from each\
+00015b90: 6e6f 7468 6572 2077 6974 6820 7468 6520  nother with the 
+00015ba0: 222c 2220 6368 6172 6163 7465 722e 2045  "," character. E
+00015bb0: 6163 6820 6752 5043 2074 6172 6765 7420  ach gRPC target 
+00015bc0: 7368 6f75 6c64 2069 6e64 6963 6174 6520  should indicate 
+00015bd0: 616e 2045 7665 6e74 5374 6f72 6544 4220  an EventStoreDB 
+00015be0: 6752 5043 5c6e 7365 7276 6572 2073 6f63  gRPC\nserver soc
+00015bf0: 6b65 742c 2062 7920 7370 6563 6966 7969  ket, by specifyi
+00015c00: 6e67 2061 2068 6f73 7420 616e 6420 6120  ng a host and a 
+00015c10: 706f 7274 206e 756d 6265 7220 7365 7061  port number sepa
+00015c20: 7261 7465 6420 7769 7468 2074 6865 2022  rated with the "
+00015c30: 3a22 2063 6861 7261 6374 6572 2e5c 6e54  :" character.\nT
+00015c40: 6865 2068 6f73 7420 6d61 7920 6265 2061  he host may be a
+00015c50: 2068 6f73 746e 616d 6520 7468 6174 2063   hostname that c
+00015c60: 616e 2062 6520 7265 736f 6c76 6564 2074  an be resolved t
+00015c70: 6f20 616e 2049 5020 6164 6472 6573 732c  o an IP address,
+00015c80: 206f 7220 616e 2049 5020 6164 6472 6573   or an IP addres
+00015c90: 732e 5c6e 5c6e 2020 2020 6772 7063 2d74  s.\n\n    grpc-t
+00015ca0: 6172 6765 7420 3d20 2820 686f 7374 6e61  arget = ( hostna
+00015cb0: 6d65 207c 2069 702d 6164 6472 6573 7320  me | ip-address 
+00015cc0: 2920 2c20 223a 2220 2c20 706f 7274 2d6e  ) , ":" , port-n
+00015cd0: 756d 6265 7220 3b5c 6e5c 6e5c 6e54 6865  umber ;\n\n\nThe
+00015ce0: 2022 6573 6462 2b64 6973 636f 7665 7222   "esdb+discover"
+00015cf0: 2055 5249 2073 6368 656d 6520 6361 6e20   URI scheme can 
+00015d00: 6265 2064 6566 696e 6564 2069 6e20 7468  be defined in th
+00015d10: 6520 666f 6c6c 6f77 696e 6720 7761 792e  e following way.
+00015d20: 5c6e 5c6e 2020 2020 6573 6462 2d64 6973  \n\n    esdb-dis
+00015d30: 636f 7665 722d 7572 6920 3d20 2265 7364  cover-uri = "esd
+00015d40: 622b 6469 7363 6f76 6572 3a2f 2f22 202c  b+discover://" ,
+00015d50: 205b 2075 7365 722d 696e 666f 2c20 2240   [ user-info, "@
+00015d60: 2220 5d20 2c20 636c 7573 7465 722d 646f  " ] , cluster-do
+00015d70: 6d61 696e 6e61 6d65 202c 205b 2022 3f22  mainname , [ "?"
+00015d80: 202c 2071 7565 7279 2d73 7472 696e 6720   , query-string 
+00015d90: 5d20 3b5c 6e5c 6e49 6e20 7468 6520 2265  ] ;\n\nIn the "e
+00015da0: 7364 622b 6469 7363 6f76 6572 2220 5552  sdb+discover" UR
+00015db0: 4920 7363 6865 6d65 2c20 6166 7465 7220  I scheme, after 
+00015dc0: 7468 6520 7573 6572 2069 6e66 6f20 7374  the user info st
+00015dd0: 7269 6e67 2c20 7468 6572 6520 6d75 7374  ring, there must
+00015de0: 2062 6520 6120 646f 6d61 696e 5c6e 6e61   be a domain\nna
+00015df0: 6d65 2077 6869 6368 2073 686f 756c 6420  me which should 
+00015e00: 6964 656e 7469 6679 2061 2063 6c75 7374  identify a clust
+00015e10: 6572 206f 6620 4576 656e 7453 746f 7265  er of EventStore
+00015e20: 4442 2073 6572 7665 7273 2e20 5468 6520  DB servers. The 
+00015e30: 636c 6965 6e74 2077 696c 6c20 7573 6520  client will use 
+00015e40: 6120 444e 535c 6e73 6572 7665 7220 746f  a DNS\nserver to
+00015e50: 2072 6573 6f6c 7665 2074 6865 2064 6f6d   resolve the dom
+00015e60: 6169 6e20 6e61 6d65 2074 6f20 6120 6c69  ain name to a li
+00015e70: 7374 206f 6620 6164 6472 6573 7365 7320  st of addresses 
+00015e80: 6f66 2045 7665 6e74 5374 6f72 6544 4220  of EventStoreDB 
+00015e90: 7365 7276 6572 732c 5c6e 6279 2071 7565  servers,\nby que
+00015ea0: 7279 696e 6720 666f 7220 5c27 415c 2720  rying for \'A\' 
+00015eb0: 7265 636f 7264 732e 2049 6e20 7468 6973  records. In this
+00015ec0: 2063 6173 652c 2074 6865 2070 6f72 7420   case, the port 
+00015ed0: 6e75 6d62 6572 2022 3231 3133 2220 7769  number "2113" wi
+00015ee0: 6c6c 2062 6520 7573 6564 2074 6f5c 6e63  ll be used to\nc
+00015ef0: 6f6e 7374 7275 6374 2067 5250 4320 7461  onstruct gRPC ta
+00015f00: 7267 6574 7320 6672 6f6d 2074 6865 2061  rgets from the a
+00015f10: 6464 7265 7373 6573 206f 6274 6169 6e65  ddresses obtaine
+00015f20: 6420 6672 6f6d 205c 2741 5c27 2072 6563  d from \'A\' rec
+00015f30: 6f72 6473 2070 726f 7669 6465 6420 6279  ords provided by
+00015f40: 2074 6865 5c6e 444e 5320 7365 7276 6572   the\nDNS server
+00015f50: 2e20 5468 6572 6566 6f72 652c 2069 6620  . Therefore, if 
+00015f60: 796f 7520 7761 6e74 2074 6f20 7573 6520  you want to use 
+00015f70: 7468 6520 2265 7364 622b 6469 7363 6f76  the "esdb+discov
+00015f80: 6572 2220 5552 4920 7363 6865 6d65 2c20  er" URI scheme, 
+00015f90: 796f 7520 7769 6c6c 5c6e 6e65 6564 2074  you will\nneed t
+00015fa0: 6f20 636f 6e66 6967 7572 6520 444e 5320  o configure DNS 
+00015fb0: 7768 656e 2073 6574 7469 6e67 2075 7020  when setting up 
+00015fc0: 796f 7572 2045 7665 6e74 5374 6f72 6544  your EventStoreD
+00015fd0: 4220 636c 7573 7465 722e 5c6e 5c6e 5769  B cluster.\n\nWi
+00015fe0: 7468 2062 6f74 6820 7468 6520 2265 7364  th both the "esd
+00015ff0: 6222 2061 6e64 2022 6573 6462 2b64 6973  b" and "esdb+dis
+00016000: 6f63 7665 7222 2055 5249 2073 6368 656d  ocver" URI schem
+00016010: 6573 2c20 7468 6520 636c 6965 6e74 2066  es, the client f
+00016020: 6972 7374 6c79 206f 6274 6169 6e73 5c6e  irstly obtains\n
+00016030: 6120 6c69 7374 206f 6620 6752 5043 2074  a list of gRPC t
+00016040: 6172 6765 7473 3a20 6569 7468 6572 2064  argets: either d
+00016050: 6972 6563 746c 7920 6672 6f6d 2022 6573  irectly from "es
+00016060: 6462 2220 636f 6e6e 6563 7469 6f6e 2073  db" connection s
+00016070: 7472 696e 6773 3b20 6f72 2069 6e64 6972  trings; or indir
+00016080: 6563 746c 795c 6e66 726f 6d20 2265 7364  ectly\nfrom "esd
+00016090: 622b 6469 7363 6f76 6572 2220 636f 6e6e  b+discover" conn
+000160a0: 6563 7469 6f6e 2073 7472 696e 6773 2076  ection strings v
+000160b0: 6961 2044 4e53 2e20 5468 6973 206c 6973  ia DNS. This lis
+000160c0: 7420 6f66 2074 6172 6765 7473 2069 7320  t of targets is 
+000160d0: 6b6e 6f77 6e20 6173 2074 6865 5c6e 2267  known as the\n"g
+000160e0: 6f73 7369 7020 7365 6564 222e 2054 6865  ossip seed". The
+000160f0: 2063 6c69 656e 7420 7769 6c6c 2074 6865   client will the
+00016100: 6e20 6174 7465 6d70 7420 746f 2063 6f6e  n attempt to con
+00016110: 6e65 6374 2074 6f20 6561 6368 2067 5250  nect to each gRP
+00016120: 4320 7461 7267 6574 2069 6e20 7475 726e  C target in turn
+00016130: 2c5c 6e61 7474 656d 7074 696e 6720 746f  ,\nattempting to
+00016140: 2063 616c 6c20 7468 6520 4576 656e 7453   call the EventS
+00016150: 746f 7265 4442 2047 6f73 7369 7020 4150  toreDB Gossip AP
+00016160: 4920 746f 206f 6274 6169 6e20 696e 666f  I to obtain info
+00016170: 726d 6174 696f 6e20 6162 6f75 7420 7468  rmation about th
+00016180: 655c 6e45 7665 6e74 5374 6f72 6544 4220  e\nEventStoreDB 
+00016190: 636c 7573 7465 722e 2041 206d 656d 6265  cluster. A membe
+000161a0: 7220 6f66 2074 6865 2063 6c75 7374 6572  r of the cluster
+000161b0: 2069 7320 7365 6c65 6374 6564 2062 7920   is selected by 
+000161c0: 7468 6520 636c 6965 6e74 2c20 6163 636f  the client, acco
+000161d0: 7264 696e 675c 6e74 6f20 7468 6520 226e  rding\nto the "n
+000161e0: 6f64 6520 7072 6566 6572 656e 6365 2220  ode preference" 
+000161f0: 6f70 7469 6f6e 2e20 5468 6520 636c 6965  option. The clie
+00016200: 6e74 206d 6179 2074 6865 6e20 6e65 6564  nt may then need
+00016210: 2074 6f20 636c 6f73 6520 6974 735c 6e63   to close its\nc
+00016220: 6f6e 6e65 6374 696f 6e20 616e 6420 7265  onnection and re
+00016230: 636f 6e6e 6563 7420 746f 2074 6865 2073  connect to the s
+00016240: 656c 6563 7465 6420 7365 7276 6572 2e5c  elected server.\
+00016250: 6e5c 6e49 6e20 626f 7468 2074 6865 2022  n\nIn both the "
+00016260: 6573 6462 2220 616e 6420 2265 7364 622b  esdb" and "esdb+
+00016270: 6469 7363 6f76 6572 2220 7363 6865 6d65  discover" scheme
+00016280: 732c 2074 6865 2055 5249 206d 6179 2069  s, the URI may i
+00016290: 6e63 6c75 6465 2061 2075 7365 7220 696e  nclude a user in
+000162a0: 666f 2073 7472 696e 672e 5c6e 4966 2069  fo string.\nIf i
+000162b0: 7420 6578 6973 7473 2069 6e20 7468 6520  t exists in the 
+000162c0: 5552 492c 2074 6865 2075 7365 7220 696e  URI, the user in
+000162d0: 666f 2073 7472 696e 6720 6d75 7374 2062  fo string must b
+000162e0: 6520 7365 7061 7261 7465 6420 6672 6f6d  e separated from
+000162f0: 2074 6865 2072 6573 7420 6f66 2074 6865   the rest of the
+00016300: 2055 5249 5c6e 7769 7468 2074 6865 2022   URI\nwith the "
+00016310: 4022 2063 6861 7261 6374 6572 2e20 5468  @" character. Th
+00016320: 6520 7573 6572 2069 6e66 6f20 7374 7269  e user info stri
+00016330: 6e67 206d 7573 7420 696e 636c 7564 6520  ng must include 
+00016340: 6120 7573 6572 6e61 6d65 2061 6e64 2061  a username and a
+00016350: 2070 6173 7377 6f72 642c 5c6e 7365 7061   password,\nsepa
+00016360: 7261 7465 6420 7769 7468 2074 6865 2022  rated with the "
+00016370: 3a22 2063 6861 7261 6374 6572 2e5c 6e5c  :" character.\n\
+00016380: 6e20 2020 2075 7365 722d 696e 666f 203d  n    user-info =
+00016390: 2075 7365 726e 616d 6520 2c20 223a 2220   username , ":" 
+000163a0: 2c20 7061 7373 776f 7264 203b 5c6e 5c6e  , password ;\n\n
+000163b0: 5468 6520 7573 6572 2069 6e66 6f20 6973  The user info is
+000163c0: 2073 656e 7420 6279 2074 6865 2063 6c69   sent by the cli
+000163d0: 656e 7420 6173 2022 6361 6c6c 2063 7265  ent as "call cre
+000163e0: 6465 6e74 6961 6c73 2220 696e 2065 6163  dentials" in eac
+000163f0: 6820 6361 6c6c 2074 6f20 6120 2273 6563  h call to a "sec
+00016400: 7572 6522 5c6e 7365 7276 6572 2c20 696e  ure"\nserver, in
+00016410: 2061 2022 6261 7369 6320 6175 7468 2220   a "basic auth" 
+00016420: 6175 7468 6f72 697a 6174 696f 6e20 6865  authorization he
+00016430: 6164 6572 2e20 5468 6973 2061 7574 686f  ader. This autho
+00016440: 7269 7a61 7469 6f6e 2068 6561 6465 7220  rization header 
+00016450: 6973 2075 7365 6420 6279 5c6e 7468 6520  is used by\nthe 
+00016460: 7365 7276 6572 2074 6f20 6175 7468 656e  server to authen
+00016470: 7469 6361 7465 2074 6865 2063 6c69 656e  ticate the clien
+00016480: 742e 2054 6865 2061 7574 686f 7269 7a61  t. The authoriza
+00016490: 7469 6f6e 2068 6561 6465 7220 6973 206e  tion header is n
+000164a0: 6f74 2073 656e 7420 746f 5c6e 2269 6e73  ot sent to\n"ins
+000164b0: 6563 7572 6522 2073 6572 7665 7273 2e5c  ecure" servers.\
+000164c0: 6e5c 6e49 6e20 626f 7468 2074 6865 2022  n\nIn both the "
+000164d0: 6573 6462 2220 616e 6420 2265 7364 622b  esdb" and "esdb+
+000164e0: 6469 7363 6f76 6572 2220 7363 6865 6d65  discover" scheme
+000164f0: 732c 2074 6865 206f 7074 696f 6e61 6c20  s, the optional 
+00016500: 7175 6572 7920 7374 7269 6e67 206d 7573  query string mus
+00016510: 7420 6265 206f 6e65 5c6e 6f72 206d 616e  t be one\nor man
+00016520: 7920 6669 656c 642d 7661 6c75 6520 6172  y field-value ar
+00016530: 6775 6d65 6e74 732c 2073 6570 6172 6174  guments, separat
+00016540: 6564 2066 726f 6d20 6561 6368 206f 7468  ed from each oth
+00016550: 6572 2077 6974 6820 7468 6520 2226 2220  er with the "&" 
+00016560: 6368 6172 6163 7465 722e 5c6e 5c6e 2020  character.\n\n  
+00016570: 2020 7175 6572 792d 7374 7269 6e67 203d    query-string =
+00016580: 2066 6965 6c64 2d76 616c 7565 2c20 7b20   field-value, { 
+00016590: 2226 222c 2066 6965 6c64 2d76 616c 7565  "&", field-value
+000165a0: 207d 203b 5c6e 5c6e 4561 6368 2066 6965   } ;\n\nEach fie
+000165b0: 6c64 2d76 616c 7565 2061 7267 756d 656e  ld-value argumen
+000165c0: 7420 6d75 7374 2062 6520 6f6e 6520 6f66  t must be one of
+000165d0: 2074 6865 2073 7570 706f 7274 6564 2066   the supported f
+000165e0: 6965 6c64 732c 2061 6e64 2061 6e5c 6e61  ields, and an\na
+000165f0: 7070 726f 7072 6961 7465 2076 616c 7565  ppropriate value
+00016600: 2c20 7365 7061 7261 7465 6420 7769 7468  , separated with
+00016610: 2074 6865 2022 3d22 2063 6861 7261 6374   the "=" charact
+00016620: 6572 2e5c 6e5c 6e20 2020 2066 6965 6c64  er.\n\n    field
+00016630: 2d76 616c 7565 203d 2028 2022 546c 7322  -value = ( "Tls"
+00016640: 2c20 223d 2220 2c20 2274 7275 6522 207c  , "=" , "true" |
+00016650: 2022 6661 6c73 6522 2029 5c6e 2020 2020   "false" )\n    
+00016660: 2020 2020 2020 2020 2020 2020 7c20 2820              | ( 
+00016670: 2254 6c73 5665 7269 6679 4365 7274 222c  "TlsVerifyCert",
+00016680: 2022 3d22 202c 2022 7472 7565 2220 7c20   "=" , "true" | 
+00016690: 2266 616c 7365 2220 295c 6e20 2020 2020  "false" )\n     
+000166a0: 2020 2020 2020 2020 2020 207c 2028 2022             | ( "
+000166b0: 436f 6e6e 6563 7469 6f6e 4e61 6d65 222c  ConnectionName",
+000166c0: 2022 3d22 202c 2073 7472 696e 6720 295c   "=" , string )\
+000166d0: 6e20 2020 2020 2020 2020 2020 2020 2020  n               
+000166e0: 207c 2028 2022 4e6f 6465 5072 6566 6572   | ( "NodePrefer
+000166f0: 656e 6365 222c 2022 3d22 202c 2022 6c65  ence", "=" , "le
+00016700: 6164 6572 2220 7c20 2266 6f6c 6c6f 7765  ader" | "followe
+00016710: 7222 207c 2022 7265 6164 6f6e 6c79 7265  r" | "readonlyre
+00016720: 706c 6963 6122 207c 2022 7261 6e64 6f6d  plica" | "random
+00016730: 2220 295c 6e20 2020 2020 2020 2020 2020  " )\n           
+00016740: 2020 2020 207c 2028 2022 4465 6661 756c       | ( "Defaul
+00016750: 7444 6561 646c 696e 6522 2c20 223d 2220  tDeadline", "=" 
+00016760: 2c20 696e 7465 6765 7220 295c 6e20 2020  , integer )\n   
+00016770: 2020 2020 2020 2020 2020 2020 207c 2028               | (
+00016780: 2022 476f 7373 6970 5469 6d65 6f75 7422   "GossipTimeout"
+00016790: 2c20 223d 2220 2c20 696e 7465 6765 7220  , "=" , integer 
+000167a0: 295c 6e20 2020 2020 2020 2020 2020 2020  )\n             
+000167b0: 2020 207c 2028 2022 4d61 7844 6973 636f     | ( "MaxDisco
+000167c0: 7665 7241 7474 656d 7074 7322 2c20 223d  verAttempts", "=
+000167d0: 2220 2c20 696e 7465 6765 7220 295c 6e20  " , integer )\n 
+000167e0: 2020 2020 2020 2020 2020 2020 2020 207c                 |
+000167f0: 2028 2022 4469 7363 6f76 6572 7949 6e74   ( "DiscoveryInt
+00016800: 6572 7661 6c22 2c20 223d 2220 2c20 696e  erval", "=" , in
+00016810: 7465 6765 7220 295c 6e20 2020 2020 2020  teger )\n       
+00016820: 2020 2020 2020 2020 207c 2028 2022 4d61           | ( "Ma
+00016830: 7844 6973 636f 7665 7241 7474 656d 7074  xDiscoverAttempt
+00016840: 7322 2c20 223d 2220 2c20 696e 7465 6765  s", "=" , intege
+00016850: 7220 295c 6e20 2020 2020 2020 2020 2020  r )\n           
+00016860: 2020 2020 207c 2028 2022 4b65 6570 416c       | ( "KeepAl
+00016870: 6976 6549 6e74 6572 7661 6c22 2c20 223d  iveInterval", "=
+00016880: 2220 2c20 696e 7465 6765 7220 295c 6e20  " , integer )\n 
+00016890: 2020 2020 2020 2020 2020 2020 2020 207c                 |
+000168a0: 2028 2022 4b65 6570 416c 6976 6549 6e74   ( "KeepAliveInt
+000168b0: 6572 7661 6c22 2c20 223d 2220 2c20 696e  erval", "=" , in
+000168c0: 7465 6765 7220 2920 3b5c 6e5c 6e54 6865  teger ) ;\n\nThe
+000168d0: 2074 6162 6c65 2062 656c 6f77 2064 6573   table below des
+000168e0: 6372 6962 6573 2074 6865 2071 7565 7279  cribes the query
+000168f0: 2066 6965 6c64 2d76 616c 7565 7320 7375   field-values su
+00016900: 7070 6f72 7465 6420 6279 2074 6869 7320  pported by this 
+00016910: 636c 6965 6e74 2e5c 6e5c 6e7c 2046 6965  client.\n\n| Fie
+00016920: 6c64 2020 2020 2020 2020 2020 2020 2020  ld              
+00016930: 207c 2056 616c 7565 2020 2020 2020 2020   | Value        
+00016940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016970: 2020 2020 2020 2020 207c 2044 6573 6372           | Descr
+00016980: 6970 7469 6f6e 2020 2020 2020 2020 2020  iption          
+00016990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000169a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000169b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000169c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000169d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000169e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000169f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016a10: 2020 2020 2020 2020 2020 2020 207c 5c6e               |\n
+00016a20: 7c2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  |---------------
+00016a30: 2d2d 2d2d 2d2d 7c2d 2d2d 2d2d 2d2d 2d2d  ------|---------
+00016a40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016a50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016a60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016a70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 7c2d  --------------|-
+00016a80: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016a90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016aa0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016ab0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016ac0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016ad0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016ae0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016af0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016b00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016b10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016b20: 2d2d 7c5c 6e7c 2054 6c73 2020 2020 2020  --|\n| Tls      
+00016b30: 2020 2020 2020 2020 2020 207c 2022 7472             | "tr
+00016b40: 7565 222c 2022 6661 6c73 6522 2028 6465  ue", "false" (de
+00016b50: 6661 756c 743a 2022 7472 7565 2229 2020  fault: "true")  
+00016b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016b80: 2020 207c 2049 6620 2274 7275 6522 2074     | If "true" t
+00016b90: 6865 2063 6c69 656e 7420 7769 6c6c 2063  he client will c
+00016ba0: 7265 6174 6520 6120 2273 6563 7572 6522  reate a "secure"
+00016bb0: 2067 5250 4320 6368 616e 6e65 6c2e 2049   gRPC channel. I
+00016bc0: 6620 2266 616c 7365 2220 7468 6520 636c  f "false" the cl
+00016bd0: 6965 6e74 2077 696c 6c20 6372 6561 7465  ient will create
+00016be0: 2061 6e20 2269 6e73 6563 7572 6522 2067   an "insecure" g
+00016bf0: 5250 4320 6368 616e 6e65 6c2e 2054 6869  RPC channel. Thi
+00016c00: 7320 6d75 7374 206d 6174 6368 2074 6865  s must match the
+00016c10: 2073 6572 7665 7220 636f 6e66 6967 7572   server configur
+00016c20: 6174 696f 6e2e 207c 5c6e 7c20 546c 7356  ation. |\n| TlsV
+00016c30: 6572 6966 7943 6572 7420 2020 2020 2020  erifyCert       
+00016c40: 7c20 2274 7275 6522 2c20 2266 616c 7365  | "true", "false
+00016c50: 2220 2864 6566 6175 6c74 3a20 2274 7275  " (default: "tru
+00016c60: 6522 2920 2020 2020 2020 2020 2020 2020  e")             
+00016c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016c80: 2020 2020 2020 2020 7c20 5468 6973 2076          | This v
+00016c90: 616c 7565 2069 7320 6375 7272 656e 746c  alue is currentl
+00016ca0: 7920 6967 6e6f 7265 642e 2020 2020 2020  y ignored.      
+00016cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016d20: 2020 2020 2020 2020 2020 2020 7c5c 6e7c              |\n|
+00016d30: 2043 6f6e 6e65 6374 696f 6e4e 616d 6520   ConnectionName 
+00016d40: 2020 2020 207c 2073 7472 696e 6720 2864       | string (d
+00016d50: 6566 6175 6c74 3a20 6175 746f 2d67 656e  efault: auto-gen
+00016d60: 6572 6174 6564 2076 6572 7369 6f6e 2d34  erated version-4
+00016d70: 2055 5549 4429 2020 2020 2020 2020 2020   UUID)          
+00016d80: 2020 2020 2020 2020 2020 2020 207c 2053               | S
+00016d90: 656e 7420 696e 2063 616c 6c20 6d65 7461  ent in call meta
+00016da0: 6461 7461 2066 6f72 2065 7665 7279 2063  data for every c
+00016db0: 616c 6c2c 2074 6f20 6964 656e 7469 6679  all, to identify
+00016dc0: 2074 6865 2063 6c69 656e 7420 746f 2074   the client to t
+00016dd0: 6865 2063 6c75 7374 6572 2e20 2020 2020  he cluster.     
+00016de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016e30: 207c 5c6e 7c20 4e6f 6465 5072 6566 6572   |\n| NodePrefer
+00016e40: 656e 6365 2020 2020 2020 7c20 226c 6561  ence      | "lea
+00016e50: 6465 7222 2c20 2266 6f6c 6c6f 7765 7222  der", "follower"
+00016e60: 2c20 2272 6561 646f 6e6c 7972 6570 6c69  , "readonlyrepli
+00016e70: 6361 222c 2022 7261 6e64 6f6d 2220 2864  ca", "random" (d
+00016e80: 6566 6175 6c74 3a20 226c 6561 6465 7222  efault: "leader"
+00016e90: 2920 7c20 5468 6520 6e6f 6465 2073 7461  ) | The node sta
+00016ea0: 7465 2070 7265 6665 7272 6564 2062 7920  te preferred by 
+00016eb0: 7468 6520 636c 6965 6e74 2e20 5468 6520  the client. The 
+00016ec0: 636c 6965 6e74 2077 696c 6c20 7365 6c65  client will sele
+00016ed0: 6374 2061 206e 6f64 6520 6672 6f6d 2074  ct a node from t
+00016ee0: 6865 2063 6c75 7374 6572 2069 6e66 6f20  he cluster info 
+00016ef0: 7265 6365 6976 6564 2066 726f 6d20 7468  received from th
+00016f00: 6520 476f 7373 6970 2041 5049 2061 6363  e Gossip API acc
+00016f10: 6f72 6469 6e67 2074 6f20 7468 6973 2070  ording to this p
+00016f20: 7265 6665 7265 6e63 652e 2020 2020 2020  reference.      
+00016f30: 2020 2020 2020 7c5c 6e7c 2044 6566 6175        |\n| Defau
+00016f40: 6c74 4465 6164 6c69 6e65 2020 2020 207c  ltDeadline     |
+00016f50: 2069 6e74 6567 6572 2028 6465 6661 756c   integer (defaul
+00016f60: 743a 2060 4e6f 6e65 6029 2020 2020 2020  t: `None`)      
+00016f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016f90: 2020 2020 2020 207c 2054 6865 2064 6566         | The def
+00016fa0: 6175 6c74 2076 616c 7565 2028 696e 2073  ault value (in s
+00016fb0: 6563 6f6e 6473 2920 6f66 2074 6865 2060  econds) of the `
+00016fc0: 7469 6d65 6f75 7460 2061 7267 756d 656e  timeout` argumen
+00016fd0: 7420 6f66 2063 6c69 656e 7420 2277 7269  t of client "wri
+00016fe0: 7465 2220 6d65 7468 6f64 7320 7375 6368  te" methods such
+00016ff0: 2061 7320 6061 7070 656e 645f 6576 656e   as `append_even
+00017000: 7473 2829 602e 2020 2020 2020 2020 2020  ts()`.          
+00017010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017030: 2020 2020 2020 2020 2020 207c 5c6e 7c20             |\n| 
+00017040: 476f 7373 6970 5469 6d65 6f75 7420 2020  GossipTimeout   
+00017050: 2020 2020 7c20 696e 7465 6765 7220 2864      | integer (d
+00017060: 6566 6175 6c74 3a20 3529 2020 2020 2020  efault: 5)      
+00017070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017090: 2020 2020 2020 2020 2020 2020 7c20 5468              | Th
+000170a0: 6520 6465 6661 756c 7420 7661 6c75 6520  e default value 
+000170b0: 2869 6e20 7365 636f 6e64 7329 206f 6620  (in seconds) of 
+000170c0: 7468 6520 6074 696d 656f 7574 6020 6172  the `timeout` ar
+000170d0: 6775 6d65 6e74 206f 6620 676f 7373 6970  gument of gossip
+000170e0: 2072 6561 6420 6d65 7468 6f64 732c 2073   read methods, s
+000170f0: 7563 6820 6173 2060 7265 6164 5f67 6f73  uch as `read_gos
+00017100: 7369 7028 2960 2e20 2020 2020 2020 2020  sip()`.         
+00017110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017140: 7c5c 6e7c 204d 6178 4469 7363 6f76 6572  |\n| MaxDiscover
+00017150: 4174 7465 6d70 7473 207c 2069 6e74 6567  Attempts | integ
+00017160: 6572 2028 6465 6661 756c 743a 2031 3029  er (default: 10)
+00017170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017180: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000171a0: 207c 2054 6865 206e 756d 6265 7220 6f66   | The number of
+000171b0: 2061 7474 656d 7074 7320 746f 2072 6561   attempts to rea
+000171c0: 6420 676f 7373 6970 2077 6865 6e20 636f  d gossip when co
+000171d0: 6e6e 6563 7469 6e67 206f 7220 7265 636f  nnecting or reco
+000171e0: 6e6e 6563 7469 6e67 2074 6f20 6120 636c  nnecting to a cl
+000171f0: 7573 7465 7220 6d65 6d62 6572 2e20 2020  uster member.   
+00017200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017240: 2020 2020 207c 5c6e 7c20 4469 7363 6f76       |\n| Discov
+00017250: 6572 7949 6e74 6572 7661 6c20 2020 7c20  eryInterval   | 
+00017260: 696e 7465 6765 7220 2864 6566 6175 6c74  integer (default
+00017270: 3a20 3130 3029 2020 2020 2020 2020 2020  : 100)          
+00017280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000172a0: 2020 2020 2020 7c20 486f 7720 6c6f 6e67        | How long
+000172b0: 2074 6f20 7761 6974 2028 696e 206d 696c   to wait (in mil
+000172c0: 6c69 7365 636f 6e64 7329 2062 6574 7765  liseconds) betwe
+000172d0: 656e 2067 6f73 7369 7020 7265 7472 6965  en gossip retrie
+000172e0: 732e 2020 2020 2020 2020 2020 2020 2020  s.              
+000172f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017340: 2020 2020 2020 2020 2020 7c5c 6e7c 204b            |\n| K
+00017350: 6565 7041 6c69 7665 496e 7465 7276 616c  eepAliveInterval
+00017360: 2020 207c 2069 6e74 6567 6572 2028 6465     | integer (de
+00017370: 6661 756c 743a 2060 4e6f 6e65 6029 2020  fault: `None`)  
+00017380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000173a0: 2020 2020 2020 2020 2020 207c 2054 6865             | The
+000173b0: 2076 616c 7565 206f 6620 7468 6520 2267   value of the "g
+000173c0: 7270 632e 6b65 6570 616c 6976 655f 6d73  rpc.keepalive_ms
+000173d0: 2220 6752 5043 2063 6861 6e6e 656c 206f  " gRPC channel o
+000173e0: 7074 696f 6e2e 2020 2020 2020 2020 2020  ption.          
+000173f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017430: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017440: 2020 2020 2020 2020 2020 2020 2020 207c                 |
+00017450: 5c6e 7c20 4b65 6570 416c 6976 6554 696d  \n| KeepAliveTim
+00017460: 656f 7574 2020 2020 7c20 696e 7465 6765  eout    | intege
+00017470: 7220 2864 6566 6175 6c74 3a20 604e 6f6e  r (default: `Non
+00017480: 6560 2920 2020 2020 2020 2020 2020 2020  e`)             
+00017490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000174a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000174b0: 7c20 5468 6520 7661 6c75 6520 6f66 2074  | The value of t
+000174c0: 6865 2022 6772 7063 2e6b 6565 7061 6c69  he "grpc.keepali
+000174d0: 7665 5f74 696d 656f 7574 5f6d 7322 2067  ve_timeout_ms" g
+000174e0: 5250 4320 6368 616e 6e65 6c20 6f70 7469  RPC channel opti
+000174f0: 6f6e 2e20 2020 2020 2020 2020 2020 2020  on.             
+00017500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017550: 2020 2020 7c5c 6e5c 6e5c 6e48 6572 6520      |\n\n\nHere 
+00017560: 6172 6520 736f 6d65 2065 7861 6d70 6c65  are some example
+00017570: 7320 6f66 2045 7665 6e74 5374 6f72 6544  s of EventStoreD
+00017580: 4220 636f 6e6e 6563 7469 6f6e 2073 7472  B connection str
+00017590: 696e 6720 5552 4973 2e5c 6e5c 6e20 2020  ing URIs.\n\n   
+000175a0: 2023 2047 6574 2063 6c75 7374 6572 2069   # Get cluster i
+000175b0: 6e66 6f20 6672 6f6d 2073 6563 7572 6520  nfo from secure 
+000175c0: 7365 7276 6572 2073 6f63 6b65 7420 6c6f  server socket lo
+000175d0: 6361 6c68 6f73 743a 3231 3133 2c5c 6e20  calhost:2113,\n 
+000175e0: 2020 2023 2061 6e64 2075 7365 2022 6164     # and use "ad
+000175f0: 6d69 6e22 2061 6e64 2022 6368 616e 6765  min" and "change
+00017600: 6974 2220 6173 2075 7365 726e 616d 6520  it" as username 
+00017610: 616e 6420 7061 7373 776f 7264 5c6e 2020  and password\n  
+00017620: 2020 2320 7768 656e 206d 616b 696e 6720    # when making 
+00017630: 6361 6c6c 7320 746f 2045 7665 6e74 5374  calls to EventSt
+00017640: 6f72 6544 4220 4150 4920 6d65 7468 6f64  oreDB API method
+00017650: 732e 5c6e 5c6e 2020 2020 6573 6462 3a2f  s.\n\n    esdb:/
+00017660: 2f61 646d 696e 3a63 6861 6e67 6569 7440  /admin:changeit@
+00017670: 6c6f 6361 6c68 6f73 743a 3231 3133 5c6e  localhost:2113\n
+00017680: 5c6e 5c6e 2020 2020 2320 4765 7420 636c  \n\n    # Get cl
+00017690: 7573 7465 7220 696e 666f 2066 726f 6d20  uster info from 
+000176a0: 696e 7365 6375 7265 2073 6572 7665 7220  insecure server 
+000176b0: 736f 636b 6574 2031 3237 2e30 2e30 2e31  socket 127.0.0.1
+000176c0: 3a32 3131 345c 6e5c 6e20 2020 2065 7364  :2114\n\n    esd
+000176d0: 623a 2f2f 3132 372e 302e 302e 313a 3231  b://127.0.0.1:21
+000176e0: 3134 3f54 6c73 3d66 616c 7365 5c6e 5c6e  14?Tls=false\n\n
+000176f0: 5c6e 2020 2020 2320 4765 7420 636c 7573  \n    # Get clus
+00017700: 7465 7220 696e 666f 2066 726f 6d20 6164  ter info from ad
+00017710: 6472 6573 7365 7320 696e 205c 2741 5c27  dresses in \'A\'
+00017720: 2072 6563 6f72 6473 2066 6f72 2063 6c75   records for clu
+00017730: 7374 6572 312e 6578 616d 706c 652e 636f  ster1.example.co
+00017740: 6d2c 5c6e 2020 2020 2320 616e 6420 7573  m,\n    # and us
+00017750: 6520 6120 6465 6661 756c 7420 6465 6164  e a default dead
+00017760: 6c69 6e65 2066 6f72 206d 616b 696e 6720  line for making 
+00017770: 6361 6c6c 7320 746f 2045 7665 6e74 5374  calls to EventSt
+00017780: 6f72 6520 4150 4920 6d65 7468 6f64 2e5c  ore API method.\
+00017790: 6e5c 6e20 2020 2065 7364 622b 6469 7363  n\n    esdb+disc
+000177a0: 6f76 6572 3a2f 2f61 646d 696e 3a63 6861  over://admin:cha
+000177b0: 6e67 6569 7440 636c 7573 7465 7231 2e65  ngeit@cluster1.e
+000177c0: 7861 6d70 6c65 2e63 6f6d 3f44 6566 6175  xample.com?Defau
+000177d0: 6c74 4465 6164 6c69 6e65 3d35 5c6e 5c6e  ltDeadline=5\n\n
+000177e0: 5c6e 2020 2020 2320 4765 7420 636c 7573  \n    # Get clus
+000177f0: 7465 7220 696e 666f 2066 726f 6d20 6569  ter info from ei
+00017800: 7468 6572 206c 6f63 616c 686f 7374 3a32  ther localhost:2
+00017810: 3131 3120 6f72 206c 6f63 616c 686f 7374  111 or localhost
+00017820: 3a32 3131 3220 6f72 5c6e 2020 2020 2320  :2112 or\n    # 
+00017830: 6c6f 6361 6c68 6f73 743a 3231 3133 2c20  localhost:2113, 
+00017840: 616e 6420 7468 656e 2063 6f6e 6e65 6374  and then connect
+00017850: 2074 6f20 6120 666f 6c6c 6f77 6572 206e   to a follower n
+00017860: 6f64 6520 696e 2074 6865 2063 6c75 7374  ode in the clust
+00017870: 6572 2e5c 6e5c 6e20 2020 2065 7364 623a  er.\n\n    esdb:
+00017880: 2f2f 6164 6d69 6e3a 6368 616e 6765 6974  //admin:changeit
+00017890: 406c 6f63 616c 686f 7374 3a32 3131 312c  @localhost:2111,
+000178a0: 6c6f 6361 6c68 6f73 743a 3231 3132 2c6c  localhost:2112,l
+000178b0: 6f63 616c 686f 7374 3a32 3131 333f 4e6f  ocalhost:2113?No
+000178c0: 6465 5072 6566 6572 656e 6365 3d66 6f6c  dePreference=fol
+000178d0: 6c6f 7765 725c 6e5c 6e5c 6e20 2020 2023  lower\n\n\n    #
+000178e0: 2047 6574 2063 6c75 7374 6572 2069 6e66   Get cluster inf
+000178f0: 6f20 6672 6f6d 2061 6464 7265 7373 6573  o from addresses
+00017900: 2069 6e20 5c27 415c 2720 7265 636f 7264   in \'A\' record
+00017910: 7320 666f 7220 636c 7573 7465 7231 2e65  s for cluster1.e
+00017920: 7861 6d70 6c65 2e63 6f6d 2c5c 6e20 2020  xample.com,\n   
+00017930: 2023 2061 6e64 2063 6f6e 6669 6775 7265   # and configure
+00017940: 2022 6b65 6570 2061 6c69 7665 2220 7469   "keep alive" ti
+00017950: 6d65 6f75 7420 616e 6420 696e 7465 7276  meout and interv
+00017960: 616c 2069 6e20 7468 6520 6752 5043 2063  al in the gRPC c
+00017970: 6861 6e6e 656c 2e5c 6e5c 6e20 2020 2065  hannel.\n\n    e
+00017980: 7364 622b 6469 7363 6f76 6572 3a2f 2f61  sdb+discover://a
+00017990: 646d 696e 3a63 6861 6e67 6569 7440 636c  dmin:changeit@cl
+000179a0: 7573 7465 7231 2e65 7861 6d70 6c65 2e63  uster1.example.c
+000179b0: 6f6d 3f4b 6565 7041 6c69 7665 496e 7465  om?KeepAliveInte
+000179c0: 7276 616c 3d31 3030 3030 264b 6565 7041  rval=10000&KeepA
+000179d0: 6c69 7665 5469 6d65 6f75 743d 3130 3030  liveTimeout=1000
+000179e0: 305c 6e5c 6e5c 6e50 6c65 6173 6520 6e6f  0\n\n\nPlease no
+000179f0: 7465 2c20 7468 6520 636c 6965 6e74 2069  te, the client i
+00017a00: 7320 696e 7365 6e73 6974 6976 6520 746f  s insensitive to
+00017a10: 2074 6865 2063 6173 6520 6f66 2066 6965   the case of fie
+00017a20: 6c64 7320 616e 6420 7661 6c75 6573 2e20  lds and values. 
+00017a30: 4966 2066 6965 6c64 7320 6172 655c 6e72  If fields are\nr
+00017a40: 6570 6561 7465 6420 696e 2074 6865 2071  epeated in the q
+00017a50: 7565 7279 2073 7472 696e 672c 2074 6865  uery string, the
+00017a60: 2071 7565 7279 2073 7472 696e 6720 7769   query string wi
+00017a70: 6c6c 2062 6520 7061 7273 6564 2077 6974  ll be parsed wit
+00017a80: 686f 7574 2065 7272 6f72 2e20 486f 7765  hout error. Howe
+00017a90: 7665 722c 5c6e 7468 6520 636f 6e6e 6563  ver,\nthe connec
+00017aa0: 7469 6f6e 206f 7074 696f 6e73 2075 7365  tion options use
+00017ab0: 6420 6279 2074 6865 2063 6c69 656e 7420  d by the client 
+00017ac0: 7769 6c6c 2075 7365 2074 6865 2076 616c  will use the val
+00017ad0: 7565 206f 6620 7468 6520 6669 7273 7420  ue of the first 
+00017ae0: 6669 656c 642e 2041 6c6c 5c6e 7468 6520  field. All\nthe 
+00017af0: 6f74 6865 7220 6669 656c 642d 7661 6c75  other field-valu
+00017b00: 6573 2069 6e20 7468 6520 7175 6572 7920  es in the query 
+00017b10: 7374 7269 6e67 2077 6974 6820 7468 6520  string with the 
+00017b20: 7361 6d65 2066 6965 6c64 206e 616d 6520  same field name 
+00017b30: 7769 6c6c 2062 6520 6967 6e6f 7265 642e  will be ignored.
+00017b40: 5c6e 4669 656c 6473 2077 6974 686f 7574  \nFields without
+00017b50: 2076 616c 7565 7320 7769 6c6c 2061 6c73   values will als
+00017b60: 6f20 6265 2069 676e 6f72 6564 2e5c 6e5c  o be ignored.\n\
+00017b70: 6e49 6620 7468 6520 636c 6965 6e74 5c27  nIf the client\'
+00017b80: 7320 6e6f 6465 2070 7265 6665 7265 6e63  s node preferenc
+00017b90: 6520 6973 2022 6c65 6164 6572 2220 616e  e is "leader" an
+00017ba0: 6420 7468 6520 6e6f 6465 2062 6563 6f6d  d the node becom
+00017bb0: 6573 2061 5c6e 2266 6f6c 6c6f 7765 7222  es a\n"follower"
+00017bc0: 2c20 7468 6520 636c 6965 6e74 2077 696c  , the client wil
+00017bd0: 6c20 6174 7465 6d70 7420 746f 2072 6563  l attempt to rec
+00017be0: 6f6e 6e65 6374 2074 6f20 7468 6520 6375  onnect to the cu
+00017bf0: 7272 656e 7420 6c65 6164 6572 2077 6865  rrent leader whe
+00017c00: 6e20 6120 6d65 7468 6f64 5c6e 6973 2063  n a method\nis c
+00017c10: 616c 6c65 6420 7468 6174 2065 7870 6563  alled that expec
+00017c20: 7473 2074 6f20 6361 6c6c 2061 206c 6561  ts to call a lea
+00017c30: 6465 722e 204d 6574 686f 6473 2077 6869  der. Methods whi
+00017c40: 6368 206d 7574 6174 6520 7468 6520 7374  ch mutate the st
+00017c50: 6174 6520 6f66 2074 6865 2064 6174 6162  ate of the datab
+00017c60: 6173 655c 6e65 7870 6563 7420 746f 2063  ase\nexpect to c
+00017c70: 616c 6c20 6120 6c65 6164 6572 2e20 466f  all a leader. Fo
+00017c80: 7220 7375 6368 206d 6574 686f 6473 2c20  r such methods, 
+00017c90: 7468 6520 4854 5450 2068 6561 6465 7222  the HTTP header"
+00017ca0: 7265 7175 6972 6573 2d6c 6561 6465 7222  requires-leader"
+00017cb0: 2069 7320 7365 7420 746f 5c6e 2274 7275   is set to\n"tru
+00017cc0: 6522 2c20 616e 6420 7468 6973 2068 6561  e", and this hea
+00017cd0: 6465 7220 6973 206f 6273 6572 7665 6420  der is observed 
+00017ce0: 6279 2074 6865 2073 6572 7665 722c 2061  by the server, a
+00017cf0: 6e64 2073 6f20 6120 6e6f 6465 2077 6869  nd so a node whi
+00017d00: 6368 2069 7320 6e6f 7420 6120 6c65 6164  ch is not a lead
+00017d10: 6572 5c6e 7468 6174 2072 6563 6569 7665  er\nthat receive
+00017d20: 7320 7375 6368 2061 2072 6571 7565 7374  s such a request
+00017d30: 2077 696c 6c20 7265 7475 726e 2061 6e20   will return an 
+00017d40: 6572 726f 722e 2054 6869 7320 6572 726f  error. This erro
+00017d50: 7220 6973 2064 6574 6563 7465 6420 6279  r is detected by
+00017d60: 2074 6865 2063 6c69 656e 742c 5c6e 7768   the client,\nwh
+00017d70: 6963 6820 7769 6c6c 2074 6865 6e20 636c  ich will then cl
+00017d80: 6f73 6520 7468 6520 6375 7272 656e 7420  ose the current 
+00017d90: 6752 5043 2063 6f6e 6e65 6374 696f 6e20  gRPC connection 
+00017da0: 616e 6420 6372 6561 7465 2061 206e 6577  and create a new
+00017db0: 2063 6f6e 6e65 6374 696f 6e20 746f 2074   connection to t
+00017dc0: 6865 5c6e 6c65 6164 6572 2e20 5468 6520  he\nleader. The 
+00017dd0: 7265 7175 6573 7420 7769 6c6c 2074 6865  request will the
+00017de0: 6e20 6265 2072 6574 7269 6564 2077 6974  n be retried wit
+00017df0: 6820 7468 6520 6c65 6164 6572 2e5c 6e5c  h the leader.\n\
+00017e00: 6e49 6620 7468 6520 636c 6965 6e74 5c27  nIf the client\'
+00017e10: 7320 6e6f 6465 2070 7265 6665 7265 6e63  s node preferenc
+00017e20: 6520 6973 2022 666f 6c6c 6f77 6572 2220  e is "follower" 
+00017e30: 616e 6420 7468 6572 6520 6172 6520 6e6f  and there are no
+00017e40: 2066 6f6c 6c6f 7765 725c 6e6e 6f64 6573   follower\nnodes
+00017e50: 2069 6e20 7468 6520 636c 7573 7465 722c   in the cluster,
+00017e60: 2074 6865 6e20 7468 6520 636c 6965 6e74   then the client
+00017e70: 2077 696c 6c20 7261 6973 6520 616e 2065   will raise an e
+00017e80: 7863 6570 7469 6f6e 2e20 5369 6d69 6c61  xception. Simila
+00017e90: 726c 792c 2069 6620 7468 655c 6e63 6c69  rly, if the\ncli
+00017ea0: 656e 745c 2773 206e 6f64 6520 7072 6566  ent\'s node pref
+00017eb0: 6572 656e 6365 2069 7320 2272 6561 646f  erence is "reado
+00017ec0: 6e6c 7972 6570 6c69 6361 2220 616e 6420  nlyreplica" and 
+00017ed0: 7468 6572 6520 6172 6520 6e6f 2072 6561  there are no rea
+00017ee0: 642d 6f6e 6c79 2072 6570 6c69 6361 5c6e  d-only replica\n
+00017ef0: 6e6f 6465 7320 696e 2074 6865 2063 6c75  nodes in the clu
+00017f00: 7374 6572 2c20 7468 656e 2074 6865 2063  ster, then the c
+00017f10: 6c69 656e 7420 7769 6c6c 2061 6c73 6f20  lient will also 
+00017f20: 7261 6973 6520 616e 2065 7863 6570 7469  raise an excepti
+00017f30: 6f6e 2e5c 6e5c 6e54 6865 2067 5250 4320  on.\n\nThe gRPC 
+00017f40: 6368 616e 6e65 6c20 6f70 7469 6f6e 2022  channel option "
+00017f50: 6772 7063 2e6d 6178 5f72 6563 6569 7665  grpc.max_receive
+00017f60: 5f6d 6573 7361 6765 5f6c 656e 6774 6822  _message_length"
+00017f70: 2069 7320 6175 746f 6d61 7469 6361 6c6c   is automaticall
+00017f80: 795c 6e63 6f6e 6669 6775 7265 6420 746f  y\nconfigured to
+00017f90: 2074 6865 2076 616c 7565 2060 3137 202a   the value `17 *
+00017fa0: 2031 3032 3420 2a20 3130 3234 602e 2054   1024 * 1024`. T
+00017fb0: 6869 7320 7661 6c75 6520 6361 6e6e 6f74  his value cannot
+00017fc0: 2062 6520 6368 616e 6765 642e 5c6e 5c6e   be changed.\n\n
+00017fd0: 5c6e 2323 2320 5265 6775 6c61 7220 6578  \n### Regular ex
+00017fe0: 7072 6573 7369 6f6e 2066 696c 7465 7273  pression filters
+00017ff0: 5c6e 5c6e 5468 6520 6669 6c74 6572 2061  \n\nThe filter a
+00018000: 7267 756d 656e 7473 2069 6e20 6072 6561  rguments in `rea
+00018010: 645f 616c 6c5f 6576 656e 7473 2829 602c  d_all_events()`,
+00018020: 2060 7375 6273 6372 6962 655f 616c 6c5f   `subscribe_all_
+00018030: 6576 656e 7473 2829 602c 5c6e 6063 7265  events()`,\n`cre
+00018040: 6174 655f 7375 6273 6372 6970 7469 6f6e  ate_subscription
+00018050: 2829 6020 616e 6420 6067 6574 5f63 6f6d  ()` and `get_com
+00018060: 6d69 745f 706f 7369 7469 6f6e 2829 6020  mit_position()` 
+00018070: 6172 6520 6170 706c 6965 6420 746f 2074  are applied to t
+00018080: 6865 2060 7479 7065 605c 6e61 7474 7269  he `type`\nattri
+00018090: 6275 7465 206f 6620 7265 636f 7264 6564  bute of recorded
+000180a0: 2065 7665 6e74 732e 5c6e 5c6e 5468 6520   events.\n\nThe 
+000180b0: 6465 6661 756c 7420 7661 6c75 6520 6f66  default value of
+000180c0: 2074 6865 2060 6669 6c74 6572 5f65 7863   the `filter_exc
+000180d0: 6c75 6465 6020 6172 6775 6d65 6e74 7320  lude` arguments 
+000180e0: 6973 2064 6573 6967 6e65 6420 746f 2065  is designed to e
+000180f0: 7863 6c75 6465 5c6e 4576 656e 7453 746f  xclude\nEventSto
+00018100: 7265 4442 2022 7379 7374 656d 2220 616e  reDB "system" an
+00018110: 6420 2270 6572 7369 7374 656e 6365 2073  d "persistence s
+00018120: 7562 7363 7269 7074 696f 6e20 636f 6e66  ubscription conf
+00018130: 6967 2220 6576 656e 7473 2c20 7768 6963  ig" events, whic
+00018140: 685c 6e6f 7468 6572 7769 7365 2077 6f75  h\notherwise wou
+00018150: 6c64 2062 6520 696e 636c 7564 6564 2e20  ld be included. 
+00018160: 5379 7374 656d 2065 7665 6e74 7320 6765  System events ge
+00018170: 6e65 7261 7465 6420 6279 2045 7665 6e74  nerated by Event
+00018180: 5374 6f72 6544 4220 616c 6c5c 6e68 6176  StoreDB all\nhav
+00018190: 6520 6074 7970 6560 2073 7472 696e 6773  e `type` strings
+000181a0: 2074 6861 7420 7374 6172 7420 7769 7468   that start with
+000181b0: 2074 6865 2060 2460 2073 6967 6e2e 2050   the `$` sign. P
+000181c0: 6572 7369 7374 656e 6365 2073 7562 7363  ersistence subsc
+000181d0: 7269 7074 696f 6e5c 6e65 7665 6e74 7320  ription\nevents 
+000181e0: 6765 6e65 7261 7465 6420 7768 656e 206d  generated when m
+000181f0: 616e 6970 756c 6174 696e 6720 7065 7273  anipulating pers
+00018200: 6973 7465 6e63 6520 7375 6273 6372 6970  istence subscrip
+00018210: 7469 6f6e 7320 616c 6c20 6861 7665 2060  tions all have `
+00018220: 7479 7065 605c 6e73 7472 696e 6773 2074  type`\nstrings t
+00018230: 6861 7420 7374 6172 7420 7769 7468 2060  hat start with `
+00018240: 5065 7273 6973 7465 6e74 436f 6e66 6967  PersistentConfig
+00018250: 602e 5c6e 5c6e 466f 7220 6578 616d 706c  `.\n\nFor exampl
+00018260: 652c 2074 6f20 6d61 7463 6820 7468 6520  e, to match the 
+00018270: 7479 7065 206f 6620 4576 656e 7453 746f  type of EventSto
+00018280: 7265 4442 2073 7973 7465 6d20 6576 656e  reDB system even
+00018290: 7473 2c20 7573 6520 7468 6520 7265 6775  ts, use the regu
+000182a0: 6c61 725c 6e65 7870 7265 7373 696f 6e20  lar\nexpression 
+000182b0: 6072 5c27 5c5c 242e 2b5c 2760 2e20 506c  `r\'\\$.+\'`. Pl
+000182c0: 6561 7365 206e 6f74 652c 2074 6865 2063  ease note, the c
+000182d0: 6f6e 7374 616e 7420 6045 5344 425f 5359  onstant `ESDB_SY
+000182e0: 5354 454d 5f45 5645 4e54 535f 5245 4745  STEM_EVENTS_REGE
+000182f0: 5860 2069 735c 6e73 6574 2074 6f20 6072  X` is\nset to `r
+00018300: 5c27 5c5c 242e 2b5c 2760 2e20 596f 7520  \'\\$.+\'`. You 
+00018310: 6361 6e20 696d 706f 7274 2074 6869 7320  can import this 
+00018320: 7661 6c75 655c 6e28 6066 726f 6d20 6573  value\n(`from es
+00018330: 6462 636c 6965 6e74 2069 6d70 6f72 7420  dbclient import 
+00018340: 4553 4442 5f53 5953 5445 4d5f 4556 454e  ESDB_SYSTEM_EVEN
+00018350: 5453 5f52 4547 4558 6029 2061 6e64 2075  TS_REGEX`) and u
+00018360: 7365 5c6e 6974 2077 6865 6e20 6275 696c  se\nit when buil
+00018370: 6469 6e67 206c 6f6e 6765 7220 7365 7175  ding longer sequ
+00018380: 656e 6365 7320 6f66 2072 6567 756c 6172  ences of regular
+00018390: 2065 7870 7265 7373 696f 6e73 2e5c 6e5c   expressions.\n\
+000183a0: 6e53 696d 696c 6172 6c79 2c20 746f 206d  nSimilarly, to m
+000183b0: 6174 6368 2074 6865 2074 7970 6520 6f66  atch the type of
+000183c0: 2045 7665 6e74 5374 6f72 6544 4220 7065   EventStoreDB pe
+000183d0: 7273 6973 7465 6e63 6520 7375 6273 6372  rsistence subscr
+000183e0: 6970 7469 6f6e 2065 7665 6e74 732c 2075  iption events, u
+000183f0: 7365 2074 6865 5c6e 7265 6775 6c61 7220  se the\nregular 
+00018400: 6578 7072 6573 7369 6f6e 2060 725c 2750  expression `r\'P
+00018410: 6572 7369 7374 656e 7443 6f6e 6669 675c  ersistentConfig\
+00018420: 5c64 2b5c 2760 2e20 5468 6520 636f 6e73  \d+\'`. The cons
+00018430: 7461 6e74 2060 4553 4442 5f50 4552 5349  tant `ESDB_PERSI
+00018440: 5354 454e 545f 434f 4e46 4947 5f45 5645  STENT_CONFIG_EVE
+00018450: 4e54 535f 5245 4745 5860 5c6e 6973 2073  NTS_REGEX`\nis s
+00018460: 6574 2074 6f20 6072 5c27 5065 7273 6973  et to `r\'Persis
+00018470: 7465 6e74 436f 6e66 6967 5c5c 642b 5c27  tentConfig\\d+\'
+00018480: 602e 2059 6f75 2063 616e 2061 6c73 6f20  `. You can also 
+00018490: 696d 706f 7274 2074 6869 7320 7661 6c75  import this valu
+000184a0: 655c 6e28 6066 726f 6d20 6573 6462 636c  e\n(`from esdbcl
+000184b0: 6965 6e74 2069 6d70 6f72 7420 4553 4442  ient import ESDB
+000184c0: 5f50 4552 5349 5354 454e 545f 434f 4e46  _PERSISTENT_CONF
+000184d0: 4947 5f45 5645 4e54 535f 5245 4745 5860  IG_EVENTS_REGEX`
+000184e0: 2920 616e 6420 7573 6520 6974 2077 6865  ) and use it whe
+000184f0: 6e20 6275 696c 6469 6e67 5c6e 6c6f 6e67  n building\nlong
+00018500: 6572 2073 6571 7565 6e63 6573 206f 6620  er sequences of 
+00018510: 7265 6775 6c61 7220 6578 7072 6573 7369  regular expressi
+00018520: 6f6e 732e 5c6e 5c6e 5468 6520 636f 6e73  ons.\n\nThe cons
+00018530: 7461 6e74 2060 4445 4641 554c 545f 4558  tant `DEFAULT_EX
+00018540: 434c 5544 455f 4649 4c54 4552 6020 6973  CLUDE_FILTER` is
+00018550: 2061 2073 6571 7565 6e63 6520 6f66 2072   a sequence of r
+00018560: 6567 756c 6172 2065 7870 7265 7373 696f  egular expressio
+00018570: 6e73 2074 6861 7420 6d61 7463 685c 6e74  ns that match\nt
+00018580: 6865 2065 7665 6e74 7320 7468 6174 2045  he events that E
+00018590: 7665 6e74 5374 6f72 6544 4220 6765 6e65  ventStoreDB gene
+000185a0: 7261 7465 7320 696e 7465 726e 616c 6c79  rates internally
+000185b0: 2c20 6576 656e 7473 2074 6861 7420 6172  , events that ar
+000185c0: 6520 6578 7472 616e 656f 7573 2074 6f20  e extraneous to 
+000185d0: 7468 6f73 655c 6e77 6869 6368 2079 6f75  those\nwhich you
+000185e0: 2061 7070 656e 6420 7573 696e 6720 7468   append using th
+000185f0: 6520 6061 7070 656e 645f 6576 656e 7473  e `append_events
+00018600: 2829 6020 6d65 7468 6f64 2e5c 6e5c 6e5c  ()` method.\n\n\
+00018610: 6e23 2323 204e 6577 2065 7665 6e74 206f  n### New event o
+00018620: 626a 6563 7473 5c6e 5c6e 5468 6520 604e  bjects\n\nThe `N
+00018630: 6577 4576 656e 7460 2063 6c61 7373 2069  ewEvent` class i
+00018640: 7320 7573 6564 2077 6865 6e20 6170 7065  s used when appe
+00018650: 6e64 696e 6720 6576 656e 7473 2e5c 6e5c  nding events.\n\
+00018660: 6e54 6865 2072 6571 7569 7265 6420 6172  nThe required ar
+00018670: 6775 6d65 6e74 2060 7479 7065 6020 6973  gument `type` is
+00018680: 2061 2050 7974 686f 6e20 6073 7472 602c   a Python `str`,
+00018690: 2075 7365 6420 746f 2069 6e64 6963 6174   used to indicat
+000186a0: 6520 7468 6520 7479 7065 206f 665c 6e74  e the type of\nt
+000186b0: 6865 2065 7665 6e74 2074 6861 7420 7769  he event that wi
+000186c0: 6c6c 2062 6520 7265 636f 7264 6564 2e5c  ll be recorded.\
+000186d0: 6e5c 6e54 6865 2072 6571 7569 7265 6420  n\nThe required 
+000186e0: 6172 6775 6d65 6e74 2060 6461 7461 6020  argument `data` 
+000186f0: 6973 2061 2050 7974 686f 6e20 6062 7974  is a Python `byt
+00018700: 6573 6020 6f62 6a65 6374 2c20 7573 6564  es` object, used
+00018710: 2074 6f20 696e 6469 6361 7465 2074 6865   to indicate the
+00018720: 2064 6174 6120 6f66 5c6e 7468 6520 6576   data of\nthe ev
+00018730: 656e 7420 7468 6174 2077 696c 6c20 6265  ent that will be
+00018740: 2072 6563 6f72 6465 642e 5c6e 5c6e 5468   recorded.\n\nTh
+00018750: 6520 6f70 7469 6f6e 616c 2061 7267 756d  e optional argum
+00018760: 656e 7420 606d 6574 6164 6174 6160 2069  ent `metadata` i
+00018770: 7320 6120 5079 7468 6f6e 2060 6279 7465  s a Python `byte
+00018780: 7360 206f 626a 6563 742c 2075 7365 6420  s` object, used 
+00018790: 746f 2069 6e64 6963 6174 6520 616e 795c  to indicate any\
+000187a0: 6e6d 6574 6164 6174 6120 6f66 2074 6865  nmetadata of the
+000187b0: 2065 7665 6e74 2074 6861 7420 7769 6c6c   event that will
+000187c0: 2062 6520 7265 636f 7264 6564 2e20 5468   be recorded. Th
+000187d0: 6520 6465 6661 756c 7420 7661 6c75 6520  e default value 
+000187e0: 6973 2061 6e20 656d 7074 7920 6062 7974  is an empty `byt
+000187f0: 6573 605c 6e6f 626a 6563 742e 5c6e 5c6e  es`\nobject.\n\n
+00018800: 5468 6520 6f70 7469 6f6e 616c 2061 7267  The optional arg
+00018810: 756d 656e 7420 6063 6f6e 7465 6e74 5f74  ument `content_t
+00018820: 7970 6560 2069 7320 6120 5079 7468 6f6e  ype` is a Python
+00018830: 2060 7374 7260 2c20 7573 6564 2074 6f20   `str`, used to 
+00018840: 696e 6469 6361 7465 2074 6865 5c6e 7479  indicate the\nty
+00018850: 7065 206f 6620 7468 6520 6461 7461 2074  pe of the data t
+00018860: 6861 7420 7769 6c6c 2062 6520 7265 636f  hat will be reco
+00018870: 7264 6564 2066 6f72 2074 6869 7320 6576  rded for this ev
+00018880: 656e 742e 2054 6865 2064 6566 6175 6c74  ent. The default
+00018890: 2076 616c 7565 2069 735c 6e60 6170 706c   value is\n`appl
+000188a0: 6963 6174 696f 6e2f 6a73 6f6e 602c 2077  ication/json`, w
+000188b0: 6869 6368 2069 6e64 6963 6174 6573 2074  hich indicates t
+000188c0: 6861 7420 7468 6520 6064 6174 6160 2077  hat the `data` w
+000188d0: 6173 2073 6572 6961 6c69 7365 6420 7573  as serialised us
+000188e0: 696e 6720 4a53 4f4e 2e5c 6e41 6e20 616c  ing JSON.\nAn al
+000188f0: 7465 726e 6174 6976 6520 7661 6c75 6520  ternative value 
+00018900: 666f 7220 7468 6973 2061 7267 756d 656e  for this argumen
+00018910: 7420 6973 2060 6170 706c 6963 6174 696f  t is `applicatio
+00018920: 6e2f 6f63 7465 742d 7374 7265 616d 602e  n/octet-stream`.
+00018930: 5c6e 5c6e 5468 6520 6f70 7469 6f6e 616c  \n\nThe optional
+00018940: 2061 7267 756d 656e 7420 6069 6460 2069   argument `id` i
+00018950: 7320 6120 5079 7468 6f6e 2060 5555 4944  s a Python `UUID
+00018960: 6020 6f62 6a65 6374 2c20 7573 6564 2074  ` object, used t
+00018970: 6f20 7370 6563 6966 7920 7468 6520 756e  o specify the un
+00018980: 6971 7565 2049 445c 6e6f 6620 7468 6520  ique ID\nof the 
+00018990: 6576 656e 7420 7468 6174 2077 696c 6c20  event that will 
+000189a0: 6265 2072 6563 6f72 6465 642e 2054 6869  be recorded. Thi
+000189b0: 7320 7661 6c75 6520 7769 6c6c 2064 6566  s value will def
+000189c0: 6175 6c74 2074 6f20 6120 6e65 7720 7665  ault to a new ve
+000189d0: 7273 696f 6e2d 3420 5555 4944 2e5c 6e5c  rsion-4 UUID.\n\
+000189e0: 6e60 6060 7079 7468 6f6e 5c6e 6e65 775f  n```python\nnew_
+000189f0: 6576 656e 7431 203d 204e 6577 4576 656e  event1 = NewEven
+00018a00: 7428 5c6e 2020 2020 7479 7065 3d5c 274f  t(\n    type=\'O
+00018a10: 7264 6572 4372 6561 7465 645c 272c 5c6e  rderCreated\',\n
+00018a20: 2020 2020 6461 7461 3d62 5c27 7b22 6e61      data=b\'{"na
+00018a30: 6d65 223a 2022 4772 6567 227d 5c27 2c5c  me": "Greg"}\',\
+00018a40: 6e29 5c6e 6173 7365 7274 206e 6577 5f65  n)\nassert new_e
+00018a50: 7665 6e74 312e 7479 7065 203d 3d20 5c27  vent1.type == \'
+00018a60: 4f72 6465 7243 7265 6174 6564 5c27 5c6e  OrderCreated\'\n
+00018a70: 6173 7365 7274 206e 6577 5f65 7665 6e74  assert new_event
+00018a80: 312e 6461 7461 203d 3d20 625c 277b 226e  1.data == b\'{"n
+00018a90: 616d 6522 3a20 2247 7265 6722 7d5c 275c  ame": "Greg"}\'\
+00018aa0: 6e61 7373 6572 7420 6e65 775f 6576 656e  nassert new_even
+00018ab0: 7431 2e6d 6574 6164 6174 6120 3d3d 2062  t1.metadata == b
+00018ac0: 5c27 5c27 5c6e 6173 7365 7274 206e 6577  \'\'\nassert new
+00018ad0: 5f65 7665 6e74 312e 636f 6e74 656e 745f  _event1.content_
+00018ae0: 7479 7065 203d 3d20 5c27 6170 706c 6963  type == \'applic
+00018af0: 6174 696f 6e2f 6a73 6f6e 5c27 5c6e 6173  ation/json\'\nas
+00018b00: 7365 7274 2069 7369 6e73 7461 6e63 6528  sert isinstance(
+00018b10: 6e65 775f 6576 656e 7431 2e69 642c 2055  new_event1.id, U
+00018b20: 5549 4429 5c6e 5c6e 6576 656e 745f 6964  UID)\n\nevent_id
+00018b30: 203d 2075 7569 6434 2829 5c6e 6e65 775f   = uuid4()\nnew_
+00018b40: 6576 656e 7432 203d 204e 6577 4576 656e  event2 = NewEven
+00018b50: 7428 5c6e 2020 2020 7479 7065 3d5c 2749  t(\n    type=\'I
+00018b60: 6d61 6765 4372 6561 7465 645c 272c 5c6e  mageCreated\',\n
+00018b70: 2020 2020 6461 7461 3d62 5c27 3031 3031      data=b\'0101
+00018b80: 3031 3031 3031 3031 3031 5c27 2c5c 6e20  0101010101\',\n 
+00018b90: 2020 206d 6574 6164 6174 613d 625c 277b     metadata=b\'{
+00018ba0: 2261 223a 2031 7d5c 272c 5c6e 2020 2020  "a": 1}\',\n    
+00018bb0: 636f 6e74 656e 745f 7479 7065 3d5c 2761  content_type=\'a
+00018bc0: 7070 6c69 6361 7469 6f6e 2f6f 6374 6574  pplication/octet
+00018bd0: 2d73 7472 6561 6d5c 272c 5c6e 2020 2020  -stream\',\n    
+00018be0: 6964 3d65 7665 6e74 5f69 642c 5c6e 295c  id=event_id,\n)\
+00018bf0: 6e61 7373 6572 7420 6e65 775f 6576 656e  nassert new_even
+00018c00: 7432 2e74 7970 6520 3d3d 205c 2749 6d61  t2.type == \'Ima
+00018c10: 6765 4372 6561 7465 645c 275c 6e61 7373  geCreated\'\nass
+00018c20: 6572 7420 6e65 775f 6576 656e 7432 2e64  ert new_event2.d
+00018c30: 6174 6120 3d3d 2062 5c27 3031 3031 3031  ata == b\'010101
+00018c40: 3031 3031 3031 3031 5c27 5c6e 6173 7365  01010101\'\nasse
+00018c50: 7274 206e 6577 5f65 7665 6e74 322e 6d65  rt new_event2.me
+00018c60: 7461 6461 7461 203d 3d20 625c 277b 2261  tadata == b\'{"a
+00018c70: 223a 2031 7d5c 275c 6e61 7373 6572 7420  ": 1}\'\nassert 
+00018c80: 6e65 775f 6576 656e 7432 2e63 6f6e 7465  new_event2.conte
+00018c90: 6e74 5f74 7970 6520 3d3d 205c 2761 7070  nt_type == \'app
+00018ca0: 6c69 6361 7469 6f6e 2f6f 6374 6574 2d73  lication/octet-s
+00018cb0: 7472 6561 6d5c 275c 6e61 7373 6572 7420  tream\'\nassert 
+00018cc0: 6e65 775f 6576 656e 7432 2e69 6420 3d3d  new_event2.id ==
+00018cd0: 2065 7665 6e74 5f69 645c 6e60 6060 5c6e   event_id\n```\n
+00018ce0: 5c6e 2323 2320 5265 636f 7264 6564 2065  \n### Recorded e
+00018cf0: 7665 6e74 206f 626a 6563 7473 5c6e 5c6e  vent objects\n\n
+00018d00: 5468 6520 6052 6563 6f72 6465 6445 7665  The `RecordedEve
+00018d10: 6e74 6020 636c 6173 7320 6973 2075 7365  nt` class is use
+00018d20: 6420 7768 656e 2072 6561 6469 6e67 2065  d when reading e
+00018d30: 7665 6e74 732e 5c6e 5c6e 5468 6520 6174  vents.\n\nThe at
+00018d40: 7472 6962 7574 6520 6074 7970 6560 2069  tribute `type` i
+00018d50: 7320 6120 5079 7468 6f6e 2060 7374 7260  s a Python `str`
+00018d60: 2c20 7573 6564 2074 6f20 696e 6469 6361  , used to indica
+00018d70: 7465 2074 6865 2074 7970 6520 6f66 2065  te the type of e
+00018d80: 7665 6e74 5c6e 7468 6174 2077 6173 2072  vent\nthat was r
+00018d90: 6563 6f72 6465 642e 5c6e 5c6e 5468 6520  ecorded.\n\nThe 
+00018da0: 6174 7472 6962 7574 6520 6064 6174 6160  attribute `data`
+00018db0: 2069 7320 6120 5079 7468 6f6e 2060 6279   is a Python `by
+00018dc0: 7465 7360 206f 626a 6563 742c 2075 7365  tes` object, use
+00018dd0: 6420 746f 2069 6e64 6963 6174 6520 7468  d to indicate th
+00018de0: 6520 6461 7461 206f 6620 7468 655c 6e65  e data of the\ne
+00018df0: 7665 6e74 2074 6861 7420 7761 7320 7265  vent that was re
+00018e00: 636f 7264 6564 2e5c 6e5c 6e54 6865 2061  corded.\n\nThe a
+00018e10: 7474 7269 6275 7465 2060 6d65 7461 6461  ttribute `metada
+00018e20: 7461 6020 6973 2061 2050 7974 686f 6e20  ta` is a Python 
+00018e30: 6062 7974 6573 6020 6f62 6a65 6374 2c20  `bytes` object, 
+00018e40: 7573 6564 2074 6f20 696e 6469 6361 7465  used to indicate
+00018e50: 2074 6865 206d 6574 6164 6174 6120 6f66   the metadata of
+00018e60: 5c6e 7468 6520 6576 656e 7420 7468 6174  \nthe event that
+00018e70: 2077 6173 2072 6563 6f72 6465 642e 5c6e   was recorded.\n
+00018e80: 5c6e 5468 6520 6174 7472 6962 7574 6520  \nThe attribute 
+00018e90: 6063 6f6e 7465 6e74 5f74 7970 6560 2069  `content_type` i
+00018ea0: 7320 6120 5079 7468 6f6e 2060 7374 7260  s a Python `str`
+00018eb0: 2c20 7573 6564 2074 6f20 696e 6469 6361  , used to indica
+00018ec0: 7465 2074 6865 2074 7970 6520 6f66 5c6e  te the type of\n
+00018ed0: 6461 7461 2074 6861 7420 7761 7320 7265  data that was re
+00018ee0: 636f 7264 6564 2066 6f72 2074 6869 7320  corded for this 
+00018ef0: 6576 656e 7420 2875 7375 616c 6c79 2060  event (usually `
+00018f00: 6170 706c 6963 6174 696f 6e2f 6a73 6f6e  application/json
+00018f10: 6020 746f 2069 6e64 6963 6174 6520 7468  ` to indicate th
+00018f20: 6174 5c6e 7468 6973 2064 6174 6120 6361  at\nthis data ca
+00018f30: 6e20 6265 2070 6172 7365 6420 6173 204a  n be parsed as J
+00018f40: 534f 4e2c 2062 7574 2061 6c74 6572 6e61  SON, but alterna
+00018f50: 7469 7665 6c79 2060 6170 706c 6963 6174  tively `applicat
+00018f60: 696f 6e2f 6f63 7465 742d 7374 7265 616d  ion/octet-stream
+00018f70: 6020 746f 5c6e 696e 6469 6361 7465 2074  ` to\nindicate t
+00018f80: 6861 7420 6974 2069 7320 736f 6d65 7468  hat it is someth
+00018f90: 696e 6720 656c 7365 292e 5c6e 5c6e 5468  ing else).\n\nTh
+00018fa0: 6520 6174 7472 6962 7574 6520 6069 6460  e attribute `id`
+00018fb0: 2069 7320 6120 5079 7468 6f6e 2060 5555   is a Python `UU
+00018fc0: 4944 6020 6f62 6a65 6374 2c20 7573 6564  ID` object, used
+00018fd0: 2074 6f20 696e 6469 6361 7465 2074 6865   to indicate the
+00018fe0: 2075 6e69 7175 6520 4944 206f 6620 7468   unique ID of th
+00018ff0: 655c 6e65 7665 6e74 2074 6861 7420 7761  e\nevent that wa
+00019000: 7320 7265 636f 7264 6564 2e20 506c 6561  s recorded. Plea
+00019010: 7365 206e 6f74 652c 2077 6865 6e20 7265  se note, when re
+00019020: 636f 7264 6564 2065 7665 6e74 7320 6172  corded events ar
+00019030: 6520 7265 7475 726e 6564 2066 726f 6d20  e returned from 
+00019040: 6120 6361 6c6c 5c6e 746f 2060 7265 6164  a call\nto `read
+00019050: 5f73 7472 6561 6d5f 6576 656e 7473 2829  _stream_events()
+00019060: 6020 696e 2045 7665 6e74 5374 6f72 6544  ` in EventStoreD
+00019070: 4220 7632 312e 3130 2c20 7468 6520 636f  B v21.10, the co
+00019080: 6d6d 6974 2070 6f73 6974 696f 6e20 6973  mmit position is
+00019090: 206e 6f74 2061 6374 7561 6c6c 795c 6e73   not actually\ns
+000190a0: 6574 2069 6e20 7468 6520 7265 7370 6f6e  et in the respon
+000190b0: 7365 2e20 5468 6973 2061 7474 7269 6275  se. This attribu
+000190c0: 7465 2069 7320 7479 7065 6420 6173 2061  te is typed as a
+000190d0: 6e20 6f70 7469 6f6e 616c 2076 616c 7565  n optional value
+000190e0: 2028 604f 7074 696f 6e61 6c5b 5555 4944   (`Optional[UUID
+000190f0: 5d60 292c 5c6e 616e 6420 696e 2074 6865  ]`),\nand in the
+00019100: 2063 6173 6520 6f66 2075 7369 6e67 2045   case of using E
+00019110: 7665 6e74 5374 6f72 6544 4220 7632 312e  ventStoreDB v21.
+00019120: 3130 2074 6865 2076 616c 7565 206f 6620  10 the value of 
+00019130: 7468 6973 2061 7474 7269 6275 7465 2077  this attribute w
+00019140: 696c 6c20 6265 2060 4e6f 6e65 605c 6e77  ill be `None`\nw
+00019150: 6865 6e20 7265 6164 696e 6720 7265 636f  hen reading reco
+00019160: 7264 6564 2065 7665 6e74 7320 6672 6f6d  rded events from
+00019170: 2061 2073 7472 6561 6d2e 2052 6563 6f72   a stream. Recor
+00019180: 6465 6420 6576 656e 7473 2077 696c 6c20  ded events will 
+00019190: 686f 7765 7665 7220 6861 7665 2074 6869  however have thi
+000191a0: 735c 6e76 616c 7565 7320 7365 7420 7768  s\nvalues set wh
+000191b0: 656e 2072 6561 6469 6e67 2072 6563 6f72  en reading recor
+000191c0: 6465 6420 6576 656e 7473 2066 726f 6d20  ded events from 
+000191d0: 6072 6561 645f 616c 6c5f 6576 656e 7473  `read_all_events
+000191e0: 2829 6020 616e 6420 6672 6f6d 2062 6f74  ()` and from bot
+000191f0: 685c 6e63 6174 6368 2d75 7020 616e 6420  h\ncatch-up and 
+00019200: 7065 7273 6973 7465 6e74 2073 7562 7363  persistent subsc
+00019210: 7269 7074 696f 6e73 2e5c 6e5c 6e54 6865  riptions.\n\nThe
+00019220: 2061 7474 7269 6275 7465 2060 7374 7265   attribute `stre
+00019230: 616d 5f6e 616d 6560 2069 7320 6120 5079  am_name` is a Py
+00019240: 7468 6f6e 2060 7374 7260 2c20 7573 6564  thon `str`, used
+00019250: 2074 6f20 696e 6469 6361 7465 2074 6865   to indicate the
+00019260: 206e 616d 6520 6f66 2074 6865 5c6e 7374   name of the\nst
+00019270: 7265 616d 2069 6e20 7768 6963 6820 7468  ream in which th
+00019280: 6520 6576 656e 7420 7761 7320 7265 636f  e event was reco
+00019290: 7264 6564 2e5c 6e5c 6e54 6865 2061 7474  rded.\n\nThe att
+000192a0: 7269 6275 7465 2060 7374 7265 616d 5f70  ribute `stream_p
+000192b0: 6f73 6974 696f 6e60 2069 7320 6120 5079  osition` is a Py
+000192c0: 7468 6f6e 2060 696e 7460 2c20 7573 6564  thon `int`, used
+000192d0: 2074 6f20 696e 6469 6361 7465 2074 6865   to indicate the
+000192e0: 2070 6f73 6974 696f 6e20 696e 2074 6865   position in the
+000192f0: 5c6e 7374 7265 616d 2061 7420 7768 6963  \nstream at whic
+00019300: 6820 7468 6520 6576 656e 7420 7761 7320  h the event was 
+00019310: 7265 636f 7264 6564 2e5c 6e5c 6e54 6865  recorded.\n\nThe
+00019320: 2061 7474 7269 6275 7465 2060 636f 6d6d   attribute `comm
+00019330: 6974 5f70 6f73 6974 696f 6e60 2069 7320  it_position` is 
+00019340: 6120 5079 7468 6f6e 2060 696e 7460 2c20  a Python `int`, 
+00019350: 7573 6564 2074 6f20 696e 6469 6361 7465  used to indicate
+00019360: 2074 6865 2063 6f6d 6d69 7420 706f 7369   the commit posi
+00019370: 7469 6f6e 5c6e 6174 2077 6869 6368 2074  tion\nat which t
+00019380: 6865 2065 7665 6e74 2077 6173 2072 6563  he event was rec
+00019390: 6f72 6465 642e 5c6e 5c6e 6060 6070 7974  orded.\n\n```pyt
+000193a0: 686f 6e5c 6e66 726f 6d20 6573 6462 636c  hon\nfrom esdbcl
+000193b0: 6965 6e74 2e65 7665 6e74 7320 696d 706f  ient.events impo
+000193c0: 7274 2052 6563 6f72 6465 6445 7665 6e74  rt RecordedEvent
+000193d0: 5c6e 5c6e 7265 636f 7264 6564 5f65 7665  \n\nrecorded_eve
+000193e0: 6e74 203d 2052 6563 6f72 6465 6445 7665  nt = RecordedEve
+000193f0: 6e74 285c 6e20 2020 2074 7970 653d 5c27  nt(\n    type=\'
+00019400: 4f72 6465 7243 7265 6174 6564 5c27 2c5c  OrderCreated\',\
+00019410: 6e20 2020 2064 6174 613d 625c 277b 7d5c  n    data=b\'{}\
+00019420: 272c 5c6e 2020 2020 6d65 7461 6461 7461  ',\n    metadata
+00019430: 3d62 5c27 5c27 2c5c 6e20 2020 2063 6f6e  =b\'\',\n    con
+00019440: 7465 6e74 5f74 7970 653d 5c27 6170 706c  tent_type=\'appl
+00019450: 6963 6174 696f 6e2f 6a73 6f6e 5c27 2c5c  ication/json\',\
+00019460: 6e20 2020 2069 643d 7575 6964 3428 292c  n    id=uuid4(),
+00019470: 5c6e 2020 2020 7374 7265 616d 5f6e 616d  \n    stream_nam
+00019480: 653d 5c27 7374 7265 616d 315c 272c 5c6e  e=\'stream1\',\n
+00019490: 2020 2020 7374 7265 616d 5f70 6f73 6974      stream_posit
+000194a0: 696f 6e3d 302c 5c6e 2020 2020 636f 6d6d  ion=0,\n    comm
+000194b0: 6974 5f70 6f73 6974 696f 6e3d 3531 322c  it_position=512,
+000194c0: 5c6e 295c 6e60 6060 5c6e 5c6e 2323 2320  \n)\n```\n\n### 
+000194d0: 4173 796e 6369 6f20 636c 6965 6e74 5c6e  Asyncio client\n
+000194e0: 5c6e 5468 6520 6065 7364 6263 6c69 656e  \nThe `esdbclien
+000194f0: 7460 2070 6163 6b61 6765 2061 6c73 6f20  t` package also 
+00019500: 696e 636c 7564 6573 2061 6e20 6561 726c  includes an earl
+00019510: 7920 7665 7273 696f 6e20 6f66 2061 6e20  y version of an 
+00019520: 6173 796e 6368 726f 6e6f 7573 2049 2f4f  asynchronous I/O
+00019530: 5c6e 6752 5043 2050 7974 686f 6e20 636c  \ngRPC Python cl
+00019540: 6965 6e74 2e20 4974 2066 6f6c 6c6f 7773  ient. It follows
+00019550: 2065 7861 6374 6c79 2074 6865 2073 616d   exactly the sam
+00019560: 6520 6265 6861 7669 6f72 7320 6173 2074  e behaviors as t
+00019570: 6865 206d 756c 7469 7468 7265 6164 6564  he multithreaded
+00019580: 5c6e 6045 5344 4243 6c69 656e 7460 2c20  \n`ESDBClient`, 
+00019590: 6275 7420 7573 6573 2074 6865 2060 6772  but uses the `gr
+000195a0: 7063 2e61 696f 6020 7061 636b 6167 6520  pc.aio` package 
+000195b0: 616e 6420 7468 6520 6061 7379 6e63 696f  and the `asyncio
+000195c0: 6020 6d6f 6475 6c65 2c20 696e 7374 6561  ` module, instea
+000195d0: 6420 6f66 5c6e 6067 7270 6360 2061 6e64  d of\n`grpc` and
+000195e0: 2060 7468 7265 6164 696e 6760 2e5c 6e5c   `threading`.\n\
+000195f0: 6e54 6865 2060 6173 796e 6360 2066 756e  nThe `async` fun
+00019600: 6374 696f 6e20 6041 7379 6e63 696f 4553  ction `AsyncioES
+00019610: 4442 436c 6965 6e74 6020 636f 6e73 7472  DBClient` constr
+00019620: 7563 7473 2074 6865 2063 6c69 656e 742c  ucts the client,
+00019630: 2061 6e64 2063 6f6e 6e65 6374 7320 746f   and connects to
+00019640: 5c6e 6120 7365 7276 6572 2e20 4974 2063  \na server. It c
+00019650: 616e 2062 6520 696d 706f 7274 6564 2066  an be imported f
+00019660: 726f 6d20 6065 7364 6263 6c69 656e 7460  rom `esdbclient`
+00019670: 2c20 616e 6420 6361 6e20 6265 2063 616c  , and can be cal
+00019680: 6c65 6420 7769 7468 2074 6865 2073 616d  led with the sam
+00019690: 655c 6e61 7267 756d 656e 7473 2061 7320  e\narguments as 
+000196a0: 6045 5344 4243 6c69 656e 7460 2e20 4974  `ESDBClient`. It
+000196b0: 2073 7570 706f 7274 7320 626f 7468 2074   supports both t
+000196c0: 6865 2022 6573 6462 2220 616e 6420 7468  he "esdb" and th
+000196d0: 6520 2265 7364 622b 6469 7363 6f76 6572  e "esdb+discover
+000196e0: 225c 6e63 6f6e 6e65 6374 696f 6e20 7374  "\nconnection st
+000196f0: 7269 6e67 2055 5249 2073 6368 656d 6573  ring URI schemes
+00019700: 2c20 616e 6420 7265 636f 6e6e 6563 7473  , and reconnects
+00019710: 2061 6e64 2072 6574 7269 6573 206d 6574   and retries met
+00019720: 686f 6473 2077 6865 6e20 636f 6e6e 6563  hods when connec
+00019730: 7469 6f6e 5c6e 6973 7375 6573 2061 7265  tion\nissues are
+00019740: 2065 6e63 6f75 6e74 6572 6564 2c20 6a75   encountered, ju
+00019750: 7374 206c 696b 6520 6045 5344 4243 6c69  st like `ESDBCli
+00019760: 656e 7460 2e5c 6e5c 6e60 6060 7079 7468  ent`.\n\n```pyth
+00019770: 6f6e 5c6e 6672 6f6d 2065 7364 6263 6c69  on\nfrom esdbcli
+00019780: 656e 7420 696d 706f 7274 2041 7379 6e63  ent import Async
+00019790: 696f 4553 4442 436c 6965 6e74 5c6e 6060  ioESDBClient\n``
+000197a0: 605c 6e5c 6e54 6865 2061 7379 6e63 6872  `\n\nThe asynchr
+000197b0: 6f6e 6f75 7320 492f 4f20 636c 6965 6e74  onous I/O client
+000197c0: 2068 6173 2060 6173 796e 6360 206d 6574   has `async` met
+000197d0: 686f 6473 2060 6170 7065 6e64 5f65 7665  hods `append_eve
+000197e0: 6e74 7328 2960 2c5c 6e60 7265 6164 5f73  nts()`,\n`read_s
+000197f0: 7472 6561 6d5f 6576 656e 7473 2829 602c  tream_events()`,
+00019800: 2060 7265 6164 5f61 6c6c 5f65 7665 6e74   `read_all_event
+00019810: 7328 2960 2c20 6073 7562 7363 7269 6265  s()`, `subscribe
+00019820: 5f61 6c6c 5f65 7665 6e74 7328 2960 2c5c  _all_events()`,\
+00019830: 6e60 6465 6c65 7465 5f73 7472 6561 6d28  n`delete_stream(
+00019840: 2960 2c20 6074 6f6d 6273 746f 6e65 5f73  )`, `tombstone_s
+00019850: 7472 6561 6d28 2960 2c20 616e 6420 6072  tream()`, and `r
+00019860: 6563 6f6e 6e65 6374 2829 602e 5c6e 5c6e  econnect()`.\n\n
+00019870: 5468 6573 6520 6d65 7468 6f64 7320 6172  These methods ar
+00019880: 6520 6571 7569 7661 6c65 6e74 2074 6f20  e equivalent to 
+00019890: 7468 6520 6d65 7468 6f64 7320 6f6e 2060  the methods on `
+000198a0: 4553 4442 436c 6965 6e74 602e 2054 6865  ESDBClient`. The
+000198b0: 7920 6861 7665 2074 6865 2073 616d 655c  y have the same\
+000198c0: 6e6d 6574 686f 6420 7369 676e 6174 7572  nmethod signatur
+000198d0: 6573 2c20 616e 6420 6361 6e20 6265 2063  es, and can be c
+000198e0: 616c 6c65 6420 7769 7468 2074 6865 2073  alled with the s
+000198f0: 616d 6520 6172 6775 6d65 6e74 732c 2074  ame arguments, t
+00019900: 6f20 7468 6520 7361 6d65 2065 6666 6563  o the same effec
+00019910: 742e 5c6e 5468 6520 6d65 7468 6f64 7320  t.\nThe methods 
+00019920: 7768 6963 6820 6170 7065 6172 206f 6e20  which appear on 
+00019930: 6045 5344 4243 6c69 656e 7460 2062 7574  `ESDBClient` but
+00019940: 206e 6f74 206f 6e20 6041 7379 6e63 696f   not on `Asyncio
+00019950: 4553 4442 436c 6965 6e74 6020 7769 6c6c  ESDBClient` will
+00019960: 2062 655c 6e61 6464 6564 2073 6f6f 6e2e   be\nadded soon.
+00019970: 5c6e 5c6e 5468 6520 6578 616d 706c 6520  \n\nThe example 
+00019980: 6265 6c6f 7720 6465 6d6f 6e73 7472 6174  below demonstrat
+00019990: 6573 2074 6865 2060 6170 7065 6e64 5f65  es the `append_e
+000199a0: 7665 6e74 7328 2960 2c20 6072 6561 645f  vents()`, `read_
+000199b0: 7374 7265 616d 5f65 7665 6e74 7328 2960  stream_events()`
+000199c0: 2061 6e64 5c6e 6073 7562 7363 7269 6265   and\n`subscribe
+000199d0: 5f61 6c6c 5f65 7665 6e74 7328 2960 206d  _all_events()` m
+000199e0: 6574 686f 6473 2e20 5468 6573 6520 6172  ethods. These ar
+000199f0: 6520 7468 6520 6d6f 7374 2075 7365 6675  e the most usefu
+00019a00: 6c20 6d65 7468 6f64 7320 666f 7220 7772  l methods for wr
+00019a10: 6974 696e 675c 6e61 6e20 6576 656e 742d  iting\nan event-
+00019a20: 736f 7572 6365 6420 6170 706c 6963 6174  sourced applicat
+00019a30: 696f 6e2c 2061 6c6c 6f77 696e 6720 6e65  ion, allowing ne
+00019a40: 7720 6167 6772 6567 6174 6520 6576 656e  w aggregate even
+00019a50: 7473 2074 6f20 6265 2072 6563 6f72 6465  ts to be recorde
+00019a60: 642c 2074 6865 5c6e 7265 636f 7264 6564  d, the\nrecorded
+00019a70: 2065 7665 6e74 7320 6f66 2061 6e20 6167   events of an ag
+00019a80: 6772 6567 6174 6520 746f 2062 6520 6f62  gregate to be ob
+00019a90: 7461 696e 6564 2073 6f20 6167 6772 6567  tained so aggreg
+00019aa0: 6174 6573 2063 616e 2062 6520 7265 636f  ates can be reco
+00019ab0: 6e73 7472 7563 7465 642c 5c6e 616e 6420  nstructed,\nand 
+00019ac0: 7468 6520 7374 6174 6520 6f66 2061 6e20  the state of an 
+00019ad0: 6170 706c 6963 6174 696f 6e20 746f 2070  application to p
+00019ae0: 726f 7061 6761 7465 6420 616e 6420 7072  ropagated and pr
+00019af0: 6f63 6573 7365 6420 7769 7468 2022 6578  ocessed with "ex
+00019b00: 6163 746c 792d 6f6e 6365 225c 6e73 656d  actly-once"\nsem
+00019b10: 616e 7469 6373 2e5c 6e5c 6e60 6060 7079  antics.\n\n```py
+00019b20: 7468 6f6e 5c6e 696d 706f 7274 2061 7379  thon\nimport asy
+00019b30: 6e63 696f 5c6e 5c6e 6173 796e 6320 6465  ncio\n\nasync de
+00019b40: 6620 6465 6d6f 6e73 7472 6174 655f 6173  f demonstrate_as
+00019b50: 796e 6369 6f5f 636c 6965 6e74 2829 3a5c  yncio_client():\
+00019b60: 6e5c 6e20 2020 2023 2043 6f6e 7374 7275  n\n    # Constru
+00019b70: 6374 2063 6c69 656e 742e 5c6e 2020 2020  ct client.\n    
+00019b80: 636c 6965 6e74 203d 2061 7761 6974 2041  client = await A
+00019b90: 7379 6e63 696f 4553 4442 436c 6965 6e74  syncioESDBClient
+00019ba0: 285c 6e20 2020 2020 2020 2075 7269 3d6f  (\n        uri=o
+00019bb0: 732e 6765 7465 6e76 2822 4553 4442 5f55  s.getenv("ESDB_U
+00019bc0: 5249 2229 2c5c 6e20 2020 2020 2020 2072  RI"),\n        r
+00019bd0: 6f6f 745f 6365 7274 6966 6963 6174 6573  oot_certificates
+00019be0: 3d6f 732e 6765 7465 6e76 2822 4553 4442  =os.getenv("ESDB
+00019bf0: 5f52 4f4f 545f 4345 5254 4946 4943 4154  _ROOT_CERTIFICAT
+00019c00: 4553 2229 2c5c 6e20 2020 2029 5c6e 5c6e  ES"),\n    )\n\n
+00019c10: 2020 2020 2320 4170 7065 6e64 2065 7665      # Append eve
+00019c20: 6e74 732e 5c6e 2020 2020 7374 7265 616d  nts.\n    stream
+00019c30: 5f6e 616d 6520 3d20 7374 7228 7575 6964  _name = str(uuid
+00019c40: 3428 2929 5c6e 2020 2020 6576 656e 7431  4())\n    event1
+00019c50: 203d 204e 6577 4576 656e 7428 224f 7264   = NewEvent("Ord
+00019c60: 6572 4372 6561 7465 6422 2c20 6461 7461  erCreated", data
+00019c70: 3d62 5c27 7b7d 5c27 295c 6e20 2020 2065  =b\'{}\')\n    e
+00019c80: 7665 6e74 3220 3d20 4e65 7745 7665 6e74  vent2 = NewEvent
+00019c90: 2822 4f72 6465 7255 7064 6174 6564 222c  ("OrderUpdated",
+00019ca0: 2064 6174 613d 625c 277b 7d5c 2729 5c6e   data=b\'{}\')\n
+00019cb0: 2020 2020 6576 656e 7433 203d 204e 6577      event3 = New
+00019cc0: 4576 656e 7428 224f 7264 6572 4465 6c65  Event("OrderDele
+00019cd0: 7465 6422 2c20 6461 7461 3d62 5c27 7b7d  ted", data=b\'{}
+00019ce0: 5c27 295c 6e5c 6e20 2020 2061 7761 6974  \')\n\n    await
+00019cf0: 2063 6c69 656e 742e 6170 7065 6e64 5f65   client.append_e
+00019d00: 7665 6e74 7328 5c6e 2020 2020 2020 2020  vents(\n        
+00019d10: 7374 7265 616d 5f6e 616d 653d 7374 7265  stream_name=stre
+00019d20: 616d 5f6e 616d 652c 5c6e 2020 2020 2020  am_name,\n      
+00019d30: 2020 6578 7065 6374 6564 5f70 6f73 6974    expected_posit
+00019d40: 696f 6e3d 4e6f 6e65 2c5c 6e20 2020 2020  ion=None,\n     
+00019d50: 2020 2065 7665 6e74 733d 5b65 7665 6e74     events=[event
+00019d60: 312c 2065 7665 6e74 322c 2065 7665 6e74  1, event2, event
+00019d70: 335d 5c6e 2020 2020 295c 6e5c 6e20 2020  3]\n    )\n\n   
+00019d80: 2023 2052 6561 6420 7374 7265 616d 2065   # Read stream e
+00019d90: 7665 6e74 732e 5c6e 2020 2020 7265 636f  vents.\n    reco
+00019da0: 7264 6564 203d 2061 7761 6974 2063 6c69  rded = await cli
+00019db0: 656e 742e 7265 6164 5f73 7472 6561 6d5f  ent.read_stream_
+00019dc0: 6576 656e 7473 2873 7472 6561 6d5f 6e61  events(stream_na
+00019dd0: 6d65 295c 6e20 2020 2061 7373 6572 7420  me)\n    assert 
+00019de0: 6c65 6e28 7265 636f 7264 6564 2920 3d3d  len(recorded) ==
+00019df0: 2033 5c6e 2020 2020 6173 7365 7274 2072   3\n    assert r
+00019e00: 6563 6f72 6465 645b 305d 2e69 6420 3d3d  ecorded[0].id ==
+00019e10: 2065 7665 6e74 312e 6964 5c6e 2020 2020   event1.id\n    
+00019e20: 6173 7365 7274 2072 6563 6f72 6465 645b  assert recorded[
+00019e30: 315d 2e69 6420 3d3d 2065 7665 6e74 322e  1].id == event2.
+00019e40: 6964 5c6e 2020 2020 6173 7365 7274 2072  id\n    assert r
+00019e50: 6563 6f72 6465 645b 325d 2e69 6420 3d3d  ecorded[2].id ==
+00019e60: 2065 7665 6e74 332e 6964 5c6e 5c6e 5c6e   event3.id\n\n\n
+00019e70: 2020 2020 2320 5375 6273 6372 6962 6520      # Subscribe 
+00019e80: 616c 6c20 6576 656e 7473 2e5c 6e20 2020  all events.\n   
+00019e90: 2072 6563 6569 7665 6420 3d20 5b5d 5c6e   received = []\n
+00019ea0: 2020 2020 6173 796e 6320 666f 7220 6576      async for ev
+00019eb0: 656e 7420 696e 2061 7761 6974 2063 6c69  ent in await cli
+00019ec0: 656e 742e 7375 6273 6372 6962 655f 616c  ent.subscribe_al
+00019ed0: 6c5f 6576 656e 7473 2829 3a5c 6e20 2020  l_events():\n   
+00019ee0: 2020 2020 2072 6563 6569 7665 642e 6170       received.ap
+00019ef0: 7065 6e64 2865 7665 6e74 295c 6e20 2020  pend(event)\n   
+00019f00: 2020 2020 2069 6620 6576 656e 742e 6964       if event.id
+00019f10: 203d 3d20 6576 656e 7433 2e69 643a 5c6e   == event3.id:\n
+00019f20: 2020 2020 2020 2020 2020 2020 6272 6561              brea
+00019f30: 6b5c 6e20 2020 2061 7373 6572 7420 7265  k\n    assert re
+00019f40: 6365 6976 6564 5b2d 335d 2e69 6420 3d3d  ceived[-3].id ==
+00019f50: 2065 7665 6e74 312e 6964 5c6e 2020 2020   event1.id\n    
+00019f60: 6173 7365 7274 2072 6563 6569 7665 645b  assert received[
+00019f70: 2d32 5d2e 6964 203d 3d20 6576 656e 7432  -2].id == event2
+00019f80: 2e69 645c 6e20 2020 2061 7373 6572 7420  .id\n    assert 
+00019f90: 7265 6365 6976 6564 5b2d 315d 2e69 6420  received[-1].id 
+00019fa0: 3d3d 2065 7665 6e74 332e 6964 5c6e 5c6e  == event3.id\n\n
+00019fb0: 5c6e 2020 2020 2320 436c 6f73 6520 7468  \n    # Close th
+00019fc0: 6520 636c 6965 6e74 2e5c 6e20 2020 2061  e client.\n    a
+00019fd0: 7761 6974 2063 6c69 656e 742e 636c 6f73  wait client.clos
+00019fe0: 6528 295c 6e5c 6e5c 6e23 2052 756e 2074  e()\n\n\n# Run t
+00019ff0: 6865 2064 656d 6f2e 5c6e 6173 796e 6369  he demo.\nasynci
+0001a000: 6f2e 6765 745f 6576 656e 745f 6c6f 6f70  o.get_event_loop
+0001a010: 2829 2e72 756e 5f75 6e74 696c 5f63 6f6d  ().run_until_com
+0001a020: 706c 6574 6528 5c6e 2020 2020 6465 6d6f  plete(\n    demo
+0001a030: 6e73 7472 6174 655f 6173 796e 6369 6f5f  nstrate_asyncio_
+0001a040: 636c 6965 6e74 2829 5c6e 295c 6e60 6060  client()\n)\n```
+0001a050: 5c6e 5c6e 2323 2043 6f6e 7472 6962 7574  \n\n## Contribut
+0001a060: 6f72 735c 6e5c 6e23 2323 2049 6e73 7461  ors\n\n### Insta
+0001a070: 6c6c 2050 6f65 7472 795c 6e5c 6e54 6865  ll Poetry\n\nThe
+0001a080: 2066 6972 7374 2074 6869 6e67 2069 7320   first thing is 
+0001a090: 746f 2063 6865 636b 2079 6f75 2068 6176  to check you hav
+0001a0a0: 6520 506f 6574 7279 2069 6e73 7461 6c6c  e Poetry install
+0001a0b0: 6564 2e5c 6e5c 6e20 2020 2024 2070 6f65  ed.\n\n    $ poe
+0001a0c0: 7472 7920 2d2d 7665 7273 696f 6e5c 6e5c  try --version\n\
+0001a0d0: 6e49 6620 796f 7520 646f 6e5c 2774 2c20  nIf you don\'t, 
+0001a0e0: 7468 656e 2070 6c65 6173 6520 5b69 6e73  then please [ins
+0001a0f0: 7461 6c6c 2050 6f65 7472 795d 2868 7474  tall Poetry](htt
+0001a100: 7073 3a2f 2f70 7974 686f 6e2d 706f 6574  ps://python-poet
+0001a110: 7279 2e6f 7267 2f64 6f63 732f 2369 6e73  ry.org/docs/#ins
+0001a120: 7461 6c6c 696e 672d 7769 7468 2d74 6865  talling-with-the
+0001a130: 2d6f 6666 6963 6961 6c2d 696e 7374 616c  -official-instal
+0001a140: 6c65 7229 2e5c 6e5c 6e20 2020 2024 2063  ler).\n\n    $ c
+0001a150: 7572 6c20 2d73 534c 2068 7474 7073 3a2f  url -sSL https:/
+0001a160: 2f69 6e73 7461 6c6c 2e70 7974 686f 6e2d  /install.python-
+0001a170: 706f 6574 7279 2e6f 7267 207c 2070 7974  poetry.org | pyt
+0001a180: 686f 6e33 202d 5c6e 5c6e 4974 2077 696c  hon3 -\n\nIt wil
+0001a190: 6c20 6865 6c70 2074 6f20 6d61 6b65 2073  l help to make s
+0001a1a0: 7572 6520 506f 6574 7279 5c27 7320 6269  ure Poetry\'s bi
+0001a1b0: 6e20 6469 7265 6374 6f72 7920 6973 2069  n directory is i
+0001a1c0: 6e20 796f 7572 2060 5041 5448 6020 656e  n your `PATH` en
+0001a1d0: 7669 726f 6e6d 656e 7420 7661 7269 6162  vironment variab
+0001a1e0: 6c65 2e5c 6e5c 6e42 7574 2069 6e20 616e  le.\n\nBut in an
+0001a1f0: 7920 6361 7365 2c20 6d61 6b65 2073 7572  y case, make sur
+0001a200: 6520 796f 7520 6b6e 6f77 2074 6865 2070  e you know the p
+0001a210: 6174 6820 746f 2074 6865 2060 706f 6574  ath to the `poet
+0001a220: 7279 6020 6578 6563 7574 6162 6c65 2e20  ry` executable. 
+0001a230: 5468 6520 506f 6574 7279 5c6e 696e 7374  The Poetry\ninst
+0001a240: 616c 6c65 7220 7465 6c6c 7320 796f 7520  aller tells you 
+0001a250: 7768 6572 6520 6974 2068 6173 2062 6565  where it has bee
+0001a260: 6e20 696e 7374 616c 6c65 642c 2061 6e64  n installed, and
+0001a270: 2068 6f77 2074 6f20 636f 6e66 6967 7572   how to configur
+0001a280: 6520 796f 7572 2073 6865 6c6c 2e5c 6e5c  e your shell.\n\
+0001a290: 6e50 6c65 6173 6520 7265 6665 7220 746f  nPlease refer to
+0001a2a0: 2074 6865 205b 506f 6574 7279 2064 6f63   the [Poetry doc
+0001a2b0: 735d 2868 7474 7073 3a2f 2f70 7974 686f  s](https://pytho
+0001a2c0: 6e2d 706f 6574 7279 2e6f 7267 2f64 6f63  n-poetry.org/doc
+0001a2d0: 732f 2920 666f 7220 6775 6964 616e 6365  s/) for guidance
+0001a2e0: 206f 6e5c 6e75 7369 6e67 2050 6f65 7472   on\nusing Poetr
+0001a2f0: 792e 5c6e 5c6e 2323 2320 5365 7475 7020  y.\n\n### Setup 
+0001a300: 666f 7220 5079 4368 6172 6d20 7573 6572  for PyCharm user
+0001a310: 735c 6e5c 6e59 6f75 2063 616e 2065 6173  s\n\nYou can eas
+0001a320: 696c 7920 6f62 7461 696e 2074 6865 2070  ily obtain the p
+0001a330: 726f 6a65 6374 2066 696c 6573 2075 7369  roject files usi
+0001a340: 6e67 2050 7943 6861 726d 2028 6d65 6e75  ng PyCharm (menu
+0001a350: 2022 4769 7420 3e20 436c 6f6e 652e 2e2e   "Git > Clone...
+0001a360: 2229 2e5c 6e50 7943 6861 726d 2077 696c  ").\nPyCharm wil
+0001a370: 6c20 7468 656e 2075 7375 616c 6c79 2070  l then usually p
+0001a380: 726f 6d70 7420 796f 7520 746f 206f 7065  rompt you to ope
+0001a390: 6e20 7468 6520 7072 6f6a 6563 742e 5c6e  n the project.\n
+0001a3a0: 5c6e 4f70 656e 2074 6865 2070 726f 6a65  \nOpen the proje
+0001a3b0: 6374 2069 6e20 6120 6e65 7720 7769 6e64  ct in a new wind
+0001a3c0: 6f77 2e20 5079 4368 6172 6d20 7769 6c6c  ow. PyCharm will
+0001a3d0: 2074 6865 6e20 7573 7561 6c6c 7920 7072   then usually pr
+0001a3e0: 6f6d 7074 2079 6f75 2074 6f20 6372 6561  ompt you to crea
+0001a3f0: 7465 5c6e 6120 6e65 7720 7669 7274 7561  te\na new virtua
+0001a400: 6c20 656e 7669 726f 6e6d 656e 742e 5c6e  l environment.\n
+0001a410: 5c6e 4372 6561 7465 2061 206e 6577 2050  \nCreate a new P
+0001a420: 6f65 7472 7920 7669 7274 7561 6c20 656e  oetry virtual en
+0001a430: 7669 726f 6e6d 656e 7420 666f 7220 7468  vironment for th
+0001a440: 6520 7072 6f6a 6563 742e 2049 6620 5079  e project. If Py
+0001a450: 4368 6172 6d20 646f 6573 6e5c 2774 2061  Charm doesn\'t a
+0001a460: 6c72 6561 6479 5c6e 6b6e 6f77 2077 6865  lready\nknow whe
+0001a470: 7265 2079 6f75 7220 6070 6f65 7472 7960  re your `poetry`
+0001a480: 2065 7865 6375 7461 626c 6520 6973 2c20   executable is, 
+0001a490: 7468 656e 2073 6574 2074 6865 2070 6174  then set the pat
+0001a4a0: 6820 746f 2079 6f75 7220 6070 6f65 7472  h to your `poetr
+0001a4b0: 7960 2065 7865 6375 7461 626c 655c 6e69  y` executable\ni
+0001a4c0: 6e20 7468 6520 224e 6577 2050 6f65 7472  n the "New Poetr
+0001a4d0: 7920 456e 7669 726f 6e6d 656e 7422 2066  y Environment" f
+0001a4e0: 6f72 6d20 696e 7075 7420 6669 656c 6420  orm input field 
+0001a4f0: 6c61 6265 6c6c 6564 2022 506f 6574 7279  labelled "Poetry
+0001a500: 2065 7865 6375 7461 626c 6522 2e20 496e   executable". In
+0001a510: 2074 6865 5c6e 224e 6577 2050 6f65 7472   the\n"New Poetr
+0001a520: 7920 456e 7669 726f 6e6d 656e 7422 2066  y Environment" f
+0001a530: 6f72 6d2c 2079 6f75 2077 696c 6c20 616c  orm, you will al
+0001a540: 736f 2068 6176 6520 7468 6520 6f70 706f  so have the oppo
+0001a550: 7274 756e 6974 7920 746f 2073 656c 6563  rtunity to selec
+0001a560: 7420 7768 6963 685c 6e50 7974 686f 6e20  t which\nPython 
+0001a570: 6578 6563 7574 6162 6c65 2077 696c 6c20  executable will 
+0001a580: 6265 2075 7365 6420 6279 2074 6865 2076  be used by the v
+0001a590: 6972 7475 616c 2065 6e76 6972 6f6e 6d65  irtual environme
+0001a5a0: 6e74 2e5c 6e5c 6e50 7943 6861 726d 2077  nt.\n\nPyCharm w
+0001a5b0: 696c 6c20 7468 656e 2063 7265 6174 6520  ill then create 
+0001a5c0: 6120 6e65 7720 506f 6574 7279 2076 6972  a new Poetry vir
+0001a5d0: 7475 616c 2065 6e76 6972 6f6e 6d65 6e74  tual environment
+0001a5e0: 2066 6f72 2079 6f75 7220 7072 6f6a 6563   for your projec
+0001a5f0: 742c 2075 7369 6e67 5c6e 6120 7061 7274  t, using\na part
+0001a600: 6963 756c 6172 2076 6572 7369 6f6e 206f  icular version o
+0001a610: 6620 5079 7468 6f6e 2c20 616e 6420 616c  f Python, and al
+0001a620: 736f 2069 6e73 7461 6c6c 2069 6e74 6f20  so install into 
+0001a630: 7468 6973 2076 6972 7475 616c 2065 6e76  this virtual env
+0001a640: 6972 6f6e 6d65 6e74 2074 6865 5c6e 7072  ironment the\npr
+0001a650: 6f6a 6563 745c 2773 2070 6163 6b61 6765  oject\'s package
+0001a660: 2064 6570 656e 6465 6e63 6965 7320 6163   dependencies ac
+0001a670: 636f 7264 696e 6720 746f 2074 6865 2070  cording to the p
+0001a680: 726f 6a65 6374 5c27 7320 6070 6f65 7472  roject\'s `poetr
+0001a690: 792e 6c6f 636b 6020 6669 6c65 2e5c 6e5c  y.lock` file.\n\
+0001a6a0: 6e59 6f75 2063 616e 2061 6464 2064 6966  nYou can add dif
+0001a6b0: 6665 7265 6e74 2050 6f65 7472 7920 656e  ferent Poetry en
+0001a6c0: 7669 726f 6e6d 656e 7473 2066 6f72 2064  vironments for d
+0001a6d0: 6966 6665 7265 6e74 2050 7974 686f 6e20  ifferent Python 
+0001a6e0: 7665 7273 696f 6e73 2c20 616e 6420 7377  versions, and sw
+0001a6f0: 6974 6368 5c6e 6265 7477 6565 6e20 7468  itch\nbetween th
+0001a700: 656d 2075 7369 6e67 2074 6865 2022 5079  em using the "Py
+0001a710: 7468 6f6e 2049 6e74 6572 7072 6574 6572  thon Interpreter
+0001a720: 2220 7365 7474 696e 6773 206f 6620 5079  " settings of Py
+0001a730: 4368 6172 6d2e 2049 6620 796f 7520 7761  Charm. If you wa
+0001a740: 6e74 2074 6f20 7573 655c 6e61 2076 6572  nt to use\na ver
+0001a750: 7369 6f6e 206f 6620 5079 7468 6f6e 2074  sion of Python t
+0001a760: 6861 7420 6973 6e5c 2774 2069 6e73 7461  hat isn\'t insta
+0001a770: 6c6c 6564 2c20 6569 7468 6572 2075 7365  lled, either use
+0001a780: 2079 6f75 7220 6661 766f 7572 6974 6520   your favourite 
+0001a790: 7061 636b 6167 6520 6d61 6e61 6765 722c  package manager,
+0001a7a0: 5c6e 6f72 2069 6e73 7461 6c6c 2050 7974  \nor install Pyt
+0001a7b0: 686f 6e20 6279 2064 6f77 6e6c 6f61 6469  hon by downloadi
+0001a7c0: 6e67 2061 6e20 696e 7374 616c 6c65 7220  ng an installer 
+0001a7d0: 666f 7220 7265 6365 6e74 2076 6572 7369  for recent versi
+0001a7e0: 6f6e 7320 6f66 2050 7974 686f 6e20 6469  ons of Python di
+0001a7f0: 7265 6374 6c79 5c6e 6672 6f6d 2074 6865  rectly\nfrom the
+0001a800: 205b 5079 7468 6f6e 2077 6562 7369 7465   [Python website
+0001a810: 5d28 6874 7470 733a 2f2f 7777 772e 7079  ](https://www.py
+0001a820: 7468 6f6e 2e6f 7267 2f64 6f77 6e6c 6f61  thon.org/downloa
+0001a830: 6473 2f29 2e5c 6e5c 6e4f 6e63 6520 7072  ds/).\n\nOnce pr
+0001a840: 6f6a 6563 7420 6465 7065 6e64 656e 6369  oject dependenci
+0001a850: 6573 2068 6176 6520 6265 656e 2069 6e73  es have been ins
+0001a860: 7461 6c6c 6564 2c20 796f 7520 7368 6f75  talled, you shou
+0001a870: 6c64 2062 6520 6162 6c65 2074 6f20 7275  ld be able to ru
+0001a880: 6e20 7465 7374 735c 6e66 726f 6d20 7769  n tests\nfrom wi
+0001a890: 7468 696e 2050 7943 6861 726d 2028 7269  thin PyCharm (ri
+0001a8a0: 6768 742d 636c 6963 6b20 6f6e 2074 6865  ght-click on the
+0001a8b0: 2060 7465 7374 7360 2066 6f6c 6465 7220   `tests` folder 
+0001a8c0: 616e 6420 7365 6c65 6374 2074 6865 205c  and select the \
+0001a8d0: 2752 756e 5c27 206f 7074 696f 6e29 2e5c  'Run\' option).\
+0001a8e0: 6e5c 6e42 6563 6175 7365 206f 6620 6120  n\nBecause of a 
+0001a8f0: 636f 6e66 6c69 6374 2062 6574 7765 656e  conflict between
+0001a900: 2070 7974 6573 7420 616e 6420 5079 4368   pytest and PyCh
+0001a910: 6172 6d5c 2773 2064 6562 7567 6765 7220  arm\'s debugger 
+0001a920: 616e 6420 7468 6520 636f 7665 7261 6765  and the coverage
+0001a930: 2074 6f6f 6c2c 5c6e 796f 7520 6d61 7920   tool,\nyou may 
+0001a940: 6e65 6564 2074 6f20 6164 6420 6060 2d2d  need to add ``--
+0001a950: 6e6f 2d63 6f76 6060 2061 7320 616e 206f  no-cov`` as an o
+0001a960: 7074 696f 6e20 746f 2074 6865 2074 6573  ption to the tes
+0001a970: 7420 7275 6e6e 6572 2074 656d 706c 6174  t runner templat
+0001a980: 652e 2041 6c74 6572 6e61 7469 7665 6c79  e. Alternatively
+0001a990: 2c5c 6e6a 7573 7420 7573 6520 7468 6520  ,\njust use the 
+0001a9a0: 5079 7468 6f6e 2053 7461 6e64 6172 6420  Python Standard 
+0001a9b0: 4c69 6272 6172 795c 2773 2060 6075 6e69  Library\'s ``uni
+0001a9c0: 7474 6573 7460 6020 6d6f 6475 6c65 2e5c  ttest`` module.\
+0001a9d0: 6e5c 6e59 6f75 2073 686f 756c 6420 616c  n\nYou should al
+0001a9e0: 736f 2062 6520 6162 6c65 2074 6f20 6f70  so be able to op
+0001a9f0: 656e 2061 2074 6572 6d69 6e61 6c20 7769  en a terminal wi
+0001aa00: 6e64 6f77 2069 6e20 5079 4368 6172 6d2c  ndow in PyCharm,
+0001aa10: 2061 6e64 2072 756e 2074 6865 2070 726f   and run the pro
+0001aa20: 6a65 6374 5c27 735c 6e4d 616b 6566 696c  ject\'s\nMakefil
+0001aa30: 6520 636f 6d6d 616e 6473 2066 726f 6d20  e commands from 
+0001aa40: 7468 6520 636f 6d6d 616e 6420 6c69 6e65  the command line
+0001aa50: 2028 7365 6520 6265 6c6f 7729 2e5c 6e5c   (see below).\n\
+0001aa60: 6e23 2323 2053 6574 7570 2066 726f 6d20  n### Setup from 
+0001aa70: 636f 6d6d 616e 6420 6c69 6e65 5c6e 5c6e  command line\n\n
+0001aa80: 4f62 7461 696e 2074 6865 2070 726f 6a65  Obtain the proje
+0001aa90: 6374 2066 696c 6573 2c20 7573 696e 6720  ct files, using 
+0001aaa0: 4769 7420 6f72 2073 7569 7461 626c 6520  Git or suitable 
+0001aab0: 616c 7465 726e 6174 6976 652e 5c6e 5c6e  alternative.\n\n
+0001aac0: 496e 2061 2074 6572 6d69 6e61 6c20 6170  In a terminal ap
+0001aad0: 706c 6963 6174 696f 6e2c 2063 6861 6e67  plication, chang
+0001aae0: 6520 796f 7572 2063 7572 7265 6e74 2077  e your current w
+0001aaf0: 6f72 6b69 6e67 2064 6972 6563 746f 7279  orking directory
+0001ab00: 5c6e 746f 2074 6865 2072 6f6f 7420 666f  \nto the root fo
+0001ab10: 6c64 6572 206f 6620 7468 6520 7072 6f6a  lder of the proj
+0001ab20: 6563 7420 6669 6c65 732e 2054 6865 7265  ect files. There
+0001ab30: 2073 686f 756c 6420 6265 2061 204d 616b   should be a Mak
+0001ab40: 6566 696c 655c 6e69 6e20 7468 6973 2066  efile\nin this f
+0001ab50: 6f6c 6465 722e 5c6e 5c6e 5573 6520 7468  older.\n\nUse th
+0001ab60: 6520 4d61 6b65 6669 6c65 2074 6f20 6372  e Makefile to cr
+0001ab70: 6561 7465 2061 206e 6577 2050 6f65 7472  eate a new Poetr
+0001ab80: 7920 7669 7274 7561 6c20 656e 7669 726f  y virtual enviro
+0001ab90: 6e6d 656e 7420 666f 7220 7468 655c 6e70  nment for the\np
+0001aba0: 726f 6a65 6374 2061 6e64 2069 6e73 7461  roject and insta
+0001abb0: 6c6c 2074 6865 2070 726f 6a65 6374 5c27  ll the project\'
+0001abc0: 7320 7061 636b 6167 6520 6465 7065 6e64  s package depend
+0001abd0: 656e 6369 6573 2069 6e74 6f20 6974 2c5c  encies into it,\
+0001abe0: 6e75 7369 6e67 2074 6865 2066 6f6c 6c6f  nusing the follo
+0001abf0: 7769 6e67 2063 6f6d 6d61 6e64 2e5c 6e5c  wing command.\n\
+0001ac00: 6e20 2020 2024 206d 616b 6520 696e 7374  n    $ make inst
+0001ac10: 616c 6c2d 7061 636b 6167 6573 5c6e 5c6e  all-packages\n\n
+0001ac20: 4974 5c27 7320 616c 736f 2070 6f73 7369  It\'s also possi
+0001ac30: 626c 6520 746f 2061 6c73 6f20 696e 7374  ble to also inst
+0001ac40: 616c 6c20 7468 6520 7072 6f6a 6563 7420  all the project 
+0001ac50: 696e 205c 2765 6469 7461 626c 6520 6d6f  in \'editable mo
+0001ac60: 6465 5c27 2e5c 6e5c 6e20 2020 2024 206d  de\'.\n\n    $ m
+0001ac70: 616b 6520 696e 7374 616c 6c5c 6e5c 6e50  ake install\n\nP
+0001ac80: 6c65 6173 6520 6e6f 7465 2c20 6966 2079  lease note, if y
+0001ac90: 6f75 2063 7265 6174 6520 7468 6520 7669  ou create the vi
+0001aca0: 7274 7561 6c20 656e 7669 726f 6e6d 656e  rtual environmen
+0001acb0: 7420 696e 2074 6869 7320 7761 792c 2061  t in this way, a
+0001acc0: 6e64 2074 6865 6e20 7472 7920 746f 5c6e  nd then try to\n
+0001acd0: 6f70 656e 2074 6865 2070 726f 6a65 6374  open the project
+0001ace0: 2069 6e20 5079 4368 6172 6d20 616e 6420   in PyCharm and 
+0001acf0: 636f 6e66 6967 7572 6520 7468 6520 7072  configure the pr
+0001ad00: 6f6a 6563 7420 746f 2075 7365 2074 6869  oject to use thi
+0001ad10: 7320 7669 7274 7561 6c5c 6e65 6e76 6972  s virtual\nenvir
+0001ad20: 6f6e 6d65 6e74 2061 7320 616e 2022 4578  onment as an "Ex
+0001ad30: 6973 7469 6e67 2050 6f65 7472 7920 456e  isting Poetry En
+0001ad40: 7669 726f 6e6d 656e 7422 2c20 5079 4368  vironment", PyCh
+0001ad50: 6172 6d20 736f 6d65 7469 6d65 7320 6861  arm sometimes ha
+0001ad60: 7320 736f 6d65 5c6e 6973 7375 6573 2028  s some\nissues (
+0001ad70: 646f 6e5c 2774 206b 6e6f 7720 7768 7929  don\'t know why)
+0001ad80: 2077 6869 6368 206d 6967 6874 2062 6520   which might be 
+0001ad90: 7072 6f62 6c65 6d61 7469 632e 2049 6620  problematic. If 
+0001ada0: 796f 7520 656e 636f 756e 7465 7220 7375  you encounter su
+0001adb0: 6368 5c6e 6973 7375 6573 2c20 796f 7520  ch\nissues, you 
+0001adc0: 6361 6e20 7265 736f 6c76 6520 7468 6573  can resolve thes
+0001add0: 6520 6973 7375 6573 2062 7920 6465 6c65  e issues by dele
+0001ade0: 7469 6e67 2074 6865 2076 6972 7475 616c  ting the virtual
+0001adf0: 2065 6e76 6972 6f6e 6d65 6e74 5c6e 616e   environment\nan
+0001ae00: 6420 6372 6561 7469 6e67 2074 6865 2050  d creating the P
+0001ae10: 6f65 7472 7920 7669 7274 7561 6c20 656e  oetry virtual en
+0001ae20: 7669 726f 6e6d 656e 7420 7573 696e 6720  vironment using 
+0001ae30: 5079 4368 6172 6d20 2873 6565 2061 626f  PyCharm (see abo
+0001ae40: 7665 292e 5c6e 5c6e 2323 2320 5072 6f6a  ve).\n\n### Proj
+0001ae50: 6563 7420 4d61 6b65 6669 6c65 2063 6f6d  ect Makefile com
+0001ae60: 6d61 6e64 735c 6e5c 6e59 6f75 2063 616e  mands\n\nYou can
+0001ae70: 2073 7461 7274 2045 7665 6e74 5374 6f72   start EventStor
+0001ae80: 6544 4220 7573 696e 6720 7468 6520 666f  eDB using the fo
+0001ae90: 6c6c 6f77 696e 6720 636f 6d6d 616e 642e  llowing command.
+0001aea0: 5c6e 5c6e 2020 2020 2420 6d61 6b65 2073  \n\n    $ make s
+0001aeb0: 7461 7274 2d65 7665 6e74 7374 6f72 6564  tart-eventstored
+0001aec0: 625c 6e5c 6e59 6f75 2063 616e 2072 756e  b\n\nYou can run
+0001aed0: 2074 6573 7473 2075 7369 6e67 2074 6865   tests using the
+0001aee0: 2066 6f6c 6c6f 7769 6e67 2063 6f6d 6d61   following comma
+0001aef0: 6e64 2028 6e65 6564 7320 4576 656e 7453  nd (needs EventS
+0001af00: 746f 7265 4442 2074 6f20 6265 2072 756e  toreDB to be run
+0001af10: 6e69 6e67 292e 5c6e 5c6e 2020 2020 2420  ning).\n\n    $ 
+0001af20: 6d61 6b65 2074 6573 745c 6e5c 6e59 6f75  make test\n\nYou
+0001af30: 2063 616e 2073 746f 7020 4576 656e 7453   can stop EventS
+0001af40: 746f 7265 4442 2075 7369 6e67 2074 6865  toreDB using the
+0001af50: 2066 6f6c 6c6f 7769 6e67 2063 6f6d 6d61   following comma
+0001af60: 6e64 2e5c 6e5c 6e20 2020 2024 206d 616b  nd.\n\n    $ mak
+0001af70: 6520 7374 6f70 2d65 7665 6e74 7374 6f72  e stop-eventstor
+0001af80: 6564 625c 6e5c 6e59 6f75 2063 616e 2063  edb\n\nYou can c
+0001af90: 6865 636b 2074 6865 2066 6f72 6d61 7474  heck the formatt
+0001afa0: 696e 6720 6f66 2074 6865 2063 6f64 6520  ing of the code 
+0001afb0: 7573 696e 6720 7468 6520 666f 6c6c 6f77  using the follow
+0001afc0: 696e 6720 636f 6d6d 616e 642e 5c6e 5c6e  ing command.\n\n
+0001afd0: 2020 2020 2420 6d61 6b65 206c 696e 745c      $ make lint\
+0001afe0: 6e5c 6e59 6f75 2063 616e 2072 6566 6f72  n\nYou can refor
+0001aff0: 6d61 7420 7468 6520 636f 6465 2075 7369  mat the code usi
+0001b000: 6e67 2074 6865 2066 6f6c 6c6f 7769 6e67  ng the following
+0001b010: 2063 6f6d 6d61 6e64 2e5c 6e5c 6e20 2020   command.\n\n   
+0001b020: 2024 206d 616b 6520 666d 745c 6e5c 6e54   $ make fmt\n\nT
+0001b030: 6573 7473 2062 656c 6f6e 6720 696e 2060  ests belong in `
+0001b040: 2e2f 7465 7374 7360 2e20 436f 6465 2d75  ./tests`. Code-u
+0001b050: 6e64 6572 2d74 6573 7420 6265 6c6f 6e67  nder-test belong
+0001b060: 7320 696e 2060 2e2f 6573 6462 636c 6965  s in `./esdbclie
+0001b070: 6e74 602e 5c6e 5c6e 4564 6974 2070 6163  nt`.\n\nEdit pac
+0001b080: 6b61 6765 2064 6570 656e 6465 6e63 6965  kage dependencie
+0001b090: 7320 696e 2060 7079 7072 6f6a 6563 742e  s in `pyproject.
+0001b0a0: 746f 6d6c 602e 2055 7064 6174 6520 696e  toml`. Update in
+0001b0b0: 7374 616c 6c65 6420 7061 636b 6167 6573  stalled packages
+0001b0c0: 2028 616e 6420 7468 655c 6e60 706f 6574   (and the\n`poet
+0001b0d0: 7279 2e6c 6f63 6b60 2066 696c 6529 2075  ry.lock` file) u
+0001b0e0: 7369 6e67 2074 6865 2066 6f6c 6c6f 7769  sing the followi
+0001b0f0: 6e67 2063 6f6d 6d61 6e64 2e5c 6e5c 6e20  ng command.\n\n 
+0001b100: 2020 2024 206d 616b 6520 7570 6461 7465     $ make update
+0001b110: 2d70 6163 6b61 6765 735c 6e27 2c0a 2020  -packages\n',.  
+0001b120: 2020 2761 7574 686f 7227 3a20 274a 6f68    'author': 'Joh
+0001b130: 6e20 4279 7761 7465 7227 2c0a 2020 2020  n Bywater',.    
+0001b140: 2761 7574 686f 725f 656d 6169 6c27 3a20  'author_email': 
+0001b150: 276a 6f68 6e2e 6279 7761 7465 7240 6170  'john.bywater@ap
+0001b160: 7072 6f70 7269 6174 6573 6f66 7477 6172  propriatesoftwar
+0001b170: 652e 6e65 7427 2c0a 2020 2020 276d 6169  e.net',.    'mai
+0001b180: 6e74 6169 6e65 7227 3a20 274e 6f6e 6527  ntainer': 'None'
+0001b190: 2c0a 2020 2020 276d 6169 6e74 6169 6e65  ,.    'maintaine
+0001b1a0: 725f 656d 6169 6c27 3a20 274e 6f6e 6527  r_email': 'None'
+0001b1b0: 2c0a 2020 2020 2775 726c 273a 2027 6874  ,.    'url': 'ht
+0001b1c0: 7470 733a 2f2f 6769 7468 7562 2e63 6f6d  tps://github.com
+0001b1d0: 2f70 7965 7665 6e74 736f 7572 6369 6e67  /pyeventsourcing
+0001b1e0: 2f65 7364 6263 6c69 656e 7427 2c0a 2020  /esdbclient',.  
+0001b1f0: 2020 2770 6163 6b61 6765 7327 3a20 7061    'packages': pa
+0001b200: 636b 6167 6573 2c0a 2020 2020 2770 6163  ckages,.    'pac
+0001b210: 6b61 6765 5f64 6174 6127 3a20 7061 636b  kage_data': pack
+0001b220: 6167 655f 6461 7461 2c0a 2020 2020 2769  age_data,.    'i
+0001b230: 6e73 7461 6c6c 5f72 6571 7569 7265 7327  nstall_requires'
+0001b240: 3a20 696e 7374 616c 6c5f 7265 7175 6972  : install_requir
+0001b250: 6573 2c0a 2020 2020 2770 7974 686f 6e5f  es,.    'python_
+0001b260: 7265 7175 6972 6573 273a 2027 3e3d 332e  requires': '>=3.
+0001b270: 372c 3c34 2e30 272c 0a7d 0a0a 0a73 6574  7,<4.0',.}...set
+0001b280: 7570 282a 2a73 6574 7570 5f6b 7761 7267  up(**setup_kwarg
+0001b290: 7329 0a                                  s).
```

### Comparing `esdbclient-1.0a4/PKG-INFO` & `esdbclient-1.0a5/PKG-INFO`

 * *Files 10% similar despite different names*

```diff
@@ -1,11 +1,11 @@
 00000000: 4d65 7461 6461 7461 2d56 6572 7369 6f6e  Metadata-Version
 00000010: 3a20 322e 310a 4e61 6d65 3a20 6573 6462  : 2.1.Name: esdb
 00000020: 636c 6965 6e74 0a56 6572 7369 6f6e 3a20  client.Version: 
-00000030: 312e 3061 340a 5375 6d6d 6172 793a 2050  1.0a4.Summary: P
+00000030: 312e 3061 350a 5375 6d6d 6172 793a 2050  1.0a5.Summary: P
 00000040: 7974 686f 6e20 6752 5043 2043 6c69 656e  ython gRPC Clien
 00000050: 7420 666f 7220 4576 656e 7453 746f 7265  t for EventStore
 00000060: 4442 0a48 6f6d 652d 7061 6765 3a20 6874  DB.Home-page: ht
 00000070: 7470 733a 2f2f 6769 7468 7562 2e63 6f6d  tps://github.com
 00000080: 2f70 7965 7665 6e74 736f 7572 6369 6e67  /pyeventsourcing
 00000090: 2f65 7364 6263 6c69 656e 740a 4c69 6365  /esdbclient.Lice
 000000a0: 6e73 653a 2042 5344 2033 2d43 6c61 7573  nse: BSD 3-Claus
@@ -152,5840 +152,6641 @@
 00000970: 726f 6261 626c 7920 7468 6520 7468 7265  robably the thre
 00000980: 6520 6d6f 7374 2075 7365 6675 6c20 6d65  e most useful me
 00000990: 7468 6f64 7320 6f66 2060 4553 4442 436c  thods of `ESDBCl
 000009a0: 6965 6e74 6020 6172 653a 0a0a 2a20 6061  ient` are:..* `a
 000009b0: 7070 656e 645f 6576 656e 7473 2829 6020  ppend_events()` 
 000009c0: 5468 6973 206d 6574 686f 6420 6361 6e20  This method can 
 000009d0: 6265 2075 7365 6420 746f 2072 6563 6f72  be used to recor
-000009e0: 640a 6576 656e 7473 2069 6e20 6120 7061  d.events in a pa
-000009f0: 7274 6963 756c 6172 2022 7374 7265 616d  rticular "stream
+000009e0: 6420 6576 656e 7473 2069 6e20 6120 7061  d events in a pa
+000009f0: 7274 6963 756c 6172 0a22 7374 7265 616d  rticular."stream
 00000a00: 222e 2054 6869 7320 6973 2075 7365 6675  ". This is usefu
-00000a10: 6c20 7768 656e 2065 7865 6375 7469 6e67  l when executing
-00000a20: 2061 2063 6f6d 6d61 6e64 0a69 6e20 616e   a command.in an
-00000a30: 2061 7070 6c69 6361 7469 6f6e 2e20 4569   application. Ei
-00000a40: 7468 6572 2061 6c6c 206f 7220 6e6f 6e65  ther all or none
-00000a50: 206f 6620 7468 6520 6576 656e 7473 2077   of the events w
-00000a60: 696c 6c20 6265 2072 6563 6f72 6465 642e  ill be recorded.
-00000a70: 0a0a 2a20 6072 6561 645f 7374 7265 616d  ..* `read_stream
-00000a80: 5f65 7665 6e74 7328 2960 2054 6869 7320  _events()` This 
-00000a90: 6d65 7468 6f64 2063 616e 2062 6520 7573  method can be us
-00000aa0: 6564 2074 6f20 7265 7472 6965 7665 2061  ed to retrieve a
-00000ab0: 6c6c 2074 6865 2072 6563 6f72 6465 640a  ll the recorded.
-00000ac0: 6576 656e 7473 2069 6e20 6120 2273 7472  events in a "str
-00000ad0: 6561 6d22 2e20 5468 6973 2069 7320 7573  eam". This is us
-00000ae0: 6566 756c 2066 6f72 2072 6563 6f6e 7374  eful for reconst
-00000af0: 7275 6374 696e 6720 616e 2061 6767 7265  ructing an aggre
-00000b00: 6761 7465 2062 6566 6f72 650a 6578 6563  gate before.exec
-00000b10: 7574 696e 6720 6120 636f 6d6d 616e 6420  uting a command 
-00000b20: 696e 2061 6e20 6170 706c 6963 6174 696f  in an applicatio
-00000b30: 6e2e 0a0a 2a20 6073 7562 7363 7269 6265  n...* `subscribe
-00000b40: 5f61 6c6c 5f65 7665 6e74 7328 2960 2054  _all_events()` T
-00000b50: 6869 7320 6d65 7468 6f64 2063 616e 2062  his method can b
-00000b60: 6520 7573 6564 2074 6f20 7265 6365 6976  e used to receiv
-00000b70: 6520 616c 6c20 7265 636f 7264 6564 0a65  e all recorded.e
-00000b80: 7665 6e74 7320 6163 726f 7373 2061 6c6c  vents across all
-00000b90: 2022 7374 7265 616d 7322 2e20 5468 6973   "streams". This
-00000ba0: 2069 7320 7573 6566 756c 2069 6e20 6576   is useful in ev
-00000bb0: 656e 742d 7072 6f63 6573 7369 6e67 2063  ent-processing c
-00000bc0: 6f6d 706f 6e65 6e74 732c 0a61 6e64 2073  omponents,.and s
-00000bd0: 7570 706f 7274 7320 7072 6f63 6573 7369  upports processi
-00000be0: 6e67 2065 7665 6e74 7320 7769 7468 2022  ng events with "
-00000bf0: 6578 6163 746c 792d 6f6e 6365 2220 7365  exactly-once" se
-00000c00: 6d61 6e74 6963 732e 0a0a 5468 6520 6578  mantics...The ex
-00000c10: 616d 706c 6520 6265 6c6f 7720 7573 6573  ample below uses
-00000c20: 2061 6e20 2269 6e73 6563 7572 6522 2045   an "insecure" E
-00000c30: 7665 6e74 5374 6f72 6544 4220 7365 7276  ventStoreDB serv
-00000c40: 6572 2072 756e 6e69 6e67 206c 6f63 616c  er running local
-00000c50: 6c79 206f 6e20 706f 7274 2032 3131 342e  ly on port 2114.
-00000c60: 0a0a 6060 6070 7974 686f 6e0a 696d 706f  ..```python.impo
-00000c70: 7274 2065 7364 6263 6c69 656e 742c 2075  rt esdbclient, u
-00000c80: 7569 640a 0a0a 2320 436f 6e73 7472 7563  uid...# Construc
-00000c90: 7420 4553 4442 436c 6965 6e74 2077 6974  t ESDBClient wit
-00000ca0: 6820 616e 2045 7665 6e74 5374 6f72 6544  h an EventStoreD
-00000cb0: 4220 5552 492e 0a0a 636c 6965 6e74 203d  B URI...client =
-00000cc0: 2065 7364 6263 6c69 656e 742e 4553 4442   esdbclient.ESDB
-00000cd0: 436c 6965 6e74 2875 7269 3d22 6573 6462  Client(uri="esdb
-00000ce0: 3a2f 2f6c 6f63 616c 686f 7374 3a32 3131  ://localhost:211
-00000cf0: 343f 546c 733d 6661 6c73 6522 290a 0a0a  4?Tls=false")...
-00000d00: 2320 4170 7065 6e64 2065 7665 6e74 7320  # Append events 
-00000d10: 746f 2061 206e 6577 2073 7472 6561 6d2e  to a new stream.
-00000d20: 0a0a 7374 7265 616d 5f6e 616d 6520 3d20  ..stream_name = 
-00000d30: 7374 7228 7575 6964 2e75 7569 6434 2829  str(uuid.uuid4()
-00000d40: 290a 0a65 7665 6e74 3120 3d20 6573 6462  )..event1 = esdb
-00000d50: 636c 6965 6e74 2e4e 6577 4576 656e 7428  client.NewEvent(
-00000d60: 7479 7065 3d27 4f72 6465 7243 7265 6174  type='OrderCreat
-00000d70: 6564 272c 2064 6174 613d 6227 6461 7461  ed', data=b'data
-00000d80: 3127 290a 0a63 6c69 656e 742e 6170 7065  1')..client.appe
-00000d90: 6e64 5f65 7665 6e74 7328 0a20 2020 2073  nd_events(.    s
-00000da0: 7472 6561 6d5f 6e61 6d65 3d73 7472 6561  tream_name=strea
-00000db0: 6d5f 6e61 6d65 2c0a 2020 2020 6578 7065  m_name,.    expe
-00000dc0: 6374 6564 5f70 6f73 6974 696f 6e3d 4e6f  cted_position=No
-00000dd0: 6e65 2c0a 2020 2020 6576 656e 7473 3d5b  ne,.    events=[
-00000de0: 6576 656e 7431 5d2c 0a29 0a0a 0a23 2041  event1],.)...# A
-00000df0: 7070 656e 6420 6d6f 7265 2065 7665 6e74  ppend more event
-00000e00: 7320 746f 2061 6e20 6578 6973 7469 6e67  s to an existing
-00000e10: 2073 7472 6561 6d2e 0a0a 6576 656e 7432   stream...event2
-00000e20: 203d 2065 7364 6263 6c69 656e 742e 4e65   = esdbclient.Ne
-00000e30: 7745 7665 6e74 2874 7970 653d 274f 7264  wEvent(type='Ord
-00000e40: 6572 5570 6461 7465 6427 2c20 6461 7461  erUpdated', data
-00000e50: 3d62 2764 6174 6132 2729 0a65 7665 6e74  =b'data2').event
-00000e60: 3320 3d20 6573 6462 636c 6965 6e74 2e4e  3 = esdbclient.N
-00000e70: 6577 4576 656e 7428 7479 7065 3d27 4f72  ewEvent(type='Or
-00000e80: 6465 7244 656c 6574 6564 272c 2064 6174  derDeleted', dat
-00000e90: 613d 6227 6461 7461 3327 290a 0a63 6c69  a=b'data3')..cli
-00000ea0: 656e 742e 6170 7065 6e64 5f65 7665 6e74  ent.append_event
-00000eb0: 7328 0a20 2020 2073 7472 6561 6d5f 6e61  s(.    stream_na
-00000ec0: 6d65 3d73 7472 6561 6d5f 6e61 6d65 2c0a  me=stream_name,.
-00000ed0: 2020 2020 6578 7065 6374 6564 5f70 6f73      expected_pos
-00000ee0: 6974 696f 6e3d 302c 0a20 2020 2065 7665  ition=0,.    eve
-00000ef0: 6e74 733d 5b65 7665 6e74 322c 2065 7665  nts=[event2, eve
-00000f00: 6e74 335d 2c0a 290a 0a0a 2320 5265 6164  nt3],.)...# Read
-00000f10: 2061 6c6c 2065 7665 6e74 7320 7265 636f   all events reco
-00000f20: 7264 6564 2069 6e20 6120 7374 7265 616d  rded in a stream
-00000f30: 2e0a 0a72 6563 6f72 6465 6420 3d20 636c  ...recorded = cl
-00000f40: 6965 6e74 2e72 6561 645f 7374 7265 616d  ient.read_stream
-00000f50: 5f65 7665 6e74 7328 0a20 2020 2073 7472  _events(.    str
-00000f60: 6561 6d5f 6e61 6d65 3d73 7472 6561 6d5f  eam_name=stream_
-00000f70: 6e61 6d65 0a29 0a0a 6173 7365 7274 206c  name.)..assert l
-00000f80: 656e 2872 6563 6f72 6465 6429 203d 3d20  en(recorded) == 
-00000f90: 330a 6173 7365 7274 2072 6563 6f72 6465  3.assert recorde
-00000fa0: 645b 305d 2e64 6174 6120 3d3d 2065 7665  d[0].data == eve
-00000fb0: 6e74 312e 6461 7461 0a61 7373 6572 7420  nt1.data.assert 
-00000fc0: 7265 636f 7264 6564 5b31 5d2e 6461 7461  recorded[1].data
-00000fd0: 203d 3d20 6576 656e 7432 2e64 6174 610a   == event2.data.
-00000fe0: 6173 7365 7274 2072 6563 6f72 6465 645b  assert recorded[
-00000ff0: 325d 2e64 6174 6120 3d3d 2065 7665 6e74  2].data == event
-00001000: 332e 6461 7461 0a61 7373 6572 7420 7265  3.data.assert re
-00001010: 636f 7264 6564 5b30 5d2e 7479 7065 203d  corded[0].type =
-00001020: 3d20 6576 656e 7431 2e74 7970 650a 6173  = event1.type.as
-00001030: 7365 7274 2072 6563 6f72 6465 645b 315d  sert recorded[1]
-00001040: 2e74 7970 6520 3d3d 2065 7665 6e74 322e  .type == event2.
-00001050: 7479 7065 0a61 7373 6572 7420 7265 636f  type.assert reco
-00001060: 7264 6564 5b32 5d2e 7479 7065 203d 3d20  rded[2].type == 
-00001070: 6576 656e 7433 2e74 7970 650a 0a0a 2320  event3.type...# 
-00001080: 496e 2061 6e20 6576 656e 742d 7072 6f63  In an event-proc
-00001090: 6573 7369 6e67 2063 6f6d 706f 6e65 6e74  essing component
-000010a0: 2c20 7573 6520 6120 2263 6174 6368 2d75  , use a "catch-u
-000010b0: 7022 2073 7562 7363 7269 7074 696f 6e0a  p" subscription.
-000010c0: 2320 746f 2072 6563 6569 7665 2061 6c6c  # to receive all
-000010d0: 2065 7665 6e74 7320 6163 726f 7373 2061   events across a
-000010e0: 6c6c 2073 7472 6561 6d73 2c20 696e 636c  ll streams, incl
-000010f0: 7564 696e 6720 6576 656e 7473 2074 6861  uding events tha
-00001100: 740a 2320 6861 7665 206e 6f74 2079 6574  t.# have not yet
-00001110: 2062 6565 6e20 7265 636f 7264 6564 2c20   been recorded, 
-00001120: 7374 6172 7469 6e67 2066 726f 6d20 7468  starting from th
-00001130: 6520 636f 6d70 6f6e 656e 7427 7320 6c61  e component's la
-00001140: 7374 0a23 2073 6176 6564 2022 636f 6d6d  st.# saved "comm
-00001150: 6974 2070 6f73 6974 696f 6e22 2e0a 0a6c  it position"...l
-00001160: 6173 745f 7361 7665 645f 636f 6d6d 6974  ast_saved_commit
-00001170: 5f70 6f73 6974 696f 6e20 3d20 300a 0a73  _position = 0..s
-00001180: 7562 7363 7269 7074 696f 6e20 3d20 636c  ubscription = cl
-00001190: 6965 6e74 2e73 7562 7363 7269 6265 5f61  ient.subscribe_a
-000011a0: 6c6c 5f65 7665 6e74 7328 0a20 2020 2063  ll_events(.    c
-000011b0: 6f6d 6d69 745f 706f 7369 7469 6f6e 3d6c  ommit_position=l
-000011c0: 6173 745f 7361 7665 645f 636f 6d6d 6974  ast_saved_commit
-000011d0: 5f70 6f73 6974 696f 6e0a 290a 0a23 2054  _position.)..# T
-000011e0: 6f20 696d 706c 656d 656e 7420 2265 7861  o implement "exa
-000011f0: 6374 6c79 2d6f 6e63 6522 2073 656d 616e  ctly-once" seman
-00001200: 7469 6373 2c20 6974 6572 6174 6520 6f76  tics, iterate ov
-00001210: 6572 2074 6865 0a23 2022 6361 7463 682d  er the.# "catch-
-00001220: 7570 2220 7375 6273 6372 6970 7469 6f6e  up" subscription
-00001230: 2e20 5072 6f63 6573 7320 6561 6368 2072  . Process each r
-00001240: 6563 6569 7665 6420 6576 656e 742c 0a23  eceived event,.#
-00001250: 2069 6e20 7475 726e 2c20 7468 726f 7567   in turn, throug
-00001260: 6820 616e 2065 7665 6e74 2d70 726f 6365  h an event-proce
-00001270: 7373 696e 6720 706f 6c69 6379 2e20 5361  ssing policy. Sa
-00001280: 7665 2074 6865 0a23 2076 616c 7565 206f  ve the.# value o
-00001290: 6620 7468 6520 636f 6d6d 6974 5f70 6f73  f the commit_pos
-000012a0: 6974 696f 6e20 6174 7472 6962 7574 6520  ition attribute 
-000012b0: 6f66 2074 6865 2070 726f 6365 7373 6564  of the processed
-000012c0: 0a23 2065 7665 6e74 2077 6974 6820 6e65  .# event with ne
-000012d0: 7720 7374 6174 6520 6765 6e65 7261 7465  w state generate
-000012e0: 6420 6279 2074 6865 2070 6f6c 6963 7920  d by the policy 
-000012f0: 696e 2074 6865 2073 616d 650a 2320 6174  in the same.# at
-00001300: 6f6d 6963 2074 7261 6e73 6163 7469 6f6e  omic transaction
-00001310: 2e20 5573 6520 7468 6520 6c61 7374 2073  . Use the last s
-00001320: 6176 6564 2022 636f 6d6d 6974 2070 6f73  aved "commit pos
-00001330: 6974 696f 6e22 0a23 2077 6865 6e20 7265  ition".# when re
-00001340: 7374 6172 7469 6e67 2074 6865 2022 6361  starting the "ca
-00001350: 7463 682d 7570 2220 7375 6273 6372 6970  tch-up" subscrip
-00001360: 7469 6f6e 2e0a 0a72 6563 6569 7665 6420  tion...received 
-00001370: 3d20 5b5d 0a66 6f72 2065 7665 6e74 2069  = [].for event i
-00001380: 6e20 7375 6273 6372 6970 7469 6f6e 3a0a  n subscription:.
-00001390: 2020 2020 7265 6365 6976 6564 2e61 7070      received.app
-000013a0: 656e 6428 6576 656e 7429 0a20 2020 2069  end(event).    i
-000013b0: 6620 6576 656e 742e 6964 203d 3d20 6576  f event.id == ev
-000013c0: 656e 7433 2e69 643a 0a20 2020 2020 2020  ent3.id:.       
-000013d0: 2062 7265 616b 0a0a 6173 7365 7274 2072   break..assert r
-000013e0: 6563 6569 7665 645b 2d33 5d2e 6461 7461  eceived[-3].data
-000013f0: 203d 3d20 6576 656e 7431 2e64 6174 610a   == event1.data.
-00001400: 6173 7365 7274 2072 6563 6569 7665 645b  assert received[
-00001410: 2d32 5d2e 6461 7461 203d 3d20 6576 656e  -2].data == even
-00001420: 7432 2e64 6174 610a 6173 7365 7274 2072  t2.data.assert r
-00001430: 6563 6569 7665 645b 2d31 5d2e 6461 7461  eceived[-1].data
-00001440: 203d 3d20 6576 656e 7433 2e64 6174 610a   == event3.data.
-00001450: 6173 7365 7274 2072 6563 6569 7665 645b  assert received[
-00001460: 2d33 5d2e 7479 7065 203d 3d20 6576 656e  -3].type == even
-00001470: 7431 2e74 7970 650a 6173 7365 7274 2072  t1.type.assert r
-00001480: 6563 6569 7665 645b 2d32 5d2e 7479 7065  eceived[-2].type
-00001490: 203d 3d20 6576 656e 7432 2e74 7970 650a   == event2.type.
-000014a0: 6173 7365 7274 2072 6563 6569 7665 645b  assert received[
-000014b0: 2d31 5d2e 7479 7065 203d 3d20 6576 656e  -1].type == even
-000014c0: 7433 2e74 7970 650a 0a61 7373 6572 7420  t3.type..assert 
-000014d0: 7265 6365 6976 6564 5b2d 335d 2e63 6f6d  received[-3].com
-000014e0: 6d69 745f 706f 7369 7469 6f6e 203e 2030  mit_position > 0
-000014f0: 0a61 7373 6572 7420 7265 6365 6976 6564  .assert received
-00001500: 5b2d 325d 2e63 6f6d 6d69 745f 706f 7369  [-2].commit_posi
-00001510: 7469 6f6e 203e 2072 6563 6569 7665 645b  tion > received[
-00001520: 2d33 5d2e 636f 6d6d 6974 5f70 6f73 6974  -3].commit_posit
-00001530: 696f 6e0a 6173 7365 7274 2072 6563 6569  ion.assert recei
-00001540: 7665 645b 2d31 5d2e 636f 6d6d 6974 5f70  ved[-1].commit_p
-00001550: 6f73 6974 696f 6e20 3e20 7265 6365 6976  osition > receiv
-00001560: 6564 5b2d 325d 2e63 6f6d 6d69 745f 706f  ed[-2].commit_po
-00001570: 7369 7469 6f6e 0a0a 0a23 2043 6c6f 7365  sition...# Close
-00001580: 2074 6865 2063 6c69 656e 7420 6166 7465   the client afte
-00001590: 7220 7573 652e 0a0a 636c 6965 6e74 2e63  r use...client.c
-000015a0: 6c6f 7365 2829 0a60 6060 0a0a 5365 6520  lose().```..See 
-000015b0: 6265 6c6f 7720 666f 7220 6d6f 7265 2064  below for more d
-000015c0: 6574 6169 6c73 2e0a 0a46 6f72 2061 6e20  etails...For an 
-000015d0: 6578 616d 706c 6520 6f66 2075 7361 6765  example of usage
-000015e0: 2c20 7365 6520 7468 6520 5b65 7665 6e74  , see the [event
-000015f0: 736f 7572 6369 6e67 2d65 7665 6e74 7374  sourcing-eventst
-00001600: 6f72 6564 625d 280a 6874 7470 733a 2f2f  oredb](.https://
-00001610: 6769 7468 7562 2e63 6f6d 2f70 7965 7665  github.com/pyeve
-00001620: 6e74 736f 7572 6369 6e67 2f65 7665 6e74  ntsourcing/event
-00001630: 736f 7572 6369 6e67 2d65 7665 6e74 7374  sourcing-eventst
-00001640: 6f72 6564 6229 2070 6163 6b61 6765 2e0a  oredb) package..
-00001650: 0a23 2320 5461 626c 6520 6f66 2063 6f6e  .## Table of con
-00001660: 7465 6e74 730a 0a3c 212d 2d20 544f 4320  tents..<!-- TOC 
-00001670: 2d2d 3e0a 2a20 5b49 6e73 7461 6c6c 2070  -->.* [Install p
-00001680: 6163 6b61 6765 5d28 2369 6e73 7461 6c6c  ackage](#install
-00001690: 2d70 6163 6b61 6765 290a 2020 2a20 5b46  -package).  * [F
-000016a0: 726f 6d20 5079 5049 5d28 2366 726f 6d2d  rom PyPI](#from-
-000016b0: 7079 7069 290a 2020 2a20 5b57 6974 6820  pypi).  * [With 
-000016c0: 506f 6574 7279 5d28 2377 6974 682d 706f  Poetry](#with-po
-000016d0: 6574 7279 290a 2a20 5b45 7665 6e74 5374  etry).* [EventSt
-000016e0: 6f72 6544 4220 7365 7276 6572 5d28 2365  oreDB server](#e
-000016f0: 7665 6e74 7374 6f72 6564 622d 7365 7276  ventstoredb-serv
-00001700: 6572 290a 2020 2a20 5b52 756e 2063 6f6e  er).  * [Run con
-00001710: 7461 696e 6572 5d28 2372 756e 2d63 6f6e  tainer](#run-con
-00001720: 7461 696e 6572 290a 2020 2a20 5b53 746f  tainer).  * [Sto
-00001730: 7020 636f 6e74 6169 6e65 725d 2823 7374  p container](#st
-00001740: 6f70 2d63 6f6e 7461 696e 6572 290a 2a20  op-container).* 
-00001750: 5b45 7665 6e74 5374 6f72 6544 4220 636c  [EventStoreDB cl
-00001760: 6965 6e74 5d28 2365 7665 6e74 7374 6f72  ient](#eventstor
-00001770: 6564 622d 636c 6965 6e74 290a 2020 2a20  edb-client).  * 
-00001780: 5b49 6d70 6f72 7420 636c 6173 735d 2823  [Import class](#
-00001790: 696d 706f 7274 2d63 6c61 7373 290a 2020  import-class).  
-000017a0: 2a20 5b43 6f6e 7374 7275 6374 2063 6c69  * [Construct cli
-000017b0: 656e 745d 2823 636f 6e73 7472 7563 742d  ent](#construct-
-000017c0: 636c 6965 6e74 290a 2a20 5b53 7472 6561  client).* [Strea
-000017d0: 6d73 5d28 2373 7472 6561 6d73 290a 2020  ms](#streams).  
-000017e0: 2a20 5b41 7070 656e 6420 6576 656e 7473  * [Append events
-000017f0: 5d28 2361 7070 656e 642d 6576 656e 7473  ](#append-events
-00001800: 290a 2020 2a20 5b41 7070 656e 6420 6576  ).  * [Append ev
-00001810: 656e 745d 2823 6170 7065 6e64 2d65 7665  ent](#append-eve
-00001820: 6e74 290a 2020 2a20 5b49 6465 6d70 6f74  nt).  * [Idempot
-00001830: 656e 7420 6170 7065 6e64 206f 7065 7261  ent append opera
-00001840: 7469 6f6e 735d 2823 6964 656d 706f 7465  tions](#idempote
-00001850: 6e74 2d61 7070 656e 642d 6f70 6572 6174  nt-append-operat
-00001860: 696f 6e73 290a 2020 2a20 5b52 6561 6420  ions).  * [Read 
-00001870: 7374 7265 616d 2065 7665 6e74 735d 2823  stream events](#
-00001880: 7265 6164 2d73 7472 6561 6d2d 6576 656e  read-stream-even
-00001890: 7473 290a 2020 2a20 5b52 6561 6420 616c  ts).  * [Read al
-000018a0: 6c20 6576 656e 7473 5d28 2372 6561 642d  l events](#read-
-000018b0: 616c 6c2d 6576 656e 7473 290a 2020 2a20  all-events).  * 
-000018c0: 5b47 6574 2063 7572 7265 6e74 2073 7472  [Get current str
-000018d0: 6561 6d20 706f 7369 7469 6f6e 5d28 2367  eam position](#g
-000018e0: 6574 2d63 7572 7265 6e74 2d73 7472 6561  et-current-strea
-000018f0: 6d2d 706f 7369 7469 6f6e 290a 2020 2a20  m-position).  * 
-00001900: 5b47 6574 2063 7572 7265 6e74 2063 6f6d  [Get current com
-00001910: 6d69 7420 706f 7369 7469 6f6e 5d28 2367  mit position](#g
-00001920: 6574 2d63 7572 7265 6e74 2d63 6f6d 6d69  et-current-commi
-00001930: 742d 706f 7369 7469 6f6e 290a 2020 2a20  t-position).  * 
-00001940: 5b47 6574 2073 7472 6561 6d20 6d65 7461  [Get stream meta
-00001950: 6461 7461 5d28 2367 6574 2d73 7472 6561  data](#get-strea
-00001960: 6d2d 6d65 7461 6461 7461 290a 2020 2a20  m-metadata).  * 
-00001970: 5b53 6574 2073 7472 6561 6d20 6d65 7461  [Set stream meta
-00001980: 6461 7461 5d28 2373 6574 2d73 7472 6561  data](#set-strea
-00001990: 6d2d 6d65 7461 6461 7461 290a 2020 2a20  m-metadata).  * 
-000019a0: 5b44 656c 6574 6520 7374 7265 616d 5d28  [Delete stream](
-000019b0: 2364 656c 6574 652d 7374 7265 616d 290a  #delete-stream).
-000019c0: 2020 2a20 5b54 6f6d 6273 746f 6e65 2073    * [Tombstone s
-000019d0: 7472 6561 6d5d 2823 746f 6d62 7374 6f6e  tream](#tombston
-000019e0: 652d 7374 7265 616d 290a 2a20 5b43 6174  e-stream).* [Cat
-000019f0: 6368 2d75 7020 7375 6273 6372 6970 7469  ch-up subscripti
-00001a00: 6f6e 735d 2823 6361 7463 682d 7570 2d73  ons](#catch-up-s
-00001a10: 7562 7363 7269 7074 696f 6e73 290a 2020  ubscriptions).  
-00001a20: 2a20 5b48 6f77 2074 6f20 696d 706c 656d  * [How to implem
-00001a30: 656e 7420 6578 6163 746c 792d 6f6e 6365  ent exactly-once
-00001a40: 2065 7665 6e74 2070 726f 6365 7373 696e   event processin
-00001a50: 675d 2823 686f 772d 746f 2d69 6d70 6c65  g](#how-to-imple
-00001a60: 6d65 6e74 2d65 7861 6374 6c79 2d6f 6e63  ment-exactly-onc
-00001a70: 652d 6576 656e 742d 7072 6f63 6573 7369  e-event-processi
-00001a80: 6e67 290a 2020 2a20 5b53 7562 7363 7269  ng).  * [Subscri
-00001a90: 6265 2061 6c6c 2065 7665 6e74 735d 2823  be all events](#
-00001aa0: 7375 6273 6372 6962 652d 616c 6c2d 6576  subscribe-all-ev
-00001ab0: 656e 7473 290a 2020 2a20 5b53 7562 7363  ents).  * [Subsc
-00001ac0: 7269 6265 2073 7472 6561 6d20 6576 656e  ribe stream even
-00001ad0: 7473 5d28 2373 7562 7363 7269 6265 2d73  ts](#subscribe-s
-00001ae0: 7472 6561 6d2d 6576 656e 7473 290a 2a20  tream-events).* 
-00001af0: 5b50 6572 7369 7374 656e 7420 7375 6273  [Persistent subs
-00001b00: 6372 6970 7469 6f6e 735d 2823 7065 7273  criptions](#pers
-00001b10: 6973 7465 6e74 2d73 7562 7363 7269 7074  istent-subscript
-00001b20: 696f 6e73 290a 2020 2a20 5b43 7265 6174  ions).  * [Creat
-00001b30: 6520 7375 6273 6372 6970 7469 6f6e 5d28  e subscription](
-00001b40: 2363 7265 6174 652d 7375 6273 6372 6970  #create-subscrip
-00001b50: 7469 6f6e 290a 2020 2a20 5b52 6561 6420  tion).  * [Read 
-00001b60: 7375 6273 6372 6970 7469 6f6e 5d28 2372  subscription](#r
-00001b70: 6561 642d 7375 6273 6372 6970 7469 6f6e  ead-subscription
-00001b80: 290a 2020 2a20 5b47 6574 2073 7562 7363  ).  * [Get subsc
-00001b90: 7269 7074 696f 6e20 696e 666f 5d28 2367  ription info](#g
-00001ba0: 6574 2d73 7562 7363 7269 7074 696f 6e2d  et-subscription-
-00001bb0: 696e 666f 290a 2020 2a20 5b4c 6973 7420  info).  * [List 
-00001bc0: 7375 6273 6372 6970 7469 6f6e 735d 2823  subscriptions](#
-00001bd0: 6c69 7374 2d73 7562 7363 7269 7074 696f  list-subscriptio
-00001be0: 6e73 290a 2020 2a20 5b44 656c 6574 6520  ns).  * [Delete 
-00001bf0: 7375 6273 6372 6970 7469 6f6e 5d28 2364  subscription](#d
-00001c00: 656c 6574 652d 7375 6273 6372 6970 7469  elete-subscripti
-00001c10: 6f6e 290a 2020 2a20 5b43 7265 6174 6520  on).  * [Create 
-00001c20: 7374 7265 616d 2073 7562 7363 7269 7074  stream subscript
-00001c30: 696f 6e5d 2823 6372 6561 7465 2d73 7472  ion](#create-str
-00001c40: 6561 6d2d 7375 6273 6372 6970 7469 6f6e  eam-subscription
-00001c50: 290a 2020 2a20 5b52 6561 6420 7374 7265  ).  * [Read stre
-00001c60: 616d 2073 7562 7363 7269 7074 696f 6e5d  am subscription]
-00001c70: 2823 7265 6164 2d73 7472 6561 6d2d 7375  (#read-stream-su
-00001c80: 6273 6372 6970 7469 6f6e 290a 2020 2a20  bscription).  * 
-00001c90: 5b47 6574 2073 7472 6561 6d20 7375 6273  [Get stream subs
-00001ca0: 6372 6970 7469 6f6e 2069 6e66 6f5d 2823  cription info](#
-00001cb0: 6765 742d 7374 7265 616d 2d73 7562 7363  get-stream-subsc
-00001cc0: 7269 7074 696f 6e2d 696e 666f 290a 2020  ription-info).  
-00001cd0: 2a20 5b4c 6973 7420 7374 7265 616d 2073  * [List stream s
-00001ce0: 7562 7363 7269 7074 696f 6e73 5d28 236c  ubscriptions](#l
-00001cf0: 6973 742d 7374 7265 616d 2d73 7562 7363  ist-stream-subsc
-00001d00: 7269 7074 696f 6e73 290a 2020 2a20 5b44  riptions).  * [D
-00001d10: 656c 6574 6520 7374 7265 616d 2073 7562  elete stream sub
-00001d20: 7363 7269 7074 696f 6e5d 2823 6465 6c65  scription](#dele
-00001d30: 7465 2d73 7472 6561 6d2d 7375 6273 6372  te-stream-subscr
-00001d40: 6970 7469 6f6e 290a 2a20 5b43 6f6e 6e65  iption).* [Conne
-00001d50: 6374 696f 6e5d 2823 636f 6e6e 6563 7469  ction](#connecti
-00001d60: 6f6e 290a 2020 2a20 5b52 6563 6f6e 6e65  on).  * [Reconne
-00001d70: 6374 5d28 2372 6563 6f6e 6e65 6374 290a  ct](#reconnect).
-00001d80: 2020 2a20 5b43 6c6f 7365 5d28 2363 6c6f    * [Close](#clo
-00001d90: 7365 290a 2a20 5b4e 6f74 6573 5d28 236e  se).* [Notes](#n
-00001da0: 6f74 6573 290a 2020 2a20 5b43 6f6e 6e65  otes).  * [Conne
-00001db0: 6374 696f 6e20 7374 7269 6e67 735d 2823  ction strings](#
-00001dc0: 636f 6e6e 6563 7469 6f6e 2d73 7472 696e  connection-strin
-00001dd0: 6773 290a 2020 2a20 5b52 6567 756c 6172  gs).  * [Regular
-00001de0: 2065 7870 7265 7373 696f 6e20 6669 6c74   expression filt
-00001df0: 6572 735d 2823 7265 6775 6c61 722d 6578  ers](#regular-ex
-00001e00: 7072 6573 7369 6f6e 2d66 696c 7465 7273  pression-filters
-00001e10: 290a 2020 2a20 5b4e 6577 2065 7665 6e74  ).  * [New event
-00001e20: 206f 626a 6563 7473 5d28 236e 6577 2d65   objects](#new-e
-00001e30: 7665 6e74 2d6f 626a 6563 7473 290a 2020  vent-objects).  
-00001e40: 2a20 5b52 6563 6f72 6465 6420 6576 656e  * [Recorded even
-00001e50: 7420 6f62 6a65 6374 735d 2823 7265 636f  t objects](#reco
-00001e60: 7264 6564 2d65 7665 6e74 2d6f 626a 6563  rded-event-objec
-00001e70: 7473 290a 2020 2a20 5b41 7379 6e63 696f  ts).  * [Asyncio
-00001e80: 2063 6c69 656e 745d 2823 6173 796e 6369   client](#asynci
-00001e90: 6f2d 636c 6965 6e74 290a 2a20 5b43 6f6e  o-client).* [Con
-00001ea0: 7472 6962 7574 6f72 735d 2823 636f 6e74  tributors](#cont
-00001eb0: 7269 6275 746f 7273 290a 2020 2a20 5b49  ributors).  * [I
-00001ec0: 6e73 7461 6c6c 2050 6f65 7472 795d 2823  nstall Poetry](#
-00001ed0: 696e 7374 616c 6c2d 706f 6574 7279 290a  install-poetry).
-00001ee0: 2020 2a20 5b53 6574 7570 2066 6f72 2050    * [Setup for P
-00001ef0: 7943 6861 726d 2075 7365 7273 5d28 2373  yCharm users](#s
-00001f00: 6574 7570 2d66 6f72 2d70 7963 6861 726d  etup-for-pycharm
-00001f10: 2d75 7365 7273 290a 2020 2a20 5b53 6574  -users).  * [Set
-00001f20: 7570 2066 726f 6d20 636f 6d6d 616e 6420  up from command 
-00001f30: 6c69 6e65 5d28 2373 6574 7570 2d66 726f  line](#setup-fro
-00001f40: 6d2d 636f 6d6d 616e 642d 6c69 6e65 290a  m-command-line).
-00001f50: 2020 2a20 5b50 726f 6a65 6374 204d 616b    * [Project Mak
-00001f60: 6566 696c 6520 636f 6d6d 616e 6473 5d28  efile commands](
-00001f70: 2370 726f 6a65 6374 2d6d 616b 6566 696c  #project-makefil
-00001f80: 652d 636f 6d6d 616e 6473 290a 3c21 2d2d  e-commands).<!--
-00001f90: 2054 4f43 202d 2d3e 0a0a 2323 2049 6e73   TOC -->..## Ins
-00001fa0: 7461 6c6c 2070 6163 6b61 6765 0a0a 4974  tall package..It
-00001fb0: 2069 7320 7265 636f 6d6d 656e 6465 6420   is recommended 
-00001fc0: 746f 2069 6e73 7461 6c6c 2050 7974 686f  to install Pytho
-00001fd0: 6e20 7061 636b 6167 6573 2069 6e74 6f20  n packages into 
-00001fe0: 6120 5079 7468 6f6e 2076 6972 7475 616c  a Python virtual
-00001ff0: 2065 6e76 6972 6f6e 6d65 6e74 2e0a 0a23   environment...#
-00002000: 2323 2046 726f 6d20 5079 5049 0a0a 596f  ## From PyPI..Yo
-00002010: 7520 6361 6e20 7573 6520 7069 7020 746f  u can use pip to
-00002020: 2069 6e73 7461 6c6c 2074 6869 7320 7061   install this pa
-00002030: 636b 6167 6520 6469 7265 6374 6c79 2066  ckage directly f
-00002040: 726f 6d0a 5b74 6865 2050 7974 686f 6e20  rom.[the Python 
-00002050: 5061 636b 6167 6520 496e 6465 785d 2868  Package Index](h
-00002060: 7474 7073 3a2f 2f70 7970 692e 6f72 672f  ttps://pypi.org/
-00002070: 7072 6f6a 6563 742f 6573 6462 636c 6965  project/esdbclie
-00002080: 6e74 2f29 2e0a 0a20 2020 2024 2070 6970  nt/)...    $ pip
-00002090: 2069 6e73 7461 6c6c 2065 7364 6263 6c69   install esdbcli
-000020a0: 656e 740a 0a23 2323 2057 6974 6820 506f  ent..### With Po
-000020b0: 6574 7279 0a0a 596f 7520 6361 6e20 7573  etry..You can us
-000020c0: 6520 506f 6574 7279 2074 6f20 6164 6420  e Poetry to add 
-000020d0: 7468 6973 2070 6163 6b61 6765 2074 6f20  this package to 
-000020e0: 796f 7572 2070 7970 726f 6a65 6374 2e74  your pyproject.t
-000020f0: 6f6d 6c20 616e 6420 696e 7374 616c 6c20  oml and install 
-00002100: 6974 2e0a 0a20 2020 2024 2070 6f65 7472  it...    $ poetr
-00002110: 7920 6164 6420 6573 6462 636c 6965 6e74  y add esdbclient
-00002120: 0a0a 2323 2045 7665 6e74 5374 6f72 6544  ..## EventStoreD
-00002130: 4220 7365 7276 6572 0a0a 5468 6520 4576  B server..The Ev
-00002140: 656e 7453 746f 7265 4442 2073 6572 7665  entStoreDB serve
-00002150: 7220 6361 6e20 6265 2072 756e 206c 6f63  r can be run loc
-00002160: 616c 6c79 2075 7369 6e67 2074 6865 206f  ally using the o
-00002170: 6666 6963 6961 6c20 446f 636b 6572 2063  fficial Docker c
-00002180: 6f6e 7461 696e 6572 2069 6d61 6765 2e0a  ontainer image..
-00002190: 0a23 2323 2052 756e 2063 6f6e 7461 696e  .### Run contain
-000021a0: 6572 0a0a 466f 7220 6465 7665 6c6f 706d  er..For developm
-000021b0: 656e 742c 2079 6f75 2063 616e 2072 756e  ent, you can run
-000021c0: 2061 2022 7365 6375 7265 2220 4576 656e   a "secure" Even
-000021d0: 7453 746f 7265 4442 2073 6572 7665 7220  tStoreDB server 
-000021e0: 7573 696e 6720 7468 6520 666f 6c6c 6f77  using the follow
-000021f0: 696e 6720 636f 6d6d 616e 642e 0a0a 2020  ing command...  
-00002200: 2020 2420 646f 636b 6572 2072 756e 202d    $ docker run -
-00002210: 6420 2d2d 6e61 6d65 2065 7665 6e74 7374  d --name eventst
-00002220: 6f72 6564 622d 7365 6375 7265 202d 6974  oredb-secure -it
-00002230: 202d 7020 3231 3133 3a32 3131 3320 2d2d   -p 2113:2113 --
-00002240: 656e 7620 2248 4f4d 453d 2f74 6d70 2220  env "HOME=/tmp" 
-00002250: 6576 656e 7473 746f 7265 2f65 7665 6e74  eventstore/event
-00002260: 7374 6f72 653a 3231 2e31 302e 392d 6275  store:21.10.9-bu
-00002270: 7374 6572 2d73 6c69 6d20 2d2d 6465 760a  ster-slim --dev.
-00002280: 0a41 7320 7765 2077 696c 6c20 7365 652c  .As we will see,
-00002290: 2074 6865 2063 6c69 656e 7420 6e65 6564   the client need
-000022a0: 7320 616e 2045 7665 6e74 5374 6f72 6544  s an EventStoreD
-000022b0: 4220 636f 6e6e 6563 7469 6f6e 2073 7472  B connection str
-000022c0: 696e 6720 5552 4920 6173 2074 6865 2076  ing URI as the v
-000022d0: 616c 7565 206f 660a 6974 7320 6075 7269  alue of.its `uri
-000022e0: 6020 636f 6e73 7472 7563 746f 7220 6172  ` constructor ar
-000022f0: 6775 6d65 6e74 2e20 5365 6520 7468 6520  gument. See the 
-00002300: 4e6f 7465 7320 7365 6374 696f 6e20 6265  Notes section be
-00002310: 6c6f 7720 666f 7220 6465 7461 696c 6564  low for detailed
-00002320: 2069 6e66 6f72 6d61 7469 6f6e 0a61 626f   information.abo
-00002330: 7574 2045 7665 6e74 5374 6f72 6544 4220  ut EventStoreDB 
-00002340: 636f 6e6e 6563 7469 6f6e 2073 7472 696e  connection strin
-00002350: 6720 5552 4973 2e0a 0a54 6865 2063 6f6e  g URIs...The con
-00002360: 6e65 6374 696f 6e20 7374 7269 6e67 2066  nection string f
-00002370: 6f72 2074 6869 7320 2273 6563 7572 6522  or this "secure"
-00002380: 2045 7665 6e74 5374 6f72 6544 4220 7365   EventStoreDB se
-00002390: 7276 6572 2077 6f75 6c64 2062 653a 0a0a  rver would be:..
-000023a0: 2020 2020 6573 6462 3a2f 2f61 646d 696e      esdb://admin
-000023b0: 3a63 6861 6e67 6569 7440 6c6f 6361 6c68  :changeit@localh
-000023c0: 6f73 743a 3231 3133 0a0a 546f 2063 6f6e  ost:2113..To con
-000023d0: 6e65 6374 2074 6f20 6120 2273 6563 7572  nect to a "secur
-000023e0: 6522 2073 6572 7665 722c 2079 6f75 2077  e" server, you w
-000023f0: 696c 6c20 7573 7561 6c6c 7920 6e65 6564  ill usually need
-00002400: 2074 6f20 696e 636c 7564 6520 6120 2275   to include a "u
-00002410: 7365 726e 616d 6522 0a61 6e64 2061 2022  sername".and a "
-00002420: 7061 7373 776f 7264 2220 696e 2074 6865  password" in the
-00002430: 2063 6f6e 6e65 6374 696f 6e20 7374 7269   connection stri
-00002440: 6e67 2c20 736f 2074 6861 7420 7468 6520  ng, so that the 
-00002450: 7365 7276 6572 2063 616e 2061 7574 6865  server can authe
-00002460: 6e74 6963 6174 6520 7468 650a 636c 6965  nticate the.clie
-00002470: 6e74 2e20 5468 6520 6465 6661 756c 7420  nt. The default 
-00002480: 7573 6572 6e61 6d65 2069 7320 2261 646d  username is "adm
-00002490: 696e 2220 616e 6420 7468 6520 6465 6661  in" and the defa
-000024a0: 756c 7420 7061 7373 776f 7264 2069 7320  ult password is 
-000024b0: 2263 6861 6e67 6569 7422 2e0a 0a57 6865  "changeit"...Whe
-000024c0: 6e20 636f 6e6e 6563 7469 6e67 2074 6f20  n connecting to 
-000024d0: 6120 2273 6563 7572 6522 2073 6572 7665  a "secure" serve
-000024e0: 722c 2074 6865 2063 6c69 656e 7420 616c  r, the client al
-000024f0: 736f 206e 6565 6473 2061 6e20 5353 4c2f  so needs an SSL/
-00002500: 544c 530a 6365 7274 6966 6963 6174 6520  TLS.certificate 
-00002510: 6173 2074 6865 2076 616c 7565 206f 6620  as the value of 
-00002520: 6974 7320 6072 6f6f 745f 6365 7274 6966  its `root_certif
-00002530: 6963 6174 6573 6020 636f 6e73 7472 7563  icates` construc
-00002540: 746f 7220 6172 6775 6d65 6e74 2e20 546f  tor argument. To
-00002550: 2063 6f6e 6e65 6374 0a74 6f20 6120 2273   connect.to a "s
-00002560: 6563 7572 6522 2073 6572 7665 7220 796f  ecure" server yo
-00002570: 7520 7769 6c6c 206e 6565 6420 616e 2053  u will need an S
-00002580: 534c 2f54 4c53 2063 6572 7469 6669 6361  SL/TLS certifica
-00002590: 7465 2073 6f20 7468 6174 2074 6865 2063  te so that the c
-000025a0: 6c69 656e 7420 6361 6e0a 6175 7468 656e  lient can.authen
-000025b0: 7469 6361 7465 2074 6865 2073 6572 7665  ticate the serve
-000025c0: 722e 2046 6f72 2064 6576 656c 6f70 6d65  r. For developme
-000025d0: 6e74 2c20 796f 7520 6361 6e20 6569 7468  nt, you can eith
-000025e0: 6572 2075 7365 2074 6865 2053 534c 2f54  er use the SSL/T
-000025f0: 4c53 2063 6572 7469 6669 6361 7465 0a6f  LS certificate.o
-00002600: 6620 7468 6520 6365 7274 6966 6963 6174  f the certificat
-00002610: 6520 6175 7468 6f72 6974 7920 7573 6564  e authority used
-00002620: 2074 6f20 6372 6561 7465 2074 6865 2073   to create the s
-00002630: 6572 7665 7227 7320 6365 7274 6966 6963  erver's certific
-00002640: 6174 652c 206f 7220 7768 656e 2075 7369  ate, or when usi
-00002650: 6e67 2061 0a73 696e 676c 652d 6e6f 6465  ng a.single-node
-00002660: 2063 6c75 7374 6572 2c20 796f 7520 6361   cluster, you ca
-00002670: 6e20 7573 6520 7468 6520 7365 7276 6572  n use the server
-00002680: 2063 6572 7469 6669 6361 7465 2069 7473   certificate its
-00002690: 656c 662e 2059 6f75 2063 616e 2067 6574  elf. You can get
-000026a0: 2074 6865 0a73 6572 7665 7220 6365 7274   the.server cert
-000026b0: 6966 6963 6174 6520 7769 7468 2074 6865  ificate with the
-000026c0: 2066 6f6c 6c6f 7769 6e67 2050 7974 686f   following Pytho
-000026d0: 6e20 636f 6465 2e0a 0a0a 6060 6070 7974  n code....```pyt
-000026e0: 686f 6e0a 696d 706f 7274 2073 736c 0a0a  hon.import ssl..
-000026f0: 7365 7276 6572 5f63 6572 7469 6669 6361  server_certifica
-00002700: 7465 203d 2073 736c 2e67 6574 5f73 6572  te = ssl.get_ser
-00002710: 7665 725f 6365 7274 6966 6963 6174 6528  ver_certificate(
-00002720: 6164 6472 3d28 276c 6f63 616c 686f 7374  addr=('localhost
-00002730: 272c 2032 3131 3329 290a 6060 600a 0a59  ', 2113)).```..Y
-00002740: 6f75 2063 616e 2061 6c73 6f20 7374 6172  ou can also star
-00002750: 7420 616e 2022 696e 7365 6375 7265 2220  t an "insecure" 
-00002760: 7365 7276 6572 2075 7369 6e67 2074 6865  server using the
-00002770: 2066 6f6c 6c6f 7769 6e67 2063 6f6d 6d61   following comma
-00002780: 6e64 2e0a 0a20 2020 2024 2064 6f63 6b65  nd...    $ docke
-00002790: 7220 7275 6e20 2d64 202d 2d6e 616d 6520  r run -d --name 
-000027a0: 6576 656e 7473 746f 7265 6462 2d69 6e73  eventstoredb-ins
-000027b0: 6563 7572 6520 2d69 7420 2d70 2032 3131  ecure -it -p 211
-000027c0: 343a 3231 3133 2065 7665 6e74 7374 6f72  4:2113 eventstor
-000027d0: 652f 6576 656e 7473 746f 7265 3a32 312e  e/eventstore:21.
-000027e0: 3130 2e39 2d62 7573 7465 722d 736c 696d  10.9-buster-slim
-000027f0: 202d 2d69 6e73 6563 7572 650a 0a54 6865   --insecure..The
-00002800: 2063 6f6e 6e65 6374 696f 6e20 7374 7269   connection stri
-00002810: 6e67 2055 5249 2066 6f72 2074 6869 7320  ng URI for this 
-00002820: 2269 6e73 6563 7572 6522 2073 6572 7665  "insecure" serve
-00002830: 7220 776f 756c 6420 6265 3a0a 0a20 2020  r would be:..   
-00002840: 2065 7364 623a 2f2f 6c6f 6361 6c68 6f73   esdb://localhos
-00002850: 743a 3231 3134 3f54 6c73 3d66 616c 7365  t:2114?Tls=false
-00002860: 0a0a 4173 2077 6520 7769 6c6c 2073 6565  ..As we will see
-00002870: 2c20 7768 656e 2063 6f6e 6e65 6374 696e  , when connectin
-00002880: 6720 746f 2061 6e20 2269 6e73 6563 7572  g to an "insecur
-00002890: 6522 2073 6572 7665 722c 2074 6865 7265  e" server, there
-000028a0: 2069 7320 6e6f 206e 6565 6420 746f 2069   is no need to i
-000028b0: 6e63 6c75 6465 0a61 2022 7573 6572 6e61  nclude.a "userna
-000028c0: 6d65 2220 616e 6420 6120 2270 6173 7377  me" and a "passw
-000028d0: 6f72 6422 2069 6e20 7468 6520 636f 6e6e  ord" in the conn
-000028e0: 6563 7469 6f6e 2073 7472 696e 672e 2049  ection string. I
-000028f0: 6620 796f 7520 646f 2c20 7468 6573 6520  f you do, these 
-00002900: 7661 6c75 6573 2077 696c 6c0a 6265 2069  values will.be i
-00002910: 676e 6f72 6564 2062 7920 7468 6520 636c  gnored by the cl
-00002920: 6965 6e74 2c20 736f 2074 6861 7420 7468  ient, so that th
-00002930: 6579 2077 696c 6c20 6e6f 7420 6265 2073  ey will not be s
-00002940: 656e 7420 746f 2074 6865 2073 6572 7665  ent to the serve
-00002950: 7220 6f76 6572 2061 6e0a 696e 7365 6375  r over an.insecu
-00002960: 7265 2063 6861 6e6e 656c 2e0a 0a50 6c65  re channel...Ple
-00002970: 6173 6520 6e6f 7465 2c20 7468 6520 2269  ase note, the "i
-00002980: 6e73 6563 7572 6522 2063 6f6e 6e65 6374  nsecure" connect
-00002990: 696f 6e20 7374 7269 6e67 2075 7365 7320  ion string uses 
-000029a0: 6120 7175 6572 7920 7374 7269 6e67 2077  a query string w
-000029b0: 6974 6820 7468 6520 6669 656c 642d 7661  ith the field-va
-000029c0: 6c75 650a 6054 6c73 3d66 616c 7365 602e  lue.`Tls=false`.
-000029d0: 2054 6865 2076 616c 7565 206f 6620 7468   The value of th
-000029e0: 6973 2066 6965 6c64 2069 7320 6279 2064  is field is by d
-000029f0: 6566 6175 6c74 2060 7472 7565 602e 2053  efault `true`. S
-00002a00: 6565 2074 6865 204e 6f74 6573 2073 6563  ee the Notes sec
-00002a10: 7469 6f6e 2062 656c 6f77 0a66 6f72 206d  tion below.for m
-00002a20: 6f72 6520 696e 666f 726d 6174 696f 6e20  ore information 
-00002a30: 6162 6f75 7420 4576 656e 7453 746f 7265  about EventStore
-00002a40: 4442 2063 6f6e 6e65 6374 696f 6e20 7374  DB connection st
-00002a50: 7269 6e67 7320 616e 6420 7468 6520 6669  rings and the fi
-00002a60: 656c 6473 2074 6861 7420 6361 6e20 6265  elds that can be
-00002a70: 0a75 7365 6420 696e 2074 6865 2071 7565  .used in the que
-00002a80: 7279 2073 7472 696e 6720 746f 2073 7065  ry string to spe
-00002a90: 6369 6679 2063 6f6e 6e65 6374 696f 6e20  cify connection 
-00002aa0: 6f70 7469 6f6e 732e 0a0a 2323 2320 5374  options...### St
-00002ab0: 6f70 2063 6f6e 7461 696e 6572 0a0a 546f  op container..To
-00002ac0: 2073 746f 7020 616e 6420 7265 6d6f 7665   stop and remove
-00002ad0: 2074 6865 2022 7365 6375 7265 2220 636f   the "secure" co
-00002ae0: 6e74 6169 6e65 722c 2075 7365 2074 6865  ntainer, use the
-00002af0: 2066 6f6c 6c6f 7769 6e67 2044 6f63 6b65   following Docke
-00002b00: 7220 636f 6d6d 616e 6473 2e0a 0a20 2020  r commands...   
-00002b10: 2024 2064 6f63 6b65 7220 7374 6f70 2065   $ docker stop e
-00002b20: 7665 6e74 7374 6f72 6564 622d 7365 6375  ventstoredb-secu
-00002b30: 7265 0a09 2420 646f 636b 6572 2072 6d20  re..$ docker rm 
-00002b40: 6576 656e 7473 746f 7265 6462 2d73 6563  eventstoredb-sec
-00002b50: 7572 650a 0a54 6f20 7374 6f70 2061 6e64  ure..To stop and
-00002b60: 2072 656d 6f76 6520 7468 6520 2269 6e73   remove the "ins
-00002b70: 6563 7572 6522 2063 6f6e 7461 696e 6572  ecure" container
-00002b80: 2c20 7573 6520 7468 6520 666f 6c6c 6f77  , use the follow
-00002b90: 696e 6720 446f 636b 6572 2063 6f6d 6d61  ing Docker comma
-00002ba0: 6e64 732e 0a0a 2020 2020 2420 646f 636b  nds...    $ dock
-00002bb0: 6572 2073 746f 7020 6576 656e 7473 746f  er stop eventsto
-00002bc0: 7265 6462 2d69 6e73 6563 7572 650a 0924  redb-insecure..$
-00002bd0: 2064 6f63 6b65 7220 726d 2065 7665 6e74   docker rm event
-00002be0: 7374 6f72 6564 622d 696e 7365 6375 7265  storedb-insecure
-00002bf0: 0a0a 0a23 2320 4576 656e 7453 746f 7265  ...## EventStore
-00002c00: 4442 2063 6c69 656e 740a 0a54 6869 7320  DB client..This 
-00002c10: 4576 656e 7453 746f 7265 4442 2063 6c69  EventStoreDB cli
-00002c20: 656e 7420 6973 2069 6d70 6c65 6d65 6e74  ent is implement
-00002c30: 6564 2069 6e20 7468 6520 6065 7364 6263  ed in the `esdbc
-00002c40: 6c69 656e 7460 2070 6163 6b61 6765 2077  lient` package w
-00002c50: 6974 680a 7468 6520 6045 5344 4243 6c69  ith.the `ESDBCli
-00002c60: 656e 7460 2063 6c61 7373 2e0a 0a23 2323  ent` class...###
-00002c70: 2049 6d70 6f72 7420 636c 6173 730a 0a54   Import class..T
-00002c80: 6865 2060 4553 4442 436c 6965 6e74 6020  he `ESDBClient` 
-00002c90: 636c 6173 7320 6361 6e20 6265 2069 6d70  class can be imp
-00002ca0: 6f72 7465 6420 6672 6f6d 2074 6865 2060  orted from the `
-00002cb0: 6573 6462 636c 6965 6e74 6020 7061 636b  esdbclient` pack
-00002cc0: 6167 652e 0a0a 6060 6070 7974 686f 6e0a  age...```python.
-00002cd0: 6672 6f6d 2065 7364 6263 6c69 656e 7420  from esdbclient 
-00002ce0: 696d 706f 7274 2045 5344 4243 6c69 656e  import ESDBClien
-00002cf0: 740a 6060 600a 0a23 2323 2043 6f6e 7374  t.```..### Const
-00002d00: 7275 6374 2063 6c69 656e 740a 0a54 6865  ruct client..The
-00002d10: 2060 4553 4442 436c 6965 6e74 6020 636c   `ESDBClient` cl
-00002d20: 6173 7320 6361 6e20 6265 2063 6f6e 7374  ass can be const
-00002d30: 7275 6374 6564 2077 6974 6820 6120 6075  ructed with a `u
-00002d40: 7269 6020 6172 6775 6d65 6e74 2c20 7768  ri` argument, wh
-00002d50: 6963 6820 6973 2072 6571 7569 7265 642e  ich is required.
-00002d60: 0a41 6e64 2c20 746f 2063 6f6e 6e65 6374  .And, to connect
-00002d70: 2074 6f20 6120 2273 6563 7572 6522 2045   to a "secure" E
-00002d80: 7665 6e74 5374 6f72 6544 4220 7365 7276  ventStoreDB serv
-00002d90: 6572 2c20 7468 6520 6f70 7469 6f6e 616c  er, the optional
-00002da0: 2060 726f 6f74 5f63 6572 7469 6669 6361   `root_certifica
-00002db0: 7465 7360 0a61 7267 756d 656e 7420 6973  tes`.argument is
-00002dc0: 2061 6c73 6f20 7265 7175 6972 6564 2e0a   also required..
-00002dd0: 0a54 6865 2060 7572 6960 2061 7267 756d  .The `uri` argum
-00002de0: 656e 7420 6973 2065 7870 6563 7465 6420  ent is expected 
-00002df0: 746f 2062 6520 616e 2045 7665 6e74 5374  to be an EventSt
-00002e00: 6f72 6544 4220 636f 6e6e 6563 7469 6f6e  oreDB connection
-00002e10: 2073 7472 696e 6720 5552 4920 7468 6174   string URI that
-00002e20: 0a63 6f6e 666f 726d 7320 7769 7468 2074  .conforms with t
-00002e30: 6865 2073 7461 6e64 6172 6420 4576 656e  he standard Even
-00002e40: 7453 746f 7265 4442 2022 6573 6462 2220  tStoreDB "esdb" 
-00002e50: 6f72 2022 6573 6462 2b64 6973 636f 7665  or "esdb+discove
-00002e60: 7222 2055 5249 2073 6368 656d 6573 2e20  r" URI schemes. 
-00002e70: 5468 650a 7379 6e74 6178 2061 6e64 2073  The.syntax and s
-00002e80: 656d 616e 7469 6373 206f 6620 4576 656e  emantics of Even
-00002e90: 7453 746f 7265 4442 2063 6f6e 6e65 6374  tStoreDB connect
-00002ea0: 696f 6e20 7374 7269 6e67 7320 6172 6520  ion strings are 
-00002eb0: 6578 706c 6169 6e65 6420 696e 2074 6865  explained in the
-00002ec0: 204e 6f74 6573 0a73 6563 7469 6f6e 2062   Notes.section b
-00002ed0: 656c 6f77 2e0a 0a46 6f72 2065 7861 6d70  elow...For examp
-00002ee0: 6c65 2c20 7468 6520 666f 6c6c 6f77 696e  le, the followin
-00002ef0: 6720 636f 6e6e 6563 7469 6f6e 2073 7472  g connection str
-00002f00: 696e 6720 7370 6563 6966 6965 7320 7468  ing specifies th
-00002f10: 6174 2074 6865 2063 6c69 656e 7420 7368  at the client sh
-00002f20: 6f75 6c64 0a61 7474 656d 7074 2074 6f20  ould.attempt to 
-00002f30: 6372 6561 7465 2061 2022 7365 6375 7265  create a "secure
-00002f40: 2220 636f 6e6e 6563 7469 6f6e 2074 6f20  " connection to 
-00002f50: 706f 7274 2032 3131 3320 6f6e 2022 6c6f  port 2113 on "lo
-00002f60: 6361 6c68 6f73 7422 2c20 616e 6420 7573  calhost", and us
-00002f70: 6520 7468 650a 636c 6965 6e74 2063 7265  e the.client cre
-00002f80: 6465 6e74 6961 6c73 2022 7573 6572 6e61  dentials "userna
-00002f90: 6d65 2220 616e 6420 2270 6173 7377 6f72  me" and "passwor
-00002fa0: 6422 2077 6865 6e20 6d61 6b69 6e67 2063  d" when making c
-00002fb0: 616c 6c73 2074 6f20 7468 6520 7365 7276  alls to the serv
-00002fc0: 6572 2e0a 0a20 2020 2065 7364 623a 2f2f  er...    esdb://
-00002fd0: 7573 6572 6e61 6d65 3a70 6173 7377 6f72  username:passwor
-00002fe0: 6440 6c6f 6361 6c68 6f73 743a 3231 3133  d@localhost:2113
-00002ff0: 3f54 6c73 3d74 7275 650a 0a54 6865 2063  ?Tls=true..The c
-00003000: 6c69 656e 7420 6d75 7374 2062 6520 636f  lient must be co
-00003010: 6e66 6967 7572 6564 2074 6f20 6372 6561  nfigured to crea
-00003020: 7465 2061 2022 7365 6375 7265 2220 636f  te a "secure" co
-00003030: 6e6e 6563 7469 6f6e 2074 6f20 6120 2273  nnection to a "s
-00003040: 6563 7572 6522 2073 6572 7665 722c 0a6f  ecure" server,.o
-00003050: 7220 616c 7465 726e 6174 6976 656c 7920  r alternatively 
-00003060: 616e 2022 696e 7365 6375 7265 2220 636f  an "insecure" co
-00003070: 6e6e 6563 7469 6f6e 2074 6f20 616e 2022  nnection to an "
-00003080: 696e 7365 6375 7265 2220 7365 7276 6572  insecure" server
-00003090: 2e20 4279 2064 6566 6175 6c74 2c20 7468  . By default, th
-000030a0: 650a 636c 6965 6e74 2077 696c 6c20 6174  e.client will at
-000030b0: 7465 6d70 7420 746f 2063 7265 6174 6520  tempt to create 
-000030c0: 6120 2273 6563 7572 6522 2063 6f6e 6e65  a "secure" conne
-000030d0: 6374 696f 6e2e 2041 6e64 2073 6f2c 2077  ction. And so, w
-000030e0: 6865 6e20 636f 6e6e 6563 7469 6e67 2074  hen connecting t
-000030f0: 6f20 616e 0a22 696e 7365 6375 7265 2220  o an."insecure" 
-00003100: 7365 7276 6572 2c20 7468 6520 636f 6e6e  server, the conn
-00003110: 6563 7469 6f6e 2073 7472 696e 6720 6d75  ection string mu
-00003120: 7374 2073 7065 6369 6679 2074 6861 7420  st specify that 
-00003130: 7468 6520 636c 6965 6e74 2073 686f 756c  the client shoul
-00003140: 6420 6174 7465 6d70 740a 746f 206d 616b  d attempt.to mak
-00003150: 6520 616e 2022 696e 7365 6375 7265 2220  e an "insecure" 
-00003160: 636f 6e6e 6563 7469 6f6e 2e0a 0a54 6865  connection...The
-00003170: 2066 6f6c 6c6f 7769 6e67 2063 6f6e 6e65   following conne
-00003180: 6374 696f 6e20 7374 7269 6e67 2073 7065  ction string spe
-00003190: 6369 6669 6573 2074 6861 7420 7468 6520  cifies that the 
-000031a0: 636c 6965 6e74 2073 686f 756c 640a 6174  client should.at
-000031b0: 7465 6d70 7420 746f 2063 7265 6174 6520  tempt to create 
-000031c0: 616e 2022 696e 7365 6375 7265 2220 636f  an "insecure" co
-000031d0: 6e6e 6563 7469 6f6e 2074 6f20 706f 7274  nnection to port
-000031e0: 2032 3131 3420 6f6e 2022 6c6f 6361 6c68   2114 on "localh
-000031f0: 6f73 7422 2e0a 5768 656e 2063 6f6e 6e65  ost"..When conne
-00003200: 6374 696e 6720 746f 2061 6e20 2269 6e73  cting to an "ins
-00003210: 6563 7572 6522 2073 6572 7665 722c 2074  ecure" server, t
-00003220: 6865 2063 6c69 656e 7420 7769 6c6c 2069  he client will i
-00003230: 676e 6f72 6520 616e 790a 7573 6572 6e61  gnore any.userna
-00003240: 6d65 2061 6e64 2070 6173 7377 6f72 6420  me and password 
-00003250: 696e 666f 726d 6174 696f 6e20 696e 636c  information incl
-00003260: 7564 6564 2069 6e20 7468 6520 636f 6e6e  uded in the conn
-00003270: 6563 7469 6f6e 2073 7472 696e 672c 0a73  ection string,.s
-00003280: 6f20 7468 6174 2075 7365 726e 616d 6573  o that usernames
-00003290: 2061 6e64 2070 6173 7377 6f72 6473 2061   and passwords a
-000032a0: 7265 206e 6f74 2073 656e 7420 6f76 6572  re not sent over
-000032b0: 2061 6e20 2269 6e73 6563 7572 6522 2063   an "insecure" c
-000032c0: 6f6e 6e65 6374 696f 6e2e 0a0a 2020 2020  onnection...    
-000032d0: 6573 6462 3a2f 2f6c 6f63 616c 686f 7374  esdb://localhost
-000032e0: 3a32 3131 343f 546c 733d 6661 6c73 650a  :2114?Tls=false.
-000032f0: 0a50 6c65 6173 6520 6e6f 7465 2c20 7468  .Please note, th
-00003300: 6520 2269 6e73 6563 7572 6522 2063 6f6e  e "insecure" con
-00003310: 6e65 6374 696f 6e20 7374 7269 6e67 2075  nection string u
-00003320: 7365 7320 6120 7175 6572 7920 7374 7269  ses a query stri
-00003330: 6e67 2077 6974 6820 7468 6520 6669 656c  ng with the fiel
-00003340: 642d 7661 6c75 650a 6054 6c73 3d66 616c  d-value.`Tls=fal
-00003350: 7365 602e 2054 6865 2076 616c 7565 206f  se`. The value o
-00003360: 6620 7468 6973 2066 6965 6c64 2069 7320  f this field is 
-00003370: 6279 2064 6566 6175 6c74 2060 7472 7565  by default `true
-00003380: 602e 2055 6e6c 6573 7320 7468 6520 636f  `. Unless the co
-00003390: 6e6e 6563 7469 6f6e 2073 7472 696e 670a  nnection string.
-000033a0: 5552 4920 696e 636c 7564 6573 2074 6865  URI includes the
-000033b0: 2066 6965 6c64 2d76 616c 7565 2060 546c   field-value `Tl
-000033c0: 733d 6661 6c73 6560 2069 6e20 7468 6520  s=false` in the 
-000033d0: 7175 6572 7920 7374 7269 6e67 2c20 7468  query string, th
-000033e0: 6520 6072 6f6f 745f 6365 7274 6966 6963  e `root_certific
-000033f0: 6174 6573 600a 636f 6e73 7472 7563 746f  ates`.constructo
-00003400: 7220 6172 6775 6d65 6e74 2069 7320 616c  r argument is al
-00003410: 736f 2072 6571 7569 7265 642e 0a0a 5768  so required...Wh
-00003420: 656e 2063 6f6e 6e65 6374 696e 6720 746f  en connecting to
-00003430: 2061 2022 7365 6375 7265 2220 7365 7276   a "secure" serv
-00003440: 6572 2c20 7468 6520 6072 6f6f 745f 6365  er, the `root_ce
-00003450: 7274 6966 6963 6174 6573 6020 6172 6775  rtificates` argu
-00003460: 6d65 6e74 2069 7320 6578 7065 6374 6564  ment is expected
-00003470: 2074 6f0a 6265 2061 2050 7974 686f 6e20   to.be a Python 
-00003480: 6073 7472 6020 636f 6e74 6169 6e69 6e67  `str` containing
-00003490: 2050 454d 2065 6e63 6f64 6564 2053 534c   PEM encoded SSL
-000034a0: 2f54 4c53 2072 6f6f 7420 6365 7274 6966  /TLS root certif
-000034b0: 6963 6174 6573 2e20 5468 6973 2076 616c  icates. This val
-000034c0: 7565 2069 730a 7061 7373 6564 2064 6972  ue is.passed dir
-000034d0: 6563 746c 7920 746f 2060 6772 7063 2e73  ectly to `grpc.s
-000034e0: 736c 5f63 6861 6e6e 656c 5f63 7265 6465  sl_channel_crede
-000034f0: 6e74 6961 6c73 2829 602e 2049 7420 6973  ntials()`. It is
-00003500: 2075 7365 6420 666f 7220 6175 7468 656e   used for authen
-00003510: 7469 6361 7469 6e67 2074 6865 0a73 6572  ticating the.ser
-00003520: 7665 7220 746f 2074 6865 2063 6c69 656e  ver to the clien
-00003530: 742e 2049 7420 6973 2063 6f6d 6d6f 6e6c  t. It is commonl
-00003540: 7920 7468 6520 6365 7274 6966 6963 6174  y the certificat
-00003550: 6520 6f66 2074 6865 2063 6572 7469 6669  e of the certifi
-00003560: 6361 7465 2061 7574 686f 7269 7479 2074  cate authority t
-00003570: 6861 740a 7761 7320 7265 7370 6f6e 7369  hat.was responsi
-00003580: 626c 6520 666f 7220 6765 6e65 7261 7469  ble for generati
-00003590: 6e67 2074 6865 2053 534c 2f54 4c53 2063  ng the SSL/TLS c
-000035a0: 6572 7469 6669 6361 7465 2075 7365 6420  ertificate used 
-000035b0: 6279 2074 6865 2045 7665 6e74 5374 6f72  by the EventStor
-000035c0: 6544 4220 7365 7276 6572 2e0a 4275 742c  eDB server..But,
-000035d0: 2061 6c74 6572 6e61 7469 7665 6c79 2066   alternatively f
-000035e0: 6f72 2064 6576 656c 6f70 6d65 6e74 2c20  or development, 
-000035f0: 796f 7520 6361 6e20 7573 6520 7468 6520  you can use the 
-00003600: 7365 7276 6572 2773 2063 6572 7469 6669  server's certifi
-00003610: 6361 7465 2069 7473 656c 662e 0a0a 496e  cate itself...In
-00003620: 2074 6865 2065 7861 6d70 6c65 2062 656c   the example bel
-00003630: 6f77 2c20 7468 6520 636f 6e73 7472 7563  ow, the construc
-00003640: 746f 7220 6172 6775 6d65 6e74 2076 616c  tor argument val
-00003650: 7565 7320 6172 6520 7461 6b65 6e20 6672  ues are taken fr
-00003660: 6f6d 2074 6865 206f 7065 7261 7469 6e67  om the operating
-00003670: 0a73 7973 7465 6d20 656e 7669 726f 6e6d  .system environm
-00003680: 656e 742e 2054 6869 7320 6973 2061 2074  ent. This is a t
-00003690: 7970 6963 616c 2061 7272 616e 6765 6d65  ypical arrangeme
-000036a0: 6e74 2069 6e20 6120 7072 6f64 7563 7469  nt in a producti
-000036b0: 6f6e 2065 6e76 6972 6f6e 6d65 6e74 2e20  on environment. 
-000036c0: 4974 2069 730a 646f 6e65 2074 6869 7320  It is.done this 
-000036d0: 7761 7920 6865 7265 2073 6f20 7468 6174  way here so that
-000036e0: 2074 6865 2063 6f64 6520 696e 2074 6869   the code in thi
-000036f0: 7320 646f 6375 6d65 6e74 6174 696f 6e20  s documentation 
-00003700: 6361 6e20 6265 2074 6573 7465 6420 7769  can be tested wi
-00003710: 7468 2062 6f74 680a 6120 2273 6563 7572  th both.a "secur
-00003720: 6522 2061 6e64 2061 6e20 2269 6e73 6563  e" and an "insec
-00003730: 7572 6522 2073 6572 7665 722e 0a0a 6060  ure" server...``
-00003740: 6070 7974 686f 6e0a 696d 706f 7274 206f  `python.import o
-00003750: 730a 0a63 6c69 656e 7420 3d20 4553 4442  s..client = ESDB
-00003760: 436c 6965 6e74 280a 2020 2020 7572 693d  Client(.    uri=
-00003770: 6f73 2e67 6574 656e 7628 2245 5344 425f  os.getenv("ESDB_
-00003780: 5552 4922 292c 0a20 2020 2072 6f6f 745f  URI"),.    root_
-00003790: 6365 7274 6966 6963 6174 6573 3d6f 732e  certificates=os.
-000037a0: 6765 7465 6e76 2822 4553 4442 5f52 4f4f  getenv("ESDB_ROO
-000037b0: 545f 4345 5254 4946 4943 4154 4553 2229  T_CERTIFICATES")
-000037c0: 2c0a 290a 6060 600a 0a53 6565 2074 6865  ,.).```..See the
-000037d0: 204e 6f74 6573 2073 6563 7469 6f6e 2062   Notes section b
-000037e0: 656c 6f77 2066 6f72 2064 6574 6169 6c65  elow for detaile
-000037f0: 6420 696e 666f 726d 6174 696f 6e20 6162  d information ab
-00003800: 6f75 7420 4576 656e 7453 746f 7265 4442  out EventStoreDB
-00003810: 2063 6f6e 6e65 6374 696f 6e0a 7374 7269   connection.stri
-00003820: 6e67 7320 616e 6420 7468 6520 6669 656c  ngs and the fiel
-00003830: 6473 2074 6861 7420 6361 6e20 6265 2075  ds that can be u
-00003840: 7365 6420 696e 2074 6865 2071 7565 7279  sed in the query
-00003850: 2073 7472 696e 6720 746f 2073 7065 6369   string to speci
-00003860: 6679 2063 6f6e 6e65 6374 696f 6e0a 6f70  fy connection.op
-00003870: 7469 6f6e 732e 0a0a 2323 2053 7472 6561  tions...## Strea
-00003880: 6d73 0a0a 496e 2045 7665 6e74 5374 6f72  ms..In EventStor
-00003890: 6544 422c 2061 2022 7374 7265 616d 2220  eDB, a "stream" 
-000038a0: 6973 2061 2073 6571 7565 6e63 6520 6f66  is a sequence of
-000038b0: 2072 6563 6f72 6465 6420 6576 656e 7473   recorded events
-000038c0: 2074 6861 7420 616c 6c20 6861 7665 0a74   that all have.t
-000038d0: 6865 2073 616d 6520 2273 7472 6561 6d20  he same "stream 
-000038e0: 6e61 6d65 222e 2054 6865 7265 2077 696c  name". There wil
-000038f0: 6c20 6e6f 726d 616c 6c79 2062 6520 6d61  l normally be ma
-00003900: 6e79 2073 7472 6561 6d73 2069 6e20 6120  ny streams in a 
-00003910: 6461 7461 6261 7365 2e0a 4561 6368 2072  database..Each r
-00003920: 6563 6f72 6465 6420 6576 656e 7420 6861  ecorded event ha
-00003930: 7320 6120 2273 7472 6561 6d20 706f 7369  s a "stream posi
-00003940: 7469 6f6e 2220 696e 2069 7473 2073 7472  tion" in its str
-00003950: 6561 6d2c 2061 6e64 2061 2022 636f 6d6d  eam, and a "comm
-00003960: 6974 2070 6f73 6974 696f 6e22 0a69 6e20  it position".in 
-00003970: 7468 6520 6461 7461 6261 7365 2e20 5468  the database. Th
-00003980: 6520 7374 7265 616d 2070 6f73 6974 696f  e stream positio
-00003990: 6e73 206f 6620 7468 6520 7265 636f 7264  ns of the record
-000039a0: 6564 2065 7665 6e74 7320 696e 2061 2073  ed events in a s
-000039b0: 7472 6561 6d20 6973 2061 2067 6170 6c65  tream is a gaple
-000039c0: 7373 0a73 6571 7565 6e63 6520 7374 6172  ss.sequence star
-000039d0: 7469 6e67 2066 726f 6d20 7a65 726f 2e20  ting from zero. 
-000039e0: 5468 6520 636f 6d6d 6974 2070 6f73 6974  The commit posit
-000039f0: 696f 6e73 206f 6620 7468 6520 7265 636f  ions of the reco
-00003a00: 7264 6564 2065 7665 6e74 7320 696e 2074  rded events in t
-00003a10: 6865 2064 6174 6162 6173 650a 666f 726d  he database.form
-00003a20: 2061 2073 6571 7565 6e63 6520 7468 6174   a sequence that
-00003a30: 2069 7320 6e6f 7420 6761 706c 6573 732e   is not gapless.
-00003a40: 0a0a 5468 6520 6d65 7468 6f64 7320 6061  ..The methods `a
-00003a50: 7070 656e 645f 6576 656e 7473 2829 602c  ppend_events()`,
-00003a60: 2060 7265 6164 5f73 7472 6561 6d5f 6576   `read_stream_ev
-00003a70: 656e 7473 2829 6020 616e 6420 6072 6561  ents()` and `rea
-00003a80: 645f 616c 6c5f 6576 656e 7473 2829 6020  d_all_events()` 
-00003a90: 6361 6e0a 6265 2075 7365 6420 746f 2072  can.be used to r
-00003aa0: 6563 6f72 6420 616e 6420 7265 6164 2065  ecord and read e
-00003ab0: 7665 6e74 7320 696e 2074 6865 2064 6174  vents in the dat
-00003ac0: 6162 6173 652e 0a0a 2323 2320 4170 7065  abase...### Appe
-00003ad0: 6e64 2065 7665 6e74 730a 0a2a 7265 7175  nd events..*requ
-00003ae0: 6972 6573 206c 6561 6465 722a 0a0a 5468  ires leader*..Th
-00003af0: 6520 6061 7070 656e 645f 6576 656e 7473  e `append_events
-00003b00: 2829 6020 6d65 7468 6f64 2063 616e 2062  ()` method can b
-00003b10: 6520 7573 6564 2074 6f20 7772 6974 6520  e used to write 
-00003b20: 6120 7365 7175 656e 6365 206f 6620 6e65  a sequence of ne
-00003b30: 7720 6576 656e 7473 2061 746f 6d69 6361  w events atomica
-00003b40: 6c6c 790a 746f 2061 2022 7374 7265 616d  lly.to a "stream
-00003b50: 222e 2057 7269 7469 6e67 206e 6577 2065  ". Writing new e
-00003b60: 7665 6e74 7320 6569 7468 6572 2063 7265  vents either cre
-00003b70: 6174 6573 2061 2073 7472 6561 6d2c 206f  ates a stream, o
-00003b80: 7220 6170 7065 6e64 7320 6576 656e 7473  r appends events
-00003b90: 2074 6f20 7468 6520 656e 640a 6f66 2061   to the end.of a
-00003ba0: 2073 7472 6561 6d2e 2054 6869 7320 6d65   stream. This me
-00003bb0: 7468 6f64 2069 7320 6964 656d 706f 7465  thod is idempote
-00003bc0: 6e74 2028 7365 6520 6265 6c6f 7729 2e0a  nt (see below)..
-00003bd0: 0a54 6869 7320 6d65 7468 6f64 2063 616e  .This method can
-00003be0: 2062 6520 7573 6564 2074 6f20 7265 636f   be used to reco
-00003bf0: 7264 2061 746f 6d69 6361 6c6c 7920 616c  rd atomically al
-00003c00: 6c20 7468 6520 6e65 770a 6576 656e 7473  l the new.events
-00003c10: 2074 6861 7420 6172 6520 6765 6e65 7261   that are genera
-00003c20: 7465 6420 7768 656e 2065 7865 6375 7469  ted when executi
-00003c30: 6e67 2061 2063 6f6d 6d61 6e64 2069 6e20  ng a command in 
-00003c40: 616e 2061 7070 6c69 6361 7469 6f6e 2e0a  an application..
-00003c50: 0a54 6872 6565 2061 7267 756d 656e 7473  .Three arguments
-00003c60: 2061 7265 2072 6571 7569 7265 642c 2060   are required, `
-00003c70: 7374 7265 616d 5f6e 616d 6560 2c20 6065  stream_name`, `e
-00003c80: 7870 6563 7465 645f 706f 7369 7469 6f6e  xpected_position
-00003c90: 600a 616e 6420 6065 7665 6e74 7360 2e0a  `.and `events`..
-00003ca0: 0a54 6865 2060 7374 7265 616d 5f6e 616d  .The `stream_nam
-00003cb0: 6560 2061 7267 756d 656e 7420 6973 2072  e` argument is r
-00003cc0: 6571 7569 7265 642c 2061 6e64 2069 7320  equired, and is 
-00003cd0: 6578 7065 6374 6564 2074 6f20 6265 2061  expected to be a
-00003ce0: 2050 7974 686f 6e0a 6073 7472 6020 7468   Python.`str` th
-00003cf0: 6174 2075 6e69 7175 656c 7920 6964 656e  at uniquely iden
-00003d00: 7469 6669 6573 2074 6865 2073 7472 6561  tifies the strea
-00003d10: 6d20 696e 2074 6865 2064 6174 6162 6173  m in the databas
-00003d20: 652e 0a0a 5468 6520 6065 7870 6563 7465  e...The `expecte
-00003d30: 645f 706f 7369 7469 6f6e 6020 6172 6775  d_position` argu
-00003d40: 6d65 6e74 2069 7320 7265 7175 6972 6564  ment is required
-00003d50: 2c20 6973 2065 7870 6563 7465 6420 746f  , is expected to
-00003d60: 2062 653a 2060 4e6f 6e65 600a 6966 2065   be: `None`.if e
-00003d70: 7665 6e74 7320 6172 6520 6265 696e 6720  vents are being 
-00003d80: 7772 6974 7465 6e20 746f 2061 206e 6577  written to a new
-00003d90: 2073 7472 6561 6d2c 2061 6e64 206f 7468   stream, and oth
-00003da0: 6572 7769 7365 2061 6e20 5079 7468 6f6e  erwise an Python
-00003db0: 2060 696e 7460 0a65 7175 616c 2074 6f20   `int`.equal to 
-00003dc0: 7468 6520 706f 7369 7469 6f6e 2069 6e20  the position in 
-00003dd0: 7468 6520 7374 7265 616d 206f 6620 7468  the stream of th
-00003de0: 6520 6c61 7374 2072 6563 6f72 6465 6420  e last recorded 
-00003df0: 6576 656e 7420 696e 2074 6865 2073 7472  event in the str
-00003e00: 6561 6d2e 0a0a 5468 6520 6065 7665 6e74  eam...The `event
-00003e10: 7360 2061 7267 756d 656e 7420 6973 2072  s` argument is r
-00003e20: 6571 7569 7265 642c 2061 6e64 2069 7320  equired, and is 
-00003e30: 6578 7065 6374 6564 2074 6f20 6265 2061  expected to be a
-00003e40: 2073 6571 7565 6e63 6520 6f66 206e 6577   sequence of new
-00003e50: 0a65 7665 6e74 206f 626a 6563 7473 2074  .event objects t
-00003e60: 6f20 6265 2061 7070 656e 6465 6420 746f  o be appended to
-00003e70: 2074 6865 206e 616d 6564 2073 7472 6561   the named strea
-00003e80: 6d2e 2054 6865 2060 4e65 7745 7665 6e74  m. The `NewEvent
-00003e90: 6020 636c 6173 7320 7368 6f75 6c64 0a62  ` class should.b
-00003ea0: 6520 7573 6564 2074 6f20 636f 6e73 7472  e used to constr
-00003eb0: 7563 7420 6e65 7720 6576 656e 7420 6f62  uct new event ob
-00003ec0: 6a65 6374 7320 2873 6565 2062 656c 6f77  jects (see below
-00003ed0: 292e 0a0a 5468 6973 206d 6574 686f 6420  )...This method 
-00003ee0: 7461 6b65 7320 616e 206f 7074 696f 6e61  takes an optiona
-00003ef0: 6c20 6074 696d 656f 7574 6020 6172 6775  l `timeout` argu
-00003f00: 6d65 6e74 2c20 7768 6963 6820 6973 2061  ment, which is a
-00003f10: 2050 7974 686f 6e20 6066 6c6f 6174 6020   Python `float` 
-00003f20: 7468 6174 2073 6574 730a 6120 6465 6164  that sets.a dead
-00003f30: 6c69 6e65 2066 6f72 2074 6865 2063 6f6d  line for the com
-00003f40: 706c 6574 696f 6e20 6f66 2074 6865 2067  pletion of the g
-00003f50: 5250 4320 6f70 6572 6174 696f 6e2e 0a0a  RPC operation...
-00003f60: 5374 7265 616d 7320 6172 6520 6372 6561  Streams are crea
-00003f70: 7465 6420 6279 2077 7269 7469 6e67 2065  ted by writing e
-00003f80: 7665 6e74 732e 2054 6865 2063 6f72 7265  vents. The corre
-00003f90: 6374 2076 616c 7565 206f 6620 7468 6520  ct value of the 
-00003fa0: 6065 7870 6563 7465 645f 706f 7369 7469  `expected_positi
-00003fb0: 6f6e 600a 6172 6775 6d65 6e74 2077 6865  on`.argument whe
-00003fc0: 6e20 7772 6974 696e 6720 7468 6520 6669  n writing the fi
-00003fd0: 7273 7420 6576 656e 7420 6f66 2061 206e  rst event of a n
-00003fe0: 6577 2073 7472 6561 6d20 6973 2060 4e6f  ew stream is `No
-00003ff0: 6e65 602e 2050 6c65 6173 6520 6e6f 7465  ne`. Please note
-00004000: 2c20 6974 2069 730a 6e6f 7420 706f 7373  , it is.not poss
-00004010: 6962 6c65 2074 6f20 736f 6d65 686f 7720  ible to somehow 
-00004020: 6372 6561 7465 2061 6e20 2265 6d70 7479  create an "empty
-00004030: 2220 7374 7265 616d 2069 6e20 4576 656e  " stream in Even
-00004040: 7453 746f 7265 4442 2e0a 0a54 6865 2073  tStoreDB...The s
-00004050: 7472 6561 6d20 706f 7369 7469 6f6e 7320  tream positions 
-00004060: 6f66 2072 6563 6f72 6465 6420 6576 656e  of recorded even
-00004070: 7473 2069 6e20 6120 7374 7265 616d 2073  ts in a stream s
-00004080: 7461 7274 2066 726f 6d20 7a65 726f 2c20  tart from zero, 
-00004090: 616e 6420 666f 726d 2061 2067 6170 6c65  and form a gaple
-000040a0: 7373 0a73 6571 7565 6e63 6520 6f66 2069  ss.sequence of i
-000040b0: 6e74 6567 6572 732e 2054 6865 2073 7472  ntegers. The str
-000040c0: 6561 6d20 706f 7369 7469 6f6e 206f 6620  eam position of 
-000040d0: 7468 6520 6669 7273 7420 7265 636f 7264  the first record
-000040e0: 6564 2065 7665 6e74 2069 6e20 6120 7374  ed event in a st
-000040f0: 7265 616d 2069 730a 6030 602e 2041 6e64  ream is.`0`. And
-00004100: 2073 6f20 7768 656e 2061 7070 656e 6469   so when appendi
-00004110: 6e67 2074 6865 2073 6563 6f6e 6420 6e65  ng the second ne
-00004120: 7720 6576 656e 7420 746f 2061 2073 7472  w event to a str
-00004130: 6561 6d20 7468 6174 2068 6173 206f 6e65  eam that has one
-00004140: 2072 6563 6f72 6465 6420 6576 656e 742c   recorded event,
-00004150: 0a74 6865 2063 6f72 7265 6374 2076 616c  .the correct val
-00004160: 7565 206f 6620 7468 6520 6065 7870 6563  ue of the `expec
-00004170: 7465 645f 706f 7369 7469 6f6e 6020 6172  ted_position` ar
-00004180: 6775 6d65 6e74 2069 7320 6030 602e 2053  gument is `0`. S
-00004190: 696d 696c 6172 6c79 2c20 7468 6520 7374  imilarly, the st
-000041a0: 7265 616d 0a70 6f73 6974 696f 6e20 6f66  ream.position of
-000041b0: 2074 6865 2073 6563 6f6e 6420 7265 636f   the second reco
-000041c0: 7264 6564 2065 7665 6e74 2069 6e20 6120  rded event in a 
-000041d0: 7374 7265 616d 2069 7320 6031 602c 2061  stream is `1`, a
-000041e0: 6e64 2073 6f20 7768 656e 2061 7070 656e  nd so when appen
-000041f0: 6469 6e67 2074 6865 0a74 6869 7264 206e  ding the.third n
-00004200: 6577 2065 7665 6e74 2074 6f20 6120 7374  ew event to a st
-00004210: 7265 616d 2074 6861 7420 6861 7320 7477  ream that has tw
-00004220: 6f20 7265 636f 7264 6564 2065 7665 6e74  o recorded event
-00004230: 732c 2074 6865 2063 6f72 7265 6374 2076  s, the correct v
-00004240: 616c 7565 206f 6620 7468 650a 6065 7870  alue of the.`exp
-00004250: 6563 7465 645f 706f 7369 7469 6f6e 6020  ected_position` 
-00004260: 6172 6775 6d65 6e74 2069 7320 6031 602e  argument is `1`.
-00004270: 2041 6e64 2073 6f20 6f6e 2e2e 2e20 2854   And so on... (T
-00004280: 6865 7265 2069 7320 6120 7468 656f 7265  here is a theore
-00004290: 7469 6361 6c20 6d61 7869 6d75 6d0a 6e75  tical maximum.nu
-000042a0: 6d62 6572 206f 6620 7265 636f 7264 6564  mber of recorded
-000042b0: 2065 7665 6e74 7320 7468 6174 2061 6e79   events that any
-000042c0: 2073 7472 6561 6d20 6361 6e20 6861 7665   stream can have
-000042d0: 2c20 6275 7420 4927 6d20 6e6f 7420 7375  , but I'm not su
-000042e0: 7265 2077 6861 7420 6974 2069 733b 0a6d  re what it is;.m
-000042f0: 6179 6265 2039 2c32 3233 2c33 3732 2c30  aybe 9,223,372,0
-00004300: 3336 2c38 3534 2c37 3735 2c38 3037 2062  36,854,775,807 b
-00004310: 6563 6175 7365 2069 7420 6973 2069 6d70  ecause it is imp
-00004320: 6c65 6d65 6e74 6564 2061 7320 6120 606c  lemented as a `l
-00004330: 6f6e 6760 2069 6e20 4323 3f29 0a0a 4966  ong` in C#?)..If
-00004340: 2074 6865 7265 2069 7320 6120 6d69 736d   there is a mism
-00004350: 6174 6368 2062 6574 7765 656e 2074 6865  atch between the
-00004360: 2067 6976 656e 2076 616c 7565 206f 6620   given value of 
-00004370: 7468 6520 6065 7870 6563 7465 645f 706f  the `expected_po
-00004380: 7369 7469 6f6e 6020 6172 6775 6d65 6e74  sition` argument
-00004390: 0a61 6e64 2074 6865 2070 6f73 6974 696f  .and the positio
-000043a0: 6e20 6f66 2074 6865 206c 6173 7420 7265  n of the last re
-000043b0: 636f 7264 6564 2065 7665 6e74 2069 6e20  corded event in 
-000043c0: 6120 7374 7265 616d 2c20 7468 656e 2061  a stream, then a
-000043d0: 6e20 6045 7870 6563 7465 6450 6f73 6974  n `ExpectedPosit
-000043e0: 696f 6e45 7272 6f72 600a 6578 6365 7074  ionError`.except
-000043f0: 696f 6e20 7769 6c6c 2062 6520 7261 6973  ion will be rais
-00004400: 6564 2e20 5468 6973 2065 6666 6563 7469  ed. This effecti
-00004410: 7665 6c79 2061 6363 6f6d 706c 6973 6865  vely accomplishe
-00004420: 7320 6f70 7469 6d69 7374 6963 2063 6f6e  s optimistic con
-00004430: 6375 7272 656e 6379 2063 6f6e 7472 6f6c  currency control
-00004440: 2e0a 0a49 6620 796f 7520 7769 7368 2074  ...If you wish t
-00004450: 6f20 6469 7361 626c 6520 6f70 7469 6d69  o disable optimi
-00004460: 7374 6963 2063 6f6e 6375 7272 656e 6379  stic concurrency
-00004470: 2063 6f6e 7472 6f6c 2077 6865 6e20 6170   control when ap
-00004480: 7065 6e64 696e 6720 6e65 7720 6576 656e  pending new even
-00004490: 7473 2c20 796f 750a 6361 6e20 7365 7420  ts, you.can set 
-000044a0: 7468 6520 6065 7870 6563 7465 645f 706f  the `expected_po
-000044b0: 7369 7469 6f6e 6020 746f 2061 206e 6567  sition` to a neg
-000044c0: 6174 6976 6520 696e 7465 6765 722e 0a0a  ative integer...
-000044d0: 4966 2079 6f75 206e 6565 6420 746f 2064  If you need to d
-000044e0: 6973 636f 7665 7220 7468 6520 6375 7272  iscover the curr
-000044f0: 656e 7420 706f 7369 7469 6f6e 206f 6620  ent position of 
-00004500: 7468 6520 6c61 7374 2072 6563 6f72 6465  the last recorde
-00004510: 6420 6576 656e 7420 696e 2061 2073 7472  d event in a str
-00004520: 6561 6d2c 0a79 6f75 2063 616e 2075 7365  eam,.you can use
-00004530: 2074 6865 2060 6765 745f 7374 7265 616d   the `get_stream
-00004540: 5f70 6f73 6974 696f 6e28 2960 206d 6574  _position()` met
-00004550: 686f 6420 2873 6565 2062 656c 6f77 292e  hod (see below).
-00004560: 0a0a 506c 6561 7365 206e 6f74 652c 2074  ..Please note, t
-00004570: 6865 2061 7070 656e 6420 6576 656e 7473  he append events
-00004580: 206f 7065 7261 7469 6f6e 2069 7320 6174   operation is at
-00004590: 6f6d 6963 2c20 736f 2074 6861 7420 6569  omic, so that ei
-000045a0: 7468 6572 2061 6c6c 0a6f 7220 6e6f 6e65  ther all.or none
-000045b0: 206f 6620 7468 6520 6769 7665 6e20 6e65   of the given ne
-000045c0: 7720 6576 656e 7473 2077 696c 6c20 6265  w events will be
-000045d0: 2072 6563 6f72 6465 642e 2042 7920 6465   recorded. By de
-000045e0: 7369 676e 2c20 6974 2069 7320 6f6e 6c79  sign, it is only
-000045f0: 0a70 6f73 7369 626c 6520 7769 7468 2045  .possible with E
-00004600: 7665 6e74 5374 6f72 6544 4220 746f 2061  ventStoreDB to a
-00004610: 746f 6d69 6361 6c6c 7920 7265 636f 7264  tomically record
-00004620: 206e 6577 2065 7665 6e74 7320 696e 206f   new events in o
-00004630: 6e65 2073 7472 6561 6d2e 0a0a 496e 2074  ne stream...In t
-00004640: 6865 2065 7861 6d70 6c65 2062 656c 6f77  he example below
-00004650: 2c20 6120 6e65 7720 6576 656e 7420 6973  , a new event is
-00004660: 2061 7070 656e 6465 6420 746f 2061 206e   appended to a n
-00004670: 6577 2073 7472 6561 6d2e 0a0a 6060 6070  ew stream...```p
-00004680: 7974 686f 6e0a 6672 6f6d 2075 7569 6420  ython.from uuid 
-00004690: 696d 706f 7274 2075 7569 6434 0a0a 6672  import uuid4..fr
-000046a0: 6f6d 2065 7364 6263 6c69 656e 7420 696d  om esdbclient im
-000046b0: 706f 7274 204e 6577 4576 656e 740a 0a23  port NewEvent..#
-000046c0: 2043 6f6e 7374 7275 6374 206e 6577 2065   Construct new e
-000046d0: 7665 6e74 206f 626a 6563 742e 0a65 7665  vent object..eve
-000046e0: 6e74 3120 3d20 4e65 7745 7665 6e74 2874  nt1 = NewEvent(t
-000046f0: 7970 653d 274f 7264 6572 4372 6561 7465  ype='OrderCreate
-00004700: 6427 2c20 6461 7461 3d62 2764 6174 6131  d', data=b'data1
-00004710: 2729 0a0a 2320 4465 6669 6e65 2073 7472  ')..# Define str
-00004720: 6561 6d20 6e61 6d65 2e0a 7374 7265 616d  eam name..stream
-00004730: 5f6e 616d 6531 203d 2073 7472 2875 7569  _name1 = str(uui
-00004740: 6434 2829 290a 0a23 2041 7070 656e 6420  d4())..# Append 
-00004750: 6c69 7374 206f 6620 6576 656e 7473 2074  list of events t
-00004760: 6f20 6e65 7720 7374 7265 616d 2e0a 636f  o new stream..co
-00004770: 6d6d 6974 5f70 6f73 6974 696f 6e31 203d  mmit_position1 =
-00004780: 2063 6c69 656e 742e 6170 7065 6e64 5f65   client.append_e
-00004790: 7665 6e74 7328 0a20 2020 2073 7472 6561  vents(.    strea
-000047a0: 6d5f 6e61 6d65 3d73 7472 6561 6d5f 6e61  m_name=stream_na
-000047b0: 6d65 312c 0a20 2020 2065 7870 6563 7465  me1,.    expecte
-000047c0: 645f 706f 7369 7469 6f6e 3d4e 6f6e 652c  d_position=None,
-000047d0: 0a20 2020 2065 7665 6e74 733d 5b65 7665  .    events=[eve
-000047e0: 6e74 315d 2c0a 290a 6060 600a 0a49 6e20  nt1],.).```..In 
-000047f0: 7468 6520 6578 616d 706c 6520 6265 6c6f  the example belo
-00004800: 772c 2074 776f 2073 7562 7365 7175 656e  w, two subsequen
-00004810: 7420 6576 656e 7473 2061 7265 2061 7070  t events are app
-00004820: 656e 6465 6420 746f 2061 6e20 6578 6973  ended to an exis
-00004830: 7469 6e67 0a73 7472 6561 6d2e 0a0a 6060  ting.stream...``
-00004840: 6070 7974 686f 6e0a 6576 656e 7432 203d  `python.event2 =
-00004850: 204e 6577 4576 656e 7428 7479 7065 3d27   NewEvent(type='
-00004860: 4f72 6465 7255 7064 6174 6564 272c 2064  OrderUpdated', d
-00004870: 6174 613d 6227 6461 7461 3227 290a 6576  ata=b'data2').ev
-00004880: 656e 7433 203d 204e 6577 4576 656e 7428  ent3 = NewEvent(
-00004890: 7479 7065 3d27 4f72 6465 7244 656c 6574  type='OrderDelet
-000048a0: 6564 272c 2064 6174 613d 6227 6461 7461  ed', data=b'data
-000048b0: 3327 290a 0a63 6f6d 6d69 745f 706f 7369  3')..commit_posi
-000048c0: 7469 6f6e 3220 3d20 636c 6965 6e74 2e61  tion2 = client.a
-000048d0: 7070 656e 645f 6576 656e 7473 280a 2020  ppend_events(.  
-000048e0: 2020 7374 7265 616d 5f6e 616d 653d 7374    stream_name=st
-000048f0: 7265 616d 5f6e 616d 6531 2c0a 2020 2020  ream_name1,.    
-00004900: 6578 7065 6374 6564 5f70 6f73 6974 696f  expected_positio
-00004910: 6e3d 302c 0a20 2020 2065 7665 6e74 733d  n=0,.    events=
-00004920: 5b65 7665 6e74 322c 2065 7665 6e74 335d  [event2, event3]
-00004930: 2c0a 290a 6060 600a 0a49 6620 7468 6520  ,.).```..If the 
-00004940: 6f70 6572 6174 696f 6e20 6973 2073 7563  operation is suc
-00004950: 6365 7373 6675 6c2c 2074 6869 7320 6d65  cessful, this me
-00004960: 7468 6f64 2072 6574 7572 6e73 2061 6e20  thod returns an 
-00004970: 696e 7465 6765 720a 7265 7072 6573 656e  integer.represen
-00004980: 7469 6e67 2074 6865 206f 7665 7261 6c6c  ting the overall
-00004990: 2022 636f 6d6d 6974 2070 6f73 6974 696f   "commit positio
-000049a0: 6e22 2061 7320 6974 2077 6173 2077 6865  n" as it was whe
-000049b0: 6e20 7468 6520 6f70 6572 6174 696f 6e0a  n the operation.
-000049c0: 7761 7320 636f 6d70 6c65 7465 642e 204f  was completed. O
-000049d0: 7468 6572 7769 7365 2c20 616e 2065 7863  therwise, an exc
-000049e0: 6570 7469 6f6e 2077 696c 6c20 6265 2072  eption will be r
-000049f0: 6169 7365 642e 0a0a 4120 2263 6f6d 6d69  aised...A "commi
-00004a00: 7420 706f 7369 7469 6f6e 2220 6973 2061  t position" is a
-00004a10: 206d 6f6e 6f74 6f6e 6963 616c 6c79 2069   monotonically i
-00004a20: 6e63 7265 6173 696e 6720 696e 7465 6765  ncreasing intege
-00004a30: 7220 7265 7072 6573 656e 7469 6e67 0a74  r representing.t
-00004a40: 6865 2070 6f73 6974 696f 6e20 6f66 2074  he position of t
-00004a50: 6865 2072 6563 6f72 6465 6420 6576 656e  he recorded even
-00004a60: 7420 696e 2061 2022 746f 7461 6c20 6f72  t in a "total or
-00004a70: 6465 7222 206f 6620 616c 6c20 7265 636f  der" of all reco
-00004a80: 7264 6564 0a65 7665 6e74 7320 696e 2074  rded.events in t
-00004a90: 6865 2064 6174 6162 6173 6520 6163 726f  he database acro
-00004aa0: 7373 2061 6c6c 2073 7472 6561 6d73 2e20  ss all streams. 
-00004ab0: 4974 2069 7320 7468 6520 6163 7475 616c  It is the actual
-00004ac0: 2070 6f73 6974 696f 6e0a 6f66 2074 6865   position.of the
-00004ad0: 2065 7665 6e74 2072 6563 6f72 6420 6f6e   event record on
-00004ae0: 2064 6973 6b2c 2061 6e64 2074 6865 7265   disk, and there
-00004af0: 2061 7265 2075 7375 616c 6c79 206c 6172   are usually lar
-00004b00: 6765 2064 6966 6665 7265 6e63 6573 0a62  ge differences.b
-00004b10: 6574 7765 656e 2073 7563 6365 7373 6976  etween successiv
-00004b20: 6520 636f 6d6d 6974 732e 2049 6e20 636f  e commits. In co
-00004b30: 6e73 6571 7565 6e63 652c 2074 6865 2073  nsequence, the s
-00004b40: 6571 7565 6e63 6520 6f66 2063 6f6d 6d69  equence of commi
-00004b50: 740a 706f 7369 7469 6f6e 7320 6973 206e  t.positions is n
-00004b60: 6f74 2067 6170 6c65 7373 2e20 496e 6465  ot gapless. Inde
-00004b70: 6564 2c20 7468 6572 6520 6172 6520 7573  ed, there are us
-00004b80: 7561 6c6c 7920 6c61 7267 6520 6469 6666  ually large diff
-00004b90: 6572 656e 6365 730a 6265 7477 6565 6e20  erences.between 
-00004ba0: 7468 6520 636f 6d6d 6974 2070 6f73 6974  the commit posit
-00004bb0: 696f 6e73 206f 6620 7375 6363 6573 7369  ions of successi
-00004bc0: 7665 2072 6563 6f72 6465 6420 6576 656e  ve recorded even
-00004bd0: 7473 2e0a 0a54 6865 2022 636f 6d6d 6974  ts...The "commit
-00004be0: 2070 6f73 6974 696f 6e22 2072 6574 7572   position" retur
-00004bf0: 6e65 6420 6279 2060 6170 7065 6e64 5f65  ned by `append_e
-00004c00: 7665 6e74 7328 2960 2069 7320 7468 6174  vents()` is that
-00004c10: 206f 6620 7468 6520 6c61 7374 0a72 6563   of the last.rec
-00004c20: 6f72 6465 6420 6576 656e 7420 696e 2074  orded event in t
-00004c30: 6865 2067 6976 656e 2062 6174 6368 206f  he given batch o
-00004c40: 6620 6e65 7720 6576 656e 7473 2e0a 0a54  f new events...T
-00004c50: 6865 2022 636f 6d6d 6974 2070 6f73 6974  he "commit posit
-00004c60: 696f 6e22 2072 6574 7572 6e65 6420 696e  ion" returned in
-00004c70: 2074 6869 7320 7761 7920 6361 6e20 7468   this way can th
-00004c80: 6572 6566 6f72 6520 6265 2075 7365 6420  erefore be used 
-00004c90: 746f 2077 6169 740a 666f 7220 6120 646f  to wait.for a do
-00004ca0: 776e 7374 7265 616d 2063 6f6d 706f 6e65  wnstream compone
-00004cb0: 6e74 2074 6f20 6861 7665 2070 726f 6365  nt to have proce
-00004cc0: 7373 6564 2061 6c6c 2074 6865 2065 7665  ssed all the eve
-00004cd0: 6e74 7320 7468 6174 2077 6572 6520 7265  nts that were re
-00004ce0: 636f 7264 6564 2e0a 0a46 6f72 2065 7861  corded...For exa
-00004cf0: 6d70 6c65 2c20 636f 6e73 6964 6572 2061  mple, consider a
-00004d00: 2075 7365 7220 696e 7465 7266 6163 6520   user interface 
-00004d10: 636f 6d6d 616e 6420 7468 6174 2072 6573  command that res
-00004d20: 756c 7473 2069 6e20 7468 6520 7265 636f  ults in the reco
-00004d30: 7264 696e 670a 6f66 206e 6577 2065 7665  rding.of new eve
-00004d40: 6e74 732c 2061 6e64 2061 2071 7565 7279  nts, and a query
-00004d50: 2069 6e74 6f20 616e 2065 7665 6e74 7561   into an eventua
-00004d60: 6c6c 7920 636f 6e73 6973 7465 6e74 206d  lly consistent m
-00004d70: 6174 6572 6961 6c69 7a65 640a 7669 6577  aterialized.view
-00004d80: 2069 6e20 6120 646f 776e 7374 7265 616d   in a downstream
-00004d90: 2063 6f6d 706f 6e65 6e74 2074 6861 7420   component that 
-00004da0: 6973 2075 7064 6174 6564 2066 726f 6d20  is updated from 
-00004db0: 7468 6573 6520 6576 656e 7473 2e20 4966  these events. If
-00004dc0: 2074 6865 206e 6577 0a65 7665 6e74 7320   the new.events 
-00004dd0: 6861 7665 206e 6f74 2079 6574 2062 6565  have not yet bee
-00004de0: 6e20 7072 6f63 6573 7365 642c 2074 6865  n processed, the
-00004df0: 2076 6965 7720 776f 756c 6420 6265 2073   view would be s
-00004e00: 7461 6c65 2e20 5468 6520 2263 6f6d 6d69  tale. The "commi
-00004e10: 7420 706f 7369 7469 6f6e 220a 6361 6e20  t position".can 
-00004e20: 6265 2075 7365 6420 6279 2074 6865 2075  be used by the u
-00004e30: 7365 7220 696e 7465 7266 6163 6520 746f  ser interface to
-00004e40: 2070 6f6c 6c20 7468 6520 646f 776e 7374   poll the downst
-00004e50: 7265 616d 2063 6f6d 706f 6e65 6e74 2075  ream component u
-00004e60: 6e74 696c 2069 7420 6861 730a 7072 6f63  ntil it has.proc
-00004e70: 6573 7365 6420 7468 6f73 6520 6e65 7720  essed those new 
-00004e80: 6576 656e 7473 2c20 6166 7465 7220 7768  events, after wh
-00004e90: 6963 6820 7469 6d65 2074 6865 2076 6965  ich time the vie
-00004ea0: 7720 7769 6c6c 206e 6f74 2062 6520 7374  w will not be st
-00004eb0: 616c 652e 0a0a 0a23 2323 2041 7070 656e  ale....### Appen
-00004ec0: 6420 6576 656e 740a 0a2a 7265 7175 6972  d event..*requir
-00004ed0: 6573 206c 6561 6465 722a 0a0a 5468 6520  es leader*..The 
-00004ee0: 6061 7070 656e 645f 6576 656e 7428 2960  `append_event()`
-00004ef0: 206d 6574 686f 6420 6361 6e20 6265 2075   method can be u
-00004f00: 7365 6420 746f 2077 7269 7465 2061 2073  sed to write a s
-00004f10: 696e 676c 6520 6e65 7720 6576 656e 7420  ingle new event 
-00004f20: 746f 2061 2073 7472 6561 6d2e 0a0a 5468  to a stream...Th
-00004f30: 7265 6520 6172 6775 6d65 6e74 7320 6172  ree arguments ar
-00004f40: 6520 7265 7175 6972 6564 2c20 6073 7472  e required, `str
-00004f50: 6561 6d5f 6e61 6d65 602c 2060 6578 7065  eam_name`, `expe
-00004f60: 6374 6564 5f70 6f73 6974 696f 6e60 2061  cted_position` a
-00004f70: 6e64 2060 6576 656e 7460 2e0a 0a54 6869  nd `event`...Thi
-00004f80: 7320 6d65 7468 6f64 2077 6f72 6b73 2069  s method works i
-00004f90: 6e20 7468 6520 7361 6d65 2077 6179 2061  n the same way a
-00004fa0: 7320 6061 7070 656e 645f 6576 656e 7473  s `append_events
-00004fb0: 2829 602c 2068 6f77 6576 6572 2060 6576  ()`, however `ev
-00004fc0: 656e 7460 2069 7320 6578 7065 6374 6564  ent` is expected
-00004fd0: 0a74 6f20 6265 2061 2073 696e 676c 6520  .to be a single 
-00004fe0: 604e 6577 4576 656e 7460 2e0a 0a54 6869  `NewEvent`...Thi
-00004ff0: 7320 6d65 7468 6f64 2074 616b 6573 2061  s method takes a
-00005000: 6e20 6f70 7469 6f6e 616c 2060 7469 6d65  n optional `time
-00005010: 6f75 7460 2061 7267 756d 656e 742c 2077  out` argument, w
-00005020: 6869 6368 2069 7320 6120 5079 7468 6f6e  hich is a Python
-00005030: 2060 666c 6f61 7460 2074 6861 7420 7365   `float` that se
-00005040: 7473 0a61 2064 6561 646c 696e 6520 666f  ts.a deadline fo
-00005050: 7220 7468 6520 636f 6d70 6c65 7469 6f6e  r the completion
-00005060: 206f 6620 7468 6520 6752 5043 206f 7065   of the gRPC ope
-00005070: 7261 7469 6f6e 2e0a 0a53 696e 6365 2074  ration...Since t
-00005080: 6865 2068 616e 646c 696e 6720 6f66 2061  he handling of a
-00005090: 2063 6f6d 6d61 6e64 2069 6e20 796f 7572   command in your
-000050a0: 2061 7070 6c69 6361 7469 6f6e 206d 6179   application may
-000050b0: 2072 6573 756c 7420 696e 206f 6e65 206f   result in one o
-000050c0: 7220 6d61 6e79 0a6e 6577 2065 7665 6e74  r many.new event
-000050d0: 732c 2061 6e64 2074 6865 2072 6573 756c  s, and the resul
-000050e0: 7473 206f 6620 6861 6e64 6c69 6e67 2061  ts of handling a
-000050f0: 2063 6f6d 6d61 6e64 2073 686f 756c 6420   command should 
-00005100: 6265 2072 6563 6f72 6465 6420 6174 6f6d  be recorded atom
-00005110: 6963 616c 6c79 2c0a 616e 6420 7468 6520  ically,.and the 
-00005120: 7772 6974 696e 6720 6f66 206e 6577 2065  writing of new e
-00005130: 7665 6e74 7320 6765 6e65 7261 7465 6420  vents generated 
-00005140: 6279 2061 2063 6f6d 6d61 6e64 2068 616e  by a command han
-00005150: 646c 6572 2069 7320 7573 7561 6c6c 7920  dler is usually 
-00005160: 6120 636f 6e63 6572 6e0a 7468 6174 2069  a concern.that i
-00005170: 7320 6661 6374 6f72 6564 206f 7574 2061  s factored out a
-00005180: 6e64 2075 7365 6420 6576 6572 7977 6865  nd used everywhe
-00005190: 7265 2069 6e20 6120 7072 6f6a 6563 742c  re in a project,
-000051a0: 2069 7420 6973 2071 7569 7465 2075 7375   it is quite usu
-000051b0: 616c 2069 6e20 6120 7072 6f6a 6563 740a  al in a project.
-000051c0: 746f 206f 6e6c 7920 7573 6520 6061 7070  to only use `app
-000051d0: 656e 645f 6576 656e 7473 2829 6020 746f  end_events()` to
-000051e0: 2072 6563 6f72 6420 6e65 7720 6576 656e   record new even
-000051f0: 7473 2e20 466f 7220 7468 6973 2072 6561  ts. For this rea
-00005200: 736f 6e2c 2061 6e20 6578 616d 706c 6520  son, an example 
-00005210: 6973 0a6e 6f74 2070 726f 7669 6465 6420  is.not provided 
-00005220: 6865 7265 2e0a 0a0a 2323 2320 4964 656d  here....### Idem
-00005230: 706f 7465 6e74 2061 7070 656e 6420 6f70  potent append op
-00005240: 6572 6174 696f 6e73 0a0a 536f 6d65 7469  erations..Someti
-00005250: 6d65 7320 6974 206d 6179 2068 6170 7065  mes it may happe
-00005260: 6e20 7468 6174 2061 206e 6577 2065 7665  n that a new eve
-00005270: 6e74 2069 7320 7375 6363 6573 7366 756c  nt is successful
-00005280: 6c79 2072 6563 6f72 6465 6420 616e 6420  ly recorded and 
-00005290: 7468 656e 2073 6f6d 6568 6f77 0a74 6865  then somehow.the
-000052a0: 2063 6f6e 6e65 6374 696f 6e20 746f 2074   connection to t
-000052b0: 6865 2064 6174 6162 6173 6520 6765 7473  he database gets
-000052c0: 2069 6e74 6572 7275 7074 6564 2062 6566   interrupted bef
-000052d0: 6f72 6520 7468 6520 7375 6363 6573 7366  ore the successf
-000052e0: 756c 2063 616c 6c20 6361 6e20 7265 7475  ul call can retu
-000052f0: 726e 0a73 7563 6365 7373 6675 6c6c 7920  rn.successfully 
-00005300: 746f 2074 6865 2063 6c69 656e 742e 2049  to the client. I
-00005310: 6e20 6361 7365 206f 6620 616e 2065 7272  n case of an err
-00005320: 6f72 2077 6865 6e20 6170 7065 6e64 696e  or when appendin
-00005330: 6720 616e 2065 7665 6e74 2c20 6974 206d  g an event, it m
-00005340: 6179 2062 650a 6465 7369 7261 626c 6520  ay be.desirable 
-00005350: 746f 2072 6574 7279 2061 7070 656e 6469  to retry appendi
-00005360: 6e67 2074 6865 2073 616d 6520 6576 656e  ng the same even
-00005370: 7420 6174 2074 6865 2073 616d 6520 706f  t at the same po
-00005380: 7369 7469 6f6e 2e20 4966 2074 6865 2065  sition. If the e
-00005390: 7665 6e74 2077 6173 0a69 6e20 6661 6374  vent was.in fact
-000053a0: 2073 7563 6365 7373 6675 6c6c 7920 7265   successfully re
-000053b0: 636f 7264 6564 2c20 6974 2069 7320 636f  corded, it is co
-000053c0: 6e76 656e 6965 6e74 2066 6f72 2074 6865  nvenient for the
-000053d0: 2072 6574 7279 2074 6f20 7265 7475 726e   retry to return
-000053e0: 2073 7563 6365 7373 6675 6c6c 790a 7769   successfully.wi
-000053f0: 7468 6f75 7420 7261 6973 696e 6720 616e  thout raising an
-00005400: 2065 7272 6f72 2064 7565 2074 6f20 6f70   error due to op
-00005410: 7469 6d69 7374 6963 2063 6f6e 6375 7272  timistic concurr
-00005420: 656e 6379 2063 6f6e 7472 6f6c 2028 6173  ency control (as
-00005430: 2064 6573 6372 6962 6564 2061 626f 7665   described above
-00005440: 292e 0a0a 5468 6520 6578 616d 706c 6520  )...The example 
-00005450: 6265 6c6f 7720 7368 6f77 7320 7468 6520  below shows the 
-00005460: 6061 7070 656e 645f 6576 656e 7473 2829  `append_events()
-00005470: 6020 6d65 7468 6f64 2062 6569 6e67 2063  ` method being c
-00005480: 616c 6c65 6420 6167 6169 6e20 7769 7468  alled again with
-00005490: 0a60 6576 656e 7433 6020 616e 6420 6065  .`event3` and `e
-000054a0: 7870 6563 7465 645f 706f 7369 7469 6f6e  xpected_position
-000054b0: 3d32 602e 2057 6520 6361 6e20 7365 6520  =2`. We can see 
-000054c0: 7468 6174 2072 6570 6561 7469 6e67 2074  that repeating t
-000054d0: 6865 2063 616c 6c20 746f 0a60 6170 7065  he call to.`appe
-000054e0: 6e64 5f65 7665 6e74 7328 2960 2072 6574  nd_events()` ret
-000054f0: 7572 6e73 2073 7563 6365 7373 6675 6c6c  urns successfull
-00005500: 792e 0a0a 6060 6070 7974 686f 6e0a 2320  y...```python.# 
-00005510: 5265 7472 7920 6170 7065 6e64 696e 6720  Retry appending 
-00005520: 6576 656e 7433 2e0a 636f 6d6d 6974 5f70  event3..commit_p
-00005530: 6f73 6974 696f 6e5f 7265 7472 7920 3d20  osition_retry = 
-00005540: 636c 6965 6e74 2e61 7070 656e 645f 6576  client.append_ev
-00005550: 656e 7473 280a 2020 2020 7374 7265 616d  ents(.    stream
-00005560: 5f6e 616d 653d 7374 7265 616d 5f6e 616d  _name=stream_nam
-00005570: 6531 2c0a 2020 2020 6578 7065 6374 6564  e1,.    expected
-00005580: 5f70 6f73 6974 696f 6e3d 302c 0a20 2020  _position=0,.   
-00005590: 2065 7665 6e74 733d 5b65 7665 6e74 322c   events=[event2,
-000055a0: 2065 7665 6e74 335d 2c0a 290a 6060 600a   event3],.).```.
-000055b0: 0a57 6520 6361 6e20 7365 6520 7468 6174  .We can see that
-000055c0: 2074 6865 2073 616d 6520 636f 6d6d 6974   the same commit
-000055d0: 2070 6f73 6974 696f 6e20 6973 2072 6574   position is ret
-000055e0: 7572 6e65 6420 6173 2061 626f 7665 2e0a  urned as above..
-000055f0: 0a60 6060 7079 7468 6f6e 0a61 7373 6572  .```python.asser
-00005600: 7420 636f 6d6d 6974 5f70 6f73 6974 696f  t commit_positio
-00005610: 6e5f 7265 7472 7920 3d3d 2063 6f6d 6d69  n_retry == commi
-00005620: 745f 706f 7369 7469 6f6e 320a 6060 600a  t_position2.```.
-00005630: 0a42 7920 6361 6c6c 696e 6720 6072 6561  .By calling `rea
-00005640: 645f 7374 7265 616d 5f65 7665 6e74 7328  d_stream_events(
-00005650: 2960 2c20 7765 2063 616e 2061 6c73 6f20  )`, we can also 
-00005660: 7365 6520 7468 6520 7374 7265 616d 2068  see the stream h
-00005670: 6173 2062 6565 6e20 756e 6368 616e 6765  as been unchange
-00005680: 640a 6465 7370 6974 6520 7468 6520 6061  d.despite the `a
-00005690: 7070 656e 645f 6576 656e 7473 2829 6020  ppend_events()` 
-000056a0: 6d65 7468 6f64 2068 6176 696e 6720 6265  method having be
-000056b0: 656e 2063 616c 6c65 6420 7477 6963 6520  en called twice 
-000056c0: 7769 7468 2074 6865 2073 616d 6520 6172  with the same ar
-000056d0: 6775 6d65 6e74 732e 0a54 6861 7420 6973  guments..That is
-000056e0: 2c20 7468 6572 6520 6172 6520 7374 696c  , there are stil
-000056f0: 6c20 6f6e 6c79 2074 6872 6565 2065 7665  l only three eve
-00005700: 6e74 7320 696e 2074 6865 2073 7472 6561  nts in the strea
-00005710: 6d2e 0a0a 6060 6070 7974 686f 6e0a 6576  m...```python.ev
-00005720: 656e 7473 203d 2063 6c69 656e 742e 7265  ents = client.re
-00005730: 6164 5f73 7472 6561 6d5f 6576 656e 7473  ad_stream_events
-00005740: 280a 2020 2020 7374 7265 616d 5f6e 616d  (.    stream_nam
-00005750: 653d 7374 7265 616d 5f6e 616d 6531 0a29  e=stream_name1.)
-00005760: 0a0a 6173 7365 7274 206c 656e 2865 7665  ..assert len(eve
-00005770: 6e74 7329 203d 3d20 330a 6060 600a 0a54  nts) == 3.```..T
-00005780: 6869 7320 6964 656d 706f 7465 6e74 2062  his idempotent b
-00005790: 6568 6176 696f 7572 2069 7320 6163 7469  ehaviour is acti
-000057a0: 7661 7465 6420 6265 6361 7573 6520 7468  vated because th
-000057b0: 6520 604e 6577 4576 656e 7460 2063 6c61  e `NewEvent` cla
-000057c0: 7373 2068 6173 2061 6e20 6069 6460 0a61  ss has an `id`.a
-000057d0: 7474 7269 6275 7465 2074 6861 742c 2062  ttribute that, b
-000057e0: 7920 6465 6661 756c 742c 2069 7320 6173  y default, is as
-000057f0: 7369 676e 6564 2061 206e 6577 2061 6e64  signed a new and
-00005800: 2075 6e69 7175 6520 7665 7273 696f 6e2d   unique version-
-00005810: 3420 5555 4944 2077 6865 6e20 616e 0a69  4 UUID when an.i
-00005820: 6e73 7461 6e63 6520 6f66 2060 4e65 7745  nstance of `NewE
-00005830: 7665 6e74 6020 6973 2063 6f6e 7374 7275  vent` is constru
-00005840: 6374 6564 2e20 4966 2065 7665 6e74 7320  cted. If events 
-00005850: 7769 7468 2074 6865 2073 616d 6520 6069  with the same `i
-00005860: 6460 2061 7265 2061 7070 656e 6465 640a  d` are appended.
-00005870: 6174 2074 6865 2073 616d 6520 6065 7870  at the same `exp
-00005880: 6563 7465 645f 706f 7369 7469 6f6e 602c  ected_position`,
-00005890: 2074 6865 2073 7472 6561 6d20 7769 6c6c   the stream will
-000058a0: 2062 6520 756e 6368 616e 6765 642c 2074   be unchanged, t
-000058b0: 6865 206f 7065 7261 7469 6f6e 2077 696c  he operation wil
-000058c0: 6c0a 636f 6d70 6c65 7465 2073 7563 6365  l.complete succe
-000058d0: 7373 6675 6c6c 792c 2061 6e64 2074 6865  ssfully, and the
-000058e0: 2073 616d 6520 636f 6d6d 6974 2070 6f73   same commit pos
-000058f0: 6974 696f 6e20 7769 6c6c 2062 6520 7265  ition will be re
-00005900: 7475 726e 6564 2074 6f20 7468 6520 6361  turned to the ca
-00005910: 6c6c 6572 2e0a 0a60 6060 7079 7468 6f6e  ller...```python
-00005920: 0a66 726f 6d20 7575 6964 2069 6d70 6f72  .from uuid impor
-00005930: 7420 5555 4944 0a0a 0a61 7373 6572 7420  t UUID...assert 
-00005940: 6973 696e 7374 616e 6365 2865 7665 6e74  isinstance(event
-00005950: 312e 6964 2c20 5555 4944 290a 6173 7365  1.id, UUID).asse
-00005960: 7274 2069 7369 6e73 7461 6e63 6528 6576  rt isinstance(ev
-00005970: 656e 7432 2e69 642c 2055 5549 4429 0a61  ent2.id, UUID).a
-00005980: 7373 6572 7420 6973 696e 7374 616e 6365  ssert isinstance
-00005990: 2865 7665 6e74 332e 6964 2c20 5555 4944  (event3.id, UUID
-000059a0: 290a 0a61 7373 6572 7420 6576 656e 7431  )..assert event1
-000059b0: 2e69 6420 213d 2065 7665 6e74 322e 6964  .id != event2.id
-000059c0: 0a61 7373 6572 7420 6576 656e 7432 2e69  .assert event2.i
-000059d0: 6420 213d 2065 7665 6e74 332e 6964 0a0a  d != event3.id..
-000059e0: 6173 7365 7274 2065 7665 6e74 735b 305d  assert events[0]
-000059f0: 2e69 6420 3d3d 2065 7665 6e74 312e 6964  .id == event1.id
-00005a00: 0a61 7373 6572 7420 6576 656e 7473 5b31  .assert events[1
-00005a10: 5d2e 6964 203d 3d20 6576 656e 7432 2e69  ].id == event2.i
-00005a20: 640a 6173 7365 7274 2065 7665 6e74 735b  d.assert events[
-00005a30: 325d 2e69 6420 3d3d 2065 7665 6e74 332e  2].id == event3.
-00005a40: 6964 0a60 6060 0a0a 4974 2069 7320 706f  id.```..It is po
-00005a50: 7373 6962 6c65 2074 6f20 7365 7420 7468  ssible to set th
-00005a60: 6520 6069 6460 2063 6f6e 7374 7275 6374  e `id` construct
-00005a70: 6f72 2061 7267 756d 656e 7420 6f66 2060  or argument of `
-00005a80: 4e65 7745 7665 6e74 6020 7768 656e 2069  NewEvent` when i
-00005a90: 6e73 7461 6e74 6961 7469 6e67 0a74 6865  nstantiating.the
-00005aa0: 2060 4e65 7745 7665 6e74 6020 636c 6173   `NewEvent` clas
-00005ab0: 732c 2062 7574 2069 6e20 7468 6520 6578  s, but in the ex
-00005ac0: 616d 706c 6573 2061 626f 7665 2077 6520  amples above we 
-00005ad0: 6861 7665 2062 6565 6e20 7573 696e 6720  have been using 
-00005ae0: 7468 6520 6465 6661 756c 740a 6265 6861  the default.beha
-00005af0: 7669 6f75 722c 2077 6869 6368 2069 7320  viour, which is 
-00005b00: 7468 6174 2074 6865 2060 6964 6020 7661  that the `id` va
-00005b10: 6c75 6520 6973 2067 656e 6572 6174 6564  lue is generated
-00005b20: 2077 6865 6e20 7468 6520 604e 6577 4576   when the `NewEv
-00005b30: 656e 7460 2063 6c61 7373 2069 730a 696e  ent` class is.in
-00005b40: 7374 616e 7469 6174 6564 2e0a 0a0a 2323  stantiated....##
-00005b50: 2320 5265 6164 2073 7472 6561 6d20 6576  # Read stream ev
-00005b60: 656e 7473 0a0a 5468 6520 6072 6561 645f  ents..The `read_
-00005b70: 7374 7265 616d 5f65 7665 6e74 7328 2960  stream_events()`
-00005b80: 206d 6574 686f 6420 6361 6e20 6265 2075   method can be u
-00005b90: 7365 6420 746f 206f 6274 6169 6e20 7468  sed to obtain th
-00005ba0: 6520 7265 636f 7264 6564 2065 7665 6e74  e recorded event
-00005bb0: 7320 696e 2061 0a73 7472 6561 6d2e 2049  s in a.stream. I
-00005bc0: 7420 7265 7475 726e 7320 6120 7365 7175  t returns a sequ
-00005bd0: 656e 6365 206f 6620 7265 636f 7264 6564  ence of recorded
-00005be0: 2065 7665 6e74 7320 6f62 6a65 6374 732e   events objects.
-00005bf0: 2054 6865 2072 6563 6569 7665 6420 7265   The received re
-00005c00: 636f 7264 6564 2065 7665 6e74 0a6f 626a  corded event.obj
-00005c10: 6563 7420 6172 6520 696e 7374 616e 6365  ect are instance
-00005c20: 7320 6f66 2074 6865 2060 5265 636f 7264  s of the `Record
-00005c30: 6564 4576 656e 7460 2063 6c61 7373 2028  edEvent` class (
-00005c40: 7365 6520 6265 6c6f 7729 2e0a 0a54 6869  see below)...Thi
-00005c50: 7320 6d65 7468 6f64 2068 6173 206f 6e65  s method has one
-00005c60: 2072 6571 7569 7265 6420 6172 6775 6d65   required argume
-00005c70: 6e74 2c20 6073 7472 6561 6d5f 6e61 6d65  nt, `stream_name
-00005c80: 602c 2077 6869 6368 2069 7320 7468 6520  `, which is the 
-00005c90: 6e61 6d65 206f 660a 7468 6520 7374 7265  name of.the stre
-00005ca0: 616d 2066 726f 6d20 7768 6963 6820 746f  am from which to
-00005cb0: 2072 6561 6420 6576 656e 7473 2e20 4279   read events. By
-00005cc0: 2064 6566 6175 6c74 2c20 7468 6520 7265   default, the re
-00005cd0: 636f 7264 6564 2065 7665 6e74 7320 696e  corded events in
-00005ce0: 2074 6865 0a73 7472 6561 6d20 6172 6520   the.stream are 
-00005cf0: 7265 7475 726e 6564 2069 6e20 7468 6520  returned in the 
-00005d00: 6f72 6465 7220 7468 6579 2077 6572 6520  order they were 
-00005d10: 7265 636f 7264 6564 2e0a 0a54 6865 206d  recorded...The m
-00005d20: 6574 686f 6420 6072 6561 645f 7374 7265  ethod `read_stre
-00005d30: 616d 5f65 7665 6e74 7328 2960 2061 6c73  am_events()` als
-00005d40: 6f20 7375 7070 6f72 7473 2066 6f75 7220  o supports four 
-00005d50: 6f70 7469 6f6e 616c 2061 7267 756d 656e  optional argumen
-00005d60: 7473 2c0a 6073 7472 6561 6d5f 706f 7369  ts,.`stream_posi
-00005d70: 7469 6f6e 602c 2060 6261 636b 7761 7264  tion`, `backward
-00005d80: 7360 2c20 606c 696d 6974 602c 2061 6e64  s`, `limit`, and
-00005d90: 2060 7469 6d65 6f75 7460 2e0a 0a54 6865   `timeout`...The
-00005da0: 206f 7074 696f 6e61 6c20 6073 7472 6561   optional `strea
-00005db0: 6d5f 706f 7369 7469 6f6e 6020 6172 6775  m_position` argu
-00005dc0: 6d65 6e74 2069 7320 616e 206f 7074 696f  ment is an optio
-00005dd0: 6e61 6c20 696e 7465 6765 7220 7468 6174  nal integer that
-00005de0: 2063 616e 2062 6520 7573 6564 2074 6f0a   can be used to.
-00005df0: 696e 6469 6361 7465 2074 6865 2070 6f73  indicate the pos
-00005e00: 6974 696f 6e20 696e 2074 6865 2073 7472  ition in the str
-00005e10: 6561 6d20 6672 6f6d 2077 6869 6368 2074  eam from which t
-00005e20: 6f20 7374 6172 7420 7265 6164 696e 672e  o start reading.
-00005e30: 2054 6869 7320 6172 6775 6d65 6e74 2069   This argument i
-00005e40: 730a 604e 6f6e 6560 2062 7920 6465 6661  s.`None` by defa
-00005e50: 756c 742c 2077 6869 6368 206d 6561 6e73  ult, which means
-00005e60: 2074 6865 2073 7472 6561 6d20 7769 6c6c   the stream will
-00005e70: 2062 6520 7265 6164 2065 6974 6865 7220   be read either 
-00005e80: 6672 6f6d 2074 6865 2073 7461 7274 206f  from the start o
-00005e90: 6620 7468 650a 7374 7265 616d 2028 7468  f the.stream (th
-00005ea0: 6520 6465 6661 756c 7420 6265 6861 7669  e default behavi
-00005eb0: 6f75 7229 2c20 6f72 2066 726f 6d20 7468  our), or from th
-00005ec0: 6520 656e 6420 6f66 2074 6865 2073 7472  e end of the str
-00005ed0: 6561 6d20 6966 2060 6261 636b 7761 7264  eam if `backward
-00005ee0: 7360 2069 730a 6054 7275 6560 2028 7365  s` is.`True` (se
-00005ef0: 6520 6265 6c6f 7729 2e20 5768 656e 2072  e below). When r
-00005f00: 6561 6469 6e67 2061 2073 7472 6561 6d20  eading a stream 
-00005f10: 6672 6f6d 2061 2073 7065 6369 6669 6320  from a specific 
-00005f20: 706f 7369 7469 6f6e 2069 6e20 7468 6520  position in the 
-00005f30: 7374 7265 616d 2c20 7468 650a 7265 636f  stream, the.reco
-00005f40: 7264 6564 2065 7665 6e74 2061 7420 7468  rded event at th
-00005f50: 6174 2070 6f73 6974 696f 6e20 7769 6c6c  at position will
-00005f60: 2062 6520 696e 636c 7564 6564 2c20 626f   be included, bo
-00005f70: 7468 2077 6865 6e20 7265 6164 696e 6720  th when reading 
-00005f80: 666f 7277 6172 6473 0a66 726f 6d20 7468  forwards.from th
-00005f90: 6174 2070 6f73 6974 696f 6e2c 2061 6e64  at position, and
-00005fa0: 2077 6865 6e20 7265 6164 696e 6720 6261   when reading ba
-00005fb0: 636b 7761 7264 7320 6672 6f6d 2074 6861  ckwards from tha
-00005fc0: 7420 706f 7369 7469 6f6e 2e0a 0a54 6865  t position...The
-00005fd0: 206f 7074 696f 6e61 6c20 6062 6163 6b77   optional `backw
-00005fe0: 6172 6473 6020 6172 6775 6d65 6e74 2069  ards` argument i
-00005ff0: 7320 6120 626f 6f6c 6561 6e2c 2062 7920  s a boolean, by 
-00006000: 6465 6661 756c 7420 6046 616c 7365 602c  default `False`,
-00006010: 2077 6869 6368 206d 6561 6e73 2074 6865   which means the
-00006020: 0a73 7472 6561 6d20 7769 6c6c 2062 6520  .stream will be 
-00006030: 7265 6164 2066 6f72 7761 7264 7320 6279  read forwards by
-00006040: 2064 6566 6175 6c74 2c20 736f 2074 6861   default, so tha
-00006050: 7420 6576 656e 7473 2061 7265 2072 6574  t events are ret
-00006060: 7572 6e65 6420 696e 2074 6865 0a6f 7264  urned in the.ord
-00006070: 6572 2074 6865 7920 7765 7265 2061 7070  er they were app
-00006080: 656e 6465 642c 2049 6620 6062 6163 6b77  ended, If `backw
-00006090: 6172 6473 6020 6973 2060 5472 7565 602c  ards` is `True`,
-000060a0: 2074 6865 2073 7472 6561 6d20 7769 6c6c   the stream will
-000060b0: 2062 6520 7265 6164 0a62 6163 6b77 6172   be read.backwar
-000060c0: 6473 2c20 736f 2074 6861 7420 6576 656e  ds, so that even
-000060d0: 7473 2061 7265 2072 6574 7572 6e65 6420  ts are returned 
-000060e0: 696e 2072 6576 6572 7365 206f 7264 6572  in reverse order
-000060f0: 2e0a 0a54 6865 206f 7074 696f 6e61 6c20  ...The optional 
-00006100: 606c 696d 6974 6020 6172 6775 6d65 6e74  `limit` argument
-00006110: 2069 7320 616e 2069 6e74 6567 6572 2077   is an integer w
-00006120: 6869 6368 206c 696d 6974 7320 7468 6520  hich limits the 
-00006130: 6e75 6d62 6572 206f 6620 6576 656e 7473  number of events
-00006140: 2074 6861 7420 7769 6c6c 0a62 6520 7265   that will.be re
-00006150: 7475 726e 6564 2e20 5468 6520 6465 6661  turned. The defa
-00006160: 756c 7420 7661 6c75 6520 6973 2060 7379  ult value is `sy
-00006170: 732e 6d61 7869 6e74 602e 0a0a 5468 6520  s.maxint`...The 
-00006180: 6f70 7469 6f6e 616c 2060 7469 6d65 6f75  optional `timeou
-00006190: 7460 2061 7267 756d 656e 7420 6973 2061  t` argument is a
-000061a0: 2050 7974 686f 6e20 6066 6c6f 6174 6020   Python `float` 
-000061b0: 7768 6963 6820 7365 7473 2061 2064 6561  which sets a dea
-000061c0: 646c 696e 6520 666f 720a 7468 6520 636f  dline for.the co
-000061d0: 6d70 6c65 7469 6f6e 206f 6620 7468 6520  mpletion of the 
-000061e0: 6752 5043 206f 7065 7261 7469 6f6e 2e0a  gRPC operation..
-000061f0: 0a54 6865 2065 7861 6d70 6c65 2062 656c  .The example bel
-00006200: 6f77 2073 686f 7773 2068 6f77 2074 6f20  ow shows how to 
-00006210: 7265 6164 2074 6865 2072 6563 6f72 6465  read the recorde
-00006220: 6420 6576 656e 7473 206f 6620 6120 7374  d events of a st
-00006230: 7265 616d 0a66 6f72 7761 7264 7320 6672  ream.forwards fr
-00006240: 6f6d 2074 6865 2073 7461 7274 206f 6620  om the start of 
-00006250: 7468 6520 7374 7265 616d 2074 6f20 7468  the stream to th
-00006260: 6520 656e 6420 6f66 2074 6865 2073 7472  e end of the str
-00006270: 6561 6d2e 2054 6865 0a6e 616d 6520 6f66  eam. The.name of
-00006280: 2061 2073 7472 6561 6d20 6973 2067 6976   a stream is giv
-00006290: 656e 2077 6865 6e20 6361 6c6c 696e 6720  en when calling 
-000062a0: 7468 6520 6d65 7468 6f64 2e0a 0a60 6060  the method...```
-000062b0: 7079 7468 6f6e 0a65 7665 6e74 7320 3d20  python.events = 
-000062c0: 636c 6965 6e74 2e72 6561 645f 7374 7265  client.read_stre
-000062d0: 616d 5f65 7665 6e74 7328 0a20 2020 2073  am_events(.    s
-000062e0: 7472 6561 6d5f 6e61 6d65 3d73 7472 6561  tream_name=strea
-000062f0: 6d5f 6e61 6d65 310a 290a 6060 600a 0a4e  m_name1.).```..N
-00006300: 6f77 2074 6861 7420 7765 2068 6176 6520  ow that we have 
-00006310: 6120 7365 7175 656e 6365 206f 6620 6576  a sequence of ev
-00006320: 656e 7420 6f62 6a65 6374 732c 2077 6520  ent objects, we 
-00006330: 6361 6e20 6368 6563 6b20 7765 2067 6f74  can check we got
-00006340: 2074 6865 0a74 6872 6565 2065 7665 6e74   the.three event
-00006350: 7320 7468 6174 2077 6572 6520 6170 7065  s that were appe
-00006360: 6e64 6564 2074 6f20 7468 6520 7374 7265  nded to the stre
-00006370: 616d 2c20 616e 6420 7468 6174 2074 6865  am, and that the
-00006380: 7920 6172 650a 6f72 6465 7265 6420 6578  y are.ordered ex
-00006390: 6163 746c 7920 6173 2074 6865 7920 7765  actly as they we
-000063a0: 7265 2061 7070 656e 6465 642e 0a0a 6060  re appended...``
-000063b0: 6070 7974 686f 6e0a 6173 7365 7274 206c  `python.assert l
-000063c0: 656e 2865 7665 6e74 7329 203d 3d20 330a  en(events) == 3.
-000063d0: 0a61 7373 6572 7420 6576 656e 7473 5b30  .assert events[0
-000063e0: 5d2e 7374 7265 616d 5f6e 616d 6520 3d3d  ].stream_name ==
-000063f0: 2073 7472 6561 6d5f 6e61 6d65 310a 6173   stream_name1.as
-00006400: 7365 7274 2065 7665 6e74 735b 305d 2e73  sert events[0].s
-00006410: 7472 6561 6d5f 706f 7369 7469 6f6e 203d  tream_position =
-00006420: 3d20 300a 6173 7365 7274 2065 7665 6e74  = 0.assert event
-00006430: 735b 305d 2e74 7970 6520 3d3d 2065 7665  s[0].type == eve
-00006440: 6e74 312e 7479 7065 0a61 7373 6572 7420  nt1.type.assert 
-00006450: 6576 656e 7473 5b30 5d2e 6461 7461 203d  events[0].data =
-00006460: 3d20 6576 656e 7431 2e64 6174 610a 0a61  = event1.data..a
-00006470: 7373 6572 7420 6576 656e 7473 5b31 5d2e  ssert events[1].
-00006480: 7374 7265 616d 5f6e 616d 6520 3d3d 2073  stream_name == s
-00006490: 7472 6561 6d5f 6e61 6d65 310a 6173 7365  tream_name1.asse
-000064a0: 7274 2065 7665 6e74 735b 315d 2e73 7472  rt events[1].str
-000064b0: 6561 6d5f 706f 7369 7469 6f6e 203d 3d20  eam_position == 
-000064c0: 310a 6173 7365 7274 2065 7665 6e74 735b  1.assert events[
-000064d0: 315d 2e74 7970 6520 3d3d 2065 7665 6e74  1].type == event
-000064e0: 322e 7479 7065 0a61 7373 6572 7420 6576  2.type.assert ev
-000064f0: 656e 7473 5b31 5d2e 6461 7461 203d 3d20  ents[1].data == 
-00006500: 6576 656e 7432 2e64 6174 610a 0a61 7373  event2.data..ass
-00006510: 6572 7420 6576 656e 7473 5b32 5d2e 7374  ert events[2].st
-00006520: 7265 616d 5f6e 616d 6520 3d3d 2073 7472  ream_name == str
-00006530: 6561 6d5f 6e61 6d65 310a 6173 7365 7274  eam_name1.assert
-00006540: 2065 7665 6e74 735b 325d 2e73 7472 6561   events[2].strea
-00006550: 6d5f 706f 7369 7469 6f6e 203d 3d20 320a  m_position == 2.
-00006560: 6173 7365 7274 2065 7665 6e74 735b 325d  assert events[2]
-00006570: 2e74 7970 6520 3d3d 2065 7665 6e74 332e  .type == event3.
-00006580: 7479 7065 0a61 7373 6572 7420 6576 656e  type.assert even
-00006590: 7473 5b32 5d2e 6461 7461 203d 3d20 6576  ts[2].data == ev
-000065a0: 656e 7433 2e64 6174 610a 6060 600a 0a54  ent3.data.```..T
-000065b0: 6865 2065 7861 6d70 6c65 2062 656c 6f77  he example below
-000065c0: 2073 686f 7773 2068 6f77 2074 6f20 7265   shows how to re
-000065d0: 6164 2072 6563 6f72 6465 6420 6576 656e  ad recorded even
-000065e0: 7473 2069 6e20 6120 7374 7265 616d 2066  ts in a stream f
-000065f0: 6f72 7761 7264 7320 6672 6f6d 0a61 2073  orwards from.a s
-00006600: 7065 6369 6669 6320 7374 7265 616d 2070  pecific stream p
-00006610: 6f73 6974 696f 6e20 746f 2074 6865 2065  osition to the e
-00006620: 6e64 206f 6620 7468 6520 7374 7265 616d  nd of the stream
-00006630: 2e0a 0a60 6060 7079 7468 6f6e 0a65 7665  ...```python.eve
-00006640: 6e74 7320 3d20 636c 6965 6e74 2e72 6561  nts = client.rea
-00006650: 645f 7374 7265 616d 5f65 7665 6e74 7328  d_stream_events(
-00006660: 0a20 2020 2073 7472 6561 6d5f 6e61 6d65  .    stream_name
-00006670: 3d73 7472 6561 6d5f 6e61 6d65 312c 0a20  =stream_name1,. 
-00006680: 2020 2073 7472 6561 6d5f 706f 7369 7469     stream_positi
-00006690: 6f6e 3d31 2c0a 290a 0a61 7373 6572 7420  on=1,.)..assert 
-000066a0: 6c65 6e28 6576 656e 7473 2920 3d3d 2032  len(events) == 2
-000066b0: 0a0a 6173 7365 7274 2065 7665 6e74 735b  ..assert events[
-000066c0: 305d 2e73 7472 6561 6d5f 6e61 6d65 203d  0].stream_name =
-000066d0: 3d20 7374 7265 616d 5f6e 616d 6531 0a61  = stream_name1.a
-000066e0: 7373 6572 7420 6576 656e 7473 5b30 5d2e  ssert events[0].
-000066f0: 7374 7265 616d 5f70 6f73 6974 696f 6e20  stream_position 
-00006700: 3d3d 2031 0a61 7373 6572 7420 6576 656e  == 1.assert even
-00006710: 7473 5b30 5d2e 7479 7065 203d 3d20 6576  ts[0].type == ev
-00006720: 656e 7432 2e74 7970 650a 6173 7365 7274  ent2.type.assert
-00006730: 2065 7665 6e74 735b 305d 2e64 6174 6120   events[0].data 
-00006740: 3d3d 2065 7665 6e74 322e 6461 7461 0a0a  == event2.data..
-00006750: 6173 7365 7274 2065 7665 6e74 735b 315d  assert events[1]
-00006760: 2e73 7472 6561 6d5f 6e61 6d65 203d 3d20  .stream_name == 
-00006770: 7374 7265 616d 5f6e 616d 6531 0a61 7373  stream_name1.ass
-00006780: 6572 7420 6576 656e 7473 5b31 5d2e 7374  ert events[1].st
-00006790: 7265 616d 5f70 6f73 6974 696f 6e20 3d3d  ream_position ==
-000067a0: 2032 0a61 7373 6572 7420 6576 656e 7473   2.assert events
-000067b0: 5b31 5d2e 7479 7065 203d 3d20 6576 656e  [1].type == even
-000067c0: 7433 2e74 7970 650a 6173 7365 7274 2065  t3.type.assert e
-000067d0: 7665 6e74 735b 315d 2e64 6174 6120 3d3d  vents[1].data ==
-000067e0: 2065 7665 6e74 332e 6461 7461 0a60 6060   event3.data.```
-000067f0: 0a0a 5468 6520 6578 616d 706c 6520 6265  ..The example be
-00006800: 6c6f 7720 7368 6f77 7320 686f 7720 746f  low shows how to
-00006810: 2072 6561 6420 7468 6520 7265 636f 7264   read the record
-00006820: 6564 2065 7665 6e74 7320 696e 2061 2073  ed events in a s
-00006830: 7472 6561 6d20 6261 636b 7761 7264 7320  tream backwards 
-00006840: 6672 6f6d 0a74 6865 2065 6e64 206f 6620  from.the end of 
-00006850: 7468 6520 7374 7265 616d 2074 6f20 7468  the stream to th
-00006860: 6520 7374 6172 7420 6f66 2074 6865 2073  e start of the s
-00006870: 7472 6561 6d2e 0a0a 6060 6070 7974 686f  tream...```pytho
-00006880: 6e0a 6576 656e 7473 203d 2063 6c69 656e  n.events = clien
-00006890: 742e 7265 6164 5f73 7472 6561 6d5f 6576  t.read_stream_ev
-000068a0: 656e 7473 280a 2020 2020 7374 7265 616d  ents(.    stream
-000068b0: 5f6e 616d 653d 7374 7265 616d 5f6e 616d  _name=stream_nam
-000068c0: 6531 2c0a 2020 2020 6261 636b 7761 7264  e1,.    backward
-000068d0: 733d 5472 7565 2c0a 290a 0a61 7373 6572  s=True,.)..asser
-000068e0: 7420 6c65 6e28 6576 656e 7473 2920 3d3d  t len(events) ==
-000068f0: 2033 0a0a 6173 7365 7274 2065 7665 6e74   3..assert event
-00006900: 735b 305d 2e73 7472 6561 6d5f 6e61 6d65  s[0].stream_name
-00006910: 203d 3d20 7374 7265 616d 5f6e 616d 6531   == stream_name1
-00006920: 0a61 7373 6572 7420 6576 656e 7473 5b30  .assert events[0
-00006930: 5d2e 7374 7265 616d 5f70 6f73 6974 696f  ].stream_positio
-00006940: 6e20 3d3d 2032 0a61 7373 6572 7420 6576  n == 2.assert ev
-00006950: 656e 7473 5b30 5d2e 7479 7065 203d 3d20  ents[0].type == 
-00006960: 6576 656e 7433 2e74 7970 650a 6173 7365  event3.type.asse
-00006970: 7274 2065 7665 6e74 735b 305d 2e64 6174  rt events[0].dat
-00006980: 6120 3d3d 2065 7665 6e74 332e 6461 7461  a == event3.data
-00006990: 0a0a 6173 7365 7274 2065 7665 6e74 735b  ..assert events[
-000069a0: 315d 2e73 7472 6561 6d5f 6e61 6d65 203d  1].stream_name =
-000069b0: 3d20 7374 7265 616d 5f6e 616d 6531 0a61  = stream_name1.a
-000069c0: 7373 6572 7420 6576 656e 7473 5b31 5d2e  ssert events[1].
-000069d0: 7374 7265 616d 5f70 6f73 6974 696f 6e20  stream_position 
-000069e0: 3d3d 2031 0a61 7373 6572 7420 6576 656e  == 1.assert even
-000069f0: 7473 5b31 5d2e 7479 7065 203d 3d20 6576  ts[1].type == ev
-00006a00: 656e 7432 2e74 7970 650a 6173 7365 7274  ent2.type.assert
-00006a10: 2065 7665 6e74 735b 315d 2e64 6174 6120   events[1].data 
-00006a20: 3d3d 2065 7665 6e74 322e 6461 7461 0a60  == event2.data.`
-00006a30: 6060 0a0a 5468 6520 6578 616d 706c 6520  ``..The example 
-00006a40: 6265 6c6f 7720 7368 6f77 7320 686f 7720  below shows how 
-00006a50: 746f 2072 6561 6420 6120 6c69 6d69 7465  to read a limite
-00006a60: 6420 6e75 6d62 6572 2028 7477 6f29 206f  d number (two) o
-00006a70: 6620 7468 6520 7265 636f 7264 6564 2065  f the recorded e
-00006a80: 7665 6e74 730a 696e 2061 2073 7472 6561  vents.in a strea
-00006a90: 6d20 666f 7277 6172 6473 2066 726f 6d20  m forwards from 
-00006aa0: 7468 6520 7374 6172 7420 6f66 2074 6865  the start of the
-00006ab0: 2073 7472 6561 6d2e 0a0a 6060 6070 7974   stream...```pyt
-00006ac0: 686f 6e0a 6576 656e 7473 203d 2063 6c69  hon.events = cli
-00006ad0: 656e 742e 7265 6164 5f73 7472 6561 6d5f  ent.read_stream_
-00006ae0: 6576 656e 7473 280a 2020 2020 7374 7265  events(.    stre
-00006af0: 616d 5f6e 616d 653d 7374 7265 616d 5f6e  am_name=stream_n
-00006b00: 616d 6531 2c0a 2020 2020 6c69 6d69 743d  ame1,.    limit=
-00006b10: 322c 0a29 0a0a 6173 7365 7274 206c 656e  2,.)..assert len
-00006b20: 2865 7665 6e74 7329 203d 3d20 320a 0a61  (events) == 2..a
-00006b30: 7373 6572 7420 6576 656e 7473 5b30 5d2e  ssert events[0].
-00006b40: 7374 7265 616d 5f6e 616d 6520 3d3d 2073  stream_name == s
-00006b50: 7472 6561 6d5f 6e61 6d65 310a 6173 7365  tream_name1.asse
-00006b60: 7274 2065 7665 6e74 735b 305d 2e73 7472  rt events[0].str
-00006b70: 6561 6d5f 706f 7369 7469 6f6e 203d 3d20  eam_position == 
-00006b80: 300a 6173 7365 7274 2065 7665 6e74 735b  0.assert events[
-00006b90: 305d 2e74 7970 6520 3d3d 2065 7665 6e74  0].type == event
-00006ba0: 312e 7479 7065 0a61 7373 6572 7420 6576  1.type.assert ev
-00006bb0: 656e 7473 5b30 5d2e 6461 7461 203d 3d20  ents[0].data == 
-00006bc0: 6576 656e 7431 2e64 6174 610a 0a61 7373  event1.data..ass
-00006bd0: 6572 7420 6576 656e 7473 5b31 5d2e 7374  ert events[1].st
-00006be0: 7265 616d 5f6e 616d 6520 3d3d 2073 7472  ream_name == str
-00006bf0: 6561 6d5f 6e61 6d65 310a 6173 7365 7274  eam_name1.assert
-00006c00: 2065 7665 6e74 735b 315d 2e73 7472 6561   events[1].strea
-00006c10: 6d5f 706f 7369 7469 6f6e 203d 3d20 310a  m_position == 1.
-00006c20: 6173 7365 7274 2065 7665 6e74 735b 315d  assert events[1]
-00006c30: 2e74 7970 6520 3d3d 2065 7665 6e74 322e  .type == event2.
-00006c40: 7479 7065 0a61 7373 6572 7420 6576 656e  type.assert even
-00006c50: 7473 5b31 5d2e 6461 7461 203d 3d20 6576  ts[1].data == ev
-00006c60: 656e 7432 2e64 6174 610a 6060 600a 0a54  ent2.data.```..T
-00006c70: 6865 2065 7861 6d70 6c65 2062 656c 6f77  he example below
-00006c80: 2073 686f 7773 2068 6f77 2074 6f20 7265   shows how to re
-00006c90: 6164 2061 206c 696d 6974 6564 206e 756d  ad a limited num
-00006ca0: 6265 7220 286f 6e65 2920 6f66 2074 6865  ber (one) of the
-00006cb0: 2072 6563 6f72 6465 640a 6576 656e 7473   recorded.events
-00006cc0: 2069 6e20 6120 7374 7265 616d 2062 6163   in a stream bac
-00006cd0: 6b77 6172 6473 2066 726f 6d20 6120 6769  kwards from a gi
-00006ce0: 7665 6e20 7374 7265 616d 2070 6f73 6974  ven stream posit
-00006cf0: 696f 6e2e 0a0a 6060 6070 7974 686f 6e0a  ion...```python.
-00006d00: 6576 656e 7473 203d 2063 6c69 656e 742e  events = client.
-00006d10: 7265 6164 5f73 7472 6561 6d5f 6576 656e  read_stream_even
-00006d20: 7473 280a 2020 2020 7374 7265 616d 5f6e  ts(.    stream_n
-00006d30: 616d 653d 7374 7265 616d 5f6e 616d 6531  ame=stream_name1
-00006d40: 2c0a 2020 2020 7374 7265 616d 5f70 6f73  ,.    stream_pos
-00006d50: 6974 696f 6e3d 322c 0a20 2020 2062 6163  ition=2,.    bac
-00006d60: 6b77 6172 6473 3d54 7275 652c 0a20 2020  kwards=True,.   
-00006d70: 206c 696d 6974 3d31 2c0a 290a 0a61 7373   limit=1,.)..ass
-00006d80: 6572 7420 6c65 6e28 6576 656e 7473 2920  ert len(events) 
-00006d90: 3d3d 2031 0a0a 6173 7365 7274 2065 7665  == 1..assert eve
-00006da0: 6e74 735b 305d 2e73 7472 6561 6d5f 6e61  nts[0].stream_na
-00006db0: 6d65 203d 3d20 7374 7265 616d 5f6e 616d  me == stream_nam
-00006dc0: 6531 0a61 7373 6572 7420 6576 656e 7473  e1.assert events
-00006dd0: 5b30 5d2e 7374 7265 616d 5f70 6f73 6974  [0].stream_posit
-00006de0: 696f 6e20 3d3d 2032 0a61 7373 6572 7420  ion == 2.assert 
-00006df0: 6576 656e 7473 5b30 5d2e 7479 7065 203d  events[0].type =
-00006e00: 3d20 6576 656e 7433 2e74 7970 650a 6173  = event3.type.as
-00006e10: 7365 7274 2065 7665 6e74 735b 305d 2e64  sert events[0].d
-00006e20: 6174 6120 3d3d 2065 7665 6e74 332e 6461  ata == event3.da
-00006e30: 7461 0a60 6060 0a0a 2323 2320 5265 6164  ta.```..### Read
-00006e40: 2061 6c6c 2065 7665 6e74 730a 0a54 6865   all events..The
-00006e50: 206d 6574 686f 6420 6072 6561 645f 616c   method `read_al
-00006e60: 6c5f 6576 656e 7473 2829 6020 6361 6e20  l_events()` can 
-00006e70: 6265 2075 7365 6420 746f 2072 6561 6420  be used to read 
-00006e80: 616c 6c20 7265 636f 7264 6564 2065 7665  all recorded eve
-00006e90: 6e74 730a 696e 2074 6865 2064 6174 6162  nts.in the datab
-00006ea0: 6173 6520 696e 2074 6865 206f 7264 6572  ase in the order
-00006eb0: 2074 6865 7920 7765 7265 2072 6563 6f72   they were recor
-00006ec0: 6465 642e 2049 7420 7265 7475 726e 7320  ded. It returns 
-00006ed0: 616e 2069 7465 7261 626c 6520 6f66 0a65  an iterable of.e
-00006ee0: 7665 6e74 7320 7468 6174 2068 6176 6520  vents that have 
-00006ef0: 6265 656e 2072 6563 6f72 6465 6420 696e  been recorded in
-00006f00: 2074 6865 2064 6174 6162 6173 652e 2049   the database. I
-00006f10: 7465 7261 7469 6e67 206f 7665 7220 7468  terating over th
-00006f20: 6973 2069 7465 7261 626c 650a 6f62 6a65  is iterable.obje
-00006f30: 6374 2077 696c 6c20 7374 6f70 2077 6865  ct will stop whe
-00006f40: 6e20 6974 2068 6173 2079 6965 6c64 6564  n it has yielded
-00006f50: 2074 6865 206c 6173 7420 7265 636f 7264   the last record
-00006f60: 6564 2065 7665 6e74 2e20 5468 6520 7265  ed event. The re
-00006f70: 6365 6976 6564 0a72 6563 6f72 6465 6420  ceived.recorded 
-00006f80: 6576 656e 7420 6f62 6a65 6374 2061 7265  event object are
-00006f90: 2069 6e73 7461 6e63 6573 206f 6620 7468   instances of th
-00006fa0: 6520 6052 6563 6f72 6465 6445 7665 6e74  e `RecordedEvent
-00006fb0: 6020 636c 6173 7320 2873 6565 2062 656c  ` class (see bel
-00006fc0: 6f77 292e 0a0a 5468 6973 206d 6574 686f  ow)...This metho
-00006fd0: 6420 7375 7070 6f72 7473 2073 6576 656e  d supports seven
-00006fe0: 206f 7074 696f 6e61 6c20 6172 6775 6d65   optional argume
-00006ff0: 6e74 732c 2060 636f 6d6d 6974 5f70 6f73  nts, `commit_pos
-00007000: 6974 696f 6e60 2c20 6062 6163 6b77 6172  ition`, `backwar
-00007010: 6473 602c 0a60 6669 6c74 6572 5f65 7863  ds`,.`filter_exc
-00007020: 6c75 6465 602c 2060 6669 6c74 6572 5f69  lude`, `filter_i
-00007030: 6e63 6c75 6465 602c 2060 6669 6c74 6572  nclude`, `filter
-00007040: 5f62 795f 7374 7265 616d 5f6e 616d 6560  _by_stream_name`
-00007050: 2c20 606c 696d 6974 602c 2061 6e64 2060  , `limit`, and `
-00007060: 7469 6d65 6f75 7460 2e0a 0a54 6865 206f  timeout`...The o
-00007070: 7074 696f 6e61 6c20 6063 6f6d 6d69 745f  ptional `commit_
-00007080: 706f 7369 7469 6f6e 6020 6172 6775 6d65  position` argume
-00007090: 6e74 2069 7320 616e 206f 7074 696f 6e61  nt is an optiona
-000070a0: 6c20 696e 7465 6765 7220 7468 6174 2063  l integer that c
-000070b0: 616e 2062 6520 7573 6564 2074 6f0a 7370  an be used to.sp
-000070c0: 6563 6966 7920 7468 6520 636f 6d6d 6974  ecify the commit
-000070d0: 2070 6f73 6974 696f 6e20 6672 6f6d 2077   position from w
-000070e0: 6869 6368 2074 6f20 7374 6172 7420 7265  hich to start re
-000070f0: 6164 696e 672e 2054 6869 7320 6172 6775  ading. This argu
-00007100: 6d65 6e74 2069 7320 604e 6f6e 6560 2062  ment is `None` b
-00007110: 790a 6465 6661 756c 742c 206d 6561 6e69  y.default, meani
-00007120: 6e67 2074 6861 7420 616c 6c20 7468 6520  ng that all the 
-00007130: 6576 656e 7473 2077 696c 6c20 6265 2072  events will be r
-00007140: 6561 6420 6569 7468 6572 2066 726f 6d20  ead either from 
-00007150: 7468 6520 7374 6172 742c 206f 720a 6672  the start, or.fr
-00007160: 6f6d 2074 6865 2065 6e64 2069 6620 6062  om the end if `b
-00007170: 6163 6b77 6172 6473 6020 6973 2060 5472  ackwards` is `Tr
-00007180: 7565 6020 2873 6565 2062 656c 6f77 292e  ue` (see below).
-00007190: 2050 6c65 6173 6520 6e6f 7465 2c20 6966   Please note, if
-000071a0: 2073 7065 6369 6669 6564 2c0a 7468 6520   specified,.the 
-000071b0: 7370 6563 6966 6965 6420 706f 7369 7469  specified positi
-000071c0: 6f6e 206d 7573 7420 6265 2061 6e20 6163  on must be an ac
-000071d0: 7475 616c 6c79 2065 7869 7374 696e 6720  tually existing 
-000071e0: 636f 6d6d 6974 2070 6f73 6974 696f 6e2c  commit position,
-000071f0: 2062 6563 6175 7365 0a61 6e79 206f 7468   because.any oth
-00007200: 6572 206e 756d 6265 7220 7769 6c6c 2072  er number will r
-00007210: 6573 756c 7420 696e 2061 2073 6572 7665  esult in a serve
-00007220: 7220 6572 726f 7220 2861 7420 6c65 6173  r error (at leas
-00007230: 7420 696e 2045 7665 6e74 5374 6f72 6544  t in EventStoreD
-00007240: 4220 7632 312e 3130 292e 0a0a 5468 6520  B v21.10)...The 
-00007250: 6f70 7469 6f6e 616c 2060 6261 636b 7761  optional `backwa
-00007260: 7264 7360 2061 7267 756d 656e 7420 6973  rds` argument is
-00007270: 2061 2062 6f6f 6c65 616e 2077 6869 6368   a boolean which
-00007280: 2069 7320 6279 2064 6566 6175 6c74 2060   is by default `
-00007290: 4661 6c73 6560 206d 6561 6e69 6e67 2074  False` meaning t
-000072a0: 6865 0a65 7665 6e74 7320 7769 6c6c 2062  he.events will b
-000072b0: 6520 7265 6164 2066 6f72 7761 7264 7320  e read forwards 
-000072c0: 6279 2064 6566 6175 6c74 2c20 736f 2074  by default, so t
-000072d0: 6861 7420 6576 656e 7473 2061 7265 2072  hat events are r
-000072e0: 6574 7572 6e65 6420 696e 2074 6865 0a6f  eturned in the.o
-000072f0: 7264 6572 2074 6865 7920 7765 7265 2063  rder they were c
-00007300: 6f6d 6d69 7474 6564 2c20 4966 2060 6261  ommitted, If `ba
-00007310: 636b 7761 7264 7360 2069 7320 6054 7275  ckwards` is `Tru
-00007320: 6560 2c20 7468 6520 6576 656e 7473 2077  e`, the events w
-00007330: 696c 6c20 6265 2072 6561 640a 6261 636b  ill be read.back
-00007340: 7761 7264 732c 2073 6f20 7468 6174 2065  wards, so that e
-00007350: 7665 6e74 7320 6172 6520 7265 7475 726e  vents are return
-00007360: 6564 2069 6e20 7265 7665 7273 6520 6f72  ed in reverse or
-00007370: 6465 722e 0a0a 5468 6520 6f70 7469 6f6e  der...The option
-00007380: 616c 2060 6669 6c74 6572 5f65 7863 6c75  al `filter_exclu
-00007390: 6465 6020 6172 6775 6d65 6e74 2069 7320  de` argument is 
-000073a0: 6120 7365 7175 656e 6365 206f 6620 7265  a sequence of re
-000073b0: 6775 6c61 7220 6578 7072 6573 7369 6f6e  gular expression
-000073c0: 7320 7468 6174 0a6d 6174 6368 2072 6563  s that.match rec
-000073d0: 6f72 6465 6420 6576 656e 7473 2074 6861  orded events tha
-000073e0: 7420 7368 6f75 6c64 206e 6f74 2062 6520  t should not be 
-000073f0: 696e 636c 7564 6564 2e20 5468 6973 2061  included. This a
-00007400: 7267 756d 656e 7420 6973 2069 676e 6f72  rgument is ignor
-00007410: 6564 0a69 6620 6066 696c 7465 725f 696e  ed.if `filter_in
-00007420: 636c 7564 6560 2069 7320 7365 7420 746f  clude` is set to
-00007430: 2061 206e 6f6e 2d65 6d70 7479 2073 6571   a non-empty seq
-00007440: 7565 6e63 652e 2042 7920 6465 6661 756c  uence. By defaul
-00007450: 742c 2074 6869 7320 6172 6775 6d65 6e74  t, this argument
-00007460: 2069 7320 7365 740a 746f 206d 6174 6368   is set.to match
-00007470: 2074 6865 2065 7665 6e74 2074 7970 6573   the event types
-00007480: 206f 6620 2273 7973 7465 6d20 6576 656e   of "system even
-00007490: 7473 222c 2073 6f20 7468 6174 2045 7665  ts", so that Eve
-000074a0: 6e74 5374 6f72 6544 4220 7379 7374 656d  ntStoreDB system
-000074b0: 2065 7665 6e74 730a 7769 6c6c 206e 6f74   events.will not
-000074c0: 206e 6f72 6d61 6c6c 7920 6265 2069 6e63   normally be inc
-000074d0: 6c75 6465 642e 2053 6565 2074 6865 204e  luded. See the N
-000074e0: 6f74 6573 2073 6563 7469 6f6e 2062 656c  otes section bel
-000074f0: 6f77 2066 6f72 206d 6f72 6520 696e 666f  ow for more info
-00007500: 726d 6174 696f 6e0a 6162 6f75 7420 6669  rmation.about fi
-00007510: 6c74 6572 2065 7870 7265 7373 696f 6e73  lter expressions
-00007520: 2e0a 0a54 6865 206f 7074 696f 6e61 6c20  ...The optional 
-00007530: 6066 696c 7465 725f 696e 636c 7564 6560  `filter_include`
-00007540: 2061 7267 756d 656e 7420 6973 2061 2073   argument is a s
-00007550: 6571 7565 6e63 6520 6f66 2072 6567 756c  equence of regul
-00007560: 6172 2065 7870 7265 7373 696f 6e73 0a74  ar expressions.t
-00007570: 6861 7420 6d61 7463 6820 7265 636f 7264  hat match record
-00007580: 6564 2065 7665 6e74 7320 7468 6174 2073  ed events that s
-00007590: 686f 756c 6420 6265 2069 6e63 6c75 6465  hould be include
-000075a0: 642e 2042 7920 6465 6661 756c 742c 2074  d. By default, t
-000075b0: 6869 7320 6172 6775 6d65 6e74 0a69 7320  his argument.is 
-000075c0: 616e 2065 6d70 7479 2074 7570 6c65 2e20  an empty tuple. 
-000075d0: 4966 2074 6869 7320 6172 6775 6d65 6e74  If this argument
-000075e0: 2069 7320 7365 7420 746f 2061 206e 6f6e   is set to a non
-000075f0: 2d65 6d70 7479 2073 6571 7565 6e63 652c  -empty sequence,
-00007600: 2074 6865 0a60 6669 6c74 6572 5f65 7863   the.`filter_exc
-00007610: 6c75 6465 6020 6172 6775 6d65 6e74 2069  lude` argument i
-00007620: 7320 6967 6e6f 7265 642e 0a0a 5468 6520  s ignored...The 
-00007630: 6f70 7469 6f6e 616c 2060 6669 6c74 6572  optional `filter
-00007640: 5f62 795f 7374 7265 616d 5f6e 616d 6560  _by_stream_name`
-00007650: 2061 7267 756d 656e 7420 6973 2061 2062   argument is a b
-00007660: 6f6f 6c65 616e 2076 616c 7565 2074 6861  oolean value tha
-00007670: 7420 696e 6469 6361 7465 7320 7768 6574  t indicates whet
-00007680: 6865 720a 7468 6520 6669 6c74 6572 2077  her.the filter w
-00007690: 696c 6c20 6170 706c 7920 746f 2065 7665  ill apply to eve
-000076a0: 6e74 2074 7970 6573 206f 7220 7374 7265  nt types or stre
-000076b0: 616d 206e 616d 6573 2e20 4279 2064 6566  am names. By def
-000076c0: 6175 6c74 2c20 7468 6973 2076 616c 7565  ault, this value
-000076d0: 2069 7320 6046 616c 7365 600a 616e 6420   is `False`.and 
-000076e0: 736f 2074 6865 2066 696c 7465 7269 6e67  so the filtering
-000076f0: 2077 696c 6c20 6170 706c 7920 746f 2074   will apply to t
-00007700: 6865 2065 7665 6e74 2074 7970 6520 7374  he event type st
-00007710: 7269 6e67 7320 6f66 2072 6563 6f72 6465  rings of recorde
-00007720: 6420 6576 656e 7473 2e0a 0a54 6865 206f  d events...The o
-00007730: 7074 696f 6e61 6c20 606c 696d 6974 6020  ptional `limit` 
-00007740: 6172 6775 6d65 6e74 2069 7320 616e 2069  argument is an i
-00007750: 6e74 6567 6572 2077 6869 6368 206c 696d  nteger which lim
-00007760: 6974 7320 7468 6520 6e75 6d62 6572 206f  its the number o
-00007770: 6620 6576 656e 7473 2074 6861 7420 7769  f events that wi
-00007780: 6c6c 0a62 6520 7265 7475 726e 6564 2e20  ll.be returned. 
-00007790: 5468 6520 6465 6661 756c 7420 7661 6c75  The default valu
-000077a0: 6520 6973 2060 7379 732e 6d61 7869 6e74  e is `sys.maxint
-000077b0: 602e 0a0a 5468 6520 6f70 7469 6f6e 616c  `...The optional
-000077c0: 2060 7469 6d65 6f75 7460 2061 7267 756d   `timeout` argum
-000077d0: 656e 7420 6973 2061 2050 7974 686f 6e20  ent is a Python 
-000077e0: 6066 6c6f 6174 6020 7768 6963 6820 7365  `float` which se
-000077f0: 7473 2061 0a64 6561 646c 696e 6520 666f  ts a.deadline fo
-00007800: 7220 7468 6520 636f 6d70 6c65 7469 6f6e  r the completion
-00007810: 206f 6620 7468 6520 6752 5043 206f 7065   of the gRPC ope
-00007820: 7261 7469 6f6e 2e0a 0a54 6865 2066 696c  ration...The fil
-00007830: 7465 7269 6e67 206f 6620 6576 656e 7473  tering of events
-00007840: 2069 7320 646f 6e65 206f 6e20 7468 6520   is done on the 
-00007850: 4576 656e 7453 746f 7265 4442 2073 6572  EventStoreDB ser
-00007860: 7665 722e 2054 6865 0a60 6c69 6d69 7460  ver. The.`limit`
-00007870: 2061 7267 756d 656e 7420 6973 2061 7070   argument is app
-00007880: 6c69 6564 206f 6e20 7468 6520 7365 7276  lied on the serv
-00007890: 6572 2061 6674 6572 2066 696c 7465 7269  er after filteri
-000078a0: 6e67 2e20 5365 6520 6265 6c6f 7720 666f  ng. See below fo
-000078b0: 720a 6d6f 7265 2069 6e66 6f72 6d61 7469  r.more informati
-000078c0: 6f6e 2061 626f 7574 2066 696c 7465 7220  on about filter 
-000078d0: 7265 6775 6c61 7220 6578 7072 6573 7369  regular expressi
-000078e0: 6f6e 732e 0a0a 5768 656e 2072 6561 6469  ons...When readi
-000078f0: 6e67 2066 6f72 7761 7264 7320 6672 6f6d  ng forwards from
-00007900: 2061 2073 7065 6369 6669 6320 636f 6d6d   a specific comm
-00007910: 6974 2070 6f73 6974 696f 6e2c 2074 6865  it position, the
-00007920: 2065 7665 6e74 2061 7420 7468 6520 7370   event at the sp
-00007930: 6563 6966 6965 640a 706f 7369 7469 6f6e  ecified.position
-00007940: 2057 494c 4c20 6265 2069 6e63 6c75 6465   WILL be include
-00007950: 642e 2048 6f77 6576 6572 2c20 7768 656e  d. However, when
-00007960: 2072 6561 6469 6e67 2062 6163 6b77 6172   reading backwar
-00007970: 6473 2c20 7468 6520 6576 656e 7420 6174  ds, the event at
-00007980: 2074 6865 0a73 7065 6369 6669 6564 2070   the.specified p
-00007990: 6f73 6974 696f 6e20 7769 6c6c 204e 4f54  osition will NOT
-000079a0: 2062 6520 696e 636c 7564 6564 2e20 2854   be included. (T
-000079b0: 6869 7320 6e6f 6e2d 696e 636c 7573 6976  his non-inclusiv
-000079c0: 6520 6265 6861 7669 6f75 722c 206f 6620  e behaviour, of 
-000079d0: 6578 636c 7564 696e 670a 7468 6520 7370  excluding.the sp
-000079e0: 6563 6966 6965 6420 636f 6d6d 6974 2070  ecified commit p
-000079f0: 6f73 6974 696f 6e20 7768 656e 2072 6561  osition when rea
-00007a00: 6469 6e67 2061 6c6c 2073 7472 6561 6d73  ding all streams
-00007a10: 2062 6163 6b77 6172 6473 2c20 6469 6666   backwards, diff
-00007a20: 6572 7320 6672 6f6d 2074 6865 0a62 6568  ers from the.beh
-00007a30: 6176 696f 7572 2077 6865 6e20 7265 6164  aviour when read
-00007a40: 696e 6720 6120 7374 7265 616d 2062 6163  ing a stream bac
-00007a50: 6b77 6172 6473 2066 726f 6d20 6120 7370  kwards from a sp
-00007a60: 6563 6966 6963 2073 7472 6561 6d20 706f  ecific stream po
-00007a70: 7369 7469 6f6e 2e29 0a0a 5468 6520 6578  sition.)..The ex
-00007a80: 616d 706c 6520 6265 6c6f 7720 7368 6f77  ample below show
-00007a90: 7320 686f 7720 746f 2072 6561 6420 616c  s how to read al
-00007aa0: 6c20 6576 656e 7473 2069 6e20 7468 6520  l events in the 
-00007ab0: 6461 7461 6261 7365 2069 6e20 7468 650a  database in the.
-00007ac0: 6f72 6465 7220 7468 6579 2077 6572 6520  order they were 
-00007ad0: 7265 636f 7264 6564 2e0a 0a60 6060 7079  recorded...```py
-00007ae0: 7468 6f6e 0a65 7665 6e74 7320 3d20 6c69  thon.events = li
-00007af0: 7374 2863 6c69 656e 742e 7265 6164 5f61  st(client.read_a
-00007b00: 6c6c 5f65 7665 6e74 7328 2929 0a0a 6173  ll_events())..as
-00007b10: 7365 7274 206c 656e 2865 7665 6e74 7329  sert len(events)
-00007b20: 203e 3d20 330a 6060 600a 0a54 6865 2065   >= 3.```..The e
-00007b30: 7861 6d70 6c65 2062 656c 6f77 2073 686f  xample below sho
-00007b40: 7773 2068 6f77 2074 6f20 7265 6164 2061  ws how to read a
-00007b50: 6c6c 2072 6563 6f72 6465 6420 6576 656e  ll recorded even
-00007b60: 7473 2066 726f 6d20 6120 7370 6563 6966  ts from a specif
-00007b70: 6963 2063 6f6d 6d69 7420 706f 7369 7469  ic commit positi
-00007b80: 6f6e 2e0a 0a60 6060 7079 7468 6f6e 0a65  on...```python.e
-00007b90: 7665 6e74 7320 3d20 6c69 7374 280a 2020  vents = list(.  
-00007ba0: 2020 636c 6965 6e74 2e72 6561 645f 616c    client.read_al
-00007bb0: 6c5f 6576 656e 7473 280a 2020 2020 2020  l_events(.      
-00007bc0: 2020 636f 6d6d 6974 5f70 6f73 6974 696f    commit_positio
-00007bd0: 6e3d 636f 6d6d 6974 5f70 6f73 6974 696f  n=commit_positio
-00007be0: 6e31 0a20 2020 2029 0a29 0a0a 6173 7365  n1.    ).)..asse
-00007bf0: 7274 206c 656e 2865 7665 6e74 7329 203d  rt len(events) =
-00007c00: 3d20 330a 0a61 7373 6572 7420 6576 656e  = 3..assert even
-00007c10: 7473 5b30 5d2e 7374 7265 616d 5f6e 616d  ts[0].stream_nam
-00007c20: 6520 3d3d 2073 7472 6561 6d5f 6e61 6d65  e == stream_name
-00007c30: 310a 6173 7365 7274 2065 7665 6e74 735b  1.assert events[
-00007c40: 305d 2e73 7472 6561 6d5f 706f 7369 7469  0].stream_positi
-00007c50: 6f6e 203d 3d20 300a 6173 7365 7274 2065  on == 0.assert e
-00007c60: 7665 6e74 735b 305d 2e74 7970 6520 3d3d  vents[0].type ==
-00007c70: 2065 7665 6e74 312e 7479 7065 0a61 7373   event1.type.ass
-00007c80: 6572 7420 6576 656e 7473 5b30 5d2e 6461  ert events[0].da
-00007c90: 7461 203d 3d20 6576 656e 7431 2e64 6174  ta == event1.dat
-00007ca0: 610a 0a61 7373 6572 7420 6576 656e 7473  a..assert events
-00007cb0: 5b31 5d2e 7374 7265 616d 5f6e 616d 6520  [1].stream_name 
-00007cc0: 3d3d 2073 7472 6561 6d5f 6e61 6d65 310a  == stream_name1.
-00007cd0: 6173 7365 7274 2065 7665 6e74 735b 315d  assert events[1]
-00007ce0: 2e73 7472 6561 6d5f 706f 7369 7469 6f6e  .stream_position
-00007cf0: 203d 3d20 310a 6173 7365 7274 2065 7665   == 1.assert eve
-00007d00: 6e74 735b 315d 2e74 7970 6520 3d3d 2065  nts[1].type == e
-00007d10: 7665 6e74 322e 7479 7065 0a61 7373 6572  vent2.type.asser
-00007d20: 7420 6576 656e 7473 5b31 5d2e 6461 7461  t events[1].data
-00007d30: 203d 3d20 6576 656e 7432 2e64 6174 610a   == event2.data.
-00007d40: 0a61 7373 6572 7420 6576 656e 7473 5b32  .assert events[2
-00007d50: 5d2e 7374 7265 616d 5f6e 616d 6520 3d3d  ].stream_name ==
-00007d60: 2073 7472 6561 6d5f 6e61 6d65 310a 6173   stream_name1.as
-00007d70: 7365 7274 2065 7665 6e74 735b 325d 2e73  sert events[2].s
-00007d80: 7472 6561 6d5f 706f 7369 7469 6f6e 203d  tream_position =
-00007d90: 3d20 320a 6173 7365 7274 2065 7665 6e74  = 2.assert event
-00007da0: 735b 325d 2e74 7970 6520 3d3d 2065 7665  s[2].type == eve
-00007db0: 6e74 332e 7479 7065 0a61 7373 6572 7420  nt3.type.assert 
-00007dc0: 6576 656e 7473 5b32 5d2e 6461 7461 203d  events[2].data =
-00007dd0: 3d20 6576 656e 7433 2e64 6174 610a 6060  = event3.data.``
-00007de0: 600a 0a54 6865 2065 7861 6d70 6c65 2062  `..The example b
-00007df0: 656c 6f77 2073 686f 7773 2068 6f77 2074  elow shows how t
-00007e00: 6f20 7265 6164 2061 6c6c 2072 6563 6f72  o read all recor
-00007e10: 6465 6420 6576 656e 7473 2069 6e20 7265  ded events in re
-00007e20: 7665 7273 6520 6f72 6465 722e 0a0a 6060  verse order...``
-00007e30: 6070 7974 686f 6e0a 6576 656e 7473 203d  `python.events =
-00007e40: 206c 6973 7428 0a20 2020 2063 6c69 656e   list(.    clien
-00007e50: 742e 7265 6164 5f61 6c6c 5f65 7665 6e74  t.read_all_event
-00007e60: 7328 0a20 2020 2020 2020 2062 6163 6b77  s(.        backw
-00007e70: 6172 6473 3d54 7275 650a 2020 2020 290a  ards=True.    ).
-00007e80: 290a 0a61 7373 6572 7420 6c65 6e28 6576  )..assert len(ev
-00007e90: 656e 7473 2920 3e3d 2033 0a0a 6173 7365  ents) >= 3..asse
-00007ea0: 7274 2065 7665 6e74 735b 305d 2e73 7472  rt events[0].str
-00007eb0: 6561 6d5f 6e61 6d65 203d 3d20 7374 7265  eam_name == stre
-00007ec0: 616d 5f6e 616d 6531 0a61 7373 6572 7420  am_name1.assert 
-00007ed0: 6576 656e 7473 5b30 5d2e 7374 7265 616d  events[0].stream
-00007ee0: 5f70 6f73 6974 696f 6e20 3d3d 2032 0a61  _position == 2.a
-00007ef0: 7373 6572 7420 6576 656e 7473 5b30 5d2e  ssert events[0].
-00007f00: 7479 7065 203d 3d20 6576 656e 7433 2e74  type == event3.t
-00007f10: 7970 650a 6173 7365 7274 2065 7665 6e74  ype.assert event
-00007f20: 735b 305d 2e64 6174 6120 3d3d 2065 7665  s[0].data == eve
-00007f30: 6e74 332e 6461 7461 0a0a 6173 7365 7274  nt3.data..assert
-00007f40: 2065 7665 6e74 735b 315d 2e73 7472 6561   events[1].strea
-00007f50: 6d5f 6e61 6d65 203d 3d20 7374 7265 616d  m_name == stream
-00007f60: 5f6e 616d 6531 0a61 7373 6572 7420 6576  _name1.assert ev
-00007f70: 656e 7473 5b31 5d2e 7374 7265 616d 5f70  ents[1].stream_p
-00007f80: 6f73 6974 696f 6e20 3d3d 2031 0a61 7373  osition == 1.ass
-00007f90: 6572 7420 6576 656e 7473 5b31 5d2e 7479  ert events[1].ty
-00007fa0: 7065 203d 3d20 6576 656e 7432 2e74 7970  pe == event2.typ
-00007fb0: 650a 6173 7365 7274 2065 7665 6e74 735b  e.assert events[
-00007fc0: 315d 2e64 6174 6120 3d3d 2065 7665 6e74  1].data == event
-00007fd0: 322e 6461 7461 0a0a 6173 7365 7274 2065  2.data..assert e
-00007fe0: 7665 6e74 735b 325d 2e73 7472 6561 6d5f  vents[2].stream_
-00007ff0: 6e61 6d65 203d 3d20 7374 7265 616d 5f6e  name == stream_n
-00008000: 616d 6531 0a61 7373 6572 7420 6576 656e  ame1.assert even
-00008010: 7473 5b32 5d2e 7374 7265 616d 5f70 6f73  ts[2].stream_pos
-00008020: 6974 696f 6e20 3d3d 2030 0a61 7373 6572  ition == 0.asser
-00008030: 7420 6576 656e 7473 5b32 5d2e 7479 7065  t events[2].type
-00008040: 203d 3d20 6576 656e 7431 2e74 7970 650a   == event1.type.
-00008050: 6173 7365 7274 2065 7665 6e74 735b 325d  assert events[2]
-00008060: 2e64 6174 6120 3d3d 2065 7665 6e74 312e  .data == event1.
-00008070: 6461 7461 0a60 6060 0a0a 5468 6520 6578  data.```..The ex
-00008080: 616d 706c 6520 6265 6c6f 7720 7368 6f77  ample below show
-00008090: 7320 686f 7720 746f 2072 6561 6420 6120  s how to read a 
-000080a0: 6c69 6d69 7465 6420 6e75 6d62 6572 2028  limited number (
-000080b0: 6f6e 6529 206f 6620 7468 6520 7265 636f  one) of the reco
-000080c0: 7264 6564 2065 7665 6e74 730a 696e 2074  rded events.in t
-000080d0: 6865 2064 6174 6162 6173 6520 666f 7277  he database forw
-000080e0: 6172 6473 2066 726f 6d20 6120 7370 6563  ards from a spec
-000080f0: 6966 6963 2063 6f6d 6d69 7420 706f 7369  ific commit posi
-00008100: 7469 6f6e 2e20 506c 6561 7365 206e 6f74  tion. Please not
-00008110: 652c 2077 6865 6e20 7265 6164 696e 670a  e, when reading.
-00008120: 616c 6c20 6576 656e 7473 2066 6f72 7761  all events forwa
-00008130: 7264 7320 6672 6f6d 2061 2073 7065 6369  rds from a speci
-00008140: 6669 6320 636f 6d6d 6974 2070 6f73 6974  fic commit posit
-00008150: 696f 6e2c 2074 6865 2065 7665 6e74 2061  ion, the event a
-00008160: 7420 7468 6520 7370 6563 6966 6965 640a  t the specified.
-00008170: 706f 7369 7469 6f6e 2057 494c 4c20 6265  position WILL be
-00008180: 2069 6e63 6c75 6465 642e 0a0a 0a60 6060   included....```
-00008190: 7079 7468 6f6e 0a65 7665 6e74 7320 3d20  python.events = 
-000081a0: 6c69 7374 280a 2020 2020 636c 6965 6e74  list(.    client
-000081b0: 2e72 6561 645f 616c 6c5f 6576 656e 7473  .read_all_events
-000081c0: 280a 2020 2020 2020 2020 636f 6d6d 6974  (.        commit
-000081d0: 5f70 6f73 6974 696f 6e3d 636f 6d6d 6974  _position=commit
-000081e0: 5f70 6f73 6974 696f 6e31 2c0a 2020 2020  _position1,.    
-000081f0: 2020 2020 6c69 6d69 743d 312c 0a20 2020      limit=1,.   
-00008200: 2029 0a29 0a0a 6173 7365 7274 206c 656e   ).)..assert len
-00008210: 2865 7665 6e74 7329 203d 3d20 310a 0a61  (events) == 1..a
-00008220: 7373 6572 7420 6576 656e 7473 5b30 5d2e  ssert events[0].
-00008230: 7374 7265 616d 5f6e 616d 6520 3d3d 2073  stream_name == s
-00008240: 7472 6561 6d5f 6e61 6d65 310a 6173 7365  tream_name1.asse
-00008250: 7274 2065 7665 6e74 735b 305d 2e73 7472  rt events[0].str
-00008260: 6561 6d5f 706f 7369 7469 6f6e 203d 3d20  eam_position == 
-00008270: 300a 6173 7365 7274 2065 7665 6e74 735b  0.assert events[
-00008280: 305d 2e74 7970 6520 3d3d 2065 7665 6e74  0].type == event
-00008290: 312e 7479 7065 0a61 7373 6572 7420 6576  1.type.assert ev
-000082a0: 656e 7473 5b30 5d2e 6461 7461 203d 3d20  ents[0].data == 
-000082b0: 6576 656e 7431 2e64 6174 610a 0a61 7373  event1.data..ass
-000082c0: 6572 7420 6576 656e 7473 5b30 5d2e 636f  ert events[0].co
-000082d0: 6d6d 6974 5f70 6f73 6974 696f 6e20 3d3d  mmit_position ==
-000082e0: 2063 6f6d 6d69 745f 706f 7369 7469 6f6e   commit_position
-000082f0: 310a 6060 600a 0a54 6865 2065 7861 6d70  1.```..The examp
-00008300: 6c65 2062 656c 6f77 2073 686f 7773 2068  le below shows h
-00008310: 6f77 2074 6f20 7265 6164 2061 206c 696d  ow to read a lim
-00008320: 6974 6564 206e 756d 6265 7220 286f 6e65  ited number (one
-00008330: 2920 6f66 2074 6865 2072 6563 6f72 6465  ) of the recorde
-00008340: 6420 6576 656e 7473 0a69 6e20 7468 6520  d events.in the 
-00008350: 6461 7461 6261 7365 2062 6163 6b77 6172  database backwar
-00008360: 6473 2066 726f 6d20 7468 6520 656e 642e  ds from the end.
-00008370: 2054 6869 7320 6769 7665 7320 7468 6520   This gives the 
-00008380: 6c61 7374 2072 6563 6f72 6465 6420 6576  last recorded ev
-00008390: 656e 742e 0a0a 6060 6070 7974 686f 6e0a  ent...```python.
-000083a0: 6576 656e 7473 203d 206c 6973 7428 0a20  events = list(. 
-000083b0: 2020 2063 6c69 656e 742e 7265 6164 5f61     client.read_a
-000083c0: 6c6c 5f65 7665 6e74 7328 0a20 2020 2020  ll_events(.     
-000083d0: 2020 2062 6163 6b77 6172 6473 3d54 7275     backwards=Tru
-000083e0: 652c 0a20 2020 2020 2020 206c 696d 6974  e,.        limit
-000083f0: 3d31 2c0a 2020 2020 290a 290a 0a61 7373  =1,.    ).)..ass
-00008400: 6572 7420 6c65 6e28 6576 656e 7473 2920  ert len(events) 
-00008410: 3d3d 2031 0a0a 6173 7365 7274 2065 7665  == 1..assert eve
-00008420: 6e74 735b 305d 2e73 7472 6561 6d5f 6e61  nts[0].stream_na
-00008430: 6d65 203d 3d20 7374 7265 616d 5f6e 616d  me == stream_nam
-00008440: 6531 0a61 7373 6572 7420 6576 656e 7473  e1.assert events
-00008450: 5b30 5d2e 7374 7265 616d 5f70 6f73 6974  [0].stream_posit
-00008460: 696f 6e20 3d3d 2032 0a61 7373 6572 7420  ion == 2.assert 
-00008470: 6576 656e 7473 5b30 5d2e 7479 7065 203d  events[0].type =
-00008480: 3d20 6576 656e 7433 2e74 7970 650a 6173  = event3.type.as
-00008490: 7365 7274 2065 7665 6e74 735b 305d 2e64  sert events[0].d
-000084a0: 6174 6120 3d3d 2065 7665 6e74 332e 6461  ata == event3.da
-000084b0: 7461 0a60 6060 0a0a 5468 6520 6578 616d  ta.```..The exam
-000084c0: 706c 6520 6265 6c6f 7720 7368 6f77 7320  ple below shows 
-000084d0: 686f 7720 746f 2072 6561 6420 6120 6c69  how to read a li
-000084e0: 6d69 7465 6420 6e75 6d62 6572 2028 6f6e  mited number (on
-000084f0: 6529 206f 6620 7468 6520 7265 636f 7264  e) of the record
-00008500: 6564 2065 7665 6e74 730a 696e 2074 6865  ed events.in the
-00008510: 2064 6174 6162 6173 6520 6261 636b 7761   database backwa
-00008520: 7264 7320 6672 6f6d 2061 2073 7065 6369  rds from a speci
-00008530: 6669 6320 636f 6d6d 6974 2070 6f73 6974  fic commit posit
-00008540: 696f 6e2e 2050 6c65 6173 6520 6e6f 7465  ion. Please note
-00008550: 2c20 7768 656e 2072 6561 6469 6e67 0a61  , when reading.a
-00008560: 6c6c 2065 7665 6e74 7320 6261 636b 7761  ll events backwa
-00008570: 7264 7320 6672 6f6d 2061 2073 7065 6369  rds from a speci
-00008580: 6669 6320 636f 6d6d 6974 2070 6f73 6974  fic commit posit
-00008590: 696f 6e2c 2074 6865 2065 7665 6e74 2061  ion, the event a
-000085a0: 7420 7468 6520 7370 6563 6966 6965 640a  t the specified.
-000085b0: 706f 7369 7469 6f6e 2057 494c 4c20 4e4f  position WILL NO
-000085c0: 5420 6265 2069 6e63 6c75 6465 642e 0a0a  T be included...
-000085d0: 6060 6070 7974 686f 6e0a 6576 656e 7473  ```python.events
-000085e0: 203d 206c 6973 7428 0a20 2020 2063 6c69   = list(.    cli
-000085f0: 656e 742e 7265 6164 5f61 6c6c 5f65 7665  ent.read_all_eve
-00008600: 6e74 7328 0a20 2020 2020 2020 2063 6f6d  nts(.        com
-00008610: 6d69 745f 706f 7369 7469 6f6e 3d63 6f6d  mit_position=com
-00008620: 6d69 745f 706f 7369 7469 6f6e 322c 0a20  mit_position2,. 
-00008630: 2020 2020 2020 2062 6163 6b77 6172 6473         backwards
-00008640: 3d54 7275 652c 0a20 2020 2020 2020 206c  =True,.        l
-00008650: 696d 6974 3d31 2c0a 2020 2020 290a 290a  imit=1,.    ).).
-00008660: 0a61 7373 6572 7420 6c65 6e28 6576 656e  .assert len(even
-00008670: 7473 2920 3d3d 2031 0a0a 6173 7365 7274  ts) == 1..assert
-00008680: 2065 7665 6e74 735b 305d 2e63 6f6d 6d69   events[0].commi
-00008690: 745f 706f 7369 7469 6f6e 203c 2063 6f6d  t_position < com
-000086a0: 6d69 745f 706f 7369 7469 6f6e 320a 6060  mit_position2.``
-000086b0: 600a 0a0a 2323 2320 4765 7420 6375 7272  `...### Get curr
-000086c0: 656e 7420 7374 7265 616d 2070 6f73 6974  ent stream posit
-000086d0: 696f 6e0a 0a54 6865 2060 6765 745f 7374  ion..The `get_st
-000086e0: 7265 616d 5f70 6f73 6974 696f 6e28 2960  ream_position()`
-000086f0: 206d 6574 686f 6420 6361 6e20 6265 2075   method can be u
-00008700: 7365 6420 746f 0a67 6574 2074 6865 2022  sed to.get the "
-00008710: 7374 7265 616d 2070 6f73 6974 696f 6e22  stream position"
-00008720: 206f 6620 7468 6520 6c61 7374 2072 6563   of the last rec
-00008730: 6f72 6465 6420 6576 656e 7420 696e 2061  orded event in a
-00008740: 2073 7472 6561 6d2e 0a0a 5468 6973 206d   stream...This m
-00008750: 6574 686f 6420 6861 7320 6120 6073 7472  ethod has a `str
-00008760: 6561 6d5f 6e61 6d65 6020 6172 6775 6d65  eam_name` argume
-00008770: 6e74 2c20 7768 6963 6820 6973 2072 6571  nt, which is req
-00008780: 7569 7265 642e 0a0a 5468 6973 206d 6574  uired...This met
-00008790: 686f 6420 616c 736f 2074 616b 6573 2061  hod also takes a
-000087a0: 6e20 6f70 7469 6f6e 616c 2060 7469 6d65  n optional `time
-000087b0: 6f75 7460 2061 7267 756d 656e 742c 2074  out` argument, t
-000087c0: 6861 740a 6973 2065 7870 6563 7465 6420  hat.is expected 
-000087d0: 746f 2062 6520 6120 5079 7468 6f6e 2060  to be a Python `
-000087e0: 666c 6f61 7460 2c20 7768 6963 6820 7365  float`, which se
-000087f0: 7473 2061 2064 6561 646c 696e 650a 666f  ts a deadline.fo
-00008800: 7220 7468 6520 636f 6d70 6c65 7469 6f6e  r the completion
-00008810: 206f 6620 7468 6520 6752 5043 206f 7065   of the gRPC ope
-00008820: 7261 7469 6f6e 2e0a 0a54 6865 2073 6571  ration...The seq
-00008830: 7565 6e63 6520 6f66 2070 6f73 6974 696f  uence of positio
-00008840: 6e73 2069 6e20 6120 7374 7265 616d 2069  ns in a stream i
-00008850: 7320 6761 706c 6573 732e 2049 7420 6973  s gapless. It is
-00008860: 207a 6572 6f2d 6261 7365 642c 0a73 6f20   zero-based,.so 
-00008870: 7468 6174 2061 2073 7472 6561 6d20 7769  that a stream wi
-00008880: 7468 206f 6e65 2072 6563 6f72 6465 6420  th one recorded 
-00008890: 6576 656e 7420 6861 7320 6120 6375 7272  event has a curr
-000088a0: 656e 7420 7374 7265 616d 0a70 6f73 6974  ent stream.posit
-000088b0: 696f 6e20 6f66 2060 3060 2e20 5468 6520  ion of `0`. The 
-000088c0: 6375 7272 656e 7420 7374 7265 616d 2070  current stream p
-000088d0: 6f73 6974 696f 6e20 6973 2060 3160 2077  osition is `1` w
-000088e0: 6865 6e20 6120 7374 7265 616d 2068 6173  hen a stream has
-000088f0: 0a74 776f 2065 7665 6e74 732c 2061 6e64  .two events, and
-00008900: 2069 7420 6973 2060 3260 2077 6865 6e20   it is `2` when 
-00008910: 7468 6572 6520 6172 6520 6576 656e 7473  there are events
-00008920: 2c20 616e 6420 736f 206f 6e2e 0a0a 496e  , and so on...In
-00008930: 2074 6865 2065 7861 6d70 6c65 2062 656c   the example bel
-00008940: 6f77 2c20 7468 6520 6375 7272 656e 7420  ow, the current 
-00008950: 7374 7265 616d 2070 6f73 6974 696f 6e20  stream position 
-00008960: 6973 206f 6274 6169 6e65 6420 6f66 2074  is obtained of t
-00008970: 6865 0a73 7472 6561 6d20 746f 2077 6869  he.stream to whi
-00008980: 6368 2065 7665 6e74 7320 7765 7265 2061  ch events were a
-00008990: 7070 656e 6465 6420 696e 2074 6865 2065  ppended in the e
-000089a0: 7861 6d70 6c65 7320 6162 6f76 652e 0a42  xamples above..B
-000089b0: 6563 6175 7365 2074 6865 2073 6571 7565  ecause the seque
-000089c0: 6e63 6520 6f66 2073 7472 6561 6d20 706f  nce of stream po
-000089d0: 7369 7469 6f6e 7320 6973 207a 6572 6f2d  sitions is zero-
-000089e0: 6261 7365 642c 2061 6e64 2062 6563 6175  based, and becau
-000089f0: 7365 0a74 6872 6565 2065 7665 6e74 7320  se.three events 
-00008a00: 7765 7265 2061 7070 656e 6465 642c 2073  were appended, s
-00008a10: 6f20 7468 6520 6375 7272 656e 7420 7374  o the current st
-00008a20: 7265 616d 2070 6f73 6974 696f 6e20 6973  ream position is
-00008a30: 2060 3260 2e0a 0a60 6060 7079 7468 6f6e   `2`...```python
-00008a40: 0a73 7472 6561 6d5f 706f 7369 7469 6f6e  .stream_position
-00008a50: 203d 2063 6c69 656e 742e 6765 745f 7374   = client.get_st
-00008a60: 7265 616d 5f70 6f73 6974 696f 6e28 0a20  ream_position(. 
-00008a70: 2020 2073 7472 6561 6d5f 6e61 6d65 3d73     stream_name=s
-00008a80: 7472 6561 6d5f 6e61 6d65 310a 290a 0a61  tream_name1.)..a
-00008a90: 7373 6572 7420 7374 7265 616d 5f70 6f73  ssert stream_pos
-00008aa0: 6974 696f 6e20 3d3d 2032 0a60 6060 0a0a  ition == 2.```..
-00008ab0: 4966 2061 2073 7472 6561 6d20 646f 6573  If a stream does
-00008ac0: 206e 6f74 2065 7869 7374 2c20 7468 6520   not exist, the 
-00008ad0: 7265 7475 726e 6564 2073 7472 6561 6d20  returned stream 
-00008ae0: 706f 7369 7469 6f6e 2076 616c 7565 2069  position value i
-00008af0: 7320 604e 6f6e 6560 2c0a 7768 6963 6820  s `None`,.which 
-00008b00: 6d61 7463 6865 7320 7468 6520 7265 7175  matches the requ
-00008b10: 6972 6564 2065 7870 6563 7465 6420 706f  ired expected po
-00008b20: 7369 7469 6f6e 2077 6865 6e20 6170 7065  sition when appe
-00008b30: 6e64 696e 6720 7468 6520 6669 7273 7420  nding the first 
-00008b40: 6576 656e 740a 6f66 2061 206e 6577 2073  event.of a new s
-00008b50: 7472 6561 6d20 2873 6565 2061 626f 7665  tream (see above
-00008b60: 292e 0a0a 6060 6070 7974 686f 6e0a 7374  )...```python.st
-00008b70: 7265 616d 5f70 6f73 6974 696f 6e20 3d20  ream_position = 
-00008b80: 636c 6965 6e74 2e67 6574 5f73 7472 6561  client.get_strea
-00008b90: 6d5f 706f 7369 7469 6f6e 280a 2020 2020  m_position(.    
-00008ba0: 7374 7265 616d 5f6e 616d 653d 7374 7228  stream_name=str(
-00008bb0: 7575 6964 3428 2929 0a29 0a0a 6173 7365  uuid4()).)..asse
-00008bc0: 7274 2073 7472 6561 6d5f 706f 7369 7469  rt stream_positi
-00008bd0: 6f6e 203d 3d20 4e6f 6e65 0a60 6060 0a0a  on == None.```..
-00008be0: 5468 6973 206d 6574 686f 6420 7461 6b65  This method take
-00008bf0: 7320 616e 206f 7074 696f 6e61 6c20 6172  s an optional ar
-00008c00: 6775 6d65 6e74 2060 7469 6d65 6f75 7460  gument `timeout`
-00008c10: 2077 6869 6368 2069 7320 6120 5079 7468   which is a Pyth
-00008c20: 6f6e 2060 666c 6f61 7460 2074 6861 7420  on `float` that 
-00008c30: 7365 7473 0a61 2064 6561 646c 696e 6520  sets.a deadline 
-00008c40: 666f 7220 7468 6520 636f 6d70 6c65 7469  for the completi
-00008c50: 6f6e 206f 6620 7468 6520 6752 5043 206f  on of the gRPC o
-00008c60: 7065 7261 7469 6f6e 2e0a 0a0a 2323 2320  peration....### 
-00008c70: 4765 7420 6375 7272 656e 7420 636f 6d6d  Get current comm
-00008c80: 6974 2070 6f73 6974 696f 6e0a 0a54 6865  it position..The
-00008c90: 206d 6574 686f 6420 6067 6574 5f63 6f6d   method `get_com
-00008ca0: 6d69 745f 706f 7369 7469 6f6e 2829 6020  mit_position()` 
-00008cb0: 6361 6e20 6265 2075 7365 6420 746f 2067  can be used to g
-00008cc0: 6574 2074 6865 2063 7572 7265 6e74 0a63  et the current.c
-00008cd0: 6f6d 6d69 7420 706f 7369 7469 6f6e 206f  ommit position o
-00008ce0: 6620 7468 6520 6461 7461 6261 7365 2e0a  f the database..
-00008cf0: 0a60 6060 7079 7468 6f6e 0a63 6f6d 6d69  .```python.commi
-00008d00: 745f 706f 7369 7469 6f6e 203d 2063 6c69  t_position = cli
-00008d10: 656e 742e 6765 745f 636f 6d6d 6974 5f70  ent.get_commit_p
-00008d20: 6f73 6974 696f 6e28 290a 6060 600a 0a54  osition().```..T
-00008d30: 6869 7320 6d65 7468 6f64 2074 616b 6573  his method takes
-00008d40: 2061 6e20 6f70 7469 6f6e 616c 2061 7267   an optional arg
-00008d50: 756d 656e 7420 6074 696d 656f 7574 6020  ument `timeout` 
-00008d60: 7768 6963 6820 6973 2061 2050 7974 686f  which is a Pytho
-00008d70: 6e20 6066 6c6f 6174 6020 7468 6174 2073  n `float` that s
-00008d80: 6574 730a 6120 6465 6164 6c69 6e65 2066  ets.a deadline f
-00008d90: 6f72 2074 6865 2063 6f6d 706c 6574 696f  or the completio
-00008da0: 6e20 6f66 2074 6865 2067 5250 4320 6f70  n of the gRPC op
-00008db0: 6572 6174 696f 6e2e 0a0a 5468 6973 206d  eration...This m
-00008dc0: 6574 686f 6420 6361 6e20 6265 2075 7365  ethod can be use
-00008dd0: 6675 6c20 746f 206d 6561 7375 7265 2070  ful to measure p
-00008de0: 726f 6772 6573 7320 6f66 2061 2064 6f77  rogress of a dow
-00008df0: 6e73 7472 6561 6d20 636f 6d70 6f6e 656e  nstream componen
-00008e00: 740a 7468 6174 2069 7320 7072 6f63 6573  t.that is proces
-00008e10: 7369 6e67 2061 6c6c 2072 6563 6f72 6465  sing all recorde
-00008e20: 6420 6576 656e 7473 2c20 6279 2063 6f6d  d events, by com
-00008e30: 7061 7269 6e67 2074 6865 2063 7572 7265  paring the curre
-00008e40: 6e74 2063 6f6d 6d69 740a 706f 7369 7469  nt commit.positi
-00008e50: 6f6e 2077 6974 6820 7468 6520 7265 636f  on with the reco
-00008e60: 7264 6564 2063 6f6d 6d69 7420 706f 7369  rded commit posi
-00008e70: 7469 6f6e 206f 6620 7468 6520 6c61 7374  tion of the last
-00008e80: 2073 7563 6365 7373 6675 6c6c 7920 7072   successfully pr
-00008e90: 6f63 6573 7365 640a 6576 656e 7420 696e  ocessed.event in
-00008ea0: 2061 2064 6f77 6e73 7472 6561 6d20 636f   a downstream co
-00008eb0: 6d70 6f6e 656e 742e 0a0a 5468 6520 7661  mponent...The va
-00008ec0: 6c75 6520 6f66 2074 6865 2060 636f 6d6d  lue of the `comm
-00008ed0: 6974 5f70 6f73 6974 696f 6e60 2061 7267  it_position` arg
-00008ee0: 756d 656e 7420 7768 656e 2072 6561 6469  ument when readi
-00008ef0: 6e67 2065 7665 6e74 7320 6569 7468 6572  ng events either
-00008f00: 2062 7920 7573 696e 670a 7468 6520 6072   by using.the `r
-00008f10: 6561 645f 616c 6c5f 6576 656e 7473 2829  ead_all_events()
-00008f20: 6020 6d65 7468 6f64 206f 7220 6279 2075  ` method or by u
-00008f30: 7369 6e67 2061 2063 6174 6368 2d75 7020  sing a catch-up 
-00008f40: 7375 6273 6372 6970 7469 6f6e 2077 6f75  subscription wou
-00008f50: 6c64 2075 7375 616c 6c79 0a62 6520 6465  ld usually.be de
-00008f60: 7465 726d 696e 6564 2062 7920 7468 6520  termined by the 
-00008f70: 7265 636f 7264 6564 2063 6f6d 6d69 7420  recorded commit 
-00008f80: 706f 7369 7469 6f6e 206f 6620 7468 6520  position of the 
-00008f90: 6c61 7374 2073 7563 6365 7373 6675 6c6c  last successfull
-00008fa0: 7920 7072 6f63 6573 7365 640a 6576 656e  y processed.even
-00008fb0: 7420 696e 2061 2064 6f77 6e73 7472 6561  t in a downstrea
-00008fc0: 6d20 636f 6d70 6f6e 656e 742e 0a0a 0a23  m component....#
-00008fd0: 2323 2047 6574 2073 7472 6561 6d20 6d65  ## Get stream me
-00008fe0: 7461 6461 7461 0a0a 5468 6520 6d65 7468  tadata..The meth
-00008ff0: 6f64 2060 6765 745f 7374 7265 616d 5f6d  od `get_stream_m
-00009000: 6574 6164 6174 6128 2960 2067 6574 7320  etadata()` gets 
-00009010: 7468 6520 6d65 7461 6461 7461 2066 6f72  the metadata for
-00009020: 2061 2073 7472 6561 6d2c 2061 6c6f 6e67   a stream, along
-00009030: 0a77 6974 6820 7468 6520 7665 7273 696f  .with the versio
-00009040: 6e20 6f66 2074 6865 2073 7472 6561 6d20  n of the stream 
-00009050: 6d65 7461 6461 7461 2e0a 0a60 6060 7079  metadata...```py
-00009060: 7468 6f6e 0a6d 6574 6164 6174 612c 206d  thon.metadata, m
-00009070: 6574 6164 6174 615f 7665 7273 696f 6e20  etadata_version 
-00009080: 3d20 636c 6965 6e74 2e67 6574 5f73 7472  = client.get_str
-00009090: 6561 6d5f 6d65 7461 6461 7461 2873 7472  eam_metadata(str
-000090a0: 6561 6d5f 6e61 6d65 3d73 7472 6561 6d5f  eam_name=stream_
-000090b0: 6e61 6d65 3129 0a60 6060 0a0a 5468 6520  name1).```..The 
-000090c0: 7265 7475 726e 6564 2060 6d65 7461 6461  returned `metada
-000090d0: 7461 6020 7661 6c75 6520 6973 2061 2050  ta` value is a P
-000090e0: 7974 686f 6e20 6064 6963 7460 2e20 5468  ython `dict`. Th
-000090f0: 6520 7265 7475 726e 6564 2060 6d65 7461  e returned `meta
-00009100: 6461 7461 5f76 6572 7369 6f6e 600a 7661  data_version`.va
-00009110: 6c75 6520 6973 2065 6974 6865 7220 616e  lue is either an
-00009120: 2060 696e 7460 2c20 6f72 2060 4e6f 6e65   `int`, or `None
-00009130: 6020 6966 2074 6865 2073 7472 6561 6d20  ` if the stream 
-00009140: 646f 6573 206e 6f74 2065 7869 7374 2e20  does not exist. 
-00009150: 5468 6573 6520 7661 6c75 6573 2063 616e  These values can
-00009160: 0a62 6520 7061 7373 6564 2069 6e74 6f20  .be passed into 
-00009170: 6073 6574 5f73 7472 6561 6d5f 6d65 7461  `set_stream_meta
-00009180: 6461 7461 2829 602e 0a0a 0a23 2323 2053  data()`....### S
-00009190: 6574 2073 7472 6561 6d20 6d65 7461 6461  et stream metada
-000091a0: 7461 0a0a 2a72 6571 7569 7265 7320 6c65  ta..*requires le
-000091b0: 6164 6572 2a0a 0a54 6865 206d 6574 686f  ader*..The metho
-000091c0: 6420 6073 6574 5f73 7472 6561 6d5f 6d65  d `set_stream_me
-000091d0: 7461 6461 7461 2829 6020 7365 7473 2074  tadata()` sets t
-000091e0: 6865 206d 6574 6164 6174 6120 666f 7220  he metadata for 
-000091f0: 6120 7374 7265 616d 2c20 616c 6f6e 670a  a stream, along.
-00009200: 7769 7468 2074 6865 2076 6572 7369 6f6e  with the version
-00009210: 206f 6620 7468 6520 7374 7265 616d 206d   of the stream m
-00009220: 6574 6164 6174 612e 0a0a 6060 6070 7974  etadata...```pyt
-00009230: 686f 6e0a 6d65 7461 6461 7461 5b22 666f  hon.metadata["fo
-00009240: 6f22 5d20 3d20 2262 6172 220a 0a63 6c69  o"] = "bar"..cli
-00009250: 656e 742e 7365 745f 7374 7265 616d 5f6d  ent.set_stream_m
-00009260: 6574 6164 6174 6128 0a20 2020 2073 7472  etadata(.    str
-00009270: 6561 6d5f 6e61 6d65 3d73 7472 6561 6d5f  eam_name=stream_
-00009280: 6e61 6d65 312c 0a20 2020 206d 6574 6164  name1,.    metad
-00009290: 6174 613d 6d65 7461 6461 7461 2c0a 2020  ata=metadata,.  
-000092a0: 2020 6578 7065 6374 6564 5f70 6f73 6974    expected_posit
-000092b0: 696f 6e3d 6d65 7461 6461 7461 5f76 6572  ion=metadata_ver
-000092c0: 7369 6f6e 2c0a 290a 6060 600a 0a54 6865  sion,.).```..The
-000092d0: 2060 6578 7065 6374 6564 5f70 6f73 6974   `expected_posit
-000092e0: 696f 6e60 2061 7267 756d 656e 7420 7368  ion` argument sh
-000092f0: 6f75 6c64 2062 6520 7468 6520 6375 7272  ould be the curr
-00009300: 656e 7420 7665 7273 696f 6e20 6f66 2074  ent version of t
-00009310: 6865 2073 7472 6561 6d20 6d65 7461 6461  he stream metada
-00009320: 7461 2e0a 0a50 6c65 6173 6520 7265 6665  ta...Please refe
-00009330: 7220 746f 2074 6865 2045 7665 6e74 5374  r to the EventSt
-00009340: 6f72 6544 4220 646f 6375 6d65 6e74 6174  oreDB documentat
-00009350: 696f 6e20 666f 7220 6d6f 7265 2069 6e66  ion for more inf
-00009360: 6f72 6d61 7469 6f6e 2061 626f 7574 2073  ormation about s
-00009370: 7472 6561 6d0a 6d65 7461 6461 7461 2e0a  tream.metadata..
-00009380: 0a23 2323 2044 656c 6574 6520 7374 7265  .### Delete stre
-00009390: 616d 0a0a 2a72 6571 7569 7265 7320 6c65  am..*requires le
-000093a0: 6164 6572 2a0a 0a54 6865 206d 6574 686f  ader*..The metho
-000093b0: 6420 6064 656c 6574 655f 7374 7265 616d  d `delete_stream
-000093c0: 2829 6020 6361 6e20 6265 2075 7365 6420  ()` can be used 
-000093d0: 746f 2022 6465 6c65 7465 2220 6120 7374  to "delete" a st
-000093e0: 7265 616d 2e0a 0a60 6060 7079 7468 6f6e  ream...```python
-000093f0: 0a63 6f6d 6d69 745f 706f 7369 7469 6f6e  .commit_position
-00009400: 203d 2063 6c69 656e 742e 6465 6c65 7465   = client.delete
-00009410: 5f73 7472 6561 6d28 7374 7265 616d 5f6e  _stream(stream_n
-00009420: 616d 653d 7374 7265 616d 5f6e 616d 6531  ame=stream_name1
-00009430: 2c20 6578 7065 6374 6564 5f70 6f73 6974  , expected_posit
-00009440: 696f 6e3d 3229 0a60 6060 0a0a 4166 7465  ion=2).```..Afte
-00009450: 7220 6465 6c65 7469 6e67 2061 2073 7472  r deleting a str
-00009460: 6561 6d2c 2069 7427 7320 7374 696c 6c20  eam, it's still 
-00009470: 706f 7373 6962 6c65 2074 6f20 6170 7065  possible to appe
-00009480: 6e64 206e 6577 2065 7665 6e74 732e 2052  nd new events. R
-00009490: 6561 6469 6e67 2066 726f 6d20 610a 6465  eading from a.de
-000094a0: 6c65 7465 6420 7374 7265 616d 2077 696c  leted stream wil
-000094b0: 6c20 7265 7475 726e 206f 6e6c 7920 6576  l return only ev
-000094c0: 656e 7473 2074 6861 7420 6861 7665 2062  ents that have b
-000094d0: 6565 6e20 6170 7065 6e64 6564 2061 6674  een appended aft
-000094e0: 6572 2069 7420 7761 730a 6465 6c65 7465  er it was.delete
-000094f0: 642e 0a0a 2323 2320 546f 6d62 7374 6f6e  d...### Tombston
-00009500: 6520 7374 7265 616d 0a0a 2a72 6571 7569  e stream..*requi
-00009510: 7265 7320 6c65 6164 6572 2a0a 0a54 6865  res leader*..The
-00009520: 206d 6574 686f 6420 6074 6f6d 6273 746f   method `tombsto
-00009530: 6e65 5f73 7472 6561 6d28 2960 2063 616e  ne_stream()` can
-00009540: 2062 6520 7573 6564 2074 6f20 2274 6f6d   be used to "tom
-00009550: 6273 746f 6e65 2220 6120 7374 7265 616d  bstone" a stream
-00009560: 2e0a 0a60 6060 7079 7468 6f6e 0a63 6f6d  ...```python.com
-00009570: 6d69 745f 706f 7369 7469 6f6e 203d 2063  mit_position = c
-00009580: 6c69 656e 742e 746f 6d62 7374 6f6e 655f  lient.tombstone_
-00009590: 7374 7265 616d 2873 7472 6561 6d5f 6e61  stream(stream_na
-000095a0: 6d65 3d73 7472 6561 6d5f 6e61 6d65 312c  me=stream_name1,
-000095b0: 2065 7870 6563 7465 645f 706f 7369 7469   expected_positi
-000095c0: 6f6e 3d32 290a 6060 600a 0a41 6674 6572  on=2).```..After
-000095d0: 2074 6f6d 6273 746f 6e69 6e67 2061 2073   tombstoning a s
-000095e0: 7472 6561 6d2c 2069 7427 7320 6e6f 7420  tream, it's not 
-000095f0: 706f 7373 6962 6c65 2074 6f20 6170 7065  possible to appe
-00009600: 6e64 206e 6577 2065 7665 6e74 732e 0a0a  nd new events...
-00009610: 0a23 2320 4361 7463 682d 7570 2073 7562  .## Catch-up sub
-00009620: 7363 7269 7074 696f 6e73 0a0a 2243 6174  scriptions.."Cat
-00009630: 6368 2d75 7022 2073 7562 7363 7269 7074  ch-up" subscript
-00009640: 696f 6e73 2063 616e 2062 6520 7573 6564  ions can be used
-00009650: 2074 6f20 7265 6365 6976 6520 6576 656e   to receive even
-00009660: 7473 2074 6861 7420 6861 7665 2062 6565  ts that have bee
-00009670: 6e20 7265 636f 7264 6564 0a69 6e20 7468  n recorded.in th
-00009680: 6520 6461 7461 6261 7365 2c20 616e 6420  e database, and 
-00009690: 616c 736f 2065 7665 6e74 7320 7468 6174  also events that
-000096a0: 2061 7265 2072 6563 6f72 6465 6420 6166   are recorded af
-000096b0: 7465 7220 6120 7375 6273 6372 6970 7469  ter a subscripti
-000096c0: 6f6e 2077 6173 2073 7461 7274 6564 2e0a  on was started..
-000096d0: 0a54 6865 206d 6574 686f 6420 6073 7562  .The method `sub
-000096e0: 7363 7269 6265 5f61 6c6c 5f65 7665 6e74  scribe_all_event
-000096f0: 7328 2960 2073 7461 7274 7320 6120 6361  s()` starts a ca
-00009700: 7463 682d 7570 2073 7562 7363 7269 7074  tch-up subscript
-00009710: 696f 6e20 746f 2072 6563 6569 7665 2061  ion to receive a
-00009720: 6c6c 0a65 7665 6e74 7320 7468 6174 2068  ll.events that h
-00009730: 6176 6520 6265 656e 2061 6e64 2077 696c  ave been and wil
-00009740: 6c20 6265 2072 6563 6f72 6465 6420 696e  l be recorded in
-00009750: 2074 6865 2064 6174 6162 6173 652e 2054   the database. T
-00009760: 6865 206d 6574 686f 640a 6073 7562 7363  he method.`subsc
-00009770: 7269 6265 5f73 7472 6561 6d5f 6576 656e  ribe_stream_even
-00009780: 7473 2829 6020 7374 6172 7473 2061 2063  ts()` starts a c
-00009790: 6174 6368 2d75 7020 7375 6273 6372 6970  atch-up subscrip
-000097a0: 7469 6f6e 2074 6f20 7265 6365 6976 6520  tion to receive 
-000097b0: 6576 656e 7473 2066 726f 6d0a 6120 7370  events from.a sp
-000097c0: 6563 6966 6963 2073 7472 6561 6d2e 0a0a  ecific stream...
-000097d0: 4361 7463 682d 7570 2073 7562 7363 7269  Catch-up subscri
-000097e0: 7074 696f 6e73 2065 6e63 6170 7375 6c61  ptions encapsula
-000097f0: 7465 2061 2073 7472 6561 6d69 6e67 2067  te a streaming g
-00009800: 5250 4320 6361 6c6c 2077 6869 6368 2069  RPC call which i
-00009810: 730a 6b65 7074 206f 7065 6e20 6279 2074  s.kept open by t
-00009820: 6865 2073 6572 7665 722c 2077 6974 6820  he server, with 
-00009830: 6e65 776c 7920 7265 636f 7264 6564 2065  newly recorded e
-00009840: 7665 6e74 7320 7365 6e74 2074 6f20 7468  vents sent to th
-00009850: 6520 636c 6965 6e74 0a61 7320 7468 6520  e client.as the 
-00009860: 636c 6965 6e74 2069 7465 7261 7465 7320  client iterates 
-00009870: 6f76 6572 2074 6865 2073 7562 7363 7269  over the subscri
-00009880: 7074 696f 6e20 7265 7370 6f6e 7365 2e0a  ption response..
-00009890: 0a4d 616e 7920 6361 7463 682d 7570 2073  .Many catch-up s
-000098a0: 7562 7363 7269 7074 696f 6e73 2063 616e  ubscriptions can
-000098b0: 2062 6520 6372 6561 7465 642c 2063 6f6e   be created, con
-000098c0: 6375 7272 656e 746c 7920 6f72 2073 7563  currently or suc
-000098d0: 6365 7373 6976 656c 792c 2061 6e64 2061  cessively, and a
-000098e0: 6c6c 0a77 696c 6c20 7265 6365 6976 6520  ll.will receive 
-000098f0: 616c 6c20 7468 6520 7265 636f 7264 6564  all the recorded
-00009900: 2065 7665 6e74 7320 7468 6579 2068 6176   events they hav
-00009910: 6520 6265 656e 2072 6571 7565 7374 6564  e been requested
-00009920: 2074 6f20 7265 6365 6976 652e 0a0a 5468   to receive...Th
-00009930: 6520 7265 6365 6976 6564 2072 6563 6f72  e received recor
-00009940: 6465 6420 6576 656e 7420 6f62 6a65 6374  ded event object
-00009950: 2061 7265 2069 6e73 7461 6e63 6573 206f   are instances o
-00009960: 6620 7468 6520 6052 6563 6f72 6465 6445  f the `RecordedE
-00009970: 7665 6e74 6020 636c 6173 730a 2873 6565  vent` class.(see
-00009980: 2062 656c 6f77 292e 0a0a 2323 2320 486f   below)...### Ho
-00009990: 7720 746f 2069 6d70 6c65 6d65 6e74 2065  w to implement e
-000099a0: 7861 6374 6c79 2d6f 6e63 6520 6576 656e  xactly-once even
-000099b0: 7420 7072 6f63 6573 7369 6e67 0a0a 5468  t processing..Th
-000099c0: 6520 636f 6d6d 6974 2070 6f73 6974 696f  e commit positio
-000099d0: 6e73 206f 6620 7265 636f 7264 6564 2065  ns of recorded e
-000099e0: 7665 6e74 7320 7468 6174 2061 7265 2072  vents that are r
-000099f0: 6563 6569 7665 6420 616e 6420 7072 6f63  eceived and proc
-00009a00: 6573 7365 6420 6279 2061 0a64 6f77 6e73  essed by a.downs
-00009a10: 7472 6561 6d20 636f 6d70 6f6e 656e 7420  tream component 
-00009a20: 6172 6520 7573 6566 756c 6c79 2072 6563  are usefully rec
-00009a30: 6f72 6465 6420 6279 2074 6865 2064 6f77  orded by the dow
-00009a40: 6e73 7472 6561 6d20 636f 6d70 6f6e 656e  nstream componen
-00009a50: 7420 736f 2074 6861 740a 7468 6520 636f  t so that.the co
-00009a60: 6d6d 6974 2070 6f73 6974 696f 6e20 6f66  mmit position of
-00009a70: 206c 6173 7420 7072 6f63 6573 7365 6420   last processed 
-00009a80: 6576 656e 7420 6361 6e20 6265 2064 6574  event can be det
-00009a90: 6572 6d69 6e65 642e 0a0a 5468 6520 6c61  ermined...The la
-00009aa0: 7374 2072 6563 6f72 6465 6420 636f 6d6d  st recorded comm
-00009ab0: 6974 2070 6f73 6974 696f 6e20 6361 6e20  it position can 
-00009ac0: 6265 2075 7365 6420 746f 2073 7065 6369  be used to speci
-00009ad0: 6679 2074 6865 2063 6f6d 6d69 7420 706f  fy the commit po
-00009ae0: 7369 7469 6f6e 2066 726f 6d20 7768 6963  sition from whic
-00009af0: 680a 746f 2073 7562 7363 7269 6265 2077  h.to subscribe w
-00009b00: 6865 6e20 7072 6f63 6573 7369 6e67 2069  hen processing i
-00009b10: 7320 7265 7375 6d65 642e 2053 696e 6365  s resumed. Since
-00009b20: 2074 6869 7320 636f 6d6d 6974 2070 6f73   this commit pos
-00009b30: 6974 696f 6e20 7769 6c6c 2072 6570 7265  ition will repre
-00009b40: 7365 6e74 2074 6865 0a70 6f73 6974 696f  sent the.positio
-00009b50: 6e20 6f66 2074 6865 206c 6173 7420 7375  n of the last su
-00009b60: 6363 6573 7366 756c 6c79 2070 726f 6365  ccessfully proce
-00009b70: 7373 6564 2065 7665 6e74 2069 6e20 6120  ssed event in a 
-00009b80: 646f 776e 7374 7265 616d 2063 6f6d 706f  downstream compo
-00009b90: 6e65 6e74 2c20 736f 2069 740a 7769 6c6c  nent, so it.will
-00009ba0: 2062 6520 7573 7561 6c20 746f 2077 616e   be usual to wan
-00009bb0: 7420 7468 6520 6e65 7874 2065 7665 6e74  t the next event
-00009bc0: 2061 6674 6572 2074 6869 7320 706f 7369   after this posi
-00009bd0: 7469 6f6e 2c20 6265 6361 7573 6520 7468  tion, because th
-00009be0: 6174 2069 7320 7468 6520 6e65 7874 0a65  at is the next.e
-00009bf0: 7665 6e74 2074 6861 7420 6861 7320 6e6f  vent that has no
-00009c00: 7420 7965 7420 6265 656e 2070 726f 6365  t yet been proce
-00009c10: 7373 6564 2e20 466f 7220 7468 6973 2072  ssed. For this r
-00009c20: 6561 736f 6e2c 2077 6865 6e20 7375 6273  eason, when subs
-00009c30: 6372 6962 696e 6720 666f 7220 6576 656e  cribing for even
-00009c40: 7473 0a66 726f 6d20 6120 7370 6563 6966  ts.from a specif
-00009c50: 6963 2063 6f6d 6d69 7420 706f 7369 7469  ic commit positi
-00009c60: 6f6e 2075 7369 6e67 2061 2063 6174 6368  on using a catch
-00009c70: 2d75 7020 7375 6273 6372 6970 7469 6f6e  -up subscription
-00009c80: 2069 6e20 4576 656e 7453 746f 7265 4442   in EventStoreDB
-00009c90: 2c20 7468 650a 7265 636f 7264 6564 2065  , the.recorded e
-00009ca0: 7665 6e74 2061 7420 7468 6520 7370 6563  vent at the spec
-00009cb0: 6966 6965 6420 636f 6d6d 6974 2070 6f73  ified commit pos
-00009cc0: 6974 696f 6e20 7769 6c6c 204e 4f54 2062  ition will NOT b
-00009cd0: 6520 696e 636c 7564 6564 2069 6e20 7468  e included in th
-00009ce0: 6520 7365 7175 656e 6365 0a6f 6620 7265  e sequence.of re
-00009cf0: 636f 7264 6564 2065 7665 6e74 7320 7468  corded events th
-00009d00: 6174 2061 7265 2072 6563 6569 7665 642e  at are received.
-00009d10: 0a0a 546f 2061 6363 6f6d 706c 6973 6820  ..To accomplish 
-00009d20: 2265 7861 6374 6c79 2d6f 6e63 6522 2070  "exactly-once" p
-00009d30: 726f 6365 7373 696e 6720 6f66 2072 6563  rocessing of rec
-00009d40: 6f72 6465 6420 6576 656e 7473 2069 6e20  orded events in 
-00009d50: 6120 646f 776e 7374 7265 616d 0a63 6f6d  a downstream.com
-00009d60: 706f 6e65 6e74 2077 6865 6e20 7573 696e  ponent when usin
-00009d70: 6720 6120 6361 7463 682d 7570 2073 7562  g a catch-up sub
-00009d80: 7363 7269 7074 696f 6e2c 2074 6865 2063  scription, the c
-00009d90: 6f6d 6d69 7420 706f 7369 7469 6f6e 206f  ommit position o
-00009da0: 6620 6120 7265 636f 7264 6564 0a65 7665  f a recorded.eve
-00009db0: 6e74 2073 686f 756c 6420 6265 2072 6563  nt should be rec
-00009dc0: 6f72 6465 6420 6174 6f6d 6963 616c 6c79  orded atomically
-00009dd0: 2061 6e64 2075 6e69 7175 656c 7920 616c   and uniquely al
-00009de0: 6f6e 6720 7769 7468 2074 6865 2072 6573  ong with the res
-00009df0: 756c 7420 6f66 2070 726f 6365 7373 696e  ult of processin
-00009e00: 670a 7265 636f 7264 6564 2065 7665 6e74  g.recorded event
-00009e10: 732c 2066 6f72 2065 7861 6d70 6c65 2069  s, for example i
-00009e20: 6e20 7468 6520 7361 6d65 2064 6174 6162  n the same datab
-00009e30: 6173 6520 6173 206d 6174 6572 6961 6c69  ase as materiali
-00009e40: 7365 6420 7669 6577 7320 7768 656e 0a69  sed views when.i
-00009e50: 6d70 6c65 6d65 6e74 696e 6720 6576 656e  mplementing even
-00009e60: 7475 616c 6c79 2d63 6f6e 7369 7374 656e  tually-consisten
-00009e70: 7420 4351 5253 2c20 6f72 2069 6e20 7468  t CQRS, or in th
-00009e80: 6520 7361 6d65 2064 6174 6162 6173 6520  e same database 
-00009e90: 6173 2061 2064 6f77 6e73 7472 6561 6d0a  as a downstream.
-00009ea0: 616e 616c 7974 6963 7320 6f72 2072 6570  analytics or rep
-00009eb0: 6f72 7469 6e67 206f 7220 6172 6368 6976  orting or archiv
-00009ec0: 696e 6720 6170 706c 6963 6174 696f 6e2e  ing application.
-00009ed0: 2042 7920 7265 636f 7264 696e 6720 7468   By recording th
-00009ee0: 6520 636f 6d6d 6974 2070 6f73 6974 696f  e commit positio
-00009ef0: 6e0a 6f66 2072 6563 6f72 6465 6420 6576  n.of recorded ev
-00009f00: 656e 7473 2061 746f 6d69 6361 6c6c 7920  ents atomically 
-00009f10: 7769 7468 2074 6865 206e 6577 2073 7461  with the new sta
-00009f20: 7465 2074 6861 7420 7265 7375 6c74 7320  te that results 
-00009f30: 6672 6f6d 2070 726f 6365 7373 696e 670a  from processing.
-00009f40: 7265 636f 7264 6564 2065 7665 6e74 732c  recorded events,
-00009f50: 2022 6475 616c 2077 7269 7469 6e67 2220   "dual writing" 
-00009f60: 696e 2074 6865 2063 6f6e 7375 6d70 7469  in the consumpti
-00009f70: 6f6e 206f 6620 7265 636f 7264 6564 2065  on of recorded e
-00009f80: 7665 6e74 7320 6361 6e20 6265 0a61 766f  vents can be.avo
-00009f90: 6964 6564 2e20 4279 2061 6c73 6f20 7265  ided. By also re
-00009fa0: 636f 7264 696e 6720 7468 6520 636f 6d6d  cording the comm
-00009fb0: 6974 2070 6f73 6974 696f 6e20 756e 6971  it position uniq
-00009fc0: 7565 6c79 2c20 7468 6520 6e65 7720 7374  uely, the new st
-00009fd0: 6174 6520 6361 6e6e 6f74 2062 650a 7265  ate cannot be.re
-00009fe0: 636f 7264 6564 2074 7769 6365 2c20 616e  corded twice, an
-00009ff0: 6420 6865 6e63 6520 7468 6520 7265 636f  d hence the reco
-0000a000: 7264 6564 2073 7461 7465 206f 6620 7468  rded state of th
-0000a010: 6520 646f 776e 7374 7265 616d 2063 6f6d  e downstream com
-0000a020: 706f 6e65 6e74 2077 696c 6c20 6265 0a75  ponent will be.u
-0000a030: 7064 6174 6564 206f 6e6c 7920 6f6e 6365  pdated only once
-0000a040: 2066 6f72 2061 6e79 2072 6563 6f72 6465   for any recorde
-0000a050: 6420 6576 656e 742e 2042 7920 7573 696e  d event. By usin
-0000a060: 6720 7468 6520 6772 6561 7465 7374 2072  g the greatest r
-0000a070: 6563 6f72 6465 6420 636f 6d6d 6974 0a70  ecorded commit.p
-0000a080: 6f73 6974 696f 6e20 746f 2072 6573 756d  osition to resum
-0000a090: 6520 6120 6361 7463 682d 7570 2073 7562  e a catch-up sub
-0000a0a0: 7363 7269 7074 696f 6e2c 2061 6c6c 2072  scription, all r
-0000a0b0: 6563 6f72 6465 6420 6576 656e 7473 2077  ecorded events w
-0000a0c0: 696c 6c20 6576 656e 7475 616c 6c79 0a62  ill eventually.b
-0000a0d0: 6520 7072 6f63 6573 7365 642e 2054 6865  e processed. The
-0000a0e0: 2063 6f6d 6269 6e61 7469 6f6e 206f 6620   combination of 
-0000a0f0: 7468 6520 2261 742d 6d6f 7374 2d6f 6e63  the "at-most-onc
-0000a100: 6522 2063 6f6e 6469 7469 6f6e 2061 6e64  e" condition and
-0000a110: 2074 6865 2022 6174 2d6c 6561 7374 2d6f   the "at-least-o
-0000a120: 6e63 6522 0a63 6f6e 6469 7469 6f6e 2067  nce".condition g
-0000a130: 6976 6573 2074 6865 2022 6578 6163 746c  ives the "exactl
-0000a140: 792d 6f6e 6365 2220 636f 6e64 6974 696f  y-once" conditio
-0000a150: 6e2e 0a0a 5468 6520 6461 6e67 6572 2077  n...The danger w
-0000a160: 6974 6820 2264 7561 6c20 7772 6974 696e  ith "dual writin
-0000a170: 6722 2069 6e20 7468 6520 636f 6e73 756d  g" in the consum
-0000a180: 7074 696f 6e20 6f66 2072 6563 6f72 6465  ption of recorde
-0000a190: 6420 6576 656e 7473 2069 7320 7468 6174  d events is that
-0000a1a0: 2069 6620 610a 7265 636f 7264 6564 2065   if a.recorded e
-0000a1b0: 7665 6e74 2069 7320 7375 6363 6573 7366  vent is successf
-0000a1c0: 756c 6c79 2070 726f 6365 7373 6564 2061  ully processed a
-0000a1d0: 6e64 206e 6577 2073 7461 7465 2072 6563  nd new state rec
-0000a1e0: 6f72 6465 6420 6174 6f6d 6963 616c 6c79  orded atomically
-0000a1f0: 2069 6e20 6f6e 650a 7472 616e 7361 6374   in one.transact
-0000a200: 696f 6e20 7769 7468 2074 6865 2063 6f6d  ion with the com
-0000a210: 6d69 7420 706f 7369 7469 6f6e 2072 6563  mit position rec
-0000a220: 6f72 6465 6420 696e 2061 2073 6570 6172  orded in a separ
-0000a230: 6174 6520 7472 616e 7361 6374 696f 6e2c  ate transaction,
-0000a240: 206f 6e65 206d 6179 0a68 6170 7065 6e20   one may.happen 
-0000a250: 616e 6420 6e6f 7420 7468 6520 6f74 6865  and not the othe
-0000a260: 722e 2049 6620 7468 6520 6e65 7720 7374  r. If the new st
-0000a270: 6174 6520 6973 2072 6563 6f72 6465 6420  ate is recorded 
-0000a280: 6275 7420 7468 6520 706f 7369 7469 6f6e  but the position
-0000a290: 2069 7320 6c6f 7374 2c0a 616e 6420 7468   is lost,.and th
-0000a2a0: 656e 2074 6865 2070 726f 6365 7373 696e  en the processin
-0000a2b0: 6720 6973 2073 746f 7070 6564 2061 6e64  g is stopped and
-0000a2c0: 2072 6573 756d 6564 2c20 7468 6520 7265   resumed, the re
-0000a2d0: 636f 7264 6564 2065 7665 6e74 206d 6179  corded event may
-0000a2e0: 2062 6520 7072 6f63 6573 7365 640a 7477   be processed.tw
-0000a2f0: 6963 652e 204f 6e20 7468 6520 6f74 6865  ice. On the othe
-0000a300: 7220 6861 6e64 2c20 6966 2074 6865 2063  r hand, if the c
-0000a310: 6f6d 6d69 7420 706f 7369 7469 6f6e 2069  ommit position i
-0000a320: 7320 7265 636f 7264 6564 2062 7574 2074  s recorded but t
-0000a330: 6865 206e 6577 2073 7461 7465 2069 730a  he new state is.
-0000a340: 6c6f 7374 2c20 7468 6520 7265 636f 7264  lost, the record
-0000a350: 6564 2065 7665 6e74 206d 6179 2065 6666  ed event may eff
-0000a360: 6563 7469 7665 6c79 206e 6f74 2062 6520  ectively not be 
-0000a370: 7072 6f63 6573 7365 6420 6174 2061 6c6c  processed at all
-0000a380: 2e20 4279 2065 6974 6865 720a 7072 6f63  . By either.proc
-0000a390: 6573 7369 6e67 2061 6e20 6576 656e 7420  essing an event 
-0000a3a0: 6d6f 7265 2074 6861 6e20 6f6e 6365 2c20  more than once, 
-0000a3b0: 6f72 2062 7920 6661 696c 696e 6720 746f  or by failing to
-0000a3c0: 2070 726f 6365 7373 2061 6e20 6576 656e   process an even
-0000a3d0: 742c 2074 6865 2072 6563 6f72 6465 640a  t, the recorded.
-0000a3e0: 7374 6174 6520 6f66 2074 6865 2064 6f77  state of the dow
-0000a3f0: 6e73 7472 6561 6d20 636f 6d70 6f6e 656e  nstream componen
-0000a400: 7420 6d69 6768 7420 6265 2069 6e61 6363  t might be inacc
-0000a410: 7572 6174 652c 206f 7220 706f 7373 6962  urate, or possib
-0000a420: 6c79 2069 6e63 6f6e 7369 7374 656e 742c  ly inconsistent,
-0000a430: 2061 6e64 0a70 6572 6861 7073 2063 6174   and.perhaps cat
-0000a440: 6173 7472 6f70 6869 6361 6c6c 7920 736f  astrophically so
-0000a450: 2e20 5375 6368 2063 6f6e 7365 7175 656e  . Such consequen
-0000a460: 6365 7320 6d61 7920 6f72 206d 6179 206e  ces may or may n
-0000a470: 6f74 206d 6174 7465 7220 696e 2079 6f75  ot matter in you
-0000a480: 7220 7369 7475 6174 696f 6e2e 0a42 7574  r situation..But
-0000a490: 2073 6f6d 6574 696d 6573 2069 6e63 6f6e   sometimes incon
-0000a4a0: 7369 7374 656e 6369 6573 206d 6179 2068  sistencies may h
-0000a4b0: 616c 7420 7072 6f63 6573 7369 6e67 2075  alt processing u
-0000a4c0: 6e74 696c 2074 6865 2069 7373 7565 2069  ntil the issue i
-0000a4d0: 7320 7265 736f 6c76 6564 2e20 596f 7520  s resolved. You 
-0000a4e0: 6361 6e0a 6176 6f69 6420 2264 7561 6c20  can.avoid "dual 
-0000a4f0: 7772 6974 696e 6722 2069 6e20 7468 6520  writing" in the 
-0000a500: 636f 6e73 756d 7074 696f 6e20 6f66 2065  consumption of e
-0000a510: 7665 6e74 7320 6279 2061 746f 6d69 6361  vents by atomica
-0000a520: 6c6c 7920 7265 636f 7264 696e 6720 7468  lly recording th
-0000a530: 6520 636f 6d6d 6974 0a70 6f73 6974 696f  e commit.positio
-0000a540: 6e20 6f66 2061 2072 6563 6f72 6465 6420  n of a recorded 
-0000a550: 6576 656e 7420 616c 6f6e 6720 7769 7468  event along with
-0000a560: 2074 6865 206e 6577 2073 7461 7465 2074   the new state t
-0000a570: 6861 7420 7265 7375 6c74 7320 6672 6f6d  hat results from
-0000a580: 2070 726f 6365 7373 696e 6720 7468 6174   processing that
-0000a590: 0a65 7665 6e74 2069 6e20 7468 6520 7361  .event in the sa
-0000a5a0: 6d65 2061 746f 6d69 6320 7472 616e 7361  me atomic transa
-0000a5b0: 6374 696f 6e2e 2042 7920 6d61 6b69 6e67  ction. By making
-0000a5c0: 2074 6865 2072 6563 6f72 6469 6e67 206f   the recording o
-0000a5d0: 6620 7468 6520 636f 6d6d 6974 2070 6f73  f the commit pos
-0000a5e0: 6974 696f 6e73 0a75 6e69 7175 652c 2073  itions.unique, s
-0000a5f0: 6f20 7468 6174 2074 7261 6e73 6163 7469  o that transacti
-0000a600: 6f6e 7320 7769 6c6c 2062 6520 726f 6c6c  ons will be roll
-0000a610: 6564 2062 6163 6b20 7768 656e 2074 6865  ed back when the
-0000a620: 7265 2069 7320 6120 636f 6e66 6c69 6374  re is a conflict
-0000a630: 2c20 796f 7520 7769 6c6c 0a70 7265 7665  , you will.preve
-0000a640: 6e74 2074 6865 2072 6573 756c 7473 206f  nt the results o
-0000a650: 6620 616e 7920 6475 706c 6963 6174 6520  f any duplicate 
-0000a660: 7072 6f63 6573 7369 6e67 206f 6620 6120  processing of a 
-0000a670: 7265 636f 7264 6564 2065 7665 6e74 2062  recorded event b
-0000a680: 6569 6e67 2063 6f6d 6d69 7474 6564 2e0a  eing committed..
-0000a690: 0a52 6563 6f72 6465 6420 6576 656e 7473  .Recorded events
-0000a6a0: 2072 6563 6569 7665 6420 6672 6f6d 2061   received from a
-0000a6b0: 2063 6174 6368 2d75 7020 7375 6273 6372   catch-up subscr
-0000a6c0: 6970 7469 6f6e 2063 616e 6e6f 7420 6265  iption cannot be
-0000a6d0: 2061 636b 6e6f 776c 6564 6765 6420 6261   acknowledged ba
-0000a6e0: 636b 0a74 6f20 7468 6520 4576 656e 7453  ck.to the EventS
-0000a6f0: 746f 7265 4442 2073 6572 7665 722e 2041  toreDB server. A
-0000a700: 636b 6e6f 776c 6564 6769 6e67 2065 7665  cknowledging eve
-0000a710: 6e74 732c 2068 6f77 6576 6572 2c20 6973  nts, however, is
-0000a720: 2061 6e20 6173 7065 6374 206f 6620 2270   an aspect of "p
-0000a730: 6572 7369 7374 656e 740a 7375 6273 6372  ersistent.subscr
-0000a740: 6970 7469 6f6e 7322 2028 7365 6520 6265  iptions" (see be
-0000a750: 6c6f 7729 2e20 486f 7069 6e67 2074 6f20  low). Hoping to 
-0000a760: 7265 6c79 206f 6e20 6163 6b6e 6f77 6c65  rely on acknowle
-0000a770: 6467 696e 6720 6576 656e 7473 2074 6f20  dging events to 
-0000a780: 616e 2075 7073 7472 6561 6d0a 636f 6d70  an upstream.comp
-0000a790: 6f6e 656e 7420 6973 2061 6e20 6578 616d  onent is an exam
-0000a7a0: 706c 6520 6f66 2064 7561 6c20 7772 6974  ple of dual writ
-0000a7b0: 696e 672e 0a0a 2323 2320 5375 6273 6372  ing...### Subscr
-0000a7c0: 6962 6520 616c 6c20 6576 656e 7473 0a0a  ibe all events..
-0000a7d0: 5468 6560 7375 6273 6372 6962 655f 616c  The`subscribe_al
-0000a7e0: 6c5f 6576 656e 7473 2829 6020 6d65 7468  l_events()` meth
-0000a7f0: 6f64 2063 616e 2062 6520 7573 6564 2074  od can be used t
-0000a800: 6f20 7374 6172 7420 6120 2263 6174 6368  o start a "catch
-0000a810: 2d75 7022 2073 7562 7363 7269 7074 696f  -up" subscriptio
-0000a820: 6e0a 7468 6174 2063 616e 2072 6574 7572  n.that can retur
-0000a830: 6e20 6576 656e 7473 2066 726f 6d20 616c  n events from al
-0000a840: 6c20 7374 7265 616d 7320 696e 2074 6865  l streams in the
-0000a850: 2064 6174 6162 6173 652e 0a0a 5468 6973   database...This
-0000a860: 206d 6574 686f 6420 6361 6e20 6265 2075   method can be u
-0000a870: 7365 6420 6279 2061 2064 6f77 6e73 7472  sed by a downstr
-0000a880: 6561 6d20 636f 6d70 6f6e 656e 740a 746f  eam component.to
-0000a890: 2070 726f 6365 7373 2072 6563 6f72 6465   process recorde
-0000a8a0: 6420 6576 656e 7473 2077 6974 6820 6578  d events with ex
-0000a8b0: 6163 746c 792d 6f6e 6365 2073 656d 616e  actly-once seman
-0000a8c0: 7469 6373 2e0a 0a54 6869 7320 6d65 7468  tics...This meth
-0000a8d0: 6f64 2074 616b 6573 2061 6e20 6f70 7469  od takes an opti
-0000a8e0: 6f6e 616c 2060 636f 6d6d 6974 5f70 6f73  onal `commit_pos
-0000a8f0: 6974 696f 6e60 2061 7267 756d 656e 742c  ition` argument,
-0000a900: 2077 6869 6368 2063 616e 2062 650a 7573   which can be.us
-0000a910: 6564 2074 6f20 7370 6563 6966 7920 6120  ed to specify a 
-0000a920: 636f 6d6d 6974 2070 6f73 6974 696f 6e20  commit position 
-0000a930: 6672 6f6d 2077 6869 6368 2074 6f20 7375  from which to su
-0000a940: 6273 6372 6962 652e 2054 6865 2064 6566  bscribe. The def
-0000a950: 6175 6c74 0a76 616c 7565 2069 7320 604e  ault.value is `N
-0000a960: 6f6e 6560 2c20 7768 6963 6820 6d65 616e  one`, which mean
-0000a970: 7320 7468 6520 7375 6273 6372 6970 7469  s the subscripti
-0000a980: 6f6e 2077 696c 6c20 6f70 6572 6174 6520  on will operate 
-0000a990: 6672 6f6d 2074 6865 2066 6972 7374 0a72  from the first.r
-0000a9a0: 6563 6f72 6465 6420 6576 656e 7420 696e  ecorded event in
-0000a9b0: 2074 6865 2064 6174 6162 6173 652e 2049   the database. I
-0000a9c0: 6620 6120 636f 6d6d 6974 2070 6f73 6974  f a commit posit
-0000a9d0: 696f 6e20 6973 2067 6976 656e 2c20 6974  ion is given, it
-0000a9e0: 206d 7573 7420 6d61 7463 680a 616e 2061   must match.an a
-0000a9f0: 6374 7561 6c6c 7920 6578 6973 7469 6e67  ctually existing
-0000aa00: 2063 6f6d 6d69 7420 706f 7369 7469 6f6e   commit position
-0000aa10: 2069 6e20 7468 6520 6461 7461 6261 7365   in the database
-0000aa20: 2e20 5468 6520 7265 636f 6465 6420 6576  . The recoded ev
-0000aa30: 656e 7473 2074 6861 740a 6172 6520 6f62  ents that.are ob
-0000aa40: 7461 696e 6564 2077 696c 6c20 6e6f 7420  tained will not 
-0000aa50: 696e 636c 7564 6520 7468 6520 6576 656e  include the even
-0000aa60: 7420 7265 636f 7264 6564 2061 7420 7468  t recorded at th
-0000aa70: 6174 2063 6f6d 6d69 7420 706f 7369 7469  at commit positi
-0000aa80: 6f6e 2e0a 0a54 6869 7320 6d65 7468 6f64  on...This method
-0000aa90: 2061 6c73 6f20 7461 6b65 7320 666f 7572   also takes four
-0000aaa0: 206f 7468 6572 206f 7074 696f 6e61 6c20   other optional 
-0000aab0: 6172 6775 6d65 6e74 732c 2060 6669 6c74  arguments, `filt
-0000aac0: 6572 5f65 7863 6c75 6465 602c 0a60 6669  er_exclude`,.`fi
-0000aad0: 6c74 6572 5f69 6e63 6c75 6465 602c 2060  lter_include`, `
-0000aae0: 6669 6c74 6572 5f62 795f 7374 7265 616d  filter_by_stream
-0000aaf0: 5f6e 616d 6560 2c20 616e 6420 6074 696d  _name`, and `tim
-0000ab00: 656f 7574 602e 0a0a 5468 6520 6f70 7469  eout`...The opti
-0000ab10: 6f6e 616c 2061 7267 756d 656e 7420 6066  onal argument `f
-0000ab20: 696c 7465 725f 6578 636c 7564 6560 2069  ilter_exclude` i
-0000ab30: 7320 6120 7365 7175 656e 6365 206f 6620  s a sequence of 
-0000ab40: 7265 6775 6c61 7220 6578 7072 6573 7369  regular expressi
-0000ab50: 6f6e 7320 7468 6174 0a6d 6174 6368 2072  ons that.match r
-0000ab60: 6563 6f72 6465 6420 6576 656e 7473 2074  ecorded events t
-0000ab70: 6861 7420 7368 6f75 6c64 206e 6f74 2062  hat should not b
-0000ab80: 6520 696e 636c 7564 6564 2e20 5468 6973  e included. This
-0000ab90: 2061 7267 756d 656e 7420 6973 2069 676e   argument is ign
-0000aba0: 6f72 6564 0a69 6620 6066 696c 7465 725f  ored.if `filter_
-0000abb0: 696e 636c 7564 6560 2069 7320 7365 7420  include` is set 
-0000abc0: 746f 2061 206e 6f6e 2d65 6d70 7479 2073  to a non-empty s
-0000abd0: 6571 7565 6e63 652e 2042 7920 6465 6661  equence. By defa
-0000abe0: 756c 742c 2074 6869 7320 6172 6775 6d65  ult, this argume
-0000abf0: 6e74 2069 7320 7365 740a 746f 206d 6174  nt is set.to mat
-0000ac00: 6368 2074 6865 2065 7665 6e74 2074 7970  ch the event typ
-0000ac10: 6573 206f 6620 2273 7973 7465 6d20 6576  es of "system ev
-0000ac20: 656e 7473 222c 2073 6f20 7468 6174 2045  ents", so that E
-0000ac30: 7665 6e74 5374 6f72 6544 4220 7379 7374  ventStoreDB syst
-0000ac40: 656d 2065 7665 6e74 730a 7769 6c6c 206e  em events.will n
-0000ac50: 6f74 206e 6f72 6d61 6c6c 7920 6265 2069  ot normally be i
-0000ac60: 6e63 6c75 6465 642e 2053 6565 2074 6865  ncluded. See the
-0000ac70: 204e 6f74 6573 2073 6563 7469 6f6e 2062   Notes section b
-0000ac80: 656c 6f77 2066 6f72 206d 6f72 6520 696e  elow for more in
-0000ac90: 666f 726d 6174 696f 6e0a 6162 6f75 7420  formation.about 
-0000aca0: 6669 6c74 6572 2065 7870 7265 7373 696f  filter expressio
-0000acb0: 6e73 2e0a 0a54 6865 206f 7074 696f 6e61  ns...The optiona
-0000acc0: 6c20 6172 6775 6d65 6e74 2060 6669 6c74  l argument `filt
-0000acd0: 6572 5f69 6e63 6c75 6465 6020 6973 2061  er_include` is a
-0000ace0: 2073 6571 7565 6e63 6520 6f66 2072 6567   sequence of reg
-0000acf0: 756c 6172 2065 7870 7265 7373 696f 6e73  ular expressions
-0000ad00: 0a74 6861 7420 6d61 7463 6820 7265 636f  .that match reco
-0000ad10: 7264 6564 2065 7665 6e74 7320 7468 6174  rded events that
-0000ad20: 2073 686f 756c 6420 6265 2069 6e63 6c75   should be inclu
-0000ad30: 6465 642e 2042 7920 6465 6661 756c 742c  ded. By default,
-0000ad40: 2074 6869 7320 6172 6775 6d65 6e74 0a69   this argument.i
-0000ad50: 7320 616e 2065 6d70 7479 2074 7570 6c65  s an empty tuple
-0000ad60: 2e20 4966 2074 6869 7320 6172 6775 6d65  . If this argume
-0000ad70: 6e74 2069 7320 7365 7420 746f 2061 206e  nt is set to a n
-0000ad80: 6f6e 2d65 6d70 7479 2073 6571 7565 6e63  on-empty sequenc
-0000ad90: 652c 2074 6865 0a60 6669 6c74 6572 5f65  e, the.`filter_e
-0000ada0: 7863 6c75 6465 6020 6172 6775 6d65 6e74  xclude` argument
-0000adb0: 2069 7320 6967 6e6f 7265 642e 0a0a 5468   is ignored...Th
-0000adc0: 6520 6f70 7469 6f6e 616c 2061 7267 756d  e optional argum
-0000add0: 656e 7420 6066 696c 7465 725f 6279 5f73  ent `filter_by_s
-0000ade0: 7472 6561 6d5f 6e61 6d65 6020 6973 2061  tream_name` is a
-0000adf0: 2062 6f6f 6c65 616e 2076 616c 7565 2074   boolean value t
-0000ae00: 6861 7420 696e 6469 6361 7465 7320 7768  hat indicates wh
-0000ae10: 6574 6865 720a 7468 6520 6669 6c74 6572  ether.the filter
-0000ae20: 2077 696c 6c20 6170 706c 7920 746f 2065   will apply to e
-0000ae30: 7665 6e74 2074 7970 6573 206f 7220 7374  vent types or st
-0000ae40: 7265 616d 206e 616d 6573 2e20 4279 2064  ream names. By d
-0000ae50: 6566 6175 6c74 2c20 7468 6973 2076 616c  efault, this val
-0000ae60: 7565 2069 7320 6046 616c 7365 600a 616e  ue is `False`.an
-0000ae70: 6420 736f 2074 6865 2066 696c 7465 7269  d so the filteri
-0000ae80: 6e67 2077 696c 6c20 6170 706c 7920 746f  ng will apply to
-0000ae90: 2074 6865 2065 7665 6e74 2074 7970 6520   the event type 
-0000aea0: 7374 7269 6e67 7320 6f66 2072 6563 6f72  strings of recor
-0000aeb0: 6465 6420 6576 656e 7473 2e0a 0a50 6c65  ded events...Ple
-0000aec0: 6173 6520 6e6f 7465 2c20 7468 6520 6669  ase note, the fi
-0000aed0: 6c74 6572 696e 6720 6861 7070 656e 7320  ltering happens 
-0000aee0: 6f6e 2074 6865 2045 7665 6e74 5374 6f72  on the EventStor
-0000aef0: 6544 4220 7365 7276 6572 2c20 616e 6420  eDB server, and 
-0000af00: 7468 650a 606c 696d 6974 6020 6172 6775  the.`limit` argu
-0000af10: 6d65 6e74 2069 7320 6170 706c 6965 6420  ment is applied 
-0000af20: 6f6e 2074 6865 2073 6572 7665 7220 6166  on the server af
-0000af30: 7465 7220 6669 6c74 6572 696e 672e 2053  ter filtering. S
-0000af40: 6565 2062 656c 6f77 2066 6f72 0a6d 6f72  ee below for.mor
-0000af50: 6520 696e 666f 726d 6174 696f 6e20 6162  e information ab
-0000af60: 6f75 7420 6669 6c74 6572 2072 6567 756c  out filter regul
-0000af70: 6172 2065 7870 7265 7373 696f 6e73 2e0a  ar expressions..
-0000af80: 0a54 6865 206f 7074 696f 6e61 6c20 6074  .The optional `t
-0000af90: 696d 656f 7574 6020 6172 6775 6d65 6e74  imeout` argument
-0000afa0: 2069 7320 6120 5079 7468 6f6e 2060 666c   is a Python `fl
-0000afb0: 6f61 7460 2077 6869 6368 2073 6574 7320  oat` which sets 
-0000afc0: 610a 6465 6164 6c69 6e65 2066 6f72 2074  a.deadline for t
-0000afd0: 6865 2063 6f6d 706c 6574 696f 6e20 6f66  he completion of
-0000afe0: 2074 6865 2067 5250 4320 6f70 6572 6174   the gRPC operat
-0000aff0: 696f 6e2e 0a0a 5468 6973 206d 6574 686f  ion...This metho
-0000b000: 6420 7265 7475 726e 7320 6120 5079 7468  d returns a Pyth
-0000b010: 6f6e 2069 7465 7261 746f 7220 7468 6174  on iterator that
-0000b020: 2079 6965 6c64 7320 7265 636f 7264 6564   yields recorded
-0000b030: 2065 7665 6e74 732c 2069 6e63 6c75 6469   events, includi
-0000b040: 6e67 2065 7665 6e74 730a 7468 6174 2061  ng events.that a
-0000b050: 7265 2072 6563 6f72 6465 6420 6166 7465  re recorded afte
-0000b060: 7220 7468 6520 7375 6273 6372 6970 7469  r the subscripti
-0000b070: 6f6e 2077 6173 2063 7265 6174 6564 2e20  on was created. 
-0000b080: 4974 6572 6174 696e 6720 6f76 6572 2074  Iterating over t
-0000b090: 6869 7320 6f62 6a65 6374 2077 696c 6c0a  his object will.
-0000b0a0: 7468 6572 6566 6f72 6520 6e6f 7420 7374  therefore not st
-0000b0b0: 6f70 2c20 756e 6c65 7373 2074 6865 2063  op, unless the c
-0000b0c0: 6f6e 6e65 6374 696f 6e20 746f 2074 6865  onnection to the
-0000b0d0: 2064 6174 6162 6173 6520 6973 206c 6f73   database is los
-0000b0e0: 742e 2054 6865 2063 616c 6c20 7769 6c6c  t. The call will
-0000b0f0: 0a62 6520 656e 6465 6420 7768 656e 2074  .be ended when t
-0000b100: 6865 2069 7465 7261 746f 7220 6f62 6a65  he iterator obje
-0000b110: 6374 2069 7320 6465 6c65 7465 6420 6672  ct is deleted fr
-0000b120: 6f6d 206d 656d 6f72 792c 2077 6869 6368  om memory, which
-0000b130: 2077 696c 6c20 6861 7070 656e 2077 6865   will happen whe
-0000b140: 6e20 7468 650a 6974 6572 6174 6f72 206f  n the.iterator o
-0000b150: 626a 6563 7420 676f 6573 206f 7574 206f  bject goes out o
-0000b160: 6620 7363 6f70 6520 6f72 2069 7320 6578  f scope or is ex
-0000b170: 706c 6963 6974 6c79 2064 656c 6574 6564  plicitly deleted
-0000b180: 2028 7365 6520 6265 6c6f 7729 2e20 5468   (see below). Th
-0000b190: 6520 6361 6c6c 0a6d 6179 2061 6c73 6f20  e call.may also 
-0000b1a0: 6265 2063 6c6f 7365 6420 6279 2074 6865  be closed by the
-0000b1b0: 2073 6572 7665 722e 0a0a 5468 6520 7375   server...The su
-0000b1c0: 6273 6372 6970 7469 6f6e 206f 626a 6563  bscription objec
-0000b1d0: 7420 6361 6e20 6265 2075 7365 6420 6469  t can be used di
-0000b1e0: 7265 6374 6c79 2c20 6275 7420 6974 206d  rectly, but it m
-0000b1f0: 6967 6874 2062 6520 7573 6564 2077 6974  ight be used wit
-0000b200: 6869 6e20 6120 7468 7265 6164 6564 0a6c  hin a threaded.l
-0000b210: 6f6f 7020 6465 6469 6361 7465 6420 746f  oop dedicated to
-0000b220: 2072 6563 6569 7669 6e67 2065 7665 6e74   receiving event
-0000b230: 7320 7468 6174 2063 616e 2062 6520 7374  s that can be st
-0000b240: 6f70 7065 6420 696e 2061 2063 6f6e 7472  opped in a contr
-0000b250: 6f6c 6c65 6420 7761 792c 2077 6974 680a  olled way, with.
-0000b260: 7265 636f 7264 6564 2065 7665 6e74 7320  recorded events 
-0000b270: 7075 7420 6f6e 2061 2071 7565 7565 2066  put on a queue f
-0000b280: 6f72 2070 726f 6365 7373 696e 6720 696e  or processing in
-0000b290: 2061 2064 6966 6665 7265 6e74 2074 6872   a different thr
-0000b2a0: 6561 642e 2054 6869 7320 7061 636b 6167  ead. This packag
-0000b2b0: 650a 646f 6573 6e27 7420 7072 6f76 6964  e.doesn't provid
-0000b2c0: 6520 7375 6368 2061 2074 6872 6561 6465  e such a threade
-0000b2d0: 6420 6f72 2071 7565 7569 6e67 206f 626a  d or queuing obj
-0000b2e0: 6563 7420 636c 6173 732e 204a 7573 7420  ect class. Just 
-0000b2f0: 6d61 6b65 2073 7572 6520 746f 2072 6563  make sure to rec
-0000b300: 6f6e 7374 7275 6374 0a74 6865 2073 7562  onstruct.the sub
-0000b310: 7363 7269 7074 696f 6e20 2861 6e64 2074  scription (and t
-0000b320: 6865 2071 7565 7565 2920 7573 696e 6720  he queue) using 
-0000b330: 7468 6520 6c61 7374 2072 6563 6f72 6465  the last recorde
-0000b340: 6420 636f 6d6d 6974 2070 6f73 6974 696f  d commit positio
-0000b350: 6e20 7768 656e 2072 6573 756d 696e 670a  n when resuming.
-0000b360: 7468 6520 7375 6273 6372 6970 7469 6f6e  the subscription
-0000b370: 2061 6674 6572 2061 6e20 6572 726f 722c   after an error,
-0000b380: 2074 6f20 6265 2073 7572 6520 616c 6c20   to be sure all 
-0000b390: 6576 656e 7473 2061 7265 2070 726f 6365  events are proce
-0000b3a0: 7373 6564 206f 6e63 652e 0a0a 5468 6520  ssed once...The 
-0000b3b0: 6578 616d 706c 6520 6265 6c6f 7720 7368  example below sh
-0000b3c0: 6f77 7320 686f 7720 746f 2073 7562 7363  ows how to subsc
-0000b3d0: 7269 6265 2074 6f20 7265 6365 6976 6520  ribe to receive 
-0000b3e0: 616c 6c20 7265 636f 7264 6564 0a65 7665  all recorded.eve
-0000b3f0: 6e74 7320 6672 6f6d 2074 6865 2073 7461  nts from the sta
-0000b400: 7274 2c20 616e 6420 7468 656e 2072 6573  rt, and then res
-0000b410: 756d 696e 6720 6672 6f6d 2061 2073 7065  uming from a spe
-0000b420: 6369 6669 6320 636f 6d6d 6974 2070 6f73  cific commit pos
-0000b430: 6974 696f 6e2e 0a54 6872 6565 2061 6c72  ition..Three alr
-0000b440: 6561 6479 2d72 6563 6f72 6465 6420 6576  eady-recorded ev
-0000b450: 656e 7473 2061 7265 2072 6563 6569 7665  ents are receive
-0000b460: 642c 2061 6e64 2074 6865 6e20 7468 7265  d, and then thre
-0000b470: 6520 6e65 7720 6576 656e 7473 2061 7265  e new events are
-0000b480: 0a72 6563 6f72 6465 642c 2077 6869 6368  .recorded, which
-0000b490: 2061 7265 2074 6865 6e20 7265 6365 6976   are then receiv
-0000b4a0: 6564 2076 6961 2074 6865 2073 7562 7363  ed via the subsc
-0000b4b0: 7269 7074 696f 6e2e 0a0a 6060 6070 7974  ription...```pyt
-0000b4c0: 686f 6e0a 0a23 2041 7070 656e 6420 616e  hon..# Append an
-0000b4d0: 2065 7665 6e74 2074 6f20 6120 6e65 7720   event to a new 
-0000b4e0: 7374 7265 616d 2e0a 7374 7265 616d 5f6e  stream..stream_n
-0000b4f0: 616d 6532 203d 2073 7472 2875 7569 6434  ame2 = str(uuid4
-0000b500: 2829 290a 6576 656e 7434 203d 204e 6577  ()).event4 = New
-0000b510: 4576 656e 7428 7479 7065 3d27 4f72 6465  Event(type='Orde
-0000b520: 7243 7265 6174 6564 272c 2064 6174 613d  rCreated', data=
-0000b530: 6227 6461 7461 3427 290a 636c 6965 6e74  b'data4').client
-0000b540: 2e61 7070 656e 645f 6576 656e 7473 280a  .append_events(.
-0000b550: 2020 2020 7374 7265 616d 5f6e 616d 653d      stream_name=
-0000b560: 7374 7265 616d 5f6e 616d 6532 2c0a 2020  stream_name2,.  
-0000b570: 2020 6578 7065 6374 6564 5f70 6f73 6974    expected_posit
-0000b580: 696f 6e3d 4e6f 6e65 2c0a 2020 2020 6576  ion=None,.    ev
-0000b590: 656e 7473 3d5b 6576 656e 7434 5d2c 0a29  ents=[event4],.)
-0000b5a0: 0a0a 2320 5375 6273 6372 6962 6520 6672  ..# Subscribe fr
-0000b5b0: 6f6d 2074 6865 2066 6972 7374 2072 6563  om the first rec
-0000b5c0: 6f72 6465 6420 6576 656e 7420 696e 2074  orded event in t
-0000b5d0: 6865 2064 6174 6162 6173 652e 0a73 7562  he database..sub
-0000b5e0: 7363 7269 7074 696f 6e20 3d20 636c 6965  scription = clie
-0000b5f0: 6e74 2e73 7562 7363 7269 6265 5f61 6c6c  nt.subscribe_all
-0000b600: 5f65 7665 6e74 7328 290a 7265 6365 6976  _events().receiv
-0000b610: 6564 5f65 7665 6e74 7320 3d20 5b5d 0a0a  ed_events = []..
-0000b620: 2320 5072 6f63 6573 7320 6576 656e 7473  # Process events
-0000b630: 2072 6563 6569 7665 6420 6672 6f6d 2074   received from t
-0000b640: 6865 2063 6174 6368 2d75 7020 7375 6273  he catch-up subs
-0000b650: 6372 6970 7469 6f6e 2e0a 666f 7220 6576  cription..for ev
-0000b660: 656e 7420 696e 2073 7562 7363 7269 7074  ent in subscript
-0000b670: 696f 6e3a 0a20 2020 206c 6173 745f 636f  ion:.    last_co
-0000b680: 6d6d 6974 5f70 6f73 6974 696f 6e20 3d20  mmit_position = 
-0000b690: 6576 656e 742e 636f 6d6d 6974 5f70 6f73  event.commit_pos
-0000b6a0: 6974 696f 6e0a 2020 2020 7265 6365 6976  ition.    receiv
-0000b6b0: 6564 5f65 7665 6e74 732e 6170 7065 6e64  ed_events.append
-0000b6c0: 2865 7665 6e74 290a 2020 2020 6966 2065  (event).    if e
-0000b6d0: 7665 6e74 2e69 6420 3d3d 2065 7665 6e74  vent.id == event
-0000b6e0: 342e 6964 3a0a 2020 2020 2020 2020 6272  4.id:.        br
-0000b6f0: 6561 6b0a 0a61 7373 6572 7420 7265 6365  eak..assert rece
-0000b700: 6976 6564 5f65 7665 6e74 735b 2d34 5d2e  ived_events[-4].
-0000b710: 6964 203d 3d20 6576 656e 7431 2e69 640a  id == event1.id.
-0000b720: 6173 7365 7274 2072 6563 6569 7665 645f  assert received_
-0000b730: 6576 656e 7473 5b2d 335d 2e69 6420 3d3d  events[-3].id ==
-0000b740: 2065 7665 6e74 322e 6964 0a61 7373 6572   event2.id.asser
-0000b750: 7420 7265 6365 6976 6564 5f65 7665 6e74  t received_event
-0000b760: 735b 2d32 5d2e 6964 203d 3d20 6576 656e  s[-2].id == even
-0000b770: 7433 2e69 640a 6173 7365 7274 2072 6563  t3.id.assert rec
-0000b780: 6569 7665 645f 6576 656e 7473 5b2d 315d  eived_events[-1]
-0000b790: 2e69 6420 3d3d 2065 7665 6e74 342e 6964  .id == event4.id
-0000b7a0: 0a0a 2320 4170 7065 6e64 2073 7562 7365  ..# Append subse
-0000b7b0: 7175 656e 7420 6576 656e 7473 2074 6f20  quent events to 
-0000b7c0: 7468 6520 7374 7265 616d 2e0a 6576 656e  the stream..even
-0000b7d0: 7435 203d 204e 6577 4576 656e 7428 7479  t5 = NewEvent(ty
-0000b7e0: 7065 3d27 4f72 6465 7255 7064 6174 6564  pe='OrderUpdated
-0000b7f0: 272c 2064 6174 613d 6227 6461 7461 3527  ', data=b'data5'
-0000b800: 290a 636c 6965 6e74 2e61 7070 656e 645f  ).client.append_
-0000b810: 6576 656e 7473 280a 2020 2020 7374 7265  events(.    stre
-0000b820: 616d 5f6e 616d 653d 7374 7265 616d 5f6e  am_name=stream_n
-0000b830: 616d 6532 2c0a 2020 2020 6578 7065 6374  ame2,.    expect
-0000b840: 6564 5f70 6f73 6974 696f 6e3d 302c 0a20  ed_position=0,. 
-0000b850: 2020 2065 7665 6e74 733d 5b65 7665 6e74     events=[event
-0000b860: 355d 2c0a 290a 0a23 2052 6563 6569 7665  5],.)..# Receive
-0000b870: 2073 7562 7365 7175 656e 7420 6576 656e   subsequent even
-0000b880: 7473 2066 726f 6d20 7468 6520 7375 6273  ts from the subs
-0000b890: 6372 6970 7469 6f6e 2e0a 666f 7220 6576  cription..for ev
-0000b8a0: 656e 7420 696e 2073 7562 7363 7269 7074  ent in subscript
-0000b8b0: 696f 6e3a 0a20 2020 206c 6173 745f 636f  ion:.    last_co
-0000b8c0: 6d6d 6974 5f70 6f73 6974 696f 6e20 3d20  mmit_position = 
-0000b8d0: 6576 656e 742e 636f 6d6d 6974 5f70 6f73  event.commit_pos
-0000b8e0: 6974 696f 6e0a 2020 2020 7265 6365 6976  ition.    receiv
-0000b8f0: 6564 5f65 7665 6e74 732e 6170 7065 6e64  ed_events.append
-0000b900: 2865 7665 6e74 290a 2020 2020 6966 2065  (event).    if e
-0000b910: 7665 6e74 2e69 6420 3d3d 2065 7665 6e74  vent.id == event
-0000b920: 352e 6964 3a0a 2020 2020 2020 2020 6272  5.id:.        br
-0000b930: 6561 6b0a 0a0a 6173 7365 7274 2072 6563  eak...assert rec
-0000b940: 6569 7665 645f 6576 656e 7473 5b2d 355d  eived_events[-5]
-0000b950: 2e69 6420 3d3d 2065 7665 6e74 312e 6964  .id == event1.id
-0000b960: 0a61 7373 6572 7420 7265 6365 6976 6564  .assert received
-0000b970: 5f65 7665 6e74 735b 2d34 5d2e 6964 203d  _events[-4].id =
-0000b980: 3d20 6576 656e 7432 2e69 640a 6173 7365  = event2.id.asse
-0000b990: 7274 2072 6563 6569 7665 645f 6576 656e  rt received_even
-0000b9a0: 7473 5b2d 335d 2e69 6420 3d3d 2065 7665  ts[-3].id == eve
-0000b9b0: 6e74 332e 6964 0a61 7373 6572 7420 7265  nt3.id.assert re
-0000b9c0: 6365 6976 6564 5f65 7665 6e74 735b 2d32  ceived_events[-2
-0000b9d0: 5d2e 6964 203d 3d20 6576 656e 7434 2e69  ].id == event4.i
-0000b9e0: 640a 6173 7365 7274 2072 6563 6569 7665  d.assert receive
-0000b9f0: 645f 6576 656e 7473 5b2d 315d 2e69 6420  d_events[-1].id 
-0000ba00: 3d3d 2065 7665 6e74 352e 6964 0a0a 0a23  == event5.id...#
-0000ba10: 2041 7070 656e 6420 6d6f 7265 2065 7665   Append more eve
-0000ba20: 6e74 7320 746f 2074 6865 2073 7472 6561  nts to the strea
-0000ba30: 6d2e 0a65 7665 6e74 3620 3d20 4e65 7745  m..event6 = NewE
-0000ba40: 7665 6e74 2874 7970 653d 274f 7264 6572  vent(type='Order
-0000ba50: 4465 6c65 7465 6427 2c20 6461 7461 3d62  Deleted', data=b
-0000ba60: 2764 6174 6136 2729 0a63 6c69 656e 742e  'data6').client.
-0000ba70: 6170 7065 6e64 5f65 7665 6e74 7328 0a20  append_events(. 
-0000ba80: 2020 2073 7472 6561 6d5f 6e61 6d65 3d73     stream_name=s
-0000ba90: 7472 6561 6d5f 6e61 6d65 322c 0a20 2020  tream_name2,.   
-0000baa0: 2065 7870 6563 7465 645f 706f 7369 7469   expected_positi
-0000bab0: 6f6e 3d31 2c0a 2020 2020 6576 656e 7473  on=1,.    events
-0000bac0: 3d5b 6576 656e 7436 5d2c 0a29 0a0a 0a23  =[event6],.)...#
-0000bad0: 2052 6573 756d 6520 7375 6273 6372 6962   Resume subscrib
-0000bae0: 696e 6720 6672 6f6d 2074 6865 206c 6173  ing from the las
-0000baf0: 7420 636f 6d6d 6974 2070 6f73 6974 696f  t commit positio
-0000bb00: 6e2e 0a73 7562 7363 7269 7074 696f 6e20  n..subscription 
-0000bb10: 3d20 636c 6965 6e74 2e73 7562 7363 7269  = client.subscri
-0000bb20: 6265 5f61 6c6c 5f65 7665 6e74 7328 0a20  be_all_events(. 
-0000bb30: 2020 2063 6f6d 6d69 745f 706f 7369 7469     commit_positi
-0000bb40: 6f6e 3d6c 6173 745f 636f 6d6d 6974 5f70  on=last_commit_p
-0000bb50: 6f73 6974 696f 6e0a 290a 0a0a 2320 4361  osition.)...# Ca
-0000bb60: 7463 6820 7570 2062 7920 7265 6365 6976  tch up by receiv
-0000bb70: 696e 6720 7468 6520 6e65 7720 6576 656e  ing the new even
-0000bb80: 7420 6672 6f6d 2074 6865 2073 7562 7363  t from the subsc
-0000bb90: 7269 7074 696f 6e2e 0a66 6f72 2065 7665  ription..for eve
-0000bba0: 6e74 2069 6e20 7375 6273 6372 6970 7469  nt in subscripti
-0000bbb0: 6f6e 3a0a 2020 2020 7265 6365 6976 6564  on:.    received
-0000bbc0: 5f65 7665 6e74 732e 6170 7065 6e64 2865  _events.append(e
-0000bbd0: 7665 6e74 290a 2020 2020 6966 2065 7665  vent).    if eve
-0000bbe0: 6e74 2e69 6420 3d3d 2065 7665 6e74 362e  nt.id == event6.
-0000bbf0: 6964 3a0a 2020 2020 2020 2020 6272 6561  id:.        brea
-0000bc00: 6b0a 0a61 7373 6572 7420 7265 6365 6976  k..assert receiv
-0000bc10: 6564 5f65 7665 6e74 735b 2d36 5d2e 6964  ed_events[-6].id
-0000bc20: 203d 3d20 6576 656e 7431 2e69 640a 6173   == event1.id.as
-0000bc30: 7365 7274 2072 6563 6569 7665 645f 6576  sert received_ev
-0000bc40: 656e 7473 5b2d 355d 2e69 6420 3d3d 2065  ents[-5].id == e
-0000bc50: 7665 6e74 322e 6964 0a61 7373 6572 7420  vent2.id.assert 
-0000bc60: 7265 6365 6976 6564 5f65 7665 6e74 735b  received_events[
-0000bc70: 2d34 5d2e 6964 203d 3d20 6576 656e 7433  -4].id == event3
-0000bc80: 2e69 640a 6173 7365 7274 2072 6563 6569  .id.assert recei
-0000bc90: 7665 645f 6576 656e 7473 5b2d 335d 2e69  ved_events[-3].i
-0000bca0: 6420 3d3d 2065 7665 6e74 342e 6964 0a61  d == event4.id.a
-0000bcb0: 7373 6572 7420 7265 6365 6976 6564 5f65  ssert received_e
-0000bcc0: 7665 6e74 735b 2d32 5d2e 6964 203d 3d20  vents[-2].id == 
-0000bcd0: 6576 656e 7435 2e69 640a 6173 7365 7274  event5.id.assert
-0000bce0: 2072 6563 6569 7665 645f 6576 656e 7473   received_events
-0000bcf0: 5b2d 315d 2e69 6420 3d3d 2065 7665 6e74  [-1].id == event
-0000bd00: 362e 6964 0a0a 0a23 2041 7070 656e 6420  6.id...# Append 
-0000bd10: 7468 7265 6520 6d6f 7265 2065 7665 6e74  three more event
-0000bd20: 7320 746f 2061 206e 6577 2073 7472 6561  s to a new strea
-0000bd30: 6d2e 0a73 7472 6561 6d5f 6e61 6d65 3320  m..stream_name3 
-0000bd40: 3d20 7374 7228 7575 6964 3428 2929 0a65  = str(uuid4()).e
-0000bd50: 7665 6e74 3720 3d20 4e65 7745 7665 6e74  vent7 = NewEvent
-0000bd60: 2874 7970 653d 274f 7264 6572 4372 6561  (type='OrderCrea
-0000bd70: 7465 6427 2c20 6461 7461 3d62 2764 6174  ted', data=b'dat
-0000bd80: 6137 2729 0a65 7665 6e74 3820 3d20 4e65  a7').event8 = Ne
-0000bd90: 7745 7665 6e74 2874 7970 653d 274f 7264  wEvent(type='Ord
-0000bda0: 6572 5570 6461 7465 6427 2c20 6461 7461  erUpdated', data
-0000bdb0: 3d62 2764 6174 6138 2729 0a65 7665 6e74  =b'data8').event
-0000bdc0: 3920 3d20 4e65 7745 7665 6e74 2874 7970  9 = NewEvent(typ
-0000bdd0: 653d 274f 7264 6572 4465 6c65 7465 6427  e='OrderDeleted'
-0000bde0: 2c20 6461 7461 3d62 2764 6174 6139 2729  , data=b'data9')
-0000bdf0: 0a0a 636c 6965 6e74 2e61 7070 656e 645f  ..client.append_
-0000be00: 6576 656e 7473 280a 2020 2020 7374 7265  events(.    stre
-0000be10: 616d 5f6e 616d 653d 7374 7265 616d 5f6e  am_name=stream_n
-0000be20: 616d 6533 2c0a 2020 2020 6578 7065 6374  ame3,.    expect
-0000be30: 6564 5f70 6f73 6974 696f 6e3d 4e6f 6e65  ed_position=None
-0000be40: 2c0a 2020 2020 6576 656e 7473 3d5b 6576  ,.    events=[ev
-0000be50: 656e 7437 2c20 6576 656e 7438 2c20 6576  ent7, event8, ev
-0000be60: 656e 7439 5d2c 0a29 0a0a 2320 5265 6365  ent9],.)..# Rece
-0000be70: 6976 6520 7468 6520 7468 7265 6520 6e65  ive the three ne
-0000be80: 7720 6576 656e 7473 2066 726f 6d20 7468  w events from th
-0000be90: 6520 7265 7375 6d65 6420 7375 6273 6372  e resumed subscr
-0000bea0: 6970 7469 6f6e 2e0a 666f 7220 6576 656e  iption..for even
-0000beb0: 7420 696e 2073 7562 7363 7269 7074 696f  t in subscriptio
-0000bec0: 6e3a 0a20 2020 2072 6563 6569 7665 645f  n:.    received_
-0000bed0: 6576 656e 7473 2e61 7070 656e 6428 6576  events.append(ev
-0000bee0: 656e 7429 0a20 2020 2069 6620 6576 656e  ent).    if even
-0000bef0: 742e 6964 203d 3d20 6576 656e 7439 2e69  t.id == event9.i
-0000bf00: 643a 0a20 2020 2020 2020 2062 7265 616b  d:.        break
-0000bf10: 0a0a 6173 7365 7274 2072 6563 6569 7665  ..assert receive
-0000bf20: 645f 6576 656e 7473 5b2d 395d 2e69 6420  d_events[-9].id 
-0000bf30: 3d3d 2065 7665 6e74 312e 6964 0a61 7373  == event1.id.ass
-0000bf40: 6572 7420 7265 6365 6976 6564 5f65 7665  ert received_eve
-0000bf50: 6e74 735b 2d38 5d2e 6964 203d 3d20 6576  nts[-8].id == ev
-0000bf60: 656e 7432 2e69 640a 6173 7365 7274 2072  ent2.id.assert r
-0000bf70: 6563 6569 7665 645f 6576 656e 7473 5b2d  eceived_events[-
-0000bf80: 375d 2e69 6420 3d3d 2065 7665 6e74 332e  7].id == event3.
-0000bf90: 6964 0a61 7373 6572 7420 7265 6365 6976  id.assert receiv
-0000bfa0: 6564 5f65 7665 6e74 735b 2d36 5d2e 6964  ed_events[-6].id
-0000bfb0: 203d 3d20 6576 656e 7434 2e69 640a 6173   == event4.id.as
-0000bfc0: 7365 7274 2072 6563 6569 7665 645f 6576  sert received_ev
-0000bfd0: 656e 7473 5b2d 355d 2e69 6420 3d3d 2065  ents[-5].id == e
-0000bfe0: 7665 6e74 352e 6964 0a61 7373 6572 7420  vent5.id.assert 
-0000bff0: 7265 6365 6976 6564 5f65 7665 6e74 735b  received_events[
-0000c000: 2d34 5d2e 6964 203d 3d20 6576 656e 7436  -4].id == event6
-0000c010: 2e69 640a 6173 7365 7274 2072 6563 6569  .id.assert recei
-0000c020: 7665 645f 6576 656e 7473 5b2d 335d 2e69  ved_events[-3].i
-0000c030: 6420 3d3d 2065 7665 6e74 372e 6964 0a61  d == event7.id.a
-0000c040: 7373 6572 7420 7265 6365 6976 6564 5f65  ssert received_e
-0000c050: 7665 6e74 735b 2d32 5d2e 6964 203d 3d20  vents[-2].id == 
-0000c060: 6576 656e 7438 2e69 640a 6173 7365 7274  event8.id.assert
-0000c070: 2072 6563 6569 7665 645f 6576 656e 7473   received_events
-0000c080: 5b2d 315d 2e69 6420 3d3d 2065 7665 6e74  [-1].id == event
-0000c090: 392e 6964 0a60 6060 0a0a 5468 6520 6361  9.id.```..The ca
-0000c0a0: 7463 682d 7570 2073 7562 7363 7269 7074  tch-up subscript
-0000c0b0: 696f 6e20 6361 6c6c 2069 7320 656e 6465  ion call is ende
-0000c0c0: 6420 6173 2073 6f6f 6e20 6173 2074 6865  d as soon as the
-0000c0d0: 2073 7562 7363 7269 7074 696f 6e20 6f62   subscription ob
-0000c0e0: 6a65 6374 0a67 6f65 7320 6f75 7420 6f66  ject.goes out of
-0000c0f0: 2073 636f 7065 206f 7220 6973 2065 7870   scope or is exp
-0000c100: 6c69 6369 746c 7920 6465 6c65 7465 6420  licitly deleted 
-0000c110: 6672 6f6d 206d 656d 6f72 792e 0a0a 6060  from memory...``
-0000c120: 6070 7974 686f 6e0a 2320 456e 6420 7468  `python.# End th
-0000c130: 6520 7375 6273 6372 6970 7469 6f6e 2e0a  e subscription..
-0000c140: 6465 6c20 7375 6273 6372 6970 7469 6f6e  del subscription
-0000c150: 0a60 6060 0a0a 2323 2320 5375 6273 6372  .```..### Subscr
-0000c160: 6962 6520 7374 7265 616d 2065 7665 6e74  ibe stream event
-0000c170: 730a 0a54 6865 6073 7562 7363 7269 6265  s..The`subscribe
-0000c180: 5f73 7472 6561 6d5f 6576 656e 7473 2829  _stream_events()
-0000c190: 6020 6d65 7468 6f64 2063 616e 2062 6520  ` method can be 
-0000c1a0: 7573 6564 2074 6f20 7374 6172 7420 6120  used to start a 
-0000c1b0: 2263 6174 6368 2d75 7022 2073 7562 7363  "catch-up" subsc
-0000c1c0: 7269 7074 696f 6e0a 7468 6174 2063 616e  ription.that can
-0000c1d0: 2072 6574 7572 6e20 6576 656e 7473 2074   return events t
-0000c1e0: 6861 7420 6172 6520 7265 636f 7264 6564  hat are recorded
-0000c1f0: 2069 6e20 6120 7369 6e67 6c65 2073 7472   in a single str
-0000c200: 6561 6d2e 0a0a 5468 6973 206d 6574 686f  eam...This metho
-0000c210: 6420 7461 6b65 7320 6120 7265 7175 6972  d takes a requir
-0000c220: 6564 2060 7374 7265 616d 5f6e 616d 6560  ed `stream_name`
-0000c230: 2061 7267 756d 656e 742c 2077 6869 6368   argument, which
-0000c240: 2073 7065 6369 6669 6573 2074 6865 206e   specifies the n
-0000c250: 616d 6520 6f66 2074 6865 2073 7472 6561  ame of the strea
-0000c260: 6d0a 6672 6f6d 2077 6869 6368 2072 6563  m.from which rec
-0000c270: 6f72 6465 6420 6576 656e 7473 2077 696c  orded events wil
-0000c280: 6c20 6265 2072 6563 6569 7665 642e 0a0a  l be received...
-0000c290: 5468 6973 206d 6574 686f 6420 616c 736f  This method also
-0000c2a0: 2074 616b 6573 2074 776f 206f 7074 696f   takes two optio
-0000c2b0: 6e61 6c20 6172 6775 6d65 6e74 732c 2060  nal arguments, `
-0000c2c0: 7374 7265 616d 5f70 6f73 6974 696f 6e60  stream_position`
-0000c2d0: 2c20 616e 6420 6074 696d 656f 7574 602e  , and `timeout`.
-0000c2e0: 0a0a 5468 6520 6f70 7469 6f6e 616c 2060  ..The optional `
-0000c2f0: 7374 7265 616d 5f70 6f73 6974 696f 6e60  stream_position`
-0000c300: 2061 7267 756d 656e 7420 7370 6563 6966   argument specif
-0000c310: 6965 7320 6120 706f 7369 7469 6f6e 2069  ies a position i
-0000c320: 6e20 7468 6520 7374 7265 616d 2066 726f  n the stream fro
-0000c330: 6d20 7768 6963 680a 7265 636f 7264 6564  m which.recorded
-0000c340: 2065 7665 6e74 7320 7769 6c6c 2062 6520   events will be 
-0000c350: 7265 6365 6976 6564 2e20 5468 6520 6576  received. The ev
-0000c360: 656e 7420 6174 2074 6865 2073 7065 6369  ent at the speci
-0000c370: 6669 6564 2073 7472 6561 6d20 706f 7369  fied stream posi
-0000c380: 7469 6f6e 2077 696c 6c20 6e6f 740a 6265  tion will not.be
-0000c390: 2069 6e63 6c75 6465 642e 0a0a 5468 6520   included...The 
-0000c3a0: 6f70 7469 6f6e 616c 2060 7469 6d65 6f75  optional `timeou
-0000c3b0: 7460 2061 7267 756d 656e 7420 6973 2061  t` argument is a
-0000c3c0: 2050 7974 686f 6e20 6066 6c6f 6174 6020   Python `float` 
-0000c3d0: 7468 6174 2073 6574 730a 6120 6465 6164  that sets.a dead
-0000c3e0: 6c69 6e65 2066 6f72 2074 6865 2063 6f6d  line for the com
-0000c3f0: 706c 6574 696f 6e20 6f66 2074 6865 2067  pletion of the g
-0000c400: 5250 4320 6f70 6572 6174 696f 6e2e 0a0a  RPC operation...
-0000c410: 5468 6520 6578 616d 706c 6520 6265 6c6f  The example belo
-0000c420: 7720 7368 6f77 7320 686f 7720 746f 2073  w shows how to s
-0000c430: 7461 7274 2061 2063 6174 6368 2d75 7020  tart a catch-up 
-0000c440: 7375 6273 6372 6970 7469 6f6e 2074 6f20  subscription to 
-0000c450: 6120 7374 7265 616d 2e0a 0a60 6060 7079  a stream...```py
-0000c460: 7468 6f6e 0a0a 2320 5375 6273 6372 6962  thon..# Subscrib
-0000c470: 6520 746f 2065 7665 6e74 7320 6672 6f6d  e to events from
-0000c480: 2073 7472 6561 6d32 2c20 6672 6f6d 2074   stream2, from t
-0000c490: 6865 2073 7461 7274 2e0a 7375 6273 6372  he start..subscr
-0000c4a0: 6970 7469 6f6e 203d 2063 6c69 656e 742e  iption = client.
-0000c4b0: 7375 6273 6372 6962 655f 7374 7265 616d  subscribe_stream
-0000c4c0: 5f65 7665 6e74 7328 7374 7265 616d 5f6e  _events(stream_n
-0000c4d0: 616d 653d 7374 7265 616d 5f6e 616d 6532  ame=stream_name2
-0000c4e0: 290a 0a23 2052 6561 6420 6672 6f6d 2074  )..# Read from t
-0000c4f0: 6865 2073 7562 7363 7269 7074 696f 6e2e  he subscription.
-0000c500: 0a65 7665 6e74 7320 3d20 5b5d 0a66 6f72  .events = [].for
-0000c510: 2065 7665 6e74 2069 6e20 7375 6273 6372   event in subscr
-0000c520: 6970 7469 6f6e 3a0a 2020 2020 6576 656e  iption:.    even
-0000c530: 7473 2e61 7070 656e 6428 6576 656e 7429  ts.append(event)
-0000c540: 0a20 2020 2069 6620 6576 656e 742e 6964  .    if event.id
-0000c550: 203d 3d20 6576 656e 7436 2e69 643a 0a20   == event6.id:. 
-0000c560: 2020 2020 2020 2062 7265 616b 0a0a 2320         break..# 
-0000c570: 4368 6563 6b20 7765 2067 6f74 2065 7665  Check we got eve
-0000c580: 6e74 7320 6f6e 6c79 2066 726f 6d20 7374  nts only from st
-0000c590: 7265 616d 322e 0a61 7373 6572 7420 6c65  ream2..assert le
-0000c5a0: 6e28 6576 656e 7473 2920 3d3d 2033 0a65  n(events) == 3.e
-0000c5b0: 7665 6e74 735b 305d 2e73 7472 6561 6d5f  vents[0].stream_
-0000c5c0: 6e61 6d65 203d 3d20 7374 7265 616d 5f6e  name == stream_n
-0000c5d0: 616d 6532 0a65 7665 6e74 735b 315d 2e73  ame2.events[1].s
-0000c5e0: 7472 6561 6d5f 6e61 6d65 203d 3d20 7374  tream_name == st
-0000c5f0: 7265 616d 5f6e 616d 6532 0a65 7665 6e74  ream_name2.event
-0000c600: 735b 325d 2e73 7472 6561 6d5f 6e61 6d65  s[2].stream_name
-0000c610: 203d 3d20 7374 7265 616d 5f6e 616d 6532   == stream_name2
-0000c620: 0a0a 2320 4170 7065 6e64 2061 6e6f 7468  ..# Append anoth
-0000c630: 6572 2065 7665 6e74 2074 6f20 7374 7265  er event to stre
-0000c640: 616d 332e 0a65 7665 6e74 3130 203d 204e  am3..event10 = N
-0000c650: 6577 4576 656e 7428 7479 7065 3d22 4f72  ewEvent(type="Or
-0000c660: 6465 7255 6e64 656c 6574 6564 222c 2064  derUndeleted", d
-0000c670: 6174 613d 6227 6461 7461 3130 2729 0a63  ata=b'data10').c
-0000c680: 6c69 656e 742e 6170 7065 6e64 5f65 7665  lient.append_eve
-0000c690: 6e74 7328 0a20 2020 2073 7472 6561 6d5f  nts(.    stream_
-0000c6a0: 6e61 6d65 3d73 7472 6561 6d5f 6e61 6d65  name=stream_name
-0000c6b0: 332c 0a20 2020 2065 7870 6563 7465 645f  3,.    expected_
-0000c6c0: 706f 7369 7469 6f6e 3d32 2c0a 2020 2020  position=2,.    
-0000c6d0: 6576 656e 7473 3d5b 6576 656e 7431 305d  events=[event10]
-0000c6e0: 2c0a 290a 0a23 2041 7070 656e 6420 616e  ,.)..# Append an
-0000c6f0: 6f74 6865 7220 6576 656e 7420 746f 2073  other event to s
-0000c700: 7472 6561 6d32 2e0a 6576 656e 7431 3120  tream2..event11 
-0000c710: 3d20 4e65 7745 7665 6e74 2874 7970 653d  = NewEvent(type=
-0000c720: 224f 7264 6572 556e 6465 6c65 7465 6422  "OrderUndeleted"
-0000c730: 2c20 6461 7461 3d62 2764 6174 6131 3127  , data=b'data11'
-0000c740: 290a 636c 6965 6e74 2e61 7070 656e 645f  ).client.append_
-0000c750: 6576 656e 7473 280a 2020 2020 7374 7265  events(.    stre
-0000c760: 616d 5f6e 616d 653d 7374 7265 616d 5f6e  am_name=stream_n
-0000c770: 616d 6532 2c0a 2020 2020 6578 7065 6374  ame2,.    expect
-0000c780: 6564 5f70 6f73 6974 696f 6e3d 322c 0a20  ed_position=2,. 
-0000c790: 2020 2065 7665 6e74 733d 5b65 7665 6e74     events=[event
-0000c7a0: 3131 5d0a 290a 0a23 2043 6f6e 7469 6e75  11].)..# Continu
-0000c7b0: 6520 7265 6164 696e 6720 6672 6f6d 2074  e reading from t
-0000c7c0: 6865 2073 7562 7363 7269 7074 696f 6e2e  he subscription.
-0000c7d0: 0a66 6f72 2065 7665 6e74 2069 6e20 7375  .for event in su
-0000c7e0: 6273 6372 6970 7469 6f6e 3a0a 2020 2020  bscription:.    
-0000c7f0: 6576 656e 7473 2e61 7070 656e 6428 6576  events.append(ev
-0000c800: 656e 7429 0a20 2020 2069 6620 6576 656e  ent).    if even
-0000c810: 742e 6964 203d 3d20 6576 656e 7431 312e  t.id == event11.
-0000c820: 6964 3a0a 2020 2020 2020 2020 6272 6561  id:.        brea
-0000c830: 6b0a 0a23 2043 6865 636b 2077 6520 676f  k..# Check we go
-0000c840: 7420 6576 656e 7473 206f 6e6c 7920 6672  t events only fr
-0000c850: 6f6d 2073 7472 6561 6d32 2e0a 6173 7365  om stream2..asse
-0000c860: 7274 206c 656e 2865 7665 6e74 7329 203d  rt len(events) =
-0000c870: 3d20 340a 6576 656e 7473 5b30 5d2e 7374  = 4.events[0].st
-0000c880: 7265 616d 5f6e 616d 6520 3d3d 2073 7472  ream_name == str
-0000c890: 6561 6d5f 6e61 6d65 320a 6576 656e 7473  eam_name2.events
-0000c8a0: 5b31 5d2e 7374 7265 616d 5f6e 616d 6520  [1].stream_name 
-0000c8b0: 3d3d 2073 7472 6561 6d5f 6e61 6d65 320a  == stream_name2.
-0000c8c0: 6576 656e 7473 5b32 5d2e 7374 7265 616d  events[2].stream
-0000c8d0: 5f6e 616d 6520 3d3d 2073 7472 6561 6d5f  _name == stream_
-0000c8e0: 6e61 6d65 320a 6576 656e 7473 5b33 5d2e  name2.events[3].
-0000c8f0: 7374 7265 616d 5f6e 616d 6520 3d3d 2073  stream_name == s
-0000c900: 7472 6561 6d5f 6e61 6d65 320a 6060 600a  tream_name2.```.
-0000c910: 0a54 6865 2065 7861 6d70 6c65 2062 656c  .The example bel
-0000c920: 6f77 2073 686f 7773 2068 6f77 2074 6f20  ow shows how to 
-0000c930: 7374 6172 7420 6120 6361 7463 682d 7570  start a catch-up
-0000c940: 2073 7562 7363 7269 7074 696f 6e20 746f   subscription to
-0000c950: 2061 2073 7472 6561 6d20 6672 6f6d 2061   a stream from a
-0000c960: 0a73 7065 6369 6669 6320 7374 7265 616d  .specific stream
-0000c970: 2070 6f73 6974 696f 6e2e 0a0a 6060 6070   position...```p
-0000c980: 7974 686f 6e0a 0a23 2053 7562 7363 7269  ython..# Subscri
-0000c990: 6265 2074 6f20 6576 656e 7473 2066 726f  be to events fro
-0000c9a0: 6d20 7374 7265 616d 322c 2066 726f 6d20  m stream2, from 
-0000c9b0: 7468 6520 7374 6172 742e 0a73 7562 7363  the start..subsc
-0000c9c0: 7269 7074 696f 6e20 3d20 636c 6965 6e74  ription = client
-0000c9d0: 2e73 7562 7363 7269 6265 5f73 7472 6561  .subscribe_strea
-0000c9e0: 6d5f 6576 656e 7473 280a 2020 2020 7374  m_events(.    st
-0000c9f0: 7265 616d 5f6e 616d 653d 7374 7265 616d  ream_name=stream
-0000ca00: 5f6e 616d 6532 2c0a 2020 2020 7374 7265  _name2,.    stre
-0000ca10: 616d 5f70 6f73 6974 696f 6e3d 312c 0a29  am_position=1,.)
-0000ca20: 0a0a 2320 5265 6164 2065 7665 6e74 2066  ..# Read event f
-0000ca30: 726f 6d20 7468 6520 7375 6273 6372 6970  rom the subscrip
-0000ca40: 7469 6f6e 2e0a 6576 656e 7473 203d 205b  tion..events = [
-0000ca50: 5d0a 666f 7220 6576 656e 7420 696e 2073  ].for event in s
-0000ca60: 7562 7363 7269 7074 696f 6e3a 0a20 2020  ubscription:.   
-0000ca70: 2065 7665 6e74 732e 6170 7065 6e64 2865   events.append(e
-0000ca80: 7665 6e74 290a 2020 2020 6966 2065 7665  vent).    if eve
-0000ca90: 6e74 2e69 6420 3d3d 2065 7665 6e74 3131  nt.id == event11
-0000caa0: 2e69 643a 0a20 2020 2020 2020 2062 7265  .id:.        bre
-0000cab0: 616b 0a0a 2320 4368 6563 6b20 7765 2067  ak..# Check we g
-0000cac0: 6f74 2065 7665 6e74 7320 6f6e 6c79 2061  ot events only a
-0000cad0: 6674 6572 2070 6f73 6974 696f 6e20 312e  fter position 1.
-0000cae0: 0a61 7373 6572 7420 6c65 6e28 6576 656e  .assert len(even
-0000caf0: 7473 2920 3d3d 2032 0a65 7665 6e74 735b  ts) == 2.events[
-0000cb00: 305d 2e69 6420 3d3d 2065 7665 6e74 362e  0].id == event6.
-0000cb10: 6964 0a65 7665 6e74 735b 305d 2e73 7472  id.events[0].str
-0000cb20: 6561 6d5f 706f 7369 7469 6f6e 203d 3d20  eam_position == 
-0000cb30: 320a 6576 656e 7473 5b30 5d2e 7374 7265  2.events[0].stre
-0000cb40: 616d 5f6e 616d 6520 3d3d 2073 7472 6561  am_name == strea
-0000cb50: 6d5f 6e61 6d65 320a 6576 656e 7473 5b31  m_name2.events[1
-0000cb60: 5d2e 6964 203d 3d20 6576 656e 7431 312e  ].id == event11.
-0000cb70: 6964 0a65 7665 6e74 735b 315d 2e73 7472  id.events[1].str
-0000cb80: 6561 6d5f 706f 7369 7469 6f6e 203d 3d20  eam_position == 
-0000cb90: 330a 6576 656e 7473 5b31 5d2e 7374 7265  3.events[1].stre
-0000cba0: 616d 5f6e 616d 6520 3d3d 2073 7472 6561  am_name == strea
-0000cbb0: 6d5f 6e61 6d65 320a 6060 600a 0a23 2320  m_name2.```..## 
-0000cbc0: 5065 7273 6973 7465 6e74 2073 7562 7363  Persistent subsc
-0000cbd0: 7269 7074 696f 6e73 0a0a 2323 2320 4372  riptions..### Cr
-0000cbe0: 6561 7465 2073 7562 7363 7269 7074 696f  eate subscriptio
-0000cbf0: 6e0a 0a2a 7265 7175 6972 6573 206c 6561  n..*requires lea
-0000cc00: 6465 722a 0a0a 5468 6520 6d65 7468 6f64  der*..The method
-0000cc10: 2060 6372 6561 7465 5f73 7562 7363 7269   `create_subscri
-0000cc20: 7074 696f 6e28 2960 2063 616e 2062 6520  ption()` can be 
-0000cc30: 7573 6564 2074 6f20 6372 6561 7465 2061  used to create a
-0000cc40: 0a22 7065 7273 6973 7465 6e74 2073 7562  ."persistent sub
-0000cc50: 7363 7269 7074 696f 6e22 2074 6f20 4576  scription" to Ev
-0000cc60: 656e 7453 746f 7265 4442 2e0a 0a54 6869  entStoreDB...Thi
-0000cc70: 7320 6d65 7468 6f64 2074 616b 6573 2061  s method takes a
-0000cc80: 2072 6571 7569 7265 6420 6067 726f 7570   required `group
-0000cc90: 5f6e 616d 6560 2061 7267 756d 656e 742c  _name` argument,
-0000cca0: 2077 6869 6368 2069 7320 7468 650a 6e61   which is the.na
-0000ccb0: 6d65 206f 6620 6120 2267 726f 7570 2220  me of a "group" 
-0000ccc0: 6f66 2063 6f6e 7375 6d65 7273 206f 6620  of consumers of 
-0000ccd0: 7468 6520 7375 6273 6372 6970 7469 6f6e  the subscription
-0000cce0: 2e0a 0a54 6869 7320 6d65 7468 6f64 2061  ...This method a
-0000ccf0: 6c73 6f20 7461 6b65 7320 7365 7665 6e20  lso takes seven 
-0000cd00: 6f70 7469 6f6e 616c 2061 7267 756d 656e  optional argumen
-0000cd10: 7473 2c20 6066 726f 6d5f 656e 6460 2c20  ts, `from_end`, 
-0000cd20: 6063 6f6d 6d69 745f 706f 7369 7469 6f6e  `commit_position
-0000cd30: 602c 0a60 6669 6c74 6572 5f65 7863 6c75  `,.`filter_exclu
-0000cd40: 6465 602c 2060 6669 6c74 6572 5f69 6e63  de`, `filter_inc
-0000cd50: 6c75 6465 602c 2060 6669 6c74 6572 5f62  lude`, `filter_b
-0000cd60: 795f 7374 7265 616d 5f6e 616d 6560 2c20  y_stream_name`, 
-0000cd70: 6063 6f6e 7375 6d65 725f 7374 7261 7465  `consumer_strate
-0000cd80: 6779 602c 0a61 6e64 2060 7469 6d65 6f75  gy`,.and `timeou
-0000cd90: 7460 2e0a 0a54 6865 206f 7074 696f 6e61  t`...The optiona
-0000cda0: 6c20 6066 726f 6d5f 656e 6460 2061 7267  l `from_end` arg
-0000cdb0: 756d 656e 7420 6361 6e20 6265 2075 7365  ument can be use
-0000cdc0: 6420 746f 2073 7065 6369 6679 2074 6861  d to specify tha
-0000cdd0: 7420 7468 6520 6772 6f75 7020 6f66 2063  t the group of c
-0000cde0: 6f6e 7375 6d65 7273 0a6f 6620 7468 6520  onsumers.of the 
-0000cdf0: 7375 6273 6372 6970 7469 6f6e 2073 686f  subscription sho
-0000ce00: 756c 6420 6f6e 6c79 2072 6563 6569 7665  uld only receive
-0000ce10: 2065 7665 6e74 7320 7468 6174 2077 6572   events that wer
-0000ce20: 6520 7265 636f 7264 6564 2061 6674 6572  e recorded after
-0000ce30: 2074 6865 2073 7562 7363 7269 7074 696f   the subscriptio
-0000ce40: 6e0a 7761 7320 6372 6561 7465 642e 0a0a  n.was created...
-0000ce50: 416c 7465 726e 6174 6976 656c 792c 2074  Alternatively, t
-0000ce60: 6865 206f 7074 696f 6e61 6c20 6063 6f6d  he optional `com
-0000ce70: 6d69 745f 706f 7369 7469 6f6e 6020 6172  mit_position` ar
-0000ce80: 6775 6d65 6e74 2063 616e 2062 6520 7573  gument can be us
-0000ce90: 6564 2074 6f20 7370 6563 6966 7920 6120  ed to specify a 
-0000cea0: 636f 6d6d 6974 0a70 6f73 6974 696f 6e20  commit.position 
-0000ceb0: 6672 6f6d 2077 6869 6368 2063 6f6d 6d69  from which commi
-0000cec0: 7420 706f 7369 7469 6f6e 2074 6865 2067  t position the g
-0000ced0: 726f 7570 206f 6620 636f 6e73 756d 6572  roup of consumer
-0000cee0: 7320 6f66 2074 6865 2073 7562 7363 7269  s of the subscri
-0000cef0: 7074 696f 6e20 7368 6f75 6c64 0a72 6563  ption should.rec
-0000cf00: 6569 7665 2065 7665 6e74 732e 2050 6c65  eive events. Ple
-0000cf10: 6173 6520 6e6f 7465 2c20 7468 6520 7265  ase note, the re
-0000cf20: 636f 7264 6564 2065 7665 6e74 2061 7420  corded event at 
-0000cf30: 7468 6520 7370 6563 6966 6965 6420 636f  the specified co
-0000cf40: 6d6d 6974 2070 6f73 6974 696f 6e20 6d69  mmit position mi
-0000cf50: 6768 740a 6265 2069 6e63 6c75 6465 6420  ght.be included 
-0000cf60: 696e 2074 6865 2072 6563 6f72 6465 6420  in the recorded 
-0000cf70: 6576 656e 7473 2072 6563 6569 7665 6420  events received 
-0000cf80: 6279 2074 6865 2067 726f 7570 206f 6620  by the group of 
-0000cf90: 636f 6e73 756d 6572 732e 0a0a 4966 206e  consumers...If n
-0000cfa0: 6569 7468 6572 2060 6672 6f6d 5f65 6e64  either `from_end
-0000cfb0: 6020 6f72 2060 636f 6d6d 6974 5f70 6f73  ` or `commit_pos
-0000cfc0: 6974 696f 6e60 2061 7265 2073 7065 6369  ition` are speci
-0000cfd0: 6669 6564 2c20 7468 6520 6772 6f75 7020  fied, the group 
-0000cfe0: 6f66 2063 6f6e 7375 6d65 7273 0a6f 6620  of consumers.of 
-0000cff0: 7468 6520 7375 6273 6372 6970 7469 6f6e  the subscription
-0000d000: 2077 696c 6c20 706f 7465 6e74 6961 6c6c   will potentiall
-0000d010: 7920 7265 6365 6976 6520 616c 6c20 7265  y receive all re
-0000d020: 636f 7264 6564 2065 7665 6e74 7320 696e  corded events in
-0000d030: 2074 6865 2064 6174 6162 6173 652e 0a0a   the database...
-0000d040: 5468 6520 6f70 7469 6f6e 616c 2060 6669  The optional `fi
-0000d050: 6c74 6572 5f65 7863 6c75 6465 6020 6172  lter_exclude` ar
-0000d060: 6775 6d65 6e74 2069 7320 6120 7365 7175  gument is a sequ
-0000d070: 656e 6365 206f 6620 7265 6775 6c61 7220  ence of regular 
-0000d080: 6578 7072 6573 7369 6f6e 7320 7468 6174  expressions that
-0000d090: 0a6d 6174 6368 2072 6563 6f72 6465 6420  .match recorded 
-0000d0a0: 6576 656e 7473 2074 6861 7420 7368 6f75  events that shou
-0000d0b0: 6c64 206e 6f74 2062 6520 696e 636c 7564  ld not be includ
-0000d0c0: 6564 2e20 5468 6973 2061 7267 756d 656e  ed. This argumen
-0000d0d0: 7420 6973 2069 676e 6f72 6564 0a69 6620  t is ignored.if 
-0000d0e0: 6066 696c 7465 725f 696e 636c 7564 6560  `filter_include`
-0000d0f0: 2069 7320 7365 7420 746f 2061 206e 6f6e   is set to a non
-0000d100: 2d65 6d70 7479 2073 6571 7565 6e63 652e  -empty sequence.
-0000d110: 2042 7920 6465 6661 756c 742c 2074 6869   By default, thi
-0000d120: 7320 6172 6775 6d65 6e74 2069 7320 7365  s argument is se
-0000d130: 740a 746f 206d 6174 6368 2074 6865 2065  t.to match the e
-0000d140: 7665 6e74 2074 7970 6573 206f 6620 2273  vent types of "s
-0000d150: 7973 7465 6d20 6576 656e 7473 222c 2073  ystem events", s
-0000d160: 6f20 7468 6174 2045 7665 6e74 5374 6f72  o that EventStor
-0000d170: 6544 4220 7379 7374 656d 2065 7665 6e74  eDB system event
-0000d180: 730a 7769 6c6c 206e 6f74 206e 6f72 6d61  s.will not norma
-0000d190: 6c6c 7920 6265 2072 6563 6569 7665 642e  lly be received.
-0000d1a0: 2053 6565 2074 6865 204e 6f74 6573 2073   See the Notes s
-0000d1b0: 6563 7469 6f6e 2062 656c 6f77 2066 6f72  ection below for
-0000d1c0: 206d 6f72 6520 696e 666f 726d 6174 696f   more informatio
-0000d1d0: 6e0a 6162 6f75 7420 6669 6c74 6572 2065  n.about filter e
-0000d1e0: 7870 7265 7373 696f 6e73 2e0a 0a54 6865  xpressions...The
-0000d1f0: 206f 7074 696f 6e61 6c20 6066 696c 7465   optional `filte
-0000d200: 725f 696e 636c 7564 6560 2061 7267 756d  r_include` argum
-0000d210: 656e 7420 6973 2061 2073 6571 7565 6e63  ent is a sequenc
-0000d220: 6520 6f66 2072 6567 756c 6172 2065 7870  e of regular exp
-0000d230: 7265 7373 696f 6e73 0a74 6861 7420 6d61  ressions.that ma
-0000d240: 7463 6820 7265 636f 7264 6564 2065 7665  tch recorded eve
-0000d250: 6e74 7320 7468 6174 2073 686f 756c 6420  nts that should 
-0000d260: 6265 2072 6563 6569 7665 642e 2042 7920  be received. By 
-0000d270: 6465 6661 756c 742c 2074 6869 7320 6172  default, this ar
-0000d280: 6775 6d65 6e74 0a69 7320 616e 2065 6d70  gument.is an emp
-0000d290: 7479 2074 7570 6c65 2e20 4966 2074 6869  ty tuple. If thi
-0000d2a0: 7320 6172 6775 6d65 6e74 2069 7320 7365  s argument is se
-0000d2b0: 7420 746f 2061 206e 6f6e 2d65 6d70 7479  t to a non-empty
-0000d2c0: 2073 6571 7565 6e63 652c 2074 6865 0a60   sequence, the.`
-0000d2d0: 6669 6c74 6572 5f65 7863 6c75 6465 6020  filter_exclude` 
-0000d2e0: 6172 6775 6d65 6e74 2069 7320 6967 6e6f  argument is igno
-0000d2f0: 7265 642e 0a0a 5468 6520 6f70 7469 6f6e  red...The option
-0000d300: 616c 2060 6669 6c74 6572 5f62 795f 7374  al `filter_by_st
-0000d310: 7265 616d 5f6e 616d 6560 2061 7267 756d  ream_name` argum
-0000d320: 656e 7420 6973 2061 2062 6f6f 6c65 616e  ent is a boolean
-0000d330: 2076 616c 7565 2074 6861 7420 696e 6469   value that indi
-0000d340: 6361 7465 7320 7768 6574 6865 720a 7468  cates whether.th
-0000d350: 6520 6669 6c74 6572 2077 696c 6c20 6170  e filter will ap
-0000d360: 706c 7920 746f 2065 7665 6e74 2074 7970  ply to event typ
-0000d370: 6573 206f 7220 7374 7265 616d 206e 616d  es or stream nam
-0000d380: 6573 2e20 4279 2064 6566 6175 6c74 2c20  es. By default, 
-0000d390: 7468 6973 2076 616c 7565 2069 7320 6046  this value is `F
-0000d3a0: 616c 7365 600a 616e 6420 736f 2074 6865  alse`.and so the
-0000d3b0: 2066 696c 7465 7269 6e67 2077 696c 6c20   filtering will 
-0000d3c0: 6170 706c 7920 746f 2074 6865 2065 7665  apply to the eve
-0000d3d0: 6e74 2074 7970 6520 7374 7269 6e67 7320  nt type strings 
-0000d3e0: 6f66 2072 6563 6f72 6465 6420 6576 656e  of recorded even
-0000d3f0: 7473 2e0a 0a54 6865 206f 7074 696f 6e61  ts...The optiona
-0000d400: 6c20 6063 6f6e 7375 6d65 725f 7374 7261  l `consumer_stra
-0000d410: 7465 6779 6020 6172 6775 6d65 6e74 2069  tegy` argument i
-0000d420: 7320 6120 5079 7468 6f6e 2060 7374 7260  s a Python `str`
-0000d430: 2074 6861 7420 6465 6669 6e65 730a 7468   that defines.th
-0000d440: 6520 636f 6e73 756d 6572 2073 7472 6174  e consumer strat
-0000d450: 6567 7920 666f 7220 7468 6973 2070 6572  egy for this per
-0000d460: 7369 7374 656e 7420 7375 6273 6372 6970  sistent subscrip
-0000d470: 7469 6f6e 2e20 5468 6520 7661 6c75 6520  tion. The value 
-0000d480: 6f66 2074 6869 7320 6172 6775 6d65 6e74  of this argument
-0000d490: 0a63 616e 2062 6520 6027 4469 7370 6174  .can be `'Dispat
-0000d4a0: 6368 546f 5369 6e67 6c65 2760 2c20 6027  chToSingle'`, `'
-0000d4b0: 526f 756e 6452 6f62 696e 2760 2c20 6027  RoundRobin'`, `'
-0000d4c0: 5069 6e6e 6564 2760 2c20 6f72 2060 2750  Pinned'`, or `'P
-0000d4d0: 696e 6e65 6442 7943 6f72 7265 6c61 7469  innedByCorrelati
-0000d4e0: 6f6e 2760 2e20 5468 650a 6465 6661 756c  on'`. The.defaul
-0000d4f0: 7420 7661 6c75 6520 6973 2060 2744 6973  t value is `'Dis
-0000d500: 7061 7463 6854 6f53 696e 676c 6527 602e  patchToSingle'`.
-0000d510: 0a0a 5468 6520 6f70 7469 6f6e 616c 2060  ..The optional `
-0000d520: 7469 6d65 6f75 7460 2061 7267 756d 656e  timeout` argumen
-0000d530: 7420 6973 2061 2050 7974 686f 6e20 6066  t is a Python `f
-0000d540: 6c6f 6174 6020 7768 6963 6820 7365 7473  loat` which sets
-0000d550: 2061 0a64 6561 646c 696e 6520 666f 7220   a.deadline for 
-0000d560: 7468 6520 636f 6d70 6c65 7469 6f6e 206f  the completion o
-0000d570: 6620 7468 6520 6752 5043 206f 7065 7261  f the gRPC opera
-0000d580: 7469 6f6e 2e0a 0a54 6865 206d 6574 686f  tion...The metho
-0000d590: 6420 6063 7265 6174 655f 7375 6273 6372  d `create_subscr
-0000d5a0: 6970 7469 6f6e 2829 6020 646f 6573 206e  iption()` does n
-0000d5b0: 6f74 2072 6574 7572 6e20 6120 7661 6c75  ot return a valu
-0000d5c0: 652c 2062 6563 6175 7365 0a72 6563 6f72  e, because.recor
-0000d5d0: 6465 6420 6576 656e 7473 2061 7265 206f  ded events are o
-0000d5e0: 6274 6169 6e65 6420 6279 2074 6865 2067  btained by the g
-0000d5f0: 726f 7570 206f 6620 636f 6e73 756d 6572  roup of consumer
-0000d600: 7320 6f66 2074 6865 2073 7562 7363 7269  s of the subscri
-0000d610: 7074 696f 6e0a 7573 696e 6720 7468 6520  ption.using the 
-0000d620: 6072 6561 645f 7375 6273 6372 6970 7469  `read_subscripti
-0000d630: 6f6e 2829 6020 6d65 7468 6f64 2e0a 0a49  on()` method...I
-0000d640: 6e20 7468 6520 6578 616d 706c 6520 6265  n the example be
-0000d650: 6c6f 772c 2061 2070 6572 7369 7374 656e  low, a persisten
-0000d660: 7420 7375 6273 6372 6970 7469 6f6e 2069  t subscription i
-0000d670: 7320 6372 6561 7465 642e 0a0a 6060 6070  s created...```p
-0000d680: 7974 686f 6e0a 2320 4372 6561 7465 2061  ython.# Create a
-0000d690: 2070 6572 7369 7374 656e 7420 7375 6273   persistent subs
-0000d6a0: 6372 6970 7469 6f6e 2e0a 6772 6f75 705f  cription..group_
-0000d6b0: 6e61 6d65 203d 2066 2267 726f 7570 2d7b  name = f"group-{
-0000d6c0: 7575 6964 3428 297d 220a 636c 6965 6e74  uuid4()}".client
-0000d6d0: 2e63 7265 6174 655f 7375 6273 6372 6970  .create_subscrip
-0000d6e0: 7469 6f6e 2867 726f 7570 5f6e 616d 653d  tion(group_name=
-0000d6f0: 6772 6f75 705f 6e61 6d65 290a 6060 600a  group_name).```.
-0000d700: 0a23 2323 2052 6561 6420 7375 6273 6372  .### Read subscr
-0000d710: 6970 7469 6f6e 0a0a 2a72 6571 7569 7265  iption..*require
-0000d720: 7320 6c65 6164 6572 2a0a 0a54 6865 206d  s leader*..The m
-0000d730: 6574 686f 6420 6072 6561 645f 7375 6273  ethod `read_subs
-0000d740: 6372 6970 7469 6f6e 2829 6020 6361 6e20  cription()` can 
-0000d750: 6265 2075 7365 6420 6279 2061 2067 726f  be used by a gro
-0000d760: 7570 206f 6620 636f 6e73 756d 6572 7320  up of consumers 
-0000d770: 746f 2072 6563 6569 7665 0a72 6563 6f72  to receive.recor
-0000d780: 6465 6420 6576 656e 7473 2066 726f 6d20  ded events from 
-0000d790: 6120 7065 7273 6973 7465 6e74 2073 7562  a persistent sub
-0000d7a0: 7363 7269 7074 696f 6e20 6372 6561 7465  scription create
-0000d7b0: 6420 7573 696e 6720 6063 7265 6174 655f  d using `create_
-0000d7c0: 7375 6273 6372 6970 7469 6f6e 602e 0a0a  subscription`...
-0000d7d0: 5468 6973 206d 6574 686f 6420 7461 6b65  This method take
-0000d7e0: 7320 6120 7265 7175 6972 6564 2060 6772  s a required `gr
-0000d7f0: 6f75 705f 6e61 6d65 6020 6172 6775 6d65  oup_name` argume
-0000d800: 6e74 2c20 7768 6963 6820 6973 0a74 6865  nt, which is.the
-0000d810: 206e 616d 6520 6f66 2061 2022 6772 6f75   name of a "grou
-0000d820: 7022 206f 6620 636f 6e73 756d 6572 7320  p" of consumers 
-0000d830: 6f66 2074 6865 2073 7562 7363 7269 7074  of the subscript
-0000d840: 696f 6e20 7370 6563 6966 6965 640a 7768  ion specified.wh
-0000d850: 656e 2060 6372 6561 7465 5f73 7562 7363  en `create_subsc
-0000d860: 7269 7074 696f 6e28 2960 2077 6173 2063  ription()` was c
-0000d870: 616c 6c65 642e 0a0a 5468 6973 206d 6574  alled...This met
-0000d880: 686f 6420 616c 736f 2074 616b 6573 2061  hod also takes a
-0000d890: 6e20 6f70 7469 6f6e 616c 2060 7469 6d65  n optional `time
-0000d8a0: 6f75 7460 2061 7267 756d 656e 742c 2074  out` argument, t
-0000d8b0: 6861 740a 6973 2065 7870 6563 7465 6420  hat.is expected 
-0000d8c0: 746f 2062 6520 6120 5079 7468 6f6e 2060  to be a Python `
-0000d8d0: 666c 6f61 7460 2c20 7768 6963 6820 7365  float`, which se
-0000d8e0: 7473 2061 2064 6561 646c 696e 650a 666f  ts a deadline.fo
-0000d8f0: 7220 7468 6520 636f 6d70 6c65 7469 6f6e  r the completion
-0000d900: 206f 6620 7468 6520 6752 5043 206f 7065   of the gRPC ope
-0000d910: 7261 7469 6f6e 2e0a 0a54 6869 7320 6d65  ration...This me
-0000d920: 7468 6f64 2072 6574 7572 6e73 2061 2032  thod returns a 2
-0000d930: 2d74 7570 6c65 3a20 6120 2272 6561 6420  -tuple: a "read 
-0000d940: 7265 7175 6573 7422 206f 626a 6563 7420  request" object 
-0000d950: 616e 6420 6120 2272 6561 6420 7265 7370  and a "read resp
-0000d960: 6f6e 7365 2220 6f62 6a65 6374 2e0a 0a60  onse" object...`
-0000d970: 6060 7079 7468 6f6e 0a72 6561 645f 7265  ``python.read_re
-0000d980: 712c 2072 6561 645f 7265 7370 203d 2063  q, read_resp = c
-0000d990: 6c69 656e 742e 7265 6164 5f73 7562 7363  lient.read_subsc
-0000d9a0: 7269 7074 696f 6e28 6772 6f75 705f 6e61  ription(group_na
-0000d9b0: 6d65 3d67 726f 7570 5f6e 616d 6529 0a60  me=group_name).`
-0000d9c0: 6060 0a0a 5468 6520 2272 6561 6420 7265  ``..The "read re
-0000d9d0: 7370 6f6e 7365 2220 6f62 6a65 6374 2069  sponse" object i
-0000d9e0: 7320 616e 2069 7465 7261 746f 7220 7468  s an iterator th
-0000d9f0: 6174 2079 6965 6c64 7320 7265 636f 7264  at yields record
-0000da00: 6564 2065 7665 6e74 7320 6672 6f6d 0a74  ed events from.t
-0000da10: 6865 2073 7065 6369 6669 6564 2063 6f6d  he specified com
-0000da20: 6d69 7420 706f 7369 7469 6f6e 2e0a 0a54  mit position...T
-0000da30: 6865 2022 7265 6164 2072 6571 7565 7374  he "read request
-0000da40: 2220 6f62 6a65 6374 2068 6173 2061 6e20  " object has an 
-0000da50: 6061 636b 2829 6020 6d65 7468 6f64 2074  `ack()` method t
-0000da60: 6861 7420 7368 6f75 6c64 2062 6520 7573  hat should be us
-0000da70: 6564 2062 7920 6120 636f 6e73 756d 6572  ed by a consumer
-0000da80: 0a69 6e20 6120 6772 6f75 7020 746f 2061  .in a group to a
-0000da90: 636b 6e6f 776c 6564 6765 2074 6f20 7468  cknowledge to th
-0000daa0: 6520 7365 7276 6572 2074 6861 7420 6974  e server that it
-0000dab0: 2068 6173 2072 6563 6569 7665 6420 616e   has received an
-0000dac0: 6420 7375 6363 6573 7366 756c 6c79 0a70  d successfully.p
-0000dad0: 726f 6365 7373 6564 2061 2072 6563 6f72  rocessed a recor
-0000dae0: 6465 6420 6576 656e 742e 2054 6869 7320  ded event. This 
-0000daf0: 7769 6c6c 2070 7265 7665 6e74 2074 6861  will prevent tha
-0000db00: 7420 7265 636f 7264 6564 2065 7665 6e74  t recorded event
-0000db10: 2062 6569 6e67 2072 6563 6569 7665 640a   being received.
-0000db20: 6279 2061 6e6f 7468 6572 2063 6f6e 7375  by another consu
-0000db30: 6d65 7220 696e 2074 6865 2073 616d 6520  mer in the same 
-0000db40: 6772 6f75 702e 2054 6865 2060 6163 6b28  group. The `ack(
-0000db50: 2960 206d 6574 686f 6420 7461 6b65 7320  )` method takes 
-0000db60: 616e 2060 6576 656e 745f 6964 600a 6172  an `event_id`.ar
-0000db70: 6775 6d65 6e74 2c20 7768 6963 6820 6973  gument, which is
-0000db80: 2074 6865 2049 4420 6f66 2074 6865 2072   the ID of the r
-0000db90: 6563 6f72 6465 6420 6576 656e 7420 7468  ecorded event th
-0000dba0: 6174 2068 6173 2062 6565 6e20 7265 6365  at has been rece
-0000dbb0: 6976 6564 2e0a 0a54 6865 2022 7265 6164  ived...The "read
-0000dbc0: 2072 6571 7565 7374 2220 6f62 6a65 6374   request" object
-0000dbd0: 2061 6c73 6f20 6861 7320 616e 2060 6e61   also has an `na
-0000dbe0: 636b 2829 6020 6d65 7468 6f64 2074 6861  ck()` method tha
-0000dbf0: 7420 7368 6f75 6c64 2062 6520 7573 6564  t should be used
-0000dc00: 2062 7920 6120 636f 6e73 756d 6572 0a69   by a consumer.i
-0000dc10: 6e20 6120 6772 6f75 7020 746f 206e 6567  n a group to neg
-0000dc20: 6174 6976 656c 7920 6163 6b6e 6f77 6c65  atively acknowle
-0000dc30: 6467 6520 746f 2074 6865 2073 6572 7665  dge to the serve
-0000dc40: 7220 7468 6174 2069 7420 6861 7320 7265  r that it has re
-0000dc50: 6365 6976 6564 2062 7574 206e 6f74 0a73  ceived but not.s
-0000dc60: 7563 6365 7373 6675 6c6c 7920 7072 6f63  uccessfully proc
-0000dc70: 6573 7365 6420 6120 7265 636f 7264 6564  essed a recorded
-0000dc80: 2065 7665 6e74 2e20 5468 6520 606e 6163   event. The `nac
-0000dc90: 6b28 2960 206d 6574 686f 6420 7461 6b65  k()` method take
-0000dca0: 7320 616e 2060 6576 656e 745f 6964 600a  s an `event_id`.
-0000dcb0: 6172 6775 6d65 6e74 2c20 7768 6963 6820  argument, which 
-0000dcc0: 6973 2074 6865 2049 4420 6f66 2074 6865  is the ID of the
-0000dcd0: 2072 6563 6f72 6465 6420 6576 656e 7420   recorded event 
-0000dce0: 7468 6174 2068 6173 2062 6565 6e20 7265  that has been re
-0000dcf0: 6365 6976 6564 2c20 616e 6420 616e 0a60  ceived, and an.`
-0000dd00: 6163 7469 6f6e 6020 6172 6775 6d65 6e74  action` argument
-0000dd10: 2c20 7768 6963 6820 7368 6f75 6c64 2062  , which should b
-0000dd20: 6520 6120 5079 7468 6f6e 2060 7374 7260  e a Python `str`
-0000dd30: 2c20 6569 7468 6572 2060 2775 6e6b 6e6f  , either `'unkno
-0000dd40: 776e 2760 2c20 6027 7061 726b 2760 2c0a  wn'`, `'park'`,.
-0000dd50: 6027 7265 7472 7927 602c 2060 2773 6b69  `'retry'`, `'ski
-0000dd60: 7027 602c 206f 7220 6027 7374 6f70 2760  p'`, or `'stop'`
-0000dd70: 2e0a 0a54 6865 2065 7861 6d70 6c65 2062  ...The example b
-0000dd80: 656c 6f77 2069 7465 7261 7465 7320 6f76  elow iterates ov
-0000dd90: 6572 2074 6865 2022 7265 6164 2072 6573  er the "read res
-0000dda0: 706f 6e73 6522 206f 626a 6563 742c 2061  ponse" object, a
-0000ddb0: 6e64 2063 616c 6c73 2060 6163 6b28 2960  nd calls `ack()`
-0000ddc0: 0a6f 6e20 7468 6520 2272 6561 6420 7265  .on the "read re
-0000ddd0: 7370 6f6e 7365 2220 6f62 6a65 6374 2e20  sponse" object. 
-0000dde0: 5468 6520 666f 7220 6c6f 6f70 2062 7265  The for loop bre
-0000ddf0: 616b 7320 7768 656e 2077 6520 6861 7665  aks when we have
-0000de00: 2072 6563 6569 7665 640a 7468 6520 6c61   received.the la
-0000de10: 7374 2065 7665 6e74 2c20 736f 2074 6861  st event, so tha
-0000de20: 7420 7765 2063 616e 2063 6f6e 7469 6e75  t we can continu
-0000de30: 6520 7769 7468 2074 6865 2065 7861 6d70  e with the examp
-0000de40: 6c65 7320 6265 6c6f 772e 0a0a 6060 6070  les below...```p
-0000de50: 7974 686f 6e0a 6576 656e 7473 203d 205b  ython.events = [
-0000de60: 5d0a 666f 7220 6576 656e 7420 696e 2072  ].for event in r
-0000de70: 6561 645f 7265 7370 3a0a 2020 2020 6576  ead_resp:.    ev
-0000de80: 656e 7473 2e61 7070 656e 6428 6576 656e  ents.append(even
-0000de90: 7429 0a0a 2020 2020 2320 4163 6b6e 6f77  t)..    # Acknow
-0000dea0: 6c65 6467 6520 7468 6520 7265 6365 6976  ledge the receiv
-0000deb0: 6564 2065 7665 6e74 2e0a 2020 2020 7265  ed event..    re
-0000dec0: 6164 5f72 6571 2e61 636b 2865 7665 6e74  ad_req.ack(event
-0000ded0: 5f69 643d 6576 656e 742e 6964 290a 0a20  _id=event.id).. 
-0000dee0: 2020 2023 2042 7265 616b 2077 6865 6e20     # Break when 
-0000def0: 7468 6520 6c61 7374 2065 7665 6e74 2068  the last event h
-0000df00: 6173 2062 6565 6e20 7265 6365 6976 6564  as been received
-0000df10: 2e0a 2020 2020 6966 2065 7665 6e74 2e69  ..    if event.i
-0000df20: 6420 3d3d 2065 7665 6e74 3131 2e69 643a  d == event11.id:
-0000df30: 0a20 2020 2020 2020 2062 7265 616b 0a60  .        break.`
-0000df40: 6060 0a0a 5468 6520 7265 6365 6976 6564  ``..The received
-0000df50: 2065 7665 6e74 7320 6172 6520 7468 6520   events are the 
-0000df60: 6576 656e 7473 2077 6520 6170 7065 6e64  events we append
-0000df70: 6564 2061 626f 7665 2e0a 0a60 6060 7079  ed above...```py
-0000df80: 7468 6f6e 0a61 7373 6572 7420 6576 656e  thon.assert even
-0000df90: 7473 5b2d 3131 5d2e 6964 203d 3d20 6576  ts[-11].id == ev
-0000dfa0: 656e 7431 2e69 640a 6173 7365 7274 2065  ent1.id.assert e
-0000dfb0: 7665 6e74 735b 2d31 305d 2e69 6420 3d3d  vents[-10].id ==
-0000dfc0: 2065 7665 6e74 322e 6964 0a61 7373 6572   event2.id.asser
-0000dfd0: 7420 6576 656e 7473 5b2d 395d 2e69 6420  t events[-9].id 
-0000dfe0: 3d3d 2065 7665 6e74 332e 6964 0a61 7373  == event3.id.ass
-0000dff0: 6572 7420 6576 656e 7473 5b2d 385d 2e69  ert events[-8].i
-0000e000: 6420 3d3d 2065 7665 6e74 342e 6964 0a61  d == event4.id.a
-0000e010: 7373 6572 7420 6576 656e 7473 5b2d 375d  ssert events[-7]
-0000e020: 2e69 6420 3d3d 2065 7665 6e74 352e 6964  .id == event5.id
-0000e030: 0a61 7373 6572 7420 6576 656e 7473 5b2d  .assert events[-
-0000e040: 365d 2e69 6420 3d3d 2065 7665 6e74 362e  6].id == event6.
-0000e050: 6964 0a61 7373 6572 7420 6576 656e 7473  id.assert events
-0000e060: 5b2d 355d 2e69 6420 3d3d 2065 7665 6e74  [-5].id == event
-0000e070: 372e 6964 0a61 7373 6572 7420 6576 656e  7.id.assert even
-0000e080: 7473 5b2d 345d 2e69 6420 3d3d 2065 7665  ts[-4].id == eve
-0000e090: 6e74 382e 6964 0a61 7373 6572 7420 6576  nt8.id.assert ev
-0000e0a0: 656e 7473 5b2d 335d 2e69 6420 3d3d 2065  ents[-3].id == e
-0000e0b0: 7665 6e74 392e 6964 0a61 7373 6572 7420  vent9.id.assert 
-0000e0c0: 6576 656e 7473 5b2d 325d 2e69 6420 3d3d  events[-2].id ==
-0000e0d0: 2065 7665 6e74 3130 2e69 640a 6173 7365   event10.id.asse
-0000e0e0: 7274 2065 7665 6e74 735b 2d31 5d2e 6964  rt events[-1].id
-0000e0f0: 203d 3d20 6576 656e 7431 312e 6964 0a60   == event11.id.`
-0000e100: 6060 0a0a 5468 6520 2272 6561 6420 7265  ``..The "read re
-0000e110: 7175 6573 7422 206f 626a 6563 7420 616c  quest" object al
-0000e120: 736f 2068 6173 2061 6e20 606e 6163 6b28  so has an `nack(
-0000e130: 2960 206d 6574 686f 6420 7468 6174 2063  )` method that c
-0000e140: 616e 2062 6520 7573 6564 2062 7920 6120  an be used by a 
-0000e150: 636f 6e73 756d 6572 0a69 6e20 6120 6772  consumer.in a gr
-0000e160: 6f75 7020 746f 2061 636b 6e6f 776c 6564  oup to acknowled
-0000e170: 6765 2074 6f20 7468 6520 7365 7276 6572  ge to the server
-0000e180: 2074 6861 7420 6974 2068 6173 2066 6169   that it has fai
-0000e190: 6c65 6420 7375 6363 6573 7366 756c 6c79  led successfully
-0000e1a0: 2074 6f0a 7072 6f63 6573 7320 6120 7265   to.process a re
-0000e1b0: 636f 7264 6564 2065 7665 6e74 2e20 5468  corded event. Th
-0000e1c0: 6973 2077 696c 6c20 616c 6c6f 7720 7468  is will allow th
-0000e1d0: 6174 2072 6563 6f72 6465 6420 6576 656e  at recorded even
-0000e1e0: 7420 746f 2062 6520 7265 6365 6976 6564  t to be received
-0000e1f0: 0a62 7920 7468 6973 206f 7220 616e 6f74  .by this or anot
-0000e200: 6865 7220 636f 6e73 756d 6572 2069 6e20  her consumer in 
-0000e210: 7468 6520 7361 6d65 2067 726f 7570 2e0a  the same group..
-0000e220: 0a49 7420 6d69 6768 7420 6265 206d 6f72  .It might be mor
-0000e230: 6520 7573 6566 756c 2074 6f20 656e 6361  e useful to enca
-0000e240: 7073 756c 6174 6520 7468 6520 7265 7175  psulate the requ
-0000e250: 6573 7420 616e 6420 7265 7370 6f6e 7365  est and response
-0000e260: 206f 626a 6563 7473 2061 6e64 2074 6f20   objects and to 
-0000e270: 6974 6572 6174 650a 6f76 6572 2074 6865  iterate.over the
-0000e280: 2022 7265 6164 2072 6573 706f 6e73 6522   "read response"
-0000e290: 2069 6e20 6120 7365 7061 7261 7465 2074   in a separate t
-0000e2a0: 6872 6561 642c 2074 6f20 6361 6c6c 2062  hread, to call b
-0000e2b0: 6163 6b20 746f 2061 2068 616e 646c 6572  ack to a handler
-0000e2c0: 2066 756e 6374 696f 6e20 7768 656e 0a61   function when.a
-0000e2d0: 2072 6563 6f72 6465 6420 6576 656e 7420   recorded event 
-0000e2e0: 6973 2072 6563 6569 7665 642c 2061 6e64  is received, and
-0000e2f0: 2063 616c 6c20 6061 636b 2829 6020 6966   call `ack()` if
-0000e300: 2074 6865 2068 616e 646c 6572 2064 6f65   the handler doe
-0000e310: 7320 6e6f 7420 7261 6973 6520 616e 0a65  s not raise an.e
-0000e320: 7863 6570 7469 6f6e 2c20 616e 6420 746f  xception, and to
-0000e330: 2063 616c 6c20 606e 6163 6b28 2960 2069   call `nack()` i
-0000e340: 6620 616e 2065 7863 6570 7469 6f6e 2069  f an exception i
-0000e350: 7320 7261 6973 6564 2e20 5468 6520 6578  s raised. The ex
-0000e360: 616d 706c 6520 6265 6c6f 7720 7368 6f77  ample below show
-0000e370: 7320 686f 770a 7468 6973 206d 6967 6874  s how.this might
-0000e380: 2062 6520 646f 6e65 2e0a 0a60 6060 7079   be done...```py
-0000e390: 7468 6f6e 0a66 726f 6d20 7468 7265 6164  thon.from thread
-0000e3a0: 696e 6720 696d 706f 7274 2054 6872 6561  ing import Threa
-0000e3b0: 640a 0a0a 636c 6173 7320 5375 6273 6372  d...class Subscr
-0000e3c0: 6970 7469 6f6e 5265 6164 6572 3a0a 2020  iptionReader:.  
-0000e3d0: 2020 6465 6620 5f5f 696e 6974 5f5f 2873    def __init__(s
-0000e3e0: 656c 662c 2063 6c69 656e 742c 2067 726f  elf, client, gro
-0000e3f0: 7570 5f6e 616d 652c 2063 616c 6c62 6163  up_name, callbac
-0000e400: 6b29 3a0a 2020 2020 2020 2020 7365 6c66  k):.        self
-0000e410: 2e63 6c69 656e 7420 3d20 636c 6965 6e74  .client = client
-0000e420: 0a20 2020 2020 2020 2073 656c 662e 6772  .        self.gr
-0000e430: 6f75 705f 6e61 6d65 203d 2067 726f 7570  oup_name = group
-0000e440: 5f6e 616d 650a 2020 2020 2020 2020 7365  _name.        se
-0000e450: 6c66 2e63 616c 6c62 6163 6b20 3d20 6361  lf.callback = ca
-0000e460: 6c6c 6261 636b 0a20 2020 2020 2020 2073  llback.        s
-0000e470: 656c 662e 7468 7265 6164 203d 2054 6872  elf.thread = Thr
-0000e480: 6561 6428 7461 7267 6574 3d73 656c 662e  ead(target=self.
-0000e490: 7265 6164 5f73 7562 7363 7269 7074 696f  read_subscriptio
-0000e4a0: 6e2c 2064 6165 6d6f 6e3d 5472 7565 290a  n, daemon=True).
-0000e4b0: 2020 2020 2020 2020 7365 6c66 2e65 7272          self.err
-0000e4c0: 6f72 203d 204e 6f6e 650a 0a20 2020 2064  or = None..    d
-0000e4d0: 6566 2073 7461 7274 2873 656c 6629 3a0a  ef start(self):.
-0000e4e0: 2020 2020 2020 2020 7365 6c66 2e74 6872          self.thr
-0000e4f0: 6561 642e 7374 6172 7428 290a 0a20 2020  ead.start()..   
-0000e500: 2064 6566 206a 6f69 6e28 7365 6c66 293a   def join(self):
-0000e510: 0a20 2020 2020 2020 2073 656c 662e 7468  .        self.th
-0000e520: 7265 6164 2e6a 6f69 6e28 290a 0a20 2020  read.join()..   
-0000e530: 2064 6566 2072 6561 645f 7375 6273 6372   def read_subscr
-0000e540: 6970 7469 6f6e 2873 656c 6629 3a0a 2020  iption(self):.  
-0000e550: 2020 2020 2020 7265 712c 2072 6573 7020        req, resp 
-0000e560: 3d20 7365 6c66 2e63 6c69 656e 742e 7265  = self.client.re
-0000e570: 6164 5f73 7562 7363 7269 7074 696f 6e28  ad_subscription(
-0000e580: 6772 6f75 705f 6e61 6d65 3d73 656c 662e  group_name=self.
-0000e590: 6772 6f75 705f 6e61 6d65 290a 2020 2020  group_name).    
-0000e5a0: 2020 2020 666f 7220 6576 656e 7420 696e      for event in
-0000e5b0: 2072 6573 703a 0a20 2020 2020 2020 2020   resp:.         
-0000e5c0: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
-0000e5d0: 2020 2020 2020 2020 7365 6c66 2e63 616c          self.cal
-0000e5e0: 6c62 6163 6b28 6576 656e 7429 0a20 2020  lback(event).   
-0000e5f0: 2020 2020 2020 2020 2065 7863 6570 7420           except 
-0000e600: 4578 6365 7074 696f 6e20 6173 2065 3a0a  Exception as e:.
-0000e610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e620: 2320 7265 712e 6e61 636b 2865 7665 6e74  # req.nack(event
-0000e630: 2e69 6429 2020 2320 6e6f 7420 7965 7420  .id)  # not yet 
-0000e640: 696d 706c 656d 656e 7465 642e 2e2e 2e0a  implemented.....
-0000e650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e660: 7365 6c66 2e65 7272 6f72 203d 2065 0a20  self.error = e. 
-0000e670: 2020 2020 2020 2020 2020 2020 2020 2062                 b
-0000e680: 7265 616b 0a20 2020 2020 2020 2020 2020  reak.           
-0000e690: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-0000e6a0: 2020 2020 2020 2072 6571 2e61 636b 2865         req.ack(e
-0000e6b0: 7665 6e74 2e69 6429 0a0a 0a23 2043 7265  vent.id)...# Cre
-0000e6c0: 6174 6520 616e 6f74 6865 7220 7065 7273  ate another pers
-0000e6d0: 6973 7465 6e74 2073 7562 7363 7269 7074  istent subscript
-0000e6e0: 696f 6e2e 0a67 726f 7570 5f6e 616d 6520  ion..group_name 
-0000e6f0: 3d20 6622 6772 6f75 702d 7b75 7569 6434  = f"group-{uuid4
-0000e700: 2829 7d22 0a63 6c69 656e 742e 6372 6561  ()}".client.crea
-0000e710: 7465 5f73 7562 7363 7269 7074 696f 6e28  te_subscription(
-0000e720: 6772 6f75 705f 6e61 6d65 3d67 726f 7570  group_name=group
-0000e730: 5f6e 616d 6529 0a0a 6576 656e 7473 203d  _name)..events =
-0000e740: 205b 5d0a 0a64 6566 2068 616e 646c 655f   []..def handle_
-0000e750: 6576 656e 7428 6576 656e 7429 3a0a 2020  event(event):.  
-0000e760: 2020 6576 656e 7473 2e61 7070 656e 6428    events.append(
-0000e770: 6576 656e 7429 0a20 2020 2069 6620 6576  event).    if ev
-0000e780: 656e 742e 6964 203d 3d20 6576 656e 7431  ent.id == event1
-0000e790: 312e 6964 3a0a 2020 2020 2020 2020 7261  1.id:.        ra
-0000e7a0: 6973 6520 4578 6365 7074 696f 6e28 290a  ise Exception().
-0000e7b0: 0a0a 7265 6164 6572 203d 2053 7562 7363  ..reader = Subsc
-0000e7c0: 7269 7074 696f 6e52 6561 6465 7228 0a20  riptionReader(. 
-0000e7d0: 2020 2063 6c69 656e 743d 636c 6965 6e74     client=client
-0000e7e0: 2c0a 2020 2020 6772 6f75 705f 6e61 6d65  ,.    group_name
-0000e7f0: 3d67 726f 7570 5f6e 616d 652c 0a20 2020  =group_name,.   
-0000e800: 2063 616c 6c62 6163 6b3d 6861 6e64 6c65   callback=handle
-0000e810: 5f65 7665 6e74 0a29 0a0a 7265 6164 6572  _event.)..reader
-0000e820: 2e73 7461 7274 2829 0a72 6561 6465 722e  .start().reader.
-0000e830: 6a6f 696e 2829 0a0a 6173 7365 7274 2065  join()..assert e
-0000e840: 7665 6e74 735b 2d31 5d2e 6964 203d 3d20  vents[-1].id == 
-0000e850: 6576 656e 7431 312e 6964 0a60 6060 0a0a  event11.id.```..
-0000e860: 506c 6561 7365 206e 6f74 652c 2077 6865  Please note, whe
-0000e870: 6e20 7072 6f63 6573 7369 6e67 2065 7665  n processing eve
-0000e880: 6e74 7320 696e 2061 2064 6f77 6e73 7472  nts in a downstr
-0000e890: 6561 6d20 636f 6d70 6f6e 656e 742c 2074  eam component, t
-0000e8a0: 6865 2063 6f6d 6d69 7420 706f 7369 7469  he commit positi
-0000e8b0: 6f6e 206f 660a 7468 6520 6c61 7374 2073  on of.the last s
-0000e8c0: 7563 6365 7373 6675 6c6c 7920 7072 6f63  uccessfully proc
-0000e8d0: 6573 7365 6420 6576 656e 7420 6973 2075  essed event is u
-0000e8e0: 7365 6675 6c6c 7920 7265 636f 7264 6564  sefully recorded
-0000e8f0: 2062 7920 7468 6520 646f 776e 7374 7265   by the downstre
-0000e900: 616d 2063 6f6d 706f 6e65 6e74 0a73 6f20  am component.so 
-0000e910: 7468 6174 2074 6865 2063 6f6d 6d69 7420  that the commit 
-0000e920: 706f 7369 7469 6f6e 2063 616e 2062 6520  position can be 
-0000e930: 6465 7465 726d 696e 6564 2062 7920 7468  determined by th
-0000e940: 6520 646f 776e 7374 7265 616d 2063 6f6d  e downstream com
-0000e950: 706f 6e65 6e74 2066 726f 6d20 6974 7320  ponent from its 
-0000e960: 6f77 6e0a 7265 636f 7264 6564 2077 6865  own.recorded whe
-0000e970: 6e20 6974 2069 7320 7265 7374 6172 7465  n it is restarte
-0000e980: 642e 2054 6869 7320 636f 6d6d 6974 2070  d. This commit p
-0000e990: 6f73 6974 696f 6e20 6361 6e20 6265 2075  osition can be u
-0000e9a0: 7365 6420 746f 2073 7065 6369 6679 2074  sed to specify t
-0000e9b0: 6865 2063 6f6d 6d69 740a 706f 7369 7469  he commit.positi
-0000e9c0: 6f6e 2066 726f 6d20 7768 6963 6820 746f  on from which to
-0000e9d0: 2073 7562 7363 7269 6265 2e20 5369 6e63   subscribe. Sinc
-0000e9e0: 6520 7468 6973 2063 6f6d 6d69 7420 706f  e this commit po
-0000e9f0: 7369 7469 6f6e 2072 6570 7265 7365 6e74  sition represent
-0000ea00: 7320 7468 6520 706f 7369 7469 6f6e 206f  s the position o
-0000ea10: 660a 7468 6520 6c61 7374 2073 7563 6365  f.the last succe
-0000ea20: 7373 6675 6c6c 7920 7072 6f63 6573 7365  ssfully processe
-0000ea30: 6420 6576 656e 7420 696e 2061 2064 6f77  d event in a dow
-0000ea40: 6e73 7472 6561 6d20 636f 6d70 6f6e 656e  nstream componen
-0000ea50: 742c 2073 6f20 6974 2077 696c 6c20 6265  t, so it will be
-0000ea60: 2075 7375 616c 2074 6f0a 7761 6e74 2074   usual to.want t
-0000ea70: 6f20 7265 6164 2066 726f 6d20 7468 6520  o read from the 
-0000ea80: 6e65 7874 2065 7665 6e74 2061 6674 6572  next event after
-0000ea90: 2074 6869 7320 706f 7369 7469 6f6e 2c20   this position, 
-0000eaa0: 6265 6361 7573 6520 7468 6174 2069 7320  because that is 
-0000eab0: 7468 6520 6e65 7874 2065 7665 6e74 0a74  the next event.t
-0000eac0: 6861 7420 6e65 6564 7320 746f 2062 6520  hat needs to be 
-0000ead0: 7072 6f63 6573 7365 642e 2048 6f77 6576  processed. Howev
-0000eae0: 6572 2c20 7768 656e 2073 7562 7363 7269  er, when subscri
-0000eaf0: 6269 6e67 2066 6f72 2065 7665 6e74 7320  bing for events 
-0000eb00: 7573 696e 6720 6120 7065 7273 6973 7465  using a persiste
-0000eb10: 6e74 0a73 7562 7363 7269 7074 696f 6e20  nt.subscription 
-0000eb20: 696e 2045 7665 6e74 5374 6f72 6544 422c  in EventStoreDB,
-0000eb30: 2074 6865 2065 7665 6e74 2061 7420 7468   the event at th
-0000eb40: 6520 7370 6563 6966 6965 6420 636f 6d6d  e specified comm
-0000eb50: 6974 2070 6f73 6974 696f 6e20 4d41 5920  it position MAY 
-0000eb60: 6265 2072 6574 7572 6e65 640a 6173 2074  be returned.as t
-0000eb70: 6865 2066 6972 7374 2065 7665 6e74 2069  he first event i
-0000eb80: 6e20 7468 6520 7265 6365 6976 6564 2073  n the received s
-0000eb90: 6571 7565 6e63 6520 6f66 2072 6563 6f72  equence of recor
-0000eba0: 6465 6420 6576 656e 7473 2c20 616e 6420  ded events, and 
-0000ebb0: 736f 2069 7420 6d61 790a 6265 206e 6563  so it may.be nec
-0000ebc0: 6573 7361 7279 2074 6f20 6368 6563 6b20  essary to check 
-0000ebd0: 7468 6520 636f 6d6d 6974 2070 6f73 6974  the commit posit
-0000ebe0: 696f 6e20 6f66 2074 6865 2072 6563 6569  ion of the recei
-0000ebf0: 7665 6420 6576 656e 7473 2061 6e64 2074  ved events and t
-0000ec00: 6f20 6469 7363 6172 640a 616e 7920 2072  o discard.any  r
-0000ec10: 6563 6f72 6465 6420 6576 656e 7420 6f62  ecorded event ob
-0000ec20: 6a65 6374 2074 6861 7420 6861 7320 6120  ject that has a 
-0000ec30: 636f 6d6d 6974 2070 6f73 6974 696f 6e20  commit position 
-0000ec40: 6571 7561 6c20 746f 2074 6865 2063 6f6d  equal to the com
-0000ec50: 6d69 7420 706f 7369 7469 6f6e 0a73 7065  mit position.spe
-0000ec60: 6369 6669 6564 2069 6e20 7468 6520 7265  cified in the re
-0000ec70: 7175 6573 742e 0a0a 5768 696c 7374 2074  quest...Whilst t
-0000ec80: 6865 7265 2061 7265 2073 6f6d 6520 6164  here are some ad
-0000ec90: 7661 6e74 6167 6573 206f 6620 7065 7273  vantages of pers
-0000eca0: 6973 7465 6e74 2073 7562 7363 7269 7074  istent subscript
-0000ecb0: 696f 6e73 2c20 696e 2070 6172 7469 6375  ions, in particu
-0000ecc0: 6c61 7220 7468 650a 7072 6f63 6573 7369  lar the.processi
-0000ecd0: 6e67 206f 6620 7265 636f 7264 6564 2065  ng of recorded e
-0000ece0: 7665 6e74 7320 6279 2061 2067 726f 7570  vents by a group
-0000ecf0: 206f 6620 636f 6e73 756d 6572 732c 2062   of consumers, b
-0000ed00: 7920 7472 6163 6b69 6e67 2069 6e20 7468  y tracking in th
-0000ed10: 650a 7570 7374 7265 616d 2073 6572 7665  e.upstream serve
-0000ed20: 7220 7468 6520 706f 7369 7469 6f6e 2069  r the position i
-0000ed30: 6e20 7468 6520 636f 6d6d 6974 2073 6571  n the commit seq
-0000ed40: 7565 6e63 6520 6f66 2065 7665 6e74 7320  uence of events 
-0000ed50: 7468 6174 2068 6176 6520 6265 656e 2070  that have been p
-0000ed60: 726f 6365 7373 6564 2c0a 7468 6572 6520  rocessed,.there 
-0000ed70: 6973 2061 2064 616e 6765 7220 6f66 2022  is a danger of "
-0000ed80: 6475 616c 2077 7269 7469 6e67 2220 696e  dual writing" in
-0000ed90: 2074 6865 2063 6f6e 7375 6d70 7469 6f6e   the consumption
-0000eda0: 206f 6620 6576 656e 7473 2e20 5265 6c69   of events. Reli
-0000edb0: 6162 696c 6974 790a 696e 2070 726f 6365  ability.in proce
-0000edc0: 7373 696e 6720 6f66 2072 6563 6f72 6465  ssing of recorde
-0000edd0: 6420 6576 656e 7473 2062 7920 6120 6772  d events by a gr
-0000ede0: 6f75 7020 6f66 2063 6f6e 7375 6d65 7273  oup of consumers
-0000edf0: 2077 696c 6c20 7265 6c79 2069 6e73 7465   will rely inste
-0000ee00: 6164 206f 6e0a 6964 656d 706f 7465 6e74  ad on.idempotent
-0000ee10: 2068 616e 646c 696e 6720 6f66 2064 7570   handling of dup
-0000ee20: 6c69 6361 7465 206d 6573 7361 6765 732c  licate messages,
-0000ee30: 2061 6e64 2072 6573 696c 6965 6e63 6520   and resilience 
-0000ee40: 746f 206f 7574 2d6f 662d 6f72 6465 7220  to out-of-order 
-0000ee50: 6465 6c69 7665 7279 2e0a 0a23 2323 2047  delivery...### G
-0000ee60: 6574 2073 7562 7363 7269 7074 696f 6e20  et subscription 
-0000ee70: 696e 666f 0a0a 2a72 6571 7569 7265 7320  info..*requires 
-0000ee80: 6c65 6164 6572 2a0a 0a54 6865 2060 6765  leader*..The `ge
-0000ee90: 745f 7375 6273 6372 6970 7469 6f6e 5f69  t_subscription_i
-0000eea0: 6e66 6f28 2960 206d 6574 686f 6420 6361  nfo()` method ca
-0000eeb0: 6e20 6265 2075 7365 6420 746f 2067 6574  n be used to get
-0000eec0: 2069 6e66 6f72 6d61 7469 6f6e 2066 6f72   information for
-0000eed0: 2061 0a70 6572 7369 7374 656e 7420 7375   a.persistent su
-0000eee0: 6273 6372 6970 7469 6f6e 2e0a 0a54 6869  bscription...Thi
-0000eef0: 7320 6d65 7468 6f64 2068 6173 206f 6e65  s method has one
-0000ef00: 2072 6571 7569 7265 6420 6172 6775 6d65   required argume
-0000ef10: 6e74 2c20 6067 726f 7570 5f6e 616d 6560  nt, `group_name`
-0000ef20: 2c20 7768 6963 680a 7368 6f75 6c64 206d  , which.should m
-0000ef30: 6174 6368 2074 6865 2076 616c 7565 206f  atch the value o
-0000ef40: 6620 7468 6520 6172 6775 6d65 6e74 2075  f the argument u
-0000ef50: 7365 6420 7768 656e 2063 616c 6c69 6e67  sed when calling
-0000ef60: 2060 6372 6561 7465 5f73 7562 7363 7269   `create_subscri
-0000ef70: 7074 696f 6e28 2960 2e0a 0a54 6869 7320  ption()`...This 
-0000ef80: 6d65 7468 6f64 2061 6c73 6f20 7461 6b65  method also take
-0000ef90: 7320 616e 206f 7074 696f 6e61 6c20 6074  s an optional `t
-0000efa0: 696d 656f 7574 6020 6172 6775 6d65 6e74  imeout` argument
-0000efb0: 2c20 7468 6174 0a69 7320 6578 7065 6374  , that.is expect
-0000efc0: 6564 2074 6f20 6265 2061 2050 7974 686f  ed to be a Pytho
-0000efd0: 6e20 6066 6c6f 6174 602c 2077 6869 6368  n `float`, which
-0000efe0: 2073 6574 7320 6120 6465 6164 6c69 6e65   sets a deadline
-0000eff0: 0a66 6f72 2074 6865 2063 6f6d 706c 6574  .for the complet
-0000f000: 696f 6e20 6f66 2074 6865 2067 5250 4320  ion of the gRPC 
-0000f010: 6f70 6572 6174 696f 6e2e 0a0a 6060 6070  operation...```p
-0000f020: 7974 686f 6e0a 7375 6273 6372 6970 7469  ython.subscripti
-0000f030: 6f6e 5f69 6e66 6f20 3d20 636c 6965 6e74  on_info = client
-0000f040: 2e67 6574 5f73 7562 7363 7269 7074 696f  .get_subscriptio
-0000f050: 6e5f 696e 666f 280a 2020 2020 6772 6f75  n_info(.    grou
-0000f060: 705f 6e61 6d65 3d67 726f 7570 5f6e 616d  p_name=group_nam
-0000f070: 652c 0a29 0a60 6060 0a0a 5468 6520 7265  e,.).```..The re
-0000f080: 7475 726e 6564 2076 616c 7565 2069 7320  turned value is 
-0000f090: 6120 6053 7562 7363 7269 7074 696f 6e49  a `SubscriptionI
-0000f0a0: 6e66 6f60 206f 626a 6563 742e 0a0a 2323  nfo` object...##
-0000f0b0: 2320 4c69 7374 2073 7562 7363 7269 7074  # List subscript
-0000f0c0: 696f 6e73 0a0a 2a72 6571 7569 7265 7320  ions..*requires 
-0000f0d0: 6c65 6164 6572 2a0a 0a54 6865 2060 6c69  leader*..The `li
-0000f0e0: 7374 5f73 7562 7363 7269 7074 696f 6e73  st_subscriptions
-0000f0f0: 2829 6020 6d65 7468 6f64 2063 616e 2062  ()` method can b
-0000f100: 6520 7573 6564 2074 6f20 6765 7420 696e  e used to get in
-0000f110: 666f 726d 6174 696f 6e20 666f 7220 616c  formation for al
-0000f120: 6c0a 6578 6973 7469 6e67 2070 6572 7369  l.existing persi
-0000f130: 7374 656e 7420 7375 6273 6372 6970 7469  stent subscripti
-0000f140: 6f6e 732e 0a0a 5468 6973 206d 6574 686f  ons...This metho
-0000f150: 6420 7461 6b65 7320 616e 206f 7074 696f  d takes an optio
-0000f160: 6e61 6c20 6074 696d 656f 7574 6020 6172  nal `timeout` ar
-0000f170: 6775 6d65 6e74 2c20 7468 6174 0a69 7320  gument, that.is 
-0000f180: 6578 7065 6374 6564 2074 6f20 6265 2061  expected to be a
-0000f190: 2050 7974 686f 6e20 6066 6c6f 6174 602c   Python `float`,
-0000f1a0: 2077 6869 6368 2073 6574 7320 6120 6465   which sets a de
-0000f1b0: 6164 6c69 6e65 0a66 6f72 2074 6865 2063  adline.for the c
-0000f1c0: 6f6d 706c 6574 696f 6e20 6f66 2074 6865  ompletion of the
-0000f1d0: 2067 5250 4320 6f70 6572 6174 696f 6e2e   gRPC operation.
-0000f1e0: 0a0a 6060 6070 7974 686f 6e0a 7375 6273  ..```python.subs
-0000f1f0: 6372 6970 7469 6f6e 7320 3d20 636c 6965  criptions = clie
-0000f200: 6e74 2e6c 6973 745f 7375 6273 6372 6970  nt.list_subscrip
-0000f210: 7469 6f6e 7328 290a 6060 600a 0a54 6865  tions().```..The
-0000f220: 2072 6574 7572 6e65 6420 7661 6c75 6520   returned value 
-0000f230: 6973 2061 206c 6973 7420 6f66 2060 5375  is a list of `Su
-0000f240: 6273 6372 6970 7469 6f6e 496e 666f 6020  bscriptionInfo` 
-0000f250: 6f62 6a65 6374 732e 0a0a 2323 2320 4465  objects...### De
-0000f260: 6c65 7465 2073 7562 7363 7269 7074 696f  lete subscriptio
-0000f270: 6e0a 0a2a 7265 7175 6972 6573 206c 6561  n..*requires lea
-0000f280: 6465 722a 0a0a 5468 6520 6064 656c 6574  der*..The `delet
-0000f290: 655f 7375 6273 6372 6970 7469 6f6e 2829  e_subscription()
-0000f2a0: 6020 6d65 7468 6f64 2063 616e 2062 6520  ` method can be 
-0000f2b0: 7573 6564 2074 6f20 6465 6c65 7465 2061  used to delete a
-0000f2c0: 2070 6572 7369 7374 656e 740a 7375 6273   persistent.subs
-0000f2d0: 6372 6970 7469 6f6e 2e0a 0a54 6869 7320  cription...This 
-0000f2e0: 6d65 7468 6f64 2068 6173 206f 6e65 2072  method has one r
-0000f2f0: 6571 7569 7265 6420 6172 6775 6d65 6e74  equired argument
-0000f300: 2c20 6067 726f 7570 5f6e 616d 6560 2c20  , `group_name`, 
-0000f310: 7768 6963 680a 7368 6f75 6c64 206d 6174  which.should mat
-0000f320: 6368 2074 6865 2076 616c 7565 206f 6620  ch the value of 
-0000f330: 6172 6775 6d65 6e74 2075 7365 6420 7768  argument used wh
-0000f340: 656e 2063 616c 6c69 6e67 2060 6372 6561  en calling `crea
-0000f350: 7465 5f73 7562 7363 7269 7074 696f 6e28  te_subscription(
-0000f360: 2960 2e0a 0a54 6869 7320 6d65 7468 6f64  )`...This method
-0000f370: 2061 6c73 6f20 7461 6b65 7320 616e 206f   also takes an o
-0000f380: 7074 696f 6e61 6c20 6074 696d 656f 7574  ptional `timeout
-0000f390: 6020 6172 6775 6d65 6e74 2c20 7468 6174  ` argument, that
-0000f3a0: 0a69 7320 6578 7065 6374 6564 2074 6f20  .is expected to 
-0000f3b0: 6265 2061 2050 7974 686f 6e20 6066 6c6f  be a Python `flo
-0000f3c0: 6174 602c 2077 6869 6368 2073 6574 7320  at`, which sets 
-0000f3d0: 6120 6465 6164 6c69 6e65 0a66 6f72 2074  a deadline.for t
-0000f3e0: 6865 2063 6f6d 706c 6574 696f 6e20 6f66  he completion of
-0000f3f0: 2074 6865 2067 5250 4320 6f70 6572 6174   the gRPC operat
-0000f400: 696f 6e2e 0a0a 6060 6070 7974 686f 6e0a  ion...```python.
-0000f410: 636c 6965 6e74 2e64 656c 6574 655f 7375  client.delete_su
-0000f420: 6273 6372 6970 7469 6f6e 280a 2020 2020  bscription(.    
-0000f430: 6772 6f75 705f 6e61 6d65 3d67 726f 7570  group_name=group
-0000f440: 5f6e 616d 652c 0a29 0a60 6060 0a0a 2323  _name,.).```..##
-0000f450: 2320 4372 6561 7465 2073 7472 6561 6d20  # Create stream 
-0000f460: 7375 6273 6372 6970 7469 6f6e 0a0a 2a72  subscription..*r
-0000f470: 6571 7569 7265 7320 6c65 6164 6572 2a0a  equires leader*.
-0000f480: 0a54 6865 2060 6372 6561 7465 5f73 7472  .The `create_str
-0000f490: 6561 6d5f 7375 6273 6372 6970 7469 6f6e  eam_subscription
-0000f4a0: 2829 6020 6d65 7468 6f64 2063 616e 2062  ()` method can b
-0000f4b0: 6520 7573 6564 2074 6f20 6372 6561 7465  e used to create
-0000f4c0: 2061 2070 6572 7369 7374 656e 740a 7375   a persistent.su
-0000f4d0: 6273 6372 6970 7469 6f6e 2066 6f72 2061  bscription for a
-0000f4e0: 2073 7472 6561 6d2e 0a0a 5468 6973 206d   stream...This m
-0000f4f0: 6574 686f 6420 6861 7320 7477 6f20 7265  ethod has two re
-0000f500: 7175 6972 6564 2061 7267 756d 656e 7473  quired arguments
-0000f510: 2c20 6067 726f 7570 5f6e 616d 6560 2061  , `group_name` a
-0000f520: 6e64 2060 7374 7265 616d 5f6e 616d 6560  nd `stream_name`
-0000f530: 2e20 5468 650a 6067 726f 7570 5f6e 616d  . The.`group_nam
-0000f540: 6560 2061 7267 756d 656e 7420 6e61 6d65  e` argument name
-0000f550: 7320 7468 6520 6772 6f75 7020 6f66 2063  s the group of c
-0000f560: 6f6e 7375 6d65 7273 2074 6861 7420 7769  onsumers that wi
-0000f570: 6c6c 2072 6563 6569 7665 2065 7665 6e74  ll receive event
-0000f580: 730a 6672 6f6d 2074 6869 7320 7375 6273  s.from this subs
-0000f590: 6372 6970 7469 6f6e 2e20 5468 6520 6073  cription. The `s
-0000f5a0: 7472 6561 6d5f 6e61 6d65 6020 6172 6775  tream_name` argu
-0000f5b0: 6d65 6e74 2073 7065 6369 6669 6573 2077  ment specifies w
-0000f5c0: 6869 6368 2073 7472 6561 6d0a 7468 6520  hich stream.the 
-0000f5d0: 7375 6273 6372 6970 7469 6f6e 2077 696c  subscription wil
-0000f5e0: 6c20 666f 6c6c 6f77 2e20 5468 6520 7661  l follow. The va
-0000f5f0: 6c75 6573 206f 6620 626f 7468 2074 6865  lues of both the
-0000f600: 7365 2061 7267 756d 656e 7473 2061 7265  se arguments are
-0000f610: 2065 7870 6563 7465 640a 746f 2062 6520   expected.to be 
-0000f620: 5079 7468 6f6e 2060 7374 7260 206f 626a  Python `str` obj
-0000f630: 6563 7473 2e0a 0a54 6865 206d 6574 686f  ects...The metho
-0000f640: 6420 616c 736f 2074 616b 6573 2066 6f75  d also takes fou
-0000f650: 7220 6f70 7469 6f6e 616c 2061 7267 756d  r optional argum
-0000f660: 656e 7473 2c20 6073 7472 6561 6d5f 706f  ents, `stream_po
-0000f670: 7369 7469 6f6e 602c 2060 6672 6f6d 5f65  sition`, `from_e
-0000f680: 6e64 602c 0a60 636f 6e73 756d 6572 5f73  nd`,.`consumer_s
-0000f690: 7472 6174 6567 7960 2c20 616e 6420 6074  trategy`, and `t
-0000f6a0: 696d 656f 7574 602e 0a0a 5468 6973 206f  imeout`...This o
-0000f6b0: 7074 696f 6e61 6c20 6073 7472 6561 6d5f  ptional `stream_
-0000f6c0: 706f 7369 7469 6f6e 6020 6172 6775 6d65  position` argume
-0000f6d0: 6e74 2073 7065 6369 6669 6573 2061 2073  nt specifies a s
-0000f6e0: 7472 6561 6d20 706f 7369 7469 6f6e 2066  tream position f
-0000f6f0: 726f 6d0a 7768 6963 6820 746f 2073 7562  rom.which to sub
-0000f700: 7363 7269 6265 2e20 5468 6520 7265 636f  scribe. The reco
-0000f710: 7264 6564 2065 7665 6e74 2061 7420 7468  rded event at th
-0000f720: 6973 2073 7472 6561 6d0a 706f 7369 7469  is stream.positi
-0000f730: 6f6e 2077 696c 6c20 6265 2072 6563 6569  on will be recei
-0000f740: 7665 6420 7768 656e 2072 6561 6469 6e67  ved when reading
-0000f750: 2074 6865 2073 7562 7363 7269 7074 696f   the subscriptio
-0000f760: 6e2e 0a0a 5468 6973 206f 7074 696f 6e61  n...This optiona
-0000f770: 6c20 6066 726f 6d5f 656e 6460 2061 7267  l `from_end` arg
-0000f780: 756d 656e 7420 6973 2061 2050 7974 686f  ument is a Pytho
-0000f790: 6e20 6062 6f6f 6c60 2e0a 4279 2064 6566  n `bool`..By def
-0000f7a0: 6175 6c74 2c20 7468 6520 7661 6c75 6520  ault, the value 
-0000f7b0: 6f66 2074 6869 7320 6172 6775 6d65 6e74  of this argument
-0000f7c0: 2069 7320 4661 6c73 652e 2049 6620 7468   is False. If th
-0000f7d0: 6973 2061 7267 756d 656e 7420 6973 2073  is argument is s
-0000f7e0: 6574 0a74 6f20 6120 5472 7565 2076 616c  et.to a True val
-0000f7f0: 7565 2c20 7265 6164 696e 6720 6672 6f6d  ue, reading from
-0000f800: 2074 6865 2073 7562 7363 7269 7074 696f   the subscriptio
-0000f810: 6e20 7769 6c6c 2072 6563 6569 7665 206f  n will receive o
-0000f820: 6e6c 7920 6576 656e 7473 0a72 6563 6f72  nly events.recor
-0000f830: 6465 6420 6166 7465 7220 7468 6520 7375  ded after the su
-0000f840: 6273 6372 6970 7469 6f6e 2077 6173 2063  bscription was c
-0000f850: 7265 6174 6564 2e20 5468 6174 2069 732c  reated. That is,
-0000f860: 2069 7420 6973 206e 6f74 2069 6e63 6c75   it is not inclu
-0000f870: 7369 7665 0a6f 6620 7468 6520 6375 7272  sive.of the curr
-0000f880: 656e 7420 7374 7265 616d 2070 6f73 6974  ent stream posit
-0000f890: 696f 6e2e 0a0a 5468 6520 6f70 7469 6f6e  ion...The option
-0000f8a0: 616c 2060 636f 6e73 756d 6572 5f73 7472  al `consumer_str
-0000f8b0: 6174 6567 7960 2061 7267 756d 656e 7420  ategy` argument 
-0000f8c0: 6973 2061 2050 7974 686f 6e20 6073 7472  is a Python `str
-0000f8d0: 6020 7468 6174 2064 6566 696e 6573 0a74  ` that defines.t
-0000f8e0: 6865 2063 6f6e 7375 6d65 7220 7374 7261  he consumer stra
-0000f8f0: 7465 6779 2066 6f72 2074 6869 7320 7065  tegy for this pe
-0000f900: 7273 6973 7465 6e74 2073 7562 7363 7269  rsistent subscri
-0000f910: 7074 696f 6e2e 2054 6865 2076 616c 7565  ption. The value
-0000f920: 206f 6620 7468 6973 2061 7267 756d 656e   of this argumen
-0000f930: 740a 6361 6e20 6265 2060 2744 6973 7061  t.can be `'Dispa
-0000f940: 7463 6854 6f53 696e 676c 6527 602c 2060  tchToSingle'`, `
-0000f950: 2752 6f75 6e64 526f 6269 6e27 602c 2060  'RoundRobin'`, `
-0000f960: 2750 696e 6e65 6427 602c 206f 7220 6027  'Pinned'`, or `'
-0000f970: 5069 6e6e 6564 4279 436f 7272 656c 6174  PinnedByCorrelat
-0000f980: 696f 6e27 602e 2054 6865 0a64 6566 6175  ion'`. The.defau
-0000f990: 6c74 2076 616c 7565 2069 7320 6027 4469  lt value is `'Di
-0000f9a0: 7370 6174 6368 546f 5369 6e67 6c65 2760  spatchToSingle'`
-0000f9b0: 2e0a 0a54 6869 7320 6d65 7468 6f64 2061  ...This method a
-0000f9c0: 6c73 6f20 7461 6b65 7320 616e 206f 7074  lso takes an opt
-0000f9d0: 696f 6e61 6c20 6074 696d 656f 7574 6020  ional `timeout` 
-0000f9e0: 6172 6775 6d65 6e74 2c20 7468 6174 0a69  argument, that.i
-0000f9f0: 7320 6578 7065 6374 6564 2074 6f20 6265  s expected to be
-0000fa00: 2061 2050 7974 686f 6e20 6066 6c6f 6174   a Python `float
-0000fa10: 602c 2077 6869 6368 2073 6574 7320 6120  `, which sets a 
-0000fa20: 6465 6164 6c69 6e65 0a66 6f72 2074 6865  deadline.for the
-0000fa30: 2063 6f6d 706c 6574 696f 6e20 6f66 2074   completion of t
-0000fa40: 6865 2067 5250 4320 6f70 6572 6174 696f  he gRPC operatio
-0000fa50: 6e2e 0a0a 5468 6973 206d 6574 686f 6420  n...This method 
-0000fa60: 646f 6573 206e 6f74 2072 6574 7572 6e20  does not return 
-0000fa70: 6120 7661 6c75 652e 2045 7665 6e74 7320  a value. Events 
-0000fa80: 6361 6e20 6265 2072 6563 6569 7665 6420  can be received 
-0000fa90: 6279 2069 7465 7261 7469 6e67 0a6f 7665  by iterating.ove
-0000faa0: 7220 7468 6520 7661 6c75 6520 7265 7475  r the value retu
-0000fab0: 726e 6564 2062 7920 6361 6c6c 696e 6720  rned by calling 
-0000fac0: 6072 6561 645f 7374 7265 616d 5f73 7562  `read_stream_sub
-0000fad0: 7363 7269 7074 696f 6e28 2960 2028 7365  scription()` (se
-0000fae0: 6520 6265 6c6f 7729 2e0a 0a54 6865 2065  e below)...The e
-0000faf0: 7861 6d70 6c65 2062 656c 6f77 2063 7265  xample below cre
-0000fb00: 6174 6573 2061 2070 6572 7369 7374 656e  ates a persisten
-0000fb10: 7420 7374 7265 616d 2073 7562 7363 7269  t stream subscri
-0000fb20: 7074 696f 6e20 6672 6f6d 2074 6865 2073  ption from the s
-0000fb30: 7461 7274 206f 6620 7468 6520 7374 7265  tart of the stre
-0000fb40: 616d 2e0a 0a60 6060 7079 7468 6f6e 0a23  am...```python.#
-0000fb50: 2043 7265 6174 6520 6120 7065 7273 6973   Create a persis
-0000fb60: 7465 6e74 2073 7472 6561 6d20 7375 6273  tent stream subs
-0000fb70: 6372 6970 7469 6f6e 2066 726f 6d20 7374  cription from st
-0000fb80: 6172 7420 6f66 2074 6865 2073 7472 6561  art of the strea
-0000fb90: 6d2e 0a67 726f 7570 5f6e 616d 6531 203d  m..group_name1 =
-0000fba0: 2066 2267 726f 7570 2d7b 7575 6964 3428   f"group-{uuid4(
-0000fbb0: 297d 220a 636c 6965 6e74 2e63 7265 6174  )}".client.creat
-0000fbc0: 655f 7374 7265 616d 5f73 7562 7363 7269  e_stream_subscri
-0000fbd0: 7074 696f 6e28 0a20 2020 2067 726f 7570  ption(.    group
-0000fbe0: 5f6e 616d 653d 6772 6f75 705f 6e61 6d65  _name=group_name
-0000fbf0: 312c 0a20 2020 2073 7472 6561 6d5f 6e61  1,.    stream_na
-0000fc00: 6d65 3d73 7472 6561 6d5f 6e61 6d65 322c  me=stream_name2,
-0000fc10: 0a29 0a60 6060 0a0a 5468 6520 6578 616d  .).```..The exam
-0000fc20: 706c 6520 6265 6c6f 7720 6372 6561 7465  ple below create
-0000fc30: 7320 6120 7065 7273 6973 7465 6e74 2073  s a persistent s
-0000fc40: 7472 6561 6d20 7375 6273 6372 6970 7469  tream subscripti
-0000fc50: 6f6e 2066 726f 6d20 6120 7374 7265 616d  on from a stream
-0000fc60: 2070 6f73 6974 696f 6e2e 0a0a 6060 6070   position...```p
-0000fc70: 7974 686f 6e0a 2320 4372 6561 7465 2061  ython.# Create a
-0000fc80: 2070 6572 7369 7374 656e 7420 7374 7265   persistent stre
-0000fc90: 616d 2073 7562 7363 7269 7074 696f 6e20  am subscription 
-0000fca0: 6672 6f6d 2061 2073 7472 6561 6d20 706f  from a stream po
-0000fcb0: 7369 7469 6f6e 2e0a 6772 6f75 705f 6e61  sition..group_na
-0000fcc0: 6d65 3220 3d20 6622 6772 6f75 702d 7b75  me2 = f"group-{u
-0000fcd0: 7569 6434 2829 7d22 0a63 6c69 656e 742e  uid4()}".client.
-0000fce0: 6372 6561 7465 5f73 7472 6561 6d5f 7375  create_stream_su
-0000fcf0: 6273 6372 6970 7469 6f6e 280a 2020 2020  bscription(.    
-0000fd00: 6772 6f75 705f 6e61 6d65 3d67 726f 7570  group_name=group
-0000fd10: 5f6e 616d 6532 2c0a 2020 2020 7374 7265  _name2,.    stre
-0000fd20: 616d 5f6e 616d 653d 7374 7265 616d 5f6e  am_name=stream_n
-0000fd30: 616d 6532 2c0a 2020 2020 7374 7265 616d  ame2,.    stream
-0000fd40: 5f70 6f73 6974 696f 6e3d 320a 290a 6060  _position=2.).``
-0000fd50: 600a 0a54 6865 2065 7861 6d70 6c65 2062  `..The example b
-0000fd60: 656c 6f77 2063 7265 6174 6573 2061 2070  elow creates a p
-0000fd70: 6572 7369 7374 656e 7420 7374 7265 616d  ersistent stream
-0000fd80: 2073 7562 7363 7269 7074 696f 6e20 6672   subscription fr
-0000fd90: 6f6d 2074 6865 2065 6e64 206f 6620 7468  om the end of th
-0000fda0: 6520 7374 7265 616d 2e0a 0a60 6060 7079  e stream...```py
-0000fdb0: 7468 6f6e 0a23 2043 7265 6174 6520 6120  thon.# Create a 
-0000fdc0: 7065 7273 6973 7465 6e74 2073 7472 6561  persistent strea
-0000fdd0: 6d20 7375 6273 6372 6970 7469 6f6e 2066  m subscription f
-0000fde0: 726f 6d20 656e 6420 6f66 2074 6865 2073  rom end of the s
-0000fdf0: 7472 6561 6d2e 0a67 726f 7570 5f6e 616d  tream..group_nam
-0000fe00: 6533 203d 2066 2267 726f 7570 2d7b 7575  e3 = f"group-{uu
-0000fe10: 6964 3428 297d 220a 636c 6965 6e74 2e63  id4()}".client.c
-0000fe20: 7265 6174 655f 7374 7265 616d 5f73 7562  reate_stream_sub
-0000fe30: 7363 7269 7074 696f 6e28 0a20 2020 2067  scription(.    g
-0000fe40: 726f 7570 5f6e 616d 653d 6772 6f75 705f  roup_name=group_
-0000fe50: 6e61 6d65 332c 0a20 2020 2073 7472 6561  name3,.    strea
-0000fe60: 6d5f 6e61 6d65 3d73 7472 6561 6d5f 6e61  m_name=stream_na
-0000fe70: 6d65 322c 0a20 2020 2066 726f 6d5f 656e  me2,.    from_en
-0000fe80: 643d 5472 7565 0a29 0a60 6060 0a0a 2323  d=True.).```..##
-0000fe90: 2320 5265 6164 2073 7472 6561 6d20 7375  # Read stream su
-0000fea0: 6273 6372 6970 7469 6f6e 0a0a 2a72 6571  bscription..*req
-0000feb0: 7569 7265 7320 6c65 6164 6572 2a0a 0a54  uires leader*..T
-0000fec0: 6865 2060 7265 6164 5f73 7472 6561 6d5f  he `read_stream_
-0000fed0: 7375 6273 6372 6970 7469 6f6e 2829 6020  subscription()` 
-0000fee0: 6d65 7468 6f64 2063 616e 2062 6520 7573  method can be us
-0000fef0: 6564 2074 6f20 6372 6561 7465 2061 2070  ed to create a p
-0000ff00: 6572 7369 7374 656e 740a 7375 6273 6372  ersistent.subscr
-0000ff10: 6970 7469 6f6e 2066 6f72 2061 2073 7472  iption for a str
-0000ff20: 6561 6d2e 0a0a 5468 6973 206d 6574 686f  eam...This metho
-0000ff30: 6420 6861 7320 7477 6f20 7265 7175 6972  d has two requir
-0000ff40: 6564 2061 7267 756d 656e 7473 2c20 6067  ed arguments, `g
-0000ff50: 726f 7570 5f6e 616d 6560 2061 6e64 2060  roup_name` and `
-0000ff60: 7374 7265 616d 5f6e 616d 6560 2c20 7768  stream_name`, wh
-0000ff70: 6963 680a 7368 6f75 6c64 206d 6174 6368  ich.should match
-0000ff80: 2074 6865 2076 616c 7565 7320 6f66 2061   the values of a
-0000ff90: 7267 756d 656e 7473 2075 7365 6420 7768  rguments used wh
-0000ffa0: 656e 2063 616c 6c69 6e67 2060 6372 6561  en calling `crea
-0000ffb0: 7465 5f73 7472 6561 6d5f 7375 6273 6372  te_stream_subscr
-0000ffc0: 6970 7469 6f6e 2829 602e 0a0a 5468 6973  iption()`...This
-0000ffd0: 206d 6574 686f 6420 616c 736f 2074 616b   method also tak
-0000ffe0: 6573 2061 6e20 6f70 7469 6f6e 616c 2060  es an optional `
-0000fff0: 7469 6d65 6f75 7460 2061 7267 756d 656e  timeout` argumen
-00010000: 742c 2074 6861 740a 6973 2065 7870 6563  t, that.is expec
-00010010: 7465 6420 746f 2062 6520 6120 5079 7468  ted to be a Pyth
-00010020: 6f6e 2060 666c 6f61 7460 2c20 7768 6963  on `float`, whic
-00010030: 6820 7365 7473 2061 2064 6561 646c 696e  h sets a deadlin
-00010040: 650a 666f 7220 7468 6520 636f 6d70 6c65  e.for the comple
-00010050: 7469 6f6e 206f 6620 7468 6520 6752 5043  tion of the gRPC
-00010060: 206f 7065 7261 7469 6f6e 2e0a 0a4a 7573   operation...Jus
-00010070: 7420 6c69 6b65 2060 7265 6164 5f73 7562  t like `read_sub
-00010080: 7363 7269 7074 696f 6e60 2c20 7468 6973  scription`, this
-00010090: 206d 6574 686f 6420 7265 7475 726e 7320   method returns 
-000100a0: 6120 322d 7475 706c 653a 2061 2022 7265  a 2-tuple: a "re
-000100b0: 6164 2072 6571 7565 7374 2220 6f62 6a65  ad request" obje
-000100c0: 6374 0a61 6e64 2061 2022 7265 6164 2072  ct.and a "read r
-000100d0: 6573 706f 6e73 6522 206f 626a 6563 742e  esponse" object.
-000100e0: 0a0a 6060 6070 7974 686f 6e0a 7265 6164  ..```python.read
-000100f0: 5f72 6571 2c20 7265 6164 5f72 6573 7020  _req, read_resp 
-00010100: 3d20 636c 6965 6e74 2e72 6561 645f 7374  = client.read_st
-00010110: 7265 616d 5f73 7562 7363 7269 7074 696f  ream_subscriptio
-00010120: 6e28 0a20 2020 2067 726f 7570 5f6e 616d  n(.    group_nam
-00010130: 653d 6772 6f75 705f 6e61 6d65 312c 0a20  e=group_name1,. 
-00010140: 2020 2073 7472 6561 6d5f 6e61 6d65 3d73     stream_name=s
-00010150: 7472 6561 6d5f 6e61 6d65 322c 0a29 0a60  tream_name2,.).`
-00010160: 6060 0a0a 5468 6520 6578 616d 706c 6520  ``..The example 
-00010170: 6265 6c6f 7720 6974 6572 6174 6573 206f  below iterates o
-00010180: 7665 7220 7468 6520 2272 6561 6420 7265  ver the "read re
-00010190: 7370 6f6e 7365 2220 6f62 6a65 6374 2c20  sponse" object, 
-000101a0: 616e 6420 6361 6c6c 7320 6061 636b 2829  and calls `ack()
-000101b0: 600a 6f6e 2074 6865 2022 7265 6164 2072  `.on the "read r
-000101c0: 6573 706f 6e73 6522 206f 626a 6563 742e  esponse" object.
-000101d0: 2054 6865 2066 6f72 206c 6f6f 7020 6272   The for loop br
-000101e0: 6561 6b73 2077 6865 6e20 7765 2068 6176  eaks when we hav
-000101f0: 6520 7265 6365 6976 6564 0a74 6865 206c  e received.the l
-00010200: 6173 7420 6576 656e 7420 696e 2074 6865  ast event in the
-00010210: 2073 7472 6561 6d2c 2073 6f20 7468 6174   stream, so that
-00010220: 2077 6520 6361 6e20 6669 6e69 7368 2074   we can finish t
-00010230: 6865 2065 7861 6d70 6c65 7320 696e 2074  he examples in t
-00010240: 6869 730a 646f 6375 6d65 6e74 6174 696f  his.documentatio
-00010250: 6e2e 0a0a 6060 6070 7974 686f 6e0a 6576  n...```python.ev
-00010260: 656e 7473 203d 205b 5d0a 666f 7220 6576  ents = [].for ev
-00010270: 656e 7420 696e 2072 6561 645f 7265 7370  ent in read_resp
-00010280: 3a0a 2020 2020 6576 656e 7473 2e61 7070  :.    events.app
-00010290: 656e 6428 6576 656e 7429 0a0a 2020 2020  end(event)..    
-000102a0: 2320 4163 6b6e 6f77 6c65 6467 6520 7468  # Acknowledge th
-000102b0: 6520 7265 6365 6976 6564 2065 7665 6e74  e received event
-000102c0: 2e0a 2020 2020 7265 6164 5f72 6571 2e61  ..    read_req.a
-000102d0: 636b 2865 7665 6e74 5f69 643d 6576 656e  ck(event_id=even
-000102e0: 742e 6964 290a 0a20 2020 2023 2042 7265  t.id)..    # Bre
-000102f0: 616b 2077 6865 6e20 7468 6520 6c61 7374  ak when the last
-00010300: 2065 7665 6e74 2068 6173 2062 6565 6e20   event has been 
-00010310: 7265 6365 6976 6564 2e0a 2020 2020 6966  received..    if
-00010320: 2065 7665 6e74 2e69 6420 3d3d 2065 7665   event.id == eve
-00010330: 6e74 3131 2e69 643a 0a20 2020 2020 2020  nt11.id:.       
-00010340: 2062 7265 616b 0a60 6060 0a0a 5765 2063   break.```..We c
-00010350: 616e 2063 6865 636b 2077 6520 7265 6365  an check we rece
-00010360: 6976 6564 2061 6c6c 2074 6865 2065 7665  ived all the eve
-00010370: 6e74 7320 7468 6174 2077 6572 6520 6170  nts that were ap
-00010380: 7065 6e64 6564 2074 6f20 6073 7472 6561  pended to `strea
-00010390: 6d5f 6e61 6d65 3260 0a69 6e20 7468 6520  m_name2`.in the 
-000103a0: 6578 616d 706c 6573 2061 626f 7665 2e0a  examples above..
-000103b0: 0a60 6060 7079 7468 6f6e 0a61 7373 6572  .```python.asser
-000103c0: 7420 6c65 6e28 6576 656e 7473 2920 3d3d  t len(events) ==
-000103d0: 2034 0a61 7373 6572 7420 6576 656e 7473   4.assert events
-000103e0: 5b30 5d2e 7374 7265 616d 5f6e 616d 6520  [0].stream_name 
-000103f0: 3d3d 2073 7472 6561 6d5f 6e61 6d65 320a  == stream_name2.
-00010400: 6173 7365 7274 2065 7665 6e74 735b 305d  assert events[0]
-00010410: 2e69 6420 3d3d 2065 7665 6e74 342e 6964  .id == event4.id
-00010420: 0a61 7373 6572 7420 6576 656e 7473 5b31  .assert events[1
-00010430: 5d2e 7374 7265 616d 5f6e 616d 6520 3d3d  ].stream_name ==
-00010440: 2073 7472 6561 6d5f 6e61 6d65 320a 6173   stream_name2.as
-00010450: 7365 7274 2065 7665 6e74 735b 315d 2e69  sert events[1].i
-00010460: 6420 3d3d 2065 7665 6e74 352e 6964 0a61  d == event5.id.a
-00010470: 7373 6572 7420 6576 656e 7473 5b32 5d2e  ssert events[2].
-00010480: 7374 7265 616d 5f6e 616d 6520 3d3d 2073  stream_name == s
-00010490: 7472 6561 6d5f 6e61 6d65 320a 6173 7365  tream_name2.asse
-000104a0: 7274 2065 7665 6e74 735b 325d 2e69 6420  rt events[2].id 
-000104b0: 3d3d 2065 7665 6e74 362e 6964 0a61 7373  == event6.id.ass
-000104c0: 6572 7420 6576 656e 7473 5b33 5d2e 7374  ert events[3].st
-000104d0: 7265 616d 5f6e 616d 6520 3d3d 2073 7472  ream_name == str
-000104e0: 6561 6d5f 6e61 6d65 320a 6173 7365 7274  eam_name2.assert
-000104f0: 2065 7665 6e74 735b 335d 2e69 6420 3d3d   events[3].id ==
-00010500: 2065 7665 6e74 3131 2e69 640a 6060 600a   event11.id.```.
-00010510: 0a23 2323 2047 6574 2073 7472 6561 6d20  .### Get stream 
-00010520: 7375 6273 6372 6970 7469 6f6e 2069 6e66  subscription inf
-00010530: 6f0a 0a2a 7265 7175 6972 6573 206c 6561  o..*requires lea
-00010540: 6465 722a 0a0a 5468 6520 6067 6574 5f73  der*..The `get_s
-00010550: 7472 6561 6d5f 7375 6273 6372 6970 7469  tream_subscripti
-00010560: 6f6e 5f69 6e66 6f28 2960 206d 6574 686f  on_info()` metho
-00010570: 6420 6361 6e20 6265 2075 7365 6420 746f  d can be used to
-00010580: 2067 6574 2069 6e66 6f72 6d61 7469 6f6e   get information
-00010590: 2066 6f72 2061 0a70 6572 7369 7374 656e   for a.persisten
-000105a0: 7420 7375 6273 6372 6970 7469 6f6e 2066  t subscription f
-000105b0: 6f72 2061 2073 7472 6561 6d2e 0a0a 5468  or a stream...Th
-000105c0: 6973 206d 6574 686f 6420 6861 7320 7477  is method has tw
-000105d0: 6f20 7265 7175 6972 6564 2061 7267 756d  o required argum
-000105e0: 656e 7473 2c20 6067 726f 7570 5f6e 616d  ents, `group_nam
-000105f0: 6560 2061 6e64 2060 7374 7265 616d 5f6e  e` and `stream_n
-00010600: 616d 6560 2c20 7768 6963 680a 7368 6f75  ame`, which.shou
-00010610: 6c64 206d 6174 6368 2074 6865 2076 616c  ld match the val
-00010620: 7565 7320 6f66 2061 7267 756d 656e 7473  ues of arguments
-00010630: 2075 7365 6420 7768 656e 2063 616c 6c69   used when calli
-00010640: 6e67 2060 6372 6561 7465 5f73 7472 6561  ng `create_strea
-00010650: 6d5f 7375 6273 6372 6970 7469 6f6e 2829  m_subscription()
-00010660: 602e 0a0a 5468 6973 206d 6574 686f 6420  `...This method 
-00010670: 616c 736f 2074 616b 6573 2061 6e20 6f70  also takes an op
-00010680: 7469 6f6e 616c 2060 7469 6d65 6f75 7460  tional `timeout`
-00010690: 2061 7267 756d 656e 742c 2074 6861 740a   argument, that.
-000106a0: 6973 2065 7870 6563 7465 6420 746f 2062  is expected to b
-000106b0: 6520 6120 5079 7468 6f6e 2060 666c 6f61  e a Python `floa
-000106c0: 7460 2c20 7768 6963 6820 7365 7473 2061  t`, which sets a
-000106d0: 2064 6561 646c 696e 650a 666f 7220 7468   deadline.for th
-000106e0: 6520 636f 6d70 6c65 7469 6f6e 206f 6620  e completion of 
-000106f0: 7468 6520 6752 5043 206f 7065 7261 7469  the gRPC operati
-00010700: 6f6e 2e0a 0a60 6060 7079 7468 6f6e 0a73  on...```python.s
-00010710: 7562 7363 7269 7074 696f 6e5f 696e 666f  ubscription_info
-00010720: 203d 2063 6c69 656e 742e 6765 745f 7374   = client.get_st
-00010730: 7265 616d 5f73 7562 7363 7269 7074 696f  ream_subscriptio
-00010740: 6e5f 696e 666f 280a 2020 2020 6772 6f75  n_info(.    grou
-00010750: 705f 6e61 6d65 3d67 726f 7570 5f6e 616d  p_name=group_nam
-00010760: 6531 2c0a 2020 2020 7374 7265 616d 5f6e  e1,.    stream_n
-00010770: 616d 653d 7374 7265 616d 5f6e 616d 6532  ame=stream_name2
-00010780: 2c0a 290a 6060 600a 0a54 6865 2072 6574  ,.).```..The ret
-00010790: 7572 6e65 6420 7661 6c75 6520 6973 2061  urned value is a
-000107a0: 2060 5375 6273 6372 6970 7469 6f6e 496e   `SubscriptionIn
-000107b0: 666f 6020 6f62 6a65 6374 2e0a 0a23 2323  fo` object...###
-000107c0: 204c 6973 7420 7374 7265 616d 2073 7562   List stream sub
-000107d0: 7363 7269 7074 696f 6e73 0a0a 2a72 6571  scriptions..*req
-000107e0: 7569 7265 7320 6c65 6164 6572 2a0a 0a54  uires leader*..T
-000107f0: 6865 2060 6c69 7374 5f73 7472 6561 6d5f  he `list_stream_
-00010800: 7375 6273 6372 6970 7469 6f6e 7328 2960  subscriptions()`
-00010810: 206d 6574 686f 6420 6361 6e20 6265 2075   method can be u
-00010820: 7365 6420 746f 2067 6574 2069 6e66 6f72  sed to get infor
-00010830: 6d61 7469 6f6e 2066 6f72 2061 6c6c 0a74  mation for all.t
-00010840: 6865 2070 6572 7369 7374 656e 7420 7375  he persistent su
-00010850: 6273 6372 6970 7469 6f6e 7320 666f 7220  bscriptions for 
-00010860: 6120 7374 7265 616d 2e0a 0a54 6869 7320  a stream...This 
-00010870: 6d65 7468 6f64 2068 6173 206f 6e65 2072  method has one r
-00010880: 6571 7569 7265 6420 6172 6775 6d65 6e74  equired argument
-00010890: 2c20 6073 7472 6561 6d5f 6e61 6d65 602e  , `stream_name`.
-000108a0: 0a0a 5468 6973 206d 6574 686f 6420 616c  ..This method al
-000108b0: 736f 2074 616b 6573 2061 6e20 6f70 7469  so takes an opti
-000108c0: 6f6e 616c 2060 7469 6d65 6f75 7460 2061  onal `timeout` a
-000108d0: 7267 756d 656e 742c 2074 6861 740a 6973  rgument, that.is
-000108e0: 2065 7870 6563 7465 6420 746f 2062 6520   expected to be 
-000108f0: 6120 5079 7468 6f6e 2060 666c 6f61 7460  a Python `float`
-00010900: 2c20 7768 6963 6820 7365 7473 2061 2064  , which sets a d
-00010910: 6561 646c 696e 650a 666f 7220 7468 6520  eadline.for the 
-00010920: 636f 6d70 6c65 7469 6f6e 206f 6620 7468  completion of th
-00010930: 6520 6752 5043 206f 7065 7261 7469 6f6e  e gRPC operation
-00010940: 2e0a 0a60 6060 7079 7468 6f6e 0a73 7562  ...```python.sub
-00010950: 7363 7269 7074 696f 6e73 203d 2063 6c69  scriptions = cli
-00010960: 656e 742e 6c69 7374 5f73 7472 6561 6d5f  ent.list_stream_
-00010970: 7375 6273 6372 6970 7469 6f6e 7328 0a20  subscriptions(. 
-00010980: 2020 2073 7472 6561 6d5f 6e61 6d65 3d73     stream_name=s
-00010990: 7472 6561 6d5f 6e61 6d65 322c 0a29 0a60  tream_name2,.).`
-000109a0: 6060 0a0a 5468 6520 7265 7475 726e 6564  ``..The returned
-000109b0: 2076 616c 7565 2069 7320 6120 6c69 7374   value is a list
-000109c0: 206f 6620 6053 7562 7363 7269 7074 696f   of `Subscriptio
-000109d0: 6e49 6e66 6f60 206f 626a 6563 7473 2e0a  nInfo` objects..
-000109e0: 0a23 2323 2044 656c 6574 6520 7374 7265  .### Delete stre
-000109f0: 616d 2073 7562 7363 7269 7074 696f 6e0a  am subscription.
-00010a00: 0a2a 7265 7175 6972 6573 206c 6561 6465  .*requires leade
-00010a10: 722a 0a0a 5468 6520 6064 656c 6574 655f  r*..The `delete_
-00010a20: 7374 7265 616d 5f73 7562 7363 7269 7074  stream_subscript
-00010a30: 696f 6e28 2960 206d 6574 686f 6420 6361  ion()` method ca
-00010a40: 6e20 6265 2075 7365 6420 746f 2064 656c  n be used to del
-00010a50: 6574 6520 6120 7065 7273 6973 7465 6e74  ete a persistent
-00010a60: 0a73 7562 7363 7269 7074 696f 6e20 666f  .subscription fo
-00010a70: 7220 6120 7374 7265 616d 2e0a 0a54 6869  r a stream...Thi
-00010a80: 7320 6d65 7468 6f64 2068 6173 2074 776f  s method has two
-00010a90: 2072 6571 7569 7265 6420 6172 6775 6d65   required argume
-00010aa0: 6e74 732c 2060 6772 6f75 705f 6e61 6d65  nts, `group_name
-00010ab0: 6020 616e 6420 6073 7472 6561 6d5f 6e61  ` and `stream_na
-00010ac0: 6d65 602c 2077 6869 6368 0a73 686f 756c  me`, which.shoul
-00010ad0: 6420 6d61 7463 6820 7468 6520 7661 6c75  d match the valu
-00010ae0: 6573 206f 6620 6172 6775 6d65 6e74 7320  es of arguments 
-00010af0: 7573 6564 2077 6865 6e20 6361 6c6c 696e  used when callin
-00010b00: 6720 6063 7265 6174 655f 7374 7265 616d  g `create_stream
-00010b10: 5f73 7562 7363 7269 7074 696f 6e28 2960  _subscription()`
-00010b20: 2e0a 0a54 6869 7320 6d65 7468 6f64 2061  ...This method a
-00010b30: 6c73 6f20 7461 6b65 7320 616e 206f 7074  lso takes an opt
-00010b40: 696f 6e61 6c20 6074 696d 656f 7574 6020  ional `timeout` 
-00010b50: 6172 6775 6d65 6e74 2c20 7468 6174 0a69  argument, that.i
-00010b60: 7320 6578 7065 6374 6564 2074 6f20 6265  s expected to be
-00010b70: 2061 2050 7974 686f 6e20 6066 6c6f 6174   a Python `float
-00010b80: 602c 2077 6869 6368 2073 6574 7320 6120  `, which sets a 
-00010b90: 6465 6164 6c69 6e65 0a66 6f72 2074 6865  deadline.for the
-00010ba0: 2063 6f6d 706c 6574 696f 6e20 6f66 2074   completion of t
-00010bb0: 6865 2067 5250 4320 6f70 6572 6174 696f  he gRPC operatio
-00010bc0: 6e2e 0a0a 6060 6070 7974 686f 6e0a 636c  n...```python.cl
-00010bd0: 6965 6e74 2e64 656c 6574 655f 7374 7265  ient.delete_stre
-00010be0: 616d 5f73 7562 7363 7269 7074 696f 6e28  am_subscription(
-00010bf0: 0a20 2020 2067 726f 7570 5f6e 616d 653d  .    group_name=
-00010c00: 6772 6f75 705f 6e61 6d65 312c 0a20 2020  group_name1,.   
-00010c10: 2073 7472 6561 6d5f 6e61 6d65 3d73 7472   stream_name=str
-00010c20: 6561 6d5f 6e61 6d65 322c 0a29 0a60 6060  eam_name2,.).```
-00010c30: 0a0a 2323 2043 6f6e 6e65 6374 696f 6e0a  ..## Connection.
-00010c40: 0a23 2323 2052 6563 6f6e 6e65 6374 0a0a  .### Reconnect..
-00010c50: 5468 6520 6072 6563 6f6e 6e65 6374 2829  The `reconnect()
-00010c60: 6020 6d65 7468 6f64 2063 616e 2062 6520  ` method can be 
-00010c70: 7573 6564 2074 6f20 6d61 6e75 616c 6c79  used to manually
-00010c80: 2072 6563 6f6e 6e65 6374 2074 6865 2063   reconnect the c
-00010c90: 6c69 656e 7420 746f 2061 0a73 7569 7461  lient to a.suita
-00010ca0: 626c 6520 4576 656e 7453 746f 7265 4442  ble EventStoreDB
-00010cb0: 206e 6f64 652e 2054 6869 7320 6d65 7468   node. This meth
-00010cc0: 6f64 2075 7365 7320 7468 6520 7361 6d65  od uses the same
-00010cd0: 2072 6f75 7469 6e65 2066 6f72 2072 6561   routine for rea
-00010ce0: 6469 6e67 2074 6865 0a63 6c75 7374 6572  ding the.cluster
-00010cf0: 206e 6f64 6520 7374 6174 6573 2061 6e64   node states and
-00010d00: 2074 6865 6e20 636f 6e6e 6563 7469 6e67   then connecting
-00010d10: 2074 6f20 6120 7375 6974 6162 6c65 206e   to a suitable n
-00010d20: 6f64 6520 6163 636f 7264 696e 6720 746f  ode according to
-00010d30: 2074 6865 0a63 6c69 656e 7427 7320 6e6f   the.client's no
-00010d40: 6465 2070 7265 6665 7265 6e63 6520 7468  de preference th
-00010d50: 6174 2069 7320 7370 6563 6966 6965 6420  at is specified 
-00010d60: 696e 2074 6865 2063 6f6e 6e65 6374 696f  in the connectio
-00010d70: 6e20 7374 7269 6e67 2055 5249 2077 6865  n string URI whe
-00010d80: 6e0a 7468 6520 636c 6965 6e74 2069 7320  n.the client is 
-00010d90: 636f 6e73 7472 7563 7465 642e 2054 6869  constructed. Thi
-00010da0: 7320 6d65 7468 6f64 2069 7320 7468 7265  s method is thre
-00010db0: 6164 2d73 6166 652c 2061 6e64 2069 7420  ad-safe, and it 
-00010dc0: 6973 2022 636f 6e73 6572 7661 7469 7665  is "conservative
-00010dd0: 220a 696e 2074 6861 742c 2077 6865 6e20  ".in that, when 
-00010de0: 6974 2069 7320 6361 6c6c 6564 2062 7920  it is called by 
-00010df0: 7365 7665 7261 6c20 7468 7265 6164 7320  several threads 
-00010e00: 6174 2074 6865 2073 616d 6520 7469 6d65  at the same time
-00010e10: 2c20 6f6e 6c79 206f 6e65 0a72 6563 6f6e  , only one.recon
-00010e20: 6e65 6374 696f 6e20 7769 6c6c 206f 6363  nection will occ
-00010e30: 7572 2e20 436f 6e63 7572 7265 6e74 2061  ur. Concurrent a
-00010e40: 7474 656d 7074 7320 746f 2072 6563 6f6e  ttempts to recon
-00010e50: 6e65 6374 2077 696c 6c20 626c 6f63 6b20  nect will block 
-00010e60: 756e 7469 6c0a 7468 6520 636c 6965 6e74  until.the client
-00010e70: 2068 6173 2072 6563 6f6e 6e65 6374 6564   has reconnected
-00010e80: 2073 7563 6365 7373 6675 6c6c 792c 2061   successfully, a
-00010e90: 6e64 2074 6865 6e20 7468 6579 2077 696c  nd then they wil
-00010ea0: 6c20 616c 6c20 7265 7475 726e 206e 6f72  l all return nor
-00010eb0: 6d61 6c6c 792e 0a0a 6060 6070 7974 686f  mally...```pytho
-00010ec0: 6e0a 636c 6965 6e74 2e72 6563 6f6e 6e65  n.client.reconne
-00010ed0: 6374 2829 0a60 6060 0a0a 416e 2065 7861  ct().```..An exa
-00010ee0: 6d70 6c65 206f 6620 7768 656e 2069 7420  mple of when it 
-00010ef0: 6d69 6768 7420 6265 2064 6573 6972 6162  might be desirab
-00010f00: 6c65 2074 6f20 7265 636f 6e6e 6563 7420  le to reconnect 
-00010f10: 6d61 6e75 616c 6c79 2069 7320 7768 656e  manually is when
-00010f20: 2028 666f 7220 7065 7266 6f72 6d61 6e63   (for performanc
-00010f30: 650a 7265 6173 6f6e 7329 2074 6865 2063  e.reasons) the c
-00010f40: 6c69 656e 7427 7320 6e6f 6465 2070 7265  lient's node pre
-00010f50: 6665 7265 6e63 6520 6973 2074 6f20 6265  ference is to be
-00010f60: 2063 6f6e 6e65 6374 6564 2074 6f20 6120   connected to a 
-00010f70: 666f 6c6c 6f77 6572 206e 6f64 6520 696e  follower node in
-00010f80: 2074 6865 0a63 6c75 7374 6572 2c20 616e   the.cluster, an
-00010f90: 642c 2061 6674 6572 2061 2063 6c75 7374  d, after a clust
-00010fa0: 6572 206c 6561 6465 7220 656c 6563 7469  er leader electi
-00010fb0: 6f6e 2c20 7468 6520 666f 6c6c 6f77 6572  on, the follower
-00010fc0: 2062 6563 6f6d 6573 2074 6865 206c 6561   becomes the lea
-00010fd0: 6465 722e 0a52 6563 6f6e 6e65 6374 696e  der..Reconnectin
-00010fe0: 6720 746f 2061 2066 6f6c 6c6f 7765 7220  g to a follower 
-00010ff0: 6e6f 6465 2069 6e20 7468 6973 2063 6173  node in this cas
-00011000: 6520 6973 2063 7572 7265 6e74 6c79 2062  e is currently b
-00011010: 6579 6f6e 6420 7468 6520 6361 7061 6269  eyond the capabi
-00011020: 6c69 7469 6573 206f 660a 7468 6973 2063  lities of.this c
-00011030: 6c69 656e 742c 2062 7574 2074 6869 7320  lient, but this 
-00011040: 6265 6861 7669 6f72 206d 6967 6874 2062  behavior might b
-00011050: 6520 696d 706c 656d 656e 7465 6420 696e  e implemented in
-00011060: 2061 2066 7574 7572 6520 7265 6c65 6173   a future releas
-00011070: 652e 0a0a 506c 6561 7365 206e 6f74 652c  e...Please note,
-00011080: 206e 6561 726c 7920 616c 6c20 7468 6520   nearly all the 
-00011090: 636c 6965 6e74 206d 6574 686f 6473 2061  client methods a
-000110a0: 7265 2064 6563 6f72 6174 6564 2077 6974  re decorated wit
-000110b0: 6820 6040 6175 746f 7265 636f 6e6e 6563  h `@autoreconnec
-000110c0: 7460 2028 7768 6963 680a 6361 6c6c 7320  t` (which.calls 
-000110d0: 7468 6520 6072 6563 6f6e 6e65 6374 2829  the `reconnect()
-000110e0: 6020 6d65 7468 6f64 2077 6865 6e20 7468  ` method when th
-000110f0: 6520 636c 6965 6e74 2064 6574 6563 7473  e client detects
-00011100: 2074 6861 7420 7265 636f 6e6e 6563 7469   that reconnecti
-00011110: 6e67 2069 7320 7265 7175 6972 6564 290a  ng is required).
-00011120: 616e 6420 6120 6040 7265 7472 7960 2064  and a `@retry` d
-00011130: 6563 6f72 6174 6f72 2074 6861 7420 6d6f  ecorator that mo
-00011140: 7265 2067 656e 6572 616c 6c79 2077 696c  re generally wil
-00011150: 6c20 7265 7472 7920 6f70 6572 6174 696f  l retry operatio
-00011160: 6e73 2074 6861 7420 6661 696c 2064 7565  ns that fail due
-00011170: 2074 6f0a 636f 6e6e 6563 7469 6f6e 2069   to.connection i
-00011180: 7373 7565 732e 0a0a 5468 6520 6040 6175  ssues...The `@au
-00011190: 746f 7265 636f 6e6e 6563 7460 2064 6563  toreconnect` dec
-000111a0: 6f72 6174 6f72 2077 696c 6c20 7265 636f  orator will reco
-000111b0: 6e6e 6563 7420 746f 2061 2073 7569 7461  nnect to a suita
-000111c0: 626c 6520 6e6f 6465 2069 6e20 7468 6520  ble node in the 
-000111d0: 636c 7573 7465 7220 7768 656e 0a74 6865  cluster when.the
-000111e0: 2073 6572 7665 7220 746f 2077 6869 6368   server to which
-000111f0: 2074 6865 2063 6c69 656e 7420 6861 7320   the client has 
-00011200: 6265 656e 2063 6f6e 6e65 6374 6564 2068  been connected h
-00011210: 6173 2062 6563 6f6d 6520 756e 6176 6169  as become unavai
-00011220: 6c61 626c 652c 206f 7220 7768 656e 2074  lable, or when t
-00011230: 6865 0a63 6c69 656e 7427 7320 6752 5043  he.client's gRPC
-00011240: 2063 6861 6e6e 656c 2068 6170 7065 6e73   channel happens
-00011250: 2074 6f20 6861 7665 2062 6565 6e20 636c   to have been cl
-00011260: 6f73 6564 2e20 5468 6520 636c 6965 6e74  osed. The client
-00011270: 2077 696c 6c20 616c 736f 2072 6563 6f6e   will also recon
-00011280: 6e65 6374 2077 6865 6e0a 6120 6d65 7468  nect when.a meth
-00011290: 6f64 2069 7320 6361 6c6c 6564 2074 6861  od is called tha
-000112a0: 7420 7265 7175 6972 6573 2061 206c 6561  t requires a lea
-000112b0: 6465 722c 2061 6e64 2074 6865 2063 6c69  der, and the cli
-000112c0: 656e 7427 7320 6e6f 6465 2070 7265 6665  ent's node prefe
-000112d0: 7265 6e63 6520 6973 2074 6f20 6265 0a63  rence is to be.c
-000112e0: 6f6e 6e65 6374 6564 2074 6f20 6120 6c65  onnected to a le
-000112f0: 6164 6572 2c20 6275 7420 7468 6520 6e6f  ader, but the no
-00011300: 6465 2074 6861 7420 7468 6520 636c 6965  de that the clie
-00011310: 6e74 2068 6173 2062 6565 6e20 636f 6e6e  nt has been conn
-00011320: 6563 7465 6420 746f 2073 746f 7073 2062  ected to stops b
-00011330: 6569 6e67 0a74 6865 206c 6561 6465 722e  eing.the leader.
-00011340: 2049 6e20 7468 6973 2063 6173 652c 2074   In this case, t
-00011350: 6865 2063 6c69 656e 7420 7769 6c6c 2072  he client will r
-00011360: 6563 6f6e 6e65 6374 2074 6f20 7468 6520  econnect to the 
-00011370: 6375 7272 656e 7420 6c65 6164 6572 2e20  current leader. 
-00011380: 4166 7465 720a 7265 636f 6e6e 6563 7469  After.reconnecti
-00011390: 6e67 2c20 7468 6520 6661 696c 6564 206f  ng, the failed o
-000113a0: 7065 7261 7469 6f6e 2077 696c 6c20 6265  peration will be
-000113b0: 2072 6574 7269 6564 2e0a 0a54 6865 2060   retried...The `
-000113c0: 4072 6574 7279 6020 6465 636f 7261 746f  @retry` decorato
-000113d0: 7220 7265 7472 6965 7320 6f70 6572 6174  r retries operat
-000113e0: 696f 6e73 2074 6861 7420 6861 7665 2066  ions that have f
-000113f0: 6169 6c65 6420 6475 6520 746f 206d 6f72  ailed due to mor
-00011400: 6520 6765 6e65 7261 6c0a 636f 6e6e 6563  e general.connec
-00011410: 7469 6f6e 2069 7373 7565 732c 2073 7563  tion issues, suc
-00011420: 6820 6173 2061 2064 6561 646c 696e 6520  h as a deadline 
-00011430: 6265 696e 6720 7265 6163 6865 6420 2873  being reached (s
-00011440: 6f20 7468 6174 2074 6865 206f 7065 7261  o that the opera
-00011450: 7469 6f6e 2074 696d 6573 0a6f 7574 292c  tion times.out),
-00011460: 206f 7220 696e 2063 6173 6520 7468 6520   or in case the 
-00011470: 7365 7276 6572 2074 6872 6f77 7320 616e  server throws an
-00011480: 2065 7863 6570 7469 6f6e 2077 6865 6e20   exception when 
-00011490: 6861 6e64 6c69 6e67 2061 2063 6c69 656e  handling a clien
-000114a0: 7420 7265 7175 6573 742e 0a0a 506c 6561  t request...Plea
-000114b0: 7365 2061 6c73 6f20 6e6f 7465 2c20 7468  se also note, th
-000114c0: 6520 6173 7065 6374 7320 6e6f 7420 636f  e aspects not co
-000114d0: 7665 7265 6420 6279 2074 6865 2072 6563  vered by the rec
-000114e0: 6f6e 6e65 6374 2061 6e64 2072 6574 7279  onnect and retry
-000114f0: 2064 6563 6f72 6174 6f72 0a62 6568 6176   decorator.behav
-00011500: 696f 7572 7320 6861 7665 2074 6f20 646f  iours have to do
-00011510: 2077 6974 6820 6d65 7468 6f64 7320 7468   with methods th
-00011520: 6174 2072 6574 7572 6e20 6974 6572 6174  at return iterat
-00011530: 6f72 732e 2046 6f72 2065 7861 6d70 6c65  ors. For example
-00011540: 2c20 636f 6e73 6964 6572 0a74 6865 2060  , consider.the `
-00011550: 7265 6164 5f61 6c6c 5f65 7665 6e74 7328  read_all_events(
-00011560: 2960 206d 6574 686f 642c 2077 6869 6368  )` method, which
-00011570: 2072 6574 7572 6e73 2061 6e20 6974 6572   returns an iter
-00011580: 6174 6f72 206f 6620 6052 6563 6f72 6465  ator of `Recorde
-00011590: 6445 7665 6e74 6020 6f62 6a65 6374 732e  dEvent` objects.
-000115a0: 0a54 6865 206d 6574 686f 6420 6861 7320  .The method has 
-000115b0: 7265 7475 726e 6564 2061 6e64 2074 6865  returned and the
-000115c0: 206d 6574 686f 6420 6465 636f 7261 746f   method decorato
-000115d0: 7273 2068 6176 6520 7468 6572 6566 6f72  rs have therefor
-000115e0: 6520 6578 6974 6564 2062 6566 6f72 6520  e exited before 
-000115f0: 7468 650a 6974 6572 6174 696e 6720 6f66  the.iterating of
-00011600: 2074 6865 2072 6573 706f 6e73 6520 6265   the response be
-00011610: 6769 6e73 2e20 5468 6572 6566 6f72 652c  gins. Therefore,
-00011620: 2069 7420 6973 6e27 7420 706f 7373 6962   it isn't possib
-00011630: 6c65 2066 6f72 2074 6869 7320 6d65 7468  le for this meth
-00011640: 6f64 2074 6f0a 7472 6967 6765 7220 6120  od to.trigger a 
-00011650: 7265 636f 6e6e 6563 7469 6f6e 206f 7220  reconnection or 
-00011660: 666f 7220 6974 2074 6f20 7265 7472 792c  for it to retry,
-00011670: 2077 6865 6e20 7468 6520 7374 7265 616d   when the stream
-00011680: 696e 6720 7265 7370 6f6e 7365 2073 6f6d  ing response som
-00011690: 6568 6f77 2066 6169 6c73 2e0a 0a41 6e6f  ehow fails...Ano
-000116a0: 7468 6572 2065 7861 6d70 6c65 2069 7320  ther example is 
-000116b0: 7468 6520 2263 6174 6368 2d75 7022 2061  the "catch-up" a
-000116c0: 6e64 2070 6572 7369 7374 656e 7420 7375  nd persistent su
-000116d0: 6273 6372 6970 7469 6f6e 2072 6561 6420  bscription read 
-000116e0: 6d65 7468 6f64 732c 2061 6c74 686f 7567  methods, althoug
-000116f0: 680a 7769 7468 2074 6865 7365 206d 6574  h.with these met
-00011700: 686f 6473 2074 6865 7265 2069 7320 616e  hods there is an
-00011710: 2069 6e69 7469 616c 2022 636f 6e66 6972   initial "confir
-00011720: 6d61 7469 6f6e 2220 7265 7370 6f6e 7365  mation" response
-00011730: 2066 726f 6d20 7468 6520 7365 7276 6572   from the server
-00011740: 2077 6869 6368 0a69 7320 7265 6365 6976   which.is receiv
-00011750: 6564 2061 6e64 2063 6865 636b 6564 2062  ed and checked b
-00011760: 7920 7468 6520 636c 6965 6e74 2062 6566  y the client bef
-00011770: 6f72 6520 7468 6520 6d65 7468 6f64 2072  ore the method r
-00011780: 6574 7572 6e73 2c20 736f 2069 6620 7468  eturns, so if th
-00011790: 6520 7365 7276 6572 2069 730a 756e 6176  e server is.unav
-000117a0: 6169 6c61 626c 6520 7768 656e 2074 6865  ailable when the
-000117b0: 2063 616c 6c20 6973 206d 6164 652c 206f   call is made, o
-000117c0: 7220 6966 2074 6865 2063 6861 6e6e 656c  r if the channel
-000117d0: 2069 7320 736f 6d65 686f 7720 636c 6f73   is somehow clos
-000117e0: 6564 2c20 6f72 2069 6620 7468 650a 7365  ed, or if the.se
-000117f0: 7276 6572 2074 6872 6f77 7320 616e 2065  rver throws an e
-00011800: 7272 6f72 2066 6f72 2073 6f6d 6520 7265  rror for some re
-00011810: 6173 6f6e 2c20 7468 656e 2074 6865 2063  ason, then the c
-00011820: 6c69 656e 7420 7769 6c6c 2065 6974 6865  lient will eithe
-00011830: 7220 7265 636f 6e6e 6563 7420 616e 640a  r reconnect and.
-00011840: 7265 7472 792c 206f 7220 6d6f 7265 2073  retry, or more s
-00011850: 696d 706c 7920 6a75 7374 2072 6574 7279  imply just retry
-00011860: 2074 6865 206f 7065 7261 7469 6f6e 2c20   the operation, 
-00011870: 6163 636f 7264 696e 6720 7468 6520 7479  according the ty
-00011880: 7065 206f 6620 6572 726f 7220 7468 6174  pe of error that
-00011890: 0a77 6173 2065 6e63 6f75 6e74 6572 6564  .was encountered
-000118a0: 2e20 486f 7765 7665 722c 2061 6e20 6576  . However, an ev
-000118b0: 656e 742d 7072 6f63 6573 7369 6e67 2063  ent-processing c
-000118c0: 6f6d 706f 6e65 6e74 2074 6861 7420 6974  omponent that it
-000118d0: 6572 6174 6573 206f 7665 7220 610a 7375  erates over a.su
-000118e0: 6363 6573 7366 756c 6c79 2072 6574 7572  ccessfully retur
-000118f0: 6e65 6420 2263 6174 6368 2d75 7022 2073  ned "catch-up" s
-00011900: 7562 7363 7269 7074 696f 6e20 7265 7370  ubscription resp
-00011910: 6f6e 7365 2077 696c 6c20 6e65 6564 2074  onse will need t
-00011920: 6f20 6265 206d 6f6e 6974 6f72 6564 2066  o be monitored f
-00011930: 6f72 0a65 7272 6f72 732c 2061 6e64 2c20  or.errors, and, 
-00011940: 6966 2069 7420 6661 696c 7320 6166 7465  if it fails afte
-00011950: 7220 6974 2068 6173 2073 7461 7274 6564  r it has started
-00011960: 2069 7465 7261 7469 6e67 206f 7665 7220   iterating over 
-00011970: 7468 6520 7265 7370 6f6e 7365 2c20 7468  the response, th
-00011980: 6520 6361 7463 682d 7570 0a73 7562 7363  e catch-up.subsc
-00011990: 7269 7074 696f 6e20 7769 6c6c 206e 6565  ription will nee
-000119a0: 6420 746f 2062 6520 7265 7374 6172 7465  d to be restarte
-000119b0: 6420 6672 6f6d 2074 6865 2065 7665 6e74  d from the event
-000119c0: 2d70 726f 6365 7373 696e 6720 636f 6d70  -processing comp
-000119d0: 6f6e 656e 7427 7320 226c 6173 740a 7361  onent's "last.sa
-000119e0: 7665 6420 636f 6d6d 6974 2070 6f73 6974  ved commit posit
-000119f0: 696f 6e22 2e20 4966 2074 6865 2065 7665  ion". If the eve
-00011a00: 6e74 2d70 726f 6365 7373 696e 6720 636f  nt-processing co
-00011a10: 6d70 6f6e 656e 7420 6973 2072 6563 6f72  mponent is recor
-00011a20: 6469 6e67 2074 6865 2063 6f6d 6d69 740a  ding the commit.
-00011a30: 706f 7369 7469 6f6e 206f 6620 6561 6368  position of each
-00011a40: 2072 6563 6f72 6465 6420 6576 656e 7420   recorded event 
-00011a50: 6174 6f6d 6963 616c 6c79 2061 6c6f 6e67  atomically along
-00011a60: 2077 6974 6820 616e 7920 6e65 7720 7374   with any new st
-00011a70: 6174 6520 7468 6174 2072 6573 756c 7473  ate that results
-00011a80: 2066 726f 6d0a 7072 6f63 6573 7369 6e67   from.processing
-00011a90: 2074 6865 2072 6563 6f72 6465 6420 6576   the recorded ev
-00011aa0: 656e 7473 2c20 616e 6420 7468 6520 636f  ents, and the co
-00011ab0: 6d6d 6974 2070 6f73 6974 696f 6e73 2061  mmit positions a
-00011ac0: 7265 2072 6563 6f72 6465 6420 7769 7468  re recorded with
-00011ad0: 2061 2075 6e69 7175 656e 6573 730a 636f   a uniqueness.co
-00011ae0: 6e73 7472 6169 6e74 2c20 7468 656e 2074  nstraint, then t
-00011af0: 6865 7265 2077 696c 6c20 6e6f 2064 616e  here will no dan
-00011b00: 6765 7220 746f 2074 6865 2070 726f 6a65  ger to the proje
-00011b10: 6374 6564 2073 7461 7465 2062 6563 6f6d  cted state becom
-00011b20: 696e 6720 696e 636f 6e73 6973 7465 6e74  ing inconsistent
-00011b30: 2064 7565 0a74 6f20 7468 6573 6520 636f   due.to these co
-00011b40: 6e6e 6563 7469 6f6e 2069 7373 7565 732e  nnection issues.
-00011b50: 2049 6e20 7468 6973 2063 6173 652c 2074   In this case, t
-00011b60: 6865 2063 6c69 656e 7420 7769 6c6c 2061  he client will a
-00011b70: 7574 6f6d 6174 6963 616c 6c79 2072 6563  utomatically rec
-00011b80: 6f6e 6e65 6374 2074 6f20 610a 6e6f 6465  onnect to a.node
-00011b90: 2069 6e20 7468 6520 636c 7573 7465 7220   in the cluster 
-00011ba0: 7768 656e 2074 6865 2073 7562 7365 7175  when the subsequ
-00011bb0: 656e 7420 6361 6c6c 2074 6f20 6120 6361  ent call to a ca
-00011bc0: 7463 682d 7570 2073 7562 7363 7269 7074  tch-up subscript
-00011bd0: 696f 6e20 6d65 7468 6f64 2069 7320 6d61  ion method is ma
-00011be0: 6465 2e0a 596f 7520 6a75 7374 206e 6565  de..You just nee
-00011bf0: 6420 746f 2068 616e 646c 6520 7468 6520  d to handle the 
-00011c00: 6578 6365 7074 696f 6e20 7468 6174 206f  exception that o
-00011c10: 6363 7572 7320 6672 6f6d 2074 6865 2069  ccurs from the i
-00011c20: 7465 7261 746f 722c 2074 6865 6e20 7265  terator, then re
-00011c30: 6164 2079 6f75 7220 6c61 7374 0a73 6176  ad your last.sav
-00011c40: 6564 2063 6f6d 6d69 7420 706f 7369 7469  ed commit positi
-00011c50: 6f6e 2c20 616e 6420 7468 656e 2072 6573  on, and then res
-00011c60: 7461 7274 2079 6f75 7220 6576 656e 742d  tart your event-
-00011c70: 7072 6f63 6573 7369 6e67 2063 6f6d 706f  processing compo
-00011c80: 6e65 6e74 2c20 7573 696e 6720 7468 6520  nent, using the 
-00011c90: 7361 6d65 0a63 6c69 656e 7420 6f62 6a65  same.client obje
-00011ca0: 6374 2e20 5468 6520 636c 6965 6e74 2077  ct. The client w
-00011cb0: 696c 6c20 7265 636f 6e6e 6563 7420 6966  ill reconnect if
-00011cc0: 2074 6865 7265 2069 7320 6120 6e65 6564   there is a need
-00011cd0: 2074 6f20 646f 2073 6f20 7768 656e 2074   to do so when t
-00011ce0: 6865 2073 7562 7365 7175 656e 740a 6361  he subsequent.ca
-00011cf0: 6c6c 2069 7320 6d61 6465 2e20 5369 6d69  ll is made. Simi
-00011d00: 6c61 726c 792c 2077 6865 6e20 7265 6164  larly, when read
-00011d10: 696e 6720 7065 7273 6973 7465 6e74 2073  ing persistent s
-00011d20: 7562 7363 7269 7074 696f 6e73 2c20 6966  ubscriptions, if
-00011d30: 2074 6865 7265 2061 7265 0a63 6f6e 6e65   there are.conne
-00011d40: 6374 6976 6974 7920 6973 7375 6573 2061  ctivity issues a
-00011d50: 6674 6572 2079 6f75 2068 6176 6520 7374  fter you have st
-00011d60: 6172 7465 6420 6974 6572 6174 696e 6720  arted iterating 
-00011d70: 6f76 6572 2061 2073 7563 6365 7373 6675  over a successfu
-00011d80: 6c6c 7920 7265 6365 6976 6564 0a72 6573  lly received.res
-00011d90: 706f 6e73 652c 2074 6865 6e20 7468 6520  ponse, then the 
-00011da0: 7365 7276 6572 2063 616c 6c20 7769 6c6c  server call will
-00011db0: 206e 6565 6420 746f 2062 6520 7265 7374   need to be rest
-00011dc0: 6172 7465 642e 2049 6e20 7468 6973 2063  arted. In this c
-00011dd0: 6173 652c 2074 6865 2072 6563 6569 7665  ase, the receive
-00011de0: 640a 6576 656e 7473 2077 696c 6c20 7374  d.events will st
-00011df0: 6172 7420 7769 7468 2074 6865 206c 6173  art with the las
-00011e00: 7420 7361 7665 6420 6368 6563 6b70 6f69  t saved checkpoi
-00011e10: 6e74 206f 6e20 7468 6520 7365 7276 6572  nt on the server
-00011e20: 2028 706f 7465 6e74 6961 6c6c 7920 7265   (potentially re
-00011e30: 7475 726e 696e 670a 6576 656e 7473 2074  turning.events t
-00011e40: 6861 7420 7765 7265 2069 6e20 6661 6374  hat were in fact
-00011e50: 2073 7563 6365 7373 6675 6c6c 7920 7072   successfully pr
-00011e60: 6f63 6573 7365 6429 2e0a 0a0a 2323 2320  ocessed)....### 
-00011e70: 436c 6f73 650a 0a54 6865 2060 636c 6f73  Close..The `clos
-00011e80: 6528 2960 206d 6574 686f 6420 6361 6e20  e()` method can 
-00011e90: 6265 2075 7365 6420 746f 2063 6c65 616e  be used to clean
-00011ea0: 6c79 2063 6c6f 7365 2074 6865 2067 5250  ly close the gRP
-00011eb0: 4320 636f 6e6e 6563 7469 6f6e 2e0a 0a60  C connection...`
-00011ec0: 6060 7079 7468 6f6e 0a63 6c69 656e 742e  ``python.client.
-00011ed0: 636c 6f73 6528 290a 6060 600a 0a23 2320  close().```..## 
-00011ee0: 4e6f 7465 730a 0a23 2323 2043 6f6e 6e65  Notes..### Conne
-00011ef0: 6374 696f 6e20 7374 7269 6e67 730a 0a54  ction strings..T
-00011f00: 6865 2045 7665 6e74 5374 6f72 6544 4220  he EventStoreDB 
-00011f10: 636f 6e6e 6563 7469 6f6e 2073 7472 696e  connection strin
-00011f20: 6720 6973 2061 2055 5249 2074 6861 7420  g is a URI that 
-00011f30: 636f 6e66 6f72 6d73 2077 6974 6820 6f6e  conforms with on
-00011f40: 6520 6f66 2074 776f 2070 6f73 7369 626c  e of two possibl
-00011f50: 650a 7363 6865 6d65 732c 2065 6974 6865  e.schemes, eithe
-00011f60: 7220 7468 6520 2265 7364 6222 2073 6368  r the "esdb" sch
-00011f70: 656d 6520 6f72 2074 6865 2022 6573 6462  eme or the "esdb
-00011f80: 2b64 6973 636f 7665 7222 2073 6368 656d  +discover" schem
-00011f90: 652e 2054 6865 2073 796e 7461 7820 616e  e. The syntax an
-00011fa0: 640a 7365 6d61 6e74 6963 7320 6f66 2074  d.semantics of t
-00011fb0: 6865 2045 7665 6e74 5374 6f72 6544 4220  he EventStoreDB 
-00011fc0: 5552 4920 7363 6865 6d65 7320 6172 6520  URI schemes are 
-00011fd0: 6578 706c 6169 6e65 6420 6265 6c6f 772e  explained below.
-00011fe0: 2054 6865 2073 796e 7461 7820 6973 0a64   The syntax is.d
-00011ff0: 6566 696e 6564 2075 7369 6e67 205b 4542  efined using [EB
-00012000: 4e46 5d28 6874 7470 733a 2f2f 656e 2e77  NF](https://en.w
-00012010: 696b 6970 6564 6961 2e6f 7267 2f77 696b  ikipedia.org/wik
-00012020: 692f 4578 7465 6e64 6564 5f42 6163 6b75  i/Extended_Backu
-00012030: 73e2 8093 4e61 7572 5f66 6f72 6d29 2e0a  s...Naur_form)..
-00012040: 0a54 6865 2022 6573 6462 2220 5552 4920  .The "esdb" URI 
-00012050: 7363 6865 6d65 2063 616e 2062 6520 6465  scheme can be de
-00012060: 6669 6e65 6420 696e 2074 6865 2066 6f6c  fined in the fol
-00012070: 6c6f 7769 6e67 2077 6179 2e0a 0a20 2020  lowing way...   
-00012080: 2065 7364 622d 7572 6920 3d20 2265 7364   esdb-uri = "esd
-00012090: 623a 2f2f 2220 2c20 5b20 7573 6572 2d69  b://" , [ user-i
-000120a0: 6e66 6f20 2c20 2240 2220 5d20 2c20 6772  nfo , "@" ] , gr
-000120b0: 7063 2d74 6172 6765 742c 207b 2022 2c22  pc-target, { ","
-000120c0: 202c 2067 7270 632d 7461 7267 6574 207d   , grpc-target }
-000120d0: 202c 205b 2022 3f22 202c 2071 7565 7279   , [ "?" , query
-000120e0: 2d73 7472 696e 6720 5d20 3b0a 0a49 6e20  -string ] ;..In 
-000120f0: 7468 6520 2265 7364 6222 2055 5249 2073  the "esdb" URI s
-00012100: 6368 656d 652c 2061 6674 6572 2074 6865  cheme, after the
-00012110: 206f 7074 696f 6e61 6c20 7573 6572 2069   optional user i
-00012120: 6e66 6f20 7374 7269 6e67 2c20 7468 6572  nfo string, ther
-00012130: 6520 6d75 7374 2062 6520 6174 206c 6561  e must be at lea
-00012140: 7374 0a6f 6e65 2067 5250 4320 7461 7267  st.one gRPC targ
-00012150: 6574 2e20 4966 2074 6865 7265 2061 7265  et. If there are
-00012160: 2073 6576 6572 616c 2067 5250 4320 7461   several gRPC ta
-00012170: 7267 6574 732c 2074 6865 7920 6d75 7374  rgets, they must
-00012180: 2062 6520 7365 7061 7261 7465 6420 6672   be separated fr
-00012190: 6f6d 2065 6163 680a 6f74 6865 7220 7769  om each.other wi
-000121a0: 7468 2074 6865 2022 2c22 2063 6861 7261  th the "," chara
-000121b0: 6374 6572 2e20 4561 6368 2067 5250 4320  cter. Each gRPC 
-000121c0: 7461 7267 6574 2073 686f 756c 6420 696e  target should in
-000121d0: 6469 6361 7465 2061 6e20 4576 656e 7453  dicate an EventS
-000121e0: 746f 7265 4442 2067 5250 430a 7365 7276  toreDB gRPC.serv
-000121f0: 6572 2073 6f63 6b65 742c 2062 7920 7370  er socket, by sp
-00012200: 6563 6966 7969 6e67 2061 2068 6f73 7420  ecifying a host 
-00012210: 616e 6420 6120 706f 7274 206e 756d 6265  and a port numbe
-00012220: 7220 7365 7061 7261 7465 6420 7769 7468  r separated with
-00012230: 2074 6865 2022 3a22 2063 6861 7261 6374   the ":" charact
-00012240: 6572 2e0a 5468 6520 686f 7374 206d 6179  er..The host may
-00012250: 2062 6520 6120 686f 7374 6e61 6d65 2074   be a hostname t
-00012260: 6861 7420 6361 6e20 6265 2072 6573 6f6c  hat can be resol
-00012270: 7665 6420 746f 2061 6e20 4950 2061 6464  ved to an IP add
-00012280: 7265 7373 2c20 6f72 2061 6e20 4950 2061  ress, or an IP a
-00012290: 6464 7265 7373 2e0a 0a20 2020 2067 7270  ddress...    grp
-000122a0: 632d 7461 7267 6574 203d 2028 2068 6f73  c-target = ( hos
-000122b0: 746e 616d 6520 7c20 6970 2d61 6464 7265  tname | ip-addre
-000122c0: 7373 2029 202c 2022 3a22 202c 2070 6f72  ss ) , ":" , por
-000122d0: 742d 6e75 6d62 6572 203b 0a0a 0a54 6865  t-number ;...The
-000122e0: 2022 6573 6462 2b64 6973 636f 7665 7222   "esdb+discover"
-000122f0: 2055 5249 2073 6368 656d 6520 6361 6e20   URI scheme can 
-00012300: 6265 2064 6566 696e 6564 2069 6e20 7468  be defined in th
-00012310: 6520 666f 6c6c 6f77 696e 6720 7761 792e  e following way.
-00012320: 0a0a 2020 2020 6573 6462 2d64 6973 636f  ..    esdb-disco
-00012330: 7665 722d 7572 6920 3d20 2265 7364 622b  ver-uri = "esdb+
-00012340: 6469 7363 6f76 6572 3a2f 2f22 202c 205b  discover://" , [
-00012350: 2075 7365 722d 696e 666f 2c20 2240 2220   user-info, "@" 
-00012360: 5d20 2c20 636c 7573 7465 722d 646f 6d61  ] , cluster-doma
-00012370: 696e 6e61 6d65 202c 205b 2022 3f22 202c  inname , [ "?" ,
-00012380: 2071 7565 7279 2d73 7472 696e 6720 5d20   query-string ] 
-00012390: 3b0a 0a49 6e20 7468 6520 2265 7364 622b  ;..In the "esdb+
-000123a0: 6469 7363 6f76 6572 2220 5552 4920 7363  discover" URI sc
-000123b0: 6865 6d65 2c20 6166 7465 7220 7468 6520  heme, after the 
-000123c0: 7573 6572 2069 6e66 6f20 7374 7269 6e67  user info string
-000123d0: 2c20 7468 6572 6520 6d75 7374 2062 6520  , there must be 
-000123e0: 6120 646f 6d61 696e 0a6e 616d 6520 7768  a domain.name wh
-000123f0: 6963 6820 7368 6f75 6c64 2069 6465 6e74  ich should ident
-00012400: 6966 7920 6120 636c 7573 7465 7220 6f66  ify a cluster of
-00012410: 2045 7665 6e74 5374 6f72 6544 4220 7365   EventStoreDB se
-00012420: 7276 6572 732e 2054 6865 2063 6c69 656e  rvers. The clien
-00012430: 7420 7769 6c6c 2075 7365 2061 2044 4e53  t will use a DNS
-00012440: 0a73 6572 7665 7220 746f 2072 6573 6f6c  .server to resol
-00012450: 7665 2074 6865 2064 6f6d 6169 6e20 6e61  ve the domain na
-00012460: 6d65 2074 6f20 6120 6c69 7374 206f 6620  me to a list of 
-00012470: 6164 6472 6573 7365 7320 6f66 2045 7665  addresses of Eve
-00012480: 6e74 5374 6f72 6544 4220 7365 7276 6572  ntStoreDB server
-00012490: 732c 0a62 7920 7175 6572 7969 6e67 2066  s,.by querying f
-000124a0: 6f72 2027 4127 2072 6563 6f72 6473 2e20  or 'A' records. 
-000124b0: 496e 2074 6869 7320 6361 7365 2c20 7468  In this case, th
-000124c0: 6520 706f 7274 206e 756d 6265 7220 2232  e port number "2
-000124d0: 3131 3322 2077 696c 6c20 6265 2075 7365  113" will be use
-000124e0: 6420 746f 0a63 6f6e 7374 7275 6374 2067  d to.construct g
-000124f0: 5250 4320 7461 7267 6574 7320 6672 6f6d  RPC targets from
-00012500: 2074 6865 2061 6464 7265 7373 6573 206f   the addresses o
-00012510: 6274 6169 6e65 6420 6672 6f6d 2027 4127  btained from 'A'
-00012520: 2072 6563 6f72 6473 2070 726f 7669 6465   records provide
-00012530: 6420 6279 2074 6865 0a44 4e53 2073 6572  d by the.DNS ser
-00012540: 7665 722e 2054 6865 7265 666f 7265 2c20  ver. Therefore, 
-00012550: 6966 2079 6f75 2077 616e 7420 746f 2075  if you want to u
-00012560: 7365 2074 6865 2022 6573 6462 2b64 6973  se the "esdb+dis
-00012570: 636f 7665 7222 2055 5249 2073 6368 656d  cover" URI schem
-00012580: 652c 2079 6f75 2077 696c 6c0a 6e65 6564  e, you will.need
-00012590: 2074 6f20 636f 6e66 6967 7572 6520 444e   to configure DN
-000125a0: 5320 7768 656e 2073 6574 7469 6e67 2075  S when setting u
-000125b0: 7020 796f 7572 2045 7665 6e74 5374 6f72  p your EventStor
-000125c0: 6544 4220 636c 7573 7465 722e 0a0a 5769  eDB cluster...Wi
-000125d0: 7468 2062 6f74 6820 7468 6520 2265 7364  th both the "esd
-000125e0: 6222 2061 6e64 2022 6573 6462 2b64 6973  b" and "esdb+dis
-000125f0: 6f63 7665 7222 2055 5249 2073 6368 656d  ocver" URI schem
-00012600: 6573 2c20 7468 6520 636c 6965 6e74 2066  es, the client f
-00012610: 6972 7374 6c79 206f 6274 6169 6e73 0a61  irstly obtains.a
-00012620: 206c 6973 7420 6f66 2067 5250 4320 7461   list of gRPC ta
-00012630: 7267 6574 733a 2065 6974 6865 7220 6469  rgets: either di
-00012640: 7265 6374 6c79 2066 726f 6d20 2265 7364  rectly from "esd
-00012650: 6222 2063 6f6e 6e65 6374 696f 6e20 7374  b" connection st
-00012660: 7269 6e67 733b 206f 7220 696e 6469 7265  rings; or indire
-00012670: 6374 6c79 0a66 726f 6d20 2265 7364 622b  ctly.from "esdb+
-00012680: 6469 7363 6f76 6572 2220 636f 6e6e 6563  discover" connec
-00012690: 7469 6f6e 2073 7472 696e 6773 2076 6961  tion strings via
-000126a0: 2044 4e53 2e20 5468 6973 206c 6973 7420   DNS. This list 
-000126b0: 6f66 2074 6172 6765 7473 2069 7320 6b6e  of targets is kn
-000126c0: 6f77 6e20 6173 2074 6865 0a22 676f 7373  own as the."goss
-000126d0: 6970 2073 6565 6422 2e20 5468 6520 636c  ip seed". The cl
-000126e0: 6965 6e74 2077 696c 6c20 7468 656e 2061  ient will then a
-000126f0: 7474 656d 7074 2074 6f20 636f 6e6e 6563  ttempt to connec
-00012700: 7420 746f 2065 6163 6820 6752 5043 2074  t to each gRPC t
-00012710: 6172 6765 7420 696e 2074 7572 6e2c 0a61  arget in turn,.a
-00012720: 7474 656d 7074 696e 6720 746f 2063 616c  ttempting to cal
-00012730: 6c20 7468 6520 4576 656e 7453 746f 7265  l the EventStore
-00012740: 4442 2047 6f73 7369 7020 4150 4920 746f  DB Gossip API to
-00012750: 206f 6274 6169 6e20 696e 666f 726d 6174   obtain informat
-00012760: 696f 6e20 6162 6f75 7420 7468 650a 4576  ion about the.Ev
-00012770: 656e 7453 746f 7265 4442 2063 6c75 7374  entStoreDB clust
-00012780: 6572 2e20 4120 6d65 6d62 6572 206f 6620  er. A member of 
-00012790: 7468 6520 636c 7573 7465 7220 6973 2073  the cluster is s
-000127a0: 656c 6563 7465 6420 6279 2074 6865 2063  elected by the c
-000127b0: 6c69 656e 742c 2061 6363 6f72 6469 6e67  lient, according
-000127c0: 0a74 6f20 7468 6520 226e 6f64 6520 7072  .to the "node pr
-000127d0: 6566 6572 656e 6365 2220 6f70 7469 6f6e  eference" option
-000127e0: 2028 7365 6520 6265 6c6f 7729 2e20 5468   (see below). Th
-000127f0: 6520 636c 6965 6e74 206d 6179 2074 6865  e client may the
-00012800: 6e20 6e65 6564 2074 6f20 636c 6f73 6520  n need to close 
-00012810: 6974 730a 636f 6e6e 6563 7469 6f6e 2061  its.connection a
-00012820: 6e64 2072 6563 6f6e 6e65 6374 2074 6f20  nd reconnect to 
-00012830: 7468 6520 7365 6c65 6374 6564 2073 6572  the selected ser
-00012840: 7665 722e 0a0a 496e 2062 6f74 6820 7468  ver...In both th
-00012850: 6520 2265 7364 6222 2061 6e64 2022 6573  e "esdb" and "es
-00012860: 6462 2b64 6973 636f 7665 7222 2073 6368  db+discover" sch
-00012870: 656d 6573 2c20 7468 6520 5552 4920 6d61  emes, the URI ma
-00012880: 7920 696e 636c 7564 6520 6120 7573 6572  y include a user
-00012890: 2069 6e66 6f20 7374 7269 6e67 2e0a 4966   info string..If
-000128a0: 2069 7420 6578 6973 7473 2069 6e20 7468   it exists in th
-000128b0: 6520 5552 492c 2074 6865 2075 7365 7220  e URI, the user 
-000128c0: 696e 666f 2073 7472 696e 6720 6d75 7374  info string must
-000128d0: 2062 6520 7365 7061 7261 7465 6420 6672   be separated fr
-000128e0: 6f6d 2074 6865 2072 6573 7420 6f66 2074  om the rest of t
-000128f0: 6865 2055 5249 0a77 6974 6820 7468 6520  he URI.with the 
-00012900: 2240 2220 6368 6172 6163 7465 722e 2054  "@" character. T
-00012910: 6865 2075 7365 7220 696e 666f 2073 7472  he user info str
-00012920: 696e 6720 6d75 7374 2069 6e63 6c75 6465  ing must include
-00012930: 2061 2075 7365 726e 616d 6520 616e 6420   a username and 
-00012940: 6120 7061 7373 776f 7264 2c0a 7365 7061  a password,.sepa
-00012950: 7261 7465 6420 7769 7468 2074 6865 2022  rated with the "
-00012960: 3a22 2063 6861 7261 6374 6572 2e0a 0a20  :" character... 
-00012970: 2020 2075 7365 722d 696e 666f 203d 2075     user-info = u
-00012980: 7365 726e 616d 6520 2c20 223a 2220 2c20  sername , ":" , 
-00012990: 7061 7373 776f 7264 203b 0a0a 5468 6520  password ;..The 
-000129a0: 7573 6572 2069 6e66 6f20 6973 2073 656e  user info is sen
-000129b0: 7420 6279 2074 6865 2063 6c69 656e 7420  t by the client 
-000129c0: 6173 2022 6361 6c6c 2063 7265 6465 6e74  as "call credent
-000129d0: 6961 6c73 2220 696e 2065 6163 6820 6361  ials" in each ca
-000129e0: 6c6c 2074 6f20 6120 2273 6563 7572 6522  ll to a "secure"
-000129f0: 0a73 6572 7665 722c 2069 6e20 6120 2262  .server, in a "b
-00012a00: 6173 6963 2061 7574 6822 2061 7574 686f  asic auth" autho
-00012a10: 7269 7a61 7469 6f6e 2068 6561 6465 722e  rization header.
-00012a20: 2054 6869 7320 6175 7468 6f72 697a 6174   This authorizat
-00012a30: 696f 6e20 6865 6164 6572 2069 7320 7573  ion header is us
-00012a40: 6564 2062 790a 7468 6520 7365 7276 6572  ed by.the server
-00012a50: 2074 6f20 6175 7468 656e 7469 6361 7465   to authenticate
-00012a60: 2074 6865 2063 6c69 656e 742e 2054 6865   the client. The
-00012a70: 2061 7574 686f 7269 7a61 7469 6f6e 2068   authorization h
-00012a80: 6561 6465 7220 6973 206e 6f74 2073 656e  eader is not sen
-00012a90: 7420 746f 0a22 696e 7365 6375 7265 2220  t to."insecure" 
-00012aa0: 7365 7276 6572 732e 0a0a 496e 2062 6f74  servers...In bot
-00012ab0: 6820 7468 6520 2265 7364 6222 2061 6e64  h the "esdb" and
-00012ac0: 2022 6573 6462 2b64 6973 636f 7665 7222   "esdb+discover"
-00012ad0: 2073 6368 656d 6573 2c20 7468 6520 6f70   schemes, the op
-00012ae0: 7469 6f6e 616c 2071 7565 7279 2073 7472  tional query str
-00012af0: 696e 6720 6d75 7374 2062 6520 6f6e 650a  ing must be one.
-00012b00: 6f72 206d 616e 7920 6669 656c 642d 7661  or many field-va
-00012b10: 6c75 6520 6172 6775 6d65 6e74 732c 2073  lue arguments, s
-00012b20: 6570 6172 6174 6564 2066 726f 6d20 6561  eparated from ea
-00012b30: 6368 206f 7468 6572 2077 6974 6820 7468  ch other with th
-00012b40: 6520 2226 2220 6368 6172 6163 7465 722e  e "&" character.
-00012b50: 0a0a 2020 2020 7175 6572 792d 7374 7269  ..    query-stri
-00012b60: 6e67 203d 2066 6965 6c64 2d76 616c 7565  ng = field-value
-00012b70: 2c20 7b20 2226 222c 2066 6965 6c64 2d76  , { "&", field-v
-00012b80: 616c 7565 207d 203b 0a0a 4561 6368 2066  alue } ;..Each f
-00012b90: 6965 6c64 2d76 616c 7565 2061 7267 756d  ield-value argum
-00012ba0: 656e 7420 6d75 7374 2062 6520 6f6e 6520  ent must be one 
-00012bb0: 6f66 2074 6865 2073 7570 706f 7274 6564  of the supported
-00012bc0: 2066 6965 6c64 732c 2061 6e64 2061 6e0a   fields, and an.
-00012bd0: 6170 7072 6f70 7269 6174 6520 7661 6c75  appropriate valu
-00012be0: 652c 2073 6570 6172 6174 6564 2077 6974  e, separated wit
-00012bf0: 6820 7468 6520 223d 2220 6368 6172 6163  h the "=" charac
-00012c00: 7465 722e 0a0a 2020 2020 6669 656c 642d  ter...    field-
-00012c10: 7661 6c75 6520 3d20 2820 2254 6c73 222c  value = ( "Tls",
-00012c20: 2022 3d22 202c 2022 7472 7565 2220 7c20   "=" , "true" | 
-00012c30: 2266 616c 7365 2220 290a 2020 2020 2020  "false" ).      
-00012c40: 2020 2020 2020 2020 2020 7c20 2820 2254            | ( "T
-00012c50: 6c73 5665 7269 6679 4365 7274 222c 2022  lsVerifyCert", "
-00012c60: 3d22 202c 2022 7472 7565 2220 7c20 2266  =" , "true" | "f
-00012c70: 616c 7365 2220 290a 2020 2020 2020 2020  alse" ).        
-00012c80: 2020 2020 2020 2020 7c20 2820 2243 6f6e          | ( "Con
-00012c90: 6e65 6374 696f 6e4e 616d 6522 2c20 223d  nectionName", "=
-00012ca0: 2220 2c20 7374 7269 6e67 2029 0a20 2020  " , string ).   
-00012cb0: 2020 2020 2020 2020 2020 2020 207c 2028               | (
-00012cc0: 2022 4e6f 6465 5072 6566 6572 656e 6365   "NodePreference
-00012cd0: 222c 2022 3d22 202c 2022 6c65 6164 6572  ", "=" , "leader
-00012ce0: 2220 7c20 2266 6f6c 6c6f 7765 7222 207c  " | "follower" |
-00012cf0: 2022 7265 6164 6f6e 6c79 7265 706c 6963   "readonlyreplic
-00012d00: 6122 207c 2022 7261 6e64 6f6d 2220 290a  a" | "random" ).
-00012d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012d20: 7c20 2820 2244 6566 6175 6c74 4465 6164  | ( "DefaultDead
-00012d30: 6c69 6e65 222c 2022 3d22 202c 2069 6e74  line", "=" , int
-00012d40: 6567 6572 2029 0a20 2020 2020 2020 2020  eger ).         
-00012d50: 2020 2020 2020 207c 2028 2022 476f 7373         | ( "Goss
-00012d60: 6970 5469 6d65 6f75 7422 2c20 223d 2220  ipTimeout", "=" 
-00012d70: 2c20 696e 7465 6765 7220 290a 2020 2020  , integer ).    
-00012d80: 2020 2020 2020 2020 2020 2020 7c20 2820              | ( 
-00012d90: 224d 6178 4469 7363 6f76 6572 4174 7465  "MaxDiscoverAtte
-00012da0: 6d70 7473 222c 2022 3d22 202c 2069 6e74  mpts", "=" , int
-00012db0: 6567 6572 2029 0a20 2020 2020 2020 2020  eger ).         
-00012dc0: 2020 2020 2020 207c 2028 2022 4469 7363         | ( "Disc
-00012dd0: 6f76 6572 7949 6e74 6572 7661 6c22 2c20  overyInterval", 
-00012de0: 223d 2220 2c20 696e 7465 6765 7220 290a  "=" , integer ).
-00012df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012e00: 7c20 2820 224d 6178 4469 7363 6f76 6572  | ( "MaxDiscover
-00012e10: 4174 7465 6d70 7473 222c 2022 3d22 202c  Attempts", "=" ,
-00012e20: 2069 6e74 6567 6572 2029 0a20 2020 2020   integer ).     
-00012e30: 2020 2020 2020 2020 2020 207c 2028 2022             | ( "
-00012e40: 4b65 6570 416c 6976 6549 6e74 6572 7661  KeepAliveInterva
-00012e50: 6c22 2c20 223d 2220 2c20 696e 7465 6765  l", "=" , intege
-00012e60: 7220 290a 2020 2020 2020 2020 2020 2020  r ).            
-00012e70: 2020 2020 7c20 2820 224b 6565 7041 6c69      | ( "KeepAli
-00012e80: 7665 496e 7465 7276 616c 222c 2022 3d22  veInterval", "="
-00012e90: 202c 2069 6e74 6567 6572 2029 203b 0a0a   , integer ) ;..
-00012ea0: 5468 6520 7461 626c 6520 6265 6c6f 7720  The table below 
-00012eb0: 6465 7363 7269 6265 7320 7468 6520 7175  describes the qu
-00012ec0: 6572 7920 6669 656c 642d 7661 6c75 6573  ery field-values
-00012ed0: 2073 7570 706f 7274 6564 2062 7920 7468   supported by th
-00012ee0: 6973 2063 6c69 656e 742e 0a0a 7c20 4669  is client...| Fi
-00012ef0: 656c 6420 2020 2020 2020 2020 2020 2020  eld             
-00012f00: 2020 7c20 5661 6c75 6520 2020 2020 2020    | Value       
-00012f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012f40: 2020 2020 2020 2020 2020 7c20 4465 7363            | Desc
-00012f50: 7269 7074 696f 6e20 2020 2020 2020 2020  ription         
-00012f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012fe0: 2020 2020 2020 2020 2020 2020 2020 7c0a                |.
-00012ff0: 7c2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  |---------------
-00013000: 2d2d 2d2d 2d2d 7c2d 2d2d 2d2d 2d2d 2d2d  ------|---------
-00013010: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00013020: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00013030: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00013040: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 7c2d  --------------|-
-00013050: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00013060: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00013070: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00013080: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00013090: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000130a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000130b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000130c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000130d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000130e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000130f0: 2d2d 7c0a 7c20 546c 7320 2020 2020 2020  --|.| Tls       
-00013100: 2020 2020 2020 2020 2020 7c20 2274 7275            | "tru
-00013110: 6522 2c20 2266 616c 7365 2220 2864 6566  e", "false" (def
-00013120: 6175 6c74 3a20 2274 7275 6522 2920 2020  ault: "true")   
-00013130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013150: 2020 7c20 4966 2022 7472 7565 2220 7468    | If "true" th
-00013160: 6520 636c 6965 6e74 2077 696c 6c20 6372  e client will cr
-00013170: 6561 7465 2061 2022 7365 6375 7265 2220  eate a "secure" 
-00013180: 6752 5043 2063 6861 6e6e 656c 2e20 4966  gRPC channel. If
-00013190: 2022 6661 6c73 6522 2074 6865 2063 6c69   "false" the cli
-000131a0: 656e 7420 7769 6c6c 2063 7265 6174 6520  ent will create 
-000131b0: 616e 2022 696e 7365 6375 7265 2220 6752  an "insecure" gR
-000131c0: 5043 2063 6861 6e6e 656c 2e20 5468 6973  PC channel. This
-000131d0: 206d 7573 7420 6d61 7463 6820 7468 6520   must match the 
-000131e0: 7365 7276 6572 2063 6f6e 6669 6775 7261  server configura
-000131f0: 7469 6f6e 2e20 7c0a 7c20 546c 7356 6572  tion. |.| TlsVer
-00013200: 6966 7943 6572 7420 2020 2020 2020 7c20  ifyCert       | 
-00013210: 2274 7275 6522 2c20 2266 616c 7365 2220  "true", "false" 
-00013220: 2864 6566 6175 6c74 3a20 2274 7275 6522  (default: "true"
-00013230: 2920 2020 2020 2020 2020 2020 2020 2020  )               
-00013240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013250: 2020 2020 2020 7c20 5468 6973 2076 616c        | This val
-00013260: 7565 2069 7320 6375 7272 656e 746c 7920  ue is currently 
-00013270: 6967 6e6f 7265 642e 2020 2020 2020 2020  ignored.        
-00013280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000132a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000132b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000132c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000132d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000132e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000132f0: 2020 2020 2020 2020 2020 7c0a 7c20 436f            |.| Co
-00013300: 6e6e 6563 7469 6f6e 4e61 6d65 2020 2020  nnectionName    
-00013310: 2020 7c20 7374 7269 6e67 2028 6465 6661    | string (defa
-00013320: 756c 743a 2061 7574 6f2d 6765 6e65 7261  ult: auto-genera
-00013330: 7465 6420 7665 7273 696f 6e2d 3420 5555  ted version-4 UU
-00013340: 4944 2920 2020 2020 2020 2020 2020 2020  ID)             
-00013350: 2020 2020 2020 2020 2020 7c20 5365 6e74            | Sent
-00013360: 2069 6e20 6361 6c6c 206d 6574 6164 6174   in call metadat
-00013370: 6120 666f 7220 6576 6572 7920 6361 6c6c  a for every call
-00013380: 2c20 746f 2069 6465 6e74 6966 7920 7468  , to identify th
-00013390: 6520 636c 6965 6e74 2074 6f20 7468 6520  e client to the 
-000133a0: 636c 7573 7465 722e 2020 2020 2020 2020  cluster.        
-000133b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000133c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000133d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000133e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000133f0: 2020 2020 2020 2020 2020 2020 2020 7c0a                |.
-00013400: 7c20 4e6f 6465 5072 6566 6572 656e 6365  | NodePreference
-00013410: 2020 2020 2020 7c20 226c 6561 6465 7222        | "leader"
-00013420: 2c20 2266 6f6c 6c6f 7765 7222 2c20 2272  , "follower", "r
-00013430: 6561 646f 6e6c 7972 6570 6c69 6361 222c  eadonlyreplica",
-00013440: 2022 7261 6e64 6f6d 2220 2864 6566 6175   "random" (defau
-00013450: 6c74 3a20 226c 6561 6465 7222 2920 7c20  lt: "leader") | 
-00013460: 5468 6520 6e6f 6465 2073 7461 7465 2070  The node state p
-00013470: 7265 6665 7272 6564 2062 7920 7468 6520  referred by the 
-00013480: 636c 6965 6e74 2e20 5468 6520 636c 6965  client. The clie
-00013490: 6e74 2077 696c 6c20 7365 6c65 6374 2061  nt will select a
-000134a0: 206e 6f64 6520 6672 6f6d 2074 6865 2063   node from the c
-000134b0: 6c75 7374 6572 2069 6e66 6f20 7265 6365  luster info rece
-000134c0: 6976 6564 2066 726f 6d20 7468 6520 476f  ived from the Go
-000134d0: 7373 6970 2041 5049 2061 6363 6f72 6469  ssip API accordi
-000134e0: 6e67 2074 6f20 7468 6973 2070 7265 6665  ng to this prefe
-000134f0: 7265 6e63 652e 2020 2020 2020 2020 2020  rence.          
-00013500: 2020 7c0a 7c20 4465 6661 756c 7444 6561    |.| DefaultDea
-00013510: 646c 696e 6520 2020 2020 7c20 696e 7465  dline     | inte
-00013520: 6765 7220 2864 6566 6175 6c74 3a20 604e  ger (default: `N
-00013530: 6f6e 6560 2920 2020 2020 2020 2020 2020  one`)           
-00013540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013560: 2020 7c20 5468 6520 6465 6661 756c 7420    | The default 
-00013570: 7661 6c75 6520 2869 6e20 7365 636f 6e64  value (in second
-00013580: 7329 206f 6620 7468 6520 6074 696d 656f  s) of the `timeo
-00013590: 7574 6020 6172 6775 6d65 6e74 206f 6620  ut` argument of 
-000135a0: 636c 6965 6e74 2022 7772 6974 6522 206d  client "write" m
-000135b0: 6574 686f 6473 2073 7563 6820 6173 2060  ethods such as `
-000135c0: 6170 7065 6e64 5f65 7665 6e74 7328 2960  append_events()`
-000135d0: 2e20 2020 2020 2020 2020 2020 2020 2020  .               
-000135e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000135f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013600: 2020 2020 2020 7c0a 7c20 476f 7373 6970        |.| Gossip
-00013610: 5469 6d65 6f75 7420 2020 2020 2020 7c20  Timeout       | 
-00013620: 696e 7465 6765 7220 2864 6566 6175 6c74  integer (default
-00013630: 3a20 3529 2020 2020 2020 2020 2020 2020  : 5)            
-00013640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013660: 2020 2020 2020 7c20 5468 6520 6465 6661        | The defa
-00013670: 756c 7420 7661 6c75 6520 2869 6e20 7365  ult value (in se
-00013680: 636f 6e64 7329 206f 6620 7468 6520 6074  conds) of the `t
-00013690: 696d 656f 7574 6020 6172 6775 6d65 6e74  imeout` argument
-000136a0: 206f 6620 676f 7373 6970 2072 6561 6420   of gossip read 
-000136b0: 6d65 7468 6f64 732c 2073 7563 6820 6173  methods, such as
-000136c0: 2060 7265 6164 5f67 6f73 7369 7028 2960   `read_gossip()`
-000136d0: 2e20 2020 2020 2020 2020 2020 2020 2020  .               
-000136e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000136f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013700: 2020 2020 2020 2020 2020 7c0a 7c20 4d61            |.| Ma
-00013710: 7844 6973 636f 7665 7241 7474 656d 7074  xDiscoverAttempt
-00013720: 7320 7c20 696e 7465 6765 7220 2864 6566  s | integer (def
-00013730: 6175 6c74 3a20 3130 2920 2020 2020 2020  ault: 10)       
-00013740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013760: 2020 2020 2020 2020 2020 7c20 5468 6520            | The 
-00013770: 6e75 6d62 6572 206f 6620 6174 7465 6d70  number of attemp
-00013780: 7473 2074 6f20 7265 6164 2067 6f73 7369  ts to read gossi
-00013790: 7020 7768 656e 2063 6f6e 6e65 6374 696e  p when connectin
-000137a0: 6720 6f72 2072 6563 6f6e 6e65 6374 696e  g or reconnectin
-000137b0: 6720 746f 2061 2063 6c75 7374 6572 206d  g to a cluster m
-000137c0: 656d 6265 722e 2020 2020 2020 2020 2020  ember.          
-000137d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000137e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000137f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013800: 2020 2020 2020 2020 2020 2020 2020 7c0a                |.
-00013810: 7c20 4469 7363 6f76 6572 7949 6e74 6572  | DiscoveryInter
-00013820: 7661 6c20 2020 7c20 696e 7465 6765 7220  val   | integer 
-00013830: 2864 6566 6175 6c74 3a20 3130 3029 2020  (default: 100)  
-00013840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013860: 2020 2020 2020 2020 2020 2020 2020 7c20                | 
-00013870: 486f 7720 6c6f 6e67 2074 6f20 7761 6974  How long to wait
-00013880: 2028 696e 206d 696c 6c69 7365 636f 6e64   (in millisecond
-00013890: 7329 2062 6574 7765 656e 2067 6f73 7369  s) between gossi
-000138a0: 7020 7265 7472 6965 732e 2020 2020 2020  p retries.      
-000138b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000138c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000138d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000138e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000138f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013910: 2020 7c0a 7c20 4b65 6570 416c 6976 6549    |.| KeepAliveI
-00013920: 6e74 6572 7661 6c20 2020 7c20 696e 7465  nterval   | inte
-00013930: 6765 7220 2864 6566 6175 6c74 3a20 604e  ger (default: `N
-00013940: 6f6e 6560 2920 2020 2020 2020 2020 2020  one`)           
+00000a10: 6c20 666f 7220 6578 616d 706c 6520 7768  l for example wh
+00000a20: 656e 2065 7865 6375 7469 6e67 2061 2063  en executing a c
+00000a30: 6f6d 6d61 6e64 2069 6e20 616e 2061 7070  ommand in an app
+00000a40: 6c69 6361 7469 6f6e 0a74 6861 7420 6d75  lication.that mu
+00000a50: 7461 7465 7320 616e 2061 6767 7265 6761  tates an aggrega
+00000a60: 7465 2e20 5468 6973 206d 6574 686f 6420  te. This method 
+00000a70: 6973 2022 6174 6f6d 6963 2220 696e 2074  is "atomic" in t
+00000a80: 6861 7420 6569 7468 6572 2061 6c6c 206f  hat either all o
+00000a90: 7220 6e6f 6e65 206f 660a 7468 6520 6576  r none of.the ev
+00000aa0: 656e 7473 2077 696c 6c20 6265 2072 6563  ents will be rec
+00000ab0: 6f72 6465 642e 0a0a 2a20 6072 6561 645f  orded...* `read_
+00000ac0: 7374 7265 616d 5f65 7665 6e74 7328 2960  stream_events()`
+00000ad0: 2054 6869 7320 6d65 7468 6f64 2063 616e   This method can
+00000ae0: 2062 6520 7573 6564 2074 6f20 7265 7472   be used to retr
+00000af0: 6965 7665 2061 6c6c 2074 6865 2072 6563  ieve all the rec
+00000b00: 6f72 6465 640a 6576 656e 7473 2069 6e20  orded.events in 
+00000b10: 6120 2273 7472 6561 6d22 2e20 5468 6973  a "stream". This
+00000b20: 2069 7320 7573 6566 756c 2066 6f72 2065   is useful for e
+00000b30: 7861 6d70 6c65 2077 6865 6e20 7265 636f  xample when reco
+00000b40: 6e73 7472 7563 7469 6e67 2061 6e20 6167  nstructing an ag
+00000b50: 6772 6567 6174 650a 6265 666f 7265 2065  gregate.before e
+00000b60: 7865 6375 7469 6e67 2061 2063 6f6d 6d61  xecuting a comma
+00000b70: 6e64 2069 6e20 616e 2061 7070 6c69 6361  nd in an applica
+00000b80: 7469 6f6e 2e0a 0a2a 2060 7375 6273 6372  tion...* `subscr
+00000b90: 6962 655f 616c 6c5f 6576 656e 7473 2829  ibe_all_events()
+00000ba0: 6020 5468 6973 206d 6574 686f 6420 6361  ` This method ca
+00000bb0: 6e20 6265 2075 7365 6420 746f 2072 6563  n be used to rec
+00000bc0: 6569 7665 2061 6c6c 2072 6563 6f72 6465  eive all recorde
+00000bd0: 640a 6576 656e 7473 2061 6372 6f73 7320  d.events across 
+00000be0: 616c 6c20 2273 7472 6561 6d73 222e 2054  all "streams". T
+00000bf0: 6869 7320 6973 2075 7365 6675 6c20 696e  his is useful in
+00000c00: 2064 6f77 6e73 7472 6561 6d20 6576 656e   downstream even
+00000c10: 742d 7072 6f63 6573 7369 6e67 0a63 6f6d  t-processing.com
+00000c20: 706f 6e65 6e74 732c 2061 6e64 2073 7570  ponents, and sup
+00000c30: 706f 7274 7320 7072 6f63 6573 7369 6e67  ports processing
+00000c40: 2065 7665 6e74 7320 7769 7468 2022 6578   events with "ex
+00000c50: 6163 746c 792d 6f6e 6365 2220 7365 6d61  actly-once" sema
+00000c60: 6e74 6963 7320 2873 6565 2062 656c 6f77  ntics (see below
+00000c70: 292e 0a0a 5468 6520 6578 616d 706c 6520  )...The example 
+00000c80: 6265 6c6f 7720 7573 6573 2061 6e20 2269  below uses an "i
+00000c90: 6e73 6563 7572 6522 2045 7665 6e74 5374  nsecure" EventSt
+00000ca0: 6f72 6544 4220 7365 7276 6572 2072 756e  oreDB server run
+00000cb0: 6e69 6e67 206c 6f63 616c 6c79 206f 6e20  ning locally on 
+00000cc0: 706f 7274 2032 3131 342e 0a0a 6060 6070  port 2114...```p
+00000cd0: 7974 686f 6e0a 696d 706f 7274 2065 7364  ython.import esd
+00000ce0: 6263 6c69 656e 742c 2075 7569 640a 0a0a  bclient, uuid...
+00000cf0: 2320 436f 6e73 7472 7563 7420 4553 4442  # Construct ESDB
+00000d00: 436c 6965 6e74 2077 6974 6820 616e 2045  Client with an E
+00000d10: 7665 6e74 5374 6f72 6544 4220 5552 492e  ventStoreDB URI.
+00000d20: 0a0a 636c 6965 6e74 203d 2065 7364 6263  ..client = esdbc
+00000d30: 6c69 656e 742e 4553 4442 436c 6965 6e74  lient.ESDBClient
+00000d40: 2875 7269 3d22 6573 6462 3a2f 2f6c 6f63  (uri="esdb://loc
+00000d50: 616c 686f 7374 3a32 3131 343f 546c 733d  alhost:2114?Tls=
+00000d60: 6661 6c73 6522 290a 0a0a 2320 4170 7065  false")...# Appe
+00000d70: 6e64 2065 7665 6e74 7320 746f 2061 206e  nd events to a n
+00000d80: 6577 2073 7472 6561 6d2e 0a0a 7374 7265  ew stream...stre
+00000d90: 616d 5f6e 616d 6520 3d20 7374 7228 7575  am_name = str(uu
+00000da0: 6964 2e75 7569 6434 2829 290a 0a65 7665  id.uuid4())..eve
+00000db0: 6e74 3120 3d20 6573 6462 636c 6965 6e74  nt1 = esdbclient
+00000dc0: 2e4e 6577 4576 656e 7428 7479 7065 3d27  .NewEvent(type='
+00000dd0: 4f72 6465 7243 7265 6174 6564 272c 2064  OrderCreated', d
+00000de0: 6174 613d 6227 6461 7461 3127 290a 0a63  ata=b'data1')..c
+00000df0: 6c69 656e 742e 6170 7065 6e64 5f65 7665  lient.append_eve
+00000e00: 6e74 7328 0a20 2020 2073 7472 6561 6d5f  nts(.    stream_
+00000e10: 6e61 6d65 3d73 7472 6561 6d5f 6e61 6d65  name=stream_name
+00000e20: 2c0a 2020 2020 6578 7065 6374 6564 5f70  ,.    expected_p
+00000e30: 6f73 6974 696f 6e3d 4e6f 6e65 2c0a 2020  osition=None,.  
+00000e40: 2020 6576 656e 7473 3d5b 6576 656e 7431    events=[event1
+00000e50: 5d2c 0a29 0a0a 0a23 2041 7070 656e 6420  ],.)...# Append 
+00000e60: 6d6f 7265 2065 7665 6e74 7320 746f 2061  more events to a
+00000e70: 6e20 6578 6973 7469 6e67 2073 7472 6561  n existing strea
+00000e80: 6d2e 0a0a 6576 656e 7432 203d 2065 7364  m...event2 = esd
+00000e90: 6263 6c69 656e 742e 4e65 7745 7665 6e74  bclient.NewEvent
+00000ea0: 2874 7970 653d 274f 7264 6572 5570 6461  (type='OrderUpda
+00000eb0: 7465 6427 2c20 6461 7461 3d62 2764 6174  ted', data=b'dat
+00000ec0: 6132 2729 0a65 7665 6e74 3320 3d20 6573  a2').event3 = es
+00000ed0: 6462 636c 6965 6e74 2e4e 6577 4576 656e  dbclient.NewEven
+00000ee0: 7428 7479 7065 3d27 4f72 6465 7244 656c  t(type='OrderDel
+00000ef0: 6574 6564 272c 2064 6174 613d 6227 6461  eted', data=b'da
+00000f00: 7461 3327 290a 0a63 6c69 656e 742e 6170  ta3')..client.ap
+00000f10: 7065 6e64 5f65 7665 6e74 7328 0a20 2020  pend_events(.   
+00000f20: 2073 7472 6561 6d5f 6e61 6d65 3d73 7472   stream_name=str
+00000f30: 6561 6d5f 6e61 6d65 2c0a 2020 2020 6578  eam_name,.    ex
+00000f40: 7065 6374 6564 5f70 6f73 6974 696f 6e3d  pected_position=
+00000f50: 302c 0a20 2020 2065 7665 6e74 733d 5b65  0,.    events=[e
+00000f60: 7665 6e74 322c 2065 7665 6e74 335d 2c0a  vent2, event3],.
+00000f70: 290a 0a0a 2320 5265 6164 2061 6c6c 2065  )...# Read all e
+00000f80: 7665 6e74 7320 7265 636f 7264 6564 2069  vents recorded i
+00000f90: 6e20 6120 7374 7265 616d 2e0a 0a72 6563  n a stream...rec
+00000fa0: 6f72 6465 6420 3d20 636c 6965 6e74 2e72  orded = client.r
+00000fb0: 6561 645f 7374 7265 616d 5f65 7665 6e74  ead_stream_event
+00000fc0: 7328 0a20 2020 2073 7472 6561 6d5f 6e61  s(.    stream_na
+00000fd0: 6d65 3d73 7472 6561 6d5f 6e61 6d65 0a29  me=stream_name.)
+00000fe0: 0a0a 6173 7365 7274 206c 656e 2872 6563  ..assert len(rec
+00000ff0: 6f72 6465 6429 203d 3d20 330a 6173 7365  orded) == 3.asse
+00001000: 7274 2072 6563 6f72 6465 645b 305d 2e64  rt recorded[0].d
+00001010: 6174 6120 3d3d 2065 7665 6e74 312e 6461  ata == event1.da
+00001020: 7461 0a61 7373 6572 7420 7265 636f 7264  ta.assert record
+00001030: 6564 5b31 5d2e 6461 7461 203d 3d20 6576  ed[1].data == ev
+00001040: 656e 7432 2e64 6174 610a 6173 7365 7274  ent2.data.assert
+00001050: 2072 6563 6f72 6465 645b 325d 2e64 6174   recorded[2].dat
+00001060: 6120 3d3d 2065 7665 6e74 332e 6461 7461  a == event3.data
+00001070: 0a61 7373 6572 7420 7265 636f 7264 6564  .assert recorded
+00001080: 5b30 5d2e 7479 7065 203d 3d20 6576 656e  [0].type == even
+00001090: 7431 2e74 7970 650a 6173 7365 7274 2072  t1.type.assert r
+000010a0: 6563 6f72 6465 645b 315d 2e74 7970 6520  ecorded[1].type 
+000010b0: 3d3d 2065 7665 6e74 322e 7479 7065 0a61  == event2.type.a
+000010c0: 7373 6572 7420 7265 636f 7264 6564 5b32  ssert recorded[2
+000010d0: 5d2e 7479 7065 203d 3d20 6576 656e 7433  ].type == event3
+000010e0: 2e74 7970 650a 0a0a 2320 496e 2061 6e20  .type...# In an 
+000010f0: 6576 656e 742d 7072 6f63 6573 7369 6e67  event-processing
+00001100: 2063 6f6d 706f 6e65 6e74 2c20 7573 6520   component, use 
+00001110: 6120 2263 6174 6368 2d75 7022 2073 7562  a "catch-up" sub
+00001120: 7363 7269 7074 696f 6e0a 2320 746f 2072  scription.# to r
+00001130: 6563 6569 7665 2061 6c6c 2065 7665 6e74  eceive all event
+00001140: 7320 6163 726f 7373 2061 6c6c 2073 7472  s across all str
+00001150: 6561 6d73 2c20 696e 636c 7564 696e 6720  eams, including 
+00001160: 6576 656e 7473 2074 6861 740a 2320 6861  events that.# ha
+00001170: 7665 206e 6f74 2079 6574 2062 6565 6e20  ve not yet been 
+00001180: 7265 636f 7264 6564 2c20 7374 6172 7469  recorded, starti
+00001190: 6e67 2066 726f 6d20 7468 6520 636f 6d70  ng from the comp
+000011a0: 6f6e 656e 7427 7320 6c61 7374 0a23 2073  onent's last.# s
+000011b0: 6176 6564 2022 636f 6d6d 6974 2070 6f73  aved "commit pos
+000011c0: 6974 696f 6e22 2e0a 0a6c 6173 745f 7361  ition"...last_sa
+000011d0: 7665 645f 636f 6d6d 6974 5f70 6f73 6974  ved_commit_posit
+000011e0: 696f 6e20 3d20 300a 0a73 7562 7363 7269  ion = 0..subscri
+000011f0: 7074 696f 6e20 3d20 636c 6965 6e74 2e73  ption = client.s
+00001200: 7562 7363 7269 6265 5f61 6c6c 5f65 7665  ubscribe_all_eve
+00001210: 6e74 7328 0a20 2020 2063 6f6d 6d69 745f  nts(.    commit_
+00001220: 706f 7369 7469 6f6e 3d6c 6173 745f 7361  position=last_sa
+00001230: 7665 645f 636f 6d6d 6974 5f70 6f73 6974  ved_commit_posit
+00001240: 696f 6e0a 290a 0a23 2054 6f20 696d 706c  ion.)..# To impl
+00001250: 656d 656e 7420 2265 7861 6374 6c79 2d6f  ement "exactly-o
+00001260: 6e63 6522 2073 656d 616e 7469 6373 2c20  nce" semantics, 
+00001270: 6974 6572 6174 6520 6f76 6572 2074 6865  iterate over the
+00001280: 0a23 2022 6361 7463 682d 7570 2220 7375  .# "catch-up" su
+00001290: 6273 6372 6970 7469 6f6e 2e20 5072 6f63  bscription. Proc
+000012a0: 6573 7320 6561 6368 2072 6563 6569 7665  ess each receive
+000012b0: 6420 6576 656e 742c 0a23 2069 6e20 7475  d event,.# in tu
+000012c0: 726e 2c20 7468 726f 7567 6820 616e 2065  rn, through an e
+000012d0: 7665 6e74 2d70 726f 6365 7373 696e 6720  vent-processing 
+000012e0: 706f 6c69 6379 2e20 5361 7665 2074 6865  policy. Save the
+000012f0: 0a23 2076 616c 7565 206f 6620 7468 6520  .# value of the 
+00001300: 636f 6d6d 6974 5f70 6f73 6974 696f 6e20  commit_position 
+00001310: 6174 7472 6962 7574 6520 6f66 2074 6865  attribute of the
+00001320: 2070 726f 6365 7373 6564 0a23 2065 7665   processed.# eve
+00001330: 6e74 2077 6974 6820 6e65 7720 7374 6174  nt with new stat
+00001340: 6520 6765 6e65 7261 7465 6420 6279 2074  e generated by t
+00001350: 6865 2070 6f6c 6963 7920 696e 2074 6865  he policy in the
+00001360: 2073 616d 650a 2320 6174 6f6d 6963 2074   same.# atomic t
+00001370: 7261 6e73 6163 7469 6f6e 2e20 5573 6520  ransaction. Use 
+00001380: 7468 6520 6c61 7374 2073 6176 6564 2022  the last saved "
+00001390: 636f 6d6d 6974 2070 6f73 6974 696f 6e22  commit position"
+000013a0: 0a23 2077 6865 6e20 7265 7374 6172 7469  .# when restarti
+000013b0: 6e67 2074 6865 2022 6361 7463 682d 7570  ng the "catch-up
+000013c0: 2220 7375 6273 6372 6970 7469 6f6e 2e0a  " subscription..
+000013d0: 0a72 6563 6569 7665 6420 3d20 5b5d 0a66  .received = [].f
+000013e0: 6f72 2065 7665 6e74 2069 6e20 7375 6273  or event in subs
+000013f0: 6372 6970 7469 6f6e 3a0a 2020 2020 7265  cription:.    re
+00001400: 6365 6976 6564 2e61 7070 656e 6428 6576  ceived.append(ev
+00001410: 656e 7429 0a20 2020 2069 6620 6576 656e  ent).    if even
+00001420: 742e 6964 203d 3d20 6576 656e 7433 2e69  t.id == event3.i
+00001430: 643a 0a20 2020 2020 2020 2062 7265 616b  d:.        break
+00001440: 0a0a 6173 7365 7274 2072 6563 6569 7665  ..assert receive
+00001450: 645b 2d33 5d2e 6461 7461 203d 3d20 6576  d[-3].data == ev
+00001460: 656e 7431 2e64 6174 610a 6173 7365 7274  ent1.data.assert
+00001470: 2072 6563 6569 7665 645b 2d32 5d2e 6461   received[-2].da
+00001480: 7461 203d 3d20 6576 656e 7432 2e64 6174  ta == event2.dat
+00001490: 610a 6173 7365 7274 2072 6563 6569 7665  a.assert receive
+000014a0: 645b 2d31 5d2e 6461 7461 203d 3d20 6576  d[-1].data == ev
+000014b0: 656e 7433 2e64 6174 610a 6173 7365 7274  ent3.data.assert
+000014c0: 2072 6563 6569 7665 645b 2d33 5d2e 7479   received[-3].ty
+000014d0: 7065 203d 3d20 6576 656e 7431 2e74 7970  pe == event1.typ
+000014e0: 650a 6173 7365 7274 2072 6563 6569 7665  e.assert receive
+000014f0: 645b 2d32 5d2e 7479 7065 203d 3d20 6576  d[-2].type == ev
+00001500: 656e 7432 2e74 7970 650a 6173 7365 7274  ent2.type.assert
+00001510: 2072 6563 6569 7665 645b 2d31 5d2e 7479   received[-1].ty
+00001520: 7065 203d 3d20 6576 656e 7433 2e74 7970  pe == event3.typ
+00001530: 650a 0a61 7373 6572 7420 7265 6365 6976  e..assert receiv
+00001540: 6564 5b2d 335d 2e63 6f6d 6d69 745f 706f  ed[-3].commit_po
+00001550: 7369 7469 6f6e 203e 2030 0a61 7373 6572  sition > 0.asser
+00001560: 7420 7265 6365 6976 6564 5b2d 325d 2e63  t received[-2].c
+00001570: 6f6d 6d69 745f 706f 7369 7469 6f6e 203e  ommit_position >
+00001580: 2072 6563 6569 7665 645b 2d33 5d2e 636f   received[-3].co
+00001590: 6d6d 6974 5f70 6f73 6974 696f 6e0a 6173  mmit_position.as
+000015a0: 7365 7274 2072 6563 6569 7665 645b 2d31  sert received[-1
+000015b0: 5d2e 636f 6d6d 6974 5f70 6f73 6974 696f  ].commit_positio
+000015c0: 6e20 3e20 7265 6365 6976 6564 5b2d 325d  n > received[-2]
+000015d0: 2e63 6f6d 6d69 745f 706f 7369 7469 6f6e  .commit_position
+000015e0: 0a0a 0a23 2043 6c6f 7365 2074 6865 2063  ...# Close the c
+000015f0: 6c69 656e 7420 6166 7465 7220 7573 652e  lient after use.
+00001600: 0a0a 636c 6965 6e74 2e63 6c6f 7365 2829  ..client.close()
+00001610: 0a60 6060 0a0a 5365 6520 6265 6c6f 7720  .```..See below 
+00001620: 666f 7220 6d6f 7265 2064 6574 6169 6c73  for more details
+00001630: 2e0a 0a46 6f72 2061 6e20 6578 616d 706c  ...For an exampl
+00001640: 6520 6f66 2075 7361 6765 2c20 7365 6520  e of usage, see 
+00001650: 7468 6520 5b65 7665 6e74 736f 7572 6369  the [eventsourci
+00001660: 6e67 2d65 7665 6e74 7374 6f72 6564 625d  ng-eventstoredb]
+00001670: 280a 6874 7470 733a 2f2f 6769 7468 7562  (.https://github
+00001680: 2e63 6f6d 2f70 7965 7665 6e74 736f 7572  .com/pyeventsour
+00001690: 6369 6e67 2f65 7665 6e74 736f 7572 6369  cing/eventsourci
+000016a0: 6e67 2d65 7665 6e74 7374 6f72 6564 6229  ng-eventstoredb)
+000016b0: 2070 6163 6b61 6765 2e0a 0a23 2320 5461   package...## Ta
+000016c0: 626c 6520 6f66 2063 6f6e 7465 6e74 730a  ble of contents.
+000016d0: 0a3c 212d 2d20 544f 4320 2d2d 3e0a 2a20  .<!-- TOC -->.* 
+000016e0: 5b49 6e73 7461 6c6c 2070 6163 6b61 6765  [Install package
+000016f0: 5d28 2369 6e73 7461 6c6c 2d70 6163 6b61  ](#install-packa
+00001700: 6765 290a 2020 2a20 5b46 726f 6d20 5079  ge).  * [From Py
+00001710: 5049 5d28 2366 726f 6d2d 7079 7069 290a  PI](#from-pypi).
+00001720: 2020 2a20 5b57 6974 6820 506f 6574 7279    * [With Poetry
+00001730: 5d28 2377 6974 682d 706f 6574 7279 290a  ](#with-poetry).
+00001740: 2a20 5b45 7665 6e74 5374 6f72 6544 4220  * [EventStoreDB 
+00001750: 7365 7276 6572 5d28 2365 7665 6e74 7374  server](#eventst
+00001760: 6f72 6564 622d 7365 7276 6572 290a 2020  oredb-server).  
+00001770: 2a20 5b52 756e 2063 6f6e 7461 696e 6572  * [Run container
+00001780: 5d28 2372 756e 2d63 6f6e 7461 696e 6572  ](#run-container
+00001790: 290a 2020 2a20 5b53 746f 7020 636f 6e74  ).  * [Stop cont
+000017a0: 6169 6e65 725d 2823 7374 6f70 2d63 6f6e  ainer](#stop-con
+000017b0: 7461 696e 6572 290a 2a20 5b45 7665 6e74  tainer).* [Event
+000017c0: 5374 6f72 6544 4220 636c 6965 6e74 5d28  StoreDB client](
+000017d0: 2365 7665 6e74 7374 6f72 6564 622d 636c  #eventstoredb-cl
+000017e0: 6965 6e74 290a 2020 2a20 5b49 6d70 6f72  ient).  * [Impor
+000017f0: 7420 636c 6173 735d 2823 696d 706f 7274  t class](#import
+00001800: 2d63 6c61 7373 290a 2020 2a20 5b43 6f6e  -class).  * [Con
+00001810: 7374 7275 6374 2063 6c69 656e 745d 2823  struct client](#
+00001820: 636f 6e73 7472 7563 742d 636c 6965 6e74  construct-client
+00001830: 290a 2a20 5b53 7472 6561 6d73 5d28 2373  ).* [Streams](#s
+00001840: 7472 6561 6d73 290a 2020 2a20 5b41 7070  treams).  * [App
+00001850: 656e 6420 6576 656e 7473 5d28 2361 7070  end events](#app
+00001860: 656e 642d 6576 656e 7473 290a 2020 2a20  end-events).  * 
+00001870: 5b41 7070 656e 6420 6576 656e 745d 2823  [Append event](#
+00001880: 6170 7065 6e64 2d65 7665 6e74 290a 2020  append-event).  
+00001890: 2a20 5b49 6465 6d70 6f74 656e 7420 6170  * [Idempotent ap
+000018a0: 7065 6e64 206f 7065 7261 7469 6f6e 735d  pend operations]
+000018b0: 2823 6964 656d 706f 7465 6e74 2d61 7070  (#idempotent-app
+000018c0: 656e 642d 6f70 6572 6174 696f 6e73 290a  end-operations).
+000018d0: 2020 2a20 5b52 6561 6420 7374 7265 616d    * [Read stream
+000018e0: 2065 7665 6e74 735d 2823 7265 6164 2d73   events](#read-s
+000018f0: 7472 6561 6d2d 6576 656e 7473 290a 2020  tream-events).  
+00001900: 2a20 5b48 6f77 2074 6f20 696d 706c 656d  * [How to implem
+00001910: 656e 7420 736e 6170 7368 6f74 7469 6e67  ent snapshotting
+00001920: 2077 6974 6820 4576 656e 7453 746f 7265   with EventStore
+00001930: 4442 5d28 2368 6f77 2d74 6f2d 696d 706c  DB](#how-to-impl
+00001940: 656d 656e 742d 736e 6170 7368 6f74 7469  ement-snapshotti
+00001950: 6e67 2d77 6974 682d 6576 656e 7473 746f  ng-with-eventsto
+00001960: 7265 6462 290a 2020 2a20 5b52 6561 6420  redb).  * [Read 
+00001970: 616c 6c20 6576 656e 7473 5d28 2372 6561  all events](#rea
+00001980: 642d 616c 6c2d 6576 656e 7473 290a 2020  d-all-events).  
+00001990: 2a20 5b47 6574 2063 7572 7265 6e74 2073  * [Get current s
+000019a0: 7472 6561 6d20 706f 7369 7469 6f6e 5d28  tream position](
+000019b0: 2367 6574 2d63 7572 7265 6e74 2d73 7472  #get-current-str
+000019c0: 6561 6d2d 706f 7369 7469 6f6e 290a 2020  eam-position).  
+000019d0: 2a20 5b47 6574 2063 7572 7265 6e74 2063  * [Get current c
+000019e0: 6f6d 6d69 7420 706f 7369 7469 6f6e 5d28  ommit position](
+000019f0: 2367 6574 2d63 7572 7265 6e74 2d63 6f6d  #get-current-com
+00001a00: 6d69 742d 706f 7369 7469 6f6e 290a 2020  mit-position).  
+00001a10: 2a20 5b47 6574 2073 7472 6561 6d20 6d65  * [Get stream me
+00001a20: 7461 6461 7461 5d28 2367 6574 2d73 7472  tadata](#get-str
+00001a30: 6561 6d2d 6d65 7461 6461 7461 290a 2020  eam-metadata).  
+00001a40: 2a20 5b53 6574 2073 7472 6561 6d20 6d65  * [Set stream me
+00001a50: 7461 6461 7461 5d28 2373 6574 2d73 7472  tadata](#set-str
+00001a60: 6561 6d2d 6d65 7461 6461 7461 290a 2020  eam-metadata).  
+00001a70: 2a20 5b44 656c 6574 6520 7374 7265 616d  * [Delete stream
+00001a80: 5d28 2364 656c 6574 652d 7374 7265 616d  ](#delete-stream
+00001a90: 290a 2020 2a20 5b54 6f6d 6273 746f 6e65  ).  * [Tombstone
+00001aa0: 2073 7472 6561 6d5d 2823 746f 6d62 7374   stream](#tombst
+00001ab0: 6f6e 652d 7374 7265 616d 290a 2a20 5b43  one-stream).* [C
+00001ac0: 6174 6368 2d75 7020 7375 6273 6372 6970  atch-up subscrip
+00001ad0: 7469 6f6e 735d 2823 6361 7463 682d 7570  tions](#catch-up
+00001ae0: 2d73 7562 7363 7269 7074 696f 6e73 290a  -subscriptions).
+00001af0: 2020 2a20 5b48 6f77 2074 6f20 696d 706c    * [How to impl
+00001b00: 656d 656e 7420 6578 6163 746c 792d 6f6e  ement exactly-on
+00001b10: 6365 2065 7665 6e74 2070 726f 6365 7373  ce event process
+00001b20: 696e 675d 2823 686f 772d 746f 2d69 6d70  ing](#how-to-imp
+00001b30: 6c65 6d65 6e74 2d65 7861 6374 6c79 2d6f  lement-exactly-o
+00001b40: 6e63 652d 6576 656e 742d 7072 6f63 6573  nce-event-proces
+00001b50: 7369 6e67 290a 2020 2a20 5b53 7562 7363  sing).  * [Subsc
+00001b60: 7269 6265 2061 6c6c 2065 7665 6e74 735d  ribe all events]
+00001b70: 2823 7375 6273 6372 6962 652d 616c 6c2d  (#subscribe-all-
+00001b80: 6576 656e 7473 290a 2020 2a20 5b53 7562  events).  * [Sub
+00001b90: 7363 7269 6265 2073 7472 6561 6d20 6576  scribe stream ev
+00001ba0: 656e 7473 5d28 2373 7562 7363 7269 6265  ents](#subscribe
+00001bb0: 2d73 7472 6561 6d2d 6576 656e 7473 290a  -stream-events).
+00001bc0: 2a20 5b50 6572 7369 7374 656e 7420 7375  * [Persistent su
+00001bd0: 6273 6372 6970 7469 6f6e 735d 2823 7065  bscriptions](#pe
+00001be0: 7273 6973 7465 6e74 2d73 7562 7363 7269  rsistent-subscri
+00001bf0: 7074 696f 6e73 290a 2020 2a20 5b43 7265  ptions).  * [Cre
+00001c00: 6174 6520 7375 6273 6372 6970 7469 6f6e  ate subscription
+00001c10: 5d28 2363 7265 6174 652d 7375 6273 6372  ](#create-subscr
+00001c20: 6970 7469 6f6e 290a 2020 2a20 5b52 6561  iption).  * [Rea
+00001c30: 6420 7375 6273 6372 6970 7469 6f6e 5d28  d subscription](
+00001c40: 2372 6561 642d 7375 6273 6372 6970 7469  #read-subscripti
+00001c50: 6f6e 290a 2020 2a20 5b47 6574 2073 7562  on).  * [Get sub
+00001c60: 7363 7269 7074 696f 6e20 696e 666f 5d28  scription info](
+00001c70: 2367 6574 2d73 7562 7363 7269 7074 696f  #get-subscriptio
+00001c80: 6e2d 696e 666f 290a 2020 2a20 5b4c 6973  n-info).  * [Lis
+00001c90: 7420 7375 6273 6372 6970 7469 6f6e 735d  t subscriptions]
+00001ca0: 2823 6c69 7374 2d73 7562 7363 7269 7074  (#list-subscript
+00001cb0: 696f 6e73 290a 2020 2a20 5b44 656c 6574  ions).  * [Delet
+00001cc0: 6520 7375 6273 6372 6970 7469 6f6e 5d28  e subscription](
+00001cd0: 2364 656c 6574 652d 7375 6273 6372 6970  #delete-subscrip
+00001ce0: 7469 6f6e 290a 2020 2a20 5b55 7064 6174  tion).  * [Updat
+00001cf0: 6520 7375 6273 6372 6970 7469 6f6e 5d28  e subscription](
+00001d00: 2375 7064 6174 652d 7375 6273 6372 6970  #update-subscrip
+00001d10: 7469 6f6e 290a 2020 2a20 5b43 7265 6174  tion).  * [Creat
+00001d20: 6520 7374 7265 616d 2073 7562 7363 7269  e stream subscri
+00001d30: 7074 696f 6e5d 2823 6372 6561 7465 2d73  ption](#create-s
+00001d40: 7472 6561 6d2d 7375 6273 6372 6970 7469  tream-subscripti
+00001d50: 6f6e 290a 2020 2a20 5b52 6561 6420 7374  on).  * [Read st
+00001d60: 7265 616d 2073 7562 7363 7269 7074 696f  ream subscriptio
+00001d70: 6e5d 2823 7265 6164 2d73 7472 6561 6d2d  n](#read-stream-
+00001d80: 7375 6273 6372 6970 7469 6f6e 290a 2020  subscription).  
+00001d90: 2a20 5b47 6574 2073 7472 6561 6d20 7375  * [Get stream su
+00001da0: 6273 6372 6970 7469 6f6e 2069 6e66 6f5d  bscription info]
+00001db0: 2823 6765 742d 7374 7265 616d 2d73 7562  (#get-stream-sub
+00001dc0: 7363 7269 7074 696f 6e2d 696e 666f 290a  scription-info).
+00001dd0: 2020 2a20 5b4c 6973 7420 7374 7265 616d    * [List stream
+00001de0: 2073 7562 7363 7269 7074 696f 6e73 5d28   subscriptions](
+00001df0: 236c 6973 742d 7374 7265 616d 2d73 7562  #list-stream-sub
+00001e00: 7363 7269 7074 696f 6e73 290a 2020 2a20  scriptions).  * 
+00001e10: 5b55 7064 6174 6520 7374 7265 616d 2073  [Update stream s
+00001e20: 7562 7363 7269 7074 696f 6e5d 2823 7570  ubscription](#up
+00001e30: 6461 7465 2d73 7472 6561 6d2d 7375 6273  date-stream-subs
+00001e40: 6372 6970 7469 6f6e 290a 2020 2a20 5b44  cription).  * [D
+00001e50: 656c 6574 6520 7374 7265 616d 2073 7562  elete stream sub
+00001e60: 7363 7269 7074 696f 6e5d 2823 6465 6c65  scription](#dele
+00001e70: 7465 2d73 7472 6561 6d2d 7375 6273 6372  te-stream-subscr
+00001e80: 6970 7469 6f6e 290a 2020 2a20 5b50 6572  iption).  * [Per
+00001e90: 7369 7374 656e 7420 7375 6273 6372 6970  sistent subscrip
+00001ea0: 7469 6f6e 2063 6f6e 7375 6d65 725d 2823  tion consumer](#
+00001eb0: 7065 7273 6973 7465 6e74 2d73 7562 7363  persistent-subsc
+00001ec0: 7269 7074 696f 6e2d 636f 6e73 756d 6572  ription-consumer
+00001ed0: 290a 2a20 5b43 6f6e 6e65 6374 696f 6e5d  ).* [Connection]
+00001ee0: 2823 636f 6e6e 6563 7469 6f6e 290a 2020  (#connection).  
+00001ef0: 2a20 5b52 6563 6f6e 6e65 6374 5d28 2372  * [Reconnect](#r
+00001f00: 6563 6f6e 6e65 6374 290a 2020 2a20 5b43  econnect).  * [C
+00001f10: 6c6f 7365 5d28 2363 6c6f 7365 290a 2a20  lose](#close).* 
+00001f20: 5b4e 6f74 6573 5d28 236e 6f74 6573 290a  [Notes](#notes).
+00001f30: 2020 2a20 5b43 6f6e 6e65 6374 696f 6e20    * [Connection 
+00001f40: 7374 7269 6e67 735d 2823 636f 6e6e 6563  strings](#connec
+00001f50: 7469 6f6e 2d73 7472 696e 6773 290a 2020  tion-strings).  
+00001f60: 2a20 5b52 6567 756c 6172 2065 7870 7265  * [Regular expre
+00001f70: 7373 696f 6e20 6669 6c74 6572 735d 2823  ssion filters](#
+00001f80: 7265 6775 6c61 722d 6578 7072 6573 7369  regular-expressi
+00001f90: 6f6e 2d66 696c 7465 7273 290a 2020 2a20  on-filters).  * 
+00001fa0: 5b4e 6577 2065 7665 6e74 206f 626a 6563  [New event objec
+00001fb0: 7473 5d28 236e 6577 2d65 7665 6e74 2d6f  ts](#new-event-o
+00001fc0: 626a 6563 7473 290a 2020 2a20 5b52 6563  bjects).  * [Rec
+00001fd0: 6f72 6465 6420 6576 656e 7420 6f62 6a65  orded event obje
+00001fe0: 6374 735d 2823 7265 636f 7264 6564 2d65  cts](#recorded-e
+00001ff0: 7665 6e74 2d6f 626a 6563 7473 290a 2020  vent-objects).  
+00002000: 2a20 5b41 7379 6e63 696f 2063 6c69 656e  * [Asyncio clien
+00002010: 745d 2823 6173 796e 6369 6f2d 636c 6965  t](#asyncio-clie
+00002020: 6e74 290a 2a20 5b43 6f6e 7472 6962 7574  nt).* [Contribut
+00002030: 6f72 735d 2823 636f 6e74 7269 6275 746f  ors](#contributo
+00002040: 7273 290a 2020 2a20 5b49 6e73 7461 6c6c  rs).  * [Install
+00002050: 2050 6f65 7472 795d 2823 696e 7374 616c   Poetry](#instal
+00002060: 6c2d 706f 6574 7279 290a 2020 2a20 5b53  l-poetry).  * [S
+00002070: 6574 7570 2066 6f72 2050 7943 6861 726d  etup for PyCharm
+00002080: 2075 7365 7273 5d28 2373 6574 7570 2d66   users](#setup-f
+00002090: 6f72 2d70 7963 6861 726d 2d75 7365 7273  or-pycharm-users
+000020a0: 290a 2020 2a20 5b53 6574 7570 2066 726f  ).  * [Setup fro
+000020b0: 6d20 636f 6d6d 616e 6420 6c69 6e65 5d28  m command line](
+000020c0: 2373 6574 7570 2d66 726f 6d2d 636f 6d6d  #setup-from-comm
+000020d0: 616e 642d 6c69 6e65 290a 2020 2a20 5b50  and-line).  * [P
+000020e0: 726f 6a65 6374 204d 616b 6566 696c 6520  roject Makefile 
+000020f0: 636f 6d6d 616e 6473 5d28 2370 726f 6a65  commands](#proje
+00002100: 6374 2d6d 616b 6566 696c 652d 636f 6d6d  ct-makefile-comm
+00002110: 616e 6473 290a 3c21 2d2d 2054 4f43 202d  ands).<!-- TOC -
+00002120: 2d3e 0a0a 2323 2049 6e73 7461 6c6c 2070  ->..## Install p
+00002130: 6163 6b61 6765 0a0a 4974 2069 7320 7265  ackage..It is re
+00002140: 636f 6d6d 656e 6465 6420 746f 2069 6e73  commended to ins
+00002150: 7461 6c6c 2050 7974 686f 6e20 7061 636b  tall Python pack
+00002160: 6167 6573 2069 6e74 6f20 6120 5079 7468  ages into a Pyth
+00002170: 6f6e 2076 6972 7475 616c 2065 6e76 6972  on virtual envir
+00002180: 6f6e 6d65 6e74 2e0a 0a23 2323 2046 726f  onment...### Fro
+00002190: 6d20 5079 5049 0a0a 596f 7520 6361 6e20  m PyPI..You can 
+000021a0: 7573 6520 7069 7020 746f 2069 6e73 7461  use pip to insta
+000021b0: 6c6c 2074 6869 7320 7061 636b 6167 6520  ll this package 
+000021c0: 6469 7265 6374 6c79 2066 726f 6d0a 5b74  directly from.[t
+000021d0: 6865 2050 7974 686f 6e20 5061 636b 6167  he Python Packag
+000021e0: 6520 496e 6465 785d 2868 7474 7073 3a2f  e Index](https:/
+000021f0: 2f70 7970 692e 6f72 672f 7072 6f6a 6563  /pypi.org/projec
+00002200: 742f 6573 6462 636c 6965 6e74 2f29 2e0a  t/esdbclient/)..
+00002210: 0a20 2020 2024 2070 6970 2069 6e73 7461  .    $ pip insta
+00002220: 6c6c 2065 7364 6263 6c69 656e 740a 0a23  ll esdbclient..#
+00002230: 2323 2057 6974 6820 506f 6574 7279 0a0a  ## With Poetry..
+00002240: 596f 7520 6361 6e20 7573 6520 506f 6574  You can use Poet
+00002250: 7279 2074 6f20 6164 6420 7468 6973 2070  ry to add this p
+00002260: 6163 6b61 6765 2074 6f20 796f 7572 2070  ackage to your p
+00002270: 7970 726f 6a65 6374 2e74 6f6d 6c20 616e  yproject.toml an
+00002280: 6420 696e 7374 616c 6c20 6974 2e0a 0a20  d install it... 
+00002290: 2020 2024 2070 6f65 7472 7920 6164 6420     $ poetry add 
+000022a0: 6573 6462 636c 6965 6e74 0a0a 2323 2045  esdbclient..## E
+000022b0: 7665 6e74 5374 6f72 6544 4220 7365 7276  ventStoreDB serv
+000022c0: 6572 0a0a 5468 6520 4576 656e 7453 746f  er..The EventSto
+000022d0: 7265 4442 2073 6572 7665 7220 6361 6e20  reDB server can 
+000022e0: 6265 2072 756e 206c 6f63 616c 6c79 2075  be run locally u
+000022f0: 7369 6e67 2074 6865 206f 6666 6963 6961  sing the officia
+00002300: 6c20 446f 636b 6572 2063 6f6e 7461 696e  l Docker contain
+00002310: 6572 2069 6d61 6765 2e0a 0a23 2323 2052  er image...### R
+00002320: 756e 2063 6f6e 7461 696e 6572 0a0a 466f  un container..Fo
+00002330: 7220 6465 7665 6c6f 706d 656e 742c 2079  r development, y
+00002340: 6f75 2063 616e 2072 756e 2061 2022 7365  ou can run a "se
+00002350: 6375 7265 2220 4576 656e 7453 746f 7265  cure" EventStore
+00002360: 4442 2073 6572 7665 7220 7573 696e 6720  DB server using 
+00002370: 7468 6520 666f 6c6c 6f77 696e 6720 636f  the following co
+00002380: 6d6d 616e 642e 0a0a 2020 2020 2420 646f  mmand...    $ do
+00002390: 636b 6572 2072 756e 202d 6420 2d2d 6e61  cker run -d --na
+000023a0: 6d65 2065 7665 6e74 7374 6f72 6564 622d  me eventstoredb-
+000023b0: 7365 6375 7265 202d 6974 202d 7020 3231  secure -it -p 21
+000023c0: 3133 3a32 3131 3320 2d2d 656e 7620 2248  13:2113 --env "H
+000023d0: 4f4d 453d 2f74 6d70 2220 6576 656e 7473  OME=/tmp" events
+000023e0: 746f 7265 2f65 7665 6e74 7374 6f72 653a  tore/eventstore:
+000023f0: 3231 2e31 302e 392d 6275 7374 6572 2d73  21.10.9-buster-s
+00002400: 6c69 6d20 2d2d 6465 760a 0a41 7320 7765  lim --dev..As we
+00002410: 2077 696c 6c20 7365 652c 2074 6865 2063   will see, the c
+00002420: 6c69 656e 7420 6e65 6564 7320 616e 2045  lient needs an E
+00002430: 7665 6e74 5374 6f72 6544 4220 636f 6e6e  ventStoreDB conn
+00002440: 6563 7469 6f6e 2073 7472 696e 6720 5552  ection string UR
+00002450: 4920 6173 2074 6865 2076 616c 7565 206f  I as the value o
+00002460: 660a 6974 7320 6075 7269 6020 636f 6e73  f.its `uri` cons
+00002470: 7472 7563 746f 7220 6172 6775 6d65 6e74  tructor argument
+00002480: 2e20 5365 6520 7468 6520 4e6f 7465 7320  . See the Notes 
+00002490: 7365 6374 696f 6e20 6265 6c6f 7720 666f  section below fo
+000024a0: 7220 6465 7461 696c 6564 2069 6e66 6f72  r detailed infor
+000024b0: 6d61 7469 6f6e 0a61 626f 7574 2045 7665  mation.about Eve
+000024c0: 6e74 5374 6f72 6544 4220 636f 6e6e 6563  ntStoreDB connec
+000024d0: 7469 6f6e 2073 7472 696e 6720 5552 4973  tion string URIs
+000024e0: 2e0a 0a54 6865 2063 6f6e 6e65 6374 696f  ...The connectio
+000024f0: 6e20 7374 7269 6e67 2066 6f72 2074 6869  n string for thi
+00002500: 7320 2273 6563 7572 6522 2045 7665 6e74  s "secure" Event
+00002510: 5374 6f72 6544 4220 7365 7276 6572 2077  StoreDB server w
+00002520: 6f75 6c64 2062 653a 0a0a 2020 2020 6573  ould be:..    es
+00002530: 6462 3a2f 2f61 646d 696e 3a63 6861 6e67  db://admin:chang
+00002540: 6569 7440 6c6f 6361 6c68 6f73 743a 3231  eit@localhost:21
+00002550: 3133 0a0a 546f 2063 6f6e 6e65 6374 2074  13..To connect t
+00002560: 6f20 6120 2273 6563 7572 6522 2073 6572  o a "secure" ser
+00002570: 7665 722c 2079 6f75 2077 696c 6c20 7573  ver, you will us
+00002580: 7561 6c6c 7920 6e65 6564 2074 6f20 696e  ually need to in
+00002590: 636c 7564 6520 6120 2275 7365 726e 616d  clude a "usernam
+000025a0: 6522 0a61 6e64 2061 2022 7061 7373 776f  e".and a "passwo
+000025b0: 7264 2220 696e 2074 6865 2063 6f6e 6e65  rd" in the conne
+000025c0: 6374 696f 6e20 7374 7269 6e67 2c20 736f  ction string, so
+000025d0: 2074 6861 7420 7468 6520 7365 7276 6572   that the server
+000025e0: 2063 616e 2061 7574 6865 6e74 6963 6174   can authenticat
+000025f0: 6520 7468 650a 636c 6965 6e74 2e20 5468  e the.client. Th
+00002600: 6520 6465 6661 756c 7420 7573 6572 6e61  e default userna
+00002610: 6d65 2069 7320 2261 646d 696e 2220 616e  me is "admin" an
+00002620: 6420 7468 6520 6465 6661 756c 7420 7061  d the default pa
+00002630: 7373 776f 7264 2069 7320 2263 6861 6e67  ssword is "chang
+00002640: 6569 7422 2e0a 0a57 6865 6e20 636f 6e6e  eit"...When conn
+00002650: 6563 7469 6e67 2074 6f20 6120 2273 6563  ecting to a "sec
+00002660: 7572 6522 2073 6572 7665 722c 2074 6865  ure" server, the
+00002670: 2063 6c69 656e 7420 616c 736f 206e 6565   client also nee
+00002680: 6473 2061 6e20 5353 4c2f 544c 530a 6365  ds an SSL/TLS.ce
+00002690: 7274 6966 6963 6174 6520 6173 2074 6865  rtificate as the
+000026a0: 2076 616c 7565 206f 6620 6974 7320 6072   value of its `r
+000026b0: 6f6f 745f 6365 7274 6966 6963 6174 6573  oot_certificates
+000026c0: 6020 636f 6e73 7472 7563 746f 7220 6172  ` constructor ar
+000026d0: 6775 6d65 6e74 2e20 546f 2063 6f6e 6e65  gument. To conne
+000026e0: 6374 0a74 6f20 6120 2273 6563 7572 6522  ct.to a "secure"
+000026f0: 2073 6572 7665 7220 796f 7520 7769 6c6c   server you will
+00002700: 206e 6565 6420 616e 2053 534c 2f54 4c53   need an SSL/TLS
+00002710: 2063 6572 7469 6669 6361 7465 2073 6f20   certificate so 
+00002720: 7468 6174 2074 6865 2063 6c69 656e 7420  that the client 
+00002730: 6361 6e0a 6175 7468 656e 7469 6361 7465  can.authenticate
+00002740: 2074 6865 2073 6572 7665 722e 2046 6f72   the server. For
+00002750: 2064 6576 656c 6f70 6d65 6e74 2c20 796f   development, yo
+00002760: 7520 6361 6e20 6569 7468 6572 2075 7365  u can either use
+00002770: 2074 6865 2053 534c 2f54 4c53 2063 6572   the SSL/TLS cer
+00002780: 7469 6669 6361 7465 0a6f 6620 7468 6520  tificate.of the 
+00002790: 6365 7274 6966 6963 6174 6520 6175 7468  certificate auth
+000027a0: 6f72 6974 7920 7573 6564 2074 6f20 6372  ority used to cr
+000027b0: 6561 7465 2074 6865 2073 6572 7665 7227  eate the server'
+000027c0: 7320 6365 7274 6966 6963 6174 652c 206f  s certificate, o
+000027d0: 7220 7768 656e 2075 7369 6e67 2061 0a73  r when using a.s
+000027e0: 696e 676c 652d 6e6f 6465 2063 6c75 7374  ingle-node clust
+000027f0: 6572 2c20 796f 7520 6361 6e20 7573 6520  er, you can use 
+00002800: 7468 6520 7365 7276 6572 2063 6572 7469  the server certi
+00002810: 6669 6361 7465 2069 7473 656c 662e 2059  ficate itself. Y
+00002820: 6f75 2063 616e 2067 6574 2074 6865 0a73  ou can get the.s
+00002830: 6572 7665 7220 6365 7274 6966 6963 6174  erver certificat
+00002840: 6520 7769 7468 2074 6865 2066 6f6c 6c6f  e with the follo
+00002850: 7769 6e67 2050 7974 686f 6e20 636f 6465  wing Python code
+00002860: 2e0a 0a0a 6060 6070 7974 686f 6e0a 696d  ....```python.im
+00002870: 706f 7274 2073 736c 0a0a 7365 7276 6572  port ssl..server
+00002880: 5f63 6572 7469 6669 6361 7465 203d 2073  _certificate = s
+00002890: 736c 2e67 6574 5f73 6572 7665 725f 6365  sl.get_server_ce
+000028a0: 7274 6966 6963 6174 6528 6164 6472 3d28  rtificate(addr=(
+000028b0: 276c 6f63 616c 686f 7374 272c 2032 3131  'localhost', 211
+000028c0: 3329 290a 6060 600a 0a59 6f75 2063 616e  3)).```..You can
+000028d0: 2061 6c73 6f20 7374 6172 7420 616e 2022   also start an "
+000028e0: 696e 7365 6375 7265 2220 7365 7276 6572  insecure" server
+000028f0: 2075 7369 6e67 2074 6865 2066 6f6c 6c6f   using the follo
+00002900: 7769 6e67 2063 6f6d 6d61 6e64 2e0a 0a20  wing command... 
+00002910: 2020 2024 2064 6f63 6b65 7220 7275 6e20     $ docker run 
+00002920: 2d64 202d 2d6e 616d 6520 6576 656e 7473  -d --name events
+00002930: 746f 7265 6462 2d69 6e73 6563 7572 6520  toredb-insecure 
+00002940: 2d69 7420 2d70 2032 3131 343a 3231 3133  -it -p 2114:2113
+00002950: 2065 7665 6e74 7374 6f72 652f 6576 656e   eventstore/even
+00002960: 7473 746f 7265 3a32 312e 3130 2e39 2d62  tstore:21.10.9-b
+00002970: 7573 7465 722d 736c 696d 202d 2d69 6e73  uster-slim --ins
+00002980: 6563 7572 650a 0a54 6865 2063 6f6e 6e65  ecure..The conne
+00002990: 6374 696f 6e20 7374 7269 6e67 2055 5249  ction string URI
+000029a0: 2066 6f72 2074 6869 7320 2269 6e73 6563   for this "insec
+000029b0: 7572 6522 2073 6572 7665 7220 776f 756c  ure" server woul
+000029c0: 6420 6265 3a0a 0a20 2020 2065 7364 623a  d be:..    esdb:
+000029d0: 2f2f 6c6f 6361 6c68 6f73 743a 3231 3134  //localhost:2114
+000029e0: 3f54 6c73 3d66 616c 7365 0a0a 4173 2077  ?Tls=false..As w
+000029f0: 6520 7769 6c6c 2073 6565 2c20 7768 656e  e will see, when
+00002a00: 2063 6f6e 6e65 6374 696e 6720 746f 2061   connecting to a
+00002a10: 6e20 2269 6e73 6563 7572 6522 2073 6572  n "insecure" ser
+00002a20: 7665 722c 2074 6865 7265 2069 7320 6e6f  ver, there is no
+00002a30: 206e 6565 6420 746f 2069 6e63 6c75 6465   need to include
+00002a40: 0a61 2022 7573 6572 6e61 6d65 2220 616e  .a "username" an
+00002a50: 6420 6120 2270 6173 7377 6f72 6422 2069  d a "password" i
+00002a60: 6e20 7468 6520 636f 6e6e 6563 7469 6f6e  n the connection
+00002a70: 2073 7472 696e 672e 2049 6620 796f 7520   string. If you 
+00002a80: 646f 2c20 7468 6573 6520 7661 6c75 6573  do, these values
+00002a90: 2077 696c 6c0a 6265 2069 676e 6f72 6564   will.be ignored
+00002aa0: 2062 7920 7468 6520 636c 6965 6e74 2c20   by the client, 
+00002ab0: 736f 2074 6861 7420 7468 6579 2077 696c  so that they wil
+00002ac0: 6c20 6e6f 7420 6265 2073 656e 7420 746f  l not be sent to
+00002ad0: 2074 6865 2073 6572 7665 7220 6f76 6572   the server over
+00002ae0: 2061 6e0a 696e 7365 6375 7265 2063 6861   an.insecure cha
+00002af0: 6e6e 656c 2e0a 0a50 6c65 6173 6520 6e6f  nnel...Please no
+00002b00: 7465 2c20 7468 6520 2269 6e73 6563 7572  te, the "insecur
+00002b10: 6522 2063 6f6e 6e65 6374 696f 6e20 7374  e" connection st
+00002b20: 7269 6e67 2075 7365 7320 6120 7175 6572  ring uses a quer
+00002b30: 7920 7374 7269 6e67 2077 6974 6820 7468  y string with th
+00002b40: 6520 6669 656c 642d 7661 6c75 650a 6054  e field-value.`T
+00002b50: 6c73 3d66 616c 7365 602e 2054 6865 2076  ls=false`. The v
+00002b60: 616c 7565 206f 6620 7468 6973 2066 6965  alue of this fie
+00002b70: 6c64 2069 7320 6279 2064 6566 6175 6c74  ld is by default
+00002b80: 2060 7472 7565 602e 2053 6565 2074 6865   `true`. See the
+00002b90: 204e 6f74 6573 2073 6563 7469 6f6e 2062   Notes section b
+00002ba0: 656c 6f77 0a66 6f72 206d 6f72 6520 696e  elow.for more in
+00002bb0: 666f 726d 6174 696f 6e20 6162 6f75 7420  formation about 
+00002bc0: 4576 656e 7453 746f 7265 4442 2063 6f6e  EventStoreDB con
+00002bd0: 6e65 6374 696f 6e20 7374 7269 6e67 7320  nection strings 
+00002be0: 616e 6420 7468 6520 6669 656c 6473 2074  and the fields t
+00002bf0: 6861 7420 6361 6e20 6265 0a75 7365 6420  hat can be.used 
+00002c00: 696e 2074 6865 2071 7565 7279 2073 7472  in the query str
+00002c10: 696e 6720 746f 2073 7065 6369 6679 2063  ing to specify c
+00002c20: 6f6e 6e65 6374 696f 6e20 6f70 7469 6f6e  onnection option
+00002c30: 732e 0a0a 2323 2320 5374 6f70 2063 6f6e  s...### Stop con
+00002c40: 7461 696e 6572 0a0a 546f 2073 746f 7020  tainer..To stop 
+00002c50: 616e 6420 7265 6d6f 7665 2074 6865 2022  and remove the "
+00002c60: 7365 6375 7265 2220 636f 6e74 6169 6e65  secure" containe
+00002c70: 722c 2075 7365 2074 6865 2066 6f6c 6c6f  r, use the follo
+00002c80: 7769 6e67 2044 6f63 6b65 7220 636f 6d6d  wing Docker comm
+00002c90: 616e 6473 2e0a 0a20 2020 2024 2064 6f63  ands...    $ doc
+00002ca0: 6b65 7220 7374 6f70 2065 7665 6e74 7374  ker stop eventst
+00002cb0: 6f72 6564 622d 7365 6375 7265 0a09 2420  oredb-secure..$ 
+00002cc0: 646f 636b 6572 2072 6d20 6576 656e 7473  docker rm events
+00002cd0: 746f 7265 6462 2d73 6563 7572 650a 0a54  toredb-secure..T
+00002ce0: 6f20 7374 6f70 2061 6e64 2072 656d 6f76  o stop and remov
+00002cf0: 6520 7468 6520 2269 6e73 6563 7572 6522  e the "insecure"
+00002d00: 2063 6f6e 7461 696e 6572 2c20 7573 6520   container, use 
+00002d10: 7468 6520 666f 6c6c 6f77 696e 6720 446f  the following Do
+00002d20: 636b 6572 2063 6f6d 6d61 6e64 732e 0a0a  cker commands...
+00002d30: 2020 2020 2420 646f 636b 6572 2073 746f      $ docker sto
+00002d40: 7020 6576 656e 7473 746f 7265 6462 2d69  p eventstoredb-i
+00002d50: 6e73 6563 7572 650a 0924 2064 6f63 6b65  nsecure..$ docke
+00002d60: 7220 726d 2065 7665 6e74 7374 6f72 6564  r rm eventstored
+00002d70: 622d 696e 7365 6375 7265 0a0a 0a23 2320  b-insecure...## 
+00002d80: 4576 656e 7453 746f 7265 4442 2063 6c69  EventStoreDB cli
+00002d90: 656e 740a 0a54 6869 7320 4576 656e 7453  ent..This EventS
+00002da0: 746f 7265 4442 2063 6c69 656e 7420 6973  toreDB client is
+00002db0: 2069 6d70 6c65 6d65 6e74 6564 2069 6e20   implemented in 
+00002dc0: 7468 6520 6065 7364 6263 6c69 656e 7460  the `esdbclient`
+00002dd0: 2070 6163 6b61 6765 2077 6974 680a 7468   package with.th
+00002de0: 6520 6045 5344 4243 6c69 656e 7460 2063  e `ESDBClient` c
+00002df0: 6c61 7373 2e0a 0a23 2323 2049 6d70 6f72  lass...### Impor
+00002e00: 7420 636c 6173 730a 0a54 6865 2060 4553  t class..The `ES
+00002e10: 4442 436c 6965 6e74 6020 636c 6173 7320  DBClient` class 
+00002e20: 6361 6e20 6265 2069 6d70 6f72 7465 6420  can be imported 
+00002e30: 6672 6f6d 2074 6865 2060 6573 6462 636c  from the `esdbcl
+00002e40: 6965 6e74 6020 7061 636b 6167 652e 0a0a  ient` package...
+00002e50: 6060 6070 7974 686f 6e0a 6672 6f6d 2065  ```python.from e
+00002e60: 7364 6263 6c69 656e 7420 696d 706f 7274  sdbclient import
+00002e70: 2045 5344 4243 6c69 656e 740a 6060 600a   ESDBClient.```.
+00002e80: 0a23 2323 2043 6f6e 7374 7275 6374 2063  .### Construct c
+00002e90: 6c69 656e 740a 0a54 6865 2060 4553 4442  lient..The `ESDB
+00002ea0: 436c 6965 6e74 6020 636c 6173 7320 6361  Client` class ca
+00002eb0: 6e20 6265 2063 6f6e 7374 7275 6374 6564  n be constructed
+00002ec0: 2077 6974 6820 6120 6075 7269 6020 6172   with a `uri` ar
+00002ed0: 6775 6d65 6e74 2c20 7768 6963 6820 6973  gument, which is
+00002ee0: 2072 6571 7569 7265 642e 0a41 6e64 2c20   required..And, 
+00002ef0: 746f 2063 6f6e 6e65 6374 2074 6f20 6120  to connect to a 
+00002f00: 2273 6563 7572 6522 2045 7665 6e74 5374  "secure" EventSt
+00002f10: 6f72 6544 4220 7365 7276 6572 2c20 7468  oreDB server, th
+00002f20: 6520 6f70 7469 6f6e 616c 2060 726f 6f74  e optional `root
+00002f30: 5f63 6572 7469 6669 6361 7465 7360 0a61  _certificates`.a
+00002f40: 7267 756d 656e 7420 6973 2061 6c73 6f20  rgument is also 
+00002f50: 7265 7175 6972 6564 2e0a 0a54 6865 2060  required...The `
+00002f60: 7572 6960 2061 7267 756d 656e 7420 6973  uri` argument is
+00002f70: 2065 7870 6563 7465 6420 746f 2062 6520   expected to be 
+00002f80: 616e 2045 7665 6e74 5374 6f72 6544 4220  an EventStoreDB 
+00002f90: 636f 6e6e 6563 7469 6f6e 2073 7472 696e  connection strin
+00002fa0: 6720 5552 4920 7468 6174 0a63 6f6e 666f  g URI that.confo
+00002fb0: 726d 7320 7769 7468 2074 6865 2073 7461  rms with the sta
+00002fc0: 6e64 6172 6420 4576 656e 7453 746f 7265  ndard EventStore
+00002fd0: 4442 2022 6573 6462 2220 6f72 2022 6573  DB "esdb" or "es
+00002fe0: 6462 2b64 6973 636f 7665 7222 2055 5249  db+discover" URI
+00002ff0: 2073 6368 656d 6573 2e20 5468 650a 7379   schemes. The.sy
+00003000: 6e74 6178 2061 6e64 2073 656d 616e 7469  ntax and semanti
+00003010: 6373 206f 6620 4576 656e 7453 746f 7265  cs of EventStore
+00003020: 4442 2063 6f6e 6e65 6374 696f 6e20 7374  DB connection st
+00003030: 7269 6e67 7320 6172 6520 6578 706c 6169  rings are explai
+00003040: 6e65 6420 696e 2074 6865 204e 6f74 6573  ned in the Notes
+00003050: 0a73 6563 7469 6f6e 2062 656c 6f77 2e0a  .section below..
+00003060: 0a46 6f72 2065 7861 6d70 6c65 2c20 7468  .For example, th
+00003070: 6520 666f 6c6c 6f77 696e 6720 636f 6e6e  e following conn
+00003080: 6563 7469 6f6e 2073 7472 696e 6720 7370  ection string sp
+00003090: 6563 6966 6965 7320 7468 6174 2074 6865  ecifies that the
+000030a0: 2063 6c69 656e 7420 7368 6f75 6c64 0a61   client should.a
+000030b0: 7474 656d 7074 2074 6f20 6372 6561 7465  ttempt to create
+000030c0: 2061 2022 7365 6375 7265 2220 636f 6e6e   a "secure" conn
+000030d0: 6563 7469 6f6e 2074 6f20 706f 7274 2032  ection to port 2
+000030e0: 3131 3320 6f6e 2022 6c6f 6361 6c68 6f73  113 on "localhos
+000030f0: 7422 2c20 616e 6420 7573 6520 7468 650a  t", and use the.
+00003100: 636c 6965 6e74 2063 7265 6465 6e74 6961  client credentia
+00003110: 6c73 2022 7573 6572 6e61 6d65 2220 616e  ls "username" an
+00003120: 6420 2270 6173 7377 6f72 6422 2077 6865  d "password" whe
+00003130: 6e20 6d61 6b69 6e67 2063 616c 6c73 2074  n making calls t
+00003140: 6f20 7468 6520 7365 7276 6572 2e0a 0a20  o the server... 
+00003150: 2020 2065 7364 623a 2f2f 7573 6572 6e61     esdb://userna
+00003160: 6d65 3a70 6173 7377 6f72 6440 6c6f 6361  me:password@loca
+00003170: 6c68 6f73 743a 3231 3133 3f54 6c73 3d74  lhost:2113?Tls=t
+00003180: 7275 650a 0a54 6865 2063 6c69 656e 7420  rue..The client 
+00003190: 6d75 7374 2062 6520 636f 6e66 6967 7572  must be configur
+000031a0: 6564 2074 6f20 6372 6561 7465 2061 2022  ed to create a "
+000031b0: 7365 6375 7265 2220 636f 6e6e 6563 7469  secure" connecti
+000031c0: 6f6e 2074 6f20 6120 2273 6563 7572 6522  on to a "secure"
+000031d0: 2073 6572 7665 722c 0a6f 7220 616c 7465   server,.or alte
+000031e0: 726e 6174 6976 656c 7920 616e 2022 696e  rnatively an "in
+000031f0: 7365 6375 7265 2220 636f 6e6e 6563 7469  secure" connecti
+00003200: 6f6e 2074 6f20 616e 2022 696e 7365 6375  on to an "insecu
+00003210: 7265 2220 7365 7276 6572 2e20 4279 2064  re" server. By d
+00003220: 6566 6175 6c74 2c20 7468 650a 636c 6965  efault, the.clie
+00003230: 6e74 2077 696c 6c20 6174 7465 6d70 7420  nt will attempt 
+00003240: 746f 2063 7265 6174 6520 6120 2273 6563  to create a "sec
+00003250: 7572 6522 2063 6f6e 6e65 6374 696f 6e2e  ure" connection.
+00003260: 2041 6e64 2073 6f2c 2077 6865 6e20 636f   And so, when co
+00003270: 6e6e 6563 7469 6e67 2074 6f20 616e 0a22  nnecting to an."
+00003280: 696e 7365 6375 7265 2220 7365 7276 6572  insecure" server
+00003290: 2c20 7468 6520 636f 6e6e 6563 7469 6f6e  , the connection
+000032a0: 2073 7472 696e 6720 6d75 7374 2073 7065   string must spe
+000032b0: 6369 6679 2074 6861 7420 7468 6520 636c  cify that the cl
+000032c0: 6965 6e74 2073 686f 756c 6420 6174 7465  ient should atte
+000032d0: 6d70 740a 746f 206d 616b 6520 616e 2022  mpt.to make an "
+000032e0: 696e 7365 6375 7265 2220 636f 6e6e 6563  insecure" connec
+000032f0: 7469 6f6e 2e0a 0a54 6865 2066 6f6c 6c6f  tion...The follo
+00003300: 7769 6e67 2063 6f6e 6e65 6374 696f 6e20  wing connection 
+00003310: 7374 7269 6e67 2073 7065 6369 6669 6573  string specifies
+00003320: 2074 6861 7420 7468 6520 636c 6965 6e74   that the client
+00003330: 2073 686f 756c 640a 6174 7465 6d70 7420   should.attempt 
+00003340: 746f 2063 7265 6174 6520 616e 2022 696e  to create an "in
+00003350: 7365 6375 7265 2220 636f 6e6e 6563 7469  secure" connecti
+00003360: 6f6e 2074 6f20 706f 7274 2032 3131 3420  on to port 2114 
+00003370: 6f6e 2022 6c6f 6361 6c68 6f73 7422 2e0a  on "localhost"..
+00003380: 5768 656e 2063 6f6e 6e65 6374 696e 6720  When connecting 
+00003390: 746f 2061 6e20 2269 6e73 6563 7572 6522  to an "insecure"
+000033a0: 2073 6572 7665 722c 2074 6865 2063 6c69   server, the cli
+000033b0: 656e 7420 7769 6c6c 2069 676e 6f72 6520  ent will ignore 
+000033c0: 616e 790a 7573 6572 6e61 6d65 2061 6e64  any.username and
+000033d0: 2070 6173 7377 6f72 6420 696e 666f 726d   password inform
+000033e0: 6174 696f 6e20 696e 636c 7564 6564 2069  ation included i
+000033f0: 6e20 7468 6520 636f 6e6e 6563 7469 6f6e  n the connection
+00003400: 2073 7472 696e 672c 0a73 6f20 7468 6174   string,.so that
+00003410: 2075 7365 726e 616d 6573 2061 6e64 2070   usernames and p
+00003420: 6173 7377 6f72 6473 2061 7265 206e 6f74  asswords are not
+00003430: 2073 656e 7420 6f76 6572 2061 6e20 2269   sent over an "i
+00003440: 6e73 6563 7572 6522 2063 6f6e 6e65 6374  nsecure" connect
+00003450: 696f 6e2e 0a0a 2020 2020 6573 6462 3a2f  ion...    esdb:/
+00003460: 2f6c 6f63 616c 686f 7374 3a32 3131 343f  /localhost:2114?
+00003470: 546c 733d 6661 6c73 650a 0a50 6c65 6173  Tls=false..Pleas
+00003480: 6520 6e6f 7465 2c20 7468 6520 2269 6e73  e note, the "ins
+00003490: 6563 7572 6522 2063 6f6e 6e65 6374 696f  ecure" connectio
+000034a0: 6e20 7374 7269 6e67 2075 7365 7320 6120  n string uses a 
+000034b0: 7175 6572 7920 7374 7269 6e67 2077 6974  query string wit
+000034c0: 6820 7468 6520 6669 656c 642d 7661 6c75  h the field-valu
+000034d0: 650a 6054 6c73 3d66 616c 7365 602e 2054  e.`Tls=false`. T
+000034e0: 6865 2076 616c 7565 206f 6620 7468 6973  he value of this
+000034f0: 2066 6965 6c64 2069 7320 6279 2064 6566   field is by def
+00003500: 6175 6c74 2060 7472 7565 602e 2055 6e6c  ault `true`. Unl
+00003510: 6573 7320 7468 6520 636f 6e6e 6563 7469  ess the connecti
+00003520: 6f6e 2073 7472 696e 670a 5552 4920 696e  on string.URI in
+00003530: 636c 7564 6573 2074 6865 2066 6965 6c64  cludes the field
+00003540: 2d76 616c 7565 2060 546c 733d 6661 6c73  -value `Tls=fals
+00003550: 6560 2069 6e20 7468 6520 7175 6572 7920  e` in the query 
+00003560: 7374 7269 6e67 2c20 7468 6520 6072 6f6f  string, the `roo
+00003570: 745f 6365 7274 6966 6963 6174 6573 600a  t_certificates`.
+00003580: 636f 6e73 7472 7563 746f 7220 6172 6775  constructor argu
+00003590: 6d65 6e74 2069 7320 616c 736f 2072 6571  ment is also req
+000035a0: 7569 7265 642e 0a0a 5768 656e 2063 6f6e  uired...When con
+000035b0: 6e65 6374 696e 6720 746f 2061 2022 7365  necting to a "se
+000035c0: 6375 7265 2220 7365 7276 6572 2c20 7468  cure" server, th
+000035d0: 6520 6072 6f6f 745f 6365 7274 6966 6963  e `root_certific
+000035e0: 6174 6573 6020 6172 6775 6d65 6e74 2069  ates` argument i
+000035f0: 7320 6578 7065 6374 6564 2074 6f0a 6265  s expected to.be
+00003600: 2061 2050 7974 686f 6e20 6073 7472 6020   a Python `str` 
+00003610: 636f 6e74 6169 6e69 6e67 2050 454d 2065  containing PEM e
+00003620: 6e63 6f64 6564 2053 534c 2f54 4c53 2072  ncoded SSL/TLS r
+00003630: 6f6f 7420 6365 7274 6966 6963 6174 6573  oot certificates
+00003640: 2e20 5468 6973 2076 616c 7565 2069 730a  . This value is.
+00003650: 7061 7373 6564 2064 6972 6563 746c 7920  passed directly 
+00003660: 746f 2060 6772 7063 2e73 736c 5f63 6861  to `grpc.ssl_cha
+00003670: 6e6e 656c 5f63 7265 6465 6e74 6961 6c73  nnel_credentials
+00003680: 2829 602e 2049 7420 6973 2075 7365 6420  ()`. It is used 
+00003690: 666f 7220 6175 7468 656e 7469 6361 7469  for authenticati
+000036a0: 6e67 2074 6865 0a73 6572 7665 7220 746f  ng the.server to
+000036b0: 2074 6865 2063 6c69 656e 742e 2049 7420   the client. It 
+000036c0: 6973 2063 6f6d 6d6f 6e6c 7920 7468 6520  is commonly the 
+000036d0: 6365 7274 6966 6963 6174 6520 6f66 2074  certificate of t
+000036e0: 6865 2063 6572 7469 6669 6361 7465 2061  he certificate a
+000036f0: 7574 686f 7269 7479 2074 6861 740a 7761  uthority that.wa
+00003700: 7320 7265 7370 6f6e 7369 626c 6520 666f  s responsible fo
+00003710: 7220 6765 6e65 7261 7469 6e67 2074 6865  r generating the
+00003720: 2053 534c 2f54 4c53 2063 6572 7469 6669   SSL/TLS certifi
+00003730: 6361 7465 2075 7365 6420 6279 2074 6865  cate used by the
+00003740: 2045 7665 6e74 5374 6f72 6544 4220 7365   EventStoreDB se
+00003750: 7276 6572 2e0a 4275 742c 2061 6c74 6572  rver..But, alter
+00003760: 6e61 7469 7665 6c79 2066 6f72 2064 6576  natively for dev
+00003770: 656c 6f70 6d65 6e74 2c20 796f 7520 6361  elopment, you ca
+00003780: 6e20 7573 6520 7468 6520 7365 7276 6572  n use the server
+00003790: 2773 2063 6572 7469 6669 6361 7465 2069  's certificate i
+000037a0: 7473 656c 662e 0a0a 496e 2074 6865 2065  tself...In the e
+000037b0: 7861 6d70 6c65 2062 656c 6f77 2c20 7468  xample below, th
+000037c0: 6520 636f 6e73 7472 7563 746f 7220 6172  e constructor ar
+000037d0: 6775 6d65 6e74 2076 616c 7565 7320 6172  gument values ar
+000037e0: 6520 7461 6b65 6e20 6672 6f6d 2074 6865  e taken from the
+000037f0: 206f 7065 7261 7469 6e67 0a73 7973 7465   operating.syste
+00003800: 6d20 656e 7669 726f 6e6d 656e 742e 2054  m environment. T
+00003810: 6869 7320 6973 2061 2074 7970 6963 616c  his is a typical
+00003820: 2061 7272 616e 6765 6d65 6e74 2069 6e20   arrangement in 
+00003830: 6120 7072 6f64 7563 7469 6f6e 2065 6e76  a production env
+00003840: 6972 6f6e 6d65 6e74 2e20 4974 2069 730a  ironment. It is.
+00003850: 646f 6e65 2074 6869 7320 7761 7920 6865  done this way he
+00003860: 7265 2073 6f20 7468 6174 2074 6865 2063  re so that the c
+00003870: 6f64 6520 696e 2074 6869 7320 646f 6375  ode in this docu
+00003880: 6d65 6e74 6174 696f 6e20 6361 6e20 6265  mentation can be
+00003890: 2074 6573 7465 6420 7769 7468 2062 6f74   tested with bot
+000038a0: 680a 6120 2273 6563 7572 6522 2061 6e64  h.a "secure" and
+000038b0: 2061 6e20 2269 6e73 6563 7572 6522 2073   an "insecure" s
+000038c0: 6572 7665 722e 0a0a 6060 6070 7974 686f  erver...```pytho
+000038d0: 6e0a 696d 706f 7274 206f 730a 0a63 6c69  n.import os..cli
+000038e0: 656e 7420 3d20 4553 4442 436c 6965 6e74  ent = ESDBClient
+000038f0: 280a 2020 2020 7572 693d 6f73 2e67 6574  (.    uri=os.get
+00003900: 656e 7628 2245 5344 425f 5552 4922 292c  env("ESDB_URI"),
+00003910: 0a20 2020 2072 6f6f 745f 6365 7274 6966  .    root_certif
+00003920: 6963 6174 6573 3d6f 732e 6765 7465 6e76  icates=os.getenv
+00003930: 2822 4553 4442 5f52 4f4f 545f 4345 5254  ("ESDB_ROOT_CERT
+00003940: 4946 4943 4154 4553 2229 2c0a 290a 6060  IFICATES"),.).``
+00003950: 600a 0a53 6565 2074 6865 204e 6f74 6573  `..See the Notes
+00003960: 2073 6563 7469 6f6e 2062 656c 6f77 2066   section below f
+00003970: 6f72 2064 6574 6169 6c65 6420 696e 666f  or detailed info
+00003980: 726d 6174 696f 6e20 6162 6f75 7420 4576  rmation about Ev
+00003990: 656e 7453 746f 7265 4442 2063 6f6e 6e65  entStoreDB conne
+000039a0: 6374 696f 6e0a 7374 7269 6e67 7320 616e  ction.strings an
+000039b0: 6420 7468 6520 6669 656c 6473 2074 6861  d the fields tha
+000039c0: 7420 6361 6e20 6265 2075 7365 6420 696e  t can be used in
+000039d0: 2074 6865 2071 7565 7279 2073 7472 696e   the query strin
+000039e0: 6720 746f 2073 7065 6369 6679 2063 6f6e  g to specify con
+000039f0: 6e65 6374 696f 6e0a 6f70 7469 6f6e 732e  nection.options.
+00003a00: 0a0a 2323 2053 7472 6561 6d73 0a0a 496e  ..## Streams..In
+00003a10: 2045 7665 6e74 5374 6f72 6544 422c 2061   EventStoreDB, a
+00003a20: 2022 7374 7265 616d 2220 6973 2061 2073   "stream" is a s
+00003a30: 6571 7565 6e63 6520 6f66 2072 6563 6f72  equence of recor
+00003a40: 6465 6420 6576 656e 7473 2074 6861 7420  ded events that 
+00003a50: 616c 6c20 6861 7665 0a74 6865 2073 616d  all have.the sam
+00003a60: 6520 2273 7472 6561 6d20 6e61 6d65 222e  e "stream name".
+00003a70: 2054 6865 7265 2077 696c 6c20 6e6f 726d   There will norm
+00003a80: 616c 6c79 2062 6520 6d61 6e79 2073 7472  ally be many str
+00003a90: 6561 6d73 2069 6e20 6120 6461 7461 6261  eams in a databa
+00003aa0: 7365 2e0a 4561 6368 2072 6563 6f72 6465  se..Each recorde
+00003ab0: 6420 6576 656e 7420 6861 7320 6120 2273  d event has a "s
+00003ac0: 7472 6561 6d20 706f 7369 7469 6f6e 2220  tream position" 
+00003ad0: 696e 2069 7473 2073 7472 6561 6d2c 2061  in its stream, a
+00003ae0: 6e64 2061 2022 636f 6d6d 6974 2070 6f73  nd a "commit pos
+00003af0: 6974 696f 6e22 0a69 6e20 7468 6520 6461  ition".in the da
+00003b00: 7461 6261 7365 2e20 5468 6520 7374 7265  tabase. The stre
+00003b10: 616d 2070 6f73 6974 696f 6e73 206f 6620  am positions of 
+00003b20: 7468 6520 7265 636f 7264 6564 2065 7665  the recorded eve
+00003b30: 6e74 7320 696e 2061 2073 7472 6561 6d20  nts in a stream 
+00003b40: 6973 2061 2067 6170 6c65 7373 0a73 6571  is a gapless.seq
+00003b50: 7565 6e63 6520 7374 6172 7469 6e67 2066  uence starting f
+00003b60: 726f 6d20 7a65 726f 2e20 5468 6520 636f  rom zero. The co
+00003b70: 6d6d 6974 2070 6f73 6974 696f 6e73 206f  mmit positions o
+00003b80: 6620 7468 6520 7265 636f 7264 6564 2065  f the recorded e
+00003b90: 7665 6e74 7320 696e 2074 6865 2064 6174  vents in the dat
+00003ba0: 6162 6173 650a 666f 726d 2061 2073 6571  abase.form a seq
+00003bb0: 7565 6e63 6520 7468 6174 2069 7320 6e6f  uence that is no
+00003bc0: 7420 6761 706c 6573 732e 0a0a 5468 6520  t gapless...The 
+00003bd0: 6d65 7468 6f64 7320 6061 7070 656e 645f  methods `append_
+00003be0: 6576 656e 7473 2829 602c 2060 7265 6164  events()`, `read
+00003bf0: 5f73 7472 6561 6d5f 6576 656e 7473 2829  _stream_events()
+00003c00: 6020 616e 6420 6072 6561 645f 616c 6c5f  ` and `read_all_
+00003c10: 6576 656e 7473 2829 6020 6361 6e0a 6265  events()` can.be
+00003c20: 2075 7365 6420 746f 2072 6563 6f72 6420   used to record 
+00003c30: 616e 6420 7265 6164 2065 7665 6e74 7320  and read events 
+00003c40: 696e 2074 6865 2064 6174 6162 6173 652e  in the database.
+00003c50: 0a0a 2323 2320 4170 7065 6e64 2065 7665  ..### Append eve
+00003c60: 6e74 730a 0a2a 7265 7175 6972 6573 206c  nts..*requires l
+00003c70: 6561 6465 722a 0a0a 5468 6520 6061 7070  eader*..The `app
+00003c80: 656e 645f 6576 656e 7473 2829 6020 6d65  end_events()` me
+00003c90: 7468 6f64 2063 616e 2062 6520 7573 6564  thod can be used
+00003ca0: 2074 6f20 7772 6974 6520 6120 7365 7175   to write a sequ
+00003cb0: 656e 6365 206f 6620 6e65 7720 6576 656e  ence of new even
+00003cc0: 7473 2061 746f 6d69 6361 6c6c 790a 746f  ts atomically.to
+00003cd0: 2061 2022 7374 7265 616d 222e 2057 7269   a "stream". Wri
+00003ce0: 7469 6e67 206e 6577 2065 7665 6e74 7320  ting new events 
+00003cf0: 6569 7468 6572 2063 7265 6174 6573 2061  either creates a
+00003d00: 2073 7472 6561 6d2c 206f 7220 6170 7065   stream, or appe
+00003d10: 6e64 7320 6576 656e 7473 2074 6f20 7468  nds events to th
+00003d20: 6520 656e 640a 6f66 2061 2073 7472 6561  e end.of a strea
+00003d30: 6d2e 2054 6869 7320 6d65 7468 6f64 2069  m. This method i
+00003d40: 7320 6964 656d 706f 7465 6e74 2e0a 0a54  s idempotent...T
+00003d50: 6869 7320 6d65 7468 6f64 2063 616e 2062  his method can b
+00003d60: 6520 7573 6564 2074 6f20 7265 636f 7264  e used to record
+00003d70: 2061 746f 6d69 6361 6c6c 7920 616c 6c20   atomically all 
+00003d80: 7468 6520 6e65 770a 6576 656e 7473 2074  the new.events t
+00003d90: 6861 7420 6172 6520 6765 6e65 7261 7465  hat are generate
+00003da0: 6420 7768 656e 2065 7865 6375 7469 6e67  d when executing
+00003db0: 2061 2063 6f6d 6d61 6e64 2069 6e20 616e   a command in an
+00003dc0: 2061 7070 6c69 6361 7469 6f6e 2e0a 0a54   application...T
+00003dd0: 6872 6565 2061 7267 756d 656e 7473 2061  hree arguments a
+00003de0: 7265 2072 6571 7569 7265 642c 2060 7374  re required, `st
+00003df0: 7265 616d 5f6e 616d 6560 2c20 6065 7870  ream_name`, `exp
+00003e00: 6563 7465 645f 706f 7369 7469 6f6e 600a  ected_position`.
+00003e10: 616e 6420 6065 7665 6e74 7360 2e0a 0a54  and `events`...T
+00003e20: 6865 2060 7374 7265 616d 5f6e 616d 6560  he `stream_name`
+00003e30: 2061 7267 756d 656e 7420 6973 2072 6571   argument is req
+00003e40: 7569 7265 642c 2061 6e64 2069 7320 6578  uired, and is ex
+00003e50: 7065 6374 6564 2074 6f20 6265 2061 2050  pected to be a P
+00003e60: 7974 686f 6e0a 6073 7472 6020 7468 6174  ython.`str` that
+00003e70: 2075 6e69 7175 656c 7920 6964 656e 7469   uniquely identi
+00003e80: 6669 6573 2074 6865 2073 7472 6561 6d20  fies the stream 
+00003e90: 696e 2074 6865 2064 6174 6162 6173 652e  in the database.
+00003ea0: 0a0a 5468 6520 6065 7870 6563 7465 645f  ..The `expected_
+00003eb0: 706f 7369 7469 6f6e 6020 6172 6775 6d65  position` argume
+00003ec0: 6e74 2069 7320 7265 7175 6972 6564 2c20  nt is required, 
+00003ed0: 6973 2065 7870 6563 7465 6420 746f 2062  is expected to b
+00003ee0: 653a 2060 4e6f 6e65 600a 6966 2065 7665  e: `None`.if eve
+00003ef0: 6e74 7320 6172 6520 6265 696e 6720 7772  nts are being wr
+00003f00: 6974 7465 6e20 746f 2061 206e 6577 2073  itten to a new s
+00003f10: 7472 6561 6d2c 2061 6e64 206f 7468 6572  tream, and other
+00003f20: 7769 7365 2061 6e20 5079 7468 6f6e 2060  wise an Python `
+00003f30: 696e 7460 0a65 7175 616c 2074 6f20 7468  int`.equal to th
+00003f40: 6520 706f 7369 7469 6f6e 2069 6e20 7468  e position in th
+00003f50: 6520 7374 7265 616d 206f 6620 7468 6520  e stream of the 
+00003f60: 6c61 7374 2072 6563 6f72 6465 6420 6576  last recorded ev
+00003f70: 656e 7420 696e 2074 6865 2073 7472 6561  ent in the strea
+00003f80: 6d2e 0a0a 5468 6520 6065 7665 6e74 7360  m...The `events`
+00003f90: 2061 7267 756d 656e 7420 6973 2072 6571   argument is req
+00003fa0: 7569 7265 642c 2061 6e64 2069 7320 6578  uired, and is ex
+00003fb0: 7065 6374 6564 2074 6f20 6265 2061 2073  pected to be a s
+00003fc0: 6571 7565 6e63 6520 6f66 206e 6577 0a65  equence of new.e
+00003fd0: 7665 6e74 206f 626a 6563 7473 2074 6f20  vent objects to 
+00003fe0: 6265 2061 7070 656e 6465 6420 746f 2074  be appended to t
+00003ff0: 6865 206e 616d 6564 2073 7472 6561 6d2e  he named stream.
+00004000: 2054 6865 2060 4e65 7745 7665 6e74 6020   The `NewEvent` 
+00004010: 636c 6173 7320 7368 6f75 6c64 0a62 6520  class should.be 
+00004020: 7573 6564 2074 6f20 636f 6e73 7472 7563  used to construc
+00004030: 7420 6e65 7720 6576 656e 7420 6f62 6a65  t new event obje
+00004040: 6374 7320 2873 6565 2074 6865 204e 6f74  cts (see the Not
+00004050: 6573 2073 6563 7469 6f6e 2062 656c 6f77  es section below
+00004060: 2066 6f72 2064 6574 6169 6c73 0a6f 6620   for details.of 
+00004070: 7468 6973 2063 6c61 7373 292e 0a0a 5468  this class)...Th
+00004080: 6973 206d 6574 686f 6420 7461 6b65 7320  is method takes 
+00004090: 616e 206f 7074 696f 6e61 6c20 6074 696d  an optional `tim
+000040a0: 656f 7574 6020 6172 6775 6d65 6e74 2c20  eout` argument, 
+000040b0: 7768 6963 6820 6973 2061 2050 7974 686f  which is a Pytho
+000040c0: 6e20 6066 6c6f 6174 6020 7468 6174 2073  n `float` that s
+000040d0: 6574 730a 6120 6465 6164 6c69 6e65 2066  ets.a deadline f
+000040e0: 6f72 2074 6865 2063 6f6d 706c 6574 696f  or the completio
+000040f0: 6e20 6f66 2074 6865 2067 5250 4320 6f70  n of the gRPC op
+00004100: 6572 6174 696f 6e2e 0a0a 5374 7265 616d  eration...Stream
+00004110: 7320 6172 6520 6372 6561 7465 6420 6279  s are created by
+00004120: 2077 7269 7469 6e67 2065 7665 6e74 732e   writing events.
+00004130: 2054 6865 2063 6f72 7265 6374 2076 616c   The correct val
+00004140: 7565 206f 6620 7468 6520 6065 7870 6563  ue of the `expec
+00004150: 7465 645f 706f 7369 7469 6f6e 600a 6172  ted_position`.ar
+00004160: 6775 6d65 6e74 2077 6865 6e20 7772 6974  gument when writ
+00004170: 696e 6720 7468 6520 6669 7273 7420 6576  ing the first ev
+00004180: 656e 7420 6f66 2061 206e 6577 2073 7472  ent of a new str
+00004190: 6561 6d20 6973 2060 4e6f 6e65 602e 2050  eam is `None`. P
+000041a0: 6c65 6173 6520 6e6f 7465 2c20 6974 2069  lease note, it i
+000041b0: 730a 6e6f 7420 706f 7373 6962 6c65 2074  s.not possible t
+000041c0: 6f20 736f 6d65 686f 7720 6372 6561 7465  o somehow create
+000041d0: 2061 6e20 2265 6d70 7479 2220 7374 7265   an "empty" stre
+000041e0: 616d 2069 6e20 4576 656e 7453 746f 7265  am in EventStore
+000041f0: 4442 2e0a 0a54 6865 2073 7472 6561 6d20  DB...The stream 
+00004200: 706f 7369 7469 6f6e 7320 6f66 2072 6563  positions of rec
+00004210: 6f72 6465 6420 6576 656e 7473 2069 6e20  orded events in 
+00004220: 6120 7374 7265 616d 2073 7461 7274 2066  a stream start f
+00004230: 726f 6d20 7a65 726f 2c20 616e 6420 666f  rom zero, and fo
+00004240: 726d 2061 2067 6170 6c65 7373 0a73 6571  rm a gapless.seq
+00004250: 7565 6e63 6520 6f66 2069 6e74 6567 6572  uence of integer
+00004260: 732e 2054 6865 2073 7472 6561 6d20 706f  s. The stream po
+00004270: 7369 7469 6f6e 206f 6620 7468 6520 6669  sition of the fi
+00004280: 7273 7420 7265 636f 7264 6564 2065 7665  rst recorded eve
+00004290: 6e74 2069 6e20 6120 7374 7265 616d 2069  nt in a stream i
+000042a0: 730a 6030 602e 2041 6e64 2073 6f20 7768  s.`0`. And so wh
+000042b0: 656e 2061 7070 656e 6469 6e67 2074 6865  en appending the
+000042c0: 2073 6563 6f6e 6420 6e65 7720 6576 656e   second new even
+000042d0: 7420 746f 2061 2073 7472 6561 6d20 7468  t to a stream th
+000042e0: 6174 2068 6173 206f 6e65 2072 6563 6f72  at has one recor
+000042f0: 6465 6420 6576 656e 742c 0a74 6865 2063  ded event,.the c
+00004300: 6f72 7265 6374 2076 616c 7565 206f 6620  orrect value of 
+00004310: 7468 6520 6065 7870 6563 7465 645f 706f  the `expected_po
+00004320: 7369 7469 6f6e 6020 6172 6775 6d65 6e74  sition` argument
+00004330: 2069 7320 6030 602e 2053 696d 696c 6172   is `0`. Similar
+00004340: 6c79 2c20 7468 6520 7374 7265 616d 0a70  ly, the stream.p
+00004350: 6f73 6974 696f 6e20 6f66 2074 6865 2073  osition of the s
+00004360: 6563 6f6e 6420 7265 636f 7264 6564 2065  econd recorded e
+00004370: 7665 6e74 2069 6e20 6120 7374 7265 616d  vent in a stream
+00004380: 2069 7320 6031 602c 2061 6e64 2073 6f20   is `1`, and so 
+00004390: 7768 656e 2061 7070 656e 6469 6e67 2074  when appending t
+000043a0: 6865 0a74 6869 7264 206e 6577 2065 7665  he.third new eve
+000043b0: 6e74 2074 6f20 6120 7374 7265 616d 2074  nt to a stream t
+000043c0: 6861 7420 6861 7320 7477 6f20 7265 636f  hat has two reco
+000043d0: 7264 6564 2065 7665 6e74 732c 2074 6865  rded events, the
+000043e0: 2063 6f72 7265 6374 2076 616c 7565 206f   correct value o
+000043f0: 6620 7468 650a 6065 7870 6563 7465 645f  f the.`expected_
+00004400: 706f 7369 7469 6f6e 6020 6172 6775 6d65  position` argume
+00004410: 6e74 2069 7320 6031 602e 2041 6e64 2073  nt is `1`. And s
+00004420: 6f20 6f6e 2e2e 2e0a 0a49 6620 7468 6572  o on.....If ther
+00004430: 6520 6973 2061 206d 6973 6d61 7463 6820  e is a mismatch 
+00004440: 6265 7477 6565 6e20 7468 6520 6769 7665  between the give
+00004450: 6e20 7661 6c75 6520 6f66 2074 6865 2060  n value of the `
+00004460: 6578 7065 6374 6564 5f70 6f73 6974 696f  expected_positio
+00004470: 6e60 2061 7267 756d 656e 740a 616e 6420  n` argument.and 
+00004480: 7468 6520 706f 7369 7469 6f6e 206f 6620  the position of 
+00004490: 7468 6520 6c61 7374 2072 6563 6f72 6465  the last recorde
+000044a0: 6420 6576 656e 7420 696e 2061 2073 7472  d event in a str
+000044b0: 6561 6d2c 2074 6865 6e20 616e 2060 4578  eam, then an `Ex
+000044c0: 7065 6374 6564 506f 7369 7469 6f6e 4572  pectedPositionEr
+000044d0: 726f 7260 0a65 7863 6570 7469 6f6e 2077  ror`.exception w
+000044e0: 696c 6c20 6265 2072 6169 7365 642e 2054  ill be raised. T
+000044f0: 6869 7320 6566 6665 6374 6976 656c 7920  his effectively 
+00004500: 6163 636f 6d70 6c69 7368 6573 206f 7074  accomplishes opt
+00004510: 696d 6973 7469 6320 636f 6e63 7572 7265  imistic concurre
+00004520: 6e63 7920 636f 6e74 726f 6c2e 0a0a 4966  ncy control...If
+00004530: 2079 6f75 2077 6973 6820 746f 2064 6973   you wish to dis
+00004540: 6162 6c65 206f 7074 696d 6973 7469 6320  able optimistic 
+00004550: 636f 6e63 7572 7265 6e63 7920 636f 6e74  concurrency cont
+00004560: 726f 6c20 7768 656e 2061 7070 656e 6469  rol when appendi
+00004570: 6e67 206e 6577 2065 7665 6e74 732c 2079  ng new events, y
+00004580: 6f75 0a63 616e 2073 6574 2074 6865 2060  ou.can set the `
+00004590: 6578 7065 6374 6564 5f70 6f73 6974 696f  expected_positio
+000045a0: 6e60 2074 6f20 6120 6e65 6761 7469 7665  n` to a negative
+000045b0: 2069 6e74 6567 6572 2e0a 0a49 6620 796f   integer...If yo
+000045c0: 7520 6e65 6564 2074 6f20 6469 7363 6f76  u need to discov
+000045d0: 6572 2074 6865 2063 7572 7265 6e74 2070  er the current p
+000045e0: 6f73 6974 696f 6e20 6f66 2074 6865 206c  osition of the l
+000045f0: 6173 7420 7265 636f 7264 6564 2065 7665  ast recorded eve
+00004600: 6e74 2069 6e20 6120 7374 7265 616d 2c0a  nt in a stream,.
+00004610: 796f 7520 6361 6e20 7573 6520 7468 6520  you can use the 
+00004620: 6067 6574 5f73 7472 6561 6d5f 706f 7369  `get_stream_posi
+00004630: 7469 6f6e 2829 6020 6d65 7468 6f64 2e0a  tion()` method..
+00004640: 0a50 6c65 6173 6520 6e6f 7465 2c20 7468  .Please note, th
+00004650: 6520 6170 7065 6e64 2065 7665 6e74 7320  e append events 
+00004660: 6f70 6572 6174 696f 6e20 6973 2061 746f  operation is ato
+00004670: 6d69 632c 2073 6f20 7468 6174 2065 6974  mic, so that eit
+00004680: 6865 7220 616c 6c0a 6f72 206e 6f6e 6520  her all.or none 
+00004690: 6f66 2074 6865 2067 6976 656e 206e 6577  of the given new
+000046a0: 2065 7665 6e74 7320 7769 6c6c 2062 6520   events will be 
+000046b0: 7265 636f 7264 6564 2e20 4279 2064 6573  recorded. By des
+000046c0: 6967 6e2c 2069 7420 6973 206f 6e6c 790a  ign, it is only.
+000046d0: 706f 7373 6962 6c65 2077 6974 6820 4576  possible with Ev
+000046e0: 656e 7453 746f 7265 4442 2074 6f20 6174  entStoreDB to at
+000046f0: 6f6d 6963 616c 6c79 2072 6563 6f72 6420  omically record 
+00004700: 6e65 7720 6576 656e 7473 2069 6e20 6f6e  new events in on
+00004710: 6520 7374 7265 616d 2e0a 0a49 6e20 7468  e stream...In th
+00004720: 6520 6578 616d 706c 6520 6265 6c6f 772c  e example below,
+00004730: 2061 206e 6577 2065 7665 6e74 2069 7320   a new event is 
+00004740: 6170 7065 6e64 6564 2074 6f20 6120 6e65  appended to a ne
+00004750: 7720 7374 7265 616d 2e0a 0a60 6060 7079  w stream...```py
+00004760: 7468 6f6e 0a66 726f 6d20 7575 6964 2069  thon.from uuid i
+00004770: 6d70 6f72 7420 7575 6964 340a 0a66 726f  mport uuid4..fro
+00004780: 6d20 6573 6462 636c 6965 6e74 2069 6d70  m esdbclient imp
+00004790: 6f72 7420 4e65 7745 7665 6e74 0a0a 2320  ort NewEvent..# 
+000047a0: 436f 6e73 7472 7563 7420 6e65 7720 6576  Construct new ev
+000047b0: 656e 7420 6f62 6a65 6374 2e0a 6576 656e  ent object..even
+000047c0: 7431 203d 204e 6577 4576 656e 7428 7479  t1 = NewEvent(ty
+000047d0: 7065 3d27 4f72 6465 7243 7265 6174 6564  pe='OrderCreated
+000047e0: 272c 2064 6174 613d 6227 6461 7461 3127  ', data=b'data1'
+000047f0: 290a 0a23 2044 6566 696e 6520 7374 7265  )..# Define stre
+00004800: 616d 206e 616d 652e 0a73 7472 6561 6d5f  am name..stream_
+00004810: 6e61 6d65 3120 3d20 7374 7228 7575 6964  name1 = str(uuid
+00004820: 3428 2929 0a0a 2320 4170 7065 6e64 206c  4())..# Append l
+00004830: 6973 7420 6f66 2065 7665 6e74 7320 746f  ist of events to
+00004840: 206e 6577 2073 7472 6561 6d2e 0a63 6f6d   new stream..com
+00004850: 6d69 745f 706f 7369 7469 6f6e 3120 3d20  mit_position1 = 
+00004860: 636c 6965 6e74 2e61 7070 656e 645f 6576  client.append_ev
+00004870: 656e 7473 280a 2020 2020 7374 7265 616d  ents(.    stream
+00004880: 5f6e 616d 653d 7374 7265 616d 5f6e 616d  _name=stream_nam
+00004890: 6531 2c0a 2020 2020 6578 7065 6374 6564  e1,.    expected
+000048a0: 5f70 6f73 6974 696f 6e3d 4e6f 6e65 2c0a  _position=None,.
+000048b0: 2020 2020 6576 656e 7473 3d5b 6576 656e      events=[even
+000048c0: 7431 5d2c 0a29 0a60 6060 0a0a 496e 2074  t1],.).```..In t
+000048d0: 6865 2065 7861 6d70 6c65 2062 656c 6f77  he example below
+000048e0: 2c20 7477 6f20 7375 6273 6571 7565 6e74  , two subsequent
+000048f0: 2065 7665 6e74 7320 6172 6520 6170 7065   events are appe
+00004900: 6e64 6564 2074 6f20 616e 2065 7869 7374  nded to an exist
+00004910: 696e 670a 7374 7265 616d 2e0a 0a60 6060  ing.stream...```
+00004920: 7079 7468 6f6e 0a65 7665 6e74 3220 3d20  python.event2 = 
+00004930: 4e65 7745 7665 6e74 2874 7970 653d 274f  NewEvent(type='O
+00004940: 7264 6572 5570 6461 7465 6427 2c20 6461  rderUpdated', da
+00004950: 7461 3d62 2764 6174 6132 2729 0a65 7665  ta=b'data2').eve
+00004960: 6e74 3320 3d20 4e65 7745 7665 6e74 2874  nt3 = NewEvent(t
+00004970: 7970 653d 274f 7264 6572 4465 6c65 7465  ype='OrderDelete
+00004980: 6427 2c20 6461 7461 3d62 2764 6174 6133  d', data=b'data3
+00004990: 2729 0a0a 636f 6d6d 6974 5f70 6f73 6974  ')..commit_posit
+000049a0: 696f 6e32 203d 2063 6c69 656e 742e 6170  ion2 = client.ap
+000049b0: 7065 6e64 5f65 7665 6e74 7328 0a20 2020  pend_events(.   
+000049c0: 2073 7472 6561 6d5f 6e61 6d65 3d73 7472   stream_name=str
+000049d0: 6561 6d5f 6e61 6d65 312c 0a20 2020 2065  eam_name1,.    e
+000049e0: 7870 6563 7465 645f 706f 7369 7469 6f6e  xpected_position
+000049f0: 3d30 2c0a 2020 2020 6576 656e 7473 3d5b  =0,.    events=[
+00004a00: 6576 656e 7432 2c20 6576 656e 7433 5d2c  event2, event3],
+00004a10: 0a29 0a60 6060 0a0a 4966 2074 6865 206f  .).```..If the o
+00004a20: 7065 7261 7469 6f6e 2069 7320 7375 6363  peration is succ
+00004a30: 6573 7366 756c 2c20 7468 6973 206d 6574  essful, this met
+00004a40: 686f 6420 7265 7475 726e 7320 616e 2069  hod returns an i
+00004a50: 6e74 6567 6572 0a72 6570 7265 7365 6e74  nteger.represent
+00004a60: 696e 6720 7468 6520 6461 7461 6261 7365  ing the database
+00004a70: 2022 636f 6d6d 6974 2070 6f73 6974 696f   "commit positio
+00004a80: 6e22 2061 7320 6974 2077 6173 2077 6865  n" as it was whe
+00004a90: 6e20 7468 6520 6f70 6572 6174 696f 6e0a  n the operation.
+00004aa0: 7761 7320 636f 6d70 6c65 7465 642e 0a0a  was completed...
+00004ab0: 4120 2263 6f6d 6d69 7420 706f 7369 7469  A "commit positi
+00004ac0: 6f6e 2220 6973 2061 206d 6f6e 6f74 6f6e  on" is a monoton
+00004ad0: 6963 616c 6c79 2069 6e63 7265 6173 696e  ically increasin
+00004ae0: 6720 696e 7465 6765 7220 7265 7072 6573  g integer repres
+00004af0: 656e 7469 6e67 0a74 6865 2070 6f73 6974  enting.the posit
+00004b00: 696f 6e20 6f66 2074 6865 2072 6563 6f72  ion of the recor
+00004b10: 6465 6420 6576 656e 7420 696e 2061 2022  ded event in a "
+00004b20: 746f 7461 6c20 6f72 6465 7222 206f 6620  total order" of 
+00004b30: 616c 6c20 7265 636f 7264 6564 0a65 7665  all recorded.eve
+00004b40: 6e74 7320 696e 2074 6865 2064 6174 6162  nts in the datab
+00004b50: 6173 6520 6163 726f 7373 2061 6c6c 2073  ase across all s
+00004b60: 7472 6561 6d73 2e20 4974 2069 7320 7468  treams. It is th
+00004b70: 6520 6163 7475 616c 2070 6f73 6974 696f  e actual positio
+00004b80: 6e0a 6f66 2074 6865 2065 7665 6e74 2072  n.of the event r
+00004b90: 6563 6f72 6420 6f6e 2064 6973 6b2e 2049  ecord on disk. I
+00004ba0: 6e20 636f 6e73 6571 7565 6e63 652c 2074  n consequence, t
+00004bb0: 6865 2073 6571 7565 6e63 6520 6f66 2063  he sequence of c
+00004bc0: 6f6d 6d69 740a 706f 7369 7469 6f6e 7320  ommit.positions 
+00004bd0: 6973 206e 6f74 2067 6170 6c65 7373 2e20  is not gapless. 
+00004be0: 496e 6465 6564 2c20 7468 6572 6520 6172  Indeed, there ar
+00004bf0: 6520 7573 7561 6c6c 7920 6c61 7267 6520  e usually large 
+00004c00: 6469 6666 6572 656e 6365 730a 6265 7477  differences.betw
+00004c10: 6565 6e20 7468 6520 636f 6d6d 6974 2070  een the commit p
+00004c20: 6f73 6974 696f 6e73 206f 6620 7375 6363  ositions of succ
+00004c30: 6573 7369 7665 2072 6563 6f72 6465 6420  essive recorded 
+00004c40: 6576 656e 7473 2e0a 0a54 6865 2022 636f  events...The "co
+00004c50: 6d6d 6974 2070 6f73 6974 696f 6e22 2072  mmit position" r
+00004c60: 6574 7572 6e65 6420 6279 2060 6170 7065  eturned by `appe
+00004c70: 6e64 5f65 7665 6e74 7328 2960 2069 7320  nd_events()` is 
+00004c80: 7468 6174 206f 6620 7468 6520 6c61 7374  that of the last
+00004c90: 0a72 6563 6f72 6465 6420 6576 656e 7420  .recorded event 
+00004ca0: 696e 2074 6865 2067 6976 656e 2062 6174  in the given bat
+00004cb0: 6368 206f 6620 6e65 7720 6576 656e 7473  ch of new events
+00004cc0: 2e0a 0a54 6865 2022 636f 6d6d 6974 2070  ...The "commit p
+00004cd0: 6f73 6974 696f 6e22 2072 6574 7572 6e65  osition" returne
+00004ce0: 6420 696e 2074 6869 7320 7761 7920 6361  d in this way ca
+00004cf0: 6e20 7468 6572 6566 6f72 6520 6265 2075  n therefore be u
+00004d00: 7365 6420 746f 2077 6169 740a 666f 7220  sed to wait.for 
+00004d10: 6120 646f 776e 7374 7265 616d 2063 6f6d  a downstream com
+00004d20: 706f 6e65 6e74 2074 6f20 6861 7665 2070  ponent to have p
+00004d30: 726f 6365 7373 6564 2061 6c6c 2074 6865  rocessed all the
+00004d40: 2065 7665 6e74 7320 7468 6174 2077 6572   events that wer
+00004d50: 6520 7265 636f 7264 6564 2e0a 0a46 6f72  e recorded...For
+00004d60: 2065 7861 6d70 6c65 2c20 636f 6e73 6964   example, consid
+00004d70: 6572 2061 2075 7365 7220 696e 7465 7266  er a user interf
+00004d80: 6163 6520 636f 6d6d 616e 6420 7468 6174  ace command that
+00004d90: 2072 6573 756c 7473 2069 6e20 7468 6520   results in the 
+00004da0: 7265 636f 7264 696e 670a 6f66 206e 6577  recording.of new
+00004db0: 2065 7665 6e74 732c 2061 6e64 2061 2071   events, and a q
+00004dc0: 7565 7279 2069 6e74 6f20 616e 2065 7665  uery into an eve
+00004dd0: 6e74 7561 6c6c 7920 636f 6e73 6973 7465  ntually consiste
+00004de0: 6e74 206d 6174 6572 6961 6c69 7a65 640a  nt materialized.
+00004df0: 7669 6577 2069 6e20 6120 646f 776e 7374  view in a downst
+00004e00: 7265 616d 2063 6f6d 706f 6e65 6e74 2074  ream component t
+00004e10: 6861 7420 6973 2075 7064 6174 6564 2066  hat is updated f
+00004e20: 726f 6d20 7468 6573 6520 6576 656e 7473  rom these events
+00004e30: 2e20 4966 2074 6865 206e 6577 0a65 7665  . If the new.eve
+00004e40: 6e74 7320 6861 7665 206e 6f74 2079 6574  nts have not yet
+00004e50: 2062 6565 6e20 7072 6f63 6573 7365 642c   been processed,
+00004e60: 2074 6865 2076 6965 7720 776f 756c 6420   the view would 
+00004e70: 6265 2073 7461 6c65 2e20 5468 6520 2263  be stale. The "c
+00004e80: 6f6d 6d69 7420 706f 7369 7469 6f6e 220a  ommit position".
+00004e90: 6361 6e20 6265 2075 7365 6420 6279 2074  can be used by t
+00004ea0: 6865 2075 7365 7220 696e 7465 7266 6163  he user interfac
+00004eb0: 6520 746f 2070 6f6c 6c20 7468 6520 646f  e to poll the do
+00004ec0: 776e 7374 7265 616d 2063 6f6d 706f 6e65  wnstream compone
+00004ed0: 6e74 2075 6e74 696c 2069 7420 6861 730a  nt until it has.
+00004ee0: 7072 6f63 6573 7365 6420 7468 6f73 6520  processed those 
+00004ef0: 6e65 7720 6576 656e 7473 2c20 6166 7465  new events, afte
+00004f00: 7220 7768 6963 6820 7469 6d65 2074 6865  r which time the
+00004f10: 2076 6965 7720 7769 6c6c 206e 6f74 2062   view will not b
+00004f20: 6520 7374 616c 652e 0a0a 0a23 2323 2041  e stale....### A
+00004f30: 7070 656e 6420 6576 656e 740a 0a2a 7265  ppend event..*re
+00004f40: 7175 6972 6573 206c 6561 6465 722a 0a0a  quires leader*..
+00004f50: 5468 6520 6061 7070 656e 645f 6576 656e  The `append_even
+00004f60: 7428 2960 206d 6574 686f 6420 6361 6e20  t()` method can 
+00004f70: 6265 2075 7365 6420 746f 2077 7269 7465  be used to write
+00004f80: 2061 2073 696e 676c 6520 6e65 7720 6576   a single new ev
+00004f90: 656e 7420 746f 2061 2073 7472 6561 6d2e  ent to a stream.
+00004fa0: 0a0a 5468 7265 6520 6172 6775 6d65 6e74  ..Three argument
+00004fb0: 7320 6172 6520 7265 7175 6972 6564 2c20  s are required, 
+00004fc0: 6073 7472 6561 6d5f 6e61 6d65 602c 2060  `stream_name`, `
+00004fd0: 6578 7065 6374 6564 5f70 6f73 6974 696f  expected_positio
+00004fe0: 6e60 2061 6e64 2060 6576 656e 7460 2e0a  n` and `event`..
+00004ff0: 0a54 6869 7320 6d65 7468 6f64 2077 6f72  .This method wor
+00005000: 6b73 2069 6e20 7468 6520 7361 6d65 2077  ks in the same w
+00005010: 6179 2061 7320 6061 7070 656e 645f 6576  ay as `append_ev
+00005020: 656e 7473 2829 602c 2068 6f77 6576 6572  ents()`, however
+00005030: 2060 6576 656e 7460 2069 7320 6578 7065   `event` is expe
+00005040: 6374 6564 0a74 6f20 6265 2061 2073 696e  cted.to be a sin
+00005050: 676c 6520 604e 6577 4576 656e 7460 2e0a  gle `NewEvent`..
+00005060: 0a54 6869 7320 6d65 7468 6f64 2074 616b  .This method tak
+00005070: 6573 2061 6e20 6f70 7469 6f6e 616c 2060  es an optional `
+00005080: 7469 6d65 6f75 7460 2061 7267 756d 656e  timeout` argumen
+00005090: 742c 2077 6869 6368 2069 7320 6120 5079  t, which is a Py
+000050a0: 7468 6f6e 2060 666c 6f61 7460 2074 6861  thon `float` tha
+000050b0: 7420 7365 7473 0a61 2064 6561 646c 696e  t sets.a deadlin
+000050c0: 6520 666f 7220 7468 6520 636f 6d70 6c65  e for the comple
+000050d0: 7469 6f6e 206f 6620 7468 6520 6752 5043  tion of the gRPC
+000050e0: 206f 7065 7261 7469 6f6e 2e0a 0a49 6620   operation...If 
+000050f0: 7468 6520 6f70 6572 6174 696f 6e20 6973  the operation is
+00005100: 2073 7563 6365 7373 6675 6c2c 2074 6869   successful, thi
+00005110: 7320 6d65 7468 6f64 2072 6574 7572 6e73  s method returns
+00005120: 2061 6e20 696e 7465 6765 720a 7265 7072   an integer.repr
+00005130: 6573 656e 7469 6e67 2074 6865 2064 6174  esenting the dat
+00005140: 6162 6173 6520 2263 6f6d 6d69 7420 706f  abase "commit po
+00005150: 7369 7469 6f6e 2220 6173 2069 7420 7761  sition" as it wa
+00005160: 7320 7768 656e 2074 6865 206f 7065 7261  s when the opera
+00005170: 7469 6f6e 0a77 6173 2063 6f6d 706c 6574  tion.was complet
+00005180: 6564 2e0a 0a53 696e 6365 2074 6865 2068  ed...Since the h
+00005190: 616e 646c 696e 6720 6f66 2061 2063 6f6d  andling of a com
+000051a0: 6d61 6e64 2069 6e20 796f 7572 2061 7070  mand in your app
+000051b0: 6c69 6361 7469 6f6e 206d 6179 2072 6573  lication may res
+000051c0: 756c 7420 696e 206f 6e65 206f 7220 6d61  ult in one or ma
+000051d0: 6e79 0a6e 6577 2065 7665 6e74 732c 2061  ny.new events, a
+000051e0: 6e64 2074 6865 2072 6573 756c 7473 206f  nd the results o
+000051f0: 6620 6861 6e64 6c69 6e67 2061 2063 6f6d  f handling a com
+00005200: 6d61 6e64 2073 686f 756c 6420 6265 2072  mand should be r
+00005210: 6563 6f72 6465 6420 6174 6f6d 6963 616c  ecorded atomical
+00005220: 6c79 2c0a 616e 6420 7468 6520 7772 6974  ly,.and the writ
+00005230: 696e 6720 6f66 206e 6577 2065 7665 6e74  ing of new event
+00005240: 7320 6765 6e65 7261 7465 6420 6279 2061  s generated by a
+00005250: 2063 6f6d 6d61 6e64 2068 616e 646c 6572   command handler
+00005260: 2069 7320 7573 7561 6c6c 7920 6120 636f   is usually a co
+00005270: 6e63 6572 6e0a 7468 6174 2069 7320 6661  ncern.that is fa
+00005280: 6374 6f72 6564 206f 7574 2061 6e64 2075  ctored out and u
+00005290: 7365 6420 6576 6572 7977 6865 7265 2069  sed everywhere i
+000052a0: 6e20 6120 7072 6f6a 6563 742c 2069 7420  n a project, it 
+000052b0: 6973 206d 6f72 6520 7573 7561 6c20 696e  is more usual in
+000052c0: 2061 2070 726f 6a65 6374 0a74 6f20 7573   a project.to us
+000052d0: 6520 6061 7070 656e 645f 6576 656e 7473  e `append_events
+000052e0: 2829 6020 746f 2072 6563 6f72 6420 6e65  ()` to record ne
+000052f0: 7720 6576 656e 7473 2e20 486f 7765 7665  w events. Howeve
+00005300: 722c 2074 6869 7320 6d65 7468 6f64 206d  r, this method m
+00005310: 6179 206f 6363 6173 696f 6e61 6c6c 790a  ay occasionally.
+00005320: 6265 2075 7365 6675 6c2c 2061 6e64 2069  be useful, and i
+00005330: 6e64 6565 6420 6974 2069 7320 7573 6564  ndeed it is used
+00005340: 2062 7920 6073 6574 5f73 7472 6561 6d5f   by `set_stream_
+00005350: 6d65 7461 6461 7461 2829 602e 0a0a 0a23  metadata()`....#
+00005360: 2323 2049 6465 6d70 6f74 656e 7420 6170  ## Idempotent ap
+00005370: 7065 6e64 206f 7065 7261 7469 6f6e 730a  pend operations.
+00005380: 0a53 6f6d 6574 696d 6573 2069 7420 6d61  .Sometimes it ma
+00005390: 7920 6861 7070 656e 2074 6861 742c 2077  y happen that, w
+000053a0: 6865 6e20 6361 6c6c 696e 6720 6061 7070  hen calling `app
+000053b0: 656e 645f 6576 656e 7473 2829 6020 6f72  end_events()` or
+000053c0: 2060 6170 7065 6e64 5f65 7665 6e74 2829   `append_event()
+000053d0: 602c 0a74 6865 206e 6577 2065 7665 6e74  `,.the new event
+000053e0: 7320 6172 6520 7375 6363 6573 7366 756c  s are successful
+000053f0: 6c79 2072 6563 6f72 6465 642c 2062 7574  ly recorded, but
+00005400: 2074 6865 6e20 736f 6d65 686f 7720 7468   then somehow th
+00005410: 6520 636f 6e6e 6563 7469 6f6e 2074 6f20  e connection to 
+00005420: 7468 650a 6461 7461 6261 7365 2067 6574  the.database get
+00005430: 7320 696e 7465 7272 7570 7465 6420 6265  s interrupted be
+00005440: 666f 7265 2074 6865 2073 7563 6365 7373  fore the success
+00005450: 6675 6c20 6361 6c6c 2063 616e 2072 6574  ful call can ret
+00005460: 7572 6e20 7375 6363 6573 7366 756c 6c79  urn successfully
+00005470: 2074 6f0a 7468 6520 636c 6965 6e74 2e20   to.the client. 
+00005480: 496e 2063 6173 6520 6f66 2061 6e20 6572  In case of an er
+00005490: 726f 7220 7768 656e 2061 7070 656e 6469  ror when appendi
+000054a0: 6e67 2061 6e20 6576 656e 742c 2069 7420  ng an event, it 
+000054b0: 6973 2064 6573 6972 6162 6c65 2074 6f0a  is desirable to.
+000054c0: 7265 7472 7920 6170 7065 6e64 696e 6720  retry appending 
+000054d0: 7468 6520 7361 6d65 2065 7665 6e74 2061  the same event a
+000054e0: 7420 7468 6520 7361 6d65 2070 6f73 6974  t the same posit
+000054f0: 696f 6e2e 2049 6620 7468 6520 6576 656e  ion. If the even
+00005500: 7420 7761 7320 696e 2066 6163 740a 7375  t was in fact.su
+00005510: 6363 6573 7366 756c 6c79 2072 6563 6f72  ccessfully recor
+00005520: 6465 642c 2069 7420 6973 2063 6f6e 7665  ded, it is conve
+00005530: 6e69 656e 7420 666f 7220 7468 6520 7265  nient for the re
+00005540: 7472 6965 6420 6f70 6572 6174 696f 6e20  tried operation 
+00005550: 746f 2072 6574 7572 6e0a 7375 6363 6573  to return.succes
+00005560: 7366 756c 6c79 2077 6974 686f 7574 2072  sfully without r
+00005570: 6169 7369 6e67 2061 6e20 6572 726f 7220  aising an error 
+00005580: 6475 6520 746f 206f 7074 696d 6973 7469  due to optimisti
+00005590: 6320 636f 6e63 7572 7265 6e63 7920 636f  c concurrency co
+000055a0: 6e74 726f 6c0a 2861 7320 6465 7363 7269  ntrol.(as descri
+000055b0: 6265 6420 6162 6f76 6529 2e0a 0a54 6865  bed above)...The
+000055c0: 2065 7861 6d70 6c65 2062 656c 6f77 2073   example below s
+000055d0: 686f 7773 2074 6865 2060 6170 7065 6e64  hows the `append
+000055e0: 5f65 7665 6e74 7328 2960 206d 6574 686f  _events()` metho
+000055f0: 6420 6265 696e 6720 6361 6c6c 6564 2061  d being called a
+00005600: 6761 696e 2077 6974 680a 6065 7665 6e74  gain with.`event
+00005610: 3360 2061 6e64 2060 6578 7065 6374 6564  3` and `expected
+00005620: 5f70 6f73 6974 696f 6e3d 3260 2e20 5765  _position=2`. We
+00005630: 2063 616e 2073 6565 2074 6861 7420 7265   can see that re
+00005640: 7065 6174 696e 6720 7468 6520 6361 6c6c  peating the call
+00005650: 2074 6f0a 6061 7070 656e 645f 6576 656e   to.`append_even
+00005660: 7473 2829 6020 7265 7475 726e 7320 7375  ts()` returns su
+00005670: 6363 6573 7366 756c 6c79 2e0a 0a60 6060  ccessfully...```
+00005680: 7079 7468 6f6e 0a23 2052 6574 7279 2061  python.# Retry a
+00005690: 7070 656e 6469 6e67 2065 7665 6e74 332e  ppending event3.
+000056a0: 0a63 6f6d 6d69 745f 706f 7369 7469 6f6e  .commit_position
+000056b0: 5f72 6574 7279 203d 2063 6c69 656e 742e  _retry = client.
+000056c0: 6170 7065 6e64 5f65 7665 6e74 7328 0a20  append_events(. 
+000056d0: 2020 2073 7472 6561 6d5f 6e61 6d65 3d73     stream_name=s
+000056e0: 7472 6561 6d5f 6e61 6d65 312c 0a20 2020  tream_name1,.   
+000056f0: 2065 7870 6563 7465 645f 706f 7369 7469   expected_positi
+00005700: 6f6e 3d30 2c0a 2020 2020 6576 656e 7473  on=0,.    events
+00005710: 3d5b 6576 656e 7432 2c20 6576 656e 7433  =[event2, event3
+00005720: 5d2c 0a29 0a60 6060 0a0a 5765 2063 616e  ],.).```..We can
+00005730: 2073 6565 2074 6861 7420 7468 6520 7361   see that the sa
+00005740: 6d65 2063 6f6d 6d69 7420 706f 7369 7469  me commit positi
+00005750: 6f6e 2069 7320 7265 7475 726e 6564 2061  on is returned a
+00005760: 7320 6162 6f76 652e 0a0a 6060 6070 7974  s above...```pyt
+00005770: 686f 6e0a 6173 7365 7274 2063 6f6d 6d69  hon.assert commi
+00005780: 745f 706f 7369 7469 6f6e 5f72 6574 7279  t_position_retry
+00005790: 203d 3d20 636f 6d6d 6974 5f70 6f73 6974   == commit_posit
+000057a0: 696f 6e32 0a60 6060 0a0a 4279 2063 616c  ion2.```..By cal
+000057b0: 6c69 6e67 2060 7265 6164 5f73 7472 6561  ling `read_strea
+000057c0: 6d5f 6576 656e 7473 2829 602c 2077 6520  m_events()`, we 
+000057d0: 6361 6e20 616c 736f 2073 6565 2074 6865  can also see the
+000057e0: 2073 7472 6561 6d20 6861 7320 6265 656e   stream has been
+000057f0: 2075 6e63 6861 6e67 6564 0a64 6573 7069   unchanged.despi
+00005800: 7465 2074 6865 2060 6170 7065 6e64 5f65  te the `append_e
+00005810: 7665 6e74 7328 2960 206d 6574 686f 6420  vents()` method 
+00005820: 6861 7669 6e67 2062 6565 6e20 6361 6c6c  having been call
+00005830: 6564 2074 7769 6365 2077 6974 6820 7468  ed twice with th
+00005840: 6520 7361 6d65 2061 7267 756d 656e 7473  e same arguments
+00005850: 2e0a 5468 6174 2069 732c 2074 6865 7265  ..That is, there
+00005860: 2061 7265 2073 7469 6c6c 206f 6e6c 7920   are still only 
+00005870: 7468 7265 6520 6576 656e 7473 2069 6e20  three events in 
+00005880: 7468 6520 7374 7265 616d 2e0a 0a60 6060  the stream...```
+00005890: 7079 7468 6f6e 0a65 7665 6e74 7320 3d20  python.events = 
+000058a0: 636c 6965 6e74 2e72 6561 645f 7374 7265  client.read_stre
+000058b0: 616d 5f65 7665 6e74 7328 0a20 2020 2073  am_events(.    s
+000058c0: 7472 6561 6d5f 6e61 6d65 3d73 7472 6561  tream_name=strea
+000058d0: 6d5f 6e61 6d65 310a 290a 0a61 7373 6572  m_name1.)..asser
+000058e0: 7420 6c65 6e28 6576 656e 7473 2920 3d3d  t len(events) ==
+000058f0: 2033 0a60 6060 0a0a 5468 6973 2069 6465   3.```..This ide
+00005900: 6d70 6f74 656e 7420 6265 6861 7669 6f75  mpotent behaviou
+00005910: 7220 6973 2061 6374 6976 6174 6564 2062  r is activated b
+00005920: 6563 6175 7365 2074 6865 2060 4e65 7745  ecause the `NewE
+00005930: 7665 6e74 6020 636c 6173 7320 6861 7320  vent` class has 
+00005940: 616e 2060 6964 600a 6174 7472 6962 7574  an `id`.attribut
+00005950: 6520 7468 6174 2c20 6279 2064 6566 6175  e that, by defau
+00005960: 6c74 2c20 6973 2061 7373 6967 6e65 6420  lt, is assigned 
+00005970: 6120 6e65 7720 616e 6420 756e 6971 7565  a new and unique
+00005980: 2076 6572 7369 6f6e 2d34 2055 5549 4420   version-4 UUID 
+00005990: 7768 656e 2061 6e0a 696e 7374 616e 6365  when an.instance
+000059a0: 206f 6620 604e 6577 4576 656e 7460 2069   of `NewEvent` i
+000059b0: 7320 636f 6e73 7472 7563 7465 642e 2049  s constructed. I
+000059c0: 6620 6576 656e 7473 2077 6974 6820 7468  f events with th
+000059d0: 6520 7361 6d65 2060 6964 6020 6172 6520  e same `id` are 
+000059e0: 6170 7065 6e64 6564 0a61 7420 7468 6520  appended.at the 
+000059f0: 7361 6d65 2060 6578 7065 6374 6564 5f70  same `expected_p
+00005a00: 6f73 6974 696f 6e60 2c20 7468 6520 7374  osition`, the st
+00005a10: 7265 616d 2077 696c 6c20 6265 2075 6e63  ream will be unc
+00005a20: 6861 6e67 6564 2c20 7468 6520 6f70 6572  hanged, the oper
+00005a30: 6174 696f 6e20 7769 6c6c 0a63 6f6d 706c  ation will.compl
+00005a40: 6574 6520 7375 6363 6573 7366 756c 6c79  ete successfully
+00005a50: 2c20 616e 6420 7468 6520 7361 6d65 2063  , and the same c
+00005a60: 6f6d 6d69 7420 706f 7369 7469 6f6e 2077  ommit position w
+00005a70: 696c 6c20 6265 2072 6574 7572 6e65 6420  ill be returned 
+00005a80: 746f 2074 6865 2063 616c 6c65 722e 0a0a  to the caller...
+00005a90: 6060 6070 7974 686f 6e0a 6672 6f6d 2075  ```python.from u
+00005aa0: 7569 6420 696d 706f 7274 2055 5549 440a  uid import UUID.
+00005ab0: 0a0a 6173 7365 7274 2069 7369 6e73 7461  ..assert isinsta
+00005ac0: 6e63 6528 6576 656e 7431 2e69 642c 2055  nce(event1.id, U
+00005ad0: 5549 4429 0a61 7373 6572 7420 6973 696e  UID).assert isin
+00005ae0: 7374 616e 6365 2865 7665 6e74 322e 6964  stance(event2.id
+00005af0: 2c20 5555 4944 290a 6173 7365 7274 2069  , UUID).assert i
+00005b00: 7369 6e73 7461 6e63 6528 6576 656e 7433  sinstance(event3
+00005b10: 2e69 642c 2055 5549 4429 0a0a 6173 7365  .id, UUID)..asse
+00005b20: 7274 2065 7665 6e74 312e 6964 2021 3d20  rt event1.id != 
+00005b30: 6576 656e 7432 2e69 640a 6173 7365 7274  event2.id.assert
+00005b40: 2065 7665 6e74 322e 6964 2021 3d20 6576   event2.id != ev
+00005b50: 656e 7433 2e69 640a 0a61 7373 6572 7420  ent3.id..assert 
+00005b60: 6576 656e 7473 5b30 5d2e 6964 203d 3d20  events[0].id == 
+00005b70: 6576 656e 7431 2e69 640a 6173 7365 7274  event1.id.assert
+00005b80: 2065 7665 6e74 735b 315d 2e69 6420 3d3d   events[1].id ==
+00005b90: 2065 7665 6e74 322e 6964 0a61 7373 6572   event2.id.asser
+00005ba0: 7420 6576 656e 7473 5b32 5d2e 6964 203d  t events[2].id =
+00005bb0: 3d20 6576 656e 7433 2e69 640a 6060 600a  = event3.id.```.
+00005bc0: 0a49 7420 6973 2070 6f73 7369 626c 6520  .It is possible 
+00005bd0: 746f 2073 6574 2074 6865 2060 6964 6020  to set the `id` 
+00005be0: 636f 6e73 7472 7563 746f 7220 6172 6775  constructor argu
+00005bf0: 6d65 6e74 206f 6620 604e 6577 4576 656e  ment of `NewEven
+00005c00: 7460 2077 6865 6e20 696e 7374 616e 7469  t` when instanti
+00005c10: 6174 696e 670a 7468 6520 604e 6577 4576  ating.the `NewEv
+00005c20: 656e 7460 2063 6c61 7373 2c20 6275 7420  ent` class, but 
+00005c30: 696e 2074 6865 2065 7861 6d70 6c65 7320  in the examples 
+00005c40: 6162 6f76 6520 7765 2068 6176 6520 6265  above we have be
+00005c50: 656e 2075 7369 6e67 2074 6865 2064 6566  en using the def
+00005c60: 6175 6c74 0a62 6568 6176 696f 7572 2c20  ault.behaviour, 
+00005c70: 7768 6963 6820 6973 2074 6861 7420 7468  which is that th
+00005c80: 6520 6069 6460 2076 616c 7565 2069 7320  e `id` value is 
+00005c90: 6765 6e65 7261 7465 6420 7768 656e 2074  generated when t
+00005ca0: 6865 2060 4e65 7745 7665 6e74 6020 636c  he `NewEvent` cl
+00005cb0: 6173 7320 6973 0a69 6e73 7461 6e74 6961  ass is.instantia
+00005cc0: 7465 642e 0a0a 0a23 2323 2052 6561 6420  ted....### Read 
+00005cd0: 7374 7265 616d 2065 7665 6e74 730a 0a54  stream events..T
+00005ce0: 6865 2060 7265 6164 5f73 7472 6561 6d5f  he `read_stream_
+00005cf0: 6576 656e 7473 2829 6020 6d65 7468 6f64  events()` method
+00005d00: 2063 616e 2062 6520 7573 6564 2074 6f20   can be used to 
+00005d10: 6f62 7461 696e 2074 6865 2072 6563 6f72  obtain the recor
+00005d20: 6465 6420 6576 656e 7473 2069 6e20 610a  ded events in a.
+00005d30: 7374 7265 616d 2e20 4974 2072 6574 7572  stream. It retur
+00005d40: 6e73 2061 2073 6571 7565 6e63 6520 6f66  ns a sequence of
+00005d50: 2072 6563 6f72 6465 6420 6576 656e 7473   recorded events
+00005d60: 206f 626a 6563 7473 2e20 5468 6520 7265   objects. The re
+00005d70: 6365 6976 6564 2072 6563 6f72 6465 6420  ceived recorded 
+00005d80: 6576 656e 740a 6f62 6a65 6374 2061 7265  event.object are
+00005d90: 2069 6e73 7461 6e63 6573 206f 6620 7468   instances of th
+00005da0: 6520 6052 6563 6f72 6465 6445 7665 6e74  e `RecordedEvent
+00005db0: 6020 636c 6173 7320 2873 6565 2074 6865  ` class (see the
+00005dc0: 204e 6f74 6573 2073 6563 7469 6f6e 2062   Notes section b
+00005dd0: 656c 6f77 2066 6f72 0a64 6574 6169 6c73  elow for.details
+00005de0: 206f 6620 7468 6973 2063 6c61 7373 292e   of this class).
+00005df0: 0a0a 5468 6973 206d 6574 686f 6420 6861  ..This method ha
+00005e00: 7320 6f6e 6520 7265 7175 6972 6564 2061  s one required a
+00005e10: 7267 756d 656e 742c 2060 7374 7265 616d  rgument, `stream
+00005e20: 5f6e 616d 6560 2c20 7768 6963 6820 6973  _name`, which is
+00005e30: 2074 6865 206e 616d 6520 6f66 0a74 6865   the name of.the
+00005e40: 2073 7472 6561 6d20 6672 6f6d 2077 6869   stream from whi
+00005e50: 6368 2074 6f20 7265 6164 2065 7665 6e74  ch to read event
+00005e60: 732e 2042 7920 6465 6661 756c 742c 2074  s. By default, t
+00005e70: 6865 2072 6563 6f72 6465 6420 6576 656e  he recorded even
+00005e80: 7473 2069 6e20 7468 650a 7374 7265 616d  ts in the.stream
+00005e90: 2061 7265 2072 6574 7572 6e65 6420 696e   are returned in
+00005ea0: 2074 6865 206f 7264 6572 2074 6865 7920   the order they 
+00005eb0: 7765 7265 2072 6563 6f72 6465 642e 0a0a  were recorded...
+00005ec0: 5468 6520 6d65 7468 6f64 2060 7265 6164  The method `read
+00005ed0: 5f73 7472 6561 6d5f 6576 656e 7473 2829  _stream_events()
+00005ee0: 6020 616c 736f 2073 7570 706f 7274 7320  ` also supports 
+00005ef0: 666f 7572 206f 7074 696f 6e61 6c20 6172  four optional ar
+00005f00: 6775 6d65 6e74 732c 0a60 7374 7265 616d  guments,.`stream
+00005f10: 5f70 6f73 6974 696f 6e60 2c20 6062 6163  _position`, `bac
+00005f20: 6b77 6172 6473 602c 2060 6c69 6d69 7460  kwards`, `limit`
+00005f30: 2c20 616e 6420 6074 696d 656f 7574 602e  , and `timeout`.
+00005f40: 0a0a 5468 6520 6f70 7469 6f6e 616c 2060  ..The optional `
+00005f50: 7374 7265 616d 5f70 6f73 6974 696f 6e60  stream_position`
+00005f60: 2061 7267 756d 656e 7420 6973 2061 6e20   argument is an 
+00005f70: 6f70 7469 6f6e 616c 2069 6e74 6567 6572  optional integer
+00005f80: 2074 6861 7420 6361 6e20 6265 2075 7365   that can be use
+00005f90: 6420 746f 0a69 6e64 6963 6174 6520 7468  d to.indicate th
+00005fa0: 6520 706f 7369 7469 6f6e 2069 6e20 7468  e position in th
+00005fb0: 6520 7374 7265 616d 2066 726f 6d20 7768  e stream from wh
+00005fc0: 6963 6820 746f 2073 7461 7274 2072 6561  ich to start rea
+00005fd0: 6469 6e67 2e20 5468 6973 2061 7267 756d  ding. This argum
+00005fe0: 656e 7420 6973 0a60 4e6f 6e65 6020 6279  ent is.`None` by
+00005ff0: 2064 6566 6175 6c74 2c20 7768 6963 6820   default, which 
+00006000: 6d65 616e 7320 7468 6520 7374 7265 616d  means the stream
+00006010: 2077 696c 6c20 6265 2072 6561 6420 6569   will be read ei
+00006020: 7468 6572 2066 726f 6d20 7468 6520 7374  ther from the st
+00006030: 6172 7420 6f66 2074 6865 0a73 7472 6561  art of the.strea
+00006040: 6d20 2874 6865 2064 6566 6175 6c74 2062  m (the default b
+00006050: 6568 6176 696f 7572 292c 206f 7220 6672  ehaviour), or fr
+00006060: 6f6d 2074 6865 2065 6e64 206f 6620 7468  om the end of th
+00006070: 6520 7374 7265 616d 2069 6620 6062 6163  e stream if `bac
+00006080: 6b77 6172 6473 6020 6973 0a60 5472 7565  kwards` is.`True
+00006090: 602e 2057 6865 6e20 7265 6164 696e 6720  `. When reading 
+000060a0: 6120 7374 7265 616d 2066 726f 6d20 6120  a stream from a 
+000060b0: 7370 6563 6966 6963 2070 6f73 6974 696f  specific positio
+000060c0: 6e20 696e 2074 6865 2073 7472 6561 6d2c  n in the stream,
+000060d0: 2074 6865 0a72 6563 6f72 6465 6420 6576   the.recorded ev
+000060e0: 656e 7420 6174 2074 6861 7420 706f 7369  ent at that posi
+000060f0: 7469 6f6e 2077 696c 6c20 6265 2069 6e63  tion will be inc
+00006100: 6c75 6465 642c 2062 6f74 6820 7768 656e  luded, both when
+00006110: 2072 6561 6469 6e67 2066 6f72 7761 7264   reading forward
+00006120: 730a 6672 6f6d 2074 6861 7420 706f 7369  s.from that posi
+00006130: 7469 6f6e 2c20 616e 6420 7768 656e 2072  tion, and when r
+00006140: 6561 6469 6e67 2062 6163 6b77 6172 6473  eading backwards
+00006150: 2066 726f 6d20 7468 6174 2070 6f73 6974   from that posit
+00006160: 696f 6e2e 0a0a 5468 6520 6f70 7469 6f6e  ion...The option
+00006170: 616c 2060 6261 636b 7761 7264 7360 2061  al `backwards` a
+00006180: 7267 756d 656e 7420 6973 2061 2050 7974  rgument is a Pyt
+00006190: 686f 6e20 6062 6f6f 6c60 2e20 5468 6520  hon `bool`. The 
+000061a0: 6465 6661 756c 7420 6973 2060 4661 6c73  default is `Fals
+000061b0: 6560 2c20 7768 6963 680a 6d65 616e 7320  e`, which.means 
+000061c0: 7468 6520 7374 7265 616d 2077 696c 6c20  the stream will 
+000061d0: 6265 2072 6561 6420 666f 7277 6172 6473  be read forwards
+000061e0: 2062 7920 6465 6661 756c 742c 2073 6f20   by default, so 
+000061f0: 7468 6174 2065 7665 6e74 7320 6172 6520  that events are 
+00006200: 7265 7475 726e 6564 2069 6e20 7468 650a  returned in the.
+00006210: 6f72 6465 7220 7468 6579 2077 6572 6520  order they were 
+00006220: 6170 7065 6e64 6564 2c20 4966 2060 6261  appended, If `ba
+00006230: 636b 7761 7264 7360 2069 7320 6054 7275  ckwards` is `Tru
+00006240: 6560 2c20 7468 6520 6576 656e 7473 2061  e`, the events a
+00006250: 7265 2072 6574 7572 6e65 6420 696e 2072  re returned in r
+00006260: 6576 6572 7365 0a6f 7264 6572 2e0a 0a54  everse.order...T
+00006270: 6865 206f 7074 696f 6e61 6c20 606c 696d  he optional `lim
+00006280: 6974 6020 6172 6775 6d65 6e74 2069 7320  it` argument is 
+00006290: 616e 2069 6e74 6567 6572 2077 6869 6368  an integer which
+000062a0: 2072 6573 7472 6963 7473 2074 6865 206e   restricts the n
+000062b0: 756d 6265 7220 6f66 2065 7665 6e74 7320  umber of events 
+000062c0: 7468 6174 0a77 696c 6c20 6265 2072 6574  that.will be ret
+000062d0: 7572 6e65 642e 2054 6865 2064 6566 6175  urned. The defau
+000062e0: 6c74 2076 616c 7565 2069 7320 6073 7973  lt value is `sys
+000062f0: 2e6d 6178 696e 7460 2e0a 0a54 6865 206f  .maxint`...The o
+00006300: 7074 696f 6e61 6c20 6074 696d 656f 7574  ptional `timeout
+00006310: 6020 6172 6775 6d65 6e74 2069 7320 6120  ` argument is a 
+00006320: 5079 7468 6f6e 2060 666c 6f61 7460 2077  Python `float` w
+00006330: 6869 6368 2073 6574 7320 6120 6465 6164  hich sets a dead
+00006340: 6c69 6e65 2066 6f72 0a74 6865 2063 6f6d  line for.the com
+00006350: 706c 6574 696f 6e20 6f66 2074 6865 2067  pletion of the g
+00006360: 5250 4320 6f70 6572 6174 696f 6e2e 0a0a  RPC operation...
+00006370: 5468 6520 6578 616d 706c 6520 6265 6c6f  The example belo
+00006380: 7720 7368 6f77 7320 686f 7720 746f 2072  w shows how to r
+00006390: 6561 6420 7468 6520 7265 636f 7264 6564  ead the recorded
+000063a0: 2065 7665 6e74 7320 6f66 2061 2073 7472   events of a str
+000063b0: 6561 6d0a 666f 7277 6172 6473 2066 726f  eam.forwards fro
+000063c0: 6d20 7468 6520 7374 6172 7420 6f66 2074  m the start of t
+000063d0: 6865 2073 7472 6561 6d20 746f 2074 6865  he stream to the
+000063e0: 2065 6e64 206f 6620 7468 6520 7374 7265   end of the stre
+000063f0: 616d 2e20 5468 650a 6e61 6d65 206f 6620  am. The.name of 
+00006400: 6120 7374 7265 616d 2069 7320 6769 7665  a stream is give
+00006410: 6e20 7768 656e 2063 616c 6c69 6e67 2074  n when calling t
+00006420: 6865 206d 6574 686f 642e 0a0a 6060 6070  he method...```p
+00006430: 7974 686f 6e0a 6576 656e 7473 203d 2063  ython.events = c
+00006440: 6c69 656e 742e 7265 6164 5f73 7472 6561  lient.read_strea
+00006450: 6d5f 6576 656e 7473 280a 2020 2020 7374  m_events(.    st
+00006460: 7265 616d 5f6e 616d 653d 7374 7265 616d  ream_name=stream
+00006470: 5f6e 616d 6531 0a29 0a60 6060 0a0a 4e6f  _name1.).```..No
+00006480: 7720 7468 6174 2077 6520 6861 7665 2061  w that we have a
+00006490: 2073 6571 7565 6e63 6520 6f66 2065 7665   sequence of eve
+000064a0: 6e74 206f 626a 6563 7473 2c20 7765 2063  nt objects, we c
+000064b0: 616e 2063 6865 636b 2077 6520 676f 7420  an check we got 
+000064c0: 7468 650a 7468 7265 6520 6576 656e 7473  the.three events
+000064d0: 2074 6861 7420 7765 7265 2061 7070 656e   that were appen
+000064e0: 6465 6420 746f 2074 6865 2073 7472 6561  ded to the strea
+000064f0: 6d2c 2061 6e64 2074 6861 7420 7468 6579  m, and that they
+00006500: 2061 7265 0a6f 7264 6572 6564 2065 7861   are.ordered exa
+00006510: 6374 6c79 2061 7320 7468 6579 2077 6572  ctly as they wer
+00006520: 6520 6170 7065 6e64 6564 2e0a 0a60 6060  e appended...```
+00006530: 7079 7468 6f6e 0a61 7373 6572 7420 6c65  python.assert le
+00006540: 6e28 6576 656e 7473 2920 3d3d 2033 0a0a  n(events) == 3..
+00006550: 6173 7365 7274 2065 7665 6e74 735b 305d  assert events[0]
+00006560: 2e73 7472 6561 6d5f 6e61 6d65 203d 3d20  .stream_name == 
+00006570: 7374 7265 616d 5f6e 616d 6531 0a61 7373  stream_name1.ass
+00006580: 6572 7420 6576 656e 7473 5b30 5d2e 7374  ert events[0].st
+00006590: 7265 616d 5f70 6f73 6974 696f 6e20 3d3d  ream_position ==
+000065a0: 2030 0a61 7373 6572 7420 6576 656e 7473   0.assert events
+000065b0: 5b30 5d2e 7479 7065 203d 3d20 6576 656e  [0].type == even
+000065c0: 7431 2e74 7970 650a 6173 7365 7274 2065  t1.type.assert e
+000065d0: 7665 6e74 735b 305d 2e64 6174 6120 3d3d  vents[0].data ==
+000065e0: 2065 7665 6e74 312e 6461 7461 0a0a 6173   event1.data..as
+000065f0: 7365 7274 2065 7665 6e74 735b 315d 2e73  sert events[1].s
+00006600: 7472 6561 6d5f 6e61 6d65 203d 3d20 7374  tream_name == st
+00006610: 7265 616d 5f6e 616d 6531 0a61 7373 6572  ream_name1.asser
+00006620: 7420 6576 656e 7473 5b31 5d2e 7374 7265  t events[1].stre
+00006630: 616d 5f70 6f73 6974 696f 6e20 3d3d 2031  am_position == 1
+00006640: 0a61 7373 6572 7420 6576 656e 7473 5b31  .assert events[1
+00006650: 5d2e 7479 7065 203d 3d20 6576 656e 7432  ].type == event2
+00006660: 2e74 7970 650a 6173 7365 7274 2065 7665  .type.assert eve
+00006670: 6e74 735b 315d 2e64 6174 6120 3d3d 2065  nts[1].data == e
+00006680: 7665 6e74 322e 6461 7461 0a0a 6173 7365  vent2.data..asse
+00006690: 7274 2065 7665 6e74 735b 325d 2e73 7472  rt events[2].str
+000066a0: 6561 6d5f 6e61 6d65 203d 3d20 7374 7265  eam_name == stre
+000066b0: 616d 5f6e 616d 6531 0a61 7373 6572 7420  am_name1.assert 
+000066c0: 6576 656e 7473 5b32 5d2e 7374 7265 616d  events[2].stream
+000066d0: 5f70 6f73 6974 696f 6e20 3d3d 2032 0a61  _position == 2.a
+000066e0: 7373 6572 7420 6576 656e 7473 5b32 5d2e  ssert events[2].
+000066f0: 7479 7065 203d 3d20 6576 656e 7433 2e74  type == event3.t
+00006700: 7970 650a 6173 7365 7274 2065 7665 6e74  ype.assert event
+00006710: 735b 325d 2e64 6174 6120 3d3d 2065 7665  s[2].data == eve
+00006720: 6e74 332e 6461 7461 0a60 6060 0a0a 5468  nt3.data.```..Th
+00006730: 6520 6578 616d 706c 6520 6265 6c6f 7720  e example below 
+00006740: 7368 6f77 7320 686f 7720 746f 2072 6561  shows how to rea
+00006750: 6420 7265 636f 7264 6564 2065 7665 6e74  d recorded event
+00006760: 7320 696e 2061 2073 7472 6561 6d20 666f  s in a stream fo
+00006770: 7277 6172 6473 2066 726f 6d0a 6120 7370  rwards from.a sp
+00006780: 6563 6966 6963 2073 7472 6561 6d20 706f  ecific stream po
+00006790: 7369 7469 6f6e 2074 6f20 7468 6520 656e  sition to the en
+000067a0: 6420 6f66 2074 6865 2073 7472 6561 6d2e  d of the stream.
+000067b0: 0a0a 6060 6070 7974 686f 6e0a 6576 656e  ..```python.even
+000067c0: 7473 203d 2063 6c69 656e 742e 7265 6164  ts = client.read
+000067d0: 5f73 7472 6561 6d5f 6576 656e 7473 280a  _stream_events(.
+000067e0: 2020 2020 7374 7265 616d 5f6e 616d 653d      stream_name=
+000067f0: 7374 7265 616d 5f6e 616d 6531 2c0a 2020  stream_name1,.  
+00006800: 2020 7374 7265 616d 5f70 6f73 6974 696f    stream_positio
+00006810: 6e3d 312c 0a29 0a0a 6173 7365 7274 206c  n=1,.)..assert l
+00006820: 656e 2865 7665 6e74 7329 203d 3d20 320a  en(events) == 2.
+00006830: 0a61 7373 6572 7420 6576 656e 7473 5b30  .assert events[0
+00006840: 5d2e 7374 7265 616d 5f6e 616d 6520 3d3d  ].stream_name ==
+00006850: 2073 7472 6561 6d5f 6e61 6d65 310a 6173   stream_name1.as
+00006860: 7365 7274 2065 7665 6e74 735b 305d 2e73  sert events[0].s
+00006870: 7472 6561 6d5f 706f 7369 7469 6f6e 203d  tream_position =
+00006880: 3d20 310a 6173 7365 7274 2065 7665 6e74  = 1.assert event
+00006890: 735b 305d 2e74 7970 6520 3d3d 2065 7665  s[0].type == eve
+000068a0: 6e74 322e 7479 7065 0a61 7373 6572 7420  nt2.type.assert 
+000068b0: 6576 656e 7473 5b30 5d2e 6461 7461 203d  events[0].data =
+000068c0: 3d20 6576 656e 7432 2e64 6174 610a 0a61  = event2.data..a
+000068d0: 7373 6572 7420 6576 656e 7473 5b31 5d2e  ssert events[1].
+000068e0: 7374 7265 616d 5f6e 616d 6520 3d3d 2073  stream_name == s
+000068f0: 7472 6561 6d5f 6e61 6d65 310a 6173 7365  tream_name1.asse
+00006900: 7274 2065 7665 6e74 735b 315d 2e73 7472  rt events[1].str
+00006910: 6561 6d5f 706f 7369 7469 6f6e 203d 3d20  eam_position == 
+00006920: 320a 6173 7365 7274 2065 7665 6e74 735b  2.assert events[
+00006930: 315d 2e74 7970 6520 3d3d 2065 7665 6e74  1].type == event
+00006940: 332e 7479 7065 0a61 7373 6572 7420 6576  3.type.assert ev
+00006950: 656e 7473 5b31 5d2e 6461 7461 203d 3d20  ents[1].data == 
+00006960: 6576 656e 7433 2e64 6174 610a 6060 600a  event3.data.```.
+00006970: 0a54 6865 2065 7861 6d70 6c65 2062 656c  .The example bel
+00006980: 6f77 2073 686f 7773 2068 6f77 2074 6f20  ow shows how to 
+00006990: 7265 6164 2074 6865 2072 6563 6f72 6465  read the recorde
+000069a0: 6420 6576 656e 7473 2069 6e20 6120 7374  d events in a st
+000069b0: 7265 616d 2062 6163 6b77 6172 6473 2066  ream backwards f
+000069c0: 726f 6d0a 7468 6520 656e 6420 6f66 2074  rom.the end of t
+000069d0: 6865 2073 7472 6561 6d20 746f 2074 6865  he stream to the
+000069e0: 2073 7461 7274 206f 6620 7468 6520 7374   start of the st
+000069f0: 7265 616d 2e0a 0a60 6060 7079 7468 6f6e  ream...```python
+00006a00: 0a65 7665 6e74 7320 3d20 636c 6965 6e74  .events = client
+00006a10: 2e72 6561 645f 7374 7265 616d 5f65 7665  .read_stream_eve
+00006a20: 6e74 7328 0a20 2020 2073 7472 6561 6d5f  nts(.    stream_
+00006a30: 6e61 6d65 3d73 7472 6561 6d5f 6e61 6d65  name=stream_name
+00006a40: 312c 0a20 2020 2062 6163 6b77 6172 6473  1,.    backwards
+00006a50: 3d54 7275 652c 0a29 0a0a 6173 7365 7274  =True,.)..assert
+00006a60: 206c 656e 2865 7665 6e74 7329 203d 3d20   len(events) == 
+00006a70: 330a 0a61 7373 6572 7420 6576 656e 7473  3..assert events
+00006a80: 5b30 5d2e 7374 7265 616d 5f6e 616d 6520  [0].stream_name 
+00006a90: 3d3d 2073 7472 6561 6d5f 6e61 6d65 310a  == stream_name1.
+00006aa0: 6173 7365 7274 2065 7665 6e74 735b 305d  assert events[0]
+00006ab0: 2e73 7472 6561 6d5f 706f 7369 7469 6f6e  .stream_position
+00006ac0: 203d 3d20 320a 6173 7365 7274 2065 7665   == 2.assert eve
+00006ad0: 6e74 735b 305d 2e74 7970 6520 3d3d 2065  nts[0].type == e
+00006ae0: 7665 6e74 332e 7479 7065 0a61 7373 6572  vent3.type.asser
+00006af0: 7420 6576 656e 7473 5b30 5d2e 6461 7461  t events[0].data
+00006b00: 203d 3d20 6576 656e 7433 2e64 6174 610a   == event3.data.
+00006b10: 0a61 7373 6572 7420 6576 656e 7473 5b31  .assert events[1
+00006b20: 5d2e 7374 7265 616d 5f6e 616d 6520 3d3d  ].stream_name ==
+00006b30: 2073 7472 6561 6d5f 6e61 6d65 310a 6173   stream_name1.as
+00006b40: 7365 7274 2065 7665 6e74 735b 315d 2e73  sert events[1].s
+00006b50: 7472 6561 6d5f 706f 7369 7469 6f6e 203d  tream_position =
+00006b60: 3d20 310a 6173 7365 7274 2065 7665 6e74  = 1.assert event
+00006b70: 735b 315d 2e74 7970 6520 3d3d 2065 7665  s[1].type == eve
+00006b80: 6e74 322e 7479 7065 0a61 7373 6572 7420  nt2.type.assert 
+00006b90: 6576 656e 7473 5b31 5d2e 6461 7461 203d  events[1].data =
+00006ba0: 3d20 6576 656e 7432 2e64 6174 610a 6060  = event2.data.``
+00006bb0: 600a 0a54 6865 2065 7861 6d70 6c65 2062  `..The example b
+00006bc0: 656c 6f77 2073 686f 7773 2068 6f77 2074  elow shows how t
+00006bd0: 6f20 7265 6164 2061 206c 696d 6974 6564  o read a limited
+00006be0: 206e 756d 6265 7220 2874 776f 2920 6f66   number (two) of
+00006bf0: 2074 6865 2072 6563 6f72 6465 6420 6576   the recorded ev
+00006c00: 656e 7473 0a69 6e20 6120 7374 7265 616d  ents.in a stream
+00006c10: 2066 6f72 7761 7264 7320 6672 6f6d 2074   forwards from t
+00006c20: 6865 2073 7461 7274 206f 6620 7468 6520  he start of the 
+00006c30: 7374 7265 616d 2e0a 0a60 6060 7079 7468  stream...```pyth
+00006c40: 6f6e 0a65 7665 6e74 7320 3d20 636c 6965  on.events = clie
+00006c50: 6e74 2e72 6561 645f 7374 7265 616d 5f65  nt.read_stream_e
+00006c60: 7665 6e74 7328 0a20 2020 2073 7472 6561  vents(.    strea
+00006c70: 6d5f 6e61 6d65 3d73 7472 6561 6d5f 6e61  m_name=stream_na
+00006c80: 6d65 312c 0a20 2020 206c 696d 6974 3d32  me1,.    limit=2
+00006c90: 2c0a 290a 0a61 7373 6572 7420 6c65 6e28  ,.)..assert len(
+00006ca0: 6576 656e 7473 2920 3d3d 2032 0a0a 6173  events) == 2..as
+00006cb0: 7365 7274 2065 7665 6e74 735b 305d 2e73  sert events[0].s
+00006cc0: 7472 6561 6d5f 6e61 6d65 203d 3d20 7374  tream_name == st
+00006cd0: 7265 616d 5f6e 616d 6531 0a61 7373 6572  ream_name1.asser
+00006ce0: 7420 6576 656e 7473 5b30 5d2e 7374 7265  t events[0].stre
+00006cf0: 616d 5f70 6f73 6974 696f 6e20 3d3d 2030  am_position == 0
+00006d00: 0a61 7373 6572 7420 6576 656e 7473 5b30  .assert events[0
+00006d10: 5d2e 7479 7065 203d 3d20 6576 656e 7431  ].type == event1
+00006d20: 2e74 7970 650a 6173 7365 7274 2065 7665  .type.assert eve
+00006d30: 6e74 735b 305d 2e64 6174 6120 3d3d 2065  nts[0].data == e
+00006d40: 7665 6e74 312e 6461 7461 0a0a 6173 7365  vent1.data..asse
+00006d50: 7274 2065 7665 6e74 735b 315d 2e73 7472  rt events[1].str
+00006d60: 6561 6d5f 6e61 6d65 203d 3d20 7374 7265  eam_name == stre
+00006d70: 616d 5f6e 616d 6531 0a61 7373 6572 7420  am_name1.assert 
+00006d80: 6576 656e 7473 5b31 5d2e 7374 7265 616d  events[1].stream
+00006d90: 5f70 6f73 6974 696f 6e20 3d3d 2031 0a61  _position == 1.a
+00006da0: 7373 6572 7420 6576 656e 7473 5b31 5d2e  ssert events[1].
+00006db0: 7479 7065 203d 3d20 6576 656e 7432 2e74  type == event2.t
+00006dc0: 7970 650a 6173 7365 7274 2065 7665 6e74  ype.assert event
+00006dd0: 735b 315d 2e64 6174 6120 3d3d 2065 7665  s[1].data == eve
+00006de0: 6e74 322e 6461 7461 0a60 6060 0a0a 5468  nt2.data.```..Th
+00006df0: 6520 6578 616d 706c 6520 6265 6c6f 7720  e example below 
+00006e00: 7368 6f77 7320 686f 7720 746f 2072 6561  shows how to rea
+00006e10: 6420 6120 6c69 6d69 7465 6420 6e75 6d62  d a limited numb
+00006e20: 6572 2028 6f6e 6529 206f 6620 7468 6520  er (one) of the 
+00006e30: 7265 636f 7264 6564 0a65 7665 6e74 7320  recorded.events 
+00006e40: 696e 2061 2073 7472 6561 6d20 6261 636b  in a stream back
+00006e50: 7761 7264 7320 6672 6f6d 2061 2067 6976  wards from a giv
+00006e60: 656e 2073 7472 6561 6d20 706f 7369 7469  en stream positi
+00006e70: 6f6e 2e0a 0a60 6060 7079 7468 6f6e 0a65  on...```python.e
+00006e80: 7665 6e74 7320 3d20 636c 6965 6e74 2e72  vents = client.r
+00006e90: 6561 645f 7374 7265 616d 5f65 7665 6e74  ead_stream_event
+00006ea0: 7328 0a20 2020 2073 7472 6561 6d5f 6e61  s(.    stream_na
+00006eb0: 6d65 3d73 7472 6561 6d5f 6e61 6d65 312c  me=stream_name1,
+00006ec0: 0a20 2020 2073 7472 6561 6d5f 706f 7369  .    stream_posi
+00006ed0: 7469 6f6e 3d32 2c0a 2020 2020 6261 636b  tion=2,.    back
+00006ee0: 7761 7264 733d 5472 7565 2c0a 2020 2020  wards=True,.    
+00006ef0: 6c69 6d69 743d 312c 0a29 0a0a 6173 7365  limit=1,.)..asse
+00006f00: 7274 206c 656e 2865 7665 6e74 7329 203d  rt len(events) =
+00006f10: 3d20 310a 0a61 7373 6572 7420 6576 656e  = 1..assert even
+00006f20: 7473 5b30 5d2e 7374 7265 616d 5f6e 616d  ts[0].stream_nam
+00006f30: 6520 3d3d 2073 7472 6561 6d5f 6e61 6d65  e == stream_name
+00006f40: 310a 6173 7365 7274 2065 7665 6e74 735b  1.assert events[
+00006f50: 305d 2e73 7472 6561 6d5f 706f 7369 7469  0].stream_positi
+00006f60: 6f6e 203d 3d20 320a 6173 7365 7274 2065  on == 2.assert e
+00006f70: 7665 6e74 735b 305d 2e74 7970 6520 3d3d  vents[0].type ==
+00006f80: 2065 7665 6e74 332e 7479 7065 0a61 7373   event3.type.ass
+00006f90: 6572 7420 6576 656e 7473 5b30 5d2e 6461  ert events[0].da
+00006fa0: 7461 203d 3d20 6576 656e 7433 2e64 6174  ta == event3.dat
+00006fb0: 610a 6060 600a 0a54 6865 2060 7265 6164  a.```..The `read
+00006fc0: 5f73 7472 6561 6d5f 6576 656e 7473 2829  _stream_events()
+00006fd0: 6020 6d65 7468 6f64 2077 696c 6c20 7261  ` method will ra
+00006fe0: 6973 6520 6120 604e 6f74 466f 756e 6460  ise a `NotFound`
+00006ff0: 2065 7863 6570 7469 6f6e 2069 6620 7468   exception if th
+00007000: 6520 7374 7265 616d 0a64 6f65 7320 6e6f  e stream.does no
+00007010: 7420 6578 6973 742e 0a0a 6060 6070 7974  t exist...```pyt
+00007020: 686f 6e0a 6672 6f6d 2065 7364 6263 6c69  hon.from esdbcli
+00007030: 656e 742e 6578 6365 7074 696f 6e73 2069  ent.exceptions i
+00007040: 6d70 6f72 7420 4e6f 7446 6f75 6e64 0a0a  mport NotFound..
+00007050: 0a74 7279 3a0a 2020 2020 636c 6965 6e74  .try:.    client
+00007060: 2e72 6561 645f 7374 7265 616d 5f65 7665  .read_stream_eve
+00007070: 6e74 7328 276e 6f74 2d61 2d73 7472 6561  nts('not-a-strea
+00007080: 6d27 290a 6578 6365 7074 204e 6f74 466f  m').except NotFo
+00007090: 756e 643a 0a20 2020 2070 6173 7320 2023  und:.    pass  #
+000070a0: 2054 6865 2073 7472 6561 6d20 276e 6f74   The stream 'not
+000070b0: 2d61 2d73 7472 6561 6d27 2064 6f65 7320  -a-stream' does 
+000070c0: 6e6f 7420 6578 6973 742e 0a65 6c73 653a  not exist..else:
+000070d0: 0a20 2020 2072 6169 7365 2045 7863 6570  .    raise Excep
+000070e0: 7469 6f6e 2822 5368 6f75 6c64 6e27 7420  tion("Shouldn't 
+000070f0: 6765 7420 6865 7265 2229 0a60 6060 0a0a  get here").```..
+00007100: 2323 2320 486f 7720 746f 2069 6d70 6c65  ### How to imple
+00007110: 6d65 6e74 2073 6e61 7073 686f 7474 696e  ment snapshottin
+00007120: 6720 7769 7468 2045 7665 6e74 5374 6f72  g with EventStor
+00007130: 6544 420a 0a45 7665 6e74 2d73 6f75 7263  eDB..Event-sourc
+00007140: 6564 2061 6767 7265 6761 7465 7320 6172  ed aggregates ar
+00007150: 6520 7479 7069 6361 6c6c 7920 7265 636f  e typically reco
+00007160: 6e73 7472 7563 7465 6420 6672 6f6d 2072  nstructed from r
+00007170: 6563 6f72 6465 6420 6576 656e 7473 2062  ecorded events b
+00007180: 7920 6361 6c6c 696e 670a 6120 6d75 7461  y calling.a muta
+00007190: 746f 7220 6675 6e63 7469 6f6e 2066 6f72  tor function for
+000071a0: 2065 6163 6820 7265 636f 7264 6564 2065   each recorded e
+000071b0: 7665 6e74 2c20 6576 6f6c 7669 6e67 2066  vent, evolving f
+000071c0: 726f 6d20 616e 2069 6e69 7469 616c 2073  rom an initial s
+000071d0: 7461 7465 0a60 4e6f 6e65 6020 746f 2074  tate.`None` to t
+000071e0: 6865 2063 7572 7265 6e74 2073 7461 7465  he current state
+000071f0: 206f 6620 7468 6520 6167 6772 6567 6174   of the aggregat
+00007200: 652e 2054 6865 2066 756e 6374 696f 6e20  e. The function 
+00007210: 6067 6574 5f61 6767 7265 6761 7465 2829  `get_aggregate()
+00007220: 6020 7368 6f77 730a 686f 7720 7468 6973  ` shows.how this
+00007230: 2063 616e 2062 6520 646f 6e65 2e20 5468   can be done. Th
+00007240: 6520 6167 6772 6567 6174 6520 4944 2069  e aggregate ID i
+00007250: 7320 7573 6564 2061 7320 6120 7374 7265  s used as a stre
+00007260: 616d 206e 616d 652e 2054 6865 2065 7863  am name. The exc
+00007270: 6570 7469 6f6e 0a60 4167 6772 6567 6174  eption.`Aggregat
+00007280: 654e 6f74 466f 756e 6460 2069 7320 7261  eNotFound` is ra
+00007290: 6973 6564 2069 6620 7468 6520 6167 6772  ised if the aggr
+000072a0: 6567 6174 6520 7374 7265 616d 2069 7320  egate stream is 
+000072b0: 6e6f 7420 666f 756e 642e 0a0a 6060 6070  not found...```p
+000072c0: 7974 686f 6e0a 6465 6620 6765 745f 6167  ython.def get_ag
+000072d0: 6772 6567 6174 6528 6167 6772 6567 6174  gregate(aggregat
+000072e0: 655f 6964 2c20 6d75 7461 746f 725f 6675  e_id, mutator_fu
+000072f0: 6e63 293a 0a20 2020 2073 7472 6561 6d5f  nc):.    stream_
+00007300: 6e61 6d65 203d 2061 6767 7265 6761 7465  name = aggregate
+00007310: 5f69 640a 0a20 2020 2023 2047 6574 2072  _id..    # Get r
+00007320: 6563 6f72 6465 6420 6576 656e 7473 2e0a  ecorded events..
+00007330: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
+00007340: 2065 7665 6e74 7320 3d20 636c 6965 6e74   events = client
+00007350: 2e72 6561 645f 7374 7265 616d 5f65 7665  .read_stream_eve
+00007360: 6e74 7328 0a20 2020 2020 2020 2020 2020  nts(.           
+00007370: 2073 7472 6561 6d5f 6e61 6d65 3d73 7472   stream_name=str
+00007380: 6561 6d5f 6e61 6d65 2c0a 2020 2020 2020  eam_name,.      
+00007390: 2020 2020 2020 7374 7265 616d 5f70 6f73        stream_pos
+000073a0: 6974 696f 6e3d 4e6f 6e65 0a20 2020 2020  ition=None.     
+000073b0: 2020 2029 0a20 2020 2065 7863 6570 7420     ).    except 
+000073c0: 4e6f 7446 6f75 6e64 2061 7320 653a 0a20  NotFound as e:. 
+000073d0: 2020 2020 2020 2072 6169 7365 2041 6767         raise Agg
+000073e0: 7265 6761 7465 4e6f 7446 6f75 6e64 2861  regateNotFound(a
+000073f0: 6767 7265 6761 7465 5f69 6429 2066 726f  ggregate_id) fro
+00007400: 6d20 650a 2020 2020 656c 7365 3a0a 2020  m e.    else:.  
+00007410: 2020 2020 2020 2320 5265 636f 6e73 7472        # Reconstr
+00007420: 7563 7420 6167 6772 6567 6174 6520 6672  uct aggregate fr
+00007430: 6f6d 2072 6563 6f72 6465 6420 6576 656e  om recorded even
+00007440: 7473 2e0a 2020 2020 2020 2020 6167 6772  ts..        aggr
+00007450: 6567 6174 6520 3d20 4e6f 6e65 0a20 2020  egate = None.   
+00007460: 2020 2020 2066 6f72 2065 7665 6e74 2069       for event i
+00007470: 6e20 6576 656e 7473 3a0a 2020 2020 2020  n events:.      
+00007480: 2020 2020 2020 6167 6772 6567 6174 6520        aggregate 
+00007490: 3d20 6d75 7461 746f 725f 6675 6e63 2861  = mutator_func(a
+000074a0: 6767 7265 6761 7465 2c20 6576 656e 7429  ggregate, event)
+000074b0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+000074c0: 6167 6772 6567 6174 650a 0a0a 636c 6173  aggregate...clas
+000074d0: 7320 4167 6772 6567 6174 654e 6f74 466f  s AggregateNotFo
+000074e0: 756e 6428 4578 6365 7074 696f 6e29 3a0a  und(Exception):.
+000074f0: 2020 2020 2222 2252 6169 7365 6420 7768      """Raised wh
+00007500: 656e 2061 6e20 6167 6772 6567 6174 6520  en an aggregate 
+00007510: 6973 206e 6f74 2066 6f75 6e64 2e22 2222  is not found."""
+00007520: 0a60 6060 0a0a 536e 6170 7368 6f74 7320  .```..Snapshots 
+00007530: 6361 6e20 696d 7072 6f76 6520 7468 6520  can improve the 
+00007540: 7065 7266 6f72 6d61 6e63 6520 6f66 2061  performance of a
+00007550: 6767 7265 6761 7465 7320 7468 6174 2077  ggregates that w
+00007560: 6f75 6c64 206f 7468 6572 7769 7365 2062  ould otherwise b
+00007570: 650a 7265 636f 6e73 7472 7563 7465 6420  e.reconstructed 
+00007580: 6672 6f6d 2076 6572 7920 6c6f 6e67 2073  from very long s
+00007590: 7472 6561 6d73 2e20 486f 7765 7665 722c  treams. However,
+000075a0: 2069 7420 6973 2067 656e 6572 616c 6c79   it is generally
+000075b0: 2072 6563 6f6d 6d65 6e64 6564 2074 6f0a   recommended to.
+000075c0: 6465 7369 676e 2061 6767 7265 6761 7465  design aggregate
+000075d0: 7320 746f 2068 6176 6520 6120 6669 6e69  s to have a fini
+000075e0: 7465 206c 6966 6563 7963 6c65 2c20 616e  te lifecycle, an
+000075f0: 6420 6865 6e63 6520 7265 6c61 7469 7665  d hence relative
+00007600: 6c79 2073 686f 7274 2073 7472 6561 6d73  ly short streams
+00007610: 2c0a 7468 6572 6562 7920 6176 6f69 6469  ,.thereby avoidi
+00007620: 6e67 2074 6865 206e 6565 6420 666f 7220  ng the need for 
+00007630: 736e 6170 7368 6f74 7469 6e67 2e20 5468  snapshotting. Th
+00007640: 6973 2022 686f 7720 746f 2220 7365 6374  is "how to" sect
+00007650: 696f 6e20 6973 2069 6e74 656e 6465 640a  ion is intended.
+00007660: 6d65 7265 6c79 2074 6f20 7368 6f77 2068  merely to show h
+00007670: 6f77 2073 6e61 7073 686f 7474 696e 6720  ow snapshotting 
+00007680: 6f66 2061 6767 7265 6761 7465 7320 6361  of aggregates ca
+00007690: 6e20 6265 2069 6d70 6c65 6d65 6e74 6564  n be implemented
+000076a0: 2077 6974 6820 4576 656e 7453 746f 7265   with EventStore
+000076b0: 4442 0a75 7369 6e67 2074 6869 7320 5079  DB.using this Py
+000076c0: 7468 6f6e 2063 6c69 656e 742e 0a0a 536e  thon client...Sn
+000076d0: 6170 7368 6f74 7469 6e67 206f 6620 6167  apshotting of ag
+000076e0: 6772 6567 6174 6573 2063 616e 2062 6520  gregates can be 
+000076f0: 696d 706c 656d 656e 7465 6420 6279 2072  implemented by r
+00007700: 6563 6f72 6469 6e67 2074 6865 2063 7572  ecording the cur
+00007710: 7265 6e74 2073 7461 7465 206f 660a 616e  rent state of.an
+00007720: 2061 6767 7265 6761 7465 2061 7320 6120   aggregate as a 
+00007730: 6e65 7720 6576 656e 742e 0a0a 4966 2061  new event...If a
+00007740: 6e20 6167 6772 6567 6174 6520 6f62 6a65  n aggregate obje
+00007750: 6374 2068 6173 2061 2076 6572 7369 6f6e  ct has a version
+00007760: 206e 756d 6265 7220 7468 6174 2063 6f72   number that cor
+00007770: 7265 7370 6f6e 6473 2074 6f20 7468 6520  responds to the 
+00007780: 7374 7265 616d 2070 6f73 6974 696f 6e20  stream position 
+00007790: 6f66 0a74 6865 206c 6173 7420 6576 656e  of.the last even
+000077a0: 7420 7468 6174 2077 6173 2075 7365 6420  t that was used 
+000077b0: 746f 2072 6563 6f6e 7374 7275 6374 2074  to reconstruct t
+000077c0: 6865 2061 6767 7265 6761 7465 2c20 616e  he aggregate, an
+000077d0: 6420 7468 6973 2076 6572 7369 6f6e 206e  d this version n
+000077e0: 756d 6265 720a 6973 2072 6563 6f72 6465  umber.is recorde
+000077f0: 6420 696e 2074 6865 2073 6e61 7073 686f  d in the snapsho
+00007800: 7420 6d65 7461 6461 7461 2c20 7468 656e  t metadata, then
+00007810: 2061 6e79 2065 7665 6e74 7320 7468 6174   any events that
+00007820: 2061 7265 2072 6563 6f72 6465 6420 6166   are recorded af
+00007830: 7465 7220 7468 650a 736e 6170 7368 6f74  ter the.snapshot
+00007840: 2063 616e 2062 6520 7365 6c65 6374 6564   can be selected
+00007850: 2075 7369 6e67 2074 6869 7320 7665 7273   using this vers
+00007860: 696f 6e20 6e75 6d62 6572 2e20 5468 6520  ion number. The 
+00007870: 6167 6772 6567 6174 6520 6361 6e20 7468  aggregate can th
+00007880: 656e 2062 650a 7265 636f 6e73 7472 7563  en be.reconstruc
+00007890: 7465 6420 6672 6f6d 2074 6865 206c 6173  ted from the las
+000078a0: 7420 736e 6170 7368 6f74 2061 6e64 2061  t snapshot and a
+000078b0: 6e79 2073 7562 7365 7175 656e 7420 6576  ny subsequent ev
+000078c0: 656e 7473 2c20 7769 7468 6f75 7420 6861  ents, without ha
+000078d0: 7669 6e67 0a74 6f20 7265 706c 6179 2074  ving.to replay t
+000078e0: 6865 2065 6e74 6972 6520 6869 7374 6f72  he entire histor
+000078f0: 792e 0a0a 5765 2077 696c 6c20 7573 6520  y...We will use 
+00007900: 6120 7365 7061 7261 7465 2073 7472 6561  a separate strea
+00007910: 6d20 666f 7220 616e 2061 6767 7265 6761  m for an aggrega
+00007920: 7465 2773 2073 6e61 7073 686f 7473 2074  te's snapshots t
+00007930: 6861 7420 6973 206e 616d 6564 2061 6674  hat is named aft
+00007940: 6572 2074 6865 0a73 7472 6561 6d20 7573  er the.stream us
+00007950: 6564 2066 6f72 2072 6563 6f72 6469 6e67  ed for recording
+00007960: 2069 7473 2065 7665 6e74 732e 2054 6865   its events. The
+00007970: 206e 616d 6520 6f66 2074 6865 2073 6e61   name of the sna
+00007980: 7073 686f 7420 7374 7265 616d 2077 696c  pshot stream wil
+00007990: 6c20 6265 0a63 6f6e 7374 7275 6374 6564  l be.constructed
+000079a0: 2062 7920 7072 6566 6978 696e 6720 7468   by prefixing th
+000079b0: 6520 6167 6772 6567 6174 6527 7320 7374  e aggregate's st
+000079c0: 7265 616d 206e 616d 6520 7769 7468 2060  ream name with `
+000079d0: 2724 736e 6170 7368 6f74 2d27 602e 0a0a  '$snapshot-'`...
+000079e0: 6060 6070 7974 686f 6e0a 534e 4150 5348  ```python.SNAPSH
+000079f0: 4f54 5f50 5245 4649 5820 3d20 2724 736e  OT_PREFIX = '$sn
+00007a00: 6170 7368 6f74 2d27 0a0a 6465 6620 6d61  apshot-'..def ma
+00007a10: 6b65 5f73 6e61 7073 686f 745f 7374 7265  ke_snapshot_stre
+00007a20: 616d 5f6e 616d 6528 7374 7265 616d 5f6e  am_name(stream_n
+00007a30: 616d 6529 3a0a 2020 2020 7265 7475 726e  ame):.    return
+00007a40: 2066 277b 534e 4150 5348 4f54 5f50 5245   f'{SNAPSHOT_PRE
+00007a50: 4649 587d 7b73 7472 6561 6d5f 6e61 6d65  FIX}{stream_name
+00007a60: 7d27 0a0a 0a64 6566 2073 7472 6970 5f73  }'...def strip_s
+00007a70: 6e61 7073 686f 745f 7374 7265 616d 5f6e  napshot_stream_n
+00007a80: 616d 6528 736e 6170 7368 6f74 5f73 7472  ame(snapshot_str
+00007a90: 6561 6d5f 6e61 6d65 293a 0a20 2020 2072  eam_name):.    r
+00007aa0: 6574 7572 6e20 736e 6170 7368 6f74 5f73  eturn snapshot_s
+00007ab0: 7472 6561 6d5f 6e61 6d65 2e6c 7374 7269  tream_name.lstri
+00007ac0: 7028 534e 4150 5348 4f54 5f50 5245 4649  p(SNAPSHOT_PREFI
+00007ad0: 5829 0a60 6060 0a0a 4c65 7427 7320 7265  X).```..Let's re
+00007ae0: 6465 6669 6e65 2074 6865 2060 6765 745f  define the `get_
+00007af0: 6167 6772 6567 6174 6528 2960 2066 756e  aggregate()` fun
+00007b00: 6374 696f 6e2c 2073 6f20 7468 6174 2069  ction, so that i
+00007b10: 7420 6c6f 6f6b 7320 666f 7220 6120 736e  t looks for a sn
+00007b20: 6170 7368 6f74 2065 7665 6e74 2c0a 7468  apshot event,.th
+00007b30: 656e 2073 656c 6563 7473 2073 7562 7365  en selects subse
+00007b40: 7175 656e 7420 6167 6772 6567 6174 6520  quent aggregate 
+00007b50: 6576 656e 7473 2c20 616e 6420 7468 656e  events, and then
+00007b60: 2063 616c 6c73 2061 206d 7574 6174 6f72   calls a mutator
+00007b70: 2066 756e 6374 696f 6e20 666f 7220 6561   function for ea
+00007b80: 6368 0a72 6563 6f72 6465 6420 6576 656e  ch.recorded even
+00007b90: 742e 2057 6520 7769 6c6c 2075 7365 204a  t. We will use J
+00007ba0: 534f 4e20 746f 2073 6572 6961 6c69 7a65  SON to serialize
+00007bb0: 2061 6e64 2064 6573 6572 6961 6c69 7a65   and deserialize
+00007bc0: 2050 7974 686f 6e20 6064 6963 7460 206f   Python `dict` o
+00007bd0: 626a 6563 7473 2e0a 0a4e 6f74 6963 6520  bjects...Notice 
+00007be0: 7468 6174 2074 6865 2061 6767 7265 6761  that the aggrega
+00007bf0: 7465 2065 7665 6e74 7320 6172 6520 7265  te events are re
+00007c00: 6164 2066 726f 6d20 6120 7374 7265 616d  ad from a stream
+00007c10: 2066 6f72 2061 6767 7265 6761 7465 0a65   for aggregate.e
+00007c20: 7665 6e74 732c 2077 6869 6c73 7420 7468  vents, whilst th
+00007c30: 6520 736e 6170 7368 6f74 2069 7320 7265  e snapshot is re
+00007c40: 6164 2066 726f 6d20 6120 7365 7061 7261  ad from a separa
+00007c50: 7465 2073 7472 6561 6d20 666f 7220 6167  te stream for ag
+00007c60: 6772 6567 6174 6520 736e 6170 7368 6f74  gregate snapshot
+00007c70: 732e 0a0a 6060 6070 7974 686f 6e0a 696d  s...```python.im
+00007c80: 706f 7274 206a 736f 6e0a 0a0a 6465 6620  port json...def 
+00007c90: 6765 745f 6167 6772 6567 6174 6528 6167  get_aggregate(ag
+00007ca0: 6772 6567 6174 655f 6964 2c20 6d75 7461  gregate_id, muta
+00007cb0: 746f 725f 6675 6e63 293a 0a20 2020 2073  tor_func):.    s
+00007cc0: 7472 6561 6d5f 6e61 6d65 203d 2061 6767  tream_name = agg
+00007cd0: 7265 6761 7465 5f69 640a 2020 2020 7265  regate_id.    re
+00007ce0: 636f 7264 6564 5f65 7665 6e74 7320 3d20  corded_events = 
+00007cf0: 5b5d 0a0a 2020 2020 2320 4c6f 6f6b 2066  []..    # Look f
+00007d00: 6f72 2061 2073 6e61 7073 686f 742e 0a20  or a snapshot.. 
+00007d10: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
+00007d20: 736e 6170 7368 6f74 7320 3d20 636c 6965  snapshots = clie
+00007d30: 6e74 2e72 6561 645f 7374 7265 616d 5f65  nt.read_stream_e
+00007d40: 7665 6e74 7328 0a20 2020 2020 2020 2020  vents(.         
+00007d50: 2020 2073 7472 6561 6d5f 6e61 6d65 3d6d     stream_name=m
+00007d60: 616b 655f 736e 6170 7368 6f74 5f73 7472  ake_snapshot_str
+00007d70: 6561 6d5f 6e61 6d65 2873 7472 6561 6d5f  eam_name(stream_
+00007d80: 6e61 6d65 292c 0a20 2020 2020 2020 2020  name),.         
+00007d90: 2020 2062 6163 6b77 6172 6473 3d54 7275     backwards=Tru
+00007da0: 652c 0a20 2020 2020 2020 2020 2020 206c  e,.            l
+00007db0: 696d 6974 3d31 0a20 2020 2020 2020 2029  imit=1.        )
+00007dc0: 0a20 2020 2065 7863 6570 7420 4e6f 7446  .    except NotF
+00007dd0: 6f75 6e64 3a0a 2020 2020 2020 2020 7374  ound:.        st
+00007de0: 7265 616d 5f70 6f73 6974 696f 6e20 3d20  ream_position = 
+00007df0: 4e6f 6e65 0a20 2020 2065 6c73 653a 0a20  None.    else:. 
+00007e00: 2020 2020 2020 2073 6e61 7073 686f 7420         snapshot 
+00007e10: 3d20 736e 6170 7368 6f74 735b 305d 0a20  = snapshots[0]. 
+00007e20: 2020 2020 2020 2073 7472 6561 6d5f 706f         stream_po
+00007e30: 7369 7469 6f6e 203d 2064 6573 6572 6961  sition = deseria
+00007e40: 6c69 7a65 2873 6e61 7073 686f 742e 6d65  lize(snapshot.me
+00007e50: 7461 6461 7461 295b 2776 6572 7369 6f6e  tadata)['version
+00007e60: 275d 202b 2031 0a20 2020 2020 2020 2072  '] + 1.        r
+00007e70: 6563 6f72 6465 645f 6576 656e 7473 2e61  ecorded_events.a
+00007e80: 7070 656e 6428 736e 6170 7368 6f74 290a  ppend(snapshot).
+00007e90: 0a20 2020 2023 2047 6574 2073 7562 7365  .    # Get subse
+00007ea0: 7175 656e 7420 6576 656e 7473 2e0a 2020  quent events..  
+00007eb0: 2020 7472 793a 0a20 2020 2020 2020 2065    try:.        e
+00007ec0: 7665 6e74 7320 3d20 636c 6965 6e74 2e72  vents = client.r
+00007ed0: 6561 645f 7374 7265 616d 5f65 7665 6e74  ead_stream_event
+00007ee0: 7328 0a20 2020 2020 2020 2020 2020 2073  s(.            s
+00007ef0: 7472 6561 6d5f 6e61 6d65 3d73 7472 6561  tream_name=strea
+00007f00: 6d5f 6e61 6d65 2c0a 2020 2020 2020 2020  m_name,.        
+00007f10: 2020 2020 7374 7265 616d 5f70 6f73 6974      stream_posit
+00007f20: 696f 6e3d 7374 7265 616d 5f70 6f73 6974  ion=stream_posit
+00007f30: 696f 6e0a 2020 2020 2020 2020 290a 2020  ion.        ).  
+00007f40: 2020 6578 6365 7074 204e 6f74 466f 756e    except NotFoun
+00007f50: 6420 6173 2065 3a0a 2020 2020 2020 2020  d as e:.        
+00007f60: 7261 6973 6520 4167 6772 6567 6174 654e  raise AggregateN
+00007f70: 6f74 466f 756e 6428 6167 6772 6567 6174  otFound(aggregat
+00007f80: 655f 6964 2920 6672 6f6d 2065 0a20 2020  e_id) from e.   
+00007f90: 2065 6c73 653a 0a20 2020 2020 2020 2072   else:.        r
+00007fa0: 6563 6f72 6465 645f 6576 656e 7473 202b  ecorded_events +
+00007fb0: 3d20 6576 656e 7473 0a0a 2020 2020 2320  = events..    # 
+00007fc0: 5265 636f 6e73 7472 7563 7420 6167 6772  Reconstruct aggr
+00007fd0: 6567 6174 6520 6672 6f6d 2072 6563 6f72  egate from recor
+00007fe0: 6465 6420 6576 656e 7473 2e0a 2020 2020  ded events..    
+00007ff0: 6167 6772 6567 6174 6520 3d20 4e6f 6e65  aggregate = None
+00008000: 0a20 2020 2066 6f72 2065 7665 6e74 2069  .    for event i
+00008010: 6e20 7265 636f 7264 6564 5f65 7665 6e74  n recorded_event
+00008020: 733a 0a20 2020 2020 2020 2061 6767 7265  s:.        aggre
+00008030: 6761 7465 203d 206d 7574 6174 6f72 5f66  gate = mutator_f
+00008040: 756e 6328 6167 6772 6567 6174 652c 2065  unc(aggregate, e
+00008050: 7665 6e74 290a 0a20 2020 2072 6574 7572  vent)..    retur
+00008060: 6e20 6167 6772 6567 6174 650a 0a0a 6465  n aggregate...de
+00008070: 6620 7365 7269 616c 697a 6528 6429 3a0a  f serialize(d):.
+00008080: 2020 2020 7265 7475 726e 206a 736f 6e2e      return json.
+00008090: 6475 6d70 7328 6429 2e65 6e63 6f64 6528  dumps(d).encode(
+000080a0: 290a 0a0a 6465 6620 6465 7365 7269 616c  )...def deserial
+000080b0: 697a 6528 7329 3a0a 2020 2020 7265 7475  ize(s):.    retu
+000080c0: 726e 206a 736f 6e2e 6c6f 6164 7328 732e  rn json.loads(s.
+000080d0: 6465 636f 6465 2829 290a 6060 600a 0a54  decode()).```..T
+000080e0: 6f20 7368 6f77 2068 6f77 2074 6869 7320  o show how this 
+000080f0: 6361 6e20 6265 2075 7365 642c 206c 6574  can be used, let
+00008100: 2773 2064 6566 696e 6520 616e 2022 696d  's define an "im
+00008110: 6d75 7461 626c 6522 2060 446f 6760 2061  mutable" `Dog` a
+00008120: 6767 7265 6761 7465 2063 6c61 7373 2c20  ggregate class, 
+00008130: 7769 7468 0a61 7474 7269 6275 7465 7320  with.attributes 
+00008140: 606e 616d 6560 2061 6e64 2060 7472 6963  `name` and `tric
+00008150: 6b73 602e 2054 6865 2061 7474 7269 6275  ks`. The attribu
+00008160: 7465 7320 6069 6460 2061 6e64 2060 7665  tes `id` and `ve
+00008170: 7273 696f 6e60 2077 696c 6c20 696e 6469  rsion` will indi
+00008180: 6361 7465 2061 6e0a 6167 6772 6567 6174  cate an.aggregat
+00008190: 6520 6f62 6a65 6374 2773 2049 4420 616e  e object's ID an
+000081a0: 6420 7665 7273 696f 6e20 6e75 6d62 6572  d version number
+000081b0: 2e20 5468 6520 6174 7472 6962 7574 6520  . The attribute 
+000081c0: 6069 735f 6672 6f6d 5f73 6e61 7073 686f  `is_from_snapsho
+000081d0: 7460 2069 7320 6164 6465 640a 6865 7265  t` is added.here
+000081e0: 206d 6572 656c 7920 746f 2064 656d 6f6e   merely to demon
+000081f0: 7374 7261 7465 2062 656c 6f77 2077 6865  strate below whe
+00008200: 6e20 616e 2061 6767 7265 6761 7465 206f  n an aggregate o
+00008210: 626a 6563 7420 6861 7320 6265 656e 2072  bject has been r
+00008220: 6563 6f6e 7374 7275 6374 6564 2075 7369  econstructed usi
+00008230: 6e67 0a61 2073 6e61 7073 686f 742e 0a0a  ng.a snapshot...
+00008240: 6060 6070 7974 686f 6e0a 6672 6f6d 2064  ```python.from d
+00008250: 6174 6163 6c61 7373 6573 2069 6d70 6f72  ataclasses impor
+00008260: 7420 6461 7461 636c 6173 730a 0a0a 4064  t dataclass...@d
+00008270: 6174 6163 6c61 7373 2866 726f 7a65 6e3d  ataclass(frozen=
+00008280: 5472 7565 290a 636c 6173 7320 4167 6772  True).class Aggr
+00008290: 6567 6174 653a 0a20 2020 2069 643a 2073  egate:.    id: s
+000082a0: 7472 0a20 2020 2076 6572 7369 6f6e 3a20  tr.    version: 
+000082b0: 696e 740a 2020 2020 6973 5f66 726f 6d5f  int.    is_from_
+000082c0: 736e 6170 7368 6f74 3a20 626f 6f6c 0a0a  snapshot: bool..
+000082d0: 0a40 6461 7461 636c 6173 7328 6672 6f7a  .@dataclass(froz
+000082e0: 656e 3d54 7275 6529 0a63 6c61 7373 2044  en=True).class D
+000082f0: 6f67 2841 6767 7265 6761 7465 293a 0a20  og(Aggregate):. 
+00008300: 2020 206e 616d 653a 2073 7472 0a20 2020     name: str.   
+00008310: 2074 7269 636b 733a 206c 6973 740a 0a60   tricks: list..`
+00008320: 6060 0a0a 4c65 7427 7320 616c 736f 2064  ``..Let's also d
+00008330: 6566 696e 6520 6120 6d75 7461 746f 7220  efine a mutator 
+00008340: 6675 6e63 7469 6f6e 2060 6d75 7461 7465  function `mutate
+00008350: 5f64 6f67 2829 6020 7468 6174 2063 616e  _dog()` that can
+00008360: 2065 766f 6c76 6520 7468 6520 7374 6174   evolve the stat
+00008370: 6520 6f66 2061 0a60 446f 6760 2061 6767  e of a.`Dog` agg
+00008380: 7265 6761 7465 2067 6976 656e 2076 6172  regate given var
+00008390: 696f 7573 2064 6966 6665 7265 6e74 2074  ious different t
+000083a0: 7970 6573 206f 6620 6576 656e 7473 2c20  ypes of events, 
+000083b0: 6027 446f 6752 6567 6973 7465 7265 6427  `'DogRegistered'
+000083c0: 602c 0a60 2744 6f67 4c65 6172 6e65 6454  `,.`'DogLearnedT
+000083d0: 7269 636b 2760 2c20 616e 6420 6027 2453  rick'`, and `'$S
+000083e0: 6e61 7073 686f 7460 272e 2054 6865 2073  napshot`'. The s
+000083f0: 6e61 7073 686f 7420 6576 656e 7420 7479  napshot event ty
+00008400: 7065 2069 7320 7072 6566 6978 6564 2077  pe is prefixed w
+00008410: 6974 680a 6027 2427 6020 736f 2074 6861  ith.`'$'` so tha
+00008420: 7420 6974 2063 616e 2062 6520 6669 6c74  t it can be filt
+00008430: 6572 6564 206f 7574 2077 6865 6e20 7265  ered out when re
+00008440: 6164 696e 6720 616c 6c20 6576 656e 7473  ading all events
+00008450: 2066 726f 6d20 7468 6520 6461 7461 6261   from the databa
+00008460: 7365 2e0a 0a60 6060 7079 7468 6f6e 0a64  se...```python.d
+00008470: 6566 206d 7574 6174 655f 646f 6728 646f  ef mutate_dog(do
+00008480: 672c 2065 7665 6e74 293a 0a20 2020 2064  g, event):.    d
+00008490: 6174 6120 3d20 6465 7365 7269 616c 697a  ata = deserializ
+000084a0: 6528 6576 656e 742e 6461 7461 290a 2020  e(event.data).  
+000084b0: 2020 6966 2065 7665 6e74 2e74 7970 6520    if event.type 
+000084c0: 3d3d 2027 446f 6752 6567 6973 7465 7265  == 'DogRegistere
+000084d0: 6427 3a0a 2020 2020 2020 2020 7265 7475  d':.        retu
+000084e0: 726e 2044 6f67 280a 2020 2020 2020 2020  rn Dog(.        
+000084f0: 2020 2020 6964 3d65 7665 6e74 2e73 7472      id=event.str
+00008500: 6561 6d5f 6e61 6d65 2c0a 2020 2020 2020  eam_name,.      
+00008510: 2020 2020 2020 7665 7273 696f 6e3d 6576        version=ev
+00008520: 656e 742e 7374 7265 616d 5f70 6f73 6974  ent.stream_posit
+00008530: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
+00008540: 2069 735f 6672 6f6d 5f73 6e61 7073 686f   is_from_snapsho
+00008550: 743d 4661 6c73 652c 0a20 2020 2020 2020  t=False,.       
+00008560: 2020 2020 206e 616d 653d 6461 7461 5b27       name=data['
+00008570: 6e61 6d65 275d 2c0a 2020 2020 2020 2020  name'],.        
+00008580: 2020 2020 7472 6963 6b73 3d5b 5d2c 0a20      tricks=[],. 
+00008590: 2020 2020 2020 2029 0a20 2020 2065 6c69         ).    eli
+000085a0: 6620 6576 656e 742e 7479 7065 203d 3d20  f event.type == 
+000085b0: 2744 6f67 4c65 6172 6e65 6454 7269 636b  'DogLearnedTrick
+000085c0: 273a 0a20 2020 2020 2020 2061 7373 6572  ':.        asser
+000085d0: 7420 6576 656e 742e 7374 7265 616d 5f70  t event.stream_p
+000085e0: 6f73 6974 696f 6e20 3d3d 2064 6f67 2e76  osition == dog.v
+000085f0: 6572 7369 6f6e 202b 2031 0a20 2020 2020  ersion + 1.     
+00008600: 2020 2061 7373 6572 7420 6576 656e 742e     assert event.
+00008610: 7374 7265 616d 5f6e 616d 6520 3d3d 2064  stream_name == d
+00008620: 6f67 2e69 640a 2020 2020 2020 2020 7265  og.id.        re
+00008630: 7475 726e 2044 6f67 280a 2020 2020 2020  turn Dog(.      
+00008640: 2020 2020 2020 6964 3d64 6f67 2e69 642c        id=dog.id,
+00008650: 0a20 2020 2020 2020 2020 2020 2076 6572  .            ver
+00008660: 7369 6f6e 3d65 7665 6e74 2e73 7472 6561  sion=event.strea
+00008670: 6d5f 706f 7369 7469 6f6e 2c0a 2020 2020  m_position,.    
+00008680: 2020 2020 2020 2020 6973 5f66 726f 6d5f          is_from_
+00008690: 736e 6170 7368 6f74 3d64 6f67 2e69 735f  snapshot=dog.is_
+000086a0: 6672 6f6d 5f73 6e61 7073 686f 742c 0a20  from_snapshot,. 
+000086b0: 2020 2020 2020 2020 2020 206e 616d 653d             name=
+000086c0: 646f 672e 6e61 6d65 2c0a 2020 2020 2020  dog.name,.      
+000086d0: 2020 2020 2020 7472 6963 6b73 3d64 6f67        tricks=dog
+000086e0: 2e74 7269 636b 7320 2b20 5b64 6174 615b  .tricks + [data[
+000086f0: 2774 7269 636b 275d 5d2c 0a20 2020 2020  'trick']],.     
+00008700: 2020 2029 0a20 2020 2065 6c69 6620 6576     ).    elif ev
+00008710: 656e 742e 7479 7065 203d 3d20 2724 536e  ent.type == '$Sn
+00008720: 6170 7368 6f74 273a 0a20 2020 2020 2020  apshot':.       
+00008730: 2072 6574 7572 6e20 446f 6728 0a20 2020   return Dog(.   
+00008740: 2020 2020 2020 2020 2069 643d 7374 7269           id=stri
+00008750: 705f 736e 6170 7368 6f74 5f73 7472 6561  p_snapshot_strea
+00008760: 6d5f 6e61 6d65 2865 7665 6e74 2e73 7472  m_name(event.str
+00008770: 6561 6d5f 6e61 6d65 292c 0a20 2020 2020  eam_name),.     
+00008780: 2020 2020 2020 2076 6572 7369 6f6e 3d64         version=d
+00008790: 6573 6572 6961 6c69 7a65 2865 7665 6e74  eserialize(event
+000087a0: 2e6d 6574 6164 6174 6129 5b27 7665 7273  .metadata)['vers
+000087b0: 696f 6e27 5d2c 0a20 2020 2020 2020 2020  ion'],.         
+000087c0: 2020 2069 735f 6672 6f6d 5f73 6e61 7073     is_from_snaps
+000087d0: 686f 743d 5472 7565 2c0a 2020 2020 2020  hot=True,.      
+000087e0: 2020 2020 2020 6e61 6d65 3d64 6174 615b        name=data[
+000087f0: 276e 616d 6527 5d2c 0a20 2020 2020 2020  'name'],.       
+00008800: 2020 2020 2074 7269 636b 733d 6461 7461       tricks=data
+00008810: 5b27 7472 6963 6b73 275d 2c0a 2020 2020  ['tricks'],.    
+00008820: 2020 2020 290a 2020 2020 656c 7365 3a0a      ).    else:.
+00008830: 2020 2020 2020 2020 7261 6973 6520 4578          raise Ex
+00008840: 6365 7074 696f 6e28 6622 556e 6b6e 6f77  ception(f"Unknow
+00008850: 6e20 6576 656e 7420 7479 7065 3a20 7b65  n event type: {e
+00008860: 7665 6e74 2e74 7970 657d 2229 0a60 6060  vent.type}").```
+00008870: 0a0a 466f 7220 636f 6e76 656e 6965 6e63  ..For convenienc
+00008880: 652c 206c 6574 2773 2061 6c73 6f20 6465  e, let's also de
+00008890: 6669 6e65 2061 2060 6765 745f 646f 6728  fine a `get_dog(
+000088a0: 2960 2066 756e 6374 696f 6e20 7468 6174  )` function that
+000088b0: 2063 616c 6c73 2060 6765 745f 6167 6772   calls `get_aggr
+000088c0: 6567 6174 6528 2960 0a77 6974 6820 7468  egate()`.with th
+000088d0: 6520 606d 7574 6174 655f 646f 6728 2960  e `mutate_dog()`
+000088e0: 2066 756e 6374 696f 6e20 6173 2074 6865   function as the
+000088f0: 2060 6d75 7461 746f 725f 6675 6e63 6020   `mutator_func` 
+00008900: 6172 6775 6d65 6e74 2e0a 0a60 6060 7079  argument...```py
+00008910: 7468 6f6e 0a64 6566 2067 6574 5f64 6f67  thon.def get_dog
+00008920: 2864 6f67 5f69 6429 3a0a 2020 2020 7265  (dog_id):.    re
+00008930: 7475 726e 2067 6574 5f61 6767 7265 6761  turn get_aggrega
+00008940: 7465 280a 2020 2020 2020 2020 6167 6772  te(.        aggr
+00008950: 6567 6174 655f 6964 3d64 6f67 5f69 642c  egate_id=dog_id,
+00008960: 0a20 2020 2020 2020 206d 7574 6174 6f72  .        mutator
+00008970: 5f66 756e 633d 6d75 7461 7465 5f64 6f67  _func=mutate_dog
+00008980: 2c0a 2020 2020 290a 6060 600a 0a57 6520  ,.    ).```..We 
+00008990: 6361 6e20 616c 736f 2064 6566 696e 6520  can also define 
+000089a0: 736f 6d65 2022 636f 6d6d 616e 6422 2066  some "command" f
+000089b0: 756e 6374 696f 6e73 2074 6861 7420 6170  unctions that ap
+000089c0: 7065 6e64 206e 6577 2065 7665 6e74 7320  pend new events 
+000089d0: 746f 2074 6865 0a64 6174 6162 6173 652e  to the.database.
+000089e0: 2054 6865 2060 7265 6769 7374 6572 5f64   The `register_d
+000089f0: 6f67 2829 6020 6675 6e63 7469 6f6e 2061  og()` function a
+00008a00: 7070 656e 6473 2061 2060 446f 6752 6567  ppends a `DogReg
+00008a10: 6973 7465 7265 6460 2065 7665 6e74 2e20  istered` event. 
+00008a20: 5468 650a 6072 6563 6f72 645f 7472 6963  The.`record_tric
+00008a30: 6b5f 6c65 6172 6e65 6428 2960 2061 7070  k_learned()` app
+00008a40: 656e 6473 2061 2060 446f 674c 6561 726e  ends a `DogLearn
+00008a50: 6564 5472 6963 6b60 2065 7665 6e74 2e20  edTrick` event. 
+00008a60: 5468 6520 6675 6e63 7469 6f6e 0a60 736e  The function.`sn
+00008a70: 6170 7368 6f74 5f64 6f67 2829 6020 6170  apshot_dog()` ap
+00008a80: 7065 6e64 7320 6120 6024 536e 6170 7368  pends a `$Snapsh
+00008a90: 6f74 6020 6576 656e 742e 204e 6f74 6963  ot` event. Notic
+00008aa0: 6520 7468 6174 2074 6865 0a60 7265 636f  e that the.`reco
+00008ab0: 7264 5f74 7269 636b 5f6c 6561 726e 6564  rd_trick_learned
+00008ac0: 2829 6020 616e 6420 6073 6e61 7073 686f  ()` and `snapsho
+00008ad0: 745f 646f 6728 2960 2066 756e 6374 696f  t_dog()` functio
+00008ae0: 6e73 2075 7365 2060 6765 745f 646f 6728  ns use `get_dog(
+00008af0: 2960 2e0a 0a4e 6f74 6963 6520 616c 736f  )`...Notice also
+00008b00: 2074 6861 7420 7468 6520 6044 6f67 5265   that the `DogRe
+00008b10: 6769 7374 6572 6564 6020 616e 6420 6044  gistered` and `D
+00008b20: 6f67 4c65 6172 6e65 6454 7269 636b 6020  ogLearnedTrick` 
+00008b30: 6576 656e 7473 2061 7265 2061 7070 656e  events are appen
+00008b40: 6465 6420 746f 2061 0a73 7472 6561 6d20  ded to a.stream 
+00008b50: 666f 7220 6167 6772 6567 6174 6520 6576  for aggregate ev
+00008b60: 656e 7473 2c20 7768 696c 7374 2074 6865  ents, whilst the
+00008b70: 2060 2453 6e61 7073 686f 7460 2069 7320   `$Snapshot` is 
+00008b80: 6170 7065 6e64 6564 2074 6f20 6120 7365  appended to a se
+00008b90: 7061 7261 7465 2073 7472 6561 6d0a 666f  parate stream.fo
+00008ba0: 7220 6167 6772 6567 6174 6520 736e 6170  r aggregate snap
+00008bb0: 7368 6f74 732e 2054 6865 2073 6e61 7073  shots. The snaps
+00008bc0: 686f 7420 6576 656e 7420 7479 7065 2069  hot event type i
+00008bd0: 7320 7072 6566 6978 6564 2077 6974 6820  s prefixed with 
+00008be0: 6027 2427 6020 736f 2074 6861 7420 6974  `'$'` so that it
+00008bf0: 2063 616e 0a62 6520 6669 6c74 6572 6564   can.be filtered
+00008c00: 206f 7574 2077 6865 6e20 7265 6164 696e   out when readin
+00008c10: 6720 616c 6c20 6576 656e 7473 2066 726f  g all events fro
+00008c20: 6d20 7468 6520 6461 7461 6261 7365 2e0a  m the database..
+00008c30: 0a60 6060 7079 7468 6f6e 0a64 6566 2072  .```python.def r
+00008c40: 6567 6973 7465 725f 646f 6728 6e61 6d65  egister_dog(name
+00008c50: 293a 0a20 2020 2064 6f67 5f69 6420 3d20  ):.    dog_id = 
+00008c60: 7374 7228 7575 6964 3428 2929 0a20 2020  str(uuid4()).   
+00008c70: 2065 7665 6e74 203d 204e 6577 4576 656e   event = NewEven
+00008c80: 7428 0a20 2020 2020 2020 2074 7970 653d  t(.        type=
+00008c90: 2744 6f67 5265 6769 7374 6572 6564 272c  'DogRegistered',
+00008ca0: 0a20 2020 2020 2020 2064 6174 613d 7365  .        data=se
+00008cb0: 7269 616c 697a 6528 7b27 6e61 6d65 273a  rialize({'name':
+00008cc0: 206e 616d 657d 292c 0a20 2020 2029 0a20   name}),.    ). 
+00008cd0: 2020 2063 6c69 656e 742e 6170 7065 6e64     client.append
+00008ce0: 5f65 7665 6e74 280a 2020 2020 2020 2020  _event(.        
+00008cf0: 7374 7265 616d 5f6e 616d 653d 646f 675f  stream_name=dog_
+00008d00: 6964 2c0a 2020 2020 2020 2020 6578 7065  id,.        expe
+00008d10: 6374 6564 5f70 6f73 6974 696f 6e3d 4e6f  cted_position=No
+00008d20: 6e65 2c0a 2020 2020 2020 2020 6576 656e  ne,.        even
+00008d30: 743d 6576 656e 742c 0a20 2020 2029 0a20  t=event,.    ). 
+00008d40: 2020 2072 6574 7572 6e20 646f 675f 6964     return dog_id
+00008d50: 0a0a 0a64 6566 2072 6563 6f72 645f 7472  ...def record_tr
+00008d60: 6963 6b5f 6c65 6172 6e65 6428 646f 675f  ick_learned(dog_
+00008d70: 6964 2c20 7472 6963 6b29 3a0a 2020 2020  id, trick):.    
+00008d80: 646f 6720 3d20 6765 745f 646f 6728 646f  dog = get_dog(do
+00008d90: 675f 6964 290a 2020 2020 6576 656e 7420  g_id).    event 
+00008da0: 3d20 4e65 7745 7665 6e74 280a 2020 2020  = NewEvent(.    
+00008db0: 2020 2020 7479 7065 3d27 446f 674c 6561      type='DogLea
+00008dc0: 726e 6564 5472 6963 6b27 2c0a 2020 2020  rnedTrick',.    
+00008dd0: 2020 2020 6461 7461 3d73 6572 6961 6c69      data=seriali
+00008de0: 7a65 287b 2774 7269 636b 273a 2074 7269  ze({'trick': tri
+00008df0: 636b 7d29 2c0a 2020 2020 290a 2020 2020  ck}),.    ).    
+00008e00: 636c 6965 6e74 2e61 7070 656e 645f 6576  client.append_ev
+00008e10: 656e 7428 0a20 2020 2020 2020 2073 7472  ent(.        str
+00008e20: 6561 6d5f 6e61 6d65 3d64 6f67 5f69 642c  eam_name=dog_id,
+00008e30: 0a20 2020 2020 2020 2065 7870 6563 7465  .        expecte
+00008e40: 645f 706f 7369 7469 6f6e 3d64 6f67 2e76  d_position=dog.v
+00008e50: 6572 7369 6f6e 2c0a 2020 2020 2020 2020  ersion,.        
+00008e60: 6576 656e 743d 6576 656e 742c 0a20 2020  event=event,.   
+00008e70: 2029 0a0a 0a64 6566 2073 6e61 7073 686f   )...def snapsho
+00008e80: 745f 646f 6728 646f 675f 6964 293a 0a20  t_dog(dog_id):. 
+00008e90: 2020 2064 6f67 203d 2067 6574 5f64 6f67     dog = get_dog
+00008ea0: 2864 6f67 5f69 6429 0a20 2020 2065 7665  (dog_id).    eve
+00008eb0: 6e74 203d 204e 6577 4576 656e 7428 0a20  nt = NewEvent(. 
+00008ec0: 2020 2020 2020 2074 7970 653d 2724 536e         type='$Sn
+00008ed0: 6170 7368 6f74 272c 0a20 2020 2020 2020  apshot',.       
+00008ee0: 2064 6174 613d 7365 7269 616c 697a 6528   data=serialize(
+00008ef0: 7b27 6e61 6d65 273a 2064 6f67 2e6e 616d  {'name': dog.nam
+00008f00: 652c 2027 7472 6963 6b73 273a 2064 6f67  e, 'tricks': dog
+00008f10: 2e74 7269 636b 737d 292c 0a20 2020 2020  .tricks}),.     
+00008f20: 2020 206d 6574 6164 6174 613d 7365 7269     metadata=seri
+00008f30: 616c 697a 6528 7b27 7665 7273 696f 6e27  alize({'version'
+00008f40: 3a20 646f 672e 7665 7273 696f 6e7d 292c  : dog.version}),
+00008f50: 0a20 2020 2029 0a20 2020 2063 6c69 656e  .    ).    clien
+00008f60: 742e 6170 7065 6e64 5f65 7665 6e74 280a  t.append_event(.
+00008f70: 2020 2020 2020 2020 7374 7265 616d 5f6e          stream_n
+00008f80: 616d 653d 6d61 6b65 5f73 6e61 7073 686f  ame=make_snapsho
+00008f90: 745f 7374 7265 616d 5f6e 616d 6528 646f  t_stream_name(do
+00008fa0: 675f 6964 292c 0a20 2020 2020 2020 2065  g_id),.        e
+00008fb0: 7870 6563 7465 645f 706f 7369 7469 6f6e  xpected_position
+00008fc0: 3d2d 312c 0a20 2020 2020 2020 2065 7665  =-1,.        eve
+00008fd0: 6e74 3d65 7665 6e74 2c0a 2020 2020 290a  nt=event,.    ).
+00008fe0: 6060 600a 0a4e 6f77 2077 6520 6361 6e20  ```..Now we can 
+00008ff0: 7265 6769 7374 6572 2061 206e 6577 2064  register a new d
+00009000: 6f67 2c20 616e 6420 7265 636f 7264 2074  og, and record t
+00009010: 6861 7420 736f 6d65 2074 7269 636b 7320  hat some tricks 
+00009020: 6861 7665 2062 6565 6e20 6c65 6172 6e65  have been learne
+00009030: 642e 0a0a 6060 6070 7974 686f 6e0a 2320  d...```python.# 
+00009040: 5265 6769 7374 6572 2061 206e 6577 2064  Register a new d
+00009050: 6f67 2e0a 646f 675f 6964 203d 2072 6567  og..dog_id = reg
+00009060: 6973 7465 725f 646f 6728 2746 6964 6f27  ister_dog('Fido'
+00009070: 290a 0a64 6f67 203d 2067 6574 5f64 6f67  )..dog = get_dog
+00009080: 2864 6f67 5f69 6429 0a61 7373 6572 7420  (dog_id).assert 
+00009090: 646f 672e 6e61 6d65 203d 3d20 2746 6964  dog.name == 'Fid
+000090a0: 6f27 0a61 7373 6572 7420 646f 672e 7472  o'.assert dog.tr
+000090b0: 6963 6b73 203d 3d20 5b5d 0a61 7373 6572  icks == [].asser
+000090c0: 7420 646f 672e 7665 7273 696f 6e20 3d3d  t dog.version ==
+000090d0: 2030 0a61 7373 6572 7420 646f 672e 6973   0.assert dog.is
+000090e0: 5f66 726f 6d5f 736e 6170 7368 6f74 2069  _from_snapshot i
+000090f0: 7320 4661 6c73 650a 0a0a 2320 5265 636f  s False...# Reco
+00009100: 7264 2074 6861 7420 2746 6964 6f27 206c  rd that 'Fido' l
+00009110: 6561 726e 6564 2061 206e 6577 2074 7269  earned a new tri
+00009120: 636b 2e0a 7265 636f 7264 5f74 7269 636b  ck..record_trick
+00009130: 5f6c 6561 726e 6564 2864 6f67 5f69 642c  _learned(dog_id,
+00009140: 2074 7269 636b 3d27 726f 6c6c 206f 7665   trick='roll ove
+00009150: 7227 290a 0a64 6f67 203d 2067 6574 5f64  r')..dog = get_d
+00009160: 6f67 2864 6f67 5f69 6429 0a61 7373 6572  og(dog_id).asser
+00009170: 7420 646f 672e 6e61 6d65 203d 3d20 2746  t dog.name == 'F
+00009180: 6964 6f27 0a61 7373 6572 7420 646f 672e  ido'.assert dog.
+00009190: 7472 6963 6b73 203d 3d20 5b27 726f 6c6c  tricks == ['roll
+000091a0: 206f 7665 7227 5d0a 6173 7365 7274 2064   over'].assert d
+000091b0: 6f67 2e76 6572 7369 6f6e 203d 3d20 310a  og.version == 1.
+000091c0: 6173 7365 7274 2064 6f67 2e69 735f 6672  assert dog.is_fr
+000091d0: 6f6d 5f73 6e61 7073 686f 7420 6973 2046  om_snapshot is F
+000091e0: 616c 7365 0a0a 0a23 2052 6563 6f72 6420  alse...# Record 
+000091f0: 7468 6174 2027 4669 646f 2720 6c65 6172  that 'Fido' lear
+00009200: 6e65 6420 616e 6f74 6865 7220 6e65 7720  ned another new 
+00009210: 7472 6963 6b2e 0a72 6563 6f72 645f 7472  trick..record_tr
+00009220: 6963 6b5f 6c65 6172 6e65 6428 646f 675f  ick_learned(dog_
+00009230: 6964 2c20 7472 6963 6b3d 2766 6574 6368  id, trick='fetch
+00009240: 2062 616c 6c27 290a 0a64 6f67 203d 2067   ball')..dog = g
+00009250: 6574 5f64 6f67 2864 6f67 5f69 6429 0a61  et_dog(dog_id).a
+00009260: 7373 6572 7420 646f 672e 6e61 6d65 203d  ssert dog.name =
+00009270: 3d20 2746 6964 6f27 0a61 7373 6572 7420  = 'Fido'.assert 
+00009280: 646f 672e 7472 6963 6b73 203d 3d20 5b27  dog.tricks == ['
+00009290: 726f 6c6c 206f 7665 7227 2c20 2766 6574  roll over', 'fet
+000092a0: 6368 2062 616c 6c27 5d0a 6173 7365 7274  ch ball'].assert
+000092b0: 2064 6f67 2e76 6572 7369 6f6e 203d 3d20   dog.version == 
+000092c0: 320a 6173 7365 7274 2064 6f67 2e69 735f  2.assert dog.is_
+000092d0: 6672 6f6d 5f73 6e61 7073 686f 7420 6973  from_snapshot is
+000092e0: 2046 616c 7365 0a60 6060 0a0a 4166 7465   False.```..Afte
+000092f0: 7220 7765 2063 616c 6c20 6073 6e61 7073  r we call `snaps
+00009300: 686f 745f 646f 6728 2960 2c20 7468 6520  hot_dog()`, the 
+00009310: 6067 6574 5f64 6f67 2829 6020 6675 6e63  `get_dog()` func
+00009320: 7469 6f6e 2077 696c 6c20 7265 7475 726e  tion will return
+00009330: 2061 2060 446f 6760 0a6f 626a 6563 7420   a `Dog`.object 
+00009340: 7468 6174 2068 6173 2062 6565 6e20 636f  that has been co
+00009350: 6e73 7472 7563 7465 6420 7573 696e 6720  nstructed using 
+00009360: 7468 6520 6024 536e 6170 7368 6f74 6020  the `$Snapshot` 
+00009370: 6576 656e 742e 0a0a 6060 6070 7974 686f  event...```pytho
+00009380: 6e0a 2320 536e 6170 7368 6f74 2027 4669  n.# Snapshot 'Fi
+00009390: 646f 272e 0a73 6e61 7073 686f 745f 646f  do'..snapshot_do
+000093a0: 6728 646f 675f 6964 290a 0a64 6f67 203d  g(dog_id)..dog =
+000093b0: 2067 6574 5f64 6f67 2864 6f67 5f69 6429   get_dog(dog_id)
+000093c0: 0a61 7373 6572 7420 646f 672e 6e61 6d65  .assert dog.name
+000093d0: 203d 3d20 2746 6964 6f27 0a61 7373 6572   == 'Fido'.asser
+000093e0: 7420 646f 672e 7472 6963 6b73 203d 3d20  t dog.tricks == 
+000093f0: 5b27 726f 6c6c 206f 7665 7227 2c20 2766  ['roll over', 'f
+00009400: 6574 6368 2062 616c 6c27 5d0a 6173 7365  etch ball'].asse
+00009410: 7274 2064 6f67 2e76 6572 7369 6f6e 203d  rt dog.version =
+00009420: 3d20 320a 6173 7365 7274 2064 6f67 2e69  = 2.assert dog.i
+00009430: 735f 6672 6f6d 5f73 6e61 7073 686f 7420  s_from_snapshot 
+00009440: 6973 2054 7275 650a 6060 600a 0a57 6520  is True.```..We 
+00009450: 6361 6e20 636f 6e74 696e 7565 2074 6f20  can continue to 
+00009460: 6576 6f6c 7665 2074 6865 2073 7461 7465  evolve the state
+00009470: 206f 6620 7468 6520 6044 6f67 6020 6167   of the `Dog` ag
+00009480: 6772 6567 6174 652c 2075 7369 6e67 0a74  gregate, using.t
+00009490: 6865 2073 6e61 7073 686f 7420 626f 7468  he snapshot both
+000094a0: 2064 7572 696e 6720 7468 6520 6361 6c6c   during the call
+000094b0: 2074 6865 2060 7265 636f 7264 5f74 7269   the `record_tri
+000094c0: 636b 5f6c 6561 726e 6564 2829 6020 616e  ck_learned()` an
+000094d0: 640a 7768 656e 2063 616c 6c69 6e67 2060  d.when calling `
+000094e0: 6765 745f 646f 6728 2960 2e0a 0a60 6060  get_dog()`...```
+000094f0: 7079 7468 6f6e 0a72 6563 6f72 645f 7472  python.record_tr
+00009500: 6963 6b5f 6c65 6172 6e65 6428 646f 675f  ick_learned(dog_
+00009510: 6964 2c20 7472 6963 6b3d 2773 6974 2729  id, trick='sit')
+00009520: 0a0a 646f 6720 3d20 6765 745f 646f 6728  ..dog = get_dog(
+00009530: 646f 675f 6964 290a 6173 7365 7274 2064  dog_id).assert d
+00009540: 6f67 2e6e 616d 6520 3d3d 2027 4669 646f  og.name == 'Fido
+00009550: 270a 6173 7365 7274 2064 6f67 2e74 7269  '.assert dog.tri
+00009560: 636b 7320 3d3d 205b 2772 6f6c 6c20 6f76  cks == ['roll ov
+00009570: 6572 272c 2027 6665 7463 6820 6261 6c6c  er', 'fetch ball
+00009580: 272c 2027 7369 7427 5d0a 6173 7365 7274  ', 'sit'].assert
+00009590: 2064 6f67 2e76 6572 7369 6f6e 203d 3d20   dog.version == 
+000095a0: 330a 6173 7365 7274 2064 6f67 2e69 735f  3.assert dog.is_
+000095b0: 6672 6f6d 5f73 6e61 7073 686f 7420 6973  from_snapshot is
+000095c0: 2054 7275 650a 6060 600a 0a57 6520 6361   True.```..We ca
+000095d0: 6e20 7365 6520 6672 6f6d 2074 6865 2060  n see from the `
+000095e0: 6973 5f66 726f 6d5f 736e 6170 7368 6f74  is_from_snapshot
+000095f0: 6020 6174 7472 6962 7574 6520 7468 6174  ` attribute that
+00009600: 2074 6865 2060 446f 6760 206f 626a 6563   the `Dog` objec
+00009610: 7420 7761 7320 696e 6465 6564 0a72 6563  t was indeed.rec
+00009620: 6f6e 7374 7275 6374 6564 2066 726f 6d20  onstructed from 
+00009630: 7468 6520 736e 6170 7368 6f74 2e0a 0a0a  the snapshot....
+00009640: 2323 2320 5265 6164 2061 6c6c 2065 7665  ### Read all eve
+00009650: 6e74 730a 0a54 6865 206d 6574 686f 6420  nts..The method 
+00009660: 6072 6561 645f 616c 6c5f 6576 656e 7473  `read_all_events
+00009670: 2829 6020 6361 6e20 6265 2075 7365 6420  ()` can be used 
+00009680: 746f 2072 6561 6420 616c 6c20 7265 636f  to read all reco
+00009690: 7264 6564 2065 7665 6e74 730a 696e 2074  rded events.in t
+000096a0: 6865 2064 6174 6162 6173 6520 696e 2074  he database in t
+000096b0: 6865 206f 7264 6572 2074 6865 7920 7765  he order they we
+000096c0: 7265 2072 6563 6f72 6465 642e 2049 7420  re recorded. It 
+000096d0: 7265 7475 726e 7320 616e 2069 7465 7261  returns an itera
+000096e0: 626c 6520 6f66 0a65 7665 6e74 7320 7468  ble of.events th
+000096f0: 6174 2068 6176 6520 6265 656e 2072 6563  at have been rec
+00009700: 6f72 6465 6420 696e 2074 6865 2064 6174  orded in the dat
+00009710: 6162 6173 652e 2049 7465 7261 7469 6e67  abase. Iterating
+00009720: 206f 7665 7220 7468 6973 2069 7465 7261   over this itera
+00009730: 626c 650a 6f62 6a65 6374 2077 696c 6c20  ble.object will 
+00009740: 7374 6f70 2077 6865 6e20 6974 2068 6173  stop when it has
+00009750: 2079 6965 6c64 6564 2074 6865 206c 6173   yielded the las
+00009760: 7420 7265 636f 7264 6564 2065 7665 6e74  t recorded event
+00009770: 2e20 5468 6520 7265 6365 6976 6564 0a72  . The received.r
+00009780: 6563 6f72 6465 6420 6576 656e 7420 6f62  ecorded event ob
+00009790: 6a65 6374 2061 7265 2069 6e73 7461 6e63  ject are instanc
+000097a0: 6573 206f 6620 7468 6520 6052 6563 6f72  es of the `Recor
+000097b0: 6465 6445 7665 6e74 6020 636c 6173 7320  dedEvent` class 
+000097c0: 2873 6565 2074 6865 0a4e 6f74 6573 2073  (see the.Notes s
+000097d0: 6563 7469 6f6e 2062 656c 6f77 2066 6f72  ection below for
+000097e0: 2064 6574 6169 6c73 206f 6620 7468 6973   details of this
+000097f0: 2063 6c61 7373 292e 0a0a 5468 6973 206d   class)...This m
+00009800: 6574 686f 6420 7375 7070 6f72 7473 2073  ethod supports s
+00009810: 6576 656e 206f 7074 696f 6e61 6c20 6172  even optional ar
+00009820: 6775 6d65 6e74 732c 2060 636f 6d6d 6974  guments, `commit
+00009830: 5f70 6f73 6974 696f 6e60 2c20 6062 6163  _position`, `bac
+00009840: 6b77 6172 6473 602c 0a60 6669 6c74 6572  kwards`,.`filter
+00009850: 5f65 7863 6c75 6465 602c 2060 6669 6c74  _exclude`, `filt
+00009860: 6572 5f69 6e63 6c75 6465 602c 2060 6669  er_include`, `fi
+00009870: 6c74 6572 5f62 795f 7374 7265 616d 5f6e  lter_by_stream_n
+00009880: 616d 6560 2c20 606c 696d 6974 602c 2061  ame`, `limit`, a
+00009890: 6e64 2060 7469 6d65 6f75 7460 2e0a 0a54  nd `timeout`...T
+000098a0: 6865 206f 7074 696f 6e61 6c20 6063 6f6d  he optional `com
+000098b0: 6d69 745f 706f 7369 7469 6f6e 6020 6172  mit_position` ar
+000098c0: 6775 6d65 6e74 2069 7320 616e 206f 7074  gument is an opt
+000098d0: 696f 6e61 6c20 696e 7465 6765 7220 7468  ional integer th
+000098e0: 6174 2063 616e 2062 6520 7573 6564 2074  at can be used t
+000098f0: 6f0a 7370 6563 6966 7920 7468 6520 636f  o.specify the co
+00009900: 6d6d 6974 2070 6f73 6974 696f 6e20 6672  mmit position fr
+00009910: 6f6d 2077 6869 6368 2074 6f20 7374 6172  om which to star
+00009920: 7420 7265 6164 696e 672e 2054 6869 7320  t reading. This 
+00009930: 6172 6775 6d65 6e74 2069 7320 604e 6f6e  argument is `Non
+00009940: 6560 2062 790a 6465 6661 756c 742c 206d  e` by.default, m
+00009950: 6561 6e69 6e67 2074 6861 7420 616c 6c20  eaning that all 
+00009960: 7468 6520 6576 656e 7473 2077 696c 6c20  the events will 
+00009970: 6265 2072 6561 6420 6569 7468 6572 2066  be read either f
+00009980: 726f 6d20 7468 6520 7374 6172 742c 206f  rom the start, o
+00009990: 720a 6672 6f6d 2074 6865 2065 6e64 2069  r.from the end i
+000099a0: 6620 6062 6163 6b77 6172 6473 6020 6973  f `backwards` is
+000099b0: 2060 5472 7565 602e 2050 6c65 6173 6520   `True`. Please 
+000099c0: 6e6f 7465 2c20 6966 2061 2063 6f6d 6d69  note, if a commi
+000099d0: 7420 706f 7369 7469 6f6e 2069 7320 7370  t position is sp
+000099e0: 6563 6966 6965 642c 0a69 7420 6d75 7374  ecified,.it must
+000099f0: 2062 6520 616e 2061 6374 7561 6c6c 7920   be an actually 
+00009a00: 6578 6973 7469 6e67 2063 6f6d 6d69 7420  existing commit 
+00009a10: 706f 7369 7469 6f6e 2069 6e20 7468 6520  position in the 
+00009a20: 6461 7461 6261 7365 2e0a 416e 7920 6f74  database..Any ot
+00009a30: 6865 7220 6e75 6d62 6572 2077 696c 6c20  her number will 
+00009a40: 7265 7375 6c74 2069 6e20 6120 7365 7276  result in a serv
+00009a50: 6572 2065 7272 6f72 2028 6174 206c 6561  er error (at lea
+00009a60: 7374 2069 6e20 4576 656e 7453 746f 7265  st in EventStore
+00009a70: 4442 2076 3231 2e31 3029 2e0a 0a54 6865  DB v21.10)...The
+00009a80: 206f 7074 696f 6e61 6c20 6062 6163 6b77   optional `backw
+00009a90: 6172 6473 6020 6172 6775 6d65 6e74 2069  ards` argument i
+00009aa0: 7320 6120 5079 7468 6f6e 2060 626f 6f6c  s a Python `bool
+00009ab0: 602e 2054 6865 2064 6566 6175 6c74 2069  `. The default i
+00009ac0: 7320 6046 616c 7365 602c 2077 6869 6368  s `False`, which
+00009ad0: 0a6d 6561 6e73 2074 6865 2064 6174 6162  .means the datab
+00009ae0: 6173 6520 7769 6c6c 2062 6520 7265 6164  ase will be read
+00009af0: 2066 6f72 7761 7264 7320 6279 2064 6566   forwards by def
+00009b00: 6175 6c74 2c20 736f 2074 6861 7420 6576  ault, so that ev
+00009b10: 656e 7473 2061 7265 2072 6574 7572 6e65  ents are returne
+00009b20: 6420 696e 2074 6865 0a6f 7264 6572 2074  d in the.order t
+00009b30: 6865 7920 7765 7265 2072 6563 6f72 6465  hey were recorde
+00009b40: 642c 2049 6620 6062 6163 6b77 6172 6473  d, If `backwards
+00009b50: 6020 6973 2060 5472 7565 602c 2074 6865  ` is `True`, the
+00009b60: 2065 7665 6e74 7320 6172 6520 7265 7475   events are retu
+00009b70: 726e 6564 2069 6e20 7265 7665 7273 650a  rned in reverse.
+00009b80: 6f72 6465 722e 0a0a 5468 6520 6f70 7469  order...The opti
+00009b90: 6f6e 616c 2060 6669 6c74 6572 5f65 7863  onal `filter_exc
+00009ba0: 6c75 6465 6020 6172 6775 6d65 6e74 2069  lude` argument i
+00009bb0: 7320 6120 7365 7175 656e 6365 206f 6620  s a sequence of 
+00009bc0: 7265 6775 6c61 7220 6578 7072 6573 7369  regular expressi
+00009bd0: 6f6e 7320 7468 6174 0a6d 6174 6368 2072  ons that.match r
+00009be0: 6563 6f72 6465 6420 6576 656e 7473 2074  ecorded events t
+00009bf0: 6861 7420 7368 6f75 6c64 206e 6f74 2062  hat should not b
+00009c00: 6520 696e 636c 7564 6564 2e20 5468 6973  e included. This
+00009c10: 2061 7267 756d 656e 7420 6973 2069 676e   argument is ign
+00009c20: 6f72 6564 0a69 6620 6066 696c 7465 725f  ored.if `filter_
+00009c30: 696e 636c 7564 6560 2069 7320 7365 7420  include` is set 
+00009c40: 746f 2061 206e 6f6e 2d65 6d70 7479 2073  to a non-empty s
+00009c50: 6571 7565 6e63 652e 2042 7920 6465 6661  equence. By defa
+00009c60: 756c 742c 2074 6869 7320 6172 6775 6d65  ult, this argume
+00009c70: 6e74 2069 7320 7365 740a 746f 206d 6174  nt is set.to mat
+00009c80: 6368 2074 6865 2065 7665 6e74 2074 7970  ch the event typ
+00009c90: 6573 206f 6620 2273 7973 7465 6d20 6576  es of "system ev
+00009ca0: 656e 7473 222c 2073 6f20 7468 6174 2045  ents", so that E
+00009cb0: 7665 6e74 5374 6f72 6544 4220 7379 7374  ventStoreDB syst
+00009cc0: 656d 2065 7665 6e74 730a 7769 6c6c 206e  em events.will n
+00009cd0: 6f74 206e 6f72 6d61 6c6c 7920 6265 2069  ot normally be i
+00009ce0: 6e63 6c75 6465 642e 2053 6565 2074 6865  ncluded. See the
+00009cf0: 204e 6f74 6573 2073 6563 7469 6f6e 2062   Notes section b
+00009d00: 656c 6f77 2066 6f72 206d 6f72 6520 696e  elow for more in
+00009d10: 666f 726d 6174 696f 6e0a 6162 6f75 7420  formation.about 
+00009d20: 6669 6c74 6572 2065 7870 7265 7373 696f  filter expressio
+00009d30: 6e73 2e0a 0a54 6865 206f 7074 696f 6e61  ns...The optiona
+00009d40: 6c20 6066 696c 7465 725f 696e 636c 7564  l `filter_includ
+00009d50: 6560 2061 7267 756d 656e 7420 6973 2061  e` argument is a
+00009d60: 2073 6571 7565 6e63 6520 6f66 2072 6567   sequence of reg
+00009d70: 756c 6172 2065 7870 7265 7373 696f 6e73  ular expressions
+00009d80: 0a74 6861 7420 6d61 7463 6820 7265 636f  .that match reco
+00009d90: 7264 6564 2065 7665 6e74 7320 7468 6174  rded events that
+00009da0: 2073 686f 756c 6420 6265 2069 6e63 6c75   should be inclu
+00009db0: 6465 642e 2042 7920 6465 6661 756c 742c  ded. By default,
+00009dc0: 2074 6869 7320 6172 6775 6d65 6e74 0a69   this argument.i
+00009dd0: 7320 616e 2065 6d70 7479 2074 7570 6c65  s an empty tuple
+00009de0: 2e20 4966 2074 6869 7320 6172 6775 6d65  . If this argume
+00009df0: 6e74 2069 7320 7365 7420 746f 2061 206e  nt is set to a n
+00009e00: 6f6e 2d65 6d70 7479 2073 6571 7565 6e63  on-empty sequenc
+00009e10: 652c 2074 6865 0a60 6669 6c74 6572 5f65  e, the.`filter_e
+00009e20: 7863 6c75 6465 6020 6172 6775 6d65 6e74  xclude` argument
+00009e30: 2069 7320 6967 6e6f 7265 642e 0a0a 5468   is ignored...Th
+00009e40: 6520 6f70 7469 6f6e 616c 2060 6669 6c74  e optional `filt
+00009e50: 6572 5f62 795f 7374 7265 616d 5f6e 616d  er_by_stream_nam
+00009e60: 6560 2061 7267 756d 656e 7420 6973 2061  e` argument is a
+00009e70: 2050 7974 686f 6e20 6062 6f6f 6c60 2074   Python `bool` t
+00009e80: 6861 7420 696e 6469 6361 7465 7320 7768  hat indicates wh
+00009e90: 6574 6865 720a 7468 6520 6669 6c74 6572  ether.the filter
+00009ea0: 2077 696c 6c20 6170 706c 7920 746f 2065   will apply to e
+00009eb0: 7665 6e74 2074 7970 6573 206f 7220 7374  vent types or st
+00009ec0: 7265 616d 206e 616d 6573 2e20 4279 2064  ream names. By d
+00009ed0: 6566 6175 6c74 2c20 7468 6973 2076 616c  efault, this val
+00009ee0: 7565 2069 7320 6046 616c 7365 600a 616e  ue is `False`.an
+00009ef0: 6420 736f 2074 6865 2066 696c 7465 7269  d so the filteri
+00009f00: 6e67 2077 696c 6c20 6170 706c 7920 746f  ng will apply to
+00009f10: 2074 6865 2065 7665 6e74 2074 7970 6520   the event type 
+00009f20: 7374 7269 6e67 7320 6f66 2072 6563 6f72  strings of recor
+00009f30: 6465 6420 6576 656e 7473 2e0a 0a54 6865  ded events...The
+00009f40: 206f 7074 696f 6e61 6c20 606c 696d 6974   optional `limit
+00009f50: 6020 6172 6775 6d65 6e74 2069 7320 616e  ` argument is an
+00009f60: 2069 6e74 6567 6572 2077 6869 6368 2072   integer which r
+00009f70: 6573 7472 6963 7473 2074 6865 206e 756d  estricts the num
+00009f80: 6265 7220 6f66 2065 7665 6e74 7320 7468  ber of events th
+00009f90: 6174 0a77 696c 6c20 6265 2072 6574 7572  at.will be retur
+00009fa0: 6e65 642e 2054 6865 2064 6566 6175 6c74  ned. The default
+00009fb0: 2076 616c 7565 2069 7320 6073 7973 2e6d   value is `sys.m
+00009fc0: 6178 696e 7460 2e0a 0a54 6865 206f 7074  axint`...The opt
+00009fd0: 696f 6e61 6c20 6074 696d 656f 7574 6020  ional `timeout` 
+00009fe0: 6172 6775 6d65 6e74 2069 7320 6120 5079  argument is a Py
+00009ff0: 7468 6f6e 2060 666c 6f61 7460 2077 6869  thon `float` whi
+0000a000: 6368 2073 6574 7320 610a 6465 6164 6c69  ch sets a.deadli
+0000a010: 6e65 2066 6f72 2074 6865 2063 6f6d 706c  ne for the compl
+0000a020: 6574 696f 6e20 6f66 2074 6865 2067 5250  etion of the gRP
+0000a030: 4320 6f70 6572 6174 696f 6e2e 0a0a 5468  C operation...Th
+0000a040: 6520 6669 6c74 6572 696e 6720 6f66 2065  e filtering of e
+0000a050: 7665 6e74 7320 6973 2064 6f6e 6520 6f6e  vents is done on
+0000a060: 2074 6865 2045 7665 6e74 5374 6f72 6544   the EventStoreD
+0000a070: 4220 7365 7276 6572 2e20 5468 650a 606c  B server. The.`l
+0000a080: 696d 6974 6020 6172 6775 6d65 6e74 2069  imit` argument i
+0000a090: 7320 6170 706c 6965 6420 6f6e 2074 6865  s applied on the
+0000a0a0: 2073 6572 7665 7220 6166 7465 7220 6669   server after fi
+0000a0b0: 6c74 6572 696e 672e 0a0a 5768 656e 2072  ltering...When r
+0000a0c0: 6561 6469 6e67 2066 6f72 7761 7264 7320  eading forwards 
+0000a0d0: 6672 6f6d 2061 2073 7065 6369 6669 6320  from a specific 
+0000a0e0: 636f 6d6d 6974 2070 6f73 6974 696f 6e2c  commit position,
+0000a0f0: 2074 6865 2065 7665 6e74 2061 7420 7468   the event at th
+0000a100: 6520 7370 6563 6966 6965 640a 706f 7369  e specified.posi
+0000a110: 7469 6f6e 2057 494c 4c20 6265 2069 6e63  tion WILL be inc
+0000a120: 6c75 6465 642e 2048 6f77 6576 6572 2c20  luded. However, 
+0000a130: 7768 656e 2072 6561 6469 6e67 2062 6163  when reading bac
+0000a140: 6b77 6172 6473 2c20 7468 6520 6576 656e  kwards, the even
+0000a150: 7420 6174 2074 6865 0a73 7065 6369 6669  t at the.specifi
+0000a160: 6564 2070 6f73 6974 696f 6e20 7769 6c6c  ed position will
+0000a170: 204e 4f54 2062 6520 696e 636c 7564 6564   NOT be included
+0000a180: 2e20 2854 6869 7320 6e6f 6e2d 696e 636c  . (This non-incl
+0000a190: 7573 6976 6520 6265 6861 7669 6f75 722c  usive behaviour,
+0000a1a0: 206f 6620 6578 636c 7564 696e 670a 7468   of excluding.th
+0000a1b0: 6520 7370 6563 6966 6965 6420 636f 6d6d  e specified comm
+0000a1c0: 6974 2070 6f73 6974 696f 6e20 7768 656e  it position when
+0000a1d0: 2072 6561 6469 6e67 2061 6c6c 2073 7472   reading all str
+0000a1e0: 6561 6d73 2062 6163 6b77 6172 6473 2c20  eams backwards, 
+0000a1f0: 6469 6666 6572 7320 6672 6f6d 2074 6865  differs from the
+0000a200: 0a62 6568 6176 696f 7572 2077 6865 6e20  .behaviour when 
+0000a210: 7265 6164 696e 6720 6120 7374 7265 616d  reading a stream
+0000a220: 2062 6163 6b77 6172 6473 2066 726f 6d20   backwards from 
+0000a230: 6120 7370 6563 6966 6963 2073 7472 6561  a specific strea
+0000a240: 6d20 706f 7369 7469 6f6e 2e29 0a0a 5468  m position.)..Th
+0000a250: 6520 6578 616d 706c 6520 6265 6c6f 7720  e example below 
+0000a260: 7368 6f77 7320 686f 7720 746f 2072 6561  shows how to rea
+0000a270: 6420 616c 6c20 6576 656e 7473 2069 6e20  d all events in 
+0000a280: 7468 6520 6461 7461 6261 7365 2069 6e20  the database in 
+0000a290: 7468 650a 6f72 6465 7220 7468 6579 2077  the.order they w
+0000a2a0: 6572 6520 7265 636f 7264 6564 2e0a 0a60  ere recorded...`
+0000a2b0: 6060 7079 7468 6f6e 0a65 7665 6e74 7320  ``python.events 
+0000a2c0: 3d20 6c69 7374 2863 6c69 656e 742e 7265  = list(client.re
+0000a2d0: 6164 5f61 6c6c 5f65 7665 6e74 7328 2929  ad_all_events())
+0000a2e0: 0a0a 6173 7365 7274 206c 656e 2865 7665  ..assert len(eve
+0000a2f0: 6e74 7329 203e 3d20 330a 6060 600a 0a54  nts) >= 3.```..T
+0000a300: 6865 2065 7861 6d70 6c65 2062 656c 6f77  he example below
+0000a310: 2073 686f 7773 2068 6f77 2074 6f20 7265   shows how to re
+0000a320: 6164 2061 6c6c 2072 6563 6f72 6465 6420  ad all recorded 
+0000a330: 6576 656e 7473 2066 726f 6d20 6120 7370  events from a sp
+0000a340: 6563 6966 6963 2063 6f6d 6d69 7420 706f  ecific commit po
+0000a350: 7369 7469 6f6e 2e0a 0a60 6060 7079 7468  sition...```pyth
+0000a360: 6f6e 0a65 7665 6e74 7320 3d20 6c69 7374  on.events = list
+0000a370: 280a 2020 2020 636c 6965 6e74 2e72 6561  (.    client.rea
+0000a380: 645f 616c 6c5f 6576 656e 7473 280a 2020  d_all_events(.  
+0000a390: 2020 2020 2020 636f 6d6d 6974 5f70 6f73        commit_pos
+0000a3a0: 6974 696f 6e3d 636f 6d6d 6974 5f70 6f73  ition=commit_pos
+0000a3b0: 6974 696f 6e31 0a20 2020 2029 0a29 0a0a  ition1.    ).)..
+0000a3c0: 6173 7365 7274 206c 656e 2865 7665 6e74  assert len(event
+0000a3d0: 7329 203d 3d20 370a 0a61 7373 6572 7420  s) == 7..assert 
+0000a3e0: 6576 656e 7473 5b30 5d2e 7374 7265 616d  events[0].stream
+0000a3f0: 5f6e 616d 6520 3d3d 2073 7472 6561 6d5f  _name == stream_
+0000a400: 6e61 6d65 310a 6173 7365 7274 2065 7665  name1.assert eve
+0000a410: 6e74 735b 305d 2e73 7472 6561 6d5f 706f  nts[0].stream_po
+0000a420: 7369 7469 6f6e 203d 3d20 300a 6173 7365  sition == 0.asse
+0000a430: 7274 2065 7665 6e74 735b 305d 2e74 7970  rt events[0].typ
+0000a440: 6520 3d3d 2065 7665 6e74 312e 7479 7065  e == event1.type
+0000a450: 0a61 7373 6572 7420 6576 656e 7473 5b30  .assert events[0
+0000a460: 5d2e 6461 7461 203d 3d20 6576 656e 7431  ].data == event1
+0000a470: 2e64 6174 610a 0a61 7373 6572 7420 6576  .data..assert ev
+0000a480: 656e 7473 5b31 5d2e 7374 7265 616d 5f6e  ents[1].stream_n
+0000a490: 616d 6520 3d3d 2073 7472 6561 6d5f 6e61  ame == stream_na
+0000a4a0: 6d65 310a 6173 7365 7274 2065 7665 6e74  me1.assert event
+0000a4b0: 735b 315d 2e73 7472 6561 6d5f 706f 7369  s[1].stream_posi
+0000a4c0: 7469 6f6e 203d 3d20 310a 6173 7365 7274  tion == 1.assert
+0000a4d0: 2065 7665 6e74 735b 315d 2e74 7970 6520   events[1].type 
+0000a4e0: 3d3d 2065 7665 6e74 322e 7479 7065 0a61  == event2.type.a
+0000a4f0: 7373 6572 7420 6576 656e 7473 5b31 5d2e  ssert events[1].
+0000a500: 6461 7461 203d 3d20 6576 656e 7432 2e64  data == event2.d
+0000a510: 6174 610a 0a61 7373 6572 7420 6576 656e  ata..assert even
+0000a520: 7473 5b32 5d2e 7374 7265 616d 5f6e 616d  ts[2].stream_nam
+0000a530: 6520 3d3d 2073 7472 6561 6d5f 6e61 6d65  e == stream_name
+0000a540: 310a 6173 7365 7274 2065 7665 6e74 735b  1.assert events[
+0000a550: 325d 2e73 7472 6561 6d5f 706f 7369 7469  2].stream_positi
+0000a560: 6f6e 203d 3d20 320a 6173 7365 7274 2065  on == 2.assert e
+0000a570: 7665 6e74 735b 325d 2e74 7970 6520 3d3d  vents[2].type ==
+0000a580: 2065 7665 6e74 332e 7479 7065 0a61 7373   event3.type.ass
+0000a590: 6572 7420 6576 656e 7473 5b32 5d2e 6461  ert events[2].da
+0000a5a0: 7461 203d 3d20 6576 656e 7433 2e64 6174  ta == event3.dat
+0000a5b0: 610a 0a61 7373 6572 7420 6576 656e 7473  a..assert events
+0000a5c0: 5b33 5d2e 7479 7065 203d 3d20 2244 6f67  [3].type == "Dog
+0000a5d0: 5265 6769 7374 6572 6564 220a 6173 7365  Registered".asse
+0000a5e0: 7274 2065 7665 6e74 735b 345d 2e74 7970  rt events[4].typ
+0000a5f0: 6520 3d3d 2022 446f 674c 6561 726e 6564  e == "DogLearned
+0000a600: 5472 6963 6b22 0a61 7373 6572 7420 6576  Trick".assert ev
+0000a610: 656e 7473 5b35 5d2e 7479 7065 203d 3d20  ents[5].type == 
+0000a620: 2244 6f67 4c65 6172 6e65 6454 7269 636b  "DogLearnedTrick
+0000a630: 220a 6173 7365 7274 2065 7665 6e74 735b  ".assert events[
+0000a640: 365d 2e74 7970 6520 3d3d 2022 446f 674c  6].type == "DogL
+0000a650: 6561 726e 6564 5472 6963 6b22 0a60 6060  earnedTrick".```
+0000a660: 0a0a 5468 6520 6578 616d 706c 6520 6265  ..The example be
+0000a670: 6c6f 7720 7368 6f77 7320 686f 7720 746f  low shows how to
+0000a680: 2072 6561 6420 616c 6c20 7265 636f 7264   read all record
+0000a690: 6564 2065 7665 6e74 7320 696e 2072 6576  ed events in rev
+0000a6a0: 6572 7365 206f 7264 6572 2e0a 0a60 6060  erse order...```
+0000a6b0: 7079 7468 6f6e 0a65 7665 6e74 7320 3d20  python.events = 
+0000a6c0: 6c69 7374 280a 2020 2020 636c 6965 6e74  list(.    client
+0000a6d0: 2e72 6561 645f 616c 6c5f 6576 656e 7473  .read_all_events
+0000a6e0: 280a 2020 2020 2020 2020 6261 636b 7761  (.        backwa
+0000a6f0: 7264 733d 5472 7565 0a20 2020 2029 0a29  rds=True.    ).)
+0000a700: 0a0a 6173 7365 7274 206c 656e 2865 7665  ..assert len(eve
+0000a710: 6e74 7329 203e 3d20 330a 0a61 7373 6572  nts) >= 3..asser
+0000a720: 7420 6576 656e 7473 5b30 5d2e 7479 7065  t events[0].type
+0000a730: 203d 3d20 2244 6f67 4c65 6172 6e65 6454   == "DogLearnedT
+0000a740: 7269 636b 220a 6173 7365 7274 2065 7665  rick".assert eve
+0000a750: 6e74 735b 315d 2e74 7970 6520 3d3d 2022  nts[1].type == "
+0000a760: 446f 674c 6561 726e 6564 5472 6963 6b22  DogLearnedTrick"
+0000a770: 0a61 7373 6572 7420 6576 656e 7473 5b32  .assert events[2
+0000a780: 5d2e 7479 7065 203d 3d20 2244 6f67 4c65  ].type == "DogLe
+0000a790: 6172 6e65 6454 7269 636b 220a 6173 7365  arnedTrick".asse
+0000a7a0: 7274 2065 7665 6e74 735b 335d 2e74 7970  rt events[3].typ
+0000a7b0: 6520 3d3d 2022 446f 6752 6567 6973 7465  e == "DogRegiste
+0000a7c0: 7265 6422 0a0a 6173 7365 7274 2065 7665  red"..assert eve
+0000a7d0: 6e74 735b 345d 2e73 7472 6561 6d5f 6e61  nts[4].stream_na
+0000a7e0: 6d65 203d 3d20 7374 7265 616d 5f6e 616d  me == stream_nam
+0000a7f0: 6531 0a61 7373 6572 7420 6576 656e 7473  e1.assert events
+0000a800: 5b34 5d2e 7374 7265 616d 5f70 6f73 6974  [4].stream_posit
+0000a810: 696f 6e20 3d3d 2032 0a61 7373 6572 7420  ion == 2.assert 
+0000a820: 6576 656e 7473 5b34 5d2e 7479 7065 203d  events[4].type =
+0000a830: 3d20 6576 656e 7433 2e74 7970 650a 6173  = event3.type.as
+0000a840: 7365 7274 2065 7665 6e74 735b 345d 2e64  sert events[4].d
+0000a850: 6174 6120 3d3d 2065 7665 6e74 332e 6461  ata == event3.da
+0000a860: 7461 0a0a 6173 7365 7274 2065 7665 6e74  ta..assert event
+0000a870: 735b 355d 2e73 7472 6561 6d5f 6e61 6d65  s[5].stream_name
+0000a880: 203d 3d20 7374 7265 616d 5f6e 616d 6531   == stream_name1
+0000a890: 0a61 7373 6572 7420 6576 656e 7473 5b35  .assert events[5
+0000a8a0: 5d2e 7374 7265 616d 5f70 6f73 6974 696f  ].stream_positio
+0000a8b0: 6e20 3d3d 2031 0a61 7373 6572 7420 6576  n == 1.assert ev
+0000a8c0: 656e 7473 5b35 5d2e 7479 7065 203d 3d20  ents[5].type == 
+0000a8d0: 6576 656e 7432 2e74 7970 650a 6173 7365  event2.type.asse
+0000a8e0: 7274 2065 7665 6e74 735b 355d 2e64 6174  rt events[5].dat
+0000a8f0: 6120 3d3d 2065 7665 6e74 322e 6461 7461  a == event2.data
+0000a900: 0a0a 6173 7365 7274 2065 7665 6e74 735b  ..assert events[
+0000a910: 365d 2e73 7472 6561 6d5f 6e61 6d65 203d  6].stream_name =
+0000a920: 3d20 7374 7265 616d 5f6e 616d 6531 0a61  = stream_name1.a
+0000a930: 7373 6572 7420 6576 656e 7473 5b36 5d2e  ssert events[6].
+0000a940: 7374 7265 616d 5f70 6f73 6974 696f 6e20  stream_position 
+0000a950: 3d3d 2030 0a61 7373 6572 7420 6576 656e  == 0.assert even
+0000a960: 7473 5b36 5d2e 7479 7065 203d 3d20 6576  ts[6].type == ev
+0000a970: 656e 7431 2e74 7970 650a 6173 7365 7274  ent1.type.assert
+0000a980: 2065 7665 6e74 735b 365d 2e64 6174 6120   events[6].data 
+0000a990: 3d3d 2065 7665 6e74 312e 6461 7461 0a0a  == event1.data..
+0000a9a0: 6060 600a 0a54 6865 2065 7861 6d70 6c65  ```..The example
+0000a9b0: 2062 656c 6f77 2073 686f 7773 2068 6f77   below shows how
+0000a9c0: 2074 6f20 7265 6164 2061 206c 696d 6974   to read a limit
+0000a9d0: 6564 206e 756d 6265 7220 286f 6e65 2920  ed number (one) 
+0000a9e0: 6f66 2074 6865 2072 6563 6f72 6465 6420  of the recorded 
+0000a9f0: 6576 656e 7473 0a69 6e20 7468 6520 6461  events.in the da
+0000aa00: 7461 6261 7365 2066 6f72 7761 7264 7320  tabase forwards 
+0000aa10: 6672 6f6d 2061 2073 7065 6369 6669 6320  from a specific 
+0000aa20: 636f 6d6d 6974 2070 6f73 6974 696f 6e2e  commit position.
+0000aa30: 2050 6c65 6173 6520 6e6f 7465 2c20 7768   Please note, wh
+0000aa40: 656e 2072 6561 6469 6e67 0a61 6c6c 2065  en reading.all e
+0000aa50: 7665 6e74 7320 666f 7277 6172 6473 2066  vents forwards f
+0000aa60: 726f 6d20 6120 7370 6563 6966 6963 2063  rom a specific c
+0000aa70: 6f6d 6d69 7420 706f 7369 7469 6f6e 2c20  ommit position, 
+0000aa80: 7468 6520 6576 656e 7420 6174 2074 6865  the event at the
+0000aa90: 2073 7065 6369 6669 6564 0a70 6f73 6974   specified.posit
+0000aaa0: 696f 6e20 5749 4c4c 2062 6520 696e 636c  ion WILL be incl
+0000aab0: 7564 6564 2e0a 0a0a 6060 6070 7974 686f  uded....```pytho
+0000aac0: 6e0a 6576 656e 7473 203d 206c 6973 7428  n.events = list(
+0000aad0: 0a20 2020 2063 6c69 656e 742e 7265 6164  .    client.read
+0000aae0: 5f61 6c6c 5f65 7665 6e74 7328 0a20 2020  _all_events(.   
+0000aaf0: 2020 2020 2063 6f6d 6d69 745f 706f 7369       commit_posi
+0000ab00: 7469 6f6e 3d63 6f6d 6d69 745f 706f 7369  tion=commit_posi
+0000ab10: 7469 6f6e 312c 0a20 2020 2020 2020 206c  tion1,.        l
+0000ab20: 696d 6974 3d31 2c0a 2020 2020 290a 290a  imit=1,.    ).).
+0000ab30: 0a61 7373 6572 7420 6c65 6e28 6576 656e  .assert len(even
+0000ab40: 7473 2920 3d3d 2031 0a0a 6173 7365 7274  ts) == 1..assert
+0000ab50: 2065 7665 6e74 735b 305d 2e73 7472 6561   events[0].strea
+0000ab60: 6d5f 6e61 6d65 203d 3d20 7374 7265 616d  m_name == stream
+0000ab70: 5f6e 616d 6531 0a61 7373 6572 7420 6576  _name1.assert ev
+0000ab80: 656e 7473 5b30 5d2e 7374 7265 616d 5f70  ents[0].stream_p
+0000ab90: 6f73 6974 696f 6e20 3d3d 2030 0a61 7373  osition == 0.ass
+0000aba0: 6572 7420 6576 656e 7473 5b30 5d2e 7479  ert events[0].ty
+0000abb0: 7065 203d 3d20 6576 656e 7431 2e74 7970  pe == event1.typ
+0000abc0: 650a 6173 7365 7274 2065 7665 6e74 735b  e.assert events[
+0000abd0: 305d 2e64 6174 6120 3d3d 2065 7665 6e74  0].data == event
+0000abe0: 312e 6461 7461 0a0a 6173 7365 7274 2065  1.data..assert e
+0000abf0: 7665 6e74 735b 305d 2e63 6f6d 6d69 745f  vents[0].commit_
+0000ac00: 706f 7369 7469 6f6e 203d 3d20 636f 6d6d  position == comm
+0000ac10: 6974 5f70 6f73 6974 696f 6e31 0a60 6060  it_position1.```
+0000ac20: 0a0a 5468 6520 6578 616d 706c 6520 6265  ..The example be
+0000ac30: 6c6f 7720 7368 6f77 7320 686f 7720 746f  low shows how to
+0000ac40: 2072 6561 6420 6120 6c69 6d69 7465 6420   read a limited 
+0000ac50: 6e75 6d62 6572 2028 6f6e 6529 206f 6620  number (one) of 
+0000ac60: 7468 6520 7265 636f 7264 6564 2065 7665  the recorded eve
+0000ac70: 6e74 730a 696e 2074 6865 2064 6174 6162  nts.in the datab
+0000ac80: 6173 6520 6261 636b 7761 7264 7320 6672  ase backwards fr
+0000ac90: 6f6d 2074 6865 2065 6e64 2e20 5468 6973  om the end. This
+0000aca0: 2067 6976 6573 2074 6865 206c 6173 7420   gives the last 
+0000acb0: 7265 636f 7264 6564 2065 7665 6e74 2e0a  recorded event..
+0000acc0: 0a60 6060 7079 7468 6f6e 0a65 7665 6e74  .```python.event
+0000acd0: 7320 3d20 6c69 7374 280a 2020 2020 636c  s = list(.    cl
+0000ace0: 6965 6e74 2e72 6561 645f 616c 6c5f 6576  ient.read_all_ev
+0000acf0: 656e 7473 280a 2020 2020 2020 2020 6261  ents(.        ba
+0000ad00: 636b 7761 7264 733d 5472 7565 2c0a 2020  ckwards=True,.  
+0000ad10: 2020 2020 2020 6c69 6d69 743d 312c 0a20        limit=1,. 
+0000ad20: 2020 2029 0a29 0a0a 6173 7365 7274 206c     ).)..assert l
+0000ad30: 656e 2865 7665 6e74 7329 203d 3d20 310a  en(events) == 1.
+0000ad40: 0a61 7373 6572 7420 6576 656e 7473 5b30  .assert events[0
+0000ad50: 5d2e 7479 7065 203d 3d20 2244 6f67 4c65  ].type == "DogLe
+0000ad60: 6172 6e65 6454 7269 636b 220a 6060 600a  arnedTrick".```.
+0000ad70: 0a54 6865 2065 7861 6d70 6c65 2062 656c  .The example bel
+0000ad80: 6f77 2073 686f 7773 2068 6f77 2074 6f20  ow shows how to 
+0000ad90: 7265 6164 2061 206c 696d 6974 6564 206e  read a limited n
+0000ada0: 756d 6265 7220 286f 6e65 2920 6f66 2074  umber (one) of t
+0000adb0: 6865 2072 6563 6f72 6465 6420 6576 656e  he recorded even
+0000adc0: 7473 0a69 6e20 7468 6520 6461 7461 6261  ts.in the databa
+0000add0: 7365 2062 6163 6b77 6172 6473 2066 726f  se backwards fro
+0000ade0: 6d20 6120 7370 6563 6966 6963 2063 6f6d  m a specific com
+0000adf0: 6d69 7420 706f 7369 7469 6f6e 2e20 506c  mit position. Pl
+0000ae00: 6561 7365 206e 6f74 652c 2077 6865 6e20  ease note, when 
+0000ae10: 7265 6164 696e 670a 616c 6c20 6576 656e  reading.all even
+0000ae20: 7473 2062 6163 6b77 6172 6473 2066 726f  ts backwards fro
+0000ae30: 6d20 6120 7370 6563 6966 6963 2063 6f6d  m a specific com
+0000ae40: 6d69 7420 706f 7369 7469 6f6e 2c20 7468  mit position, th
+0000ae50: 6520 6576 656e 7420 6174 2074 6865 2073  e event at the s
+0000ae60: 7065 6369 6669 6564 0a70 6f73 6974 696f  pecified.positio
+0000ae70: 6e20 5749 4c4c 204e 4f54 2062 6520 696e  n WILL NOT be in
+0000ae80: 636c 7564 6564 2e0a 0a60 6060 7079 7468  cluded...```pyth
+0000ae90: 6f6e 0a65 7665 6e74 7320 3d20 6c69 7374  on.events = list
+0000aea0: 280a 2020 2020 636c 6965 6e74 2e72 6561  (.    client.rea
+0000aeb0: 645f 616c 6c5f 6576 656e 7473 280a 2020  d_all_events(.  
+0000aec0: 2020 2020 2020 636f 6d6d 6974 5f70 6f73        commit_pos
+0000aed0: 6974 696f 6e3d 636f 6d6d 6974 5f70 6f73  ition=commit_pos
+0000aee0: 6974 696f 6e32 2c0a 2020 2020 2020 2020  ition2,.        
+0000aef0: 6261 636b 7761 7264 733d 5472 7565 2c0a  backwards=True,.
+0000af00: 2020 2020 2020 2020 6c69 6d69 743d 312c          limit=1,
+0000af10: 0a20 2020 2029 0a29 0a0a 6173 7365 7274  .    ).)..assert
+0000af20: 206c 656e 2865 7665 6e74 7329 203d 3d20   len(events) == 
+0000af30: 310a 0a61 7373 6572 7420 6576 656e 7473  1..assert events
+0000af40: 5b30 5d2e 636f 6d6d 6974 5f70 6f73 6974  [0].commit_posit
+0000af50: 696f 6e20 3c20 636f 6d6d 6974 5f70 6f73  ion < commit_pos
+0000af60: 6974 696f 6e32 0a60 6060 0a0a 0a23 2323  ition2.```...###
+0000af70: 2047 6574 2063 7572 7265 6e74 2073 7472   Get current str
+0000af80: 6561 6d20 706f 7369 7469 6f6e 0a0a 5468  eam position..Th
+0000af90: 6520 6067 6574 5f73 7472 6561 6d5f 706f  e `get_stream_po
+0000afa0: 7369 7469 6f6e 2829 6020 6d65 7468 6f64  sition()` method
+0000afb0: 2063 616e 2062 6520 7573 6564 2074 6f0a   can be used to.
+0000afc0: 6765 7420 7468 6520 2273 7472 6561 6d20  get the "stream 
+0000afd0: 706f 7369 7469 6f6e 2220 6f66 2074 6865  position" of the
+0000afe0: 206c 6173 7420 7265 636f 7264 6564 2065   last recorded e
+0000aff0: 7665 6e74 2069 6e20 6120 7374 7265 616d  vent in a stream
+0000b000: 2e0a 0a54 6869 7320 6d65 7468 6f64 2068  ...This method h
+0000b010: 6173 2061 2060 7374 7265 616d 5f6e 616d  as a `stream_nam
+0000b020: 6560 2061 7267 756d 656e 742c 2077 6869  e` argument, whi
+0000b030: 6368 2069 7320 7265 7175 6972 6564 2e0a  ch is required..
+0000b040: 0a54 6869 7320 6d65 7468 6f64 2061 6c73  .This method als
+0000b050: 6f20 7461 6b65 7320 616e 206f 7074 696f  o takes an optio
+0000b060: 6e61 6c20 6074 696d 656f 7574 6020 6172  nal `timeout` ar
+0000b070: 6775 6d65 6e74 2c20 7468 6174 0a69 7320  gument, that.is 
+0000b080: 6578 7065 6374 6564 2074 6f20 6265 2061  expected to be a
+0000b090: 2050 7974 686f 6e20 6066 6c6f 6174 602c   Python `float`,
+0000b0a0: 2077 6869 6368 2073 6574 7320 6120 6465   which sets a de
+0000b0b0: 6164 6c69 6e65 0a66 6f72 2074 6865 2063  adline.for the c
+0000b0c0: 6f6d 706c 6574 696f 6e20 6f66 2074 6865  ompletion of the
+0000b0d0: 2067 5250 4320 6f70 6572 6174 696f 6e2e   gRPC operation.
+0000b0e0: 0a0a 5468 6520 7365 7175 656e 6365 206f  ..The sequence o
+0000b0f0: 6620 706f 7369 7469 6f6e 7320 696e 2061  f positions in a
+0000b100: 2073 7472 6561 6d20 6973 2067 6170 6c65   stream is gaple
+0000b110: 7373 2e20 4974 2069 7320 7a65 726f 2d62  ss. It is zero-b
+0000b120: 6173 6564 2c0a 736f 2074 6861 7420 6120  ased,.so that a 
+0000b130: 7374 7265 616d 2077 6974 6820 6f6e 6520  stream with one 
+0000b140: 7265 636f 7264 6564 2065 7665 6e74 2068  recorded event h
+0000b150: 6173 2061 2063 7572 7265 6e74 2073 7472  as a current str
+0000b160: 6561 6d0a 706f 7369 7469 6f6e 206f 6620  eam.position of 
+0000b170: 6030 602e 2054 6865 2063 7572 7265 6e74  `0`. The current
+0000b180: 2073 7472 6561 6d20 706f 7369 7469 6f6e   stream position
+0000b190: 2069 7320 6031 6020 7768 656e 2061 2073   is `1` when a s
+0000b1a0: 7472 6561 6d20 6861 730a 7477 6f20 6576  tream has.two ev
+0000b1b0: 656e 7473 2c20 616e 6420 6974 2069 7320  ents, and it is 
+0000b1c0: 6032 6020 7768 656e 2074 6865 7265 2061  `2` when there a
+0000b1d0: 7265 2065 7665 6e74 732c 2061 6e64 2073  re events, and s
+0000b1e0: 6f20 6f6e 2e0a 0a49 6e20 7468 6520 6578  o on...In the ex
+0000b1f0: 616d 706c 6520 6265 6c6f 772c 2074 6865  ample below, the
+0000b200: 2063 7572 7265 6e74 2073 7472 6561 6d20   current stream 
+0000b210: 706f 7369 7469 6f6e 2069 7320 6f62 7461  position is obta
+0000b220: 696e 6564 206f 6620 7468 650a 7374 7265  ined of the.stre
+0000b230: 616d 2074 6f20 7768 6963 6820 6576 656e  am to which even
+0000b240: 7473 2077 6572 6520 6170 7065 6e64 6564  ts were appended
+0000b250: 2069 6e20 7468 6520 6578 616d 706c 6573   in the examples
+0000b260: 2061 626f 7665 2e0a 4265 6361 7573 6520   above..Because 
+0000b270: 7468 6520 7365 7175 656e 6365 206f 6620  the sequence of 
+0000b280: 7374 7265 616d 2070 6f73 6974 696f 6e73  stream positions
+0000b290: 2069 7320 7a65 726f 2d62 6173 6564 2c20   is zero-based, 
+0000b2a0: 616e 6420 6265 6361 7573 650a 7468 7265  and because.thre
+0000b2b0: 6520 6576 656e 7473 2077 6572 6520 6170  e events were ap
+0000b2c0: 7065 6e64 6564 2c20 736f 2074 6865 2063  pended, so the c
+0000b2d0: 7572 7265 6e74 2073 7472 6561 6d20 706f  urrent stream po
+0000b2e0: 7369 7469 6f6e 2069 7320 6032 602e 0a0a  sition is `2`...
+0000b2f0: 6060 6070 7974 686f 6e0a 7374 7265 616d  ```python.stream
+0000b300: 5f70 6f73 6974 696f 6e20 3d20 636c 6965  _position = clie
+0000b310: 6e74 2e67 6574 5f73 7472 6561 6d5f 706f  nt.get_stream_po
+0000b320: 7369 7469 6f6e 280a 2020 2020 7374 7265  sition(.    stre
+0000b330: 616d 5f6e 616d 653d 7374 7265 616d 5f6e  am_name=stream_n
+0000b340: 616d 6531 0a29 0a0a 6173 7365 7274 2073  ame1.)..assert s
+0000b350: 7472 6561 6d5f 706f 7369 7469 6f6e 203d  tream_position =
+0000b360: 3d20 320a 6060 600a 0a49 6620 6120 7374  = 2.```..If a st
+0000b370: 7265 616d 2064 6f65 7320 6e6f 7420 6578  ream does not ex
+0000b380: 6973 742c 2074 6865 2072 6574 7572 6e65  ist, the returne
+0000b390: 6420 7374 7265 616d 2070 6f73 6974 696f  d stream positio
+0000b3a0: 6e20 7661 6c75 6520 6973 2060 4e6f 6e65  n value is `None
+0000b3b0: 602c 0a77 6869 6368 206d 6174 6368 6573  `,.which matches
+0000b3c0: 2074 6865 2072 6571 7569 7265 6420 6578   the required ex
+0000b3d0: 7065 6374 6564 2070 6f73 6974 696f 6e20  pected position 
+0000b3e0: 7768 656e 2061 7070 656e 6469 6e67 2074  when appending t
+0000b3f0: 6865 2066 6972 7374 2065 7665 6e74 0a6f  he first event.o
+0000b400: 6620 6120 6e65 7720 7374 7265 616d 2028  f a new stream (
+0000b410: 7365 6520 6162 6f76 6529 2e0a 0a60 6060  see above)...```
+0000b420: 7079 7468 6f6e 0a73 7472 6561 6d5f 706f  python.stream_po
+0000b430: 7369 7469 6f6e 203d 2063 6c69 656e 742e  sition = client.
+0000b440: 6765 745f 7374 7265 616d 5f70 6f73 6974  get_stream_posit
+0000b450: 696f 6e28 0a20 2020 2073 7472 6561 6d5f  ion(.    stream_
+0000b460: 6e61 6d65 3d73 7472 2875 7569 6434 2829  name=str(uuid4()
+0000b470: 290a 290a 0a61 7373 6572 7420 7374 7265  ).)..assert stre
+0000b480: 616d 5f70 6f73 6974 696f 6e20 3d3d 204e  am_position == N
+0000b490: 6f6e 650a 6060 600a 0a54 6869 7320 6d65  one.```..This me
+0000b4a0: 7468 6f64 2074 616b 6573 2061 6e20 6f70  thod takes an op
+0000b4b0: 7469 6f6e 616c 2061 7267 756d 656e 7420  tional argument 
+0000b4c0: 6074 696d 656f 7574 6020 7768 6963 6820  `timeout` which 
+0000b4d0: 6973 2061 2050 7974 686f 6e20 6066 6c6f  is a Python `flo
+0000b4e0: 6174 6020 7468 6174 2073 6574 730a 6120  at` that sets.a 
+0000b4f0: 6465 6164 6c69 6e65 2066 6f72 2074 6865  deadline for the
+0000b500: 2063 6f6d 706c 6574 696f 6e20 6f66 2074   completion of t
+0000b510: 6865 2067 5250 4320 6f70 6572 6174 696f  he gRPC operatio
+0000b520: 6e2e 0a0a 0a23 2323 2047 6574 2063 7572  n....### Get cur
+0000b530: 7265 6e74 2063 6f6d 6d69 7420 706f 7369  rent commit posi
+0000b540: 7469 6f6e 0a0a 5468 6520 6d65 7468 6f64  tion..The method
+0000b550: 2060 6765 745f 636f 6d6d 6974 5f70 6f73   `get_commit_pos
+0000b560: 6974 696f 6e28 2960 2063 616e 2062 6520  ition()` can be 
+0000b570: 7573 6564 2074 6f20 6765 7420 7468 6520  used to get the 
+0000b580: 6375 7272 656e 740a 636f 6d6d 6974 2070  current.commit p
+0000b590: 6f73 6974 696f 6e20 6f66 2074 6865 2064  osition of the d
+0000b5a0: 6174 6162 6173 652e 0a0a 6060 6070 7974  atabase...```pyt
+0000b5b0: 686f 6e0a 636f 6d6d 6974 5f70 6f73 6974  hon.commit_posit
+0000b5c0: 696f 6e20 3d20 636c 6965 6e74 2e67 6574  ion = client.get
+0000b5d0: 5f63 6f6d 6d69 745f 706f 7369 7469 6f6e  _commit_position
+0000b5e0: 2829 0a60 6060 0a0a 5468 6973 206d 6574  ().```..This met
+0000b5f0: 686f 6420 7461 6b65 7320 616e 206f 7074  hod takes an opt
+0000b600: 696f 6e61 6c20 6172 6775 6d65 6e74 2060  ional argument `
+0000b610: 7469 6d65 6f75 7460 2077 6869 6368 2069  timeout` which i
+0000b620: 7320 6120 5079 7468 6f6e 2060 666c 6f61  s a Python `floa
+0000b630: 7460 2074 6861 7420 7365 7473 0a61 2064  t` that sets.a d
+0000b640: 6561 646c 696e 6520 666f 7220 7468 6520  eadline for the 
+0000b650: 636f 6d70 6c65 7469 6f6e 206f 6620 7468  completion of th
+0000b660: 6520 6752 5043 206f 7065 7261 7469 6f6e  e gRPC operation
+0000b670: 2e0a 0a54 6869 7320 6d65 7468 6f64 2063  ...This method c
+0000b680: 616e 2062 6520 7573 6566 756c 2074 6f20  an be useful to 
+0000b690: 6d65 6173 7572 6520 7072 6f67 7265 7373  measure progress
+0000b6a0: 206f 6620 6120 646f 776e 7374 7265 616d   of a downstream
+0000b6b0: 2063 6f6d 706f 6e65 6e74 0a74 6861 7420   component.that 
+0000b6c0: 6973 2070 726f 6365 7373 696e 6720 616c  is processing al
+0000b6d0: 6c20 7265 636f 7264 6564 2065 7665 6e74  l recorded event
+0000b6e0: 732c 2062 7920 636f 6d70 6172 696e 6720  s, by comparing 
+0000b6f0: 7468 6520 6375 7272 656e 7420 636f 6d6d  the current comm
+0000b700: 6974 0a70 6f73 6974 696f 6e20 7769 7468  it.position with
+0000b710: 2074 6865 2072 6563 6f72 6465 6420 636f   the recorded co
+0000b720: 6d6d 6974 2070 6f73 6974 696f 6e20 6f66  mmit position of
+0000b730: 2074 6865 206c 6173 7420 7375 6363 6573   the last succes
+0000b740: 7366 756c 6c79 2070 726f 6365 7373 6564  sfully processed
+0000b750: 0a65 7665 6e74 2069 6e20 6120 646f 776e  .event in a down
+0000b760: 7374 7265 616d 2063 6f6d 706f 6e65 6e74  stream component
+0000b770: 2e0a 0a54 6865 2076 616c 7565 206f 6620  ...The value of 
+0000b780: 7468 6520 6063 6f6d 6d69 745f 706f 7369  the `commit_posi
+0000b790: 7469 6f6e 6020 6172 6775 6d65 6e74 2077  tion` argument w
+0000b7a0: 6865 6e20 7265 6164 696e 6720 6576 656e  hen reading even
+0000b7b0: 7473 2065 6974 6865 7220 6279 2075 7369  ts either by usi
+0000b7c0: 6e67 0a74 6865 2060 7265 6164 5f61 6c6c  ng.the `read_all
+0000b7d0: 5f65 7665 6e74 7328 2960 206d 6574 686f  _events()` metho
+0000b7e0: 6420 6f72 2062 7920 7573 696e 6720 6120  d or by using a 
+0000b7f0: 6361 7463 682d 7570 2073 7562 7363 7269  catch-up subscri
+0000b800: 7074 696f 6e20 776f 756c 6420 7573 7561  ption would usua
+0000b810: 6c6c 790a 6265 2064 6574 6572 6d69 6e65  lly.be determine
+0000b820: 6420 6279 2074 6865 2072 6563 6f72 6465  d by the recorde
+0000b830: 6420 636f 6d6d 6974 2070 6f73 6974 696f  d commit positio
+0000b840: 6e20 6f66 2074 6865 206c 6173 7420 7375  n of the last su
+0000b850: 6363 6573 7366 756c 6c79 2070 726f 6365  ccessfully proce
+0000b860: 7373 6564 0a65 7665 6e74 2069 6e20 6120  ssed.event in a 
+0000b870: 646f 776e 7374 7265 616d 2063 6f6d 706f  downstream compo
+0000b880: 6e65 6e74 2e0a 0a0a 2323 2320 4765 7420  nent....### Get 
+0000b890: 7374 7265 616d 206d 6574 6164 6174 610a  stream metadata.
+0000b8a0: 0a54 6865 206d 6574 686f 6420 6067 6574  .The method `get
+0000b8b0: 5f73 7472 6561 6d5f 6d65 7461 6461 7461  _stream_metadata
+0000b8c0: 2829 6020 6765 7473 2074 6865 206d 6574  ()` gets the met
+0000b8d0: 6164 6174 6120 666f 7220 6120 7374 7265  adata for a stre
+0000b8e0: 616d 2c20 616c 6f6e 670a 7769 7468 2074  am, along.with t
+0000b8f0: 6865 2076 6572 7369 6f6e 206f 6620 7468  he version of th
+0000b900: 6520 7374 7265 616d 206d 6574 6164 6174  e stream metadat
+0000b910: 612e 0a0a 6060 6070 7974 686f 6e0a 6d65  a...```python.me
+0000b920: 7461 6461 7461 2c20 6d65 7461 6461 7461  tadata, metadata
+0000b930: 5f76 6572 7369 6f6e 203d 2063 6c69 656e  _version = clien
+0000b940: 742e 6765 745f 7374 7265 616d 5f6d 6574  t.get_stream_met
+0000b950: 6164 6174 6128 7374 7265 616d 5f6e 616d  adata(stream_nam
+0000b960: 653d 7374 7265 616d 5f6e 616d 6531 290a  e=stream_name1).
+0000b970: 6060 600a 0a54 6865 2072 6574 7572 6e65  ```..The returne
+0000b980: 6420 606d 6574 6164 6174 6160 2076 616c  d `metadata` val
+0000b990: 7565 2069 7320 6120 5079 7468 6f6e 2060  ue is a Python `
+0000b9a0: 6469 6374 602e 2054 6865 2072 6574 7572  dict`. The retur
+0000b9b0: 6e65 6420 606d 6574 6164 6174 615f 7665  ned `metadata_ve
+0000b9c0: 7273 696f 6e60 0a76 616c 7565 2069 7320  rsion`.value is 
+0000b9d0: 6569 7468 6572 2061 6e20 6069 6e74 602c  either an `int`,
+0000b9e0: 206f 7220 604e 6f6e 6560 2069 6620 7468   or `None` if th
+0000b9f0: 6520 7374 7265 616d 2064 6f65 7320 6e6f  e stream does no
+0000ba00: 7420 6578 6973 742e 2054 6865 7365 2076  t exist. These v
+0000ba10: 616c 7565 7320 6361 6e0a 6265 2070 6173  alues can.be pas
+0000ba20: 7365 6420 696e 746f 2060 7365 745f 7374  sed into `set_st
+0000ba30: 7265 616d 5f6d 6574 6164 6174 6128 2960  ream_metadata()`
+0000ba40: 2e0a 0a0a 2323 2320 5365 7420 7374 7265  ....### Set stre
+0000ba50: 616d 206d 6574 6164 6174 610a 0a2a 7265  am metadata..*re
+0000ba60: 7175 6972 6573 206c 6561 6465 722a 0a0a  quires leader*..
+0000ba70: 5468 6520 6d65 7468 6f64 2060 7365 745f  The method `set_
+0000ba80: 7374 7265 616d 5f6d 6574 6164 6174 6128  stream_metadata(
+0000ba90: 2960 2073 6574 7320 7468 6520 6d65 7461  )` sets the meta
+0000baa0: 6461 7461 2066 6f72 2061 2073 7472 6561  data for a strea
+0000bab0: 6d2c 2061 6c6f 6e67 0a77 6974 6820 7468  m, along.with th
+0000bac0: 6520 7665 7273 696f 6e20 6f66 2074 6865  e version of the
+0000bad0: 2073 7472 6561 6d20 6d65 7461 6461 7461   stream metadata
+0000bae0: 2e0a 0a60 6060 7079 7468 6f6e 0a6d 6574  ...```python.met
+0000baf0: 6164 6174 615b 2266 6f6f 225d 203d 2022  adata["foo"] = "
+0000bb00: 6261 7222 0a0a 636c 6965 6e74 2e73 6574  bar"..client.set
+0000bb10: 5f73 7472 6561 6d5f 6d65 7461 6461 7461  _stream_metadata
+0000bb20: 280a 2020 2020 7374 7265 616d 5f6e 616d  (.    stream_nam
+0000bb30: 653d 7374 7265 616d 5f6e 616d 6531 2c0a  e=stream_name1,.
+0000bb40: 2020 2020 6d65 7461 6461 7461 3d6d 6574      metadata=met
+0000bb50: 6164 6174 612c 0a20 2020 2065 7870 6563  adata,.    expec
+0000bb60: 7465 645f 706f 7369 7469 6f6e 3d6d 6574  ted_position=met
+0000bb70: 6164 6174 615f 7665 7273 696f 6e2c 0a29  adata_version,.)
+0000bb80: 0a60 6060 0a0a 5468 6520 6065 7870 6563  .```..The `expec
+0000bb90: 7465 645f 706f 7369 7469 6f6e 6020 6172  ted_position` ar
+0000bba0: 6775 6d65 6e74 2073 686f 756c 6420 6265  gument should be
+0000bbb0: 2074 6865 2063 7572 7265 6e74 2076 6572   the current ver
+0000bbc0: 7369 6f6e 206f 6620 7468 6520 7374 7265  sion of the stre
+0000bbd0: 616d 206d 6574 6164 6174 612e 0a0a 506c  am metadata...Pl
+0000bbe0: 6561 7365 2072 6566 6572 2074 6f20 7468  ease refer to th
+0000bbf0: 6520 4576 656e 7453 746f 7265 4442 2064  e EventStoreDB d
+0000bc00: 6f63 756d 656e 7461 7469 6f6e 2066 6f72  ocumentation for
+0000bc10: 206d 6f72 6520 696e 666f 726d 6174 696f   more informatio
+0000bc20: 6e20 6162 6f75 7420 7374 7265 616d 0a6d  n about stream.m
+0000bc30: 6574 6164 6174 612e 0a0a 2323 2320 4465  etadata...### De
+0000bc40: 6c65 7465 2073 7472 6561 6d0a 0a2a 7265  lete stream..*re
+0000bc50: 7175 6972 6573 206c 6561 6465 722a 0a0a  quires leader*..
+0000bc60: 5468 6520 6d65 7468 6f64 2060 6465 6c65  The method `dele
+0000bc70: 7465 5f73 7472 6561 6d28 2960 2063 616e  te_stream()` can
+0000bc80: 2062 6520 7573 6564 2074 6f20 2264 656c   be used to "del
+0000bc90: 6574 6522 2061 2073 7472 6561 6d2e 0a0a  ete" a stream...
+0000bca0: 6060 6070 7974 686f 6e0a 636f 6d6d 6974  ```python.commit
+0000bcb0: 5f70 6f73 6974 696f 6e20 3d20 636c 6965  _position = clie
+0000bcc0: 6e74 2e64 656c 6574 655f 7374 7265 616d  nt.delete_stream
+0000bcd0: 2873 7472 6561 6d5f 6e61 6d65 3d73 7472  (stream_name=str
+0000bce0: 6561 6d5f 6e61 6d65 312c 2065 7870 6563  eam_name1, expec
+0000bcf0: 7465 645f 706f 7369 7469 6f6e 3d32 290a  ted_position=2).
+0000bd00: 6060 600a 0a41 6674 6572 2064 656c 6574  ```..After delet
+0000bd10: 696e 6720 6120 7374 7265 616d 2c20 6974  ing a stream, it
+0000bd20: 2773 2073 7469 6c6c 2070 6f73 7369 626c  's still possibl
+0000bd30: 6520 746f 2061 7070 656e 6420 6e65 7720  e to append new 
+0000bd40: 6576 656e 7473 2e20 5265 6164 696e 6720  events. Reading 
+0000bd50: 6672 6f6d 2061 0a64 656c 6574 6564 2073  from a.deleted s
+0000bd60: 7472 6561 6d20 7769 6c6c 2072 6574 7572  tream will retur
+0000bd70: 6e20 6f6e 6c79 2065 7665 6e74 7320 7468  n only events th
+0000bd80: 6174 2068 6176 6520 6265 656e 2061 7070  at have been app
+0000bd90: 656e 6465 6420 6166 7465 7220 6974 2077  ended after it w
+0000bda0: 6173 0a64 656c 6574 6564 2e0a 0a23 2323  as.deleted...###
+0000bdb0: 2054 6f6d 6273 746f 6e65 2073 7472 6561   Tombstone strea
+0000bdc0: 6d0a 0a2a 7265 7175 6972 6573 206c 6561  m..*requires lea
+0000bdd0: 6465 722a 0a0a 5468 6520 6d65 7468 6f64  der*..The method
+0000bde0: 2060 746f 6d62 7374 6f6e 655f 7374 7265   `tombstone_stre
+0000bdf0: 616d 2829 6020 6361 6e20 6265 2075 7365  am()` can be use
+0000be00: 6420 746f 2022 746f 6d62 7374 6f6e 6522  d to "tombstone"
+0000be10: 2061 2073 7472 6561 6d2e 0a0a 6060 6070   a stream...```p
+0000be20: 7974 686f 6e0a 636f 6d6d 6974 5f70 6f73  ython.commit_pos
+0000be30: 6974 696f 6e20 3d20 636c 6965 6e74 2e74  ition = client.t
+0000be40: 6f6d 6273 746f 6e65 5f73 7472 6561 6d28  ombstone_stream(
+0000be50: 7374 7265 616d 5f6e 616d 653d 7374 7265  stream_name=stre
+0000be60: 616d 5f6e 616d 6531 2c20 6578 7065 6374  am_name1, expect
+0000be70: 6564 5f70 6f73 6974 696f 6e3d 3229 0a60  ed_position=2).`
+0000be80: 6060 0a0a 4166 7465 7220 746f 6d62 7374  ``..After tombst
+0000be90: 6f6e 696e 6720 6120 7374 7265 616d 2c20  oning a stream, 
+0000bea0: 6974 2773 206e 6f74 2070 6f73 7369 626c  it's not possibl
+0000beb0: 6520 746f 2061 7070 656e 6420 6e65 7720  e to append new 
+0000bec0: 6576 656e 7473 2e0a 0a0a 2323 2043 6174  events....## Cat
+0000bed0: 6368 2d75 7020 7375 6273 6372 6970 7469  ch-up subscripti
+0000bee0: 6f6e 730a 0a22 4361 7463 682d 7570 2220  ons.."Catch-up" 
+0000bef0: 7375 6273 6372 6970 7469 6f6e 7320 6361  subscriptions ca
+0000bf00: 6e20 6265 2075 7365 6420 746f 2072 6563  n be used to rec
+0000bf10: 6569 7665 2065 7665 6e74 7320 7468 6174  eive events that
+0000bf20: 2068 6176 6520 6265 656e 2072 6563 6f72   have been recor
+0000bf30: 6465 640a 696e 2074 6865 2064 6174 6162  ded.in the datab
+0000bf40: 6173 652c 2061 6e64 2061 6c73 6f20 6576  ase, and also ev
+0000bf50: 656e 7473 2074 6861 7420 6172 6520 7265  ents that are re
+0000bf60: 636f 7264 6564 2061 6674 6572 2061 2073  corded after a s
+0000bf70: 7562 7363 7269 7074 696f 6e20 7761 7320  ubscription was 
+0000bf80: 7374 6172 7465 642e 0a0a 5468 6520 6d65  started...The me
+0000bf90: 7468 6f64 2060 7375 6273 6372 6962 655f  thod `subscribe_
+0000bfa0: 616c 6c5f 6576 656e 7473 2829 6020 7374  all_events()` st
+0000bfb0: 6172 7473 2061 2063 6174 6368 2d75 7020  arts a catch-up 
+0000bfc0: 7375 6273 6372 6970 7469 6f6e 2074 6f20  subscription to 
+0000bfd0: 7265 6365 6976 6520 616c 6c0a 6576 656e  receive all.even
+0000bfe0: 7473 2074 6861 7420 6861 7665 2062 6565  ts that have bee
+0000bff0: 6e20 616e 6420 7769 6c6c 2062 6520 7265  n and will be re
+0000c000: 636f 7264 6564 2069 6e20 7468 6520 6461  corded in the da
+0000c010: 7461 6261 7365 2e20 5468 6520 6d65 7468  tabase. The meth
+0000c020: 6f64 0a60 7375 6273 6372 6962 655f 7374  od.`subscribe_st
+0000c030: 7265 616d 5f65 7665 6e74 7328 2960 2073  ream_events()` s
+0000c040: 7461 7274 7320 6120 6361 7463 682d 7570  tarts a catch-up
+0000c050: 2073 7562 7363 7269 7074 696f 6e20 746f   subscription to
+0000c060: 2072 6563 6569 7665 2065 7665 6e74 7320   receive events 
+0000c070: 6672 6f6d 0a61 2073 7065 6369 6669 6320  from.a specific 
+0000c080: 7374 7265 616d 2e0a 0a43 6174 6368 2d75  stream...Catch-u
+0000c090: 7020 7375 6273 6372 6970 7469 6f6e 7320  p subscriptions 
+0000c0a0: 656e 6361 7073 756c 6174 6520 6120 7374  encapsulate a st
+0000c0b0: 7265 616d 696e 6720 6752 5043 2063 616c  reaming gRPC cal
+0000c0c0: 6c20 7768 6963 6820 6973 0a6b 6570 7420  l which is.kept 
+0000c0d0: 6f70 656e 2062 7920 7468 6520 7365 7276  open by the serv
+0000c0e0: 6572 2c20 7769 7468 206e 6577 6c79 2072  er, with newly r
+0000c0f0: 6563 6f72 6465 6420 6576 656e 7473 2073  ecorded events s
+0000c100: 656e 7420 746f 2074 6865 2063 6c69 656e  ent to the clien
+0000c110: 740a 6173 2074 6865 2063 6c69 656e 7420  t.as the client 
+0000c120: 6974 6572 6174 6573 206f 7665 7220 7468  iterates over th
+0000c130: 6520 7375 6273 6372 6970 7469 6f6e 2072  e subscription r
+0000c140: 6573 706f 6e73 652e 0a0a 4d61 6e79 2063  esponse...Many c
+0000c150: 6174 6368 2d75 7020 7375 6273 6372 6970  atch-up subscrip
+0000c160: 7469 6f6e 7320 6361 6e20 6265 2063 7265  tions can be cre
+0000c170: 6174 6564 2c20 636f 6e63 7572 7265 6e74  ated, concurrent
+0000c180: 6c79 206f 7220 7375 6363 6573 7369 7665  ly or successive
+0000c190: 6c79 2c20 616e 6420 616c 6c0a 7769 6c6c  ly, and all.will
+0000c1a0: 2072 6563 6569 7665 2061 6c6c 2074 6865   receive all the
+0000c1b0: 2072 6563 6f72 6465 6420 6576 656e 7473   recorded events
+0000c1c0: 2074 6865 7920 6861 7665 2062 6565 6e20   they have been 
+0000c1d0: 7265 7175 6573 7465 6420 746f 2072 6563  requested to rec
+0000c1e0: 6569 7665 2e0a 0a54 6865 2072 6563 6569  eive...The recei
+0000c1f0: 7665 6420 7265 636f 7264 6564 2065 7665  ved recorded eve
+0000c200: 6e74 206f 626a 6563 7420 6172 6520 696e  nt object are in
+0000c210: 7374 616e 6365 7320 6f66 2074 6865 2060  stances of the `
+0000c220: 5265 636f 7264 6564 4576 656e 7460 2063  RecordedEvent` c
+0000c230: 6c61 7373 0a28 7365 6520 7468 6520 4e6f  lass.(see the No
+0000c240: 7465 7320 7365 6374 696f 6e20 6265 6c6f  tes section belo
+0000c250: 7720 666f 7220 6465 7461 696c 7320 6f66  w for details of
+0000c260: 2074 6869 7320 636c 6173 7329 2e0a 0a23   this class)...#
+0000c270: 2323 2048 6f77 2074 6f20 696d 706c 656d  ## How to implem
+0000c280: 656e 7420 6578 6163 746c 792d 6f6e 6365  ent exactly-once
+0000c290: 2065 7665 6e74 2070 726f 6365 7373 696e   event processin
+0000c2a0: 670a 0a54 6865 2063 6f6d 6d69 7420 706f  g..The commit po
+0000c2b0: 7369 7469 6f6e 7320 6f66 2072 6563 6f72  sitions of recor
+0000c2c0: 6465 6420 6576 656e 7473 2074 6861 7420  ded events that 
+0000c2d0: 6172 6520 7265 6365 6976 6564 2061 6e64  are received and
+0000c2e0: 2070 726f 6365 7373 6564 2062 7920 610a   processed by a.
+0000c2f0: 646f 776e 7374 7265 616d 2063 6f6d 706f  downstream compo
+0000c300: 6e65 6e74 2061 7265 2075 7365 6675 6c6c  nent are usefull
+0000c310: 7920 7265 636f 7264 6564 2062 7920 7468  y recorded by th
+0000c320: 6520 646f 776e 7374 7265 616d 2063 6f6d  e downstream com
+0000c330: 706f 6e65 6e74 2073 6f20 7468 6174 0a74  ponent so that.t
+0000c340: 6865 2063 6f6d 6d69 7420 706f 7369 7469  he commit positi
+0000c350: 6f6e 206f 6620 6c61 7374 2070 726f 6365  on of last proce
+0000c360: 7373 6564 2065 7665 6e74 2063 616e 2062  ssed event can b
+0000c370: 6520 6465 7465 726d 696e 6564 2e0a 0a54  e determined...T
+0000c380: 6865 206c 6173 7420 7265 636f 7264 6564  he last recorded
+0000c390: 2063 6f6d 6d69 7420 706f 7369 7469 6f6e   commit position
+0000c3a0: 2063 616e 2062 6520 7573 6564 2074 6f20   can be used to 
+0000c3b0: 7370 6563 6966 7920 7468 6520 636f 6d6d  specify the comm
+0000c3c0: 6974 2070 6f73 6974 696f 6e20 6672 6f6d  it position from
+0000c3d0: 2077 6869 6368 0a74 6f20 7375 6273 6372   which.to subscr
+0000c3e0: 6962 6520 7768 656e 2070 726f 6365 7373  ibe when process
+0000c3f0: 696e 6720 6973 2072 6573 756d 6564 2e20  ing is resumed. 
+0000c400: 5369 6e63 6520 7468 6973 2063 6f6d 6d69  Since this commi
+0000c410: 7420 706f 7369 7469 6f6e 2077 696c 6c20  t position will 
+0000c420: 7265 7072 6573 656e 7420 7468 650a 706f  represent the.po
+0000c430: 7369 7469 6f6e 206f 6620 7468 6520 6c61  sition of the la
+0000c440: 7374 2073 7563 6365 7373 6675 6c6c 7920  st successfully 
+0000c450: 7072 6f63 6573 7365 6420 6576 656e 7420  processed event 
+0000c460: 696e 2061 2064 6f77 6e73 7472 6561 6d20  in a downstream 
+0000c470: 636f 6d70 6f6e 656e 742c 2073 6f20 6974  component, so it
+0000c480: 0a77 696c 6c20 6265 2075 7375 616c 2074  .will be usual t
+0000c490: 6f20 7761 6e74 2074 6865 206e 6578 7420  o want the next 
+0000c4a0: 6576 656e 7420 6166 7465 7220 7468 6973  event after this
+0000c4b0: 2070 6f73 6974 696f 6e2c 2062 6563 6175   position, becau
+0000c4c0: 7365 2074 6861 7420 6973 2074 6865 206e  se that is the n
+0000c4d0: 6578 740a 6576 656e 7420 7468 6174 2068  ext.event that h
+0000c4e0: 6173 206e 6f74 2079 6574 2062 6565 6e20  as not yet been 
+0000c4f0: 7072 6f63 6573 7365 642e 2046 6f72 2074  processed. For t
+0000c500: 6869 7320 7265 6173 6f6e 2c20 7768 656e  his reason, when
+0000c510: 2073 7562 7363 7269 6269 6e67 2066 6f72   subscribing for
+0000c520: 2065 7665 6e74 730a 6672 6f6d 2061 2073   events.from a s
+0000c530: 7065 6369 6669 6320 636f 6d6d 6974 2070  pecific commit p
+0000c540: 6f73 6974 696f 6e20 7573 696e 6720 6120  osition using a 
+0000c550: 6361 7463 682d 7570 2073 7562 7363 7269  catch-up subscri
+0000c560: 7074 696f 6e20 696e 2045 7665 6e74 5374  ption in EventSt
+0000c570: 6f72 6544 422c 2074 6865 0a72 6563 6f72  oreDB, the.recor
+0000c580: 6465 6420 6576 656e 7420 6174 2074 6865  ded event at the
+0000c590: 2073 7065 6369 6669 6564 2063 6f6d 6d69   specified commi
+0000c5a0: 7420 706f 7369 7469 6f6e 2077 696c 6c20  t position will 
+0000c5b0: 4e4f 5420 6265 2069 6e63 6c75 6465 6420  NOT be included 
+0000c5c0: 696e 2074 6865 2073 6571 7565 6e63 650a  in the sequence.
+0000c5d0: 6f66 2072 6563 6f72 6465 6420 6576 656e  of recorded even
+0000c5e0: 7473 2074 6861 7420 6172 6520 7265 6365  ts that are rece
+0000c5f0: 6976 6564 2e0a 0a54 6f20 6163 636f 6d70  ived...To accomp
+0000c600: 6c69 7368 2022 6578 6163 746c 792d 6f6e  lish "exactly-on
+0000c610: 6365 2220 7072 6f63 6573 7369 6e67 206f  ce" processing o
+0000c620: 6620 7265 636f 7264 6564 2065 7665 6e74  f recorded event
+0000c630: 7320 696e 2061 2064 6f77 6e73 7472 6561  s in a downstrea
+0000c640: 6d0a 636f 6d70 6f6e 656e 7420 7768 656e  m.component when
+0000c650: 2075 7369 6e67 2061 2063 6174 6368 2d75   using a catch-u
+0000c660: 7020 7375 6273 6372 6970 7469 6f6e 2c20  p subscription, 
+0000c670: 7468 6520 636f 6d6d 6974 2070 6f73 6974  the commit posit
+0000c680: 696f 6e20 6f66 2061 2072 6563 6f72 6465  ion of a recorde
+0000c690: 640a 6576 656e 7420 7368 6f75 6c64 2062  d.event should b
+0000c6a0: 6520 7265 636f 7264 6564 2061 746f 6d69  e recorded atomi
+0000c6b0: 6361 6c6c 7920 616e 6420 756e 6971 7565  cally and unique
+0000c6c0: 6c79 2061 6c6f 6e67 2077 6974 6820 7468  ly along with th
+0000c6d0: 6520 7265 7375 6c74 206f 6620 7072 6f63  e result of proc
+0000c6e0: 6573 7369 6e67 0a72 6563 6f72 6465 6420  essing.recorded 
+0000c6f0: 6576 656e 7473 2c20 666f 7220 6578 616d  events, for exam
+0000c700: 706c 6520 696e 2074 6865 2073 616d 6520  ple in the same 
+0000c710: 6461 7461 6261 7365 2061 7320 6d61 7465  database as mate
+0000c720: 7269 616c 6973 6564 2076 6965 7773 2077  rialised views w
+0000c730: 6865 6e0a 696d 706c 656d 656e 7469 6e67  hen.implementing
+0000c740: 2065 7665 6e74 7561 6c6c 792d 636f 6e73   eventually-cons
+0000c750: 6973 7465 6e74 2043 5152 532c 206f 7220  istent CQRS, or 
+0000c760: 696e 2074 6865 2073 616d 6520 6461 7461  in the same data
+0000c770: 6261 7365 2061 7320 6120 646f 776e 7374  base as a downst
+0000c780: 7265 616d 0a61 6e61 6c79 7469 6373 206f  ream.analytics o
+0000c790: 7220 7265 706f 7274 696e 6720 6f72 2061  r reporting or a
+0000c7a0: 7263 6869 7669 6e67 2061 7070 6c69 6361  rchiving applica
+0000c7b0: 7469 6f6e 2e20 4279 2072 6563 6f72 6469  tion. By recordi
+0000c7c0: 6e67 2074 6865 2063 6f6d 6d69 7420 706f  ng the commit po
+0000c7d0: 7369 7469 6f6e 0a6f 6620 7265 636f 7264  sition.of record
+0000c7e0: 6564 2065 7665 6e74 7320 6174 6f6d 6963  ed events atomic
+0000c7f0: 616c 6c79 2077 6974 6820 7468 6520 6e65  ally with the ne
+0000c800: 7720 7374 6174 6520 7468 6174 2072 6573  w state that res
+0000c810: 756c 7473 2066 726f 6d20 7072 6f63 6573  ults from proces
+0000c820: 7369 6e67 0a72 6563 6f72 6465 6420 6576  sing.recorded ev
+0000c830: 656e 7473 2c20 2264 7561 6c20 7772 6974  ents, "dual writ
+0000c840: 696e 6722 2069 6e20 7468 6520 636f 6e73  ing" in the cons
+0000c850: 756d 7074 696f 6e20 6f66 2072 6563 6f72  umption of recor
+0000c860: 6465 6420 6576 656e 7473 2063 616e 2062  ded events can b
+0000c870: 650a 6176 6f69 6465 642e 2042 7920 616c  e.avoided. By al
+0000c880: 736f 2072 6563 6f72 6469 6e67 2074 6865  so recording the
+0000c890: 2063 6f6d 6d69 7420 706f 7369 7469 6f6e   commit position
+0000c8a0: 2075 6e69 7175 656c 792c 2074 6865 206e   uniquely, the n
+0000c8b0: 6577 2073 7461 7465 2063 616e 6e6f 7420  ew state cannot 
+0000c8c0: 6265 0a72 6563 6f72 6465 6420 7477 6963  be.recorded twic
+0000c8d0: 652c 2061 6e64 2068 656e 6365 2074 6865  e, and hence the
+0000c8e0: 2072 6563 6f72 6465 6420 7374 6174 6520   recorded state 
+0000c8f0: 6f66 2074 6865 2064 6f77 6e73 7472 6561  of the downstrea
+0000c900: 6d20 636f 6d70 6f6e 656e 7420 7769 6c6c  m component will
+0000c910: 2062 650a 7570 6461 7465 6420 6f6e 6c79   be.updated only
+0000c920: 206f 6e63 6520 666f 7220 616e 7920 7265   once for any re
+0000c930: 636f 7264 6564 2065 7665 6e74 2e20 4279  corded event. By
+0000c940: 2075 7369 6e67 2074 6865 2067 7265 6174   using the great
+0000c950: 6573 7420 7265 636f 7264 6564 2063 6f6d  est recorded com
+0000c960: 6d69 740a 706f 7369 7469 6f6e 2074 6f20  mit.position to 
+0000c970: 7265 7375 6d65 2061 2063 6174 6368 2d75  resume a catch-u
+0000c980: 7020 7375 6273 6372 6970 7469 6f6e 2c20  p subscription, 
+0000c990: 616c 6c20 7265 636f 7264 6564 2065 7665  all recorded eve
+0000c9a0: 6e74 7320 7769 6c6c 2065 7665 6e74 7561  nts will eventua
+0000c9b0: 6c6c 790a 6265 2070 726f 6365 7373 6564  lly.be processed
+0000c9c0: 2e20 5468 6520 636f 6d62 696e 6174 696f  . The combinatio
+0000c9d0: 6e20 6f66 2074 6865 2022 6174 2d6d 6f73  n of the "at-mos
+0000c9e0: 742d 6f6e 6365 2220 636f 6e64 6974 696f  t-once" conditio
+0000c9f0: 6e20 616e 6420 7468 6520 2261 742d 6c65  n and the "at-le
+0000ca00: 6173 742d 6f6e 6365 220a 636f 6e64 6974  ast-once".condit
+0000ca10: 696f 6e20 6769 7665 7320 7468 6520 2265  ion gives the "e
+0000ca20: 7861 6374 6c79 2d6f 6e63 6522 2063 6f6e  xactly-once" con
+0000ca30: 6469 7469 6f6e 2e0a 0a54 6865 2064 616e  dition...The dan
+0000ca40: 6765 7220 7769 7468 2022 6475 616c 2077  ger with "dual w
+0000ca50: 7269 7469 6e67 2220 696e 2074 6865 2063  riting" in the c
+0000ca60: 6f6e 7375 6d70 7469 6f6e 206f 6620 7265  onsumption of re
+0000ca70: 636f 7264 6564 2065 7665 6e74 7320 6973  corded events is
+0000ca80: 2074 6861 7420 6966 2061 0a72 6563 6f72   that if a.recor
+0000ca90: 6465 6420 6576 656e 7420 6973 2073 7563  ded event is suc
+0000caa0: 6365 7373 6675 6c6c 7920 7072 6f63 6573  cessfully proces
+0000cab0: 7365 6420 616e 6420 6e65 7720 7374 6174  sed and new stat
+0000cac0: 6520 7265 636f 7264 6564 2061 746f 6d69  e recorded atomi
+0000cad0: 6361 6c6c 7920 696e 206f 6e65 0a74 7261  cally in one.tra
+0000cae0: 6e73 6163 7469 6f6e 2077 6974 6820 7468  nsaction with th
+0000caf0: 6520 636f 6d6d 6974 2070 6f73 6974 696f  e commit positio
+0000cb00: 6e20 7265 636f 7264 6564 2069 6e20 6120  n recorded in a 
+0000cb10: 7365 7061 7261 7465 2074 7261 6e73 6163  separate transac
+0000cb20: 7469 6f6e 2c20 6f6e 6520 6d61 790a 6861  tion, one may.ha
+0000cb30: 7070 656e 2061 6e64 206e 6f74 2074 6865  ppen and not the
+0000cb40: 206f 7468 6572 2e20 4966 2074 6865 206e   other. If the n
+0000cb50: 6577 2073 7461 7465 2069 7320 7265 636f  ew state is reco
+0000cb60: 7264 6564 2062 7574 2074 6865 2070 6f73  rded but the pos
+0000cb70: 6974 696f 6e20 6973 206c 6f73 742c 0a61  ition is lost,.a
+0000cb80: 6e64 2074 6865 6e20 7468 6520 7072 6f63  nd then the proc
+0000cb90: 6573 7369 6e67 2069 7320 7374 6f70 7065  essing is stoppe
+0000cba0: 6420 616e 6420 7265 7375 6d65 642c 2074  d and resumed, t
+0000cbb0: 6865 2072 6563 6f72 6465 6420 6576 656e  he recorded even
+0000cbc0: 7420 6d61 7920 6265 2070 726f 6365 7373  t may be process
+0000cbd0: 6564 0a74 7769 6365 2e20 4f6e 2074 6865  ed.twice. On the
+0000cbe0: 206f 7468 6572 2068 616e 642c 2069 6620   other hand, if 
+0000cbf0: 7468 6520 636f 6d6d 6974 2070 6f73 6974  the commit posit
+0000cc00: 696f 6e20 6973 2072 6563 6f72 6465 6420  ion is recorded 
+0000cc10: 6275 7420 7468 6520 6e65 7720 7374 6174  but the new stat
+0000cc20: 6520 6973 0a6c 6f73 742c 2074 6865 2072  e is.lost, the r
+0000cc30: 6563 6f72 6465 6420 6576 656e 7420 6d61  ecorded event ma
+0000cc40: 7920 6566 6665 6374 6976 656c 7920 6e6f  y effectively no
+0000cc50: 7420 6265 2070 726f 6365 7373 6564 2061  t be processed a
+0000cc60: 7420 616c 6c2e 2042 7920 6569 7468 6572  t all. By either
+0000cc70: 0a70 726f 6365 7373 696e 6720 616e 2065  .processing an e
+0000cc80: 7665 6e74 206d 6f72 6520 7468 616e 206f  vent more than o
+0000cc90: 6e63 652c 206f 7220 6279 2066 6169 6c69  nce, or by faili
+0000cca0: 6e67 2074 6f20 7072 6f63 6573 7320 616e  ng to process an
+0000ccb0: 2065 7665 6e74 2c20 7468 6520 7265 636f   event, the reco
+0000ccc0: 7264 6564 0a73 7461 7465 206f 6620 7468  rded.state of th
+0000ccd0: 6520 646f 776e 7374 7265 616d 2063 6f6d  e downstream com
+0000cce0: 706f 6e65 6e74 206d 6967 6874 2062 6520  ponent might be 
+0000ccf0: 696e 6163 6375 7261 7465 2c20 6f72 2070  inaccurate, or p
+0000cd00: 6f73 7369 626c 7920 696e 636f 6e73 6973  ossibly inconsis
+0000cd10: 7465 6e74 2c20 616e 640a 7065 7268 6170  tent, and.perhap
+0000cd20: 7320 6361 7461 7374 726f 7068 6963 616c  s catastrophical
+0000cd30: 6c79 2073 6f2e 2053 7563 6820 636f 6e73  ly so. Such cons
+0000cd40: 6571 7565 6e63 6573 206d 6179 206f 7220  equences may or 
+0000cd50: 6d61 7920 6e6f 7420 6d61 7474 6572 2069  may not matter i
+0000cd60: 6e20 796f 7572 2073 6974 7561 7469 6f6e  n your situation
+0000cd70: 2e0a 4275 7420 736f 6d65 7469 6d65 7320  ..But sometimes 
+0000cd80: 696e 636f 6e73 6973 7465 6e63 6965 7320  inconsistencies 
+0000cd90: 6d61 7920 6861 6c74 2070 726f 6365 7373  may halt process
+0000cda0: 696e 6720 756e 7469 6c20 7468 6520 6973  ing until the is
+0000cdb0: 7375 6520 6973 2072 6573 6f6c 7665 642e  sue is resolved.
+0000cdc0: 2059 6f75 2063 616e 0a61 766f 6964 2022   You can.avoid "
+0000cdd0: 6475 616c 2077 7269 7469 6e67 2220 696e  dual writing" in
+0000cde0: 2074 6865 2063 6f6e 7375 6d70 7469 6f6e   the consumption
+0000cdf0: 206f 6620 6576 656e 7473 2062 7920 6174   of events by at
+0000ce00: 6f6d 6963 616c 6c79 2072 6563 6f72 6469  omically recordi
+0000ce10: 6e67 2074 6865 2063 6f6d 6d69 740a 706f  ng the commit.po
+0000ce20: 7369 7469 6f6e 206f 6620 6120 7265 636f  sition of a reco
+0000ce30: 7264 6564 2065 7665 6e74 2061 6c6f 6e67  rded event along
+0000ce40: 2077 6974 6820 7468 6520 6e65 7720 7374   with the new st
+0000ce50: 6174 6520 7468 6174 2072 6573 756c 7473  ate that results
+0000ce60: 2066 726f 6d20 7072 6f63 6573 7369 6e67   from processing
+0000ce70: 2074 6861 740a 6576 656e 7420 696e 2074   that.event in t
+0000ce80: 6865 2073 616d 6520 6174 6f6d 6963 2074  he same atomic t
+0000ce90: 7261 6e73 6163 7469 6f6e 2e20 4279 206d  ransaction. By m
+0000cea0: 616b 696e 6720 7468 6520 7265 636f 7264  aking the record
+0000ceb0: 696e 6720 6f66 2074 6865 2063 6f6d 6d69  ing of the commi
+0000cec0: 7420 706f 7369 7469 6f6e 730a 756e 6971  t positions.uniq
+0000ced0: 7565 2c20 736f 2074 6861 7420 7472 616e  ue, so that tran
+0000cee0: 7361 6374 696f 6e73 2077 696c 6c20 6265  sactions will be
+0000cef0: 2072 6f6c 6c65 6420 6261 636b 2077 6865   rolled back whe
+0000cf00: 6e20 7468 6572 6520 6973 2061 2063 6f6e  n there is a con
+0000cf10: 666c 6963 742c 2079 6f75 2077 696c 6c0a  flict, you will.
+0000cf20: 7072 6576 656e 7420 7468 6520 7265 7375  prevent the resu
+0000cf30: 6c74 7320 6f66 2061 6e79 2064 7570 6c69  lts of any dupli
+0000cf40: 6361 7465 2070 726f 6365 7373 696e 6720  cate processing 
+0000cf50: 6f66 2061 2072 6563 6f72 6465 6420 6576  of a recorded ev
+0000cf60: 656e 7420 6265 696e 6720 636f 6d6d 6974  ent being commit
+0000cf70: 7465 642e 0a0a 5265 636f 7264 6564 2065  ted...Recorded e
+0000cf80: 7665 6e74 7320 7265 6365 6976 6564 2066  vents received f
+0000cf90: 726f 6d20 6120 6361 7463 682d 7570 2073  rom a catch-up s
+0000cfa0: 7562 7363 7269 7074 696f 6e20 6361 6e6e  ubscription cann
+0000cfb0: 6f74 2062 6520 6163 6b6e 6f77 6c65 6467  ot be acknowledg
+0000cfc0: 6564 2062 6163 6b0a 746f 2074 6865 2045  ed back.to the E
+0000cfd0: 7665 6e74 5374 6f72 6544 4220 7365 7276  ventStoreDB serv
+0000cfe0: 6572 2e20 4163 6b6e 6f77 6c65 6467 696e  er. Acknowledgin
+0000cff0: 6720 6576 656e 7473 2c20 686f 7765 7665  g events, howeve
+0000d000: 722c 2069 7320 616e 2061 7370 6563 7420  r, is an aspect 
+0000d010: 6f66 2022 7065 7273 6973 7465 6e74 0a73  of "persistent.s
+0000d020: 7562 7363 7269 7074 696f 6e73 222e 2048  ubscriptions". H
+0000d030: 6f70 696e 6720 746f 2072 656c 7920 6f6e  oping to rely on
+0000d040: 2061 636b 6e6f 776c 6564 6769 6e67 2065   acknowledging e
+0000d050: 7665 6e74 7320 746f 2061 6e20 7570 7374  vents to an upst
+0000d060: 7265 616d 0a63 6f6d 706f 6e65 6e74 2069  ream.component i
+0000d070: 7320 616e 2065 7861 6d70 6c65 206f 6620  s an example of 
+0000d080: 6475 616c 2077 7269 7469 6e67 2e0a 0a23  dual writing...#
+0000d090: 2323 2053 7562 7363 7269 6265 2061 6c6c  ## Subscribe all
+0000d0a0: 2065 7665 6e74 730a 0a54 6865 6073 7562   events..The`sub
+0000d0b0: 7363 7269 6265 5f61 6c6c 5f65 7665 6e74  scribe_all_event
+0000d0c0: 7328 2960 206d 6574 686f 6420 6361 6e20  s()` method can 
+0000d0d0: 6265 2075 7365 6420 746f 2073 7461 7274  be used to start
+0000d0e0: 2061 2022 6361 7463 682d 7570 2220 7375   a "catch-up" su
+0000d0f0: 6273 6372 6970 7469 6f6e 0a74 6861 7420  bscription.that 
+0000d100: 6361 6e20 7265 7475 726e 2065 7665 6e74  can return event
+0000d110: 7320 6672 6f6d 2061 6c6c 2073 7472 6561  s from all strea
+0000d120: 6d73 2069 6e20 7468 6520 6461 7461 6261  ms in the databa
+0000d130: 7365 2e0a 0a54 6869 7320 6d65 7468 6f64  se...This method
+0000d140: 2063 616e 2062 6520 7573 6564 2062 7920   can be used by 
+0000d150: 6120 646f 776e 7374 7265 616d 2063 6f6d  a downstream com
+0000d160: 706f 6e65 6e74 0a74 6f20 7072 6f63 6573  ponent.to proces
+0000d170: 7320 7265 636f 7264 6564 2065 7665 6e74  s recorded event
+0000d180: 7320 7769 7468 2065 7861 6374 6c79 2d6f  s with exactly-o
+0000d190: 6e63 6520 7365 6d61 6e74 6963 732e 0a0a  nce semantics...
+0000d1a0: 5468 6973 206d 6574 686f 6420 7461 6b65  This method take
+0000d1b0: 7320 616e 206f 7074 696f 6e61 6c20 6063  s an optional `c
+0000d1c0: 6f6d 6d69 745f 706f 7369 7469 6f6e 6020  ommit_position` 
+0000d1d0: 6172 6775 6d65 6e74 2c20 7768 6963 6820  argument, which 
+0000d1e0: 6361 6e20 6265 0a75 7365 6420 746f 2073  can be.used to s
+0000d1f0: 7065 6369 6679 2061 2063 6f6d 6d69 7420  pecify a commit 
+0000d200: 706f 7369 7469 6f6e 2066 726f 6d20 7768  position from wh
+0000d210: 6963 6820 746f 2073 7562 7363 7269 6265  ich to subscribe
+0000d220: 2e20 5468 6520 6465 6661 756c 740a 7661  . The default.va
+0000d230: 6c75 6520 6973 2060 4e6f 6e65 602c 2077  lue is `None`, w
+0000d240: 6869 6368 206d 6561 6e73 2074 6865 2073  hich means the s
+0000d250: 7562 7363 7269 7074 696f 6e20 7769 6c6c  ubscription will
+0000d260: 206f 7065 7261 7465 2066 726f 6d20 7468   operate from th
+0000d270: 6520 6669 7273 740a 7265 636f 7264 6564  e first.recorded
+0000d280: 2065 7665 6e74 2069 6e20 7468 6520 6461   event in the da
+0000d290: 7461 6261 7365 2e20 4966 2061 2063 6f6d  tabase. If a com
+0000d2a0: 6d69 7420 706f 7369 7469 6f6e 2069 7320  mit position is 
+0000d2b0: 6769 7665 6e2c 2069 7420 6d75 7374 206d  given, it must m
+0000d2c0: 6174 6368 0a61 6e20 6163 7475 616c 6c79  atch.an actually
+0000d2d0: 2065 7869 7374 696e 6720 636f 6d6d 6974   existing commit
+0000d2e0: 2070 6f73 6974 696f 6e20 696e 2074 6865   position in the
+0000d2f0: 2064 6174 6162 6173 652e 2054 6865 2072   database. The r
+0000d300: 6563 6f64 6564 2065 7665 6e74 7320 7468  ecoded events th
+0000d310: 6174 0a61 7265 206f 6274 6169 6e65 6420  at.are obtained 
+0000d320: 7769 6c6c 206e 6f74 2069 6e63 6c75 6465  will not include
+0000d330: 2074 6865 2065 7665 6e74 2072 6563 6f72   the event recor
+0000d340: 6465 6420 6174 2074 6861 7420 636f 6d6d  ded at that comm
+0000d350: 6974 2070 6f73 6974 696f 6e2e 0a0a 5468  it position...Th
+0000d360: 6973 206d 6574 686f 6420 616c 736f 2074  is method also t
+0000d370: 616b 6573 2066 6f75 7220 6f74 6865 7220  akes four other 
+0000d380: 6f70 7469 6f6e 616c 2061 7267 756d 656e  optional argumen
+0000d390: 7473 2c20 6066 696c 7465 725f 6578 636c  ts, `filter_excl
+0000d3a0: 7564 6560 2c0a 6066 696c 7465 725f 696e  ude`,.`filter_in
+0000d3b0: 636c 7564 6560 2c20 6066 696c 7465 725f  clude`, `filter_
+0000d3c0: 6279 5f73 7472 6561 6d5f 6e61 6d65 602c  by_stream_name`,
+0000d3d0: 2061 6e64 2060 7469 6d65 6f75 7460 2e0a   and `timeout`..
+0000d3e0: 0a54 6865 206f 7074 696f 6e61 6c20 6172  .The optional ar
+0000d3f0: 6775 6d65 6e74 2060 6669 6c74 6572 5f65  gument `filter_e
+0000d400: 7863 6c75 6465 6020 6973 2061 2073 6571  xclude` is a seq
+0000d410: 7565 6e63 6520 6f66 2072 6567 756c 6172  uence of regular
+0000d420: 2065 7870 7265 7373 696f 6e73 2074 6861   expressions tha
+0000d430: 740a 6d61 7463 6820 7265 636f 7264 6564  t.match recorded
+0000d440: 2065 7665 6e74 7320 7468 6174 2073 686f   events that sho
+0000d450: 756c 6420 6e6f 7420 6265 2069 6e63 6c75  uld not be inclu
+0000d460: 6465 642e 2054 6869 7320 6172 6775 6d65  ded. This argume
+0000d470: 6e74 2069 7320 6967 6e6f 7265 640a 6966  nt is ignored.if
+0000d480: 2060 6669 6c74 6572 5f69 6e63 6c75 6465   `filter_include
+0000d490: 6020 6973 2073 6574 2074 6f20 6120 6e6f  ` is set to a no
+0000d4a0: 6e2d 656d 7074 7920 7365 7175 656e 6365  n-empty sequence
+0000d4b0: 2e20 4279 2064 6566 6175 6c74 2c20 7468  . By default, th
+0000d4c0: 6973 2061 7267 756d 656e 7420 6973 2073  is argument is s
+0000d4d0: 6574 0a74 6f20 6d61 7463 6820 7468 6520  et.to match the 
+0000d4e0: 6576 656e 7420 7479 7065 7320 6f66 2022  event types of "
+0000d4f0: 7379 7374 656d 2065 7665 6e74 7322 2c20  system events", 
+0000d500: 736f 2074 6861 7420 4576 656e 7453 746f  so that EventSto
+0000d510: 7265 4442 2073 7973 7465 6d20 6576 656e  reDB system even
+0000d520: 7473 0a77 696c 6c20 6e6f 7420 6e6f 726d  ts.will not norm
+0000d530: 616c 6c79 2062 6520 696e 636c 7564 6564  ally be included
+0000d540: 2e20 5365 6520 7468 6520 4e6f 7465 7320  . See the Notes 
+0000d550: 7365 6374 696f 6e20 6265 6c6f 7720 666f  section below fo
+0000d560: 7220 6d6f 7265 2069 6e66 6f72 6d61 7469  r more informati
+0000d570: 6f6e 0a61 626f 7574 2066 696c 7465 7220  on.about filter 
+0000d580: 6578 7072 6573 7369 6f6e 732e 0a0a 5468  expressions...Th
+0000d590: 6520 6f70 7469 6f6e 616c 2061 7267 756d  e optional argum
+0000d5a0: 656e 7420 6066 696c 7465 725f 696e 636c  ent `filter_incl
+0000d5b0: 7564 6560 2069 7320 6120 7365 7175 656e  ude` is a sequen
+0000d5c0: 6365 206f 6620 7265 6775 6c61 7220 6578  ce of regular ex
+0000d5d0: 7072 6573 7369 6f6e 730a 7468 6174 206d  pressions.that m
+0000d5e0: 6174 6368 2072 6563 6f72 6465 6420 6576  atch recorded ev
+0000d5f0: 656e 7473 2074 6861 7420 7368 6f75 6c64  ents that should
+0000d600: 2062 6520 696e 636c 7564 6564 2e20 4279   be included. By
+0000d610: 2064 6566 6175 6c74 2c20 7468 6973 2061   default, this a
+0000d620: 7267 756d 656e 740a 6973 2061 6e20 656d  rgument.is an em
+0000d630: 7074 7920 7475 706c 652e 2049 6620 7468  pty tuple. If th
+0000d640: 6973 2061 7267 756d 656e 7420 6973 2073  is argument is s
+0000d650: 6574 2074 6f20 6120 6e6f 6e2d 656d 7074  et to a non-empt
+0000d660: 7920 7365 7175 656e 6365 2c20 7468 650a  y sequence, the.
+0000d670: 6066 696c 7465 725f 6578 636c 7564 6560  `filter_exclude`
+0000d680: 2061 7267 756d 656e 7420 6973 2069 676e   argument is ign
+0000d690: 6f72 6564 2e0a 0a54 6865 206f 7074 696f  ored...The optio
+0000d6a0: 6e61 6c20 6172 6775 6d65 6e74 2060 6669  nal argument `fi
+0000d6b0: 6c74 6572 5f62 795f 7374 7265 616d 5f6e  lter_by_stream_n
+0000d6c0: 616d 6560 2069 7320 6120 5079 7468 6f6e  ame` is a Python
+0000d6d0: 2060 626f 6f6c 6020 7468 6174 2069 6e64   `bool` that ind
+0000d6e0: 6963 6174 6573 2077 6865 7468 6572 0a74  icates whether.t
+0000d6f0: 6865 2066 696c 7465 7220 7769 6c6c 2061  he filter will a
+0000d700: 7070 6c79 2074 6f20 6576 656e 7420 7479  pply to event ty
+0000d710: 7065 7320 6f72 2073 7472 6561 6d20 6e61  pes or stream na
+0000d720: 6d65 732e 2042 7920 6465 6661 756c 742c  mes. By default,
+0000d730: 2074 6869 7320 7661 6c75 6520 6973 2060   this value is `
+0000d740: 4661 6c73 6560 0a61 6e64 2073 6f20 7468  False`.and so th
+0000d750: 6520 6669 6c74 6572 696e 6720 7769 6c6c  e filtering will
+0000d760: 2061 7070 6c79 2074 6f20 7468 6520 6576   apply to the ev
+0000d770: 656e 7420 7479 7065 2073 7472 696e 6773  ent type strings
+0000d780: 206f 6620 7265 636f 7264 6564 2065 7665   of recorded eve
+0000d790: 6e74 732e 0a0a 506c 6561 7365 206e 6f74  nts...Please not
+0000d7a0: 652c 2074 6865 2066 696c 7465 7269 6e67  e, the filtering
+0000d7b0: 2068 6170 7065 6e73 206f 6e20 7468 6520   happens on the 
+0000d7c0: 4576 656e 7453 746f 7265 4442 2073 6572  EventStoreDB ser
+0000d7d0: 7665 722c 2061 6e64 2074 6865 0a60 6c69  ver, and the.`li
+0000d7e0: 6d69 7460 2061 7267 756d 656e 7420 6973  mit` argument is
+0000d7f0: 2061 7070 6c69 6564 206f 6e20 7468 6520   applied on the 
+0000d800: 7365 7276 6572 2061 6674 6572 2066 696c  server after fil
+0000d810: 7465 7269 6e67 2e0a 0a54 6865 206f 7074  tering...The opt
+0000d820: 696f 6e61 6c20 6074 696d 656f 7574 6020  ional `timeout` 
+0000d830: 6172 6775 6d65 6e74 2069 7320 6120 5079  argument is a Py
+0000d840: 7468 6f6e 2060 666c 6f61 7460 2077 6869  thon `float` whi
+0000d850: 6368 2073 6574 7320 610a 6465 6164 6c69  ch sets a.deadli
+0000d860: 6e65 2066 6f72 2074 6865 2063 6f6d 706c  ne for the compl
+0000d870: 6574 696f 6e20 6f66 2074 6865 2067 5250  etion of the gRP
+0000d880: 4320 6f70 6572 6174 696f 6e2e 0a0a 5468  C operation...Th
+0000d890: 6973 206d 6574 686f 6420 7265 7475 726e  is method return
+0000d8a0: 7320 6120 5079 7468 6f6e 2069 7465 7261  s a Python itera
+0000d8b0: 746f 7220 7468 6174 2079 6965 6c64 7320  tor that yields 
+0000d8c0: 7265 636f 7264 6564 2065 7665 6e74 732c  recorded events,
+0000d8d0: 2069 6e63 6c75 6469 6e67 2065 7665 6e74   including event
+0000d8e0: 730a 7468 6174 2061 7265 2072 6563 6f72  s.that are recor
+0000d8f0: 6465 6420 6166 7465 7220 7468 6520 7375  ded after the su
+0000d900: 6273 6372 6970 7469 6f6e 2077 6173 2063  bscription was c
+0000d910: 7265 6174 6564 2e20 4974 6572 6174 696e  reated. Iteratin
+0000d920: 6720 6f76 6572 2074 6869 7320 6f62 6a65  g over this obje
+0000d930: 6374 2077 696c 6c0a 7468 6572 6566 6f72  ct will.therefor
+0000d940: 6520 6e6f 7420 7374 6f70 2c20 756e 6c65  e not stop, unle
+0000d950: 7373 2074 6865 2063 6f6e 6e65 6374 696f  ss the connectio
+0000d960: 6e20 746f 2074 6865 2064 6174 6162 6173  n to the databas
+0000d970: 6520 6973 206c 6f73 742e 2054 6865 2063  e is lost. The c
+0000d980: 616c 6c20 7769 6c6c 0a62 6520 656e 6465  all will.be ende
+0000d990: 6420 7768 656e 2074 6865 2069 7465 7261  d when the itera
+0000d9a0: 746f 7220 6f62 6a65 6374 2069 7320 6465  tor object is de
+0000d9b0: 6c65 7465 6420 6672 6f6d 206d 656d 6f72  leted from memor
+0000d9c0: 792c 2077 6869 6368 2077 696c 6c20 6861  y, which will ha
+0000d9d0: 7070 656e 2077 6865 6e20 7468 650a 6974  ppen when the.it
+0000d9e0: 6572 6174 6f72 206f 626a 6563 7420 676f  erator object go
+0000d9f0: 6573 206f 7574 206f 6620 7363 6f70 6520  es out of scope 
+0000da00: 6f72 2069 7320 6578 706c 6963 6974 6c79  or is explicitly
+0000da10: 2064 656c 6574 6564 2e20 5468 6520 6361   deleted. The ca
+0000da20: 6c6c 206d 6179 2061 6c73 6f20 6265 0a63  ll may also be.c
+0000da30: 6c6f 7365 6420 6279 2074 6865 2073 6572  losed by the ser
+0000da40: 7665 722e 0a0a 5468 6520 7375 6273 6372  ver...The subscr
+0000da50: 6970 7469 6f6e 206f 626a 6563 7420 6361  iption object ca
+0000da60: 6e20 6265 2075 7365 6420 6469 7265 6374  n be used direct
+0000da70: 6c79 2c20 6275 7420 6974 206d 6967 6874  ly, but it might
+0000da80: 2062 6520 7573 6564 2077 6974 6869 6e20   be used within 
+0000da90: 6120 7468 7265 6164 6564 0a6c 6f6f 7020  a threaded.loop 
+0000daa0: 6465 6469 6361 7465 6420 746f 2072 6563  dedicated to rec
+0000dab0: 6569 7669 6e67 2065 7665 6e74 7320 7468  eiving events th
+0000dac0: 6174 2063 616e 2062 6520 7374 6f70 7065  at can be stoppe
+0000dad0: 6420 696e 2061 2063 6f6e 7472 6f6c 6c65  d in a controlle
+0000dae0: 6420 7761 792c 2077 6974 680a 7265 636f  d way, with.reco
+0000daf0: 7264 6564 2065 7665 6e74 7320 7075 7420  rded events put 
+0000db00: 6f6e 2061 2071 7565 7565 2066 6f72 2070  on a queue for p
+0000db10: 726f 6365 7373 696e 6720 696e 2061 2064  rocessing in a d
+0000db20: 6966 6665 7265 6e74 2074 6872 6561 642e  ifferent thread.
+0000db30: 2054 6869 7320 7061 636b 6167 650a 646f   This package.do
+0000db40: 6573 6e27 7420 7072 6f76 6964 6520 7375  esn't provide su
+0000db50: 6368 2061 2074 6872 6561 6465 6420 6f72  ch a threaded or
+0000db60: 2071 7565 7569 6e67 206f 626a 6563 7420   queuing object 
+0000db70: 636c 6173 732e 204a 7573 7420 6d61 6b65  class. Just make
+0000db80: 2073 7572 6520 746f 2072 6563 6f6e 7374   sure to reconst
+0000db90: 7275 6374 0a74 6865 2073 7562 7363 7269  ruct.the subscri
+0000dba0: 7074 696f 6e20 2861 6e64 2074 6865 2071  ption (and the q
+0000dbb0: 7565 7565 2920 7573 696e 6720 7468 6520  ueue) using the 
+0000dbc0: 6c61 7374 2072 6563 6f72 6465 6420 636f  last recorded co
+0000dbd0: 6d6d 6974 2070 6f73 6974 696f 6e20 7768  mmit position wh
+0000dbe0: 656e 2072 6573 756d 696e 670a 7468 6520  en resuming.the 
+0000dbf0: 7375 6273 6372 6970 7469 6f6e 2061 6674  subscription aft
+0000dc00: 6572 2061 6e20 6572 726f 722c 2074 6f20  er an error, to 
+0000dc10: 6265 2073 7572 6520 616c 6c20 6576 656e  be sure all even
+0000dc20: 7473 2061 7265 2070 726f 6365 7373 6564  ts are processed
+0000dc30: 206f 6e63 652e 0a0a 5468 6520 6578 616d   once...The exam
+0000dc40: 706c 6520 6265 6c6f 7720 7368 6f77 7320  ple below shows 
+0000dc50: 686f 7720 746f 2073 7562 7363 7269 6265  how to subscribe
+0000dc60: 2074 6f20 7265 6365 6976 6520 616c 6c20   to receive all 
+0000dc70: 7265 636f 7264 6564 0a65 7665 6e74 7320  recorded.events 
+0000dc80: 6672 6f6d 2074 6865 2073 7461 7274 2c20  from the start, 
+0000dc90: 616e 6420 7468 656e 2072 6573 756d 696e  and then resumin
+0000dca0: 6720 6672 6f6d 2061 2073 7065 6369 6669  g from a specifi
+0000dcb0: 6320 636f 6d6d 6974 2070 6f73 6974 696f  c commit positio
+0000dcc0: 6e2e 0a54 6872 6565 2061 6c72 6561 6479  n..Three already
+0000dcd0: 2d72 6563 6f72 6465 6420 6576 656e 7473  -recorded events
+0000dce0: 2061 7265 2072 6563 6569 7665 642c 2061   are received, a
+0000dcf0: 6e64 2074 6865 6e20 7468 7265 6520 6e65  nd then three ne
+0000dd00: 7720 6576 656e 7473 2061 7265 0a72 6563  w events are.rec
+0000dd10: 6f72 6465 642c 2077 6869 6368 2061 7265  orded, which are
+0000dd20: 2074 6865 6e20 7265 6365 6976 6564 2076   then received v
+0000dd30: 6961 2074 6865 2073 7562 7363 7269 7074  ia the subscript
+0000dd40: 696f 6e2e 0a0a 6060 6070 7974 686f 6e0a  ion...```python.
+0000dd50: 0a23 2041 7070 656e 6420 616e 2065 7665  .# Append an eve
+0000dd60: 6e74 2074 6f20 6120 6e65 7720 7374 7265  nt to a new stre
+0000dd70: 616d 2e0a 7374 7265 616d 5f6e 616d 6532  am..stream_name2
+0000dd80: 203d 2073 7472 2875 7569 6434 2829 290a   = str(uuid4()).
+0000dd90: 6576 656e 7434 203d 204e 6577 4576 656e  event4 = NewEven
+0000dda0: 7428 7479 7065 3d27 4f72 6465 7243 7265  t(type='OrderCre
+0000ddb0: 6174 6564 272c 2064 6174 613d 6227 6461  ated', data=b'da
+0000ddc0: 7461 3427 290a 636c 6965 6e74 2e61 7070  ta4').client.app
+0000ddd0: 656e 645f 6576 656e 7473 280a 2020 2020  end_events(.    
+0000dde0: 7374 7265 616d 5f6e 616d 653d 7374 7265  stream_name=stre
+0000ddf0: 616d 5f6e 616d 6532 2c0a 2020 2020 6578  am_name2,.    ex
+0000de00: 7065 6374 6564 5f70 6f73 6974 696f 6e3d  pected_position=
+0000de10: 4e6f 6e65 2c0a 2020 2020 6576 656e 7473  None,.    events
+0000de20: 3d5b 6576 656e 7434 5d2c 0a29 0a0a 2320  =[event4],.)..# 
+0000de30: 5375 6273 6372 6962 6520 6672 6f6d 2074  Subscribe from t
+0000de40: 6865 2066 6972 7374 2072 6563 6f72 6465  he first recorde
+0000de50: 6420 6576 656e 7420 696e 2074 6865 2064  d event in the d
+0000de60: 6174 6162 6173 652e 0a73 7562 7363 7269  atabase..subscri
+0000de70: 7074 696f 6e20 3d20 636c 6965 6e74 2e73  ption = client.s
+0000de80: 7562 7363 7269 6265 5f61 6c6c 5f65 7665  ubscribe_all_eve
+0000de90: 6e74 7328 290a 7265 6365 6976 6564 5f65  nts().received_e
+0000dea0: 7665 6e74 7320 3d20 5b5d 0a0a 2320 5072  vents = []..# Pr
+0000deb0: 6f63 6573 7320 6576 656e 7473 2072 6563  ocess events rec
+0000dec0: 6569 7665 6420 6672 6f6d 2074 6865 2063  eived from the c
+0000ded0: 6174 6368 2d75 7020 7375 6273 6372 6970  atch-up subscrip
+0000dee0: 7469 6f6e 2e0a 666f 7220 6576 656e 7420  tion..for event 
+0000def0: 696e 2073 7562 7363 7269 7074 696f 6e3a  in subscription:
+0000df00: 0a20 2020 206c 6173 745f 636f 6d6d 6974  .    last_commit
+0000df10: 5f70 6f73 6974 696f 6e20 3d20 6576 656e  _position = even
+0000df20: 742e 636f 6d6d 6974 5f70 6f73 6974 696f  t.commit_positio
+0000df30: 6e0a 2020 2020 7265 6365 6976 6564 5f65  n.    received_e
+0000df40: 7665 6e74 732e 6170 7065 6e64 2865 7665  vents.append(eve
+0000df50: 6e74 290a 2020 2020 6966 2065 7665 6e74  nt).    if event
+0000df60: 2e69 6420 3d3d 2065 7665 6e74 342e 6964  .id == event4.id
+0000df70: 3a0a 2020 2020 2020 2020 6272 6561 6b0a  :.        break.
+0000df80: 0a61 7373 6572 7420 7265 6365 6976 6564  .assert received
+0000df90: 5f65 7665 6e74 735b 2d38 5d2e 6964 203d  _events[-8].id =
+0000dfa0: 3d20 6576 656e 7431 2e69 640a 6173 7365  = event1.id.asse
+0000dfb0: 7274 2072 6563 6569 7665 645f 6576 656e  rt received_even
+0000dfc0: 7473 5b2d 375d 2e69 6420 3d3d 2065 7665  ts[-7].id == eve
+0000dfd0: 6e74 322e 6964 0a61 7373 6572 7420 7265  nt2.id.assert re
+0000dfe0: 6365 6976 6564 5f65 7665 6e74 735b 2d36  ceived_events[-6
+0000dff0: 5d2e 6964 203d 3d20 6576 656e 7433 2e69  ].id == event3.i
+0000e000: 640a 6173 7365 7274 2072 6563 6569 7665  d.assert receive
+0000e010: 645f 6576 656e 7473 5b2d 355d 2e74 7970  d_events[-5].typ
+0000e020: 6520 3d3d 2022 446f 6752 6567 6973 7465  e == "DogRegiste
+0000e030: 7265 6422 0a61 7373 6572 7420 7265 6365  red".assert rece
+0000e040: 6976 6564 5f65 7665 6e74 735b 2d34 5d2e  ived_events[-4].
+0000e050: 7479 7065 203d 3d20 2244 6f67 4c65 6172  type == "DogLear
+0000e060: 6e65 6454 7269 636b 220a 6173 7365 7274  nedTrick".assert
+0000e070: 2072 6563 6569 7665 645f 6576 656e 7473   received_events
+0000e080: 5b2d 335d 2e74 7970 6520 3d3d 2022 446f  [-3].type == "Do
+0000e090: 674c 6561 726e 6564 5472 6963 6b22 0a61  gLearnedTrick".a
+0000e0a0: 7373 6572 7420 7265 6365 6976 6564 5f65  ssert received_e
+0000e0b0: 7665 6e74 735b 2d32 5d2e 7479 7065 203d  vents[-2].type =
+0000e0c0: 3d20 2244 6f67 4c65 6172 6e65 6454 7269  = "DogLearnedTri
+0000e0d0: 636b 220a 6173 7365 7274 2072 6563 6569  ck".assert recei
+0000e0e0: 7665 645f 6576 656e 7473 5b2d 315d 2e69  ved_events[-1].i
+0000e0f0: 6420 3d3d 2065 7665 6e74 342e 6964 0a0a  d == event4.id..
+0000e100: 2320 4170 7065 6e64 2073 7562 7365 7175  # Append subsequ
+0000e110: 656e 7420 6576 656e 7473 2074 6f20 7468  ent events to th
+0000e120: 6520 7374 7265 616d 2e0a 6576 656e 7435  e stream..event5
+0000e130: 203d 204e 6577 4576 656e 7428 7479 7065   = NewEvent(type
+0000e140: 3d27 4f72 6465 7255 7064 6174 6564 272c  ='OrderUpdated',
+0000e150: 2064 6174 613d 6227 6461 7461 3527 290a   data=b'data5').
+0000e160: 636c 6965 6e74 2e61 7070 656e 645f 6576  client.append_ev
+0000e170: 656e 7473 280a 2020 2020 7374 7265 616d  ents(.    stream
+0000e180: 5f6e 616d 653d 7374 7265 616d 5f6e 616d  _name=stream_nam
+0000e190: 6532 2c0a 2020 2020 6578 7065 6374 6564  e2,.    expected
+0000e1a0: 5f70 6f73 6974 696f 6e3d 302c 0a20 2020  _position=0,.   
+0000e1b0: 2065 7665 6e74 733d 5b65 7665 6e74 355d   events=[event5]
+0000e1c0: 2c0a 290a 0a23 2052 6563 6569 7665 2073  ,.)..# Receive s
+0000e1d0: 7562 7365 7175 656e 7420 6576 656e 7473  ubsequent events
+0000e1e0: 2066 726f 6d20 7468 6520 7375 6273 6372   from the subscr
+0000e1f0: 6970 7469 6f6e 2e0a 666f 7220 6576 656e  iption..for even
+0000e200: 7420 696e 2073 7562 7363 7269 7074 696f  t in subscriptio
+0000e210: 6e3a 0a20 2020 206c 6173 745f 636f 6d6d  n:.    last_comm
+0000e220: 6974 5f70 6f73 6974 696f 6e20 3d20 6576  it_position = ev
+0000e230: 656e 742e 636f 6d6d 6974 5f70 6f73 6974  ent.commit_posit
+0000e240: 696f 6e0a 2020 2020 7265 6365 6976 6564  ion.    received
+0000e250: 5f65 7665 6e74 732e 6170 7065 6e64 2865  _events.append(e
+0000e260: 7665 6e74 290a 2020 2020 6966 2065 7665  vent).    if eve
+0000e270: 6e74 2e69 6420 3d3d 2065 7665 6e74 352e  nt.id == event5.
+0000e280: 6964 3a0a 2020 2020 2020 2020 6272 6561  id:.        brea
+0000e290: 6b0a 0a0a 0a61 7373 6572 7420 7265 6365  k....assert rece
+0000e2a0: 6976 6564 5f65 7665 6e74 735b 2d32 5d2e  ived_events[-2].
+0000e2b0: 6964 203d 3d20 6576 656e 7434 2e69 640a  id == event4.id.
+0000e2c0: 6173 7365 7274 2072 6563 6569 7665 645f  assert received_
+0000e2d0: 6576 656e 7473 5b2d 315d 2e69 6420 3d3d  events[-1].id ==
+0000e2e0: 2065 7665 6e74 352e 6964 0a0a 0a23 2041   event5.id...# A
+0000e2f0: 7070 656e 6420 6d6f 7265 2065 7665 6e74  ppend more event
+0000e300: 7320 746f 2074 6865 2073 7472 6561 6d2e  s to the stream.
+0000e310: 0a65 7665 6e74 3620 3d20 4e65 7745 7665  .event6 = NewEve
+0000e320: 6e74 2874 7970 653d 274f 7264 6572 4465  nt(type='OrderDe
+0000e330: 6c65 7465 6427 2c20 6461 7461 3d62 2764  leted', data=b'd
+0000e340: 6174 6136 2729 0a63 6c69 656e 742e 6170  ata6').client.ap
+0000e350: 7065 6e64 5f65 7665 6e74 7328 0a20 2020  pend_events(.   
+0000e360: 2073 7472 6561 6d5f 6e61 6d65 3d73 7472   stream_name=str
+0000e370: 6561 6d5f 6e61 6d65 322c 0a20 2020 2065  eam_name2,.    e
+0000e380: 7870 6563 7465 645f 706f 7369 7469 6f6e  xpected_position
+0000e390: 3d31 2c0a 2020 2020 6576 656e 7473 3d5b  =1,.    events=[
+0000e3a0: 6576 656e 7436 5d2c 0a29 0a0a 0a23 2052  event6],.)...# R
+0000e3b0: 6573 756d 6520 7375 6273 6372 6962 696e  esume subscribin
+0000e3c0: 6720 6672 6f6d 2074 6865 206c 6173 7420  g from the last 
+0000e3d0: 636f 6d6d 6974 2070 6f73 6974 696f 6e2e  commit position.
+0000e3e0: 0a73 7562 7363 7269 7074 696f 6e20 3d20  .subscription = 
+0000e3f0: 636c 6965 6e74 2e73 7562 7363 7269 6265  client.subscribe
+0000e400: 5f61 6c6c 5f65 7665 6e74 7328 0a20 2020  _all_events(.   
+0000e410: 2063 6f6d 6d69 745f 706f 7369 7469 6f6e   commit_position
+0000e420: 3d6c 6173 745f 636f 6d6d 6974 5f70 6f73  =last_commit_pos
+0000e430: 6974 696f 6e0a 290a 0a0a 2320 4361 7463  ition.)...# Catc
+0000e440: 6820 7570 2062 7920 7265 6365 6976 696e  h up by receivin
+0000e450: 6720 7468 6520 6e65 7720 6576 656e 7420  g the new event 
+0000e460: 6672 6f6d 2074 6865 2073 7562 7363 7269  from the subscri
+0000e470: 7074 696f 6e2e 0a66 6f72 2065 7665 6e74  ption..for event
+0000e480: 2069 6e20 7375 6273 6372 6970 7469 6f6e   in subscription
+0000e490: 3a0a 2020 2020 7265 6365 6976 6564 5f65  :.    received_e
+0000e4a0: 7665 6e74 732e 6170 7065 6e64 2865 7665  vents.append(eve
+0000e4b0: 6e74 290a 2020 2020 6966 2065 7665 6e74  nt).    if event
+0000e4c0: 2e69 6420 3d3d 2065 7665 6e74 362e 6964  .id == event6.id
+0000e4d0: 3a0a 2020 2020 2020 2020 6272 6561 6b0a  :.        break.
+0000e4e0: 0a61 7373 6572 7420 7265 6365 6976 6564  .assert received
+0000e4f0: 5f65 7665 6e74 735b 2d33 5d2e 6964 203d  _events[-3].id =
+0000e500: 3d20 6576 656e 7434 2e69 640a 6173 7365  = event4.id.asse
+0000e510: 7274 2072 6563 6569 7665 645f 6576 656e  rt received_even
+0000e520: 7473 5b2d 325d 2e69 6420 3d3d 2065 7665  ts[-2].id == eve
+0000e530: 6e74 352e 6964 0a61 7373 6572 7420 7265  nt5.id.assert re
+0000e540: 6365 6976 6564 5f65 7665 6e74 735b 2d31  ceived_events[-1
+0000e550: 5d2e 6964 203d 3d20 6576 656e 7436 2e69  ].id == event6.i
+0000e560: 640a 0a0a 2320 4170 7065 6e64 2074 6872  d...# Append thr
+0000e570: 6565 206d 6f72 6520 6576 656e 7473 2074  ee more events t
+0000e580: 6f20 6120 6e65 7720 7374 7265 616d 2e0a  o a new stream..
+0000e590: 7374 7265 616d 5f6e 616d 6533 203d 2073  stream_name3 = s
+0000e5a0: 7472 2875 7569 6434 2829 290a 6576 656e  tr(uuid4()).even
+0000e5b0: 7437 203d 204e 6577 4576 656e 7428 7479  t7 = NewEvent(ty
+0000e5c0: 7065 3d27 4f72 6465 7243 7265 6174 6564  pe='OrderCreated
+0000e5d0: 272c 2064 6174 613d 6227 6461 7461 3727  ', data=b'data7'
+0000e5e0: 290a 6576 656e 7438 203d 204e 6577 4576  ).event8 = NewEv
+0000e5f0: 656e 7428 7479 7065 3d27 4f72 6465 7255  ent(type='OrderU
+0000e600: 7064 6174 6564 272c 2064 6174 613d 6227  pdated', data=b'
+0000e610: 6461 7461 3827 290a 6576 656e 7439 203d  data8').event9 =
+0000e620: 204e 6577 4576 656e 7428 7479 7065 3d27   NewEvent(type='
+0000e630: 4f72 6465 7244 656c 6574 6564 272c 2064  OrderDeleted', d
+0000e640: 6174 613d 6227 6461 7461 3927 290a 0a63  ata=b'data9')..c
+0000e650: 6c69 656e 742e 6170 7065 6e64 5f65 7665  lient.append_eve
+0000e660: 6e74 7328 0a20 2020 2073 7472 6561 6d5f  nts(.    stream_
+0000e670: 6e61 6d65 3d73 7472 6561 6d5f 6e61 6d65  name=stream_name
+0000e680: 332c 0a20 2020 2065 7870 6563 7465 645f  3,.    expected_
+0000e690: 706f 7369 7469 6f6e 3d4e 6f6e 652c 0a20  position=None,. 
+0000e6a0: 2020 2065 7665 6e74 733d 5b65 7665 6e74     events=[event
+0000e6b0: 372c 2065 7665 6e74 382c 2065 7665 6e74  7, event8, event
+0000e6c0: 395d 2c0a 290a 0a23 2052 6563 6569 7665  9],.)..# Receive
+0000e6d0: 2074 6865 2074 6872 6565 206e 6577 2065   the three new e
+0000e6e0: 7665 6e74 7320 6672 6f6d 2074 6865 2072  vents from the r
+0000e6f0: 6573 756d 6564 2073 7562 7363 7269 7074  esumed subscript
+0000e700: 696f 6e2e 0a66 6f72 2065 7665 6e74 2069  ion..for event i
+0000e710: 6e20 7375 6273 6372 6970 7469 6f6e 3a0a  n subscription:.
+0000e720: 2020 2020 7265 6365 6976 6564 5f65 7665      received_eve
+0000e730: 6e74 732e 6170 7065 6e64 2865 7665 6e74  nts.append(event
+0000e740: 290a 2020 2020 6966 2065 7665 6e74 2e69  ).    if event.i
+0000e750: 6420 3d3d 2065 7665 6e74 392e 6964 3a0a  d == event9.id:.
+0000e760: 2020 2020 2020 2020 6272 6561 6b0a 0a61          break..a
+0000e770: 7373 6572 7420 7265 6365 6976 6564 5f65  ssert received_e
+0000e780: 7665 6e74 735b 2d36 5d2e 6964 203d 3d20  vents[-6].id == 
+0000e790: 6576 656e 7434 2e69 640a 6173 7365 7274  event4.id.assert
+0000e7a0: 2072 6563 6569 7665 645f 6576 656e 7473   received_events
+0000e7b0: 5b2d 355d 2e69 6420 3d3d 2065 7665 6e74  [-5].id == event
+0000e7c0: 352e 6964 0a61 7373 6572 7420 7265 6365  5.id.assert rece
+0000e7d0: 6976 6564 5f65 7665 6e74 735b 2d34 5d2e  ived_events[-4].
+0000e7e0: 6964 203d 3d20 6576 656e 7436 2e69 640a  id == event6.id.
+0000e7f0: 6173 7365 7274 2072 6563 6569 7665 645f  assert received_
+0000e800: 6576 656e 7473 5b2d 335d 2e69 6420 3d3d  events[-3].id ==
+0000e810: 2065 7665 6e74 372e 6964 0a61 7373 6572   event7.id.asser
+0000e820: 7420 7265 6365 6976 6564 5f65 7665 6e74  t received_event
+0000e830: 735b 2d32 5d2e 6964 203d 3d20 6576 656e  s[-2].id == even
+0000e840: 7438 2e69 640a 6173 7365 7274 2072 6563  t8.id.assert rec
+0000e850: 6569 7665 645f 6576 656e 7473 5b2d 315d  eived_events[-1]
+0000e860: 2e69 6420 3d3d 2065 7665 6e74 392e 6964  .id == event9.id
+0000e870: 0a60 6060 0a0a 5468 6520 6361 7463 682d  .```..The catch-
+0000e880: 7570 2073 7562 7363 7269 7074 696f 6e20  up subscription 
+0000e890: 6361 6c6c 2069 7320 656e 6465 6420 6173  call is ended as
+0000e8a0: 2073 6f6f 6e20 6173 2074 6865 2073 7562   soon as the sub
+0000e8b0: 7363 7269 7074 696f 6e20 6f62 6a65 6374  scription object
+0000e8c0: 0a67 6f65 7320 6f75 7420 6f66 2073 636f  .goes out of sco
+0000e8d0: 7065 206f 7220 6973 2065 7870 6c69 6369  pe or is explici
+0000e8e0: 746c 7920 6465 6c65 7465 6420 6672 6f6d  tly deleted from
+0000e8f0: 206d 656d 6f72 792e 0a0a 6060 6070 7974   memory...```pyt
+0000e900: 686f 6e0a 2320 456e 6420 7468 6520 7375  hon.# End the su
+0000e910: 6273 6372 6970 7469 6f6e 2e0a 6465 6c20  bscription..del 
+0000e920: 7375 6273 6372 6970 7469 6f6e 0a60 6060  subscription.```
+0000e930: 0a0a 2323 2320 5375 6273 6372 6962 6520  ..### Subscribe 
+0000e940: 7374 7265 616d 2065 7665 6e74 730a 0a54  stream events..T
+0000e950: 6865 6073 7562 7363 7269 6265 5f73 7472  he`subscribe_str
+0000e960: 6561 6d5f 6576 656e 7473 2829 6020 6d65  eam_events()` me
+0000e970: 7468 6f64 2063 616e 2062 6520 7573 6564  thod can be used
+0000e980: 2074 6f20 7374 6172 7420 6120 2263 6174   to start a "cat
+0000e990: 6368 2d75 7022 2073 7562 7363 7269 7074  ch-up" subscript
+0000e9a0: 696f 6e0a 7468 6174 2063 616e 2072 6574  ion.that can ret
+0000e9b0: 7572 6e20 6576 656e 7473 2074 6861 7420  urn events that 
+0000e9c0: 6172 6520 7265 636f 7264 6564 2069 6e20  are recorded in 
+0000e9d0: 6120 7369 6e67 6c65 2073 7472 6561 6d2e  a single stream.
+0000e9e0: 0a0a 5468 6973 206d 6574 686f 6420 7461  ..This method ta
+0000e9f0: 6b65 7320 6120 7265 7175 6972 6564 2060  kes a required `
+0000ea00: 7374 7265 616d 5f6e 616d 6560 2061 7267  stream_name` arg
+0000ea10: 756d 656e 742c 2077 6869 6368 2073 7065  ument, which spe
+0000ea20: 6369 6669 6573 2074 6865 206e 616d 6520  cifies the name 
+0000ea30: 6f66 2074 6865 2073 7472 6561 6d0a 6672  of the stream.fr
+0000ea40: 6f6d 2077 6869 6368 2072 6563 6f72 6465  om which recorde
+0000ea50: 6420 6576 656e 7473 2077 696c 6c20 6265  d events will be
+0000ea60: 2072 6563 6569 7665 642e 0a0a 5468 6973   received...This
+0000ea70: 206d 6574 686f 6420 616c 736f 2074 616b   method also tak
+0000ea80: 6573 2074 776f 206f 7074 696f 6e61 6c20  es two optional 
+0000ea90: 6172 6775 6d65 6e74 732c 2060 7374 7265  arguments, `stre
+0000eaa0: 616d 5f70 6f73 6974 696f 6e60 2c20 616e  am_position`, an
+0000eab0: 6420 6074 696d 656f 7574 602e 0a0a 5468  d `timeout`...Th
+0000eac0: 6520 6f70 7469 6f6e 616c 2060 7374 7265  e optional `stre
+0000ead0: 616d 5f70 6f73 6974 696f 6e60 2061 7267  am_position` arg
+0000eae0: 756d 656e 7420 7370 6563 6966 6965 7320  ument specifies 
+0000eaf0: 6120 706f 7369 7469 6f6e 2069 6e20 7468  a position in th
+0000eb00: 6520 7374 7265 616d 2066 726f 6d20 7768  e stream from wh
+0000eb10: 6963 680a 7265 636f 7264 6564 2065 7665  ich.recorded eve
+0000eb20: 6e74 7320 7769 6c6c 2062 6520 7265 6365  nts will be rece
+0000eb30: 6976 6564 2e20 5468 6520 6576 656e 7420  ived. The event 
+0000eb40: 6174 2074 6865 2073 7065 6369 6669 6564  at the specified
+0000eb50: 2073 7472 6561 6d20 706f 7369 7469 6f6e   stream position
+0000eb60: 2077 696c 6c20 6e6f 740a 6265 2069 6e63   will not.be inc
+0000eb70: 6c75 6465 642e 0a0a 5468 6520 6f70 7469  luded...The opti
+0000eb80: 6f6e 616c 2060 7469 6d65 6f75 7460 2061  onal `timeout` a
+0000eb90: 7267 756d 656e 7420 6973 2061 2050 7974  rgument is a Pyt
+0000eba0: 686f 6e20 6066 6c6f 6174 6020 7468 6174  hon `float` that
+0000ebb0: 2073 6574 730a 6120 6465 6164 6c69 6e65   sets.a deadline
+0000ebc0: 2066 6f72 2074 6865 2063 6f6d 706c 6574   for the complet
+0000ebd0: 696f 6e20 6f66 2074 6865 2067 5250 4320  ion of the gRPC 
+0000ebe0: 6f70 6572 6174 696f 6e2e 0a0a 5468 6520  operation...The 
+0000ebf0: 6578 616d 706c 6520 6265 6c6f 7720 7368  example below sh
+0000ec00: 6f77 7320 686f 7720 746f 2073 7461 7274  ows how to start
+0000ec10: 2061 2063 6174 6368 2d75 7020 7375 6273   a catch-up subs
+0000ec20: 6372 6970 7469 6f6e 2074 6f20 6120 7374  cription to a st
+0000ec30: 7265 616d 2e0a 0a60 6060 7079 7468 6f6e  ream...```python
+0000ec40: 0a0a 2320 5375 6273 6372 6962 6520 746f  ..# Subscribe to
+0000ec50: 2065 7665 6e74 7320 6672 6f6d 2073 7472   events from str
+0000ec60: 6561 6d32 2c20 6672 6f6d 2074 6865 2073  eam2, from the s
+0000ec70: 7461 7274 2e0a 7375 6273 6372 6970 7469  tart..subscripti
+0000ec80: 6f6e 203d 2063 6c69 656e 742e 7375 6273  on = client.subs
+0000ec90: 6372 6962 655f 7374 7265 616d 5f65 7665  cribe_stream_eve
+0000eca0: 6e74 7328 7374 7265 616d 5f6e 616d 653d  nts(stream_name=
+0000ecb0: 7374 7265 616d 5f6e 616d 6532 290a 0a23  stream_name2)..#
+0000ecc0: 2052 6561 6420 6672 6f6d 2074 6865 2073   Read from the s
+0000ecd0: 7562 7363 7269 7074 696f 6e2e 0a65 7665  ubscription..eve
+0000ece0: 6e74 7320 3d20 5b5d 0a66 6f72 2065 7665  nts = [].for eve
+0000ecf0: 6e74 2069 6e20 7375 6273 6372 6970 7469  nt in subscripti
+0000ed00: 6f6e 3a0a 2020 2020 6576 656e 7473 2e61  on:.    events.a
+0000ed10: 7070 656e 6428 6576 656e 7429 0a20 2020  ppend(event).   
+0000ed20: 2069 6620 6576 656e 742e 6964 203d 3d20   if event.id == 
+0000ed30: 6576 656e 7436 2e69 643a 0a20 2020 2020  event6.id:.     
+0000ed40: 2020 2062 7265 616b 0a0a 2320 4368 6563     break..# Chec
+0000ed50: 6b20 7765 2067 6f74 2065 7665 6e74 7320  k we got events 
+0000ed60: 6f6e 6c79 2066 726f 6d20 7374 7265 616d  only from stream
+0000ed70: 322e 0a61 7373 6572 7420 6c65 6e28 6576  2..assert len(ev
+0000ed80: 656e 7473 2920 3d3d 2033 0a65 7665 6e74  ents) == 3.event
+0000ed90: 735b 305d 2e73 7472 6561 6d5f 6e61 6d65  s[0].stream_name
+0000eda0: 203d 3d20 7374 7265 616d 5f6e 616d 6532   == stream_name2
+0000edb0: 0a65 7665 6e74 735b 315d 2e73 7472 6561  .events[1].strea
+0000edc0: 6d5f 6e61 6d65 203d 3d20 7374 7265 616d  m_name == stream
+0000edd0: 5f6e 616d 6532 0a65 7665 6e74 735b 325d  _name2.events[2]
+0000ede0: 2e73 7472 6561 6d5f 6e61 6d65 203d 3d20  .stream_name == 
+0000edf0: 7374 7265 616d 5f6e 616d 6532 0a0a 2320  stream_name2..# 
+0000ee00: 4170 7065 6e64 2061 6e6f 7468 6572 2065  Append another e
+0000ee10: 7665 6e74 2074 6f20 7374 7265 616d 332e  vent to stream3.
+0000ee20: 0a65 7665 6e74 3130 203d 204e 6577 4576  .event10 = NewEv
+0000ee30: 656e 7428 7479 7065 3d22 4f72 6465 7255  ent(type="OrderU
+0000ee40: 6e64 656c 6574 6564 222c 2064 6174 613d  ndeleted", data=
+0000ee50: 6227 6461 7461 3130 2729 0a63 6c69 656e  b'data10').clien
+0000ee60: 742e 6170 7065 6e64 5f65 7665 6e74 7328  t.append_events(
+0000ee70: 0a20 2020 2073 7472 6561 6d5f 6e61 6d65  .    stream_name
+0000ee80: 3d73 7472 6561 6d5f 6e61 6d65 332c 0a20  =stream_name3,. 
+0000ee90: 2020 2065 7870 6563 7465 645f 706f 7369     expected_posi
+0000eea0: 7469 6f6e 3d32 2c0a 2020 2020 6576 656e  tion=2,.    even
+0000eeb0: 7473 3d5b 6576 656e 7431 305d 2c0a 290a  ts=[event10],.).
+0000eec0: 0a23 2041 7070 656e 6420 616e 6f74 6865  .# Append anothe
+0000eed0: 7220 6576 656e 7420 746f 2073 7472 6561  r event to strea
+0000eee0: 6d32 2e0a 6576 656e 7431 3120 3d20 4e65  m2..event11 = Ne
+0000eef0: 7745 7665 6e74 2874 7970 653d 224f 7264  wEvent(type="Ord
+0000ef00: 6572 556e 6465 6c65 7465 6422 2c20 6461  erUndeleted", da
+0000ef10: 7461 3d62 2764 6174 6131 3127 290a 636c  ta=b'data11').cl
+0000ef20: 6965 6e74 2e61 7070 656e 645f 6576 656e  ient.append_even
+0000ef30: 7473 280a 2020 2020 7374 7265 616d 5f6e  ts(.    stream_n
+0000ef40: 616d 653d 7374 7265 616d 5f6e 616d 6532  ame=stream_name2
+0000ef50: 2c0a 2020 2020 6578 7065 6374 6564 5f70  ,.    expected_p
+0000ef60: 6f73 6974 696f 6e3d 322c 0a20 2020 2065  osition=2,.    e
+0000ef70: 7665 6e74 733d 5b65 7665 6e74 3131 5d0a  vents=[event11].
+0000ef80: 290a 0a23 2043 6f6e 7469 6e75 6520 7265  )..# Continue re
+0000ef90: 6164 696e 6720 6672 6f6d 2074 6865 2073  ading from the s
+0000efa0: 7562 7363 7269 7074 696f 6e2e 0a66 6f72  ubscription..for
+0000efb0: 2065 7665 6e74 2069 6e20 7375 6273 6372   event in subscr
+0000efc0: 6970 7469 6f6e 3a0a 2020 2020 6576 656e  iption:.    even
+0000efd0: 7473 2e61 7070 656e 6428 6576 656e 7429  ts.append(event)
+0000efe0: 0a20 2020 2069 6620 6576 656e 742e 6964  .    if event.id
+0000eff0: 203d 3d20 6576 656e 7431 312e 6964 3a0a   == event11.id:.
+0000f000: 2020 2020 2020 2020 6272 6561 6b0a 0a23          break..#
+0000f010: 2043 6865 636b 2077 6520 676f 7420 6576   Check we got ev
+0000f020: 656e 7473 206f 6e6c 7920 6672 6f6d 2073  ents only from s
+0000f030: 7472 6561 6d32 2e0a 6173 7365 7274 206c  tream2..assert l
+0000f040: 656e 2865 7665 6e74 7329 203d 3d20 340a  en(events) == 4.
+0000f050: 6576 656e 7473 5b30 5d2e 7374 7265 616d  events[0].stream
+0000f060: 5f6e 616d 6520 3d3d 2073 7472 6561 6d5f  _name == stream_
+0000f070: 6e61 6d65 320a 6576 656e 7473 5b31 5d2e  name2.events[1].
+0000f080: 7374 7265 616d 5f6e 616d 6520 3d3d 2073  stream_name == s
+0000f090: 7472 6561 6d5f 6e61 6d65 320a 6576 656e  tream_name2.even
+0000f0a0: 7473 5b32 5d2e 7374 7265 616d 5f6e 616d  ts[2].stream_nam
+0000f0b0: 6520 3d3d 2073 7472 6561 6d5f 6e61 6d65  e == stream_name
+0000f0c0: 320a 6576 656e 7473 5b33 5d2e 7374 7265  2.events[3].stre
+0000f0d0: 616d 5f6e 616d 6520 3d3d 2073 7472 6561  am_name == strea
+0000f0e0: 6d5f 6e61 6d65 320a 6060 600a 0a54 6865  m_name2.```..The
+0000f0f0: 2065 7861 6d70 6c65 2062 656c 6f77 2073   example below s
+0000f100: 686f 7773 2068 6f77 2074 6f20 7374 6172  hows how to star
+0000f110: 7420 6120 6361 7463 682d 7570 2073 7562  t a catch-up sub
+0000f120: 7363 7269 7074 696f 6e20 746f 2061 2073  scription to a s
+0000f130: 7472 6561 6d20 6672 6f6d 2061 0a73 7065  tream from a.spe
+0000f140: 6369 6669 6320 7374 7265 616d 2070 6f73  cific stream pos
+0000f150: 6974 696f 6e2e 0a0a 6060 6070 7974 686f  ition...```pytho
+0000f160: 6e0a 0a23 2053 7562 7363 7269 6265 2074  n..# Subscribe t
+0000f170: 6f20 6576 656e 7473 2066 726f 6d20 7374  o events from st
+0000f180: 7265 616d 322c 2066 726f 6d20 7468 6520  ream2, from the 
+0000f190: 7374 6172 742e 0a73 7562 7363 7269 7074  start..subscript
+0000f1a0: 696f 6e20 3d20 636c 6965 6e74 2e73 7562  ion = client.sub
+0000f1b0: 7363 7269 6265 5f73 7472 6561 6d5f 6576  scribe_stream_ev
+0000f1c0: 656e 7473 280a 2020 2020 7374 7265 616d  ents(.    stream
+0000f1d0: 5f6e 616d 653d 7374 7265 616d 5f6e 616d  _name=stream_nam
+0000f1e0: 6532 2c0a 2020 2020 7374 7265 616d 5f70  e2,.    stream_p
+0000f1f0: 6f73 6974 696f 6e3d 312c 0a29 0a0a 2320  osition=1,.)..# 
+0000f200: 5265 6164 2065 7665 6e74 2066 726f 6d20  Read event from 
+0000f210: 7468 6520 7375 6273 6372 6970 7469 6f6e  the subscription
+0000f220: 2e0a 6576 656e 7473 203d 205b 5d0a 666f  ..events = [].fo
+0000f230: 7220 6576 656e 7420 696e 2073 7562 7363  r event in subsc
+0000f240: 7269 7074 696f 6e3a 0a20 2020 2065 7665  ription:.    eve
+0000f250: 6e74 732e 6170 7065 6e64 2865 7665 6e74  nts.append(event
+0000f260: 290a 2020 2020 6966 2065 7665 6e74 2e69  ).    if event.i
+0000f270: 6420 3d3d 2065 7665 6e74 3131 2e69 643a  d == event11.id:
+0000f280: 0a20 2020 2020 2020 2062 7265 616b 0a0a  .        break..
+0000f290: 2320 4368 6563 6b20 7765 2067 6f74 2065  # Check we got e
+0000f2a0: 7665 6e74 7320 6f6e 6c79 2061 6674 6572  vents only after
+0000f2b0: 2070 6f73 6974 696f 6e20 312e 0a61 7373   position 1..ass
+0000f2c0: 6572 7420 6c65 6e28 6576 656e 7473 2920  ert len(events) 
+0000f2d0: 3d3d 2032 0a65 7665 6e74 735b 305d 2e69  == 2.events[0].i
+0000f2e0: 6420 3d3d 2065 7665 6e74 362e 6964 0a65  d == event6.id.e
+0000f2f0: 7665 6e74 735b 305d 2e73 7472 6561 6d5f  vents[0].stream_
+0000f300: 706f 7369 7469 6f6e 203d 3d20 320a 6576  position == 2.ev
+0000f310: 656e 7473 5b30 5d2e 7374 7265 616d 5f6e  ents[0].stream_n
+0000f320: 616d 6520 3d3d 2073 7472 6561 6d5f 6e61  ame == stream_na
+0000f330: 6d65 320a 6576 656e 7473 5b31 5d2e 6964  me2.events[1].id
+0000f340: 203d 3d20 6576 656e 7431 312e 6964 0a65   == event11.id.e
+0000f350: 7665 6e74 735b 315d 2e73 7472 6561 6d5f  vents[1].stream_
+0000f360: 706f 7369 7469 6f6e 203d 3d20 330a 6576  position == 3.ev
+0000f370: 656e 7473 5b31 5d2e 7374 7265 616d 5f6e  ents[1].stream_n
+0000f380: 616d 6520 3d3d 2073 7472 6561 6d5f 6e61  ame == stream_na
+0000f390: 6d65 320a 6060 600a 0a23 2320 5065 7273  me2.```..## Pers
+0000f3a0: 6973 7465 6e74 2073 7562 7363 7269 7074  istent subscript
+0000f3b0: 696f 6e73 0a0a 2323 2320 4372 6561 7465  ions..### Create
+0000f3c0: 2073 7562 7363 7269 7074 696f 6e0a 0a2a   subscription..*
+0000f3d0: 7265 7175 6972 6573 206c 6561 6465 722a  requires leader*
+0000f3e0: 0a0a 5468 6520 6d65 7468 6f64 2060 6372  ..The method `cr
+0000f3f0: 6561 7465 5f73 7562 7363 7269 7074 696f  eate_subscriptio
+0000f400: 6e28 2960 2063 616e 2062 6520 7573 6564  n()` can be used
+0000f410: 2074 6f20 6372 6561 7465 2061 0a22 7065   to create a."pe
+0000f420: 7273 6973 7465 6e74 2073 7562 7363 7269  rsistent subscri
+0000f430: 7074 696f 6e22 2074 6f20 4576 656e 7453  ption" to EventS
+0000f440: 746f 7265 4442 2e0a 0a54 6869 7320 6d65  toreDB...This me
+0000f450: 7468 6f64 2074 616b 6573 2061 2072 6571  thod takes a req
+0000f460: 7569 7265 6420 6067 726f 7570 5f6e 616d  uired `group_nam
+0000f470: 6560 2061 7267 756d 656e 742c 2077 6869  e` argument, whi
+0000f480: 6368 2069 7320 7468 650a 6e61 6d65 206f  ch is the.name o
+0000f490: 6620 6120 2267 726f 7570 2220 6f66 2063  f a "group" of c
+0000f4a0: 6f6e 7375 6d65 7273 206f 6620 7468 6520  onsumers of the 
+0000f4b0: 7375 6273 6372 6970 7469 6f6e 2e0a 0a54  subscription...T
+0000f4c0: 6869 7320 6d65 7468 6f64 2061 6c73 6f20  his method also 
+0000f4d0: 7461 6b65 7320 7365 7665 6e20 6f70 7469  takes seven opti
+0000f4e0: 6f6e 616c 2061 7267 756d 656e 7473 2c20  onal arguments, 
+0000f4f0: 6066 726f 6d5f 656e 6460 2c20 6063 6f6d  `from_end`, `com
+0000f500: 6d69 745f 706f 7369 7469 6f6e 602c 0a60  mit_position`,.`
+0000f510: 6669 6c74 6572 5f65 7863 6c75 6465 602c  filter_exclude`,
+0000f520: 2060 6669 6c74 6572 5f69 6e63 6c75 6465   `filter_include
+0000f530: 602c 2060 6669 6c74 6572 5f62 795f 7374  `, `filter_by_st
+0000f540: 7265 616d 5f6e 616d 6560 2c20 6063 6f6e  ream_name`, `con
+0000f550: 7375 6d65 725f 7374 7261 7465 6779 602c  sumer_strategy`,
+0000f560: 0a61 6e64 2060 7469 6d65 6f75 7460 2e0a  .and `timeout`..
+0000f570: 0a54 6865 206f 7074 696f 6e61 6c20 6066  .The optional `f
+0000f580: 726f 6d5f 656e 6460 2061 7267 756d 656e  rom_end` argumen
+0000f590: 7420 6361 6e20 6265 2075 7365 6420 746f  t can be used to
+0000f5a0: 2073 7065 6369 6679 2074 6861 7420 7468   specify that th
+0000f5b0: 6520 6772 6f75 7020 6f66 2063 6f6e 7375  e group of consu
+0000f5c0: 6d65 7273 0a6f 6620 7468 6520 7375 6273  mers.of the subs
+0000f5d0: 6372 6970 7469 6f6e 2073 686f 756c 6420  cription should 
+0000f5e0: 6f6e 6c79 2072 6563 6569 7665 2065 7665  only receive eve
+0000f5f0: 6e74 7320 7468 6174 2077 6572 6520 7265  nts that were re
+0000f600: 636f 7264 6564 2061 6674 6572 2074 6865  corded after the
+0000f610: 2073 7562 7363 7269 7074 696f 6e0a 7761   subscription.wa
+0000f620: 7320 6372 6561 7465 642e 0a0a 416c 7465  s created...Alte
+0000f630: 726e 6174 6976 656c 792c 2074 6865 206f  rnatively, the o
+0000f640: 7074 696f 6e61 6c20 6063 6f6d 6d69 745f  ptional `commit_
+0000f650: 706f 7369 7469 6f6e 6020 6172 6775 6d65  position` argume
+0000f660: 6e74 2063 616e 2062 6520 7573 6564 2074  nt can be used t
+0000f670: 6f20 7370 6563 6966 7920 6120 636f 6d6d  o specify a comm
+0000f680: 6974 0a70 6f73 6974 696f 6e20 6672 6f6d  it.position from
+0000f690: 2077 6869 6368 2063 6f6d 6d69 7420 706f   which commit po
+0000f6a0: 7369 7469 6f6e 2074 6865 2067 726f 7570  sition the group
+0000f6b0: 206f 6620 636f 6e73 756d 6572 7320 6f66   of consumers of
+0000f6c0: 2074 6865 2073 7562 7363 7269 7074 696f   the subscriptio
+0000f6d0: 6e20 7368 6f75 6c64 0a72 6563 6569 7665  n should.receive
+0000f6e0: 2065 7665 6e74 732e 2050 6c65 6173 6520   events. Please 
+0000f6f0: 6e6f 7465 2c20 7468 6520 7265 636f 7264  note, the record
+0000f700: 6564 2065 7665 6e74 2061 7420 7468 6520  ed event at the 
+0000f710: 7370 6563 6966 6965 6420 636f 6d6d 6974  specified commit
+0000f720: 2070 6f73 6974 696f 6e20 6d69 6768 740a   position might.
+0000f730: 6265 2069 6e63 6c75 6465 6420 696e 2074  be included in t
+0000f740: 6865 2072 6563 6f72 6465 6420 6576 656e  he recorded even
+0000f750: 7473 2072 6563 6569 7665 6420 6279 2074  ts received by t
+0000f760: 6865 2067 726f 7570 206f 6620 636f 6e73  he group of cons
+0000f770: 756d 6572 732e 0a0a 4966 206e 6569 7468  umers...If neith
+0000f780: 6572 2060 6672 6f6d 5f65 6e64 6020 6f72  er `from_end` or
+0000f790: 2060 636f 6d6d 6974 5f70 6f73 6974 696f   `commit_positio
+0000f7a0: 6e60 2061 7265 2073 7065 6369 6669 6564  n` are specified
+0000f7b0: 2c20 7468 6520 6772 6f75 7020 6f66 2063  , the group of c
+0000f7c0: 6f6e 7375 6d65 7273 0a6f 6620 7468 6520  onsumers.of the 
+0000f7d0: 7375 6273 6372 6970 7469 6f6e 2077 696c  subscription wil
+0000f7e0: 6c20 706f 7465 6e74 6961 6c6c 7920 7265  l potentially re
+0000f7f0: 6365 6976 6520 616c 6c20 7265 636f 7264  ceive all record
+0000f800: 6564 2065 7665 6e74 7320 696e 2074 6865  ed events in the
+0000f810: 2064 6174 6162 6173 652e 0a0a 5468 6520   database...The 
+0000f820: 6f70 7469 6f6e 616c 2060 6669 6c74 6572  optional `filter
+0000f830: 5f65 7863 6c75 6465 6020 6172 6775 6d65  _exclude` argume
+0000f840: 6e74 2069 7320 6120 7365 7175 656e 6365  nt is a sequence
+0000f850: 206f 6620 7265 6775 6c61 7220 6578 7072   of regular expr
+0000f860: 6573 7369 6f6e 7320 7468 6174 0a6d 6174  essions that.mat
+0000f870: 6368 2072 6563 6f72 6465 6420 6576 656e  ch recorded even
+0000f880: 7473 2074 6861 7420 7368 6f75 6c64 206e  ts that should n
+0000f890: 6f74 2062 6520 696e 636c 7564 6564 2e20  ot be included. 
+0000f8a0: 5468 6973 2061 7267 756d 656e 7420 6973  This argument is
+0000f8b0: 2069 676e 6f72 6564 0a69 6620 6066 696c   ignored.if `fil
+0000f8c0: 7465 725f 696e 636c 7564 6560 2069 7320  ter_include` is 
+0000f8d0: 7365 7420 746f 2061 206e 6f6e 2d65 6d70  set to a non-emp
+0000f8e0: 7479 2073 6571 7565 6e63 652e 2042 7920  ty sequence. By 
+0000f8f0: 6465 6661 756c 742c 2074 6869 7320 6172  default, this ar
+0000f900: 6775 6d65 6e74 2069 7320 7365 740a 746f  gument is set.to
+0000f910: 206d 6174 6368 2074 6865 2065 7665 6e74   match the event
+0000f920: 2074 7970 6573 206f 6620 2273 7973 7465   types of "syste
+0000f930: 6d20 6576 656e 7473 222c 2073 6f20 7468  m events", so th
+0000f940: 6174 2045 7665 6e74 5374 6f72 6544 4220  at EventStoreDB 
+0000f950: 7379 7374 656d 2065 7665 6e74 730a 7769  system events.wi
+0000f960: 6c6c 206e 6f74 206e 6f72 6d61 6c6c 7920  ll not normally 
+0000f970: 6265 2072 6563 6569 7665 642e 2053 6565  be received. See
+0000f980: 2074 6865 204e 6f74 6573 2073 6563 7469   the Notes secti
+0000f990: 6f6e 2062 656c 6f77 2066 6f72 206d 6f72  on below for mor
+0000f9a0: 6520 696e 666f 726d 6174 696f 6e0a 6162  e information.ab
+0000f9b0: 6f75 7420 6669 6c74 6572 2065 7870 7265  out filter expre
+0000f9c0: 7373 696f 6e73 2e0a 0a54 6865 206f 7074  ssions...The opt
+0000f9d0: 696f 6e61 6c20 6066 696c 7465 725f 696e  ional `filter_in
+0000f9e0: 636c 7564 6560 2061 7267 756d 656e 7420  clude` argument 
+0000f9f0: 6973 2061 2073 6571 7565 6e63 6520 6f66  is a sequence of
+0000fa00: 2072 6567 756c 6172 2065 7870 7265 7373   regular express
+0000fa10: 696f 6e73 0a74 6861 7420 6d61 7463 6820  ions.that match 
+0000fa20: 7265 636f 7264 6564 2065 7665 6e74 7320  recorded events 
+0000fa30: 7468 6174 2073 686f 756c 6420 6265 2072  that should be r
+0000fa40: 6563 6569 7665 642e 2042 7920 6465 6661  eceived. By defa
+0000fa50: 756c 742c 2074 6869 7320 6172 6775 6d65  ult, this argume
+0000fa60: 6e74 0a69 7320 616e 2065 6d70 7479 2074  nt.is an empty t
+0000fa70: 7570 6c65 2e20 4966 2074 6869 7320 6172  uple. If this ar
+0000fa80: 6775 6d65 6e74 2069 7320 7365 7420 746f  gument is set to
+0000fa90: 2061 206e 6f6e 2d65 6d70 7479 2073 6571   a non-empty seq
+0000faa0: 7565 6e63 652c 2074 6865 0a60 6669 6c74  uence, the.`filt
+0000fab0: 6572 5f65 7863 6c75 6465 6020 6172 6775  er_exclude` argu
+0000fac0: 6d65 6e74 2069 7320 6967 6e6f 7265 642e  ment is ignored.
+0000fad0: 0a0a 5468 6520 6f70 7469 6f6e 616c 2060  ..The optional `
+0000fae0: 6669 6c74 6572 5f62 795f 7374 7265 616d  filter_by_stream
+0000faf0: 5f6e 616d 6560 2061 7267 756d 656e 7420  _name` argument 
+0000fb00: 6973 2061 2050 7974 686f 6e20 6062 6f6f  is a Python `boo
+0000fb10: 6c60 2074 6861 7420 696e 6469 6361 7465  l` that indicate
+0000fb20: 7320 7768 6574 6865 720a 7468 6520 6669  s whether.the fi
+0000fb30: 6c74 6572 2077 696c 6c20 6170 706c 7920  lter will apply 
+0000fb40: 746f 2065 7665 6e74 2074 7970 6573 206f  to event types o
+0000fb50: 7220 7374 7265 616d 206e 616d 6573 2e20  r stream names. 
+0000fb60: 4279 2064 6566 6175 6c74 2c20 7468 6973  By default, this
+0000fb70: 2076 616c 7565 2069 7320 6046 616c 7365   value is `False
+0000fb80: 600a 616e 6420 736f 2074 6865 2066 696c  `.and so the fil
+0000fb90: 7465 7269 6e67 2077 696c 6c20 6170 706c  tering will appl
+0000fba0: 7920 746f 2074 6865 2065 7665 6e74 2074  y to the event t
+0000fbb0: 7970 6520 7374 7269 6e67 7320 6f66 2072  ype strings of r
+0000fbc0: 6563 6f72 6465 6420 6576 656e 7473 2e0a  ecorded events..
+0000fbd0: 0a54 6865 206f 7074 696f 6e61 6c20 6063  .The optional `c
+0000fbe0: 6f6e 7375 6d65 725f 7374 7261 7465 6779  onsumer_strategy
+0000fbf0: 6020 6172 6775 6d65 6e74 2069 7320 6120  ` argument is a 
+0000fc00: 5079 7468 6f6e 2060 7374 7260 2074 6861  Python `str` tha
+0000fc10: 7420 6465 6669 6e65 730a 7468 6520 636f  t defines.the co
+0000fc20: 6e73 756d 6572 2073 7472 6174 6567 7920  nsumer strategy 
+0000fc30: 666f 7220 7468 6973 2070 6572 7369 7374  for this persist
+0000fc40: 656e 7420 7375 6273 6372 6970 7469 6f6e  ent subscription
+0000fc50: 2e20 5468 6520 7661 6c75 6520 6f66 2074  . The value of t
+0000fc60: 6869 7320 6172 6775 6d65 6e74 0a63 616e  his argument.can
+0000fc70: 2062 6520 6027 4469 7370 6174 6368 546f   be `'DispatchTo
+0000fc80: 5369 6e67 6c65 2760 2c20 6027 526f 756e  Single'`, `'Roun
+0000fc90: 6452 6f62 696e 2760 2c20 6027 5069 6e6e  dRobin'`, `'Pinn
+0000fca0: 6564 2760 2c20 6f72 2060 2750 696e 6e65  ed'`, or `'Pinne
+0000fcb0: 6442 7943 6f72 7265 6c61 7469 6f6e 2760  dByCorrelation'`
+0000fcc0: 2e20 5468 650a 6465 6661 756c 7420 7661  . The.default va
+0000fcd0: 6c75 6520 6973 2060 2744 6973 7061 7463  lue is `'Dispatc
+0000fce0: 6854 6f53 696e 676c 6527 602e 0a0a 5468  hToSingle'`...Th
+0000fcf0: 6520 6f70 7469 6f6e 616c 2060 7469 6d65  e optional `time
+0000fd00: 6f75 7460 2061 7267 756d 656e 7420 6973  out` argument is
+0000fd10: 2061 2050 7974 686f 6e20 6066 6c6f 6174   a Python `float
+0000fd20: 6020 7768 6963 6820 7365 7473 2061 0a64  ` which sets a.d
+0000fd30: 6561 646c 696e 6520 666f 7220 7468 6520  eadline for the 
+0000fd40: 636f 6d70 6c65 7469 6f6e 206f 6620 7468  completion of th
+0000fd50: 6520 6752 5043 206f 7065 7261 7469 6f6e  e gRPC operation
+0000fd60: 2e0a 0a54 6865 206d 6574 686f 6420 6063  ...The method `c
+0000fd70: 7265 6174 655f 7375 6273 6372 6970 7469  reate_subscripti
+0000fd80: 6f6e 2829 6020 646f 6573 206e 6f74 2072  on()` does not r
+0000fd90: 6574 7572 6e20 6120 7661 6c75 652c 2062  eturn a value, b
+0000fda0: 6563 6175 7365 0a72 6563 6f72 6465 6420  ecause.recorded 
+0000fdb0: 6576 656e 7473 2061 7265 206f 6274 6169  events are obtai
+0000fdc0: 6e65 6420 6279 2074 6865 2067 726f 7570  ned by the group
+0000fdd0: 206f 6620 636f 6e73 756d 6572 7320 6f66   of consumers of
+0000fde0: 2074 6865 2073 7562 7363 7269 7074 696f   the subscriptio
+0000fdf0: 6e0a 7573 696e 6720 7468 6520 6072 6561  n.using the `rea
+0000fe00: 645f 7375 6273 6372 6970 7469 6f6e 2829  d_subscription()
+0000fe10: 6020 6d65 7468 6f64 2e0a 0a49 6e20 7468  ` method...In th
+0000fe20: 6520 6578 616d 706c 6520 6265 6c6f 772c  e example below,
+0000fe30: 2061 2070 6572 7369 7374 656e 7420 7375   a persistent su
+0000fe40: 6273 6372 6970 7469 6f6e 2069 7320 6372  bscription is cr
+0000fe50: 6561 7465 642e 0a0a 6060 6070 7974 686f  eated...```pytho
+0000fe60: 6e0a 2320 4372 6561 7465 2061 2070 6572  n.# Create a per
+0000fe70: 7369 7374 656e 7420 7375 6273 6372 6970  sistent subscrip
+0000fe80: 7469 6f6e 2e0a 6772 6f75 705f 6e61 6d65  tion..group_name
+0000fe90: 203d 2066 2267 726f 7570 2d7b 7575 6964   = f"group-{uuid
+0000fea0: 3428 297d 220a 636c 6965 6e74 2e63 7265  4()}".client.cre
+0000feb0: 6174 655f 7375 6273 6372 6970 7469 6f6e  ate_subscription
+0000fec0: 2867 726f 7570 5f6e 616d 653d 6772 6f75  (group_name=grou
+0000fed0: 705f 6e61 6d65 290a 6060 600a 0a23 2323  p_name).```..###
+0000fee0: 2052 6561 6420 7375 6273 6372 6970 7469   Read subscripti
+0000fef0: 6f6e 0a0a 2a72 6571 7569 7265 7320 6c65  on..*requires le
+0000ff00: 6164 6572 2a0a 0a54 6865 206d 6574 686f  ader*..The metho
+0000ff10: 6420 6072 6561 645f 7375 6273 6372 6970  d `read_subscrip
+0000ff20: 7469 6f6e 2829 6020 6361 6e20 6265 2075  tion()` can be u
+0000ff30: 7365 6420 6279 2061 2067 726f 7570 206f  sed by a group o
+0000ff40: 6620 636f 6e73 756d 6572 7320 746f 2072  f consumers to r
+0000ff50: 6563 6569 7665 0a72 6563 6f72 6465 6420  eceive.recorded 
+0000ff60: 6576 656e 7473 2066 726f 6d20 6120 7065  events from a pe
+0000ff70: 7273 6973 7465 6e74 2073 7562 7363 7269  rsistent subscri
+0000ff80: 7074 696f 6e20 6372 6561 7465 6420 7573  ption created us
+0000ff90: 696e 6720 6063 7265 6174 655f 7375 6273  ing `create_subs
+0000ffa0: 6372 6970 7469 6f6e 602e 0a0a 5468 6973  cription`...This
+0000ffb0: 206d 6574 686f 6420 7461 6b65 7320 6120   method takes a 
+0000ffc0: 7265 7175 6972 6564 2060 6772 6f75 705f  required `group_
+0000ffd0: 6e61 6d65 6020 6172 6775 6d65 6e74 2c20  name` argument, 
+0000ffe0: 7768 6963 6820 6973 0a74 6865 206e 616d  which is.the nam
+0000fff0: 6520 6f66 2061 2022 6772 6f75 7022 206f  e of a "group" o
+00010000: 6620 636f 6e73 756d 6572 7320 6f66 2074  f consumers of t
+00010010: 6865 2073 7562 7363 7269 7074 696f 6e20  he subscription 
+00010020: 7370 6563 6966 6965 640a 7768 656e 2060  specified.when `
+00010030: 6372 6561 7465 5f73 7562 7363 7269 7074  create_subscript
+00010040: 696f 6e28 2960 2077 6173 2063 616c 6c65  ion()` was calle
+00010050: 642e 0a0a 5468 6973 206d 6574 686f 6420  d...This method 
+00010060: 616c 736f 2074 616b 6573 2061 6e20 6f70  also takes an op
+00010070: 7469 6f6e 616c 2060 7469 6d65 6f75 7460  tional `timeout`
+00010080: 2061 7267 756d 656e 742c 2074 6861 740a   argument, that.
+00010090: 6973 2065 7870 6563 7465 6420 746f 2062  is expected to b
+000100a0: 6520 6120 5079 7468 6f6e 2060 666c 6f61  e a Python `floa
+000100b0: 7460 2c20 7768 6963 6820 7365 7473 2061  t`, which sets a
+000100c0: 2064 6561 646c 696e 650a 666f 7220 7468   deadline.for th
+000100d0: 6520 636f 6d70 6c65 7469 6f6e 206f 6620  e completion of 
+000100e0: 7468 6520 6752 5043 206f 7065 7261 7469  the gRPC operati
+000100f0: 6f6e 2e0a 0a54 6869 7320 6d65 7468 6f64  on...This method
+00010100: 2072 6574 7572 6e73 2061 2060 5065 7273   returns a `Pers
+00010110: 6973 7465 6e74 5375 6273 6372 6970 7469  istentSubscripti
+00010120: 6f6e 6020 6f62 6a65 6374 2c20 7768 6963  on` object, whic
+00010130: 6820 6973 2061 6e20 6974 6572 6174 6f72  h is an iterator
+00010140: 0a67 6976 696e 6720 6052 6563 6f72 6465  .giving `Recorde
+00010150: 6445 7665 6e74 6020 6f62 6a65 6374 732c  dEvent` objects,
+00010160: 2074 6861 7420 616c 736f 2068 6173 2060   that also has `
+00010170: 6163 6b28 2960 2c20 606e 6163 6b28 2960  ack()`, `nack()`
+00010180: 2061 6e64 2060 7374 6f70 2829 600a 6d65   and `stop()`.me
+00010190: 7468 6f64 732e 0a0a 6060 6070 7974 686f  thods...```pytho
+000101a0: 6e0a 7375 6273 6372 6970 7469 6f6e 203d  n.subscription =
+000101b0: 2063 6c69 656e 742e 7265 6164 5f73 7562   client.read_sub
+000101c0: 7363 7269 7074 696f 6e28 6772 6f75 705f  scription(group_
+000101d0: 6e61 6d65 3d67 726f 7570 5f6e 616d 6529  name=group_name)
+000101e0: 0a60 6060 0a0a 5468 6520 6061 636b 2829  .```..The `ack()
+000101f0: 6020 6d65 7468 6f64 2073 686f 756c 6420  ` method should 
+00010200: 6265 2075 7365 6420 6279 2061 2063 6f6e  be used by a con
+00010210: 7375 6d65 7220 746f 2069 6e64 6963 6174  sumer to indicat
+00010220: 6520 746f 2074 6865 2073 6572 7665 7220  e to the server 
+00010230: 7468 6174 2069 740a 6861 7320 7265 6365  that it.has rece
+00010240: 6976 6564 2061 6e64 2073 7563 6365 7373  ived and success
+00010250: 6675 6c6c 7920 7072 6f63 6573 7365 6420  fully processed 
+00010260: 6120 7265 636f 7264 6564 2065 7665 6e74  a recorded event
+00010270: 2e20 5468 6973 2077 696c 6c20 7072 6576  . This will prev
+00010280: 656e 7420 7468 6174 0a72 6563 6f72 6465  ent that.recorde
+00010290: 6420 6576 656e 7420 6265 696e 6720 7265  d event being re
+000102a0: 6365 6976 6564 2062 7920 616e 6f74 6865  ceived by anothe
+000102b0: 7220 636f 6e73 756d 6572 2069 6e20 7468  r consumer in th
+000102c0: 6520 7361 6d65 2067 726f 7570 2e20 5468  e same group. Th
+000102d0: 6520 6061 636b 2829 600a 6d65 7468 6f64  e `ack()`.method
+000102e0: 2074 616b 6573 2061 6e20 6065 7665 6e74   takes an `event
+000102f0: 5f69 6460 2061 7267 756d 656e 742c 2077  _id` argument, w
+00010300: 6869 6368 2069 7320 7468 6520 4944 206f  hich is the ID o
+00010310: 6620 7468 6520 7265 636f 7264 6564 2065  f the recorded e
+00010320: 7665 6e74 2074 6861 740a 6861 7320 6265  vent that.has be
+00010330: 656e 2072 6563 6569 7665 642e 0a0a 5468  en received...Th
+00010340: 6520 6578 616d 706c 6520 6265 6c6f 7720  e example below 
+00010350: 6974 6572 6174 6573 206f 7665 7220 7468  iterates over th
+00010360: 6520 7375 6273 6372 6970 7469 6f6e 206f  e subscription o
+00010370: 626a 6563 742c 2061 6e64 2063 616c 6c73  bject, and calls
+00010380: 2060 6163 6b28 2960 2e20 5468 650a 6073   `ack()`. The.`s
+00010390: 746f 7028 2960 206d 6574 686f 6420 6973  top()` method is
+000103a0: 2063 616c 6c65 6420 7768 656e 2077 6520   called when we 
+000103b0: 6861 7665 2072 6563 6569 7665 6420 7468  have received th
+000103c0: 6520 6c61 7374 2065 7665 6e74 2c20 736f  e last event, so
+000103d0: 2074 6861 7420 7765 2063 616e 0a63 6f6e   that we can.con
+000103e0: 7469 6e75 6520 7769 7468 2074 6865 2065  tinue with the e
+000103f0: 7861 6d70 6c65 7320 6265 6c6f 772e 0a0a  xamples below...
+00010400: 6060 6070 7974 686f 6e0a 6576 656e 7473  ```python.events
+00010410: 203d 205b 5d0a 666f 7220 6576 656e 7420   = [].for event 
+00010420: 696e 2073 7562 7363 7269 7074 696f 6e3a  in subscription:
+00010430: 0a20 2020 2065 7665 6e74 732e 6170 7065  .    events.appe
+00010440: 6e64 2865 7665 6e74 290a 0a20 2020 2023  nd(event)..    #
+00010450: 2041 636b 6e6f 776c 6564 6765 2074 6865   Acknowledge the
+00010460: 2072 6563 6569 7665 6420 6576 656e 742e   received event.
+00010470: 0a20 2020 2073 7562 7363 7269 7074 696f  .    subscriptio
+00010480: 6e2e 6163 6b28 6576 656e 745f 6964 3d65  n.ack(event_id=e
+00010490: 7665 6e74 2e69 6429 0a0a 2020 2020 2320  vent.id)..    # 
+000104a0: 4272 6561 6b20 7768 656e 2074 6865 206c  Break when the l
+000104b0: 6173 7420 6576 656e 7420 6861 7320 6265  ast event has be
+000104c0: 656e 2072 6563 6569 7665 642e 0a20 2020  en received..   
+000104d0: 2069 6620 6576 656e 742e 6964 203d 3d20   if event.id == 
+000104e0: 6576 656e 7431 312e 6964 3a0a 2020 2020  event11.id:.    
+000104f0: 2020 2020 7375 6273 6372 6970 7469 6f6e      subscription
+00010500: 2e73 746f 7028 290a 6060 600a 0a54 6865  .stop().```..The
+00010510: 2072 6563 6569 7665 6420 6576 656e 7473   received events
+00010520: 2061 7265 2074 6865 2065 7665 6e74 7320   are the events 
+00010530: 7765 2061 7070 656e 6465 6420 6162 6f76  we appended abov
+00010540: 652e 0a0a 6060 6070 7974 686f 6e0a 6173  e...```python.as
+00010550: 7365 7274 2065 7665 6e74 735b 2d31 355d  sert events[-15]
+00010560: 2e69 6420 3d3d 2065 7665 6e74 312e 6964  .id == event1.id
+00010570: 0a61 7373 6572 7420 6576 656e 7473 5b2d  .assert events[-
+00010580: 3134 5d2e 6964 203d 3d20 6576 656e 7432  14].id == event2
+00010590: 2e69 640a 6173 7365 7274 2065 7665 6e74  .id.assert event
+000105a0: 735b 2d31 335d 2e69 6420 3d3d 2065 7665  s[-13].id == eve
+000105b0: 6e74 332e 6964 0a61 7373 6572 7420 6576  nt3.id.assert ev
+000105c0: 656e 7473 5b2d 3132 5d2e 7479 7065 203d  ents[-12].type =
+000105d0: 3d20 2244 6f67 5265 6769 7374 6572 6564  = "DogRegistered
+000105e0: 220a 6173 7365 7274 2065 7665 6e74 735b  ".assert events[
+000105f0: 2d31 315d 2e74 7970 6520 3d3d 2022 446f  -11].type == "Do
+00010600: 674c 6561 726e 6564 5472 6963 6b22 0a61  gLearnedTrick".a
+00010610: 7373 6572 7420 6576 656e 7473 5b2d 3130  ssert events[-10
+00010620: 5d2e 7479 7065 203d 3d20 2244 6f67 4c65  ].type == "DogLe
+00010630: 6172 6e65 6454 7269 636b 220a 6173 7365  arnedTrick".asse
+00010640: 7274 2065 7665 6e74 735b 2d39 5d2e 7479  rt events[-9].ty
+00010650: 7065 203d 3d20 2244 6f67 4c65 6172 6e65  pe == "DogLearne
+00010660: 6454 7269 636b 220a 6173 7365 7274 2065  dTrick".assert e
+00010670: 7665 6e74 735b 2d38 5d2e 6964 203d 3d20  vents[-8].id == 
+00010680: 6576 656e 7434 2e69 640a 6173 7365 7274  event4.id.assert
+00010690: 2065 7665 6e74 735b 2d37 5d2e 6964 203d   events[-7].id =
+000106a0: 3d20 6576 656e 7435 2e69 640a 6173 7365  = event5.id.asse
+000106b0: 7274 2065 7665 6e74 735b 2d36 5d2e 6964  rt events[-6].id
+000106c0: 203d 3d20 6576 656e 7436 2e69 640a 6173   == event6.id.as
+000106d0: 7365 7274 2065 7665 6e74 735b 2d35 5d2e  sert events[-5].
+000106e0: 6964 203d 3d20 6576 656e 7437 2e69 640a  id == event7.id.
+000106f0: 6173 7365 7274 2065 7665 6e74 735b 2d34  assert events[-4
+00010700: 5d2e 6964 203d 3d20 6576 656e 7438 2e69  ].id == event8.i
+00010710: 640a 6173 7365 7274 2065 7665 6e74 735b  d.assert events[
+00010720: 2d33 5d2e 6964 203d 3d20 6576 656e 7439  -3].id == event9
+00010730: 2e69 640a 6173 7365 7274 2065 7665 6e74  .id.assert event
+00010740: 735b 2d32 5d2e 6964 203d 3d20 6576 656e  s[-2].id == even
+00010750: 7431 302e 6964 0a61 7373 6572 7420 6576  t10.id.assert ev
+00010760: 656e 7473 5b2d 315d 2e69 6420 3d3d 2065  ents[-1].id == e
+00010770: 7665 6e74 3131 2e69 640a 6060 600a 0a54  vent11.id.```..T
+00010780: 6865 2022 7375 6273 6372 6970 7469 6f6e  he "subscription
+00010790: 2220 6f62 6a65 6374 2061 6c73 6f20 6861  " object also ha
+000107a0: 7320 616e 2060 6e61 636b 2829 6020 6d65  s an `nack()` me
+000107b0: 7468 6f64 2074 6861 7420 7368 6f75 6c64  thod that should
+000107c0: 2062 6520 7573 6564 2062 7920 6120 636f   be used by a co
+000107d0: 6e73 756d 6572 0a74 6f20 6e65 6761 7469  nsumer.to negati
+000107e0: 7665 6c79 2061 636b 6e6f 776c 6564 6765  vely acknowledge
+000107f0: 2074 6f20 7468 6520 7365 7276 6572 2074   to the server t
+00010800: 6861 7420 6974 2068 6173 2072 6563 6569  hat it has recei
+00010810: 7665 6420 6275 7420 6e6f 7420 7375 6363  ved but not succ
+00010820: 6573 7366 756c 6c79 0a70 726f 6365 7373  essfully.process
+00010830: 6564 2061 2072 6563 6f72 6465 6420 6576  ed a recorded ev
+00010840: 656e 742e 2054 6865 2060 6e61 636b 2829  ent. The `nack()
+00010850: 6020 6d65 7468 6f64 2074 616b 6573 2061  ` method takes a
+00010860: 6e20 6065 7665 6e74 5f69 6460 2061 7267  n `event_id` arg
+00010870: 756d 656e 742c 2077 6869 6368 2069 730a  ument, which is.
+00010880: 7468 6520 4944 206f 6620 7468 6520 7265  the ID of the re
+00010890: 636f 7264 6564 2065 7665 6e74 2074 6861  corded event tha
+000108a0: 7420 6861 7320 6265 656e 2072 6563 6569  t has been recei
+000108b0: 7665 642c 2061 6e64 2061 6e20 6061 6374  ved, and an `act
+000108c0: 696f 6e60 2061 7267 756d 656e 742c 2077  ion` argument, w
+000108d0: 6869 6368 0a73 686f 756c 6420 6265 2061  hich.should be a
+000108e0: 2050 7974 686f 6e20 6073 7472 602c 2065   Python `str`, e
+000108f0: 6974 6865 7220 6027 756e 6b6e 6f77 6e27  ither `'unknown'
+00010900: 602c 2060 2770 6172 6b27 602c 2060 2772  `, `'park'`, `'r
+00010910: 6574 7279 2760 2c20 6027 736b 6970 2760  etry'`, `'skip'`
+00010920: 2c20 6f72 2060 2773 746f 7027 602e 0a0a  , or `'stop'`...
+00010930: 5768 696c 7374 2074 6865 7265 2061 7265  Whilst there are
+00010940: 2073 6f6d 6520 6164 7661 6e74 6167 6573   some advantages
+00010950: 206f 6620 7065 7273 6973 7465 6e74 2073   of persistent s
+00010960: 7562 7363 7269 7074 696f 6e73 2c20 696e  ubscriptions, in
+00010970: 2070 6172 7469 6375 6c61 7220 7468 650a   particular the.
+00010980: 7072 6f63 6573 7369 6e67 206f 6620 7265  processing of re
+00010990: 636f 7264 6564 2065 7665 6e74 7320 6279  corded events by
+000109a0: 2061 2067 726f 7570 206f 6620 636f 6e73   a group of cons
+000109b0: 756d 6572 732c 2062 7920 7472 6163 6b69  umers, by tracki
+000109c0: 6e67 2069 6e20 7468 6520 7365 7276 6572  ng in the server
+000109d0: 0a74 6865 2070 6f73 6974 696f 6e20 696e  .the position in
+000109e0: 2074 6865 2063 6f6d 6d69 7420 7365 7175   the commit sequ
+000109f0: 656e 6365 206f 6620 6576 656e 7473 2074  ence of events t
+00010a00: 6861 7420 6861 7665 2062 6565 6e20 7072  hat have been pr
+00010a10: 6f63 6573 7365 642c 2074 6865 7265 2069  ocessed, there i
+00010a20: 730a 7468 6520 6461 6e67 6572 206f 6620  s.the danger of 
+00010a30: 2264 7561 6c20 7772 6974 696e 6722 2069  "dual writing" i
+00010a40: 6e20 7468 6520 636f 6e73 756d 7074 696f  n the consumptio
+00010a50: 6e20 6f66 2065 7665 6e74 732e 2052 656c  n of events. Rel
+00010a60: 6961 6269 6c69 7479 2069 6e20 7072 6f63  iability in proc
+00010a70: 6573 7369 6e67 0a6f 6620 7265 636f 7264  essing.of record
+00010a80: 6564 2065 7665 6e74 7320 6279 2061 2067  ed events by a g
+00010a90: 726f 7570 206f 6620 636f 6e73 756d 6572  roup of consumer
+00010aa0: 7320 7769 6c6c 2072 656c 7920 696e 7374  s will rely inst
+00010ab0: 6561 6420 6f6e 2069 6465 6d70 6f74 656e  ead on idempoten
+00010ac0: 7420 6861 6e64 6c69 6e67 0a6f 6620 6475  t handling.of du
+00010ad0: 706c 6963 6174 6520 6d65 7373 6167 6573  plicate messages
+00010ae0: 2c20 616e 6420 7265 7369 6c69 656e 6365  , and resilience
+00010af0: 2074 6f20 6f75 742d 6f66 2d6f 7264 6572   to out-of-order
+00010b00: 2064 656c 6976 6572 792e 0a0a 2323 2320   delivery...### 
+00010b10: 4765 7420 7375 6273 6372 6970 7469 6f6e  Get subscription
+00010b20: 2069 6e66 6f0a 0a2a 7265 7175 6972 6573   info..*requires
+00010b30: 206c 6561 6465 722a 0a0a 5468 6520 6067   leader*..The `g
+00010b40: 6574 5f73 7562 7363 7269 7074 696f 6e5f  et_subscription_
+00010b50: 696e 666f 2829 6020 6d65 7468 6f64 2063  info()` method c
+00010b60: 616e 2062 6520 7573 6564 2074 6f20 6765  an be used to ge
+00010b70: 7420 696e 666f 726d 6174 696f 6e20 666f  t information fo
+00010b80: 7220 610a 7065 7273 6973 7465 6e74 2073  r a.persistent s
+00010b90: 7562 7363 7269 7074 696f 6e2e 0a0a 5468  ubscription...Th
+00010ba0: 6973 206d 6574 686f 6420 6861 7320 6f6e  is method has on
+00010bb0: 6520 7265 7175 6972 6564 2061 7267 756d  e required argum
+00010bc0: 656e 742c 2060 6772 6f75 705f 6e61 6d65  ent, `group_name
+00010bd0: 602c 2077 6869 6368 0a73 686f 756c 6420  `, which.should 
+00010be0: 6d61 7463 6820 7468 6520 7661 6c75 6520  match the value 
+00010bf0: 6f66 2074 6865 2061 7267 756d 656e 7420  of the argument 
+00010c00: 7573 6564 2077 6865 6e20 6361 6c6c 696e  used when callin
+00010c10: 6720 6063 7265 6174 655f 7375 6273 6372  g `create_subscr
+00010c20: 6970 7469 6f6e 2829 602e 0a0a 5468 6973  iption()`...This
+00010c30: 206d 6574 686f 6420 616c 736f 2074 616b   method also tak
+00010c40: 6573 2061 6e20 6f70 7469 6f6e 616c 2060  es an optional `
+00010c50: 7469 6d65 6f75 7460 2061 7267 756d 656e  timeout` argumen
+00010c60: 742c 2074 6861 740a 6973 2065 7870 6563  t, that.is expec
+00010c70: 7465 6420 746f 2062 6520 6120 5079 7468  ted to be a Pyth
+00010c80: 6f6e 2060 666c 6f61 7460 2c20 7768 6963  on `float`, whic
+00010c90: 6820 7365 7473 2061 2064 6561 646c 696e  h sets a deadlin
+00010ca0: 650a 666f 7220 7468 6520 636f 6d70 6c65  e.for the comple
+00010cb0: 7469 6f6e 206f 6620 7468 6520 6752 5043  tion of the gRPC
+00010cc0: 206f 7065 7261 7469 6f6e 2e0a 0a60 6060   operation...```
+00010cd0: 7079 7468 6f6e 0a73 7562 7363 7269 7074  python.subscript
+00010ce0: 696f 6e5f 696e 666f 203d 2063 6c69 656e  ion_info = clien
+00010cf0: 742e 6765 745f 7375 6273 6372 6970 7469  t.get_subscripti
+00010d00: 6f6e 5f69 6e66 6f28 0a20 2020 2067 726f  on_info(.    gro
+00010d10: 7570 5f6e 616d 653d 6772 6f75 705f 6e61  up_name=group_na
+00010d20: 6d65 2c0a 290a 6060 600a 0a54 6865 2072  me,.).```..The r
+00010d30: 6574 7572 6e65 6420 7661 6c75 6520 6973  eturned value is
+00010d40: 2061 2060 5375 6273 6372 6970 7469 6f6e   a `Subscription
+00010d50: 496e 666f 6020 6f62 6a65 6374 2e0a 0a23  Info` object...#
+00010d60: 2323 204c 6973 7420 7375 6273 6372 6970  ## List subscrip
+00010d70: 7469 6f6e 730a 0a2a 7265 7175 6972 6573  tions..*requires
+00010d80: 206c 6561 6465 722a 0a0a 5468 6520 606c   leader*..The `l
+00010d90: 6973 745f 7375 6273 6372 6970 7469 6f6e  ist_subscription
+00010da0: 7328 2960 206d 6574 686f 6420 6361 6e20  s()` method can 
+00010db0: 6265 2075 7365 6420 746f 2067 6574 2069  be used to get i
+00010dc0: 6e66 6f72 6d61 7469 6f6e 2066 6f72 2061  nformation for a
+00010dd0: 6c6c 0a65 7869 7374 696e 6720 7065 7273  ll.existing pers
+00010de0: 6973 7465 6e74 2073 7562 7363 7269 7074  istent subscript
+00010df0: 696f 6e73 2e0a 0a54 6869 7320 6d65 7468  ions...This meth
+00010e00: 6f64 2074 616b 6573 2061 6e20 6f70 7469  od takes an opti
+00010e10: 6f6e 616c 2060 7469 6d65 6f75 7460 2061  onal `timeout` a
+00010e20: 7267 756d 656e 742c 2074 6861 740a 6973  rgument, that.is
+00010e30: 2065 7870 6563 7465 6420 746f 2062 6520   expected to be 
+00010e40: 6120 5079 7468 6f6e 2060 666c 6f61 7460  a Python `float`
+00010e50: 2c20 7768 6963 6820 7365 7473 2061 2064  , which sets a d
+00010e60: 6561 646c 696e 650a 666f 7220 7468 6520  eadline.for the 
+00010e70: 636f 6d70 6c65 7469 6f6e 206f 6620 7468  completion of th
+00010e80: 6520 6752 5043 206f 7065 7261 7469 6f6e  e gRPC operation
+00010e90: 2e0a 0a60 6060 7079 7468 6f6e 0a73 7562  ...```python.sub
+00010ea0: 7363 7269 7074 696f 6e73 203d 2063 6c69  scriptions = cli
+00010eb0: 656e 742e 6c69 7374 5f73 7562 7363 7269  ent.list_subscri
+00010ec0: 7074 696f 6e73 2829 0a60 6060 0a0a 5468  ptions().```..Th
+00010ed0: 6520 7265 7475 726e 6564 2076 616c 7565  e returned value
+00010ee0: 2069 7320 6120 6c69 7374 206f 6620 6053   is a list of `S
+00010ef0: 7562 7363 7269 7074 696f 6e49 6e66 6f60  ubscriptionInfo`
+00010f00: 206f 626a 6563 7473 2e0a 0a23 2323 2055   objects...### U
+00010f10: 7064 6174 6520 7375 6273 6372 6970 7469  pdate subscripti
+00010f20: 6f6e 0a0a 2a72 6571 7569 7265 7320 6c65  on..*requires le
+00010f30: 6164 6572 2a0a 0a54 6865 206d 6574 686f  ader*..The metho
+00010f40: 6420 6075 7064 6174 655f 7375 6273 6372  d `update_subscr
+00010f50: 6970 7469 6f6e 2829 6020 6361 6e20 6265  iption()` can be
+00010f60: 2075 7365 6420 746f 2075 7064 6174 6520   used to update 
+00010f70: 610a 2270 6572 7369 7374 656e 7420 7375  a."persistent su
+00010f80: 6273 6372 6970 7469 6f6e 222e 0a0a 5468  bscription"...Th
+00010f90: 6973 206d 6574 686f 6420 7461 6b65 7320  is method takes 
+00010fa0: 6120 7265 7175 6972 6564 2060 6772 6f75  a required `grou
+00010fb0: 705f 6e61 6d65 6020 6172 6775 6d65 6e74  p_name` argument
+00010fc0: 2c20 7768 6963 6820 6973 2074 6865 0a6e  , which is the.n
+00010fd0: 616d 6520 6f66 2061 2022 6772 6f75 7022  ame of a "group"
+00010fe0: 206f 6620 636f 6e73 756d 6572 7320 6f66   of consumers of
+00010ff0: 2074 6865 2073 7562 7363 7269 7074 696f   the subscriptio
+00011000: 6e2e 0a0a 5468 6973 206d 6574 686f 6420  n...This method 
+00011010: 616c 736f 2074 616b 6573 2074 6872 6565  also takes three
+00011020: 206f 7074 696f 6e61 6c20 6172 6775 6d65   optional argume
+00011030: 6e74 732c 2060 6672 6f6d 5f65 6e64 602c  nts, `from_end`,
+00011040: 2060 636f 6d6d 6974 5f70 6f73 6974 696f   `commit_positio
+00011050: 6e60 2c0a 616e 6420 6074 696d 656f 7574  n`,.and `timeout
+00011060: 602e 0a0a 5468 6520 6f70 7469 6f6e 616c  `...The optional
+00011070: 2060 6672 6f6d 5f65 6e64 6020 6172 6775   `from_end` argu
+00011080: 6d65 6e74 2063 616e 2062 6520 7573 6564  ment can be used
+00011090: 2074 6f20 7370 6563 6966 7920 7468 6174   to specify that
+000110a0: 2074 6865 2067 726f 7570 206f 6620 636f   the group of co
+000110b0: 6e73 756d 6572 730a 6f66 2074 6865 2073  nsumers.of the s
+000110c0: 7562 7363 7269 7074 696f 6e20 7368 6f75  ubscription shou
+000110d0: 6c64 206f 6e6c 7920 7265 6365 6976 6520  ld only receive 
+000110e0: 6576 656e 7473 2074 6861 7420 7765 7265  events that were
+000110f0: 2072 6563 6f72 6465 6420 6166 7465 7220   recorded after 
+00011100: 7468 6520 7375 6273 6372 6970 7469 6f6e  the subscription
+00011110: 0a77 6173 2075 7064 6174 6564 2e0a 0a41  .was updated...A
+00011120: 6c74 6572 6e61 7469 7665 6c79 2c20 7468  lternatively, th
+00011130: 6520 6f70 7469 6f6e 616c 2060 636f 6d6d  e optional `comm
+00011140: 6974 5f70 6f73 6974 696f 6e60 2061 7267  it_position` arg
+00011150: 756d 656e 7420 6361 6e20 6265 2075 7365  ument can be use
+00011160: 6420 746f 2073 7065 6369 6679 2061 2063  d to specify a c
+00011170: 6f6d 6d69 740a 706f 7369 7469 6f6e 2066  ommit.position f
+00011180: 726f 6d20 7768 6963 6820 636f 6d6d 6974  rom which commit
+00011190: 2070 6f73 6974 696f 6e20 7468 6520 6772   position the gr
+000111a0: 6f75 7020 6f66 2063 6f6e 7375 6d65 7273  oup of consumers
+000111b0: 206f 6620 7468 6520 7375 6273 6372 6970   of the subscrip
+000111c0: 7469 6f6e 2073 686f 756c 640a 7265 6365  tion should.rece
+000111d0: 6976 6520 6576 656e 7473 2e20 506c 6561  ive events. Plea
+000111e0: 7365 206e 6f74 652c 2074 6865 2072 6563  se note, the rec
+000111f0: 6f72 6465 6420 6576 656e 7420 6174 2074  orded event at t
+00011200: 6865 2073 7065 6369 6669 6564 2063 6f6d  he specified com
+00011210: 6d69 7420 706f 7369 7469 6f6e 206d 6967  mit position mig
+00011220: 6874 0a62 6520 696e 636c 7564 6564 2069  ht.be included i
+00011230: 6e20 7468 6520 7265 636f 7264 6564 2065  n the recorded e
+00011240: 7665 6e74 7320 7265 6365 6976 6564 2062  vents received b
+00011250: 7920 7468 6520 6772 6f75 7020 6f66 2063  y the group of c
+00011260: 6f6e 7375 6d65 7273 2e0a 0a49 6620 6e65  onsumers...If ne
+00011270: 6974 6865 7220 6066 726f 6d5f 656e 6460  ither `from_end`
+00011280: 206f 7220 6063 6f6d 6d69 745f 706f 7369   or `commit_posi
+00011290: 7469 6f6e 6020 6172 6520 7370 6563 6966  tion` are specif
+000112a0: 6965 642c 2074 6865 2067 726f 7570 206f  ied, the group o
+000112b0: 6620 636f 6e73 756d 6572 730a 6f66 2074  f consumers.of t
+000112c0: 6865 2073 7562 7363 7269 7074 696f 6e20  he subscription 
+000112d0: 7769 6c6c 2070 6f74 656e 7469 616c 6c79  will potentially
+000112e0: 2072 6563 6569 7665 2061 6c6c 2072 6563   receive all rec
+000112f0: 6f72 6465 6420 6576 656e 7473 2069 6e20  orded events in 
+00011300: 7468 6520 6461 7461 6261 7365 2e0a 0a50  the database...P
+00011310: 6c65 6173 6520 6e6f 7465 2c20 7468 6520  lease note, the 
+00011320: 6669 6c74 6572 206f 7074 696f 6e73 2061  filter options a
+00011330: 6e64 2063 6f6e 7375 6d65 7220 7374 7261  nd consumer stra
+00011340: 7465 6779 2063 616e 6e6f 7420 6265 2061  tegy cannot be a
+00011350: 646a 7573 7465 642e 0a0a 5468 6520 6f70  djusted...The op
+00011360: 7469 6f6e 616c 2060 7469 6d65 6f75 7460  tional `timeout`
+00011370: 2061 7267 756d 656e 7420 6973 2061 2050   argument is a P
+00011380: 7974 686f 6e20 6066 6c6f 6174 6020 7768  ython `float` wh
+00011390: 6963 6820 7365 7473 2061 0a64 6561 646c  ich sets a.deadl
+000113a0: 696e 6520 666f 7220 7468 6520 636f 6d70  ine for the comp
+000113b0: 6c65 7469 6f6e 206f 6620 7468 6520 6752  letion of the gR
+000113c0: 5043 206f 7065 7261 7469 6f6e 2e0a 0a54  PC operation...T
+000113d0: 6865 206d 6574 686f 6420 6075 7064 6174  he method `updat
+000113e0: 655f 7375 6273 6372 6970 7469 6f6e 2829  e_subscription()
+000113f0: 6020 646f 6573 206e 6f74 2072 6574 7572  ` does not retur
+00011400: 6e20 6120 7661 6c75 652e 0a0a 496e 2074  n a value...In t
+00011410: 6865 2065 7861 6d70 6c65 2062 656c 6f77  he example below
+00011420: 2c20 6120 7065 7273 6973 7465 6e74 2073  , a persistent s
+00011430: 7562 7363 7269 7074 696f 6e20 6973 2075  ubscription is u
+00011440: 7064 6174 6564 2074 6f20 7275 6e20 6672  pdated to run fr
+00011450: 6f6d 2074 6865 2065 6e64 206f 6620 7468  om the end of th
+00011460: 650a 6461 7461 6261 7365 2e0a 0a60 6060  e.database...```
+00011470: 7079 7468 6f6e 0a23 2043 7265 6174 6520  python.# Create 
+00011480: 6120 7065 7273 6973 7465 6e74 2073 7562  a persistent sub
+00011490: 7363 7269 7074 696f 6e2e 0a63 6c69 656e  scription..clien
+000114a0: 742e 7570 6461 7465 5f73 7562 7363 7269  t.update_subscri
+000114b0: 7074 696f 6e28 6772 6f75 705f 6e61 6d65  ption(group_name
+000114c0: 3d67 726f 7570 5f6e 616d 652c 2066 726f  =group_name, fro
+000114d0: 6d5f 656e 643d 5472 7565 290a 6060 600a  m_end=True).```.
+000114e0: 0a23 2323 2044 656c 6574 6520 7375 6273  .### Delete subs
+000114f0: 6372 6970 7469 6f6e 0a0a 2a72 6571 7569  cription..*requi
+00011500: 7265 7320 6c65 6164 6572 2a0a 0a54 6865  res leader*..The
+00011510: 2060 6465 6c65 7465 5f73 7562 7363 7269   `delete_subscri
+00011520: 7074 696f 6e28 2960 206d 6574 686f 6420  ption()` method 
+00011530: 6361 6e20 6265 2075 7365 6420 746f 2064  can be used to d
+00011540: 656c 6574 6520 6120 7065 7273 6973 7465  elete a persiste
+00011550: 6e74 0a73 7562 7363 7269 7074 696f 6e2e  nt.subscription.
+00011560: 0a0a 5468 6973 206d 6574 686f 6420 6861  ..This method ha
+00011570: 7320 6f6e 6520 7265 7175 6972 6564 2061  s one required a
+00011580: 7267 756d 656e 742c 2060 6772 6f75 705f  rgument, `group_
+00011590: 6e61 6d65 602c 2077 6869 6368 0a73 686f  name`, which.sho
+000115a0: 756c 6420 6d61 7463 6820 7468 6520 7661  uld match the va
+000115b0: 6c75 6520 6f66 2061 7267 756d 656e 7420  lue of argument 
+000115c0: 7573 6564 2077 6865 6e20 6361 6c6c 696e  used when callin
+000115d0: 6720 6063 7265 6174 655f 7375 6273 6372  g `create_subscr
+000115e0: 6970 7469 6f6e 2829 602e 0a0a 5468 6973  iption()`...This
+000115f0: 206d 6574 686f 6420 616c 736f 2074 616b   method also tak
+00011600: 6573 2061 6e20 6f70 7469 6f6e 616c 2060  es an optional `
+00011610: 7469 6d65 6f75 7460 2061 7267 756d 656e  timeout` argumen
+00011620: 742c 2074 6861 740a 6973 2065 7870 6563  t, that.is expec
+00011630: 7465 6420 746f 2062 6520 6120 5079 7468  ted to be a Pyth
+00011640: 6f6e 2060 666c 6f61 7460 2c20 7768 6963  on `float`, whic
+00011650: 6820 7365 7473 2061 2064 6561 646c 696e  h sets a deadlin
+00011660: 650a 666f 7220 7468 6520 636f 6d70 6c65  e.for the comple
+00011670: 7469 6f6e 206f 6620 7468 6520 6752 5043  tion of the gRPC
+00011680: 206f 7065 7261 7469 6f6e 2e0a 0a60 6060   operation...```
+00011690: 7079 7468 6f6e 0a63 6c69 656e 742e 6465  python.client.de
+000116a0: 6c65 7465 5f73 7562 7363 7269 7074 696f  lete_subscriptio
+000116b0: 6e28 0a20 2020 2067 726f 7570 5f6e 616d  n(.    group_nam
+000116c0: 653d 6772 6f75 705f 6e61 6d65 2c0a 290a  e=group_name,.).
+000116d0: 6060 600a 0a23 2323 2043 7265 6174 6520  ```..### Create 
+000116e0: 7374 7265 616d 2073 7562 7363 7269 7074  stream subscript
+000116f0: 696f 6e0a 0a2a 7265 7175 6972 6573 206c  ion..*requires l
+00011700: 6561 6465 722a 0a0a 5468 6520 6063 7265  eader*..The `cre
+00011710: 6174 655f 7374 7265 616d 5f73 7562 7363  ate_stream_subsc
+00011720: 7269 7074 696f 6e28 2960 206d 6574 686f  ription()` metho
+00011730: 6420 6361 6e20 6265 2075 7365 6420 746f  d can be used to
+00011740: 2063 7265 6174 6520 6120 7065 7273 6973   create a persis
+00011750: 7465 6e74 0a73 7562 7363 7269 7074 696f  tent.subscriptio
+00011760: 6e20 666f 7220 6120 7374 7265 616d 2e0a  n for a stream..
+00011770: 0a54 6869 7320 6d65 7468 6f64 2068 6173  .This method has
+00011780: 2074 776f 2072 6571 7569 7265 6420 6172   two required ar
+00011790: 6775 6d65 6e74 732c 2060 6772 6f75 705f  guments, `group_
+000117a0: 6e61 6d65 6020 616e 6420 6073 7472 6561  name` and `strea
+000117b0: 6d5f 6e61 6d65 602e 2054 6865 0a60 6772  m_name`. The.`gr
+000117c0: 6f75 705f 6e61 6d65 6020 6172 6775 6d65  oup_name` argume
+000117d0: 6e74 206e 616d 6573 2074 6865 2067 726f  nt names the gro
+000117e0: 7570 206f 6620 636f 6e73 756d 6572 7320  up of consumers 
+000117f0: 7468 6174 2077 696c 6c20 7265 6365 6976  that will receiv
+00011800: 6520 6576 656e 7473 0a66 726f 6d20 7468  e events.from th
+00011810: 6973 2073 7562 7363 7269 7074 696f 6e2e  is subscription.
+00011820: 2054 6865 2060 7374 7265 616d 5f6e 616d   The `stream_nam
+00011830: 6560 2061 7267 756d 656e 7420 7370 6563  e` argument spec
+00011840: 6966 6965 7320 7768 6963 6820 7374 7265  ifies which stre
+00011850: 616d 0a74 6865 2073 7562 7363 7269 7074  am.the subscript
+00011860: 696f 6e20 7769 6c6c 2066 6f6c 6c6f 772e  ion will follow.
+00011870: 2054 6865 2076 616c 7565 7320 6f66 2062   The values of b
+00011880: 6f74 6820 7468 6573 6520 6172 6775 6d65  oth these argume
+00011890: 6e74 7320 6172 6520 6578 7065 6374 6564  nts are expected
+000118a0: 0a74 6f20 6265 2050 7974 686f 6e20 6073  .to be Python `s
+000118b0: 7472 6020 6f62 6a65 6374 732e 0a0a 5468  tr` objects...Th
+000118c0: 6520 6d65 7468 6f64 2061 6c73 6f20 7461  e method also ta
+000118d0: 6b65 7320 666f 7572 206f 7074 696f 6e61  kes four optiona
+000118e0: 6c20 6172 6775 6d65 6e74 732c 2060 7374  l arguments, `st
+000118f0: 7265 616d 5f70 6f73 6974 696f 6e60 2c20  ream_position`, 
+00011900: 6066 726f 6d5f 656e 6460 2c0a 6063 6f6e  `from_end`,.`con
+00011910: 7375 6d65 725f 7374 7261 7465 6779 602c  sumer_strategy`,
+00011920: 2061 6e64 2060 7469 6d65 6f75 7460 2e0a   and `timeout`..
+00011930: 0a54 6869 7320 6f70 7469 6f6e 616c 2060  .This optional `
+00011940: 7374 7265 616d 5f70 6f73 6974 696f 6e60  stream_position`
+00011950: 2061 7267 756d 656e 7420 7370 6563 6966   argument specif
+00011960: 6965 7320 6120 7374 7265 616d 2070 6f73  ies a stream pos
+00011970: 6974 696f 6e20 6672 6f6d 0a77 6869 6368  ition from.which
+00011980: 2074 6f20 7375 6273 6372 6962 652e 2054   to subscribe. T
+00011990: 6865 2072 6563 6f72 6465 6420 6576 656e  he recorded even
+000119a0: 7420 6174 2074 6869 7320 7374 7265 616d  t at this stream
+000119b0: 0a70 6f73 6974 696f 6e20 7769 6c6c 2062  .position will b
+000119c0: 6520 7265 6365 6976 6564 2077 6865 6e20  e received when 
+000119d0: 7265 6164 696e 6720 7468 6520 7375 6273  reading the subs
+000119e0: 6372 6970 7469 6f6e 2e0a 0a54 6869 7320  cription...This 
+000119f0: 6f70 7469 6f6e 616c 2060 6672 6f6d 5f65  optional `from_e
+00011a00: 6e64 6020 6172 6775 6d65 6e74 2069 7320  nd` argument is 
+00011a10: 6120 5079 7468 6f6e 2060 626f 6f6c 602e  a Python `bool`.
+00011a20: 0a42 7920 6465 6661 756c 742c 2074 6865  .By default, the
+00011a30: 2076 616c 7565 206f 6620 7468 6973 2061   value of this a
+00011a40: 7267 756d 656e 7420 6973 2060 4661 6c73  rgument is `Fals
+00011a50: 6560 2e20 4966 2074 6869 7320 6172 6775  e`. If this argu
+00011a60: 6d65 6e74 2069 7320 7365 740a 746f 2060  ment is set.to `
+00011a70: 5472 7565 602c 2072 6561 6469 6e67 2066  True`, reading f
+00011a80: 726f 6d20 7468 6520 7375 6273 6372 6970  rom the subscrip
+00011a90: 7469 6f6e 2077 696c 6c20 7265 6365 6976  tion will receiv
+00011aa0: 6520 6f6e 6c79 2065 7665 6e74 730a 7265  e only events.re
+00011ab0: 636f 7264 6564 2061 6674 6572 2074 6865  corded after the
+00011ac0: 2073 7562 7363 7269 7074 696f 6e20 7761   subscription wa
+00011ad0: 7320 6372 6561 7465 642e 2054 6861 7420  s created. That 
+00011ae0: 6973 2c20 6974 2069 7320 6e6f 7420 696e  is, it is not in
+00011af0: 636c 7573 6976 650a 6f66 2074 6865 2063  clusive.of the c
+00011b00: 7572 7265 6e74 2073 7472 6561 6d20 706f  urrent stream po
+00011b10: 7369 7469 6f6e 2e0a 0a54 6865 206f 7074  sition...The opt
+00011b20: 696f 6e61 6c20 6063 6f6e 7375 6d65 725f  ional `consumer_
+00011b30: 7374 7261 7465 6779 6020 6172 6775 6d65  strategy` argume
+00011b40: 6e74 2069 7320 6120 5079 7468 6f6e 2060  nt is a Python `
+00011b50: 7374 7260 2074 6861 7420 6465 6669 6e65  str` that define
+00011b60: 730a 7468 6520 636f 6e73 756d 6572 2073  s.the consumer s
+00011b70: 7472 6174 6567 7920 666f 7220 7468 6973  trategy for this
+00011b80: 2070 6572 7369 7374 656e 7420 7375 6273   persistent subs
+00011b90: 6372 6970 7469 6f6e 2e20 5468 6520 7661  cription. The va
+00011ba0: 6c75 6520 6f66 2074 6869 7320 6172 6775  lue of this argu
+00011bb0: 6d65 6e74 0a63 616e 2062 6520 6027 4469  ment.can be `'Di
+00011bc0: 7370 6174 6368 546f 5369 6e67 6c65 2760  spatchToSingle'`
+00011bd0: 2c20 6027 526f 756e 6452 6f62 696e 2760  , `'RoundRobin'`
+00011be0: 2c20 6027 5069 6e6e 6564 2760 2c20 6f72  , `'Pinned'`, or
+00011bf0: 2060 2750 696e 6e65 6442 7943 6f72 7265   `'PinnedByCorre
+00011c00: 6c61 7469 6f6e 2760 2e20 5468 650a 6465  lation'`. The.de
+00011c10: 6661 756c 7420 7661 6c75 6520 6973 2060  fault value is `
+00011c20: 2744 6973 7061 7463 6854 6f53 696e 676c  'DispatchToSingl
+00011c30: 6527 602e 0a0a 5468 6973 206d 6574 686f  e'`...This metho
+00011c40: 6420 616c 736f 2074 616b 6573 2061 6e20  d also takes an 
+00011c50: 6f70 7469 6f6e 616c 2060 7469 6d65 6f75  optional `timeou
+00011c60: 7460 2061 7267 756d 656e 742c 2074 6861  t` argument, tha
+00011c70: 740a 6973 2065 7870 6563 7465 6420 746f  t.is expected to
+00011c80: 2062 6520 6120 5079 7468 6f6e 2060 666c   be a Python `fl
+00011c90: 6f61 7460 2c20 7768 6963 6820 7365 7473  oat`, which sets
+00011ca0: 2061 2064 6561 646c 696e 650a 666f 7220   a deadline.for 
+00011cb0: 7468 6520 636f 6d70 6c65 7469 6f6e 206f  the completion o
+00011cc0: 6620 7468 6520 6752 5043 206f 7065 7261  f the gRPC opera
+00011cd0: 7469 6f6e 2e0a 0a54 6869 7320 6d65 7468  tion...This meth
+00011ce0: 6f64 2064 6f65 7320 6e6f 7420 7265 7475  od does not retu
+00011cf0: 726e 2061 2076 616c 7565 2e20 4576 656e  rn a value. Even
+00011d00: 7473 2063 616e 2062 6520 7265 6365 6976  ts can be receiv
+00011d10: 6564 2062 7920 6974 6572 6174 696e 670a  ed by iterating.
+00011d20: 6f76 6572 2074 6865 2076 616c 7565 2072  over the value r
+00011d30: 6574 7572 6e65 6420 6279 2063 616c 6c69  eturned by calli
+00011d40: 6e67 2060 7265 6164 5f73 7472 6561 6d5f  ng `read_stream_
+00011d50: 7375 6273 6372 6970 7469 6f6e 2829 602e  subscription()`.
+00011d60: 0a0a 5468 6520 6578 616d 706c 6520 6265  ..The example be
+00011d70: 6c6f 7720 6372 6561 7465 7320 6120 7065  low creates a pe
+00011d80: 7273 6973 7465 6e74 2073 7472 6561 6d20  rsistent stream 
+00011d90: 7375 6273 6372 6970 7469 6f6e 2066 726f  subscription fro
+00011da0: 6d20 7468 6520 7374 6172 7420 6f66 2074  m the start of t
+00011db0: 6865 2073 7472 6561 6d2e 0a0a 6060 6070  he stream...```p
+00011dc0: 7974 686f 6e0a 2320 4372 6561 7465 2061  ython.# Create a
+00011dd0: 2070 6572 7369 7374 656e 7420 7374 7265   persistent stre
+00011de0: 616d 2073 7562 7363 7269 7074 696f 6e20  am subscription 
+00011df0: 6672 6f6d 2073 7461 7274 206f 6620 7468  from start of th
+00011e00: 6520 7374 7265 616d 2e0a 6772 6f75 705f  e stream..group_
+00011e10: 6e61 6d65 3120 3d20 6622 6772 6f75 702d  name1 = f"group-
+00011e20: 7b75 7569 6434 2829 7d22 0a63 6c69 656e  {uuid4()}".clien
+00011e30: 742e 6372 6561 7465 5f73 7472 6561 6d5f  t.create_stream_
+00011e40: 7375 6273 6372 6970 7469 6f6e 280a 2020  subscription(.  
+00011e50: 2020 6772 6f75 705f 6e61 6d65 3d67 726f    group_name=gro
+00011e60: 7570 5f6e 616d 6531 2c0a 2020 2020 7374  up_name1,.    st
+00011e70: 7265 616d 5f6e 616d 653d 7374 7265 616d  ream_name=stream
+00011e80: 5f6e 616d 6532 2c0a 290a 6060 600a 0a54  _name2,.).```..T
+00011e90: 6865 2065 7861 6d70 6c65 2062 656c 6f77  he example below
+00011ea0: 2063 7265 6174 6573 2061 2070 6572 7369   creates a persi
+00011eb0: 7374 656e 7420 7374 7265 616d 2073 7562  stent stream sub
+00011ec0: 7363 7269 7074 696f 6e20 6672 6f6d 2061  scription from a
+00011ed0: 2073 7472 6561 6d20 706f 7369 7469 6f6e   stream position
+00011ee0: 2e0a 0a60 6060 7079 7468 6f6e 0a23 2043  ...```python.# C
+00011ef0: 7265 6174 6520 6120 7065 7273 6973 7465  reate a persiste
+00011f00: 6e74 2073 7472 6561 6d20 7375 6273 6372  nt stream subscr
+00011f10: 6970 7469 6f6e 2066 726f 6d20 6120 7374  iption from a st
+00011f20: 7265 616d 2070 6f73 6974 696f 6e2e 0a67  ream position..g
+00011f30: 726f 7570 5f6e 616d 6532 203d 2066 2267  roup_name2 = f"g
+00011f40: 726f 7570 2d7b 7575 6964 3428 297d 220a  roup-{uuid4()}".
+00011f50: 636c 6965 6e74 2e63 7265 6174 655f 7374  client.create_st
+00011f60: 7265 616d 5f73 7562 7363 7269 7074 696f  ream_subscriptio
+00011f70: 6e28 0a20 2020 2067 726f 7570 5f6e 616d  n(.    group_nam
+00011f80: 653d 6772 6f75 705f 6e61 6d65 322c 0a20  e=group_name2,. 
+00011f90: 2020 2073 7472 6561 6d5f 6e61 6d65 3d73     stream_name=s
+00011fa0: 7472 6561 6d5f 6e61 6d65 322c 0a20 2020  tream_name2,.   
+00011fb0: 2073 7472 6561 6d5f 706f 7369 7469 6f6e   stream_position
+00011fc0: 3d32 0a29 0a60 6060 0a0a 5468 6520 6578  =2.).```..The ex
+00011fd0: 616d 706c 6520 6265 6c6f 7720 6372 6561  ample below crea
+00011fe0: 7465 7320 6120 7065 7273 6973 7465 6e74  tes a persistent
+00011ff0: 2073 7472 6561 6d20 7375 6273 6372 6970   stream subscrip
+00012000: 7469 6f6e 2066 726f 6d20 7468 6520 656e  tion from the en
+00012010: 6420 6f66 2074 6865 2073 7472 6561 6d2e  d of the stream.
+00012020: 0a0a 6060 6070 7974 686f 6e0a 2320 4372  ..```python.# Cr
+00012030: 6561 7465 2061 2070 6572 7369 7374 656e  eate a persisten
+00012040: 7420 7374 7265 616d 2073 7562 7363 7269  t stream subscri
+00012050: 7074 696f 6e20 6672 6f6d 2065 6e64 206f  ption from end o
+00012060: 6620 7468 6520 7374 7265 616d 2e0a 6772  f the stream..gr
+00012070: 6f75 705f 6e61 6d65 3320 3d20 6622 6772  oup_name3 = f"gr
+00012080: 6f75 702d 7b75 7569 6434 2829 7d22 0a63  oup-{uuid4()}".c
+00012090: 6c69 656e 742e 6372 6561 7465 5f73 7472  lient.create_str
+000120a0: 6561 6d5f 7375 6273 6372 6970 7469 6f6e  eam_subscription
+000120b0: 280a 2020 2020 6772 6f75 705f 6e61 6d65  (.    group_name
+000120c0: 3d67 726f 7570 5f6e 616d 6533 2c0a 2020  =group_name3,.  
+000120d0: 2020 7374 7265 616d 5f6e 616d 653d 7374    stream_name=st
+000120e0: 7265 616d 5f6e 616d 6532 2c0a 2020 2020  ream_name2,.    
+000120f0: 6672 6f6d 5f65 6e64 3d54 7275 650a 290a  from_end=True.).
+00012100: 6060 600a 0a23 2323 2052 6561 6420 7374  ```..### Read st
+00012110: 7265 616d 2073 7562 7363 7269 7074 696f  ream subscriptio
+00012120: 6e0a 0a2a 7265 7175 6972 6573 206c 6561  n..*requires lea
+00012130: 6465 722a 0a0a 5468 6520 6072 6561 645f  der*..The `read_
+00012140: 7374 7265 616d 5f73 7562 7363 7269 7074  stream_subscript
+00012150: 696f 6e28 2960 206d 6574 686f 6420 6361  ion()` method ca
+00012160: 6e20 6265 2075 7365 6420 746f 2072 6561  n be used to rea
+00012170: 6420 6120 7065 7273 6973 7465 6e74 0a73  d a persistent.s
+00012180: 7472 6561 6d20 7375 6273 6372 6970 7469  tream subscripti
+00012190: 6f6e 2e0a 0a54 6869 7320 6d65 7468 6f64  on...This method
+000121a0: 2068 6173 2074 776f 2072 6571 7569 7265   has two require
+000121b0: 6420 6172 6775 6d65 6e74 732c 2060 6772  d arguments, `gr
+000121c0: 6f75 705f 6e61 6d65 6020 616e 6420 6073  oup_name` and `s
+000121d0: 7472 6561 6d5f 6e61 6d65 602c 2077 6869  tream_name`, whi
+000121e0: 6368 0a73 686f 756c 6420 6d61 7463 6820  ch.should match 
+000121f0: 7468 6520 7661 6c75 6573 206f 6620 6172  the values of ar
+00012200: 6775 6d65 6e74 7320 7573 6564 2077 6865  guments used whe
+00012210: 6e20 6361 6c6c 696e 6720 6063 7265 6174  n calling `creat
+00012220: 655f 7374 7265 616d 5f73 7562 7363 7269  e_stream_subscri
+00012230: 7074 696f 6e28 2960 2e0a 0a54 6869 7320  ption()`...This 
+00012240: 6d65 7468 6f64 2061 6c73 6f20 7461 6b65  method also take
+00012250: 7320 616e 206f 7074 696f 6e61 6c20 6074  s an optional `t
+00012260: 696d 656f 7574 6020 6172 6775 6d65 6e74  imeout` argument
+00012270: 2c20 7468 6174 0a69 7320 6578 7065 6374  , that.is expect
+00012280: 6564 2074 6f20 6265 2061 2050 7974 686f  ed to be a Pytho
+00012290: 6e20 6066 6c6f 6174 602c 2077 6869 6368  n `float`, which
+000122a0: 2073 6574 7320 6120 6465 6164 6c69 6e65   sets a deadline
+000122b0: 0a66 6f72 2074 6865 2063 6f6d 706c 6574  .for the complet
+000122c0: 696f 6e20 6f66 2074 6865 2067 5250 4320  ion of the gRPC 
+000122d0: 6f70 6572 6174 696f 6e2e 0a0a 5468 6973  operation...This
+000122e0: 206d 6574 686f 6420 7265 7475 726e 7320   method returns 
+000122f0: 6120 6050 6572 7369 7374 656e 7453 7562  a `PersistentSub
+00012300: 7363 7269 7074 696f 6e60 206f 626a 6563  scription` objec
+00012310: 742c 2077 6869 6368 2069 7320 616e 2069  t, which is an i
+00012320: 7465 7261 746f 720a 6769 7669 6e67 2060  terator.giving `
+00012330: 5265 636f 7264 6564 4576 656e 7460 206f  RecordedEvent` o
+00012340: 626a 6563 7473 2c20 7468 6174 2061 6c73  bjects, that als
+00012350: 6f20 6861 7320 6061 636b 2829 602c 2060  o has `ack()`, `
+00012360: 6e61 636b 2829 6020 616e 6420 6073 746f  nack()` and `sto
+00012370: 7028 2960 0a6d 6574 686f 6473 2e0a 0a60  p()`.methods...`
+00012380: 6060 7079 7468 6f6e 0a73 7562 7363 7269  ``python.subscri
+00012390: 7074 696f 6e20 3d20 636c 6965 6e74 2e72  ption = client.r
+000123a0: 6561 645f 7374 7265 616d 5f73 7562 7363  ead_stream_subsc
+000123b0: 7269 7074 696f 6e28 0a20 2020 2067 726f  ription(.    gro
+000123c0: 7570 5f6e 616d 653d 6772 6f75 705f 6e61  up_name=group_na
+000123d0: 6d65 312c 0a20 2020 2073 7472 6561 6d5f  me1,.    stream_
+000123e0: 6e61 6d65 3d73 7472 6561 6d5f 6e61 6d65  name=stream_name
+000123f0: 322c 0a29 0a60 6060 0a0a 5468 6520 6578  2,.).```..The ex
+00012400: 616d 706c 6520 6265 6c6f 7720 6974 6572  ample below iter
+00012410: 6174 6573 206f 7665 7220 7468 6520 7375  ates over the su
+00012420: 6273 6372 6970 7469 6f6e 206f 626a 6563  bscription objec
+00012430: 742c 2061 6e64 2063 616c 6c73 2060 6163  t, and calls `ac
+00012440: 6b28 2960 2e0a 5468 6520 666f 7220 6c6f  k()`..The for lo
+00012450: 6f70 2062 7265 616b 7320 7768 656e 2077  op breaks when w
+00012460: 6520 6861 7665 2072 6563 6569 7665 6420  e have received 
+00012470: 7468 6520 6c61 7374 2065 7665 6e74 2069  the last event i
+00012480: 6e20 7468 6520 7374 7265 616d 2c20 736f  n the stream, so
+00012490: 0a74 6861 7420 7765 2063 616e 2066 696e  .that we can fin
+000124a0: 6973 6820 7468 6520 6578 616d 706c 6573  ish the examples
+000124b0: 2069 6e20 7468 6973 2064 6f63 756d 656e   in this documen
+000124c0: 7461 7469 6f6e 2e0a 0a60 6060 7079 7468  tation...```pyth
+000124d0: 6f6e 0a65 7665 6e74 7320 3d20 5b5d 0a66  on.events = [].f
+000124e0: 6f72 2065 7665 6e74 2069 6e20 7375 6273  or event in subs
+000124f0: 6372 6970 7469 6f6e 3a0a 2020 2020 6576  cription:.    ev
+00012500: 656e 7473 2e61 7070 656e 6428 6576 656e  ents.append(even
+00012510: 7429 0a0a 2020 2020 2320 4163 6b6e 6f77  t)..    # Acknow
+00012520: 6c65 6467 6520 7468 6520 7265 6365 6976  ledge the receiv
+00012530: 6564 2065 7665 6e74 2e0a 2020 2020 7375  ed event..    su
+00012540: 6273 6372 6970 7469 6f6e 2e61 636b 2865  bscription.ack(e
+00012550: 7665 6e74 5f69 643d 6576 656e 742e 6964  vent_id=event.id
+00012560: 290a 0a20 2020 2023 2053 746f 7020 7768  )..    # Stop wh
+00012570: 656e 2027 6576 656e 7431 3127 2068 6173  en 'event11' has
+00012580: 2062 6565 6e20 7265 6365 6976 6564 2e0a   been received..
+00012590: 2020 2020 6966 2065 7665 6e74 2e69 6420      if event.id 
+000125a0: 3d3d 2065 7665 6e74 3131 2e69 643a 0a20  == event11.id:. 
+000125b0: 2020 2020 2020 2073 7562 7363 7269 7074         subscript
+000125c0: 696f 6e2e 7374 6f70 2829 0a60 6060 0a0a  ion.stop().```..
+000125d0: 5765 2063 616e 2063 6865 636b 2077 6520  We can check we 
+000125e0: 7265 6365 6976 6564 2061 6c6c 2074 6865  received all the
+000125f0: 2065 7665 6e74 7320 7468 6174 2077 6572   events that wer
+00012600: 6520 6170 7065 6e64 6564 2074 6f20 6073  e appended to `s
+00012610: 7472 6561 6d5f 6e61 6d65 3260 0a69 6e20  tream_name2`.in 
+00012620: 7468 6520 6578 616d 706c 6573 2061 626f  the examples abo
+00012630: 7665 2e0a 0a60 6060 7079 7468 6f6e 0a61  ve...```python.a
+00012640: 7373 6572 7420 6c65 6e28 6576 656e 7473  ssert len(events
+00012650: 2920 3d3d 2034 0a61 7373 6572 7420 6576  ) == 4.assert ev
+00012660: 656e 7473 5b30 5d2e 7374 7265 616d 5f6e  ents[0].stream_n
+00012670: 616d 6520 3d3d 2073 7472 6561 6d5f 6e61  ame == stream_na
+00012680: 6d65 320a 6173 7365 7274 2065 7665 6e74  me2.assert event
+00012690: 735b 305d 2e69 6420 3d3d 2065 7665 6e74  s[0].id == event
+000126a0: 342e 6964 0a61 7373 6572 7420 6576 656e  4.id.assert even
+000126b0: 7473 5b31 5d2e 7374 7265 616d 5f6e 616d  ts[1].stream_nam
+000126c0: 6520 3d3d 2073 7472 6561 6d5f 6e61 6d65  e == stream_name
+000126d0: 320a 6173 7365 7274 2065 7665 6e74 735b  2.assert events[
+000126e0: 315d 2e69 6420 3d3d 2065 7665 6e74 352e  1].id == event5.
+000126f0: 6964 0a61 7373 6572 7420 6576 656e 7473  id.assert events
+00012700: 5b32 5d2e 7374 7265 616d 5f6e 616d 6520  [2].stream_name 
+00012710: 3d3d 2073 7472 6561 6d5f 6e61 6d65 320a  == stream_name2.
+00012720: 6173 7365 7274 2065 7665 6e74 735b 325d  assert events[2]
+00012730: 2e69 6420 3d3d 2065 7665 6e74 362e 6964  .id == event6.id
+00012740: 0a61 7373 6572 7420 6576 656e 7473 5b33  .assert events[3
+00012750: 5d2e 7374 7265 616d 5f6e 616d 6520 3d3d  ].stream_name ==
+00012760: 2073 7472 6561 6d5f 6e61 6d65 320a 6173   stream_name2.as
+00012770: 7365 7274 2065 7665 6e74 735b 335d 2e69  sert events[3].i
+00012780: 6420 3d3d 2065 7665 6e74 3131 2e69 640a  d == event11.id.
+00012790: 6060 600a 0a23 2323 2047 6574 2073 7472  ```..### Get str
+000127a0: 6561 6d20 7375 6273 6372 6970 7469 6f6e  eam subscription
+000127b0: 2069 6e66 6f0a 0a2a 7265 7175 6972 6573   info..*requires
+000127c0: 206c 6561 6465 722a 0a0a 5468 6520 6067   leader*..The `g
+000127d0: 6574 5f73 7472 6561 6d5f 7375 6273 6372  et_stream_subscr
+000127e0: 6970 7469 6f6e 5f69 6e66 6f28 2960 206d  iption_info()` m
+000127f0: 6574 686f 6420 6361 6e20 6265 2075 7365  ethod can be use
+00012800: 6420 746f 2067 6574 2069 6e66 6f72 6d61  d to get informa
+00012810: 7469 6f6e 2066 6f72 2061 0a70 6572 7369  tion for a.persi
+00012820: 7374 656e 7420 7375 6273 6372 6970 7469  stent subscripti
+00012830: 6f6e 2066 6f72 2061 2073 7472 6561 6d2e  on for a stream.
+00012840: 0a0a 5468 6973 206d 6574 686f 6420 6861  ..This method ha
+00012850: 7320 7477 6f20 7265 7175 6972 6564 2061  s two required a
+00012860: 7267 756d 656e 7473 2c20 6067 726f 7570  rguments, `group
+00012870: 5f6e 616d 6560 2061 6e64 2060 7374 7265  _name` and `stre
+00012880: 616d 5f6e 616d 6560 2c20 7768 6963 680a  am_name`, which.
+00012890: 7368 6f75 6c64 206d 6174 6368 2074 6865  should match the
+000128a0: 2076 616c 7565 7320 6f66 2061 7267 756d   values of argum
+000128b0: 656e 7473 2075 7365 6420 7768 656e 2063  ents used when c
+000128c0: 616c 6c69 6e67 2060 6372 6561 7465 5f73  alling `create_s
+000128d0: 7472 6561 6d5f 7375 6273 6372 6970 7469  tream_subscripti
+000128e0: 6f6e 2829 602e 0a0a 5468 6973 206d 6574  on()`...This met
+000128f0: 686f 6420 616c 736f 2074 616b 6573 2061  hod also takes a
+00012900: 6e20 6f70 7469 6f6e 616c 2060 7469 6d65  n optional `time
+00012910: 6f75 7460 2061 7267 756d 656e 742c 2074  out` argument, t
+00012920: 6861 740a 6973 2065 7870 6563 7465 6420  hat.is expected 
+00012930: 746f 2062 6520 6120 5079 7468 6f6e 2060  to be a Python `
+00012940: 666c 6f61 7460 2c20 7768 6963 6820 7365  float`, which se
+00012950: 7473 2061 2064 6561 646c 696e 650a 666f  ts a deadline.fo
+00012960: 7220 7468 6520 636f 6d70 6c65 7469 6f6e  r the completion
+00012970: 206f 6620 7468 6520 6752 5043 206f 7065   of the gRPC ope
+00012980: 7261 7469 6f6e 2e0a 0a60 6060 7079 7468  ration...```pyth
+00012990: 6f6e 0a73 7562 7363 7269 7074 696f 6e5f  on.subscription_
+000129a0: 696e 666f 203d 2063 6c69 656e 742e 6765  info = client.ge
+000129b0: 745f 7374 7265 616d 5f73 7562 7363 7269  t_stream_subscri
+000129c0: 7074 696f 6e5f 696e 666f 280a 2020 2020  ption_info(.    
+000129d0: 6772 6f75 705f 6e61 6d65 3d67 726f 7570  group_name=group
+000129e0: 5f6e 616d 6531 2c0a 2020 2020 7374 7265  _name1,.    stre
+000129f0: 616d 5f6e 616d 653d 7374 7265 616d 5f6e  am_name=stream_n
+00012a00: 616d 6532 2c0a 290a 6060 600a 0a54 6865  ame2,.).```..The
+00012a10: 2072 6574 7572 6e65 6420 7661 6c75 6520   returned value 
+00012a20: 6973 2061 2060 5375 6273 6372 6970 7469  is a `Subscripti
+00012a30: 6f6e 496e 666f 6020 6f62 6a65 6374 2e0a  onInfo` object..
+00012a40: 0a23 2323 204c 6973 7420 7374 7265 616d  .### List stream
+00012a50: 2073 7562 7363 7269 7074 696f 6e73 0a0a   subscriptions..
+00012a60: 2a72 6571 7569 7265 7320 6c65 6164 6572  *requires leader
+00012a70: 2a0a 0a54 6865 2060 6c69 7374 5f73 7472  *..The `list_str
+00012a80: 6561 6d5f 7375 6273 6372 6970 7469 6f6e  eam_subscription
+00012a90: 7328 2960 206d 6574 686f 6420 6361 6e20  s()` method can 
+00012aa0: 6265 2075 7365 6420 746f 2067 6574 2069  be used to get i
+00012ab0: 6e66 6f72 6d61 7469 6f6e 2066 6f72 2061  nformation for a
+00012ac0: 6c6c 0a74 6865 2070 6572 7369 7374 656e  ll.the persisten
+00012ad0: 7420 7375 6273 6372 6970 7469 6f6e 7320  t subscriptions 
+00012ae0: 666f 7220 6120 7374 7265 616d 2e0a 0a54  for a stream...T
+00012af0: 6869 7320 6d65 7468 6f64 2068 6173 206f  his method has o
+00012b00: 6e65 2072 6571 7569 7265 6420 6172 6775  ne required argu
+00012b10: 6d65 6e74 2c20 6073 7472 6561 6d5f 6e61  ment, `stream_na
+00012b20: 6d65 602e 0a0a 5468 6973 206d 6574 686f  me`...This metho
+00012b30: 6420 616c 736f 2074 616b 6573 2061 6e20  d also takes an 
+00012b40: 6f70 7469 6f6e 616c 2060 7469 6d65 6f75  optional `timeou
+00012b50: 7460 2061 7267 756d 656e 742c 2074 6861  t` argument, tha
+00012b60: 740a 6973 2065 7870 6563 7465 6420 746f  t.is expected to
+00012b70: 2062 6520 6120 5079 7468 6f6e 2060 666c   be a Python `fl
+00012b80: 6f61 7460 2c20 7768 6963 6820 7365 7473  oat`, which sets
+00012b90: 2061 2064 6561 646c 696e 650a 666f 7220   a deadline.for 
+00012ba0: 7468 6520 636f 6d70 6c65 7469 6f6e 206f  the completion o
+00012bb0: 6620 7468 6520 6752 5043 206f 7065 7261  f the gRPC opera
+00012bc0: 7469 6f6e 2e0a 0a60 6060 7079 7468 6f6e  tion...```python
+00012bd0: 0a73 7562 7363 7269 7074 696f 6e73 203d  .subscriptions =
+00012be0: 2063 6c69 656e 742e 6c69 7374 5f73 7472   client.list_str
+00012bf0: 6561 6d5f 7375 6273 6372 6970 7469 6f6e  eam_subscription
+00012c00: 7328 0a20 2020 2073 7472 6561 6d5f 6e61  s(.    stream_na
+00012c10: 6d65 3d73 7472 6561 6d5f 6e61 6d65 322c  me=stream_name2,
+00012c20: 0a29 0a60 6060 0a0a 5468 6520 7265 7475  .).```..The retu
+00012c30: 726e 6564 2076 616c 7565 2069 7320 6120  rned value is a 
+00012c40: 6c69 7374 206f 6620 6053 7562 7363 7269  list of `Subscri
+00012c50: 7074 696f 6e49 6e66 6f60 206f 626a 6563  ptionInfo` objec
+00012c60: 7473 2e0a 0a23 2323 2055 7064 6174 6520  ts...### Update 
+00012c70: 7374 7265 616d 2073 7562 7363 7269 7074  stream subscript
+00012c80: 696f 6e0a 0a2a 7265 7175 6972 6573 206c  ion..*requires l
+00012c90: 6561 6465 722a 0a0a 5468 6520 6d65 7468  eader*..The meth
+00012ca0: 6f64 2060 7570 6461 7465 5f73 7472 6561  od `update_strea
+00012cb0: 6d5f 7375 6273 6372 6970 7469 6f6e 2829  m_subscription()
+00012cc0: 6020 6361 6e20 6265 2075 7365 6420 746f  ` can be used to
+00012cd0: 2075 7064 6174 6520 610a 7065 7273 6973   update a.persis
+00012ce0: 7465 6e74 2073 7562 7363 7269 7074 696f  tent subscriptio
+00012cf0: 6e20 666f 7220 6120 7374 7265 616d 2e0a  n for a stream..
+00012d00: 0a54 6869 7320 6d65 7468 6f64 2074 616b  .This method tak
+00012d10: 6573 2061 2072 6571 7569 7265 6420 6067  es a required `g
+00012d20: 726f 7570 5f6e 616d 6560 2061 7267 756d  roup_name` argum
+00012d30: 656e 742c 2077 6869 6368 2069 7320 7468  ent, which is th
+00012d40: 650a 6e61 6d65 206f 6620 6120 2267 726f  e.name of a "gro
+00012d50: 7570 2220 6f66 2063 6f6e 7375 6d65 7273  up" of consumers
+00012d60: 206f 6620 7468 6520 7375 6273 6372 6970   of the subscrip
+00012d70: 7469 6f6e 2c20 616e 6420 6120 7265 7175  tion, and a requ
+00012d80: 6972 6564 0a60 7374 7265 616d 5f6e 616d  ired.`stream_nam
+00012d90: 6560 2061 7267 756d 656e 742c 2077 6869  e` argument, whi
+00012da0: 6368 2069 7320 7468 6520 6e61 6d65 206f  ch is the name o
+00012db0: 6620 6120 7374 7265 616d 2e0a 0a54 6869  f a stream...Thi
+00012dc0: 7320 6d65 7468 6f64 2061 6c73 6f20 7461  s method also ta
+00012dd0: 6b65 7320 7468 7265 6520 6f70 7469 6f6e  kes three option
+00012de0: 616c 2061 7267 756d 656e 7473 2c20 6066  al arguments, `f
+00012df0: 726f 6d5f 656e 6460 2c20 6073 7472 6561  rom_end`, `strea
+00012e00: 6d5f 706f 7369 7469 6f6e 602c 0a61 6e64  m_position`,.and
+00012e10: 2060 7469 6d65 6f75 7460 2e0a 0a54 6865   `timeout`...The
+00012e20: 206f 7074 696f 6e61 6c20 6066 726f 6d5f   optional `from_
+00012e30: 656e 6460 2061 7267 756d 656e 7420 6361  end` argument ca
+00012e40: 6e20 6265 2075 7365 6420 746f 2073 7065  n be used to spe
+00012e50: 6369 6679 2074 6861 7420 7468 6520 6772  cify that the gr
+00012e60: 6f75 7020 6f66 2063 6f6e 7375 6d65 7273  oup of consumers
+00012e70: 0a6f 6620 7468 6520 7375 6273 6372 6970  .of the subscrip
+00012e80: 7469 6f6e 2073 686f 756c 6420 6f6e 6c79  tion should only
+00012e90: 2072 6563 6569 7665 2065 7665 6e74 7320   receive events 
+00012ea0: 7468 6174 2077 6572 6520 7265 636f 7264  that were record
+00012eb0: 6564 2061 6674 6572 2074 6865 2073 7562  ed after the sub
+00012ec0: 7363 7269 7074 696f 6e0a 7761 7320 7570  scription.was up
+00012ed0: 6461 7465 642e 0a0a 416c 7465 726e 6174  dated...Alternat
+00012ee0: 6976 656c 792c 2074 6865 206f 7074 696f  ively, the optio
+00012ef0: 6e61 6c20 6073 7472 6561 6d5f 706f 7369  nal `stream_posi
+00012f00: 7469 6f6e 6020 6172 6775 6d65 6e74 2063  tion` argument c
+00012f10: 616e 2062 6520 7573 6564 2074 6f20 7370  an be used to sp
+00012f20: 6563 6966 7920 6120 7374 7265 616d 0a70  ecify a stream.p
+00012f30: 6f73 6974 696f 6e20 6672 6f6d 2077 6869  osition from whi
+00012f40: 6368 2063 6f6d 6d69 7420 706f 7369 7469  ch commit positi
+00012f50: 6f6e 2074 6865 2067 726f 7570 206f 6620  on the group of 
+00012f60: 636f 6e73 756d 6572 7320 6f66 2074 6865  consumers of the
+00012f70: 2073 7562 7363 7269 7074 696f 6e20 7368   subscription sh
+00012f80: 6f75 6c64 0a72 6563 6569 7665 2065 7665  ould.receive eve
+00012f90: 6e74 732e 2050 6c65 6173 6520 6e6f 7465  nts. Please note
+00012fa0: 2c20 7468 6520 7265 636f 7264 6564 2065  , the recorded e
+00012fb0: 7665 6e74 2061 7420 7468 6520 7370 6563  vent at the spec
+00012fc0: 6966 6965 6420 7374 7265 616d 2070 6f73  ified stream pos
+00012fd0: 6974 696f 6e20 6d69 6768 740a 6265 2069  ition might.be i
+00012fe0: 6e63 6c75 6465 6420 696e 2074 6865 2072  ncluded in the r
+00012ff0: 6563 6f72 6465 6420 6576 656e 7473 2072  ecorded events r
+00013000: 6563 6569 7665 6420 6279 2074 6865 2067  eceived by the g
+00013010: 726f 7570 206f 6620 636f 6e73 756d 6572  roup of consumer
+00013020: 732e 0a0a 4966 206e 6569 7468 6572 2060  s...If neither `
+00013030: 6672 6f6d 5f65 6e64 6020 6f72 2060 636f  from_end` or `co
+00013040: 6d6d 6974 5f70 6f73 6974 696f 6e60 2061  mmit_position` a
+00013050: 7265 2073 7065 6369 6669 6564 2c20 7468  re specified, th
+00013060: 6520 6772 6f75 7020 6f66 2063 6f6e 7375  e group of consu
+00013070: 6d65 7273 0a6f 6620 7468 6520 7375 6273  mers.of the subs
+00013080: 6372 6970 7469 6f6e 2077 696c 6c20 706f  cription will po
+00013090: 7465 6e74 6961 6c6c 7920 7265 6365 6976  tentially receiv
+000130a0: 6520 616c 6c20 7265 636f 7264 6564 2065  e all recorded e
+000130b0: 7665 6e74 7320 696e 2074 6865 2073 7472  vents in the str
+000130c0: 6561 6d2e 0a0a 506c 6561 7365 206e 6f74  eam...Please not
+000130d0: 652c 2074 6865 2063 6f6e 7375 6d65 7220  e, the consumer 
+000130e0: 7374 7261 7465 6779 2063 616e 6e6f 7420  strategy cannot 
+000130f0: 6265 2061 646a 7573 7465 642e 0a0a 5468  be adjusted...Th
+00013100: 6520 6f70 7469 6f6e 616c 2060 7469 6d65  e optional `time
+00013110: 6f75 7460 2061 7267 756d 656e 7420 6973  out` argument is
+00013120: 2061 2050 7974 686f 6e20 6066 6c6f 6174   a Python `float
+00013130: 6020 7768 6963 6820 7365 7473 2061 0a64  ` which sets a.d
+00013140: 6561 646c 696e 6520 666f 7220 7468 6520  eadline for the 
+00013150: 636f 6d70 6c65 7469 6f6e 206f 6620 7468  completion of th
+00013160: 6520 6752 5043 206f 7065 7261 7469 6f6e  e gRPC operation
+00013170: 2e0a 0a54 6865 206d 6574 686f 6420 6075  ...The method `u
+00013180: 7064 6174 655f 7374 7265 616d 5f73 7562  pdate_stream_sub
+00013190: 7363 7269 7074 696f 6e28 2960 2064 6f65  scription()` doe
+000131a0: 7320 6e6f 7420 7265 7475 726e 2061 2076  s not return a v
+000131b0: 616c 7565 2e0a 0a49 6e20 7468 6520 6578  alue...In the ex
+000131c0: 616d 706c 6520 6265 6c6f 772c 2061 2070  ample below, a p
+000131d0: 6572 7369 7374 656e 7420 7375 6273 6372  ersistent subscr
+000131e0: 6970 7469 6f6e 2066 6f72 2061 2073 7472  iption for a str
+000131f0: 6561 6d20 6973 2075 7064 6174 6564 2074  eam is updated t
+00013200: 6f20 7275 6e20 6672 6f6d 2074 6865 0a65  o run from the.e
+00013210: 6e64 206f 6620 7468 6520 7374 7265 616d  nd of the stream
+00013220: 2e0a 0a60 6060 7079 7468 6f6e 0a23 2043  ...```python.# C
+00013230: 7265 6174 6520 6120 7065 7273 6973 7465  reate a persiste
+00013240: 6e74 2073 7562 7363 7269 7074 696f 6e2e  nt subscription.
+00013250: 0a63 6c69 656e 742e 7570 6461 7465 5f73  .client.update_s
+00013260: 7472 6561 6d5f 7375 6273 6372 6970 7469  tream_subscripti
+00013270: 6f6e 280a 2020 2020 6772 6f75 705f 6e61  on(.    group_na
+00013280: 6d65 3d67 726f 7570 5f6e 616d 6531 2c0a  me=group_name1,.
+00013290: 2020 2020 7374 7265 616d 5f6e 616d 653d      stream_name=
+000132a0: 7374 7265 616d 5f6e 616d 6532 2c0a 2020  stream_name2,.  
+000132b0: 2020 6672 6f6d 5f65 6e64 3d54 7275 652c    from_end=True,
+000132c0: 0a29 0a60 6060 0a0a 2323 2320 4465 6c65  .).```..### Dele
+000132d0: 7465 2073 7472 6561 6d20 7375 6273 6372  te stream subscr
+000132e0: 6970 7469 6f6e 0a0a 2a72 6571 7569 7265  iption..*require
+000132f0: 7320 6c65 6164 6572 2a0a 0a54 6865 2060  s leader*..The `
+00013300: 6465 6c65 7465 5f73 7472 6561 6d5f 7375  delete_stream_su
+00013310: 6273 6372 6970 7469 6f6e 2829 6020 6d65  bscription()` me
+00013320: 7468 6f64 2063 616e 2062 6520 7573 6564  thod can be used
+00013330: 2074 6f20 6465 6c65 7465 2061 2070 6572   to delete a per
+00013340: 7369 7374 656e 740a 7375 6273 6372 6970  sistent.subscrip
+00013350: 7469 6f6e 2066 6f72 2061 2073 7472 6561  tion for a strea
+00013360: 6d2e 0a0a 5468 6973 206d 6574 686f 6420  m...This method 
+00013370: 6861 7320 7477 6f20 7265 7175 6972 6564  has two required
+00013380: 2061 7267 756d 656e 7473 2c20 6067 726f   arguments, `gro
+00013390: 7570 5f6e 616d 6560 2061 6e64 2060 7374  up_name` and `st
+000133a0: 7265 616d 5f6e 616d 6560 2c20 7768 6963  ream_name`, whic
+000133b0: 680a 7368 6f75 6c64 206d 6174 6368 2074  h.should match t
+000133c0: 6865 2076 616c 7565 7320 6f66 2061 7267  he values of arg
+000133d0: 756d 656e 7473 2075 7365 6420 7768 656e  uments used when
+000133e0: 2063 616c 6c69 6e67 2060 6372 6561 7465   calling `create
+000133f0: 5f73 7472 6561 6d5f 7375 6273 6372 6970  _stream_subscrip
+00013400: 7469 6f6e 2829 602e 0a0a 5468 6973 206d  tion()`...This m
+00013410: 6574 686f 6420 616c 736f 2074 616b 6573  ethod also takes
+00013420: 2061 6e20 6f70 7469 6f6e 616c 2060 7469   an optional `ti
+00013430: 6d65 6f75 7460 2061 7267 756d 656e 742c  meout` argument,
+00013440: 2074 6861 740a 6973 2065 7870 6563 7465   that.is expecte
+00013450: 6420 746f 2062 6520 6120 5079 7468 6f6e  d to be a Python
+00013460: 2060 666c 6f61 7460 2c20 7768 6963 6820   `float`, which 
+00013470: 7365 7473 2061 2064 6561 646c 696e 650a  sets a deadline.
+00013480: 666f 7220 7468 6520 636f 6d70 6c65 7469  for the completi
+00013490: 6f6e 206f 6620 7468 6520 6752 5043 206f  on of the gRPC o
+000134a0: 7065 7261 7469 6f6e 2e0a 0a60 6060 7079  peration...```py
+000134b0: 7468 6f6e 0a63 6c69 656e 742e 6465 6c65  thon.client.dele
+000134c0: 7465 5f73 7472 6561 6d5f 7375 6273 6372  te_stream_subscr
+000134d0: 6970 7469 6f6e 280a 2020 2020 6772 6f75  iption(.    grou
+000134e0: 705f 6e61 6d65 3d67 726f 7570 5f6e 616d  p_name=group_nam
+000134f0: 6531 2c0a 2020 2020 7374 7265 616d 5f6e  e1,.    stream_n
+00013500: 616d 653d 7374 7265 616d 5f6e 616d 6532  ame=stream_name2
+00013510: 2c0a 290a 6060 600a 0a23 2323 2050 6572  ,.).```..### Per
+00013520: 7369 7374 656e 7420 7375 6273 6372 6970  sistent subscrip
+00013530: 7469 6f6e 2063 6f6e 7375 6d65 720a 0a54  tion consumer..T
+00013540: 6865 2072 6561 6469 6e67 206f 6620 6120  he reading of a 
+00013550: 7065 7273 6973 7465 6e74 2073 7562 7363  persistent subsc
+00013560: 7269 7074 696f 6e20 6361 6e20 6265 2065  ription can be e
+00013570: 6e63 6170 7375 6c61 7465 6420 696e 2061  ncapsulated in a
+00013580: 2022 636f 6e73 756d 6572 2220 7468 6174   "consumer" that
+00013590: 2063 616c 6c73 0a61 2022 706f 6c69 6379   calls.a "policy
+000135a0: 2220 6675 6e63 7469 6f6e 2077 6865 6e20  " function when 
+000135b0: 6120 7265 636f 7264 6564 2065 7665 6e74  a recorded event
+000135c0: 2069 7320 7265 6365 6976 6564 2061 6e64   is received and
+000135d0: 2074 6865 6e20 6175 746f 6d61 7469 6361   then automatica
+000135e0: 6c6c 7920 6361 6c6c 730a 6061 636b 2829  lly calls.`ack()
+000135f0: 6020 6966 2074 6865 2070 6f6c 6963 7920  ` if the policy 
+00013600: 6675 6e63 7469 6f6e 2072 6574 7572 6e73  function returns
+00013610: 206e 6f72 6d61 6c6c 792c 2061 6e64 2060   normally, and `
+00013620: 6e61 636b 2829 6020 6966 2069 7420 7261  nack()` if it ra
+00013630: 6973 6573 2061 6e20 6578 6365 7074 696f  ises an exceptio
+00013640: 6e2c 0a70 6572 6861 7073 2072 6574 7279  n,.perhaps retry
+00013650: 696e 6720 7468 6520 6576 656e 7420 666f  ing the event fo
+00013660: 7220 6120 6365 7274 6169 6e20 6e75 6d62  r a certain numb
+00013670: 6572 206f 6620 7469 6d65 732c 2061 6e64  er of times, and
+00013680: 2074 6865 6e20 7061 726b 696e 6720 7468   then parking th
+00013690: 6520 6576 656e 742e 0a0a 5468 6520 7369  e event...The si
+000136a0: 6d70 6c65 2065 7861 6d70 6c65 2062 656c  mple example bel
+000136b0: 6f77 2073 686f 7773 2068 6f77 2074 6869  ow shows how thi
+000136c0: 7320 6d69 6768 7420 6265 2064 6f6e 652e  s might be done.
+000136d0: 2057 6520 6361 6e20 7365 6520 7468 6174   We can see that
+000136e0: 2027 6576 656e 7431 3127 2069 730a 6163   'event11' is.ac
+000136f0: 6b6e 6f77 6c65 6467 6564 2062 6566 6f72  knowledged befor
+00013700: 6520 2765 7665 6e74 3527 2069 7320 6669  e 'event5' is fi
+00013710: 6e61 6c6c 7920 7061 726b 6564 2e0a 0a0a  nally parked....
+00013720: 6060 6070 7974 686f 6e0a 6163 6b65 645f  ```python.acked_
+00013730: 6576 656e 7473 203d 207b 7d0a 6e61 636b  events = {}.nack
+00013740: 6564 5f65 7665 6e74 7320 3d20 7b7d 0a0a  ed_events = {}..
+00013750: 0a63 6c61 7373 2045 7861 6d70 6c65 436f  .class ExampleCo
+00013760: 6e73 756d 6572 3a0a 2020 2020 6465 6620  nsumer:.    def 
+00013770: 5f5f 696e 6974 5f5f 2873 656c 662c 2073  __init__(self, s
+00013780: 7562 7363 7269 7074 696f 6e2c 206d 6178  ubscription, max
+00013790: 5f72 6574 7269 6573 2c20 6669 6e61 6c5f  _retries, final_
+000137a0: 6163 7469 6f6e 293a 0a20 2020 2020 2020  action):.       
+000137b0: 2073 656c 662e 7375 6273 6372 6970 7469   self.subscripti
+000137c0: 6f6e 203d 2073 7562 7363 7269 7074 696f  on = subscriptio
+000137d0: 6e0a 2020 2020 2020 2020 7365 6c66 2e6d  n.        self.m
+000137e0: 6178 5f72 6574 7269 6573 203d 206d 6178  ax_retries = max
+000137f0: 5f72 6574 7269 6573 0a20 2020 2020 2020  _retries.       
+00013800: 2073 656c 662e 6669 6e61 6c5f 6163 7469   self.final_acti
+00013810: 6f6e 203d 2066 696e 616c 5f61 6374 696f  on = final_actio
+00013820: 6e0a 2020 2020 2020 2020 7365 6c66 2e65  n.        self.e
+00013830: 7272 6f72 203d 204e 6f6e 650a 0a20 2020  rror = None..   
+00013840: 2064 6566 2072 756e 2873 656c 6629 3a0a   def run(self):.
+00013850: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
+00013860: 2020 2020 2020 2020 2066 6f72 2065 7665           for eve
+00013870: 6e74 2069 6e20 7365 6c66 2e73 7562 7363  nt in self.subsc
+00013880: 7269 7074 696f 6e3a 0a20 2020 2020 2020  ription:.       
+00013890: 2020 2020 2020 2020 2074 7279 3a0a 2020           try:.  
+000138a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000138b0: 2020 7365 6c66 2e70 6f6c 6963 7928 6576    self.policy(ev
+000138c0: 656e 7429 0a20 2020 2020 2020 2020 2020  ent).           
+000138d0: 2020 2020 2065 7863 6570 7420 4578 6365       except Exce
+000138e0: 7074 696f 6e3a 0a20 2020 2020 2020 2020  ption:.         
+000138f0: 2020 2020 2020 2020 2020 2069 6620 6576             if ev
+00013900: 656e 742e 7265 7472 795f 636f 756e 7420  ent.retry_count 
+00013910: 3c20 7365 6c66 2e6d 6178 5f72 6574 7269  < self.max_retri
+00013920: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
+00013930: 2020 2020 2020 2020 2020 2020 6163 7469              acti
+00013940: 6f6e 203d 2022 7265 7472 7922 0a20 2020  on = "retry".   
 00013950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013970: 2020 7c20 5468 6520 7661 6c75 6520 6f66    | The value of
-00013980: 2074 6865 2022 6772 7063 2e6b 6565 7061   the "grpc.keepa
-00013990: 6c69 7665 5f6d 7322 2067 5250 4320 6368  live_ms" gRPC ch
-000139a0: 616e 6e65 6c20 6f70 7469 6f6e 2e20 2020  annel option.   
-000139b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000139c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000139d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013960: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00013970: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+00013980: 6374 696f 6e20 3d20 7365 6c66 2e66 696e  ction = self.fin
+00013990: 616c 5f61 6374 696f 6e0a 2020 2020 2020  al_action.      
+000139a0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+000139b0: 6c66 2e73 7562 7363 7269 7074 696f 6e2e  lf.subscription.
+000139c0: 6e61 636b 2865 7665 6e74 2e69 642c 2061  nack(event.id, a
+000139d0: 6374 696f 6e3d 6163 7469 6f6e 290a 2020  ction=action).  
 000139e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000139f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013a10: 2020 2020 2020 7c0a 7c20 4b65 6570 416c        |.| KeepAl
-00013a20: 6976 6554 696d 656f 7574 2020 2020 7c20  iveTimeout    | 
-00013a30: 696e 7465 6765 7220 2864 6566 6175 6c74  integer (default
-00013a40: 3a20 604e 6f6e 6560 2920 2020 2020 2020  : `None`)       
-00013a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013a70: 2020 2020 2020 7c20 5468 6520 7661 6c75        | The valu
-00013a80: 6520 6f66 2074 6865 2022 6772 7063 2e6b  e of the "grpc.k
-00013a90: 6565 7061 6c69 7665 5f74 696d 656f 7574  eepalive_timeout
-00013aa0: 5f6d 7322 2067 5250 4320 6368 616e 6e65  _ms" gRPC channe
-00013ab0: 6c20 6f70 7469 6f6e 2e20 2020 2020 2020  l option.       
-00013ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013b10: 2020 2020 2020 2020 2020 7c0a 0a0a 4865            |...He
-00013b20: 7265 2061 7265 2073 6f6d 6520 6578 616d  re are some exam
-00013b30: 706c 6573 206f 6620 4576 656e 7453 746f  ples of EventSto
-00013b40: 7265 4442 2063 6f6e 6e65 6374 696f 6e20  reDB connection 
-00013b50: 7374 7269 6e67 2055 5249 732e 0a0a 2020  string URIs...  
-00013b60: 2020 2320 4765 7420 636c 7573 7465 7220    # Get cluster 
-00013b70: 696e 666f 2066 726f 6d20 7365 6375 7265  info from secure
-00013b80: 2073 6572 7665 7220 736f 636b 6574 206c   server socket l
-00013b90: 6f63 616c 686f 7374 3a32 3131 332c 0a20  ocalhost:2113,. 
-00013ba0: 2020 2023 2061 6e64 2075 7365 2022 6164     # and use "ad
-00013bb0: 6d69 6e22 2061 6e64 2022 6368 616e 6765  min" and "change
-00013bc0: 6974 2220 6173 2075 7365 726e 616d 6520  it" as username 
-00013bd0: 616e 6420 7061 7373 776f 7264 0a20 2020  and password.   
-00013be0: 2023 2077 6865 6e20 6d61 6b69 6e67 2063   # when making c
-00013bf0: 616c 6c73 2074 6f20 4576 656e 7453 746f  alls to EventSto
-00013c00: 7265 4442 2041 5049 206d 6574 686f 6473  reDB API methods
-00013c10: 2e0a 0a20 2020 2065 7364 623a 2f2f 6164  ...    esdb://ad
-00013c20: 6d69 6e3a 6368 616e 6765 6974 406c 6f63  min:changeit@loc
-00013c30: 616c 686f 7374 3a32 3131 330a 0a0a 2020  alhost:2113...  
-00013c40: 2020 2320 4765 7420 636c 7573 7465 7220    # Get cluster 
-00013c50: 696e 666f 2066 726f 6d20 696e 7365 6375  info from insecu
-00013c60: 7265 2073 6572 7665 7220 736f 636b 6574  re server socket
-00013c70: 2031 3237 2e30 2e30 2e31 3a32 3131 340a   127.0.0.1:2114.
-00013c80: 0a20 2020 2065 7364 623a 2f2f 3132 372e  .    esdb://127.
-00013c90: 302e 302e 313a 3231 3134 3f54 6c73 3d66  0.0.1:2114?Tls=f
-00013ca0: 616c 7365 0a0a 0a20 2020 2023 2047 6574  alse...    # Get
-00013cb0: 2063 6c75 7374 6572 2069 6e66 6f20 6672   cluster info fr
-00013cc0: 6f6d 2061 6464 7265 7373 6573 2069 6e20  om addresses in 
-00013cd0: 2741 2720 7265 636f 7264 7320 666f 7220  'A' records for 
-00013ce0: 636c 7573 7465 7231 2e65 7861 6d70 6c65  cluster1.example
-00013cf0: 2e63 6f6d 2c0a 2020 2020 2320 616e 6420  .com,.    # and 
-00013d00: 7573 6520 6120 6465 6661 756c 7420 6465  use a default de
-00013d10: 6164 6c69 6e65 2066 6f72 206d 616b 696e  adline for makin
-00013d20: 6720 6361 6c6c 7320 746f 2045 7665 6e74  g calls to Event
-00013d30: 5374 6f72 6520 4150 4920 6d65 7468 6f64  Store API method
-00013d40: 2e0a 0a20 2020 2065 7364 622b 6469 7363  ...    esdb+disc
-00013d50: 6f76 6572 3a2f 2f61 646d 696e 3a63 6861  over://admin:cha
-00013d60: 6e67 6569 7440 636c 7573 7465 7231 2e65  ngeit@cluster1.e
-00013d70: 7861 6d70 6c65 2e63 6f6d 3f44 6566 6175  xample.com?Defau
-00013d80: 6c74 4465 6164 6c69 6e65 3d35 0a0a 0a20  ltDeadline=5... 
-00013d90: 2020 2023 2047 6574 2063 6c75 7374 6572     # Get cluster
-00013da0: 2069 6e66 6f20 6672 6f6d 2065 6974 6865   info from eithe
-00013db0: 7220 6c6f 6361 6c68 6f73 743a 3231 3131  r localhost:2111
-00013dc0: 206f 7220 6c6f 6361 6c68 6f73 743a 3231   or localhost:21
-00013dd0: 3132 206f 720a 2020 2020 2320 6c6f 6361  12 or.    # loca
-00013de0: 6c68 6f73 743a 3231 3133 2c20 616e 6420  lhost:2113, and 
-00013df0: 7468 656e 2063 6f6e 6e65 6374 2074 6f20  then connect to 
-00013e00: 6120 666f 6c6c 6f77 6572 206e 6f64 6520  a follower node 
-00013e10: 696e 2074 6865 2063 6c75 7374 6572 2e0a  in the cluster..
-00013e20: 0a20 2020 2065 7364 623a 2f2f 6164 6d69  .    esdb://admi
-00013e30: 6e3a 6368 616e 6765 6974 406c 6f63 616c  n:changeit@local
-00013e40: 686f 7374 3a32 3131 312c 6c6f 6361 6c68  host:2111,localh
-00013e50: 6f73 743a 3231 3132 2c6c 6f63 616c 686f  ost:2112,localho
-00013e60: 7374 3a32 3131 333f 4e6f 6465 5072 6566  st:2113?NodePref
-00013e70: 6572 656e 6365 3d66 6f6c 6c6f 7765 720a  erence=follower.
-00013e80: 0a0a 2020 2020 2320 4765 7420 636c 7573  ..    # Get clus
-00013e90: 7465 7220 696e 666f 2066 726f 6d20 6164  ter info from ad
-00013ea0: 6472 6573 7365 7320 696e 2027 4127 2072  dresses in 'A' r
-00013eb0: 6563 6f72 6473 2066 6f72 2063 6c75 7374  ecords for clust
-00013ec0: 6572 312e 6578 616d 706c 652e 636f 6d2c  er1.example.com,
-00013ed0: 0a20 2020 2023 2061 6e64 2063 6f6e 6669  .    # and confi
-00013ee0: 6775 7265 2022 6b65 6570 2061 6c69 7665  gure "keep alive
-00013ef0: 2220 7469 6d65 6f75 7420 616e 6420 696e  " timeout and in
-00013f00: 7465 7276 616c 2069 6e20 7468 6520 6752  terval in the gR
-00013f10: 5043 2063 6861 6e6e 656c 2e0a 0a20 2020  PC channel...   
-00013f20: 2065 7364 622b 6469 7363 6f76 6572 3a2f   esdb+discover:/
-00013f30: 2f61 646d 696e 3a63 6861 6e67 6569 7440  /admin:changeit@
-00013f40: 636c 7573 7465 7231 2e65 7861 6d70 6c65  cluster1.example
-00013f50: 2e63 6f6d 3f4b 6565 7041 6c69 7665 496e  .com?KeepAliveIn
-00013f60: 7465 7276 616c 3d31 3030 3030 264b 6565  terval=10000&Kee
-00013f70: 7041 6c69 7665 5469 6d65 6f75 743d 3130  pAliveTimeout=10
-00013f80: 3030 300a 0a0a 506c 6561 7365 206e 6f74  000...Please not
-00013f90: 652c 2074 6865 2063 6c69 656e 7420 6973  e, the client is
-00013fa0: 2069 6e73 656e 7369 7469 7665 2074 6f20   insensitive to 
-00013fb0: 7468 6520 6361 7365 206f 6620 6669 656c  the case of fiel
-00013fc0: 6473 2061 6e64 2076 616c 7565 732e 2049  ds and values. I
-00013fd0: 6620 6669 656c 6473 2061 7265 0a72 6570  f fields are.rep
-00013fe0: 6561 7465 6420 696e 2074 6865 2071 7565  eated in the que
-00013ff0: 7279 2073 7472 696e 672c 2074 6865 2071  ry string, the q
-00014000: 7565 7279 2073 7472 696e 6720 7769 6c6c  uery string will
-00014010: 2062 6520 7061 7273 6564 2077 6974 686f   be parsed witho
-00014020: 7574 2065 7272 6f72 2e20 486f 7765 7665  ut error. Howeve
-00014030: 722c 0a74 6865 2063 6f6e 6e65 6374 696f  r,.the connectio
-00014040: 6e20 6f70 7469 6f6e 7320 7573 6564 2062  n options used b
-00014050: 7920 7468 6520 636c 6965 6e74 2077 696c  y the client wil
-00014060: 6c20 7573 6520 7468 6520 7661 6c75 6520  l use the value 
-00014070: 6f66 2074 6865 2066 6972 7374 2066 6965  of the first fie
-00014080: 6c64 2e20 416c 6c0a 7468 6520 6f74 6865  ld. All.the othe
-00014090: 7220 6669 656c 642d 7661 6c75 6573 2069  r field-values i
-000140a0: 6e20 7468 6520 7175 6572 7920 7374 7269  n the query stri
-000140b0: 6e67 2077 6974 6820 7468 6520 7361 6d65  ng with the same
-000140c0: 2066 6965 6c64 206e 616d 6520 7769 6c6c   field name will
-000140d0: 2062 6520 6967 6e6f 7265 642e 0a46 6965   be ignored..Fie
-000140e0: 6c64 7320 7769 7468 6f75 7420 7661 6c75  lds without valu
-000140f0: 6573 2077 696c 6c20 616c 736f 2062 6520  es will also be 
-00014100: 6967 6e6f 7265 642e 0a0a 4966 2074 6865  ignored...If the
-00014110: 2063 6c69 656e 7427 7320 6e6f 6465 2070   client's node p
-00014120: 7265 6665 7265 6e63 6520 6973 2022 6c65  reference is "le
-00014130: 6164 6572 2220 616e 6420 7468 6520 6e6f  ader" and the no
-00014140: 6465 2062 6563 6f6d 6573 2061 0a22 666f  de becomes a."fo
-00014150: 6c6c 6f77 6572 222c 2074 6865 2063 6c69  llower", the cli
-00014160: 656e 7420 7769 6c6c 2061 7474 656d 7074  ent will attempt
-00014170: 2074 6f20 7265 636f 6e6e 6563 7420 746f   to reconnect to
-00014180: 2074 6865 2063 7572 7265 6e74 206c 6561   the current lea
-00014190: 6465 7220 7768 656e 2061 206d 6574 686f  der when a metho
-000141a0: 640a 6973 2063 616c 6c65 6420 7468 6174  d.is called that
-000141b0: 2065 7870 6563 7473 2074 6f20 6361 6c6c   expects to call
-000141c0: 2061 206c 6561 6465 722e 204d 6574 686f   a leader. Metho
-000141d0: 6473 2077 6869 6368 206d 7574 6174 6520  ds which mutate 
-000141e0: 7468 6520 7374 6174 6520 6f66 2074 6865  the state of the
-000141f0: 2064 6174 6162 6173 650a 6578 7065 6374   database.expect
-00014200: 2074 6f20 6361 6c6c 2061 206c 6561 6465   to call a leade
-00014210: 722e 2046 6f72 2073 7563 6820 6d65 7468  r. For such meth
-00014220: 6f64 732c 2074 6865 2048 5454 5020 6865  ods, the HTTP he
-00014230: 6164 6572 2272 6571 7569 7265 732d 6c65  ader"requires-le
-00014240: 6164 6572 2220 6973 2073 6574 2074 6f0a  ader" is set to.
-00014250: 2274 7275 6522 2c20 616e 6420 7468 6973  "true", and this
-00014260: 2068 6561 6465 7220 6973 206f 6273 6572   header is obser
-00014270: 7665 6420 6279 2074 6865 2073 6572 7665  ved by the serve
-00014280: 722c 2061 6e64 2073 6f20 6120 6e6f 6465  r, and so a node
-00014290: 2077 6869 6368 2069 7320 6e6f 7420 6120   which is not a 
-000142a0: 6c65 6164 6572 0a74 6861 7420 7265 6365  leader.that rece
-000142b0: 6976 6573 2073 7563 6820 6120 7265 7175  ives such a requ
-000142c0: 6573 7420 7769 6c6c 2072 6574 7572 6e20  est will return 
-000142d0: 616e 2065 7272 6f72 2e20 5468 6973 2065  an error. This e
-000142e0: 7272 6f72 2069 7320 6465 7465 6374 6564  rror is detected
-000142f0: 2062 7920 7468 6520 636c 6965 6e74 2c0a   by the client,.
-00014300: 7768 6963 6820 7769 6c6c 2074 6865 6e20  which will then 
-00014310: 636c 6f73 6520 7468 6520 6375 7272 656e  close the curren
-00014320: 7420 6752 5043 2063 6f6e 6e65 6374 696f  t gRPC connectio
-00014330: 6e20 616e 6420 6372 6561 7465 2061 206e  n and create a n
-00014340: 6577 2063 6f6e 6e65 6374 696f 6e20 746f  ew connection to
-00014350: 2074 6865 0a6c 6561 6465 722e 2054 6865   the.leader. The
-00014360: 2072 6571 7565 7374 2077 696c 6c20 7468   request will th
-00014370: 656e 2062 6520 7265 7472 6965 6420 7769  en be retried wi
-00014380: 7468 2074 6865 206c 6561 6465 722e 0a0a  th the leader...
-00014390: 4966 2074 6865 2063 6c69 656e 7427 7320  If the client's 
-000143a0: 6e6f 6465 2070 7265 6665 7265 6e63 6520  node preference 
-000143b0: 6973 2022 666f 6c6c 6f77 6572 2220 616e  is "follower" an
-000143c0: 6420 7468 6572 6520 6172 6520 6e6f 2066  d there are no f
-000143d0: 6f6c 6c6f 7765 720a 6e6f 6465 7320 696e  ollower.nodes in
-000143e0: 2074 6865 2063 6c75 7374 6572 2c20 7468   the cluster, th
-000143f0: 656e 2074 6865 2063 6c69 656e 7420 7769  en the client wi
-00014400: 6c6c 2072 6169 7365 2061 6e20 6578 6365  ll raise an exce
-00014410: 7074 696f 6e2e 2053 696d 696c 6172 6c79  ption. Similarly
-00014420: 2c20 6966 2074 6865 0a63 6c69 656e 7427  , if the.client'
-00014430: 7320 6e6f 6465 2070 7265 6665 7265 6e63  s node preferenc
-00014440: 6520 6973 2022 7265 6164 6f6e 6c79 7265  e is "readonlyre
-00014450: 706c 6963 6122 2061 6e64 2074 6865 7265  plica" and there
-00014460: 2061 7265 206e 6f20 7265 6164 2d6f 6e6c   are no read-onl
-00014470: 7920 7265 706c 6963 610a 6e6f 6465 7320  y replica.nodes 
-00014480: 696e 2074 6865 2063 6c75 7374 6572 2c20  in the cluster, 
-00014490: 7468 656e 2074 6865 2063 6c69 656e 7420  then the client 
-000144a0: 7769 6c6c 2061 6c73 6f20 7261 6973 6520  will also raise 
-000144b0: 616e 2065 7863 6570 7469 6f6e 2e0a 0a54  an exception...T
-000144c0: 6865 2067 5250 4320 6368 616e 6e65 6c20  he gRPC channel 
-000144d0: 6f70 7469 6f6e 2022 6772 7063 2e6d 6178  option "grpc.max
-000144e0: 5f72 6563 6569 7665 5f6d 6573 7361 6765  _receive_message
-000144f0: 5f6c 656e 6774 6822 2069 7320 6175 746f  _length" is auto
-00014500: 6d61 7469 6361 6c6c 790a 636f 6e66 6967  matically.config
-00014510: 7572 6564 2074 6f20 7468 6520 7661 6c75  ured to the valu
-00014520: 6520 6031 3720 2a20 3130 3234 202a 2031  e `17 * 1024 * 1
-00014530: 3032 3460 2e20 5468 6973 2076 616c 7565  024`. This value
-00014540: 2063 616e 6e6f 7420 6265 2063 6861 6e67   cannot be chang
-00014550: 6564 2e0a 0a0a 2323 2320 5265 6775 6c61  ed....### Regula
-00014560: 7220 6578 7072 6573 7369 6f6e 2066 696c  r expression fil
-00014570: 7465 7273 0a0a 5468 6520 6669 6c74 6572  ters..The filter
-00014580: 2061 7267 756d 656e 7473 2069 6e20 6072   arguments in `r
-00014590: 6561 645f 616c 6c5f 6576 656e 7473 2829  ead_all_events()
-000145a0: 602c 2060 7375 6273 6372 6962 655f 616c  `, `subscribe_al
-000145b0: 6c5f 6576 656e 7473 2829 602c 0a60 6372  l_events()`,.`cr
-000145c0: 6561 7465 5f73 7562 7363 7269 7074 696f  eate_subscriptio
-000145d0: 6e28 2960 2061 6e64 2060 6765 745f 636f  n()` and `get_co
-000145e0: 6d6d 6974 5f70 6f73 6974 696f 6e28 2960  mmit_position()`
-000145f0: 2061 7265 2061 7070 6c69 6564 2074 6f20   are applied to 
-00014600: 7468 6520 6074 7970 6560 0a61 7474 7269  the `type`.attri
-00014610: 6275 7465 206f 6620 7265 636f 7264 6564  bute of recorded
-00014620: 2065 7665 6e74 732e 0a0a 5468 6520 6465   events...The de
-00014630: 6661 756c 7420 7661 6c75 6520 6f66 2074  fault value of t
-00014640: 6865 2060 6669 6c74 6572 5f65 7863 6c75  he `filter_exclu
-00014650: 6465 6020 6172 6775 6d65 6e74 7320 6973  de` arguments is
-00014660: 2064 6573 6967 6e65 6420 746f 2065 7863   designed to exc
-00014670: 6c75 6465 0a45 7665 6e74 5374 6f72 6544  lude.EventStoreD
-00014680: 4220 2273 7973 7465 6d22 2061 6e64 2022  B "system" and "
-00014690: 7065 7273 6973 7465 6e63 6520 7375 6273  persistence subs
-000146a0: 6372 6970 7469 6f6e 2063 6f6e 6669 6722  cription config"
-000146b0: 2065 7665 6e74 732c 2077 6869 6368 0a6f   events, which.o
-000146c0: 7468 6572 7769 7365 2077 6f75 6c64 2062  therwise would b
-000146d0: 6520 696e 636c 7564 6564 2e20 5379 7374  e included. Syst
-000146e0: 656d 2065 7665 6e74 7320 6765 6e65 7261  em events genera
-000146f0: 7465 6420 6279 2045 7665 6e74 5374 6f72  ted by EventStor
-00014700: 6544 4220 616c 6c0a 6861 7665 2060 7479  eDB all.have `ty
-00014710: 7065 6020 7374 7269 6e67 7320 7468 6174  pe` strings that
-00014720: 2073 7461 7274 2077 6974 6820 7468 6520   start with the 
-00014730: 6024 6020 7369 676e 2e20 5065 7273 6973  `$` sign. Persis
-00014740: 7465 6e63 6520 7375 6273 6372 6970 7469  tence subscripti
-00014750: 6f6e 0a65 7665 6e74 7320 6765 6e65 7261  on.events genera
-00014760: 7465 6420 7768 656e 206d 616e 6970 756c  ted when manipul
-00014770: 6174 696e 6720 7065 7273 6973 7465 6e63  ating persistenc
-00014780: 6520 7375 6273 6372 6970 7469 6f6e 7320  e subscriptions 
-00014790: 616c 6c20 6861 7665 2060 7479 7065 600a  all have `type`.
-000147a0: 7374 7269 6e67 7320 7468 6174 2073 7461  strings that sta
-000147b0: 7274 2077 6974 6820 6050 6572 7369 7374  rt with `Persist
-000147c0: 656e 7443 6f6e 6669 6760 2e0a 0a46 6f72  entConfig`...For
-000147d0: 2065 7861 6d70 6c65 2c20 746f 206d 6174   example, to mat
-000147e0: 6368 2074 6865 2074 7970 6520 6f66 2045  ch the type of E
-000147f0: 7665 6e74 5374 6f72 6544 4220 7379 7374  ventStoreDB syst
-00014800: 656d 2065 7665 6e74 732c 2075 7365 2074  em events, use t
-00014810: 6865 2072 6567 756c 6172 0a65 7870 7265  he regular.expre
-00014820: 7373 696f 6e20 6072 275c 242e 2b27 602e  ssion `r'\$.+'`.
-00014830: 2050 6c65 6173 6520 6e6f 7465 2c20 7468   Please note, th
-00014840: 6520 636f 6e73 7461 6e74 2060 4553 4442  e constant `ESDB
-00014850: 5f53 5953 5445 4d5f 4556 454e 5453 5f52  _SYSTEM_EVENTS_R
-00014860: 4547 4558 6020 6973 0a73 6574 2074 6f20  EGEX` is.set to 
-00014870: 6072 275c 242e 2b27 602e 2059 6f75 2063  `r'\$.+'`. You c
-00014880: 616e 2069 6d70 6f72 7420 7468 6973 2076  an import this v
-00014890: 616c 7565 0a28 6066 726f 6d20 6573 6462  alue.(`from esdb
-000148a0: 636c 6965 6e74 2069 6d70 6f72 7420 4553  client import ES
-000148b0: 4442 5f53 5953 5445 4d5f 4556 454e 5453  DB_SYSTEM_EVENTS
-000148c0: 5f52 4547 4558 6029 2061 6e64 2075 7365  _REGEX`) and use
-000148d0: 0a69 7420 7768 656e 2062 7569 6c64 696e  .it when buildin
-000148e0: 6720 6c6f 6e67 6572 2073 6571 7565 6e63  g longer sequenc
-000148f0: 6573 206f 6620 7265 6775 6c61 7220 6578  es of regular ex
-00014900: 7072 6573 7369 6f6e 732e 0a0a 5369 6d69  pressions...Simi
-00014910: 6c61 726c 792c 2074 6f20 6d61 7463 6820  larly, to match 
-00014920: 7468 6520 7479 7065 206f 6620 4576 656e  the type of Even
-00014930: 7453 746f 7265 4442 2070 6572 7369 7374  tStoreDB persist
-00014940: 656e 6365 2073 7562 7363 7269 7074 696f  ence subscriptio
-00014950: 6e20 6576 656e 7473 2c20 7573 6520 7468  n events, use th
-00014960: 650a 7265 6775 6c61 7220 6578 7072 6573  e.regular expres
-00014970: 7369 6f6e 2060 7227 5065 7273 6973 7465  sion `r'Persiste
-00014980: 6e74 436f 6e66 6967 5c64 2b27 602e 2054  ntConfig\d+'`. T
-00014990: 6865 2063 6f6e 7374 616e 7420 6045 5344  he constant `ESD
-000149a0: 425f 5045 5253 4953 5445 4e54 5f43 4f4e  B_PERSISTENT_CON
-000149b0: 4649 475f 4556 454e 5453 5f52 4547 4558  FIG_EVENTS_REGEX
-000149c0: 600a 6973 2073 6574 2074 6f20 6072 2750  `.is set to `r'P
-000149d0: 6572 7369 7374 656e 7443 6f6e 6669 675c  ersistentConfig\
-000149e0: 642b 2760 2e20 596f 7520 6361 6e20 616c  d+'`. You can al
-000149f0: 736f 2069 6d70 6f72 7420 7468 6973 2076  so import this v
-00014a00: 616c 7565 0a28 6066 726f 6d20 6573 6462  alue.(`from esdb
-00014a10: 636c 6965 6e74 2069 6d70 6f72 7420 4553  client import ES
-00014a20: 4442 5f50 4552 5349 5354 454e 545f 434f  DB_PERSISTENT_CO
-00014a30: 4e46 4947 5f45 5645 4e54 535f 5245 4745  NFIG_EVENTS_REGE
-00014a40: 5860 2920 616e 6420 7573 6520 6974 2077  X`) and use it w
-00014a50: 6865 6e20 6275 696c 6469 6e67 0a6c 6f6e  hen building.lon
-00014a60: 6765 7220 7365 7175 656e 6365 7320 6f66  ger sequences of
-00014a70: 2072 6567 756c 6172 2065 7870 7265 7373   regular express
-00014a80: 696f 6e73 2e0a 0a54 6865 2063 6f6e 7374  ions...The const
-00014a90: 616e 7420 6044 4546 4155 4c54 5f45 5843  ant `DEFAULT_EXC
-00014aa0: 4c55 4445 5f46 494c 5445 5260 2069 7320  LUDE_FILTER` is 
-00014ab0: 6120 7365 7175 656e 6365 206f 6620 7265  a sequence of re
-00014ac0: 6775 6c61 7220 6578 7072 6573 7369 6f6e  gular expression
-00014ad0: 7320 7468 6174 206d 6174 6368 0a74 6865  s that match.the
-00014ae0: 2065 7665 6e74 7320 7468 6174 2045 7665   events that Eve
-00014af0: 6e74 5374 6f72 6544 4220 6765 6e65 7261  ntStoreDB genera
-00014b00: 7465 7320 696e 7465 726e 616c 6c79 2c20  tes internally, 
-00014b10: 6576 656e 7473 2074 6861 7420 6172 6520  events that are 
-00014b20: 6578 7472 616e 656f 7573 2074 6f20 7468  extraneous to th
-00014b30: 6f73 650a 7768 6963 6820 796f 7520 6170  ose.which you ap
-00014b40: 7065 6e64 2075 7369 6e67 2074 6865 2060  pend using the `
-00014b50: 6170 7065 6e64 5f65 7665 6e74 7328 2960  append_events()`
-00014b60: 206d 6574 686f 642e 0a0a 466f 7220 6578   method...For ex
-00014b70: 616d 706c 652c 2074 6f20 6578 636c 7564  ample, to exclud
-00014b80: 6520 7379 7374 656d 2065 7665 6e74 7320  e system events 
-00014b90: 616e 6420 7065 7273 6973 7465 6e63 6520  and persistence 
-00014ba0: 7375 6273 6372 6970 7469 6f6e 2063 6f6e  subscription con
-00014bb0: 6669 6775 7261 7469 6f6e 2065 7665 6e74  figuration event
-00014bc0: 732c 0a61 6e64 2073 6e61 7073 686f 7473  s,.and snapshots
-00014bd0: 2c20 796f 7520 6d69 6768 7420 7573 6520  , you might use 
-00014be0: 7468 6520 7365 7175 656e 6365 2060 4445  the sequence `DE
-00014bf0: 4641 554c 545f 4558 434c 5544 455f 4649  FAULT_EXCLUDE_FI
-00014c00: 4c54 4552 202b 205b 272e 2a53 6e61 7073  LTER + ['.*Snaps
-00014c10: 686f 7427 5d60 2061 730a 7468 6520 7661  hot']` as.the va
-00014c20: 6c75 6520 6f66 2074 6865 2060 6669 6c74  lue of the `filt
-00014c30: 6572 5f65 7863 6c75 6465 6020 6172 6775  er_exclude` argu
-00014c40: 6d65 6e74 2077 6865 6e20 6361 6c6c 696e  ment when callin
-00014c50: 6720 6072 6561 645f 616c 6c5f 6576 656e  g `read_all_even
-00014c60: 7473 2829 602c 0a60 7375 6273 6372 6962  ts()`,.`subscrib
-00014c70: 655f 616c 6c5f 6576 656e 7473 2829 602c  e_all_events()`,
-00014c80: 2060 6372 6561 7465 5f73 7562 7363 7269   `create_subscri
-00014c90: 7074 696f 6e28 2960 206f 7220 6067 6574  ption()` or `get
-00014ca0: 5f63 6f6d 6d69 745f 706f 7369 7469 6f6e  _commit_position
-00014cb0: 2829 602e 0a0a 2323 2320 4e65 7720 6576  ()`...### New ev
-00014cc0: 656e 7420 6f62 6a65 6374 730a 0a54 6865  ent objects..The
-00014cd0: 2060 4e65 7745 7665 6e74 6020 636c 6173   `NewEvent` clas
-00014ce0: 7320 6973 2075 7365 6420 7768 656e 2061  s is used when a
-00014cf0: 7070 656e 6469 6e67 2065 7665 6e74 732e  ppending events.
-00014d00: 0a0a 5468 6520 7265 7175 6972 6564 2061  ..The required a
-00014d10: 7267 756d 656e 7420 6074 7970 6560 2069  rgument `type` i
-00014d20: 7320 6120 5079 7468 6f6e 2060 7374 7260  s a Python `str`
-00014d30: 2c20 7573 6564 2074 6f20 696e 6469 6361  , used to indica
-00014d40: 7465 2074 6865 2074 7970 6520 6f66 0a74  te the type of.t
-00014d50: 6865 2065 7665 6e74 2074 6861 7420 7769  he event that wi
-00014d60: 6c6c 2062 6520 7265 636f 7264 6564 2e0a  ll be recorded..
-00014d70: 0a54 6865 2072 6571 7569 7265 6420 6172  .The required ar
-00014d80: 6775 6d65 6e74 2060 6461 7461 6020 6973  gument `data` is
-00014d90: 2061 2050 7974 686f 6e20 6062 7974 6573   a Python `bytes
-00014da0: 6020 6f62 6a65 6374 2c20 7573 6564 2074  ` object, used t
-00014db0: 6f20 696e 6469 6361 7465 2074 6865 2064  o indicate the d
-00014dc0: 6174 6120 6f66 0a74 6865 2065 7665 6e74  ata of.the event
-00014dd0: 2074 6861 7420 7769 6c6c 2062 6520 7265   that will be re
-00014de0: 636f 7264 6564 2e0a 0a54 6865 206f 7074  corded...The opt
-00014df0: 696f 6e61 6c20 6172 6775 6d65 6e74 2060  ional argument `
-00014e00: 6d65 7461 6461 7461 6020 6973 2061 2050  metadata` is a P
-00014e10: 7974 686f 6e20 6062 7974 6573 6020 6f62  ython `bytes` ob
-00014e20: 6a65 6374 2c20 7573 6564 2074 6f20 696e  ject, used to in
-00014e30: 6469 6361 7465 2061 6e79 0a6d 6574 6164  dicate any.metad
-00014e40: 6174 6120 6f66 2074 6865 2065 7665 6e74  ata of the event
-00014e50: 2074 6861 7420 7769 6c6c 2062 6520 7265   that will be re
-00014e60: 636f 7264 6564 2e20 5468 6520 6465 6661  corded. The defa
-00014e70: 756c 7420 7661 6c75 6520 6973 2061 6e20  ult value is an 
-00014e80: 656d 7074 7920 6062 7974 6573 600a 6f62  empty `bytes`.ob
-00014e90: 6a65 6374 2e0a 0a54 6865 206f 7074 696f  ject...The optio
-00014ea0: 6e61 6c20 6172 6775 6d65 6e74 2060 636f  nal argument `co
-00014eb0: 6e74 656e 745f 7479 7065 6020 6973 2061  ntent_type` is a
-00014ec0: 2050 7974 686f 6e20 6073 7472 602c 2075   Python `str`, u
-00014ed0: 7365 6420 746f 2069 6e64 6963 6174 6520  sed to indicate 
-00014ee0: 7468 650a 7479 7065 206f 6620 7468 6520  the.type of the 
-00014ef0: 6461 7461 2074 6861 7420 7769 6c6c 2062  data that will b
-00014f00: 6520 7265 636f 7264 6564 2066 6f72 2074  e recorded for t
-00014f10: 6869 7320 6576 656e 742e 2054 6865 2064  his event. The d
-00014f20: 6566 6175 6c74 2076 616c 7565 2069 730a  efault value is.
-00014f30: 6061 7070 6c69 6361 7469 6f6e 2f6a 736f  `application/jso
-00014f40: 6e60 2c20 7768 6963 6820 696e 6469 6361  n`, which indica
-00014f50: 7465 7320 7468 6174 2074 6865 2060 6461  tes that the `da
-00014f60: 7461 6020 7761 7320 7365 7269 616c 6973  ta` was serialis
-00014f70: 6564 2075 7369 6e67 204a 534f 4e2e 0a41  ed using JSON..A
-00014f80: 6e20 616c 7465 726e 6174 6976 6520 7661  n alternative va
-00014f90: 6c75 6520 666f 7220 7468 6973 2061 7267  lue for this arg
-00014fa0: 756d 656e 7420 6973 2060 6170 706c 6963  ument is `applic
-00014fb0: 6174 696f 6e2f 6f63 7465 742d 7374 7265  ation/octet-stre
-00014fc0: 616d 602e 0a0a 5468 6520 6f70 7469 6f6e  am`...The option
-00014fd0: 616c 2061 7267 756d 656e 7420 6069 6460  al argument `id`
-00014fe0: 2069 7320 6120 5079 7468 6f6e 2060 5555   is a Python `UU
-00014ff0: 4944 6020 6f62 6a65 6374 2c20 7573 6564  ID` object, used
-00015000: 2074 6f20 7370 6563 6966 7920 7468 6520   to specify the 
-00015010: 756e 6971 7565 2049 440a 6f66 2074 6865  unique ID.of the
-00015020: 2065 7665 6e74 2074 6861 7420 7769 6c6c   event that will
-00015030: 2062 6520 7265 636f 7264 6564 2e20 5468   be recorded. Th
-00015040: 6973 2076 616c 7565 2077 696c 6c20 6465  is value will de
-00015050: 6661 756c 7420 746f 2061 206e 6577 2076  fault to a new v
-00015060: 6572 7369 6f6e 2d34 2055 5549 442e 0a0a  ersion-4 UUID...
-00015070: 6060 6070 7974 686f 6e0a 6e65 775f 6576  ```python.new_ev
-00015080: 656e 7431 203d 204e 6577 4576 656e 7428  ent1 = NewEvent(
-00015090: 0a20 2020 2074 7970 653d 274f 7264 6572  .    type='Order
-000150a0: 4372 6561 7465 6427 2c0a 2020 2020 6461  Created',.    da
-000150b0: 7461 3d62 277b 226e 616d 6522 3a20 2247  ta=b'{"name": "G
-000150c0: 7265 6722 7d27 2c0a 290a 6173 7365 7274  reg"}',.).assert
-000150d0: 206e 6577 5f65 7665 6e74 312e 7479 7065   new_event1.type
-000150e0: 203d 3d20 274f 7264 6572 4372 6561 7465   == 'OrderCreate
-000150f0: 6427 0a61 7373 6572 7420 6e65 775f 6576  d'.assert new_ev
-00015100: 656e 7431 2e64 6174 6120 3d3d 2062 277b  ent1.data == b'{
-00015110: 226e 616d 6522 3a20 2247 7265 6722 7d27  "name": "Greg"}'
-00015120: 0a61 7373 6572 7420 6e65 775f 6576 656e  .assert new_even
-00015130: 7431 2e6d 6574 6164 6174 6120 3d3d 2062  t1.metadata == b
-00015140: 2727 0a61 7373 6572 7420 6e65 775f 6576  ''.assert new_ev
-00015150: 656e 7431 2e63 6f6e 7465 6e74 5f74 7970  ent1.content_typ
-00015160: 6520 3d3d 2027 6170 706c 6963 6174 696f  e == 'applicatio
-00015170: 6e2f 6a73 6f6e 270a 6173 7365 7274 2069  n/json'.assert i
-00015180: 7369 6e73 7461 6e63 6528 6e65 775f 6576  sinstance(new_ev
-00015190: 656e 7431 2e69 642c 2055 5549 4429 0a0a  ent1.id, UUID)..
-000151a0: 6576 656e 745f 6964 203d 2075 7569 6434  event_id = uuid4
-000151b0: 2829 0a6e 6577 5f65 7665 6e74 3220 3d20  ().new_event2 = 
-000151c0: 4e65 7745 7665 6e74 280a 2020 2020 7479  NewEvent(.    ty
-000151d0: 7065 3d27 496d 6167 6543 7265 6174 6564  pe='ImageCreated
-000151e0: 272c 0a20 2020 2064 6174 613d 6227 3031  ',.    data=b'01
-000151f0: 3031 3031 3031 3031 3031 3031 272c 0a20  010101010101',. 
-00015200: 2020 206d 6574 6164 6174 613d 6227 7b22     metadata=b'{"
-00015210: 6122 3a20 317d 272c 0a20 2020 2063 6f6e  a": 1}',.    con
-00015220: 7465 6e74 5f74 7970 653d 2761 7070 6c69  tent_type='appli
-00015230: 6361 7469 6f6e 2f6f 6374 6574 2d73 7472  cation/octet-str
-00015240: 6561 6d27 2c0a 2020 2020 6964 3d65 7665  eam',.    id=eve
-00015250: 6e74 5f69 642c 0a29 0a61 7373 6572 7420  nt_id,.).assert 
-00015260: 6e65 775f 6576 656e 7432 2e74 7970 6520  new_event2.type 
-00015270: 3d3d 2027 496d 6167 6543 7265 6174 6564  == 'ImageCreated
-00015280: 270a 6173 7365 7274 206e 6577 5f65 7665  '.assert new_eve
-00015290: 6e74 322e 6461 7461 203d 3d20 6227 3031  nt2.data == b'01
-000152a0: 3031 3031 3031 3031 3031 3031 270a 6173  010101010101'.as
-000152b0: 7365 7274 206e 6577 5f65 7665 6e74 322e  sert new_event2.
-000152c0: 6d65 7461 6461 7461 203d 3d20 6227 7b22  metadata == b'{"
-000152d0: 6122 3a20 317d 270a 6173 7365 7274 206e  a": 1}'.assert n
-000152e0: 6577 5f65 7665 6e74 322e 636f 6e74 656e  ew_event2.conten
-000152f0: 745f 7479 7065 203d 3d20 2761 7070 6c69  t_type == 'appli
-00015300: 6361 7469 6f6e 2f6f 6374 6574 2d73 7472  cation/octet-str
-00015310: 6561 6d27 0a61 7373 6572 7420 6e65 775f  eam'.assert new_
-00015320: 6576 656e 7432 2e69 6420 3d3d 2065 7665  event2.id == eve
-00015330: 6e74 5f69 640a 6060 600a 0a23 2323 2052  nt_id.```..### R
-00015340: 6563 6f72 6465 6420 6576 656e 7420 6f62  ecorded event ob
-00015350: 6a65 6374 730a 0a54 6865 2060 5265 636f  jects..The `Reco
-00015360: 7264 6564 4576 656e 7460 2063 6c61 7373  rdedEvent` class
-00015370: 2069 7320 7573 6564 2077 6865 6e20 7265   is used when re
-00015380: 6164 696e 6720 6576 656e 7473 2e0a 0a54  ading events...T
-00015390: 6865 2061 7474 7269 6275 7465 2060 7479  he attribute `ty
-000153a0: 7065 6020 6973 2061 2050 7974 686f 6e20  pe` is a Python 
-000153b0: 6073 7472 602c 2075 7365 6420 746f 2069  `str`, used to i
-000153c0: 6e64 6963 6174 6520 7468 6520 7479 7065  ndicate the type
-000153d0: 206f 6620 6576 656e 740a 7468 6174 2077   of event.that w
-000153e0: 6173 2072 6563 6f72 6465 642e 0a0a 5468  as recorded...Th
-000153f0: 6520 6174 7472 6962 7574 6520 6064 6174  e attribute `dat
-00015400: 6160 2069 7320 6120 5079 7468 6f6e 2060  a` is a Python `
-00015410: 6279 7465 7360 206f 626a 6563 742c 2075  bytes` object, u
-00015420: 7365 6420 746f 2069 6e64 6963 6174 6520  sed to indicate 
-00015430: 7468 6520 6461 7461 206f 6620 7468 650a  the data of the.
-00015440: 6576 656e 7420 7468 6174 2077 6173 2072  event that was r
-00015450: 6563 6f72 6465 642e 0a0a 5468 6520 6174  ecorded...The at
-00015460: 7472 6962 7574 6520 606d 6574 6164 6174  tribute `metadat
-00015470: 6160 2069 7320 6120 5079 7468 6f6e 2060  a` is a Python `
-00015480: 6279 7465 7360 206f 626a 6563 742c 2075  bytes` object, u
-00015490: 7365 6420 746f 2069 6e64 6963 6174 6520  sed to indicate 
-000154a0: 7468 6520 6d65 7461 6461 7461 206f 660a  the metadata of.
-000154b0: 7468 6520 6576 656e 7420 7468 6174 2077  the event that w
-000154c0: 6173 2072 6563 6f72 6465 642e 0a0a 5468  as recorded...Th
-000154d0: 6520 6174 7472 6962 7574 6520 6063 6f6e  e attribute `con
-000154e0: 7465 6e74 5f74 7970 6560 2069 7320 6120  tent_type` is a 
-000154f0: 5079 7468 6f6e 2060 7374 7260 2c20 7573  Python `str`, us
-00015500: 6564 2074 6f20 696e 6469 6361 7465 2074  ed to indicate t
-00015510: 6865 2074 7970 6520 6f66 0a64 6174 6120  he type of.data 
-00015520: 7468 6174 2077 6173 2072 6563 6f72 6465  that was recorde
-00015530: 6420 666f 7220 7468 6973 2065 7665 6e74  d for this event
-00015540: 2028 7573 7561 6c6c 7920 6061 7070 6c69   (usually `appli
-00015550: 6361 7469 6f6e 2f6a 736f 6e60 2074 6f20  cation/json` to 
-00015560: 696e 6469 6361 7465 2074 6861 740a 7468  indicate that.th
-00015570: 6973 2064 6174 6120 6361 6e20 6265 2070  is data can be p
-00015580: 6172 7365 6420 6173 204a 534f 4e2c 2062  arsed as JSON, b
-00015590: 7574 2061 6c74 6572 6e61 7469 7665 6c79  ut alternatively
-000155a0: 2060 6170 706c 6963 6174 696f 6e2f 6f63   `application/oc
-000155b0: 7465 742d 7374 7265 616d 6020 746f 0a69  tet-stream` to.i
-000155c0: 6e64 6963 6174 6520 7468 6174 2069 7420  ndicate that it 
-000155d0: 6973 2073 6f6d 6574 6869 6e67 2065 6c73  is something els
-000155e0: 6529 2e0a 0a54 6865 2061 7474 7269 6275  e)...The attribu
-000155f0: 7465 2060 6964 6020 6973 2061 2050 7974  te `id` is a Pyt
-00015600: 686f 6e20 6055 5549 4460 206f 626a 6563  hon `UUID` objec
-00015610: 742c 2075 7365 6420 746f 2069 6e64 6963  t, used to indic
-00015620: 6174 6520 7468 6520 756e 6971 7565 2049  ate the unique I
-00015630: 4420 6f66 2074 6865 0a65 7665 6e74 2074  D of the.event t
-00015640: 6861 7420 7761 7320 7265 636f 7264 6564  hat was recorded
-00015650: 2e20 506c 6561 7365 206e 6f74 652c 2077  . Please note, w
-00015660: 6865 6e20 7265 636f 7264 6564 2065 7665  hen recorded eve
-00015670: 6e74 7320 6172 6520 7265 7475 726e 6564  nts are returned
-00015680: 2066 726f 6d20 6120 6361 6c6c 0a74 6f20   from a call.to 
-00015690: 6072 6561 645f 7374 7265 616d 5f65 7665  `read_stream_eve
-000156a0: 6e74 7328 2960 2069 6e20 4576 656e 7453  nts()` in EventS
-000156b0: 746f 7265 4442 2076 3231 2e31 302c 2074  toreDB v21.10, t
-000156c0: 6865 2063 6f6d 6d69 7420 706f 7369 7469  he commit positi
-000156d0: 6f6e 2069 7320 6e6f 7420 6163 7475 616c  on is not actual
-000156e0: 6c79 0a73 6574 2069 6e20 7468 6520 7265  ly.set in the re
-000156f0: 7370 6f6e 7365 2e20 5468 6973 2061 7474  sponse. This att
-00015700: 7269 6275 7465 2069 7320 7479 7065 6420  ribute is typed 
-00015710: 6173 2061 6e20 6f70 7469 6f6e 616c 2076  as an optional v
-00015720: 616c 7565 2028 604f 7074 696f 6e61 6c5b  alue (`Optional[
-00015730: 5555 4944 5d60 292c 0a61 6e64 2069 6e20  UUID]`),.and in 
-00015740: 7468 6520 6361 7365 206f 6620 7573 696e  the case of usin
-00015750: 6720 4576 656e 7453 746f 7265 4442 2076  g EventStoreDB v
-00015760: 3231 2e31 3020 7468 6520 7661 6c75 6520  21.10 the value 
-00015770: 6f66 2074 6869 7320 6174 7472 6962 7574  of this attribut
-00015780: 6520 7769 6c6c 2062 6520 604e 6f6e 6560  e will be `None`
-00015790: 0a77 6865 6e20 7265 6164 696e 6720 7265  .when reading re
-000157a0: 636f 7264 6564 2065 7665 6e74 7320 6672  corded events fr
-000157b0: 6f6d 2061 2073 7472 6561 6d2e 2052 6563  om a stream. Rec
-000157c0: 6f72 6465 6420 6576 656e 7473 2077 696c  orded events wil
-000157d0: 6c20 686f 7765 7665 7220 6861 7665 2074  l however have t
-000157e0: 6869 730a 7661 6c75 6573 2073 6574 2077  his.values set w
-000157f0: 6865 6e20 7265 6164 696e 6720 7265 636f  hen reading reco
-00015800: 7264 6564 2065 7665 6e74 7320 6672 6f6d  rded events from
-00015810: 2060 7265 6164 5f61 6c6c 5f65 7665 6e74   `read_all_event
-00015820: 7328 2960 2061 6e64 2066 726f 6d20 626f  s()` and from bo
-00015830: 7468 0a63 6174 6368 2d75 7020 616e 6420  th.catch-up and 
-00015840: 7065 7273 6973 7465 6e74 2073 7562 7363  persistent subsc
-00015850: 7269 7074 696f 6e73 2e0a 0a54 6865 2061  riptions...The a
-00015860: 7474 7269 6275 7465 2060 7374 7265 616d  ttribute `stream
-00015870: 5f6e 616d 6560 2069 7320 6120 5079 7468  _name` is a Pyth
-00015880: 6f6e 2060 7374 7260 2c20 7573 6564 2074  on `str`, used t
-00015890: 6f20 696e 6469 6361 7465 2074 6865 206e  o indicate the n
-000158a0: 616d 6520 6f66 2074 6865 0a73 7472 6561  ame of the.strea
-000158b0: 6d20 696e 2077 6869 6368 2074 6865 2065  m in which the e
-000158c0: 7665 6e74 2077 6173 2072 6563 6f72 6465  vent was recorde
-000158d0: 642e 0a0a 5468 6520 6174 7472 6962 7574  d...The attribut
-000158e0: 6520 6073 7472 6561 6d5f 706f 7369 7469  e `stream_positi
-000158f0: 6f6e 6020 6973 2061 2050 7974 686f 6e20  on` is a Python 
-00015900: 6069 6e74 602c 2075 7365 6420 746f 2069  `int`, used to i
-00015910: 6e64 6963 6174 6520 7468 6520 706f 7369  ndicate the posi
-00015920: 7469 6f6e 2069 6e20 7468 650a 7374 7265  tion in the.stre
-00015930: 616d 2061 7420 7768 6963 6820 7468 6520  am at which the 
-00015940: 6576 656e 7420 7761 7320 7265 636f 7264  event was record
-00015950: 6564 2e0a 0a54 6865 2061 7474 7269 6275  ed...The attribu
-00015960: 7465 2060 636f 6d6d 6974 5f70 6f73 6974  te `commit_posit
-00015970: 696f 6e60 2069 7320 6120 5079 7468 6f6e  ion` is a Python
-00015980: 2060 696e 7460 2c20 7573 6564 2074 6f20   `int`, used to 
-00015990: 696e 6469 6361 7465 2074 6865 2063 6f6d  indicate the com
-000159a0: 6d69 7420 706f 7369 7469 6f6e 0a61 7420  mit position.at 
-000159b0: 7768 6963 6820 7468 6520 6576 656e 7420  which the event 
-000159c0: 7761 7320 7265 636f 7264 6564 2e0a 0a60  was recorded...`
-000159d0: 6060 7079 7468 6f6e 0a66 726f 6d20 6573  ``python.from es
-000159e0: 6462 636c 6965 6e74 2e65 7665 6e74 7320  dbclient.events 
-000159f0: 696d 706f 7274 2052 6563 6f72 6465 6445  import RecordedE
-00015a00: 7665 6e74 0a0a 7265 636f 7264 6564 5f65  vent..recorded_e
-00015a10: 7665 6e74 203d 2052 6563 6f72 6465 6445  vent = RecordedE
-00015a20: 7665 6e74 280a 2020 2020 7479 7065 3d27  vent(.    type='
-00015a30: 4f72 6465 7243 7265 6174 6564 272c 0a20  OrderCreated',. 
-00015a40: 2020 2064 6174 613d 6227 7b7d 272c 0a20     data=b'{}',. 
-00015a50: 2020 206d 6574 6164 6174 613d 6227 272c     metadata=b'',
-00015a60: 0a20 2020 2063 6f6e 7465 6e74 5f74 7970  .    content_typ
-00015a70: 653d 2761 7070 6c69 6361 7469 6f6e 2f6a  e='application/j
-00015a80: 736f 6e27 2c0a 2020 2020 6964 3d75 7569  son',.    id=uui
-00015a90: 6434 2829 2c0a 2020 2020 7374 7265 616d  d4(),.    stream
-00015aa0: 5f6e 616d 653d 2773 7472 6561 6d31 272c  _name='stream1',
-00015ab0: 0a20 2020 2073 7472 6561 6d5f 706f 7369  .    stream_posi
-00015ac0: 7469 6f6e 3d30 2c0a 2020 2020 636f 6d6d  tion=0,.    comm
-00015ad0: 6974 5f70 6f73 6974 696f 6e3d 3531 322c  it_position=512,
-00015ae0: 0a29 0a60 6060 0a0a 2323 2320 4173 796e  .).```..### Asyn
-00015af0: 6369 6f20 636c 6965 6e74 0a0a 5468 6520  cio client..The 
-00015b00: 6065 7364 6263 6c69 656e 7460 2070 6163  `esdbclient` pac
-00015b10: 6b61 6765 2061 6c73 6f20 696e 636c 7564  kage also includ
-00015b20: 6573 2061 6e20 6561 726c 7920 7665 7273  es an early vers
-00015b30: 696f 6e20 6f66 2061 6e20 6173 796e 6368  ion of an asynch
-00015b40: 726f 6e6f 7573 2049 2f4f 0a67 5250 4320  ronous I/O.gRPC 
-00015b50: 5079 7468 6f6e 2063 6c69 656e 742e 2049  Python client. I
-00015b60: 7420 666f 6c6c 6f77 7320 6578 6163 746c  t follows exactl
-00015b70: 7920 7468 6520 7361 6d65 2062 6568 6176  y the same behav
-00015b80: 696f 7273 2061 7320 7468 6520 6d75 6c74  iors as the mult
-00015b90: 6974 6872 6561 6465 640a 6045 5344 4243  ithreaded.`ESDBC
-00015ba0: 6c69 656e 7460 2c20 6275 7420 7573 6573  lient`, but uses
-00015bb0: 2074 6865 2060 6772 7063 2e61 696f 6020   the `grpc.aio` 
-00015bc0: 7061 636b 6167 6520 616e 6420 7468 6520  package and the 
-00015bd0: 6061 7379 6e63 696f 6020 6d6f 6475 6c65  `asyncio` module
-00015be0: 2c20 696e 7374 6561 6420 6f66 0a60 6772  , instead of.`gr
-00015bf0: 7063 6020 616e 6420 6074 6872 6561 6469  pc` and `threadi
-00015c00: 6e67 602e 0a0a 5468 6520 6061 7379 6e63  ng`...The `async
-00015c10: 6020 6675 6e63 7469 6f6e 2060 4173 796e  ` function `Asyn
-00015c20: 6369 6f45 5344 4243 6c69 656e 7460 2063  cioESDBClient` c
-00015c30: 6f6e 7374 7275 6374 7320 7468 6520 636c  onstructs the cl
-00015c40: 6965 6e74 2c20 616e 6420 636f 6e6e 6563  ient, and connec
-00015c50: 7473 2074 6f0a 6120 7365 7276 6572 2e20  ts to.a server. 
-00015c60: 4974 2063 616e 2062 6520 696d 706f 7274  It can be import
-00015c70: 6564 2066 726f 6d20 6065 7364 6263 6c69  ed from `esdbcli
-00015c80: 656e 7460 2c20 616e 6420 6361 6e20 6265  ent`, and can be
-00015c90: 2063 616c 6c65 6420 7769 7468 2074 6865   called with the
-00015ca0: 2073 616d 650a 6172 6775 6d65 6e74 7320   same.arguments 
-00015cb0: 6173 2060 4553 4442 436c 6965 6e74 602e  as `ESDBClient`.
-00015cc0: 2049 7420 7375 7070 6f72 7473 2062 6f74   It supports bot
-00015cd0: 6820 7468 6520 2265 7364 6222 2061 6e64  h the "esdb" and
-00015ce0: 2074 6865 2022 6573 6462 2b64 6973 636f   the "esdb+disco
-00015cf0: 7665 7222 0a63 6f6e 6e65 6374 696f 6e20  ver".connection 
-00015d00: 7374 7269 6e67 2055 5249 2073 6368 656d  string URI schem
-00015d10: 6573 2c20 616e 6420 7265 636f 6e6e 6563  es, and reconnec
-00015d20: 7473 2061 6e64 2072 6574 7269 6573 206d  ts and retries m
-00015d30: 6574 686f 6473 2077 6865 6e20 636f 6e6e  ethods when conn
-00015d40: 6563 7469 6f6e 0a69 7373 7565 7320 6172  ection.issues ar
-00015d50: 6520 656e 636f 756e 7465 7265 642c 206a  e encountered, j
-00015d60: 7573 7420 6c69 6b65 2060 4553 4442 436c  ust like `ESDBCl
-00015d70: 6965 6e74 602e 0a0a 6060 6070 7974 686f  ient`...```pytho
-00015d80: 6e0a 6672 6f6d 2065 7364 6263 6c69 656e  n.from esdbclien
-00015d90: 7420 696d 706f 7274 2041 7379 6e63 696f  t import Asyncio
-00015da0: 4553 4442 436c 6965 6e74 0a60 6060 0a0a  ESDBClient.```..
-00015db0: 5468 6520 6173 796e 6368 726f 6e6f 7573  The asynchronous
-00015dc0: 2049 2f4f 2063 6c69 656e 7420 6861 7320   I/O client has 
-00015dd0: 6061 7379 6e63 6020 6d65 7468 6f64 7320  `async` methods 
-00015de0: 6061 7070 656e 645f 6576 656e 7473 2829  `append_events()
-00015df0: 602c 0a60 7265 6164 5f73 7472 6561 6d5f  `,.`read_stream_
-00015e00: 6576 656e 7473 2829 602c 2060 7265 6164  events()`, `read
-00015e10: 5f61 6c6c 5f65 7665 6e74 7328 2960 2c20  _all_events()`, 
-00015e20: 6073 7562 7363 7269 6265 5f61 6c6c 5f65  `subscribe_all_e
-00015e30: 7665 6e74 7328 2960 2c0a 6064 656c 6574  vents()`,.`delet
-00015e40: 655f 7374 7265 616d 2829 602c 2060 746f  e_stream()`, `to
-00015e50: 6d62 7374 6f6e 655f 7374 7265 616d 2829  mbstone_stream()
-00015e60: 602c 2061 6e64 2060 7265 636f 6e6e 6563  `, and `reconnec
-00015e70: 7428 2960 2e0a 0a54 6865 7365 206d 6574  t()`...These met
-00015e80: 686f 6473 2061 7265 2065 7175 6976 616c  hods are equival
-00015e90: 656e 7420 746f 2074 6865 206d 6574 686f  ent to the metho
-00015ea0: 6473 206f 6e20 6045 5344 4243 6c69 656e  ds on `ESDBClien
-00015eb0: 7460 2e20 5468 6579 2068 6176 6520 7468  t`. They have th
-00015ec0: 6520 7361 6d65 0a6d 6574 686f 6420 7369  e same.method si
-00015ed0: 676e 6174 7572 6573 2c20 616e 6420 6361  gnatures, and ca
-00015ee0: 6e20 6265 2063 616c 6c65 6420 7769 7468  n be called with
-00015ef0: 2074 6865 2073 616d 6520 6172 6775 6d65   the same argume
-00015f00: 6e74 732c 2074 6f20 7468 6520 7361 6d65  nts, to the same
-00015f10: 2065 6666 6563 742e 0a54 6865 206d 6574   effect..The met
-00015f20: 686f 6473 2077 6869 6368 2061 7070 6561  hods which appea
-00015f30: 7220 6f6e 2060 4553 4442 436c 6965 6e74  r on `ESDBClient
-00015f40: 6020 6275 7420 6e6f 7420 6f6e 2060 4173  ` but not on `As
-00015f50: 796e 6369 6f45 5344 4243 6c69 656e 7460  yncioESDBClient`
-00015f60: 2077 696c 6c20 6265 0a61 6464 6564 2073   will be.added s
-00015f70: 6f6f 6e2e 0a0a 5468 6520 6578 616d 706c  oon...The exampl
-00015f80: 6520 6265 6c6f 7720 6465 6d6f 6e73 7472  e below demonstr
-00015f90: 6174 6573 2074 6865 2060 6170 7065 6e64  ates the `append
-00015fa0: 5f65 7665 6e74 7328 2960 2c20 6072 6561  _events()`, `rea
-00015fb0: 645f 7374 7265 616d 5f65 7665 6e74 7328  d_stream_events(
-00015fc0: 2960 2061 6e64 0a60 7375 6273 6372 6962  )` and.`subscrib
-00015fd0: 655f 616c 6c5f 6576 656e 7473 2829 6020  e_all_events()` 
-00015fe0: 6d65 7468 6f64 732e 2054 6865 7365 2061  methods. These a
-00015ff0: 7265 2074 6865 206d 6f73 7420 7573 6566  re the most usef
-00016000: 756c 206d 6574 686f 6473 2066 6f72 2077  ul methods for w
-00016010: 7269 7469 6e67 0a61 6e20 6576 656e 742d  riting.an event-
-00016020: 736f 7572 6365 6420 6170 706c 6963 6174  sourced applicat
-00016030: 696f 6e2c 2061 6c6c 6f77 696e 6720 6e65  ion, allowing ne
-00016040: 7720 6167 6772 6567 6174 6520 6576 656e  w aggregate even
-00016050: 7473 2074 6f20 6265 2072 6563 6f72 6465  ts to be recorde
-00016060: 642c 2074 6865 0a72 6563 6f72 6465 6420  d, the.recorded 
-00016070: 6576 656e 7473 206f 6620 616e 2061 6767  events of an agg
-00016080: 7265 6761 7465 2074 6f20 6265 206f 6274  regate to be obt
-00016090: 6169 6e65 6420 736f 2061 6767 7265 6761  ained so aggrega
-000160a0: 7465 7320 6361 6e20 6265 2072 6563 6f6e  tes can be recon
-000160b0: 7374 7275 6374 6564 2c0a 616e 6420 7468  structed,.and th
-000160c0: 6520 7374 6174 6520 6f66 2061 6e20 6170  e state of an ap
-000160d0: 706c 6963 6174 696f 6e20 746f 2070 726f  plication to pro
-000160e0: 7061 6761 7465 6420 616e 6420 7072 6f63  pagated and proc
-000160f0: 6573 7365 6420 7769 7468 2022 6578 6163  essed with "exac
-00016100: 746c 792d 6f6e 6365 220a 7365 6d61 6e74  tly-once".semant
-00016110: 6963 732e 0a0a 6060 6070 7974 686f 6e0a  ics...```python.
-00016120: 696d 706f 7274 2061 7379 6e63 696f 0a0a  import asyncio..
-00016130: 6173 796e 6320 6465 6620 6465 6d6f 6e73  async def demons
-00016140: 7472 6174 655f 6173 796e 6369 6f5f 636c  trate_asyncio_cl
-00016150: 6965 6e74 2829 3a0a 0a20 2020 2023 2043  ient():..    # C
-00016160: 6f6e 7374 7275 6374 2063 6c69 656e 742e  onstruct client.
-00016170: 0a20 2020 2063 6c69 656e 7420 3d20 6177  .    client = aw
-00016180: 6169 7420 4173 796e 6369 6f45 5344 4243  ait AsyncioESDBC
-00016190: 6c69 656e 7428 0a20 2020 2020 2020 2075  lient(.        u
-000161a0: 7269 3d6f 732e 6765 7465 6e76 2822 4553  ri=os.getenv("ES
-000161b0: 4442 5f55 5249 2229 2c0a 2020 2020 2020  DB_URI"),.      
-000161c0: 2020 726f 6f74 5f63 6572 7469 6669 6361    root_certifica
-000161d0: 7465 733d 6f73 2e67 6574 656e 7628 2245  tes=os.getenv("E
-000161e0: 5344 425f 524f 4f54 5f43 4552 5449 4649  SDB_ROOT_CERTIFI
-000161f0: 4341 5445 5322 292c 0a20 2020 2029 0a0a  CATES"),.    )..
-00016200: 2020 2020 2320 4170 7065 6e64 2065 7665      # Append eve
-00016210: 6e74 732e 0a20 2020 2073 7472 6561 6d5f  nts..    stream_
-00016220: 6e61 6d65 203d 2073 7472 2875 7569 6434  name = str(uuid4
-00016230: 2829 290a 2020 2020 6576 656e 7431 203d  ()).    event1 =
-00016240: 204e 6577 4576 656e 7428 224f 7264 6572   NewEvent("Order
-00016250: 4372 6561 7465 6422 2c20 6461 7461 3d62  Created", data=b
-00016260: 277b 7d27 290a 2020 2020 6576 656e 7432  '{}').    event2
-00016270: 203d 204e 6577 4576 656e 7428 224f 7264   = NewEvent("Ord
-00016280: 6572 5570 6461 7465 6422 2c20 6461 7461  erUpdated", data
-00016290: 3d62 277b 7d27 290a 2020 2020 6576 656e  =b'{}').    even
-000162a0: 7433 203d 204e 6577 4576 656e 7428 224f  t3 = NewEvent("O
-000162b0: 7264 6572 4465 6c65 7465 6422 2c20 6461  rderDeleted", da
-000162c0: 7461 3d62 277b 7d27 290a 0a20 2020 2061  ta=b'{}')..    a
-000162d0: 7761 6974 2063 6c69 656e 742e 6170 7065  wait client.appe
-000162e0: 6e64 5f65 7665 6e74 7328 0a20 2020 2020  nd_events(.     
-000162f0: 2020 2073 7472 6561 6d5f 6e61 6d65 3d73     stream_name=s
-00016300: 7472 6561 6d5f 6e61 6d65 2c0a 2020 2020  tream_name,.    
-00016310: 2020 2020 6578 7065 6374 6564 5f70 6f73      expected_pos
-00016320: 6974 696f 6e3d 4e6f 6e65 2c0a 2020 2020  ition=None,.    
-00016330: 2020 2020 6576 656e 7473 3d5b 6576 656e      events=[even
-00016340: 7431 2c20 6576 656e 7432 2c20 6576 656e  t1, event2, even
-00016350: 7433 5d0a 2020 2020 290a 0a20 2020 2023  t3].    )..    #
-00016360: 2052 6561 6420 7374 7265 616d 2065 7665   Read stream eve
-00016370: 6e74 732e 0a20 2020 2072 6563 6f72 6465  nts..    recorde
-00016380: 6420 3d20 6177 6169 7420 636c 6965 6e74  d = await client
-00016390: 2e72 6561 645f 7374 7265 616d 5f65 7665  .read_stream_eve
-000163a0: 6e74 7328 7374 7265 616d 5f6e 616d 6529  nts(stream_name)
-000163b0: 0a20 2020 2061 7373 6572 7420 6c65 6e28  .    assert len(
-000163c0: 7265 636f 7264 6564 2920 3d3d 2033 0a20  recorded) == 3. 
-000163d0: 2020 2061 7373 6572 7420 7265 636f 7264     assert record
-000163e0: 6564 5b30 5d2e 6964 203d 3d20 6576 656e  ed[0].id == even
-000163f0: 7431 2e69 640a 2020 2020 6173 7365 7274  t1.id.    assert
-00016400: 2072 6563 6f72 6465 645b 315d 2e69 6420   recorded[1].id 
-00016410: 3d3d 2065 7665 6e74 322e 6964 0a20 2020  == event2.id.   
-00016420: 2061 7373 6572 7420 7265 636f 7264 6564   assert recorded
-00016430: 5b32 5d2e 6964 203d 3d20 6576 656e 7433  [2].id == event3
-00016440: 2e69 640a 0a0a 2020 2020 2320 5375 6273  .id...    # Subs
-00016450: 6372 6962 6520 616c 6c20 6576 656e 7473  cribe all events
-00016460: 2e0a 2020 2020 7265 6365 6976 6564 203d  ..    received =
-00016470: 205b 5d0a 2020 2020 6173 796e 6320 666f   [].    async fo
-00016480: 7220 6576 656e 7420 696e 2061 7761 6974  r event in await
-00016490: 2063 6c69 656e 742e 7375 6273 6372 6962   client.subscrib
-000164a0: 655f 616c 6c5f 6576 656e 7473 2829 3a0a  e_all_events():.
-000164b0: 2020 2020 2020 2020 7265 6365 6976 6564          received
-000164c0: 2e61 7070 656e 6428 6576 656e 7429 0a20  .append(event). 
-000164d0: 2020 2020 2020 2069 6620 6576 656e 742e         if event.
-000164e0: 6964 203d 3d20 6576 656e 7433 2e69 643a  id == event3.id:
-000164f0: 0a20 2020 2020 2020 2020 2020 2062 7265  .            bre
-00016500: 616b 0a20 2020 2061 7373 6572 7420 7265  ak.    assert re
-00016510: 6365 6976 6564 5b2d 335d 2e69 6420 3d3d  ceived[-3].id ==
-00016520: 2065 7665 6e74 312e 6964 0a20 2020 2061   event1.id.    a
-00016530: 7373 6572 7420 7265 6365 6976 6564 5b2d  ssert received[-
-00016540: 325d 2e69 6420 3d3d 2065 7665 6e74 322e  2].id == event2.
-00016550: 6964 0a20 2020 2061 7373 6572 7420 7265  id.    assert re
-00016560: 6365 6976 6564 5b2d 315d 2e69 6420 3d3d  ceived[-1].id ==
-00016570: 2065 7665 6e74 332e 6964 0a0a 0a20 2020   event3.id...   
-00016580: 2023 2043 6c6f 7365 2074 6865 2063 6c69   # Close the cli
-00016590: 656e 742e 0a20 2020 2061 7761 6974 2063  ent..    await c
-000165a0: 6c69 656e 742e 636c 6f73 6528 290a 0a0a  lient.close()...
-000165b0: 2320 5275 6e20 7468 6520 6465 6d6f 2e0a  # Run the demo..
-000165c0: 6173 796e 6369 6f2e 6765 745f 6576 656e  asyncio.get_even
-000165d0: 745f 6c6f 6f70 2829 2e72 756e 5f75 6e74  t_loop().run_unt
-000165e0: 696c 5f63 6f6d 706c 6574 6528 0a20 2020  il_complete(.   
-000165f0: 2064 656d 6f6e 7374 7261 7465 5f61 7379   demonstrate_asy
-00016600: 6e63 696f 5f63 6c69 656e 7428 290a 290a  ncio_client().).
-00016610: 6060 600a 0a23 2320 436f 6e74 7269 6275  ```..## Contribu
-00016620: 746f 7273 0a0a 2323 2320 496e 7374 616c  tors..### Instal
-00016630: 6c20 506f 6574 7279 0a0a 5468 6520 6669  l Poetry..The fi
-00016640: 7273 7420 7468 696e 6720 6973 2074 6f20  rst thing is to 
-00016650: 6368 6563 6b20 796f 7520 6861 7665 2050  check you have P
-00016660: 6f65 7472 7920 696e 7374 616c 6c65 642e  oetry installed.
-00016670: 0a0a 2020 2020 2420 706f 6574 7279 202d  ..    $ poetry -
-00016680: 2d76 6572 7369 6f6e 0a0a 4966 2079 6f75  -version..If you
-00016690: 2064 6f6e 2774 2c20 7468 656e 2070 6c65   don't, then ple
-000166a0: 6173 6520 5b69 6e73 7461 6c6c 2050 6f65  ase [install Poe
-000166b0: 7472 795d 2868 7474 7073 3a2f 2f70 7974  try](https://pyt
-000166c0: 686f 6e2d 706f 6574 7279 2e6f 7267 2f64  hon-poetry.org/d
-000166d0: 6f63 732f 2369 6e73 7461 6c6c 696e 672d  ocs/#installing-
-000166e0: 7769 7468 2d74 6865 2d6f 6666 6963 6961  with-the-officia
-000166f0: 6c2d 696e 7374 616c 6c65 7229 2e0a 0a20  l-installer)... 
-00016700: 2020 2024 2063 7572 6c20 2d73 534c 2068     $ curl -sSL h
-00016710: 7474 7073 3a2f 2f69 6e73 7461 6c6c 2e70  ttps://install.p
-00016720: 7974 686f 6e2d 706f 6574 7279 2e6f 7267  ython-poetry.org
-00016730: 207c 2070 7974 686f 6e33 202d 0a0a 4974   | python3 -..It
-00016740: 2077 696c 6c20 6865 6c70 2074 6f20 6d61   will help to ma
-00016750: 6b65 2073 7572 6520 506f 6574 7279 2773  ke sure Poetry's
-00016760: 2062 696e 2064 6972 6563 746f 7279 2069   bin directory i
-00016770: 7320 696e 2079 6f75 7220 6050 4154 4860  s in your `PATH`
-00016780: 2065 6e76 6972 6f6e 6d65 6e74 2076 6172   environment var
-00016790: 6961 626c 652e 0a0a 4275 7420 696e 2061  iable...But in a
-000167a0: 6e79 2063 6173 652c 206d 616b 6520 7375  ny case, make su
-000167b0: 7265 2079 6f75 206b 6e6f 7720 7468 6520  re you know the 
-000167c0: 7061 7468 2074 6f20 7468 6520 6070 6f65  path to the `poe
-000167d0: 7472 7960 2065 7865 6375 7461 626c 652e  try` executable.
-000167e0: 2054 6865 2050 6f65 7472 790a 696e 7374   The Poetry.inst
-000167f0: 616c 6c65 7220 7465 6c6c 7320 796f 7520  aller tells you 
-00016800: 7768 6572 6520 6974 2068 6173 2062 6565  where it has bee
-00016810: 6e20 696e 7374 616c 6c65 642c 2061 6e64  n installed, and
-00016820: 2068 6f77 2074 6f20 636f 6e66 6967 7572   how to configur
-00016830: 6520 796f 7572 2073 6865 6c6c 2e0a 0a50  e your shell...P
-00016840: 6c65 6173 6520 7265 6665 7220 746f 2074  lease refer to t
-00016850: 6865 205b 506f 6574 7279 2064 6f63 735d  he [Poetry docs]
-00016860: 2868 7474 7073 3a2f 2f70 7974 686f 6e2d  (https://python-
-00016870: 706f 6574 7279 2e6f 7267 2f64 6f63 732f  poetry.org/docs/
-00016880: 2920 666f 7220 6775 6964 616e 6365 206f  ) for guidance o
-00016890: 6e0a 7573 696e 6720 506f 6574 7279 2e0a  n.using Poetry..
-000168a0: 0a23 2323 2053 6574 7570 2066 6f72 2050  .### Setup for P
-000168b0: 7943 6861 726d 2075 7365 7273 0a0a 596f  yCharm users..Yo
-000168c0: 7520 6361 6e20 6561 7369 6c79 206f 6274  u can easily obt
-000168d0: 6169 6e20 7468 6520 7072 6f6a 6563 7420  ain the project 
-000168e0: 6669 6c65 7320 7573 696e 6720 5079 4368  files using PyCh
-000168f0: 6172 6d20 286d 656e 7520 2247 6974 203e  arm (menu "Git >
-00016900: 2043 6c6f 6e65 2e2e 2e22 292e 0a50 7943   Clone...")..PyC
-00016910: 6861 726d 2077 696c 6c20 7468 656e 2075  harm will then u
-00016920: 7375 616c 6c79 2070 726f 6d70 7420 796f  sually prompt yo
-00016930: 7520 746f 206f 7065 6e20 7468 6520 7072  u to open the pr
-00016940: 6f6a 6563 742e 0a0a 4f70 656e 2074 6865  oject...Open the
-00016950: 2070 726f 6a65 6374 2069 6e20 6120 6e65   project in a ne
-00016960: 7720 7769 6e64 6f77 2e20 5079 4368 6172  w window. PyChar
-00016970: 6d20 7769 6c6c 2074 6865 6e20 7573 7561  m will then usua
-00016980: 6c6c 7920 7072 6f6d 7074 2079 6f75 2074  lly prompt you t
-00016990: 6f20 6372 6561 7465 0a61 206e 6577 2076  o create.a new v
-000169a0: 6972 7475 616c 2065 6e76 6972 6f6e 6d65  irtual environme
-000169b0: 6e74 2e0a 0a43 7265 6174 6520 6120 6e65  nt...Create a ne
-000169c0: 7720 506f 6574 7279 2076 6972 7475 616c  w Poetry virtual
-000169d0: 2065 6e76 6972 6f6e 6d65 6e74 2066 6f72   environment for
-000169e0: 2074 6865 2070 726f 6a65 6374 2e20 4966   the project. If
-000169f0: 2050 7943 6861 726d 2064 6f65 736e 2774   PyCharm doesn't
-00016a00: 2061 6c72 6561 6479 0a6b 6e6f 7720 7768   already.know wh
-00016a10: 6572 6520 796f 7572 2060 706f 6574 7279  ere your `poetry
-00016a20: 6020 6578 6563 7574 6162 6c65 2069 732c  ` executable is,
-00016a30: 2074 6865 6e20 7365 7420 7468 6520 7061   then set the pa
-00016a40: 7468 2074 6f20 796f 7572 2060 706f 6574  th to your `poet
-00016a50: 7279 6020 6578 6563 7574 6162 6c65 0a69  ry` executable.i
-00016a60: 6e20 7468 6520 224e 6577 2050 6f65 7472  n the "New Poetr
-00016a70: 7920 456e 7669 726f 6e6d 656e 7422 2066  y Environment" f
-00016a80: 6f72 6d20 696e 7075 7420 6669 656c 6420  orm input field 
-00016a90: 6c61 6265 6c6c 6564 2022 506f 6574 7279  labelled "Poetry
-00016aa0: 2065 7865 6375 7461 626c 6522 2e20 496e   executable". In
-00016ab0: 2074 6865 0a22 4e65 7720 506f 6574 7279   the."New Poetry
-00016ac0: 2045 6e76 6972 6f6e 6d65 6e74 2220 666f   Environment" fo
-00016ad0: 726d 2c20 796f 7520 7769 6c6c 2061 6c73  rm, you will als
-00016ae0: 6f20 6861 7665 2074 6865 206f 7070 6f72  o have the oppor
-00016af0: 7475 6e69 7479 2074 6f20 7365 6c65 6374  tunity to select
-00016b00: 2077 6869 6368 0a50 7974 686f 6e20 6578   which.Python ex
-00016b10: 6563 7574 6162 6c65 2077 696c 6c20 6265  ecutable will be
-00016b20: 2075 7365 6420 6279 2074 6865 2076 6972   used by the vir
-00016b30: 7475 616c 2065 6e76 6972 6f6e 6d65 6e74  tual environment
-00016b40: 2e0a 0a50 7943 6861 726d 2077 696c 6c20  ...PyCharm will 
-00016b50: 7468 656e 2063 7265 6174 6520 6120 6e65  then create a ne
-00016b60: 7720 506f 6574 7279 2076 6972 7475 616c  w Poetry virtual
-00016b70: 2065 6e76 6972 6f6e 6d65 6e74 2066 6f72   environment for
-00016b80: 2079 6f75 7220 7072 6f6a 6563 742c 2075   your project, u
-00016b90: 7369 6e67 0a61 2070 6172 7469 6375 6c61  sing.a particula
-00016ba0: 7220 7665 7273 696f 6e20 6f66 2050 7974  r version of Pyt
-00016bb0: 686f 6e2c 2061 6e64 2061 6c73 6f20 696e  hon, and also in
-00016bc0: 7374 616c 6c20 696e 746f 2074 6869 7320  stall into this 
-00016bd0: 7669 7274 7561 6c20 656e 7669 726f 6e6d  virtual environm
-00016be0: 656e 7420 7468 650a 7072 6f6a 6563 7427  ent the.project'
-00016bf0: 7320 7061 636b 6167 6520 6465 7065 6e64  s package depend
-00016c00: 656e 6369 6573 2061 6363 6f72 6469 6e67  encies according
-00016c10: 2074 6f20 7468 6520 7072 6f6a 6563 7427   to the project'
-00016c20: 7320 6070 6f65 7472 792e 6c6f 636b 6020  s `poetry.lock` 
-00016c30: 6669 6c65 2e0a 0a59 6f75 2063 616e 2061  file...You can a
-00016c40: 6464 2064 6966 6665 7265 6e74 2050 6f65  dd different Poe
-00016c50: 7472 7920 656e 7669 726f 6e6d 656e 7473  try environments
-00016c60: 2066 6f72 2064 6966 6665 7265 6e74 2050   for different P
-00016c70: 7974 686f 6e20 7665 7273 696f 6e73 2c20  ython versions, 
-00016c80: 616e 6420 7377 6974 6368 0a62 6574 7765  and switch.betwe
-00016c90: 656e 2074 6865 6d20 7573 696e 6720 7468  en them using th
-00016ca0: 6520 2250 7974 686f 6e20 496e 7465 7270  e "Python Interp
-00016cb0: 7265 7465 7222 2073 6574 7469 6e67 7320  reter" settings 
-00016cc0: 6f66 2050 7943 6861 726d 2e20 4966 2079  of PyCharm. If y
-00016cd0: 6f75 2077 616e 7420 746f 2075 7365 0a61  ou want to use.a
-00016ce0: 2076 6572 7369 6f6e 206f 6620 5079 7468   version of Pyth
-00016cf0: 6f6e 2074 6861 7420 6973 6e27 7420 696e  on that isn't in
-00016d00: 7374 616c 6c65 642c 2065 6974 6865 7220  stalled, either 
-00016d10: 7573 6520 796f 7572 2066 6176 6f75 7269  use your favouri
-00016d20: 7465 2070 6163 6b61 6765 206d 616e 6167  te package manag
-00016d30: 6572 2c0a 6f72 2069 6e73 7461 6c6c 2050  er,.or install P
-00016d40: 7974 686f 6e20 6279 2064 6f77 6e6c 6f61  ython by downloa
-00016d50: 6469 6e67 2061 6e20 696e 7374 616c 6c65  ding an installe
-00016d60: 7220 666f 7220 7265 6365 6e74 2076 6572  r for recent ver
-00016d70: 7369 6f6e 7320 6f66 2050 7974 686f 6e20  sions of Python 
-00016d80: 6469 7265 6374 6c79 0a66 726f 6d20 7468  directly.from th
-00016d90: 6520 5b50 7974 686f 6e20 7765 6273 6974  e [Python websit
-00016da0: 655d 2868 7474 7073 3a2f 2f77 7777 2e70  e](https://www.p
-00016db0: 7974 686f 6e2e 6f72 672f 646f 776e 6c6f  ython.org/downlo
-00016dc0: 6164 732f 292e 0a0a 4f6e 6365 2070 726f  ads/)...Once pro
-00016dd0: 6a65 6374 2064 6570 656e 6465 6e63 6965  ject dependencie
-00016de0: 7320 6861 7665 2062 6565 6e20 696e 7374  s have been inst
-00016df0: 616c 6c65 642c 2079 6f75 2073 686f 756c  alled, you shoul
-00016e00: 6420 6265 2061 626c 6520 746f 2072 756e  d be able to run
-00016e10: 2074 6573 7473 0a66 726f 6d20 7769 7468   tests.from with
-00016e20: 696e 2050 7943 6861 726d 2028 7269 6768  in PyCharm (righ
-00016e30: 742d 636c 6963 6b20 6f6e 2074 6865 2060  t-click on the `
-00016e40: 7465 7374 7360 2066 6f6c 6465 7220 616e  tests` folder an
-00016e50: 6420 7365 6c65 6374 2074 6865 2027 5275  d select the 'Ru
-00016e60: 6e27 206f 7074 696f 6e29 2e0a 0a42 6563  n' option)...Bec
-00016e70: 6175 7365 206f 6620 6120 636f 6e66 6c69  ause of a confli
-00016e80: 6374 2062 6574 7765 656e 2070 7974 6573  ct between pytes
-00016e90: 7420 616e 6420 5079 4368 6172 6d27 7320  t and PyCharm's 
-00016ea0: 6465 6275 6767 6572 2061 6e64 2074 6865  debugger and the
-00016eb0: 2063 6f76 6572 6167 6520 746f 6f6c 2c0a   coverage tool,.
-00016ec0: 796f 7520 6d61 7920 6e65 6564 2074 6f20  you may need to 
-00016ed0: 6164 6420 6060 2d2d 6e6f 2d63 6f76 6060  add ``--no-cov``
-00016ee0: 2061 7320 616e 206f 7074 696f 6e20 746f   as an option to
-00016ef0: 2074 6865 2074 6573 7420 7275 6e6e 6572   the test runner
-00016f00: 2074 656d 706c 6174 652e 2041 6c74 6572   template. Alter
-00016f10: 6e61 7469 7665 6c79 2c0a 6a75 7374 2075  natively,.just u
-00016f20: 7365 2074 6865 2050 7974 686f 6e20 5374  se the Python St
-00016f30: 616e 6461 7264 204c 6962 7261 7279 2773  andard Library's
-00016f40: 2060 6075 6e69 7474 6573 7460 6020 6d6f   ``unittest`` mo
-00016f50: 6475 6c65 2e0a 0a59 6f75 2073 686f 756c  dule...You shoul
-00016f60: 6420 616c 736f 2062 6520 6162 6c65 2074  d also be able t
-00016f70: 6f20 6f70 656e 2061 2074 6572 6d69 6e61  o open a termina
-00016f80: 6c20 7769 6e64 6f77 2069 6e20 5079 4368  l window in PyCh
-00016f90: 6172 6d2c 2061 6e64 2072 756e 2074 6865  arm, and run the
-00016fa0: 2070 726f 6a65 6374 2773 0a4d 616b 6566   project's.Makef
-00016fb0: 696c 6520 636f 6d6d 616e 6473 2066 726f  ile commands fro
-00016fc0: 6d20 7468 6520 636f 6d6d 616e 6420 6c69  m the command li
-00016fd0: 6e65 2028 7365 6520 6265 6c6f 7729 2e0a  ne (see below)..
-00016fe0: 0a23 2323 2053 6574 7570 2066 726f 6d20  .### Setup from 
-00016ff0: 636f 6d6d 616e 6420 6c69 6e65 0a0a 4f62  command line..Ob
-00017000: 7461 696e 2074 6865 2070 726f 6a65 6374  tain the project
-00017010: 2066 696c 6573 2c20 7573 696e 6720 4769   files, using Gi
-00017020: 7420 6f72 2073 7569 7461 626c 6520 616c  t or suitable al
-00017030: 7465 726e 6174 6976 652e 0a0a 496e 2061  ternative...In a
-00017040: 2074 6572 6d69 6e61 6c20 6170 706c 6963   terminal applic
-00017050: 6174 696f 6e2c 2063 6861 6e67 6520 796f  ation, change yo
-00017060: 7572 2063 7572 7265 6e74 2077 6f72 6b69  ur current worki
-00017070: 6e67 2064 6972 6563 746f 7279 0a74 6f20  ng directory.to 
-00017080: 7468 6520 726f 6f74 2066 6f6c 6465 7220  the root folder 
-00017090: 6f66 2074 6865 2070 726f 6a65 6374 2066  of the project f
-000170a0: 696c 6573 2e20 5468 6572 6520 7368 6f75  iles. There shou
-000170b0: 6c64 2062 6520 6120 4d61 6b65 6669 6c65  ld be a Makefile
-000170c0: 0a69 6e20 7468 6973 2066 6f6c 6465 722e  .in this folder.
-000170d0: 0a0a 5573 6520 7468 6520 4d61 6b65 6669  ..Use the Makefi
-000170e0: 6c65 2074 6f20 6372 6561 7465 2061 206e  le to create a n
-000170f0: 6577 2050 6f65 7472 7920 7669 7274 7561  ew Poetry virtua
-00017100: 6c20 656e 7669 726f 6e6d 656e 7420 666f  l environment fo
-00017110: 7220 7468 650a 7072 6f6a 6563 7420 616e  r the.project an
-00017120: 6420 696e 7374 616c 6c20 7468 6520 7072  d install the pr
-00017130: 6f6a 6563 7427 7320 7061 636b 6167 6520  oject's package 
-00017140: 6465 7065 6e64 656e 6369 6573 2069 6e74  dependencies int
-00017150: 6f20 6974 2c0a 7573 696e 6720 7468 6520  o it,.using the 
-00017160: 666f 6c6c 6f77 696e 6720 636f 6d6d 616e  following comman
-00017170: 642e 0a0a 2020 2020 2420 6d61 6b65 2069  d...    $ make i
-00017180: 6e73 7461 6c6c 2d70 6163 6b61 6765 730a  nstall-packages.
-00017190: 0a49 7427 7320 616c 736f 2070 6f73 7369  .It's also possi
-000171a0: 626c 6520 746f 2061 6c73 6f20 696e 7374  ble to also inst
-000171b0: 616c 6c20 7468 6520 7072 6f6a 6563 7420  all the project 
-000171c0: 696e 2027 6564 6974 6162 6c65 206d 6f64  in 'editable mod
-000171d0: 6527 2e0a 0a20 2020 2024 206d 616b 6520  e'...    $ make 
-000171e0: 696e 7374 616c 6c0a 0a50 6c65 6173 6520  install..Please 
-000171f0: 6e6f 7465 2c20 6966 2079 6f75 2063 7265  note, if you cre
-00017200: 6174 6520 7468 6520 7669 7274 7561 6c20  ate the virtual 
-00017210: 656e 7669 726f 6e6d 656e 7420 696e 2074  environment in t
-00017220: 6869 7320 7761 792c 2061 6e64 2074 6865  his way, and the
-00017230: 6e20 7472 7920 746f 0a6f 7065 6e20 7468  n try to.open th
-00017240: 6520 7072 6f6a 6563 7420 696e 2050 7943  e project in PyC
-00017250: 6861 726d 2061 6e64 2063 6f6e 6669 6775  harm and configu
-00017260: 7265 2074 6865 2070 726f 6a65 6374 2074  re the project t
-00017270: 6f20 7573 6520 7468 6973 2076 6972 7475  o use this virtu
-00017280: 616c 0a65 6e76 6972 6f6e 6d65 6e74 2061  al.environment a
-00017290: 7320 616e 2022 4578 6973 7469 6e67 2050  s an "Existing P
-000172a0: 6f65 7472 7920 456e 7669 726f 6e6d 656e  oetry Environmen
-000172b0: 7422 2c20 5079 4368 6172 6d20 736f 6d65  t", PyCharm some
-000172c0: 7469 6d65 7320 6861 7320 736f 6d65 0a69  times has some.i
-000172d0: 7373 7565 7320 2864 6f6e 2774 206b 6e6f  ssues (don't kno
-000172e0: 7720 7768 7929 2077 6869 6368 206d 6967  w why) which mig
-000172f0: 6874 2062 6520 7072 6f62 6c65 6d61 7469  ht be problemati
-00017300: 632e 2049 6620 796f 7520 656e 636f 756e  c. If you encoun
-00017310: 7465 7220 7375 6368 0a69 7373 7565 732c  ter such.issues,
-00017320: 2079 6f75 2063 616e 2072 6573 6f6c 7665   you can resolve
-00017330: 2074 6865 7365 2069 7373 7565 7320 6279   these issues by
-00017340: 2064 656c 6574 696e 6720 7468 6520 7669   deleting the vi
-00017350: 7274 7561 6c20 656e 7669 726f 6e6d 656e  rtual environmen
-00017360: 740a 616e 6420 6372 6561 7469 6e67 2074  t.and creating t
-00017370: 6865 2050 6f65 7472 7920 7669 7274 7561  he Poetry virtua
-00017380: 6c20 656e 7669 726f 6e6d 656e 7420 7573  l environment us
-00017390: 696e 6720 5079 4368 6172 6d20 2873 6565  ing PyCharm (see
-000173a0: 2061 626f 7665 292e 0a0a 2323 2320 5072   above)...### Pr
-000173b0: 6f6a 6563 7420 4d61 6b65 6669 6c65 2063  oject Makefile c
-000173c0: 6f6d 6d61 6e64 730a 0a59 6f75 2063 616e  ommands..You can
-000173d0: 2073 7461 7274 2045 7665 6e74 5374 6f72   start EventStor
-000173e0: 6544 4220 7573 696e 6720 7468 6520 666f  eDB using the fo
-000173f0: 6c6c 6f77 696e 6720 636f 6d6d 616e 642e  llowing command.
-00017400: 0a0a 2020 2020 2420 6d61 6b65 2073 7461  ..    $ make sta
-00017410: 7274 2d65 7665 6e74 7374 6f72 6564 620a  rt-eventstoredb.
-00017420: 0a59 6f75 2063 616e 2072 756e 2074 6573  .You can run tes
-00017430: 7473 2075 7369 6e67 2074 6865 2066 6f6c  ts using the fol
-00017440: 6c6f 7769 6e67 2063 6f6d 6d61 6e64 2028  lowing command (
-00017450: 6e65 6564 7320 4576 656e 7453 746f 7265  needs EventStore
-00017460: 4442 2074 6f20 6265 2072 756e 6e69 6e67  DB to be running
-00017470: 292e 0a0a 2020 2020 2420 6d61 6b65 2074  )...    $ make t
-00017480: 6573 740a 0a59 6f75 2063 616e 2073 746f  est..You can sto
-00017490: 7020 4576 656e 7453 746f 7265 4442 2075  p EventStoreDB u
-000174a0: 7369 6e67 2074 6865 2066 6f6c 6c6f 7769  sing the followi
-000174b0: 6e67 2063 6f6d 6d61 6e64 2e0a 0a20 2020  ng command...   
-000174c0: 2024 206d 616b 6520 7374 6f70 2d65 7665   $ make stop-eve
-000174d0: 6e74 7374 6f72 6564 620a 0a59 6f75 2063  ntstoredb..You c
-000174e0: 616e 2063 6865 636b 2074 6865 2066 6f72  an check the for
-000174f0: 6d61 7474 696e 6720 6f66 2074 6865 2063  matting of the c
-00017500: 6f64 6520 7573 696e 6720 7468 6520 666f  ode using the fo
-00017510: 6c6c 6f77 696e 6720 636f 6d6d 616e 642e  llowing command.
-00017520: 0a0a 2020 2020 2420 6d61 6b65 206c 696e  ..    $ make lin
-00017530: 740a 0a59 6f75 2063 616e 2072 6566 6f72  t..You can refor
-00017540: 6d61 7420 7468 6520 636f 6465 2075 7369  mat the code usi
-00017550: 6e67 2074 6865 2066 6f6c 6c6f 7769 6e67  ng the following
-00017560: 2063 6f6d 6d61 6e64 2e0a 0a20 2020 2024   command...    $
-00017570: 206d 616b 6520 666d 740a 0a54 6573 7473   make fmt..Tests
-00017580: 2062 656c 6f6e 6720 696e 2060 2e2f 7465   belong in `./te
-00017590: 7374 7360 2e20 436f 6465 2d75 6e64 6572  sts`. Code-under
-000175a0: 2d74 6573 7420 6265 6c6f 6e67 7320 696e  -test belongs in
-000175b0: 2060 2e2f 6573 6462 636c 6965 6e74 602e   `./esdbclient`.
-000175c0: 0a0a 4564 6974 2070 6163 6b61 6765 2064  ..Edit package d
-000175d0: 6570 656e 6465 6e63 6965 7320 696e 2060  ependencies in `
-000175e0: 7079 7072 6f6a 6563 742e 746f 6d6c 602e  pyproject.toml`.
-000175f0: 2055 7064 6174 6520 696e 7374 616c 6c65   Update installe
-00017600: 6420 7061 636b 6167 6573 2028 616e 6420  d packages (and 
-00017610: 7468 650a 6070 6f65 7472 792e 6c6f 636b  the.`poetry.lock
-00017620: 6020 6669 6c65 2920 7573 696e 6720 7468  ` file) using th
-00017630: 6520 666f 6c6c 6f77 696e 6720 636f 6d6d  e following comm
-00017640: 616e 642e 0a0a 2020 2020 2420 6d61 6b65  and...    $ make
-00017650: 2075 7064 6174 652d 7061 636b 6167 6573   update-packages
-00017660: 0a0a                                     ..
+000139f0: 2020 7365 6c66 2e61 6674 6572 5f6e 6163    self.after_nac
+00013a00: 6b28 6576 656e 742c 2061 6374 696f 6e29  k(event, action)
+00013a10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00013a20: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00013a30: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00013a40: 7375 6273 6372 6970 7469 6f6e 2e61 636b  subscription.ack
+00013a50: 2865 7665 6e74 2e69 6429 0a20 2020 2020  (event.id).     
+00013a60: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00013a70: 656c 662e 6166 7465 725f 6163 6b28 6576  elf.after_ack(ev
+00013a80: 656e 7429 0a20 2020 2020 2020 2065 7863  ent).        exc
+00013a90: 6570 7420 4578 6365 7074 696f 6e3a 0a20  ept Exception:. 
+00013aa0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00013ab0: 7375 6273 6372 6970 7469 6f6e 2e73 746f  subscription.sto
+00013ac0: 7028 290a 2020 2020 2020 2020 2020 2020  p().            
+00013ad0: 7261 6973 650a 0a20 2020 2064 6566 2073  raise..    def s
+00013ae0: 746f 7028 7365 6c66 293a 0a20 2020 2020  top(self):.     
+00013af0: 2020 2073 656c 662e 7375 6273 6372 6970     self.subscrip
+00013b00: 7469 6f6e 2e73 746f 7028 290a 0a20 2020  tion.stop()..   
+00013b10: 2064 6566 2070 6f6c 6963 7928 7365 6c66   def policy(self
+00013b20: 2c20 6576 656e 7429 3a0a 2020 2020 2020  , event):.      
+00013b30: 2020 2320 5261 6973 6520 616e 2065 7863    # Raise an exc
+00013b40: 6570 7469 6f6e 2077 6865 6e20 7765 2073  eption when we s
+00013b50: 6565 2022 6576 656e 7435 222e 0a20 2020  ee "event5"..   
+00013b60: 2020 2020 2069 6620 6576 656e 742e 6964       if event.id
+00013b70: 203d 3d20 6576 656e 7435 2e69 643a 0a20   == event5.id:. 
+00013b80: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00013b90: 2045 7863 6570 7469 6f6e 2829 0a0a 2020   Exception()..  
+00013ba0: 2020 6465 6620 6166 7465 725f 6163 6b28    def after_ack(
+00013bb0: 7365 6c66 2c20 6576 656e 7429 3a0a 2020  self, event):.  
+00013bc0: 2020 2020 2020 2320 5472 6163 6b20 7265        # Track re
+00013bd0: 7472 7920 636f 756e 7420 6f66 2061 636b  try count of ack
+00013be0: 6564 2065 7665 6e74 732e 0a20 2020 2020  ed events..     
+00013bf0: 2020 2061 636b 6564 5f65 7665 6e74 735b     acked_events[
+00013c00: 6576 656e 742e 6964 5d20 3d20 6576 656e  event.id] = even
+00013c10: 742e 7265 7472 795f 636f 756e 740a 0a20  t.retry_count.. 
+00013c20: 2020 2064 6566 2061 6674 6572 5f6e 6163     def after_nac
+00013c30: 6b28 7365 6c66 2c20 6576 656e 742c 2061  k(self, event, a
+00013c40: 6374 696f 6e29 3a0a 2020 2020 2020 2020  ction):.        
+00013c50: 2320 5472 6163 6b20 7265 7472 7920 636f  # Track retry co
+00013c60: 756e 7420 6f66 206e 6163 6b65 6420 6576  unt of nacked ev
+00013c70: 656e 7473 2e0a 2020 2020 2020 2020 6e61  ents..        na
+00013c80: 636b 6564 5f65 7665 6e74 735b 6576 656e  cked_events[even
+00013c90: 742e 6964 5d20 3d20 6576 656e 742e 7265  t.id] = event.re
+00013ca0: 7472 795f 636f 756e 740a 0a20 2020 2020  try_count..     
+00013cb0: 2020 2069 6620 6163 7469 6f6e 203d 3d20     if action == 
+00013cc0: 7365 6c66 2e66 696e 616c 5f61 6374 696f  self.final_actio
+00013cd0: 6e3a 0a20 2020 2020 2020 2020 2020 2023  n:.            #
+00013ce0: 2053 746f 7020 7468 6520 636f 6e73 756d   Stop the consum
+00013cf0: 6572 2c20 736f 2077 6520 6361 6e20 636f  er, so we can co
+00013d00: 6e74 696e 7565 2077 6974 6820 7468 6520  ntinue with the 
+00013d10: 6578 616d 706c 6573 2e0a 2020 2020 2020  examples..      
+00013d20: 2020 2020 2020 7365 6c66 2e73 746f 7028        self.stop(
+00013d30: 290a 0a0a 2320 4372 6561 7465 2073 7562  )...# Create sub
+00013d40: 7363 7269 7074 696f 6e2e 0a67 726f 7570  scription..group
+00013d50: 5f6e 616d 6520 3d20 6622 6772 6f75 702d  _name = f"group-
+00013d60: 7b75 7569 6434 2829 7d22 0a63 6c69 656e  {uuid4()}".clien
+00013d70: 742e 6372 6561 7465 5f73 7562 7363 7269  t.create_subscri
+00013d80: 7074 696f 6e28 6772 6f75 705f 6e61 6d65  ption(group_name
+00013d90: 2c20 636f 6d6d 6974 5f70 6f73 6974 696f  , commit_positio
+00013da0: 6e3d 636f 6d6d 6974 5f70 6f73 6974 696f  n=commit_positio
+00013db0: 6e31 290a 0a23 2052 6561 6420 7375 6273  n1)..# Read subs
+00013dc0: 6372 6970 7469 6f6e 2e0a 7375 6273 6372  cription..subscr
+00013dd0: 6970 7469 6f6e 203d 2063 6c69 656e 742e  iption = client.
+00013de0: 7265 6164 5f73 7562 7363 7269 7074 696f  read_subscriptio
+00013df0: 6e28 6772 6f75 705f 6e61 6d65 290a 0a23  n(group_name)..#
+00013e00: 2043 6f6e 7374 7275 6374 2063 6f6e 7375   Construct consu
+00013e10: 6d65 722e 0a63 6f6e 7375 6d65 7220 3d20  mer..consumer = 
+00013e20: 4578 616d 706c 6543 6f6e 7375 6d65 7228  ExampleConsumer(
+00013e30: 0a20 2020 2073 7562 7363 7269 7074 696f  .    subscriptio
+00013e40: 6e3d 7375 6273 6372 6970 7469 6f6e 2c0a  n=subscription,.
+00013e50: 2020 2020 6d61 785f 7265 7472 6965 733d      max_retries=
+00013e60: 352c 0a20 2020 2066 696e 616c 5f61 6374  5,.    final_act
+00013e70: 696f 6e3d 2270 6172 6b22 2c0a 290a 0a23  ion="park",.)..#
+00013e80: 2052 756e 2063 6f6e 7375 6d65 722e 0a63   Run consumer..c
+00013e90: 6f6e 7375 6d65 722e 7275 6e28 290a 0a23  onsumer.run()..#
+00013ea0: 2043 6865 636b 2027 6576 656e 7431 3127   Check 'event11'
+00013eb0: 2077 6173 2061 636b 6564 2061 6e64 206e   was acked and n
+00013ec0: 6576 6572 2072 6574 7269 6564 2e0a 6173  ever retried..as
+00013ed0: 7365 7274 2061 636b 6564 5f65 7665 6e74  sert acked_event
+00013ee0: 735b 6576 656e 7431 312e 6964 5d20 3d3d  s[event11.id] ==
+00013ef0: 2030 0a61 7373 6572 7420 6576 656e 7431   0.assert event1
+00013f00: 312e 6964 206e 6f74 2069 6e20 6e61 636b  1.id not in nack
+00013f10: 6564 5f65 7665 6e74 730a 0a23 2043 6865  ed_events..# Che
+00013f20: 636b 2027 6576 656e 7435 2720 7761 7320  ck 'event5' was 
+00013f30: 7265 7472 6965 6420 6669 7665 2074 696d  retried five tim
+00013f40: 6573 2061 6e64 206e 6576 6572 2061 636b  es and never ack
+00013f50: 6564 2e0a 6173 7365 7274 206e 6163 6b65  ed..assert nacke
+00013f60: 645f 6576 656e 7473 5b65 7665 6e74 352e  d_events[event5.
+00013f70: 6964 5d20 3d3d 2035 0a61 7373 6572 7420  id] == 5.assert 
+00013f80: 6576 656e 7435 2e69 6420 6e6f 7420 696e  event5.id not in
+00013f90: 2061 636b 6564 5f65 7665 6e74 730a 6060   acked_events.``
+00013fa0: 600a 0a23 2320 436f 6e6e 6563 7469 6f6e  `..## Connection
+00013fb0: 0a0a 2323 2320 5265 636f 6e6e 6563 740a  ..### Reconnect.
+00013fc0: 0a54 6865 2060 7265 636f 6e6e 6563 7428  .The `reconnect(
+00013fd0: 2960 206d 6574 686f 6420 6361 6e20 6265  )` method can be
+00013fe0: 2075 7365 6420 746f 206d 616e 7561 6c6c   used to manuall
+00013ff0: 7920 7265 636f 6e6e 6563 7420 7468 6520  y reconnect the 
+00014000: 636c 6965 6e74 2074 6f20 610a 7375 6974  client to a.suit
+00014010: 6162 6c65 2045 7665 6e74 5374 6f72 6544  able EventStoreD
+00014020: 4220 6e6f 6465 2e20 5468 6973 206d 6574  B node. This met
+00014030: 686f 6420 7573 6573 2074 6865 2073 616d  hod uses the sam
+00014040: 6520 726f 7574 696e 6520 666f 7220 7265  e routine for re
+00014050: 6164 696e 6720 7468 650a 636c 7573 7465  ading the.cluste
+00014060: 7220 6e6f 6465 2073 7461 7465 7320 616e  r node states an
+00014070: 6420 7468 656e 2063 6f6e 6e65 6374 696e  d then connectin
+00014080: 6720 746f 2061 2073 7569 7461 626c 6520  g to a suitable 
+00014090: 6e6f 6465 2061 6363 6f72 6469 6e67 2074  node according t
+000140a0: 6f20 7468 650a 636c 6965 6e74 2773 206e  o the.client's n
+000140b0: 6f64 6520 7072 6566 6572 656e 6365 2074  ode preference t
+000140c0: 6861 7420 6973 2073 7065 6369 6669 6564  hat is specified
+000140d0: 2069 6e20 7468 6520 636f 6e6e 6563 7469   in the connecti
+000140e0: 6f6e 2073 7472 696e 6720 5552 4920 7768  on string URI wh
+000140f0: 656e 0a74 6865 2063 6c69 656e 7420 6973  en.the client is
+00014100: 2063 6f6e 7374 7275 6374 6564 2e20 5468   constructed. Th
+00014110: 6973 206d 6574 686f 6420 6973 2074 6872  is method is thr
+00014120: 6561 642d 7361 6665 2c20 616e 6420 6974  ead-safe, and it
+00014130: 2069 7320 2263 6f6e 7365 7276 6174 6976   is "conservativ
+00014140: 6522 0a69 6e20 7468 6174 2c20 7768 656e  e".in that, when
+00014150: 2069 7420 6973 2063 616c 6c65 6420 6279   it is called by
+00014160: 2073 6576 6572 616c 2074 6872 6561 6473   several threads
+00014170: 2061 7420 7468 6520 7361 6d65 2074 696d   at the same tim
+00014180: 652c 206f 6e6c 7920 6f6e 650a 7265 636f  e, only one.reco
+00014190: 6e6e 6563 7469 6f6e 2077 696c 6c20 6f63  nnection will oc
+000141a0: 6375 722e 2043 6f6e 6375 7272 656e 7420  cur. Concurrent 
+000141b0: 6174 7465 6d70 7473 2074 6f20 7265 636f  attempts to reco
+000141c0: 6e6e 6563 7420 7769 6c6c 2062 6c6f 636b  nnect will block
+000141d0: 2075 6e74 696c 0a74 6865 2063 6c69 656e   until.the clien
+000141e0: 7420 6861 7320 7265 636f 6e6e 6563 7465  t has reconnecte
+000141f0: 6420 7375 6363 6573 7366 756c 6c79 2c20  d successfully, 
+00014200: 616e 6420 7468 656e 2074 6865 7920 7769  and then they wi
+00014210: 6c6c 2061 6c6c 2072 6574 7572 6e20 6e6f  ll all return no
+00014220: 726d 616c 6c79 2e0a 0a60 6060 7079 7468  rmally...```pyth
+00014230: 6f6e 0a63 6c69 656e 742e 7265 636f 6e6e  on.client.reconn
+00014240: 6563 7428 290a 6060 600a 0a41 6e20 6578  ect().```..An ex
+00014250: 616d 706c 6520 6f66 2077 6865 6e20 6974  ample of when it
+00014260: 206d 6967 6874 2062 6520 6465 7369 7261   might be desira
+00014270: 626c 6520 746f 2072 6563 6f6e 6e65 6374  ble to reconnect
+00014280: 206d 616e 7561 6c6c 7920 6973 2077 6865   manually is whe
+00014290: 6e20 2866 6f72 2070 6572 666f 726d 616e  n (for performan
+000142a0: 6365 0a72 6561 736f 6e73 2920 7468 6520  ce.reasons) the 
+000142b0: 636c 6965 6e74 2773 206e 6f64 6520 7072  client's node pr
+000142c0: 6566 6572 656e 6365 2069 7320 746f 2062  eference is to b
+000142d0: 6520 636f 6e6e 6563 7465 6420 746f 2061  e connected to a
+000142e0: 2066 6f6c 6c6f 7765 7220 6e6f 6465 2069   follower node i
+000142f0: 6e20 7468 650a 636c 7573 7465 722c 2061  n the.cluster, a
+00014300: 6e64 2c20 6166 7465 7220 6120 636c 7573  nd, after a clus
+00014310: 7465 7220 6c65 6164 6572 2065 6c65 6374  ter leader elect
+00014320: 696f 6e2c 2074 6865 2066 6f6c 6c6f 7765  ion, the followe
+00014330: 7220 6265 636f 6d65 7320 7468 6520 6c65  r becomes the le
+00014340: 6164 6572 2e0a 5265 636f 6e6e 6563 7469  ader..Reconnecti
+00014350: 6e67 2074 6f20 6120 666f 6c6c 6f77 6572  ng to a follower
+00014360: 206e 6f64 6520 696e 2074 6869 7320 6361   node in this ca
+00014370: 7365 2069 7320 6375 7272 656e 746c 7920  se is currently 
+00014380: 6265 796f 6e64 2074 6865 2063 6170 6162  beyond the capab
+00014390: 696c 6974 6965 7320 6f66 0a74 6869 7320  ilities of.this 
+000143a0: 636c 6965 6e74 2c20 6275 7420 7468 6973  client, but this
+000143b0: 2062 6568 6176 696f 7220 6d69 6768 7420   behavior might 
+000143c0: 6265 2069 6d70 6c65 6d65 6e74 6564 2069  be implemented i
+000143d0: 6e20 6120 6675 7475 7265 2072 656c 6561  n a future relea
+000143e0: 7365 2e0a 0a50 6c65 6173 6520 6e6f 7465  se...Please note
+000143f0: 2c20 6e65 6172 6c79 2061 6c6c 2074 6865  , nearly all the
+00014400: 2063 6c69 656e 7420 6d65 7468 6f64 7320   client methods 
+00014410: 6172 6520 6465 636f 7261 7465 6420 7769  are decorated wi
+00014420: 7468 2060 4061 7574 6f72 6563 6f6e 6e65  th `@autoreconne
+00014430: 6374 6020 2877 6869 6368 0a63 616c 6c73  ct` (which.calls
+00014440: 2074 6865 2060 7265 636f 6e6e 6563 7428   the `reconnect(
+00014450: 2960 206d 6574 686f 6420 7768 656e 2074  )` method when t
+00014460: 6865 2063 6c69 656e 7420 6465 7465 6374  he client detect
+00014470: 7320 7468 6174 2072 6563 6f6e 6e65 6374  s that reconnect
+00014480: 696e 6720 6973 2072 6571 7569 7265 6429  ing is required)
+00014490: 0a61 6e64 2061 2060 4072 6574 7279 6020  .and a `@retry` 
+000144a0: 6465 636f 7261 746f 7220 7468 6174 206d  decorator that m
+000144b0: 6f72 6520 6765 6e65 7261 6c6c 7920 7769  ore generally wi
+000144c0: 6c6c 2072 6574 7279 206f 7065 7261 7469  ll retry operati
+000144d0: 6f6e 7320 7468 6174 2066 6169 6c20 6475  ons that fail du
+000144e0: 6520 746f 0a63 6f6e 6e65 6374 696f 6e20  e to.connection 
+000144f0: 6973 7375 6573 2e0a 0a54 6865 2060 4061  issues...The `@a
+00014500: 7574 6f72 6563 6f6e 6e65 6374 6020 6465  utoreconnect` de
+00014510: 636f 7261 746f 7220 7769 6c6c 2072 6563  corator will rec
+00014520: 6f6e 6e65 6374 2074 6f20 6120 7375 6974  onnect to a suit
+00014530: 6162 6c65 206e 6f64 6520 696e 2074 6865  able node in the
+00014540: 2063 6c75 7374 6572 2077 6865 6e0a 7468   cluster when.th
+00014550: 6520 7365 7276 6572 2074 6f20 7768 6963  e server to whic
+00014560: 6820 7468 6520 636c 6965 6e74 2068 6173  h the client has
+00014570: 2062 6565 6e20 636f 6e6e 6563 7465 6420   been connected 
+00014580: 6861 7320 6265 636f 6d65 2075 6e61 7661  has become unava
+00014590: 696c 6162 6c65 2c20 6f72 2077 6865 6e20  ilable, or when 
+000145a0: 7468 650a 636c 6965 6e74 2773 2067 5250  the.client's gRP
+000145b0: 4320 6368 616e 6e65 6c20 6861 7070 656e  C channel happen
+000145c0: 7320 746f 2068 6176 6520 6265 656e 2063  s to have been c
+000145d0: 6c6f 7365 642e 2054 6865 2063 6c69 656e  losed. The clien
+000145e0: 7420 7769 6c6c 2061 6c73 6f20 7265 636f  t will also reco
+000145f0: 6e6e 6563 7420 7768 656e 0a61 206d 6574  nnect when.a met
+00014600: 686f 6420 6973 2063 616c 6c65 6420 7468  hod is called th
+00014610: 6174 2072 6571 7569 7265 7320 6120 6c65  at requires a le
+00014620: 6164 6572 2c20 616e 6420 7468 6520 636c  ader, and the cl
+00014630: 6965 6e74 2773 206e 6f64 6520 7072 6566  ient's node pref
+00014640: 6572 656e 6365 2069 7320 746f 2062 650a  erence is to be.
+00014650: 636f 6e6e 6563 7465 6420 746f 2061 206c  connected to a l
+00014660: 6561 6465 722c 2062 7574 2074 6865 206e  eader, but the n
+00014670: 6f64 6520 7468 6174 2074 6865 2063 6c69  ode that the cli
+00014680: 656e 7420 6861 7320 6265 656e 2063 6f6e  ent has been con
+00014690: 6e65 6374 6564 2074 6f20 7374 6f70 7320  nected to stops 
+000146a0: 6265 696e 670a 7468 6520 6c65 6164 6572  being.the leader
+000146b0: 2e20 496e 2074 6869 7320 6361 7365 2c20  . In this case, 
+000146c0: 7468 6520 636c 6965 6e74 2077 696c 6c20  the client will 
+000146d0: 7265 636f 6e6e 6563 7420 746f 2074 6865  reconnect to the
+000146e0: 2063 7572 7265 6e74 206c 6561 6465 722e   current leader.
+000146f0: 2041 6674 6572 0a72 6563 6f6e 6e65 6374   After.reconnect
+00014700: 696e 672c 2074 6865 2066 6169 6c65 6420  ing, the failed 
+00014710: 6f70 6572 6174 696f 6e20 7769 6c6c 2062  operation will b
+00014720: 6520 7265 7472 6965 642e 0a0a 5468 6520  e retried...The 
+00014730: 6040 7265 7472 7960 2064 6563 6f72 6174  `@retry` decorat
+00014740: 6f72 2072 6574 7269 6573 206f 7065 7261  or retries opera
+00014750: 7469 6f6e 7320 7468 6174 2068 6176 6520  tions that have 
+00014760: 6661 696c 6564 2064 7565 2074 6f20 6d6f  failed due to mo
+00014770: 7265 2067 656e 6572 616c 0a63 6f6e 6e65  re general.conne
+00014780: 6374 696f 6e20 6973 7375 6573 2c20 7375  ction issues, su
+00014790: 6368 2061 7320 6120 6465 6164 6c69 6e65  ch as a deadline
+000147a0: 2062 6569 6e67 2072 6561 6368 6564 2028   being reached (
+000147b0: 736f 2074 6861 7420 7468 6520 6f70 6572  so that the oper
+000147c0: 6174 696f 6e20 7469 6d65 730a 6f75 7429  ation times.out)
+000147d0: 2c20 6f72 2069 6e20 6361 7365 2074 6865  , or in case the
+000147e0: 2073 6572 7665 7220 7468 726f 7773 2061   server throws a
+000147f0: 6e20 6578 6365 7074 696f 6e20 7768 656e  n exception when
+00014800: 2068 616e 646c 696e 6720 6120 636c 6965   handling a clie
+00014810: 6e74 2072 6571 7565 7374 2e0a 0a50 6c65  nt request...Ple
+00014820: 6173 6520 616c 736f 206e 6f74 652c 2074  ase also note, t
+00014830: 6865 2061 7370 6563 7473 206e 6f74 2063  he aspects not c
+00014840: 6f76 6572 6564 2062 7920 7468 6520 7265  overed by the re
+00014850: 636f 6e6e 6563 7420 616e 6420 7265 7472  connect and retr
+00014860: 7920 6465 636f 7261 746f 720a 6265 6861  y decorator.beha
+00014870: 7669 6f75 7273 2068 6176 6520 746f 2064  viours have to d
+00014880: 6f20 7769 7468 206d 6574 686f 6473 2074  o with methods t
+00014890: 6861 7420 7265 7475 726e 2069 7465 7261  hat return itera
+000148a0: 746f 7273 2e20 466f 7220 6578 616d 706c  tors. For exampl
+000148b0: 652c 2063 6f6e 7369 6465 720a 7468 6520  e, consider.the 
+000148c0: 6072 6561 645f 616c 6c5f 6576 656e 7473  `read_all_events
+000148d0: 2829 6020 6d65 7468 6f64 2c20 7768 6963  ()` method, whic
+000148e0: 6820 7265 7475 726e 7320 616e 2069 7465  h returns an ite
+000148f0: 7261 746f 7220 6f66 2060 5265 636f 7264  rator of `Record
+00014900: 6564 4576 656e 7460 206f 626a 6563 7473  edEvent` objects
+00014910: 2e0a 5468 6520 6d65 7468 6f64 2068 6173  ..The method has
+00014920: 2072 6574 7572 6e65 6420 616e 6420 7468   returned and th
+00014930: 6520 6d65 7468 6f64 2064 6563 6f72 6174  e method decorat
+00014940: 6f72 7320 6861 7665 2074 6865 7265 666f  ors have therefo
+00014950: 7265 2065 7869 7465 6420 6265 666f 7265  re exited before
+00014960: 2074 6865 0a69 7465 7261 7469 6e67 206f   the.iterating o
+00014970: 6620 7468 6520 7265 7370 6f6e 7365 2062  f the response b
+00014980: 6567 696e 732e 2054 6865 7265 666f 7265  egins. Therefore
+00014990: 2c20 6974 2069 736e 2774 2070 6f73 7369  , it isn't possi
+000149a0: 626c 6520 666f 7220 7468 6973 206d 6574  ble for this met
+000149b0: 686f 6420 746f 0a74 7269 6767 6572 2061  hod to.trigger a
+000149c0: 2072 6563 6f6e 6e65 6374 696f 6e20 6f72   reconnection or
+000149d0: 2066 6f72 2069 7420 746f 2072 6574 7279   for it to retry
+000149e0: 2c20 7768 656e 2074 6865 2073 7472 6561  , when the strea
+000149f0: 6d69 6e67 2072 6573 706f 6e73 6520 736f  ming response so
+00014a00: 6d65 686f 7720 6661 696c 732e 0a0a 416e  mehow fails...An
+00014a10: 6f74 6865 7220 6578 616d 706c 6520 6973  other example is
+00014a20: 2074 6865 2022 6361 7463 682d 7570 2220   the "catch-up" 
+00014a30: 616e 6420 7065 7273 6973 7465 6e74 2073  and persistent s
+00014a40: 7562 7363 7269 7074 696f 6e20 7265 6164  ubscription read
+00014a50: 206d 6574 686f 6473 2c20 616c 7468 6f75   methods, althou
+00014a60: 6768 0a77 6974 6820 7468 6573 6520 6d65  gh.with these me
+00014a70: 7468 6f64 7320 7468 6572 6520 6973 2061  thods there is a
+00014a80: 6e20 696e 6974 6961 6c20 2263 6f6e 6669  n initial "confi
+00014a90: 726d 6174 696f 6e22 2072 6573 706f 6e73  rmation" respons
+00014aa0: 6520 6672 6f6d 2074 6865 2073 6572 7665  e from the serve
+00014ab0: 7220 7768 6963 680a 6973 2072 6563 6569  r which.is recei
+00014ac0: 7665 6420 616e 6420 6368 6563 6b65 6420  ved and checked 
+00014ad0: 6279 2074 6865 2063 6c69 656e 7420 6265  by the client be
+00014ae0: 666f 7265 2074 6865 206d 6574 686f 6420  fore the method 
+00014af0: 7265 7475 726e 732c 2073 6f20 6966 2074  returns, so if t
+00014b00: 6865 2073 6572 7665 7220 6973 0a75 6e61  he server is.una
+00014b10: 7661 696c 6162 6c65 2077 6865 6e20 7468  vailable when th
+00014b20: 6520 6361 6c6c 2069 7320 6d61 6465 2c20  e call is made, 
+00014b30: 6f72 2069 6620 7468 6520 6368 616e 6e65  or if the channe
+00014b40: 6c20 6973 2073 6f6d 6568 6f77 2063 6c6f  l is somehow clo
+00014b50: 7365 642c 206f 7220 6966 2074 6865 0a73  sed, or if the.s
+00014b60: 6572 7665 7220 7468 726f 7773 2061 6e20  erver throws an 
+00014b70: 6572 726f 7220 666f 7220 736f 6d65 2072  error for some r
+00014b80: 6561 736f 6e2c 2074 6865 6e20 7468 6520  eason, then the 
+00014b90: 636c 6965 6e74 2077 696c 6c20 6569 7468  client will eith
+00014ba0: 6572 2072 6563 6f6e 6e65 6374 2061 6e64  er reconnect and
+00014bb0: 0a72 6574 7279 2c20 6f72 206d 6f72 6520  .retry, or more 
+00014bc0: 7369 6d70 6c79 206a 7573 7420 7265 7472  simply just retr
+00014bd0: 7920 7468 6520 6f70 6572 6174 696f 6e2c  y the operation,
+00014be0: 2061 6363 6f72 6469 6e67 2074 6865 2074   according the t
+00014bf0: 7970 6520 6f66 2065 7272 6f72 2074 6861  ype of error tha
+00014c00: 740a 7761 7320 656e 636f 756e 7465 7265  t.was encountere
+00014c10: 642e 2048 6f77 6576 6572 2c20 616e 2065  d. However, an e
+00014c20: 7665 6e74 2d70 726f 6365 7373 696e 6720  vent-processing 
+00014c30: 636f 6d70 6f6e 656e 7420 7468 6174 2069  component that i
+00014c40: 7465 7261 7465 7320 6f76 6572 2061 0a73  terates over a.s
+00014c50: 7563 6365 7373 6675 6c6c 7920 7265 7475  uccessfully retu
+00014c60: 726e 6564 2022 6361 7463 682d 7570 2220  rned "catch-up" 
+00014c70: 7375 6273 6372 6970 7469 6f6e 2072 6573  subscription res
+00014c80: 706f 6e73 6520 7769 6c6c 206e 6565 6420  ponse will need 
+00014c90: 746f 2062 6520 6d6f 6e69 746f 7265 6420  to be monitored 
+00014ca0: 666f 720a 6572 726f 7273 2c20 616e 642c  for.errors, and,
+00014cb0: 2069 6620 6974 2066 6169 6c73 2061 6674   if it fails aft
+00014cc0: 6572 2069 7420 6861 7320 7374 6172 7465  er it has starte
+00014cd0: 6420 6974 6572 6174 696e 6720 6f76 6572  d iterating over
+00014ce0: 2074 6865 2072 6573 706f 6e73 652c 2074   the response, t
+00014cf0: 6865 2063 6174 6368 2d75 700a 7375 6273  he catch-up.subs
+00014d00: 6372 6970 7469 6f6e 2077 696c 6c20 6e65  cription will ne
+00014d10: 6564 2074 6f20 6265 2072 6573 7461 7274  ed to be restart
+00014d20: 6564 2066 726f 6d20 7468 6520 6576 656e  ed from the even
+00014d30: 742d 7072 6f63 6573 7369 6e67 2063 6f6d  t-processing com
+00014d40: 706f 6e65 6e74 2773 2022 6c61 7374 0a73  ponent's "last.s
+00014d50: 6176 6564 2063 6f6d 6d69 7420 706f 7369  aved commit posi
+00014d60: 7469 6f6e 222e 2049 6620 7468 6520 6576  tion". If the ev
+00014d70: 656e 742d 7072 6f63 6573 7369 6e67 2063  ent-processing c
+00014d80: 6f6d 706f 6e65 6e74 2069 7320 7265 636f  omponent is reco
+00014d90: 7264 696e 6720 7468 6520 636f 6d6d 6974  rding the commit
+00014da0: 0a70 6f73 6974 696f 6e20 6f66 2065 6163  .position of eac
+00014db0: 6820 7265 636f 7264 6564 2065 7665 6e74  h recorded event
+00014dc0: 2061 746f 6d69 6361 6c6c 7920 616c 6f6e   atomically alon
+00014dd0: 6720 7769 7468 2061 6e79 206e 6577 2073  g with any new s
+00014de0: 7461 7465 2074 6861 7420 7265 7375 6c74  tate that result
+00014df0: 7320 6672 6f6d 0a70 726f 6365 7373 696e  s from.processin
+00014e00: 6720 7468 6520 7265 636f 7264 6564 2065  g the recorded e
+00014e10: 7665 6e74 732c 2061 6e64 2074 6865 2063  vents, and the c
+00014e20: 6f6d 6d69 7420 706f 7369 7469 6f6e 7320  ommit positions 
+00014e30: 6172 6520 7265 636f 7264 6564 2077 6974  are recorded wit
+00014e40: 6820 6120 756e 6971 7565 6e65 7373 0a63  h a uniqueness.c
+00014e50: 6f6e 7374 7261 696e 742c 2074 6865 6e20  onstraint, then 
+00014e60: 7468 6572 6520 7769 6c6c 206e 6f20 6461  there will no da
+00014e70: 6e67 6572 2074 6f20 7468 6520 7072 6f6a  nger to the proj
+00014e80: 6563 7465 6420 7374 6174 6520 6265 636f  ected state beco
+00014e90: 6d69 6e67 2069 6e63 6f6e 7369 7374 656e  ming inconsisten
+00014ea0: 7420 6475 650a 746f 2074 6865 7365 2063  t due.to these c
+00014eb0: 6f6e 6e65 6374 696f 6e20 6973 7375 6573  onnection issues
+00014ec0: 2e20 496e 2074 6869 7320 6361 7365 2c20  . In this case, 
+00014ed0: 7468 6520 636c 6965 6e74 2077 696c 6c20  the client will 
+00014ee0: 6175 746f 6d61 7469 6361 6c6c 7920 7265  automatically re
+00014ef0: 636f 6e6e 6563 7420 746f 2061 0a6e 6f64  connect to a.nod
+00014f00: 6520 696e 2074 6865 2063 6c75 7374 6572  e in the cluster
+00014f10: 2077 6865 6e20 7468 6520 7375 6273 6571   when the subseq
+00014f20: 7565 6e74 2063 616c 6c20 746f 2061 2063  uent call to a c
+00014f30: 6174 6368 2d75 7020 7375 6273 6372 6970  atch-up subscrip
+00014f40: 7469 6f6e 206d 6574 686f 6420 6973 206d  tion method is m
+00014f50: 6164 652e 0a59 6f75 206a 7573 7420 6e65  ade..You just ne
+00014f60: 6564 2074 6f20 6861 6e64 6c65 2074 6865  ed to handle the
+00014f70: 2065 7863 6570 7469 6f6e 2074 6861 7420   exception that 
+00014f80: 6f63 6375 7273 2066 726f 6d20 7468 6520  occurs from the 
+00014f90: 6974 6572 6174 6f72 2c20 7468 656e 2072  iterator, then r
+00014fa0: 6561 6420 796f 7572 206c 6173 740a 7361  ead your last.sa
+00014fb0: 7665 6420 636f 6d6d 6974 2070 6f73 6974  ved commit posit
+00014fc0: 696f 6e2c 2061 6e64 2074 6865 6e20 7265  ion, and then re
+00014fd0: 7374 6172 7420 796f 7572 2065 7665 6e74  start your event
+00014fe0: 2d70 726f 6365 7373 696e 6720 636f 6d70  -processing comp
+00014ff0: 6f6e 656e 742c 2075 7369 6e67 2074 6865  onent, using the
+00015000: 2073 616d 650a 636c 6965 6e74 206f 626a   same.client obj
+00015010: 6563 742e 2054 6865 2063 6c69 656e 7420  ect. The client 
+00015020: 7769 6c6c 2072 6563 6f6e 6e65 6374 2069  will reconnect i
+00015030: 6620 7468 6572 6520 6973 2061 206e 6565  f there is a nee
+00015040: 6420 746f 2064 6f20 736f 2077 6865 6e20  d to do so when 
+00015050: 7468 6520 7375 6273 6571 7565 6e74 0a63  the subsequent.c
+00015060: 616c 6c20 6973 206d 6164 652e 2053 696d  all is made. Sim
+00015070: 696c 6172 6c79 2c20 7768 656e 2072 6561  ilarly, when rea
+00015080: 6469 6e67 2070 6572 7369 7374 656e 7420  ding persistent 
+00015090: 7375 6273 6372 6970 7469 6f6e 732c 2069  subscriptions, i
+000150a0: 6620 7468 6572 6520 6172 650a 636f 6e6e  f there are.conn
+000150b0: 6563 7469 7669 7479 2069 7373 7565 7320  ectivity issues 
+000150c0: 6166 7465 7220 796f 7520 6861 7665 2073  after you have s
+000150d0: 7461 7274 6564 2069 7465 7261 7469 6e67  tarted iterating
+000150e0: 206f 7665 7220 6120 7375 6363 6573 7366   over a successf
+000150f0: 756c 6c79 2072 6563 6569 7665 640a 7265  ully received.re
+00015100: 7370 6f6e 7365 2c20 7468 656e 2074 6865  sponse, then the
+00015110: 2073 6572 7665 7220 6361 6c6c 2077 696c   server call wil
+00015120: 6c20 6e65 6564 2074 6f20 6265 2072 6573  l need to be res
+00015130: 7461 7274 6564 2e20 496e 2074 6869 7320  tarted. In this 
+00015140: 6361 7365 2c20 7468 6520 7265 6365 6976  case, the receiv
+00015150: 6564 0a65 7665 6e74 7320 7769 6c6c 2073  ed.events will s
+00015160: 7461 7274 2077 6974 6820 7468 6520 6c61  tart with the la
+00015170: 7374 2073 6176 6564 2063 6865 636b 706f  st saved checkpo
+00015180: 696e 7420 6f6e 2074 6865 2073 6572 7665  int on the serve
+00015190: 7220 2870 6f74 656e 7469 616c 6c79 2072  r (potentially r
+000151a0: 6574 7572 6e69 6e67 0a65 7665 6e74 7320  eturning.events 
+000151b0: 7468 6174 2077 6572 6520 696e 2066 6163  that were in fac
+000151c0: 7420 7375 6363 6573 7366 756c 6c79 2070  t successfully p
+000151d0: 726f 6365 7373 6564 292e 0a0a 0a23 2323  rocessed)....###
+000151e0: 2043 6c6f 7365 0a0a 5468 6520 6063 6c6f   Close..The `clo
+000151f0: 7365 2829 6020 6d65 7468 6f64 2063 616e  se()` method can
+00015200: 2062 6520 7573 6564 2074 6f20 636c 6561   be used to clea
+00015210: 6e6c 7920 636c 6f73 6520 7468 6520 6752  nly close the gR
+00015220: 5043 2063 6f6e 6e65 6374 696f 6e2e 0a0a  PC connection...
+00015230: 6060 6070 7974 686f 6e0a 636c 6965 6e74  ```python.client
+00015240: 2e63 6c6f 7365 2829 0a60 6060 0a0a 2323  .close().```..##
+00015250: 204e 6f74 6573 0a0a 2323 2320 436f 6e6e   Notes..### Conn
+00015260: 6563 7469 6f6e 2073 7472 696e 6773 0a0a  ection strings..
+00015270: 5468 6520 4576 656e 7453 746f 7265 4442  The EventStoreDB
+00015280: 2063 6f6e 6e65 6374 696f 6e20 7374 7269   connection stri
+00015290: 6e67 2069 7320 6120 5552 4920 7468 6174  ng is a URI that
+000152a0: 2063 6f6e 666f 726d 7320 7769 7468 206f   conforms with o
+000152b0: 6e65 206f 6620 7477 6f20 706f 7373 6962  ne of two possib
+000152c0: 6c65 0a73 6368 656d 6573 2c20 6569 7468  le.schemes, eith
+000152d0: 6572 2074 6865 2022 6573 6462 2220 7363  er the "esdb" sc
+000152e0: 6865 6d65 206f 7220 7468 6520 2265 7364  heme or the "esd
+000152f0: 622b 6469 7363 6f76 6572 2220 7363 6865  b+discover" sche
+00015300: 6d65 2e20 5468 6520 7379 6e74 6178 2061  me. The syntax a
+00015310: 6e64 0a73 656d 616e 7469 6373 206f 6620  nd.semantics of 
+00015320: 7468 6520 4576 656e 7453 746f 7265 4442  the EventStoreDB
+00015330: 2055 5249 2073 6368 656d 6573 2061 7265   URI schemes are
+00015340: 2065 7870 6c61 696e 6564 2062 656c 6f77   explained below
+00015350: 2e20 5468 6520 7379 6e74 6178 2069 730a  . The syntax is.
+00015360: 6465 6669 6e65 6420 7573 696e 6720 5b45  defined using [E
+00015370: 424e 465d 2868 7474 7073 3a2f 2f65 6e2e  BNF](https://en.
+00015380: 7769 6b69 7065 6469 612e 6f72 672f 7769  wikipedia.org/wi
+00015390: 6b69 2f45 7874 656e 6465 645f 4261 636b  ki/Extended_Back
+000153a0: 7573 e280 934e 6175 725f 666f 726d 292e  us...Naur_form).
+000153b0: 0a0a 5468 6520 2265 7364 6222 2055 5249  ..The "esdb" URI
+000153c0: 2073 6368 656d 6520 6361 6e20 6265 2064   scheme can be d
+000153d0: 6566 696e 6564 2069 6e20 7468 6520 666f  efined in the fo
+000153e0: 6c6c 6f77 696e 6720 7761 792e 0a0a 2020  llowing way...  
+000153f0: 2020 6573 6462 2d75 7269 203d 2022 6573    esdb-uri = "es
+00015400: 6462 3a2f 2f22 202c 205b 2075 7365 722d  db://" , [ user-
+00015410: 696e 666f 202c 2022 4022 205d 202c 2067  info , "@" ] , g
+00015420: 7270 632d 7461 7267 6574 2c20 7b20 222c  rpc-target, { ",
+00015430: 2220 2c20 6772 7063 2d74 6172 6765 7420  " , grpc-target 
+00015440: 7d20 2c20 5b20 223f 2220 2c20 7175 6572  } , [ "?" , quer
+00015450: 792d 7374 7269 6e67 205d 203b 0a0a 496e  y-string ] ;..In
+00015460: 2074 6865 2022 6573 6462 2220 5552 4920   the "esdb" URI 
+00015470: 7363 6865 6d65 2c20 6166 7465 7220 7468  scheme, after th
+00015480: 6520 6f70 7469 6f6e 616c 2075 7365 7220  e optional user 
+00015490: 696e 666f 2073 7472 696e 672c 2074 6865  info string, the
+000154a0: 7265 206d 7573 7420 6265 2061 7420 6c65  re must be at le
+000154b0: 6173 740a 6f6e 6520 6752 5043 2074 6172  ast.one gRPC tar
+000154c0: 6765 742e 2049 6620 7468 6572 6520 6172  get. If there ar
+000154d0: 6520 7365 7665 7261 6c20 6752 5043 2074  e several gRPC t
+000154e0: 6172 6765 7473 2c20 7468 6579 206d 7573  argets, they mus
+000154f0: 7420 6265 2073 6570 6172 6174 6564 2066  t be separated f
+00015500: 726f 6d20 6561 6368 0a6f 7468 6572 2077  rom each.other w
+00015510: 6974 6820 7468 6520 222c 2220 6368 6172  ith the "," char
+00015520: 6163 7465 722e 2045 6163 6820 6752 5043  acter. Each gRPC
+00015530: 2074 6172 6765 7420 7368 6f75 6c64 2069   target should i
+00015540: 6e64 6963 6174 6520 616e 2045 7665 6e74  ndicate an Event
+00015550: 5374 6f72 6544 4220 6752 5043 0a73 6572  StoreDB gRPC.ser
+00015560: 7665 7220 736f 636b 6574 2c20 6279 2073  ver socket, by s
+00015570: 7065 6369 6679 696e 6720 6120 686f 7374  pecifying a host
+00015580: 2061 6e64 2061 2070 6f72 7420 6e75 6d62   and a port numb
+00015590: 6572 2073 6570 6172 6174 6564 2077 6974  er separated wit
+000155a0: 6820 7468 6520 223a 2220 6368 6172 6163  h the ":" charac
+000155b0: 7465 722e 0a54 6865 2068 6f73 7420 6d61  ter..The host ma
+000155c0: 7920 6265 2061 2068 6f73 746e 616d 6520  y be a hostname 
+000155d0: 7468 6174 2063 616e 2062 6520 7265 736f  that can be reso
+000155e0: 6c76 6564 2074 6f20 616e 2049 5020 6164  lved to an IP ad
+000155f0: 6472 6573 732c 206f 7220 616e 2049 5020  dress, or an IP 
+00015600: 6164 6472 6573 732e 0a0a 2020 2020 6772  address...    gr
+00015610: 7063 2d74 6172 6765 7420 3d20 2820 686f  pc-target = ( ho
+00015620: 7374 6e61 6d65 207c 2069 702d 6164 6472  stname | ip-addr
+00015630: 6573 7320 2920 2c20 223a 2220 2c20 706f  ess ) , ":" , po
+00015640: 7274 2d6e 756d 6265 7220 3b0a 0a0a 5468  rt-number ;...Th
+00015650: 6520 2265 7364 622b 6469 7363 6f76 6572  e "esdb+discover
+00015660: 2220 5552 4920 7363 6865 6d65 2063 616e  " URI scheme can
+00015670: 2062 6520 6465 6669 6e65 6420 696e 2074   be defined in t
+00015680: 6865 2066 6f6c 6c6f 7769 6e67 2077 6179  he following way
+00015690: 2e0a 0a20 2020 2065 7364 622d 6469 7363  ...    esdb-disc
+000156a0: 6f76 6572 2d75 7269 203d 2022 6573 6462  over-uri = "esdb
+000156b0: 2b64 6973 636f 7665 723a 2f2f 2220 2c20  +discover://" , 
+000156c0: 5b20 7573 6572 2d69 6e66 6f2c 2022 4022  [ user-info, "@"
+000156d0: 205d 202c 2063 6c75 7374 6572 2d64 6f6d   ] , cluster-dom
+000156e0: 6169 6e6e 616d 6520 2c20 5b20 223f 2220  ainname , [ "?" 
+000156f0: 2c20 7175 6572 792d 7374 7269 6e67 205d  , query-string ]
+00015700: 203b 0a0a 496e 2074 6865 2022 6573 6462   ;..In the "esdb
+00015710: 2b64 6973 636f 7665 7222 2055 5249 2073  +discover" URI s
+00015720: 6368 656d 652c 2061 6674 6572 2074 6865  cheme, after the
+00015730: 2075 7365 7220 696e 666f 2073 7472 696e   user info strin
+00015740: 672c 2074 6865 7265 206d 7573 7420 6265  g, there must be
+00015750: 2061 2064 6f6d 6169 6e0a 6e61 6d65 2077   a domain.name w
+00015760: 6869 6368 2073 686f 756c 6420 6964 656e  hich should iden
+00015770: 7469 6679 2061 2063 6c75 7374 6572 206f  tify a cluster o
+00015780: 6620 4576 656e 7453 746f 7265 4442 2073  f EventStoreDB s
+00015790: 6572 7665 7273 2e20 5468 6520 636c 6965  ervers. The clie
+000157a0: 6e74 2077 696c 6c20 7573 6520 6120 444e  nt will use a DN
+000157b0: 530a 7365 7276 6572 2074 6f20 7265 736f  S.server to reso
+000157c0: 6c76 6520 7468 6520 646f 6d61 696e 206e  lve the domain n
+000157d0: 616d 6520 746f 2061 206c 6973 7420 6f66  ame to a list of
+000157e0: 2061 6464 7265 7373 6573 206f 6620 4576   addresses of Ev
+000157f0: 656e 7453 746f 7265 4442 2073 6572 7665  entStoreDB serve
+00015800: 7273 2c0a 6279 2071 7565 7279 696e 6720  rs,.by querying 
+00015810: 666f 7220 2741 2720 7265 636f 7264 732e  for 'A' records.
+00015820: 2049 6e20 7468 6973 2063 6173 652c 2074   In this case, t
+00015830: 6865 2070 6f72 7420 6e75 6d62 6572 2022  he port number "
+00015840: 3231 3133 2220 7769 6c6c 2062 6520 7573  2113" will be us
+00015850: 6564 2074 6f0a 636f 6e73 7472 7563 7420  ed to.construct 
+00015860: 6752 5043 2074 6172 6765 7473 2066 726f  gRPC targets fro
+00015870: 6d20 7468 6520 6164 6472 6573 7365 7320  m the addresses 
+00015880: 6f62 7461 696e 6564 2066 726f 6d20 2741  obtained from 'A
+00015890: 2720 7265 636f 7264 7320 7072 6f76 6964  ' records provid
+000158a0: 6564 2062 7920 7468 650a 444e 5320 7365  ed by the.DNS se
+000158b0: 7276 6572 2e20 5468 6572 6566 6f72 652c  rver. Therefore,
+000158c0: 2069 6620 796f 7520 7761 6e74 2074 6f20   if you want to 
+000158d0: 7573 6520 7468 6520 2265 7364 622b 6469  use the "esdb+di
+000158e0: 7363 6f76 6572 2220 5552 4920 7363 6865  scover" URI sche
+000158f0: 6d65 2c20 796f 7520 7769 6c6c 0a6e 6565  me, you will.nee
+00015900: 6420 746f 2063 6f6e 6669 6775 7265 2044  d to configure D
+00015910: 4e53 2077 6865 6e20 7365 7474 696e 6720  NS when setting 
+00015920: 7570 2079 6f75 7220 4576 656e 7453 746f  up your EventSto
+00015930: 7265 4442 2063 6c75 7374 6572 2e0a 0a57  reDB cluster...W
+00015940: 6974 6820 626f 7468 2074 6865 2022 6573  ith both the "es
+00015950: 6462 2220 616e 6420 2265 7364 622b 6469  db" and "esdb+di
+00015960: 736f 6376 6572 2220 5552 4920 7363 6865  socver" URI sche
+00015970: 6d65 732c 2074 6865 2063 6c69 656e 7420  mes, the client 
+00015980: 6669 7273 746c 7920 6f62 7461 696e 730a  firstly obtains.
+00015990: 6120 6c69 7374 206f 6620 6752 5043 2074  a list of gRPC t
+000159a0: 6172 6765 7473 3a20 6569 7468 6572 2064  argets: either d
+000159b0: 6972 6563 746c 7920 6672 6f6d 2022 6573  irectly from "es
+000159c0: 6462 2220 636f 6e6e 6563 7469 6f6e 2073  db" connection s
+000159d0: 7472 696e 6773 3b20 6f72 2069 6e64 6972  trings; or indir
+000159e0: 6563 746c 790a 6672 6f6d 2022 6573 6462  ectly.from "esdb
+000159f0: 2b64 6973 636f 7665 7222 2063 6f6e 6e65  +discover" conne
+00015a00: 6374 696f 6e20 7374 7269 6e67 7320 7669  ction strings vi
+00015a10: 6120 444e 532e 2054 6869 7320 6c69 7374  a DNS. This list
+00015a20: 206f 6620 7461 7267 6574 7320 6973 206b   of targets is k
+00015a30: 6e6f 776e 2061 7320 7468 650a 2267 6f73  nown as the."gos
+00015a40: 7369 7020 7365 6564 222e 2054 6865 2063  sip seed". The c
+00015a50: 6c69 656e 7420 7769 6c6c 2074 6865 6e20  lient will then 
+00015a60: 6174 7465 6d70 7420 746f 2063 6f6e 6e65  attempt to conne
+00015a70: 6374 2074 6f20 6561 6368 2067 5250 4320  ct to each gRPC 
+00015a80: 7461 7267 6574 2069 6e20 7475 726e 2c0a  target in turn,.
+00015a90: 6174 7465 6d70 7469 6e67 2074 6f20 6361  attempting to ca
+00015aa0: 6c6c 2074 6865 2045 7665 6e74 5374 6f72  ll the EventStor
+00015ab0: 6544 4220 476f 7373 6970 2041 5049 2074  eDB Gossip API t
+00015ac0: 6f20 6f62 7461 696e 2069 6e66 6f72 6d61  o obtain informa
+00015ad0: 7469 6f6e 2061 626f 7574 2074 6865 0a45  tion about the.E
+00015ae0: 7665 6e74 5374 6f72 6544 4220 636c 7573  ventStoreDB clus
+00015af0: 7465 722e 2041 206d 656d 6265 7220 6f66  ter. A member of
+00015b00: 2074 6865 2063 6c75 7374 6572 2069 7320   the cluster is 
+00015b10: 7365 6c65 6374 6564 2062 7920 7468 6520  selected by the 
+00015b20: 636c 6965 6e74 2c20 6163 636f 7264 696e  client, accordin
+00015b30: 670a 746f 2074 6865 2022 6e6f 6465 2070  g.to the "node p
+00015b40: 7265 6665 7265 6e63 6522 206f 7074 696f  reference" optio
+00015b50: 6e2e 2054 6865 2063 6c69 656e 7420 6d61  n. The client ma
+00015b60: 7920 7468 656e 206e 6565 6420 746f 2063  y then need to c
+00015b70: 6c6f 7365 2069 7473 0a63 6f6e 6e65 6374  lose its.connect
+00015b80: 696f 6e20 616e 6420 7265 636f 6e6e 6563  ion and reconnec
+00015b90: 7420 746f 2074 6865 2073 656c 6563 7465  t to the selecte
+00015ba0: 6420 7365 7276 6572 2e0a 0a49 6e20 626f  d server...In bo
+00015bb0: 7468 2074 6865 2022 6573 6462 2220 616e  th the "esdb" an
+00015bc0: 6420 2265 7364 622b 6469 7363 6f76 6572  d "esdb+discover
+00015bd0: 2220 7363 6865 6d65 732c 2074 6865 2055  " schemes, the U
+00015be0: 5249 206d 6179 2069 6e63 6c75 6465 2061  RI may include a
+00015bf0: 2075 7365 7220 696e 666f 2073 7472 696e   user info strin
+00015c00: 672e 0a49 6620 6974 2065 7869 7374 7320  g..If it exists 
+00015c10: 696e 2074 6865 2055 5249 2c20 7468 6520  in the URI, the 
+00015c20: 7573 6572 2069 6e66 6f20 7374 7269 6e67  user info string
+00015c30: 206d 7573 7420 6265 2073 6570 6172 6174   must be separat
+00015c40: 6564 2066 726f 6d20 7468 6520 7265 7374  ed from the rest
+00015c50: 206f 6620 7468 6520 5552 490a 7769 7468   of the URI.with
+00015c60: 2074 6865 2022 4022 2063 6861 7261 6374   the "@" charact
+00015c70: 6572 2e20 5468 6520 7573 6572 2069 6e66  er. The user inf
+00015c80: 6f20 7374 7269 6e67 206d 7573 7420 696e  o string must in
+00015c90: 636c 7564 6520 6120 7573 6572 6e61 6d65  clude a username
+00015ca0: 2061 6e64 2061 2070 6173 7377 6f72 642c   and a password,
+00015cb0: 0a73 6570 6172 6174 6564 2077 6974 6820  .separated with 
+00015cc0: 7468 6520 223a 2220 6368 6172 6163 7465  the ":" characte
+00015cd0: 722e 0a0a 2020 2020 7573 6572 2d69 6e66  r...    user-inf
+00015ce0: 6f20 3d20 7573 6572 6e61 6d65 202c 2022  o = username , "
+00015cf0: 3a22 202c 2070 6173 7377 6f72 6420 3b0a  :" , password ;.
+00015d00: 0a54 6865 2075 7365 7220 696e 666f 2069  .The user info i
+00015d10: 7320 7365 6e74 2062 7920 7468 6520 636c  s sent by the cl
+00015d20: 6965 6e74 2061 7320 2263 616c 6c20 6372  ient as "call cr
+00015d30: 6564 656e 7469 616c 7322 2069 6e20 6561  edentials" in ea
+00015d40: 6368 2063 616c 6c20 746f 2061 2022 7365  ch call to a "se
+00015d50: 6375 7265 220a 7365 7276 6572 2c20 696e  cure".server, in
+00015d60: 2061 2022 6261 7369 6320 6175 7468 2220   a "basic auth" 
+00015d70: 6175 7468 6f72 697a 6174 696f 6e20 6865  authorization he
+00015d80: 6164 6572 2e20 5468 6973 2061 7574 686f  ader. This autho
+00015d90: 7269 7a61 7469 6f6e 2068 6561 6465 7220  rization header 
+00015da0: 6973 2075 7365 6420 6279 0a74 6865 2073  is used by.the s
+00015db0: 6572 7665 7220 746f 2061 7574 6865 6e74  erver to authent
+00015dc0: 6963 6174 6520 7468 6520 636c 6965 6e74  icate the client
+00015dd0: 2e20 5468 6520 6175 7468 6f72 697a 6174  . The authorizat
+00015de0: 696f 6e20 6865 6164 6572 2069 7320 6e6f  ion header is no
+00015df0: 7420 7365 6e74 2074 6f0a 2269 6e73 6563  t sent to."insec
+00015e00: 7572 6522 2073 6572 7665 7273 2e0a 0a49  ure" servers...I
+00015e10: 6e20 626f 7468 2074 6865 2022 6573 6462  n both the "esdb
+00015e20: 2220 616e 6420 2265 7364 622b 6469 7363  " and "esdb+disc
+00015e30: 6f76 6572 2220 7363 6865 6d65 732c 2074  over" schemes, t
+00015e40: 6865 206f 7074 696f 6e61 6c20 7175 6572  he optional quer
+00015e50: 7920 7374 7269 6e67 206d 7573 7420 6265  y string must be
+00015e60: 206f 6e65 0a6f 7220 6d61 6e79 2066 6965   one.or many fie
+00015e70: 6c64 2d76 616c 7565 2061 7267 756d 656e  ld-value argumen
+00015e80: 7473 2c20 7365 7061 7261 7465 6420 6672  ts, separated fr
+00015e90: 6f6d 2065 6163 6820 6f74 6865 7220 7769  om each other wi
+00015ea0: 7468 2074 6865 2022 2622 2063 6861 7261  th the "&" chara
+00015eb0: 6374 6572 2e0a 0a20 2020 2071 7565 7279  cter...    query
+00015ec0: 2d73 7472 696e 6720 3d20 6669 656c 642d  -string = field-
+00015ed0: 7661 6c75 652c 207b 2022 2622 2c20 6669  value, { "&", fi
+00015ee0: 656c 642d 7661 6c75 6520 7d20 3b0a 0a45  eld-value } ;..E
+00015ef0: 6163 6820 6669 656c 642d 7661 6c75 6520  ach field-value 
+00015f00: 6172 6775 6d65 6e74 206d 7573 7420 6265  argument must be
+00015f10: 206f 6e65 206f 6620 7468 6520 7375 7070   one of the supp
+00015f20: 6f72 7465 6420 6669 656c 6473 2c20 616e  orted fields, an
+00015f30: 6420 616e 0a61 7070 726f 7072 6961 7465  d an.appropriate
+00015f40: 2076 616c 7565 2c20 7365 7061 7261 7465   value, separate
+00015f50: 6420 7769 7468 2074 6865 2022 3d22 2063  d with the "=" c
+00015f60: 6861 7261 6374 6572 2e0a 0a20 2020 2066  haracter...    f
+00015f70: 6965 6c64 2d76 616c 7565 203d 2028 2022  ield-value = ( "
+00015f80: 546c 7322 2c20 223d 2220 2c20 2274 7275  Tls", "=" , "tru
+00015f90: 6522 207c 2022 6661 6c73 6522 2029 0a20  e" | "false" ). 
+00015fa0: 2020 2020 2020 2020 2020 2020 2020 207c                 |
+00015fb0: 2028 2022 546c 7356 6572 6966 7943 6572   ( "TlsVerifyCer
+00015fc0: 7422 2c20 223d 2220 2c20 2274 7275 6522  t", "=" , "true"
+00015fd0: 207c 2022 6661 6c73 6522 2029 0a20 2020   | "false" ).   
+00015fe0: 2020 2020 2020 2020 2020 2020 207c 2028               | (
+00015ff0: 2022 436f 6e6e 6563 7469 6f6e 4e61 6d65   "ConnectionName
+00016000: 222c 2022 3d22 202c 2073 7472 696e 6720  ", "=" , string 
+00016010: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00016020: 2020 7c20 2820 224e 6f64 6550 7265 6665    | ( "NodePrefe
+00016030: 7265 6e63 6522 2c20 223d 2220 2c20 226c  rence", "=" , "l
+00016040: 6561 6465 7222 207c 2022 666f 6c6c 6f77  eader" | "follow
+00016050: 6572 2220 7c20 2272 6561 646f 6e6c 7972  er" | "readonlyr
+00016060: 6570 6c69 6361 2220 7c20 2272 616e 646f  eplica" | "rando
+00016070: 6d22 2029 0a20 2020 2020 2020 2020 2020  m" ).           
+00016080: 2020 2020 207c 2028 2022 4465 6661 756c       | ( "Defaul
+00016090: 7444 6561 646c 696e 6522 2c20 223d 2220  tDeadline", "=" 
+000160a0: 2c20 696e 7465 6765 7220 290a 2020 2020  , integer ).    
+000160b0: 2020 2020 2020 2020 2020 2020 7c20 2820              | ( 
+000160c0: 2247 6f73 7369 7054 696d 656f 7574 222c  "GossipTimeout",
+000160d0: 2022 3d22 202c 2069 6e74 6567 6572 2029   "=" , integer )
+000160e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000160f0: 207c 2028 2022 4d61 7844 6973 636f 7665   | ( "MaxDiscove
+00016100: 7241 7474 656d 7074 7322 2c20 223d 2220  rAttempts", "=" 
+00016110: 2c20 696e 7465 6765 7220 290a 2020 2020  , integer ).    
+00016120: 2020 2020 2020 2020 2020 2020 7c20 2820              | ( 
+00016130: 2244 6973 636f 7665 7279 496e 7465 7276  "DiscoveryInterv
+00016140: 616c 222c 2022 3d22 202c 2069 6e74 6567  al", "=" , integ
+00016150: 6572 2029 0a20 2020 2020 2020 2020 2020  er ).           
+00016160: 2020 2020 207c 2028 2022 4d61 7844 6973       | ( "MaxDis
+00016170: 636f 7665 7241 7474 656d 7074 7322 2c20  coverAttempts", 
+00016180: 223d 2220 2c20 696e 7465 6765 7220 290a  "=" , integer ).
+00016190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000161a0: 7c20 2820 224b 6565 7041 6c69 7665 496e  | ( "KeepAliveIn
+000161b0: 7465 7276 616c 222c 2022 3d22 202c 2069  terval", "=" , i
+000161c0: 6e74 6567 6572 2029 0a20 2020 2020 2020  nteger ).       
+000161d0: 2020 2020 2020 2020 207c 2028 2022 4b65           | ( "Ke
+000161e0: 6570 416c 6976 6549 6e74 6572 7661 6c22  epAliveInterval"
+000161f0: 2c20 223d 2220 2c20 696e 7465 6765 7220  , "=" , integer 
+00016200: 2920 3b0a 0a54 6865 2074 6162 6c65 2062  ) ;..The table b
+00016210: 656c 6f77 2064 6573 6372 6962 6573 2074  elow describes t
+00016220: 6865 2071 7565 7279 2066 6965 6c64 2d76  he query field-v
+00016230: 616c 7565 7320 7375 7070 6f72 7465 6420  alues supported 
+00016240: 6279 2074 6869 7320 636c 6965 6e74 2e0a  by this client..
+00016250: 0a7c 2046 6965 6c64 2020 2020 2020 2020  .| Field        
+00016260: 2020 2020 2020 207c 2056 616c 7565 2020         | Value  
+00016270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000162a0: 2020 2020 2020 2020 2020 2020 2020 207c                 |
+000162b0: 2044 6573 6372 6970 7469 6f6e 2020 2020   Description    
+000162c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000162d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000162e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000162f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016350: 2020 207c 0a7c 2d2d 2d2d 2d2d 2d2d 2d2d     |.|----------
+00016360: 2d2d 2d2d 2d2d 2d2d 2d2d 2d7c 2d2d 2d2d  -----------|----
+00016370: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016380: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016390: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000163a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000163b0: 2d2d 2d7c 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ---|------------
+000163c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000163d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000163e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000163f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016400: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016410: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016420: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016430: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016440: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00016450: 2d2d 2d2d 2d2d 2d7c 0a7c 2054 6c73 2020  -------|.| Tls  
+00016460: 2020 2020 2020 2020 2020 2020 2020 207c                 |
+00016470: 2022 7472 7565 222c 2022 6661 6c73 6522   "true", "false"
+00016480: 2028 6465 6661 756c 743a 2022 7472 7565   (default: "true
+00016490: 2229 2020 2020 2020 2020 2020 2020 2020  ")              
+000164a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000164b0: 2020 2020 2020 207c 2049 6620 2274 7275         | If "tru
+000164c0: 6522 2074 6865 2063 6c69 656e 7420 7769  e" the client wi
+000164d0: 6c6c 2063 7265 6174 6520 6120 2273 6563  ll create a "sec
+000164e0: 7572 6522 2067 5250 4320 6368 616e 6e65  ure" gRPC channe
+000164f0: 6c2e 2049 6620 2266 616c 7365 2220 7468  l. If "false" th
+00016500: 6520 636c 6965 6e74 2077 696c 6c20 6372  e client will cr
+00016510: 6561 7465 2061 6e20 2269 6e73 6563 7572  eate an "insecur
+00016520: 6522 2067 5250 4320 6368 616e 6e65 6c2e  e" gRPC channel.
+00016530: 2054 6869 7320 6d75 7374 206d 6174 6368   This must match
+00016540: 2074 6865 2073 6572 7665 7220 636f 6e66   the server conf
+00016550: 6967 7572 6174 696f 6e2e 207c 0a7c 2054  iguration. |.| T
+00016560: 6c73 5665 7269 6679 4365 7274 2020 2020  lsVerifyCert    
+00016570: 2020 207c 2022 7472 7565 222c 2022 6661     | "true", "fa
+00016580: 6c73 6522 2028 6465 6661 756c 743a 2022  lse" (default: "
+00016590: 7472 7565 2229 2020 2020 2020 2020 2020  true")          
+000165a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000165b0: 2020 2020 2020 2020 2020 207c 2054 6869             | Thi
+000165c0: 7320 7661 6c75 6520 6973 2063 7572 7265  s value is curre
+000165d0: 6e74 6c79 2069 676e 6f72 6564 2e20 2020  ntly ignored.   
+000165e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000165f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016650: 2020 2020 2020 2020 2020 2020 2020 207c                 |
+00016660: 0a7c 2043 6f6e 6e65 6374 696f 6e4e 616d  .| ConnectionNam
+00016670: 6520 2020 2020 207c 2073 7472 696e 6720  e      | string 
+00016680: 2864 6566 6175 6c74 3a20 6175 746f 2d67  (default: auto-g
+00016690: 656e 6572 6174 6564 2076 6572 7369 6f6e  enerated version
+000166a0: 2d34 2055 5549 4429 2020 2020 2020 2020  -4 UUID)        
+000166b0: 2020 2020 2020 2020 2020 2020 2020 207c                 |
+000166c0: 2053 656e 7420 696e 2063 616c 6c20 6d65   Sent in call me
+000166d0: 7461 6461 7461 2066 6f72 2065 7665 7279  tadata for every
+000166e0: 2063 616c 6c2c 2074 6f20 6964 656e 7469   call, to identi
+000166f0: 6679 2074 6865 2063 6c69 656e 7420 746f  fy the client to
+00016700: 2074 6865 2063 6c75 7374 6572 2e20 2020   the cluster.   
+00016710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016760: 2020 207c 0a7c 204e 6f64 6550 7265 6665     |.| NodePrefe
+00016770: 7265 6e63 6520 2020 2020 207c 2022 6c65  rence      | "le
+00016780: 6164 6572 222c 2022 666f 6c6c 6f77 6572  ader", "follower
+00016790: 222c 2022 7265 6164 6f6e 6c79 7265 706c  ", "readonlyrepl
+000167a0: 6963 6122 2c20 2272 616e 646f 6d22 2028  ica", "random" (
+000167b0: 6465 6661 756c 743a 2022 6c65 6164 6572  default: "leader
+000167c0: 2229 207c 2054 6865 206e 6f64 6520 7374  ") | The node st
+000167d0: 6174 6520 7072 6566 6572 7265 6420 6279  ate preferred by
+000167e0: 2074 6865 2063 6c69 656e 742e 2054 6865   the client. The
+000167f0: 2063 6c69 656e 7420 7769 6c6c 2073 656c   client will sel
+00016800: 6563 7420 6120 6e6f 6465 2066 726f 6d20  ect a node from 
+00016810: 7468 6520 636c 7573 7465 7220 696e 666f  the cluster info
+00016820: 2072 6563 6569 7665 6420 6672 6f6d 2074   received from t
+00016830: 6865 2047 6f73 7369 7020 4150 4920 6163  he Gossip API ac
+00016840: 636f 7264 696e 6720 746f 2074 6869 7320  cording to this 
+00016850: 7072 6566 6572 656e 6365 2e20 2020 2020  preference.     
+00016860: 2020 2020 2020 207c 0a7c 2044 6566 6175         |.| Defau
+00016870: 6c74 4465 6164 6c69 6e65 2020 2020 207c  ltDeadline     |
+00016880: 2069 6e74 6567 6572 2028 6465 6661 756c   integer (defaul
+00016890: 743a 2060 4e6f 6e65 6029 2020 2020 2020  t: `None`)      
+000168a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000168b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000168c0: 2020 2020 2020 207c 2054 6865 2064 6566         | The def
+000168d0: 6175 6c74 2076 616c 7565 2028 696e 2073  ault value (in s
+000168e0: 6563 6f6e 6473 2920 6f66 2074 6865 2060  econds) of the `
+000168f0: 7469 6d65 6f75 7460 2061 7267 756d 656e  timeout` argumen
+00016900: 7420 6f66 2063 6c69 656e 7420 2277 7269  t of client "wri
+00016910: 7465 2220 6d65 7468 6f64 7320 7375 6368  te" methods such
+00016920: 2061 7320 6061 7070 656e 645f 6576 656e   as `append_even
+00016930: 7473 2829 602e 2020 2020 2020 2020 2020  ts()`.          
+00016940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016960: 2020 2020 2020 2020 2020 207c 0a7c 2047             |.| G
+00016970: 6f73 7369 7054 696d 656f 7574 2020 2020  ossipTimeout    
+00016980: 2020 207c 2069 6e74 6567 6572 2028 6465     | integer (de
+00016990: 6661 756c 743a 2035 2920 2020 2020 2020  fault: 5)       
+000169a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000169b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000169c0: 2020 2020 2020 2020 2020 207c 2054 6865             | The
+000169d0: 2064 6566 6175 6c74 2076 616c 7565 2028   default value (
+000169e0: 696e 2073 6563 6f6e 6473 2920 6f66 2074  in seconds) of t
+000169f0: 6865 2060 7469 6d65 6f75 7460 2061 7267  he `timeout` arg
+00016a00: 756d 656e 7420 6f66 2067 6f73 7369 7020  ument of gossip 
+00016a10: 7265 6164 206d 6574 686f 6473 2c20 7375  read methods, su
+00016a20: 6368 2061 7320 6072 6561 645f 676f 7373  ch as `read_goss
+00016a30: 6970 2829 602e 2020 2020 2020 2020 2020  ip()`.          
+00016a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016a60: 2020 2020 2020 2020 2020 2020 2020 207c                 |
+00016a70: 0a7c 204d 6178 4469 7363 6f76 6572 4174  .| MaxDiscoverAt
+00016a80: 7465 6d70 7473 207c 2069 6e74 6567 6572  tempts | integer
+00016a90: 2028 6465 6661 756c 743a 2031 3029 2020   (default: 10)  
+00016aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016ac0: 2020 2020 2020 2020 2020 2020 2020 207c                 |
+00016ad0: 2054 6865 206e 756d 6265 7220 6f66 2061   The number of a
+00016ae0: 7474 656d 7074 7320 746f 2072 6561 6420  ttempts to read 
+00016af0: 676f 7373 6970 2077 6865 6e20 636f 6e6e  gossip when conn
+00016b00: 6563 7469 6e67 206f 7220 7265 636f 6e6e  ecting or reconn
+00016b10: 6563 7469 6e67 2074 6f20 6120 636c 7573  ecting to a clus
+00016b20: 7465 7220 6d65 6d62 6572 2e20 2020 2020  ter member.     
+00016b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016b70: 2020 207c 0a7c 2044 6973 636f 7665 7279     |.| Discovery
+00016b80: 496e 7465 7276 616c 2020 207c 2069 6e74  Interval   | int
+00016b90: 6567 6572 2028 6465 6661 756c 743a 2031  eger (default: 1
+00016ba0: 3030 2920 2020 2020 2020 2020 2020 2020  00)             
+00016bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016bd0: 2020 207c 2048 6f77 206c 6f6e 6720 746f     | How long to
+00016be0: 2077 6169 7420 2869 6e20 6d69 6c6c 6973   wait (in millis
+00016bf0: 6563 6f6e 6473 2920 6265 7477 6565 6e20  econds) between 
+00016c00: 676f 7373 6970 2072 6574 7269 6573 2e20  gossip retries. 
+00016c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016c70: 2020 2020 2020 207c 0a7c 204b 6565 7041         |.| KeepA
+00016c80: 6c69 7665 496e 7465 7276 616c 2020 207c  liveInterval   |
+00016c90: 2069 6e74 6567 6572 2028 6465 6661 756c   integer (defaul
+00016ca0: 743a 2060 4e6f 6e65 6029 2020 2020 2020  t: `None`)      
+00016cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016cd0: 2020 2020 2020 207c 2054 6865 2076 616c         | The val
+00016ce0: 7565 206f 6620 7468 6520 2267 7270 632e  ue of the "grpc.
+00016cf0: 6b65 6570 616c 6976 655f 6d73 2220 6752  keepalive_ms" gR
+00016d00: 5043 2063 6861 6e6e 656c 206f 7074 696f  PC channel optio
+00016d10: 6e2e 2020 2020 2020 2020 2020 2020 2020  n.              
+00016d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016d70: 2020 2020 2020 2020 2020 207c 0a7c 204b             |.| K
+00016d80: 6565 7041 6c69 7665 5469 6d65 6f75 7420  eepAliveTimeout 
+00016d90: 2020 207c 2069 6e74 6567 6572 2028 6465     | integer (de
+00016da0: 6661 756c 743a 2060 4e6f 6e65 6029 2020  fault: `None`)  
+00016db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016dd0: 2020 2020 2020 2020 2020 207c 2054 6865             | The
+00016de0: 2076 616c 7565 206f 6620 7468 6520 2267   value of the "g
+00016df0: 7270 632e 6b65 6570 616c 6976 655f 7469  rpc.keepalive_ti
+00016e00: 6d65 6f75 745f 6d73 2220 6752 5043 2063  meout_ms" gRPC c
+00016e10: 6861 6e6e 656c 206f 7074 696f 6e2e 2020  hannel option.  
+00016e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016e70: 2020 2020 2020 2020 2020 2020 2020 207c                 |
+00016e80: 0a0a 0a48 6572 6520 6172 6520 736f 6d65  ...Here are some
+00016e90: 2065 7861 6d70 6c65 7320 6f66 2045 7665   examples of Eve
+00016ea0: 6e74 5374 6f72 6544 4220 636f 6e6e 6563  ntStoreDB connec
+00016eb0: 7469 6f6e 2073 7472 696e 6720 5552 4973  tion string URIs
+00016ec0: 2e0a 0a20 2020 2023 2047 6574 2063 6c75  ...    # Get clu
+00016ed0: 7374 6572 2069 6e66 6f20 6672 6f6d 2073  ster info from s
+00016ee0: 6563 7572 6520 7365 7276 6572 2073 6f63  ecure server soc
+00016ef0: 6b65 7420 6c6f 6361 6c68 6f73 743a 3231  ket localhost:21
+00016f00: 3133 2c0a 2020 2020 2320 616e 6420 7573  13,.    # and us
+00016f10: 6520 2261 646d 696e 2220 616e 6420 2263  e "admin" and "c
+00016f20: 6861 6e67 6569 7422 2061 7320 7573 6572  hangeit" as user
+00016f30: 6e61 6d65 2061 6e64 2070 6173 7377 6f72  name and passwor
+00016f40: 640a 2020 2020 2320 7768 656e 206d 616b  d.    # when mak
+00016f50: 696e 6720 6361 6c6c 7320 746f 2045 7665  ing calls to Eve
+00016f60: 6e74 5374 6f72 6544 4220 4150 4920 6d65  ntStoreDB API me
+00016f70: 7468 6f64 732e 0a0a 2020 2020 6573 6462  thods...    esdb
+00016f80: 3a2f 2f61 646d 696e 3a63 6861 6e67 6569  ://admin:changei
+00016f90: 7440 6c6f 6361 6c68 6f73 743a 3231 3133  t@localhost:2113
+00016fa0: 0a0a 0a20 2020 2023 2047 6574 2063 6c75  ...    # Get clu
+00016fb0: 7374 6572 2069 6e66 6f20 6672 6f6d 2069  ster info from i
+00016fc0: 6e73 6563 7572 6520 7365 7276 6572 2073  nsecure server s
+00016fd0: 6f63 6b65 7420 3132 372e 302e 302e 313a  ocket 127.0.0.1:
+00016fe0: 3231 3134 0a0a 2020 2020 6573 6462 3a2f  2114..    esdb:/
+00016ff0: 2f31 3237 2e30 2e30 2e31 3a32 3131 343f  /127.0.0.1:2114?
+00017000: 546c 733d 6661 6c73 650a 0a0a 2020 2020  Tls=false...    
+00017010: 2320 4765 7420 636c 7573 7465 7220 696e  # Get cluster in
+00017020: 666f 2066 726f 6d20 6164 6472 6573 7365  fo from addresse
+00017030: 7320 696e 2027 4127 2072 6563 6f72 6473  s in 'A' records
+00017040: 2066 6f72 2063 6c75 7374 6572 312e 6578   for cluster1.ex
+00017050: 616d 706c 652e 636f 6d2c 0a20 2020 2023  ample.com,.    #
+00017060: 2061 6e64 2075 7365 2061 2064 6566 6175   and use a defau
+00017070: 6c74 2064 6561 646c 696e 6520 666f 7220  lt deadline for 
+00017080: 6d61 6b69 6e67 2063 616c 6c73 2074 6f20  making calls to 
+00017090: 4576 656e 7453 746f 7265 2041 5049 206d  EventStore API m
+000170a0: 6574 686f 642e 0a0a 2020 2020 6573 6462  ethod...    esdb
+000170b0: 2b64 6973 636f 7665 723a 2f2f 6164 6d69  +discover://admi
+000170c0: 6e3a 6368 616e 6765 6974 4063 6c75 7374  n:changeit@clust
+000170d0: 6572 312e 6578 616d 706c 652e 636f 6d3f  er1.example.com?
+000170e0: 4465 6661 756c 7444 6561 646c 696e 653d  DefaultDeadline=
+000170f0: 350a 0a0a 2020 2020 2320 4765 7420 636c  5...    # Get cl
+00017100: 7573 7465 7220 696e 666f 2066 726f 6d20  uster info from 
+00017110: 6569 7468 6572 206c 6f63 616c 686f 7374  either localhost
+00017120: 3a32 3131 3120 6f72 206c 6f63 616c 686f  :2111 or localho
+00017130: 7374 3a32 3131 3220 6f72 0a20 2020 2023  st:2112 or.    #
+00017140: 206c 6f63 616c 686f 7374 3a32 3131 332c   localhost:2113,
+00017150: 2061 6e64 2074 6865 6e20 636f 6e6e 6563   and then connec
+00017160: 7420 746f 2061 2066 6f6c 6c6f 7765 7220  t to a follower 
+00017170: 6e6f 6465 2069 6e20 7468 6520 636c 7573  node in the clus
+00017180: 7465 722e 0a0a 2020 2020 6573 6462 3a2f  ter...    esdb:/
+00017190: 2f61 646d 696e 3a63 6861 6e67 6569 7440  /admin:changeit@
+000171a0: 6c6f 6361 6c68 6f73 743a 3231 3131 2c6c  localhost:2111,l
+000171b0: 6f63 616c 686f 7374 3a32 3131 322c 6c6f  ocalhost:2112,lo
+000171c0: 6361 6c68 6f73 743a 3231 3133 3f4e 6f64  calhost:2113?Nod
+000171d0: 6550 7265 6665 7265 6e63 653d 666f 6c6c  ePreference=foll
+000171e0: 6f77 6572 0a0a 0a20 2020 2023 2047 6574  ower...    # Get
+000171f0: 2063 6c75 7374 6572 2069 6e66 6f20 6672   cluster info fr
+00017200: 6f6d 2061 6464 7265 7373 6573 2069 6e20  om addresses in 
+00017210: 2741 2720 7265 636f 7264 7320 666f 7220  'A' records for 
+00017220: 636c 7573 7465 7231 2e65 7861 6d70 6c65  cluster1.example
+00017230: 2e63 6f6d 2c0a 2020 2020 2320 616e 6420  .com,.    # and 
+00017240: 636f 6e66 6967 7572 6520 226b 6565 7020  configure "keep 
+00017250: 616c 6976 6522 2074 696d 656f 7574 2061  alive" timeout a
+00017260: 6e64 2069 6e74 6572 7661 6c20 696e 2074  nd interval in t
+00017270: 6865 2067 5250 4320 6368 616e 6e65 6c2e  he gRPC channel.
+00017280: 0a0a 2020 2020 6573 6462 2b64 6973 636f  ..    esdb+disco
+00017290: 7665 723a 2f2f 6164 6d69 6e3a 6368 616e  ver://admin:chan
+000172a0: 6765 6974 4063 6c75 7374 6572 312e 6578  geit@cluster1.ex
+000172b0: 616d 706c 652e 636f 6d3f 4b65 6570 416c  ample.com?KeepAl
+000172c0: 6976 6549 6e74 6572 7661 6c3d 3130 3030  iveInterval=1000
+000172d0: 3026 4b65 6570 416c 6976 6554 696d 656f  0&KeepAliveTimeo
+000172e0: 7574 3d31 3030 3030 0a0a 0a50 6c65 6173  ut=10000...Pleas
+000172f0: 6520 6e6f 7465 2c20 7468 6520 636c 6965  e note, the clie
+00017300: 6e74 2069 7320 696e 7365 6e73 6974 6976  nt is insensitiv
+00017310: 6520 746f 2074 6865 2063 6173 6520 6f66  e to the case of
+00017320: 2066 6965 6c64 7320 616e 6420 7661 6c75   fields and valu
+00017330: 6573 2e20 4966 2066 6965 6c64 7320 6172  es. If fields ar
+00017340: 650a 7265 7065 6174 6564 2069 6e20 7468  e.repeated in th
+00017350: 6520 7175 6572 7920 7374 7269 6e67 2c20  e query string, 
+00017360: 7468 6520 7175 6572 7920 7374 7269 6e67  the query string
+00017370: 2077 696c 6c20 6265 2070 6172 7365 6420   will be parsed 
+00017380: 7769 7468 6f75 7420 6572 726f 722e 2048  without error. H
+00017390: 6f77 6576 6572 2c0a 7468 6520 636f 6e6e  owever,.the conn
+000173a0: 6563 7469 6f6e 206f 7074 696f 6e73 2075  ection options u
+000173b0: 7365 6420 6279 2074 6865 2063 6c69 656e  sed by the clien
+000173c0: 7420 7769 6c6c 2075 7365 2074 6865 2076  t will use the v
+000173d0: 616c 7565 206f 6620 7468 6520 6669 7273  alue of the firs
+000173e0: 7420 6669 656c 642e 2041 6c6c 0a74 6865  t field. All.the
+000173f0: 206f 7468 6572 2066 6965 6c64 2d76 616c   other field-val
+00017400: 7565 7320 696e 2074 6865 2071 7565 7279  ues in the query
+00017410: 2073 7472 696e 6720 7769 7468 2074 6865   string with the
+00017420: 2073 616d 6520 6669 656c 6420 6e61 6d65   same field name
+00017430: 2077 696c 6c20 6265 2069 676e 6f72 6564   will be ignored
+00017440: 2e0a 4669 656c 6473 2077 6974 686f 7574  ..Fields without
+00017450: 2076 616c 7565 7320 7769 6c6c 2061 6c73   values will als
+00017460: 6f20 6265 2069 676e 6f72 6564 2e0a 0a49  o be ignored...I
+00017470: 6620 7468 6520 636c 6965 6e74 2773 206e  f the client's n
+00017480: 6f64 6520 7072 6566 6572 656e 6365 2069  ode preference i
+00017490: 7320 226c 6561 6465 7222 2061 6e64 2074  s "leader" and t
+000174a0: 6865 206e 6f64 6520 6265 636f 6d65 7320  he node becomes 
+000174b0: 610a 2266 6f6c 6c6f 7765 7222 2c20 7468  a."follower", th
+000174c0: 6520 636c 6965 6e74 2077 696c 6c20 6174  e client will at
+000174d0: 7465 6d70 7420 746f 2072 6563 6f6e 6e65  tempt to reconne
+000174e0: 6374 2074 6f20 7468 6520 6375 7272 656e  ct to the curren
+000174f0: 7420 6c65 6164 6572 2077 6865 6e20 6120  t leader when a 
+00017500: 6d65 7468 6f64 0a69 7320 6361 6c6c 6564  method.is called
+00017510: 2074 6861 7420 6578 7065 6374 7320 746f   that expects to
+00017520: 2063 616c 6c20 6120 6c65 6164 6572 2e20   call a leader. 
+00017530: 4d65 7468 6f64 7320 7768 6963 6820 6d75  Methods which mu
+00017540: 7461 7465 2074 6865 2073 7461 7465 206f  tate the state o
+00017550: 6620 7468 6520 6461 7461 6261 7365 0a65  f the database.e
+00017560: 7870 6563 7420 746f 2063 616c 6c20 6120  xpect to call a 
+00017570: 6c65 6164 6572 2e20 466f 7220 7375 6368  leader. For such
+00017580: 206d 6574 686f 6473 2c20 7468 6520 4854   methods, the HT
+00017590: 5450 2068 6561 6465 7222 7265 7175 6972  TP header"requir
+000175a0: 6573 2d6c 6561 6465 7222 2069 7320 7365  es-leader" is se
+000175b0: 7420 746f 0a22 7472 7565 222c 2061 6e64  t to."true", and
+000175c0: 2074 6869 7320 6865 6164 6572 2069 7320   this header is 
+000175d0: 6f62 7365 7276 6564 2062 7920 7468 6520  observed by the 
+000175e0: 7365 7276 6572 2c20 616e 6420 736f 2061  server, and so a
+000175f0: 206e 6f64 6520 7768 6963 6820 6973 206e   node which is n
+00017600: 6f74 2061 206c 6561 6465 720a 7468 6174  ot a leader.that
+00017610: 2072 6563 6569 7665 7320 7375 6368 2061   receives such a
+00017620: 2072 6571 7565 7374 2077 696c 6c20 7265   request will re
+00017630: 7475 726e 2061 6e20 6572 726f 722e 2054  turn an error. T
+00017640: 6869 7320 6572 726f 7220 6973 2064 6574  his error is det
+00017650: 6563 7465 6420 6279 2074 6865 2063 6c69  ected by the cli
+00017660: 656e 742c 0a77 6869 6368 2077 696c 6c20  ent,.which will 
+00017670: 7468 656e 2063 6c6f 7365 2074 6865 2063  then close the c
+00017680: 7572 7265 6e74 2067 5250 4320 636f 6e6e  urrent gRPC conn
+00017690: 6563 7469 6f6e 2061 6e64 2063 7265 6174  ection and creat
+000176a0: 6520 6120 6e65 7720 636f 6e6e 6563 7469  e a new connecti
+000176b0: 6f6e 2074 6f20 7468 650a 6c65 6164 6572  on to the.leader
+000176c0: 2e20 5468 6520 7265 7175 6573 7420 7769  . The request wi
+000176d0: 6c6c 2074 6865 6e20 6265 2072 6574 7269  ll then be retri
+000176e0: 6564 2077 6974 6820 7468 6520 6c65 6164  ed with the lead
+000176f0: 6572 2e0a 0a49 6620 7468 6520 636c 6965  er...If the clie
+00017700: 6e74 2773 206e 6f64 6520 7072 6566 6572  nt's node prefer
+00017710: 656e 6365 2069 7320 2266 6f6c 6c6f 7765  ence is "followe
+00017720: 7222 2061 6e64 2074 6865 7265 2061 7265  r" and there are
+00017730: 206e 6f20 666f 6c6c 6f77 6572 0a6e 6f64   no follower.nod
+00017740: 6573 2069 6e20 7468 6520 636c 7573 7465  es in the cluste
+00017750: 722c 2074 6865 6e20 7468 6520 636c 6965  r, then the clie
+00017760: 6e74 2077 696c 6c20 7261 6973 6520 616e  nt will raise an
+00017770: 2065 7863 6570 7469 6f6e 2e20 5369 6d69   exception. Simi
+00017780: 6c61 726c 792c 2069 6620 7468 650a 636c  larly, if the.cl
+00017790: 6965 6e74 2773 206e 6f64 6520 7072 6566  ient's node pref
+000177a0: 6572 656e 6365 2069 7320 2272 6561 646f  erence is "reado
+000177b0: 6e6c 7972 6570 6c69 6361 2220 616e 6420  nlyreplica" and 
+000177c0: 7468 6572 6520 6172 6520 6e6f 2072 6561  there are no rea
+000177d0: 642d 6f6e 6c79 2072 6570 6c69 6361 0a6e  d-only replica.n
+000177e0: 6f64 6573 2069 6e20 7468 6520 636c 7573  odes in the clus
+000177f0: 7465 722c 2074 6865 6e20 7468 6520 636c  ter, then the cl
+00017800: 6965 6e74 2077 696c 6c20 616c 736f 2072  ient will also r
+00017810: 6169 7365 2061 6e20 6578 6365 7074 696f  aise an exceptio
+00017820: 6e2e 0a0a 5468 6520 6752 5043 2063 6861  n...The gRPC cha
+00017830: 6e6e 656c 206f 7074 696f 6e20 2267 7270  nnel option "grp
+00017840: 632e 6d61 785f 7265 6365 6976 655f 6d65  c.max_receive_me
+00017850: 7373 6167 655f 6c65 6e67 7468 2220 6973  ssage_length" is
+00017860: 2061 7574 6f6d 6174 6963 616c 6c79 0a63   automatically.c
+00017870: 6f6e 6669 6775 7265 6420 746f 2074 6865  onfigured to the
+00017880: 2076 616c 7565 2060 3137 202a 2031 3032   value `17 * 102
+00017890: 3420 2a20 3130 3234 602e 2054 6869 7320  4 * 1024`. This 
+000178a0: 7661 6c75 6520 6361 6e6e 6f74 2062 6520  value cannot be 
+000178b0: 6368 616e 6765 642e 0a0a 0a23 2323 2052  changed....### R
+000178c0: 6567 756c 6172 2065 7870 7265 7373 696f  egular expressio
+000178d0: 6e20 6669 6c74 6572 730a 0a54 6865 2066  n filters..The f
+000178e0: 696c 7465 7220 6172 6775 6d65 6e74 7320  ilter arguments 
+000178f0: 696e 2060 7265 6164 5f61 6c6c 5f65 7665  in `read_all_eve
+00017900: 6e74 7328 2960 2c20 6073 7562 7363 7269  nts()`, `subscri
+00017910: 6265 5f61 6c6c 5f65 7665 6e74 7328 2960  be_all_events()`
+00017920: 2c0a 6063 7265 6174 655f 7375 6273 6372  ,.`create_subscr
+00017930: 6970 7469 6f6e 2829 6020 616e 6420 6067  iption()` and `g
+00017940: 6574 5f63 6f6d 6d69 745f 706f 7369 7469  et_commit_positi
+00017950: 6f6e 2829 6020 6172 6520 6170 706c 6965  on()` are applie
+00017960: 6420 746f 2074 6865 2060 7479 7065 600a  d to the `type`.
+00017970: 6174 7472 6962 7574 6520 6f66 2072 6563  attribute of rec
+00017980: 6f72 6465 6420 6576 656e 7473 2e0a 0a54  orded events...T
+00017990: 6865 2064 6566 6175 6c74 2076 616c 7565  he default value
+000179a0: 206f 6620 7468 6520 6066 696c 7465 725f   of the `filter_
+000179b0: 6578 636c 7564 6560 2061 7267 756d 656e  exclude` argumen
+000179c0: 7473 2069 7320 6465 7369 676e 6564 2074  ts is designed t
+000179d0: 6f20 6578 636c 7564 650a 4576 656e 7453  o exclude.EventS
+000179e0: 746f 7265 4442 2022 7379 7374 656d 2220  toreDB "system" 
+000179f0: 616e 6420 2270 6572 7369 7374 656e 6365  and "persistence
+00017a00: 2073 7562 7363 7269 7074 696f 6e20 636f   subscription co
+00017a10: 6e66 6967 2220 6576 656e 7473 2c20 7768  nfig" events, wh
+00017a20: 6963 680a 6f74 6865 7277 6973 6520 776f  ich.otherwise wo
+00017a30: 756c 6420 6265 2069 6e63 6c75 6465 642e  uld be included.
+00017a40: 2053 7973 7465 6d20 6576 656e 7473 2067   System events g
+00017a50: 656e 6572 6174 6564 2062 7920 4576 656e  enerated by Even
+00017a60: 7453 746f 7265 4442 2061 6c6c 0a68 6176  tStoreDB all.hav
+00017a70: 6520 6074 7970 6560 2073 7472 696e 6773  e `type` strings
+00017a80: 2074 6861 7420 7374 6172 7420 7769 7468   that start with
+00017a90: 2074 6865 2060 2460 2073 6967 6e2e 2050   the `$` sign. P
+00017aa0: 6572 7369 7374 656e 6365 2073 7562 7363  ersistence subsc
+00017ab0: 7269 7074 696f 6e0a 6576 656e 7473 2067  ription.events g
+00017ac0: 656e 6572 6174 6564 2077 6865 6e20 6d61  enerated when ma
+00017ad0: 6e69 7075 6c61 7469 6e67 2070 6572 7369  nipulating persi
+00017ae0: 7374 656e 6365 2073 7562 7363 7269 7074  stence subscript
+00017af0: 696f 6e73 2061 6c6c 2068 6176 6520 6074  ions all have `t
+00017b00: 7970 6560 0a73 7472 696e 6773 2074 6861  ype`.strings tha
+00017b10: 7420 7374 6172 7420 7769 7468 2060 5065  t start with `Pe
+00017b20: 7273 6973 7465 6e74 436f 6e66 6967 602e  rsistentConfig`.
+00017b30: 0a0a 466f 7220 6578 616d 706c 652c 2074  ..For example, t
+00017b40: 6f20 6d61 7463 6820 7468 6520 7479 7065  o match the type
+00017b50: 206f 6620 4576 656e 7453 746f 7265 4442   of EventStoreDB
+00017b60: 2073 7973 7465 6d20 6576 656e 7473 2c20   system events, 
+00017b70: 7573 6520 7468 6520 7265 6775 6c61 720a  use the regular.
+00017b80: 6578 7072 6573 7369 6f6e 2060 7227 5c24  expression `r'\$
+00017b90: 2e2b 2760 2e20 506c 6561 7365 206e 6f74  .+'`. Please not
+00017ba0: 652c 2074 6865 2063 6f6e 7374 616e 7420  e, the constant 
+00017bb0: 6045 5344 425f 5359 5354 454d 5f45 5645  `ESDB_SYSTEM_EVE
+00017bc0: 4e54 535f 5245 4745 5860 2069 730a 7365  NTS_REGEX` is.se
+00017bd0: 7420 746f 2060 7227 5c24 2e2b 2760 2e20  t to `r'\$.+'`. 
+00017be0: 596f 7520 6361 6e20 696d 706f 7274 2074  You can import t
+00017bf0: 6869 7320 7661 6c75 650a 2860 6672 6f6d  his value.(`from
+00017c00: 2065 7364 6263 6c69 656e 7420 696d 706f   esdbclient impo
+00017c10: 7274 2045 5344 425f 5359 5354 454d 5f45  rt ESDB_SYSTEM_E
+00017c20: 5645 4e54 535f 5245 4745 5860 2920 616e  VENTS_REGEX`) an
+00017c30: 6420 7573 650a 6974 2077 6865 6e20 6275  d use.it when bu
+00017c40: 696c 6469 6e67 206c 6f6e 6765 7220 7365  ilding longer se
+00017c50: 7175 656e 6365 7320 6f66 2072 6567 756c  quences of regul
+00017c60: 6172 2065 7870 7265 7373 696f 6e73 2e0a  ar expressions..
+00017c70: 0a53 696d 696c 6172 6c79 2c20 746f 206d  .Similarly, to m
+00017c80: 6174 6368 2074 6865 2074 7970 6520 6f66  atch the type of
+00017c90: 2045 7665 6e74 5374 6f72 6544 4220 7065   EventStoreDB pe
+00017ca0: 7273 6973 7465 6e63 6520 7375 6273 6372  rsistence subscr
+00017cb0: 6970 7469 6f6e 2065 7665 6e74 732c 2075  iption events, u
+00017cc0: 7365 2074 6865 0a72 6567 756c 6172 2065  se the.regular e
+00017cd0: 7870 7265 7373 696f 6e20 6072 2750 6572  xpression `r'Per
+00017ce0: 7369 7374 656e 7443 6f6e 6669 675c 642b  sistentConfig\d+
+00017cf0: 2760 2e20 5468 6520 636f 6e73 7461 6e74  '`. The constant
+00017d00: 2060 4553 4442 5f50 4552 5349 5354 454e   `ESDB_PERSISTEN
+00017d10: 545f 434f 4e46 4947 5f45 5645 4e54 535f  T_CONFIG_EVENTS_
+00017d20: 5245 4745 5860 0a69 7320 7365 7420 746f  REGEX`.is set to
+00017d30: 2060 7227 5065 7273 6973 7465 6e74 436f   `r'PersistentCo
+00017d40: 6e66 6967 5c64 2b27 602e 2059 6f75 2063  nfig\d+'`. You c
+00017d50: 616e 2061 6c73 6f20 696d 706f 7274 2074  an also import t
+00017d60: 6869 7320 7661 6c75 650a 2860 6672 6f6d  his value.(`from
+00017d70: 2065 7364 6263 6c69 656e 7420 696d 706f   esdbclient impo
+00017d80: 7274 2045 5344 425f 5045 5253 4953 5445  rt ESDB_PERSISTE
+00017d90: 4e54 5f43 4f4e 4649 475f 4556 454e 5453  NT_CONFIG_EVENTS
+00017da0: 5f52 4547 4558 6029 2061 6e64 2075 7365  _REGEX`) and use
+00017db0: 2069 7420 7768 656e 2062 7569 6c64 696e   it when buildin
+00017dc0: 670a 6c6f 6e67 6572 2073 6571 7565 6e63  g.longer sequenc
+00017dd0: 6573 206f 6620 7265 6775 6c61 7220 6578  es of regular ex
+00017de0: 7072 6573 7369 6f6e 732e 0a0a 5468 6520  pressions...The 
+00017df0: 636f 6e73 7461 6e74 2060 4445 4641 554c  constant `DEFAUL
+00017e00: 545f 4558 434c 5544 455f 4649 4c54 4552  T_EXCLUDE_FILTER
+00017e10: 6020 6973 2061 2073 6571 7565 6e63 6520  ` is a sequence 
+00017e20: 6f66 2072 6567 756c 6172 2065 7870 7265  of regular expre
+00017e30: 7373 696f 6e73 2074 6861 7420 6d61 7463  ssions that matc
+00017e40: 680a 7468 6520 6576 656e 7473 2074 6861  h.the events tha
+00017e50: 7420 4576 656e 7453 746f 7265 4442 2067  t EventStoreDB g
+00017e60: 656e 6572 6174 6573 2069 6e74 6572 6e61  enerates interna
+00017e70: 6c6c 792c 2065 7665 6e74 7320 7468 6174  lly, events that
+00017e80: 2061 7265 2065 7874 7261 6e65 6f75 7320   are extraneous 
+00017e90: 746f 2074 686f 7365 0a77 6869 6368 2079  to those.which y
+00017ea0: 6f75 2061 7070 656e 6420 7573 696e 6720  ou append using 
+00017eb0: 7468 6520 6061 7070 656e 645f 6576 656e  the `append_even
+00017ec0: 7473 2829 6020 6d65 7468 6f64 2e0a 0a0a  ts()` method....
+00017ed0: 2323 2320 4e65 7720 6576 656e 7420 6f62  ### New event ob
+00017ee0: 6a65 6374 730a 0a54 6865 2060 4e65 7745  jects..The `NewE
+00017ef0: 7665 6e74 6020 636c 6173 7320 6973 2075  vent` class is u
+00017f00: 7365 6420 7768 656e 2061 7070 656e 6469  sed when appendi
+00017f10: 6e67 2065 7665 6e74 732e 0a0a 5468 6520  ng events...The 
+00017f20: 7265 7175 6972 6564 2061 7267 756d 656e  required argumen
+00017f30: 7420 6074 7970 6560 2069 7320 6120 5079  t `type` is a Py
+00017f40: 7468 6f6e 2060 7374 7260 2c20 7573 6564  thon `str`, used
+00017f50: 2074 6f20 696e 6469 6361 7465 2074 6865   to indicate the
+00017f60: 2074 7970 6520 6f66 0a74 6865 2065 7665   type of.the eve
+00017f70: 6e74 2074 6861 7420 7769 6c6c 2062 6520  nt that will be 
+00017f80: 7265 636f 7264 6564 2e0a 0a54 6865 2072  recorded...The r
+00017f90: 6571 7569 7265 6420 6172 6775 6d65 6e74  equired argument
+00017fa0: 2060 6461 7461 6020 6973 2061 2050 7974   `data` is a Pyt
+00017fb0: 686f 6e20 6062 7974 6573 6020 6f62 6a65  hon `bytes` obje
+00017fc0: 6374 2c20 7573 6564 2074 6f20 696e 6469  ct, used to indi
+00017fd0: 6361 7465 2074 6865 2064 6174 6120 6f66  cate the data of
+00017fe0: 0a74 6865 2065 7665 6e74 2074 6861 7420  .the event that 
+00017ff0: 7769 6c6c 2062 6520 7265 636f 7264 6564  will be recorded
+00018000: 2e0a 0a54 6865 206f 7074 696f 6e61 6c20  ...The optional 
+00018010: 6172 6775 6d65 6e74 2060 6d65 7461 6461  argument `metada
+00018020: 7461 6020 6973 2061 2050 7974 686f 6e20  ta` is a Python 
+00018030: 6062 7974 6573 6020 6f62 6a65 6374 2c20  `bytes` object, 
+00018040: 7573 6564 2074 6f20 696e 6469 6361 7465  used to indicate
+00018050: 2061 6e79 0a6d 6574 6164 6174 6120 6f66   any.metadata of
+00018060: 2074 6865 2065 7665 6e74 2074 6861 7420   the event that 
+00018070: 7769 6c6c 2062 6520 7265 636f 7264 6564  will be recorded
+00018080: 2e20 5468 6520 6465 6661 756c 7420 7661  . The default va
+00018090: 6c75 6520 6973 2061 6e20 656d 7074 7920  lue is an empty 
+000180a0: 6062 7974 6573 600a 6f62 6a65 6374 2e0a  `bytes`.object..
+000180b0: 0a54 6865 206f 7074 696f 6e61 6c20 6172  .The optional ar
+000180c0: 6775 6d65 6e74 2060 636f 6e74 656e 745f  gument `content_
+000180d0: 7479 7065 6020 6973 2061 2050 7974 686f  type` is a Pytho
+000180e0: 6e20 6073 7472 602c 2075 7365 6420 746f  n `str`, used to
+000180f0: 2069 6e64 6963 6174 6520 7468 650a 7479   indicate the.ty
+00018100: 7065 206f 6620 7468 6520 6461 7461 2074  pe of the data t
+00018110: 6861 7420 7769 6c6c 2062 6520 7265 636f  hat will be reco
+00018120: 7264 6564 2066 6f72 2074 6869 7320 6576  rded for this ev
+00018130: 656e 742e 2054 6865 2064 6566 6175 6c74  ent. The default
+00018140: 2076 616c 7565 2069 730a 6061 7070 6c69   value is.`appli
+00018150: 6361 7469 6f6e 2f6a 736f 6e60 2c20 7768  cation/json`, wh
+00018160: 6963 6820 696e 6469 6361 7465 7320 7468  ich indicates th
+00018170: 6174 2074 6865 2060 6461 7461 6020 7761  at the `data` wa
+00018180: 7320 7365 7269 616c 6973 6564 2075 7369  s serialised usi
+00018190: 6e67 204a 534f 4e2e 0a41 6e20 616c 7465  ng JSON..An alte
+000181a0: 726e 6174 6976 6520 7661 6c75 6520 666f  rnative value fo
+000181b0: 7220 7468 6973 2061 7267 756d 656e 7420  r this argument 
+000181c0: 6973 2060 6170 706c 6963 6174 696f 6e2f  is `application/
+000181d0: 6f63 7465 742d 7374 7265 616d 602e 0a0a  octet-stream`...
+000181e0: 5468 6520 6f70 7469 6f6e 616c 2061 7267  The optional arg
+000181f0: 756d 656e 7420 6069 6460 2069 7320 6120  ument `id` is a 
+00018200: 5079 7468 6f6e 2060 5555 4944 6020 6f62  Python `UUID` ob
+00018210: 6a65 6374 2c20 7573 6564 2074 6f20 7370  ject, used to sp
+00018220: 6563 6966 7920 7468 6520 756e 6971 7565  ecify the unique
+00018230: 2049 440a 6f66 2074 6865 2065 7665 6e74   ID.of the event
+00018240: 2074 6861 7420 7769 6c6c 2062 6520 7265   that will be re
+00018250: 636f 7264 6564 2e20 5468 6973 2076 616c  corded. This val
+00018260: 7565 2077 696c 6c20 6465 6661 756c 7420  ue will default 
+00018270: 746f 2061 206e 6577 2076 6572 7369 6f6e  to a new version
+00018280: 2d34 2055 5549 442e 0a0a 6060 6070 7974  -4 UUID...```pyt
+00018290: 686f 6e0a 6e65 775f 6576 656e 7431 203d  hon.new_event1 =
+000182a0: 204e 6577 4576 656e 7428 0a20 2020 2074   NewEvent(.    t
+000182b0: 7970 653d 274f 7264 6572 4372 6561 7465  ype='OrderCreate
+000182c0: 6427 2c0a 2020 2020 6461 7461 3d62 277b  d',.    data=b'{
+000182d0: 226e 616d 6522 3a20 2247 7265 6722 7d27  "name": "Greg"}'
+000182e0: 2c0a 290a 6173 7365 7274 206e 6577 5f65  ,.).assert new_e
+000182f0: 7665 6e74 312e 7479 7065 203d 3d20 274f  vent1.type == 'O
+00018300: 7264 6572 4372 6561 7465 6427 0a61 7373  rderCreated'.ass
+00018310: 6572 7420 6e65 775f 6576 656e 7431 2e64  ert new_event1.d
+00018320: 6174 6120 3d3d 2062 277b 226e 616d 6522  ata == b'{"name"
+00018330: 3a20 2247 7265 6722 7d27 0a61 7373 6572  : "Greg"}'.asser
+00018340: 7420 6e65 775f 6576 656e 7431 2e6d 6574  t new_event1.met
+00018350: 6164 6174 6120 3d3d 2062 2727 0a61 7373  adata == b''.ass
+00018360: 6572 7420 6e65 775f 6576 656e 7431 2e63  ert new_event1.c
+00018370: 6f6e 7465 6e74 5f74 7970 6520 3d3d 2027  ontent_type == '
+00018380: 6170 706c 6963 6174 696f 6e2f 6a73 6f6e  application/json
+00018390: 270a 6173 7365 7274 2069 7369 6e73 7461  '.assert isinsta
+000183a0: 6e63 6528 6e65 775f 6576 656e 7431 2e69  nce(new_event1.i
+000183b0: 642c 2055 5549 4429 0a0a 6576 656e 745f  d, UUID)..event_
+000183c0: 6964 203d 2075 7569 6434 2829 0a6e 6577  id = uuid4().new
+000183d0: 5f65 7665 6e74 3220 3d20 4e65 7745 7665  _event2 = NewEve
+000183e0: 6e74 280a 2020 2020 7479 7065 3d27 496d  nt(.    type='Im
+000183f0: 6167 6543 7265 6174 6564 272c 0a20 2020  ageCreated',.   
+00018400: 2064 6174 613d 6227 3031 3031 3031 3031   data=b'01010101
+00018410: 3031 3031 3031 272c 0a20 2020 206d 6574  010101',.    met
+00018420: 6164 6174 613d 6227 7b22 6122 3a20 317d  adata=b'{"a": 1}
+00018430: 272c 0a20 2020 2063 6f6e 7465 6e74 5f74  ',.    content_t
+00018440: 7970 653d 2761 7070 6c69 6361 7469 6f6e  ype='application
+00018450: 2f6f 6374 6574 2d73 7472 6561 6d27 2c0a  /octet-stream',.
+00018460: 2020 2020 6964 3d65 7665 6e74 5f69 642c      id=event_id,
+00018470: 0a29 0a61 7373 6572 7420 6e65 775f 6576  .).assert new_ev
+00018480: 656e 7432 2e74 7970 6520 3d3d 2027 496d  ent2.type == 'Im
+00018490: 6167 6543 7265 6174 6564 270a 6173 7365  ageCreated'.asse
+000184a0: 7274 206e 6577 5f65 7665 6e74 322e 6461  rt new_event2.da
+000184b0: 7461 203d 3d20 6227 3031 3031 3031 3031  ta == b'01010101
+000184c0: 3031 3031 3031 270a 6173 7365 7274 206e  010101'.assert n
+000184d0: 6577 5f65 7665 6e74 322e 6d65 7461 6461  ew_event2.metada
+000184e0: 7461 203d 3d20 6227 7b22 6122 3a20 317d  ta == b'{"a": 1}
+000184f0: 270a 6173 7365 7274 206e 6577 5f65 7665  '.assert new_eve
+00018500: 6e74 322e 636f 6e74 656e 745f 7479 7065  nt2.content_type
+00018510: 203d 3d20 2761 7070 6c69 6361 7469 6f6e   == 'application
+00018520: 2f6f 6374 6574 2d73 7472 6561 6d27 0a61  /octet-stream'.a
+00018530: 7373 6572 7420 6e65 775f 6576 656e 7432  ssert new_event2
+00018540: 2e69 6420 3d3d 2065 7665 6e74 5f69 640a  .id == event_id.
+00018550: 6060 600a 0a23 2323 2052 6563 6f72 6465  ```..### Recorde
+00018560: 6420 6576 656e 7420 6f62 6a65 6374 730a  d event objects.
+00018570: 0a54 6865 2060 5265 636f 7264 6564 4576  .The `RecordedEv
+00018580: 656e 7460 2063 6c61 7373 2069 7320 7573  ent` class is us
+00018590: 6564 2077 6865 6e20 7265 6164 696e 6720  ed when reading 
+000185a0: 6576 656e 7473 2e0a 0a54 6865 2061 7474  events...The att
+000185b0: 7269 6275 7465 2060 7479 7065 6020 6973  ribute `type` is
+000185c0: 2061 2050 7974 686f 6e20 6073 7472 602c   a Python `str`,
+000185d0: 2075 7365 6420 746f 2069 6e64 6963 6174   used to indicat
+000185e0: 6520 7468 6520 7479 7065 206f 6620 6576  e the type of ev
+000185f0: 656e 740a 7468 6174 2077 6173 2072 6563  ent.that was rec
+00018600: 6f72 6465 642e 0a0a 5468 6520 6174 7472  orded...The attr
+00018610: 6962 7574 6520 6064 6174 6160 2069 7320  ibute `data` is 
+00018620: 6120 5079 7468 6f6e 2060 6279 7465 7360  a Python `bytes`
+00018630: 206f 626a 6563 742c 2075 7365 6420 746f   object, used to
+00018640: 2069 6e64 6963 6174 6520 7468 6520 6461   indicate the da
+00018650: 7461 206f 6620 7468 650a 6576 656e 7420  ta of the.event 
+00018660: 7468 6174 2077 6173 2072 6563 6f72 6465  that was recorde
+00018670: 642e 0a0a 5468 6520 6174 7472 6962 7574  d...The attribut
+00018680: 6520 606d 6574 6164 6174 6160 2069 7320  e `metadata` is 
+00018690: 6120 5079 7468 6f6e 2060 6279 7465 7360  a Python `bytes`
+000186a0: 206f 626a 6563 742c 2075 7365 6420 746f   object, used to
+000186b0: 2069 6e64 6963 6174 6520 7468 6520 6d65   indicate the me
+000186c0: 7461 6461 7461 206f 660a 7468 6520 6576  tadata of.the ev
+000186d0: 656e 7420 7468 6174 2077 6173 2072 6563  ent that was rec
+000186e0: 6f72 6465 642e 0a0a 5468 6520 6174 7472  orded...The attr
+000186f0: 6962 7574 6520 6063 6f6e 7465 6e74 5f74  ibute `content_t
+00018700: 7970 6560 2069 7320 6120 5079 7468 6f6e  ype` is a Python
+00018710: 2060 7374 7260 2c20 7573 6564 2074 6f20   `str`, used to 
+00018720: 696e 6469 6361 7465 2074 6865 2074 7970  indicate the typ
+00018730: 6520 6f66 0a64 6174 6120 7468 6174 2077  e of.data that w
+00018740: 6173 2072 6563 6f72 6465 6420 666f 7220  as recorded for 
+00018750: 7468 6973 2065 7665 6e74 2028 7573 7561  this event (usua
+00018760: 6c6c 7920 6061 7070 6c69 6361 7469 6f6e  lly `application
+00018770: 2f6a 736f 6e60 2074 6f20 696e 6469 6361  /json` to indica
+00018780: 7465 2074 6861 740a 7468 6973 2064 6174  te that.this dat
+00018790: 6120 6361 6e20 6265 2070 6172 7365 6420  a can be parsed 
+000187a0: 6173 204a 534f 4e2c 2062 7574 2061 6c74  as JSON, but alt
+000187b0: 6572 6e61 7469 7665 6c79 2060 6170 706c  ernatively `appl
+000187c0: 6963 6174 696f 6e2f 6f63 7465 742d 7374  ication/octet-st
+000187d0: 7265 616d 6020 746f 0a69 6e64 6963 6174  ream` to.indicat
+000187e0: 6520 7468 6174 2069 7420 6973 2073 6f6d  e that it is som
+000187f0: 6574 6869 6e67 2065 6c73 6529 2e0a 0a54  ething else)...T
+00018800: 6865 2061 7474 7269 6275 7465 2060 6964  he attribute `id
+00018810: 6020 6973 2061 2050 7974 686f 6e20 6055  ` is a Python `U
+00018820: 5549 4460 206f 626a 6563 742c 2075 7365  UID` object, use
+00018830: 6420 746f 2069 6e64 6963 6174 6520 7468  d to indicate th
+00018840: 6520 756e 6971 7565 2049 4420 6f66 2074  e unique ID of t
+00018850: 6865 0a65 7665 6e74 2074 6861 7420 7761  he.event that wa
+00018860: 7320 7265 636f 7264 6564 2e20 506c 6561  s recorded. Plea
+00018870: 7365 206e 6f74 652c 2077 6865 6e20 7265  se note, when re
+00018880: 636f 7264 6564 2065 7665 6e74 7320 6172  corded events ar
+00018890: 6520 7265 7475 726e 6564 2066 726f 6d20  e returned from 
+000188a0: 6120 6361 6c6c 0a74 6f20 6072 6561 645f  a call.to `read_
+000188b0: 7374 7265 616d 5f65 7665 6e74 7328 2960  stream_events()`
+000188c0: 2069 6e20 4576 656e 7453 746f 7265 4442   in EventStoreDB
+000188d0: 2076 3231 2e31 302c 2074 6865 2063 6f6d   v21.10, the com
+000188e0: 6d69 7420 706f 7369 7469 6f6e 2069 7320  mit position is 
+000188f0: 6e6f 7420 6163 7475 616c 6c79 0a73 6574  not actually.set
+00018900: 2069 6e20 7468 6520 7265 7370 6f6e 7365   in the response
+00018910: 2e20 5468 6973 2061 7474 7269 6275 7465  . This attribute
+00018920: 2069 7320 7479 7065 6420 6173 2061 6e20   is typed as an 
+00018930: 6f70 7469 6f6e 616c 2076 616c 7565 2028  optional value (
+00018940: 604f 7074 696f 6e61 6c5b 5555 4944 5d60  `Optional[UUID]`
+00018950: 292c 0a61 6e64 2069 6e20 7468 6520 6361  ),.and in the ca
+00018960: 7365 206f 6620 7573 696e 6720 4576 656e  se of using Even
+00018970: 7453 746f 7265 4442 2076 3231 2e31 3020  tStoreDB v21.10 
+00018980: 7468 6520 7661 6c75 6520 6f66 2074 6869  the value of thi
+00018990: 7320 6174 7472 6962 7574 6520 7769 6c6c  s attribute will
+000189a0: 2062 6520 604e 6f6e 6560 0a77 6865 6e20   be `None`.when 
+000189b0: 7265 6164 696e 6720 7265 636f 7264 6564  reading recorded
+000189c0: 2065 7665 6e74 7320 6672 6f6d 2061 2073   events from a s
+000189d0: 7472 6561 6d2e 2052 6563 6f72 6465 6420  tream. Recorded 
+000189e0: 6576 656e 7473 2077 696c 6c20 686f 7765  events will howe
+000189f0: 7665 7220 6861 7665 2074 6869 730a 7661  ver have this.va
+00018a00: 6c75 6573 2073 6574 2077 6865 6e20 7265  lues set when re
+00018a10: 6164 696e 6720 7265 636f 7264 6564 2065  ading recorded e
+00018a20: 7665 6e74 7320 6672 6f6d 2060 7265 6164  vents from `read
+00018a30: 5f61 6c6c 5f65 7665 6e74 7328 2960 2061  _all_events()` a
+00018a40: 6e64 2066 726f 6d20 626f 7468 0a63 6174  nd from both.cat
+00018a50: 6368 2d75 7020 616e 6420 7065 7273 6973  ch-up and persis
+00018a60: 7465 6e74 2073 7562 7363 7269 7074 696f  tent subscriptio
+00018a70: 6e73 2e0a 0a54 6865 2061 7474 7269 6275  ns...The attribu
+00018a80: 7465 2060 7374 7265 616d 5f6e 616d 6560  te `stream_name`
+00018a90: 2069 7320 6120 5079 7468 6f6e 2060 7374   is a Python `st
+00018aa0: 7260 2c20 7573 6564 2074 6f20 696e 6469  r`, used to indi
+00018ab0: 6361 7465 2074 6865 206e 616d 6520 6f66  cate the name of
+00018ac0: 2074 6865 0a73 7472 6561 6d20 696e 2077   the.stream in w
+00018ad0: 6869 6368 2074 6865 2065 7665 6e74 2077  hich the event w
+00018ae0: 6173 2072 6563 6f72 6465 642e 0a0a 5468  as recorded...Th
+00018af0: 6520 6174 7472 6962 7574 6520 6073 7472  e attribute `str
+00018b00: 6561 6d5f 706f 7369 7469 6f6e 6020 6973  eam_position` is
+00018b10: 2061 2050 7974 686f 6e20 6069 6e74 602c   a Python `int`,
+00018b20: 2075 7365 6420 746f 2069 6e64 6963 6174   used to indicat
+00018b30: 6520 7468 6520 706f 7369 7469 6f6e 2069  e the position i
+00018b40: 6e20 7468 650a 7374 7265 616d 2061 7420  n the.stream at 
+00018b50: 7768 6963 6820 7468 6520 6576 656e 7420  which the event 
+00018b60: 7761 7320 7265 636f 7264 6564 2e0a 0a54  was recorded...T
+00018b70: 6865 2061 7474 7269 6275 7465 2060 636f  he attribute `co
+00018b80: 6d6d 6974 5f70 6f73 6974 696f 6e60 2069  mmit_position` i
+00018b90: 7320 6120 5079 7468 6f6e 2060 696e 7460  s a Python `int`
+00018ba0: 2c20 7573 6564 2074 6f20 696e 6469 6361  , used to indica
+00018bb0: 7465 2074 6865 2063 6f6d 6d69 7420 706f  te the commit po
+00018bc0: 7369 7469 6f6e 0a61 7420 7768 6963 6820  sition.at which 
+00018bd0: 7468 6520 6576 656e 7420 7761 7320 7265  the event was re
+00018be0: 636f 7264 6564 2e0a 0a60 6060 7079 7468  corded...```pyth
+00018bf0: 6f6e 0a66 726f 6d20 6573 6462 636c 6965  on.from esdbclie
+00018c00: 6e74 2e65 7665 6e74 7320 696d 706f 7274  nt.events import
+00018c10: 2052 6563 6f72 6465 6445 7665 6e74 0a0a   RecordedEvent..
+00018c20: 7265 636f 7264 6564 5f65 7665 6e74 203d  recorded_event =
+00018c30: 2052 6563 6f72 6465 6445 7665 6e74 280a   RecordedEvent(.
+00018c40: 2020 2020 7479 7065 3d27 4f72 6465 7243      type='OrderC
+00018c50: 7265 6174 6564 272c 0a20 2020 2064 6174  reated',.    dat
+00018c60: 613d 6227 7b7d 272c 0a20 2020 206d 6574  a=b'{}',.    met
+00018c70: 6164 6174 613d 6227 272c 0a20 2020 2063  adata=b'',.    c
+00018c80: 6f6e 7465 6e74 5f74 7970 653d 2761 7070  ontent_type='app
+00018c90: 6c69 6361 7469 6f6e 2f6a 736f 6e27 2c0a  lication/json',.
+00018ca0: 2020 2020 6964 3d75 7569 6434 2829 2c0a      id=uuid4(),.
+00018cb0: 2020 2020 7374 7265 616d 5f6e 616d 653d      stream_name=
+00018cc0: 2773 7472 6561 6d31 272c 0a20 2020 2073  'stream1',.    s
+00018cd0: 7472 6561 6d5f 706f 7369 7469 6f6e 3d30  tream_position=0
+00018ce0: 2c0a 2020 2020 636f 6d6d 6974 5f70 6f73  ,.    commit_pos
+00018cf0: 6974 696f 6e3d 3531 322c 0a29 0a60 6060  ition=512,.).```
+00018d00: 0a0a 2323 2320 4173 796e 6369 6f20 636c  ..### Asyncio cl
+00018d10: 6965 6e74 0a0a 5468 6520 6065 7364 6263  ient..The `esdbc
+00018d20: 6c69 656e 7460 2070 6163 6b61 6765 2061  lient` package a
+00018d30: 6c73 6f20 696e 636c 7564 6573 2061 6e20  lso includes an 
+00018d40: 6561 726c 7920 7665 7273 696f 6e20 6f66  early version of
+00018d50: 2061 6e20 6173 796e 6368 726f 6e6f 7573   an asynchronous
+00018d60: 2049 2f4f 0a67 5250 4320 5079 7468 6f6e   I/O.gRPC Python
+00018d70: 2063 6c69 656e 742e 2049 7420 666f 6c6c   client. It foll
+00018d80: 6f77 7320 6578 6163 746c 7920 7468 6520  ows exactly the 
+00018d90: 7361 6d65 2062 6568 6176 696f 7273 2061  same behaviors a
+00018da0: 7320 7468 6520 6d75 6c74 6974 6872 6561  s the multithrea
+00018db0: 6465 640a 6045 5344 4243 6c69 656e 7460  ded.`ESDBClient`
+00018dc0: 2c20 6275 7420 7573 6573 2074 6865 2060  , but uses the `
+00018dd0: 6772 7063 2e61 696f 6020 7061 636b 6167  grpc.aio` packag
+00018de0: 6520 616e 6420 7468 6520 6061 7379 6e63  e and the `async
+00018df0: 696f 6020 6d6f 6475 6c65 2c20 696e 7374  io` module, inst
+00018e00: 6561 6420 6f66 0a60 6772 7063 6020 616e  ead of.`grpc` an
+00018e10: 6420 6074 6872 6561 6469 6e67 602e 0a0a  d `threading`...
+00018e20: 5468 6520 6061 7379 6e63 6020 6675 6e63  The `async` func
+00018e30: 7469 6f6e 2060 4173 796e 6369 6f45 5344  tion `AsyncioESD
+00018e40: 4243 6c69 656e 7460 2063 6f6e 7374 7275  BClient` constru
+00018e50: 6374 7320 7468 6520 636c 6965 6e74 2c20  cts the client, 
+00018e60: 616e 6420 636f 6e6e 6563 7473 2074 6f0a  and connects to.
+00018e70: 6120 7365 7276 6572 2e20 4974 2063 616e  a server. It can
+00018e80: 2062 6520 696d 706f 7274 6564 2066 726f   be imported fro
+00018e90: 6d20 6065 7364 6263 6c69 656e 7460 2c20  m `esdbclient`, 
+00018ea0: 616e 6420 6361 6e20 6265 2063 616c 6c65  and can be calle
+00018eb0: 6420 7769 7468 2074 6865 2073 616d 650a  d with the same.
+00018ec0: 6172 6775 6d65 6e74 7320 6173 2060 4553  arguments as `ES
+00018ed0: 4442 436c 6965 6e74 602e 2049 7420 7375  DBClient`. It su
+00018ee0: 7070 6f72 7473 2062 6f74 6820 7468 6520  pports both the 
+00018ef0: 2265 7364 6222 2061 6e64 2074 6865 2022  "esdb" and the "
+00018f00: 6573 6462 2b64 6973 636f 7665 7222 0a63  esdb+discover".c
+00018f10: 6f6e 6e65 6374 696f 6e20 7374 7269 6e67  onnection string
+00018f20: 2055 5249 2073 6368 656d 6573 2c20 616e   URI schemes, an
+00018f30: 6420 7265 636f 6e6e 6563 7473 2061 6e64  d reconnects and
+00018f40: 2072 6574 7269 6573 206d 6574 686f 6473   retries methods
+00018f50: 2077 6865 6e20 636f 6e6e 6563 7469 6f6e   when connection
+00018f60: 0a69 7373 7565 7320 6172 6520 656e 636f  .issues are enco
+00018f70: 756e 7465 7265 642c 206a 7573 7420 6c69  untered, just li
+00018f80: 6b65 2060 4553 4442 436c 6965 6e74 602e  ke `ESDBClient`.
+00018f90: 0a0a 6060 6070 7974 686f 6e0a 6672 6f6d  ..```python.from
+00018fa0: 2065 7364 6263 6c69 656e 7420 696d 706f   esdbclient impo
+00018fb0: 7274 2041 7379 6e63 696f 4553 4442 436c  rt AsyncioESDBCl
+00018fc0: 6965 6e74 0a60 6060 0a0a 5468 6520 6173  ient.```..The as
+00018fd0: 796e 6368 726f 6e6f 7573 2049 2f4f 2063  ynchronous I/O c
+00018fe0: 6c69 656e 7420 6861 7320 6061 7379 6e63  lient has `async
+00018ff0: 6020 6d65 7468 6f64 7320 6061 7070 656e  ` methods `appen
+00019000: 645f 6576 656e 7473 2829 602c 0a60 7265  d_events()`,.`re
+00019010: 6164 5f73 7472 6561 6d5f 6576 656e 7473  ad_stream_events
+00019020: 2829 602c 2060 7265 6164 5f61 6c6c 5f65  ()`, `read_all_e
+00019030: 7665 6e74 7328 2960 2c20 6073 7562 7363  vents()`, `subsc
+00019040: 7269 6265 5f61 6c6c 5f65 7665 6e74 7328  ribe_all_events(
+00019050: 2960 2c0a 6064 656c 6574 655f 7374 7265  )`,.`delete_stre
+00019060: 616d 2829 602c 2060 746f 6d62 7374 6f6e  am()`, `tombston
+00019070: 655f 7374 7265 616d 2829 602c 2061 6e64  e_stream()`, and
+00019080: 2060 7265 636f 6e6e 6563 7428 2960 2e0a   `reconnect()`..
+00019090: 0a54 6865 7365 206d 6574 686f 6473 2061  .These methods a
+000190a0: 7265 2065 7175 6976 616c 656e 7420 746f  re equivalent to
+000190b0: 2074 6865 206d 6574 686f 6473 206f 6e20   the methods on 
+000190c0: 6045 5344 4243 6c69 656e 7460 2e20 5468  `ESDBClient`. Th
+000190d0: 6579 2068 6176 6520 7468 6520 7361 6d65  ey have the same
+000190e0: 0a6d 6574 686f 6420 7369 676e 6174 7572  .method signatur
+000190f0: 6573 2c20 616e 6420 6361 6e20 6265 2063  es, and can be c
+00019100: 616c 6c65 6420 7769 7468 2074 6865 2073  alled with the s
+00019110: 616d 6520 6172 6775 6d65 6e74 732c 2074  ame arguments, t
+00019120: 6f20 7468 6520 7361 6d65 2065 6666 6563  o the same effec
+00019130: 742e 0a54 6865 206d 6574 686f 6473 2077  t..The methods w
+00019140: 6869 6368 2061 7070 6561 7220 6f6e 2060  hich appear on `
+00019150: 4553 4442 436c 6965 6e74 6020 6275 7420  ESDBClient` but 
+00019160: 6e6f 7420 6f6e 2060 4173 796e 6369 6f45  not on `AsyncioE
+00019170: 5344 4243 6c69 656e 7460 2077 696c 6c20  SDBClient` will 
+00019180: 6265 0a61 6464 6564 2073 6f6f 6e2e 0a0a  be.added soon...
+00019190: 5468 6520 6578 616d 706c 6520 6265 6c6f  The example belo
+000191a0: 7720 6465 6d6f 6e73 7472 6174 6573 2074  w demonstrates t
+000191b0: 6865 2060 6170 7065 6e64 5f65 7665 6e74  he `append_event
+000191c0: 7328 2960 2c20 6072 6561 645f 7374 7265  s()`, `read_stre
+000191d0: 616d 5f65 7665 6e74 7328 2960 2061 6e64  am_events()` and
+000191e0: 0a60 7375 6273 6372 6962 655f 616c 6c5f  .`subscribe_all_
+000191f0: 6576 656e 7473 2829 6020 6d65 7468 6f64  events()` method
+00019200: 732e 2054 6865 7365 2061 7265 2074 6865  s. These are the
+00019210: 206d 6f73 7420 7573 6566 756c 206d 6574   most useful met
+00019220: 686f 6473 2066 6f72 2077 7269 7469 6e67  hods for writing
+00019230: 0a61 6e20 6576 656e 742d 736f 7572 6365  .an event-source
+00019240: 6420 6170 706c 6963 6174 696f 6e2c 2061  d application, a
+00019250: 6c6c 6f77 696e 6720 6e65 7720 6167 6772  llowing new aggr
+00019260: 6567 6174 6520 6576 656e 7473 2074 6f20  egate events to 
+00019270: 6265 2072 6563 6f72 6465 642c 2074 6865  be recorded, the
+00019280: 0a72 6563 6f72 6465 6420 6576 656e 7473  .recorded events
+00019290: 206f 6620 616e 2061 6767 7265 6761 7465   of an aggregate
+000192a0: 2074 6f20 6265 206f 6274 6169 6e65 6420   to be obtained 
+000192b0: 736f 2061 6767 7265 6761 7465 7320 6361  so aggregates ca
+000192c0: 6e20 6265 2072 6563 6f6e 7374 7275 6374  n be reconstruct
+000192d0: 6564 2c0a 616e 6420 7468 6520 7374 6174  ed,.and the stat
+000192e0: 6520 6f66 2061 6e20 6170 706c 6963 6174  e of an applicat
+000192f0: 696f 6e20 746f 2070 726f 7061 6761 7465  ion to propagate
+00019300: 6420 616e 6420 7072 6f63 6573 7365 6420  d and processed 
+00019310: 7769 7468 2022 6578 6163 746c 792d 6f6e  with "exactly-on
+00019320: 6365 220a 7365 6d61 6e74 6963 732e 0a0a  ce".semantics...
+00019330: 6060 6070 7974 686f 6e0a 696d 706f 7274  ```python.import
+00019340: 2061 7379 6e63 696f 0a0a 6173 796e 6320   asyncio..async 
+00019350: 6465 6620 6465 6d6f 6e73 7472 6174 655f  def demonstrate_
+00019360: 6173 796e 6369 6f5f 636c 6965 6e74 2829  asyncio_client()
+00019370: 3a0a 0a20 2020 2023 2043 6f6e 7374 7275  :..    # Constru
+00019380: 6374 2063 6c69 656e 742e 0a20 2020 2063  ct client..    c
+00019390: 6c69 656e 7420 3d20 6177 6169 7420 4173  lient = await As
+000193a0: 796e 6369 6f45 5344 4243 6c69 656e 7428  yncioESDBClient(
+000193b0: 0a20 2020 2020 2020 2075 7269 3d6f 732e  .        uri=os.
+000193c0: 6765 7465 6e76 2822 4553 4442 5f55 5249  getenv("ESDB_URI
+000193d0: 2229 2c0a 2020 2020 2020 2020 726f 6f74  "),.        root
+000193e0: 5f63 6572 7469 6669 6361 7465 733d 6f73  _certificates=os
+000193f0: 2e67 6574 656e 7628 2245 5344 425f 524f  .getenv("ESDB_RO
+00019400: 4f54 5f43 4552 5449 4649 4341 5445 5322  OT_CERTIFICATES"
+00019410: 292c 0a20 2020 2029 0a0a 2020 2020 2320  ),.    )..    # 
+00019420: 4170 7065 6e64 2065 7665 6e74 732e 0a20  Append events.. 
+00019430: 2020 2073 7472 6561 6d5f 6e61 6d65 203d     stream_name =
+00019440: 2073 7472 2875 7569 6434 2829 290a 2020   str(uuid4()).  
+00019450: 2020 6576 656e 7431 203d 204e 6577 4576    event1 = NewEv
+00019460: 656e 7428 224f 7264 6572 4372 6561 7465  ent("OrderCreate
+00019470: 6422 2c20 6461 7461 3d62 277b 7d27 290a  d", data=b'{}').
+00019480: 2020 2020 6576 656e 7432 203d 204e 6577      event2 = New
+00019490: 4576 656e 7428 224f 7264 6572 5570 6461  Event("OrderUpda
+000194a0: 7465 6422 2c20 6461 7461 3d62 277b 7d27  ted", data=b'{}'
+000194b0: 290a 2020 2020 6576 656e 7433 203d 204e  ).    event3 = N
+000194c0: 6577 4576 656e 7428 224f 7264 6572 4465  ewEvent("OrderDe
+000194d0: 6c65 7465 6422 2c20 6461 7461 3d62 277b  leted", data=b'{
+000194e0: 7d27 290a 0a20 2020 2061 7761 6974 2063  }')..    await c
+000194f0: 6c69 656e 742e 6170 7065 6e64 5f65 7665  lient.append_eve
+00019500: 6e74 7328 0a20 2020 2020 2020 2073 7472  nts(.        str
+00019510: 6561 6d5f 6e61 6d65 3d73 7472 6561 6d5f  eam_name=stream_
+00019520: 6e61 6d65 2c0a 2020 2020 2020 2020 6578  name,.        ex
+00019530: 7065 6374 6564 5f70 6f73 6974 696f 6e3d  pected_position=
+00019540: 4e6f 6e65 2c0a 2020 2020 2020 2020 6576  None,.        ev
+00019550: 656e 7473 3d5b 6576 656e 7431 2c20 6576  ents=[event1, ev
+00019560: 656e 7432 2c20 6576 656e 7433 5d0a 2020  ent2, event3].  
+00019570: 2020 290a 0a20 2020 2023 2052 6561 6420    )..    # Read 
+00019580: 7374 7265 616d 2065 7665 6e74 732e 0a20  stream events.. 
+00019590: 2020 2072 6563 6f72 6465 6420 3d20 6177     recorded = aw
+000195a0: 6169 7420 636c 6965 6e74 2e72 6561 645f  ait client.read_
+000195b0: 7374 7265 616d 5f65 7665 6e74 7328 7374  stream_events(st
+000195c0: 7265 616d 5f6e 616d 6529 0a20 2020 2061  ream_name).    a
+000195d0: 7373 6572 7420 6c65 6e28 7265 636f 7264  ssert len(record
+000195e0: 6564 2920 3d3d 2033 0a20 2020 2061 7373  ed) == 3.    ass
+000195f0: 6572 7420 7265 636f 7264 6564 5b30 5d2e  ert recorded[0].
+00019600: 6964 203d 3d20 6576 656e 7431 2e69 640a  id == event1.id.
+00019610: 2020 2020 6173 7365 7274 2072 6563 6f72      assert recor
+00019620: 6465 645b 315d 2e69 6420 3d3d 2065 7665  ded[1].id == eve
+00019630: 6e74 322e 6964 0a20 2020 2061 7373 6572  nt2.id.    asser
+00019640: 7420 7265 636f 7264 6564 5b32 5d2e 6964  t recorded[2].id
+00019650: 203d 3d20 6576 656e 7433 2e69 640a 0a0a   == event3.id...
+00019660: 2020 2020 2320 5375 6273 6372 6962 6520      # Subscribe 
+00019670: 616c 6c20 6576 656e 7473 2e0a 2020 2020  all events..    
+00019680: 7265 6365 6976 6564 203d 205b 5d0a 2020  received = [].  
+00019690: 2020 6173 796e 6320 666f 7220 6576 656e    async for even
+000196a0: 7420 696e 2061 7761 6974 2063 6c69 656e  t in await clien
+000196b0: 742e 7375 6273 6372 6962 655f 616c 6c5f  t.subscribe_all_
+000196c0: 6576 656e 7473 2829 3a0a 2020 2020 2020  events():.      
+000196d0: 2020 7265 6365 6976 6564 2e61 7070 656e    received.appen
+000196e0: 6428 6576 656e 7429 0a20 2020 2020 2020  d(event).       
+000196f0: 2069 6620 6576 656e 742e 6964 203d 3d20   if event.id == 
+00019700: 6576 656e 7433 2e69 643a 0a20 2020 2020  event3.id:.     
+00019710: 2020 2020 2020 2062 7265 616b 0a20 2020         break.   
+00019720: 2061 7373 6572 7420 7265 6365 6976 6564   assert received
+00019730: 5b2d 335d 2e69 6420 3d3d 2065 7665 6e74  [-3].id == event
+00019740: 312e 6964 0a20 2020 2061 7373 6572 7420  1.id.    assert 
+00019750: 7265 6365 6976 6564 5b2d 325d 2e69 6420  received[-2].id 
+00019760: 3d3d 2065 7665 6e74 322e 6964 0a20 2020  == event2.id.   
+00019770: 2061 7373 6572 7420 7265 6365 6976 6564   assert received
+00019780: 5b2d 315d 2e69 6420 3d3d 2065 7665 6e74  [-1].id == event
+00019790: 332e 6964 0a0a 0a20 2020 2023 2043 6c6f  3.id...    # Clo
+000197a0: 7365 2074 6865 2063 6c69 656e 742e 0a20  se the client.. 
+000197b0: 2020 2061 7761 6974 2063 6c69 656e 742e     await client.
+000197c0: 636c 6f73 6528 290a 0a0a 2320 5275 6e20  close()...# Run 
+000197d0: 7468 6520 6465 6d6f 2e0a 6173 796e 6369  the demo..asynci
+000197e0: 6f2e 6765 745f 6576 656e 745f 6c6f 6f70  o.get_event_loop
+000197f0: 2829 2e72 756e 5f75 6e74 696c 5f63 6f6d  ().run_until_com
+00019800: 706c 6574 6528 0a20 2020 2064 656d 6f6e  plete(.    demon
+00019810: 7374 7261 7465 5f61 7379 6e63 696f 5f63  strate_asyncio_c
+00019820: 6c69 656e 7428 290a 290a 6060 600a 0a23  lient().).```..#
+00019830: 2320 436f 6e74 7269 6275 746f 7273 0a0a  # Contributors..
+00019840: 2323 2320 496e 7374 616c 6c20 506f 6574  ### Install Poet
+00019850: 7279 0a0a 5468 6520 6669 7273 7420 7468  ry..The first th
+00019860: 696e 6720 6973 2074 6f20 6368 6563 6b20  ing is to check 
+00019870: 796f 7520 6861 7665 2050 6f65 7472 7920  you have Poetry 
+00019880: 696e 7374 616c 6c65 642e 0a0a 2020 2020  installed...    
+00019890: 2420 706f 6574 7279 202d 2d76 6572 7369  $ poetry --versi
+000198a0: 6f6e 0a0a 4966 2079 6f75 2064 6f6e 2774  on..If you don't
+000198b0: 2c20 7468 656e 2070 6c65 6173 6520 5b69  , then please [i
+000198c0: 6e73 7461 6c6c 2050 6f65 7472 795d 2868  nstall Poetry](h
+000198d0: 7474 7073 3a2f 2f70 7974 686f 6e2d 706f  ttps://python-po
+000198e0: 6574 7279 2e6f 7267 2f64 6f63 732f 2369  etry.org/docs/#i
+000198f0: 6e73 7461 6c6c 696e 672d 7769 7468 2d74  nstalling-with-t
+00019900: 6865 2d6f 6666 6963 6961 6c2d 696e 7374  he-official-inst
+00019910: 616c 6c65 7229 2e0a 0a20 2020 2024 2063  aller)...    $ c
+00019920: 7572 6c20 2d73 534c 2068 7474 7073 3a2f  url -sSL https:/
+00019930: 2f69 6e73 7461 6c6c 2e70 7974 686f 6e2d  /install.python-
+00019940: 706f 6574 7279 2e6f 7267 207c 2070 7974  poetry.org | pyt
+00019950: 686f 6e33 202d 0a0a 4974 2077 696c 6c20  hon3 -..It will 
+00019960: 6865 6c70 2074 6f20 6d61 6b65 2073 7572  help to make sur
+00019970: 6520 506f 6574 7279 2773 2062 696e 2064  e Poetry's bin d
+00019980: 6972 6563 746f 7279 2069 7320 696e 2079  irectory is in y
+00019990: 6f75 7220 6050 4154 4860 2065 6e76 6972  our `PATH` envir
+000199a0: 6f6e 6d65 6e74 2076 6172 6961 626c 652e  onment variable.
+000199b0: 0a0a 4275 7420 696e 2061 6e79 2063 6173  ..But in any cas
+000199c0: 652c 206d 616b 6520 7375 7265 2079 6f75  e, make sure you
+000199d0: 206b 6e6f 7720 7468 6520 7061 7468 2074   know the path t
+000199e0: 6f20 7468 6520 6070 6f65 7472 7960 2065  o the `poetry` e
+000199f0: 7865 6375 7461 626c 652e 2054 6865 2050  xecutable. The P
+00019a00: 6f65 7472 790a 696e 7374 616c 6c65 7220  oetry.installer 
+00019a10: 7465 6c6c 7320 796f 7520 7768 6572 6520  tells you where 
+00019a20: 6974 2068 6173 2062 6565 6e20 696e 7374  it has been inst
+00019a30: 616c 6c65 642c 2061 6e64 2068 6f77 2074  alled, and how t
+00019a40: 6f20 636f 6e66 6967 7572 6520 796f 7572  o configure your
+00019a50: 2073 6865 6c6c 2e0a 0a50 6c65 6173 6520   shell...Please 
+00019a60: 7265 6665 7220 746f 2074 6865 205b 506f  refer to the [Po
+00019a70: 6574 7279 2064 6f63 735d 2868 7474 7073  etry docs](https
+00019a80: 3a2f 2f70 7974 686f 6e2d 706f 6574 7279  ://python-poetry
+00019a90: 2e6f 7267 2f64 6f63 732f 2920 666f 7220  .org/docs/) for 
+00019aa0: 6775 6964 616e 6365 206f 6e0a 7573 696e  guidance on.usin
+00019ab0: 6720 506f 6574 7279 2e0a 0a23 2323 2053  g Poetry...### S
+00019ac0: 6574 7570 2066 6f72 2050 7943 6861 726d  etup for PyCharm
+00019ad0: 2075 7365 7273 0a0a 596f 7520 6361 6e20   users..You can 
+00019ae0: 6561 7369 6c79 206f 6274 6169 6e20 7468  easily obtain th
+00019af0: 6520 7072 6f6a 6563 7420 6669 6c65 7320  e project files 
+00019b00: 7573 696e 6720 5079 4368 6172 6d20 286d  using PyCharm (m
+00019b10: 656e 7520 2247 6974 203e 2043 6c6f 6e65  enu "Git > Clone
+00019b20: 2e2e 2e22 292e 0a50 7943 6861 726d 2077  ...")..PyCharm w
+00019b30: 696c 6c20 7468 656e 2075 7375 616c 6c79  ill then usually
+00019b40: 2070 726f 6d70 7420 796f 7520 746f 206f   prompt you to o
+00019b50: 7065 6e20 7468 6520 7072 6f6a 6563 742e  pen the project.
+00019b60: 0a0a 4f70 656e 2074 6865 2070 726f 6a65  ..Open the proje
+00019b70: 6374 2069 6e20 6120 6e65 7720 7769 6e64  ct in a new wind
+00019b80: 6f77 2e20 5079 4368 6172 6d20 7769 6c6c  ow. PyCharm will
+00019b90: 2074 6865 6e20 7573 7561 6c6c 7920 7072   then usually pr
+00019ba0: 6f6d 7074 2079 6f75 2074 6f20 6372 6561  ompt you to crea
+00019bb0: 7465 0a61 206e 6577 2076 6972 7475 616c  te.a new virtual
+00019bc0: 2065 6e76 6972 6f6e 6d65 6e74 2e0a 0a43   environment...C
+00019bd0: 7265 6174 6520 6120 6e65 7720 506f 6574  reate a new Poet
+00019be0: 7279 2076 6972 7475 616c 2065 6e76 6972  ry virtual envir
+00019bf0: 6f6e 6d65 6e74 2066 6f72 2074 6865 2070  onment for the p
+00019c00: 726f 6a65 6374 2e20 4966 2050 7943 6861  roject. If PyCha
+00019c10: 726d 2064 6f65 736e 2774 2061 6c72 6561  rm doesn't alrea
+00019c20: 6479 0a6b 6e6f 7720 7768 6572 6520 796f  dy.know where yo
+00019c30: 7572 2060 706f 6574 7279 6020 6578 6563  ur `poetry` exec
+00019c40: 7574 6162 6c65 2069 732c 2074 6865 6e20  utable is, then 
+00019c50: 7365 7420 7468 6520 7061 7468 2074 6f20  set the path to 
+00019c60: 796f 7572 2060 706f 6574 7279 6020 6578  your `poetry` ex
+00019c70: 6563 7574 6162 6c65 0a69 6e20 7468 6520  ecutable.in the 
+00019c80: 224e 6577 2050 6f65 7472 7920 456e 7669  "New Poetry Envi
+00019c90: 726f 6e6d 656e 7422 2066 6f72 6d20 696e  ronment" form in
+00019ca0: 7075 7420 6669 656c 6420 6c61 6265 6c6c  put field labell
+00019cb0: 6564 2022 506f 6574 7279 2065 7865 6375  ed "Poetry execu
+00019cc0: 7461 626c 6522 2e20 496e 2074 6865 0a22  table". In the."
+00019cd0: 4e65 7720 506f 6574 7279 2045 6e76 6972  New Poetry Envir
+00019ce0: 6f6e 6d65 6e74 2220 666f 726d 2c20 796f  onment" form, yo
+00019cf0: 7520 7769 6c6c 2061 6c73 6f20 6861 7665  u will also have
+00019d00: 2074 6865 206f 7070 6f72 7475 6e69 7479   the opportunity
+00019d10: 2074 6f20 7365 6c65 6374 2077 6869 6368   to select which
+00019d20: 0a50 7974 686f 6e20 6578 6563 7574 6162  .Python executab
+00019d30: 6c65 2077 696c 6c20 6265 2075 7365 6420  le will be used 
+00019d40: 6279 2074 6865 2076 6972 7475 616c 2065  by the virtual e
+00019d50: 6e76 6972 6f6e 6d65 6e74 2e0a 0a50 7943  nvironment...PyC
+00019d60: 6861 726d 2077 696c 6c20 7468 656e 2063  harm will then c
+00019d70: 7265 6174 6520 6120 6e65 7720 506f 6574  reate a new Poet
+00019d80: 7279 2076 6972 7475 616c 2065 6e76 6972  ry virtual envir
+00019d90: 6f6e 6d65 6e74 2066 6f72 2079 6f75 7220  onment for your 
+00019da0: 7072 6f6a 6563 742c 2075 7369 6e67 0a61  project, using.a
+00019db0: 2070 6172 7469 6375 6c61 7220 7665 7273   particular vers
+00019dc0: 696f 6e20 6f66 2050 7974 686f 6e2c 2061  ion of Python, a
+00019dd0: 6e64 2061 6c73 6f20 696e 7374 616c 6c20  nd also install 
+00019de0: 696e 746f 2074 6869 7320 7669 7274 7561  into this virtua
+00019df0: 6c20 656e 7669 726f 6e6d 656e 7420 7468  l environment th
+00019e00: 650a 7072 6f6a 6563 7427 7320 7061 636b  e.project's pack
+00019e10: 6167 6520 6465 7065 6e64 656e 6369 6573  age dependencies
+00019e20: 2061 6363 6f72 6469 6e67 2074 6f20 7468   according to th
+00019e30: 6520 7072 6f6a 6563 7427 7320 6070 6f65  e project's `poe
+00019e40: 7472 792e 6c6f 636b 6020 6669 6c65 2e0a  try.lock` file..
+00019e50: 0a59 6f75 2063 616e 2061 6464 2064 6966  .You can add dif
+00019e60: 6665 7265 6e74 2050 6f65 7472 7920 656e  ferent Poetry en
+00019e70: 7669 726f 6e6d 656e 7473 2066 6f72 2064  vironments for d
+00019e80: 6966 6665 7265 6e74 2050 7974 686f 6e20  ifferent Python 
+00019e90: 7665 7273 696f 6e73 2c20 616e 6420 7377  versions, and sw
+00019ea0: 6974 6368 0a62 6574 7765 656e 2074 6865  itch.between the
+00019eb0: 6d20 7573 696e 6720 7468 6520 2250 7974  m using the "Pyt
+00019ec0: 686f 6e20 496e 7465 7270 7265 7465 7222  hon Interpreter"
+00019ed0: 2073 6574 7469 6e67 7320 6f66 2050 7943   settings of PyC
+00019ee0: 6861 726d 2e20 4966 2079 6f75 2077 616e  harm. If you wan
+00019ef0: 7420 746f 2075 7365 0a61 2076 6572 7369  t to use.a versi
+00019f00: 6f6e 206f 6620 5079 7468 6f6e 2074 6861  on of Python tha
+00019f10: 7420 6973 6e27 7420 696e 7374 616c 6c65  t isn't installe
+00019f20: 642c 2065 6974 6865 7220 7573 6520 796f  d, either use yo
+00019f30: 7572 2066 6176 6f75 7269 7465 2070 6163  ur favourite pac
+00019f40: 6b61 6765 206d 616e 6167 6572 2c0a 6f72  kage manager,.or
+00019f50: 2069 6e73 7461 6c6c 2050 7974 686f 6e20   install Python 
+00019f60: 6279 2064 6f77 6e6c 6f61 6469 6e67 2061  by downloading a
+00019f70: 6e20 696e 7374 616c 6c65 7220 666f 7220  n installer for 
+00019f80: 7265 6365 6e74 2076 6572 7369 6f6e 7320  recent versions 
+00019f90: 6f66 2050 7974 686f 6e20 6469 7265 6374  of Python direct
+00019fa0: 6c79 0a66 726f 6d20 7468 6520 5b50 7974  ly.from the [Pyt
+00019fb0: 686f 6e20 7765 6273 6974 655d 2868 7474  hon website](htt
+00019fc0: 7073 3a2f 2f77 7777 2e70 7974 686f 6e2e  ps://www.python.
+00019fd0: 6f72 672f 646f 776e 6c6f 6164 732f 292e  org/downloads/).
+00019fe0: 0a0a 4f6e 6365 2070 726f 6a65 6374 2064  ..Once project d
+00019ff0: 6570 656e 6465 6e63 6965 7320 6861 7665  ependencies have
+0001a000: 2062 6565 6e20 696e 7374 616c 6c65 642c   been installed,
+0001a010: 2079 6f75 2073 686f 756c 6420 6265 2061   you should be a
+0001a020: 626c 6520 746f 2072 756e 2074 6573 7473  ble to run tests
+0001a030: 0a66 726f 6d20 7769 7468 696e 2050 7943  .from within PyC
+0001a040: 6861 726d 2028 7269 6768 742d 636c 6963  harm (right-clic
+0001a050: 6b20 6f6e 2074 6865 2060 7465 7374 7360  k on the `tests`
+0001a060: 2066 6f6c 6465 7220 616e 6420 7365 6c65   folder and sele
+0001a070: 6374 2074 6865 2027 5275 6e27 206f 7074  ct the 'Run' opt
+0001a080: 696f 6e29 2e0a 0a42 6563 6175 7365 206f  ion)...Because o
+0001a090: 6620 6120 636f 6e66 6c69 6374 2062 6574  f a conflict bet
+0001a0a0: 7765 656e 2070 7974 6573 7420 616e 6420  ween pytest and 
+0001a0b0: 5079 4368 6172 6d27 7320 6465 6275 6767  PyCharm's debugg
+0001a0c0: 6572 2061 6e64 2074 6865 2063 6f76 6572  er and the cover
+0001a0d0: 6167 6520 746f 6f6c 2c0a 796f 7520 6d61  age tool,.you ma
+0001a0e0: 7920 6e65 6564 2074 6f20 6164 6420 6060  y need to add ``
+0001a0f0: 2d2d 6e6f 2d63 6f76 6060 2061 7320 616e  --no-cov`` as an
+0001a100: 206f 7074 696f 6e20 746f 2074 6865 2074   option to the t
+0001a110: 6573 7420 7275 6e6e 6572 2074 656d 706c  est runner templ
+0001a120: 6174 652e 2041 6c74 6572 6e61 7469 7665  ate. Alternative
+0001a130: 6c79 2c0a 6a75 7374 2075 7365 2074 6865  ly,.just use the
+0001a140: 2050 7974 686f 6e20 5374 616e 6461 7264   Python Standard
+0001a150: 204c 6962 7261 7279 2773 2060 6075 6e69   Library's ``uni
+0001a160: 7474 6573 7460 6020 6d6f 6475 6c65 2e0a  ttest`` module..
+0001a170: 0a59 6f75 2073 686f 756c 6420 616c 736f  .You should also
+0001a180: 2062 6520 6162 6c65 2074 6f20 6f70 656e   be able to open
+0001a190: 2061 2074 6572 6d69 6e61 6c20 7769 6e64   a terminal wind
+0001a1a0: 6f77 2069 6e20 5079 4368 6172 6d2c 2061  ow in PyCharm, a
+0001a1b0: 6e64 2072 756e 2074 6865 2070 726f 6a65  nd run the proje
+0001a1c0: 6374 2773 0a4d 616b 6566 696c 6520 636f  ct's.Makefile co
+0001a1d0: 6d6d 616e 6473 2066 726f 6d20 7468 6520  mmands from the 
+0001a1e0: 636f 6d6d 616e 6420 6c69 6e65 2028 7365  command line (se
+0001a1f0: 6520 6265 6c6f 7729 2e0a 0a23 2323 2053  e below)...### S
+0001a200: 6574 7570 2066 726f 6d20 636f 6d6d 616e  etup from comman
+0001a210: 6420 6c69 6e65 0a0a 4f62 7461 696e 2074  d line..Obtain t
+0001a220: 6865 2070 726f 6a65 6374 2066 696c 6573  he project files
+0001a230: 2c20 7573 696e 6720 4769 7420 6f72 2073  , using Git or s
+0001a240: 7569 7461 626c 6520 616c 7465 726e 6174  uitable alternat
+0001a250: 6976 652e 0a0a 496e 2061 2074 6572 6d69  ive...In a termi
+0001a260: 6e61 6c20 6170 706c 6963 6174 696f 6e2c  nal application,
+0001a270: 2063 6861 6e67 6520 796f 7572 2063 7572   change your cur
+0001a280: 7265 6e74 2077 6f72 6b69 6e67 2064 6972  rent working dir
+0001a290: 6563 746f 7279 0a74 6f20 7468 6520 726f  ectory.to the ro
+0001a2a0: 6f74 2066 6f6c 6465 7220 6f66 2074 6865  ot folder of the
+0001a2b0: 2070 726f 6a65 6374 2066 696c 6573 2e20   project files. 
+0001a2c0: 5468 6572 6520 7368 6f75 6c64 2062 6520  There should be 
+0001a2d0: 6120 4d61 6b65 6669 6c65 0a69 6e20 7468  a Makefile.in th
+0001a2e0: 6973 2066 6f6c 6465 722e 0a0a 5573 6520  is folder...Use 
+0001a2f0: 7468 6520 4d61 6b65 6669 6c65 2074 6f20  the Makefile to 
+0001a300: 6372 6561 7465 2061 206e 6577 2050 6f65  create a new Poe
+0001a310: 7472 7920 7669 7274 7561 6c20 656e 7669  try virtual envi
+0001a320: 726f 6e6d 656e 7420 666f 7220 7468 650a  ronment for the.
+0001a330: 7072 6f6a 6563 7420 616e 6420 696e 7374  project and inst
+0001a340: 616c 6c20 7468 6520 7072 6f6a 6563 7427  all the project'
+0001a350: 7320 7061 636b 6167 6520 6465 7065 6e64  s package depend
+0001a360: 656e 6369 6573 2069 6e74 6f20 6974 2c0a  encies into it,.
+0001a370: 7573 696e 6720 7468 6520 666f 6c6c 6f77  using the follow
+0001a380: 696e 6720 636f 6d6d 616e 642e 0a0a 2020  ing command...  
+0001a390: 2020 2420 6d61 6b65 2069 6e73 7461 6c6c    $ make install
+0001a3a0: 2d70 6163 6b61 6765 730a 0a49 7427 7320  -packages..It's 
+0001a3b0: 616c 736f 2070 6f73 7369 626c 6520 746f  also possible to
+0001a3c0: 2061 6c73 6f20 696e 7374 616c 6c20 7468   also install th
+0001a3d0: 6520 7072 6f6a 6563 7420 696e 2027 6564  e project in 'ed
+0001a3e0: 6974 6162 6c65 206d 6f64 6527 2e0a 0a20  itable mode'... 
+0001a3f0: 2020 2024 206d 616b 6520 696e 7374 616c     $ make instal
+0001a400: 6c0a 0a50 6c65 6173 6520 6e6f 7465 2c20  l..Please note, 
+0001a410: 6966 2079 6f75 2063 7265 6174 6520 7468  if you create th
+0001a420: 6520 7669 7274 7561 6c20 656e 7669 726f  e virtual enviro
+0001a430: 6e6d 656e 7420 696e 2074 6869 7320 7761  nment in this wa
+0001a440: 792c 2061 6e64 2074 6865 6e20 7472 7920  y, and then try 
+0001a450: 746f 0a6f 7065 6e20 7468 6520 7072 6f6a  to.open the proj
+0001a460: 6563 7420 696e 2050 7943 6861 726d 2061  ect in PyCharm a
+0001a470: 6e64 2063 6f6e 6669 6775 7265 2074 6865  nd configure the
+0001a480: 2070 726f 6a65 6374 2074 6f20 7573 6520   project to use 
+0001a490: 7468 6973 2076 6972 7475 616c 0a65 6e76  this virtual.env
+0001a4a0: 6972 6f6e 6d65 6e74 2061 7320 616e 2022  ironment as an "
+0001a4b0: 4578 6973 7469 6e67 2050 6f65 7472 7920  Existing Poetry 
+0001a4c0: 456e 7669 726f 6e6d 656e 7422 2c20 5079  Environment", Py
+0001a4d0: 4368 6172 6d20 736f 6d65 7469 6d65 7320  Charm sometimes 
+0001a4e0: 6861 7320 736f 6d65 0a69 7373 7565 7320  has some.issues 
+0001a4f0: 2864 6f6e 2774 206b 6e6f 7720 7768 7929  (don't know why)
+0001a500: 2077 6869 6368 206d 6967 6874 2062 6520   which might be 
+0001a510: 7072 6f62 6c65 6d61 7469 632e 2049 6620  problematic. If 
+0001a520: 796f 7520 656e 636f 756e 7465 7220 7375  you encounter su
+0001a530: 6368 0a69 7373 7565 732c 2079 6f75 2063  ch.issues, you c
+0001a540: 616e 2072 6573 6f6c 7665 2074 6865 7365  an resolve these
+0001a550: 2069 7373 7565 7320 6279 2064 656c 6574   issues by delet
+0001a560: 696e 6720 7468 6520 7669 7274 7561 6c20  ing the virtual 
+0001a570: 656e 7669 726f 6e6d 656e 740a 616e 6420  environment.and 
+0001a580: 6372 6561 7469 6e67 2074 6865 2050 6f65  creating the Poe
+0001a590: 7472 7920 7669 7274 7561 6c20 656e 7669  try virtual envi
+0001a5a0: 726f 6e6d 656e 7420 7573 696e 6720 5079  ronment using Py
+0001a5b0: 4368 6172 6d20 2873 6565 2061 626f 7665  Charm (see above
+0001a5c0: 292e 0a0a 2323 2320 5072 6f6a 6563 7420  )...### Project 
+0001a5d0: 4d61 6b65 6669 6c65 2063 6f6d 6d61 6e64  Makefile command
+0001a5e0: 730a 0a59 6f75 2063 616e 2073 7461 7274  s..You can start
+0001a5f0: 2045 7665 6e74 5374 6f72 6544 4220 7573   EventStoreDB us
+0001a600: 696e 6720 7468 6520 666f 6c6c 6f77 696e  ing the followin
+0001a610: 6720 636f 6d6d 616e 642e 0a0a 2020 2020  g command...    
+0001a620: 2420 6d61 6b65 2073 7461 7274 2d65 7665  $ make start-eve
+0001a630: 6e74 7374 6f72 6564 620a 0a59 6f75 2063  ntstoredb..You c
+0001a640: 616e 2072 756e 2074 6573 7473 2075 7369  an run tests usi
+0001a650: 6e67 2074 6865 2066 6f6c 6c6f 7769 6e67  ng the following
+0001a660: 2063 6f6d 6d61 6e64 2028 6e65 6564 7320   command (needs 
+0001a670: 4576 656e 7453 746f 7265 4442 2074 6f20  EventStoreDB to 
+0001a680: 6265 2072 756e 6e69 6e67 292e 0a0a 2020  be running)...  
+0001a690: 2020 2420 6d61 6b65 2074 6573 740a 0a59    $ make test..Y
+0001a6a0: 6f75 2063 616e 2073 746f 7020 4576 656e  ou can stop Even
+0001a6b0: 7453 746f 7265 4442 2075 7369 6e67 2074  tStoreDB using t
+0001a6c0: 6865 2066 6f6c 6c6f 7769 6e67 2063 6f6d  he following com
+0001a6d0: 6d61 6e64 2e0a 0a20 2020 2024 206d 616b  mand...    $ mak
+0001a6e0: 6520 7374 6f70 2d65 7665 6e74 7374 6f72  e stop-eventstor
+0001a6f0: 6564 620a 0a59 6f75 2063 616e 2063 6865  edb..You can che
+0001a700: 636b 2074 6865 2066 6f72 6d61 7474 696e  ck the formattin
+0001a710: 6720 6f66 2074 6865 2063 6f64 6520 7573  g of the code us
+0001a720: 696e 6720 7468 6520 666f 6c6c 6f77 696e  ing the followin
+0001a730: 6720 636f 6d6d 616e 642e 0a0a 2020 2020  g command...    
+0001a740: 2420 6d61 6b65 206c 696e 740a 0a59 6f75  $ make lint..You
+0001a750: 2063 616e 2072 6566 6f72 6d61 7420 7468   can reformat th
+0001a760: 6520 636f 6465 2075 7369 6e67 2074 6865  e code using the
+0001a770: 2066 6f6c 6c6f 7769 6e67 2063 6f6d 6d61   following comma
+0001a780: 6e64 2e0a 0a20 2020 2024 206d 616b 6520  nd...    $ make 
+0001a790: 666d 740a 0a54 6573 7473 2062 656c 6f6e  fmt..Tests belon
+0001a7a0: 6720 696e 2060 2e2f 7465 7374 7360 2e20  g in `./tests`. 
+0001a7b0: 436f 6465 2d75 6e64 6572 2d74 6573 7420  Code-under-test 
+0001a7c0: 6265 6c6f 6e67 7320 696e 2060 2e2f 6573  belongs in `./es
+0001a7d0: 6462 636c 6965 6e74 602e 0a0a 4564 6974  dbclient`...Edit
+0001a7e0: 2070 6163 6b61 6765 2064 6570 656e 6465   package depende
+0001a7f0: 6e63 6965 7320 696e 2060 7079 7072 6f6a  ncies in `pyproj
+0001a800: 6563 742e 746f 6d6c 602e 2055 7064 6174  ect.toml`. Updat
+0001a810: 6520 696e 7374 616c 6c65 6420 7061 636b  e installed pack
+0001a820: 6167 6573 2028 616e 6420 7468 650a 6070  ages (and the.`p
+0001a830: 6f65 7472 792e 6c6f 636b 6020 6669 6c65  oetry.lock` file
+0001a840: 2920 7573 696e 6720 7468 6520 666f 6c6c  ) using the foll
+0001a850: 6f77 696e 6720 636f 6d6d 616e 642e 0a0a  owing command...
+0001a860: 2020 2020 2420 6d61 6b65 2075 7064 6174      $ make updat
+0001a870: 652d 7061 636b 6167 6573 0a0a            e-packages..
```

