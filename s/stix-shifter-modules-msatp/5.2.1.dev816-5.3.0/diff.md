# Comparing `tmp/stix_shifter_modules_msatp-5.2.1.dev816-py2.py3-none-any.whl.zip` & `tmp/stix_shifter_modules_msatp-5.3.0-py2.py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,28 +1,29 @@
-Zip file size: 39534 bytes, number of entries: 26
--rw-rw-r--  2.0 unx        0 b- defN 23-May-12 16:33 stix_shifter_modules/msatp/__init__.py
--rw-rw-r--  2.0 unx      425 b- defN 23-May-12 16:33 stix_shifter_modules/msatp/entry_point.py
--rw-rw-r--  2.0 unx    84180 b- defN 23-May-12 16:36 stix_shifter_modules/msatp/configuration/config.json
--rw-rw-r--  2.0 unx       78 b- defN 23-May-12 16:36 stix_shifter_modules/msatp/configuration/dialects.json
--rw-rw-r--  2.0 unx     3580 b- defN 23-May-12 16:36 stix_shifter_modules/msatp/configuration/lang_en.json
--rw-rw-r--  2.0 unx        1 b- defN 23-May-12 16:33 stix_shifter_modules/msatp/stix_translation/__init__.py
--rw-rw-r--  2.0 unx    21567 b- defN 23-May-12 16:36 stix_shifter_modules/msatp/stix_translation/json_to_stix_translator.py
--rw-rw-r--  2.0 unx    18533 b- defN 23-May-12 16:33 stix_shifter_modules/msatp/stix_translation/query_constructor.py
--rw-rw-r--  2.0 unx     1038 b- defN 23-May-12 16:33 stix_shifter_modules/msatp/stix_translation/query_translator.py
--rw-rw-r--  2.0 unx      133 b- defN 23-May-12 16:33 stix_shifter_modules/msatp/stix_translation/results_translator.py
--rw-rw-r--  2.0 unx     1649 b- defN 23-May-12 16:33 stix_shifter_modules/msatp/stix_translation/transformers.py
--rw-rw-r--  2.0 unx    16632 b- defN 23-May-12 16:33 stix_shifter_modules/msatp/stix_translation/json/from_stix_map.json
--rw-rw-r--  2.0 unx      583 b- defN 23-May-12 16:33 stix_shifter_modules/msatp/stix_translation/json/operators.json
--rw-rw-r--  2.0 unx    23675 b- defN 23-May-12 16:33 stix_shifter_modules/msatp/stix_translation/json/to_stix_map.json
--rw-rw-r--  2.0 unx    16206 b- defN 23-May-12 16:33 stix_shifter_modules/msatp/stix_translation/json/stix_2_1/from_stix_map.json
--rw-rw-r--  2.0 unx    22959 b- defN 23-May-12 16:33 stix_shifter_modules/msatp/stix_translation/json/stix_2_1/to_stix_map.json
--rw-rw-r--  2.0 unx        0 b- defN 23-May-12 16:33 stix_shifter_modules/msatp/stix_transmission/__init__.py
--rw-rw-r--  2.0 unx     2313 b- defN 23-May-12 16:33 stix_shifter_modules/msatp/stix_transmission/api_client.py
--rw-rw-r--  2.0 unx     6555 b- defN 23-May-12 16:33 stix_shifter_modules/msatp/stix_transmission/connector.py
--rw-rw-r--  2.0 unx     1850 b- defN 23-May-12 16:33 stix_shifter_modules/msatp/stix_transmission/error_mapper.py
--rw-rw-r--  2.0 unx    12786 b- defN 23-May-12 16:36 stix_shifter_modules_msatp-5.2.1.dev816.dist-info/LICENSE.md
--rw-rw-r--  2.0 unx     7091 b- defN 23-May-12 16:36 stix_shifter_modules_msatp-5.2.1.dev816.dist-info/METADATA
--rw-rw-r--  2.0 unx     1418 b- defN 23-May-12 16:36 stix_shifter_modules_msatp-5.2.1.dev816.dist-info/NOTICE
--rw-rw-r--  2.0 unx      110 b- defN 23-May-12 16:36 stix_shifter_modules_msatp-5.2.1.dev816.dist-info/WHEEL
--rw-rw-r--  2.0 unx       21 b- defN 23-May-12 16:36 stix_shifter_modules_msatp-5.2.1.dev816.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     2957 b- defN 23-May-12 16:36 stix_shifter_modules_msatp-5.2.1.dev816.dist-info/RECORD
-26 files, 246340 bytes uncompressed, 34460 bytes compressed:  86.0%
+Zip file size: 54494 bytes, number of entries: 27
+-rw-rw-r--  2.0 unx        0 b- defN 23-May-16 14:04 stix_shifter_modules/msatp/__init__.py
+-rw-rw-r--  2.0 unx      425 b- defN 23-May-16 14:04 stix_shifter_modules/msatp/entry_point.py
+-rw-rw-r--  2.0 unx   191810 b- defN 23-May-16 14:07 stix_shifter_modules/msatp/configuration/config.json
+-rw-rw-r--  2.0 unx       78 b- defN 23-May-16 14:07 stix_shifter_modules/msatp/configuration/dialects.json
+-rw-rw-r--  2.0 unx     5039 b- defN 23-May-16 14:07 stix_shifter_modules/msatp/configuration/lang_en.json
+-rw-rw-r--  2.0 unx        1 b- defN 23-May-16 14:04 stix_shifter_modules/msatp/stix_translation/__init__.py
+-rw-rw-r--  2.0 unx    22536 b- defN 23-May-16 14:07 stix_shifter_modules/msatp/stix_translation/json_to_stix_translator.py
+-rw-rw-r--  2.0 unx    18741 b- defN 23-May-16 14:04 stix_shifter_modules/msatp/stix_translation/query_constructor.py
+-rw-rw-r--  2.0 unx     1038 b- defN 23-May-16 14:04 stix_shifter_modules/msatp/stix_translation/query_translator.py
+-rw-rw-r--  2.0 unx     8390 b- defN 23-May-16 14:04 stix_shifter_modules/msatp/stix_translation/results_translator.py
+-rw-rw-r--  2.0 unx     5510 b- defN 23-May-16 14:04 stix_shifter_modules/msatp/stix_translation/transformers.py
+-rw-rw-r--  2.0 unx    20749 b- defN 23-May-16 14:04 stix_shifter_modules/msatp/stix_translation/json/from_stix_map.json
+-rw-rw-r--  2.0 unx      583 b- defN 23-May-16 14:04 stix_shifter_modules/msatp/stix_translation/json/operators.json
+-rw-rw-r--  2.0 unx    69903 b- defN 23-May-16 14:04 stix_shifter_modules/msatp/stix_translation/json/to_stix_map.json
+-rw-rw-r--  2.0 unx    20764 b- defN 23-May-16 14:04 stix_shifter_modules/msatp/stix_translation/json/stix_2_1/from_stix_map.json
+-rw-rw-r--  2.0 unx    68275 b- defN 23-May-16 14:04 stix_shifter_modules/msatp/stix_translation/json/stix_2_1/to_stix_map.json
+-rw-rw-r--  2.0 unx        0 b- defN 23-May-16 14:04 stix_shifter_modules/msatp/stix_transmission/__init__.py
+-rw-rw-r--  2.0 unx     2952 b- defN 23-May-16 14:04 stix_shifter_modules/msatp/stix_transmission/api_client.py
+-rw-rw-r--  2.0 unx     3779 b- defN 23-May-16 14:04 stix_shifter_modules/msatp/stix_transmission/connector.py
+-rw-rw-r--  2.0 unx    11998 b- defN 23-May-16 14:04 stix_shifter_modules/msatp/stix_transmission/connector_post_processing.py
+-rw-rw-r--  2.0 unx     1850 b- defN 23-May-16 14:04 stix_shifter_modules/msatp/stix_transmission/error_mapper.py
+-rw-rw-r--  2.0 unx    12786 b- defN 23-May-16 14:07 stix_shifter_modules_msatp-5.3.0.dist-info/LICENSE.md
+-rw-rw-r--  2.0 unx     8035 b- defN 23-May-16 14:07 stix_shifter_modules_msatp-5.3.0.dist-info/METADATA
+-rw-rw-r--  2.0 unx     1418 b- defN 23-May-16 14:07 stix_shifter_modules_msatp-5.3.0.dist-info/NOTICE
+-rw-rw-r--  2.0 unx      110 b- defN 23-May-16 14:07 stix_shifter_modules_msatp-5.3.0.dist-info/WHEEL
+-rw-rw-r--  2.0 unx       21 b- defN 23-May-16 14:07 stix_shifter_modules_msatp-5.3.0.dist-info/top_level.txt
+?rw-rw-r--  2.0 unx     3048 b- defN 23-May-16 14:07 stix_shifter_modules_msatp-5.3.0.dist-info/RECORD
+27 files, 479839 bytes uncompressed, 49282 bytes compressed:  89.7%
```

## zipnote {}

```diff
@@ -51,29 +51,32 @@
 
 Filename: stix_shifter_modules/msatp/stix_transmission/api_client.py
 Comment: 
 
 Filename: stix_shifter_modules/msatp/stix_transmission/connector.py
 Comment: 
 
+Filename: stix_shifter_modules/msatp/stix_transmission/connector_post_processing.py
+Comment: 
+
 Filename: stix_shifter_modules/msatp/stix_transmission/error_mapper.py
 Comment: 
 
-Filename: stix_shifter_modules_msatp-5.2.1.dev816.dist-info/LICENSE.md
+Filename: stix_shifter_modules_msatp-5.3.0.dist-info/LICENSE.md
 Comment: 
 
-Filename: stix_shifter_modules_msatp-5.2.1.dev816.dist-info/METADATA
+Filename: stix_shifter_modules_msatp-5.3.0.dist-info/METADATA
 Comment: 
 
-Filename: stix_shifter_modules_msatp-5.2.1.dev816.dist-info/NOTICE
+Filename: stix_shifter_modules_msatp-5.3.0.dist-info/NOTICE
 Comment: 
 
-Filename: stix_shifter_modules_msatp-5.2.1.dev816.dist-info/WHEEL
+Filename: stix_shifter_modules_msatp-5.3.0.dist-info/WHEEL
 Comment: 
 
-Filename: stix_shifter_modules_msatp-5.2.1.dev816.dist-info/top_level.txt
+Filename: stix_shifter_modules_msatp-5.3.0.dist-info/top_level.txt
 Comment: 
 
-Filename: stix_shifter_modules_msatp-5.2.1.dev816.dist-info/RECORD
+Filename: stix_shifter_modules_msatp-5.3.0.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## stix_shifter_modules/msatp/configuration/config.json

### Pretty-printed

 * *Similarity: 0.9955275058817086%*

 * *Differences: {"'connection'": "{'options': {'mapping': {'default': {'from_stix_map': {'ipv4-addr': {'fields': "*

 * *                 "{'value': {insert: [(2, 'DeviceEvents.RemoteIP'), (3, "*

 * *                 "'DeviceEvents.LocalIP')]}}}, 'ipv6-addr': {'fields': {'value': {insert: [(2, "*

 * *                 "'DeviceEvents.RemoteIP'), (3, 'DeviceEvents.LocalIP')]}}}, 'network-traffic': "*

 * *                 "{'fields': {'src_port': {insert: [(1, 'DeviceEvents.LocalPort')]}, 'dst_port': "*

 * *                 "{insert: [(1, 'DeviceEvents [â€¦]*

```diff
@@ -29,14 +29,26 @@
                 "type": "text"
             },
             "dialects": {
                 "hidden": true,
                 "optional": true,
                 "type": "array"
             },
+            "includeAlerts": {
+                "default": false,
+                "type": "boolean"
+            },
+            "includeHostOs": {
+                "default": false,
+                "type": "boolean"
+            },
+            "includeNetworkInfo": {
+                "default": false,
+                "type": "boolean"
+            },
             "language": {
                 "default": "stix",
                 "hidden": true,
                 "optional": true,
                 "type": "string"
             },
             "mapping": {
@@ -45,157 +57,185 @@
                         "directory": {
                             "fields": {
                                 "path": [
                                     "DeviceFileEvents.FolderPath",
                                     "DeviceFileEvents.InitiatingProcessFolderPath",
                                     "DeviceProcessEvents.FolderPath",
                                     "DeviceProcessEvents.InitiatingProcessFolderPath",
+                                    "DeviceEvents.FolderPath",
+                                    "DeviceEvents.InitiatingProcessFolderPath",
                                     "DeviceNetworkEvents.InitiatingProcessFolderPath",
-                                    "DeviceRegistryEvents.InitiatingProcessFolderPath"
+                                    "DeviceRegistryEvents.InitiatingProcessFolderPath",
+                                    "DeviceImageLoadEvents.FolderPath",
+                                    "DeviceImageLoadEvents.InitiatingProcessFolderPath"
                                 ]
                             }
                         },
                         "domain-name": {
                             "fields": {
                                 "value": [
-                                    "DeviceFileEvents.DeviceName",
-                                    "DeviceProcessEvents.DeviceName",
-                                    "DeviceNetworkEvents.DeviceName",
-                                    "DeviceRegistryEvents.DeviceName",
-                                    "DeviceEvents.DeviceName",
-                                    "DeviceInfo.DeviceName",
-                                    "DeviceAlertEvents.DeviceName",
-                                    "DeviceImageLoadEvents.DeviceName",
-                                    "DeviceLogonEvents.DeviceName",
-                                    "DeviceNetworkInfo.DeviceName"
+                                    "DeviceNetworkEvents.RemoteUrl",
+                                    "DeviceEvents.RemoteUrl"
                                 ]
                             }
                         },
                         "file": {
                             "fields": {
                                 "hashes.'SHA-1'": [
                                     "DeviceFileEvents.SHA1",
                                     "DeviceFileEvents.InitiatingProcessSHA1",
                                     "DeviceProcessEvents.SHA1",
                                     "DeviceProcessEvents.InitiatingProcessSHA1",
                                     "DeviceNetworkEvents.InitiatingProcessSHA1",
-                                    "DeviceRegistryEvents.InitiatingProcessSHA1"
+                                    "DeviceRegistryEvents.InitiatingProcessSHA1",
+                                    "DeviceEvents.SHA1",
+                                    "DeviceEvents.InitiatingProcessSHA1",
+                                    "DeviceImageLoadEvents.SHA1",
+                                    "DeviceImageLoadEvents.InitiatingProcessSHA1"
                                 ],
                                 "hashes.'SHA-256'": [
                                     "DeviceFileEvents.SHA256",
                                     "DeviceFileEvents.InitiatingProcessSHA256",
                                     "DeviceProcessEvents.SHA256",
                                     "DeviceProcessEvents.InitiatingProcessSHA256",
                                     "DeviceNetworkEvents.InitiatingProcessSHA256",
-                                    "DeviceRegistryEvents.InitiatingProcessSHA256"
+                                    "DeviceRegistryEvents.InitiatingProcessSHA256",
+                                    "DeviceEvents.SHA256",
+                                    "DeviceEvents.InitiatingProcessSHA256",
+                                    "DeviceImageLoadEvents.SHA256",
+                                    "DeviceImageLoadEvents.InitiatingProcessSHA256"
                                 ],
                                 "hashes.MD5": [
                                     "DeviceFileEvents.MD5",
                                     "DeviceFileEvents.InitiatingProcessMD5",
                                     "DeviceProcessEvents.MD5",
                                     "DeviceProcessEvents.InitiatingProcessMD5",
                                     "DeviceNetworkEvents.InitiatingProcessMD5",
-                                    "DeviceRegistryEvents.InitiatingProcessMD5"
+                                    "DeviceRegistryEvents.InitiatingProcessMD5",
+                                    "DeviceEvents.MD5",
+                                    "DeviceEvents.InitiatingProcessMD5",
+                                    "DeviceImageLoadEvents.MD5",
+                                    "DeviceImageLoadEvents.InitiatingProcessMD5"
                                 ],
                                 "name": [
                                     "DeviceFileEvents.FileName",
                                     "DeviceFileEvents.InitiatingProcessFileName",
                                     "DeviceFileEvents.InitiatingProcessParentFileName",
                                     "DeviceProcessEvents.FileName",
                                     "DeviceProcessEvents.InitiatingProcessFileName",
                                     "DeviceProcessEvents.InitiatingProcessParentFileName",
                                     "DeviceNetworkEvents.InitiatingProcessFileName",
                                     "DeviceNetworkEvents.InitiatingProcessParentFileName",
                                     "DeviceRegistryEvents.InitiatingProcessFileName",
-                                    "DeviceRegistryEvents.InitiatingProcessParentFileName"
+                                    "DeviceRegistryEvents.InitiatingProcessParentFileName",
+                                    "DeviceEvents.FileName",
+                                    "DeviceEvents.InitiatingProcessFileName",
+                                    "DeviceEvents.InitiatingProcessParentFileName",
+                                    "DeviceImageLoadEvents.FileName",
+                                    "DeviceImageLoadEvents.InitiatingProcessFileName",
+                                    "DeviceImageLoadEvents.InitiatingProcessParentFileName"
                                 ],
                                 "parent_directory_ref.path": [
                                     "DeviceFileEvents.FolderPath",
                                     "DeviceFileEvents.InitiatingProcessFolderPath",
                                     "DeviceProcessEvents.FolderPath",
                                     "DeviceProcessEvents.InitiatingProcessFolderPath",
                                     "DeviceNetworkEvents.InitiatingProcessFolderPath",
-                                    "DeviceRegistryEvents.InitiatingProcessFolderPath"
+                                    "DeviceRegistryEvents.InitiatingProcessFolderPath",
+                                    "DeviceEvents.FolderPath",
+                                    "DeviceEvents.InitiatingProcessFolderPath",
+                                    "DeviceImageLoadEvents.FolderPath",
+                                    "DeviceImageLoadEvents.InitiatingProcessFolderPath"
                                 ]
                             }
                         },
                         "ipv4-addr": {
                             "fields": {
                                 "value": [
                                     "DeviceNetworkEvents.LocalIP",
-                                    "DeviceNetworkEvents.RemoteIP"
+                                    "DeviceNetworkEvents.RemoteIP",
+                                    "DeviceEvents.RemoteIP",
+                                    "DeviceEvents.LocalIP"
                                 ]
                             }
                         },
                         "ipv6-addr": {
                             "fields": {
                                 "value": [
                                     "DeviceNetworkEvents.LocalIP",
-                                    "DeviceNetworkEvents.RemoteIP"
+                                    "DeviceNetworkEvents.RemoteIP",
+                                    "DeviceEvents.RemoteIP",
+                                    "DeviceEvents.LocalIP"
                                 ]
                             }
                         },
                         "mac-addr": {
                             "fields": {
                                 "value": [
                                     "DeviceNetworkInfo.MacAddress"
                                 ]
                             }
                         },
                         "network-traffic": {
                             "fields": {
                                 "dst_port": [
-                                    "DeviceNetworkEvents.RemotePort"
+                                    "DeviceNetworkEvents.RemotePort",
+                                    "DeviceEvents.RemotePort"
                                 ],
                                 "dst_ref.value": [
-                                    "DeviceNetworkEvents.RemoteIP"
+                                    "DeviceNetworkEvents.RemoteIP",
+                                    "DeviceEvents.RemoteIP"
                                 ],
                                 "protocols[*]": [
                                     "DeviceNetworkEvents.Protocol"
                                 ],
                                 "src_port": [
-                                    "DeviceNetworkEvents.LocalPort"
+                                    "DeviceNetworkEvents.LocalPort",
+                                    "DeviceEvents.LocalPort"
                                 ],
                                 "src_ref.value": [
                                     "DeviceNetworkEvents.LocalIP",
-                                    "DeviceNetworkInfo.MacAddress"
+                                    "DeviceNetworkInfo.MacAddress",
+                                    "DeviceEvents.LocalIP"
                                 ]
                             }
                         },
                         "process": {
                             "fields": {
                                 "binary_ref.hashes.'SHA-1'": [
-                                    "DeviceFileEvents.SHA1",
-                                    "DeviceFileEvents.InitiatingProcessSHA1",
                                     "DeviceProcessEvents.SHA1",
-                                    "DeviceProcessEvents.InitiatingProcessSHA1",
+                                    "DeviceEvents.SHA1",
+                                    "DeviceFileEvents.InitiatingProcessSHA1",
                                     "DeviceNetworkEvents.InitiatingProcessSHA1",
-                                    "DeviceRegistryEvents.InitiatingProcessSHA1"
+                                    "DeviceRegistryEvents.InitiatingProcessSHA1",
+                                    "DeviceImageLoadEvents.InitiatingProcessSHA1"
                                 ],
                                 "binary_ref.hashes.'SHA-256'": [
-                                    "DeviceFileEvents.SHA256",
-                                    "DeviceFileEvents.InitiatingProcessSHA256",
                                     "DeviceProcessEvents.SHA256",
-                                    "DeviceProcessEvents.InitiatingProcessSHA256",
+                                    "DeviceEvents.SHA256",
+                                    "DeviceFileEvents.InitiatingProcessSHA256",
                                     "DeviceNetworkEvents.InitiatingProcessSHA256",
-                                    "DeviceRegistryEvents.InitiatingProcessSHA256"
+                                    "DeviceRegistryEvents.InitiatingProcessSHA256",
+                                    "DeviceImageLoadEvents.InitiatingProcessSHA256"
                                 ],
                                 "binary_ref.hashes.MD5": [
-                                    "DeviceFileEvents.MD5",
-                                    "DeviceFileEvents.InitiatingProcessMD5",
                                     "DeviceProcessEvents.MD5",
-                                    "DeviceProcessEvents.InitiatingProcessMD5",
+                                    "DeviceEvents.MD5",
+                                    "DeviceFileEvents.InitiatingProcessMD5",
                                     "DeviceNetworkEvents.InitiatingProcessMD5",
-                                    "DeviceRegistryEvents.InitiatingProcessMD5"
+                                    "DeviceRegistryEvents.InitiatingProcessMD5",
+                                    "DeviceImageLoadEvents.InitiatingProcessMD5"
                                 ],
                                 "binary_ref.parent_directory_ref.path": [
-                                    "DeviceProcessEvents.InitiatingProcessFolderPath",
+                                    "DeviceProcessEvents.FolderPath",
+                                    "DeviceEvents.FolderPath",
                                     "DeviceNetworkEvents.InitiatingProcessFolderPath",
                                     "DeviceRegistryEvents.InitiatingProcessFolderPath",
-                                    "DeviceFileEvents.InitiatingProcessFolderPath"
+                                    "DeviceFileEvents.InitiatingProcessFolderPath",
+                                    "DeviceImageLoadEvents.InitiatingProcessFolderPath"
                                 ],
                                 "child_refs.binary_ref.hashes.'SHA-1'": [
                                     "DeviceProcessEvents.SHA1"
                                 ],
                                 "child_refs.binary_ref.hashes.'SHA-256'": [
                                     "DeviceProcessEvents.SHA256"
                                 ],
@@ -205,304 +245,377 @@
                                 "child_refs.binary_ref.parent_directory_ref.path": [
                                     "DeviceProcessEvents.FolderPath"
                                 ],
                                 "child_refs.creator_user_ref.account_login": [
                                     "DeviceProcessEvents.AccountName"
                                 ],
                                 "child_refs.pid": [
-                                    "DeviceProcessEvents.ProcessId",
-                                    "DeviceProcessEvents.InitiatingProcessId",
-                                    "DeviceNetworkEvents.InitiatingProcessId",
-                                    "DeviceRegistryEvents.InitiatingProcessId",
-                                    "DeviceFileEvents.InitiatingProcessId"
+                                    "DeviceProcessEvents.ProcessId"
                                 ],
                                 "command_line": [
                                     "DeviceProcessEvents.ProcessCommandLine",
                                     "DeviceProcessEvents.InitiatingProcessCommandLine",
+                                    "DeviceEvents.ProcessCommandLine",
+                                    "DeviceEvents.InitiatingProcessCommandLine",
+                                    "DeviceFileEvents.InitiatingProcessCommandLine",
                                     "DeviceNetworkEvents.InitiatingProcessCommandLine",
-                                    "DeviceRegistryEvents.InitiatingProcessCommandLine"
+                                    "DeviceRegistryEvents.InitiatingProcessCommandLine",
+                                    "DeviceImageLoadEvents.InitiatingProcessCommandLine"
                                 ],
                                 "created": [
                                     "DeviceProcessEvents.ProcessCreationTime",
-                                    "DeviceProcessEvents.InitiatingProcessParentCreationTime",
+                                    "DeviceEvents.ProcessCreationTime",
                                     "DeviceNetworkEvents.InitiatingProcessCreationTime",
-                                    "DeviceNetworkEvents.InitiatingProcessParentCreationTime",
                                     "DeviceRegistryEvents.InitiatingProcessCreationTime",
-                                    "DeviceRegistryEvents.InitiatingProcessParentCreationTime",
                                     "DeviceFileEvents.InitiatingProcessCreationTime",
-                                    "DeviceFileEvents.InitiatingProcessParentCreationTime"
+                                    "DeviceImageLoadEvents.InitiatingProcessCreationTime"
                                 ],
                                 "creator_user_ref.account_login": [
-                                    "DeviceProcessEvents.InitiatingProcessAccountName"
+                                    "DeviceProcessEvents.AccountUpn",
+                                    "DeviceEvents.AccountUpn",
+                                    "DeviceNetworkEvents.InitiatingProcessAccountUpn",
+                                    "DeviceRegistryEvents.InitiatingProcessAccountUpn",
+                                    "DeviceFileEvents.InitiatingProcessAccountUpn",
+                                    "DeviceImageLoadEvents.InitiatingProcessAccountUpn"
                                 ],
                                 "creator_user_ref.user_id": [
-                                    "DeviceProcessEvents.AccountSid",
-                                    "DeviceProcessEvents.InitiatingProcessAccountSid"
+                                    "DeviceProcessEvents.AccountName",
+                                    "DeviceEvents.AccountName",
+                                    "DeviceNetworkEvents.InitiatingProcessAccountName",
+                                    "DeviceRegistryEvents.InitiatingProcessAccountName",
+                                    "DeviceFileEvents.InitiatingProcessAccountName",
+                                    "DeviceImageLoadEvents.InitiatingProcessAccountName"
                                 ],
                                 "name": [
                                     "DeviceProcessEvents.FileName",
+                                    "DeviceEvents.FileName",
                                     "DeviceProcessEvents.InitiatingProcessFileName",
-                                    "DeviceProcessEvents.InitiatingProcessParentFileName",
+                                    "DeviceEvents.InitiatingProcessFileName",
+                                    "DeviceFileEvents.InitiatingProcessFileName",
                                     "DeviceNetworkEvents.InitiatingProcessFileName",
-                                    "DeviceNetworkEvents.InitiatingProcessParentFileName",
                                     "DeviceRegistryEvents.InitiatingProcessFileName",
-                                    "DeviceRegistryEvents.InitiatingProcessParentFileName"
+                                    "DeviceImageLoadEvents.InitiatingProcessFileName"
+                                ],
+                                "parent_ref.binary_ref.hashes.'SHA-1'": [
+                                    "DeviceProcessEvents.InitiatingProcessSHA1",
+                                    "DeviceEvents.InitiatingProcessSHA1"
+                                ],
+                                "parent_ref.binary_ref.hashes.'SHA-256'": [
+                                    "DeviceProcessEvents.InitiatingProcessSHA256",
+                                    "DeviceEvents.InitiatingProcessSHA256"
+                                ],
+                                "parent_ref.binary_ref.hashes.MD5": [
+                                    "DeviceProcessEvents.InitiatingProcessMD5",
+                                    "DeviceEvents.InitiatingProcessMD5"
+                                ],
+                                "parent_ref.binary_ref.parent_directory_ref.path": [
+                                    "DeviceProcessEvents.InitiatingProcessFolderPath",
+                                    "DeviceEvents.InitiatingProcessFolderPath"
                                 ],
                                 "parent_ref.created": [
-                                    "DeviceProcessEvents.InitiatingProcessParentCreationTime",
+                                    "DeviceProcessEvents.InitiatingProcessCreationTime",
+                                    "DeviceEvents.InitiatingProcessCreationTime",
                                     "DeviceNetworkEvents.InitiatingProcessParentCreationTime",
                                     "DeviceRegistryEvents.InitiatingProcessParentCreationTime",
-                                    "DeviceFileEvents.InitiatingProcessParentCreationTime"
+                                    "DeviceFileEvents.InitiatingProcessParentCreationTime",
+                                    "DeviceImageLoadEvents.InitiatingProcessParentCreationTime"
+                                ],
+                                "parent_ref.creator_user_ref.account_login": [
+                                    "DeviceProcessEvents.InitiatingProcessAccountUpn",
+                                    "DeviceEvents.InitiatingProcessAccountUpn"
+                                ],
+                                "parent_ref.creator_user_ref.user_id": [
+                                    "DeviceProcessEvents.InitiatingProcessAccountName",
+                                    "DeviceEvents.InitiatingProcessAccountName"
                                 ],
                                 "parent_ref.name": [
                                     "DeviceProcessEvents.InitiatingProcessFileName",
-                                    "DeviceProcessEvents.InitiatingProcessFileName",
-                                    "DeviceNetworkEvents.InitiatingProcessFileName",
-                                    "DeviceRegistryEvents.InitiatingProcessFileName",
-                                    "DeviceProcessEvents.InitiatingProcessParentFileName",
-                                    "DeviceProcessEvents.InitiatingProcessParentFileName",
+                                    "DeviceEvents.InitiatingProcessFileName",
+                                    "DeviceFileEvents.InitiatingProcessParentFileName",
                                     "DeviceNetworkEvents.InitiatingProcessParentFileName",
-                                    "DeviceRegistryEvents.InitiatingProcessParentFileName"
+                                    "DeviceRegistryEvents.InitiatingProcessParentFileName",
+                                    "DeviceImageLoadEvents.InitiatingProcessParentFileName"
+                                ],
+                                "parent_ref.parent_ref.created": [
+                                    "DeviceProcessEvents.InitiatingProcessParentCreationTime",
+                                    "DeviceEvents.InitiatingProcessParentCreationTime"
+                                ],
+                                "parent_ref.parent_ref.name": [
+                                    "DeviceProcessEvents.InitiatingProcessParentFileName",
+                                    "DeviceEvents.InitiatingProcessParentFileName"
+                                ],
+                                "parent_ref.parent_ref.pid": [
+                                    "DeviceProcessEvents.InitiatingProcessParentId",
+                                    "DeviceNetworkEvents.InitiatingProcessParentId"
                                 ],
                                 "parent_ref.pid": [
                                     "DeviceProcessEvents.InitiatingProcessId",
                                     "DeviceNetworkEvents.InitiatingProcessId",
-                                    "DeviceRegistryEvents.InitiatingProcessId",
-                                    "DeviceFileEvents.InitiatingProcessId",
-                                    "DeviceProcessEvents.InitiatingProcessParentId",
-                                    "DeviceNetworkEvents.InitiatingProcessParentId",
                                     "DeviceRegistryEvents.InitiatingProcessParentId",
-                                    "DeviceFileEvents.InitiatingProcessParentId"
+                                    "DeviceFileEvents.InitiatingProcessParentId",
+                                    "DeviceEvents.InitiatingProcessParentId",
+                                    "DeviceImageLoadEvents.InitiatingProcessParentId"
                                 ],
                                 "pid": [
                                     "DeviceProcessEvents.ProcessId",
+                                    "DeviceEvents.ProcessId",
+                                    "DeviceProcessEvents.InitiatingProcessId",
+                                    "DeviceEvents.InitiatingProcessId",
                                     "DeviceProcessEvents.InitiatingProcessId",
-                                    "DeviceProcessEvents.InitiatingProcessParentId",
                                     "DeviceNetworkEvents.InitiatingProcessId",
-                                    "DeviceNetworkEvents.InitiatingProcessParentId",
                                     "DeviceRegistryEvents.InitiatingProcessId",
-                                    "DeviceRegistryEvents.InitiatingProcessParentId",
                                     "DeviceFileEvents.InitiatingProcessId",
-                                    "DeviceFileEvents.InitiatingProcessParentId"
+                                    "DeviceImageLoadEvents.InitiatingProcessId"
                                 ]
                             }
                         },
                         "url": {
                             "fields": {
                                 "value": [
-                                    "DeviceNetworkEvents.RemoteUrl"
+                                    "DeviceNetworkEvents.RemoteUrl",
+                                    "DeviceEvents.RemoteUrl",
+                                    "DeviceFileEvents.FileOriginUrl",
+                                    "DeviceFileEvents.FileOriginReferrerUrl"
                                 ]
                             }
                         },
                         "user-account": {
                             "fields": {
                                 "account_login": [
-                                    "DeviceProcessEvents.AccountName",
-                                    "DeviceNetworkEvents.InitiatingProcessAccountName",
-                                    "DeviceRegistryEvents.InitiatingProcessAccountName"
+                                    "DeviceProcessEvents.AccountUpn",
+                                    "DeviceEvents.AccountUpn",
+                                    "DeviceProcessEvents.InitiatingProcessAccountUpn",
+                                    "DeviceNetworkEvents.InitiatingProcessAccountUpn",
+                                    "DeviceRegistryEvents.InitiatingProcessAccountUpn",
+                                    "DeviceFileEvents.InitiatingProcessAccountUpn",
+                                    "DeviceEvents.InitiatingProcessAccountUpn",
+                                    "DeviceImageLoadEvents.InitiatingProcessAccountUpn"
                                 ],
                                 "user_id": [
-                                    "DeviceProcessEvents.AccountSid",
-                                    "DeviceNetworkEvents.InitiatingProcessAccountSid",
-                                    "DeviceRegistryEvents.InitiatingProcessAccountSid"
+                                    "DeviceProcessEvents.AccountName",
+                                    "DeviceFileEvents.RequestAccountName",
+                                    "DeviceEvents.AccountName",
+                                    "DeviceProcessEvents.InitiatingProcessAccountName",
+                                    "DeviceNetworkEvents.InitiatingProcessAccountName",
+                                    "DeviceRegistryEvents.InitiatingProcessAccountName",
+                                    "DeviceFileEvents.InitiatingProcessAccountName",
+                                    "DeviceEvents.InitiatingProcessAccountName",
+                                    "DeviceImageLoadEvents.InitiatingProcessAccountName"
                                 ]
                             }
                         },
                         "windows-registry-key": {
                             "fields": {
                                 "key": [
-                                    "DeviceRegistryEvents.RegistryKey"
+                                    "DeviceRegistryEvents.RegistryKey",
+                                    "DeviceEvents.RegistryKey"
                                 ],
                                 "values[*]": [
-                                    "DeviceRegistryEvents.RegistryValueName"
+                                    "DeviceRegistryEvents.RegistryValueName",
+                                    "DeviceEvents.RegistryValueName"
                                 ]
                             }
                         },
-                        "x-msatp": {
+                        "x-ibm-finding": {
                             "fields": {
-                                "computer_name": [
-                                    "DeviceProcessEvents.DeviceName",
-                                    "DeviceNetworkEvents.DeviceName",
-                                    "DeviceRegistryEvents.DeviceName",
-                                    "DeviceFileEvents.DeviceName"
+                                "alert_id": [
+                                    "DeviceAlertEvents.AlertId"
                                 ],
-                                "machine_id": [
-                                    "DeviceProcessEvents.DeviceId",
-                                    "DeviceNetworkEvents.DeviceId",
-                                    "DeviceRegistryEvents.DeviceId",
-                                    "DeviceFileEvents.DeviceId"
+                                "name": [
+                                    "DeviceAlertEvents.Title"
+                                ],
+                                "time_observed": [
+                                    "DeviceAlertEvents.Timestamp"
                                 ]
                             }
                         },
                         "x-oca-asset": {
                             "fields": {
-                                "domain": [
-                                    "DeviceFileEvents.DeviceName",
-                                    "DeviceProcessEvents.DeviceName",
-                                    "DeviceNetworkEvents.DeviceName",
-                                    "DeviceRegistryEvents.DeviceName",
-                                    "DeviceEvents.DeviceName",
-                                    "DeviceInfo.DeviceName",
-                                    "DeviceAlertEvents.DeviceName",
-                                    "DeviceImageLoadEvents.DeviceName",
-                                    "DeviceLogonEvents.DeviceName",
-                                    "DeviceNetworkInfo.DeviceName"
+                                "device_id": [
+                                    "DeviceFileEvents.DeviceId",
+                                    "DeviceProcessEvents.DeviceId",
+                                    "DeviceNetworkEvents.DeviceId",
+                                    "DeviceRegistryEvents.DeviceId",
+                                    "DeviceEvents.DeviceId",
+                                    "DeviceImageLoadEvents.DeviceId",
+                                    "DeviceLogonEvents.DeviceId"
                                 ],
                                 "hostname": [
                                     "DeviceFileEvents.DeviceName",
                                     "DeviceProcessEvents.DeviceName",
                                     "DeviceNetworkEvents.DeviceName",
                                     "DeviceRegistryEvents.DeviceName",
                                     "DeviceEvents.DeviceName",
-                                    "DeviceInfo.DeviceName",
-                                    "DeviceAlertEvents.DeviceName",
                                     "DeviceImageLoadEvents.DeviceName",
-                                    "DeviceLogonEvents.DeviceName",
-                                    "DeviceNetworkInfo.DeviceName"
+                                    "DeviceLogonEvents.DeviceName"
                                 ],
-                                "ip": [
+                                "ip_refs[*].value": [
                                     "DeviceNetworkEvents.LocalIP"
                                 ],
-                                "name": [
-                                    "DeviceFileEvents.DeviceName",
-                                    "DeviceProcessEvents.DeviceName",
-                                    "DeviceNetworkEvents.DeviceName",
-                                    "DeviceRegistryEvents.DeviceName",
-                                    "DeviceEvents.DeviceName",
-                                    "DeviceInfo.DeviceName",
-                                    "DeviceAlertEvents.DeviceName",
-                                    "DeviceImageLoadEvents.DeviceName",
-                                    "DeviceLogonEvents.DeviceName",
-                                    "DeviceNetworkInfo.DeviceName"
-                                ],
                                 "os.name": [
                                     "DeviceInfo.OSPlatform"
                                 ],
                                 "os.platform": [
                                     "DeviceInfo.OSPlatform"
                                 ]
                             }
                         },
                         "x-oca-event": {
                             "fields": {
+                                "action": [
+                                    "DeviceProcessEvents.ActionType",
+                                    "DeviceEvents.ActionType",
+                                    "DeviceNetworkEvents.ActionType",
+                                    "DeviceRegistryEvents.ActionType",
+                                    "DeviceFileEvents.ActionType",
+                                    "DeviceImageLoadEvents.ActionType"
+                                ],
                                 "domain_ref.value": [
-                                    "DeviceProcessEvents.DeviceName",
-                                    "DeviceNetworkEvents.DeviceName",
-                                    "DeviceRegistryEvents.DeviceName",
-                                    "DeviceFileEvents.DeviceName"
+                                    "DeviceNetworkEvents.RemoteUrl",
+                                    "DeviceEvents.RemoteUrl"
                                 ],
                                 "file_ref.name": [
-                                    "DeviceProcessEvents.InitiatingProcessFileName",
-                                    "DeviceNetworkEvents.InitiatingProcessFileName",
-                                    "DeviceRegistryEvents.InitiatingProcessFileName"
+                                    "DeviceFileEvents.FileName",
+                                    "DeviceImageLoadEvents.FileName"
                                 ],
-                                "host_ref.hostname": [
-                                    "DeviceFileEvents.DeviceName",
-                                    "DeviceProcessEvents.DeviceName",
-                                    "DeviceNetworkEvents.DeviceName",
-                                    "DeviceRegistryEvents.DeviceName",
-                                    "DeviceEvents.DeviceName",
-                                    "DeviceInfo.DeviceName",
-                                    "DeviceAlertEvents.DeviceName",
-                                    "DeviceImageLoadEvents.DeviceName",
-                                    "DeviceLogonEvents.DeviceName",
-                                    "DeviceNetworkInfo.DeviceName"
+                                "host_ref.device_id": [
+                                    "DeviceFileEvents.DeviceId",
+                                    "DeviceProcessEvents.DeviceId",
+                                    "DeviceNetworkEvents.DeviceId",
+                                    "DeviceRegistryEvents.DeviceId",
+                                    "DeviceEvents.DeviceId",
+                                    "DeviceImageLoadEvents.DeviceId",
+                                    "DeviceLogonEvents.DeviceId"
                                 ],
-                                "host_ref.name": [
+                                "host_ref.hostname": [
                                     "DeviceFileEvents.DeviceName",
                                     "DeviceProcessEvents.DeviceName",
                                     "DeviceNetworkEvents.DeviceName",
                                     "DeviceRegistryEvents.DeviceName",
                                     "DeviceEvents.DeviceName",
-                                    "DeviceInfo.DeviceName",
-                                    "DeviceAlertEvents.DeviceName",
                                     "DeviceImageLoadEvents.DeviceName",
-                                    "DeviceLogonEvents.DeviceName",
-                                    "DeviceNetworkInfo.DeviceName"
+                                    "DeviceLogonEvents.DeviceName"
                                 ],
                                 "parent_process_ref.name": [
-                                    "DeviceProcessEvents.InitiatingProcessParentFileName",
+                                    "DeviceProcessEvents.InitiatingProcessFileName",
+                                    "DeviceEvents.InitiatingProcessFileName",
                                     "DeviceNetworkEvents.InitiatingProcessParentFileName",
                                     "DeviceRegistryEvents.InitiatingProcessParentFileName",
-                                    "DeviceFileEvents.InitiatingProcessParentFileName"
+                                    "DeviceFileEvents.InitiatingProcessParentFileName",
+                                    "DeviceImageLoadEvents.InitiatingProcessParentFileName"
                                 ],
                                 "parent_process_ref.pid": [
-                                    "DeviceProcessEvents.InitiatingProcessParentId",
+                                    "DeviceProcessEvents.InitiatingProcessId",
+                                    "DeviceEvents.InitiatingProcessId",
                                     "DeviceNetworkEvents.InitiatingProcessParentId",
                                     "DeviceRegistryEvents.InitiatingProcessParentId",
-                                    "DeviceFileEvents.InitiatingProcessParentId"
+                                    "DeviceFileEvents.InitiatingProcessParentId",
+                                    "DeviceImageLoadEvents.InitiatingProcessParentId"
+                                ],
+                                "process_ref.binary_ref.hashes.'SHA-1'": [
+                                    "DeviceProcessEvents.SHA1",
+                                    "DeviceEvents.SHA1",
+                                    "DeviceNetworkEvents.InitiatingProcessSHA1",
+                                    "DeviceRegistryEvents.InitiatingProcessSHA1",
+                                    "DeviceFileEvents.InitiatingProcessSHA1",
+                                    "DeviceImageLoadEvents.InitiatingProcessSHA1"
                                 ],
                                 "process_ref.binary_ref.hashes.'SHA-256'": [
-                                    "DeviceProcessEvents.InitiatingProcessSHA256",
+                                    "DeviceProcessEvents.SHA256",
+                                    "DeviceEvents.SHA256",
                                     "DeviceNetworkEvents.InitiatingProcessSHA256",
                                     "DeviceRegistryEvents.InitiatingProcessSHA256",
-                                    "DeviceFileEvents.InitiatingProcessSHA256"
+                                    "DeviceFileEvents.InitiatingProcessSHA256",
+                                    "DeviceImageLoadEvents.InitiatingProcessSHA256"
                                 ],
                                 "process_ref.binary_ref.hashes.MD5": [
-                                    "DeviceProcessEvents.InitiatingProcessMD5",
+                                    "DeviceProcessEvents.MD5",
+                                    "DeviceEvents.MD5",
                                     "DeviceNetworkEvents.InitiatingProcessMD5",
                                     "DeviceRegistryEvents.InitiatingProcessMD5",
-                                    "DeviceFileEvents.InitiatingProcessMD5"
+                                    "DeviceFileEvents.InitiatingProcessMD5",
+                                    "DeviceImageLoadEvents.InitiatingProcessMD5"
                                 ],
                                 "process_ref.binary_ref.name": [
-                                    "DeviceProcessEvents.InitiatingProcessFileName",
+                                    "DeviceProcessEvents.FileName",
+                                    "DeviceEvents.FileName",
                                     "DeviceNetworkEvents.InitiatingProcessFileName",
                                     "DeviceRegistryEvents.InitiatingProcessFileName",
-                                    "DeviceFileEvents.InitiatingProcessFileName"
-                                ],
-                                "process_ref.child_refs.name": [
-                                    "DeviceProcessEvents.FileName"
-                                ],
-                                "process_ref.child_refs.pid": [
-                                    "DeviceProcessEvents.ProcessId"
+                                    "DeviceFileEvents.InitiatingProcessFileName",
+                                    "DeviceImageLoadEvents.InitiatingProcessFileName"
                                 ],
                                 "process_ref.command_line": [
-                                    "DeviceProcessEvents.InitiatingProcessCommandLine",
+                                    "DeviceProcessEvents.ProcessCommandLine",
+                                    "DeviceEvents.ProcessCommandLine",
                                     "DeviceNetworkEvents.InitiatingProcessCommandLine",
                                     "DeviceRegistryEvents.InitiatingProcessCommandLine",
-                                    "DeviceFileEvents.InitiatingProcessCommandLine"
+                                    "DeviceFileEvents.InitiatingProcessCommandLine",
+                                    "DeviceImageLoadEvents.InitiatingProcessCommandLine"
                                 ],
                                 "process_ref.creator_user_ref.account_login": [
-                                    "DeviceProcessEvents.AccountName"
+                                    "DeviceProcessEvents.AccountUpn",
+                                    "DeviceEvents.AccountUpn",
+                                    "DeviceNetworkEvents.InitiatingProcessAccountUpn",
+                                    "DeviceRegistryEvents.InitiatingProcessAccountUpn",
+                                    "DeviceFileEvents.InitiatingProcessAccountUpn",
+                                    "DeviceImageLoadEvents.InitiatingProcessAccountUpn"
                                 ],
                                 "process_ref.creator_user_ref.user_id": [
-                                    "DeviceProcessEvents.InitiatingProcessAccountSid",
-                                    "DeviceNetworkEvents.InitiatingProcessAccountSid",
-                                    "DeviceRegistryEvents.InitiatingProcessAccountSid",
-                                    "DeviceFileEvents.InitiatingProcessAccountSid"
+                                    "DeviceProcessEvents.AccountName",
+                                    "DeviceEvents.AccountName",
+                                    "DeviceNetworkEvents.InitiatingProcessAccountName",
+                                    "DeviceRegistryEvents.InitiatingProcessAccountName",
+                                    "DeviceFileEvents.InitiatingProcessAccountName",
+                                    "DeviceImageLoadEvents.InitiatingProcessAccountName"
                                 ],
                                 "process_ref.name": [
-                                    "DeviceProcessEvents.InitiatingProcessFileName",
+                                    "DeviceProcessEvents.FileName",
+                                    "DeviceEvents.FileName",
                                     "DeviceNetworkEvents.InitiatingProcessFileName",
                                     "DeviceRegistryEvents.InitiatingProcessFileName",
-                                    "DeviceFileEvents.InitiatingProcessFileName"
+                                    "DeviceFileEvents.InitiatingProcessFileName",
+                                    "DeviceImageLoadEvents.InitiatingProcessFileName"
+                                ],
+                                "process_ref.parent_ref.command_line": [
+                                    "DeviceProcessEvents.InitiatingProcessCommandLine",
+                                    "DeviceEvents.InitiatingProcessCommandLine"
                                 ],
                                 "process_ref.parent_ref.name": [
-                                    "DeviceProcessEvents.InitiatingProcessParentFileName",
+                                    "DeviceProcessEvents.InitiatingProcessFileName",
+                                    "DeviceEvents.InitiatingProcessFileName",
                                     "DeviceNetworkEvents.InitiatingProcessParentFileName",
                                     "DeviceRegistryEvents.InitiatingProcessParentFileName",
-                                    "DeviceFileEvents.InitiatingProcessParentFileName"
+                                    "DeviceFileEvents.InitiatingProcessParentFileName",
+                                    "DeviceImageLoadEvents.InitiatingProcessParentFileName"
                                 ],
                                 "process_ref.parent_ref.pid": [
-                                    "DeviceProcessEvents.InitiatingProcessParentId",
+                                    "DeviceProcessEvents.InitiatingProcessId",
+                                    "DeviceEvents.InitiatingProcessId",
                                     "DeviceNetworkEvents.InitiatingProcessParentId",
                                     "DeviceRegistryEvents.InitiatingProcessParentId",
-                                    "DeviceFileEvents.InitiatingProcessParentId"
+                                    "DeviceFileEvents.InitiatingProcessParentId",
+                                    "DeviceImageLoadEvents.InitiatingProcessParentId"
                                 ],
                                 "process_ref.pid": [
-                                    "DeviceProcessEvents.InitiatingProcessId",
+                                    "DeviceProcessEvents.ProcessId",
+                                    "DeviceEvents.ProcessId",
                                     "DeviceNetworkEvents.InitiatingProcessId",
                                     "DeviceRegistryEvents.InitiatingProcessId",
-                                    "DeviceFileEvents.InitiatingProcessId"
-                                ],
-                                "process_ref.process_ref.creator_user_ref.account_login": [
-                                    "DeviceProcessEvents.AccountName"
+                                    "DeviceFileEvents.InitiatingProcessId",
+                                    "DeviceImageLoadEvents.InitiatingProcessId"
                                 ],
                                 "registry_ref.key": [
                                     "DeviceRegistryEvents.RegistryKey"
+                                ],
+                                "url_ref.value": [
+                                    "DeviceNetworkEvents.RemoteUrl",
+                                    "DeviceEvents.RemoteUrl",
+                                    "DeviceEvents.FileOriginUrl",
+                                    "DeviceFileEvents.FileOriginUrl",
+                                    "DeviceFileEvents.FileOriginReferrerUrl"
                                 ]
                             }
                         }
                     },
                     "operators": {
                         "ComparisonComparators.Equal": "==",
                         "ComparisonComparators.GreaterThan": ">",
@@ -515,71 +628,1413 @@
                         "ComparisonComparators.NotEqual": "!=",
                         "ComparisonExpressionOperators.And": "and",
                         "ComparisonExpressionOperators.Or": "or",
                         "ObservationOperators.And": "or",
                         "ObservationOperators.Or": "or"
                     },
                     "to_stix_map": {
-                        "DeviceFileEvents": {
+                        "DeviceAlertEvents": {
+                            "AlertId": [
+                                {
+                                    "key": "x-ibm-finding.alert_id",
+                                    "object": "finding"
+                                },
+                                {
+                                    "group": true,
+                                    "key": "x-oca-event.finding_refs",
+                                    "object": "event",
+                                    "references": [
+                                        "finding"
+                                    ]
+                                }
+                            ],
+                            "AttackTechniques": [
+                                {
+                                    "key": "x-ibm-ttp-tagging.extensions.mitre-attack-ext.technique_name",
+                                    "object": "ttp_tagging",
+                                    "unwrap": true
+                                },
+                                {
+                                    "group": true,
+                                    "key": "x-ibm-finding.ttp_tagging_refs",
+                                    "object": "finding",
+                                    "references": [
+                                        "ttp_tagging"
+                                    ],
+                                    "unwrap": true
+                                }
+                            ],
+                            "Category": [
+                                {
+                                    "key": "x-ibm-ttp-tagging.kill_chain_phases.phase_name",
+                                    "object": "ttp_tagging_phase"
+                                },
+                                {
+                                    "group": true,
+                                    "key": "x-ibm-finding.ttp_tagging_refs",
+                                    "object": "finding",
+                                    "references": [
+                                        "ttp_tagging_phase"
+                                    ],
+                                    "unwrap": true
+                                }
+                            ],
+                            "DeviceId": [
+                                {
+                                    "key": "x-oca-asset.device_id",
+                                    "object": "host"
+                                },
+                                {
+                                    "key": "x-oca-event.host_ref",
+                                    "object": "event",
+                                    "references": "host"
+                                }
+                            ],
+                            "DeviceName": [
+                                {
+                                    "key": "x-oca-asset.hostname",
+                                    "object": "host"
+                                },
+                                {
+                                    "key": "x-oca-event.host_ref",
+                                    "object": "event",
+                                    "references": "host"
+                                }
+                            ],
+                            "FileName": [
+                                {
+                                    "key": "file.name",
+                                    "object": "file",
+                                    "transformer": "ToFileName"
+                                },
+                                {
+                                    "key": "x-oca-event.file_ref",
+                                    "object": "event",
+                                    "references": "file"
+                                },
+                                {
+                                    "key": "directory.path",
+                                    "object": "file_dir",
+                                    "transformer": "ToMSATPDirectoryPath"
+                                },
+                                {
+                                    "key": "file.parent_directory_ref",
+                                    "object": "file",
+                                    "references": "file_dir"
+                                }
+                            ],
+                            "MD5": {
+                                "key": "file.hashes.MD5",
+                                "object": "file"
+                            },
+                            "RemoteIP": [
+                                {
+                                    "key": "ipv4-addr.value",
+                                    "object": "dst_ip"
+                                },
+                                {
+                                    "key": "ipv6-addr.value",
+                                    "object": "dst_ip"
+                                },
+                                {
+                                    "key": "network-traffic.dst_ref",
+                                    "object": "nt",
+                                    "references": "dst_ip"
+                                },
+                                {
+                                    "key": "x-oca-event.network_ref",
+                                    "object": "event",
+                                    "references": "nt"
+                                },
+                                {
+                                    "group": true,
+                                    "key": "x-oca-event.ip_refs",
+                                    "object": "event",
+                                    "references": [
+                                        "dst_ip"
+                                    ]
+                                },
+                                {
+                                    "group": true,
+                                    "key": "x-ibm-finding.ioc_refs",
+                                    "object": "finding",
+                                    "references": [
+                                        "dst_ip"
+                                    ]
+                                }
+                            ],
+                            "RemoteUrl": [
+                                {
+                                    "key": "url.value",
+                                    "object": "url",
+                                    "transformer": "IfValidUrl"
+                                },
+                                {
+                                    "key": "domain-name.value",
+                                    "object": "domain-name",
+                                    "transformer": "GetDomainName"
+                                },
+                                {
+                                    "key": "x-oca-event.domain_ref",
+                                    "object": "event",
+                                    "references": "domain-name"
+                                },
+                                {
+                                    "key": "x-oca-event.url_ref",
+                                    "object": "event",
+                                    "references": "url"
+                                },
+                                {
+                                    "group": true,
+                                    "key": "x-ibm-finding.ioc_refs",
+                                    "object": "finding",
+                                    "references": [
+                                        "url",
+                                        "domain-name"
+                                    ]
+                                }
+                            ],
+                            "ReportId": {
+                                "key": "x-msatp.ReportId",
+                                "object": "x-msatp"
+                            },
+                            "SHA1": {
+                                "key": "file.hashes.SHA-1",
+                                "object": "file"
+                            },
+                            "SHA256": {
+                                "key": "file.hashes.SHA-256",
+                                "object": "file"
+                            },
+                            "Severity": {
+                                "key": "x-ibm-finding.severity",
+                                "object": "finding",
+                                "transformer": "SeverityToNumericVal"
+                            },
+                            "TableName": {
+                                "key": "x-msatp.Table",
+                                "object": "x-msatp"
+                            },
+                            "Timestamp": [
+                                {
+                                    "key": "x-oca-event.created",
+                                    "object": "event"
+                                },
+                                {
+                                    "key": "x-ibm-finding.time_observed",
+                                    "object": "finding"
+                                },
+                                {
+                                    "cybox": false,
+                                    "key": "first_observed",
+                                    "transformer": "MsatpToTimestamp"
+                                },
+                                {
+                                    "cybox": false,
+                                    "key": "last_observed",
+                                    "transformer": "MsatpToTimestamp"
+                                }
+                            ],
+                            "Title": [
+                                {
+                                    "key": "x-ibm-finding.name",
+                                    "object": "finding"
+                                },
+                                {
+                                    "key": "x-oca-event.action",
+                                    "object": "event"
+                                },
+                                {
+                                    "key": "x-oca-event.category",
+                                    "object": "event",
+                                    "transformer": "Alert"
+                                },
+                                {
+                                    "key": "x-ibm-finding.finding_type",
+                                    "object": "finding",
+                                    "transformer": "Alert"
+                                }
+                            ],
+                            "event_count": {
+                                "cybox": false,
+                                "key": "number_observed",
+                                "transformer": "ToInteger"
+                            },
+                            "event_link": [
+                                {
+                                    "key": "external-reference.url",
+                                    "object": "device_external_ref"
+                                },
+                                {
+                                    "key": "x-oca-event.external_ref",
+                                    "object": "event",
+                                    "references": "device_external_ref"
+                                }
+                            ],
+                            "original_ref": [
+                                {
+                                    "key": "artifact.payload_bin",
+                                    "object": "original_ref",
+                                    "transformer": "ToBase64"
+                                },
+                                {
+                                    "key": "x-oca-event.original_ref",
+                                    "object": "event",
+                                    "references": "original_ref"
+                                }
+                            ],
+                            "provider": {
+                                "key": "x-oca-event.provider",
+                                "object": "event",
+                                "value": "Microsoft Defender for Endpoint"
+                            }
+                        },
+                        "DeviceEvents": {
+                            "AccountName": [
+                                {
+                                    "key": "user-account.user_id",
+                                    "object": "child_process_creator"
+                                },
+                                {
+                                    "key": "process.creator_user_ref",
+                                    "object": "child_process",
+                                    "references": "child_process_creator"
+                                }
+                            ],
+                            "AccountUpn": [
+                                {
+                                    "key": "user-account.account_login",
+                                    "object": "child_process_creator"
+                                },
+                                {
+                                    "key": "process.creator_user_ref",
+                                    "object": "child_process",
+                                    "references": "child_process_creator"
+                                }
+                            ],
                             "ActionType": [
                                 {
                                     "key": "x-oca-event.action",
                                     "object": "event"
                                 }
                             ],
-                            "DeviceId": {
-                                "key": "x-oca-asset.device_id",
+                            "AdditionalFields": {
+                                "key": "x-msatp.AdditionalFields",
+                                "object": "x-msatp",
+                                "transformer": "JsonToString"
+                            },
+                            "Alerts": {
+                                "key": "x-json-alert.data"
+                            },
+                            "DeviceId": [
+                                {
+                                    "key": "x-oca-asset.device_id",
+                                    "object": "host"
+                                },
+                                {
+                                    "key": "x-oca-event.host_ref",
+                                    "object": "event",
+                                    "references": "host"
+                                }
+                            ],
+                            "DeviceName": [
+                                {
+                                    "key": "x-oca-asset.hostname",
+                                    "object": "host"
+                                },
+                                {
+                                    "key": "x-oca-event.host_ref",
+                                    "object": "event",
+                                    "references": "host"
+                                }
+                            ],
+                            "FileName": [
+                                {
+                                    "key": "file.name",
+                                    "object": "child_process_file",
+                                    "transformer": "ToFileName"
+                                },
+                                {
+                                    "key": "process.name",
+                                    "object": "child_process",
+                                    "transformer": "ToFileName"
+                                },
+                                {
+                                    "key": "process.binary_ref",
+                                    "object": "child_process",
+                                    "references": "child_process_file"
+                                },
+                                {
+                                    "key": "process.child_refs",
+                                    "object": "process",
+                                    "references": [
+                                        "child_process"
+                                    ]
+                                },
+                                {
+                                    "key": "x-oca-event.process_ref",
+                                    "object": "event",
+                                    "references": "child_process"
+                                },
+                                {
+                                    "key": "directory.path",
+                                    "object": "child_process_file_dir",
+                                    "transformer": "ToMSATPDirectoryPath"
+                                },
+                                {
+                                    "key": "file.parent_directory_ref",
+                                    "object": "child_process_file",
+                                    "references": "child_process_file_dir"
+                                }
+                            ],
+                            "FileOriginIP": [
+                                {
+                                    "key": "ipv4-addr.value",
+                                    "object": "dst_ip"
+                                },
+                                {
+                                    "key": "ipv6-addr.value",
+                                    "object": "dst_ip"
+                                },
+                                {
+                                    "key": "network-traffic.dst_ref",
+                                    "object": "nt",
+                                    "references": "dst_ip"
+                                },
+                                {
+                                    "key": "x-oca-event.network_ref",
+                                    "object": "event",
+                                    "references": "nt"
+                                }
+                            ],
+                            "FileOriginUrl": [
+                                {
+                                    "key": "url.value",
+                                    "object": "url_ref",
+                                    "transformer": "IfValidUrl"
+                                },
+                                {
+                                    "key": "x-oca-event.url_ref",
+                                    "object": "event",
+                                    "references": "url_ref"
+                                },
+                                {
+                                    "key": "domain-name.value",
+                                    "object": "file-origin-domain",
+                                    "transformer": "GetDomainName"
+                                },
+                                {
+                                    "key": "x-oca-event.domain_ref",
+                                    "object": "event",
+                                    "references": "file-origin-domain"
+                                }
+                            ],
+                            "FolderPath": [
+                                {
+                                    "key": "directory.path",
+                                    "object": "child_process_file_dir",
+                                    "transformer": "ToMSATPDirectoryPath"
+                                },
+                                {
+                                    "key": "file.parent_directory_ref",
+                                    "object": "child_process_file",
+                                    "references": "child_process_file_dir"
+                                }
+                            ],
+                            "IPAddresses": [
+                                {
+                                    "key": "ipv4-addr.value",
+                                    "object": "host_ip4",
+                                    "transformer": "FilterIPv4List",
+                                    "unwrap": true
+                                },
+                                {
+                                    "key": "ipv6-addr.value",
+                                    "object": "host_ip6",
+                                    "transformer": "FilterIPv6List",
+                                    "unwrap": true
+                                },
+                                {
+                                    "group": true,
+                                    "key": "x-oca-asset.ip_refs",
+                                    "object": "host",
+                                    "references": [
+                                        "host_ip4",
+                                        "host_ip6"
+                                    ],
+                                    "unwrap": true
+                                }
+                            ],
+                            "InitiatingProcessAccountName": [
+                                {
+                                    "key": "user-account.user_id",
+                                    "object": "process_creator"
+                                },
+                                {
+                                    "key": "process.creator_user_ref",
+                                    "object": "process",
+                                    "references": "process_creator"
+                                }
+                            ],
+                            "InitiatingProcessAccountUpn": [
+                                {
+                                    "key": "user-account.account_login",
+                                    "object": "process_creator"
+                                },
+                                {
+                                    "key": "process.creator_user_ref",
+                                    "object": "process",
+                                    "references": "process_creator"
+                                }
+                            ],
+                            "InitiatingProcessCommandLine": {
+                                "key": "process.command_line",
+                                "object": "process"
+                            },
+                            "InitiatingProcessCreationTime": {
+                                "key": "process.created",
+                                "object": "process",
+                                "transformer": "MsatpToTimestamp"
+                            },
+                            "InitiatingProcessFileName": [
+                                {
+                                    "key": "file.name",
+                                    "object": "process_file",
+                                    "transformer": "ToFileName"
+                                },
+                                {
+                                    "key": "process.name",
+                                    "object": "process",
+                                    "transformer": "ToFileName"
+                                },
+                                {
+                                    "key": "process.binary_ref",
+                                    "object": "process",
+                                    "references": "process_file"
+                                },
+                                {
+                                    "key": "process.parent_ref",
+                                    "object": "child_process",
+                                    "references": "process"
+                                },
+                                {
+                                    "key": "directory.path",
+                                    "object": "process_file_dir",
+                                    "transformer": "ToMSATPDirectoryPath"
+                                },
+                                {
+                                    "key": "file.parent_directory_ref",
+                                    "object": "process_file",
+                                    "references": "process_file_dir"
+                                }
+                            ],
+                            "InitiatingProcessFolderPath": [
+                                {
+                                    "key": "directory.path",
+                                    "object": "process_file_dir",
+                                    "transformer": "ToMSATPDirectoryPath"
+                                },
+                                {
+                                    "key": "file.parent_directory_ref",
+                                    "object": "process_file",
+                                    "references": "process_file_dir"
+                                },
+                                {
+                                    "key": "process.binary_ref",
+                                    "object": "process",
+                                    "references": "process_file"
+                                }
+                            ],
+                            "InitiatingProcessId": [
+                                {
+                                    "key": "process.pid",
+                                    "object": "process",
+                                    "transformer": "ToInteger"
+                                },
+                                {
+                                    "key": "process.parent_ref",
+                                    "object": "child_process",
+                                    "references": "process"
+                                }
+                            ],
+                            "InitiatingProcessMD5": [
+                                {
+                                    "key": "file.hashes.MD5",
+                                    "object": "process_file"
+                                },
+                                {
+                                    "key": "process.binary_ref",
+                                    "object": "process",
+                                    "references": "process_file"
+                                }
+                            ],
+                            "InitiatingProcessParentCreationTime": [
+                                {
+                                    "key": "process.created",
+                                    "object": "parent_process",
+                                    "transformer": "MsatpToTimestamp"
+                                },
+                                {
+                                    "key": "process.parent_ref",
+                                    "object": "process",
+                                    "references": "parent_process"
+                                }
+                            ],
+                            "InitiatingProcessParentFileName": [
+                                {
+                                    "key": "file.name",
+                                    "object": "parent_process_file",
+                                    "transformer": "ToFileName"
+                                },
+                                {
+                                    "key": "process.name",
+                                    "object": "parent_process",
+                                    "transformer": "ToFileName"
+                                },
+                                {
+                                    "key": "process.parent_ref",
+                                    "object": "process",
+                                    "references": "parent_process"
+                                },
+                                {
+                                    "key": "process.binary_ref",
+                                    "object": "parent_process",
+                                    "references": "parent_process_file"
+                                },
+                                {
+                                    "key": "directory.path",
+                                    "object": "parent_process_file_dir",
+                                    "transformer": "ToMSATPDirectoryPath"
+                                },
+                                {
+                                    "key": "file.parent_directory_ref",
+                                    "object": "parent_process_file",
+                                    "references": "parent_process_file_dir"
+                                }
+                            ],
+                            "InitiatingProcessParentId": {
+                                "key": "process.pid",
+                                "object": "parent_process",
+                                "transformer": "ToInteger"
+                            },
+                            "InitiatingProcessSHA1": [
+                                {
+                                    "key": "file.hashes.SHA-1",
+                                    "object": "process_file"
+                                },
+                                {
+                                    "key": "process.binary_ref",
+                                    "object": "process",
+                                    "references": "process_file"
+                                }
+                            ],
+                            "InitiatingProcessSHA256": [
+                                {
+                                    "key": "file.hashes.SHA-256",
+                                    "object": "process_file"
+                                },
+                                {
+                                    "key": "process.binary_ref",
+                                    "object": "process",
+                                    "references": "process_file"
+                                }
+                            ],
+                            "LocalIP": [
+                                {
+                                    "key": "ipv4-addr.value",
+                                    "object": "src_ip"
+                                },
+                                {
+                                    "key": "ipv6-addr.value",
+                                    "object": "src_ip"
+                                },
+                                {
+                                    "key": "network-traffic.src_ref",
+                                    "object": "nt",
+                                    "references": "src_ip"
+                                },
+                                {
+                                    "group": true,
+                                    "key": "x-oca-asset.ip_refs",
+                                    "object": "host",
+                                    "references": [
+                                        "src_ip"
+                                    ]
+                                },
+                                {
+                                    "key": "x-oca-event.network_ref",
+                                    "object": "event",
+                                    "references": "nt"
+                                }
+                            ],
+                            "LocalPort": [
+                                {
+                                    "key": "network-traffic.src_port",
+                                    "object": "nt",
+                                    "transformer": "ToInteger"
+                                },
+                                {
+                                    "key": "x-oca-event.network_ref",
+                                    "object": "event",
+                                    "references": "nt"
+                                }
+                            ],
+                            "MD5": {
+                                "key": "file.hashes.MD5",
+                                "object": "child_process_file"
+                            },
+                            "MacAddressSet": [
+                                {
+                                    "key": "mac-addr.value",
+                                    "object": "mac",
+                                    "transformer": "FormatMacList",
+                                    "unwrap": true
+                                },
+                                {
+                                    "group": true,
+                                    "key": "x-oca-asset.mac_refs",
+                                    "object": "host",
+                                    "references": [
+                                        "mac"
+                                    ],
+                                    "unwrap": true
+                                }
+                            ],
+                            "OSArchitecture": {
+                                "key": "x-oca-asset.architecture",
+                                "object": "host"
+                            },
+                            "OSPlatform": {
+                                "key": "x-oca-asset.os_name",
+                                "object": "host"
+                            },
+                            "OSVersion": {
+                                "key": "x-oca-asset.os_version",
                                 "object": "host"
                             },
+                            "ProcessCommandLine": [
+                                {
+                                    "key": "process.command_line",
+                                    "object": "child_process"
+                                },
+                                {
+                                    "key": "process.child_refs",
+                                    "object": "process",
+                                    "references": [
+                                        "child_process"
+                                    ]
+                                }
+                            ],
+                            "ProcessCreationTime": {
+                                "key": "process.created",
+                                "object": "child_process",
+                                "transformer": "MsatpToTimestamp"
+                            },
+                            "ProcessId": [
+                                {
+                                    "key": "process.pid",
+                                    "object": "child_process",
+                                    "transformer": "ToInteger"
+                                },
+                                {
+                                    "key": "process.child_refs",
+                                    "object": "process",
+                                    "references": [
+                                        "child_process"
+                                    ]
+                                },
+                                {
+                                    "key": "x-oca-event.process_ref",
+                                    "object": "event",
+                                    "references": "child_process"
+                                }
+                            ],
+                            "PublicIP": [
+                                {
+                                    "key": "ipv4-addr.value",
+                                    "object": "public-ip"
+                                },
+                                {
+                                    "group": true,
+                                    "key": "x-oca-asset.ip_refs",
+                                    "object": "host",
+                                    "references": [
+                                        "public-ip"
+                                    ]
+                                }
+                            ],
+                            "RemoteIP": [
+                                {
+                                    "key": "ipv4-addr.value",
+                                    "object": "dst_ip"
+                                },
+                                {
+                                    "key": "ipv6-addr.value",
+                                    "object": "dst_ip"
+                                },
+                                {
+                                    "key": "network-traffic.dst_ref",
+                                    "object": "nt",
+                                    "references": "dst_ip"
+                                },
+                                {
+                                    "key": "x-oca-event.network_ref",
+                                    "object": "event",
+                                    "references": "nt"
+                                }
+                            ],
+                            "RemotePort": [
+                                {
+                                    "key": "network-traffic.dst_port",
+                                    "object": "nt",
+                                    "transformer": "ToInteger"
+                                },
+                                {
+                                    "key": "x-oca-event.network_ref",
+                                    "object": "event",
+                                    "references": "nt"
+                                }
+                            ],
+                            "RemoteUrl": [
+                                {
+                                    "key": "url.value",
+                                    "object": "url",
+                                    "transformer": "IfValidUrl"
+                                },
+                                {
+                                    "key": "domain-name.value",
+                                    "object": "domain-name",
+                                    "transformer": "GetDomainName"
+                                },
+                                {
+                                    "key": "x-oca-event.domain_ref",
+                                    "object": "event",
+                                    "references": "domain-name"
+                                },
+                                {
+                                    "key": "x-oca-event.url_ref",
+                                    "object": "event",
+                                    "references": "url"
+                                }
+                            ],
+                            "ReportId": {
+                                "key": "x-msatp.ReportId",
+                                "object": "x-msatp"
+                            },
+                            "SHA1": {
+                                "key": "file.hashes.SHA-1",
+                                "object": "child_process_file"
+                            },
+                            "SHA256": {
+                                "key": "file.hashes.SHA-256",
+                                "object": "child_process_file"
+                            },
+                            "TableName": {
+                                "key": "x-msatp.Table",
+                                "object": "x-msatp"
+                            },
+                            "Timestamp": [
+                                {
+                                    "key": "x-oca-event.created",
+                                    "object": "event"
+                                },
+                                {
+                                    "cybox": false,
+                                    "key": "first_observed",
+                                    "transformer": "MsatpToTimestamp"
+                                },
+                                {
+                                    "cybox": false,
+                                    "key": "last_observed",
+                                    "transformer": "MsatpToTimestamp"
+                                }
+                            ],
+                            "event_count": {
+                                "cybox": false,
+                                "key": "number_observed",
+                                "transformer": "ToInteger"
+                            },
+                            "event_link": [
+                                {
+                                    "key": "external-reference.url",
+                                    "object": "device_external_ref"
+                                },
+                                {
+                                    "key": "x-oca-event.external_ref",
+                                    "object": "event",
+                                    "references": "device_external_ref"
+                                }
+                            ],
+                            "missingChildShouldMapInitiatingPid": {
+                                "key": "x-oca-event.missingChildShouldMapInitiatingPid",
+                                "object": "event"
+                            },
+                            "original_ref": [
+                                {
+                                    "key": "artifact.payload_bin",
+                                    "object": "original_ref",
+                                    "transformer": "ToBase64"
+                                },
+                                {
+                                    "key": "x-oca-event.original_ref",
+                                    "object": "event",
+                                    "references": "original_ref"
+                                }
+                            ],
+                            "provider": {
+                                "key": "x-oca-event.provider",
+                                "object": "event",
+                                "value": "Microsoft Defender for Endpoint"
+                            }
+                        },
+                        "DeviceFileEvents": {
+                            "ActionType": [
+                                {
+                                    "key": "x-oca-event.action",
+                                    "object": "event"
+                                }
+                            ],
+                            "AdditionalFields": {
+                                "key": "x-msatp.AdditionalFields",
+                                "object": "x-msatp",
+                                "transformer": "JsonToString"
+                            },
+                            "Alerts": {
+                                "key": "x-json-alert.data"
+                            },
+                            "DeviceId": [
+                                {
+                                    "key": "x-oca-asset.device_id",
+                                    "object": "host"
+                                },
+                                {
+                                    "key": "x-oca-event.host_ref",
+                                    "object": "event",
+                                    "references": "host"
+                                }
+                            ],
                             "DeviceName": [
                                 {
                                     "key": "x-oca-asset.hostname",
                                     "object": "host"
                                 },
                                 {
                                     "key": "x-oca-event.host_ref",
                                     "object": "event",
                                     "references": "host"
                                 }
                             ],
                             "FileName": [
                                 {
                                     "key": "file.name",
-                                    "object": "file"
+                                    "object": "file",
+                                    "transformer": "ToFileName"
                                 },
                                 {
                                     "key": "x-oca-event.file_ref",
                                     "object": "event",
                                     "references": "file"
+                                },
+                                {
+                                    "key": "directory.path",
+                                    "object": "file_dir",
+                                    "transformer": "ToMSATPDirectoryPath"
+                                },
+                                {
+                                    "key": "file.parent_directory_ref",
+                                    "object": "file",
+                                    "references": "file_dir"
+                                }
+                            ],
+                            "FileOriginIP": [
+                                {
+                                    "key": "ipv4-addr.value",
+                                    "object": "dst_ip"
+                                },
+                                {
+                                    "key": "ipv6-addr.value",
+                                    "object": "dst_ip"
+                                },
+                                {
+                                    "key": "network-traffic.dst_ref",
+                                    "object": "nt",
+                                    "references": "dst_ip"
+                                },
+                                {
+                                    "key": "x-oca-event.network_ref",
+                                    "object": "event",
+                                    "references": "nt"
+                                },
+                                {
+                                    "group": true,
+                                    "key": "x-oca-event.ips_ref",
+                                    "object": "event",
+                                    "references": [
+                                        "dst_ip"
+                                    ]
+                                }
+                            ],
+                            "FileOriginReferrerUrl": [
+                                {
+                                    "key": "url.value",
+                                    "object": "url_ref",
+                                    "transformer": "IfValidUrl"
+                                },
+                                {
+                                    "key": "x-oca-event.url_ref",
+                                    "object": "event",
+                                    "references": "url_ref"
+                                },
+                                {
+                                    "key": "domain-name.value",
+                                    "object": "file-origin-ref-domain",
+                                    "transformer": "GetDomainName"
+                                },
+                                {
+                                    "key": "x-oca-event.domain_ref",
+                                    "object": "event",
+                                    "references": "file-origin-ref-domain"
                                 }
                             ],
                             "FolderPath": [
                                 {
                                     "key": "directory.path",
                                     "object": "file_dir",
-                                    "transformer": "ToDirectoryPath"
+                                    "transformer": "ToMSATPDirectoryPath"
                                 },
                                 {
                                     "key": "file.parent_directory_ref",
                                     "object": "file",
                                     "references": "file_dir"
                                 }
                             ],
+                            "IPAddresses": [
+                                {
+                                    "key": "ipv4-addr.value",
+                                    "object": "host_ip4",
+                                    "transformer": "FilterIPv4List",
+                                    "unwrap": true
+                                },
+                                {
+                                    "key": "ipv6-addr.value",
+                                    "object": "host_ip6",
+                                    "transformer": "FilterIPv6List",
+                                    "unwrap": true
+                                },
+                                {
+                                    "group": true,
+                                    "key": "x-oca-asset.ip_refs",
+                                    "object": "host",
+                                    "references": [
+                                        "host_ip4",
+                                        "host_ip6"
+                                    ],
+                                    "unwrap": true
+                                }
+                            ],
                             "InitiatingProcessAccountName": [
                                 {
+                                    "key": "user-account.user_id",
+                                    "object": "fc_process_creator"
+                                },
+                                {
+                                    "key": "process.creator_user_ref",
+                                    "object": "fc_process",
+                                    "references": "fc_process_creator"
+                                },
+                                {
+                                    "key": "x-oca-event.user_ref",
+                                    "object": "event",
+                                    "references": "fc_process_creator"
+                                }
+                            ],
+                            "InitiatingProcessAccountUpn": [
+                                {
                                     "key": "user-account.account_login",
                                     "object": "fc_process_creator"
                                 },
                                 {
                                     "key": "process.creator_user_ref",
                                     "object": "fc_process",
                                     "references": "fc_process_creator"
                                 }
                             ],
-                            "InitiatingProcessAccountSid": [
+                            "InitiatingProcessCommandLine": {
+                                "key": "process.command_line",
+                                "object": "fc_process"
+                            },
+                            "InitiatingProcessCreationTime": {
+                                "key": "process.created",
+                                "object": "fc_process",
+                                "transformer": "MsatpToTimestamp"
+                            },
+                            "InitiatingProcessFileName": [
+                                {
+                                    "key": "file.name",
+                                    "object": "fc_process_file",
+                                    "transformer": "ToFileName"
+                                },
+                                {
+                                    "key": "process.name",
+                                    "object": "fc_process",
+                                    "transformer": "ToFileName"
+                                },
+                                {
+                                    "key": "process.binary_ref",
+                                    "object": "fc_process",
+                                    "references": "fc_process_file"
+                                },
+                                {
+                                    "key": "x-oca-event.process_ref",
+                                    "object": "event",
+                                    "references": "fc_process"
+                                },
+                                {
+                                    "key": "directory.path",
+                                    "object": "fc_process_file_dir",
+                                    "transformer": "ToMSATPDirectoryPath"
+                                },
+                                {
+                                    "key": "file.parent_directory_ref",
+                                    "object": "fc_process_file",
+                                    "references": "fc_process_file_dir"
+                                }
+                            ],
+                            "InitiatingProcessFolderPath": [
+                                {
+                                    "key": "directory.path",
+                                    "object": "fc_process_file_dir",
+                                    "transformer": "ToMSATPDirectoryPath"
+                                },
+                                {
+                                    "key": "file.parent_directory_ref",
+                                    "object": "fc_process_file",
+                                    "references": "fc_process_file_dir"
+                                },
+                                {
+                                    "key": "process.binary_ref",
+                                    "object": "fc_process",
+                                    "references": "fc_process_file"
+                                }
+                            ],
+                            "InitiatingProcessId": [
+                                {
+                                    "key": "process.pid",
+                                    "object": "fc_process",
+                                    "transformer": "ToInteger"
+                                },
+                                {
+                                    "key": "x-oca-event.process_ref",
+                                    "object": "event",
+                                    "references": "fc_process"
+                                }
+                            ],
+                            "InitiatingProcessMD5": [
+                                {
+                                    "key": "file.hashes.MD5",
+                                    "object": "fc_process_file"
+                                },
+                                {
+                                    "key": "process.binary_ref",
+                                    "object": "fc_process",
+                                    "references": "fc_process_file"
+                                }
+                            ],
+                            "InitiatingProcessParentCreationTime": [
+                                {
+                                    "key": "process.created",
+                                    "object": "fc_parent_process",
+                                    "transformer": "MsatpToTimestamp"
+                                },
+                                {
+                                    "key": "process.parent_ref",
+                                    "object": "fc_process",
+                                    "references": "fc_parent_process"
+                                }
+                            ],
+                            "InitiatingProcessParentFileName": [
+                                {
+                                    "key": "file.name",
+                                    "object": "fc_parent_process_file",
+                                    "transformer": "ToFileName"
+                                },
+                                {
+                                    "key": "process.name",
+                                    "object": "fc_parent_process",
+                                    "transformer": "ToFileName"
+                                },
+                                {
+                                    "key": "process.parent_ref",
+                                    "object": "fc_process",
+                                    "references": "fc_parent_process"
+                                },
+                                {
+                                    "key": "process.binary_ref",
+                                    "object": "fc_parent_process",
+                                    "references": "fc_parent_process_file"
+                                },
+                                {
+                                    "key": "directory.path",
+                                    "object": "fc_parent_process_file_dir",
+                                    "transformer": "ToMSATPDirectoryPath"
+                                },
+                                {
+                                    "key": "file.parent_directory_ref",
+                                    "object": "fc_parent_process_file",
+                                    "references": "fc_parent_process_file_dir"
+                                }
+                            ],
+                            "InitiatingProcessParentId": [
+                                {
+                                    "key": "process.pid",
+                                    "object": "fc_parent_process",
+                                    "transformer": "ToInteger"
+                                },
+                                {
+                                    "key": "process.parent_ref",
+                                    "object": "fc_process",
+                                    "references": "fc_parent_process"
+                                },
+                                {
+                                    "key": "x-oca-event.parent_process_ref",
+                                    "object": "event",
+                                    "references": "fc_parent_process"
+                                }
+                            ],
+                            "InitiatingProcessSHA1": [
+                                {
+                                    "key": "file.hashes.SHA-1",
+                                    "object": "fc_process_file"
+                                },
+                                {
+                                    "key": "process.binary_ref",
+                                    "object": "fc_process",
+                                    "references": "fc_process_file"
+                                }
+                            ],
+                            "InitiatingProcessSHA256": [
+                                {
+                                    "key": "file.hashes.SHA-256",
+                                    "object": "fc_process_file"
+                                },
+                                {
+                                    "key": "process.binary_ref",
+                                    "object": "fc_process",
+                                    "references": "fc_process_file"
+                                }
+                            ],
+                            "MD5": {
+                                "key": "file.hashes.MD5",
+                                "object": "file"
+                            },
+                            "MacAddressSet": [
+                                {
+                                    "key": "mac-addr.value",
+                                    "object": "mac",
+                                    "transformer": "FormatMacList",
+                                    "unwrap": true
+                                },
+                                {
+                                    "group": true,
+                                    "key": "x-oca-asset.mac_refs",
+                                    "object": "host",
+                                    "references": [
+                                        "mac"
+                                    ],
+                                    "unwrap": true
+                                }
+                            ],
+                            "OSArchitecture": {
+                                "key": "x-oca-asset.architecture",
+                                "object": "host"
+                            },
+                            "OSPlatform": {
+                                "key": "x-oca-asset.os_name",
+                                "object": "host"
+                            },
+                            "OSVersion": {
+                                "key": "x-oca-asset.os_version",
+                                "object": "host"
+                            },
+                            "PublicIP": [
+                                {
+                                    "key": "ipv4-addr.value",
+                                    "object": "public-ip"
+                                },
+                                {
+                                    "group": true,
+                                    "key": "x-oca-asset.ip_refs",
+                                    "object": "host",
+                                    "references": [
+                                        "public-ip"
+                                    ]
+                                }
+                            ],
+                            "ReportId": {
+                                "key": "x-msatp.ReportId",
+                                "object": "x-msatp"
+                            },
+                            "SHA1": {
+                                "key": "file.hashes.SHA-1",
+                                "object": "file"
+                            },
+                            "SHA256": {
+                                "key": "file.hashes.SHA-256",
+                                "object": "file"
+                            },
+                            "TableName": {
+                                "key": "x-msatp.Table",
+                                "object": "x-msatp"
+                            },
+                            "Timestamp": [
+                                {
+                                    "key": "x-oca-event.created",
+                                    "object": "event"
+                                },
+                                {
+                                    "cybox": false,
+                                    "key": "first_observed",
+                                    "transformer": "MsatpToTimestamp"
+                                },
+                                {
+                                    "cybox": false,
+                                    "key": "last_observed",
+                                    "transformer": "MsatpToTimestamp"
+                                }
+                            ],
+                            "event_count": {
+                                "cybox": false,
+                                "key": "number_observed",
+                                "transformer": "ToInteger"
+                            },
+                            "event_link": [
+                                {
+                                    "key": "external-reference.url",
+                                    "object": "device_external_ref"
+                                },
+                                {
+                                    "key": "x-oca-event.external_ref",
+                                    "object": "event",
+                                    "references": "device_external_ref"
+                                }
+                            ],
+                            "original_ref": [
+                                {
+                                    "key": "artifact.payload_bin",
+                                    "object": "original_ref",
+                                    "transformer": "ToBase64"
+                                },
+                                {
+                                    "key": "x-oca-event.original_ref",
+                                    "object": "event",
+                                    "references": "original_ref"
+                                }
+                            ],
+                            "provider": {
+                                "key": "x-oca-event.provider",
+                                "object": "event",
+                                "value": "Microsoft Defender for Endpoint"
+                            }
+                        },
+                        "DeviceImageLoadEvents": {
+                            "ActionType": [
+                                {
+                                    "key": "x-oca-event.action",
+                                    "object": "event"
+                                }
+                            ],
+                            "AdditionalFields": {
+                                "key": "x-msatp.AdditionalFields",
+                                "object": "x-msatp",
+                                "transformer": "JsonToString"
+                            },
+                            "Alerts": {
+                                "key": "x-json-alert.data"
+                            },
+                            "DeviceId": [
+                                {
+                                    "key": "x-oca-asset.device_id",
+                                    "object": "host"
+                                },
+                                {
+                                    "key": "x-oca-event.host_ref",
+                                    "object": "event",
+                                    "references": "host"
+                                }
+                            ],
+                            "DeviceName": [
+                                {
+                                    "key": "x-oca-asset.hostname",
+                                    "object": "host"
+                                },
+                                {
+                                    "key": "x-oca-event.host_ref",
+                                    "object": "event",
+                                    "references": "host"
+                                }
+                            ],
+                            "FileName": [
+                                {
+                                    "key": "file.name",
+                                    "object": "file",
+                                    "transformer": "ToFileName"
+                                },
+                                {
+                                    "key": "x-oca-event.file_ref",
+                                    "object": "event",
+                                    "references": "file"
+                                },
+                                {
+                                    "key": "directory.path",
+                                    "object": "file_dir",
+                                    "transformer": "ToMSATPDirectoryPath"
+                                },
+                                {
+                                    "key": "file.parent_directory_ref",
+                                    "object": "file",
+                                    "references": "file_dir"
+                                }
+                            ],
+                            "FolderPath": [
+                                {
+                                    "key": "directory.path",
+                                    "object": "file_dir",
+                                    "transformer": "ToMSATPDirectoryPath"
+                                },
+                                {
+                                    "key": "file.parent_directory_ref",
+                                    "object": "file",
+                                    "references": "file_dir"
+                                }
+                            ],
+                            "IPAddresses": [
+                                {
+                                    "key": "ipv4-addr.value",
+                                    "object": "host_ip4",
+                                    "transformer": "FilterIPv4List",
+                                    "unwrap": true
+                                },
+                                {
+                                    "key": "ipv6-addr.value",
+                                    "object": "host_ip6",
+                                    "transformer": "FilterIPv6List",
+                                    "unwrap": true
+                                },
+                                {
+                                    "group": true,
+                                    "key": "x-oca-asset.ip_refs",
+                                    "object": "host",
+                                    "references": [
+                                        "host_ip4",
+                                        "host_ip6"
+                                    ],
+                                    "unwrap": true
+                                }
+                            ],
+                            "InitiatingProcessAccountName": [
                                 {
                                     "key": "user-account.user_id",
                                     "object": "fc_process_creator"
                                 },
                                 {
                                     "key": "process.creator_user_ref",
                                     "object": "fc_process",
@@ -587,43 +2042,71 @@
                                 },
                                 {
                                     "key": "x-oca-event.user_ref",
                                     "object": "event",
                                     "references": "fc_process_creator"
                                 }
                             ],
+                            "InitiatingProcessAccountUpn": [
+                                {
+                                    "key": "user-account.account_login",
+                                    "object": "fc_process_creator"
+                                },
+                                {
+                                    "key": "process.creator_user_ref",
+                                    "object": "fc_process",
+                                    "references": "fc_process_creator"
+                                }
+                            ],
                             "InitiatingProcessCommandLine": {
                                 "key": "process.command_line",
                                 "object": "fc_process"
                             },
                             "InitiatingProcessCreationTime": {
                                 "key": "process.created",
                                 "object": "fc_process",
                                 "transformer": "MsatpToTimestamp"
                             },
                             "InitiatingProcessFileName": [
                                 {
                                     "key": "file.name",
-                                    "object": "fc_process_file"
+                                    "object": "fc_process_file",
+                                    "transformer": "ToFileName"
                                 },
                                 {
                                     "key": "process.name",
-                                    "object": "fc_process"
+                                    "object": "fc_process",
+                                    "transformer": "ToFileName"
                                 },
                                 {
                                     "key": "process.binary_ref",
                                     "object": "fc_process",
                                     "references": "fc_process_file"
+                                },
+                                {
+                                    "key": "x-oca-event.process_ref",
+                                    "object": "event",
+                                    "references": "fc_process"
+                                },
+                                {
+                                    "key": "directory.path",
+                                    "object": "fc_process_file_dir",
+                                    "transformer": "ToMSATPDirectoryPath"
+                                },
+                                {
+                                    "key": "file.parent_directory_ref",
+                                    "object": "fc_process_file",
+                                    "references": "fc_process_file_dir"
                                 }
                             ],
                             "InitiatingProcessFolderPath": [
                                 {
                                     "key": "directory.path",
                                     "object": "fc_process_file_dir",
-                                    "transformer": "ToDirectoryPath"
+                                    "transformer": "ToMSATPDirectoryPath"
                                 },
                                 {
                                     "key": "file.parent_directory_ref",
                                     "object": "fc_process_file",
                                     "references": "fc_process_file_dir"
                                 },
                                 {
@@ -666,29 +2149,41 @@
                                     "object": "fc_process",
                                     "references": "fc_parent_process"
                                 }
                             ],
                             "InitiatingProcessParentFileName": [
                                 {
                                     "key": "file.name",
-                                    "object": "fc_parent_process_file"
+                                    "object": "fc_parent_process_file",
+                                    "transformer": "ToFileName"
                                 },
                                 {
                                     "key": "process.name",
-                                    "object": "fc_parent_process"
+                                    "object": "fc_parent_process",
+                                    "transformer": "ToFileName"
                                 },
                                 {
                                     "key": "process.parent_ref",
                                     "object": "fc_process",
                                     "references": "fc_parent_process"
                                 },
                                 {
                                     "key": "process.binary_ref",
                                     "object": "fc_parent_process",
                                     "references": "fc_parent_process_file"
+                                },
+                                {
+                                    "key": "directory.path",
+                                    "object": "fc_parent_process_file_dir",
+                                    "transformer": "ToMSATPDirectoryPath"
+                                },
+                                {
+                                    "key": "file.parent_directory_ref",
+                                    "object": "fc_parent_process_file",
+                                    "references": "fc_parent_process_file_dir"
                                 }
                             ],
                             "InitiatingProcessParentId": [
                                 {
                                     "key": "process.pid",
                                     "object": "fc_parent_process",
                                     "transformer": "ToInteger"
@@ -726,22 +2221,73 @@
                                     "references": "fc_process_file"
                                 }
                             ],
                             "MD5": {
                                 "key": "file.hashes.MD5",
                                 "object": "file"
                             },
+                            "MacAddressSet": [
+                                {
+                                    "key": "mac-addr.value",
+                                    "object": "mac",
+                                    "transformer": "FormatMacList",
+                                    "unwrap": true
+                                },
+                                {
+                                    "group": true,
+                                    "key": "x-oca-asset.mac_refs",
+                                    "object": "host",
+                                    "references": [
+                                        "mac"
+                                    ],
+                                    "unwrap": true
+                                }
+                            ],
+                            "OSArchitecture": {
+                                "key": "x-oca-asset.architecture",
+                                "object": "host"
+                            },
+                            "OSPlatform": {
+                                "key": "x-oca-asset.os_name",
+                                "object": "host"
+                            },
+                            "OSVersion": {
+                                "key": "x-oca-asset.os_version",
+                                "object": "host"
+                            },
+                            "PublicIP": [
+                                {
+                                    "key": "ipv4-addr.value",
+                                    "object": "public-ip"
+                                },
+                                {
+                                    "group": true,
+                                    "key": "x-oca-asset.ip_refs",
+                                    "object": "host",
+                                    "references": [
+                                        "public-ip"
+                                    ]
+                                }
+                            ],
+                            "ReportId": {
+                                "key": "x-msatp.ReportId",
+                                "object": "x-msatp"
+                            },
                             "SHA1": {
                                 "key": "file.hashes.SHA-1",
                                 "object": "file"
                             },
                             "SHA256": {
                                 "key": "file.hashes.SHA-256",
                                 "object": "file"
                             },
+                            "TableName": {
+                                "key": "x-msatp.Table",
+                                "object": "x-msatp"
+                            },
                             "Timestamp": [
                                 {
                                     "key": "x-oca-event.created",
                                     "object": "event"
                                 },
                                 {
                                     "cybox": false,
@@ -754,100 +2300,216 @@
                                     "transformer": "MsatpToTimestamp"
                                 }
                             ],
                             "event_count": {
                                 "cybox": false,
                                 "key": "number_observed",
                                 "transformer": "ToInteger"
+                            },
+                            "event_link": [
+                                {
+                                    "key": "external-reference.url",
+                                    "object": "device_external_ref"
+                                },
+                                {
+                                    "key": "x-oca-event.external_ref",
+                                    "object": "event",
+                                    "references": "device_external_ref"
+                                }
+                            ],
+                            "original_ref": [
+                                {
+                                    "key": "artifact.payload_bin",
+                                    "object": "original_ref",
+                                    "transformer": "ToBase64"
+                                },
+                                {
+                                    "key": "x-oca-event.original_ref",
+                                    "object": "event",
+                                    "references": "original_ref"
+                                }
+                            ],
+                            "provider": {
+                                "key": "x-oca-event.provider",
+                                "object": "event",
+                                "value": "Microsoft Defender for Endpoint"
                             }
                         },
                         "DeviceNetworkEvents": {
-                            "DeviceId": {
-                                "key": "x-msatp.machine_id"
+                            "ActionType": {
+                                "key": "x-oca-event.action",
+                                "object": "event"
+                            },
+                            "AdditionalFields": {
+                                "key": "x-msatp.AdditionalFields",
+                                "object": "x-msatp",
+                                "transformer": "JsonToString"
                             },
-                            "DeviceName": {
-                                "key": "x-msatp.computer_name"
+                            "Alerts": {
+                                "key": "x-json-alert.data"
                             },
+                            "DeviceId": [
+                                {
+                                    "key": "x-oca-asset.device_id",
+                                    "object": "host"
+                                },
+                                {
+                                    "key": "x-oca-event.host_ref",
+                                    "object": "event",
+                                    "references": "host"
+                                }
+                            ],
+                            "DeviceName": [
+                                {
+                                    "key": "x-oca-asset.hostname",
+                                    "object": "host"
+                                },
+                                {
+                                    "key": "x-oca-event.host_ref",
+                                    "object": "event",
+                                    "references": "host"
+                                }
+                            ],
+                            "IPAddresses": [
+                                {
+                                    "key": "ipv4-addr.value",
+                                    "object": "host_ip4",
+                                    "transformer": "FilterIPv4List",
+                                    "unwrap": true
+                                },
+                                {
+                                    "key": "ipv6-addr.value",
+                                    "object": "host_ip6",
+                                    "transformer": "FilterIPv6List",
+                                    "unwrap": true
+                                },
+                                {
+                                    "group": true,
+                                    "key": "x-oca-asset.ip_refs",
+                                    "object": "host",
+                                    "references": [
+                                        "host_ip4",
+                                        "host_ip6"
+                                    ],
+                                    "unwrap": true
+                                }
+                            ],
                             "InitiatingProcessAccountName": [
                                 {
-                                    "key": "user-account.account_login",
+                                    "key": "user-account.user_id",
                                     "object": "nc_process_creator"
                                 },
                                 {
                                     "key": "process.creator_user_ref",
                                     "object": "nc_process",
                                     "references": "nc_process_creator"
                                 }
                             ],
-                            "InitiatingProcessAccountSid": [
+                            "InitiatingProcessAccountUpn": [
                                 {
-                                    "key": "user-account.user_id",
+                                    "key": "user-account.account_login",
                                     "object": "nc_process_creator"
                                 },
                                 {
                                     "key": "process.creator_user_ref",
                                     "object": "nc_process",
                                     "references": "nc_process_creator"
                                 }
                             ],
-                            "InitiatingProcessCommandLine": {
-                                "key": "process.command_line",
-                                "object": "nc_process"
-                            },
+                            "InitiatingProcessCommandLine": [
+                                {
+                                    "key": "process.command_line",
+                                    "object": "nc_process"
+                                },
+                                {
+                                    "key": "x-oca-event.process_ref",
+                                    "object": "event",
+                                    "references": "nc_process"
+                                }
+                            ],
                             "InitiatingProcessCreationTime": {
                                 "key": "process.created",
                                 "object": "nc_process",
                                 "transformer": "MsatpToTimestamp"
                             },
                             "InitiatingProcessFileName": [
                                 {
                                     "key": "file.name",
-                                    "object": "nc_process_file"
+                                    "object": "nc_process_file",
+                                    "transformer": "ToFileName"
                                 },
                                 {
                                     "key": "process.name",
-                                    "object": "nc_process"
+                                    "object": "nc_process",
+                                    "transformer": "ToFileName"
                                 },
                                 {
                                     "key": "process.binary_ref",
                                     "object": "nc_process",
                                     "references": "nc_process_file"
+                                },
+                                {
+                                    "key": "x-oca-event.process_ref",
+                                    "object": "event",
+                                    "references": "nc_process"
+                                },
+                                {
+                                    "key": "directory.path",
+                                    "object": "nc_process_file_dir",
+                                    "transformer": "ToMSATPDirectoryPath"
+                                },
+                                {
+                                    "key": "file.parent_directory_ref",
+                                    "object": "nc_process_file",
+                                    "references": "nc_process_file_dir"
                                 }
                             ],
                             "InitiatingProcessFolderPath": [
                                 {
                                     "key": "directory.path",
                                     "object": "nc_process_file_dir",
-                                    "transformer": "ToDirectoryPath"
+                                    "transformer": "ToMSATPDirectoryPath"
                                 },
                                 {
                                     "key": "file.parent_directory_ref",
                                     "object": "nc_process_file",
                                     "references": "nc_process_file_dir"
                                 },
                                 {
                                     "key": "process.binary_ref",
                                     "object": "nc_process",
                                     "references": "nc_process_file"
                                 }
                             ],
-                            "InitiatingProcessId": {
-                                "key": "process.pid",
-                                "object": "nc_process",
-                                "transformer": "ToInteger"
-                            },
+                            "InitiatingProcessId": [
+                                {
+                                    "key": "process.pid",
+                                    "object": "nc_process",
+                                    "transformer": "ToInteger"
+                                },
+                                {
+                                    "key": "x-oca-event.process_ref",
+                                    "object": "event",
+                                    "references": "nc_process"
+                                }
+                            ],
                             "InitiatingProcessMD5": [
                                 {
                                     "key": "file.hashes.MD5",
                                     "object": "nc_process_file"
                                 },
                                 {
                                     "key": "process.binary_ref",
                                     "object": "nc_process",
                                     "references": "nc_process_file"
+                                },
+                                {
+                                    "key": "x-oca-event.process_ref",
+                                    "object": "event",
+                                    "references": "nc_process"
                                 }
                             ],
                             "InitiatingProcessParentCreationTime": [
                                 {
                                     "key": "process.created",
                                     "object": "nc_parent_process",
                                     "transformer": "MsatpToTimestamp"
@@ -857,29 +2519,41 @@
                                     "object": "nc_process",
                                     "references": "nc_parent_process"
                                 }
                             ],
                             "InitiatingProcessParentFileName": [
                                 {
                                     "key": "file.name",
-                                    "object": "nc_parent_process_file"
+                                    "object": "nc_parent_process_file",
+                                    "transformer": "ToFileName"
                                 },
                                 {
                                     "key": "process.name",
-                                    "object": "nc_parent_process"
+                                    "object": "nc_parent_process",
+                                    "transformer": "ToFileName"
                                 },
                                 {
                                     "key": "process.parent_ref",
                                     "object": "nc_process",
                                     "references": "nc_parent_process"
                                 },
                                 {
                                     "key": "process.binary_ref",
                                     "object": "nc_parent_process",
                                     "references": "nc_parent_process_file"
+                                },
+                                {
+                                    "key": "directory.path",
+                                    "object": "nc_parent_process_file_dir",
+                                    "transformer": "ToMSATPDirectoryPath"
+                                },
+                                {
+                                    "key": "file.parent_directory_ref",
+                                    "object": "nc_parent_process_file",
+                                    "references": "nc_parent_process_file_dir"
                                 }
                             ],
                             "InitiatingProcessParentId": [
                                 {
                                     "key": "process.pid",
                                     "object": "nc_parent_process",
                                     "transformer": "ToInteger"
@@ -895,25 +2569,35 @@
                                     "key": "file.hashes.SHA-1",
                                     "object": "nc_process_file"
                                 },
                                 {
                                     "key": "process.binary_ref",
                                     "object": "nc_process",
                                     "references": "nc_process_file"
+                                },
+                                {
+                                    "key": "x-oca-event.process_ref",
+                                    "object": "event",
+                                    "references": "nc_process"
                                 }
                             ],
                             "InitiatingProcessSHA256": [
                                 {
                                     "key": "file.hashes.SHA-256",
                                     "object": "nc_process_file"
                                 },
                                 {
                                     "key": "process.binary_ref",
                                     "object": "nc_process",
                                     "references": "nc_process_file"
+                                },
+                                {
+                                    "key": "x-oca-event.process_ref",
+                                    "object": "event",
+                                    "references": "nc_process"
                                 }
                             ],
                             "LocalIP": [
                                 {
                                     "key": "ipv4-addr.value",
                                     "object": "src_ip"
                                 },
@@ -921,21 +2605,39 @@
                                     "key": "ipv6-addr.value",
                                     "object": "src_ip"
                                 },
                                 {
                                     "key": "network-traffic.src_ref",
                                     "object": "nt",
                                     "references": "src_ip"
+                                },
+                                {
+                                    "group": true,
+                                    "key": "x-oca-asset.ip_refs",
+                                    "object": "host",
+                                    "references": [
+                                        "src_ip"
+                                    ]
+                                },
+                                {
+                                    "key": "x-oca-event.network_ref",
+                                    "object": "event",
+                                    "references": "nt"
                                 }
                             ],
                             "LocalPort": [
                                 {
                                     "key": "network-traffic.src_port",
                                     "object": "nt",
                                     "transformer": "ToInteger"
+                                },
+                                {
+                                    "key": "x-oca-event.network_ref",
+                                    "object": "event",
+                                    "references": "nt"
                                 }
                             ],
                             "MacAddress": [
                                 {
                                     "key": "mac-addr.value",
                                     "object": "mac",
                                     "transformer": "FormatMac"
@@ -954,60 +2656,172 @@
                                 },
                                 {
                                     "key": "x-oca-event.network_ref",
                                     "object": "event",
                                     "references": "nt"
                                 }
                             ],
+                            "MacAddressSet": [
+                                {
+                                    "key": "mac-addr.value",
+                                    "object": "mac",
+                                    "transformer": "FormatMacList",
+                                    "unwrap": true
+                                },
+                                {
+                                    "group": true,
+                                    "key": "x-oca-asset.mac_refs",
+                                    "object": "host",
+                                    "references": [
+                                        "mac"
+                                    ],
+                                    "unwrap": true
+                                }
+                            ],
+                            "OSArchitecture": {
+                                "key": "x-oca-asset.architecture",
+                                "object": "host"
+                            },
+                            "OSPlatform": {
+                                "key": "x-oca-asset.os_name",
+                                "object": "host"
+                            },
+                            "OSVersion": {
+                                "key": "x-oca-asset.os_version",
+                                "object": "host"
+                            },
                             "Protocol": {
                                 "key": "network-traffic.protocols",
                                 "object": "nt",
                                 "transformer": "FormatTCPProtocol"
                             },
+                            "PublicIP": [
+                                {
+                                    "key": "ipv4-addr.value",
+                                    "object": "public-ip"
+                                },
+                                {
+                                    "group": true,
+                                    "key": "x-oca-asset.ip_refs",
+                                    "object": "host",
+                                    "references": [
+                                        "public-ip"
+                                    ]
+                                }
+                            ],
                             "RemoteIP": [
                                 {
                                     "key": "ipv4-addr.value",
                                     "object": "dst_ip"
                                 },
                                 {
                                     "key": "ipv6-addr.value",
                                     "object": "dst_ip"
                                 },
                                 {
                                     "key": "network-traffic.dst_ref",
                                     "object": "nt",
                                     "references": "dst_ip"
+                                },
+                                {
+                                    "key": "x-oca-event.network_ref",
+                                    "object": "event",
+                                    "references": "nt"
                                 }
                             ],
                             "RemotePort": [
                                 {
                                     "key": "network-traffic.dst_port",
                                     "object": "nt",
                                     "transformer": "ToInteger"
+                                },
+                                {
+                                    "key": "x-oca-event.network_ref",
+                                    "object": "event",
+                                    "references": "nt"
+                                }
+                            ],
+                            "RemoteUrl": [
+                                {
+                                    "key": "url.value",
+                                    "object": "url",
+                                    "transformer": "IfValidUrl"
+                                },
+                                {
+                                    "key": "domain-name.value",
+                                    "object": "domain-name",
+                                    "transformer": "GetDomainName"
+                                },
+                                {
+                                    "key": "x-oca-event.domain_ref",
+                                    "object": "event",
+                                    "references": "domain-name"
+                                },
+                                {
+                                    "key": "x-oca-event.url_ref",
+                                    "object": "event",
+                                    "references": "url"
                                 }
                             ],
-                            "RemoteUrl": {
-                                "key": "url.value"
+                            "ReportId": {
+                                "key": "x-msatp.ReportId",
+                                "object": "x-msatp"
+                            },
+                            "TableName": {
+                                "key": "x-msatp.Table",
+                                "object": "x-msatp"
                             },
                             "Timestamp": [
                                 {
+                                    "key": "x-oca-event.created",
+                                    "object": "event"
+                                },
+                                {
                                     "cybox": false,
                                     "key": "first_observed",
                                     "transformer": "MsatpToTimestamp"
                                 },
                                 {
                                     "cybox": false,
                                     "key": "last_observed",
                                     "transformer": "MsatpToTimestamp"
                                 }
                             ],
                             "event_count": {
                                 "cybox": false,
                                 "key": "number_observed",
                                 "transformer": "ToInteger"
+                            },
+                            "event_link": [
+                                {
+                                    "key": "external-reference.url",
+                                    "object": "device_external_ref"
+                                },
+                                {
+                                    "key": "x-oca-event.external_ref",
+                                    "object": "event",
+                                    "references": "device_external_ref"
+                                }
+                            ],
+                            "original_ref": [
+                                {
+                                    "key": "artifact.payload_bin",
+                                    "object": "original_ref",
+                                    "transformer": "ToBase64"
+                                },
+                                {
+                                    "key": "x-oca-event.original_ref",
+                                    "object": "event",
+                                    "references": "original_ref"
+                                }
+                            ],
+                            "provider": {
+                                "key": "x-oca-event.provider",
+                                "object": "event",
+                                "value": "Microsoft Defender for Endpoint"
                             }
                         },
                         "DeviceNetworkInfo": {
                             "IpAddresses": [
                                 {
                                     "key": "ipv4-addr.value",
                                     "object": "host_ip",
@@ -1041,99 +2855,169 @@
                                     "references": "host_mac"
                                 }
                             ]
                         },
                         "DeviceProcessEvents": {
                             "AccountName": [
                                 {
-                                    "key": "user-account.account_login",
+                                    "key": "user-account.user_id",
                                     "object": "child_process_creator"
                                 },
                                 {
                                     "key": "process.creator_user_ref",
                                     "object": "child_process",
                                     "references": "child_process_creator"
+                                },
+                                {
+                                    "key": "x-oca-event.user_ref",
+                                    "object": "event",
+                                    "references": "child_process_creator"
                                 }
                             ],
-                            "AccountSid": [
+                            "AccountUpn": [
                                 {
-                                    "key": "user-account.user_id",
+                                    "key": "user-account.account_login",
                                     "object": "child_process_creator"
                                 },
                                 {
                                     "key": "process.creator_user_ref",
                                     "object": "child_process",
                                     "references": "child_process_creator"
+                                },
+                                {
+                                    "key": "x-oca-event.user_ref",
+                                    "object": "event",
+                                    "references": "child_process_creator"
                                 }
                             ],
                             "ActionType": [
                                 {
                                     "key": "x-oca-event.action",
                                     "object": "event"
                                 }
                             ],
-                            "DeviceId": {
-                                "key": "x-msatp.machine_id"
+                            "AdditionalFields": {
+                                "key": "x-msatp.AdditionalFields",
+                                "object": "x-msatp",
+                                "transformer": "JsonToString"
                             },
-                            "DeviceName": {
-                                "key": "x-msatp.computer_name"
+                            "Alerts": {
+                                "key": "x-json-alert.data"
                             },
+                            "DeviceId": [
+                                {
+                                    "key": "x-oca-asset.device_id",
+                                    "object": "host"
+                                },
+                                {
+                                    "key": "x-oca-event.host_ref",
+                                    "object": "event",
+                                    "references": "host"
+                                }
+                            ],
+                            "DeviceName": [
+                                {
+                                    "key": "x-oca-asset.hostname",
+                                    "object": "host"
+                                },
+                                {
+                                    "key": "x-oca-event.host_ref",
+                                    "object": "event",
+                                    "references": "host"
+                                }
+                            ],
                             "FileName": [
                                 {
                                     "key": "file.name",
-                                    "object": "child_file"
+                                    "object": "child_process_file",
+                                    "transformer": "ToFileName"
                                 },
                                 {
                                     "key": "process.name",
-                                    "object": "child_process"
+                                    "object": "child_process",
+                                    "transformer": "ToFileName"
                                 },
                                 {
                                     "key": "process.binary_ref",
                                     "object": "child_process",
-                                    "references": "child_file"
+                                    "references": "child_process_file"
                                 },
                                 {
                                     "key": "process.child_refs",
                                     "object": "process",
                                     "references": [
                                         "child_process"
                                     ]
                                 },
                                 {
                                     "key": "x-oca-event.process_ref",
                                     "object": "event",
-                                    "references": "process"
+                                    "references": "child_process"
+                                },
+                                {
+                                    "key": "directory.path",
+                                    "object": "child_process_file_dir",
+                                    "transformer": "ToMSATPDirectoryPath"
+                                },
+                                {
+                                    "key": "file.parent_directory_ref",
+                                    "object": "child_process_file",
+                                    "references": "child_process_file_dir"
                                 }
                             ],
                             "FolderPath": [
                                 {
                                     "key": "directory.path",
-                                    "object": "child_file_dir",
-                                    "transformer": "ToDirectoryPath"
+                                    "object": "child_process_file_dir",
+                                    "transformer": "ToMSATPDirectoryPath"
                                 },
                                 {
                                     "key": "file.parent_directory_ref",
-                                    "object": "child_file",
-                                    "references": "child_file_dir"
+                                    "object": "child_process_file",
+                                    "references": "child_process_file_dir"
+                                }
+                            ],
+                            "IPAddresses": [
+                                {
+                                    "key": "ipv4-addr.value",
+                                    "object": "host_ip4",
+                                    "transformer": "FilterIPv4List",
+                                    "unwrap": true
+                                },
+                                {
+                                    "key": "ipv6-addr.value",
+                                    "object": "host_ip6",
+                                    "transformer": "FilterIPv6List",
+                                    "unwrap": true
+                                },
+                                {
+                                    "group": true,
+                                    "key": "x-oca-asset.ip_refs",
+                                    "object": "host",
+                                    "references": [
+                                        "host_ip4",
+                                        "host_ip6"
+                                    ],
+                                    "unwrap": true
                                 }
                             ],
                             "InitiatingProcessAccountName": [
                                 {
-                                    "key": "user-account.account_login",
+                                    "key": "user-account.user_id",
                                     "object": "process_creator"
                                 },
                                 {
                                     "key": "process.creator_user_ref",
                                     "object": "process",
                                     "references": "process_creator"
                                 }
                             ],
-                            "InitiatingProcessAccountSid": [
+                            "InitiatingProcessAccountUpn": [
                                 {
-                                    "key": "user-account.user_id",
+                                    "key": "user-account.account_login",
                                     "object": "process_creator"
                                 },
                                 {
                                     "key": "process.creator_user_ref",
                                     "object": "process",
                                     "references": "process_creator"
                                 }
@@ -1146,48 +3030,72 @@
                                 "key": "process.created",
                                 "object": "process",
                                 "transformer": "MsatpToTimestamp"
                             },
                             "InitiatingProcessFileName": [
                                 {
                                     "key": "file.name",
-                                    "object": "process_file"
+                                    "object": "process_file",
+                                    "transformer": "ToFileName"
                                 },
                                 {
                                     "key": "process.name",
-                                    "object": "process"
+                                    "object": "process",
+                                    "transformer": "ToFileName"
                                 },
                                 {
                                     "key": "process.binary_ref",
                                     "object": "process",
                                     "references": "process_file"
+                                },
+                                {
+                                    "key": "process.parent_ref",
+                                    "object": "child_process",
+                                    "references": "process"
+                                },
+                                {
+                                    "key": "directory.path",
+                                    "object": "process_file_dir",
+                                    "transformer": "ToMSATPDirectoryPath"
+                                },
+                                {
+                                    "key": "file.parent_directory_ref",
+                                    "object": "process_file",
+                                    "references": "process_file_dir"
                                 }
                             ],
                             "InitiatingProcessFolderPath": [
                                 {
                                     "key": "directory.path",
                                     "object": "process_file_dir",
-                                    "transformer": "ToDirectoryPath"
+                                    "transformer": "ToMSATPDirectoryPath"
                                 },
                                 {
                                     "key": "file.parent_directory_ref",
                                     "object": "process_file",
                                     "references": "process_file_dir"
                                 },
                                 {
                                     "key": "process.binary_ref",
                                     "object": "process",
                                     "references": "process_file"
                                 }
                             ],
-                            "InitiatingProcessId": {
-                                "key": "process.pid",
-                                "object": "process",
-                                "transformer": "ToInteger"
-                            },
+                            "InitiatingProcessId": [
+                                {
+                                    "key": "process.pid",
+                                    "object": "process",
+                                    "transformer": "ToInteger"
+                                },
+                                {
+                                    "key": "process.parent_ref",
+                                    "object": "child_process",
+                                    "references": "process"
+                                }
+                            ],
                             "InitiatingProcessMD5": [
                                 {
                                     "key": "file.hashes.MD5",
                                     "object": "process_file"
                                 },
                                 {
                                     "key": "process.binary_ref",
@@ -1206,43 +3114,48 @@
                                     "object": "process",
                                     "references": "parent_process"
                                 }
                             ],
                             "InitiatingProcessParentFileName": [
                                 {
                                     "key": "file.name",
-                                    "object": "parent_process_file"
+                                    "object": "parent_process_file",
+                                    "transformer": "ToFileName"
                                 },
                                 {
                                     "key": "process.name",
-                                    "object": "parent_process"
+                                    "object": "parent_process",
+                                    "transformer": "ToFileName"
                                 },
                                 {
                                     "key": "process.parent_ref",
                                     "object": "process",
                                     "references": "parent_process"
                                 },
                                 {
                                     "key": "process.binary_ref",
                                     "object": "parent_process",
                                     "references": "parent_process_file"
-                                }
-                            ],
-                            "InitiatingProcessParentId": [
+                                },
                                 {
-                                    "key": "process.pid",
-                                    "object": "parent_process",
-                                    "transformer": "ToInteger"
+                                    "key": "directory.path",
+                                    "object": "parent_process_file_dir",
+                                    "transformer": "ToMSATPDirectoryPath"
                                 },
                                 {
-                                    "key": "process.parent_ref",
-                                    "object": "process",
-                                    "references": "parent_process"
+                                    "key": "file.parent_directory_ref",
+                                    "object": "parent_process_file",
+                                    "references": "parent_process_file_dir"
                                 }
                             ],
+                            "InitiatingProcessParentId": {
+                                "key": "process.pid",
+                                "object": "parent_process",
+                                "transformer": "ToInteger"
+                            },
                             "InitiatingProcessSHA1": [
                                 {
                                     "key": "file.hashes.SHA-1",
                                     "object": "process_file"
                                 },
                                 {
                                     "key": "process.binary_ref",
@@ -1259,43 +3172,63 @@
                                     "key": "process.binary_ref",
                                     "object": "process",
                                     "references": "process_file"
                                 }
                             ],
                             "MD5": {
                                 "key": "file.hashes.MD5",
-                                "object": "child_file"
+                                "object": "child_process_file"
                             },
-                            "ProcessCommandLine": [
+                            "MacAddressSet": [
                                 {
-                                    "key": "process.command_line",
-                                    "object": "child_process"
+                                    "key": "mac-addr.value",
+                                    "object": "mac",
+                                    "transformer": "FormatMacList",
+                                    "unwrap": true
                                 },
                                 {
-                                    "key": "process.child_refs",
-                                    "object": "process",
+                                    "group": true,
+                                    "key": "x-oca-asset.mac_refs",
+                                    "object": "host",
                                     "references": [
-                                        "child_process"
-                                    ]
+                                        "mac"
+                                    ],
+                                    "unwrap": true
                                 }
                             ],
-                            "ProcessCreationTime": [
+                            "OSArchitecture": {
+                                "key": "x-oca-asset.architecture",
+                                "object": "host"
+                            },
+                            "OSPlatform": {
+                                "key": "x-oca-asset.os_name",
+                                "object": "host"
+                            },
+                            "OSVersion": {
+                                "key": "x-oca-asset.os_version",
+                                "object": "host"
+                            },
+                            "ProcessCommandLine": [
                                 {
-                                    "key": "process.created",
-                                    "object": "child_process",
-                                    "transformer": "MsatpToTimestamp"
+                                    "key": "process.command_line",
+                                    "object": "child_process"
                                 },
                                 {
                                     "key": "process.child_refs",
                                     "object": "process",
                                     "references": [
                                         "child_process"
                                     ]
                                 }
                             ],
+                            "ProcessCreationTime": {
+                                "key": "process.created",
+                                "object": "child_process",
+                                "transformer": "MsatpToTimestamp"
+                            },
                             "ProcessId": [
                                 {
                                     "key": "process.pid",
                                     "object": "child_process",
                                     "transformer": "ToInteger"
                                 },
                                 {
@@ -1304,24 +3237,46 @@
                                     "references": [
                                         "child_process"
                                     ]
                                 },
                                 {
                                     "key": "x-oca-event.process_ref",
                                     "object": "event",
-                                    "references": "process"
+                                    "references": "child_process"
                                 }
                             ],
+                            "PublicIP": [
+                                {
+                                    "key": "ipv4-addr.value",
+                                    "object": "public-ip"
+                                },
+                                {
+                                    "group": true,
+                                    "key": "x-oca-asset.ip_refs",
+                                    "object": "host",
+                                    "references": [
+                                        "public-ip"
+                                    ]
+                                }
+                            ],
+                            "ReportId": {
+                                "key": "x-msatp.ReportId",
+                                "object": "x-msatp"
+                            },
                             "SHA1": {
                                 "key": "file.hashes.SHA-1",
-                                "object": "child_file"
+                                "object": "child_process_file"
                             },
                             "SHA256": {
                                 "key": "file.hashes.SHA-256",
-                                "object": "child_file"
+                                "object": "child_process_file"
+                            },
+                            "TableName": {
+                                "key": "x-msatp.Table",
+                                "object": "x-msatp"
                             },
                             "Timestamp": [
                                 {
                                     "key": "x-oca-event.created",
                                     "object": "event"
                                 },
                                 {
@@ -1335,52 +3290,119 @@
                                     "transformer": "MsatpToTimestamp"
                                 }
                             ],
                             "event_count": {
                                 "cybox": false,
                                 "key": "number_observed",
                                 "transformer": "ToInteger"
+                            },
+                            "event_link": [
+                                {
+                                    "key": "external-reference.url",
+                                    "object": "device_external_ref"
+                                },
+                                {
+                                    "key": "x-oca-event.external_ref",
+                                    "object": "event",
+                                    "references": "device_external_ref"
+                                }
+                            ],
+                            "original_ref": [
+                                {
+                                    "key": "artifact.payload_bin",
+                                    "object": "original_ref",
+                                    "transformer": "ToBase64"
+                                },
+                                {
+                                    "key": "x-oca-event.original_ref",
+                                    "object": "event",
+                                    "references": "original_ref"
+                                }
+                            ],
+                            "provider": {
+                                "key": "x-oca-event.provider",
+                                "object": "event",
+                                "value": "Microsoft Defender for Endpoint"
                             }
                         },
                         "DeviceRegistryEvents": {
                             "ActionType": [
                                 {
                                     "key": "x-oca-event.action",
                                     "object": "event"
                                 }
                             ],
-                            "DeviceId": {
-                                "key": "x-oca-asset.device_id",
-                                "object": "host"
+                            "AdditionalFields": {
+                                "key": "x-msatp.AdditionalFields",
+                                "object": "x-msatp",
+                                "transformer": "JsonToString"
+                            },
+                            "Alerts": {
+                                "key": "x-json-alert.data"
                             },
+                            "DeviceId": [
+                                {
+                                    "key": "x-oca-asset.device_id",
+                                    "object": "host"
+                                },
+                                {
+                                    "key": "x-oca-event.host_ref",
+                                    "object": "event",
+                                    "references": "host"
+                                }
+                            ],
                             "DeviceName": [
                                 {
                                     "key": "x-oca-asset.hostname",
                                     "object": "host"
                                 },
                                 {
                                     "key": "x-oca-event.host_ref",
                                     "object": "event",
                                     "references": "host"
                                 }
                             ],
+                            "IPAddresses": [
+                                {
+                                    "key": "ipv4-addr.value",
+                                    "object": "host_ip4",
+                                    "transformer": "FilterIPv4List",
+                                    "unwrap": true
+                                },
+                                {
+                                    "key": "ipv6-addr.value",
+                                    "object": "host_ip6",
+                                    "transformer": "FilterIPv6List",
+                                    "unwrap": true
+                                },
+                                {
+                                    "group": true,
+                                    "key": "x-oca-asset.ip_refs",
+                                    "object": "host",
+                                    "references": [
+                                        "host_ip4",
+                                        "host_ip6"
+                                    ],
+                                    "unwrap": true
+                                }
+                            ],
                             "InitiatingProcessAccountName": [
                                 {
-                                    "key": "user-account.account_login",
+                                    "key": "user-account.user_id",
                                     "object": "re_process_creator"
                                 },
                                 {
                                     "key": "process.creator_user_ref",
                                     "object": "re_process",
                                     "references": "re_process_creator"
                                 }
                             ],
-                            "InitiatingProcessAccountSid": [
+                            "InitiatingProcessAccountUpn": [
                                 {
-                                    "key": "user-account.user_id",
+                                    "key": "user-account.account_login",
                                     "object": "re_process_creator"
                                 },
                                 {
                                     "key": "process.creator_user_ref",
                                     "object": "re_process",
                                     "references": "re_process_creator"
                                 }
@@ -1393,24 +3415,41 @@
                                 "key": "process.created",
                                 "object": "re_process",
                                 "transformer": "MsatpToTimestamp"
                             },
                             "InitiatingProcessFileName": [
                                 {
                                     "key": "file.name",
-                                    "object": "re_process_file"
+                                    "object": "re_process_file",
+                                    "transformer": "ToFileName"
                                 },
                                 {
                                     "key": "process.name",
-                                    "object": "re_process"
+                                    "object": "re_process",
+                                    "transformer": "ToFileName"
                                 },
                                 {
                                     "key": "process.binary_ref",
                                     "object": "re_process",
                                     "references": "re_process_file"
+                                },
+                                {
+                                    "key": "x-oca-event.process_ref",
+                                    "object": "event",
+                                    "references": "re_process"
+                                },
+                                {
+                                    "key": "directory.path",
+                                    "object": "re_process_file_dir",
+                                    "transformer": "ToDirectoryPath"
+                                },
+                                {
+                                    "key": "file.parent_directory_ref",
+                                    "object": "re_process_file",
+                                    "references": "re_process_file_dir"
                                 }
                             ],
                             "InitiatingProcessFolderPath": [
                                 {
                                     "key": "directory.path",
                                     "object": "re_process_file_dir",
                                     "transformer": "ToDirectoryPath"
@@ -1460,46 +3499,53 @@
                                     "object": "re_process",
                                     "references": "re_parent_process"
                                 }
                             ],
                             "InitiatingProcessParentFileName": [
                                 {
                                     "key": "file.name",
-                                    "object": "re_parent_process_file"
+                                    "object": "re_parent_process_file",
+                                    "transformer": "ToFileName"
                                 },
                                 {
                                     "key": "process.name",
-                                    "object": "re_parent_process"
+                                    "object": "re_parent_process",
+                                    "transformer": "ToFileName"
                                 },
                                 {
                                     "key": "process.parent_ref",
                                     "object": "re_process",
                                     "references": "re_parent_process"
                                 },
                                 {
                                     "key": "process.binary_ref",
                                     "object": "re_parent_process",
                                     "references": "re_parent_process_file"
+                                },
+                                {
+                                    "key": "directory.path",
+                                    "object": "re_parent_process_file_dir",
+                                    "transformer": "ToDirectoryPath"
+                                },
+                                {
+                                    "key": "file.parent_directory_ref",
+                                    "object": "re_parent_process_file",
+                                    "references": "re_parent_process_file_dir"
                                 }
                             ],
                             "InitiatingProcessParentId": [
                                 {
                                     "key": "process.pid",
                                     "object": "re_parent_process",
                                     "transformer": "ToInteger"
                                 },
                                 {
                                     "key": "process.parent_ref",
                                     "object": "re_process",
                                     "references": "re_parent_process"
-                                },
-                                {
-                                    "key": "x-oca-event.parent_process_ref",
-                                    "object": "event",
-                                    "references": "re_parent_process"
                                 }
                             ],
                             "InitiatingProcessSHA1": [
                                 {
                                     "key": "file.hashes.SHA-1",
                                     "object": "re_process_file"
                                 },
@@ -1516,23 +3562,81 @@
                                 },
                                 {
                                     "key": "process.binary_ref",
                                     "object": "re_process",
                                     "references": "re_process_file"
                                 }
                             ],
-                            "RegistryKey": {
-                                "key": "windows-registry-key.key",
-                                "object": "re_key"
+                            "MacAddressSet": [
+                                {
+                                    "key": "mac-addr.value",
+                                    "object": "mac",
+                                    "transformer": "FormatMacList",
+                                    "unwrap": true
+                                },
+                                {
+                                    "group": true,
+                                    "key": "x-oca-asset.mac_refs",
+                                    "object": "host",
+                                    "references": [
+                                        "mac"
+                                    ],
+                                    "unwrap": true
+                                }
+                            ],
+                            "OSArchitecture": {
+                                "key": "x-oca-asset.architecture",
+                                "object": "host"
+                            },
+                            "OSPlatform": {
+                                "key": "x-oca-asset.os_name",
+                                "object": "host"
+                            },
+                            "OSVersion": {
+                                "key": "x-oca-asset.os_version",
+                                "object": "host"
                             },
+                            "PublicIP": [
+                                {
+                                    "key": "ipv4-addr.value",
+                                    "object": "public-ip"
+                                },
+                                {
+                                    "group": true,
+                                    "key": "x-oca-asset.ip_refs",
+                                    "object": "host",
+                                    "references": [
+                                        "public-ip"
+                                    ]
+                                }
+                            ],
+                            "RegistryKey": [
+                                {
+                                    "key": "windows-registry-key.key",
+                                    "object": "re_key"
+                                },
+                                {
+                                    "key": "x-oca-event.registry_ref",
+                                    "object": "event",
+                                    "references": "re_key"
+                                }
+                            ],
                             "RegistryValues": {
                                 "key": "windows-registry-key.values",
                                 "object": "re_key",
                                 "transformer": "MsatpToRegistryValue"
                             },
+                            "ReportId": {
+                                "key": "x-msatp.ReportId",
+                                "object": "x-msatp"
+                            },
+                            "TableName": {
+                                "key": "x-msatp.Table",
+                                "object": "x-msatp"
+                            },
                             "Timestamp": [
                                 {
                                     "key": "x-oca-event.created",
                                     "object": "event"
                                 },
                                 {
                                     "cybox": false,
@@ -1545,14 +3649,42 @@
                                     "transformer": "MsatpToTimestamp"
                                 }
                             ],
                             "event_count": {
                                 "cybox": false,
                                 "key": "number_observed",
                                 "transformer": "ToInteger"
+                            },
+                            "event_link": [
+                                {
+                                    "key": "external-reference.url",
+                                    "object": "device_external_ref"
+                                },
+                                {
+                                    "key": "x-oca-event.external_ref",
+                                    "object": "event",
+                                    "references": "device_external_ref"
+                                }
+                            ],
+                            "original_ref": [
+                                {
+                                    "key": "artifact.payload_bin",
+                                    "object": "original_ref",
+                                    "transformer": "ToBase64"
+                                },
+                                {
+                                    "key": "x-oca-event.original_ref",
+                                    "object": "event",
+                                    "references": "original_ref"
+                                }
+                            ],
+                            "provider": {
+                                "key": "x-oca-event.provider",
+                                "object": "event",
+                                "value": "Microsoft Defender for Endpoint"
                             }
                         }
                     }
                 },
                 "optional": true,
                 "previous": "connection.mapping",
                 "type": "json"
@@ -1560,14 +3692,18 @@
             "result_limit": {
                 "default": 10000,
                 "max": 500000,
                 "min": 1,
                 "previous": "connection.resultSizeLimit",
                 "type": "number"
             },
+            "retainOriginal": {
+                "default": false,
+                "type": "boolean"
+            },
             "stix_2.1": {
                 "default": false,
                 "hidden": true,
                 "optional": true,
                 "type": "boolean"
             },
             "stix_validator": {
```

## stix_shifter_modules/msatp/configuration/lang_en.json

### Pretty-printed

 * *Similarity: 0.9760044642857143%*

 * *Differences: {"'configuration'": "{'auth': {'clientId': {'label': 'Client ID'}, 'clientSecret': {'label': "*

 * *                    "'Client secret'}}}",*

 * * "'connection'": "{'port': {'label': 'Host port'}, 'selfSignedCert': {'label': 'Microsoft Defender "*

 * *                 "for Endpoint certificate'}, 'options': {'result_limit': {'label': 'Result size "*

 * *                 "limit'}, 'time_range': {'label': 'Query time range'}, 'timeout': {'label': "*

 * *                 "'Query response timeout limit'}, 'validate_pattern': {'label': [â€¦]*

```diff
@@ -1,17 +1,17 @@
 {
     "configuration": {
         "auth": {
             "clientId": {
                 "description": "Client ID of Azure Active directory Application with access to the Microsoft Graph API",
-                "label": "Client Id"
+                "label": "Client ID"
             },
             "clientSecret": {
                 "description": "Client Secret of Azure Active directory Application with access to the Microsoft Graph API",
-                "label": "Client Secret"
+                "label": "Client secret"
             },
             "tenant": {
                 "description": "Tenant ID of Azure Active directory Application with access to the Microsoft Graph API",
                 "label": "Tenant"
             },
             "type": "fields"
         }
@@ -25,52 +25,68 @@
             "description": "Specify the IP address or hostname of the data source",
             "label": "Management IP address or hostname",
             "placeholder": "192.168.1.10"
         },
         "options": {
             "concurrent": {
                 "description": "The number of simultaneous connections that can be made to the data source.  Valid input range is {{min}} to {{max}}.",
-                "label": "Concurrent Search Limit"
+                "label": "Concurrent search limit"
             },
             "dialects": {
                 "description": "The dialect to use if the data source needs to search multiple schema or database tables.",
                 "label": "Dialect"
             },
+            "includeAlerts": {
+                "description": "With this feature enabled every event will be searched for correlated alerts in the DeviceAlertsEvent table and the alert data will be included in the results. Keep in mind that this feature will add API CPU consumption.",
+                "label": "Join events with alerts?"
+            },
+            "includeHostOs": {
+                "description": "With this feature enabled every event will include also the device OS details from the DeviceInfo table. Keep in mind that this feature will add API CPU consumption.",
+                "label": "Join events with host os info?"
+            },
+            "includeNetworkInfo": {
+                "description": "With this feature enabled every event will include also the active network adapters IP and MAC addresses of the device at the time of the event from the DeviceNetworkInfo table. Keep in mind that this feature will add API CPU consumption.",
+                "label": "Join events with device network info?"
+            },
             "mapping": {
                 "description": "Custom stix mapping if default mapping needs to be replaced",
-                "label": "Custom Mapping"
+                "label": "Custom mapping"
             },
             "result_limit": {
                 "description": "The maximum number of entries or objects that are returned by search query.  Valid input range is {{min}} to {{max}}.",
-                "label": "Result Size Limit"
+                "label": "Result size limit"
+            },
+            "retainOriginal": {
+                "description": "Setting this to true will encode the original json results from the EDR before they are translated to STIX and put them in an artifact object referenced as original_ref from x-oca-event. This is helpful if critical data is missing in the final translation.",
+                "label": "Keep the original json payload as original_ref?"
             },
             "stix_validator": {
                 "description": "Validate translated STIX Objects",
-                "label": "STIX Object Validator"
+                "label": "STIX object validator"
             },
             "time_range": {
                 "description": "Time range for the search, in minutes, represented as last x minutes.  Valid input range is {{min}} to {{max}}.",
-                "label": "Query Time Range"
+                "label": "Query time range"
             },
             "timeout": {
                 "description": "The limit on how long to wait for the data source response, in seconds. Valid input range is {{min}} to {{max}}.",
-                "label": "Query Response Timeout Limit"
+                "label": "Query response timeout limit"
             },
             "validate_pattern": {
                 "description": "Validate STIX patterns that needs to be translated into native data source query",
-                "label": "STIX Pattern Validator"
+                "label": "STIX pattern validator"
             }
         },
         "port": {
             "description": "Set the port number that is associated with the hostname or IP address",
-            "label": "Host Port"
+            "label": "Host port"
         },
         "selfSignedCert": {
             "description": "Use self-signed Security Sockets Layer (SSL) certificate only if Microsoft Defender for Endpoint is configured with a self-signed SSL certificate",
-            "label": "Microsoft Defender for Endpoint Certificate"
+            "label": "Microsoft Defender for Endpoint certificate"
         },
         "sni": {
             "description": "The Server Name Indicator (SNI) enables a separate hostname to be provided for SSL authentication",
             "label": "Server Name Indicator"
         },
         "type": {
             "description": "Data source type"
```

## stix_shifter_modules/msatp/stix_translation/json_to_stix_translator.py

```diff
@@ -15,41 +15,49 @@
 NUMBER_OBSERVED_KEY = 'number_observed'
 FIRST_OBSERVED_KEY = 'first_observed'
 LAST_OBSERVED_KEY = 'last_observed'
 
 
 # convert JSON data to STIX object using map_data and transformers
 def convert_to_stix(data_source, map_data, data, transformers, options, callback=None):
+    try:
+        ds2stix = DataSourceObjToStixObj(data_source, map_data, transformers, options, callback)
 
-    ds2stix = DataSourceObjToStixObj(data_source, map_data, transformers, options, callback)
-
-    # map data list to list of transformed objects
-    observation = ds2stix.transform
-    results = list(map(observation, data))
-
-    for stix_object in results:
-        if ds2stix.spec_version == "2.1":
-            del stix_object["objects"]
-        ds2stix.bundle["objects"].append(stix_object)
-
-    for _, value in ds2stix.unique_cybox_objects.items():
-        ds2stix.bundle["objects"].append(value)
-
-    if options.get('stix_validator'):
-        if ds2stix.spec_version == "2.1":
-            # Serialize and Deserialize bundle to covert StixObjectIds to strings
-            bundle_obj = json.dumps(ds2stix.bundle, sort_keys=False)
-            bundle_obj = json.loads(bundle_obj)
-        else:
-            bundle_obj = ds2stix.bundle
-        validated_result = validate_instance(bundle_obj, ValidationOptions(version=ds2stix.spec_version))
-        print_results(validated_result)
+        # map data list to list of transformed objects
+        observation = ds2stix.transform
+        results = list(map(observation, data))
+
+        for stix_object in results:
+            if ds2stix.spec_version == "2.1":
+                del stix_object["objects"]
+            ds2stix.bundle["objects"].append(stix_object)
+
+        for _, value in ds2stix.unique_cybox_objects.items():
+            ds2stix.bundle["objects"].append(value)
+
+        if options.get('stix_validator'):
+            if ds2stix.spec_version == "2.1":
+                # Serialize and Deserialize bundle to covert StixObjectIds to strings
+                bundle_obj = json.dumps(ds2stix.bundle, sort_keys=False)
+                bundle_obj = json.loads(bundle_obj)
+            else:
+                bundle_obj = ds2stix.bundle
+            validated_result = validate_instance(bundle_obj, ValidationOptions(version=ds2stix.spec_version))
+            print_results(validated_result)
 
-    return ds2stix.bundle
+        return ds2stix.bundle
 
+    except Exception as e:
+        try:
+            # try to print the error line
+            logger_log = logger.set_logger(__name__)
+            logger_log.error(logger.last_tb_to_string(e))
+        except:
+            pass
+        raise e
 
 class DataSourceObjToStixObj:
     logger = logger.set_logger(__name__)
 
     def __init__(self, data_source, ds_to_stix_map, transformers, options, callback=None):
         self.identity_id = data_source["id"]
         self.ds_to_stix_map = ds_to_stix_map
@@ -196,31 +204,38 @@
         
         return tag_ind
 
     def _add_property(self, type_name, property_key, parent_key_ind, value, objects, group=False, cybox=True):
         """
         Add observable object property and its STIX valid value to the cached `objects` dictionary
         """
+        named_group =  isinstance(group, str) and group.lower() != "true"
         parent_key_ind_str = str(parent_key_ind)
         if not parent_key_ind_str in objects:
             if cybox:
+                # Grouped properties go in a list
+                if named_group:
+                    value = [value]
                 objects[parent_key_ind_str] = {
                     'type': type_name,
                     property_key: value
                 }
                 if self.spec_version == "2.1":
                     objects[parent_key_ind_str]["id"] = parent_key_ind
                     objects[parent_key_ind_str]["spec_version"] = "2.1"
             else:
                 objects[parent_key_ind_str] = {
                 property_key: value
             }
         else:
             if not property_key in objects[parent_key_ind_str]:
                 objects[parent_key_ind_str][property_key] = value
+            # Add grouped value in existing list element
+            elif isinstance(value, dict) and named_group and isinstance(objects[parent_key_ind_str][property_key], list):
+                objects[parent_key_ind_str][property_key][0] = dict_merge(objects[parent_key_ind_str][property_key][0], value)
             elif isinstance(value, dict):
                 objects[parent_key_ind_str][property_key] = dict_merge(objects[parent_key_ind_str][property_key], value)
             elif isinstance(objects[parent_key_ind_str][property_key], list) and group:
                 objects[parent_key_ind_str][property_key].extend(value)
 
             
     def _handle_properties(self, to_stix_config_prop, data, objects, object_tag_ref_map, parent_data=None, ds_sub_key=None, object_key_ind=None):
@@ -300,16 +315,18 @@
                 if len(config_keys) < 2:
                     if False is prop.get('cybox', self.cybox_default): 
                         object_tag_ref_map['out_cybox'][key] = self._compose_value_object(data, [], observable_key=key, object_tag_ref_map=object_tag_ref_map, transformer=transformer, references=references, unwrap=unwrap)
                     pass
                 else:
                     type_name = config_keys[0]
                     property_key = config_keys[1]
+                    # set the object to combine properties from same SCO
                     parent_key = prop['object'] if 'object' in prop else type_name
 
+                    # set the group to combine properties in a list
                     group = prop['group'] if 'group' in prop else False
                     substitute_key = prop['ds_key'] if 'ds_key' in prop else None
 
                     if False is cybox and not substitute_key:
                         value = self._compose_value_object(data, config_keys[2:], observable_key=key, object_tag_ref_map=object_tag_ref_map, transformer=transformer, references=references, unwrap=unwrap)
                         self._add_property(type_name, property_key, type_name, value, object_tag_ref_map['out_cybox'], cybox=False)
                         continue
```

## stix_shifter_modules/msatp/stix_translation/query_constructor.py

```diff
@@ -12,79 +12,81 @@
 FLOOR_TIME = '| extend FormattedTimeKey = bin(Timestamp, 1m)'
 
 
 class QueryStringPatternTranslator:
     """
     Stix to kusto query translation
     """
-    # Join query to get MAC address value from DeviceNetworkInfo
-    join_query = ' | join kind= inner (DeviceNetworkInfo {qualifier_string}{floor_time}| mvexpand parse_json(' \
-                 'IPAddresses) | extend IP = IPAddresses.IPAddress | project Timestamp ,DeviceId , MacAddress, IP, ' \
-                 'FormattedTimeKey) on DeviceId, $left.FormattedTimeKey ' \
-                 '== $right.FormattedTimeKey | where LocalIP == IP | where {mac_query} | order by Timestamp desc'
 
     def __init__(self, pattern: Pattern, data_model_mapper, time_range):
         self.dmm = data_model_mapper
         self.comparator_lookup = self.dmm.map_comparator()
         self._time_range = time_range
         self.qualified_queries = []
         self.qualifier_string = ''
         self.lookup_table_object = None
         self._is_mac = None
         self.parse_expression(pattern)
 
     @staticmethod
+    def _escape_value(value):
+        if isinstance(value, str):
+            return value.replace("\\", "\\\\")
+        return value
+
+    @staticmethod
     def _format_equality(value, comparator) -> str:
         """
         Formatting value in the event of equality operation
         :param value: str
         :return: str
         """
         if isinstance(value, str):
             if comparator == '==':
                 comparator = '=~'
             elif comparator == '!=':
                 comparator = '!~'
-        return '"{}"'.format(value), comparator
+        return '"{}"'.format(QueryStringPatternTranslator._escape_value(value)), comparator
 
     @staticmethod
     def _format_set(value) -> str:
         """
         Formatting list of values in the event of IN operation
         :param values: str
         :return: list
         """
         final_value = []
         for val in value.values:
-            final_value.append('"{}"'.format(val))
+            final_value.append('"{}"'.format(QueryStringPatternTranslator._escape_value(val)))
         return '{}'.format(str(final_value).replace('[', '(').replace(']', ')').replace("'", ""))
 
     @staticmethod
     def _format_like(value, comparator) -> str:
         """
         Formatting value in the event of LIKE operation
         :param value: str
         :return: str
         """
         # Replacing value with % to .* and _ to . for supporting Like comparator
+        value = QueryStringPatternTranslator._escape_value(value)
         compile_regex = re.compile(r'.*(\%|\_).*')
         if compile_regex.match(value):
             if comparator == 'contains':
                 comparator = 'matches'
             return 'regex"({}$)"'.format(value.replace('%', '.*').replace('_', '.')), comparator
         return '"{}"'.format(value), comparator
 
     @staticmethod
     def _format_matches(value) -> str:
         """
         Formatting value in the event of MATCHES operation
         :param value: str
         :return: str
         """
-        return 'regex"({})"'.format(value)
+        return 'regex"({})"'.format(QueryStringPatternTranslator._escape_value(value))
 
     @staticmethod
     def _format_datetime(value, expression) -> str:
         """
         Formating value in the event of value is datetime
         :param value:
         :return:
@@ -173,14 +175,18 @@
             if mapped_field in DS_INT_FIELDS:
                 is_int_field = True
             # changing mapped field to 'tostring(mapped_field)' for datetime values
             if expression.comparator in [ComparisonComparators.Like, ComparisonComparators.Matches,
                                          ComparisonComparators.Equal, ComparisonComparators.NotEqual]:
                 if is_int_field or is_date_field:
                     mapped_field = 'tostring({mapped_field})'.format(mapped_field=mapped_field)
+                elif expression.object_path == "domain-name:value":
+                    # since msatp has one field RemoteUrl that sometimes contains urls and sometime only domain names
+                    # in order to find a domain name we need to replace the normal equality comparator to contains
+                    comparator = 'contains'
             elif expression.comparator in [ComparisonComparators.GreaterThan, ComparisonComparators.GreaterThanOrEqual,
                                            ComparisonComparators.LessThan,
                                            ComparisonComparators.LessThanOrEqual]:
                 if not is_int_field and not is_date_field:
                     raise NotImplementedError(
                         "Comparison operator {} unsupported for MSATP attribute {}".format(comparator, mapped_field))
```

## stix_shifter_modules/msatp/stix_translation/results_translator.py

```diff
@@ -1,4 +1,239 @@
+import json
+import re
+
+from stix_shifter_modules.msatp.stix_translation.transformers import SeverityToNumericVal
 from stix_shifter_utils.stix_translation.src.json_to_stix.json_to_stix import JSONToStix
 
+TACTICS = [
+    "Reconnaissance",
+    "Resource Development",
+    "Initial Access",
+    "Execution",
+    "Persistence",
+    "Privilege Escalation",
+    "Defense Evasion",
+    "Credential Access",
+    "Discovery",
+    "Lateral Movement",
+    "Collection",
+    "Command and Control",
+    "Exfiltration",
+    "Impact"
+]
+
+
+def parse_camel_case(name):
+    return "".join([" " + char if char.isupper() and i > 0 else char for i, char in enumerate(name)])
+
+
+def get_objects_by_type(objects, type_name):
+    """receives a stix objects dictionary and returns indexes of all objets of the given type"""
+    return [key for (key, obj) in objects.items() if obj["type"] == type_name]
+
+
+def get_first_object_by_type(objects, type_name):
+    """receives a stix objects dictionary and returns the first index and value of the object of the given type"""
+    for k, v in objects.items():
+        if v.get("type") == type_name:
+            return k, v
+    return None, None
+
+
+def delete_object(objects, remove_ref):
+    """removes an object with all its references from objects"""
+    index_to_remove = int(remove_ref)
+    objects.pop(remove_ref)
+    renames = []
+    for ref, sco in objects.items():
+        if int(ref) > index_to_remove:
+            renames.append(ref)
+        remove = []
+        for key, value in sco.items():
+            if key.endswith("_ref"):
+                if int(value) == index_to_remove:
+                    remove.append(key)
+                elif int(value) > index_to_remove:
+                    sco[key] = str(int(value) - 1)
+            elif key.endswith("_refs"):
+                sco[key] = [str(int(item) - 1) if int(item) > index_to_remove else item for item in value if
+                            int(item) != index_to_remove]
+                if len(sco[key]) == 0:
+                    remove.append(key)
+        for i in remove:
+            sco.pop(i)
+    for ref in renames:
+        objects[str(int(ref) - 1)] = objects.pop(ref)
+
+
+def get_next_index(objects):
+    """returns the next available index in the objects dictionary"""
+    i = 0
+    while str(i) in objects:
+        i += 1
+    next_ref = str(i)
+    for ref, sco in objects.items():
+        remove = []
+        for key, value in sco.items():
+            if key.endswith("_ref"):
+                if value == next_ref:
+                    remove.append(key)
+            elif key.endswith("_refs"):
+                for r in value:
+                    if r == next_ref:
+                        sco[key] = [item for item in value if item != next_ref]
+                        if len(sco[key]) == 0:
+                            remove.append(key)
+        for i in remove:
+            sco.pop(i)
+    return next_ref
+
+
+def add_to_objects(observed, obj_to_add):
+    objects = observed['objects']
+    index = get_next_index(objects)
+    objects[index] = obj_to_add
+    if int(index) < len(objects) - 1:
+        observed['objects'] = sort_objects(objects)
+    return index
+
+
+def parse_technique(technique):
+    match = re.match(r'^(.+) \((T.+)\)$', technique)
+    return {
+        "technique_name": match.group(1),
+        "technique_id": match.group(2)
+    }
+
+
+def create_ttp_from_category(category):
+    phase_name = parse_camel_case(category)
+    kill_chain = "microsoft"
+    if phase_name in TACTICS:
+        kill_chain = "mitre-attack"
+    return {
+        'type': 'x-ibm-ttp-tagging',
+        'kill_chain_phases': [
+            {
+                "phase_name": phase_name,
+                "kill_chain_name": kill_chain
+            }
+        ]
+    }
+
+
+def create_ttps_from_technique(technique):
+    t = parse_technique(technique)
+    return {
+        'type': 'x-ibm-ttp-tagging',
+        'extensions': {
+            'mitre-attack-ext': t
+        }
+    }
+
+
+def fix_alerts(observed):
+    objects = observed["objects"]
+    json_alert_ref, json_alert = get_first_object_by_type(objects, "x-json-alert")
+    if json_alert_ref is not None:
+        objects.pop(json_alert_ref)
+        event_ref, event = get_first_object_by_type(objects, "x-oca-event")
+        alerts = json.loads(json_alert.get('data'))
+        ttps = {}
+        for alert in alerts:
+            finding = {
+                'type': 'x-ibm-finding',
+                'name': alert.get("Title"),
+                'alert_id': alert.get("AlertId"),
+                'severity': SeverityToNumericVal.transform(alert.get("Severity")),
+                'ttp_tagging_refs': []
+            }
+            finding_ref = add_to_objects(observed, finding)
+            if 'finding_refs' not in event:
+                event['finding_refs'] = []
+            event['finding_refs'].append(finding_ref)
+            if 'Category' in alert:
+                cat = alert['Category']
+                if cat not in ttps:
+                    cat_ttp = create_ttp_from_category(cat)
+                    cat_ref = add_to_objects(observed, cat_ttp)
+                    ttps[cat] = cat_ref
+                finding['ttp_tagging_refs'].append(ttps[cat])
+            if 'AttackTechniques' in alert:
+                for technique in alert['AttackTechniques']:
+                    if technique not in ttps:
+                        ttp = create_ttps_from_technique(technique)
+                        ttp_ref = add_to_objects(observed, ttp)
+                        ttps[technique] = ttp_ref
+                    finding['ttp_tagging_refs'].append(ttps[technique])
+            if len(finding['ttp_tagging_refs']) == 0:
+                finding.pop('ttp_tagging_refs')
+
+
+def get_reference(objects, source, ref_prop, ref_type):
+    if ref_prop not in source:
+        return None
+    ref_index = source[ref_prop]
+    if ref_index not in objects:
+        return None
+    ref = objects[ref_index]
+    if not 'type' in ref or ref['type'] != ref_type:
+        return None
+    return ref
+
+
+def extract_pipe_name(x_msatp, event):
+    if 'AdditionalFields' in x_msatp:
+        pattern = r'PipeName:\s*(.+?),'
+        match = re.search(pattern, x_msatp['AdditionalFields'])
+        if match:
+            event['pipe_name'] = match.group(1)
+
+
+def fix_device_event_refs(observed):
+    objects = observed["objects"]
+    x_msatp_refs = get_objects_by_type(objects, "x-msatp")
+    if len(x_msatp_refs) > 0:
+        x_msatp = objects[x_msatp_refs[0]]
+        events = get_objects_by_type(objects, "x-oca-event")
+        if len(events) > 0:
+            event = objects[events[0]]
+            if event['action'] == "NamedPipeEvent":
+                ## if named pipe event add the pip_name to event:
+                extract_pipe_name(x_msatp, event)
+            if 'Table' in x_msatp and x_msatp['Table'] == 'DeviceEvents':
+                ## if event from DeviceEvent and there is only file name without process pid should be a file_ref not process_ref:
+                validate_process_ref_in_event(event, objects)
+
+
+def validate_process_ref_in_event(event, objects):
+    if 'missingChildShouldMapInitiatingPid' in event:
+        pid = event['missingChildShouldMapInitiatingPid']
+        if 'process_ref' in event:
+            proc_ref = event['process_ref']
+            proc = get_reference(objects, event, 'process_ref', 'process')
+            ref = proc['binary_ref']
+            event['file_ref'] = ref
+            delete_object(objects, proc_ref)
+        if pid is not None and pid != "-1":
+            init_proc = [key for key, value in objects.items()
+                         if value.get("type") == "process"
+                         and value.get("pid") == event['missingChildShouldMapInitiatingPid']]
+            if len(init_proc) == 1:
+                event['process_ref'] = init_proc[0]
+        del event['missingChildShouldMapInitiatingPid']
+
+
+def sort_objects(objects):
+    return {k: objects[k] for k in sorted(objects, key=lambda x: int(x))}
+
+
 class ResultsTranslator(JSONToStix):
-  pass
+
+    def translate_results(self, data_source, data):
+        result = super().translate_results(data_source, data)
+        for observed in result["objects"]:
+            if observed["type"] == "observed-data" and "objects" in observed:
+                fix_alerts(observed)
+                fix_device_event_refs(observed)
+                observed['objects'] = sort_objects(observed['objects'])
+        return result
```

## stix_shifter_modules/msatp/stix_translation/transformers.py

```diff
@@ -1,21 +1,32 @@
+import json
+import ntpath
+import re
+import urllib
+from stix_shifter_utils.utils import logger
 from stix_shifter_utils.stix_translation.src.utils.transformers import ValueTransformer
 
+HIGH_SEVERITY = 99
+MEDIUM_SEVERITY = 66
+LOW_SEVERITY = 33
+KILL_CHAIN_NAME = 'mitre-attack'
+
+LOGGER = logger.set_logger(__name__)
+
 
 class MsatpToTimestamp(ValueTransformer):
     """A value transformer to truncate milliseconds"""
 
     @staticmethod
     def transform(msatptime):
         time_array = msatptime.split('.')
         converted_time = time_array[0] + '.' + time_array[1][:3] + 'Z' if len(time_array) > 1 else time_array[0] + 'Z'
         return converted_time
 
 
-
 class MsatpToRegistryValue(ValueTransformer):
     """A value transformer to convert MSATP Registry value protocol to windows-registry-value-type STIX"""
 
     @staticmethod
     def transform(registryvalues):
         stix_mapping = {"RegistryValueName": "name", "RegistryValueData": "data", "RegistryValueType": "data_type"}
         stix_datatype_mapping = {"None": "REG_NONE", "String": "REG_SZ", "Dword": "REG_DWORD",
@@ -32,7 +43,128 @@
                     else:
                         is_data_add = False
                 if is_data_add:
                     registryvalue_dict.update({stix_mapping[key]: value})
         converted_value.append(registryvalue_dict)
         return converted_value
 
+
+class FormatMacList(ValueTransformer):
+    """A value transformer to convert Mac address to STIX Mac address format"""
+
+    @staticmethod
+    def transform(mac_lst):
+        addresses = []
+        for mac in mac_lst:
+            mac = mac.replace("-", "").replace(":", "")
+            val = ':'.join([mac[i:i + 2] for i in range(0, len(mac), 2)]).lower()
+            addresses.append(val)
+        return addresses
+
+
+class IfValidUrl(ValueTransformer):
+    """returns a url if its valid, empty string otherwise"""
+
+    @staticmethod
+    def transform(value):
+        parsed_url = urllib.parse.urlparse(value)
+        if parsed_url.scheme != "":
+            return value
+        else:
+            return ""
+
+
+class GetDomainName(ValueTransformer):
+    """A value transformer to extract domain name from url"""
+
+    @staticmethod
+    def is_valid_domain_name(value):
+        """test if value is a vaild domain name"""
+        try:
+            return (not re.search(r"\s", value)) and (re.compile(
+                r"^(?:[a-zA-Z0-9](?:[a-zA-Z0-9-_]{0,61}[A-Za-z0-9])?\.)+[A-Za-z0-9][A-Za-z0-9-_]{0,61}[A-Za-z]$"
+            ).match(value.encode("idna").decode("ascii")) is not None)
+        except UnicodeError:
+            return False
+
+    @staticmethod
+    def transform(value):
+        # if it is already a domain name return it
+        if GetDomainName.is_valid_domain_name(value):
+            return value
+        # it might be a url, parse the domain from the url
+        parsed_url = urllib.parse.urlparse(value)
+        return parsed_url.netloc
+
+
+class ToFileName(ValueTransformer):
+
+    @staticmethod
+    def transform(value):
+        try:
+            _, file_name = ntpath.split(value)
+            return file_name
+        except ValueError:
+            LOGGER.error("Cannot convert input to file name string")
+
+
+class ToDirectory(ValueTransformer):
+
+    @staticmethod
+    def transform(value):
+        try:
+            file_path, _ = ntpath.split(value)
+            return file_path
+        except ValueError:
+            LOGGER.error("Cannot convert input to file path string")
+
+
+class ToMSATPDirectoryPath(ValueTransformer):
+    """A value transformer for expected directory path. Take care of the inconsistency, sometimes shows up as a
+    folder path and somtimes as a file name """
+
+    @staticmethod
+    def transform(value):
+        try:
+            file_path, file_name = ntpath.split(value)
+            if '.' not in file_name:
+                file_path = value
+            return file_path
+        except ValueError:
+            LOGGER.error("Cannot convert input to directory path string")
+
+
+class SeverityToNumericVal(ValueTransformer):
+    """A value transformer to convert MSATP Severity value (high/medium/low) to numeric value"""
+
+    @staticmethod
+    def transform(severity):
+        severity = severity.lower()
+        if severity == 'high':
+            return HIGH_SEVERITY
+        elif severity == 'medium':
+            return MEDIUM_SEVERITY
+        else:
+            return LOW_SEVERITY
+
+
+class Alert(ValueTransformer):
+    """A value transformer to convert MSATP Severity value (high/medium/low) to numeric value"""
+
+    @staticmethod
+    def transform(val):
+        return "alert"
+
+
+class JsonToString(ValueTransformer):
+    """A value transformer to convert a string representing a json object to key: value string"""
+
+    @staticmethod
+    def transform(val):
+        try:
+            data = json.loads(val)
+        except json.JSONDecodeError:
+            return val
+        pairs = []
+        for key, value in data.items():
+            pairs.append(f"{key}: {value}")
+        return ", ".join(pairs)
```

## stix_shifter_modules/msatp/stix_translation/json/from_stix_map.json

### Pretty-printed

 * *Similarity: 0.7932813854795998%*

 * *Differences: {"'directory'": "{'fields': {'path': {insert: [(4, 'DeviceEvents.FolderPath'), (5, "*

 * *                "'DeviceEvents.InitiatingProcessFolderPath'), (8, "*

 * *                "'DeviceImageLoadEvents.FolderPath'), (9, "*

 * *                "'DeviceImageLoadEvents.InitiatingProcessFolderPath')]}}}",*

 * * "'domain-name'": "{'fields': {'value': ['DeviceNetworkEvents.RemoteUrl', "*

 * *                  "'DeviceEvents.RemoteUrl']}}",*

 * * "'file'": "{'fields': {'name': {insert: [(10, 'DeviceEvents.FileName'), (11, "*

 * *           "'Devic [â€¦]*

```diff
@@ -2,157 +2,185 @@
     "directory": {
         "fields": {
             "path": [
                 "DeviceFileEvents.FolderPath",
                 "DeviceFileEvents.InitiatingProcessFolderPath",
                 "DeviceProcessEvents.FolderPath",
                 "DeviceProcessEvents.InitiatingProcessFolderPath",
+                "DeviceEvents.FolderPath",
+                "DeviceEvents.InitiatingProcessFolderPath",
                 "DeviceNetworkEvents.InitiatingProcessFolderPath",
-                "DeviceRegistryEvents.InitiatingProcessFolderPath"
+                "DeviceRegistryEvents.InitiatingProcessFolderPath",
+                "DeviceImageLoadEvents.FolderPath",
+                "DeviceImageLoadEvents.InitiatingProcessFolderPath"
             ]
         }
     },
     "domain-name": {
         "fields": {
             "value": [
-                "DeviceFileEvents.DeviceName",
-                "DeviceProcessEvents.DeviceName",
-                "DeviceNetworkEvents.DeviceName",
-                "DeviceRegistryEvents.DeviceName",
-                "DeviceEvents.DeviceName",
-                "DeviceInfo.DeviceName",
-                "DeviceAlertEvents.DeviceName",
-                "DeviceImageLoadEvents.DeviceName",
-                "DeviceLogonEvents.DeviceName",
-                "DeviceNetworkInfo.DeviceName"
+                "DeviceNetworkEvents.RemoteUrl",
+                "DeviceEvents.RemoteUrl"
             ]
         }
     },
     "file": {
         "fields": {
             "hashes.'SHA-1'": [
                 "DeviceFileEvents.SHA1",
                 "DeviceFileEvents.InitiatingProcessSHA1",
                 "DeviceProcessEvents.SHA1",
                 "DeviceProcessEvents.InitiatingProcessSHA1",
                 "DeviceNetworkEvents.InitiatingProcessSHA1",
-                "DeviceRegistryEvents.InitiatingProcessSHA1"
+                "DeviceRegistryEvents.InitiatingProcessSHA1",
+                "DeviceEvents.SHA1",
+                "DeviceEvents.InitiatingProcessSHA1",
+                "DeviceImageLoadEvents.SHA1",
+                "DeviceImageLoadEvents.InitiatingProcessSHA1"
             ],
             "hashes.'SHA-256'": [
                 "DeviceFileEvents.SHA256",
                 "DeviceFileEvents.InitiatingProcessSHA256",
                 "DeviceProcessEvents.SHA256",
                 "DeviceProcessEvents.InitiatingProcessSHA256",
                 "DeviceNetworkEvents.InitiatingProcessSHA256",
-                "DeviceRegistryEvents.InitiatingProcessSHA256"
+                "DeviceRegistryEvents.InitiatingProcessSHA256",
+                "DeviceEvents.SHA256",
+                "DeviceEvents.InitiatingProcessSHA256",
+                "DeviceImageLoadEvents.SHA256",
+                "DeviceImageLoadEvents.InitiatingProcessSHA256"
             ],
             "hashes.MD5": [
                 "DeviceFileEvents.MD5",
                 "DeviceFileEvents.InitiatingProcessMD5",
                 "DeviceProcessEvents.MD5",
                 "DeviceProcessEvents.InitiatingProcessMD5",
                 "DeviceNetworkEvents.InitiatingProcessMD5",
-                "DeviceRegistryEvents.InitiatingProcessMD5"
+                "DeviceRegistryEvents.InitiatingProcessMD5",
+                "DeviceEvents.MD5",
+                "DeviceEvents.InitiatingProcessMD5",
+                "DeviceImageLoadEvents.MD5",
+                "DeviceImageLoadEvents.InitiatingProcessMD5"
             ],
             "name": [
                 "DeviceFileEvents.FileName",
                 "DeviceFileEvents.InitiatingProcessFileName",
                 "DeviceFileEvents.InitiatingProcessParentFileName",
                 "DeviceProcessEvents.FileName",
                 "DeviceProcessEvents.InitiatingProcessFileName",
                 "DeviceProcessEvents.InitiatingProcessParentFileName",
                 "DeviceNetworkEvents.InitiatingProcessFileName",
                 "DeviceNetworkEvents.InitiatingProcessParentFileName",
                 "DeviceRegistryEvents.InitiatingProcessFileName",
-                "DeviceRegistryEvents.InitiatingProcessParentFileName"
+                "DeviceRegistryEvents.InitiatingProcessParentFileName",
+                "DeviceEvents.FileName",
+                "DeviceEvents.InitiatingProcessFileName",
+                "DeviceEvents.InitiatingProcessParentFileName",
+                "DeviceImageLoadEvents.FileName",
+                "DeviceImageLoadEvents.InitiatingProcessFileName",
+                "DeviceImageLoadEvents.InitiatingProcessParentFileName"
             ],
             "parent_directory_ref.path": [
                 "DeviceFileEvents.FolderPath",
                 "DeviceFileEvents.InitiatingProcessFolderPath",
                 "DeviceProcessEvents.FolderPath",
                 "DeviceProcessEvents.InitiatingProcessFolderPath",
                 "DeviceNetworkEvents.InitiatingProcessFolderPath",
-                "DeviceRegistryEvents.InitiatingProcessFolderPath"
+                "DeviceRegistryEvents.InitiatingProcessFolderPath",
+                "DeviceEvents.FolderPath",
+                "DeviceEvents.InitiatingProcessFolderPath",
+                "DeviceImageLoadEvents.FolderPath",
+                "DeviceImageLoadEvents.InitiatingProcessFolderPath"
             ]
         }
     },
     "ipv4-addr": {
         "fields": {
             "value": [
                 "DeviceNetworkEvents.LocalIP",
-                "DeviceNetworkEvents.RemoteIP"
+                "DeviceNetworkEvents.RemoteIP",
+                "DeviceEvents.RemoteIP",
+                "DeviceEvents.LocalIP"
             ]
         }
     },
     "ipv6-addr": {
         "fields": {
             "value": [
                 "DeviceNetworkEvents.LocalIP",
-                "DeviceNetworkEvents.RemoteIP"
+                "DeviceNetworkEvents.RemoteIP",
+                "DeviceEvents.RemoteIP",
+                "DeviceEvents.LocalIP"
             ]
         }
     },
     "mac-addr": {
         "fields": {
             "value": [
                 "DeviceNetworkInfo.MacAddress"
             ]
         }
     },
     "network-traffic": {
         "fields": {
             "dst_port": [
-                "DeviceNetworkEvents.RemotePort"
+                "DeviceNetworkEvents.RemotePort",
+                "DeviceEvents.RemotePort"
             ],
             "dst_ref.value": [
-                "DeviceNetworkEvents.RemoteIP"
+                "DeviceNetworkEvents.RemoteIP",
+                "DeviceEvents.RemoteIP"
             ],
             "protocols[*]": [
                 "DeviceNetworkEvents.Protocol"
             ],
             "src_port": [
-                "DeviceNetworkEvents.LocalPort"
+                "DeviceNetworkEvents.LocalPort",
+                "DeviceEvents.LocalPort"
             ],
             "src_ref.value": [
                 "DeviceNetworkEvents.LocalIP",
-                "DeviceNetworkInfo.MacAddress"
+                "DeviceNetworkInfo.MacAddress",
+                "DeviceEvents.LocalIP"
             ]
         }
     },
     "process": {
         "fields": {
             "binary_ref.hashes.'SHA-1'": [
-                "DeviceFileEvents.SHA1",
-                "DeviceFileEvents.InitiatingProcessSHA1",
                 "DeviceProcessEvents.SHA1",
-                "DeviceProcessEvents.InitiatingProcessSHA1",
+                "DeviceEvents.SHA1",
+                "DeviceFileEvents.InitiatingProcessSHA1",
                 "DeviceNetworkEvents.InitiatingProcessSHA1",
-                "DeviceRegistryEvents.InitiatingProcessSHA1"
+                "DeviceRegistryEvents.InitiatingProcessSHA1",
+                "DeviceImageLoadEvents.InitiatingProcessSHA1"
             ],
             "binary_ref.hashes.'SHA-256'": [
-                "DeviceFileEvents.SHA256",
-                "DeviceFileEvents.InitiatingProcessSHA256",
                 "DeviceProcessEvents.SHA256",
-                "DeviceProcessEvents.InitiatingProcessSHA256",
+                "DeviceEvents.SHA256",
+                "DeviceFileEvents.InitiatingProcessSHA256",
                 "DeviceNetworkEvents.InitiatingProcessSHA256",
-                "DeviceRegistryEvents.InitiatingProcessSHA256"
+                "DeviceRegistryEvents.InitiatingProcessSHA256",
+                "DeviceImageLoadEvents.InitiatingProcessSHA256"
             ],
             "binary_ref.hashes.MD5": [
-                "DeviceFileEvents.MD5",
-                "DeviceFileEvents.InitiatingProcessMD5",
                 "DeviceProcessEvents.MD5",
-                "DeviceProcessEvents.InitiatingProcessMD5",
+                "DeviceEvents.MD5",
+                "DeviceFileEvents.InitiatingProcessMD5",
                 "DeviceNetworkEvents.InitiatingProcessMD5",
-                "DeviceRegistryEvents.InitiatingProcessMD5"
+                "DeviceRegistryEvents.InitiatingProcessMD5",
+                "DeviceImageLoadEvents.InitiatingProcessMD5"
             ],
             "binary_ref.parent_directory_ref.path": [
-                "DeviceProcessEvents.InitiatingProcessFolderPath",
+                "DeviceProcessEvents.FolderPath",
+                "DeviceEvents.FolderPath",
                 "DeviceNetworkEvents.InitiatingProcessFolderPath",
                 "DeviceRegistryEvents.InitiatingProcessFolderPath",
-                "DeviceFileEvents.InitiatingProcessFolderPath"
+                "DeviceFileEvents.InitiatingProcessFolderPath",
+                "DeviceImageLoadEvents.InitiatingProcessFolderPath"
             ],
             "child_refs.binary_ref.hashes.'SHA-1'": [
                 "DeviceProcessEvents.SHA1"
             ],
             "child_refs.binary_ref.hashes.'SHA-256'": [
                 "DeviceProcessEvents.SHA256"
             ],
@@ -162,301 +190,374 @@
             "child_refs.binary_ref.parent_directory_ref.path": [
                 "DeviceProcessEvents.FolderPath"
             ],
             "child_refs.creator_user_ref.account_login": [
                 "DeviceProcessEvents.AccountName"
             ],
             "child_refs.pid": [
-                "DeviceProcessEvents.ProcessId",
-                "DeviceProcessEvents.InitiatingProcessId",
-                "DeviceNetworkEvents.InitiatingProcessId",
-                "DeviceRegistryEvents.InitiatingProcessId",
-                "DeviceFileEvents.InitiatingProcessId"
+                "DeviceProcessEvents.ProcessId"
             ],
             "command_line": [
                 "DeviceProcessEvents.ProcessCommandLine",
                 "DeviceProcessEvents.InitiatingProcessCommandLine",
+                "DeviceEvents.ProcessCommandLine",
+                "DeviceEvents.InitiatingProcessCommandLine",
+                "DeviceFileEvents.InitiatingProcessCommandLine",
                 "DeviceNetworkEvents.InitiatingProcessCommandLine",
-                "DeviceRegistryEvents.InitiatingProcessCommandLine"
+                "DeviceRegistryEvents.InitiatingProcessCommandLine",
+                "DeviceImageLoadEvents.InitiatingProcessCommandLine"
             ],
             "created": [
                 "DeviceProcessEvents.ProcessCreationTime",
-                "DeviceProcessEvents.InitiatingProcessParentCreationTime",
+                "DeviceEvents.ProcessCreationTime",
                 "DeviceNetworkEvents.InitiatingProcessCreationTime",
-                "DeviceNetworkEvents.InitiatingProcessParentCreationTime",
                 "DeviceRegistryEvents.InitiatingProcessCreationTime",
-                "DeviceRegistryEvents.InitiatingProcessParentCreationTime",
                 "DeviceFileEvents.InitiatingProcessCreationTime",
-                "DeviceFileEvents.InitiatingProcessParentCreationTime"
+                "DeviceImageLoadEvents.InitiatingProcessCreationTime"
             ],
             "creator_user_ref.account_login": [
-                "DeviceProcessEvents.InitiatingProcessAccountName"
+                "DeviceProcessEvents.AccountUpn",
+                "DeviceEvents.AccountUpn",
+                "DeviceNetworkEvents.InitiatingProcessAccountUpn",
+                "DeviceRegistryEvents.InitiatingProcessAccountUpn",
+                "DeviceFileEvents.InitiatingProcessAccountUpn",
+                "DeviceImageLoadEvents.InitiatingProcessAccountUpn"
             ],
             "creator_user_ref.user_id": [
-                "DeviceProcessEvents.AccountSid",
-                "DeviceProcessEvents.InitiatingProcessAccountSid"
+                "DeviceProcessEvents.AccountName",
+                "DeviceEvents.AccountName",
+                "DeviceNetworkEvents.InitiatingProcessAccountName",
+                "DeviceRegistryEvents.InitiatingProcessAccountName",
+                "DeviceFileEvents.InitiatingProcessAccountName",
+                "DeviceImageLoadEvents.InitiatingProcessAccountName"
             ],
             "name": [
                 "DeviceProcessEvents.FileName",
+                "DeviceEvents.FileName",
                 "DeviceProcessEvents.InitiatingProcessFileName",
-                "DeviceProcessEvents.InitiatingProcessParentFileName",
+                "DeviceEvents.InitiatingProcessFileName",
+                "DeviceFileEvents.InitiatingProcessFileName",
                 "DeviceNetworkEvents.InitiatingProcessFileName",
-                "DeviceNetworkEvents.InitiatingProcessParentFileName",
                 "DeviceRegistryEvents.InitiatingProcessFileName",
-                "DeviceRegistryEvents.InitiatingProcessParentFileName"
+                "DeviceImageLoadEvents.InitiatingProcessFileName"
+            ],
+            "parent_ref.binary_ref.hashes.'SHA-1'": [
+                "DeviceProcessEvents.InitiatingProcessSHA1",
+                "DeviceEvents.InitiatingProcessSHA1"
+            ],
+            "parent_ref.binary_ref.hashes.'SHA-256'": [
+                "DeviceProcessEvents.InitiatingProcessSHA256",
+                "DeviceEvents.InitiatingProcessSHA256"
+            ],
+            "parent_ref.binary_ref.hashes.MD5": [
+                "DeviceProcessEvents.InitiatingProcessMD5",
+                "DeviceEvents.InitiatingProcessMD5"
+            ],
+            "parent_ref.binary_ref.parent_directory_ref.path": [
+                "DeviceProcessEvents.InitiatingProcessFolderPath",
+                "DeviceEvents.InitiatingProcessFolderPath"
             ],
             "parent_ref.created": [
-                "DeviceProcessEvents.InitiatingProcessParentCreationTime",
+                "DeviceProcessEvents.InitiatingProcessCreationTime",
+                "DeviceEvents.InitiatingProcessCreationTime",
                 "DeviceNetworkEvents.InitiatingProcessParentCreationTime",
                 "DeviceRegistryEvents.InitiatingProcessParentCreationTime",
-                "DeviceFileEvents.InitiatingProcessParentCreationTime"
+                "DeviceFileEvents.InitiatingProcessParentCreationTime",
+                "DeviceImageLoadEvents.InitiatingProcessParentCreationTime"
+            ],
+            "parent_ref.creator_user_ref.account_login": [
+                "DeviceProcessEvents.InitiatingProcessAccountUpn",
+                "DeviceEvents.InitiatingProcessAccountUpn"
+            ],
+            "parent_ref.creator_user_ref.user_id": [
+                "DeviceProcessEvents.InitiatingProcessAccountName",
+                "DeviceEvents.InitiatingProcessAccountName"
             ],
             "parent_ref.name": [
                 "DeviceProcessEvents.InitiatingProcessFileName",
-                "DeviceProcessEvents.InitiatingProcessFileName",
-                "DeviceNetworkEvents.InitiatingProcessFileName",
-                "DeviceRegistryEvents.InitiatingProcessFileName",
-                "DeviceProcessEvents.InitiatingProcessParentFileName",
-                "DeviceProcessEvents.InitiatingProcessParentFileName",
+                "DeviceEvents.InitiatingProcessFileName",
+                "DeviceFileEvents.InitiatingProcessParentFileName",
                 "DeviceNetworkEvents.InitiatingProcessParentFileName",
-                "DeviceRegistryEvents.InitiatingProcessParentFileName"
+                "DeviceRegistryEvents.InitiatingProcessParentFileName",
+                "DeviceImageLoadEvents.InitiatingProcessParentFileName"
+            ],
+            "parent_ref.parent_ref.created": [
+                "DeviceProcessEvents.InitiatingProcessParentCreationTime",
+                "DeviceEvents.InitiatingProcessParentCreationTime"
+            ],
+            "parent_ref.parent_ref.name": [
+                "DeviceProcessEvents.InitiatingProcessParentFileName",
+                "DeviceEvents.InitiatingProcessParentFileName"
+            ],
+            "parent_ref.parent_ref.pid": [
+                "DeviceProcessEvents.InitiatingProcessParentId",
+                "DeviceNetworkEvents.InitiatingProcessParentId"
             ],
             "parent_ref.pid": [
                 "DeviceProcessEvents.InitiatingProcessId",
                 "DeviceNetworkEvents.InitiatingProcessId",
-                "DeviceRegistryEvents.InitiatingProcessId",
-                "DeviceFileEvents.InitiatingProcessId",
-                "DeviceProcessEvents.InitiatingProcessParentId",
-                "DeviceNetworkEvents.InitiatingProcessParentId",
                 "DeviceRegistryEvents.InitiatingProcessParentId",
-                "DeviceFileEvents.InitiatingProcessParentId"
+                "DeviceFileEvents.InitiatingProcessParentId",
+                "DeviceEvents.InitiatingProcessParentId",
+                "DeviceImageLoadEvents.InitiatingProcessParentId"
             ],
             "pid": [
                 "DeviceProcessEvents.ProcessId",
+                "DeviceEvents.ProcessId",
+                "DeviceProcessEvents.InitiatingProcessId",
+                "DeviceEvents.InitiatingProcessId",
                 "DeviceProcessEvents.InitiatingProcessId",
-                "DeviceProcessEvents.InitiatingProcessParentId",
                 "DeviceNetworkEvents.InitiatingProcessId",
-                "DeviceNetworkEvents.InitiatingProcessParentId",
                 "DeviceRegistryEvents.InitiatingProcessId",
-                "DeviceRegistryEvents.InitiatingProcessParentId",
                 "DeviceFileEvents.InitiatingProcessId",
-                "DeviceFileEvents.InitiatingProcessParentId"
+                "DeviceImageLoadEvents.InitiatingProcessId"
             ]
         }
     },
     "url": {
         "fields": {
             "value": [
-                "DeviceNetworkEvents.RemoteUrl"
+                "DeviceNetworkEvents.RemoteUrl",
+                "DeviceEvents.RemoteUrl",
+                "DeviceFileEvents.FileOriginUrl",
+                "DeviceFileEvents.FileOriginReferrerUrl"
             ]
         }
     },
     "user-account": {
         "fields": {
             "account_login": [
-                "DeviceProcessEvents.AccountName",
-                "DeviceNetworkEvents.InitiatingProcessAccountName",
-                "DeviceRegistryEvents.InitiatingProcessAccountName"
+                "DeviceProcessEvents.AccountUpn",
+                "DeviceEvents.AccountUpn",
+                "DeviceProcessEvents.InitiatingProcessAccountUpn",
+                "DeviceNetworkEvents.InitiatingProcessAccountUpn",
+                "DeviceRegistryEvents.InitiatingProcessAccountUpn",
+                "DeviceFileEvents.InitiatingProcessAccountUpn",
+                "DeviceEvents.InitiatingProcessAccountUpn",
+                "DeviceImageLoadEvents.InitiatingProcessAccountUpn"
             ],
             "user_id": [
-                "DeviceProcessEvents.AccountSid",
-                "DeviceNetworkEvents.InitiatingProcessAccountSid",
-                "DeviceRegistryEvents.InitiatingProcessAccountSid"
+                "DeviceProcessEvents.AccountName",
+                "DeviceFileEvents.RequestAccountName",
+                "DeviceEvents.AccountName",
+                "DeviceProcessEvents.InitiatingProcessAccountName",
+                "DeviceNetworkEvents.InitiatingProcessAccountName",
+                "DeviceRegistryEvents.InitiatingProcessAccountName",
+                "DeviceFileEvents.InitiatingProcessAccountName",
+                "DeviceEvents.InitiatingProcessAccountName",
+                "DeviceImageLoadEvents.InitiatingProcessAccountName"
             ]
         }
     },
     "windows-registry-key": {
         "fields": {
             "key": [
-                "DeviceRegistryEvents.RegistryKey"
+                "DeviceRegistryEvents.RegistryKey",
+                "DeviceEvents.RegistryKey"
             ],
             "values[*]": [
-                "DeviceRegistryEvents.RegistryValueName"
+                "DeviceRegistryEvents.RegistryValueName",
+                "DeviceEvents.RegistryValueName"
             ]
         }
     },
-    "x-msatp": {
+    "x-ibm-finding": {
         "fields": {
-            "computer_name": [
-                "DeviceProcessEvents.DeviceName",
-                "DeviceNetworkEvents.DeviceName",
-                "DeviceRegistryEvents.DeviceName",
-                "DeviceFileEvents.DeviceName"
+            "alert_id": [
+                "DeviceAlertEvents.AlertId"
             ],
-            "machine_id": [
-                "DeviceProcessEvents.DeviceId",
-                "DeviceNetworkEvents.DeviceId",
-                "DeviceRegistryEvents.DeviceId",
-                "DeviceFileEvents.DeviceId"
+            "name": [
+                "DeviceAlertEvents.Title"
+            ],
+            "time_observed": [
+                "DeviceAlertEvents.Timestamp"
             ]
         }
     },
     "x-oca-asset": {
         "fields": {
-            "domain": [
-                "DeviceFileEvents.DeviceName",
-                "DeviceProcessEvents.DeviceName",
-                "DeviceNetworkEvents.DeviceName",
-                "DeviceRegistryEvents.DeviceName",
-                "DeviceEvents.DeviceName",
-                "DeviceInfo.DeviceName",
-                "DeviceAlertEvents.DeviceName",
-                "DeviceImageLoadEvents.DeviceName",
-                "DeviceLogonEvents.DeviceName",
-                "DeviceNetworkInfo.DeviceName"
+            "device_id": [
+                "DeviceFileEvents.DeviceId",
+                "DeviceProcessEvents.DeviceId",
+                "DeviceNetworkEvents.DeviceId",
+                "DeviceRegistryEvents.DeviceId",
+                "DeviceEvents.DeviceId",
+                "DeviceImageLoadEvents.DeviceId",
+                "DeviceLogonEvents.DeviceId"
             ],
             "hostname": [
                 "DeviceFileEvents.DeviceName",
                 "DeviceProcessEvents.DeviceName",
                 "DeviceNetworkEvents.DeviceName",
                 "DeviceRegistryEvents.DeviceName",
                 "DeviceEvents.DeviceName",
-                "DeviceInfo.DeviceName",
-                "DeviceAlertEvents.DeviceName",
                 "DeviceImageLoadEvents.DeviceName",
-                "DeviceLogonEvents.DeviceName",
-                "DeviceNetworkInfo.DeviceName"
+                "DeviceLogonEvents.DeviceName"
             ],
-            "ip": [
+            "ip_refs[*].value": [
                 "DeviceNetworkEvents.LocalIP"
             ],
-            "name": [
-                "DeviceFileEvents.DeviceName",
-                "DeviceProcessEvents.DeviceName",
-                "DeviceNetworkEvents.DeviceName",
-                "DeviceRegistryEvents.DeviceName",
-                "DeviceEvents.DeviceName",
-                "DeviceInfo.DeviceName",
-                "DeviceAlertEvents.DeviceName",
-                "DeviceImageLoadEvents.DeviceName",
-                "DeviceLogonEvents.DeviceName",
-                "DeviceNetworkInfo.DeviceName"
-            ],
             "os.name": [
                 "DeviceInfo.OSPlatform"
             ],
             "os.platform": [
                 "DeviceInfo.OSPlatform"
             ]
         }
     },
     "x-oca-event": {
         "fields": {
+            "action": [
+                "DeviceProcessEvents.ActionType",
+                "DeviceEvents.ActionType",
+                "DeviceNetworkEvents.ActionType",
+                "DeviceRegistryEvents.ActionType",
+                "DeviceFileEvents.ActionType",
+                "DeviceImageLoadEvents.ActionType"
+            ],
             "domain_ref.value": [
-                "DeviceProcessEvents.DeviceName",
-                "DeviceNetworkEvents.DeviceName",
-                "DeviceRegistryEvents.DeviceName",
-                "DeviceFileEvents.DeviceName"
+                "DeviceNetworkEvents.RemoteUrl",
+                "DeviceEvents.RemoteUrl"
             ],
             "file_ref.name": [
-                "DeviceProcessEvents.InitiatingProcessFileName",
-                "DeviceNetworkEvents.InitiatingProcessFileName",
-                "DeviceRegistryEvents.InitiatingProcessFileName"
+                "DeviceFileEvents.FileName",
+                "DeviceImageLoadEvents.FileName"
             ],
-            "host_ref.hostname": [
-                "DeviceFileEvents.DeviceName",
-                "DeviceProcessEvents.DeviceName",
-                "DeviceNetworkEvents.DeviceName",
-                "DeviceRegistryEvents.DeviceName",
-                "DeviceEvents.DeviceName",
-                "DeviceInfo.DeviceName",
-                "DeviceAlertEvents.DeviceName",
-                "DeviceImageLoadEvents.DeviceName",
-                "DeviceLogonEvents.DeviceName",
-                "DeviceNetworkInfo.DeviceName"
+            "host_ref.device_id": [
+                "DeviceFileEvents.DeviceId",
+                "DeviceProcessEvents.DeviceId",
+                "DeviceNetworkEvents.DeviceId",
+                "DeviceRegistryEvents.DeviceId",
+                "DeviceEvents.DeviceId",
+                "DeviceImageLoadEvents.DeviceId",
+                "DeviceLogonEvents.DeviceId"
             ],
-            "host_ref.name": [
+            "host_ref.hostname": [
                 "DeviceFileEvents.DeviceName",
                 "DeviceProcessEvents.DeviceName",
                 "DeviceNetworkEvents.DeviceName",
                 "DeviceRegistryEvents.DeviceName",
                 "DeviceEvents.DeviceName",
-                "DeviceInfo.DeviceName",
-                "DeviceAlertEvents.DeviceName",
                 "DeviceImageLoadEvents.DeviceName",
-                "DeviceLogonEvents.DeviceName",
-                "DeviceNetworkInfo.DeviceName"
+                "DeviceLogonEvents.DeviceName"
             ],
             "parent_process_ref.name": [
-                "DeviceProcessEvents.InitiatingProcessParentFileName",
+                "DeviceProcessEvents.InitiatingProcessFileName",
+                "DeviceEvents.InitiatingProcessFileName",
                 "DeviceNetworkEvents.InitiatingProcessParentFileName",
                 "DeviceRegistryEvents.InitiatingProcessParentFileName",
-                "DeviceFileEvents.InitiatingProcessParentFileName"
+                "DeviceFileEvents.InitiatingProcessParentFileName",
+                "DeviceImageLoadEvents.InitiatingProcessParentFileName"
             ],
             "parent_process_ref.pid": [
-                "DeviceProcessEvents.InitiatingProcessParentId",
+                "DeviceProcessEvents.InitiatingProcessId",
+                "DeviceEvents.InitiatingProcessId",
                 "DeviceNetworkEvents.InitiatingProcessParentId",
                 "DeviceRegistryEvents.InitiatingProcessParentId",
-                "DeviceFileEvents.InitiatingProcessParentId"
+                "DeviceFileEvents.InitiatingProcessParentId",
+                "DeviceImageLoadEvents.InitiatingProcessParentId"
+            ],
+            "process_ref.binary_ref.hashes.'SHA-1'": [
+                "DeviceProcessEvents.SHA1",
+                "DeviceEvents.SHA1",
+                "DeviceNetworkEvents.InitiatingProcessSHA1",
+                "DeviceRegistryEvents.InitiatingProcessSHA1",
+                "DeviceFileEvents.InitiatingProcessSHA1",
+                "DeviceImageLoadEvents.InitiatingProcessSHA1"
             ],
             "process_ref.binary_ref.hashes.'SHA-256'": [
-                "DeviceProcessEvents.InitiatingProcessSHA256",
+                "DeviceProcessEvents.SHA256",
+                "DeviceEvents.SHA256",
                 "DeviceNetworkEvents.InitiatingProcessSHA256",
                 "DeviceRegistryEvents.InitiatingProcessSHA256",
-                "DeviceFileEvents.InitiatingProcessSHA256"
+                "DeviceFileEvents.InitiatingProcessSHA256",
+                "DeviceImageLoadEvents.InitiatingProcessSHA256"
             ],
             "process_ref.binary_ref.hashes.MD5": [
-                "DeviceProcessEvents.InitiatingProcessMD5",
+                "DeviceProcessEvents.MD5",
+                "DeviceEvents.MD5",
                 "DeviceNetworkEvents.InitiatingProcessMD5",
                 "DeviceRegistryEvents.InitiatingProcessMD5",
-                "DeviceFileEvents.InitiatingProcessMD5"
+                "DeviceFileEvents.InitiatingProcessMD5",
+                "DeviceImageLoadEvents.InitiatingProcessMD5"
             ],
             "process_ref.binary_ref.name": [
-                "DeviceProcessEvents.InitiatingProcessFileName",
+                "DeviceProcessEvents.FileName",
+                "DeviceEvents.FileName",
                 "DeviceNetworkEvents.InitiatingProcessFileName",
                 "DeviceRegistryEvents.InitiatingProcessFileName",
-                "DeviceFileEvents.InitiatingProcessFileName"
-            ],
-            "process_ref.child_refs.name": [
-                "DeviceProcessEvents.FileName"
-            ],
-            "process_ref.child_refs.pid": [
-                "DeviceProcessEvents.ProcessId"
+                "DeviceFileEvents.InitiatingProcessFileName",
+                "DeviceImageLoadEvents.InitiatingProcessFileName"
             ],
             "process_ref.command_line": [
-                "DeviceProcessEvents.InitiatingProcessCommandLine",
+                "DeviceProcessEvents.ProcessCommandLine",
+                "DeviceEvents.ProcessCommandLine",
                 "DeviceNetworkEvents.InitiatingProcessCommandLine",
                 "DeviceRegistryEvents.InitiatingProcessCommandLine",
-                "DeviceFileEvents.InitiatingProcessCommandLine"
+                "DeviceFileEvents.InitiatingProcessCommandLine",
+                "DeviceImageLoadEvents.InitiatingProcessCommandLine"
             ],
             "process_ref.creator_user_ref.account_login": [
-                "DeviceProcessEvents.AccountName"
+                "DeviceProcessEvents.AccountUpn",
+                "DeviceEvents.AccountUpn",
+                "DeviceNetworkEvents.InitiatingProcessAccountUpn",
+                "DeviceRegistryEvents.InitiatingProcessAccountUpn",
+                "DeviceFileEvents.InitiatingProcessAccountUpn",
+                "DeviceImageLoadEvents.InitiatingProcessAccountUpn"
             ],
             "process_ref.creator_user_ref.user_id": [
-                "DeviceProcessEvents.InitiatingProcessAccountSid",
-                "DeviceNetworkEvents.InitiatingProcessAccountSid",
-                "DeviceRegistryEvents.InitiatingProcessAccountSid",
-                "DeviceFileEvents.InitiatingProcessAccountSid"
+                "DeviceProcessEvents.AccountName",
+                "DeviceEvents.AccountName",
+                "DeviceNetworkEvents.InitiatingProcessAccountName",
+                "DeviceRegistryEvents.InitiatingProcessAccountName",
+                "DeviceFileEvents.InitiatingProcessAccountName",
+                "DeviceImageLoadEvents.InitiatingProcessAccountName"
             ],
             "process_ref.name": [
-                "DeviceProcessEvents.InitiatingProcessFileName",
+                "DeviceProcessEvents.FileName",
+                "DeviceEvents.FileName",
                 "DeviceNetworkEvents.InitiatingProcessFileName",
                 "DeviceRegistryEvents.InitiatingProcessFileName",
-                "DeviceFileEvents.InitiatingProcessFileName"
+                "DeviceFileEvents.InitiatingProcessFileName",
+                "DeviceImageLoadEvents.InitiatingProcessFileName"
+            ],
+            "process_ref.parent_ref.command_line": [
+                "DeviceProcessEvents.InitiatingProcessCommandLine",
+                "DeviceEvents.InitiatingProcessCommandLine"
             ],
             "process_ref.parent_ref.name": [
-                "DeviceProcessEvents.InitiatingProcessParentFileName",
+                "DeviceProcessEvents.InitiatingProcessFileName",
+                "DeviceEvents.InitiatingProcessFileName",
                 "DeviceNetworkEvents.InitiatingProcessParentFileName",
                 "DeviceRegistryEvents.InitiatingProcessParentFileName",
-                "DeviceFileEvents.InitiatingProcessParentFileName"
+                "DeviceFileEvents.InitiatingProcessParentFileName",
+                "DeviceImageLoadEvents.InitiatingProcessParentFileName"
             ],
             "process_ref.parent_ref.pid": [
-                "DeviceProcessEvents.InitiatingProcessParentId",
+                "DeviceProcessEvents.InitiatingProcessId",
+                "DeviceEvents.InitiatingProcessId",
                 "DeviceNetworkEvents.InitiatingProcessParentId",
                 "DeviceRegistryEvents.InitiatingProcessParentId",
-                "DeviceFileEvents.InitiatingProcessParentId"
+                "DeviceFileEvents.InitiatingProcessParentId",
+                "DeviceImageLoadEvents.InitiatingProcessParentId"
             ],
             "process_ref.pid": [
-                "DeviceProcessEvents.InitiatingProcessId",
+                "DeviceProcessEvents.ProcessId",
+                "DeviceEvents.ProcessId",
                 "DeviceNetworkEvents.InitiatingProcessId",
                 "DeviceRegistryEvents.InitiatingProcessId",
-                "DeviceFileEvents.InitiatingProcessId"
-            ],
-            "process_ref.process_ref.creator_user_ref.account_login": [
-                "DeviceProcessEvents.AccountName"
+                "DeviceFileEvents.InitiatingProcessId",
+                "DeviceImageLoadEvents.InitiatingProcessId"
             ],
             "registry_ref.key": [
                 "DeviceRegistryEvents.RegistryKey"
+            ],
+            "url_ref.value": [
+                "DeviceNetworkEvents.RemoteUrl",
+                "DeviceEvents.RemoteUrl",
+                "DeviceEvents.FileOriginUrl",
+                "DeviceFileEvents.FileOriginUrl",
+                "DeviceFileEvents.FileOriginReferrerUrl"
             ]
         }
     }
 }
```

## stix_shifter_modules/msatp/stix_translation/json/to_stix_map.json

### Pretty-printed

 * *Similarity: 0.500664535560547%*

 * *Differences: {"'DeviceAlertEvents'": "OrderedDict([('AlertId', [OrderedDict([('key', 'x-ibm-finding.alert_id'), "*

 * *                        "('object', 'finding')]), OrderedDict([('key', "*

 * *                        "'x-oca-event.finding_refs'), ('object', 'event'), ('references', "*

 * *                        "['finding']), ('group', True)])]), ('Severity', OrderedDict([('key', "*

 * *                        "'x-ibm-finding.severity'), ('object', 'finding'), ('transformer', "*

 * *                        "'SeverityToNumericVal')])), ('At [â€¦]*

```diff
@@ -1,65 +1,1407 @@
 {
-    "DeviceFileEvents": {
+    "DeviceAlertEvents": {
+        "AlertId": [
+            {
+                "key": "x-ibm-finding.alert_id",
+                "object": "finding"
+            },
+            {
+                "group": true,
+                "key": "x-oca-event.finding_refs",
+                "object": "event",
+                "references": [
+                    "finding"
+                ]
+            }
+        ],
+        "AttackTechniques": [
+            {
+                "key": "x-ibm-ttp-tagging.extensions.mitre-attack-ext.technique_name",
+                "object": "ttp_tagging",
+                "unwrap": true
+            },
+            {
+                "group": true,
+                "key": "x-ibm-finding.ttp_tagging_refs",
+                "object": "finding",
+                "references": [
+                    "ttp_tagging"
+                ],
+                "unwrap": true
+            }
+        ],
+        "Category": [
+            {
+                "key": "x-ibm-ttp-tagging.kill_chain_phases.phase_name",
+                "object": "ttp_tagging_phase"
+            },
+            {
+                "group": true,
+                "key": "x-ibm-finding.ttp_tagging_refs",
+                "object": "finding",
+                "references": [
+                    "ttp_tagging_phase"
+                ],
+                "unwrap": true
+            }
+        ],
+        "DeviceId": [
+            {
+                "key": "x-oca-asset.device_id",
+                "object": "host"
+            },
+            {
+                "key": "x-oca-event.host_ref",
+                "object": "event",
+                "references": "host"
+            }
+        ],
+        "DeviceName": [
+            {
+                "key": "x-oca-asset.hostname",
+                "object": "host"
+            },
+            {
+                "key": "x-oca-event.host_ref",
+                "object": "event",
+                "references": "host"
+            }
+        ],
+        "FileName": [
+            {
+                "key": "file.name",
+                "object": "file",
+                "transformer": "ToFileName"
+            },
+            {
+                "key": "x-oca-event.file_ref",
+                "object": "event",
+                "references": "file"
+            },
+            {
+                "key": "directory.path",
+                "object": "file_dir",
+                "transformer": "ToMSATPDirectoryPath"
+            },
+            {
+                "key": "file.parent_directory_ref",
+                "object": "file",
+                "references": "file_dir"
+            }
+        ],
+        "MD5": {
+            "key": "file.hashes.MD5",
+            "object": "file"
+        },
+        "RemoteIP": [
+            {
+                "key": "ipv4-addr.value",
+                "object": "dst_ip"
+            },
+            {
+                "key": "ipv6-addr.value",
+                "object": "dst_ip"
+            },
+            {
+                "key": "network-traffic.dst_ref",
+                "object": "nt",
+                "references": "dst_ip"
+            },
+            {
+                "key": "x-oca-event.network_ref",
+                "object": "event",
+                "references": "nt"
+            },
+            {
+                "group": true,
+                "key": "x-oca-event.ip_refs",
+                "object": "event",
+                "references": [
+                    "dst_ip"
+                ]
+            },
+            {
+                "group": true,
+                "key": "x-ibm-finding.ioc_refs",
+                "object": "finding",
+                "references": [
+                    "dst_ip"
+                ]
+            }
+        ],
+        "RemoteUrl": [
+            {
+                "key": "url.value",
+                "object": "url",
+                "transformer": "IfValidUrl"
+            },
+            {
+                "key": "domain-name.value",
+                "object": "domain-name",
+                "transformer": "GetDomainName"
+            },
+            {
+                "key": "x-oca-event.domain_ref",
+                "object": "event",
+                "references": "domain-name"
+            },
+            {
+                "key": "x-oca-event.url_ref",
+                "object": "event",
+                "references": "url"
+            },
+            {
+                "group": true,
+                "key": "x-ibm-finding.ioc_refs",
+                "object": "finding",
+                "references": [
+                    "url",
+                    "domain-name"
+                ]
+            }
+        ],
+        "ReportId": {
+            "key": "x-msatp.ReportId",
+            "object": "x-msatp"
+        },
+        "SHA1": {
+            "key": "file.hashes.SHA-1",
+            "object": "file"
+        },
+        "SHA256": {
+            "key": "file.hashes.SHA-256",
+            "object": "file"
+        },
+        "Severity": {
+            "key": "x-ibm-finding.severity",
+            "object": "finding",
+            "transformer": "SeverityToNumericVal"
+        },
+        "TableName": {
+            "key": "x-msatp.Table",
+            "object": "x-msatp"
+        },
+        "Timestamp": [
+            {
+                "key": "x-oca-event.created",
+                "object": "event"
+            },
+            {
+                "key": "x-ibm-finding.time_observed",
+                "object": "finding"
+            },
+            {
+                "cybox": false,
+                "key": "first_observed",
+                "transformer": "MsatpToTimestamp"
+            },
+            {
+                "cybox": false,
+                "key": "last_observed",
+                "transformer": "MsatpToTimestamp"
+            }
+        ],
+        "Title": [
+            {
+                "key": "x-ibm-finding.name",
+                "object": "finding"
+            },
+            {
+                "key": "x-oca-event.action",
+                "object": "event"
+            },
+            {
+                "key": "x-oca-event.category",
+                "object": "event",
+                "transformer": "Alert"
+            },
+            {
+                "key": "x-ibm-finding.finding_type",
+                "object": "finding",
+                "transformer": "Alert"
+            }
+        ],
+        "event_count": {
+            "cybox": false,
+            "key": "number_observed",
+            "transformer": "ToInteger"
+        },
+        "event_link": [
+            {
+                "key": "external-reference.url",
+                "object": "device_external_ref"
+            },
+            {
+                "key": "x-oca-event.external_ref",
+                "object": "event",
+                "references": "device_external_ref"
+            }
+        ],
+        "original_ref": [
+            {
+                "key": "artifact.payload_bin",
+                "object": "original_ref",
+                "transformer": "ToBase64"
+            },
+            {
+                "key": "x-oca-event.original_ref",
+                "object": "event",
+                "references": "original_ref"
+            }
+        ],
+        "provider": {
+            "key": "x-oca-event.provider",
+            "object": "event",
+            "value": "Microsoft Defender for Endpoint"
+        }
+    },
+    "DeviceEvents": {
+        "AccountName": [
+            {
+                "key": "user-account.user_id",
+                "object": "child_process_creator"
+            },
+            {
+                "key": "process.creator_user_ref",
+                "object": "child_process",
+                "references": "child_process_creator"
+            }
+        ],
+        "AccountUpn": [
+            {
+                "key": "user-account.account_login",
+                "object": "child_process_creator"
+            },
+            {
+                "key": "process.creator_user_ref",
+                "object": "child_process",
+                "references": "child_process_creator"
+            }
+        ],
         "ActionType": [
             {
                 "key": "x-oca-event.action",
                 "object": "event"
             }
         ],
-        "DeviceId": {
-            "key": "x-oca-asset.device_id",
+        "AdditionalFields": {
+            "key": "x-msatp.AdditionalFields",
+            "object": "x-msatp",
+            "transformer": "JsonToString"
+        },
+        "Alerts": {
+            "key": "x-json-alert.data"
+        },
+        "DeviceId": [
+            {
+                "key": "x-oca-asset.device_id",
+                "object": "host"
+            },
+            {
+                "key": "x-oca-event.host_ref",
+                "object": "event",
+                "references": "host"
+            }
+        ],
+        "DeviceName": [
+            {
+                "key": "x-oca-asset.hostname",
+                "object": "host"
+            },
+            {
+                "key": "x-oca-event.host_ref",
+                "object": "event",
+                "references": "host"
+            }
+        ],
+        "FileName": [
+            {
+                "key": "file.name",
+                "object": "child_process_file",
+                "transformer": "ToFileName"
+            },
+            {
+                "key": "process.name",
+                "object": "child_process",
+                "transformer": "ToFileName"
+            },
+            {
+                "key": "process.binary_ref",
+                "object": "child_process",
+                "references": "child_process_file"
+            },
+            {
+                "key": "process.child_refs",
+                "object": "process",
+                "references": [
+                    "child_process"
+                ]
+            },
+            {
+                "key": "x-oca-event.process_ref",
+                "object": "event",
+                "references": "child_process"
+            },
+            {
+                "key": "directory.path",
+                "object": "child_process_file_dir",
+                "transformer": "ToMSATPDirectoryPath"
+            },
+            {
+                "key": "file.parent_directory_ref",
+                "object": "child_process_file",
+                "references": "child_process_file_dir"
+            }
+        ],
+        "FileOriginIP": [
+            {
+                "key": "ipv4-addr.value",
+                "object": "dst_ip"
+            },
+            {
+                "key": "ipv6-addr.value",
+                "object": "dst_ip"
+            },
+            {
+                "key": "network-traffic.dst_ref",
+                "object": "nt",
+                "references": "dst_ip"
+            },
+            {
+                "key": "x-oca-event.network_ref",
+                "object": "event",
+                "references": "nt"
+            }
+        ],
+        "FileOriginUrl": [
+            {
+                "key": "url.value",
+                "object": "url_ref",
+                "transformer": "IfValidUrl"
+            },
+            {
+                "key": "x-oca-event.url_ref",
+                "object": "event",
+                "references": "url_ref"
+            },
+            {
+                "key": "domain-name.value",
+                "object": "file-origin-domain",
+                "transformer": "GetDomainName"
+            },
+            {
+                "key": "x-oca-event.domain_ref",
+                "object": "event",
+                "references": "file-origin-domain"
+            }
+        ],
+        "FolderPath": [
+            {
+                "key": "directory.path",
+                "object": "child_process_file_dir",
+                "transformer": "ToMSATPDirectoryPath"
+            },
+            {
+                "key": "file.parent_directory_ref",
+                "object": "child_process_file",
+                "references": "child_process_file_dir"
+            }
+        ],
+        "IPAddresses": [
+            {
+                "key": "ipv4-addr.value",
+                "object": "host_ip4",
+                "transformer": "FilterIPv4List",
+                "unwrap": true
+            },
+            {
+                "key": "ipv6-addr.value",
+                "object": "host_ip6",
+                "transformer": "FilterIPv6List",
+                "unwrap": true
+            },
+            {
+                "group": true,
+                "key": "x-oca-asset.ip_refs",
+                "object": "host",
+                "references": [
+                    "host_ip4",
+                    "host_ip6"
+                ],
+                "unwrap": true
+            }
+        ],
+        "InitiatingProcessAccountName": [
+            {
+                "key": "user-account.user_id",
+                "object": "process_creator"
+            },
+            {
+                "key": "process.creator_user_ref",
+                "object": "process",
+                "references": "process_creator"
+            }
+        ],
+        "InitiatingProcessAccountUpn": [
+            {
+                "key": "user-account.account_login",
+                "object": "process_creator"
+            },
+            {
+                "key": "process.creator_user_ref",
+                "object": "process",
+                "references": "process_creator"
+            }
+        ],
+        "InitiatingProcessCommandLine": {
+            "key": "process.command_line",
+            "object": "process"
+        },
+        "InitiatingProcessCreationTime": {
+            "key": "process.created",
+            "object": "process",
+            "transformer": "MsatpToTimestamp"
+        },
+        "InitiatingProcessFileName": [
+            {
+                "key": "file.name",
+                "object": "process_file",
+                "transformer": "ToFileName"
+            },
+            {
+                "key": "process.name",
+                "object": "process",
+                "transformer": "ToFileName"
+            },
+            {
+                "key": "process.binary_ref",
+                "object": "process",
+                "references": "process_file"
+            },
+            {
+                "key": "process.parent_ref",
+                "object": "child_process",
+                "references": "process"
+            },
+            {
+                "key": "directory.path",
+                "object": "process_file_dir",
+                "transformer": "ToMSATPDirectoryPath"
+            },
+            {
+                "key": "file.parent_directory_ref",
+                "object": "process_file",
+                "references": "process_file_dir"
+            }
+        ],
+        "InitiatingProcessFolderPath": [
+            {
+                "key": "directory.path",
+                "object": "process_file_dir",
+                "transformer": "ToMSATPDirectoryPath"
+            },
+            {
+                "key": "file.parent_directory_ref",
+                "object": "process_file",
+                "references": "process_file_dir"
+            },
+            {
+                "key": "process.binary_ref",
+                "object": "process",
+                "references": "process_file"
+            }
+        ],
+        "InitiatingProcessId": [
+            {
+                "key": "process.pid",
+                "object": "process",
+                "transformer": "ToInteger"
+            },
+            {
+                "key": "process.parent_ref",
+                "object": "child_process",
+                "references": "process"
+            }
+        ],
+        "InitiatingProcessMD5": [
+            {
+                "key": "file.hashes.MD5",
+                "object": "process_file"
+            },
+            {
+                "key": "process.binary_ref",
+                "object": "process",
+                "references": "process_file"
+            }
+        ],
+        "InitiatingProcessParentCreationTime": [
+            {
+                "key": "process.created",
+                "object": "parent_process",
+                "transformer": "MsatpToTimestamp"
+            },
+            {
+                "key": "process.parent_ref",
+                "object": "process",
+                "references": "parent_process"
+            }
+        ],
+        "InitiatingProcessParentFileName": [
+            {
+                "key": "file.name",
+                "object": "parent_process_file",
+                "transformer": "ToFileName"
+            },
+            {
+                "key": "process.name",
+                "object": "parent_process",
+                "transformer": "ToFileName"
+            },
+            {
+                "key": "process.parent_ref",
+                "object": "process",
+                "references": "parent_process"
+            },
+            {
+                "key": "process.binary_ref",
+                "object": "parent_process",
+                "references": "parent_process_file"
+            },
+            {
+                "key": "directory.path",
+                "object": "parent_process_file_dir",
+                "transformer": "ToMSATPDirectoryPath"
+            },
+            {
+                "key": "file.parent_directory_ref",
+                "object": "parent_process_file",
+                "references": "parent_process_file_dir"
+            }
+        ],
+        "InitiatingProcessParentId": {
+            "key": "process.pid",
+            "object": "parent_process",
+            "transformer": "ToInteger"
+        },
+        "InitiatingProcessSHA1": [
+            {
+                "key": "file.hashes.SHA-1",
+                "object": "process_file"
+            },
+            {
+                "key": "process.binary_ref",
+                "object": "process",
+                "references": "process_file"
+            }
+        ],
+        "InitiatingProcessSHA256": [
+            {
+                "key": "file.hashes.SHA-256",
+                "object": "process_file"
+            },
+            {
+                "key": "process.binary_ref",
+                "object": "process",
+                "references": "process_file"
+            }
+        ],
+        "LocalIP": [
+            {
+                "key": "ipv4-addr.value",
+                "object": "src_ip"
+            },
+            {
+                "key": "ipv6-addr.value",
+                "object": "src_ip"
+            },
+            {
+                "key": "network-traffic.src_ref",
+                "object": "nt",
+                "references": "src_ip"
+            },
+            {
+                "group": true,
+                "key": "x-oca-asset.ip_refs",
+                "object": "host",
+                "references": [
+                    "src_ip"
+                ]
+            },
+            {
+                "key": "x-oca-event.network_ref",
+                "object": "event",
+                "references": "nt"
+            }
+        ],
+        "LocalPort": [
+            {
+                "key": "network-traffic.src_port",
+                "object": "nt",
+                "transformer": "ToInteger"
+            },
+            {
+                "key": "x-oca-event.network_ref",
+                "object": "event",
+                "references": "nt"
+            }
+        ],
+        "MD5": {
+            "key": "file.hashes.MD5",
+            "object": "child_process_file"
+        },
+        "MacAddressSet": [
+            {
+                "key": "mac-addr.value",
+                "object": "mac",
+                "transformer": "FormatMacList",
+                "unwrap": true
+            },
+            {
+                "group": true,
+                "key": "x-oca-asset.mac_refs",
+                "object": "host",
+                "references": [
+                    "mac"
+                ],
+                "unwrap": true
+            }
+        ],
+        "OSArchitecture": {
+            "key": "x-oca-asset.architecture",
             "object": "host"
         },
+        "OSPlatform": {
+            "key": "x-oca-asset.os_name",
+            "object": "host"
+        },
+        "OSVersion": {
+            "key": "x-oca-asset.os_version",
+            "object": "host"
+        },
+        "ProcessCommandLine": [
+            {
+                "key": "process.command_line",
+                "object": "child_process"
+            },
+            {
+                "key": "process.child_refs",
+                "object": "process",
+                "references": [
+                    "child_process"
+                ]
+            }
+        ],
+        "ProcessCreationTime": {
+            "key": "process.created",
+            "object": "child_process",
+            "transformer": "MsatpToTimestamp"
+        },
+        "ProcessId": [
+            {
+                "key": "process.pid",
+                "object": "child_process",
+                "transformer": "ToInteger"
+            },
+            {
+                "key": "process.child_refs",
+                "object": "process",
+                "references": [
+                    "child_process"
+                ]
+            },
+            {
+                "key": "x-oca-event.process_ref",
+                "object": "event",
+                "references": "child_process"
+            }
+        ],
+        "PublicIP": [
+            {
+                "key": "ipv4-addr.value",
+                "object": "public-ip"
+            },
+            {
+                "group": true,
+                "key": "x-oca-asset.ip_refs",
+                "object": "host",
+                "references": [
+                    "public-ip"
+                ]
+            }
+        ],
+        "RemoteIP": [
+            {
+                "key": "ipv4-addr.value",
+                "object": "dst_ip"
+            },
+            {
+                "key": "ipv6-addr.value",
+                "object": "dst_ip"
+            },
+            {
+                "key": "network-traffic.dst_ref",
+                "object": "nt",
+                "references": "dst_ip"
+            },
+            {
+                "key": "x-oca-event.network_ref",
+                "object": "event",
+                "references": "nt"
+            }
+        ],
+        "RemotePort": [
+            {
+                "key": "network-traffic.dst_port",
+                "object": "nt",
+                "transformer": "ToInteger"
+            },
+            {
+                "key": "x-oca-event.network_ref",
+                "object": "event",
+                "references": "nt"
+            }
+        ],
+        "RemoteUrl": [
+            {
+                "key": "url.value",
+                "object": "url",
+                "transformer": "IfValidUrl"
+            },
+            {
+                "key": "domain-name.value",
+                "object": "domain-name",
+                "transformer": "GetDomainName"
+            },
+            {
+                "key": "x-oca-event.domain_ref",
+                "object": "event",
+                "references": "domain-name"
+            },
+            {
+                "key": "x-oca-event.url_ref",
+                "object": "event",
+                "references": "url"
+            }
+        ],
+        "ReportId": {
+            "key": "x-msatp.ReportId",
+            "object": "x-msatp"
+        },
+        "SHA1": {
+            "key": "file.hashes.SHA-1",
+            "object": "child_process_file"
+        },
+        "SHA256": {
+            "key": "file.hashes.SHA-256",
+            "object": "child_process_file"
+        },
+        "TableName": {
+            "key": "x-msatp.Table",
+            "object": "x-msatp"
+        },
+        "Timestamp": [
+            {
+                "key": "x-oca-event.created",
+                "object": "event"
+            },
+            {
+                "cybox": false,
+                "key": "first_observed",
+                "transformer": "MsatpToTimestamp"
+            },
+            {
+                "cybox": false,
+                "key": "last_observed",
+                "transformer": "MsatpToTimestamp"
+            }
+        ],
+        "event_count": {
+            "cybox": false,
+            "key": "number_observed",
+            "transformer": "ToInteger"
+        },
+        "event_link": [
+            {
+                "key": "external-reference.url",
+                "object": "device_external_ref"
+            },
+            {
+                "key": "x-oca-event.external_ref",
+                "object": "event",
+                "references": "device_external_ref"
+            }
+        ],
+        "missingChildShouldMapInitiatingPid": {
+            "key": "x-oca-event.missingChildShouldMapInitiatingPid",
+            "object": "event"
+        },
+        "original_ref": [
+            {
+                "key": "artifact.payload_bin",
+                "object": "original_ref",
+                "transformer": "ToBase64"
+            },
+            {
+                "key": "x-oca-event.original_ref",
+                "object": "event",
+                "references": "original_ref"
+            }
+        ],
+        "provider": {
+            "key": "x-oca-event.provider",
+            "object": "event",
+            "value": "Microsoft Defender for Endpoint"
+        }
+    },
+    "DeviceFileEvents": {
+        "ActionType": [
+            {
+                "key": "x-oca-event.action",
+                "object": "event"
+            }
+        ],
+        "AdditionalFields": {
+            "key": "x-msatp.AdditionalFields",
+            "object": "x-msatp",
+            "transformer": "JsonToString"
+        },
+        "Alerts": {
+            "key": "x-json-alert.data"
+        },
+        "DeviceId": [
+            {
+                "key": "x-oca-asset.device_id",
+                "object": "host"
+            },
+            {
+                "key": "x-oca-event.host_ref",
+                "object": "event",
+                "references": "host"
+            }
+        ],
         "DeviceName": [
             {
                 "key": "x-oca-asset.hostname",
                 "object": "host"
             },
             {
                 "key": "x-oca-event.host_ref",
                 "object": "event",
                 "references": "host"
             }
         ],
         "FileName": [
             {
                 "key": "file.name",
-                "object": "file"
+                "object": "file",
+                "transformer": "ToFileName"
             },
             {
                 "key": "x-oca-event.file_ref",
                 "object": "event",
                 "references": "file"
+            },
+            {
+                "key": "directory.path",
+                "object": "file_dir",
+                "transformer": "ToMSATPDirectoryPath"
+            },
+            {
+                "key": "file.parent_directory_ref",
+                "object": "file",
+                "references": "file_dir"
+            }
+        ],
+        "FileOriginIP": [
+            {
+                "key": "ipv4-addr.value",
+                "object": "dst_ip"
+            },
+            {
+                "key": "ipv6-addr.value",
+                "object": "dst_ip"
+            },
+            {
+                "key": "network-traffic.dst_ref",
+                "object": "nt",
+                "references": "dst_ip"
+            },
+            {
+                "key": "x-oca-event.network_ref",
+                "object": "event",
+                "references": "nt"
+            },
+            {
+                "group": true,
+                "key": "x-oca-event.ips_ref",
+                "object": "event",
+                "references": [
+                    "dst_ip"
+                ]
+            }
+        ],
+        "FileOriginReferrerUrl": [
+            {
+                "key": "url.value",
+                "object": "url_ref",
+                "transformer": "IfValidUrl"
+            },
+            {
+                "key": "x-oca-event.url_ref",
+                "object": "event",
+                "references": "url_ref"
+            },
+            {
+                "key": "domain-name.value",
+                "object": "file-origin-ref-domain",
+                "transformer": "GetDomainName"
+            },
+            {
+                "key": "x-oca-event.domain_ref",
+                "object": "event",
+                "references": "file-origin-ref-domain"
             }
         ],
         "FolderPath": [
             {
                 "key": "directory.path",
                 "object": "file_dir",
-                "transformer": "ToDirectoryPath"
+                "transformer": "ToMSATPDirectoryPath"
             },
             {
                 "key": "file.parent_directory_ref",
                 "object": "file",
                 "references": "file_dir"
             }
         ],
+        "IPAddresses": [
+            {
+                "key": "ipv4-addr.value",
+                "object": "host_ip4",
+                "transformer": "FilterIPv4List",
+                "unwrap": true
+            },
+            {
+                "key": "ipv6-addr.value",
+                "object": "host_ip6",
+                "transformer": "FilterIPv6List",
+                "unwrap": true
+            },
+            {
+                "group": true,
+                "key": "x-oca-asset.ip_refs",
+                "object": "host",
+                "references": [
+                    "host_ip4",
+                    "host_ip6"
+                ],
+                "unwrap": true
+            }
+        ],
         "InitiatingProcessAccountName": [
             {
+                "key": "user-account.user_id",
+                "object": "fc_process_creator"
+            },
+            {
+                "key": "process.creator_user_ref",
+                "object": "fc_process",
+                "references": "fc_process_creator"
+            },
+            {
+                "key": "x-oca-event.user_ref",
+                "object": "event",
+                "references": "fc_process_creator"
+            }
+        ],
+        "InitiatingProcessAccountUpn": [
+            {
                 "key": "user-account.account_login",
                 "object": "fc_process_creator"
             },
             {
                 "key": "process.creator_user_ref",
                 "object": "fc_process",
                 "references": "fc_process_creator"
             }
         ],
-        "InitiatingProcessAccountSid": [
+        "InitiatingProcessCommandLine": {
+            "key": "process.command_line",
+            "object": "fc_process"
+        },
+        "InitiatingProcessCreationTime": {
+            "key": "process.created",
+            "object": "fc_process",
+            "transformer": "MsatpToTimestamp"
+        },
+        "InitiatingProcessFileName": [
+            {
+                "key": "file.name",
+                "object": "fc_process_file",
+                "transformer": "ToFileName"
+            },
+            {
+                "key": "process.name",
+                "object": "fc_process",
+                "transformer": "ToFileName"
+            },
+            {
+                "key": "process.binary_ref",
+                "object": "fc_process",
+                "references": "fc_process_file"
+            },
+            {
+                "key": "x-oca-event.process_ref",
+                "object": "event",
+                "references": "fc_process"
+            },
+            {
+                "key": "directory.path",
+                "object": "fc_process_file_dir",
+                "transformer": "ToMSATPDirectoryPath"
+            },
+            {
+                "key": "file.parent_directory_ref",
+                "object": "fc_process_file",
+                "references": "fc_process_file_dir"
+            }
+        ],
+        "InitiatingProcessFolderPath": [
+            {
+                "key": "directory.path",
+                "object": "fc_process_file_dir",
+                "transformer": "ToMSATPDirectoryPath"
+            },
+            {
+                "key": "file.parent_directory_ref",
+                "object": "fc_process_file",
+                "references": "fc_process_file_dir"
+            },
+            {
+                "key": "process.binary_ref",
+                "object": "fc_process",
+                "references": "fc_process_file"
+            }
+        ],
+        "InitiatingProcessId": [
+            {
+                "key": "process.pid",
+                "object": "fc_process",
+                "transformer": "ToInteger"
+            },
+            {
+                "key": "x-oca-event.process_ref",
+                "object": "event",
+                "references": "fc_process"
+            }
+        ],
+        "InitiatingProcessMD5": [
+            {
+                "key": "file.hashes.MD5",
+                "object": "fc_process_file"
+            },
+            {
+                "key": "process.binary_ref",
+                "object": "fc_process",
+                "references": "fc_process_file"
+            }
+        ],
+        "InitiatingProcessParentCreationTime": [
+            {
+                "key": "process.created",
+                "object": "fc_parent_process",
+                "transformer": "MsatpToTimestamp"
+            },
+            {
+                "key": "process.parent_ref",
+                "object": "fc_process",
+                "references": "fc_parent_process"
+            }
+        ],
+        "InitiatingProcessParentFileName": [
+            {
+                "key": "file.name",
+                "object": "fc_parent_process_file",
+                "transformer": "ToFileName"
+            },
+            {
+                "key": "process.name",
+                "object": "fc_parent_process",
+                "transformer": "ToFileName"
+            },
+            {
+                "key": "process.parent_ref",
+                "object": "fc_process",
+                "references": "fc_parent_process"
+            },
+            {
+                "key": "process.binary_ref",
+                "object": "fc_parent_process",
+                "references": "fc_parent_process_file"
+            },
+            {
+                "key": "directory.path",
+                "object": "fc_parent_process_file_dir",
+                "transformer": "ToMSATPDirectoryPath"
+            },
+            {
+                "key": "file.parent_directory_ref",
+                "object": "fc_parent_process_file",
+                "references": "fc_parent_process_file_dir"
+            }
+        ],
+        "InitiatingProcessParentId": [
+            {
+                "key": "process.pid",
+                "object": "fc_parent_process",
+                "transformer": "ToInteger"
+            },
+            {
+                "key": "process.parent_ref",
+                "object": "fc_process",
+                "references": "fc_parent_process"
+            },
+            {
+                "key": "x-oca-event.parent_process_ref",
+                "object": "event",
+                "references": "fc_parent_process"
+            }
+        ],
+        "InitiatingProcessSHA1": [
+            {
+                "key": "file.hashes.SHA-1",
+                "object": "fc_process_file"
+            },
+            {
+                "key": "process.binary_ref",
+                "object": "fc_process",
+                "references": "fc_process_file"
+            }
+        ],
+        "InitiatingProcessSHA256": [
+            {
+                "key": "file.hashes.SHA-256",
+                "object": "fc_process_file"
+            },
+            {
+                "key": "process.binary_ref",
+                "object": "fc_process",
+                "references": "fc_process_file"
+            }
+        ],
+        "MD5": {
+            "key": "file.hashes.MD5",
+            "object": "file"
+        },
+        "MacAddressSet": [
+            {
+                "key": "mac-addr.value",
+                "object": "mac",
+                "transformer": "FormatMacList",
+                "unwrap": true
+            },
+            {
+                "group": true,
+                "key": "x-oca-asset.mac_refs",
+                "object": "host",
+                "references": [
+                    "mac"
+                ],
+                "unwrap": true
+            }
+        ],
+        "OSArchitecture": {
+            "key": "x-oca-asset.architecture",
+            "object": "host"
+        },
+        "OSPlatform": {
+            "key": "x-oca-asset.os_name",
+            "object": "host"
+        },
+        "OSVersion": {
+            "key": "x-oca-asset.os_version",
+            "object": "host"
+        },
+        "PublicIP": [
+            {
+                "key": "ipv4-addr.value",
+                "object": "public-ip"
+            },
+            {
+                "group": true,
+                "key": "x-oca-asset.ip_refs",
+                "object": "host",
+                "references": [
+                    "public-ip"
+                ]
+            }
+        ],
+        "ReportId": {
+            "key": "x-msatp.ReportId",
+            "object": "x-msatp"
+        },
+        "SHA1": {
+            "key": "file.hashes.SHA-1",
+            "object": "file"
+        },
+        "SHA256": {
+            "key": "file.hashes.SHA-256",
+            "object": "file"
+        },
+        "TableName": {
+            "key": "x-msatp.Table",
+            "object": "x-msatp"
+        },
+        "Timestamp": [
+            {
+                "key": "x-oca-event.created",
+                "object": "event"
+            },
+            {
+                "cybox": false,
+                "key": "first_observed",
+                "transformer": "MsatpToTimestamp"
+            },
+            {
+                "cybox": false,
+                "key": "last_observed",
+                "transformer": "MsatpToTimestamp"
+            }
+        ],
+        "event_count": {
+            "cybox": false,
+            "key": "number_observed",
+            "transformer": "ToInteger"
+        },
+        "event_link": [
+            {
+                "key": "external-reference.url",
+                "object": "device_external_ref"
+            },
+            {
+                "key": "x-oca-event.external_ref",
+                "object": "event",
+                "references": "device_external_ref"
+            }
+        ],
+        "original_ref": [
+            {
+                "key": "artifact.payload_bin",
+                "object": "original_ref",
+                "transformer": "ToBase64"
+            },
+            {
+                "key": "x-oca-event.original_ref",
+                "object": "event",
+                "references": "original_ref"
+            }
+        ],
+        "provider": {
+            "key": "x-oca-event.provider",
+            "object": "event",
+            "value": "Microsoft Defender for Endpoint"
+        }
+    },
+    "DeviceImageLoadEvents": {
+        "ActionType": [
+            {
+                "key": "x-oca-event.action",
+                "object": "event"
+            }
+        ],
+        "AdditionalFields": {
+            "key": "x-msatp.AdditionalFields",
+            "object": "x-msatp",
+            "transformer": "JsonToString"
+        },
+        "Alerts": {
+            "key": "x-json-alert.data"
+        },
+        "DeviceId": [
+            {
+                "key": "x-oca-asset.device_id",
+                "object": "host"
+            },
+            {
+                "key": "x-oca-event.host_ref",
+                "object": "event",
+                "references": "host"
+            }
+        ],
+        "DeviceName": [
+            {
+                "key": "x-oca-asset.hostname",
+                "object": "host"
+            },
+            {
+                "key": "x-oca-event.host_ref",
+                "object": "event",
+                "references": "host"
+            }
+        ],
+        "FileName": [
+            {
+                "key": "file.name",
+                "object": "file",
+                "transformer": "ToFileName"
+            },
+            {
+                "key": "x-oca-event.file_ref",
+                "object": "event",
+                "references": "file"
+            },
+            {
+                "key": "directory.path",
+                "object": "file_dir",
+                "transformer": "ToMSATPDirectoryPath"
+            },
+            {
+                "key": "file.parent_directory_ref",
+                "object": "file",
+                "references": "file_dir"
+            }
+        ],
+        "FolderPath": [
+            {
+                "key": "directory.path",
+                "object": "file_dir",
+                "transformer": "ToMSATPDirectoryPath"
+            },
+            {
+                "key": "file.parent_directory_ref",
+                "object": "file",
+                "references": "file_dir"
+            }
+        ],
+        "IPAddresses": [
+            {
+                "key": "ipv4-addr.value",
+                "object": "host_ip4",
+                "transformer": "FilterIPv4List",
+                "unwrap": true
+            },
+            {
+                "key": "ipv6-addr.value",
+                "object": "host_ip6",
+                "transformer": "FilterIPv6List",
+                "unwrap": true
+            },
+            {
+                "group": true,
+                "key": "x-oca-asset.ip_refs",
+                "object": "host",
+                "references": [
+                    "host_ip4",
+                    "host_ip6"
+                ],
+                "unwrap": true
+            }
+        ],
+        "InitiatingProcessAccountName": [
             {
                 "key": "user-account.user_id",
                 "object": "fc_process_creator"
             },
             {
                 "key": "process.creator_user_ref",
                 "object": "fc_process",
@@ -67,43 +1409,71 @@
             },
             {
                 "key": "x-oca-event.user_ref",
                 "object": "event",
                 "references": "fc_process_creator"
             }
         ],
+        "InitiatingProcessAccountUpn": [
+            {
+                "key": "user-account.account_login",
+                "object": "fc_process_creator"
+            },
+            {
+                "key": "process.creator_user_ref",
+                "object": "fc_process",
+                "references": "fc_process_creator"
+            }
+        ],
         "InitiatingProcessCommandLine": {
             "key": "process.command_line",
             "object": "fc_process"
         },
         "InitiatingProcessCreationTime": {
             "key": "process.created",
             "object": "fc_process",
             "transformer": "MsatpToTimestamp"
         },
         "InitiatingProcessFileName": [
             {
                 "key": "file.name",
-                "object": "fc_process_file"
+                "object": "fc_process_file",
+                "transformer": "ToFileName"
             },
             {
                 "key": "process.name",
-                "object": "fc_process"
+                "object": "fc_process",
+                "transformer": "ToFileName"
             },
             {
                 "key": "process.binary_ref",
                 "object": "fc_process",
                 "references": "fc_process_file"
+            },
+            {
+                "key": "x-oca-event.process_ref",
+                "object": "event",
+                "references": "fc_process"
+            },
+            {
+                "key": "directory.path",
+                "object": "fc_process_file_dir",
+                "transformer": "ToMSATPDirectoryPath"
+            },
+            {
+                "key": "file.parent_directory_ref",
+                "object": "fc_process_file",
+                "references": "fc_process_file_dir"
             }
         ],
         "InitiatingProcessFolderPath": [
             {
                 "key": "directory.path",
                 "object": "fc_process_file_dir",
-                "transformer": "ToDirectoryPath"
+                "transformer": "ToMSATPDirectoryPath"
             },
             {
                 "key": "file.parent_directory_ref",
                 "object": "fc_process_file",
                 "references": "fc_process_file_dir"
             },
             {
@@ -146,29 +1516,41 @@
                 "object": "fc_process",
                 "references": "fc_parent_process"
             }
         ],
         "InitiatingProcessParentFileName": [
             {
                 "key": "file.name",
-                "object": "fc_parent_process_file"
+                "object": "fc_parent_process_file",
+                "transformer": "ToFileName"
             },
             {
                 "key": "process.name",
-                "object": "fc_parent_process"
+                "object": "fc_parent_process",
+                "transformer": "ToFileName"
             },
             {
                 "key": "process.parent_ref",
                 "object": "fc_process",
                 "references": "fc_parent_process"
             },
             {
                 "key": "process.binary_ref",
                 "object": "fc_parent_process",
                 "references": "fc_parent_process_file"
+            },
+            {
+                "key": "directory.path",
+                "object": "fc_parent_process_file_dir",
+                "transformer": "ToMSATPDirectoryPath"
+            },
+            {
+                "key": "file.parent_directory_ref",
+                "object": "fc_parent_process_file",
+                "references": "fc_parent_process_file_dir"
             }
         ],
         "InitiatingProcessParentId": [
             {
                 "key": "process.pid",
                 "object": "fc_parent_process",
                 "transformer": "ToInteger"
@@ -206,22 +1588,73 @@
                 "references": "fc_process_file"
             }
         ],
         "MD5": {
             "key": "file.hashes.MD5",
             "object": "file"
         },
+        "MacAddressSet": [
+            {
+                "key": "mac-addr.value",
+                "object": "mac",
+                "transformer": "FormatMacList",
+                "unwrap": true
+            },
+            {
+                "group": true,
+                "key": "x-oca-asset.mac_refs",
+                "object": "host",
+                "references": [
+                    "mac"
+                ],
+                "unwrap": true
+            }
+        ],
+        "OSArchitecture": {
+            "key": "x-oca-asset.architecture",
+            "object": "host"
+        },
+        "OSPlatform": {
+            "key": "x-oca-asset.os_name",
+            "object": "host"
+        },
+        "OSVersion": {
+            "key": "x-oca-asset.os_version",
+            "object": "host"
+        },
+        "PublicIP": [
+            {
+                "key": "ipv4-addr.value",
+                "object": "public-ip"
+            },
+            {
+                "group": true,
+                "key": "x-oca-asset.ip_refs",
+                "object": "host",
+                "references": [
+                    "public-ip"
+                ]
+            }
+        ],
+        "ReportId": {
+            "key": "x-msatp.ReportId",
+            "object": "x-msatp"
+        },
         "SHA1": {
             "key": "file.hashes.SHA-1",
             "object": "file"
         },
         "SHA256": {
             "key": "file.hashes.SHA-256",
             "object": "file"
         },
+        "TableName": {
+            "key": "x-msatp.Table",
+            "object": "x-msatp"
+        },
         "Timestamp": [
             {
                 "key": "x-oca-event.created",
                 "object": "event"
             },
             {
                 "cybox": false,
@@ -234,100 +1667,216 @@
                 "transformer": "MsatpToTimestamp"
             }
         ],
         "event_count": {
             "cybox": false,
             "key": "number_observed",
             "transformer": "ToInteger"
+        },
+        "event_link": [
+            {
+                "key": "external-reference.url",
+                "object": "device_external_ref"
+            },
+            {
+                "key": "x-oca-event.external_ref",
+                "object": "event",
+                "references": "device_external_ref"
+            }
+        ],
+        "original_ref": [
+            {
+                "key": "artifact.payload_bin",
+                "object": "original_ref",
+                "transformer": "ToBase64"
+            },
+            {
+                "key": "x-oca-event.original_ref",
+                "object": "event",
+                "references": "original_ref"
+            }
+        ],
+        "provider": {
+            "key": "x-oca-event.provider",
+            "object": "event",
+            "value": "Microsoft Defender for Endpoint"
         }
     },
     "DeviceNetworkEvents": {
-        "DeviceId": {
-            "key": "x-msatp.machine_id"
+        "ActionType": {
+            "key": "x-oca-event.action",
+            "object": "event"
+        },
+        "AdditionalFields": {
+            "key": "x-msatp.AdditionalFields",
+            "object": "x-msatp",
+            "transformer": "JsonToString"
         },
-        "DeviceName": {
-            "key": "x-msatp.computer_name"
+        "Alerts": {
+            "key": "x-json-alert.data"
         },
+        "DeviceId": [
+            {
+                "key": "x-oca-asset.device_id",
+                "object": "host"
+            },
+            {
+                "key": "x-oca-event.host_ref",
+                "object": "event",
+                "references": "host"
+            }
+        ],
+        "DeviceName": [
+            {
+                "key": "x-oca-asset.hostname",
+                "object": "host"
+            },
+            {
+                "key": "x-oca-event.host_ref",
+                "object": "event",
+                "references": "host"
+            }
+        ],
+        "IPAddresses": [
+            {
+                "key": "ipv4-addr.value",
+                "object": "host_ip4",
+                "transformer": "FilterIPv4List",
+                "unwrap": true
+            },
+            {
+                "key": "ipv6-addr.value",
+                "object": "host_ip6",
+                "transformer": "FilterIPv6List",
+                "unwrap": true
+            },
+            {
+                "group": true,
+                "key": "x-oca-asset.ip_refs",
+                "object": "host",
+                "references": [
+                    "host_ip4",
+                    "host_ip6"
+                ],
+                "unwrap": true
+            }
+        ],
         "InitiatingProcessAccountName": [
             {
-                "key": "user-account.account_login",
+                "key": "user-account.user_id",
                 "object": "nc_process_creator"
             },
             {
                 "key": "process.creator_user_ref",
                 "object": "nc_process",
                 "references": "nc_process_creator"
             }
         ],
-        "InitiatingProcessAccountSid": [
+        "InitiatingProcessAccountUpn": [
             {
-                "key": "user-account.user_id",
+                "key": "user-account.account_login",
                 "object": "nc_process_creator"
             },
             {
                 "key": "process.creator_user_ref",
                 "object": "nc_process",
                 "references": "nc_process_creator"
             }
         ],
-        "InitiatingProcessCommandLine": {
-            "key": "process.command_line",
-            "object": "nc_process"
-        },
+        "InitiatingProcessCommandLine": [
+            {
+                "key": "process.command_line",
+                "object": "nc_process"
+            },
+            {
+                "key": "x-oca-event.process_ref",
+                "object": "event",
+                "references": "nc_process"
+            }
+        ],
         "InitiatingProcessCreationTime": {
             "key": "process.created",
             "object": "nc_process",
             "transformer": "MsatpToTimestamp"
         },
         "InitiatingProcessFileName": [
             {
                 "key": "file.name",
-                "object": "nc_process_file"
+                "object": "nc_process_file",
+                "transformer": "ToFileName"
             },
             {
                 "key": "process.name",
-                "object": "nc_process"
+                "object": "nc_process",
+                "transformer": "ToFileName"
             },
             {
                 "key": "process.binary_ref",
                 "object": "nc_process",
                 "references": "nc_process_file"
+            },
+            {
+                "key": "x-oca-event.process_ref",
+                "object": "event",
+                "references": "nc_process"
+            },
+            {
+                "key": "directory.path",
+                "object": "nc_process_file_dir",
+                "transformer": "ToMSATPDirectoryPath"
+            },
+            {
+                "key": "file.parent_directory_ref",
+                "object": "nc_process_file",
+                "references": "nc_process_file_dir"
             }
         ],
         "InitiatingProcessFolderPath": [
             {
                 "key": "directory.path",
                 "object": "nc_process_file_dir",
-                "transformer": "ToDirectoryPath"
+                "transformer": "ToMSATPDirectoryPath"
             },
             {
                 "key": "file.parent_directory_ref",
                 "object": "nc_process_file",
                 "references": "nc_process_file_dir"
             },
             {
                 "key": "process.binary_ref",
                 "object": "nc_process",
                 "references": "nc_process_file"
             }
         ],
-        "InitiatingProcessId": {
-            "key": "process.pid",
-            "object": "nc_process",
-            "transformer": "ToInteger"
-        },
+        "InitiatingProcessId": [
+            {
+                "key": "process.pid",
+                "object": "nc_process",
+                "transformer": "ToInteger"
+            },
+            {
+                "key": "x-oca-event.process_ref",
+                "object": "event",
+                "references": "nc_process"
+            }
+        ],
         "InitiatingProcessMD5": [
             {
                 "key": "file.hashes.MD5",
                 "object": "nc_process_file"
             },
             {
                 "key": "process.binary_ref",
                 "object": "nc_process",
                 "references": "nc_process_file"
+            },
+            {
+                "key": "x-oca-event.process_ref",
+                "object": "event",
+                "references": "nc_process"
             }
         ],
         "InitiatingProcessParentCreationTime": [
             {
                 "key": "process.created",
                 "object": "nc_parent_process",
                 "transformer": "MsatpToTimestamp"
@@ -337,29 +1886,41 @@
                 "object": "nc_process",
                 "references": "nc_parent_process"
             }
         ],
         "InitiatingProcessParentFileName": [
             {
                 "key": "file.name",
-                "object": "nc_parent_process_file"
+                "object": "nc_parent_process_file",
+                "transformer": "ToFileName"
             },
             {
                 "key": "process.name",
-                "object": "nc_parent_process"
+                "object": "nc_parent_process",
+                "transformer": "ToFileName"
             },
             {
                 "key": "process.parent_ref",
                 "object": "nc_process",
                 "references": "nc_parent_process"
             },
             {
                 "key": "process.binary_ref",
                 "object": "nc_parent_process",
                 "references": "nc_parent_process_file"
+            },
+            {
+                "key": "directory.path",
+                "object": "nc_parent_process_file_dir",
+                "transformer": "ToMSATPDirectoryPath"
+            },
+            {
+                "key": "file.parent_directory_ref",
+                "object": "nc_parent_process_file",
+                "references": "nc_parent_process_file_dir"
             }
         ],
         "InitiatingProcessParentId": [
             {
                 "key": "process.pid",
                 "object": "nc_parent_process",
                 "transformer": "ToInteger"
@@ -375,25 +1936,35 @@
                 "key": "file.hashes.SHA-1",
                 "object": "nc_process_file"
             },
             {
                 "key": "process.binary_ref",
                 "object": "nc_process",
                 "references": "nc_process_file"
+            },
+            {
+                "key": "x-oca-event.process_ref",
+                "object": "event",
+                "references": "nc_process"
             }
         ],
         "InitiatingProcessSHA256": [
             {
                 "key": "file.hashes.SHA-256",
                 "object": "nc_process_file"
             },
             {
                 "key": "process.binary_ref",
                 "object": "nc_process",
                 "references": "nc_process_file"
+            },
+            {
+                "key": "x-oca-event.process_ref",
+                "object": "event",
+                "references": "nc_process"
             }
         ],
         "LocalIP": [
             {
                 "key": "ipv4-addr.value",
                 "object": "src_ip"
             },
@@ -401,21 +1972,39 @@
                 "key": "ipv6-addr.value",
                 "object": "src_ip"
             },
             {
                 "key": "network-traffic.src_ref",
                 "object": "nt",
                 "references": "src_ip"
+            },
+            {
+                "group": true,
+                "key": "x-oca-asset.ip_refs",
+                "object": "host",
+                "references": [
+                    "src_ip"
+                ]
+            },
+            {
+                "key": "x-oca-event.network_ref",
+                "object": "event",
+                "references": "nt"
             }
         ],
         "LocalPort": [
             {
                 "key": "network-traffic.src_port",
                 "object": "nt",
                 "transformer": "ToInteger"
+            },
+            {
+                "key": "x-oca-event.network_ref",
+                "object": "event",
+                "references": "nt"
             }
         ],
         "MacAddress": [
             {
                 "key": "mac-addr.value",
                 "object": "mac",
                 "transformer": "FormatMac"
@@ -434,60 +2023,172 @@
             },
             {
                 "key": "x-oca-event.network_ref",
                 "object": "event",
                 "references": "nt"
             }
         ],
+        "MacAddressSet": [
+            {
+                "key": "mac-addr.value",
+                "object": "mac",
+                "transformer": "FormatMacList",
+                "unwrap": true
+            },
+            {
+                "group": true,
+                "key": "x-oca-asset.mac_refs",
+                "object": "host",
+                "references": [
+                    "mac"
+                ],
+                "unwrap": true
+            }
+        ],
+        "OSArchitecture": {
+            "key": "x-oca-asset.architecture",
+            "object": "host"
+        },
+        "OSPlatform": {
+            "key": "x-oca-asset.os_name",
+            "object": "host"
+        },
+        "OSVersion": {
+            "key": "x-oca-asset.os_version",
+            "object": "host"
+        },
         "Protocol": {
             "key": "network-traffic.protocols",
             "object": "nt",
             "transformer": "FormatTCPProtocol"
         },
+        "PublicIP": [
+            {
+                "key": "ipv4-addr.value",
+                "object": "public-ip"
+            },
+            {
+                "group": true,
+                "key": "x-oca-asset.ip_refs",
+                "object": "host",
+                "references": [
+                    "public-ip"
+                ]
+            }
+        ],
         "RemoteIP": [
             {
                 "key": "ipv4-addr.value",
                 "object": "dst_ip"
             },
             {
                 "key": "ipv6-addr.value",
                 "object": "dst_ip"
             },
             {
                 "key": "network-traffic.dst_ref",
                 "object": "nt",
                 "references": "dst_ip"
+            },
+            {
+                "key": "x-oca-event.network_ref",
+                "object": "event",
+                "references": "nt"
             }
         ],
         "RemotePort": [
             {
                 "key": "network-traffic.dst_port",
                 "object": "nt",
                 "transformer": "ToInteger"
+            },
+            {
+                "key": "x-oca-event.network_ref",
+                "object": "event",
+                "references": "nt"
             }
         ],
-        "RemoteUrl": {
-            "key": "url.value"
+        "RemoteUrl": [
+            {
+                "key": "url.value",
+                "object": "url",
+                "transformer": "IfValidUrl"
+            },
+            {
+                "key": "domain-name.value",
+                "object": "domain-name",
+                "transformer": "GetDomainName"
+            },
+            {
+                "key": "x-oca-event.domain_ref",
+                "object": "event",
+                "references": "domain-name"
+            },
+            {
+                "key": "x-oca-event.url_ref",
+                "object": "event",
+                "references": "url"
+            }
+        ],
+        "ReportId": {
+            "key": "x-msatp.ReportId",
+            "object": "x-msatp"
+        },
+        "TableName": {
+            "key": "x-msatp.Table",
+            "object": "x-msatp"
         },
         "Timestamp": [
             {
+                "key": "x-oca-event.created",
+                "object": "event"
+            },
+            {
                 "cybox": false,
                 "key": "first_observed",
                 "transformer": "MsatpToTimestamp"
             },
             {
                 "cybox": false,
                 "key": "last_observed",
                 "transformer": "MsatpToTimestamp"
             }
         ],
         "event_count": {
             "cybox": false,
             "key": "number_observed",
             "transformer": "ToInteger"
+        },
+        "event_link": [
+            {
+                "key": "external-reference.url",
+                "object": "device_external_ref"
+            },
+            {
+                "key": "x-oca-event.external_ref",
+                "object": "event",
+                "references": "device_external_ref"
+            }
+        ],
+        "original_ref": [
+            {
+                "key": "artifact.payload_bin",
+                "object": "original_ref",
+                "transformer": "ToBase64"
+            },
+            {
+                "key": "x-oca-event.original_ref",
+                "object": "event",
+                "references": "original_ref"
+            }
+        ],
+        "provider": {
+            "key": "x-oca-event.provider",
+            "object": "event",
+            "value": "Microsoft Defender for Endpoint"
         }
     },
     "DeviceNetworkInfo": {
         "IpAddresses": [
             {
                 "key": "ipv4-addr.value",
                 "object": "host_ip",
@@ -521,99 +2222,169 @@
                 "references": "host_mac"
             }
         ]
     },
     "DeviceProcessEvents": {
         "AccountName": [
             {
-                "key": "user-account.account_login",
+                "key": "user-account.user_id",
                 "object": "child_process_creator"
             },
             {
                 "key": "process.creator_user_ref",
                 "object": "child_process",
                 "references": "child_process_creator"
+            },
+            {
+                "key": "x-oca-event.user_ref",
+                "object": "event",
+                "references": "child_process_creator"
             }
         ],
-        "AccountSid": [
+        "AccountUpn": [
             {
-                "key": "user-account.user_id",
+                "key": "user-account.account_login",
                 "object": "child_process_creator"
             },
             {
                 "key": "process.creator_user_ref",
                 "object": "child_process",
                 "references": "child_process_creator"
+            },
+            {
+                "key": "x-oca-event.user_ref",
+                "object": "event",
+                "references": "child_process_creator"
             }
         ],
         "ActionType": [
             {
                 "key": "x-oca-event.action",
                 "object": "event"
             }
         ],
-        "DeviceId": {
-            "key": "x-msatp.machine_id"
+        "AdditionalFields": {
+            "key": "x-msatp.AdditionalFields",
+            "object": "x-msatp",
+            "transformer": "JsonToString"
         },
-        "DeviceName": {
-            "key": "x-msatp.computer_name"
+        "Alerts": {
+            "key": "x-json-alert.data"
         },
+        "DeviceId": [
+            {
+                "key": "x-oca-asset.device_id",
+                "object": "host"
+            },
+            {
+                "key": "x-oca-event.host_ref",
+                "object": "event",
+                "references": "host"
+            }
+        ],
+        "DeviceName": [
+            {
+                "key": "x-oca-asset.hostname",
+                "object": "host"
+            },
+            {
+                "key": "x-oca-event.host_ref",
+                "object": "event",
+                "references": "host"
+            }
+        ],
         "FileName": [
             {
                 "key": "file.name",
-                "object": "child_file"
+                "object": "child_process_file",
+                "transformer": "ToFileName"
             },
             {
                 "key": "process.name",
-                "object": "child_process"
+                "object": "child_process",
+                "transformer": "ToFileName"
             },
             {
                 "key": "process.binary_ref",
                 "object": "child_process",
-                "references": "child_file"
+                "references": "child_process_file"
             },
             {
                 "key": "process.child_refs",
                 "object": "process",
                 "references": [
                     "child_process"
                 ]
             },
             {
                 "key": "x-oca-event.process_ref",
                 "object": "event",
-                "references": "process"
+                "references": "child_process"
+            },
+            {
+                "key": "directory.path",
+                "object": "child_process_file_dir",
+                "transformer": "ToMSATPDirectoryPath"
+            },
+            {
+                "key": "file.parent_directory_ref",
+                "object": "child_process_file",
+                "references": "child_process_file_dir"
             }
         ],
         "FolderPath": [
             {
                 "key": "directory.path",
-                "object": "child_file_dir",
-                "transformer": "ToDirectoryPath"
+                "object": "child_process_file_dir",
+                "transformer": "ToMSATPDirectoryPath"
             },
             {
                 "key": "file.parent_directory_ref",
-                "object": "child_file",
-                "references": "child_file_dir"
+                "object": "child_process_file",
+                "references": "child_process_file_dir"
+            }
+        ],
+        "IPAddresses": [
+            {
+                "key": "ipv4-addr.value",
+                "object": "host_ip4",
+                "transformer": "FilterIPv4List",
+                "unwrap": true
+            },
+            {
+                "key": "ipv6-addr.value",
+                "object": "host_ip6",
+                "transformer": "FilterIPv6List",
+                "unwrap": true
+            },
+            {
+                "group": true,
+                "key": "x-oca-asset.ip_refs",
+                "object": "host",
+                "references": [
+                    "host_ip4",
+                    "host_ip6"
+                ],
+                "unwrap": true
             }
         ],
         "InitiatingProcessAccountName": [
             {
-                "key": "user-account.account_login",
+                "key": "user-account.user_id",
                 "object": "process_creator"
             },
             {
                 "key": "process.creator_user_ref",
                 "object": "process",
                 "references": "process_creator"
             }
         ],
-        "InitiatingProcessAccountSid": [
+        "InitiatingProcessAccountUpn": [
             {
-                "key": "user-account.user_id",
+                "key": "user-account.account_login",
                 "object": "process_creator"
             },
             {
                 "key": "process.creator_user_ref",
                 "object": "process",
                 "references": "process_creator"
             }
@@ -626,48 +2397,72 @@
             "key": "process.created",
             "object": "process",
             "transformer": "MsatpToTimestamp"
         },
         "InitiatingProcessFileName": [
             {
                 "key": "file.name",
-                "object": "process_file"
+                "object": "process_file",
+                "transformer": "ToFileName"
             },
             {
                 "key": "process.name",
-                "object": "process"
+                "object": "process",
+                "transformer": "ToFileName"
             },
             {
                 "key": "process.binary_ref",
                 "object": "process",
                 "references": "process_file"
+            },
+            {
+                "key": "process.parent_ref",
+                "object": "child_process",
+                "references": "process"
+            },
+            {
+                "key": "directory.path",
+                "object": "process_file_dir",
+                "transformer": "ToMSATPDirectoryPath"
+            },
+            {
+                "key": "file.parent_directory_ref",
+                "object": "process_file",
+                "references": "process_file_dir"
             }
         ],
         "InitiatingProcessFolderPath": [
             {
                 "key": "directory.path",
                 "object": "process_file_dir",
-                "transformer": "ToDirectoryPath"
+                "transformer": "ToMSATPDirectoryPath"
             },
             {
                 "key": "file.parent_directory_ref",
                 "object": "process_file",
                 "references": "process_file_dir"
             },
             {
                 "key": "process.binary_ref",
                 "object": "process",
                 "references": "process_file"
             }
         ],
-        "InitiatingProcessId": {
-            "key": "process.pid",
-            "object": "process",
-            "transformer": "ToInteger"
-        },
+        "InitiatingProcessId": [
+            {
+                "key": "process.pid",
+                "object": "process",
+                "transformer": "ToInteger"
+            },
+            {
+                "key": "process.parent_ref",
+                "object": "child_process",
+                "references": "process"
+            }
+        ],
         "InitiatingProcessMD5": [
             {
                 "key": "file.hashes.MD5",
                 "object": "process_file"
             },
             {
                 "key": "process.binary_ref",
@@ -686,43 +2481,48 @@
                 "object": "process",
                 "references": "parent_process"
             }
         ],
         "InitiatingProcessParentFileName": [
             {
                 "key": "file.name",
-                "object": "parent_process_file"
+                "object": "parent_process_file",
+                "transformer": "ToFileName"
             },
             {
                 "key": "process.name",
-                "object": "parent_process"
+                "object": "parent_process",
+                "transformer": "ToFileName"
             },
             {
                 "key": "process.parent_ref",
                 "object": "process",
                 "references": "parent_process"
             },
             {
                 "key": "process.binary_ref",
                 "object": "parent_process",
                 "references": "parent_process_file"
-            }
-        ],
-        "InitiatingProcessParentId": [
+            },
             {
-                "key": "process.pid",
-                "object": "parent_process",
-                "transformer": "ToInteger"
+                "key": "directory.path",
+                "object": "parent_process_file_dir",
+                "transformer": "ToMSATPDirectoryPath"
             },
             {
-                "key": "process.parent_ref",
-                "object": "process",
-                "references": "parent_process"
+                "key": "file.parent_directory_ref",
+                "object": "parent_process_file",
+                "references": "parent_process_file_dir"
             }
         ],
+        "InitiatingProcessParentId": {
+            "key": "process.pid",
+            "object": "parent_process",
+            "transformer": "ToInteger"
+        },
         "InitiatingProcessSHA1": [
             {
                 "key": "file.hashes.SHA-1",
                 "object": "process_file"
             },
             {
                 "key": "process.binary_ref",
@@ -739,43 +2539,63 @@
                 "key": "process.binary_ref",
                 "object": "process",
                 "references": "process_file"
             }
         ],
         "MD5": {
             "key": "file.hashes.MD5",
-            "object": "child_file"
+            "object": "child_process_file"
         },
-        "ProcessCommandLine": [
+        "MacAddressSet": [
             {
-                "key": "process.command_line",
-                "object": "child_process"
+                "key": "mac-addr.value",
+                "object": "mac",
+                "transformer": "FormatMacList",
+                "unwrap": true
             },
             {
-                "key": "process.child_refs",
-                "object": "process",
+                "group": true,
+                "key": "x-oca-asset.mac_refs",
+                "object": "host",
                 "references": [
-                    "child_process"
-                ]
+                    "mac"
+                ],
+                "unwrap": true
             }
         ],
-        "ProcessCreationTime": [
+        "OSArchitecture": {
+            "key": "x-oca-asset.architecture",
+            "object": "host"
+        },
+        "OSPlatform": {
+            "key": "x-oca-asset.os_name",
+            "object": "host"
+        },
+        "OSVersion": {
+            "key": "x-oca-asset.os_version",
+            "object": "host"
+        },
+        "ProcessCommandLine": [
             {
-                "key": "process.created",
-                "object": "child_process",
-                "transformer": "MsatpToTimestamp"
+                "key": "process.command_line",
+                "object": "child_process"
             },
             {
                 "key": "process.child_refs",
                 "object": "process",
                 "references": [
                     "child_process"
                 ]
             }
         ],
+        "ProcessCreationTime": {
+            "key": "process.created",
+            "object": "child_process",
+            "transformer": "MsatpToTimestamp"
+        },
         "ProcessId": [
             {
                 "key": "process.pid",
                 "object": "child_process",
                 "transformer": "ToInteger"
             },
             {
@@ -784,24 +2604,46 @@
                 "references": [
                     "child_process"
                 ]
             },
             {
                 "key": "x-oca-event.process_ref",
                 "object": "event",
-                "references": "process"
+                "references": "child_process"
+            }
+        ],
+        "PublicIP": [
+            {
+                "key": "ipv4-addr.value",
+                "object": "public-ip"
+            },
+            {
+                "group": true,
+                "key": "x-oca-asset.ip_refs",
+                "object": "host",
+                "references": [
+                    "public-ip"
+                ]
             }
         ],
+        "ReportId": {
+            "key": "x-msatp.ReportId",
+            "object": "x-msatp"
+        },
         "SHA1": {
             "key": "file.hashes.SHA-1",
-            "object": "child_file"
+            "object": "child_process_file"
         },
         "SHA256": {
             "key": "file.hashes.SHA-256",
-            "object": "child_file"
+            "object": "child_process_file"
+        },
+        "TableName": {
+            "key": "x-msatp.Table",
+            "object": "x-msatp"
         },
         "Timestamp": [
             {
                 "key": "x-oca-event.created",
                 "object": "event"
             },
             {
@@ -815,52 +2657,119 @@
                 "transformer": "MsatpToTimestamp"
             }
         ],
         "event_count": {
             "cybox": false,
             "key": "number_observed",
             "transformer": "ToInteger"
+        },
+        "event_link": [
+            {
+                "key": "external-reference.url",
+                "object": "device_external_ref"
+            },
+            {
+                "key": "x-oca-event.external_ref",
+                "object": "event",
+                "references": "device_external_ref"
+            }
+        ],
+        "original_ref": [
+            {
+                "key": "artifact.payload_bin",
+                "object": "original_ref",
+                "transformer": "ToBase64"
+            },
+            {
+                "key": "x-oca-event.original_ref",
+                "object": "event",
+                "references": "original_ref"
+            }
+        ],
+        "provider": {
+            "key": "x-oca-event.provider",
+            "object": "event",
+            "value": "Microsoft Defender for Endpoint"
         }
     },
     "DeviceRegistryEvents": {
         "ActionType": [
             {
                 "key": "x-oca-event.action",
                 "object": "event"
             }
         ],
-        "DeviceId": {
-            "key": "x-oca-asset.device_id",
-            "object": "host"
+        "AdditionalFields": {
+            "key": "x-msatp.AdditionalFields",
+            "object": "x-msatp",
+            "transformer": "JsonToString"
+        },
+        "Alerts": {
+            "key": "x-json-alert.data"
         },
+        "DeviceId": [
+            {
+                "key": "x-oca-asset.device_id",
+                "object": "host"
+            },
+            {
+                "key": "x-oca-event.host_ref",
+                "object": "event",
+                "references": "host"
+            }
+        ],
         "DeviceName": [
             {
                 "key": "x-oca-asset.hostname",
                 "object": "host"
             },
             {
                 "key": "x-oca-event.host_ref",
                 "object": "event",
                 "references": "host"
             }
         ],
+        "IPAddresses": [
+            {
+                "key": "ipv4-addr.value",
+                "object": "host_ip4",
+                "transformer": "FilterIPv4List",
+                "unwrap": true
+            },
+            {
+                "key": "ipv6-addr.value",
+                "object": "host_ip6",
+                "transformer": "FilterIPv6List",
+                "unwrap": true
+            },
+            {
+                "group": true,
+                "key": "x-oca-asset.ip_refs",
+                "object": "host",
+                "references": [
+                    "host_ip4",
+                    "host_ip6"
+                ],
+                "unwrap": true
+            }
+        ],
         "InitiatingProcessAccountName": [
             {
-                "key": "user-account.account_login",
+                "key": "user-account.user_id",
                 "object": "re_process_creator"
             },
             {
                 "key": "process.creator_user_ref",
                 "object": "re_process",
                 "references": "re_process_creator"
             }
         ],
-        "InitiatingProcessAccountSid": [
+        "InitiatingProcessAccountUpn": [
             {
-                "key": "user-account.user_id",
+                "key": "user-account.account_login",
                 "object": "re_process_creator"
             },
             {
                 "key": "process.creator_user_ref",
                 "object": "re_process",
                 "references": "re_process_creator"
             }
@@ -873,24 +2782,41 @@
             "key": "process.created",
             "object": "re_process",
             "transformer": "MsatpToTimestamp"
         },
         "InitiatingProcessFileName": [
             {
                 "key": "file.name",
-                "object": "re_process_file"
+                "object": "re_process_file",
+                "transformer": "ToFileName"
             },
             {
                 "key": "process.name",
-                "object": "re_process"
+                "object": "re_process",
+                "transformer": "ToFileName"
             },
             {
                 "key": "process.binary_ref",
                 "object": "re_process",
                 "references": "re_process_file"
+            },
+            {
+                "key": "x-oca-event.process_ref",
+                "object": "event",
+                "references": "re_process"
+            },
+            {
+                "key": "directory.path",
+                "object": "re_process_file_dir",
+                "transformer": "ToDirectoryPath"
+            },
+            {
+                "key": "file.parent_directory_ref",
+                "object": "re_process_file",
+                "references": "re_process_file_dir"
             }
         ],
         "InitiatingProcessFolderPath": [
             {
                 "key": "directory.path",
                 "object": "re_process_file_dir",
                 "transformer": "ToDirectoryPath"
@@ -940,46 +2866,53 @@
                 "object": "re_process",
                 "references": "re_parent_process"
             }
         ],
         "InitiatingProcessParentFileName": [
             {
                 "key": "file.name",
-                "object": "re_parent_process_file"
+                "object": "re_parent_process_file",
+                "transformer": "ToFileName"
             },
             {
                 "key": "process.name",
-                "object": "re_parent_process"
+                "object": "re_parent_process",
+                "transformer": "ToFileName"
             },
             {
                 "key": "process.parent_ref",
                 "object": "re_process",
                 "references": "re_parent_process"
             },
             {
                 "key": "process.binary_ref",
                 "object": "re_parent_process",
                 "references": "re_parent_process_file"
+            },
+            {
+                "key": "directory.path",
+                "object": "re_parent_process_file_dir",
+                "transformer": "ToDirectoryPath"
+            },
+            {
+                "key": "file.parent_directory_ref",
+                "object": "re_parent_process_file",
+                "references": "re_parent_process_file_dir"
             }
         ],
         "InitiatingProcessParentId": [
             {
                 "key": "process.pid",
                 "object": "re_parent_process",
                 "transformer": "ToInteger"
             },
             {
                 "key": "process.parent_ref",
                 "object": "re_process",
                 "references": "re_parent_process"
-            },
-            {
-                "key": "x-oca-event.parent_process_ref",
-                "object": "event",
-                "references": "re_parent_process"
             }
         ],
         "InitiatingProcessSHA1": [
             {
                 "key": "file.hashes.SHA-1",
                 "object": "re_process_file"
             },
@@ -996,23 +2929,81 @@
             },
             {
                 "key": "process.binary_ref",
                 "object": "re_process",
                 "references": "re_process_file"
             }
         ],
-        "RegistryKey": {
-            "key": "windows-registry-key.key",
-            "object": "re_key"
+        "MacAddressSet": [
+            {
+                "key": "mac-addr.value",
+                "object": "mac",
+                "transformer": "FormatMacList",
+                "unwrap": true
+            },
+            {
+                "group": true,
+                "key": "x-oca-asset.mac_refs",
+                "object": "host",
+                "references": [
+                    "mac"
+                ],
+                "unwrap": true
+            }
+        ],
+        "OSArchitecture": {
+            "key": "x-oca-asset.architecture",
+            "object": "host"
+        },
+        "OSPlatform": {
+            "key": "x-oca-asset.os_name",
+            "object": "host"
+        },
+        "OSVersion": {
+            "key": "x-oca-asset.os_version",
+            "object": "host"
         },
+        "PublicIP": [
+            {
+                "key": "ipv4-addr.value",
+                "object": "public-ip"
+            },
+            {
+                "group": true,
+                "key": "x-oca-asset.ip_refs",
+                "object": "host",
+                "references": [
+                    "public-ip"
+                ]
+            }
+        ],
+        "RegistryKey": [
+            {
+                "key": "windows-registry-key.key",
+                "object": "re_key"
+            },
+            {
+                "key": "x-oca-event.registry_ref",
+                "object": "event",
+                "references": "re_key"
+            }
+        ],
         "RegistryValues": {
             "key": "windows-registry-key.values",
             "object": "re_key",
             "transformer": "MsatpToRegistryValue"
         },
+        "ReportId": {
+            "key": "x-msatp.ReportId",
+            "object": "x-msatp"
+        },
+        "TableName": {
+            "key": "x-msatp.Table",
+            "object": "x-msatp"
+        },
         "Timestamp": [
             {
                 "key": "x-oca-event.created",
                 "object": "event"
             },
             {
                 "cybox": false,
@@ -1025,10 +3016,38 @@
                 "transformer": "MsatpToTimestamp"
             }
         ],
         "event_count": {
             "cybox": false,
             "key": "number_observed",
             "transformer": "ToInteger"
+        },
+        "event_link": [
+            {
+                "key": "external-reference.url",
+                "object": "device_external_ref"
+            },
+            {
+                "key": "x-oca-event.external_ref",
+                "object": "event",
+                "references": "device_external_ref"
+            }
+        ],
+        "original_ref": [
+            {
+                "key": "artifact.payload_bin",
+                "object": "original_ref",
+                "transformer": "ToBase64"
+            },
+            {
+                "key": "x-oca-event.original_ref",
+                "object": "event",
+                "references": "original_ref"
+            }
+        ],
+        "provider": {
+            "key": "x-oca-event.provider",
+            "object": "event",
+            "value": "Microsoft Defender for Endpoint"
         }
     }
 }
```

## stix_shifter_modules/msatp/stix_translation/json/stix_2_1/from_stix_map.json

### Pretty-printed

 * *Similarity: 0.7856772648647647%*

 * *Differences: {"'directory'": "{'fields': {'path': {insert: [(4, 'DeviceEvents.FolderPath'), (5, "*

 * *                "'DeviceEvents.InitiatingProcessFolderPath'), (8, "*

 * *                "'DeviceImageLoadEvents.FolderPath'), (9, "*

 * *                "'DeviceImageLoadEvents.InitiatingProcessFolderPath')]}}}",*

 * * "'domain-name'": "{'fields': {'value': ['DeviceNetworkEvents.RemoteUrl', "*

 * *                  "'DeviceEvents.RemoteUrl']}}",*

 * * "'file'": "{'fields': {'name': {insert: [(10, 'DeviceEvents.FileName'), (11, "*

 * *           "'Devic [â€¦]*

```diff
@@ -2,452 +2,562 @@
     "directory": {
         "fields": {
             "path": [
                 "DeviceFileEvents.FolderPath",
                 "DeviceFileEvents.InitiatingProcessFolderPath",
                 "DeviceProcessEvents.FolderPath",
                 "DeviceProcessEvents.InitiatingProcessFolderPath",
+                "DeviceEvents.FolderPath",
+                "DeviceEvents.InitiatingProcessFolderPath",
                 "DeviceNetworkEvents.InitiatingProcessFolderPath",
-                "DeviceRegistryEvents.InitiatingProcessFolderPath"
+                "DeviceRegistryEvents.InitiatingProcessFolderPath",
+                "DeviceImageLoadEvents.FolderPath",
+                "DeviceImageLoadEvents.InitiatingProcessFolderPath"
             ]
         }
     },
     "domain-name": {
         "fields": {
             "value": [
-                "DeviceFileEvents.DeviceName",
-                "DeviceProcessEvents.DeviceName",
-                "DeviceNetworkEvents.DeviceName",
-                "DeviceRegistryEvents.DeviceName",
-                "DeviceEvents.DeviceName",
-                "DeviceInfo.DeviceName",
-                "DeviceAlertEvents.DeviceName",
-                "DeviceImageLoadEvents.DeviceName",
-                "DeviceLogonEvents.DeviceName",
-                "DeviceNetworkInfo.DeviceName"
+                "DeviceNetworkEvents.RemoteUrl",
+                "DeviceEvents.RemoteUrl"
             ]
         }
     },
     "file": {
         "fields": {
             "hashes.'SHA-1'": [
-                "DeviceFileEvents.'SHA1'",
+                "DeviceFileEvents.SHA1",
                 "DeviceFileEvents.InitiatingProcessSHA1",
                 "DeviceProcessEvents.SHA1",
                 "DeviceProcessEvents.InitiatingProcessSHA1",
                 "DeviceNetworkEvents.InitiatingProcessSHA1",
-                "DeviceRegistryEvents.InitiatingProcessSHA1"
+                "DeviceRegistryEvents.InitiatingProcessSHA1",
+                "DeviceEvents.SHA1",
+                "DeviceEvents.InitiatingProcessSHA1",
+                "DeviceImageLoadEvents.SHA1",
+                "DeviceImageLoadEvents.InitiatingProcessSHA1"
             ],
             "hashes.'SHA-256'": [
                 "DeviceFileEvents.SHA256",
                 "DeviceFileEvents.InitiatingProcessSHA256",
                 "DeviceProcessEvents.SHA256",
                 "DeviceProcessEvents.InitiatingProcessSHA256",
                 "DeviceNetworkEvents.InitiatingProcessSHA256",
-                "DeviceRegistryEvents.InitiatingProcessSHA256"
+                "DeviceRegistryEvents.InitiatingProcessSHA256",
+                "DeviceEvents.SHA256",
+                "DeviceEvents.InitiatingProcessSHA256",
+                "DeviceImageLoadEvents.SHA256",
+                "DeviceImageLoadEvents.InitiatingProcessSHA256"
             ],
             "hashes.MD5": [
                 "DeviceFileEvents.MD5",
                 "DeviceFileEvents.InitiatingProcessMD5",
                 "DeviceProcessEvents.MD5",
                 "DeviceProcessEvents.InitiatingProcessMD5",
                 "DeviceNetworkEvents.InitiatingProcessMD5",
-                "DeviceRegistryEvents.InitiatingProcessMD5"
+                "DeviceRegistryEvents.InitiatingProcessMD5",
+                "DeviceEvents.MD5",
+                "DeviceEvents.InitiatingProcessMD5",
+                "DeviceImageLoadEvents.MD5",
+                "DeviceImageLoadEvents.InitiatingProcessMD5"
             ],
             "name": [
                 "DeviceFileEvents.FileName",
                 "DeviceFileEvents.InitiatingProcessFileName",
                 "DeviceFileEvents.InitiatingProcessParentFileName",
                 "DeviceProcessEvents.FileName",
                 "DeviceProcessEvents.InitiatingProcessFileName",
                 "DeviceProcessEvents.InitiatingProcessParentFileName",
                 "DeviceNetworkEvents.InitiatingProcessFileName",
                 "DeviceNetworkEvents.InitiatingProcessParentFileName",
                 "DeviceRegistryEvents.InitiatingProcessFileName",
-                "DeviceRegistryEvents.InitiatingProcessParentFileName"
+                "DeviceRegistryEvents.InitiatingProcessParentFileName",
+                "DeviceEvents.FileName",
+                "DeviceEvents.InitiatingProcessFileName",
+                "DeviceEvents.InitiatingProcessParentFileName",
+                "DeviceImageLoadEvents.FileName",
+                "DeviceImageLoadEvents.InitiatingProcessFileName",
+                "DeviceImageLoadEvents.InitiatingProcessParentFileName"
             ],
             "parent_directory_ref.path": [
                 "DeviceFileEvents.FolderPath",
                 "DeviceFileEvents.InitiatingProcessFolderPath",
                 "DeviceProcessEvents.FolderPath",
                 "DeviceProcessEvents.InitiatingProcessFolderPath",
                 "DeviceNetworkEvents.InitiatingProcessFolderPath",
-                "DeviceRegistryEvents.InitiatingProcessFolderPath"
+                "DeviceRegistryEvents.InitiatingProcessFolderPath",
+                "DeviceEvents.FolderPath",
+                "DeviceEvents.InitiatingProcessFolderPath",
+                "DeviceImageLoadEvents.FolderPath",
+                "DeviceImageLoadEvents.InitiatingProcessFolderPath"
             ]
         }
     },
     "ipv4-addr": {
         "fields": {
             "value": [
                 "DeviceNetworkEvents.LocalIP",
-                "DeviceNetworkEvents.RemoteIP"
+                "DeviceNetworkEvents.RemoteIP",
+                "DeviceEvents.RemoteIP",
+                "DeviceEvents.LocalIP"
             ]
         }
     },
     "ipv6-addr": {
         "fields": {
             "value": [
                 "DeviceNetworkEvents.LocalIP",
-                "DeviceNetworkEvents.RemoteIP"
+                "DeviceNetworkEvents.RemoteIP",
+                "DeviceEvents.RemoteIP",
+                "DeviceEvents.LocalIP"
             ]
         }
     },
     "mac-addr": {
         "fields": {
             "value": [
                 "DeviceNetworkInfo.MacAddress"
             ]
         }
     },
     "network-traffic": {
         "fields": {
             "dst_port": [
-                "DeviceNetworkEvents.RemotePort"
+                "DeviceNetworkEvents.RemotePort",
+                "DeviceEvents.RemotePort"
             ],
             "dst_ref.value": [
-                "DeviceNetworkEvents.RemoteIP"
+                "DeviceNetworkEvents.RemoteIP",
+                "DeviceEvents.RemoteIP"
             ],
             "protocols[*]": [
                 "DeviceNetworkEvents.Protocol"
             ],
             "src_port": [
-                "DeviceNetworkEvents.LocalPort"
+                "DeviceNetworkEvents.LocalPort",
+                "DeviceEvents.LocalPort"
             ],
             "src_ref.value": [
                 "DeviceNetworkEvents.LocalIP",
-                "DeviceNetworkInfo.MacAddress"
+                "DeviceNetworkInfo.MacAddress",
+                "DeviceEvents.LocalIP"
             ]
         }
     },
     "process": {
         "fields": {
-            "child_refs.creator_user_ref.account_login": [
-                "DeviceProcessEvents.AccountName"
+            "binary_ref.hashes.'SHA-1'": [
+                "DeviceProcessEvents.SHA1",
+                "DeviceEvents.SHA1",
+                "DeviceFileEvents.InitiatingProcessSHA1",
+                "DeviceNetworkEvents.InitiatingProcessSHA1",
+                "DeviceRegistryEvents.InitiatingProcessSHA1",
+                "DeviceImageLoadEvents.InitiatingProcessSHA1"
+            ],
+            "binary_ref.hashes.'SHA-256'": [
+                "DeviceProcessEvents.SHA256",
+                "DeviceEvents.SHA256",
+                "DeviceFileEvents.InitiatingProcessSHA256",
+                "DeviceNetworkEvents.InitiatingProcessSHA256",
+                "DeviceRegistryEvents.InitiatingProcessSHA256",
+                "DeviceImageLoadEvents.InitiatingProcessSHA256"
             ],
-            "child_refs.image_ref.hashes.'SHA-1'": [
+            "binary_ref.hashes.MD5": [
+                "DeviceProcessEvents.MD5",
+                "DeviceEvents.MD5",
+                "DeviceFileEvents.InitiatingProcessMD5",
+                "DeviceNetworkEvents.InitiatingProcessMD5",
+                "DeviceRegistryEvents.InitiatingProcessMD5",
+                "DeviceImageLoadEvents.InitiatingProcessMD5"
+            ],
+            "binary_ref.parent_directory_ref.path": [
+                "DeviceProcessEvents.FolderPath",
+                "DeviceEvents.FolderPath",
+                "DeviceNetworkEvents.InitiatingProcessFolderPath",
+                "DeviceRegistryEvents.InitiatingProcessFolderPath",
+                "DeviceFileEvents.InitiatingProcessFolderPath",
+                "DeviceImageLoadEvents.InitiatingProcessFolderPath"
+            ],
+            "child_refs.binary_ref.hashes.'SHA-1'": [
                 "DeviceProcessEvents.SHA1"
             ],
-            "child_refs.image_ref.hashes.'SHA-256'": [
+            "child_refs.binary_ref.hashes.'SHA-256'": [
                 "DeviceProcessEvents.SHA256"
             ],
-            "child_refs.image_ref.hashes.MD5": [
+            "child_refs.binary_ref.hashes.MD5": [
                 "DeviceProcessEvents.MD5"
             ],
-            "child_refs.image_ref.parent_directory_ref.path": [
+            "child_refs.binary_ref.parent_directory_ref.path": [
                 "DeviceProcessEvents.FolderPath"
             ],
+            "child_refs.creator_user_ref.account_login": [
+                "DeviceProcessEvents.AccountName"
+            ],
             "child_refs.pid": [
-                "DeviceProcessEvents.ProcessId",
-                "DeviceProcessEvents.InitiatingProcessId",
-                "DeviceNetworkEvents.InitiatingProcessId",
-                "DeviceRegistryEvents.InitiatingProcessId",
-                "DeviceFileEvents.InitiatingProcessId"
+                "DeviceProcessEvents.ProcessId"
             ],
             "command_line": [
                 "DeviceProcessEvents.ProcessCommandLine",
                 "DeviceProcessEvents.InitiatingProcessCommandLine",
+                "DeviceEvents.ProcessCommandLine",
+                "DeviceEvents.InitiatingProcessCommandLine",
+                "DeviceFileEvents.InitiatingProcessCommandLine",
                 "DeviceNetworkEvents.InitiatingProcessCommandLine",
-                "DeviceRegistryEvents.InitiatingProcessCommandLine"
+                "DeviceRegistryEvents.InitiatingProcessCommandLine",
+                "DeviceImageLoadEvents.InitiatingProcessCommandLine"
             ],
             "created_time": [
                 "DeviceProcessEvents.ProcessCreationTime",
-                "DeviceProcessEvents.InitiatingProcessParentCreationTime",
+                "DeviceEvents.ProcessCreationTime",
                 "DeviceNetworkEvents.InitiatingProcessCreationTime",
-                "DeviceNetworkEvents.InitiatingProcessParentCreationTime",
                 "DeviceRegistryEvents.InitiatingProcessCreationTime",
-                "DeviceRegistryEvents.InitiatingProcessParentCreationTime",
                 "DeviceFileEvents.InitiatingProcessCreationTime",
-                "DeviceFileEvents.InitiatingProcessParentCreationTime"
+                "DeviceImageLoadEvents.InitiatingProcessCreationTime"
             ],
             "creator_user_ref.account_login": [
-                "DeviceProcessEvents.InitiatingProcessAccountName"
+                "DeviceProcessEvents.AccountUpn",
+                "DeviceEvents.AccountUpn",
+                "DeviceNetworkEvents.InitiatingProcessAccountUpn",
+                "DeviceRegistryEvents.InitiatingProcessAccountUpn",
+                "DeviceFileEvents.InitiatingProcessAccountUpn",
+                "DeviceImageLoadEvents.InitiatingProcessAccountUpn"
             ],
             "creator_user_ref.user_id": [
-                "DeviceProcessEvents.AccountSid",
-                "DeviceProcessEvents.InitiatingProcessAccountSid"
+                "DeviceProcessEvents.AccountName",
+                "DeviceEvents.AccountName",
+                "DeviceNetworkEvents.InitiatingProcessAccountName",
+                "DeviceRegistryEvents.InitiatingProcessAccountName",
+                "DeviceFileEvents.InitiatingProcessAccountName",
+                "DeviceImageLoadEvents.InitiatingProcessAccountName"
             ],
-            "image_ref.hashes.'SHA-1'": [
-                "DeviceFileEvents.SHA1",
-                "DeviceFileEvents.InitiatingProcessSHA1",
-                "DeviceProcessEvents.SHA1",
+            "name": [
+                "DeviceProcessEvents.FileName",
+                "DeviceEvents.FileName",
+                "DeviceProcessEvents.InitiatingProcessFileName",
+                "DeviceEvents.InitiatingProcessFileName",
+                "DeviceFileEvents.InitiatingProcessFileName",
+                "DeviceNetworkEvents.InitiatingProcessFileName",
+                "DeviceRegistryEvents.InitiatingProcessFileName",
+                "DeviceImageLoadEvents.InitiatingProcessFileName"
+            ],
+            "parent_ref.binary_ref.hashes.'SHA-1'": [
                 "DeviceProcessEvents.InitiatingProcessSHA1",
-                "DeviceNetworkEvents.InitiatingProcessSHA1",
-                "DeviceRegistryEvents.InitiatingProcessSHA1"
+                "DeviceEvents.InitiatingProcessSHA1"
             ],
-            "image_ref.hashes.'SHA-256'": [
-                "DeviceFileEvents.SHA256",
-                "DeviceFileEvents.InitiatingProcessSHA256",
-                "DeviceProcessEvents.SHA256",
+            "parent_ref.binary_ref.hashes.'SHA-256'": [
                 "DeviceProcessEvents.InitiatingProcessSHA256",
-                "DeviceNetworkEvents.InitiatingProcessSHA256",
-                "DeviceRegistryEvents.InitiatingProcessSHA256"
+                "DeviceEvents.InitiatingProcessSHA256"
             ],
-            "image_ref.hashes.MD5": [
-                "DeviceFileEvents.MD5",
-                "DeviceFileEvents.InitiatingProcessMD5",
-                "DeviceProcessEvents.MD5",
+            "parent_ref.binary_ref.hashes.MD5": [
                 "DeviceProcessEvents.InitiatingProcessMD5",
-                "DeviceNetworkEvents.InitiatingProcessMD5",
-                "DeviceRegistryEvents.InitiatingProcessMD5"
+                "DeviceEvents.InitiatingProcessMD5"
             ],
-            "image_ref.parent_directory_ref.path": [
+            "parent_ref.binary_ref.parent_directory_ref.path": [
                 "DeviceProcessEvents.InitiatingProcessFolderPath",
-                "DeviceNetworkEvents.InitiatingProcessFolderPath",
-                "DeviceRegistryEvents.InitiatingProcessFolderPath",
-                "DeviceFileEvents.InitiatingProcessFolderPath"
+                "DeviceEvents.InitiatingProcessFolderPath"
             ],
             "parent_ref.created_time": [
-                "DeviceProcessEvents.InitiatingProcessParentCreationTime",
+                "DeviceProcessEvents.InitiatingProcessCreationTime",
+                "DeviceEvents.InitiatingProcessCreationTime",
                 "DeviceNetworkEvents.InitiatingProcessParentCreationTime",
                 "DeviceRegistryEvents.InitiatingProcessParentCreationTime",
-                "DeviceFileEvents.InitiatingProcessParentCreationTime"
+                "DeviceFileEvents.InitiatingProcessParentCreationTime",
+                "DeviceImageLoadEvents.InitiatingProcessParentCreationTime"
+            ],
+            "parent_ref.creator_user_ref.account_login": [
+                "DeviceProcessEvents.InitiatingProcessAccountUpn",
+                "DeviceEvents.InitiatingProcessAccountUpn"
+            ],
+            "parent_ref.creator_user_ref.user_id": [
+                "DeviceProcessEvents.InitiatingProcessAccountName",
+                "DeviceEvents.InitiatingProcessAccountName"
             ],
             "parent_ref.name": [
                 "DeviceProcessEvents.InitiatingProcessFileName",
-                "DeviceProcessEvents.InitiatingProcessFileName",
-                "DeviceNetworkEvents.InitiatingProcessFileName",
-                "DeviceRegistryEvents.InitiatingProcessFileName",
-                "DeviceProcessEvents.InitiatingProcessParentFileName",
-                "DeviceProcessEvents.InitiatingProcessParentFileName",
+                "DeviceEvents.InitiatingProcessFileName",
+                "DeviceFileEvents.InitiatingProcessParentFileName",
                 "DeviceNetworkEvents.InitiatingProcessParentFileName",
-                "DeviceRegistryEvents.InitiatingProcessParentFileName"
+                "DeviceRegistryEvents.InitiatingProcessParentFileName",
+                "DeviceImageLoadEvents.InitiatingProcessParentFileName"
+            ],
+            "parent_ref.parent_ref.created_time": [
+                "DeviceProcessEvents.InitiatingProcessParentCreationTime",
+                "DeviceEvents.InitiatingProcessParentCreationTime"
+            ],
+            "parent_ref.parent_ref.name": [
+                "DeviceProcessEvents.InitiatingProcessParentFileName",
+                "DeviceEvents.InitiatingProcessParentFileName"
+            ],
+            "parent_ref.parent_ref.pid": [
+                "DeviceProcessEvents.InitiatingProcessParentId",
+                "DeviceNetworkEvents.InitiatingProcessParentId"
             ],
             "parent_ref.pid": [
                 "DeviceProcessEvents.InitiatingProcessId",
                 "DeviceNetworkEvents.InitiatingProcessId",
-                "DeviceRegistryEvents.InitiatingProcessId",
-                "DeviceFileEvents.InitiatingProcessId",
-                "DeviceProcessEvents.InitiatingProcessParentId",
-                "DeviceNetworkEvents.InitiatingProcessParentId",
                 "DeviceRegistryEvents.InitiatingProcessParentId",
-                "DeviceFileEvents.InitiatingProcessParentId"
+                "DeviceFileEvents.InitiatingProcessParentId",
+                "DeviceEvents.InitiatingProcessParentId",
+                "DeviceImageLoadEvents.InitiatingProcessParentId"
             ],
             "pid": [
                 "DeviceProcessEvents.ProcessId",
+                "DeviceEvents.ProcessId",
+                "DeviceProcessEvents.InitiatingProcessId",
+                "DeviceEvents.InitiatingProcessId",
                 "DeviceProcessEvents.InitiatingProcessId",
-                "DeviceProcessEvents.InitiatingProcessParentId",
                 "DeviceNetworkEvents.InitiatingProcessId",
-                "DeviceNetworkEvents.InitiatingProcessParentId",
                 "DeviceRegistryEvents.InitiatingProcessId",
-                "DeviceRegistryEvents.InitiatingProcessParentId",
                 "DeviceFileEvents.InitiatingProcessId",
-                "DeviceFileEvents.InitiatingProcessParentId"
+                "DeviceImageLoadEvents.InitiatingProcessId"
             ]
         }
     },
     "url": {
         "fields": {
             "value": [
-                "DeviceNetworkEvents.RemoteUrl"
+                "DeviceNetworkEvents.RemoteUrl",
+                "DeviceEvents.RemoteUrl",
+                "DeviceFileEvents.FileOriginUrl",
+                "DeviceFileEvents.FileOriginReferrerUrl"
             ]
         }
     },
     "user-account": {
         "fields": {
             "account_login": [
-                "DeviceProcessEvents.AccountName",
-                "DeviceNetworkEvents.InitiatingProcessAccountName",
-                "DeviceRegistryEvents.InitiatingProcessAccountName"
+                "DeviceProcessEvents.AccountUpn",
+                "DeviceEvents.AccountUpn",
+                "DeviceProcessEvents.InitiatingProcessAccountUpn",
+                "DeviceNetworkEvents.InitiatingProcessAccountUpn",
+                "DeviceRegistryEvents.InitiatingProcessAccountUpn",
+                "DeviceFileEvents.InitiatingProcessAccountUpn",
+                "DeviceEvents.InitiatingProcessAccountUpn",
+                "DeviceImageLoadEvents.InitiatingProcessAccountUpn"
             ],
             "user_id": [
-                "DeviceProcessEvents.AccountSid",
-                "DeviceNetworkEvents.InitiatingProcessAccountSid",
-                "DeviceRegistryEvents.InitiatingProcessAccountSid"
+                "DeviceProcessEvents.AccountName",
+                "DeviceFileEvents.RequestAccountName",
+                "DeviceEvents.AccountName",
+                "DeviceProcessEvents.InitiatingProcessAccountName",
+                "DeviceNetworkEvents.InitiatingProcessAccountName",
+                "DeviceRegistryEvents.InitiatingProcessAccountName",
+                "DeviceFileEvents.InitiatingProcessAccountName",
+                "DeviceEvents.InitiatingProcessAccountName",
+                "DeviceImageLoadEvents.InitiatingProcessAccountName"
             ]
         }
     },
     "windows-registry-key": {
         "fields": {
             "key": [
-                "DeviceRegistryEvents.RegistryKey"
+                "DeviceRegistryEvents.RegistryKey",
+                "DeviceEvents.RegistryKey"
             ],
             "values[*]": [
-                "DeviceRegistryEvents.RegistryValueName"
+                "DeviceRegistryEvents.RegistryValueName",
+                "DeviceEvents.RegistryValueName"
             ]
         }
     },
-    "x-msatp": {
+    "x-ibm-finding": {
         "fields": {
-            "computer_name": [
-                "DeviceProcessEvents.DeviceName",
-                "DeviceNetworkEvents.DeviceName",
-                "DeviceRegistryEvents.DeviceName",
-                "DeviceFileEvents.DeviceName"
+            "alert_id": [
+                "DeviceAlertEvents.AlertId"
             ],
-            "machine_id": [
-                "DeviceProcessEvents.DeviceId",
-                "DeviceNetworkEvents.DeviceId",
-                "DeviceRegistryEvents.DeviceId",
-                "DeviceFileEvents.DeviceId"
+            "name": [
+                "DeviceAlertEvents.Title"
+            ],
+            "time_observed": [
+                "DeviceAlertEvents.Timestamp"
             ]
         }
     },
     "x-oca-asset": {
         "fields": {
-            "domain": [
-                "DeviceFileEvents.DeviceName",
-                "DeviceProcessEvents.DeviceName",
-                "DeviceNetworkEvents.DeviceName",
-                "DeviceRegistryEvents.DeviceName",
-                "DeviceEvents.DeviceName",
-                "DeviceInfo.DeviceName",
-                "DeviceAlertEvents.DeviceName",
-                "DeviceImageLoadEvents.DeviceName",
-                "DeviceLogonEvents.DeviceName",
-                "DeviceNetworkInfo.DeviceName"
+            "device_id": [
+                "DeviceFileEvents.DeviceId",
+                "DeviceProcessEvents.DeviceId",
+                "DeviceNetworkEvents.DeviceId",
+                "DeviceRegistryEvents.DeviceId",
+                "DeviceEvents.DeviceId",
+                "DeviceImageLoadEvents.DeviceId",
+                "DeviceLogonEvents.DeviceId"
             ],
             "hostname": [
                 "DeviceFileEvents.DeviceName",
                 "DeviceProcessEvents.DeviceName",
                 "DeviceNetworkEvents.DeviceName",
                 "DeviceRegistryEvents.DeviceName",
                 "DeviceEvents.DeviceName",
-                "DeviceInfo.DeviceName",
-                "DeviceAlertEvents.DeviceName",
                 "DeviceImageLoadEvents.DeviceName",
-                "DeviceLogonEvents.DeviceName",
-                "DeviceNetworkInfo.DeviceName"
+                "DeviceLogonEvents.DeviceName"
             ],
-            "ip": [
+            "ip_refs[*].value": [
                 "DeviceNetworkEvents.LocalIP"
             ],
-            "name": [
-                "DeviceFileEvents.DeviceName",
-                "DeviceProcessEvents.DeviceName",
-                "DeviceNetworkEvents.DeviceName",
-                "DeviceRegistryEvents.DeviceName",
-                "DeviceEvents.DeviceName",
-                "DeviceInfo.DeviceName",
-                "DeviceAlertEvents.DeviceName",
-                "DeviceImageLoadEvents.DeviceName",
-                "DeviceLogonEvents.DeviceName",
-                "DeviceNetworkInfo.DeviceName"
-            ],
             "os.name": [
                 "DeviceInfo.OSPlatform"
             ],
             "os.platform": [
                 "DeviceInfo.OSPlatform"
             ]
         }
     },
     "x-oca-event": {
         "fields": {
+            "action": [
+                "DeviceProcessEvents.ActionType",
+                "DeviceEvents.ActionType",
+                "DeviceNetworkEvents.ActionType",
+                "DeviceRegistryEvents.ActionType",
+                "DeviceFileEvents.ActionType",
+                "DeviceImageLoadEvents.ActionType"
+            ],
             "domain_ref.value": [
-                "DeviceProcessEvents.DeviceName",
-                "DeviceNetworkEvents.DeviceName",
-                "DeviceRegistryEvents.DeviceName",
-                "DeviceFileEvents.DeviceName"
+                "DeviceNetworkEvents.RemoteUrl",
+                "DeviceEvents.RemoteUrl"
             ],
             "file_ref.name": [
-                "DeviceProcessEvents.InitiatingProcessFileName",
-                "DeviceNetworkEvents.InitiatingProcessFileName",
-                "DeviceRegistryEvents.InitiatingProcessFileName"
+                "DeviceFileEvents.FileName",
+                "DeviceImageLoadEvents.FileName"
             ],
-            "host_ref.hostname": [
-                "DeviceFileEvents.DeviceName",
-                "DeviceProcessEvents.DeviceName",
-                "DeviceNetworkEvents.DeviceName",
-                "DeviceRegistryEvents.DeviceName",
-                "DeviceEvents.DeviceName",
-                "DeviceInfo.DeviceName",
-                "DeviceAlertEvents.DeviceName",
-                "DeviceImageLoadEvents.DeviceName",
-                "DeviceLogonEvents.DeviceName",
-                "DeviceNetworkInfo.DeviceName"
+            "host_ref.device_id": [
+                "DeviceFileEvents.DeviceId",
+                "DeviceProcessEvents.DeviceId",
+                "DeviceNetworkEvents.DeviceId",
+                "DeviceRegistryEvents.DeviceId",
+                "DeviceEvents.DeviceId",
+                "DeviceImageLoadEvents.DeviceId",
+                "DeviceLogonEvents.DeviceId"
             ],
-            "host_ref.name": [
+            "host_ref.hostname": [
                 "DeviceFileEvents.DeviceName",
                 "DeviceProcessEvents.DeviceName",
                 "DeviceNetworkEvents.DeviceName",
                 "DeviceRegistryEvents.DeviceName",
                 "DeviceEvents.DeviceName",
-                "DeviceInfo.DeviceName",
-                "DeviceAlertEvents.DeviceName",
                 "DeviceImageLoadEvents.DeviceName",
-                "DeviceLogonEvents.DeviceName",
-                "DeviceNetworkInfo.DeviceName"
+                "DeviceLogonEvents.DeviceName"
             ],
             "parent_process_ref.name": [
-                "DeviceProcessEvents.InitiatingProcessParentFileName",
+                "DeviceProcessEvents.InitiatingProcessFileName",
+                "DeviceEvents.InitiatingProcessFileName",
                 "DeviceNetworkEvents.InitiatingProcessParentFileName",
                 "DeviceRegistryEvents.InitiatingProcessParentFileName",
-                "DeviceFileEvents.InitiatingProcessParentFileName"
+                "DeviceFileEvents.InitiatingProcessParentFileName",
+                "DeviceImageLoadEvents.InitiatingProcessParentFileName"
             ],
             "parent_process_ref.pid": [
-                "DeviceProcessEvents.InitiatingProcessParentId",
+                "DeviceProcessEvents.InitiatingProcessId",
+                "DeviceEvents.InitiatingProcessId",
                 "DeviceNetworkEvents.InitiatingProcessParentId",
                 "DeviceRegistryEvents.InitiatingProcessParentId",
-                "DeviceFileEvents.InitiatingProcessParentId"
-            ],
-            "process_ref.child_refs.name": [
-                "DeviceProcessEvents.FileName"
-            ],
-            "process_ref.child_refs.pid": [
-                "DeviceProcessEvents.ProcessId"
+                "DeviceFileEvents.InitiatingProcessParentId",
+                "DeviceImageLoadEvents.InitiatingProcessParentId"
             ],
-            "process_ref.command_line": [
-                "DeviceProcessEvents.InitiatingProcessCommandLine",
-                "DeviceNetworkEvents.InitiatingProcessCommandLine",
-                "DeviceRegistryEvents.InitiatingProcessCommandLine",
-                "DeviceFileEvents.InitiatingProcessCommandLine"
-            ],
-            "process_ref.creator_user_ref.account_login": [
-                "DeviceProcessEvents.AccountName"
-            ],
-            "process_ref.creator_user_ref.user_id": [
-                "DeviceProcessEvents.InitiatingProcessAccountSid",
-                "DeviceNetworkEvents.InitiatingProcessAccountSid",
-                "DeviceRegistryEvents.InitiatingProcessAccountSid",
-                "DeviceFileEvents.InitiatingProcessAccountSid"
+            "process_ref.binary_ref.hashes.'SHA-1'": [
+                "DeviceProcessEvents.SHA1",
+                "DeviceEvents.SHA1",
+                "DeviceNetworkEvents.InitiatingProcessSHA1",
+                "DeviceRegistryEvents.InitiatingProcessSHA1",
+                "DeviceFileEvents.InitiatingProcessSHA1",
+                "DeviceImageLoadEvents.InitiatingProcessSHA1"
             ],
-            "process_ref.image_ref.hashes.'SHA-256'": [
-                "DeviceProcessEvents.InitiatingProcessSHA256",
+            "process_ref.binary_ref.hashes.'SHA-256'": [
+                "DeviceProcessEvents.SHA256",
+                "DeviceEvents.SHA256",
                 "DeviceNetworkEvents.InitiatingProcessSHA256",
                 "DeviceRegistryEvents.InitiatingProcessSHA256",
-                "DeviceFileEvents.InitiatingProcessSHA256"
+                "DeviceFileEvents.InitiatingProcessSHA256",
+                "DeviceImageLoadEvents.InitiatingProcessSHA256"
             ],
-            "process_ref.image_ref.hashes.MD5": [
-                "DeviceProcessEvents.InitiatingProcessMD5",
+            "process_ref.binary_ref.hashes.MD5": [
+                "DeviceProcessEvents.MD5",
+                "DeviceEvents.MD5",
                 "DeviceNetworkEvents.InitiatingProcessMD5",
                 "DeviceRegistryEvents.InitiatingProcessMD5",
-                "DeviceFileEvents.InitiatingProcessMD5"
+                "DeviceFileEvents.InitiatingProcessMD5",
+                "DeviceImageLoadEvents.InitiatingProcessMD5"
             ],
-            "process_ref.image_ref.name": [
-                "DeviceProcessEvents.InitiatingProcessFileName",
+            "process_ref.binary_ref.name": [
+                "DeviceProcessEvents.FileName",
+                "DeviceEvents.FileName",
                 "DeviceNetworkEvents.InitiatingProcessFileName",
                 "DeviceRegistryEvents.InitiatingProcessFileName",
-                "DeviceFileEvents.InitiatingProcessFileName"
+                "DeviceFileEvents.InitiatingProcessFileName",
+                "DeviceImageLoadEvents.InitiatingProcessFileName"
+            ],
+            "process_ref.command_line": [
+                "DeviceProcessEvents.ProcessCommandLine",
+                "DeviceEvents.ProcessCommandLine",
+                "DeviceNetworkEvents.InitiatingProcessCommandLine",
+                "DeviceRegistryEvents.InitiatingProcessCommandLine",
+                "DeviceFileEvents.InitiatingProcessCommandLine",
+                "DeviceImageLoadEvents.InitiatingProcessCommandLine"
+            ],
+            "process_ref.creator_user_ref.account_login": [
+                "DeviceProcessEvents.AccountUpn",
+                "DeviceEvents.AccountUpn",
+                "DeviceNetworkEvents.InitiatingProcessAccountUpn",
+                "DeviceRegistryEvents.InitiatingProcessAccountUpn",
+                "DeviceFileEvents.InitiatingProcessAccountUpn",
+                "DeviceImageLoadEvents.InitiatingProcessAccountUpn"
+            ],
+            "process_ref.creator_user_ref.user_id": [
+                "DeviceProcessEvents.AccountName",
+                "DeviceEvents.AccountName",
+                "DeviceNetworkEvents.InitiatingProcessAccountName",
+                "DeviceRegistryEvents.InitiatingProcessAccountName",
+                "DeviceFileEvents.InitiatingProcessAccountName",
+                "DeviceImageLoadEvents.InitiatingProcessAccountName"
             ],
             "process_ref.name": [
-                "DeviceProcessEvents.InitiatingProcessFileName",
+                "DeviceProcessEvents.FileName",
+                "DeviceEvents.FileName",
                 "DeviceNetworkEvents.InitiatingProcessFileName",
                 "DeviceRegistryEvents.InitiatingProcessFileName",
-                "DeviceFileEvents.InitiatingProcessFileName"
+                "DeviceFileEvents.InitiatingProcessFileName",
+                "DeviceImageLoadEvents.InitiatingProcessFileName"
+            ],
+            "process_ref.parent_ref.command_line": [
+                "DeviceProcessEvents.InitiatingProcessCommandLine",
+                "DeviceEvents.InitiatingProcessCommandLine"
             ],
             "process_ref.parent_ref.name": [
-                "DeviceProcessEvents.InitiatingProcessParentFileName",
+                "DeviceProcessEvents.InitiatingProcessFileName",
+                "DeviceEvents.InitiatingProcessFileName",
                 "DeviceNetworkEvents.InitiatingProcessParentFileName",
                 "DeviceRegistryEvents.InitiatingProcessParentFileName",
-                "DeviceFileEvents.InitiatingProcessParentFileName"
+                "DeviceFileEvents.InitiatingProcessParentFileName",
+                "DeviceImageLoadEvents.InitiatingProcessParentFileName"
             ],
             "process_ref.parent_ref.pid": [
-                "DeviceProcessEvents.InitiatingProcessParentId",
+                "DeviceProcessEvents.InitiatingProcessId",
+                "DeviceEvents.InitiatingProcessId",
                 "DeviceNetworkEvents.InitiatingProcessParentId",
                 "DeviceRegistryEvents.InitiatingProcessParentId",
-                "DeviceFileEvents.InitiatingProcessParentId"
+                "DeviceFileEvents.InitiatingProcessParentId",
+                "DeviceImageLoadEvents.InitiatingProcessParentId"
             ],
             "process_ref.pid": [
-                "DeviceProcessEvents.InitiatingProcessId",
+                "DeviceProcessEvents.ProcessId",
+                "DeviceEvents.ProcessId",
                 "DeviceNetworkEvents.InitiatingProcessId",
                 "DeviceRegistryEvents.InitiatingProcessId",
-                "DeviceFileEvents.InitiatingProcessId"
-            ],
-            "process_ref.process_ref.creator_user_ref.account_login": [
-                "DeviceProcessEvents.AccountName"
+                "DeviceFileEvents.InitiatingProcessId",
+                "DeviceImageLoadEvents.InitiatingProcessId"
             ],
             "registry_ref.key": [
                 "DeviceRegistryEvents.RegistryKey"
+            ],
+            "url_ref.value": [
+                "DeviceNetworkEvents.RemoteUrl",
+                "DeviceEvents.RemoteUrl",
+                "DeviceEvents.FileOriginUrl",
+                "DeviceFileEvents.FileOriginUrl",
+                "DeviceFileEvents.FileOriginReferrerUrl"
             ]
         }
     }
 }
```

## stix_shifter_modules/msatp/stix_translation/json/stix_2_1/to_stix_map.json

### Pretty-printed

 * *Similarity: 0.500397460682494%*

 * *Differences: {"'DeviceAlertEvents'": "OrderedDict([('AlertId', [OrderedDict([('key', 'x-ibm-finding.alert_id'), "*

 * *                        "('object', 'finding')]), OrderedDict([('key', "*

 * *                        "'x-oca-event.finding_refs'), ('object', 'event'), ('references', "*

 * *                        "['finding']), ('group', True)])]), ('Severity', OrderedDict([('key', "*

 * *                        "'x-ibm-finding.severity'), ('object', 'finding'), ('transformer', "*

 * *                        "'SeverityToNumericVal')])), ('At [â€¦]*

```diff
@@ -1,65 +1,1382 @@
 {
-    "DeviceFileEvents": {
+    "DeviceAlertEvents": {
+        "AlertId": [
+            {
+                "key": "x-ibm-finding.alert_id",
+                "object": "finding"
+            },
+            {
+                "group": true,
+                "key": "x-oca-event.finding_refs",
+                "object": "event",
+                "references": [
+                    "finding"
+                ]
+            }
+        ],
+        "AttackTechniques": [
+            {
+                "key": "x-ibm-ttp-tagging.extensions.mitre-attack-ext.technique_name",
+                "object": "ttp_tagging",
+                "unwrap": true
+            },
+            {
+                "group": true,
+                "key": "x-ibm-finding.ttp_tagging_refs",
+                "object": "finding",
+                "references": [
+                    "ttp_tagging"
+                ],
+                "unwrap": true
+            }
+        ],
+        "Category": [
+            {
+                "key": "x-ibm-ttp-tagging.kill_chain_phases.phase_name",
+                "object": "ttp_tagging_phase"
+            },
+            {
+                "group": true,
+                "key": "x-ibm-finding.ttp_tagging_refs",
+                "object": "finding",
+                "references": [
+                    "ttp_tagging_phase"
+                ],
+                "unwrap": true
+            }
+        ],
+        "DeviceId": [
+            {
+                "key": "x-oca-asset.device_id",
+                "object": "host"
+            },
+            {
+                "key": "x-oca-event.host_ref",
+                "object": "event",
+                "references": "host"
+            }
+        ],
+        "DeviceName": [
+            {
+                "key": "x-oca-asset.hostname",
+                "object": "host"
+            },
+            {
+                "key": "x-oca-event.host_ref",
+                "object": "event",
+                "references": "host"
+            }
+        ],
+        "FileName": [
+            {
+                "key": "file.name",
+                "object": "file",
+                "transformer": "ToFileName"
+            },
+            {
+                "key": "x-oca-event.file_ref",
+                "object": "event",
+                "references": "file"
+            },
+            {
+                "key": "directory.path",
+                "object": "file_dir",
+                "transformer": "ToMSATPDirectoryPath"
+            },
+            {
+                "key": "file.parent_directory_ref",
+                "object": "file",
+                "references": "file_dir"
+            }
+        ],
+        "MD5": {
+            "key": "file.hashes.MD5",
+            "object": "file"
+        },
+        "RemoteIP": [
+            {
+                "key": "ipv4-addr.value",
+                "object": "dst_ip"
+            },
+            {
+                "key": "ipv6-addr.value",
+                "object": "dst_ip"
+            },
+            {
+                "key": "network-traffic.dst_ref",
+                "object": "nt",
+                "references": "dst_ip"
+            },
+            {
+                "key": "x-oca-event.network_ref",
+                "object": "event",
+                "references": "nt"
+            },
+            {
+                "group": true,
+                "key": "x-oca-event.ip_refs",
+                "object": "event",
+                "references": [
+                    "dst_ip"
+                ]
+            },
+            {
+                "group": true,
+                "key": "x-ibm-finding.ioc_refs",
+                "object": "finding",
+                "references": [
+                    "dst_ip"
+                ]
+            }
+        ],
+        "RemoteUrl": [
+            {
+                "key": "url.value",
+                "object": "url",
+                "transformer": "IfValidUrl"
+            },
+            {
+                "key": "domain-name.value",
+                "object": "domain-name",
+                "transformer": "GetDomainName"
+            },
+            {
+                "key": "x-oca-event.domain_ref",
+                "object": "event",
+                "references": "domain-name"
+            },
+            {
+                "key": "x-oca-event.url_ref",
+                "object": "event",
+                "references": "url"
+            },
+            {
+                "group": true,
+                "key": "x-ibm-finding.ioc_refs",
+                "object": "finding",
+                "references": [
+                    "url",
+                    "domain-name"
+                ]
+            }
+        ],
+        "ReportId": {
+            "key": "x-msatp.ReportId",
+            "object": "x-msatp"
+        },
+        "SHA1": {
+            "key": "file.hashes.SHA-1",
+            "object": "file"
+        },
+        "SHA256": {
+            "key": "file.hashes.SHA-256",
+            "object": "file"
+        },
+        "Severity": {
+            "key": "x-ibm-finding.severity",
+            "object": "finding",
+            "transformer": "SeverityToNumericVal"
+        },
+        "TableName": {
+            "key": "x-msatp.Table",
+            "object": "x-msatp"
+        },
+        "Timestamp": [
+            {
+                "key": "x-oca-event.created",
+                "object": "event"
+            },
+            {
+                "key": "x-ibm-finding.time_observed",
+                "object": "finding"
+            },
+            {
+                "cybox": false,
+                "key": "first_observed",
+                "transformer": "MsatpToTimestamp"
+            },
+            {
+                "cybox": false,
+                "key": "last_observed",
+                "transformer": "MsatpToTimestamp"
+            }
+        ],
+        "Title": [
+            {
+                "key": "x-ibm-finding.name",
+                "object": "finding"
+            },
+            {
+                "key": "x-oca-event.action",
+                "object": "event"
+            },
+            {
+                "key": "x-oca-event.category",
+                "object": "event",
+                "transformer": "Alert"
+            },
+            {
+                "key": "x-ibm-finding.finding_type",
+                "object": "finding",
+                "transformer": "Alert"
+            }
+        ],
+        "event_count": {
+            "cybox": false,
+            "key": "number_observed",
+            "transformer": "ToInteger"
+        },
+        "event_link": [
+            {
+                "key": "external-reference.url",
+                "object": "device_external_ref"
+            },
+            {
+                "key": "x-oca-event.external_ref",
+                "object": "event",
+                "references": "device_external_ref"
+            }
+        ],
+        "original_ref": [
+            {
+                "key": "artifact.payload_bin",
+                "object": "original_ref",
+                "transformer": "ToBase64"
+            },
+            {
+                "key": "x-oca-event.original_ref",
+                "object": "event",
+                "references": "original_ref"
+            }
+        ],
+        "provider": {
+            "key": "x-oca-event.provider",
+            "object": "event",
+            "value": "Microsoft Defender for Endpoint"
+        }
+    },
+    "DeviceEvents": {
+        "AccountName": [
+            {
+                "key": "user-account.user_id",
+                "object": "child_process_creator"
+            },
+            {
+                "key": "process.creator_user_ref",
+                "object": "child_process",
+                "references": "child_process_creator"
+            }
+        ],
+        "AccountUpn": [
+            {
+                "key": "user-account.account_login",
+                "object": "child_process_creator"
+            },
+            {
+                "key": "process.creator_user_ref",
+                "object": "child_process",
+                "references": "child_process_creator"
+            }
+        ],
         "ActionType": [
             {
                 "key": "x-oca-event.action",
                 "object": "event"
             }
         ],
-        "DeviceId": {
-            "key": "x-oca-asset.device_id",
+        "AdditionalFields": {
+            "key": "x-msatp.AdditionalFields",
+            "object": "x-msatp",
+            "transformer": "JsonToString"
+        },
+        "Alerts": {
+            "key": "x-json-alert.data"
+        },
+        "DeviceId": [
+            {
+                "key": "x-oca-asset.device_id",
+                "object": "host"
+            },
+            {
+                "key": "x-oca-event.host_ref",
+                "object": "event",
+                "references": "host"
+            }
+        ],
+        "DeviceName": [
+            {
+                "key": "x-oca-asset.hostname",
+                "object": "host"
+            },
+            {
+                "key": "x-oca-event.host_ref",
+                "object": "event",
+                "references": "host"
+            }
+        ],
+        "FileName": [
+            {
+                "key": "file.name",
+                "object": "child_process_file",
+                "transformer": "ToFileName"
+            },
+            {
+                "key": "process.image_ref",
+                "object": "child_process",
+                "references": "child_process_file"
+            },
+            {
+                "key": "process.child_refs",
+                "object": "process",
+                "references": [
+                    "child_process"
+                ]
+            },
+            {
+                "key": "x-oca-event.process_ref",
+                "object": "event",
+                "references": "child_process"
+            },
+            {
+                "key": "directory.path",
+                "object": "child_process_file_dir",
+                "transformer": "ToMSATPDirectoryPath"
+            },
+            {
+                "key": "file.parent_directory_ref",
+                "object": "child_process_file",
+                "references": "child_process_file_dir"
+            }
+        ],
+        "FileOriginIP": [
+            {
+                "key": "ipv4-addr.value",
+                "object": "dst_ip"
+            },
+            {
+                "key": "ipv6-addr.value",
+                "object": "dst_ip"
+            },
+            {
+                "key": "network-traffic.dst_ref",
+                "object": "nt",
+                "references": "dst_ip"
+            },
+            {
+                "key": "x-oca-event.network_ref",
+                "object": "event",
+                "references": "nt"
+            }
+        ],
+        "FileOriginUrl": [
+            {
+                "key": "url.value",
+                "object": "url_ref",
+                "transformer": "IfValidUrl"
+            },
+            {
+                "key": "x-oca-event.url_ref",
+                "object": "event",
+                "references": "url_ref"
+            },
+            {
+                "key": "domain-name.value",
+                "object": "file-origin-domain",
+                "transformer": "GetDomainName"
+            },
+            {
+                "key": "x-oca-event.domain_ref",
+                "object": "event",
+                "references": "file-origin-domain"
+            }
+        ],
+        "FolderPath": [
+            {
+                "key": "directory.path",
+                "object": "child_process_file_dir",
+                "transformer": "ToMSATPDirectoryPath"
+            },
+            {
+                "key": "file.parent_directory_ref",
+                "object": "child_process_file",
+                "references": "child_process_file_dir"
+            }
+        ],
+        "IPAddresses": [
+            {
+                "key": "ipv4-addr.value",
+                "object": "host_ip4",
+                "transformer": "FilterIPv4List",
+                "unwrap": true
+            },
+            {
+                "key": "ipv6-addr.value",
+                "object": "host_ip6",
+                "transformer": "FilterIPv6List",
+                "unwrap": true
+            },
+            {
+                "group": true,
+                "key": "x-oca-asset.ip_refs",
+                "object": "host",
+                "references": [
+                    "host_ip4",
+                    "host_ip6"
+                ],
+                "unwrap": true
+            }
+        ],
+        "InitiatingProcessAccountName": [
+            {
+                "key": "user-account.user_id",
+                "object": "process_creator"
+            },
+            {
+                "key": "process.creator_user_ref",
+                "object": "process",
+                "references": "process_creator"
+            }
+        ],
+        "InitiatingProcessAccountUpn": [
+            {
+                "key": "user-account.account_login",
+                "object": "process_creator"
+            },
+            {
+                "key": "process.creator_user_ref",
+                "object": "process",
+                "references": "process_creator"
+            }
+        ],
+        "InitiatingProcessCommandLine": {
+            "key": "process.command_line",
+            "object": "process"
+        },
+        "InitiatingProcessCreationTime": {
+            "key": "process.created_time",
+            "object": "process",
+            "transformer": "MsatpToTimestamp"
+        },
+        "InitiatingProcessFileName": [
+            {
+                "key": "file.name",
+                "object": "process_file",
+                "transformer": "ToFileName"
+            },
+            {
+                "key": "process.image_ref",
+                "object": "process",
+                "references": "process_file"
+            },
+            {
+                "key": "process.parent_ref",
+                "object": "child_process",
+                "references": "process"
+            },
+            {
+                "key": "directory.path",
+                "object": "process_file_dir",
+                "transformer": "ToMSATPDirectoryPath"
+            },
+            {
+                "key": "file.parent_directory_ref",
+                "object": "process_file",
+                "references": "process_file_dir"
+            }
+        ],
+        "InitiatingProcessFolderPath": [
+            {
+                "key": "directory.path",
+                "object": "process_file_dir",
+                "transformer": "ToMSATPDirectoryPath"
+            },
+            {
+                "key": "file.parent_directory_ref",
+                "object": "process_file",
+                "references": "process_file_dir"
+            },
+            {
+                "key": "process.image_ref",
+                "object": "process",
+                "references": "process_file"
+            }
+        ],
+        "InitiatingProcessId": [
+            {
+                "key": "process.pid",
+                "object": "process",
+                "transformer": "ToInteger"
+            },
+            {
+                "key": "process.parent_ref",
+                "object": "child_process",
+                "references": "process"
+            }
+        ],
+        "InitiatingProcessMD5": [
+            {
+                "key": "file.hashes.MD5",
+                "object": "process_file"
+            },
+            {
+                "key": "process.image_ref",
+                "object": "process",
+                "references": "process_file"
+            }
+        ],
+        "InitiatingProcessParentCreationTime": [
+            {
+                "key": "process.created_time",
+                "object": "parent_process",
+                "transformer": "MsatpToTimestamp"
+            },
+            {
+                "key": "process.parent_ref",
+                "object": "process",
+                "references": "parent_process"
+            }
+        ],
+        "InitiatingProcessParentFileName": [
+            {
+                "key": "file.name",
+                "object": "parent_process_file",
+                "transformer": "ToFileName"
+            },
+            {
+                "key": "process.parent_ref",
+                "object": "process",
+                "references": "parent_process"
+            },
+            {
+                "key": "process.image_ref",
+                "object": "parent_process",
+                "references": "parent_process_file"
+            },
+            {
+                "key": "directory.path",
+                "object": "parent_process_file_dir",
+                "transformer": "ToMSATPDirectoryPath"
+            },
+            {
+                "key": "file.parent_directory_ref",
+                "object": "parent_process_file",
+                "references": "parent_process_file_dir"
+            }
+        ],
+        "InitiatingProcessParentId": {
+            "key": "process.pid",
+            "object": "parent_process",
+            "transformer": "ToInteger"
+        },
+        "InitiatingProcessSHA1": [
+            {
+                "key": "file.hashes.SHA-1",
+                "object": "process_file"
+            },
+            {
+                "key": "process.image_ref",
+                "object": "process",
+                "references": "process_file"
+            }
+        ],
+        "InitiatingProcessSHA256": [
+            {
+                "key": "file.hashes.SHA-256",
+                "object": "process_file"
+            },
+            {
+                "key": "process.image_ref",
+                "object": "process",
+                "references": "process_file"
+            }
+        ],
+        "LocalIP": [
+            {
+                "key": "ipv4-addr.value",
+                "object": "src_ip"
+            },
+            {
+                "key": "ipv6-addr.value",
+                "object": "src_ip"
+            },
+            {
+                "key": "network-traffic.src_ref",
+                "object": "nt",
+                "references": "src_ip"
+            },
+            {
+                "group": true,
+                "key": "x-oca-asset.ip_refs",
+                "object": "host",
+                "references": [
+                    "src_ip"
+                ]
+            },
+            {
+                "key": "x-oca-event.network_ref",
+                "object": "event",
+                "references": "nt"
+            }
+        ],
+        "LocalPort": [
+            {
+                "key": "network-traffic.src_port",
+                "object": "nt",
+                "transformer": "ToInteger"
+            },
+            {
+                "key": "x-oca-event.network_ref",
+                "object": "event",
+                "references": "nt"
+            }
+        ],
+        "MD5": {
+            "key": "file.hashes.MD5",
+            "object": "child_process_file"
+        },
+        "MacAddressSet": [
+            {
+                "key": "mac-addr.value",
+                "object": "mac",
+                "transformer": "FormatMacList",
+                "unwrap": true
+            },
+            {
+                "group": true,
+                "key": "x-oca-asset.mac_refs",
+                "object": "host",
+                "references": [
+                    "mac"
+                ],
+                "unwrap": true
+            }
+        ],
+        "OSArchitecture": {
+            "key": "x-oca-asset.architecture",
+            "object": "host"
+        },
+        "OSPlatform": {
+            "key": "x-oca-asset.os_name",
             "object": "host"
         },
+        "OSVersion": {
+            "key": "x-oca-asset.os_version",
+            "object": "host"
+        },
+        "ProcessCommandLine": [
+            {
+                "key": "process.command_line",
+                "object": "child_process"
+            },
+            {
+                "key": "process.child_refs",
+                "object": "process",
+                "references": [
+                    "child_process"
+                ]
+            }
+        ],
+        "ProcessCreationTime": {
+            "key": "process.created_time",
+            "object": "child_process",
+            "transformer": "MsatpToTimestamp"
+        },
+        "ProcessId": [
+            {
+                "key": "process.pid",
+                "object": "child_process",
+                "transformer": "ToInteger"
+            },
+            {
+                "key": "process.child_refs",
+                "object": "process",
+                "references": [
+                    "child_process"
+                ]
+            },
+            {
+                "key": "x-oca-event.process_ref",
+                "object": "event",
+                "references": "child_process"
+            }
+        ],
+        "PublicIP": [
+            {
+                "key": "ipv4-addr.value",
+                "object": "public-ip"
+            },
+            {
+                "group": true,
+                "key": "x-oca-asset.ip_refs",
+                "object": "host",
+                "references": [
+                    "public-ip"
+                ]
+            }
+        ],
+        "RemoteIP": [
+            {
+                "key": "ipv4-addr.value",
+                "object": "dst_ip"
+            },
+            {
+                "key": "ipv6-addr.value",
+                "object": "dst_ip"
+            },
+            {
+                "key": "network-traffic.dst_ref",
+                "object": "nt",
+                "references": "dst_ip"
+            },
+            {
+                "key": "x-oca-event.network_ref",
+                "object": "event",
+                "references": "nt"
+            }
+        ],
+        "RemotePort": [
+            {
+                "key": "network-traffic.dst_port",
+                "object": "nt",
+                "transformer": "ToInteger"
+            },
+            {
+                "key": "x-oca-event.network_ref",
+                "object": "event",
+                "references": "nt"
+            }
+        ],
+        "RemoteUrl": [
+            {
+                "key": "url.value",
+                "object": "url",
+                "transformer": "IfValidUrl"
+            },
+            {
+                "key": "domain-name.value",
+                "object": "domain-name",
+                "transformer": "GetDomainName"
+            },
+            {
+                "key": "x-oca-event.domain_ref",
+                "object": "event",
+                "references": "domain-name"
+            },
+            {
+                "key": "x-oca-event.url_ref",
+                "object": "event",
+                "references": "url"
+            }
+        ],
+        "ReportId": {
+            "key": "x-msatp.ReportId",
+            "object": "x-msatp"
+        },
+        "SHA1": {
+            "key": "file.hashes.SHA-1",
+            "object": "child_process_file"
+        },
+        "SHA256": {
+            "key": "file.hashes.SHA-256",
+            "object": "child_process_file"
+        },
+        "TableName": {
+            "key": "x-msatp.Table",
+            "object": "x-msatp"
+        },
+        "Timestamp": [
+            {
+                "key": "x-oca-event.created",
+                "object": "event"
+            },
+            {
+                "cybox": false,
+                "key": "first_observed",
+                "transformer": "MsatpToTimestamp"
+            },
+            {
+                "cybox": false,
+                "key": "last_observed",
+                "transformer": "MsatpToTimestamp"
+            }
+        ],
+        "event_count": {
+            "cybox": false,
+            "key": "number_observed",
+            "transformer": "ToInteger"
+        },
+        "event_link": [
+            {
+                "key": "external-reference.url",
+                "object": "device_external_ref"
+            },
+            {
+                "key": "x-oca-event.external_ref",
+                "object": "event",
+                "references": "device_external_ref"
+            }
+        ],
+        "missingChildShouldMapInitiatingPid": {
+            "key": "x-oca-event.missingChildShouldMapInitiatingPid",
+            "object": "event"
+        },
+        "original_ref": [
+            {
+                "key": "artifact.payload_bin",
+                "object": "original_ref",
+                "transformer": "ToBase64"
+            },
+            {
+                "key": "x-oca-event.original_ref",
+                "object": "event",
+                "references": "original_ref"
+            }
+        ],
+        "provider": {
+            "key": "x-oca-event.provider",
+            "object": "event",
+            "value": "Microsoft Defender for Endpoint"
+        }
+    },
+    "DeviceFileEvents": {
+        "ActionType": [
+            {
+                "key": "x-oca-event.action",
+                "object": "event"
+            }
+        ],
+        "AdditionalFields": {
+            "key": "x-msatp.AdditionalFields",
+            "object": "x-msatp",
+            "transformer": "JsonToString"
+        },
+        "Alerts": {
+            "key": "x-json-alert.data"
+        },
+        "DeviceId": [
+            {
+                "key": "x-oca-asset.device_id",
+                "object": "host"
+            },
+            {
+                "key": "x-oca-event.host_ref",
+                "object": "event",
+                "references": "host"
+            }
+        ],
         "DeviceName": [
             {
                 "key": "x-oca-asset.hostname",
                 "object": "host"
             },
             {
                 "key": "x-oca-event.host_ref",
                 "object": "event",
                 "references": "host"
             }
         ],
         "FileName": [
             {
                 "key": "file.name",
-                "object": "file"
+                "object": "file",
+                "transformer": "ToFileName"
             },
             {
                 "key": "x-oca-event.file_ref",
                 "object": "event",
                 "references": "file"
+            },
+            {
+                "key": "directory.path",
+                "object": "file_dir",
+                "transformer": "ToMSATPDirectoryPath"
+            },
+            {
+                "key": "file.parent_directory_ref",
+                "object": "file",
+                "references": "file_dir"
+            }
+        ],
+        "FileOriginIP": [
+            {
+                "key": "ipv4-addr.value",
+                "object": "dst_ip"
+            },
+            {
+                "key": "ipv6-addr.value",
+                "object": "dst_ip"
+            },
+            {
+                "key": "network-traffic.dst_ref",
+                "object": "nt",
+                "references": "dst_ip"
+            },
+            {
+                "key": "x-oca-event.network_ref",
+                "object": "event",
+                "references": "nt"
+            },
+            {
+                "group": true,
+                "key": "x-oca-event.ips_ref",
+                "object": "event",
+                "references": [
+                    "dst_ip"
+                ]
+            }
+        ],
+        "FileOriginReferrerUrl": [
+            {
+                "key": "url.value",
+                "object": "url_ref",
+                "transformer": "IfValidUrl"
+            },
+            {
+                "key": "x-oca-event.url_ref",
+                "object": "event",
+                "references": "url_ref"
+            },
+            {
+                "key": "domain-name.value",
+                "object": "file-origin-ref-domain",
+                "transformer": "GetDomainName"
+            },
+            {
+                "key": "x-oca-event.domain_ref",
+                "object": "event",
+                "references": "file-origin-ref-domain"
             }
         ],
         "FolderPath": [
             {
                 "key": "directory.path",
                 "object": "file_dir",
-                "transformer": "ToDirectoryPath"
+                "transformer": "ToMSATPDirectoryPath"
             },
             {
                 "key": "file.parent_directory_ref",
                 "object": "file",
                 "references": "file_dir"
             }
         ],
+        "IPAddresses": [
+            {
+                "key": "ipv4-addr.value",
+                "object": "host_ip4",
+                "transformer": "FilterIPv4List",
+                "unwrap": true
+            },
+            {
+                "key": "ipv6-addr.value",
+                "object": "host_ip6",
+                "transformer": "FilterIPv6List",
+                "unwrap": true
+            },
+            {
+                "group": true,
+                "key": "x-oca-asset.ip_refs",
+                "object": "host",
+                "references": [
+                    "host_ip4",
+                    "host_ip6"
+                ],
+                "unwrap": true
+            }
+        ],
         "InitiatingProcessAccountName": [
             {
+                "key": "user-account.user_id",
+                "object": "fc_process_creator"
+            },
+            {
+                "key": "process.creator_user_ref",
+                "object": "fc_process",
+                "references": "fc_process_creator"
+            },
+            {
+                "key": "x-oca-event.user_ref",
+                "object": "event",
+                "references": "fc_process_creator"
+            }
+        ],
+        "InitiatingProcessAccountUpn": [
+            {
                 "key": "user-account.account_login",
                 "object": "fc_process_creator"
             },
             {
                 "key": "process.creator_user_ref",
                 "object": "fc_process",
                 "references": "fc_process_creator"
             }
         ],
-        "InitiatingProcessAccountSid": [
+        "InitiatingProcessCommandLine": {
+            "key": "process.command_line",
+            "object": "fc_process"
+        },
+        "InitiatingProcessCreationTime": {
+            "key": "process.created_time",
+            "object": "fc_process",
+            "transformer": "MsatpToTimestamp"
+        },
+        "InitiatingProcessFileName": [
+            {
+                "key": "file.name",
+                "object": "fc_process_file",
+                "transformer": "ToFileName"
+            },
+            {
+                "key": "process.image_ref",
+                "object": "fc_process",
+                "references": "fc_process_file"
+            },
+            {
+                "key": "x-oca-event.process_ref",
+                "object": "event",
+                "references": "fc_process"
+            },
+            {
+                "key": "directory.path",
+                "object": "fc_process_file_dir",
+                "transformer": "ToMSATPDirectoryPath"
+            },
+            {
+                "key": "file.parent_directory_ref",
+                "object": "fc_process_file",
+                "references": "fc_process_file_dir"
+            }
+        ],
+        "InitiatingProcessFolderPath": [
+            {
+                "key": "directory.path",
+                "object": "fc_process_file_dir",
+                "transformer": "ToMSATPDirectoryPath"
+            },
+            {
+                "key": "file.parent_directory_ref",
+                "object": "fc_process_file",
+                "references": "fc_process_file_dir"
+            },
+            {
+                "key": "process.image_ref",
+                "object": "fc_process",
+                "references": "fc_process_file"
+            }
+        ],
+        "InitiatingProcessId": [
+            {
+                "key": "process.pid",
+                "object": "fc_process",
+                "transformer": "ToInteger"
+            },
+            {
+                "key": "x-oca-event.process_ref",
+                "object": "event",
+                "references": "fc_process"
+            }
+        ],
+        "InitiatingProcessMD5": [
+            {
+                "key": "file.hashes.MD5",
+                "object": "fc_process_file"
+            },
+            {
+                "key": "process.image_ref",
+                "object": "fc_process",
+                "references": "fc_process_file"
+            }
+        ],
+        "InitiatingProcessParentCreationTime": [
+            {
+                "key": "process.created_time",
+                "object": "fc_parent_process",
+                "transformer": "MsatpToTimestamp"
+            },
+            {
+                "key": "process.parent_ref",
+                "object": "fc_process",
+                "references": "fc_parent_process"
+            }
+        ],
+        "InitiatingProcessParentFileName": [
+            {
+                "key": "file.name",
+                "object": "fc_parent_process_file",
+                "transformer": "ToFileName"
+            },
+            {
+                "key": "process.parent_ref",
+                "object": "fc_process",
+                "references": "fc_parent_process"
+            },
+            {
+                "key": "process.image_ref",
+                "object": "fc_parent_process",
+                "references": "fc_parent_process_file"
+            },
+            {
+                "key": "directory.path",
+                "object": "fc_parent_process_file_dir",
+                "transformer": "ToMSATPDirectoryPath"
+            },
+            {
+                "key": "file.parent_directory_ref",
+                "object": "fc_parent_process_file",
+                "references": "fc_parent_process_file_dir"
+            }
+        ],
+        "InitiatingProcessParentId": [
+            {
+                "key": "process.pid",
+                "object": "fc_parent_process",
+                "transformer": "ToInteger"
+            },
+            {
+                "key": "process.parent_ref",
+                "object": "fc_process",
+                "references": "fc_parent_process"
+            },
+            {
+                "key": "x-oca-event.parent_process_ref",
+                "object": "event",
+                "references": "fc_parent_process"
+            }
+        ],
+        "InitiatingProcessSHA1": [
+            {
+                "key": "file.hashes.SHA-1",
+                "object": "fc_process_file"
+            },
+            {
+                "key": "process.image_ref",
+                "object": "fc_process",
+                "references": "fc_process_file"
+            }
+        ],
+        "InitiatingProcessSHA256": [
+            {
+                "key": "file.hashes.SHA-256",
+                "object": "fc_process_file"
+            },
+            {
+                "key": "process.image_ref",
+                "object": "fc_process",
+                "references": "fc_process_file"
+            }
+        ],
+        "MD5": {
+            "key": "file.hashes.MD5",
+            "object": "file"
+        },
+        "MacAddressSet": [
+            {
+                "key": "mac-addr.value",
+                "object": "mac",
+                "transformer": "FormatMacList",
+                "unwrap": true
+            },
+            {
+                "group": true,
+                "key": "x-oca-asset.mac_refs",
+                "object": "host",
+                "references": [
+                    "mac"
+                ],
+                "unwrap": true
+            }
+        ],
+        "OSArchitecture": {
+            "key": "x-oca-asset.architecture",
+            "object": "host"
+        },
+        "OSPlatform": {
+            "key": "x-oca-asset.os_name",
+            "object": "host"
+        },
+        "OSVersion": {
+            "key": "x-oca-asset.os_version",
+            "object": "host"
+        },
+        "PublicIP": [
+            {
+                "key": "ipv4-addr.value",
+                "object": "public-ip"
+            },
+            {
+                "group": true,
+                "key": "x-oca-asset.ip_refs",
+                "object": "host",
+                "references": [
+                    "public-ip"
+                ]
+            }
+        ],
+        "ReportId": {
+            "key": "x-msatp.ReportId",
+            "object": "x-msatp"
+        },
+        "SHA1": {
+            "key": "file.hashes.SHA-1",
+            "object": "file"
+        },
+        "SHA256": {
+            "key": "file.hashes.SHA-256",
+            "object": "file"
+        },
+        "TableName": {
+            "key": "x-msatp.Table",
+            "object": "x-msatp"
+        },
+        "Timestamp": [
+            {
+                "key": "x-oca-event.created",
+                "object": "event"
+            },
+            {
+                "cybox": false,
+                "key": "first_observed",
+                "transformer": "MsatpToTimestamp"
+            },
+            {
+                "cybox": false,
+                "key": "last_observed",
+                "transformer": "MsatpToTimestamp"
+            }
+        ],
+        "event_count": {
+            "cybox": false,
+            "key": "number_observed",
+            "transformer": "ToInteger"
+        },
+        "event_link": [
+            {
+                "key": "external-reference.url",
+                "object": "device_external_ref"
+            },
+            {
+                "key": "x-oca-event.external_ref",
+                "object": "event",
+                "references": "device_external_ref"
+            }
+        ],
+        "original_ref": [
+            {
+                "key": "artifact.payload_bin",
+                "object": "original_ref",
+                "transformer": "ToBase64"
+            },
+            {
+                "key": "x-oca-event.original_ref",
+                "object": "event",
+                "references": "original_ref"
+            }
+        ],
+        "provider": {
+            "key": "x-oca-event.provider",
+            "object": "event",
+            "value": "Microsoft Defender for Endpoint"
+        }
+    },
+    "DeviceImageLoadEvents": {
+        "ActionType": [
+            {
+                "key": "x-oca-event.action",
+                "object": "event"
+            }
+        ],
+        "AdditionalFields": {
+            "key": "x-msatp.AdditionalFields",
+            "object": "x-msatp",
+            "transformer": "JsonToString"
+        },
+        "Alerts": {
+            "key": "x-json-alert.data"
+        },
+        "DeviceId": [
+            {
+                "key": "x-oca-asset.device_id",
+                "object": "host"
+            },
+            {
+                "key": "x-oca-event.host_ref",
+                "object": "event",
+                "references": "host"
+            }
+        ],
+        "DeviceName": [
+            {
+                "key": "x-oca-asset.hostname",
+                "object": "host"
+            },
+            {
+                "key": "x-oca-event.host_ref",
+                "object": "event",
+                "references": "host"
+            }
+        ],
+        "FileName": [
+            {
+                "key": "file.name",
+                "object": "file",
+                "transformer": "ToFileName"
+            },
+            {
+                "key": "x-oca-event.file_ref",
+                "object": "event",
+                "references": "file"
+            },
+            {
+                "key": "directory.path",
+                "object": "file_dir",
+                "transformer": "ToMSATPDirectoryPath"
+            },
+            {
+                "key": "file.parent_directory_ref",
+                "object": "file",
+                "references": "file_dir"
+            }
+        ],
+        "FolderPath": [
+            {
+                "key": "directory.path",
+                "object": "file_dir",
+                "transformer": "ToMSATPDirectoryPath"
+            },
+            {
+                "key": "file.parent_directory_ref",
+                "object": "file",
+                "references": "file_dir"
+            }
+        ],
+        "IPAddresses": [
+            {
+                "key": "ipv4-addr.value",
+                "object": "host_ip4",
+                "transformer": "FilterIPv4List",
+                "unwrap": true
+            },
+            {
+                "key": "ipv6-addr.value",
+                "object": "host_ip6",
+                "transformer": "FilterIPv6List",
+                "unwrap": true
+            },
+            {
+                "group": true,
+                "key": "x-oca-asset.ip_refs",
+                "object": "host",
+                "references": [
+                    "host_ip4",
+                    "host_ip6"
+                ],
+                "unwrap": true
+            }
+        ],
+        "InitiatingProcessAccountName": [
             {
                 "key": "user-account.user_id",
                 "object": "fc_process_creator"
             },
             {
                 "key": "process.creator_user_ref",
                 "object": "fc_process",
@@ -67,39 +1384,66 @@
             },
             {
                 "key": "x-oca-event.user_ref",
                 "object": "event",
                 "references": "fc_process_creator"
             }
         ],
+        "InitiatingProcessAccountUpn": [
+            {
+                "key": "user-account.account_login",
+                "object": "fc_process_creator"
+            },
+            {
+                "key": "process.creator_user_ref",
+                "object": "fc_process",
+                "references": "fc_process_creator"
+            }
+        ],
         "InitiatingProcessCommandLine": {
             "key": "process.command_line",
             "object": "fc_process"
         },
         "InitiatingProcessCreationTime": {
             "key": "process.created_time",
             "object": "fc_process",
             "transformer": "MsatpToTimestamp"
         },
         "InitiatingProcessFileName": [
             {
                 "key": "file.name",
-                "object": "fc_process_file"
+                "object": "fc_process_file",
+                "transformer": "ToFileName"
             },
             {
                 "key": "process.image_ref",
                 "object": "fc_process",
                 "references": "fc_process_file"
+            },
+            {
+                "key": "x-oca-event.process_ref",
+                "object": "event",
+                "references": "fc_process"
+            },
+            {
+                "key": "directory.path",
+                "object": "fc_process_file_dir",
+                "transformer": "ToMSATPDirectoryPath"
+            },
+            {
+                "key": "file.parent_directory_ref",
+                "object": "fc_process_file",
+                "references": "fc_process_file_dir"
             }
         ],
         "InitiatingProcessFolderPath": [
             {
                 "key": "directory.path",
                 "object": "fc_process_file_dir",
-                "transformer": "ToDirectoryPath"
+                "transformer": "ToMSATPDirectoryPath"
             },
             {
                 "key": "file.parent_directory_ref",
                 "object": "fc_process_file",
                 "references": "fc_process_file_dir"
             },
             {
@@ -142,25 +1486,36 @@
                 "object": "fc_process",
                 "references": "fc_parent_process"
             }
         ],
         "InitiatingProcessParentFileName": [
             {
                 "key": "file.name",
-                "object": "fc_parent_process_file"
+                "object": "fc_parent_process_file",
+                "transformer": "ToFileName"
             },
             {
                 "key": "process.parent_ref",
                 "object": "fc_process",
                 "references": "fc_parent_process"
             },
             {
                 "key": "process.image_ref",
                 "object": "fc_parent_process",
                 "references": "fc_parent_process_file"
+            },
+            {
+                "key": "directory.path",
+                "object": "fc_parent_process_file_dir",
+                "transformer": "ToMSATPDirectoryPath"
+            },
+            {
+                "key": "file.parent_directory_ref",
+                "object": "fc_parent_process_file",
+                "references": "fc_parent_process_file_dir"
             }
         ],
         "InitiatingProcessParentId": [
             {
                 "key": "process.pid",
                 "object": "fc_parent_process",
                 "transformer": "ToInteger"
@@ -198,22 +1553,73 @@
                 "references": "fc_process_file"
             }
         ],
         "MD5": {
             "key": "file.hashes.MD5",
             "object": "file"
         },
+        "MacAddressSet": [
+            {
+                "key": "mac-addr.value",
+                "object": "mac",
+                "transformer": "FormatMacList",
+                "unwrap": true
+            },
+            {
+                "group": true,
+                "key": "x-oca-asset.mac_refs",
+                "object": "host",
+                "references": [
+                    "mac"
+                ],
+                "unwrap": true
+            }
+        ],
+        "OSArchitecture": {
+            "key": "x-oca-asset.architecture",
+            "object": "host"
+        },
+        "OSPlatform": {
+            "key": "x-oca-asset.os_name",
+            "object": "host"
+        },
+        "OSVersion": {
+            "key": "x-oca-asset.os_version",
+            "object": "host"
+        },
+        "PublicIP": [
+            {
+                "key": "ipv4-addr.value",
+                "object": "public-ip"
+            },
+            {
+                "group": true,
+                "key": "x-oca-asset.ip_refs",
+                "object": "host",
+                "references": [
+                    "public-ip"
+                ]
+            }
+        ],
+        "ReportId": {
+            "key": "x-msatp.ReportId",
+            "object": "x-msatp"
+        },
         "SHA1": {
             "key": "file.hashes.SHA-1",
             "object": "file"
         },
         "SHA256": {
             "key": "file.hashes.SHA-256",
             "object": "file"
         },
+        "TableName": {
+            "key": "x-msatp.Table",
+            "object": "x-msatp"
+        },
         "Timestamp": [
             {
                 "key": "x-oca-event.created",
                 "object": "event"
             },
             {
                 "cybox": false,
@@ -226,96 +1632,211 @@
                 "transformer": "MsatpToTimestamp"
             }
         ],
         "event_count": {
             "cybox": false,
             "key": "number_observed",
             "transformer": "ToInteger"
+        },
+        "event_link": [
+            {
+                "key": "external-reference.url",
+                "object": "device_external_ref"
+            },
+            {
+                "key": "x-oca-event.external_ref",
+                "object": "event",
+                "references": "device_external_ref"
+            }
+        ],
+        "original_ref": [
+            {
+                "key": "artifact.payload_bin",
+                "object": "original_ref",
+                "transformer": "ToBase64"
+            },
+            {
+                "key": "x-oca-event.original_ref",
+                "object": "event",
+                "references": "original_ref"
+            }
+        ],
+        "provider": {
+            "key": "x-oca-event.provider",
+            "object": "event",
+            "value": "Microsoft Defender for Endpoint"
         }
     },
     "DeviceNetworkEvents": {
-        "DeviceId": {
-            "key": "x-msatp.machine_id"
+        "ActionType": {
+            "key": "x-oca-event.action",
+            "object": "event"
+        },
+        "AdditionalFields": {
+            "key": "x-msatp.AdditionalFields",
+            "object": "x-msatp",
+            "transformer": "JsonToString"
         },
-        "DeviceName": {
-            "key": "x-msatp.computer_name"
+        "Alerts": {
+            "key": "x-json-alert.data"
         },
+        "DeviceId": [
+            {
+                "key": "x-oca-asset.device_id",
+                "object": "host"
+            },
+            {
+                "key": "x-oca-event.host_ref",
+                "object": "event",
+                "references": "host"
+            }
+        ],
+        "DeviceName": [
+            {
+                "key": "x-oca-asset.hostname",
+                "object": "host"
+            },
+            {
+                "key": "x-oca-event.host_ref",
+                "object": "event",
+                "references": "host"
+            }
+        ],
+        "IPAddresses": [
+            {
+                "key": "ipv4-addr.value",
+                "object": "host_ip4",
+                "transformer": "FilterIPv4List",
+                "unwrap": true
+            },
+            {
+                "key": "ipv6-addr.value",
+                "object": "host_ip6",
+                "transformer": "FilterIPv6List",
+                "unwrap": true
+            },
+            {
+                "group": true,
+                "key": "x-oca-asset.ip_refs",
+                "object": "host",
+                "references": [
+                    "host_ip4",
+                    "host_ip6"
+                ],
+                "unwrap": true
+            }
+        ],
         "InitiatingProcessAccountName": [
             {
-                "key": "user-account.account_login",
+                "key": "user-account.user_id",
                 "object": "nc_process_creator"
             },
             {
                 "key": "process.creator_user_ref",
                 "object": "nc_process",
                 "references": "nc_process_creator"
             }
         ],
-        "InitiatingProcessAccountSid": [
+        "InitiatingProcessAccountUpn": [
             {
-                "key": "user-account.user_id",
+                "key": "user-account.account_login",
                 "object": "nc_process_creator"
             },
             {
                 "key": "process.creator_user_ref",
                 "object": "nc_process",
                 "references": "nc_process_creator"
             }
         ],
-        "InitiatingProcessCommandLine": {
-            "key": "process.command_line",
-            "object": "nc_process"
-        },
+        "InitiatingProcessCommandLine": [
+            {
+                "key": "process.command_line",
+                "object": "nc_process"
+            },
+            {
+                "key": "x-oca-event.process_ref",
+                "object": "event",
+                "references": "nc_process"
+            }
+        ],
         "InitiatingProcessCreationTime": {
             "key": "process.created_time",
             "object": "nc_process",
             "transformer": "MsatpToTimestamp"
         },
         "InitiatingProcessFileName": [
             {
                 "key": "file.name",
-                "object": "nc_process_file"
+                "object": "nc_process_file",
+                "transformer": "ToFileName"
             },
             {
                 "key": "process.image_ref",
                 "object": "nc_process",
                 "references": "nc_process_file"
+            },
+            {
+                "key": "x-oca-event.process_ref",
+                "object": "event",
+                "references": "nc_process"
+            },
+            {
+                "key": "directory.path",
+                "object": "nc_process_file_dir",
+                "transformer": "ToMSATPDirectoryPath"
+            },
+            {
+                "key": "file.parent_directory_ref",
+                "object": "nc_process_file",
+                "references": "nc_process_file_dir"
             }
         ],
         "InitiatingProcessFolderPath": [
             {
                 "key": "directory.path",
                 "object": "nc_process_file_dir",
-                "transformer": "ToDirectoryPath"
+                "transformer": "ToMSATPDirectoryPath"
             },
             {
                 "key": "file.parent_directory_ref",
                 "object": "nc_process_file",
                 "references": "nc_process_file_dir"
             },
             {
                 "key": "process.image_ref",
                 "object": "nc_process",
                 "references": "nc_process_file"
             }
         ],
-        "InitiatingProcessId": {
-            "key": "process.pid",
-            "object": "nc_process",
-            "transformer": "ToInteger"
-        },
+        "InitiatingProcessId": [
+            {
+                "key": "process.pid",
+                "object": "nc_process",
+                "transformer": "ToInteger"
+            },
+            {
+                "key": "x-oca-event.process_ref",
+                "object": "event",
+                "references": "nc_process"
+            }
+        ],
         "InitiatingProcessMD5": [
             {
                 "key": "file.hashes.MD5",
                 "object": "nc_process_file"
             },
             {
                 "key": "process.image_ref",
                 "object": "nc_process",
                 "references": "nc_process_file"
+            },
+            {
+                "key": "x-oca-event.process_ref",
+                "object": "event",
+                "references": "nc_process"
             }
         ],
         "InitiatingProcessParentCreationTime": [
             {
                 "key": "process.created_time",
                 "object": "nc_parent_process",
                 "transformer": "MsatpToTimestamp"
@@ -325,25 +1846,36 @@
                 "object": "nc_process",
                 "references": "nc_parent_process"
             }
         ],
         "InitiatingProcessParentFileName": [
             {
                 "key": "file.name",
-                "object": "nc_parent_process_file"
+                "object": "nc_parent_process_file",
+                "transformer": "ToFileName"
             },
             {
                 "key": "process.parent_ref",
                 "object": "nc_process",
                 "references": "nc_parent_process"
             },
             {
                 "key": "process.image_ref",
                 "object": "nc_parent_process",
                 "references": "nc_parent_process_file"
+            },
+            {
+                "key": "directory.path",
+                "object": "nc_parent_process_file_dir",
+                "transformer": "ToMSATPDirectoryPath"
+            },
+            {
+                "key": "file.parent_directory_ref",
+                "object": "nc_parent_process_file",
+                "references": "nc_parent_process_file_dir"
             }
         ],
         "InitiatingProcessParentId": [
             {
                 "key": "process.pid",
                 "object": "nc_parent_process",
                 "transformer": "ToInteger"
@@ -359,25 +1891,35 @@
                 "key": "file.hashes.SHA-1",
                 "object": "nc_process_file"
             },
             {
                 "key": "process.image_ref",
                 "object": "nc_process",
                 "references": "nc_process_file"
+            },
+            {
+                "key": "x-oca-event.process_ref",
+                "object": "event",
+                "references": "nc_process"
             }
         ],
         "InitiatingProcessSHA256": [
             {
                 "key": "file.hashes.SHA-256",
                 "object": "nc_process_file"
             },
             {
                 "key": "process.image_ref",
                 "object": "nc_process",
                 "references": "nc_process_file"
+            },
+            {
+                "key": "x-oca-event.process_ref",
+                "object": "event",
+                "references": "nc_process"
             }
         ],
         "LocalIP": [
             {
                 "key": "ipv4-addr.value",
                 "object": "src_ip"
             },
@@ -385,21 +1927,39 @@
                 "key": "ipv6-addr.value",
                 "object": "src_ip"
             },
             {
                 "key": "network-traffic.src_ref",
                 "object": "nt",
                 "references": "src_ip"
+            },
+            {
+                "group": true,
+                "key": "x-oca-asset.ip_refs",
+                "object": "host",
+                "references": [
+                    "src_ip"
+                ]
+            },
+            {
+                "key": "x-oca-event.network_ref",
+                "object": "event",
+                "references": "nt"
             }
         ],
         "LocalPort": [
             {
                 "key": "network-traffic.src_port",
                 "object": "nt",
                 "transformer": "ToInteger"
+            },
+            {
+                "key": "x-oca-event.network_ref",
+                "object": "event",
+                "references": "nt"
             }
         ],
         "MacAddress": [
             {
                 "key": "mac-addr.value",
                 "object": "mac",
                 "transformer": "FormatMac"
@@ -418,60 +1978,172 @@
             },
             {
                 "key": "x-oca-event.network_ref",
                 "object": "event",
                 "references": "nt"
             }
         ],
+        "MacAddressSet": [
+            {
+                "key": "mac-addr.value",
+                "object": "mac",
+                "transformer": "FormatMacList",
+                "unwrap": true
+            },
+            {
+                "group": true,
+                "key": "x-oca-asset.mac_refs",
+                "object": "host",
+                "references": [
+                    "mac"
+                ],
+                "unwrap": true
+            }
+        ],
+        "OSArchitecture": {
+            "key": "x-oca-asset.architecture",
+            "object": "host"
+        },
+        "OSPlatform": {
+            "key": "x-oca-asset.os_name",
+            "object": "host"
+        },
+        "OSVersion": {
+            "key": "x-oca-asset.os_version",
+            "object": "host"
+        },
         "Protocol": {
             "key": "network-traffic.protocols",
             "object": "nt",
             "transformer": "FormatTCPProtocol"
         },
+        "PublicIP": [
+            {
+                "key": "ipv4-addr.value",
+                "object": "public-ip"
+            },
+            {
+                "group": true,
+                "key": "x-oca-asset.ip_refs",
+                "object": "host",
+                "references": [
+                    "public-ip"
+                ]
+            }
+        ],
         "RemoteIP": [
             {
                 "key": "ipv4-addr.value",
                 "object": "dst_ip"
             },
             {
                 "key": "ipv6-addr.value",
                 "object": "dst_ip"
             },
             {
                 "key": "network-traffic.dst_ref",
                 "object": "nt",
                 "references": "dst_ip"
+            },
+            {
+                "key": "x-oca-event.network_ref",
+                "object": "event",
+                "references": "nt"
             }
         ],
         "RemotePort": [
             {
                 "key": "network-traffic.dst_port",
                 "object": "nt",
                 "transformer": "ToInteger"
+            },
+            {
+                "key": "x-oca-event.network_ref",
+                "object": "event",
+                "references": "nt"
             }
         ],
-        "RemoteUrl": {
-            "key": "url.value"
+        "RemoteUrl": [
+            {
+                "key": "url.value",
+                "object": "url",
+                "transformer": "IfValidUrl"
+            },
+            {
+                "key": "domain-name.value",
+                "object": "domain-name",
+                "transformer": "GetDomainName"
+            },
+            {
+                "key": "x-oca-event.domain_ref",
+                "object": "event",
+                "references": "domain-name"
+            },
+            {
+                "key": "x-oca-event.url_ref",
+                "object": "event",
+                "references": "url"
+            }
+        ],
+        "ReportId": {
+            "key": "x-msatp.ReportId",
+            "object": "x-msatp"
+        },
+        "TableName": {
+            "key": "x-msatp.Table",
+            "object": "x-msatp"
         },
         "Timestamp": [
             {
+                "key": "x-oca-event.created",
+                "object": "event"
+            },
+            {
                 "cybox": false,
                 "key": "first_observed",
                 "transformer": "MsatpToTimestamp"
             },
             {
                 "cybox": false,
                 "key": "last_observed",
                 "transformer": "MsatpToTimestamp"
             }
         ],
         "event_count": {
             "cybox": false,
             "key": "number_observed",
             "transformer": "ToInteger"
+        },
+        "event_link": [
+            {
+                "key": "external-reference.url",
+                "object": "device_external_ref"
+            },
+            {
+                "key": "x-oca-event.external_ref",
+                "object": "event",
+                "references": "device_external_ref"
+            }
+        ],
+        "original_ref": [
+            {
+                "key": "artifact.payload_bin",
+                "object": "original_ref",
+                "transformer": "ToBase64"
+            },
+            {
+                "key": "x-oca-event.original_ref",
+                "object": "event",
+                "references": "original_ref"
+            }
+        ],
+        "provider": {
+            "key": "x-oca-event.provider",
+            "object": "event",
+            "value": "Microsoft Defender for Endpoint"
         }
     },
     "DeviceNetworkInfo": {
         "IpAddresses": [
             {
                 "key": "ipv4-addr.value",
                 "object": "host_ip",
@@ -505,95 +2177,164 @@
                 "references": "host_mac"
             }
         ]
     },
     "DeviceProcessEvents": {
         "AccountName": [
             {
-                "key": "user-account.account_login",
+                "key": "user-account.user_id",
                 "object": "child_process_creator"
             },
             {
                 "key": "process.creator_user_ref",
                 "object": "child_process",
                 "references": "child_process_creator"
+            },
+            {
+                "key": "x-oca-event.user_ref",
+                "object": "event",
+                "references": "child_process_creator"
             }
         ],
-        "AccountSid": [
+        "AccountUpn": [
             {
-                "key": "user-account.user_id",
+                "key": "user-account.account_login",
                 "object": "child_process_creator"
             },
             {
                 "key": "process.creator_user_ref",
                 "object": "child_process",
                 "references": "child_process_creator"
+            },
+            {
+                "key": "x-oca-event.user_ref",
+                "object": "event",
+                "references": "child_process_creator"
             }
         ],
         "ActionType": [
             {
                 "key": "x-oca-event.action",
                 "object": "event"
             }
         ],
-        "DeviceId": {
-            "key": "x-msatp.machine_id"
+        "AdditionalFields": {
+            "key": "x-msatp.AdditionalFields",
+            "object": "x-msatp",
+            "transformer": "JsonToString"
         },
-        "DeviceName": {
-            "key": "x-msatp.computer_name"
+        "Alerts": {
+            "key": "x-json-alert.data"
         },
+        "DeviceId": [
+            {
+                "key": "x-oca-asset.device_id",
+                "object": "host"
+            },
+            {
+                "key": "x-oca-event.host_ref",
+                "object": "event",
+                "references": "host"
+            }
+        ],
+        "DeviceName": [
+            {
+                "key": "x-oca-asset.hostname",
+                "object": "host"
+            },
+            {
+                "key": "x-oca-event.host_ref",
+                "object": "event",
+                "references": "host"
+            }
+        ],
         "FileName": [
             {
                 "key": "file.name",
-                "object": "child_file"
+                "object": "child_process_file",
+                "transformer": "ToFileName"
             },
             {
                 "key": "process.image_ref",
                 "object": "child_process",
-                "references": "child_file"
+                "references": "child_process_file"
             },
             {
                 "key": "process.child_refs",
                 "object": "process",
                 "references": [
                     "child_process"
                 ]
             },
             {
                 "key": "x-oca-event.process_ref",
                 "object": "event",
-                "references": "process"
+                "references": "child_process"
+            },
+            {
+                "key": "directory.path",
+                "object": "child_process_file_dir",
+                "transformer": "ToMSATPDirectoryPath"
+            },
+            {
+                "key": "file.parent_directory_ref",
+                "object": "child_process_file",
+                "references": "child_process_file_dir"
             }
         ],
         "FolderPath": [
             {
                 "key": "directory.path",
-                "object": "child_file_dir",
-                "transformer": "ToDirectoryPath"
+                "object": "child_process_file_dir",
+                "transformer": "ToMSATPDirectoryPath"
             },
             {
                 "key": "file.parent_directory_ref",
-                "object": "child_file",
-                "references": "child_file_dir"
+                "object": "child_process_file",
+                "references": "child_process_file_dir"
+            }
+        ],
+        "IPAddresses": [
+            {
+                "key": "ipv4-addr.value",
+                "object": "host_ip4",
+                "transformer": "FilterIPv4List",
+                "unwrap": true
+            },
+            {
+                "key": "ipv6-addr.value",
+                "object": "host_ip6",
+                "transformer": "FilterIPv6List",
+                "unwrap": true
+            },
+            {
+                "group": true,
+                "key": "x-oca-asset.ip_refs",
+                "object": "host",
+                "references": [
+                    "host_ip4",
+                    "host_ip6"
+                ],
+                "unwrap": true
             }
         ],
         "InitiatingProcessAccountName": [
             {
-                "key": "user-account.account_login",
+                "key": "user-account.user_id",
                 "object": "process_creator"
             },
             {
                 "key": "process.creator_user_ref",
                 "object": "process",
                 "references": "process_creator"
             }
         ],
-        "InitiatingProcessAccountSid": [
+        "InitiatingProcessAccountUpn": [
             {
-                "key": "user-account.user_id",
+                "key": "user-account.account_login",
                 "object": "process_creator"
             },
             {
                 "key": "process.creator_user_ref",
                 "object": "process",
                 "references": "process_creator"
             }
@@ -606,44 +2347,67 @@
             "key": "process.created_time",
             "object": "process",
             "transformer": "MsatpToTimestamp"
         },
         "InitiatingProcessFileName": [
             {
                 "key": "file.name",
-                "object": "process_file"
+                "object": "process_file",
+                "transformer": "ToFileName"
             },
             {
                 "key": "process.image_ref",
                 "object": "process",
                 "references": "process_file"
+            },
+            {
+                "key": "process.parent_ref",
+                "object": "child_process",
+                "references": "process"
+            },
+            {
+                "key": "directory.path",
+                "object": "process_file_dir",
+                "transformer": "ToMSATPDirectoryPath"
+            },
+            {
+                "key": "file.parent_directory_ref",
+                "object": "process_file",
+                "references": "process_file_dir"
             }
         ],
         "InitiatingProcessFolderPath": [
             {
                 "key": "directory.path",
                 "object": "process_file_dir",
-                "transformer": "ToDirectoryPath"
+                "transformer": "ToMSATPDirectoryPath"
             },
             {
                 "key": "file.parent_directory_ref",
                 "object": "process_file",
                 "references": "process_file_dir"
             },
             {
                 "key": "process.image_ref",
                 "object": "process",
                 "references": "process_file"
             }
         ],
-        "InitiatingProcessId": {
-            "key": "process.pid",
-            "object": "process",
-            "transformer": "ToInteger"
-        },
+        "InitiatingProcessId": [
+            {
+                "key": "process.pid",
+                "object": "process",
+                "transformer": "ToInteger"
+            },
+            {
+                "key": "process.parent_ref",
+                "object": "child_process",
+                "references": "process"
+            }
+        ],
         "InitiatingProcessMD5": [
             {
                 "key": "file.hashes.MD5",
                 "object": "process_file"
             },
             {
                 "key": "process.image_ref",
@@ -662,39 +2426,43 @@
                 "object": "process",
                 "references": "parent_process"
             }
         ],
         "InitiatingProcessParentFileName": [
             {
                 "key": "file.name",
-                "object": "parent_process_file"
+                "object": "parent_process_file",
+                "transformer": "ToFileName"
             },
             {
                 "key": "process.parent_ref",
                 "object": "process",
                 "references": "parent_process"
             },
             {
                 "key": "process.image_ref",
                 "object": "parent_process",
                 "references": "parent_process_file"
-            }
-        ],
-        "InitiatingProcessParentId": [
+            },
             {
-                "key": "process.pid",
-                "object": "parent_process",
-                "transformer": "ToInteger"
+                "key": "directory.path",
+                "object": "parent_process_file_dir",
+                "transformer": "ToMSATPDirectoryPath"
             },
             {
-                "key": "process.parent_ref",
-                "object": "process",
-                "references": "parent_process"
+                "key": "file.parent_directory_ref",
+                "object": "parent_process_file",
+                "references": "parent_process_file_dir"
             }
         ],
+        "InitiatingProcessParentId": {
+            "key": "process.pid",
+            "object": "parent_process",
+            "transformer": "ToInteger"
+        },
         "InitiatingProcessSHA1": [
             {
                 "key": "file.hashes.SHA-1",
                 "object": "process_file"
             },
             {
                 "key": "process.image_ref",
@@ -711,43 +2479,63 @@
                 "key": "process.image_ref",
                 "object": "process",
                 "references": "process_file"
             }
         ],
         "MD5": {
             "key": "file.hashes.MD5",
-            "object": "child_file"
+            "object": "child_process_file"
         },
-        "ProcessCommandLine": [
+        "MacAddressSet": [
             {
-                "key": "process.command_line",
-                "object": "child_process"
+                "key": "mac-addr.value",
+                "object": "mac",
+                "transformer": "FormatMacList",
+                "unwrap": true
             },
             {
-                "key": "process.child_refs",
-                "object": "process",
+                "group": true,
+                "key": "x-oca-asset.mac_refs",
+                "object": "host",
                 "references": [
-                    "child_process"
-                ]
+                    "mac"
+                ],
+                "unwrap": true
             }
         ],
-        "ProcessCreationTime": [
+        "OSArchitecture": {
+            "key": "x-oca-asset.architecture",
+            "object": "host"
+        },
+        "OSPlatform": {
+            "key": "x-oca-asset.os_name",
+            "object": "host"
+        },
+        "OSVersion": {
+            "key": "x-oca-asset.os_version",
+            "object": "host"
+        },
+        "ProcessCommandLine": [
             {
-                "key": "process.created_time",
-                "object": "child_process",
-                "transformer": "MsatpToTimestamp"
+                "key": "process.command_line",
+                "object": "child_process"
             },
             {
                 "key": "process.child_refs",
                 "object": "process",
                 "references": [
                     "child_process"
                 ]
             }
         ],
+        "ProcessCreationTime": {
+            "key": "process.created_time",
+            "object": "child_process",
+            "transformer": "MsatpToTimestamp"
+        },
         "ProcessId": [
             {
                 "key": "process.pid",
                 "object": "child_process",
                 "transformer": "ToInteger"
             },
             {
@@ -756,24 +2544,46 @@
                 "references": [
                     "child_process"
                 ]
             },
             {
                 "key": "x-oca-event.process_ref",
                 "object": "event",
-                "references": "process"
+                "references": "child_process"
             }
         ],
+        "PublicIP": [
+            {
+                "key": "ipv4-addr.value",
+                "object": "public-ip"
+            },
+            {
+                "group": true,
+                "key": "x-oca-asset.ip_refs",
+                "object": "host",
+                "references": [
+                    "public-ip"
+                ]
+            }
+        ],
+        "ReportId": {
+            "key": "x-msatp.ReportId",
+            "object": "x-msatp"
+        },
         "SHA1": {
             "key": "file.hashes.SHA-1",
-            "object": "child_file"
+            "object": "child_process_file"
         },
         "SHA256": {
             "key": "file.hashes.SHA-256",
-            "object": "child_file"
+            "object": "child_process_file"
+        },
+        "TableName": {
+            "key": "x-msatp.Table",
+            "object": "x-msatp"
         },
         "Timestamp": [
             {
                 "key": "x-oca-event.created",
                 "object": "event"
             },
             {
@@ -787,52 +2597,119 @@
                 "transformer": "MsatpToTimestamp"
             }
         ],
         "event_count": {
             "cybox": false,
             "key": "number_observed",
             "transformer": "ToInteger"
+        },
+        "event_link": [
+            {
+                "key": "external-reference.url",
+                "object": "device_external_ref"
+            },
+            {
+                "key": "x-oca-event.external_ref",
+                "object": "event",
+                "references": "device_external_ref"
+            }
+        ],
+        "original_ref": [
+            {
+                "key": "artifact.payload_bin",
+                "object": "original_ref",
+                "transformer": "ToBase64"
+            },
+            {
+                "key": "x-oca-event.original_ref",
+                "object": "event",
+                "references": "original_ref"
+            }
+        ],
+        "provider": {
+            "key": "x-oca-event.provider",
+            "object": "event",
+            "value": "Microsoft Defender for Endpoint"
         }
     },
     "DeviceRegistryEvents": {
         "ActionType": [
             {
                 "key": "x-oca-event.action",
                 "object": "event"
             }
         ],
-        "DeviceId": {
-            "key": "x-oca-asset.device_id",
-            "object": "host"
+        "AdditionalFields": {
+            "key": "x-msatp.AdditionalFields",
+            "object": "x-msatp",
+            "transformer": "JsonToString"
+        },
+        "Alerts": {
+            "key": "x-json-alert.data"
         },
+        "DeviceId": [
+            {
+                "key": "x-oca-asset.device_id",
+                "object": "host"
+            },
+            {
+                "key": "x-oca-event.host_ref",
+                "object": "event",
+                "references": "host"
+            }
+        ],
         "DeviceName": [
             {
                 "key": "x-oca-asset.hostname",
                 "object": "host"
             },
             {
                 "key": "x-oca-event.host_ref",
                 "object": "event",
                 "references": "host"
             }
         ],
+        "IPAddresses": [
+            {
+                "key": "ipv4-addr.value",
+                "object": "host_ip4",
+                "transformer": "FilterIPv4List",
+                "unwrap": true
+            },
+            {
+                "key": "ipv6-addr.value",
+                "object": "host_ip6",
+                "transformer": "FilterIPv6List",
+                "unwrap": true
+            },
+            {
+                "group": true,
+                "key": "x-oca-asset.ip_refs",
+                "object": "host",
+                "references": [
+                    "host_ip4",
+                    "host_ip6"
+                ],
+                "unwrap": true
+            }
+        ],
         "InitiatingProcessAccountName": [
             {
-                "key": "user-account.account_login",
+                "key": "user-account.user_id",
                 "object": "re_process_creator"
             },
             {
                 "key": "process.creator_user_ref",
                 "object": "re_process",
                 "references": "re_process_creator"
             }
         ],
-        "InitiatingProcessAccountSid": [
+        "InitiatingProcessAccountUpn": [
             {
-                "key": "user-account.user_id",
+                "key": "user-account.account_login",
                 "object": "re_process_creator"
             },
             {
                 "key": "process.creator_user_ref",
                 "object": "re_process",
                 "references": "re_process_creator"
             }
@@ -845,20 +2722,36 @@
             "key": "process.created_time",
             "object": "re_process",
             "transformer": "MsatpToTimestamp"
         },
         "InitiatingProcessFileName": [
             {
                 "key": "file.name",
-                "object": "re_process_file"
+                "object": "re_process_file",
+                "transformer": "ToFileName"
             },
             {
                 "key": "process.image_ref",
                 "object": "re_process",
                 "references": "re_process_file"
+            },
+            {
+                "key": "x-oca-event.process_ref",
+                "object": "event",
+                "references": "re_process"
+            },
+            {
+                "key": "directory.path",
+                "object": "re_process_file_dir",
+                "transformer": "ToDirectoryPath"
+            },
+            {
+                "key": "file.parent_directory_ref",
+                "object": "re_process_file",
+                "references": "re_process_file_dir"
             }
         ],
         "InitiatingProcessFolderPath": [
             {
                 "key": "directory.path",
                 "object": "re_process_file_dir",
                 "transformer": "ToDirectoryPath"
@@ -908,42 +2801,48 @@
                 "object": "re_process",
                 "references": "re_parent_process"
             }
         ],
         "InitiatingProcessParentFileName": [
             {
                 "key": "file.name",
-                "object": "re_parent_process_file"
+                "object": "re_parent_process_file",
+                "transformer": "ToFileName"
             },
             {
                 "key": "process.parent_ref",
                 "object": "re_process",
                 "references": "re_parent_process"
             },
             {
                 "key": "process.image_ref",
                 "object": "re_parent_process",
                 "references": "re_parent_process_file"
+            },
+            {
+                "key": "directory.path",
+                "object": "re_parent_process_file_dir",
+                "transformer": "ToDirectoryPath"
+            },
+            {
+                "key": "file.parent_directory_ref",
+                "object": "re_parent_process_file",
+                "references": "re_parent_process_file_dir"
             }
         ],
         "InitiatingProcessParentId": [
             {
                 "key": "process.pid",
                 "object": "re_parent_process",
                 "transformer": "ToInteger"
             },
             {
                 "key": "process.parent_ref",
                 "object": "re_process",
                 "references": "re_parent_process"
-            },
-            {
-                "key": "x-oca-event.parent_process_ref",
-                "object": "event",
-                "references": "re_parent_process"
             }
         ],
         "InitiatingProcessSHA1": [
             {
                 "key": "file.hashes.SHA-1",
                 "object": "re_process_file"
             },
@@ -960,23 +2859,81 @@
             },
             {
                 "key": "process.image_ref",
                 "object": "re_process",
                 "references": "re_process_file"
             }
         ],
-        "RegistryKey": {
-            "key": "windows-registry-key.key",
-            "object": "re_key"
+        "MacAddressSet": [
+            {
+                "key": "mac-addr.value",
+                "object": "mac",
+                "transformer": "FormatMacList",
+                "unwrap": true
+            },
+            {
+                "group": true,
+                "key": "x-oca-asset.mac_refs",
+                "object": "host",
+                "references": [
+                    "mac"
+                ],
+                "unwrap": true
+            }
+        ],
+        "OSArchitecture": {
+            "key": "x-oca-asset.architecture",
+            "object": "host"
+        },
+        "OSPlatform": {
+            "key": "x-oca-asset.os_name",
+            "object": "host"
+        },
+        "OSVersion": {
+            "key": "x-oca-asset.os_version",
+            "object": "host"
         },
+        "PublicIP": [
+            {
+                "key": "ipv4-addr.value",
+                "object": "public-ip"
+            },
+            {
+                "group": true,
+                "key": "x-oca-asset.ip_refs",
+                "object": "host",
+                "references": [
+                    "public-ip"
+                ]
+            }
+        ],
+        "RegistryKey": [
+            {
+                "key": "windows-registry-key.key",
+                "object": "re_key"
+            },
+            {
+                "key": "x-oca-event.registry_ref",
+                "object": "event",
+                "references": "re_key"
+            }
+        ],
         "RegistryValues": {
             "key": "windows-registry-key.values",
             "object": "re_key",
             "transformer": "MsatpToRegistryValue"
         },
+        "ReportId": {
+            "key": "x-msatp.ReportId",
+            "object": "x-msatp"
+        },
+        "TableName": {
+            "key": "x-msatp.Table",
+            "object": "x-msatp"
+        },
         "Timestamp": [
             {
                 "key": "x-oca-event.created",
                 "object": "event"
             },
             {
                 "cybox": false,
@@ -989,10 +2946,38 @@
                 "transformer": "MsatpToTimestamp"
             }
         ],
         "event_count": {
             "cybox": false,
             "key": "number_observed",
             "transformer": "ToInteger"
+        },
+        "event_link": [
+            {
+                "key": "external-reference.url",
+                "object": "device_external_ref"
+            },
+            {
+                "key": "x-oca-event.external_ref",
+                "object": "event",
+                "references": "device_external_ref"
+            }
+        ],
+        "original_ref": [
+            {
+                "key": "artifact.payload_bin",
+                "object": "original_ref",
+                "transformer": "ToBase64"
+            },
+            {
+                "key": "x-oca-event.original_ref",
+                "object": "event",
+                "references": "original_ref"
+            }
+        ],
+        "provider": {
+            "key": "x-oca-event.provider",
+            "object": "event",
+            "value": "Microsoft Defender for Endpoint"
         }
     }
 }
```

## stix_shifter_modules/msatp/stix_transmission/api_client.py

```diff
@@ -1,45 +1,55 @@
 """Apiclient for MSATP"""
 import json
+from azure.identity.aio import ClientSecretCredential
 from stix_shifter_utils.stix_transmission.utils.RestApiClientAsync import RestApiClientAsync
 
 DEFAULT_LIMIT = 10000
 DEFAULT_OFFSET = 0
 
 
 class APIClient:
     """API Client to handle all calls."""
 
     def __init__(self, connection, configuration):
         """Initialization.
         :param connection: dict, connection dict
         :param configuration: dict,config dict"""
 
-        headers = dict()
-        url_modifier_function = None
-        auth = configuration.get('auth')
         self.endpoint = 'api/advancedqueries/run'
         self.host = connection.get('host')
-
-        if auth:
-            if 'access_token' in auth and auth['access_token']:
-                headers['Authorization'] = "Bearer " + auth['access_token']
-
-        self.client = RestApiClientAsync(connection.get('host'),
-                                    connection.get('port', None),
-                                    headers,
-                                    url_modifier_function=url_modifier_function,
-                                    cert_verify=connection.get('selfSignedCert', True),
-                                    sni=connection.get('sni', None)
-                                    )
+        self.auth = configuration.get('auth')
         self.timeout = connection['options'].get('timeout')
+        self.connection = connection
+
+    async def init_async_client(self):
+        url_modifier_function = None
+        headers = dict()
+
+        self.credential = ClientSecretCredential(tenant_id=self.auth["tenant"],
+                                                 client_id=self.auth["clientId"],
+                                                 client_secret=self.auth["clientSecret"])
+        async with self.credential:
+            self.access_token = await self.credential.get_token("https://{host}/.default".format(host=self.host))
+            headers['Authorization'] = "Bearer " + self.access_token.token
+
+        self.client = RestApiClientAsync(self.host,
+                                         self.connection.get('port', None),
+                                         headers,
+                                         url_modifier_function=url_modifier_function,
+                                         cert_verify=self.connection.get(
+                                             'selfSignedCert', True),
+                                         sni=self.connection.get('sni', None)
+                                         )
+        return self.client
 
     async def ping_box(self):
         """Ping the endpoint."""
         endpoint = '/api'
+        await self.init_async_client()
         return await self.client.call_api(endpoint, 'GET', timeout=self.timeout)
 
     async def run_search(self, query_expression, offset=DEFAULT_OFFSET, length=DEFAULT_LIMIT):
         """get the response from MSatp endpoints
         :param query_expression: str, search_id
         :param offset: int,offset value
         :param length: int,length value
@@ -47,8 +57,9 @@
         serialize = '| serialize rn = row_number() | where rn >= {offset} | limit {length}'
         headers = dict()
         headers['Content-Type'] = 'application/json'
         headers['Accept'] = 'application/json'
         endpoint = self.endpoint
         query_expression = query_expression + serialize.format(offset=offset, length=length)
         query_expression = json.dumps({'Query': query_expression}).encode("utf-8")
+        await self.init_async_client()
         return await self.client.call_api(endpoint, 'POST', headers=headers, data=query_expression, timeout=self.timeout)
```

## stix_shifter_modules/msatp/stix_transmission/connector.py

```diff
@@ -1,32 +1,26 @@
 import json
-import adal
 from stix_shifter_utils.modules.base.stix_transmission.base_json_sync_connector import BaseJsonSyncConnector
 from .api_client import APIClient
 from stix_shifter_utils.utils.error_response import ErrorResponder
 from stix_shifter_utils.utils import logger
-import copy
+
+from .connector_post_processing import ConnectorPostProcessing
 
 
 class Connector(BaseJsonSyncConnector):
-    init_error = None
     logger = logger.set_logger(__name__)
 
     def __init__(self, connection, configuration):
         """Initialization.
         :param connection: dict, connection dict
         :param configuration: dict,config dict"""
         self.connector = __name__.split('.')[1]
-
-        self.adal_response = Connector.generate_token(self, connection, configuration)
-        if self.adal_response['success']:
-            configuration['auth']['access_token'] = self.adal_response['access_token']
-            self.api_client = APIClient(connection, configuration)
-        else:
-            self.init_error = True
+        self.options = connection['options']
+        self.api_client = APIClient(connection, configuration)
 
     def _handle_errors(self, response, return_obj):
         """Handling API error response
         :param response: response for the API
         :param return_obj: dict, response for the API call with status
         """
         response_code = response.code
@@ -45,16 +39,14 @@
             raise Exception(return_obj)
         else:
             raise Exception(return_obj)
 
     async def ping_connection(self):
         """Ping the endpoint."""
         return_obj = dict()
-        if self.init_error:
-            return self.adal_response
         response = await self.api_client.ping_box()
         response_code = response.code
         if 200 <= response_code < 300:
             return_obj['success'] = True
         else:
             ErrorResponder.fill_error(return_obj, message='unexpected exception', connector=self.connector)
         return return_obj
@@ -66,81 +58,35 @@
 
     async def create_results_connection(self, query, offset, length):
         """"built the response object
         :param query: str, search_id
         :param offset: int,offset value
         :param length: int,length value"""
 
+        util = ConnectorPostProcessing(self.options, False)
         response_txt = None
-        return_obj = dict()
+        return_obj = {
+            'success': True,
+            'data': []
+        }
 
         try:
-            if self.init_error:
-                return self.adal_response
-            response = await self.api_client.run_search(query, offset, length)
-            return_obj = self._handle_errors(response, return_obj)
-            response_json = json.loads(return_obj["data"])
-            return_obj['data'] = response_json['Results']
-            # Customizing the output json,
-            # Get 'TableName' attribute from each row of event data
-            # Create a dictionary with 'TableName' as key and other attributes in an event data as value
-            # Filter the "None" and empty values except for RegistryValueName, which support empty string
-            # Customizing of Registryvalues json
-            table_event_data = []
-            for event_data in return_obj['data']:
-                lookup_table = event_data['TableName']
-                event_data.pop('TableName')
-                build_data = dict()
-                build_data[lookup_table] = {k: v for k, v in event_data.items() if v or k == "RegistryValueName"}
-                if lookup_table == "DeviceRegistryEvents":
-                    registry_build_data = copy.deepcopy(build_data)
-                    registry_build_data[lookup_table]["RegistryValues"] = []
-                    registry_value_dict = {}
-                    for k, v in build_data[lookup_table].items():
-                        if k in ["RegistryValueData", "RegistryValueName", "RegistryValueType"]:
-                            registry_value_dict.update({k: v})
-                            registry_build_data[lookup_table].pop(k)
-                    registry_build_data[lookup_table]["RegistryValues"].append(registry_value_dict)
-
-                    build_data[lookup_table] = registry_build_data[lookup_table]
-                build_data[lookup_table]['event_count'] = '1'
-                table_event_data.append(build_data)
-            return_obj['data'] = table_event_data
-            return return_obj
+            joined_query = util.join_query_with_other_tables(query)
+            response_data = await self.api_client_run_search(joined_query, length, offset)
 
+            async def api_run(q):
+                return await self.api_client_run_search(q, length, offset)
+
+            return util.post_process(response_data, return_obj, api_run)
         except Exception as ex:
             if response_txt is not None:
                 ErrorResponder.fill_error(return_obj, message='unexpected exception', connector=self.connector)
                 self.logger.error('can not parse response: ' + str(response_txt))
             else:
                 raise ex
 
-    def generate_token(self, connection, configuration):
-        """To generate the Token
-        :param connection: dict, connection dict
-        :param configuration: dict,config dict"""
-        return_obj = dict()
-
-        authority_url = ('https://login.windows.net/' +
-                         configuration['auth']['tenant'])
-        resource = "https://" + str(connection.get('host'))
-
-        try:
-            context = adal.AuthenticationContext(
-                authority_url, validate_authority=configuration['auth']['tenant'] != 'adfs',
-            )
-            response_dict = context.acquire_token_with_client_credentials(
-                resource,
-                configuration['auth']['clientId'],
-                configuration['auth']['clientSecret'])
-
-            return_obj['success'] = True
-            return_obj['access_token'] = response_dict['accessToken']
-        except Exception as ex:
-            if ex.__class__.__name__ == 'AdalError':
-                response_dict = ex.error_response
-                ErrorResponder.fill_error(return_obj, response_dict, ['error_description'], connector=self.connector)
-            else:
-                ErrorResponder.fill_error(return_obj, message=str(ex), connector=self.connector)
-            Connector.logger.error("Token generation Failed: " + str(ex.error_response))
-
-        return return_obj
+    async def api_client_run_search(self, joined_query, length, offset):
+        temp_return_obj = dict()
+        response = await self.api_client.run_search(joined_query, offset, length)
+        temp_return_obj = self._handle_errors(response, temp_return_obj)
+        response_data = json.loads(temp_return_obj["data"]).get("Results")
+        return response_data
```

## Comparing `stix_shifter_modules_msatp-5.2.1.dev816.dist-info/LICENSE.md` & `stix_shifter_modules_msatp-5.3.0.dist-info/LICENSE.md`

 * *Files identical despite different names*

## Comparing `stix_shifter_modules_msatp-5.2.1.dev816.dist-info/METADATA` & `stix_shifter_modules_msatp-5.3.0.dist-info/METADATA`

 * *Files 10% similar despite different names*

```diff
@@ -1,66 +1,59 @@
 Metadata-Version: 2.1
 Name: stix-shifter-modules-msatp
-Version: 5.2.1.dev816
+Version: 5.3.0
 Summary: Tools and interface to translate STIX formatted results and queries to different data source formats and to set up appropriate connection strings for invoking and triggering actions in openwhisk
 Home-page: https://github.com/opencybersecurityalliance/stix-shifter
 Author: ibm
 Author-email: 
 Project-URL: Source, https://github.com/opencybersecurityalliance/stix-shifter
 Keywords: datasource stix translate transform transmit
 Classifier: License :: OSI Approved :: Apache Software License
 Classifier: Programming Language :: Python :: 3.8
 Classifier: Programming Language :: Python :: 3.9
 Description-Content-Type: text/markdown
 License-File: LICENSE.md
 License-File: NOTICE
 
+[![example workflow](https://github.com/opencybersecurityalliance/stix-shifter/actions/workflows/main.yml/badge.svg)](https://github.com/opencybersecurityalliance/stix-shifter/actions)
 [![codecov](https://codecov.io/gh/opencybersecurityalliance/stix-shifter/branch/develop/graph/badge.svg?token=gQvl14peRj)](https://codecov.io/gh/opencybersecurityalliance/stix-shifter)
 
-### Join us on Slack!
-
-[Click here](https://docs.google.com/forms/d/1vEAqg9SKBF3UMtmbJJ9qqLarrXN5zeVG3_obedA3DKs) and fill out the form to receive an invite to the Open Cybersecurity Alliance slack instance, then join the #stix-shifter channel, to meet and discuss usage with the team.
-
-### Introduction Webinar!
-
-[Click here](https://ibm.biz/BdzTyA) to view an introduction webinar on STIX Shifter and the use cases it solves for.
-
-### Introduction
+# Introduction to STIX-Shifter
 
 STIX-shifter is an open source python library allowing software to connect to products that house data repositories by using STIX Patterning, and return results as STIX Observations.
 
-For more information about this project, see the [STIX-shifter Overview](https://github.com/opencybersecurityalliance/stix-shifter/blob/develop/OVERVIEW.md)
+This library takes in STIX 2 Patterns as input, and "finds" data that matches the patterns inside various products that house repositories of cybersecurity data. Examples of such products include SIEM systems, endpoint management systems, threat intelligence platforms, orchestration platforms, network control points, data lakes, and more.
 
-### Dependencies
+In addition to "finding" the data by using these patterns, STIX-Shifter also _transforms the output_ into STIX 2 Observations. Why would we do that you ask? To put it simply - so that all of the security data, regardless of the source, mostly looks and behaves the same.
 
-This stix-shifter has the following dependencies:
+[## Project Overview and CLI Commands](https://github.com/opencybersecurityalliance/stix-shifter/blob/develop/OVERVIEW.md)
 
-- [stix2-patterns==1.3.0](https://pypi.org/project/stix2-patterns/)
-- [stix2-validator==1.1.2](https://pypi.org/project/stix2-validator/)
-- [stix2-matcher==1.0.0](https://pypi.org/project/stix2-matcher/)
-- [antlr4-python3-runtime==4.8](https://pypi.org/project/antlr4-python3-runtime/)
-- [python-dateutil==2.8.1](https://pypi.org/project/python-dateutil/)
+For general information about STIX, this project, and the command line utilities, see the [STIX-shifter Overview](https://github.com/opencybersecurityalliance/stix-shifter/blob/develop/OVERVIEW.md)
 
-Your development environment must use Python version: 3.8 greater
 
-## Installation
+# Installation
 
-The recommended method for installing the STIX-shifter is via pip. Two prerequisite packages needs to be installed inlcuding the package of stix-shifter connector module to complete a stix-shifter connector installation. Run below commands to install all the packages-
+The recommended method for installing stix-shifter is via pip. Two prerequisite packages needs to be installed inlcuding the package of stix-shifter connector module to complete a stix-shifter connector installation. Run the below commands to install all the packages:
 
 1. Main stix-shifter package:  `pip install stix-shifter`
 
 2. Stix-shifter Utility package:  `pip install stix-shifter-utils`
 
 3. Desired stix-shifter connector module package:  `pip install stix-shifter-modules-<module name> `
    Example:  `pip install stix-shifter-modules-qradar`
 
-## Usage
+## Dependencies
+
+STIX-shifter requries Python 3.8 or greater. See the [requirements file](stix_shifter/requirements.txt) for library dependencies. 
 
+# Usage
 
-### As A Command Line Utility
+STIX-Shifter can use used the following ways:
+
+## 1. As a command line utility
 
 The STIX-Shifter comes with a bundled script which you can use to translate STIX Pattern to a native datasource query. It can also be used to translate a JSON data source query result to a STIX bundle of observable objects. You can also send query to a datasource by using a transmission option. 
 
 More details of the command line option can be found [here](https://github.com/opencybersecurityalliance/stix-shifter/blob/master/OVERVIEW.md#how-to-use)
 
 ```
 $ stix-shifter translate <MODULE NAME> query "<STIX IDENTITY OBJECT>" "<STIX PATTERN>" "<OPTIONS>"
@@ -73,17 +66,17 @@
 In order to build `stix-shifter` packages from source follow the below prerequisite steps:
    1. Go to the stix-shifter parent directory
    2. Optionally, you can create a Python 3 virtual environemnt:
        `virtualenv -p python3 virtualenv && source virtualenv/bin/activate`
    3. Run setup: `python3 setup.py install`
 
 
-### Running From the Source
+## 2. Running from the source
 
-You may also use `python3 main.py` script. All the options are the same as "As a command line utility" usage above.
+You may also use the `python3 main.py` script. All the options are the same as the command line utility described above.
 
 Example:
 
 ```
 python3 main.py translate qradar query {} "[ipv4-addr:value = '127.0.0.1']" {}
 ```
 
@@ -91,15 +84,15 @@
    1. Go to the stix-shifter parent directory
    2. Optionally, you can create a Python 3 virtual environemnt:
        `virtualenv -p python3 virtualenv && source virtualenv/bin/activate`
    3. Run setup to install dependancies: `INSTALL_REQUIREMENTS_ONLY=1 python3 setup.py install`. 
 
 **Note:** setup.py only installs dependencies when INSTALL_REQUIREMENTS_ONLY=1 directive is used. This option is similar to `python3 generate_requirements.py && pip install -r requirements.txt`
 
-### As A Library
+## 3. As a library
 
 You can also use this library to integrate STIX Shifter into your own tools. You can translate a STIX Pattern:
 
 ```
 from stix_shifter.stix_translation import stix_translation
 
 translation = stix_translation.StixTranslation()
@@ -109,35 +102,47 @@
 ```
 ### Use of custom mappings
 
 If a connector has been installed using pip, the process for editing the STIX mappings is different than if you have pulled-down the project. When working locally, you can edit the mapping files directly. See the [mapping files for the MySQL connector](stix_shifter_modules/mysql/stix_translation/json) as an example. Editing the mapping files won't work if the connector has been installed with pip; the setup script of the stix-shifter package includes the mapppings inside `config.json`. This allows stix-shifter to injest custom mappings as part of the connector's configuration.
 
 Refer to [Use of custom mappings](https://github.com/opencybersecurityalliance/stix-shifter/blob/develop/adapter-guide/custom_mappings.md) for more details on how to edit the mappings in the configuration.
 
-## Contributing
+# Contributing
 
 We are thrilled you are considering contributing! We welcome all contributors.
-
 Please read our [guidelines for contributing](https://github.com/opencybersecurityalliance/stix-shifter/blob/develop/CONTRIBUTING.md).
 
-## Developer Guides
+## [Connector Developer Guide](https://github.com/opencybersecurityalliance/stix-shifter/blob/develop/adapter-guide/develop-stix-adapter.md)
 
-If you want to create a new connector for STIX-shifter, see the [developer guide](https://github.com/opencybersecurityalliance/stix-shifter/blob/develop/adapter-guide/develop-stix-adapter.md)
+<!-- If you want to create a new connector for STIX-shifter, see the [developer guide](https://github.com/opencybersecurityalliance/stix-shifter/blob/develop/adapter-guide/develop-stix-adapter.md) -->
 
-There are also a few [Jupyter Notebook labs](https://github.com/opencybersecurityalliance/stix-shifter/blob/develop/lab) that cover the CLI commands and dev process.
+## [Jupyter Notebook Development Labs](https://github.com/opencybersecurityalliance/stix-shifter/blob/develop/lab)
 
-## Licensing
+<!-- There are also a few [Jupyter Notebook labs](https://github.com/opencybersecurityalliance/stix-shifter/blob/develop/lab) that cover the CLI commands and dev process. -->
+
+# Licensing
 
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at
 
     http://www.apache.org/licenses/LICENSE-2.0
 
 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
 
-## More Resources
-   - [Changelog](https://github.com/opencybersecurityalliance/stix-shifter/blob/develop/CHANGELOG.md)
+# More Resources
+
+## Join us on Slack!
+
+[Click here](https://docs.google.com/forms/d/1vEAqg9SKBF3UMtmbJJ9qqLarrXN5zeVG3_obedA3DKs) and fill out the form to receive an invite to the Open Cybersecurity Alliance slack instance, then join the #stix-shifter channel, to meet and discuss usage with the team.
+
+## Introduction Webinar!
+
+[Click here](https://ibm.biz/BdzTyA) to view an introduction webinar on STIX Shifter and the use cases it solves for.
+
+## Changelog
+
+- [Changelog](https://github.com/opencybersecurityalliance/stix-shifter/blob/develop/CHANGELOG.md)
```

## Comparing `stix_shifter_modules_msatp-5.2.1.dev816.dist-info/NOTICE` & `stix_shifter_modules_msatp-5.3.0.dist-info/NOTICE`

 * *Files identical despite different names*

## Comparing `stix_shifter_modules_msatp-5.2.1.dev816.dist-info/RECORD` & `stix_shifter_modules_msatp-5.3.0.dist-info/RECORD`

 * *Files 9% similar despite different names*

```diff
@@ -1,26 +1,27 @@
 stix_shifter_modules/msatp/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 stix_shifter_modules/msatp/entry_point.py,sha256=zhlhvXf6Qn3A3wcYJX-n0c0rLGkchn_8oMEldexcRwE,425
-stix_shifter_modules/msatp/configuration/config.json,sha256=erv50307uEeAceo1jNmf1co3-7Nv3yxUYlDQdnKEB74,84180
+stix_shifter_modules/msatp/configuration/config.json,sha256=xyhtbINp3Or89a7bE552dtlqgjiC1lnZXmlTfj1GcDw,191810
 stix_shifter_modules/msatp/configuration/dialects.json,sha256=tewYuoIE-WBBxsLTlOstMkMSUs6sFlEyW1dveC61xwk,78
-stix_shifter_modules/msatp/configuration/lang_en.json,sha256=Bt_9hBQVhpDId-xtxTSaeEhMwsS3NzIkuK2Ega3DEkI,3580
+stix_shifter_modules/msatp/configuration/lang_en.json,sha256=AJ-nfgt5IlkuZFCvdLfPa6ifzYYObOGBi98QbBmSKSc,5039
 stix_shifter_modules/msatp/stix_translation/__init__.py,sha256=AbpHGcgLb-kRsJGnwFEktk7uzpZOCcBY74-YBdrKVGs,1
-stix_shifter_modules/msatp/stix_translation/json_to_stix_translator.py,sha256=72KkjPPwPGUxxyhtYaq9CcFAOOKG_emxSqKeCnmveyw,21567
-stix_shifter_modules/msatp/stix_translation/query_constructor.py,sha256=FXWcBGVo_N5CnskPwUkUtMRcfciAxLyxkkiyzbnE0ew,18533
+stix_shifter_modules/msatp/stix_translation/json_to_stix_translator.py,sha256=8KbNAbPFHVIw6CN4tylW35GqJ1sxBZpaxpQaFAM6e0M,22536
+stix_shifter_modules/msatp/stix_translation/query_constructor.py,sha256=Sds-DOc0j3PDktT45NYgqwPL2GYag_XUMCn85FUjs5Y,18741
 stix_shifter_modules/msatp/stix_translation/query_translator.py,sha256=tPOKCH8_ueGfhbGaEjJZcMIEl4B8787nw5R23flMoMU,1038
-stix_shifter_modules/msatp/stix_translation/results_translator.py,sha256=DG5PcExUGumeGNNhjWAdFq2YJK24T0vg8WKM5MQ5H1k,133
-stix_shifter_modules/msatp/stix_translation/transformers.py,sha256=ZkNF8rfG0eIbEETfdmttm8S4qceKJT7eGuK03xa4qpE,1649
-stix_shifter_modules/msatp/stix_translation/json/from_stix_map.json,sha256=NdKLBOBmdDi1z7J2PBdGExhVxvbSQYR5yJsH_M2n2YQ,16632
+stix_shifter_modules/msatp/stix_translation/results_translator.py,sha256=cMXZZZuMShDHbl1V0kSnd0zF_yU4YChPIPDh9blMj44,8390
+stix_shifter_modules/msatp/stix_translation/transformers.py,sha256=yJhqm4qyC2HZz-FQWrYroPx0Ytb4BFXEXk7xICra9mQ,5510
+stix_shifter_modules/msatp/stix_translation/json/from_stix_map.json,sha256=nFjEbCUl4oiEbkcy8UeOLgIeOs78ryjY4wYnEJbhHUE,20749
 stix_shifter_modules/msatp/stix_translation/json/operators.json,sha256=rfECBPtyeCEWZGrj_h0q6ksWJZwZZrT-BkD1f0OspiQ,583
-stix_shifter_modules/msatp/stix_translation/json/to_stix_map.json,sha256=8LNfhCTIBQ_14IWvUAZDc-dK6B2kCLVSSkSOdf7ivSw,23675
-stix_shifter_modules/msatp/stix_translation/json/stix_2_1/from_stix_map.json,sha256=j2fcEegvL_ZFXzPC3NlZsfNBg2DHQ_rBM06626f6Oq8,16206
-stix_shifter_modules/msatp/stix_translation/json/stix_2_1/to_stix_map.json,sha256=RsZgVW1XExgcixW8p4MgDvtG3lt6jOARnrMrPAGrd14,22959
+stix_shifter_modules/msatp/stix_translation/json/to_stix_map.json,sha256=Mj-ZpckZIZ9vpZrOv11YCpxkokWEAncJ9QiLt6ZcP_A,69903
+stix_shifter_modules/msatp/stix_translation/json/stix_2_1/from_stix_map.json,sha256=_VlTGRLC5xq7t1Xqs4JO9qvNm0k7Iu4wD2ZpxrG0mKI,20764
+stix_shifter_modules/msatp/stix_translation/json/stix_2_1/to_stix_map.json,sha256=ClM2cE90pF3ku82lmPckryKX1ZeFcgd5-6R8ysenDRM,68275
 stix_shifter_modules/msatp/stix_transmission/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-stix_shifter_modules/msatp/stix_transmission/api_client.py,sha256=c-gl04tvASZtpT71788Sb7vorN46pepkp-0PnFDs_54,2313
-stix_shifter_modules/msatp/stix_transmission/connector.py,sha256=MKcqQFEdyQPetQkHOrNumojfIVnTPbdtbi0rYF6hKwY,6555
+stix_shifter_modules/msatp/stix_transmission/api_client.py,sha256=qkndj5xxAu3-RtXTsf6NAnNIMmzDfxfIuGp1v-c-uOw,2952
+stix_shifter_modules/msatp/stix_transmission/connector.py,sha256=9Ud5sONBlRHd4v2Ex8GZWJ5TRYKI2qRITOmanheCPZg,3779
+stix_shifter_modules/msatp/stix_transmission/connector_post_processing.py,sha256=U81Dm90jO1ElomLhNrw8FHPWaPEHL3SrppWv05bhe9U,11998
 stix_shifter_modules/msatp/stix_transmission/error_mapper.py,sha256=DjdDVRyTJNgAGlbWIUo6zxBxTCLwJeQqE4Ejy1krqYU,1850
-stix_shifter_modules_msatp-5.2.1.dev816.dist-info/LICENSE.md,sha256=ssGEKMVW69oFTBblVhD1YPolqCOyOCJi4wRDRI7xCnU,12786
-stix_shifter_modules_msatp-5.2.1.dev816.dist-info/METADATA,sha256=DrWChjCQgjc7QYwUH9NGE8LycLy7vHXVCTPsK606SH0,7091
-stix_shifter_modules_msatp-5.2.1.dev816.dist-info/NOTICE,sha256=wx-gWE9vSnLJ7YQkrGlMp9VNXOXG57TTxDDRd9CEdYg,1418
-stix_shifter_modules_msatp-5.2.1.dev816.dist-info/WHEEL,sha256=bb2Ot9scclHKMOLDEHY6B2sicWOgugjFKaJsT7vwMQo,110
-stix_shifter_modules_msatp-5.2.1.dev816.dist-info/top_level.txt,sha256=NX-VgUOr8fI-lMXHt3gtjfsEn1UPaGAVszt6Z_CTp2s,21
-stix_shifter_modules_msatp-5.2.1.dev816.dist-info/RECORD,,
+stix_shifter_modules_msatp-5.3.0.dist-info/LICENSE.md,sha256=ssGEKMVW69oFTBblVhD1YPolqCOyOCJi4wRDRI7xCnU,12786
+stix_shifter_modules_msatp-5.3.0.dist-info/METADATA,sha256=uKuWmYZ7fOLC7qw9u5SS5FFgIG9UZAOwEx1qu60Qxa8,8035
+stix_shifter_modules_msatp-5.3.0.dist-info/NOTICE,sha256=wx-gWE9vSnLJ7YQkrGlMp9VNXOXG57TTxDDRd9CEdYg,1418
+stix_shifter_modules_msatp-5.3.0.dist-info/WHEEL,sha256=bb2Ot9scclHKMOLDEHY6B2sicWOgugjFKaJsT7vwMQo,110
+stix_shifter_modules_msatp-5.3.0.dist-info/top_level.txt,sha256=NX-VgUOr8fI-lMXHt3gtjfsEn1UPaGAVszt6Z_CTp2s,21
+stix_shifter_modules_msatp-5.3.0.dist-info/RECORD,,
```

