# Comparing `tmp/mlrun-1.4.0rc3-py3-none-any.whl.zip` & `tmp/mlrun-1.4.0rc4-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,404 +1,412 @@
-Zip file size: 1176317 bytes, number of entries: 402
--rw-r--r--  2.0 unx     8727 b- defN 23-May-10 16:31 mlrun/__init__.py
--rw-r--r--  2.0 unx    49356 b- defN 23-May-10 16:31 mlrun/__main__.py
--rw-r--r--  2.0 unx    25103 b- defN 23-May-10 16:31 mlrun/builder.py
--rw-r--r--  2.0 unx    54803 b- defN 23-May-10 16:31 mlrun/config.py
--rw-r--r--  2.0 unx     6780 b- defN 23-May-10 16:31 mlrun/errors.py
--rw-r--r--  2.0 unx    39096 b- defN 23-May-10 16:31 mlrun/execution.py
--rw-r--r--  2.0 unx    15624 b- defN 23-May-10 16:31 mlrun/features.py
--rw-r--r--  2.0 unx     4880 b- defN 23-May-10 16:31 mlrun/k8s_utils.py
--rw-r--r--  2.0 unx    29645 b- defN 23-May-10 16:31 mlrun/kfpops.py
--rw-r--r--  2.0 unx     8360 b- defN 23-May-10 16:31 mlrun/lists.py
--rw-r--r--  2.0 unx    53415 b- defN 23-May-10 16:31 mlrun/model.py
--rw-r--r--  2.0 unx    11828 b- defN 23-May-10 16:31 mlrun/render.py
--rw-r--r--  2.0 unx    64472 b- defN 23-May-10 16:31 mlrun/run.py
--rw-r--r--  2.0 unx     7783 b- defN 23-May-10 16:31 mlrun/secrets.py
--rw-r--r--  2.0 unx      571 b- defN 23-May-10 16:31 mlrun/api/__init__.py
--rw-r--r--  2.0 unx     2105 b- defN 23-May-10 16:31 mlrun/api/alembic.ini
--rw-r--r--  2.0 unx      685 b- defN 23-May-10 16:31 mlrun/api/constants.py
--rw-r--r--  2.0 unx    23464 b- defN 23-May-10 16:31 mlrun/api/initial_data.py
--rw-r--r--  2.0 unx    26288 b- defN 23-May-10 16:31 mlrun/api/main.py
--rw-r--r--  2.0 unx     5247 b- defN 23-May-10 16:31 mlrun/api/middlewares.py
--rw-r--r--  2.0 unx      571 b- defN 23-May-10 16:31 mlrun/api/api/__init__.py
--rw-r--r--  2.0 unx     4243 b- defN 23-May-10 16:31 mlrun/api/api/api.py
--rw-r--r--  2.0 unx     3197 b- defN 23-May-10 16:31 mlrun/api/api/deps.py
--rw-r--r--  2.0 unx    36432 b- defN 23-May-10 16:31 mlrun/api/api/utils.py
--rw-r--r--  2.0 unx      571 b- defN 23-May-10 16:31 mlrun/api/api/endpoints/__init__.py
--rw-r--r--  2.0 unx     9545 b- defN 23-May-10 16:31 mlrun/api/api/endpoints/artifacts.py
--rw-r--r--  2.0 unx     1199 b- defN 23-May-10 16:31 mlrun/api/api/endpoints/auth.py
--rw-r--r--  2.0 unx     3618 b- defN 23-May-10 16:31 mlrun/api/api/endpoints/background_tasks.py
--rw-r--r--  2.0 unx     1214 b- defN 23-May-10 16:31 mlrun/api/api/endpoints/client_spec.py
--rw-r--r--  2.0 unx     1175 b- defN 23-May-10 16:31 mlrun/api/api/endpoints/clusterization_spec.py
--rw-r--r--  2.0 unx    29675 b- defN 23-May-10 16:31 mlrun/api/api/endpoints/feature_store.py
--rw-r--r--  2.0 unx     6104 b- defN 23-May-10 16:31 mlrun/api/api/endpoints/files.py
--rw-r--r--  2.0 unx     5729 b- defN 23-May-10 16:31 mlrun/api/api/endpoints/frontend_spec.py
--rw-r--r--  2.0 unx    34608 b- defN 23-May-10 16:31 mlrun/api/api/endpoints/functions.py
--rw-r--r--  2.0 unx     5986 b- defN 23-May-10 16:31 mlrun/api/api/endpoints/grafana_proxy.py
--rw-r--r--  2.0 unx     1344 b- defN 23-May-10 16:31 mlrun/api/api/endpoints/healthz.py
--rw-r--r--  2.0 unx    10399 b- defN 23-May-10 16:31 mlrun/api/api/endpoints/hub.py
--rw-r--r--  2.0 unx     2450 b- defN 23-May-10 16:31 mlrun/api/api/endpoints/logs.py
--rw-r--r--  2.0 unx    15817 b- defN 23-May-10 16:31 mlrun/api/api/endpoints/model_endpoints.py
--rw-r--r--  2.0 unx     3756 b- defN 23-May-10 16:31 mlrun/api/api/endpoints/operations.py
--rw-r--r--  2.0 unx     9220 b- defN 23-May-10 16:31 mlrun/api/api/endpoints/pipelines.py
--rw-r--r--  2.0 unx    11494 b- defN 23-May-10 16:31 mlrun/api/api/endpoints/projects.py
--rw-r--r--  2.0 unx     9151 b- defN 23-May-10 16:31 mlrun/api/api/endpoints/runs.py
--rw-r--r--  2.0 unx     9063 b- defN 23-May-10 16:31 mlrun/api/api/endpoints/runtime_resources.py
--rw-r--r--  2.0 unx    10731 b- defN 23-May-10 16:31 mlrun/api/api/endpoints/schedules.py
--rw-r--r--  2.0 unx     6061 b- defN 23-May-10 16:31 mlrun/api/api/endpoints/secrets.py
--rw-r--r--  2.0 unx     5298 b- defN 23-May-10 16:31 mlrun/api/api/endpoints/submit.py
--rw-r--r--  2.0 unx     4894 b- defN 23-May-10 16:31 mlrun/api/api/endpoints/tags.py
--rw-r--r--  2.0 unx     1203 b- defN 23-May-10 16:31 mlrun/api/api/endpoints/internal/__init__.py
--rw-r--r--  2.0 unx     1043 b- defN 23-May-10 16:31 mlrun/api/api/endpoints/internal/config.py
--rw-r--r--  2.0 unx     1724 b- defN 23-May-10 16:31 mlrun/api/api/endpoints/internal/memory_reports.py
--rw-r--r--  2.0 unx     1209 b- defN 23-May-10 16:31 mlrun/api/crud/__init__.py
--rw-r--r--  2.0 unx     5610 b- defN 23-May-10 16:31 mlrun/api/crud/artifacts.py
--rw-r--r--  2.0 unx     7331 b- defN 23-May-10 16:31 mlrun/api/crud/client_spec.py
--rw-r--r--  2.0 unx     1055 b- defN 23-May-10 16:31 mlrun/api/crud/clusterization_spec.py
--rw-r--r--  2.0 unx    18628 b- defN 23-May-10 16:31 mlrun/api/crud/feature_store.py
--rw-r--r--  2.0 unx     3556 b- defN 23-May-10 16:31 mlrun/api/crud/functions.py
--rw-r--r--  2.0 unx    12025 b- defN 23-May-10 16:31 mlrun/api/crud/hub.py
--rw-r--r--  2.0 unx     9729 b- defN 23-May-10 16:31 mlrun/api/crud/logs.py
--rw-r--r--  2.0 unx     2751 b- defN 23-May-10 16:31 mlrun/api/crud/notifications.py
--rw-r--r--  2.0 unx    14030 b- defN 23-May-10 16:31 mlrun/api/crud/pipelines.py
--rw-r--r--  2.0 unx    14269 b- defN 23-May-10 16:31 mlrun/api/crud/projects.py
--rw-r--r--  2.0 unx     6020 b- defN 23-May-10 16:31 mlrun/api/crud/runs.py
--rw-r--r--  2.0 unx     5575 b- defN 23-May-10 16:31 mlrun/api/crud/runtime_resources.py
--rw-r--r--  2.0 unx    20145 b- defN 23-May-10 16:31 mlrun/api/crud/secrets.py
--rw-r--r--  2.0 unx     3277 b- defN 23-May-10 16:31 mlrun/api/crud/tags.py
--rw-r--r--  2.0 unx      722 b- defN 23-May-10 16:31 mlrun/api/crud/model_monitoring/__init__.py
--rw-r--r--  2.0 unx    15692 b- defN 23-May-10 16:31 mlrun/api/crud/model_monitoring/grafana.py
--rw-r--r--  2.0 unx    43000 b- defN 23-May-10 16:31 mlrun/api/crud/model_monitoring/model_endpoints.py
--rw-r--r--  2.0 unx      571 b- defN 23-May-10 16:31 mlrun/api/crud/runtimes/__init__.py
--rw-r--r--  2.0 unx      571 b- defN 23-May-10 16:31 mlrun/api/crud/runtimes/nuclio/__init__.py
--rw-r--r--  2.0 unx    17168 b- defN 23-May-10 16:31 mlrun/api/crud/runtimes/nuclio/function.py
--rw-r--r--  2.0 unx    11398 b- defN 23-May-10 16:31 mlrun/api/crud/runtimes/nuclio/helpers.py
--rw-r--r--  2.0 unx      571 b- defN 23-May-10 16:31 mlrun/api/db/__init__.py
--rw-r--r--  2.0 unx    15056 b- defN 23-May-10 16:31 mlrun/api/db/base.py
--rw-r--r--  2.0 unx      870 b- defN 23-May-10 16:31 mlrun/api/db/init_db.py
--rw-r--r--  2.0 unx      993 b- defN 23-May-10 16:31 mlrun/api/db/session.py
--rw-r--r--  2.0 unx      571 b- defN 23-May-10 16:31 mlrun/api/db/sqldb/__init__.py
--rw-r--r--  2.0 unx   144042 b- defN 23-May-10 16:31 mlrun/api/db/sqldb/db.py
--rw-r--r--  2.0 unx     2340 b- defN 23-May-10 16:31 mlrun/api/db/sqldb/helpers.py
--rw-r--r--  2.0 unx     2542 b- defN 23-May-10 16:31 mlrun/api/db/sqldb/session.py
--rw-r--r--  2.0 unx     1063 b- defN 23-May-10 16:31 mlrun/api/db/sqldb/models/__init__.py
--rw-r--r--  2.0 unx    20642 b- defN 23-May-10 16:31 mlrun/api/db/sqldb/models/models_mysql.py
--rw-r--r--  2.0 unx    18304 b- defN 23-May-10 16:31 mlrun/api/db/sqldb/models/models_sqlite.py
--rw-r--r--  2.0 unx     2906 b- defN 23-May-10 16:31 mlrun/api/migrations_mysql/env.py
--rw-r--r--  2.0 unx     1203 b- defN 23-May-10 16:31 mlrun/api/migrations_mysql/versions/28383af526f3_market_place_to_hub.py
--rw-r--r--  2.0 unx     4614 b- defN 23-May-10 16:31 mlrun/api/migrations_mysql/versions/32bae1b0e29c_increase_timestamp_fields_precision.py
--rw-r--r--  2.0 unx     1936 b- defN 23-May-10 16:31 mlrun/api/migrations_mysql/versions/4903aef6a91d_tag_foreign_key_and_cascades.py
--rw-r--r--  2.0 unx     1909 b- defN 23-May-10 16:31 mlrun/api/migrations_mysql/versions/5f1351c88a19_adding_background_tasks_table.py
--rw-r--r--  2.0 unx     1415 b- defN 23-May-10 16:31 mlrun/api/migrations_mysql/versions/88e656800d6a_add_requested_logs_column_and_index_to_.py
--rw-r--r--  2.0 unx     1504 b- defN 23-May-10 16:31 mlrun/api/migrations_mysql/versions/9d16de5f03a7_adding_data_versions_table.py
--rw-r--r--  2.0 unx     1649 b- defN 23-May-10 16:31 mlrun/api/migrations_mysql/versions/b86f5b53f3d7_adding_name_and_updated_to_runs_table.py
--rw-r--r--  2.0 unx    24057 b- defN 23-May-10 16:31 mlrun/api/migrations_mysql/versions/c4af40b0bf61_init.py
--rw-r--r--  2.0 unx     2457 b- defN 23-May-10 16:31 mlrun/api/migrations_mysql/versions/c905d15bd91d_notifications.py
--rw-r--r--  2.0 unx     1351 b- defN 23-May-10 16:31 mlrun/api/migrations_mysql/versions/ee041e8fdaa0_adding_next_run_time_column_to_schedule_.py
--rw-r--r--  2.0 unx     2906 b- defN 23-May-10 16:31 mlrun/api/migrations_sqlite/env.py
--rw-r--r--  2.0 unx    11473 b- defN 23-May-10 16:31 mlrun/api/migrations_sqlite/versions/11f8dd2dc9fe_init.py
--rw-r--r--  2.0 unx     1348 b- defN 23-May-10 16:31 mlrun/api/migrations_sqlite/versions/1c954f8cb32d_schedule_last_run_uri.py
--rw-r--r--  2.0 unx     5180 b- defN 23-May-10 16:31 mlrun/api/migrations_sqlite/versions/2b6d23c715aa_adding_feature_sets.py
--rw-r--r--  2.0 unx     2595 b- defN 23-May-10 16:31 mlrun/api/migrations_sqlite/versions/4acd9430b093_market_place_to_hub.py
--rw-r--r--  2.0 unx     1388 b- defN 23-May-10 16:31 mlrun/api/migrations_sqlite/versions/6401142f2d7c_adding_next_run_time_column_to_schedule_.py
--rw-r--r--  2.0 unx     1767 b- defN 23-May-10 16:31 mlrun/api/migrations_sqlite/versions/64d90a1a69bc_adding_background_tasks_table.py
--rw-r--r--  2.0 unx     1360 b- defN 23-May-10 16:31 mlrun/api/migrations_sqlite/versions/803438ecd005_add_requested_logs_column_to_runs.py
--rw-r--r--  2.0 unx     1259 b- defN 23-May-10 16:31 mlrun/api/migrations_sqlite/versions/863114f0c659_refactoring_feature_set.py
--rw-r--r--  2.0 unx     2147 b- defN 23-May-10 16:31 mlrun/api/migrations_sqlite/versions/959ae00528ad_notifications.py
--rw-r--r--  2.0 unx     1482 b- defN 23-May-10 16:31 mlrun/api/migrations_sqlite/versions/accf9fc83d38_adding_data_versions_table.py
--rw-r--r--  2.0 unx     1892 b- defN 23-May-10 16:31 mlrun/api/migrations_sqlite/versions/b68e8e897a28_schedule_labels.py
--rw-r--r--  2.0 unx     1882 b- defN 23-May-10 16:31 mlrun/api/migrations_sqlite/versions/bcd0c1f9720c_adding_project_labels.py
--rw-r--r--  2.0 unx     1420 b- defN 23-May-10 16:31 mlrun/api/migrations_sqlite/versions/cf21882f938e_schedule_id.py
--rw-r--r--  2.0 unx     2034 b- defN 23-May-10 16:31 mlrun/api/migrations_sqlite/versions/d781f58f607f_tag_object_name_string.py
--rw-r--r--  2.0 unx     1828 b- defN 23-May-10 16:31 mlrun/api/migrations_sqlite/versions/deac06871ace_adding_marketplace_sources_table.py
--rw-r--r--  2.0 unx     1380 b- defN 23-May-10 16:31 mlrun/api/migrations_sqlite/versions/e1dd5983c06b_schedule_concurrency_limit.py
--rw-r--r--  2.0 unx     1831 b- defN 23-May-10 16:31 mlrun/api/migrations_sqlite/versions/e5594ed3ab53_adding_name_and_updated_to_runs_table.py
--rw-r--r--  2.0 unx     3936 b- defN 23-May-10 16:31 mlrun/api/migrations_sqlite/versions/f4249b4ba6fa_adding_feature_vectors.py
--rw-r--r--  2.0 unx     2588 b- defN 23-May-10 16:31 mlrun/api/migrations_sqlite/versions/f7b5a1a03629_adding_feature_labels.py
--rw-r--r--  2.0 unx    13338 b- defN 23-May-10 16:31 mlrun/api/schemas/__init__.py
--rw-r--r--  2.0 unx      571 b- defN 23-May-10 16:31 mlrun/api/utils/__init__.py
--rw-r--r--  2.0 unx     1092 b- defN 23-May-10 16:31 mlrun/api/utils/asyncio.py
--rw-r--r--  2.0 unx     7371 b- defN 23-May-10 16:31 mlrun/api/utils/background_tasks.py
--rw-r--r--  2.0 unx     2431 b- defN 23-May-10 16:31 mlrun/api/utils/helpers.py
--rw-r--r--  2.0 unx     3728 b- defN 23-May-10 16:31 mlrun/api/utils/memory_reports.py
--rw-r--r--  2.0 unx     2599 b- defN 23-May-10 16:31 mlrun/api/utils/periodic.py
--rw-r--r--  2.0 unx    39305 b- defN 23-May-10 16:31 mlrun/api/utils/scheduler.py
--rw-r--r--  2.0 unx      571 b- defN 23-May-10 16:31 mlrun/api/utils/auth/__init__.py
--rw-r--r--  2.0 unx    12383 b- defN 23-May-10 16:31 mlrun/api/utils/auth/verifier.py
--rw-r--r--  2.0 unx      571 b- defN 23-May-10 16:31 mlrun/api/utils/auth/providers/__init__.py
--rw-r--r--  2.0 unx     1381 b- defN 23-May-10 16:31 mlrun/api/utils/auth/providers/base.py
--rw-r--r--  2.0 unx     1460 b- defN 23-May-10 16:31 mlrun/api/utils/auth/providers/nop.py
--rw-r--r--  2.0 unx    10883 b- defN 23-May-10 16:31 mlrun/api/utils/auth/providers/opa.py
--rw-r--r--  2.0 unx      571 b- defN 23-May-10 16:31 mlrun/api/utils/clients/__init__.py
--rw-r--r--  2.0 unx    13271 b- defN 23-May-10 16:31 mlrun/api/utils/clients/chief.py
--rw-r--r--  2.0 unx    31266 b- defN 23-May-10 16:31 mlrun/api/utils/clients/iguazio.py
--rw-r--r--  2.0 unx    12109 b- defN 23-May-10 16:31 mlrun/api/utils/clients/log_collector.py
--rw-r--r--  2.0 unx     9916 b- defN 23-May-10 16:31 mlrun/api/utils/clients/nuclio.py
--rw-r--r--  2.0 unx      571 b- defN 23-May-10 16:31 mlrun/api/utils/clients/protocols/__init__.py
--rw-r--r--  2.0 unx     2567 b- defN 23-May-10 16:31 mlrun/api/utils/clients/protocols/grpc.py
--rw-r--r--  2.0 unx      571 b- defN 23-May-10 16:31 mlrun/api/utils/db/__init__.py
--rw-r--r--  2.0 unx     3305 b- defN 23-May-10 16:31 mlrun/api/utils/db/alembic.py
--rw-r--r--  2.0 unx     8214 b- defN 23-May-10 16:31 mlrun/api/utils/db/backup.py
--rw-r--r--  2.0 unx     3795 b- defN 23-May-10 16:31 mlrun/api/utils/db/mysql.py
--rw-r--r--  2.0 unx      992 b- defN 23-May-10 16:31 mlrun/api/utils/db/sql_collation.py
--rw-r--r--  2.0 unx     3855 b- defN 23-May-10 16:31 mlrun/api/utils/db/sqlite_migration.py
--rw-r--r--  2.0 unx      571 b- defN 23-May-10 16:31 mlrun/api/utils/projects/__init__.py
--rw-r--r--  2.0 unx    17423 b- defN 23-May-10 16:31 mlrun/api/utils/projects/follower.py
--rw-r--r--  2.0 unx    19549 b- defN 23-May-10 16:31 mlrun/api/utils/projects/leader.py
--rw-r--r--  2.0 unx     7133 b- defN 23-May-10 16:31 mlrun/api/utils/projects/member.py
--rw-r--r--  2.0 unx      571 b- defN 23-May-10 16:31 mlrun/api/utils/projects/remotes/__init__.py
--rw-r--r--  2.0 unx     2659 b- defN 23-May-10 16:31 mlrun/api/utils/projects/remotes/follower.py
--rw-r--r--  2.0 unx     2094 b- defN 23-May-10 16:31 mlrun/api/utils/projects/remotes/leader.py
--rw-r--r--  2.0 unx     5000 b- defN 23-May-10 16:31 mlrun/api/utils/projects/remotes/nop_follower.py
--rw-r--r--  2.0 unx     3861 b- defN 23-May-10 16:31 mlrun/api/utils/projects/remotes/nop_leader.py
--rw-r--r--  2.0 unx      571 b- defN 23-May-10 16:31 mlrun/api/utils/singletons/__init__.py
--rw-r--r--  2.0 unx     1202 b- defN 23-May-10 16:31 mlrun/api/utils/singletons/db.py
--rw-r--r--  2.0 unx    22630 b- defN 23-May-10 16:31 mlrun/api/utils/singletons/k8s.py
--rw-r--r--  2.0 unx      840 b- defN 23-May-10 16:31 mlrun/api/utils/singletons/logs_dir.py
--rw-r--r--  2.0 unx     1279 b- defN 23-May-10 16:31 mlrun/api/utils/singletons/project_member.py
--rw-r--r--  2.0 unx     1063 b- defN 23-May-10 16:31 mlrun/api/utils/singletons/scheduler.py
--rw-r--r--  2.0 unx     1091 b- defN 23-May-10 16:31 mlrun/artifacts/__init__.py
--rw-r--r--  2.0 unx    30849 b- defN 23-May-10 16:31 mlrun/artifacts/base.py
--rw-r--r--  2.0 unx    20432 b- defN 23-May-10 16:31 mlrun/artifacts/dataset.py
--rw-r--r--  2.0 unx    12110 b- defN 23-May-10 16:31 mlrun/artifacts/manager.py
--rw-r--r--  2.0 unx    23673 b- defN 23-May-10 16:31 mlrun/artifacts/model.py
--rw-r--r--  2.0 unx    15383 b- defN 23-May-10 16:31 mlrun/artifacts/plots.py
--rw-r--r--  2.0 unx      571 b- defN 23-May-10 16:31 mlrun/common/__init__.py
--rw-r--r--  2.0 unx     5670 b- defN 23-May-10 16:31 mlrun/common/model_monitoring.py
--rw-r--r--  2.0 unx      790 b- defN 23-May-10 16:31 mlrun/common/types.py
--rw-r--r--  2.0 unx     3973 b- defN 23-May-10 16:31 mlrun/common/schemas/__init__.py
--rw-r--r--  2.0 unx     1923 b- defN 23-May-10 16:31 mlrun/common/schemas/artifact.py
--rw-r--r--  2.0 unx     5251 b- defN 23-May-10 16:31 mlrun/common/schemas/auth.py
--rw-r--r--  2.0 unx     1553 b- defN 23-May-10 16:31 mlrun/common/schemas/background_task.py
--rw-r--r--  2.0 unx     2751 b- defN 23-May-10 16:31 mlrun/common/schemas/client_spec.py
--rw-r--r--  2.0 unx      888 b- defN 23-May-10 16:31 mlrun/common/schemas/clusterization_spec.py
--rw-r--r--  2.0 unx     6243 b- defN 23-May-10 16:31 mlrun/common/schemas/constants.py
--rw-r--r--  2.0 unx     3671 b- defN 23-May-10 16:31 mlrun/common/schemas/feature_store.py
--rw-r--r--  2.0 unx     2546 b- defN 23-May-10 16:31 mlrun/common/schemas/frontend_spec.py
--rw-r--r--  2.0 unx     3971 b- defN 23-May-10 16:31 mlrun/common/schemas/function.py
--rw-r--r--  2.0 unx      705 b- defN 23-May-10 16:31 mlrun/common/schemas/http.py
--rw-r--r--  2.0 unx     4245 b- defN 23-May-10 16:31 mlrun/common/schemas/hub.py
--rw-r--r--  2.0 unx     1395 b- defN 23-May-10 16:31 mlrun/common/schemas/k8s.py
--rw-r--r--  2.0 unx      920 b- defN 23-May-10 16:31 mlrun/common/schemas/memory_reports.py
--rw-r--r--  2.0 unx    12528 b- defN 23-May-10 16:31 mlrun/common/schemas/model_endpoints.py
--rw-r--r--  2.0 unx      879 b- defN 23-May-10 16:31 mlrun/common/schemas/notification.py
--rw-r--r--  2.0 unx     1907 b- defN 23-May-10 16:31 mlrun/common/schemas/object.py
--rw-r--r--  2.0 unx     1184 b- defN 23-May-10 16:31 mlrun/common/schemas/pipeline.py
--rw-r--r--  2.0 unx     4094 b- defN 23-May-10 16:31 mlrun/common/schemas/project.py
--rw-r--r--  2.0 unx     1636 b- defN 23-May-10 16:31 mlrun/common/schemas/runtime_resource.py
--rw-r--r--  2.0 unx     4188 b- defN 23-May-10 16:31 mlrun/common/schemas/schedule.py
--rw-r--r--  2.0 unx     1484 b- defN 23-May-10 16:31 mlrun/common/schemas/secret.py
--rw-r--r--  2.0 unx      919 b- defN 23-May-10 16:31 mlrun/common/schemas/tag.py
--rw-r--r--  2.0 unx     1087 b- defN 23-May-10 16:31 mlrun/data_types/__init__.py
--rw-r--r--  2.0 unx     4647 b- defN 23-May-10 16:31 mlrun/data_types/data_types.py
--rw-r--r--  2.0 unx     5813 b- defN 23-May-10 16:31 mlrun/data_types/infer.py
--rw-r--r--  2.0 unx     9426 b- defN 23-May-10 16:31 mlrun/data_types/spark.py
--rw-r--r--  2.0 unx     3443 b- defN 23-May-10 16:31 mlrun/datastore/__init__.py
--rw-r--r--  2.0 unx     6946 b- defN 23-May-10 16:31 mlrun/datastore/azure_blob.py
--rw-r--r--  2.0 unx    18274 b- defN 23-May-10 16:31 mlrun/datastore/base.py
--rw-r--r--  2.0 unx     7995 b- defN 23-May-10 16:31 mlrun/datastore/datastore.py
--rw-r--r--  2.0 unx     3791 b- defN 23-May-10 16:31 mlrun/datastore/filestore.py
--rw-r--r--  2.0 unx     5114 b- defN 23-May-10 16:31 mlrun/datastore/google_cloud_storage.py
--rw-r--r--  2.0 unx     2627 b- defN 23-May-10 16:31 mlrun/datastore/inmem.py
--rw-r--r--  2.0 unx     4873 b- defN 23-May-10 16:31 mlrun/datastore/redis.py
--rw-r--r--  2.0 unx     7035 b- defN 23-May-10 16:31 mlrun/datastore/s3.py
--rw-r--r--  2.0 unx    34385 b- defN 23-May-10 16:31 mlrun/datastore/sources.py
--rw-r--r--  2.0 unx     1410 b- defN 23-May-10 16:31 mlrun/datastore/spark_udf.py
--rw-r--r--  2.0 unx     6895 b- defN 23-May-10 16:31 mlrun/datastore/store_resources.py
--rw-r--r--  2.0 unx    62060 b- defN 23-May-10 16:31 mlrun/datastore/targets.py
--rw-r--r--  2.0 unx     2409 b- defN 23-May-10 16:31 mlrun/datastore/utils.py
--rw-r--r--  2.0 unx     8097 b- defN 23-May-10 16:31 mlrun/datastore/v3io.py
--rw-r--r--  2.0 unx     1343 b- defN 23-May-10 16:31 mlrun/datastore/wasbfs/__init__.py
--rw-r--r--  2.0 unx     6152 b- defN 23-May-10 16:31 mlrun/datastore/wasbfs/fs.py
--rw-r--r--  2.0 unx     2816 b- defN 23-May-10 16:31 mlrun/db/__init__.py
--rw-r--r--  2.0 unx    15737 b- defN 23-May-10 16:31 mlrun/db/base.py
--rw-r--r--  2.0 unx   130695 b- defN 23-May-10 16:31 mlrun/db/httpdb.py
--rw-r--r--  2.0 unx    13197 b- defN 23-May-10 16:31 mlrun/db/nopdb.py
--rw-r--r--  2.0 unx    25917 b- defN 23-May-10 16:31 mlrun/db/sqldb.py
--rw-r--r--  2.0 unx     1501 b- defN 23-May-10 16:31 mlrun/feature_store/__init__.py
--rw-r--r--  2.0 unx    43820 b- defN 23-May-10 16:31 mlrun/feature_store/api.py
--rw-r--r--  2.0 unx    12781 b- defN 23-May-10 16:31 mlrun/feature_store/common.py
--rw-r--r--  2.0 unx    47273 b- defN 23-May-10 16:31 mlrun/feature_store/feature_set.py
--rw-r--r--  2.0 unx    21940 b- defN 23-May-10 16:31 mlrun/feature_store/feature_vector.py
--rw-r--r--  2.0 unx    11681 b- defN 23-May-10 16:31 mlrun/feature_store/ingestion.py
--rw-r--r--  2.0 unx    28635 b- defN 23-May-10 16:31 mlrun/feature_store/steps.py
--rw-r--r--  2.0 unx     1232 b- defN 23-May-10 16:31 mlrun/feature_store/retrieval/__init__.py
--rw-r--r--  2.0 unx    25911 b- defN 23-May-10 16:31 mlrun/feature_store/retrieval/base.py
--rw-r--r--  2.0 unx     4261 b- defN 23-May-10 16:31 mlrun/feature_store/retrieval/dask_merger.py
--rw-r--r--  2.0 unx     7106 b- defN 23-May-10 16:31 mlrun/feature_store/retrieval/job.py
--rw-r--r--  2.0 unx     4765 b- defN 23-May-10 16:31 mlrun/feature_store/retrieval/local_merger.py
--rw-r--r--  2.0 unx     3352 b- defN 23-May-10 16:31 mlrun/feature_store/retrieval/online.py
--rw-r--r--  2.0 unx     9661 b- defN 23-May-10 16:31 mlrun/feature_store/retrieval/spark_merger.py
--rw-r--r--  2.0 unx      743 b- defN 23-May-10 16:31 mlrun/frameworks/__init__.py
--rw-r--r--  2.0 unx    11466 b- defN 23-May-10 16:31 mlrun/frameworks/parallel_coordinates.py
--rw-r--r--  2.0 unx      962 b- defN 23-May-10 16:31 mlrun/frameworks/_common/__init__.py
--rw-r--r--  2.0 unx     8515 b- defN 23-May-10 16:31 mlrun/frameworks/_common/artifacts_library.py
--rw-r--r--  2.0 unx    21018 b- defN 23-May-10 16:31 mlrun/frameworks/_common/mlrun_interface.py
--rw-r--r--  2.0 unx    55376 b- defN 23-May-10 16:31 mlrun/frameworks/_common/model_handler.py
--rw-r--r--  2.0 unx     3469 b- defN 23-May-10 16:31 mlrun/frameworks/_common/plan.py
--rw-r--r--  2.0 unx     5757 b- defN 23-May-10 16:31 mlrun/frameworks/_common/producer.py
--rw-r--r--  2.0 unx     9209 b- defN 23-May-10 16:31 mlrun/frameworks/_common/utils.py
--rw-r--r--  2.0 unx      750 b- defN 23-May-10 16:31 mlrun/frameworks/_dl_common/__init__.py
--rw-r--r--  2.0 unx     1151 b- defN 23-May-10 16:31 mlrun/frameworks/_dl_common/model_handler.py
--rw-r--r--  2.0 unx      996 b- defN 23-May-10 16:31 mlrun/frameworks/_dl_common/utils.py
--rw-r--r--  2.0 unx      787 b- defN 23-May-10 16:31 mlrun/frameworks/_dl_common/loggers/__init__.py
--rw-r--r--  2.0 unx    11531 b- defN 23-May-10 16:31 mlrun/frameworks/_dl_common/loggers/logger.py
--rw-r--r--  2.0 unx    14777 b- defN 23-May-10 16:31 mlrun/frameworks/_dl_common/loggers/mlrun_logger.py
--rw-r--r--  2.0 unx    28414 b- defN 23-May-10 16:31 mlrun/frameworks/_dl_common/loggers/tensorboard_logger.py
--rw-r--r--  2.0 unx      956 b- defN 23-May-10 16:31 mlrun/frameworks/_ml_common/__init__.py
--rw-r--r--  2.0 unx     3169 b- defN 23-May-10 16:31 mlrun/frameworks/_ml_common/artifacts_library.py
--rw-r--r--  2.0 unx    16957 b- defN 23-May-10 16:31 mlrun/frameworks/_ml_common/model_handler.py
--rw-r--r--  2.0 unx     2368 b- defN 23-May-10 16:31 mlrun/frameworks/_ml_common/pkl_model_server.py
--rw-r--r--  2.0 unx     4881 b- defN 23-May-10 16:31 mlrun/frameworks/_ml_common/plan.py
--rw-r--r--  2.0 unx     4061 b- defN 23-May-10 16:31 mlrun/frameworks/_ml_common/producer.py
--rw-r--r--  2.0 unx    10490 b- defN 23-May-10 16:31 mlrun/frameworks/_ml_common/utils.py
--rw-r--r--  2.0 unx      737 b- defN 23-May-10 16:31 mlrun/frameworks/_ml_common/loggers/__init__.py
--rw-r--r--  2.0 unx     5684 b- defN 23-May-10 16:31 mlrun/frameworks/_ml_common/loggers/logger.py
--rw-r--r--  2.0 unx     6453 b- defN 23-May-10 16:31 mlrun/frameworks/_ml_common/loggers/mlrun_logger.py
--rw-r--r--  2.0 unx      922 b- defN 23-May-10 16:31 mlrun/frameworks/_ml_common/plans/__init__.py
--rw-r--r--  2.0 unx     5212 b- defN 23-May-10 16:31 mlrun/frameworks/_ml_common/plans/calibration_curve_plan.py
--rw-r--r--  2.0 unx     6078 b- defN 23-May-10 16:31 mlrun/frameworks/_ml_common/plans/confusion_matrix_plan.py
--rw-r--r--  2.0 unx     6658 b- defN 23-May-10 16:31 mlrun/frameworks/_ml_common/plans/dataset_plan.py
--rw-r--r--  2.0 unx     5318 b- defN 23-May-10 16:31 mlrun/frameworks/_ml_common/plans/feature_importance_plan.py
--rw-r--r--  2.0 unx     6993 b- defN 23-May-10 16:31 mlrun/frameworks/_ml_common/plans/roc_curve_plan.py
--rw-r--r--  2.0 unx      706 b- defN 23-May-10 16:31 mlrun/frameworks/auto_mlrun/__init__.py
--rw-r--r--  2.0 unx    23796 b- defN 23-May-10 16:31 mlrun/frameworks/auto_mlrun/auto_mlrun.py
--rw-r--r--  2.0 unx      721 b- defN 23-May-10 16:31 mlrun/frameworks/huggingface/__init__.py
--rw-r--r--  2.0 unx     6083 b- defN 23-May-10 16:31 mlrun/frameworks/huggingface/model_server.py
--rw-r--r--  2.0 unx    15883 b- defN 23-May-10 16:31 mlrun/frameworks/lgbm/__init__.py
--rw-r--r--  2.0 unx    13891 b- defN 23-May-10 16:31 mlrun/frameworks/lgbm/model_handler.py
--rw-r--r--  2.0 unx     9189 b- defN 23-May-10 16:31 mlrun/frameworks/lgbm/model_server.py
--rw-r--r--  2.0 unx     8278 b- defN 23-May-10 16:31 mlrun/frameworks/lgbm/utils.py
--rw-r--r--  2.0 unx      857 b- defN 23-May-10 16:31 mlrun/frameworks/lgbm/callbacks/__init__.py
--rw-r--r--  2.0 unx     4081 b- defN 23-May-10 16:31 mlrun/frameworks/lgbm/callbacks/callback.py
--rw-r--r--  2.0 unx     5156 b- defN 23-May-10 16:31 mlrun/frameworks/lgbm/callbacks/logging_callback.py
--rw-r--r--  2.0 unx     4137 b- defN 23-May-10 16:31 mlrun/frameworks/lgbm/callbacks/mlrun_logging_callback.py
--rw-r--r--  2.0 unx      842 b- defN 23-May-10 16:31 mlrun/frameworks/lgbm/mlrun_interfaces/__init__.py
--rw-r--r--  2.0 unx     1624 b- defN 23-May-10 16:31 mlrun/frameworks/lgbm/mlrun_interfaces/booster_mlrun_interface.py
--rw-r--r--  2.0 unx    14256 b- defN 23-May-10 16:31 mlrun/frameworks/lgbm/mlrun_interfaces/mlrun_interface.py
--rw-r--r--  2.0 unx     1333 b- defN 23-May-10 16:31 mlrun/frameworks/lgbm/mlrun_interfaces/model_mlrun_interface.py
--rw-r--r--  2.0 unx      791 b- defN 23-May-10 16:31 mlrun/frameworks/onnx/__init__.py
--rw-r--r--  2.0 unx     6098 b- defN 23-May-10 16:31 mlrun/frameworks/onnx/dataset.py
--rw-r--r--  2.0 unx     2405 b- defN 23-May-10 16:31 mlrun/frameworks/onnx/mlrun_interface.py
--rw-r--r--  2.0 unx     6203 b- defN 23-May-10 16:31 mlrun/frameworks/onnx/model_handler.py
--rw-r--r--  2.0 unx     7061 b- defN 23-May-10 16:31 mlrun/frameworks/onnx/model_server.py
--rw-r--r--  2.0 unx    22056 b- defN 23-May-10 16:31 mlrun/frameworks/pytorch/__init__.py
--rw-r--r--  2.0 unx    27904 b- defN 23-May-10 16:31 mlrun/frameworks/pytorch/callbacks_handler.py
--rw-r--r--  2.0 unx    44639 b- defN 23-May-10 16:31 mlrun/frameworks/pytorch/mlrun_interface.py
--rw-r--r--  2.0 unx    22465 b- defN 23-May-10 16:31 mlrun/frameworks/pytorch/model_handler.py
--rw-r--r--  2.0 unx    10136 b- defN 23-May-10 16:31 mlrun/frameworks/pytorch/model_server.py
--rw-r--r--  2.0 unx     4515 b- defN 23-May-10 16:31 mlrun/frameworks/pytorch/utils.py
--rw-r--r--  2.0 unx      896 b- defN 23-May-10 16:31 mlrun/frameworks/pytorch/callbacks/__init__.py
--rw-r--r--  2.0 unx    11524 b- defN 23-May-10 16:31 mlrun/frameworks/pytorch/callbacks/callback.py
--rw-r--r--  2.0 unx    23166 b- defN 23-May-10 16:31 mlrun/frameworks/pytorch/callbacks/logging_callback.py
--rw-r--r--  2.0 unx     9310 b- defN 23-May-10 16:31 mlrun/frameworks/pytorch/callbacks/mlrun_logging_callback.py
--rw-r--r--  2.0 unx    26661 b- defN 23-May-10 16:31 mlrun/frameworks/pytorch/callbacks/tensorboard_logging_callback.py
--rw-r--r--  2.0 unx    10892 b- defN 23-May-10 16:31 mlrun/frameworks/sklearn/__init__.py
--rw-r--r--  2.0 unx     5852 b- defN 23-May-10 16:31 mlrun/frameworks/sklearn/estimator.py
--rw-r--r--  2.0 unx     7117 b- defN 23-May-10 16:31 mlrun/frameworks/sklearn/metric.py
--rw-r--r--  2.0 unx    12215 b- defN 23-May-10 16:31 mlrun/frameworks/sklearn/metrics_library.py
--rw-r--r--  2.0 unx    14126 b- defN 23-May-10 16:31 mlrun/frameworks/sklearn/mlrun_interface.py
--rw-r--r--  2.0 unx     4745 b- defN 23-May-10 16:31 mlrun/frameworks/sklearn/model_handler.py
--rw-r--r--  2.0 unx     1209 b- defN 23-May-10 16:31 mlrun/frameworks/sklearn/utils.py
--rw-r--r--  2.0 unx    10455 b- defN 23-May-10 16:31 mlrun/frameworks/tf_keras/__init__.py
--rw-r--r--  2.0 unx    16627 b- defN 23-May-10 16:31 mlrun/frameworks/tf_keras/mlrun_interface.py
--rw-r--r--  2.0 unx    28247 b- defN 23-May-10 16:31 mlrun/frameworks/tf_keras/model_handler.py
--rw-r--r--  2.0 unx     9565 b- defN 23-May-10 16:31 mlrun/frameworks/tf_keras/model_server.py
--rw-r--r--  2.0 unx     4284 b- defN 23-May-10 16:31 mlrun/frameworks/tf_keras/utils.py
--rw-r--r--  2.0 unx      844 b- defN 23-May-10 16:31 mlrun/frameworks/tf_keras/callbacks/__init__.py
--rw-r--r--  2.0 unx    21886 b- defN 23-May-10 16:31 mlrun/frameworks/tf_keras/callbacks/logging_callback.py
--rw-r--r--  2.0 unx     8791 b- defN 23-May-10 16:31 mlrun/frameworks/tf_keras/callbacks/mlrun_logging_callback.py
--rw-r--r--  2.0 unx    28728 b- defN 23-May-10 16:31 mlrun/frameworks/tf_keras/callbacks/tensorboard_logging_callback.py
--rw-r--r--  2.0 unx    10287 b- defN 23-May-10 16:31 mlrun/frameworks/xgboost/__init__.py
--rw-r--r--  2.0 unx      878 b- defN 23-May-10 16:31 mlrun/frameworks/xgboost/mlrun_interface.py
--rw-r--r--  2.0 unx    11617 b- defN 23-May-10 16:31 mlrun/frameworks/xgboost/model_handler.py
--rw-r--r--  2.0 unx     1069 b- defN 23-May-10 16:31 mlrun/frameworks/xgboost/utils.py
--rw-r--r--  2.0 unx      760 b- defN 23-May-10 16:31 mlrun/mlutils/__init__.py
--rw-r--r--  2.0 unx     5325 b- defN 23-May-10 16:31 mlrun/mlutils/data.py
--rw-r--r--  2.0 unx     2598 b- defN 23-May-10 16:31 mlrun/mlutils/models.py
--rw-r--r--  2.0 unx    30120 b- defN 23-May-10 16:31 mlrun/mlutils/plots.py
--rw-r--r--  2.0 unx     1208 b- defN 23-May-10 16:31 mlrun/model_monitoring/__init__.py
--rw-r--r--  2.0 unx    23948 b- defN 23-May-10 16:31 mlrun/model_monitoring/features_drift_table.py
--rw-r--r--  2.0 unx     9756 b- defN 23-May-10 16:31 mlrun/model_monitoring/helpers.py
--rw-r--r--  2.0 unx     5196 b- defN 23-May-10 16:31 mlrun/model_monitoring/model_endpoint.py
--rw-r--r--  2.0 unx    36885 b- defN 23-May-10 16:31 mlrun/model_monitoring/model_monitoring_batch.py
--rw-r--r--  2.0 unx    43172 b- defN 23-May-10 16:31 mlrun/model_monitoring/stream_processing_fs.py
--rw-r--r--  2.0 unx     4240 b- defN 23-May-10 16:31 mlrun/model_monitoring/stores/__init__.py
--rw-r--r--  2.0 unx    17357 b- defN 23-May-10 16:31 mlrun/model_monitoring/stores/kv_model_endpoint_store.py
--rw-r--r--  2.0 unx     5695 b- defN 23-May-10 16:31 mlrun/model_monitoring/stores/model_endpoint_store.py
--rw-r--r--  2.0 unx    15706 b- defN 23-May-10 16:31 mlrun/model_monitoring/stores/sql_model_endpoint_store.py
--rw-r--r--  2.0 unx      884 b- defN 23-May-10 16:31 mlrun/model_monitoring/stores/models/__init__.py
--rw-r--r--  2.0 unx      655 b- defN 23-May-10 16:31 mlrun/model_monitoring/stores/models/base.py
--rw-r--r--  2.0 unx     3741 b- defN 23-May-10 16:31 mlrun/model_monitoring/stores/models/mysql.py
--rw-r--r--  2.0 unx     3658 b- defN 23-May-10 16:31 mlrun/model_monitoring/stores/models/sqlite.py
--rw-r--r--  2.0 unx     2400 b- defN 23-May-10 16:31 mlrun/platforms/__init__.py
--rw-r--r--  2.0 unx    24102 b- defN 23-May-10 16:31 mlrun/platforms/iguazio.py
--rw-r--r--  2.0 unx    11852 b- defN 23-May-10 16:31 mlrun/platforms/other.py
--rw-r--r--  2.0 unx     1153 b- defN 23-May-10 16:31 mlrun/projects/__init__.py
--rw-r--r--  2.0 unx    17480 b- defN 23-May-10 16:31 mlrun/projects/operations.py
--rw-r--r--  2.0 unx    38336 b- defN 23-May-10 16:31 mlrun/projects/pipelines.py
--rw-r--r--  2.0 unx   105214 b- defN 23-May-10 16:31 mlrun/projects/project.py
--rw-r--r--  2.0 unx     8773 b- defN 23-May-10 16:31 mlrun/runtimes/__init__.py
--rw-r--r--  2.0 unx   109329 b- defN 23-May-10 16:31 mlrun/runtimes/base.py
--rw-r--r--  2.0 unx     6689 b- defN 23-May-10 16:31 mlrun/runtimes/constants.py
--rw-r--r--  2.0 unx    30520 b- defN 23-May-10 16:31 mlrun/runtimes/daskjob.py
--rw-r--r--  2.0 unx     9190 b- defN 23-May-10 16:31 mlrun/runtimes/funcdoc.py
--rw-r--r--  2.0 unx    45205 b- defN 23-May-10 16:31 mlrun/runtimes/function.py
--rw-r--r--  2.0 unx     4911 b- defN 23-May-10 16:31 mlrun/runtimes/function_reference.py
--rw-r--r--  2.0 unx     6530 b- defN 23-May-10 16:31 mlrun/runtimes/generators.py
--rw-r--r--  2.0 unx    15406 b- defN 23-May-10 16:31 mlrun/runtimes/kubejob.py
--rw-r--r--  2.0 unx    18005 b- defN 23-May-10 16:31 mlrun/runtimes/local.py
--rw-r--r--  2.0 unx     2885 b- defN 23-May-10 16:31 mlrun/runtimes/nuclio.py
--rw-r--r--  2.0 unx    60644 b- defN 23-May-10 16:31 mlrun/runtimes/pod.py
--rw-r--r--  2.0 unx     7695 b- defN 23-May-10 16:31 mlrun/runtimes/remotesparkjob.py
--rw-r--r--  2.0 unx    29858 b- defN 23-May-10 16:31 mlrun/runtimes/serving.py
--rw-r--r--  2.0 unx    21131 b- defN 23-May-10 16:31 mlrun/runtimes/utils.py
--rw-r--r--  2.0 unx      790 b- defN 23-May-10 16:31 mlrun/runtimes/mpijob/__init__.py
--rw-r--r--  2.0 unx    14713 b- defN 23-May-10 16:31 mlrun/runtimes/mpijob/abstract.py
--rw-r--r--  2.0 unx    13845 b- defN 23-May-10 16:31 mlrun/runtimes/mpijob/v1.py
--rw-r--r--  2.0 unx     8460 b- defN 23-May-10 16:31 mlrun/runtimes/mpijob/v1alpha1.py
--rw-r--r--  2.0 unx      673 b- defN 23-May-10 16:31 mlrun/runtimes/package/__init__.py
--rw-r--r--  2.0 unx    27068 b- defN 23-May-10 16:31 mlrun/runtimes/package/context_handler.py
--rw-r--r--  2.0 unx      751 b- defN 23-May-10 16:31 mlrun/runtimes/sparkjob/__init__.py
--rw-r--r--  2.0 unx    35028 b- defN 23-May-10 16:31 mlrun/runtimes/sparkjob/abstract.py
--rw-r--r--  2.0 unx    28746 b- defN 23-May-10 16:31 mlrun/runtimes/sparkjob/spark3job.py
--rw-r--r--  2.0 unx     1078 b- defN 23-May-10 16:31 mlrun/serving/__init__.py
--rw-r--r--  2.0 unx     6116 b- defN 23-May-10 16:31 mlrun/serving/merger.py
--rw-r--r--  2.0 unx    18038 b- defN 23-May-10 16:31 mlrun/serving/remote.py
--rw-r--r--  2.0 unx    55277 b- defN 23-May-10 16:31 mlrun/serving/routers.py
--rw-r--r--  2.0 unx    20247 b- defN 23-May-10 16:31 mlrun/serving/server.py
--rw-r--r--  2.0 unx      836 b- defN 23-May-10 16:31 mlrun/serving/serving_wrapper.py
--rw-r--r--  2.0 unx    53940 b- defN 23-May-10 16:31 mlrun/serving/states.py
--rw-r--r--  2.0 unx     3902 b- defN 23-May-10 16:31 mlrun/serving/utils.py
--rw-r--r--  2.0 unx    11814 b- defN 23-May-10 16:31 mlrun/serving/v1_serving.py
--rw-r--r--  2.0 unx    21460 b- defN 23-May-10 16:31 mlrun/serving/v2_serving.py
--rw-r--r--  2.0 unx      826 b- defN 23-May-10 16:31 mlrun/utils/__init__.py
--rw-r--r--  2.0 unx    10397 b- defN 23-May-10 16:31 mlrun/utils/async_http.py
--rw-r--r--  2.0 unx     3456 b- defN 23-May-10 16:31 mlrun/utils/azure_vault.py
--rw-r--r--  2.0 unx     6245 b- defN 23-May-10 16:31 mlrun/utils/clones.py
--rw-r--r--  2.0 unx     1662 b- defN 23-May-10 16:31 mlrun/utils/db.py
--rw-r--r--  2.0 unx    42139 b- defN 23-May-10 16:31 mlrun/utils/helpers.py
--rw-r--r--  2.0 unx     7093 b- defN 23-May-10 16:31 mlrun/utils/http.py
--rw-r--r--  2.0 unx     5637 b- defN 23-May-10 16:31 mlrun/utils/logger.py
--rw-r--r--  2.0 unx     9969 b- defN 23-May-10 16:31 mlrun/utils/model_monitoring.py
--rw-r--r--  2.0 unx     3954 b- defN 23-May-10 16:31 mlrun/utils/regex.py
--rw-r--r--  2.0 unx      883 b- defN 23-May-10 16:31 mlrun/utils/singleton.py
--rw-r--r--  2.0 unx     1319 b- defN 23-May-10 16:31 mlrun/utils/v3io_clients.py
--rw-r--r--  2.0 unx    10447 b- defN 23-May-10 16:31 mlrun/utils/vault.py
--rw-r--r--  2.0 unx      990 b- defN 23-May-10 16:31 mlrun/utils/notifications/__init__.py
--rw-r--r--  2.0 unx    12336 b- defN 23-May-10 16:31 mlrun/utils/notifications/notification_pusher.py
--rw-r--r--  2.0 unx     1803 b- defN 23-May-10 16:31 mlrun/utils/notifications/notification/__init__.py
--rw-r--r--  2.0 unx     2177 b- defN 23-May-10 16:31 mlrun/utils/notifications/notification/base.py
--rw-r--r--  2.0 unx     1971 b- defN 23-May-10 16:31 mlrun/utils/notifications/notification/console.py
--rw-r--r--  2.0 unx     4742 b- defN 23-May-10 16:31 mlrun/utils/notifications/notification/git.py
--rw-r--r--  2.0 unx     2021 b- defN 23-May-10 16:31 mlrun/utils/notifications/notification/ipython.py
--rw-r--r--  2.0 unx     3751 b- defN 23-May-10 16:31 mlrun/utils/notifications/notification/slack.py
--rw-r--r--  2.0 unx      614 b- defN 23-May-10 16:31 mlrun/utils/version/__init__.py
--rw-r--r--  2.0 unx       88 b- defN 23-May-10 16:31 mlrun/utils/version/version.json
--rw-r--r--  2.0 unx     1970 b- defN 23-May-10 16:31 mlrun/utils/version/version.py
--rw-r--r--  2.0 unx    11357 b- defN 23-May-10 16:31 mlrun-1.4.0rc3.dist-info/LICENSE
--rw-r--r--  2.0 unx    17185 b- defN 23-May-10 16:31 mlrun-1.4.0rc3.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-May-10 16:31 mlrun-1.4.0rc3.dist-info/WHEEL
--rw-r--r--  2.0 unx       47 b- defN 23-May-10 16:31 mlrun-1.4.0rc3.dist-info/entry_points.txt
--rw-r--r--  2.0 unx        6 b- defN 23-May-10 16:31 mlrun-1.4.0rc3.dist-info/top_level.txt
--rw-rw-r--  2.0 unx    37832 b- defN 23-May-10 16:31 mlrun-1.4.0rc3.dist-info/RECORD
-402 files, 4396387 bytes uncompressed, 1115935 bytes compressed:  74.6%
+Zip file size: 1190001 bytes, number of entries: 410
+-rw-r--r--  2.0 unx     8727 b- defN 23-May-11 15:49 mlrun/__init__.py
+-rw-r--r--  2.0 unx    49342 b- defN 23-May-11 15:49 mlrun/__main__.py
+-rw-r--r--  2.0 unx    54803 b- defN 23-May-11 15:49 mlrun/config.py
+-rw-r--r--  2.0 unx     6780 b- defN 23-May-11 15:49 mlrun/errors.py
+-rw-r--r--  2.0 unx    39096 b- defN 23-May-11 15:49 mlrun/execution.py
+-rw-r--r--  2.0 unx    15624 b- defN 23-May-11 15:49 mlrun/features.py
+-rw-r--r--  2.0 unx     4880 b- defN 23-May-11 15:49 mlrun/k8s_utils.py
+-rw-r--r--  2.0 unx    29645 b- defN 23-May-11 15:49 mlrun/kfpops.py
+-rw-r--r--  2.0 unx     8360 b- defN 23-May-11 15:49 mlrun/lists.py
+-rw-r--r--  2.0 unx    53415 b- defN 23-May-11 15:49 mlrun/model.py
+-rw-r--r--  2.0 unx    11828 b- defN 23-May-11 15:49 mlrun/render.py
+-rw-r--r--  2.0 unx    64472 b- defN 23-May-11 15:49 mlrun/run.py
+-rw-r--r--  2.0 unx     7783 b- defN 23-May-11 15:49 mlrun/secrets.py
+-rw-r--r--  2.0 unx      571 b- defN 23-May-11 15:49 mlrun/api/__init__.py
+-rw-r--r--  2.0 unx     2105 b- defN 23-May-11 15:49 mlrun/api/alembic.ini
+-rw-r--r--  2.0 unx      685 b- defN 23-May-11 15:49 mlrun/api/constants.py
+-rw-r--r--  2.0 unx    25068 b- defN 23-May-11 15:49 mlrun/api/initial_data.py
+-rw-r--r--  2.0 unx     7075 b- defN 23-May-11 15:49 mlrun/api/launcher.py
+-rw-r--r--  2.0 unx    26288 b- defN 23-May-11 15:49 mlrun/api/main.py
+-rw-r--r--  2.0 unx     5247 b- defN 23-May-11 15:49 mlrun/api/middlewares.py
+-rw-r--r--  2.0 unx      571 b- defN 23-May-11 15:49 mlrun/api/api/__init__.py
+-rw-r--r--  2.0 unx     4243 b- defN 23-May-11 15:49 mlrun/api/api/api.py
+-rw-r--r--  2.0 unx     3197 b- defN 23-May-11 15:49 mlrun/api/api/deps.py
+-rw-r--r--  2.0 unx    36432 b- defN 23-May-11 15:49 mlrun/api/api/utils.py
+-rw-r--r--  2.0 unx      571 b- defN 23-May-11 15:49 mlrun/api/api/endpoints/__init__.py
+-rw-r--r--  2.0 unx     9545 b- defN 23-May-11 15:49 mlrun/api/api/endpoints/artifacts.py
+-rw-r--r--  2.0 unx     1199 b- defN 23-May-11 15:49 mlrun/api/api/endpoints/auth.py
+-rw-r--r--  2.0 unx     3618 b- defN 23-May-11 15:49 mlrun/api/api/endpoints/background_tasks.py
+-rw-r--r--  2.0 unx     1214 b- defN 23-May-11 15:49 mlrun/api/api/endpoints/client_spec.py
+-rw-r--r--  2.0 unx     1175 b- defN 23-May-11 15:49 mlrun/api/api/endpoints/clusterization_spec.py
+-rw-r--r--  2.0 unx    29675 b- defN 23-May-11 15:49 mlrun/api/api/endpoints/feature_store.py
+-rw-r--r--  2.0 unx     6104 b- defN 23-May-11 15:49 mlrun/api/api/endpoints/files.py
+-rw-r--r--  2.0 unx     5749 b- defN 23-May-11 15:49 mlrun/api/api/endpoints/frontend_spec.py
+-rw-r--r--  2.0 unx    34618 b- defN 23-May-11 15:49 mlrun/api/api/endpoints/functions.py
+-rw-r--r--  2.0 unx     5986 b- defN 23-May-11 15:49 mlrun/api/api/endpoints/grafana_proxy.py
+-rw-r--r--  2.0 unx     1344 b- defN 23-May-11 15:49 mlrun/api/api/endpoints/healthz.py
+-rw-r--r--  2.0 unx    10399 b- defN 23-May-11 15:49 mlrun/api/api/endpoints/hub.py
+-rw-r--r--  2.0 unx     2450 b- defN 23-May-11 15:49 mlrun/api/api/endpoints/logs.py
+-rw-r--r--  2.0 unx    15817 b- defN 23-May-11 15:49 mlrun/api/api/endpoints/model_endpoints.py
+-rw-r--r--  2.0 unx     3756 b- defN 23-May-11 15:49 mlrun/api/api/endpoints/operations.py
+-rw-r--r--  2.0 unx     9220 b- defN 23-May-11 15:49 mlrun/api/api/endpoints/pipelines.py
+-rw-r--r--  2.0 unx    11494 b- defN 23-May-11 15:49 mlrun/api/api/endpoints/projects.py
+-rw-r--r--  2.0 unx     9151 b- defN 23-May-11 15:49 mlrun/api/api/endpoints/runs.py
+-rw-r--r--  2.0 unx     9063 b- defN 23-May-11 15:49 mlrun/api/api/endpoints/runtime_resources.py
+-rw-r--r--  2.0 unx    10731 b- defN 23-May-11 15:49 mlrun/api/api/endpoints/schedules.py
+-rw-r--r--  2.0 unx     6061 b- defN 23-May-11 15:49 mlrun/api/api/endpoints/secrets.py
+-rw-r--r--  2.0 unx     5298 b- defN 23-May-11 15:49 mlrun/api/api/endpoints/submit.py
+-rw-r--r--  2.0 unx     4894 b- defN 23-May-11 15:49 mlrun/api/api/endpoints/tags.py
+-rw-r--r--  2.0 unx     1203 b- defN 23-May-11 15:49 mlrun/api/api/endpoints/internal/__init__.py
+-rw-r--r--  2.0 unx     1043 b- defN 23-May-11 15:49 mlrun/api/api/endpoints/internal/config.py
+-rw-r--r--  2.0 unx     1724 b- defN 23-May-11 15:49 mlrun/api/api/endpoints/internal/memory_reports.py
+-rw-r--r--  2.0 unx     1209 b- defN 23-May-11 15:49 mlrun/api/crud/__init__.py
+-rw-r--r--  2.0 unx     5610 b- defN 23-May-11 15:49 mlrun/api/crud/artifacts.py
+-rw-r--r--  2.0 unx     7331 b- defN 23-May-11 15:49 mlrun/api/crud/client_spec.py
+-rw-r--r--  2.0 unx     1055 b- defN 23-May-11 15:49 mlrun/api/crud/clusterization_spec.py
+-rw-r--r--  2.0 unx    18628 b- defN 23-May-11 15:49 mlrun/api/crud/feature_store.py
+-rw-r--r--  2.0 unx     3556 b- defN 23-May-11 15:49 mlrun/api/crud/functions.py
+-rw-r--r--  2.0 unx    12025 b- defN 23-May-11 15:49 mlrun/api/crud/hub.py
+-rw-r--r--  2.0 unx     9729 b- defN 23-May-11 15:49 mlrun/api/crud/logs.py
+-rw-r--r--  2.0 unx     2751 b- defN 23-May-11 15:49 mlrun/api/crud/notifications.py
+-rw-r--r--  2.0 unx    14030 b- defN 23-May-11 15:49 mlrun/api/crud/pipelines.py
+-rw-r--r--  2.0 unx    14269 b- defN 23-May-11 15:49 mlrun/api/crud/projects.py
+-rw-r--r--  2.0 unx     6020 b- defN 23-May-11 15:49 mlrun/api/crud/runs.py
+-rw-r--r--  2.0 unx     5575 b- defN 23-May-11 15:49 mlrun/api/crud/runtime_resources.py
+-rw-r--r--  2.0 unx    20145 b- defN 23-May-11 15:49 mlrun/api/crud/secrets.py
+-rw-r--r--  2.0 unx     3277 b- defN 23-May-11 15:49 mlrun/api/crud/tags.py
+-rw-r--r--  2.0 unx      722 b- defN 23-May-11 15:49 mlrun/api/crud/model_monitoring/__init__.py
+-rw-r--r--  2.0 unx    15692 b- defN 23-May-11 15:49 mlrun/api/crud/model_monitoring/grafana.py
+-rw-r--r--  2.0 unx    43000 b- defN 23-May-11 15:49 mlrun/api/crud/model_monitoring/model_endpoints.py
+-rw-r--r--  2.0 unx      571 b- defN 23-May-11 15:49 mlrun/api/crud/runtimes/__init__.py
+-rw-r--r--  2.0 unx      571 b- defN 23-May-11 15:49 mlrun/api/crud/runtimes/nuclio/__init__.py
+-rw-r--r--  2.0 unx    17168 b- defN 23-May-11 15:49 mlrun/api/crud/runtimes/nuclio/function.py
+-rw-r--r--  2.0 unx    11398 b- defN 23-May-11 15:49 mlrun/api/crud/runtimes/nuclio/helpers.py
+-rw-r--r--  2.0 unx      571 b- defN 23-May-11 15:49 mlrun/api/db/__init__.py
+-rw-r--r--  2.0 unx    15056 b- defN 23-May-11 15:49 mlrun/api/db/base.py
+-rw-r--r--  2.0 unx      870 b- defN 23-May-11 15:49 mlrun/api/db/init_db.py
+-rw-r--r--  2.0 unx      993 b- defN 23-May-11 15:49 mlrun/api/db/session.py
+-rw-r--r--  2.0 unx      571 b- defN 23-May-11 15:49 mlrun/api/db/sqldb/__init__.py
+-rw-r--r--  2.0 unx   144136 b- defN 23-May-11 15:49 mlrun/api/db/sqldb/db.py
+-rw-r--r--  2.0 unx     2340 b- defN 23-May-11 15:49 mlrun/api/db/sqldb/helpers.py
+-rw-r--r--  2.0 unx     2542 b- defN 23-May-11 15:49 mlrun/api/db/sqldb/session.py
+-rw-r--r--  2.0 unx     1063 b- defN 23-May-11 15:49 mlrun/api/db/sqldb/models/__init__.py
+-rw-r--r--  2.0 unx    20642 b- defN 23-May-11 15:49 mlrun/api/db/sqldb/models/models_mysql.py
+-rw-r--r--  2.0 unx    18304 b- defN 23-May-11 15:49 mlrun/api/db/sqldb/models/models_sqlite.py
+-rw-r--r--  2.0 unx     2906 b- defN 23-May-11 15:49 mlrun/api/migrations_mysql/env.py
+-rw-r--r--  2.0 unx     1203 b- defN 23-May-11 15:49 mlrun/api/migrations_mysql/versions/28383af526f3_market_place_to_hub.py
+-rw-r--r--  2.0 unx     4614 b- defN 23-May-11 15:49 mlrun/api/migrations_mysql/versions/32bae1b0e29c_increase_timestamp_fields_precision.py
+-rw-r--r--  2.0 unx     1936 b- defN 23-May-11 15:49 mlrun/api/migrations_mysql/versions/4903aef6a91d_tag_foreign_key_and_cascades.py
+-rw-r--r--  2.0 unx     1909 b- defN 23-May-11 15:49 mlrun/api/migrations_mysql/versions/5f1351c88a19_adding_background_tasks_table.py
+-rw-r--r--  2.0 unx     1415 b- defN 23-May-11 15:49 mlrun/api/migrations_mysql/versions/88e656800d6a_add_requested_logs_column_and_index_to_.py
+-rw-r--r--  2.0 unx     1504 b- defN 23-May-11 15:49 mlrun/api/migrations_mysql/versions/9d16de5f03a7_adding_data_versions_table.py
+-rw-r--r--  2.0 unx     1649 b- defN 23-May-11 15:49 mlrun/api/migrations_mysql/versions/b86f5b53f3d7_adding_name_and_updated_to_runs_table.py
+-rw-r--r--  2.0 unx    24057 b- defN 23-May-11 15:49 mlrun/api/migrations_mysql/versions/c4af40b0bf61_init.py
+-rw-r--r--  2.0 unx     2457 b- defN 23-May-11 15:49 mlrun/api/migrations_mysql/versions/c905d15bd91d_notifications.py
+-rw-r--r--  2.0 unx     1351 b- defN 23-May-11 15:49 mlrun/api/migrations_mysql/versions/ee041e8fdaa0_adding_next_run_time_column_to_schedule_.py
+-rw-r--r--  2.0 unx     2906 b- defN 23-May-11 15:49 mlrun/api/migrations_sqlite/env.py
+-rw-r--r--  2.0 unx    11473 b- defN 23-May-11 15:49 mlrun/api/migrations_sqlite/versions/11f8dd2dc9fe_init.py
+-rw-r--r--  2.0 unx     1348 b- defN 23-May-11 15:49 mlrun/api/migrations_sqlite/versions/1c954f8cb32d_schedule_last_run_uri.py
+-rw-r--r--  2.0 unx     5180 b- defN 23-May-11 15:49 mlrun/api/migrations_sqlite/versions/2b6d23c715aa_adding_feature_sets.py
+-rw-r--r--  2.0 unx     2595 b- defN 23-May-11 15:49 mlrun/api/migrations_sqlite/versions/4acd9430b093_market_place_to_hub.py
+-rw-r--r--  2.0 unx     1388 b- defN 23-May-11 15:49 mlrun/api/migrations_sqlite/versions/6401142f2d7c_adding_next_run_time_column_to_schedule_.py
+-rw-r--r--  2.0 unx     1767 b- defN 23-May-11 15:49 mlrun/api/migrations_sqlite/versions/64d90a1a69bc_adding_background_tasks_table.py
+-rw-r--r--  2.0 unx     1360 b- defN 23-May-11 15:49 mlrun/api/migrations_sqlite/versions/803438ecd005_add_requested_logs_column_to_runs.py
+-rw-r--r--  2.0 unx     1259 b- defN 23-May-11 15:49 mlrun/api/migrations_sqlite/versions/863114f0c659_refactoring_feature_set.py
+-rw-r--r--  2.0 unx     2147 b- defN 23-May-11 15:49 mlrun/api/migrations_sqlite/versions/959ae00528ad_notifications.py
+-rw-r--r--  2.0 unx     1482 b- defN 23-May-11 15:49 mlrun/api/migrations_sqlite/versions/accf9fc83d38_adding_data_versions_table.py
+-rw-r--r--  2.0 unx     1892 b- defN 23-May-11 15:49 mlrun/api/migrations_sqlite/versions/b68e8e897a28_schedule_labels.py
+-rw-r--r--  2.0 unx     1882 b- defN 23-May-11 15:49 mlrun/api/migrations_sqlite/versions/bcd0c1f9720c_adding_project_labels.py
+-rw-r--r--  2.0 unx     1420 b- defN 23-May-11 15:49 mlrun/api/migrations_sqlite/versions/cf21882f938e_schedule_id.py
+-rw-r--r--  2.0 unx     2034 b- defN 23-May-11 15:49 mlrun/api/migrations_sqlite/versions/d781f58f607f_tag_object_name_string.py
+-rw-r--r--  2.0 unx     1828 b- defN 23-May-11 15:49 mlrun/api/migrations_sqlite/versions/deac06871ace_adding_marketplace_sources_table.py
+-rw-r--r--  2.0 unx     1380 b- defN 23-May-11 15:49 mlrun/api/migrations_sqlite/versions/e1dd5983c06b_schedule_concurrency_limit.py
+-rw-r--r--  2.0 unx     1831 b- defN 23-May-11 15:49 mlrun/api/migrations_sqlite/versions/e5594ed3ab53_adding_name_and_updated_to_runs_table.py
+-rw-r--r--  2.0 unx     3936 b- defN 23-May-11 15:49 mlrun/api/migrations_sqlite/versions/f4249b4ba6fa_adding_feature_vectors.py
+-rw-r--r--  2.0 unx     2588 b- defN 23-May-11 15:49 mlrun/api/migrations_sqlite/versions/f7b5a1a03629_adding_feature_labels.py
+-rw-r--r--  2.0 unx    13338 b- defN 23-May-11 15:49 mlrun/api/schemas/__init__.py
+-rw-r--r--  2.0 unx      571 b- defN 23-May-11 15:49 mlrun/api/utils/__init__.py
+-rw-r--r--  2.0 unx     1092 b- defN 23-May-11 15:49 mlrun/api/utils/asyncio.py
+-rw-r--r--  2.0 unx     7371 b- defN 23-May-11 15:49 mlrun/api/utils/background_tasks.py
+-rw-r--r--  2.0 unx    25560 b- defN 23-May-11 15:49 mlrun/api/utils/builder.py
+-rw-r--r--  2.0 unx     2431 b- defN 23-May-11 15:49 mlrun/api/utils/helpers.py
+-rw-r--r--  2.0 unx     3728 b- defN 23-May-11 15:49 mlrun/api/utils/memory_reports.py
+-rw-r--r--  2.0 unx     2599 b- defN 23-May-11 15:49 mlrun/api/utils/periodic.py
+-rw-r--r--  2.0 unx    39305 b- defN 23-May-11 15:49 mlrun/api/utils/scheduler.py
+-rw-r--r--  2.0 unx      571 b- defN 23-May-11 15:49 mlrun/api/utils/auth/__init__.py
+-rw-r--r--  2.0 unx    12383 b- defN 23-May-11 15:49 mlrun/api/utils/auth/verifier.py
+-rw-r--r--  2.0 unx      571 b- defN 23-May-11 15:49 mlrun/api/utils/auth/providers/__init__.py
+-rw-r--r--  2.0 unx     1381 b- defN 23-May-11 15:49 mlrun/api/utils/auth/providers/base.py
+-rw-r--r--  2.0 unx     1460 b- defN 23-May-11 15:49 mlrun/api/utils/auth/providers/nop.py
+-rw-r--r--  2.0 unx    10883 b- defN 23-May-11 15:49 mlrun/api/utils/auth/providers/opa.py
+-rw-r--r--  2.0 unx      571 b- defN 23-May-11 15:49 mlrun/api/utils/clients/__init__.py
+-rw-r--r--  2.0 unx    13271 b- defN 23-May-11 15:49 mlrun/api/utils/clients/chief.py
+-rw-r--r--  2.0 unx    31249 b- defN 23-May-11 15:49 mlrun/api/utils/clients/iguazio.py
+-rw-r--r--  2.0 unx    12109 b- defN 23-May-11 15:49 mlrun/api/utils/clients/log_collector.py
+-rw-r--r--  2.0 unx     9916 b- defN 23-May-11 15:49 mlrun/api/utils/clients/nuclio.py
+-rw-r--r--  2.0 unx      571 b- defN 23-May-11 15:49 mlrun/api/utils/clients/protocols/__init__.py
+-rw-r--r--  2.0 unx     2567 b- defN 23-May-11 15:49 mlrun/api/utils/clients/protocols/grpc.py
+-rw-r--r--  2.0 unx      571 b- defN 23-May-11 15:49 mlrun/api/utils/db/__init__.py
+-rw-r--r--  2.0 unx     3305 b- defN 23-May-11 15:49 mlrun/api/utils/db/alembic.py
+-rw-r--r--  2.0 unx     8214 b- defN 23-May-11 15:49 mlrun/api/utils/db/backup.py
+-rw-r--r--  2.0 unx     3795 b- defN 23-May-11 15:49 mlrun/api/utils/db/mysql.py
+-rw-r--r--  2.0 unx      992 b- defN 23-May-11 15:49 mlrun/api/utils/db/sql_collation.py
+-rw-r--r--  2.0 unx     3855 b- defN 23-May-11 15:49 mlrun/api/utils/db/sqlite_migration.py
+-rw-r--r--  2.0 unx      571 b- defN 23-May-11 15:49 mlrun/api/utils/projects/__init__.py
+-rw-r--r--  2.0 unx    17423 b- defN 23-May-11 15:49 mlrun/api/utils/projects/follower.py
+-rw-r--r--  2.0 unx    19372 b- defN 23-May-11 15:49 mlrun/api/utils/projects/leader.py
+-rw-r--r--  2.0 unx     7133 b- defN 23-May-11 15:49 mlrun/api/utils/projects/member.py
+-rw-r--r--  2.0 unx      571 b- defN 23-May-11 15:49 mlrun/api/utils/projects/remotes/__init__.py
+-rw-r--r--  2.0 unx     2659 b- defN 23-May-11 15:49 mlrun/api/utils/projects/remotes/follower.py
+-rw-r--r--  2.0 unx     2094 b- defN 23-May-11 15:49 mlrun/api/utils/projects/remotes/leader.py
+-rw-r--r--  2.0 unx     5000 b- defN 23-May-11 15:49 mlrun/api/utils/projects/remotes/nop_follower.py
+-rw-r--r--  2.0 unx     3861 b- defN 23-May-11 15:49 mlrun/api/utils/projects/remotes/nop_leader.py
+-rw-r--r--  2.0 unx      571 b- defN 23-May-11 15:49 mlrun/api/utils/singletons/__init__.py
+-rw-r--r--  2.0 unx     1202 b- defN 23-May-11 15:49 mlrun/api/utils/singletons/db.py
+-rw-r--r--  2.0 unx    22630 b- defN 23-May-11 15:49 mlrun/api/utils/singletons/k8s.py
+-rw-r--r--  2.0 unx      840 b- defN 23-May-11 15:49 mlrun/api/utils/singletons/logs_dir.py
+-rw-r--r--  2.0 unx     1279 b- defN 23-May-11 15:49 mlrun/api/utils/singletons/project_member.py
+-rw-r--r--  2.0 unx     1063 b- defN 23-May-11 15:49 mlrun/api/utils/singletons/scheduler.py
+-rw-r--r--  2.0 unx     1091 b- defN 23-May-11 15:49 mlrun/artifacts/__init__.py
+-rw-r--r--  2.0 unx    30849 b- defN 23-May-11 15:49 mlrun/artifacts/base.py
+-rw-r--r--  2.0 unx    20432 b- defN 23-May-11 15:49 mlrun/artifacts/dataset.py
+-rw-r--r--  2.0 unx    12110 b- defN 23-May-11 15:49 mlrun/artifacts/manager.py
+-rw-r--r--  2.0 unx    23673 b- defN 23-May-11 15:49 mlrun/artifacts/model.py
+-rw-r--r--  2.0 unx    15383 b- defN 23-May-11 15:49 mlrun/artifacts/plots.py
+-rw-r--r--  2.0 unx      571 b- defN 23-May-11 15:49 mlrun/common/__init__.py
+-rw-r--r--  2.0 unx      660 b- defN 23-May-11 15:49 mlrun/common/constants.py
+-rw-r--r--  2.0 unx     5670 b- defN 23-May-11 15:49 mlrun/common/model_monitoring.py
+-rw-r--r--  2.0 unx      790 b- defN 23-May-11 15:49 mlrun/common/types.py
+-rw-r--r--  2.0 unx     3973 b- defN 23-May-11 15:49 mlrun/common/schemas/__init__.py
+-rw-r--r--  2.0 unx     1923 b- defN 23-May-11 15:49 mlrun/common/schemas/artifact.py
+-rw-r--r--  2.0 unx     5251 b- defN 23-May-11 15:49 mlrun/common/schemas/auth.py
+-rw-r--r--  2.0 unx     1553 b- defN 23-May-11 15:49 mlrun/common/schemas/background_task.py
+-rw-r--r--  2.0 unx     2751 b- defN 23-May-11 15:49 mlrun/common/schemas/client_spec.py
+-rw-r--r--  2.0 unx      888 b- defN 23-May-11 15:49 mlrun/common/schemas/clusterization_spec.py
+-rw-r--r--  2.0 unx     6243 b- defN 23-May-11 15:49 mlrun/common/schemas/constants.py
+-rw-r--r--  2.0 unx     3671 b- defN 23-May-11 15:49 mlrun/common/schemas/feature_store.py
+-rw-r--r--  2.0 unx     2546 b- defN 23-May-11 15:49 mlrun/common/schemas/frontend_spec.py
+-rw-r--r--  2.0 unx     3971 b- defN 23-May-11 15:49 mlrun/common/schemas/function.py
+-rw-r--r--  2.0 unx      705 b- defN 23-May-11 15:49 mlrun/common/schemas/http.py
+-rw-r--r--  2.0 unx     4245 b- defN 23-May-11 15:49 mlrun/common/schemas/hub.py
+-rw-r--r--  2.0 unx     1395 b- defN 23-May-11 15:49 mlrun/common/schemas/k8s.py
+-rw-r--r--  2.0 unx      920 b- defN 23-May-11 15:49 mlrun/common/schemas/memory_reports.py
+-rw-r--r--  2.0 unx    12528 b- defN 23-May-11 15:49 mlrun/common/schemas/model_endpoints.py
+-rw-r--r--  2.0 unx      879 b- defN 23-May-11 15:49 mlrun/common/schemas/notification.py
+-rw-r--r--  2.0 unx     1907 b- defN 23-May-11 15:49 mlrun/common/schemas/object.py
+-rw-r--r--  2.0 unx     1184 b- defN 23-May-11 15:49 mlrun/common/schemas/pipeline.py
+-rw-r--r--  2.0 unx     4094 b- defN 23-May-11 15:49 mlrun/common/schemas/project.py
+-rw-r--r--  2.0 unx     1636 b- defN 23-May-11 15:49 mlrun/common/schemas/runtime_resource.py
+-rw-r--r--  2.0 unx     4188 b- defN 23-May-11 15:49 mlrun/common/schemas/schedule.py
+-rw-r--r--  2.0 unx     1484 b- defN 23-May-11 15:49 mlrun/common/schemas/secret.py
+-rw-r--r--  2.0 unx      919 b- defN 23-May-11 15:49 mlrun/common/schemas/tag.py
+-rw-r--r--  2.0 unx     1087 b- defN 23-May-11 15:49 mlrun/data_types/__init__.py
+-rw-r--r--  2.0 unx     4647 b- defN 23-May-11 15:49 mlrun/data_types/data_types.py
+-rw-r--r--  2.0 unx     5813 b- defN 23-May-11 15:49 mlrun/data_types/infer.py
+-rw-r--r--  2.0 unx     9426 b- defN 23-May-11 15:49 mlrun/data_types/spark.py
+-rw-r--r--  2.0 unx     3443 b- defN 23-May-11 15:49 mlrun/datastore/__init__.py
+-rw-r--r--  2.0 unx     6946 b- defN 23-May-11 15:49 mlrun/datastore/azure_blob.py
+-rw-r--r--  2.0 unx    18274 b- defN 23-May-11 15:49 mlrun/datastore/base.py
+-rw-r--r--  2.0 unx     7995 b- defN 23-May-11 15:49 mlrun/datastore/datastore.py
+-rw-r--r--  2.0 unx     3791 b- defN 23-May-11 15:49 mlrun/datastore/filestore.py
+-rw-r--r--  2.0 unx     5114 b- defN 23-May-11 15:49 mlrun/datastore/google_cloud_storage.py
+-rw-r--r--  2.0 unx     2627 b- defN 23-May-11 15:49 mlrun/datastore/inmem.py
+-rw-r--r--  2.0 unx     4873 b- defN 23-May-11 15:49 mlrun/datastore/redis.py
+-rw-r--r--  2.0 unx     7035 b- defN 23-May-11 15:49 mlrun/datastore/s3.py
+-rw-r--r--  2.0 unx    34385 b- defN 23-May-11 15:49 mlrun/datastore/sources.py
+-rw-r--r--  2.0 unx     1410 b- defN 23-May-11 15:49 mlrun/datastore/spark_udf.py
+-rw-r--r--  2.0 unx     6895 b- defN 23-May-11 15:49 mlrun/datastore/store_resources.py
+-rw-r--r--  2.0 unx    62060 b- defN 23-May-11 15:49 mlrun/datastore/targets.py
+-rw-r--r--  2.0 unx     2900 b- defN 23-May-11 15:49 mlrun/datastore/utils.py
+-rw-r--r--  2.0 unx     8097 b- defN 23-May-11 15:49 mlrun/datastore/v3io.py
+-rw-r--r--  2.0 unx     1343 b- defN 23-May-11 15:49 mlrun/datastore/wasbfs/__init__.py
+-rw-r--r--  2.0 unx     6152 b- defN 23-May-11 15:49 mlrun/datastore/wasbfs/fs.py
+-rw-r--r--  2.0 unx     2816 b- defN 23-May-11 15:49 mlrun/db/__init__.py
+-rw-r--r--  2.0 unx    15968 b- defN 23-May-11 15:49 mlrun/db/base.py
+-rw-r--r--  2.0 unx   130810 b- defN 23-May-11 15:49 mlrun/db/httpdb.py
+-rw-r--r--  2.0 unx    13197 b- defN 23-May-11 15:49 mlrun/db/nopdb.py
+-rw-r--r--  2.0 unx    25917 b- defN 23-May-11 15:49 mlrun/db/sqldb.py
+-rw-r--r--  2.0 unx     1501 b- defN 23-May-11 15:49 mlrun/feature_store/__init__.py
+-rw-r--r--  2.0 unx    43820 b- defN 23-May-11 15:49 mlrun/feature_store/api.py
+-rw-r--r--  2.0 unx    12781 b- defN 23-May-11 15:49 mlrun/feature_store/common.py
+-rw-r--r--  2.0 unx    47273 b- defN 23-May-11 15:49 mlrun/feature_store/feature_set.py
+-rw-r--r--  2.0 unx    21940 b- defN 23-May-11 15:49 mlrun/feature_store/feature_vector.py
+-rw-r--r--  2.0 unx    11681 b- defN 23-May-11 15:49 mlrun/feature_store/ingestion.py
+-rw-r--r--  2.0 unx    28635 b- defN 23-May-11 15:49 mlrun/feature_store/steps.py
+-rw-r--r--  2.0 unx     1232 b- defN 23-May-11 15:49 mlrun/feature_store/retrieval/__init__.py
+-rw-r--r--  2.0 unx    25911 b- defN 23-May-11 15:49 mlrun/feature_store/retrieval/base.py
+-rw-r--r--  2.0 unx     4261 b- defN 23-May-11 15:49 mlrun/feature_store/retrieval/dask_merger.py
+-rw-r--r--  2.0 unx     7141 b- defN 23-May-11 15:49 mlrun/feature_store/retrieval/job.py
+-rw-r--r--  2.0 unx     4765 b- defN 23-May-11 15:49 mlrun/feature_store/retrieval/local_merger.py
+-rw-r--r--  2.0 unx     3352 b- defN 23-May-11 15:49 mlrun/feature_store/retrieval/online.py
+-rw-r--r--  2.0 unx     9661 b- defN 23-May-11 15:49 mlrun/feature_store/retrieval/spark_merger.py
+-rw-r--r--  2.0 unx      743 b- defN 23-May-11 15:49 mlrun/frameworks/__init__.py
+-rw-r--r--  2.0 unx    11466 b- defN 23-May-11 15:49 mlrun/frameworks/parallel_coordinates.py
+-rw-r--r--  2.0 unx      962 b- defN 23-May-11 15:49 mlrun/frameworks/_common/__init__.py
+-rw-r--r--  2.0 unx     8515 b- defN 23-May-11 15:49 mlrun/frameworks/_common/artifacts_library.py
+-rw-r--r--  2.0 unx    21018 b- defN 23-May-11 15:49 mlrun/frameworks/_common/mlrun_interface.py
+-rw-r--r--  2.0 unx    55376 b- defN 23-May-11 15:49 mlrun/frameworks/_common/model_handler.py
+-rw-r--r--  2.0 unx     3469 b- defN 23-May-11 15:49 mlrun/frameworks/_common/plan.py
+-rw-r--r--  2.0 unx     5757 b- defN 23-May-11 15:49 mlrun/frameworks/_common/producer.py
+-rw-r--r--  2.0 unx     9209 b- defN 23-May-11 15:49 mlrun/frameworks/_common/utils.py
+-rw-r--r--  2.0 unx      750 b- defN 23-May-11 15:49 mlrun/frameworks/_dl_common/__init__.py
+-rw-r--r--  2.0 unx     1151 b- defN 23-May-11 15:49 mlrun/frameworks/_dl_common/model_handler.py
+-rw-r--r--  2.0 unx      996 b- defN 23-May-11 15:49 mlrun/frameworks/_dl_common/utils.py
+-rw-r--r--  2.0 unx      787 b- defN 23-May-11 15:49 mlrun/frameworks/_dl_common/loggers/__init__.py
+-rw-r--r--  2.0 unx    11531 b- defN 23-May-11 15:49 mlrun/frameworks/_dl_common/loggers/logger.py
+-rw-r--r--  2.0 unx    14777 b- defN 23-May-11 15:49 mlrun/frameworks/_dl_common/loggers/mlrun_logger.py
+-rw-r--r--  2.0 unx    28414 b- defN 23-May-11 15:49 mlrun/frameworks/_dl_common/loggers/tensorboard_logger.py
+-rw-r--r--  2.0 unx      956 b- defN 23-May-11 15:49 mlrun/frameworks/_ml_common/__init__.py
+-rw-r--r--  2.0 unx     3169 b- defN 23-May-11 15:49 mlrun/frameworks/_ml_common/artifacts_library.py
+-rw-r--r--  2.0 unx    16957 b- defN 23-May-11 15:49 mlrun/frameworks/_ml_common/model_handler.py
+-rw-r--r--  2.0 unx     2368 b- defN 23-May-11 15:49 mlrun/frameworks/_ml_common/pkl_model_server.py
+-rw-r--r--  2.0 unx     4881 b- defN 23-May-11 15:49 mlrun/frameworks/_ml_common/plan.py
+-rw-r--r--  2.0 unx     4061 b- defN 23-May-11 15:49 mlrun/frameworks/_ml_common/producer.py
+-rw-r--r--  2.0 unx    10490 b- defN 23-May-11 15:49 mlrun/frameworks/_ml_common/utils.py
+-rw-r--r--  2.0 unx      737 b- defN 23-May-11 15:49 mlrun/frameworks/_ml_common/loggers/__init__.py
+-rw-r--r--  2.0 unx     5684 b- defN 23-May-11 15:49 mlrun/frameworks/_ml_common/loggers/logger.py
+-rw-r--r--  2.0 unx     6453 b- defN 23-May-11 15:49 mlrun/frameworks/_ml_common/loggers/mlrun_logger.py
+-rw-r--r--  2.0 unx      922 b- defN 23-May-11 15:49 mlrun/frameworks/_ml_common/plans/__init__.py
+-rw-r--r--  2.0 unx     5212 b- defN 23-May-11 15:49 mlrun/frameworks/_ml_common/plans/calibration_curve_plan.py
+-rw-r--r--  2.0 unx     6078 b- defN 23-May-11 15:49 mlrun/frameworks/_ml_common/plans/confusion_matrix_plan.py
+-rw-r--r--  2.0 unx     6658 b- defN 23-May-11 15:49 mlrun/frameworks/_ml_common/plans/dataset_plan.py
+-rw-r--r--  2.0 unx     5318 b- defN 23-May-11 15:49 mlrun/frameworks/_ml_common/plans/feature_importance_plan.py
+-rw-r--r--  2.0 unx     6993 b- defN 23-May-11 15:49 mlrun/frameworks/_ml_common/plans/roc_curve_plan.py
+-rw-r--r--  2.0 unx      706 b- defN 23-May-11 15:49 mlrun/frameworks/auto_mlrun/__init__.py
+-rw-r--r--  2.0 unx    23796 b- defN 23-May-11 15:49 mlrun/frameworks/auto_mlrun/auto_mlrun.py
+-rw-r--r--  2.0 unx      721 b- defN 23-May-11 15:49 mlrun/frameworks/huggingface/__init__.py
+-rw-r--r--  2.0 unx     6083 b- defN 23-May-11 15:49 mlrun/frameworks/huggingface/model_server.py
+-rw-r--r--  2.0 unx    15883 b- defN 23-May-11 15:49 mlrun/frameworks/lgbm/__init__.py
+-rw-r--r--  2.0 unx    13891 b- defN 23-May-11 15:49 mlrun/frameworks/lgbm/model_handler.py
+-rw-r--r--  2.0 unx     9189 b- defN 23-May-11 15:49 mlrun/frameworks/lgbm/model_server.py
+-rw-r--r--  2.0 unx     8278 b- defN 23-May-11 15:49 mlrun/frameworks/lgbm/utils.py
+-rw-r--r--  2.0 unx      857 b- defN 23-May-11 15:49 mlrun/frameworks/lgbm/callbacks/__init__.py
+-rw-r--r--  2.0 unx     4081 b- defN 23-May-11 15:49 mlrun/frameworks/lgbm/callbacks/callback.py
+-rw-r--r--  2.0 unx     5156 b- defN 23-May-11 15:49 mlrun/frameworks/lgbm/callbacks/logging_callback.py
+-rw-r--r--  2.0 unx     4137 b- defN 23-May-11 15:49 mlrun/frameworks/lgbm/callbacks/mlrun_logging_callback.py
+-rw-r--r--  2.0 unx      842 b- defN 23-May-11 15:49 mlrun/frameworks/lgbm/mlrun_interfaces/__init__.py
+-rw-r--r--  2.0 unx     1624 b- defN 23-May-11 15:49 mlrun/frameworks/lgbm/mlrun_interfaces/booster_mlrun_interface.py
+-rw-r--r--  2.0 unx    14256 b- defN 23-May-11 15:49 mlrun/frameworks/lgbm/mlrun_interfaces/mlrun_interface.py
+-rw-r--r--  2.0 unx     1333 b- defN 23-May-11 15:49 mlrun/frameworks/lgbm/mlrun_interfaces/model_mlrun_interface.py
+-rw-r--r--  2.0 unx      791 b- defN 23-May-11 15:49 mlrun/frameworks/onnx/__init__.py
+-rw-r--r--  2.0 unx     6098 b- defN 23-May-11 15:49 mlrun/frameworks/onnx/dataset.py
+-rw-r--r--  2.0 unx     2405 b- defN 23-May-11 15:49 mlrun/frameworks/onnx/mlrun_interface.py
+-rw-r--r--  2.0 unx     6203 b- defN 23-May-11 15:49 mlrun/frameworks/onnx/model_handler.py
+-rw-r--r--  2.0 unx     7061 b- defN 23-May-11 15:49 mlrun/frameworks/onnx/model_server.py
+-rw-r--r--  2.0 unx    22056 b- defN 23-May-11 15:49 mlrun/frameworks/pytorch/__init__.py
+-rw-r--r--  2.0 unx    27904 b- defN 23-May-11 15:49 mlrun/frameworks/pytorch/callbacks_handler.py
+-rw-r--r--  2.0 unx    44639 b- defN 23-May-11 15:49 mlrun/frameworks/pytorch/mlrun_interface.py
+-rw-r--r--  2.0 unx    22465 b- defN 23-May-11 15:49 mlrun/frameworks/pytorch/model_handler.py
+-rw-r--r--  2.0 unx    10136 b- defN 23-May-11 15:49 mlrun/frameworks/pytorch/model_server.py
+-rw-r--r--  2.0 unx     4515 b- defN 23-May-11 15:49 mlrun/frameworks/pytorch/utils.py
+-rw-r--r--  2.0 unx      896 b- defN 23-May-11 15:49 mlrun/frameworks/pytorch/callbacks/__init__.py
+-rw-r--r--  2.0 unx    11524 b- defN 23-May-11 15:49 mlrun/frameworks/pytorch/callbacks/callback.py
+-rw-r--r--  2.0 unx    23166 b- defN 23-May-11 15:49 mlrun/frameworks/pytorch/callbacks/logging_callback.py
+-rw-r--r--  2.0 unx     9310 b- defN 23-May-11 15:49 mlrun/frameworks/pytorch/callbacks/mlrun_logging_callback.py
+-rw-r--r--  2.0 unx    26661 b- defN 23-May-11 15:49 mlrun/frameworks/pytorch/callbacks/tensorboard_logging_callback.py
+-rw-r--r--  2.0 unx    10892 b- defN 23-May-11 15:49 mlrun/frameworks/sklearn/__init__.py
+-rw-r--r--  2.0 unx     5852 b- defN 23-May-11 15:49 mlrun/frameworks/sklearn/estimator.py
+-rw-r--r--  2.0 unx     7117 b- defN 23-May-11 15:49 mlrun/frameworks/sklearn/metric.py
+-rw-r--r--  2.0 unx    12215 b- defN 23-May-11 15:49 mlrun/frameworks/sklearn/metrics_library.py
+-rw-r--r--  2.0 unx    14126 b- defN 23-May-11 15:49 mlrun/frameworks/sklearn/mlrun_interface.py
+-rw-r--r--  2.0 unx     4745 b- defN 23-May-11 15:49 mlrun/frameworks/sklearn/model_handler.py
+-rw-r--r--  2.0 unx     1209 b- defN 23-May-11 15:49 mlrun/frameworks/sklearn/utils.py
+-rw-r--r--  2.0 unx    10455 b- defN 23-May-11 15:49 mlrun/frameworks/tf_keras/__init__.py
+-rw-r--r--  2.0 unx    16627 b- defN 23-May-11 15:49 mlrun/frameworks/tf_keras/mlrun_interface.py
+-rw-r--r--  2.0 unx    28247 b- defN 23-May-11 15:49 mlrun/frameworks/tf_keras/model_handler.py
+-rw-r--r--  2.0 unx     9565 b- defN 23-May-11 15:49 mlrun/frameworks/tf_keras/model_server.py
+-rw-r--r--  2.0 unx     4284 b- defN 23-May-11 15:49 mlrun/frameworks/tf_keras/utils.py
+-rw-r--r--  2.0 unx      844 b- defN 23-May-11 15:49 mlrun/frameworks/tf_keras/callbacks/__init__.py
+-rw-r--r--  2.0 unx    21886 b- defN 23-May-11 15:49 mlrun/frameworks/tf_keras/callbacks/logging_callback.py
+-rw-r--r--  2.0 unx     8791 b- defN 23-May-11 15:49 mlrun/frameworks/tf_keras/callbacks/mlrun_logging_callback.py
+-rw-r--r--  2.0 unx    28728 b- defN 23-May-11 15:49 mlrun/frameworks/tf_keras/callbacks/tensorboard_logging_callback.py
+-rw-r--r--  2.0 unx    10287 b- defN 23-May-11 15:49 mlrun/frameworks/xgboost/__init__.py
+-rw-r--r--  2.0 unx      878 b- defN 23-May-11 15:49 mlrun/frameworks/xgboost/mlrun_interface.py
+-rw-r--r--  2.0 unx    11617 b- defN 23-May-11 15:49 mlrun/frameworks/xgboost/model_handler.py
+-rw-r--r--  2.0 unx     1069 b- defN 23-May-11 15:49 mlrun/frameworks/xgboost/utils.py
+-rw-r--r--  2.0 unx      577 b- defN 23-May-11 15:49 mlrun/launcher/__init__.py
+-rw-r--r--  2.0 unx    15021 b- defN 23-May-11 15:49 mlrun/launcher/base.py
+-rw-r--r--  2.0 unx     4717 b- defN 23-May-11 15:49 mlrun/launcher/client.py
+-rw-r--r--  2.0 unx     1883 b- defN 23-May-11 15:49 mlrun/launcher/factory.py
+-rw-r--r--  2.0 unx    10024 b- defN 23-May-11 15:49 mlrun/launcher/local.py
+-rw-r--r--  2.0 unx     6874 b- defN 23-May-11 15:49 mlrun/launcher/remote.py
+-rw-r--r--  2.0 unx      760 b- defN 23-May-11 15:49 mlrun/mlutils/__init__.py
+-rw-r--r--  2.0 unx     5325 b- defN 23-May-11 15:49 mlrun/mlutils/data.py
+-rw-r--r--  2.0 unx     2598 b- defN 23-May-11 15:49 mlrun/mlutils/models.py
+-rw-r--r--  2.0 unx    30120 b- defN 23-May-11 15:49 mlrun/mlutils/plots.py
+-rw-r--r--  2.0 unx     1208 b- defN 23-May-11 15:49 mlrun/model_monitoring/__init__.py
+-rw-r--r--  2.0 unx    23948 b- defN 23-May-11 15:49 mlrun/model_monitoring/features_drift_table.py
+-rw-r--r--  2.0 unx     9756 b- defN 23-May-11 15:49 mlrun/model_monitoring/helpers.py
+-rw-r--r--  2.0 unx     5196 b- defN 23-May-11 15:49 mlrun/model_monitoring/model_endpoint.py
+-rw-r--r--  2.0 unx    36885 b- defN 23-May-11 15:49 mlrun/model_monitoring/model_monitoring_batch.py
+-rw-r--r--  2.0 unx    43172 b- defN 23-May-11 15:49 mlrun/model_monitoring/stream_processing_fs.py
+-rw-r--r--  2.0 unx     4240 b- defN 23-May-11 15:49 mlrun/model_monitoring/stores/__init__.py
+-rw-r--r--  2.0 unx    17357 b- defN 23-May-11 15:49 mlrun/model_monitoring/stores/kv_model_endpoint_store.py
+-rw-r--r--  2.0 unx     5695 b- defN 23-May-11 15:49 mlrun/model_monitoring/stores/model_endpoint_store.py
+-rw-r--r--  2.0 unx    15706 b- defN 23-May-11 15:49 mlrun/model_monitoring/stores/sql_model_endpoint_store.py
+-rw-r--r--  2.0 unx      884 b- defN 23-May-11 15:49 mlrun/model_monitoring/stores/models/__init__.py
+-rw-r--r--  2.0 unx      655 b- defN 23-May-11 15:49 mlrun/model_monitoring/stores/models/base.py
+-rw-r--r--  2.0 unx     3741 b- defN 23-May-11 15:49 mlrun/model_monitoring/stores/models/mysql.py
+-rw-r--r--  2.0 unx     3658 b- defN 23-May-11 15:49 mlrun/model_monitoring/stores/models/sqlite.py
+-rw-r--r--  2.0 unx     2400 b- defN 23-May-11 15:49 mlrun/platforms/__init__.py
+-rw-r--r--  2.0 unx    24102 b- defN 23-May-11 15:49 mlrun/platforms/iguazio.py
+-rw-r--r--  2.0 unx    11852 b- defN 23-May-11 15:49 mlrun/platforms/other.py
+-rw-r--r--  2.0 unx     1153 b- defN 23-May-11 15:49 mlrun/projects/__init__.py
+-rw-r--r--  2.0 unx    17480 b- defN 23-May-11 15:49 mlrun/projects/operations.py
+-rw-r--r--  2.0 unx    38336 b- defN 23-May-11 15:49 mlrun/projects/pipelines.py
+-rw-r--r--  2.0 unx   105214 b- defN 23-May-11 15:49 mlrun/projects/project.py
+-rw-r--r--  2.0 unx     8773 b- defN 23-May-11 15:49 mlrun/runtimes/__init__.py
+-rw-r--r--  2.0 unx    95055 b- defN 23-May-11 15:49 mlrun/runtimes/base.py
+-rw-r--r--  2.0 unx     6689 b- defN 23-May-11 15:49 mlrun/runtimes/constants.py
+-rw-r--r--  2.0 unx    30520 b- defN 23-May-11 15:49 mlrun/runtimes/daskjob.py
+-rw-r--r--  2.0 unx     9561 b- defN 23-May-11 15:49 mlrun/runtimes/funcdoc.py
+-rw-r--r--  2.0 unx    45205 b- defN 23-May-11 15:49 mlrun/runtimes/function.py
+-rw-r--r--  2.0 unx     4911 b- defN 23-May-11 15:49 mlrun/runtimes/function_reference.py
+-rw-r--r--  2.0 unx     6530 b- defN 23-May-11 15:49 mlrun/runtimes/generators.py
+-rw-r--r--  2.0 unx    15140 b- defN 23-May-11 15:49 mlrun/runtimes/kubejob.py
+-rw-r--r--  2.0 unx    18005 b- defN 23-May-11 15:49 mlrun/runtimes/local.py
+-rw-r--r--  2.0 unx     2885 b- defN 23-May-11 15:49 mlrun/runtimes/nuclio.py
+-rw-r--r--  2.0 unx    60644 b- defN 23-May-11 15:49 mlrun/runtimes/pod.py
+-rw-r--r--  2.0 unx     7695 b- defN 23-May-11 15:49 mlrun/runtimes/remotesparkjob.py
+-rw-r--r--  2.0 unx    29858 b- defN 23-May-11 15:49 mlrun/runtimes/serving.py
+-rw-r--r--  2.0 unx    21222 b- defN 23-May-11 15:49 mlrun/runtimes/utils.py
+-rw-r--r--  2.0 unx      790 b- defN 23-May-11 15:49 mlrun/runtimes/mpijob/__init__.py
+-rw-r--r--  2.0 unx    14713 b- defN 23-May-11 15:49 mlrun/runtimes/mpijob/abstract.py
+-rw-r--r--  2.0 unx    13845 b- defN 23-May-11 15:49 mlrun/runtimes/mpijob/v1.py
+-rw-r--r--  2.0 unx     8460 b- defN 23-May-11 15:49 mlrun/runtimes/mpijob/v1alpha1.py
+-rw-r--r--  2.0 unx      673 b- defN 23-May-11 15:49 mlrun/runtimes/package/__init__.py
+-rw-r--r--  2.0 unx    27068 b- defN 23-May-11 15:49 mlrun/runtimes/package/context_handler.py
+-rw-r--r--  2.0 unx      751 b- defN 23-May-11 15:49 mlrun/runtimes/sparkjob/__init__.py
+-rw-r--r--  2.0 unx    35028 b- defN 23-May-11 15:49 mlrun/runtimes/sparkjob/abstract.py
+-rw-r--r--  2.0 unx    28746 b- defN 23-May-11 15:49 mlrun/runtimes/sparkjob/spark3job.py
+-rw-r--r--  2.0 unx     1078 b- defN 23-May-11 15:49 mlrun/serving/__init__.py
+-rw-r--r--  2.0 unx     6116 b- defN 23-May-11 15:49 mlrun/serving/merger.py
+-rw-r--r--  2.0 unx    18038 b- defN 23-May-11 15:49 mlrun/serving/remote.py
+-rw-r--r--  2.0 unx    55277 b- defN 23-May-11 15:49 mlrun/serving/routers.py
+-rw-r--r--  2.0 unx    20247 b- defN 23-May-11 15:49 mlrun/serving/server.py
+-rw-r--r--  2.0 unx      836 b- defN 23-May-11 15:49 mlrun/serving/serving_wrapper.py
+-rw-r--r--  2.0 unx    53940 b- defN 23-May-11 15:49 mlrun/serving/states.py
+-rw-r--r--  2.0 unx     3902 b- defN 23-May-11 15:49 mlrun/serving/utils.py
+-rw-r--r--  2.0 unx    11814 b- defN 23-May-11 15:49 mlrun/serving/v1_serving.py
+-rw-r--r--  2.0 unx    21460 b- defN 23-May-11 15:49 mlrun/serving/v2_serving.py
+-rw-r--r--  2.0 unx      826 b- defN 23-May-11 15:49 mlrun/utils/__init__.py
+-rw-r--r--  2.0 unx    10397 b- defN 23-May-11 15:49 mlrun/utils/async_http.py
+-rw-r--r--  2.0 unx     3456 b- defN 23-May-11 15:49 mlrun/utils/azure_vault.py
+-rw-r--r--  2.0 unx     6245 b- defN 23-May-11 15:49 mlrun/utils/clones.py
+-rw-r--r--  2.0 unx     1662 b- defN 23-May-11 15:49 mlrun/utils/db.py
+-rw-r--r--  2.0 unx    42577 b- defN 23-May-11 15:49 mlrun/utils/helpers.py
+-rw-r--r--  2.0 unx     7093 b- defN 23-May-11 15:49 mlrun/utils/http.py
+-rw-r--r--  2.0 unx     5637 b- defN 23-May-11 15:49 mlrun/utils/logger.py
+-rw-r--r--  2.0 unx     9969 b- defN 23-May-11 15:49 mlrun/utils/model_monitoring.py
+-rw-r--r--  2.0 unx     3954 b- defN 23-May-11 15:49 mlrun/utils/regex.py
+-rw-r--r--  2.0 unx      883 b- defN 23-May-11 15:49 mlrun/utils/singleton.py
+-rw-r--r--  2.0 unx     1319 b- defN 23-May-11 15:49 mlrun/utils/v3io_clients.py
+-rw-r--r--  2.0 unx    10447 b- defN 23-May-11 15:49 mlrun/utils/vault.py
+-rw-r--r--  2.0 unx      990 b- defN 23-May-11 15:49 mlrun/utils/notifications/__init__.py
+-rw-r--r--  2.0 unx    12331 b- defN 23-May-11 15:49 mlrun/utils/notifications/notification_pusher.py
+-rw-r--r--  2.0 unx     1803 b- defN 23-May-11 15:49 mlrun/utils/notifications/notification/__init__.py
+-rw-r--r--  2.0 unx     2177 b- defN 23-May-11 15:49 mlrun/utils/notifications/notification/base.py
+-rw-r--r--  2.0 unx     1971 b- defN 23-May-11 15:49 mlrun/utils/notifications/notification/console.py
+-rw-r--r--  2.0 unx     4742 b- defN 23-May-11 15:49 mlrun/utils/notifications/notification/git.py
+-rw-r--r--  2.0 unx     2021 b- defN 23-May-11 15:49 mlrun/utils/notifications/notification/ipython.py
+-rw-r--r--  2.0 unx     3751 b- defN 23-May-11 15:49 mlrun/utils/notifications/notification/slack.py
+-rw-r--r--  2.0 unx      614 b- defN 23-May-11 15:49 mlrun/utils/version/__init__.py
+-rw-r--r--  2.0 unx       88 b- defN 23-May-11 15:49 mlrun/utils/version/version.json
+-rw-r--r--  2.0 unx     1970 b- defN 23-May-11 15:49 mlrun/utils/version/version.py
+-rw-r--r--  2.0 unx    11357 b- defN 23-May-11 15:49 mlrun-1.4.0rc4.dist-info/LICENSE
+-rw-r--r--  2.0 unx    17185 b- defN 23-May-11 15:49 mlrun-1.4.0rc4.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-May-11 15:49 mlrun-1.4.0rc4.dist-info/WHEEL
+-rw-r--r--  2.0 unx       47 b- defN 23-May-11 15:49 mlrun-1.4.0rc4.dist-info/entry_points.txt
+-rw-r--r--  2.0 unx        6 b- defN 23-May-11 15:49 mlrun-1.4.0rc4.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx    38487 b- defN 23-May-11 15:49 mlrun-1.4.0rc4.dist-info/RECORD
+410 files, 4433077 bytes uncompressed, 1128611 bytes compressed:  74.5%
```

## zipnote {}

```diff
@@ -1,16 +1,13 @@
 Filename: mlrun/__init__.py
 Comment: 
 
 Filename: mlrun/__main__.py
 Comment: 
 
-Filename: mlrun/builder.py
-Comment: 
-
 Filename: mlrun/config.py
 Comment: 
 
 Filename: mlrun/errors.py
 Comment: 
 
 Filename: mlrun/execution.py
@@ -48,14 +45,17 @@
 
 Filename: mlrun/api/constants.py
 Comment: 
 
 Filename: mlrun/api/initial_data.py
 Comment: 
 
+Filename: mlrun/api/launcher.py
+Comment: 
+
 Filename: mlrun/api/main.py
 Comment: 
 
 Filename: mlrun/api/middlewares.py
 Comment: 
 
 Filename: mlrun/api/api/__init__.py
@@ -351,14 +351,17 @@
 
 Filename: mlrun/api/utils/asyncio.py
 Comment: 
 
 Filename: mlrun/api/utils/background_tasks.py
 Comment: 
 
+Filename: mlrun/api/utils/builder.py
+Comment: 
+
 Filename: mlrun/api/utils/helpers.py
 Comment: 
 
 Filename: mlrun/api/utils/memory_reports.py
 Comment: 
 
 Filename: mlrun/api/utils/periodic.py
@@ -486,14 +489,17 @@
 
 Filename: mlrun/artifacts/plots.py
 Comment: 
 
 Filename: mlrun/common/__init__.py
 Comment: 
 
+Filename: mlrun/common/constants.py
+Comment: 
+
 Filename: mlrun/common/model_monitoring.py
 Comment: 
 
 Filename: mlrun/common/types.py
 Comment: 
 
 Filename: mlrun/common/schemas/__init__.py
@@ -933,14 +939,32 @@
 
 Filename: mlrun/frameworks/xgboost/model_handler.py
 Comment: 
 
 Filename: mlrun/frameworks/xgboost/utils.py
 Comment: 
 
+Filename: mlrun/launcher/__init__.py
+Comment: 
+
+Filename: mlrun/launcher/base.py
+Comment: 
+
+Filename: mlrun/launcher/client.py
+Comment: 
+
+Filename: mlrun/launcher/factory.py
+Comment: 
+
+Filename: mlrun/launcher/local.py
+Comment: 
+
+Filename: mlrun/launcher/remote.py
+Comment: 
+
 Filename: mlrun/mlutils/__init__.py
 Comment: 
 
 Filename: mlrun/mlutils/data.py
 Comment: 
 
 Filename: mlrun/mlutils/models.py
@@ -1182,26 +1206,26 @@
 
 Filename: mlrun/utils/version/version.json
 Comment: 
 
 Filename: mlrun/utils/version/version.py
 Comment: 
 
-Filename: mlrun-1.4.0rc3.dist-info/LICENSE
+Filename: mlrun-1.4.0rc4.dist-info/LICENSE
 Comment: 
 
-Filename: mlrun-1.4.0rc3.dist-info/METADATA
+Filename: mlrun-1.4.0rc4.dist-info/METADATA
 Comment: 
 
-Filename: mlrun-1.4.0rc3.dist-info/WHEEL
+Filename: mlrun-1.4.0rc4.dist-info/WHEEL
 Comment: 
 
-Filename: mlrun-1.4.0rc3.dist-info/entry_points.txt
+Filename: mlrun-1.4.0rc4.dist-info/entry_points.txt
 Comment: 
 
-Filename: mlrun-1.4.0rc3.dist-info/top_level.txt
+Filename: mlrun-1.4.0rc4.dist-info/top_level.txt
 Comment: 
 
-Filename: mlrun-1.4.0rc3.dist-info/RECORD
+Filename: mlrun-1.4.0rc4.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## mlrun/__main__.py

```diff
@@ -30,15 +30,14 @@
 import dotenv
 import pandas as pd
 import yaml
 from tabulate import tabulate
 
 import mlrun
 
-from .builder import upload_tarball
 from .config import config as mlconf
 from .db import get_run_db
 from .errors import err_to_str
 from .model import RunTemplate
 from .platforms import auto_mount as auto_mount_modifier
 from .projects import load_project
 from .run import (
@@ -540,15 +539,15 @@
 
     archive = archive or mlconf.default_archive
     if archive:
         src = b.source or "./"
         logger.info(f"uploading data from {src} to {archive}")
         target = archive if archive.endswith("/") else archive + "/"
         target += f"src-{meta.project}-{meta.name}-{meta.tag or 'latest'}.tar.gz"
-        upload_tarball(src, target)
+        mlrun.datastore.utils.upload_tarball(src, target)
         # todo: replace function.yaml inside the tar
         b.source = target
 
     with_mlrun = True if with_mlrun else None  # False will map to None
 
     if ensure_project and project:
         mlrun.get_or_create_project(
```

## mlrun/api/initial_data.py

```diff
@@ -15,14 +15,15 @@
 import collections
 import datetime
 import os
 import pathlib
 import typing
 
 import dateutil.parser
+import pydantic.error_wrappers
 import pymysql.err
 import sqlalchemy.exc
 import sqlalchemy.orm
 
 import mlrun.api.db.sqldb.db
 import mlrun.api.db.sqldb.helpers
 import mlrun.api.db.sqldb.models
@@ -103,15 +104,15 @@
     logger.info("Initial data created")
 
 
 # If the data_table version doesn't exist, we can assume the data version is 1.
 # This is because data version 1 points to to a data migration which was added back in 0.6.0, and
 # upgrading from a version earlier than 0.6.0 to v>=0.8.0 is not supported.
 data_version_prior_to_table_addition = 1
-latest_data_version = 2
+latest_data_version = 3
 
 
 def _resolve_needed_operations(
     alembic_util: mlrun.api.utils.db.alembic.AlembicUtil,
     sqlite_migration_util: typing.Optional[
         mlrun.api.utils.db.sqlite_migration.SQLiteMigrationUtil
     ],
@@ -208,14 +209,17 @@
                 current_data_version=current_data_version,
                 latest_data_version=latest_data_version,
             )
             if current_data_version < 1:
                 _perform_version_1_data_migrations(db, db_session)
             if current_data_version < 2:
                 _perform_version_2_data_migrations(db, db_session)
+            if current_data_version < 3:
+                _perform_version_3_data_migrations(db, db_session)
+
             db.create_data_version(db_session, str(latest_data_version))
 
 
 def _add_initial_data(db_session: sqlalchemy.orm.Session):
     # FileDB is not really a thing anymore, so using SQLDB directly
     db = mlrun.api.db.sqldb.db.SQLDB("")
     _add_default_hub_source_if_needed(db, db_session)
@@ -461,14 +465,38 @@
                 run_dict.get("status", {}).get("last_update")
             )
         db._update_run_updated_time(run, run_dict, updated)
         run.struct = run_dict
         db._upsert(db_session, [run], ignore=True)
 
 
+def _perform_version_3_data_migrations(
+    db: mlrun.api.db.sqldb.db.SQLDB, db_session: sqlalchemy.orm.Session
+):
+    _rename_marketplace_kind_to_hub(db, db_session)
+
+
+def _rename_marketplace_kind_to_hub(
+    db: mlrun.api.db.sqldb.db.SQLDB, db_session: sqlalchemy.orm.Session
+):
+    logger.info("Renaming 'Marketplace' kinds to 'Hub'")
+
+    hubs = db._list_hub_sources_without_transform(db_session)
+    for hub in hubs:
+        hub_dict = hub.full_object
+
+        # rename kind from "MarketplaceSource" to "HubSource"
+        if "Marketplace" in hub_dict.get("kind", ""):
+            hub_dict["kind"] = hub_dict["kind"].replace("Marketplace", "Hub")
+
+        # save the object back to the db
+        hub.full_object = hub_dict
+        db._upsert(db_session, [hub], ignore=True)
+
+
 def _perform_version_1_data_migrations(
     db: mlrun.api.db.sqldb.db.SQLDB, db_session: sqlalchemy.orm.Session
 ):
     _enrich_project_state(db, db_session)
     _fix_artifact_tags_duplications(db, db_session)
     _fix_datasets_large_previews(db, db_session)
 
@@ -499,14 +527,29 @@
 ):
     try:
         hub_marketplace_source = db.get_hub_source(
             db_session, config.hub.default_source.name
         )
     except mlrun.errors.MLRunNotFoundError:
         hub_marketplace_source = None
+    except pydantic.error_wrappers.ValidationError as exc:
+
+        # following the renaming of 'marketplace' to 'hub', validation errors can occur on the old 'marketplace'.
+        # this will be handled later in the data migrations, but for now - if a validation error occurs, we assume
+        # that a default hub source exists
+        if all(
+            [
+                "validation error for HubSource" in str(exc),
+                "value is not a valid enumeration member" in str(exc),
+            ]
+        ):
+            logger.info("Found existing default hub source, data migration needed")
+            hub_marketplace_source = True
+        else:
+            raise exc
 
     if not hub_marketplace_source:
         hub_source = mlrun.common.schemas.HubSource.generate_default_source()
         # hub_source will be None if the configuration has hub.default_source.create=False
         if hub_source:
             logger.info("Adding default hub source")
             # Not using db.store_marketplace_source() since it doesn't allow changing the default hub source.
```

## mlrun/api/api/endpoints/frontend_spec.py

```diff
@@ -14,16 +14,16 @@
 #
 import typing
 
 import fastapi
 import semver
 
 import mlrun.api.api.deps
+import mlrun.api.utils.builder
 import mlrun.api.utils.clients.iguazio
-import mlrun.builder
 import mlrun.common.schemas
 import mlrun.runtimes
 import mlrun.runtimes.utils
 import mlrun.utils.helpers
 from mlrun.api.api.utils import get_allowed_path_prefixes_list
 from mlrun.config import config
 from mlrun.platforms import is_iguazio_session_cookie
@@ -72,15 +72,15 @@
         feature_flags=feature_flags,
         default_function_priority_class_name=config.default_function_priority_class_name,
         valid_function_priority_class_names=config.get_valid_function_priority_class_names(),
         default_function_image_by_kind=mlrun.mlconf.function_defaults.image_by_kind.to_dict(),
         function_deployment_target_image_template=function_deployment_target_image_template,
         function_deployment_target_image_name_prefix_template=function_target_image_name_prefix_template,
         function_deployment_target_image_registries_to_enforce_prefix=registries_to_enforce_prefix,
-        function_deployment_mlrun_command=mlrun.builder.resolve_mlrun_install_command(),
+        function_deployment_mlrun_command=mlrun.api.utils.builder.resolve_mlrun_install_command(),
         auto_mount_type=config.storage.auto_mount_type,
         auto_mount_params=config.get_storage_auto_mount_params(),
         default_artifact_path=config.artifact_path,
         default_function_pod_resources=mlrun.mlconf.default_function_pod_resources.to_dict(),
         default_function_preemption_mode=mlrun.mlconf.function_defaults.preemption_mode,
         feature_store_data_prefixes=config.feature_store.data_prefixes.to_dict(),
         allowed_artifact_path_prefixes_list=get_allowed_path_prefixes_list(),
```

## mlrun/api/api/endpoints/functions.py

```diff
@@ -42,15 +42,15 @@
 import mlrun.api.utils.singletons.k8s
 import mlrun.api.utils.singletons.project_member
 import mlrun.common.model_monitoring
 import mlrun.common.schemas
 from mlrun.api.api import deps
 from mlrun.api.api.utils import get_run_db_instance, log_and_raise, log_path
 from mlrun.api.crud.secrets import Secrets, SecretsClientType
-from mlrun.builder import build_runtime
+from mlrun.api.utils.builder import build_runtime
 from mlrun.config import config
 from mlrun.errors import MLRunRuntimeError, err_to_str
 from mlrun.run import new_function
 from mlrun.runtimes import RuntimeKinds, ServingRuntime, runtime_resources_map
 from mlrun.runtimes.utils import get_item_name
 from mlrun.utils import get_in, logger, parse_versioned_object_uri, update_in
 from mlrun.utils.model_monitoring import parse_model_endpoint_store_prefix
```

## mlrun/api/db/sqldb/db.py

```diff
@@ -1395,17 +1395,15 @@
     def patch_project(
         self,
         session: Session,
         name: str,
         project: dict,
         patch_mode: mlrun.common.schemas.PatchMode = mlrun.common.schemas.PatchMode.replace,
     ):
-        logger.debug(
-            "Patching project in DB", name=name, project=project, patch_mode=patch_mode
-        )
+        logger.debug("Patching project in DB", name=name, patch_mode=patch_mode)
         project_record = self._get_project_record(session, name)
         self._patch_project_record_from_project(
             session, name, project_record, project, patch_mode
         )
 
     def get_project(
         self, session: Session, name: str = None, project_id: int = None
@@ -3425,14 +3423,17 @@
             # Need this to make the list return such that the default source is last in the response.
             if ordered_source.index != mlrun.common.schemas.last_source_index:
                 results.insert(0, ordered_source)
             else:
                 results.append(ordered_source)
         return results
 
+    def _list_hub_sources_without_transform(self, session) -> List[HubSource]:
+        return self._query(session, HubSource).all()
+
     def delete_hub_source(self, session, name):
         logger.debug("Deleting hub source from DB", name=name)
 
         source_record = self._query(session, HubSource, name=name).one_or_none()
         if not source_record:
             return
```

## mlrun/api/utils/clients/iguazio.py

```diff
@@ -200,15 +200,15 @@
 
     def update_project(
         self,
         session: str,
         name: str,
         project: mlrun.common.schemas.Project,
     ):
-        logger.debug("Updating project in Iguazio", name=name, project=project)
+        logger.debug("Updating project in Iguazio", name=name)
         body = self._transform_mlrun_project_to_iguazio_project(project)
         self._put_project_to_iguazio(session, name, body)
 
     def delete_project(
         self,
         session: str,
         name: str,
```

## mlrun/api/utils/projects/leader.py

```diff
@@ -268,15 +268,14 @@
                 project = followers_projects_map[project_follower_name][project_name]
                 self._enrich_and_validate_before_creation(project)
                 self._leader_follower.create_project(db_session, project)
             except Exception as exc:
                 logger.warning(
                     "Failed creating missing project in leader",
                     project_follower_name=project_follower_name,
-                    project=project,
                     project_name=project_name,
                     exc=err_to_str(exc),
                     traceback=traceback.format_exc(),
                 )
             else:
                 project_in_leader = True
         else:
@@ -311,29 +310,27 @@
         project: mlrun.common.schemas.Project,
     ):
         for follower_name in follower_names:
             logger.debug(
                 "Updating project in follower",
                 follower_name=follower_name,
                 project_name=project_name,
-                project=project,
             )
             try:
                 self._enrich_and_validate_before_creation(project)
                 self._followers[follower_name].store_project(
                     db_session,
                     project_name,
                     project,
                 )
             except Exception as exc:
                 logger.warning(
                     "Failed updating project in follower",
                     follower_name=follower_name,
                     project_name=project_name,
-                    project=project,
                     exc=err_to_str(exc),
                     traceback=traceback.format_exc(),
                 )
 
     def _create_project_in_missing_followers(
         self,
         db_session: sqlalchemy.orm.Session,
@@ -345,29 +342,27 @@
     ):
         for missing_follower in missing_followers:
             logger.debug(
                 "Project is missing from follower. Creating",
                 missing_follower_name=missing_follower,
                 project_follower_name=project_follower_name,
                 project_name=project_name,
-                project=project,
             )
             try:
                 self._enrich_and_validate_before_creation(project)
                 self._followers[missing_follower].create_project(
                     db_session,
                     project,
                 )
             except Exception as exc:
                 logger.warning(
                     "Failed creating missing project in follower",
                     missing_follower_name=missing_follower,
                     project_follower_name=project_follower_name,
                     project_name=project_name,
-                    project=project,
                     exc=err_to_str(exc),
                     traceback=traceback.format_exc(),
                 )
 
     def _should_sync_project_to_followers(self, project_name: str) -> bool:
         """
         projects name validation is enforced on creation, the only way for a project name to be invalid is if it was
```

## mlrun/datastore/utils.py

```diff
@@ -8,17 +8,21 @@
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 #
+import tarfile
+import tempfile
 import typing
 from urllib.parse import parse_qs, urlparse
 
+import mlrun.datastore
+
 
 def store_path_to_spark(path):
     if path.startswith("redis://") or path.startswith("rediss://"):
         url = urlparse(path)
         if url.path:
             path = url.path
     elif path.startswith("v3io:///"):
@@ -62,7 +66,18 @@
     query_dict = parse_qs(url.query)
     if "topic" in query_dict:
         topic = query_dict["topic"][0]
     else:
         topic = url.path
         topic = topic.lstrip("/")
     return topic, bootstrap_servers
+
+
+def upload_tarball(source_dir, target, secrets=None):
+
+    # will delete the temp file
+    with tempfile.NamedTemporaryFile(suffix=".tar.gz") as temp_fh:
+        with tarfile.open(mode="w:gz", fileobj=temp_fh) as tar:
+            tar.add(source_dir, arcname="")
+        stores = mlrun.datastore.store_manager.set(secrets)
+        datastore, subpath = stores.get_or_create_store(target)
+        datastore.upload(subpath, temp_fh.name)
```

## mlrun/db/base.py

```diff
@@ -598,7 +598,17 @@
 
     @abstractmethod
     def verify_authorization(
         self,
         authorization_verification_input: mlrun.common.schemas.AuthorizationVerificationInput,
     ):
         pass
+
+    def get_builder_status(
+        self,
+        func: "mlrun.runtimes.BaseRuntime",
+        offset: int = 0,
+        logs: bool = True,
+        last_log_timestamp: float = 0.0,
+        verbose: bool = False,
+    ):
+        pass
```

## mlrun/db/httpdb.py

```diff
@@ -3204,4966 +3204,4973 @@
 0000c830: 7370 6f6e 7365 2229 0a0a 2020 2020 2020  sponse")..      
 0000c840: 2020 7265 7475 726e 2072 6573 702e 6a73    return resp.js
 0000c850: 6f6e 2829 0a0a 2020 2020 6465 6620 6765  on()..    def ge
 0000c860: 745f 6275 696c 6465 725f 7374 6174 7573  t_builder_status
 0000c870: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
 0000c880: 2020 2020 2020 2020 6675 6e63 3a20 4261          func: Ba
 0000c890: 7365 5275 6e74 696d 652c 0a20 2020 2020  seRuntime,.     
-0000c8a0: 2020 206f 6666 7365 743d 302c 0a20 2020     offset=0,.   
-0000c8b0: 2020 2020 206c 6f67 733d 5472 7565 2c0a       logs=True,.
-0000c8c0: 2020 2020 2020 2020 6c61 7374 5f6c 6f67          last_log
-0000c8d0: 5f74 696d 6573 7461 6d70 3d30 2c0a 2020  _timestamp=0,.  
-0000c8e0: 2020 2020 2020 7665 7262 6f73 653d 4661        verbose=Fa
-0000c8f0: 6c73 652c 0a20 2020 2029 3a0a 2020 2020  lse,.    ):.    
-0000c900: 2020 2020 2222 2252 6574 7269 6576 6520      """Retrieve 
-0000c910: 7468 6520 7374 6174 7573 206f 6620 6120  the status of a 
-0000c920: 6275 696c 6420 6f70 6572 6174 696f 6e20  build operation 
-0000c930: 6375 7272 656e 746c 7920 696e 2070 726f  currently in pro
-0000c940: 6772 6573 732e 0a0a 2020 2020 2020 2020  gress...        
-0000c950: 3a70 6172 616d 2066 756e 633a 2046 756e  :param func: Fun
-0000c960: 6374 696f 6e20 6f62 6a65 6374 2074 6861  ction object tha
-0000c970: 7420 6973 2062 6569 6e67 2062 7569 6c74  t is being built
-0000c980: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-0000c990: 206f 6666 7365 743a 204f 6666 7365 7420   offset: Offset 
-0000c9a0: 696e 746f 2074 6865 2062 7569 6c64 206c  into the build l
-0000c9b0: 6f67 7320 746f 2072 6574 7269 6576 6520  ogs to retrieve 
-0000c9c0: 6c6f 6773 2066 726f 6d2e 0a20 2020 2020  logs from..     
-0000c9d0: 2020 203a 7061 7261 6d20 6c6f 6773 3a20     :param logs: 
-0000c9e0: 5368 6f75 6c64 2062 7569 6c64 206c 6f67  Should build log
-0000c9f0: 7320 6265 2072 6574 7269 6576 6564 2e0a  s be retrieved..
-0000ca00: 2020 2020 2020 2020 3a70 6172 616d 206c          :param l
-0000ca10: 6173 745f 6c6f 675f 7469 6d65 7374 616d  ast_log_timestam
-0000ca20: 703a 204c 6173 7420 7469 6d65 7374 616d  p: Last timestam
-0000ca30: 7020 6f66 206c 6f67 7320 7468 6174 2077  p of logs that w
-0000ca40: 6572 6520 616c 7265 6164 7920 7265 7472  ere already retr
-0000ca50: 6965 7665 642e 2046 756e 6374 696f 6e20  ieved. Function 
-0000ca60: 7769 6c6c 2072 6574 7572 6e20 6f6e 6c79  will return only
-0000ca70: 206c 6f67 730a 2020 2020 2020 2020 2020   logs.          
-0000ca80: 2020 6c61 7465 7220 7468 616e 2074 6869    later than thi
-0000ca90: 7320 7061 7261 6d65 7465 722e 0a20 2020  s parameter..   
-0000caa0: 2020 2020 203a 7061 7261 6d20 7665 7262       :param verb
-0000cab0: 6f73 653a 2041 6464 2076 6572 626f 7365  ose: Add verbose
-0000cac0: 206c 6f67 7320 696e 746f 2074 6865 206f   logs into the o
-0000cad0: 7574 7075 742e 0a20 2020 2020 2020 203a  utput..        :
-0000cae0: 7265 7475 726e 733a 2054 6865 2066 6f6c  returns: The fol
-0000caf0: 6c6f 7769 6e67 2070 6172 616d 6574 6572  lowing parameter
-0000cb00: 733a 0a0a 2020 2020 2020 2020 2020 2020  s:..            
-0000cb10: 2d20 5465 7874 206f 6620 6275 696c 6465  - Text of builde
-0000cb20: 7220 6c6f 6773 2e0a 2020 2020 2020 2020  r logs..        
-0000cb30: 2020 2020 2d20 5469 6d65 7374 616d 7020      - Timestamp 
-0000cb40: 6f66 206c 6173 7420 6c6f 6720 7265 7472  of last log retr
-0000cb50: 6965 7665 642c 2074 6f20 6265 2075 7365  ieved, to be use
-0000cb60: 6420 696e 2073 7562 7365 7175 656e 7420  d in subsequent 
-0000cb70: 6361 6c6c 7320 746f 2074 6869 7320 6675  calls to this fu
-0000cb80: 6e63 7469 6f6e 2e0a 0a20 2020 2020 2020  nction...       
-0000cb90: 2020 2020 2054 6865 2066 756e 6374 696f       The functio
-0000cba0: 6e20 616c 736f 2075 7064 6174 6573 2069  n also updates i
-0000cbb0: 6e74 6572 6e61 6c20 6d65 6d62 6572 7320  nternal members 
-0000cbc0: 6f66 2074 6865 2060 6066 756e 6360 6020  of the ``func`` 
-0000cbd0: 6f62 6a65 6374 2074 6f20 7265 666c 6563  object to reflec
-0000cbe0: 7420 6275 696c 6420 7072 6f63 6573 7320  t build process 
-0000cbf0: 696e 666f 2e0a 2020 2020 2020 2020 2222  info..        ""
-0000cc00: 220a 0a20 2020 2020 2020 2074 7279 3a0a  "..        try:.
-0000cc10: 2020 2020 2020 2020 2020 2020 7061 7261              para
-0000cc20: 6d73 203d 207b 0a20 2020 2020 2020 2020  ms = {.         
-0000cc30: 2020 2020 2020 2022 6e61 6d65 223a 206e         "name": n
-0000cc40: 6f72 6d61 6c69 7a65 5f6e 616d 6528 6675  ormalize_name(fu
-0000cc50: 6e63 2e6d 6574 6164 6174 612e 6e61 6d65  nc.metadata.name
-0000cc60: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-0000cc70: 2020 2022 7072 6f6a 6563 7422 3a20 6675     "project": fu
-0000cc80: 6e63 2e6d 6574 6164 6174 612e 7072 6f6a  nc.metadata.proj
-0000cc90: 6563 742c 0a20 2020 2020 2020 2020 2020  ect,.           
-0000cca0: 2020 2020 2022 7461 6722 3a20 6675 6e63       "tag": func
-0000ccb0: 2e6d 6574 6164 6174 612e 7461 672c 0a20  .metadata.tag,. 
-0000ccc0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0000ccd0: 6c6f 6773 223a 2062 6f6f 6c32 7374 7228  logs": bool2str(
-0000cce0: 6c6f 6773 292c 0a20 2020 2020 2020 2020  logs),.         
-0000ccf0: 2020 2020 2020 2022 6f66 6673 6574 223a         "offset":
-0000cd00: 2073 7472 286f 6666 7365 7429 2c0a 2020   str(offset),.  
-0000cd10: 2020 2020 2020 2020 2020 2020 2020 226c                "l
-0000cd20: 6173 745f 6c6f 675f 7469 6d65 7374 616d  ast_log_timestam
-0000cd30: 7022 3a20 7374 7228 6c61 7374 5f6c 6f67  p": str(last_log
-0000cd40: 5f74 696d 6573 7461 6d70 292c 0a20 2020  _timestamp),.   
-0000cd50: 2020 2020 2020 2020 2020 2020 2022 7665               "ve
-0000cd60: 7262 6f73 6522 3a20 626f 6f6c 3273 7472  rbose": bool2str
-0000cd70: 2876 6572 626f 7365 292c 0a20 2020 2020  (verbose),.     
-0000cd80: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
-0000cd90: 2020 2020 2072 6573 7020 3d20 7365 6c66       resp = self
-0000cda0: 2e61 7069 5f63 616c 6c28 2247 4554 222c  .api_call("GET",
-0000cdb0: 2022 6275 696c 642f 7374 6174 7573 222c   "build/status",
-0000cdc0: 2070 6172 616d 733d 7061 7261 6d73 290a   params=params).
-0000cdd0: 2020 2020 2020 2020 6578 6365 7074 204f          except O
-0000cde0: 5345 7272 6f72 2061 7320 6572 723a 0a20  SError as err:. 
-0000cdf0: 2020 2020 2020 2020 2020 206c 6f67 6765             logge
-0000ce00: 722e 6572 726f 7228 6622 6572 726f 7220  r.error(f"error 
-0000ce10: 6765 7474 696e 6720 6275 696c 6420 7374  getting build st
-0000ce20: 6174 7573 3a20 7b65 7272 5f74 6f5f 7374  atus: {err_to_st
-0000ce30: 7228 6572 7229 7d22 290a 2020 2020 2020  r(err)}").      
-0000ce40: 2020 2020 2020 7261 6973 6520 4f53 4572        raise OSEr
-0000ce50: 726f 7228 6622 6572 726f 723a 2063 616e  ror(f"error: can
-0000ce60: 6e6f 7420 6765 7420 6275 696c 6420 7374  not get build st
-0000ce70: 6174 7573 2c20 7b65 7272 5f74 6f5f 7374  atus, {err_to_st
-0000ce80: 7228 6572 7229 7d22 290a 0a20 2020 2020  r(err)}")..     
-0000ce90: 2020 2069 6620 6e6f 7420 7265 7370 2e6f     if not resp.o
-0000cea0: 6b3a 0a20 2020 2020 2020 2020 2020 206c  k:.            l
-0000ceb0: 6f67 6765 722e 7761 726e 696e 6728 6622  ogger.warning(f"
-0000cec0: 6661 696c 6564 2072 6573 702c 207b 7265  failed resp, {re
-0000ced0: 7370 2e74 6578 747d 2229 0a20 2020 2020  sp.text}").     
-0000cee0: 2020 2020 2020 2072 6169 7365 2052 756e         raise Run
-0000cef0: 4442 4572 726f 7228 2262 6164 2066 756e  DBError("bad fun
-0000cf00: 6374 696f 6e20 6275 696c 6420 7265 7370  ction build resp
-0000cf10: 6f6e 7365 2229 0a0a 2020 2020 2020 2020  onse")..        
-0000cf20: 6966 2072 6573 702e 6865 6164 6572 733a  if resp.headers:
-0000cf30: 0a20 2020 2020 2020 2020 2020 2066 756e  .            fun
-0000cf40: 632e 7374 6174 7573 2e73 7461 7465 203d  c.status.state =
-0000cf50: 2072 6573 702e 6865 6164 6572 732e 6765   resp.headers.ge
-0000cf60: 7428 2278 2d6d 6c72 756e 2d66 756e 6374  t("x-mlrun-funct
-0000cf70: 696f 6e2d 7374 6174 7573 222c 2022 2229  ion-status", "")
-0000cf80: 0a20 2020 2020 2020 2020 2020 206c 6173  .            las
-0000cf90: 745f 6c6f 675f 7469 6d65 7374 616d 7020  t_log_timestamp 
-0000cfa0: 3d20 666c 6f61 7428 0a20 2020 2020 2020  = float(.       
-0000cfb0: 2020 2020 2020 2020 2072 6573 702e 6865           resp.he
-0000cfc0: 6164 6572 732e 6765 7428 2278 2d6d 6c72  aders.get("x-mlr
-0000cfd0: 756e 2d6c 6173 742d 7469 6d65 7374 616d  un-last-timestam
-0000cfe0: 7022 2c20 2230 2e30 2229 0a20 2020 2020  p", "0.0").     
-0000cff0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0000d000: 2020 2020 2069 6620 6675 6e63 2e6b 696e       if func.kin
-0000d010: 6420 696e 206d 6c72 756e 2e72 756e 7469  d in mlrun.runti
-0000d020: 6d65 732e 5275 6e74 696d 654b 696e 6473  mes.RuntimeKinds
-0000d030: 2e6e 7563 6c69 6f5f 7275 6e74 696d 6573  .nuclio_runtimes
-0000d040: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
-0000d050: 2020 2020 6675 6e63 2e73 7461 7475 732e      func.status.
-0000d060: 6164 6472 6573 7320 3d20 7265 7370 2e68  address = resp.h
-0000d070: 6561 6465 7273 2e67 6574 2822 782d 6d6c  eaders.get("x-ml
-0000d080: 7275 6e2d 6164 6472 6573 7322 2c20 2222  run-address", ""
-0000d090: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0000d0a0: 2020 6675 6e63 2e73 7461 7475 732e 6e75    func.status.nu
-0000d0b0: 636c 696f 5f6e 616d 6520 3d20 7265 7370  clio_name = resp
-0000d0c0: 2e68 6561 6465 7273 2e67 6574 2822 782d  .headers.get("x-
-0000d0d0: 6d6c 7275 6e2d 6e61 6d65 222c 2022 2229  mlrun-name", "")
-0000d0e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000d0f0: 2066 756e 632e 7374 6174 7573 2e69 6e74   func.status.int
-0000d100: 6572 6e61 6c5f 696e 766f 6361 7469 6f6e  ernal_invocation
-0000d110: 5f75 726c 7320 3d20 7265 7370 2e68 6561  _urls = resp.hea
-0000d120: 6465 7273 2e67 6574 280a 2020 2020 2020  ders.get(.      
-0000d130: 2020 2020 2020 2020 2020 2020 2020 2278                "x
-0000d140: 2d6d 6c72 756e 2d69 6e74 6572 6e61 6c2d  -mlrun-internal-
-0000d150: 696e 766f 6361 7469 6f6e 2d75 726c 7322  invocation-urls"
-0000d160: 2c20 2222 0a20 2020 2020 2020 2020 2020  , "".           
-0000d170: 2020 2020 2029 2e73 706c 6974 2822 2c22       ).split(","
-0000d180: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0000d190: 2020 6675 6e63 2e73 7461 7475 732e 6578    func.status.ex
-0000d1a0: 7465 726e 616c 5f69 6e76 6f63 6174 696f  ternal_invocatio
-0000d1b0: 6e5f 7572 6c73 203d 2072 6573 702e 6865  n_urls = resp.he
-0000d1c0: 6164 6572 732e 6765 7428 0a20 2020 2020  aders.get(.     
-0000d1d0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0000d1e0: 782d 6d6c 7275 6e2d 6578 7465 726e 616c  x-mlrun-external
-0000d1f0: 2d69 6e76 6f63 6174 696f 6e2d 7572 6c73  -invocation-urls
-0000d200: 222c 2022 220a 2020 2020 2020 2020 2020  ", "".          
-0000d210: 2020 2020 2020 292e 7370 6c69 7428 222c        ).split(",
-0000d220: 2229 0a20 2020 2020 2020 2020 2020 2020  ").             
-0000d230: 2020 2066 756e 632e 7374 6174 7573 2e63     func.status.c
-0000d240: 6f6e 7461 696e 6572 5f69 6d61 6765 203d  ontainer_image =
-0000d250: 2072 6573 702e 6865 6164 6572 732e 6765   resp.headers.ge
-0000d260: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
-0000d270: 2020 2020 2020 2022 782d 6d6c 7275 6e2d         "x-mlrun-
-0000d280: 636f 6e74 6169 6e65 722d 696d 6167 6522  container-image"
-0000d290: 2c20 2222 0a20 2020 2020 2020 2020 2020  , "".           
-0000d2a0: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-0000d2b0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0000d2c0: 2020 2020 2020 2020 2066 756e 632e 7374           func.st
-0000d2d0: 6174 7573 2e62 7569 6c64 5f70 6f64 203d  atus.build_pod =
-0000d2e0: 2072 6573 702e 6865 6164 6572 732e 6765   resp.headers.ge
-0000d2f0: 7428 2262 7569 6c64 6572 5f70 6f64 222c  t("builder_pod",
-0000d300: 2022 2229 0a20 2020 2020 2020 2020 2020   "").           
-0000d310: 2020 2020 2066 756e 632e 7370 6563 2e69       func.spec.i
-0000d320: 6d61 6765 203d 2072 6573 702e 6865 6164  mage = resp.head
-0000d330: 6572 732e 6765 7428 2266 756e 6374 696f  ers.get("functio
-0000d340: 6e5f 696d 6167 6522 2c20 2222 290a 0a20  n_image", "").. 
-0000d350: 2020 2020 2020 2074 6578 7420 3d20 2222         text = ""
-0000d360: 0a20 2020 2020 2020 2069 6620 7265 7370  .        if resp
-0000d370: 2e63 6f6e 7465 6e74 3a0a 2020 2020 2020  .content:.      
-0000d380: 2020 2020 2020 7465 7874 203d 2072 6573        text = res
-0000d390: 702e 636f 6e74 656e 742e 6465 636f 6465  p.content.decode
-0000d3a0: 2829 0a20 2020 2020 2020 2072 6574 7572  ().        retur
-0000d3b0: 6e20 7465 7874 2c20 6c61 7374 5f6c 6f67  n text, last_log
-0000d3c0: 5f74 696d 6573 7461 6d70 0a0a 2020 2020  _timestamp..    
-0000d3d0: 6465 6620 7265 6d6f 7465 5f73 7461 7274  def remote_start
-0000d3e0: 2873 656c 662c 2066 756e 635f 7572 6c29  (self, func_url)
-0000d3f0: 202d 3e20 6d6c 7275 6e2e 636f 6d6d 6f6e   -> mlrun.common
-0000d400: 2e73 6368 656d 6173 2e42 6163 6b67 726f  .schemas.Backgro
-0000d410: 756e 6454 6173 6b3a 0a20 2020 2020 2020  undTask:.       
-0000d420: 2022 2222 4578 6563 7574 6520 6120 6675   """Execute a fu
-0000d430: 6e63 7469 6f6e 2072 656d 6f74 656c 792c  nction remotely,
-0000d440: 2055 7365 6420 666f 7220 6060 6461 736b   Used for ``dask
-0000d450: 6060 2066 756e 6374 696f 6e73 2e0a 0a20  `` functions... 
-0000d460: 2020 2020 2020 203a 7061 7261 6d20 6675         :param fu
-0000d470: 6e63 5f75 726c 3a20 5552 4c20 746f 2074  nc_url: URL to t
-0000d480: 6865 2066 756e 6374 696f 6e20 746f 2062  he function to b
-0000d490: 6520 6578 6563 7574 6564 2e0a 2020 2020  e executed..    
-0000d4a0: 2020 2020 3a72 6574 7572 6e73 3a20 4120      :returns: A 
-0000d4b0: 4261 636b 6772 6f75 6e64 5461 736b 206f  BackgroundTask o
-0000d4c0: 626a 6563 742c 2077 6974 6820 6465 7461  bject, with deta
-0000d4d0: 696c 7320 6f6e 2065 7865 6375 7469 6f6e  ils on execution
-0000d4e0: 2070 726f 6365 7373 2061 6e64 2069 7473   process and its
-0000d4f0: 2073 7461 7475 732e 0a20 2020 2020 2020   status..       
-0000d500: 2022 2222 0a0a 2020 2020 2020 2020 7472   """..        tr
-0000d510: 793a 0a20 2020 2020 2020 2020 2020 2072  y:.            r
-0000d520: 6571 203d 207b 2266 756e 6374 696f 6e55  eq = {"functionU
-0000d530: 726c 223a 2066 756e 635f 7572 6c7d 0a20  rl": func_url}. 
-0000d540: 2020 2020 2020 2020 2020 2072 6573 7020             resp 
-0000d550: 3d20 7365 6c66 2e61 7069 5f63 616c 6c28  = self.api_call(
-0000d560: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000d570: 2022 504f 5354 222c 0a20 2020 2020 2020   "POST",.       
-0000d580: 2020 2020 2020 2020 2022 7374 6172 742f           "start/
-0000d590: 6675 6e63 7469 6f6e 222c 0a20 2020 2020  function",.     
-0000d5a0: 2020 2020 2020 2020 2020 206a 736f 6e3d             json=
-0000d5b0: 7265 712c 0a20 2020 2020 2020 2020 2020  req,.           
-0000d5c0: 2020 2020 2074 696d 656f 7574 3d69 6e74       timeout=int
-0000d5d0: 2863 6f6e 6669 672e 7375 626d 6974 5f74  (config.submit_t
-0000d5e0: 696d 656f 7574 2920 6f72 2036 302c 0a20  imeout) or 60,. 
-0000d5f0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-0000d600: 2020 2020 2065 7863 6570 7420 4f53 4572       except OSEr
-0000d610: 726f 7220 6173 2065 7272 3a0a 2020 2020  ror as err:.    
-0000d620: 2020 2020 2020 2020 6c6f 6767 6572 2e65          logger.e
-0000d630: 7272 6f72 2866 2265 7272 6f72 2073 7461  rror(f"error sta
-0000d640: 7274 696e 6720 6675 6e63 7469 6f6e 3a20  rting function: 
-0000d650: 7b65 7272 5f74 6f5f 7374 7228 6572 7229  {err_to_str(err)
-0000d660: 7d22 290a 2020 2020 2020 2020 2020 2020  }").            
-0000d670: 7261 6973 6520 4f53 4572 726f 7228 6622  raise OSError(f"
-0000d680: 6572 726f 723a 2063 616e 6e6f 7420 7374  error: cannot st
-0000d690: 6172 7420 6675 6e63 7469 6f6e 2c20 7b65  art function, {e
-0000d6a0: 7272 5f74 6f5f 7374 7228 6572 7229 7d22  rr_to_str(err)}"
-0000d6b0: 290a 0a20 2020 2020 2020 2069 6620 6e6f  )..        if no
-0000d6c0: 7420 7265 7370 2e6f 6b3a 0a20 2020 2020  t resp.ok:.     
-0000d6d0: 2020 2020 2020 206c 6f67 6765 722e 6572         logger.er
-0000d6e0: 726f 7228 6622 6261 6420 7265 7370 2121  ror(f"bad resp!!
-0000d6f0: 5c6e 7b72 6573 702e 7465 7874 7d22 290a  \n{resp.text}").
-0000d700: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-0000d710: 6520 5661 6c75 6545 7272 6f72 2822 6261  e ValueError("ba
-0000d720: 6420 6675 6e63 7469 6f6e 2073 7461 7274  d function start
-0000d730: 2072 6573 706f 6e73 6522 290a 0a20 2020   response")..   
-0000d740: 2020 2020 2072 6574 7572 6e20 6d6c 7275       return mlru
-0000d750: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
-0000d760: 2e42 6163 6b67 726f 756e 6454 6173 6b28  .BackgroundTask(
-0000d770: 2a2a 7265 7370 2e6a 736f 6e28 2929 0a0a  **resp.json())..
-0000d780: 2020 2020 6465 6620 6765 745f 7072 6f6a      def get_proj
-0000d790: 6563 745f 6261 636b 6772 6f75 6e64 5f74  ect_background_t
-0000d7a0: 6173 6b28 0a20 2020 2020 2020 2073 656c  ask(.        sel
-0000d7b0: 662c 0a20 2020 2020 2020 2070 726f 6a65  f,.        proje
-0000d7c0: 6374 3a20 7374 722c 0a20 2020 2020 2020  ct: str,.       
-0000d7d0: 206e 616d 653a 2073 7472 2c0a 2020 2020   name: str,.    
-0000d7e0: 2920 2d3e 206d 6c72 756e 2e63 6f6d 6d6f  ) -> mlrun.commo
-0000d7f0: 6e2e 7363 6865 6d61 732e 4261 636b 6772  n.schemas.Backgr
-0000d800: 6f75 6e64 5461 736b 3a0a 2020 2020 2020  oundTask:.      
-0000d810: 2020 2222 2252 6574 7269 6576 6520 7570    """Retrieve up
-0000d820: 6461 7465 6420 696e 666f 726d 6174 696f  dated informatio
-0000d830: 6e20 6f6e 2061 2070 726f 6a65 6374 2062  n on a project b
-0000d840: 6163 6b67 726f 756e 6420 7461 736b 2062  ackground task b
-0000d850: 6569 6e67 2065 7865 6375 7465 642e 2222  eing executed.""
-0000d860: 220a 0a20 2020 2020 2020 2070 726f 6a65  "..        proje
-0000d870: 6374 203d 2070 726f 6a65 6374 206f 7220  ct = project or 
-0000d880: 636f 6e66 6967 2e64 6566 6175 6c74 5f70  config.default_p
-0000d890: 726f 6a65 6374 0a20 2020 2020 2020 2070  roject.        p
-0000d8a0: 6174 6820 3d20 6622 7072 6f6a 6563 7473  ath = f"projects
-0000d8b0: 2f7b 7072 6f6a 6563 747d 2f62 6163 6b67  /{project}/backg
-0000d8c0: 726f 756e 642d 7461 736b 732f 7b6e 616d  round-tasks/{nam
-0000d8d0: 657d 220a 2020 2020 2020 2020 6572 726f  e}".        erro
-0000d8e0: 725f 6d65 7373 6167 6520 3d20 280a 2020  r_message = (.  
-0000d8f0: 2020 2020 2020 2020 2020 6622 4661 696c            f"Fail
-0000d900: 6564 2067 6574 7469 6e67 2070 726f 6a65  ed getting proje
-0000d910: 6374 2062 6163 6b67 726f 756e 6420 7461  ct background ta
-0000d920: 736b 2e20 7072 6f6a 6563 743d 7b70 726f  sk. project={pro
-0000d930: 6a65 6374 7d2c 206e 616d 653d 7b6e 616d  ject}, name={nam
-0000d940: 657d 220a 2020 2020 2020 2020 290a 2020  e}".        ).  
-0000d950: 2020 2020 2020 7265 7370 6f6e 7365 203d        response =
-0000d960: 2073 656c 662e 6170 695f 6361 6c6c 2822   self.api_call("
-0000d970: 4745 5422 2c20 7061 7468 2c20 6572 726f  GET", path, erro
-0000d980: 725f 6d65 7373 6167 6529 0a20 2020 2020  r_message).     
-0000d990: 2020 2072 6574 7572 6e20 6d6c 7275 6e2e     return mlrun.
-0000d9a0: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e42  common.schemas.B
-0000d9b0: 6163 6b67 726f 756e 6454 6173 6b28 2a2a  ackgroundTask(**
-0000d9c0: 7265 7370 6f6e 7365 2e6a 736f 6e28 2929  response.json())
-0000d9d0: 0a0a 2020 2020 6465 6620 6765 745f 6261  ..    def get_ba
-0000d9e0: 636b 6772 6f75 6e64 5f74 6173 6b28 7365  ckground_task(se
-0000d9f0: 6c66 2c20 6e61 6d65 3a20 7374 7229 202d  lf, name: str) -
-0000da00: 3e20 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  > mlrun.common.s
-0000da10: 6368 656d 6173 2e42 6163 6b67 726f 756e  chemas.Backgroun
-0000da20: 6454 6173 6b3a 0a20 2020 2020 2020 2022  dTask:.        "
-0000da30: 2222 5265 7472 6965 7665 2075 7064 6174  ""Retrieve updat
-0000da40: 6564 2069 6e66 6f72 6d61 7469 6f6e 206f  ed information o
-0000da50: 6e20 6120 6261 636b 6772 6f75 6e64 2074  n a background t
-0000da60: 6173 6b20 6265 696e 6720 6578 6563 7574  ask being execut
-0000da70: 6564 2e22 2222 0a0a 2020 2020 2020 2020  ed."""..        
-0000da80: 7061 7468 203d 2066 2262 6163 6b67 726f  path = f"backgro
-0000da90: 756e 642d 7461 736b 732f 7b6e 616d 657d  und-tasks/{name}
-0000daa0: 220a 2020 2020 2020 2020 6572 726f 725f  ".        error_
-0000dab0: 6d65 7373 6167 6520 3d20 6622 4661 696c  message = f"Fail
-0000dac0: 6564 2067 6574 7469 6e67 2062 6163 6b67  ed getting backg
-0000dad0: 726f 756e 6420 7461 736b 2e20 6e61 6d65  round task. name
-0000dae0: 3d7b 6e61 6d65 7d22 0a20 2020 2020 2020  ={name}".       
-0000daf0: 2072 6573 706f 6e73 6520 3d20 7365 6c66   response = self
-0000db00: 2e61 7069 5f63 616c 6c28 2247 4554 222c  .api_call("GET",
-0000db10: 2070 6174 682c 2065 7272 6f72 5f6d 6573   path, error_mes
-0000db20: 7361 6765 290a 2020 2020 2020 2020 7265  sage).        re
-0000db30: 7475 726e 206d 6c72 756e 2e63 6f6d 6d6f  turn mlrun.commo
-0000db40: 6e2e 7363 6865 6d61 732e 4261 636b 6772  n.schemas.Backgr
-0000db50: 6f75 6e64 5461 736b 282a 2a72 6573 706f  oundTask(**respo
-0000db60: 6e73 652e 6a73 6f6e 2829 290a 0a20 2020  nse.json())..   
-0000db70: 2064 6566 2072 656d 6f74 655f 7374 6174   def remote_stat
-0000db80: 7573 2873 656c 662c 2070 726f 6a65 6374  us(self, project
-0000db90: 2c20 6e61 6d65 2c20 6b69 6e64 2c20 7365  , name, kind, se
-0000dba0: 6c65 6374 6f72 293a 0a20 2020 2020 2020  lector):.       
-0000dbb0: 2022 2222 5265 7472 6965 7665 2073 7461   """Retrieve sta
-0000dbc0: 7475 7320 6f66 2061 2066 756e 6374 696f  tus of a functio
-0000dbd0: 6e20 6265 696e 6720 6578 6563 7574 6564  n being executed
-0000dbe0: 2072 656d 6f74 656c 7920 2872 656c 6576   remotely (relev
-0000dbf0: 616e 7420 746f 2060 6064 6173 6b60 6020  ant to ``dask`` 
-0000dc00: 6675 6e63 7469 6f6e 7329 2e0a 0a20 2020  functions)...   
-0000dc10: 2020 2020 203a 7061 7261 6d20 7072 6f6a       :param proj
-0000dc20: 6563 743a 2054 6865 2070 726f 6a65 6374  ect: The project
-0000dc30: 206f 6620 7468 6520 6675 6e63 7469 6f6e   of the function
-0000dc40: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-0000dc50: 6e61 6d65 3a20 5468 6520 6e61 6d65 206f  name: The name o
-0000dc60: 6620 7468 6520 6675 6e63 7469 6f6e 0a20  f the function. 
-0000dc70: 2020 2020 2020 203a 7061 7261 6d20 6b69         :param ki
-0000dc80: 6e64 3a20 5468 6520 6b69 6e64 206f 6620  nd: The kind of 
-0000dc90: 7468 6520 6675 6e63 7469 6f6e 2c20 6375  the function, cu
-0000dca0: 7272 656e 746c 7920 6060 6461 736b 6060  rrently ``dask``
-0000dcb0: 2069 7320 7375 7070 6f72 7465 642e 0a20   is supported.. 
-0000dcc0: 2020 2020 2020 203a 7061 7261 6d20 7365         :param se
-0000dcd0: 6c65 6374 6f72 3a20 5365 6c65 6374 6f72  lector: Selector
-0000dce0: 2063 6c61 7573 6520 746f 2062 6520 6170   clause to be ap
-0000dcf0: 706c 6965 6420 746f 2074 6865 204b 7562  plied to the Kub
-0000dd00: 6572 6e65 7465 7320 7374 6174 7573 2071  ernetes status q
-0000dd10: 7565 7279 2074 6f20 6669 6c74 6572 2074  uery to filter t
-0000dd20: 6865 2072 6573 756c 7473 2e0a 2020 2020  he results..    
-0000dd30: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
-0000dd40: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
-0000dd50: 2020 7265 7120 3d20 7b22 6b69 6e64 223a    req = {"kind":
-0000dd60: 206b 696e 642c 2022 7365 6c65 6374 6f72   kind, "selector
-0000dd70: 223a 2073 656c 6563 746f 722c 2022 7072  ": selector, "pr
-0000dd80: 6f6a 6563 7422 3a20 7072 6f6a 6563 742c  oject": project,
-0000dd90: 2022 6e61 6d65 223a 206e 616d 657d 0a20   "name": name}. 
-0000dda0: 2020 2020 2020 2020 2020 2072 6573 7020             resp 
-0000ddb0: 3d20 7365 6c66 2e61 7069 5f63 616c 6c28  = self.api_call(
-0000ddc0: 2250 4f53 5422 2c20 2273 7461 7475 732f  "POST", "status/
-0000ddd0: 6675 6e63 7469 6f6e 222c 206a 736f 6e3d  function", json=
-0000dde0: 7265 7129 0a20 2020 2020 2020 2065 7863  req).        exc
-0000ddf0: 6570 7420 4f53 4572 726f 7220 6173 2065  ept OSError as e
-0000de00: 7272 3a0a 2020 2020 2020 2020 2020 2020  rr:.            
-0000de10: 6c6f 6767 6572 2e65 7272 6f72 2866 2265  logger.error(f"e
-0000de20: 7272 6f72 2073 7461 7274 696e 6720 6675  rror starting fu
-0000de30: 6e63 7469 6f6e 3a20 7b65 7272 5f74 6f5f  nction: {err_to_
-0000de40: 7374 7228 6572 7229 7d22 290a 2020 2020  str(err)}").    
-0000de50: 2020 2020 2020 2020 7261 6973 6520 4f53          raise OS
-0000de60: 4572 726f 7228 6622 6572 726f 723a 2063  Error(f"error: c
-0000de70: 616e 6e6f 7420 7374 6172 7420 6675 6e63  annot start func
-0000de80: 7469 6f6e 2c20 7b65 7272 5f74 6f5f 7374  tion, {err_to_st
-0000de90: 7228 6572 7229 7d22 290a 0a20 2020 2020  r(err)}")..     
-0000dea0: 2020 2069 6620 6e6f 7420 7265 7370 2e6f     if not resp.o
-0000deb0: 6b3a 0a20 2020 2020 2020 2020 2020 206c  k:.            l
-0000dec0: 6f67 6765 722e 6572 726f 7228 6622 6261  ogger.error(f"ba
-0000ded0: 6420 7265 7370 2121 5c6e 7b72 6573 702e  d resp!!\n{resp.
-0000dee0: 7465 7874 7d22 290a 2020 2020 2020 2020  text}").        
-0000def0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-0000df00: 7272 6f72 2822 6261 6420 6675 6e63 7469  rror("bad functi
-0000df10: 6f6e 2073 7461 7475 7320 7265 7370 6f6e  on status respon
-0000df20: 7365 2229 0a0a 2020 2020 2020 2020 7265  se")..        re
-0000df30: 7475 726e 2072 6573 702e 6a73 6f6e 2829  turn resp.json()
-0000df40: 5b22 6461 7461 225d 0a0a 2020 2020 6465  ["data"]..    de
-0000df50: 6620 7375 626d 6974 5f6a 6f62 280a 2020  f submit_job(.  
-0000df60: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-0000df70: 2020 2020 7275 6e73 7065 632c 0a20 2020      runspec,.   
-0000df80: 2020 2020 2073 6368 6564 756c 653a 2055       schedule: U
-0000df90: 6e69 6f6e 5b73 7472 2c20 6d6c 7275 6e2e  nion[str, mlrun.
-0000dfa0: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e53  common.schemas.S
-0000dfb0: 6368 6564 756c 6543 726f 6e54 7269 6767  cheduleCronTrigg
-0000dfc0: 6572 5d20 3d20 4e6f 6e65 2c0a 2020 2020  er] = None,.    
-0000dfd0: 293a 0a20 2020 2020 2020 2022 2222 5375  ):.        """Su
-0000dfe0: 626d 6974 2061 206a 6f62 2066 6f72 2072  bmit a job for r
-0000dff0: 656d 6f74 6520 6578 6563 7574 696f 6e2e  emote execution.
-0000e000: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-0000e010: 2072 756e 7370 6563 3a20 5468 6520 7275   runspec: The ru
-0000e020: 6e74 696d 6520 6f62 6a65 6374 2073 7065  ntime object spe
-0000e030: 6320 2854 6173 6b29 2074 6f20 6578 6563  c (Task) to exec
-0000e040: 7574 652e 0a20 2020 2020 2020 203a 7061  ute..        :pa
-0000e050: 7261 6d20 7363 6865 6475 6c65 3a20 5768  ram schedule: Wh
-0000e060: 6574 6865 7220 746f 2073 6368 6564 756c  ether to schedul
-0000e070: 6520 7468 6973 206a 6f62 2075 7369 6e67  e this job using
-0000e080: 2061 2043 726f 6e20 7472 6967 6765 722e   a Cron trigger.
-0000e090: 2049 6620 6e6f 7420 7370 6563 6966 6965   If not specifie
-0000e0a0: 642c 2074 6865 206a 6f62 2077 696c 6c20  d, the job will 
-0000e0b0: 6265 2073 7562 6d69 7474 6564 0a20 2020  be submitted.   
-0000e0c0: 2020 2020 2020 2020 2069 6d6d 6564 6961           immedia
-0000e0d0: 7465 6c79 2e0a 2020 2020 2020 2020 2222  tely..        ""
-0000e0e0: 220a 0a20 2020 2020 2020 2074 7279 3a0a  "..        try:.
-0000e0f0: 2020 2020 2020 2020 2020 2020 7265 7120              req 
-0000e100: 3d20 7b22 7461 736b 223a 2072 756e 7370  = {"task": runsp
-0000e110: 6563 2e74 6f5f 6469 6374 2829 7d0a 2020  ec.to_dict()}.  
-0000e120: 2020 2020 2020 2020 2020 6966 2073 6368            if sch
-0000e130: 6564 756c 653a 0a20 2020 2020 2020 2020  edule:.         
-0000e140: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-0000e150: 616e 6365 2873 6368 6564 756c 652c 206d  ance(schedule, m
-0000e160: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
-0000e170: 6d61 732e 5363 6865 6475 6c65 4372 6f6e  mas.ScheduleCron
-0000e180: 5472 6967 6765 7229 3a0a 2020 2020 2020  Trigger):.      
-0000e190: 2020 2020 2020 2020 2020 2020 2020 7363                sc
-0000e1a0: 6865 6475 6c65 203d 2073 6368 6564 756c  hedule = schedul
-0000e1b0: 652e 6469 6374 2829 0a20 2020 2020 2020  e.dict().       
-0000e1c0: 2020 2020 2020 2020 2072 6571 5b22 7363           req["sc
-0000e1d0: 6865 6475 6c65 225d 203d 2073 6368 6564  hedule"] = sched
-0000e1e0: 756c 650a 2020 2020 2020 2020 2020 2020  ule.            
-0000e1f0: 7469 6d65 6f75 7420 3d20 2869 6e74 2863  timeout = (int(c
-0000e200: 6f6e 6669 672e 7375 626d 6974 5f74 696d  onfig.submit_tim
-0000e210: 656f 7574 2920 6f72 2031 3230 2920 2b20  eout) or 120) + 
-0000e220: 3230 0a20 2020 2020 2020 2020 2020 2072  20.            r
-0000e230: 6573 7020 3d20 7365 6c66 2e61 7069 5f63  esp = self.api_c
-0000e240: 616c 6c28 2250 4f53 5422 2c20 2273 7562  all("POST", "sub
-0000e250: 6d69 745f 6a6f 6222 2c20 6a73 6f6e 3d72  mit_job", json=r
-0000e260: 6571 2c20 7469 6d65 6f75 743d 7469 6d65  eq, timeout=time
-0000e270: 6f75 7429 0a0a 2020 2020 2020 2020 6578  out)..        ex
-0000e280: 6365 7074 2072 6571 7565 7374 732e 4854  cept requests.HT
-0000e290: 5450 4572 726f 7220 6173 2065 7272 3a0a  TPError as err:.
-0000e2a0: 2020 2020 2020 2020 2020 2020 6c6f 6767              logg
-0000e2b0: 6572 2e65 7272 6f72 2866 2265 7272 6f72  er.error(f"error
-0000e2c0: 2073 7562 6d69 7474 696e 6720 7461 736b   submitting task
-0000e2d0: 3a20 7b65 7272 5f74 6f5f 7374 7228 6572  : {err_to_str(er
-0000e2e0: 7229 7d22 290a 2020 2020 2020 2020 2020  r)}").          
-0000e2f0: 2020 2320 6e6f 7420 6372 6561 7469 6e67    # not creating
-0000e300: 2061 206e 6577 2065 7863 6570 7469 6f6e   a new exception
-0000e310: 2068 6572 652c 2069 6e20 6f72 6465 7220   here, in order 
-0000e320: 746f 206b 6565 7020 7468 6520 7265 7370  to keep the resp
-0000e330: 6f6e 7365 2061 6e64 2073 7461 7475 7320  onse and status 
-0000e340: 636f 6465 2069 6e20 7468 6520 6578 6365  code in the exce
-0000e350: 7074 696f 6e0a 2020 2020 2020 2020 2020  ption.          
-0000e360: 2020 7261 6973 650a 0a20 2020 2020 2020    raise..       
-0000e370: 2065 7863 6570 7420 4f53 4572 726f 7220   except OSError 
-0000e380: 6173 2065 7272 3a0a 2020 2020 2020 2020  as err:.        
-0000e390: 2020 2020 6c6f 6767 6572 2e65 7272 6f72      logger.error
-0000e3a0: 2866 2265 7272 6f72 2073 7562 6d69 7474  (f"error submitt
-0000e3b0: 696e 6720 7461 736b 3a20 7b65 7272 5f74  ing task: {err_t
-0000e3c0: 6f5f 7374 7228 6572 7229 7d22 290a 2020  o_str(err)}").  
-0000e3d0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0000e3e0: 4f53 4572 726f 7228 2265 7272 6f72 3a20  OSError("error: 
-0000e3f0: 6361 6e6e 6f74 2073 7562 6d69 7420 7461  cannot submit ta
-0000e400: 736b 2229 2066 726f 6d20 6572 720a 0a20  sk") from err.. 
-0000e410: 2020 2020 2020 2069 6620 6e6f 7420 7265         if not re
-0000e420: 7370 2e6f 6b3a 0a20 2020 2020 2020 2020  sp.ok:.         
-0000e430: 2020 206c 6f67 6765 722e 6572 726f 7228     logger.error(
-0000e440: 6622 6261 6420 7265 7370 2121 5c6e 7b72  f"bad resp!!\n{r
-0000e450: 6573 702e 7465 7874 7d22 290a 2020 2020  esp.text}").    
-0000e460: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-0000e470: 6c75 6545 7272 6f72 2866 2262 6164 2066  lueError(f"bad f
-0000e480: 756e 6374 696f 6e20 7275 6e20 7265 7370  unction run resp
-0000e490: 6f6e 7365 2c20 7b72 6573 702e 7465 7874  onse, {resp.text
-0000e4a0: 7d22 290a 0a20 2020 2020 2020 2072 6573  }")..        res
-0000e4b0: 7020 3d20 7265 7370 2e6a 736f 6e28 290a  p = resp.json().
-0000e4c0: 2020 2020 2020 2020 7265 7475 726e 2072          return r
-0000e4d0: 6573 705b 2264 6174 6122 5d0a 0a20 2020  esp["data"]..   
-0000e4e0: 2064 6566 2073 7562 6d69 745f 7069 7065   def submit_pipe
-0000e4f0: 6c69 6e65 280a 2020 2020 2020 2020 7365  line(.        se
-0000e500: 6c66 2c0a 2020 2020 2020 2020 7072 6f6a  lf,.        proj
-0000e510: 6563 742c 0a20 2020 2020 2020 2070 6970  ect,.        pip
-0000e520: 656c 696e 652c 0a20 2020 2020 2020 2061  eline,.        a
-0000e530: 7267 756d 656e 7473 3d4e 6f6e 652c 0a20  rguments=None,. 
-0000e540: 2020 2020 2020 2065 7870 6572 696d 656e         experimen
-0000e550: 743d 4e6f 6e65 2c0a 2020 2020 2020 2020  t=None,.        
-0000e560: 7275 6e3d 4e6f 6e65 2c0a 2020 2020 2020  run=None,.      
-0000e570: 2020 6e61 6d65 7370 6163 653d 4e6f 6e65    namespace=None
-0000e580: 2c0a 2020 2020 2020 2020 6172 7469 6661  ,.        artifa
-0000e590: 6374 5f70 6174 683d 4e6f 6e65 2c0a 2020  ct_path=None,.  
-0000e5a0: 2020 2020 2020 6f70 733d 4e6f 6e65 2c0a        ops=None,.
-0000e5b0: 2020 2020 2020 2020 2320 544f 444f 3a20          # TODO: 
-0000e5c0: 6465 7072 6563 6174 6564 2c20 7265 6d6f  deprecated, remo
-0000e5d0: 7665 2069 6e20 312e 352e 300a 2020 2020  ve in 1.5.0.    
-0000e5e0: 2020 2020 7474 6c3d 4e6f 6e65 2c0a 2020      ttl=None,.  
-0000e5f0: 2020 2020 2020 636c 6561 6e75 705f 7474        cleanup_tt
-0000e600: 6c3d 4e6f 6e65 2c0a 2020 2020 293a 0a20  l=None,.    ):. 
-0000e610: 2020 2020 2020 2022 2222 5375 626d 6974         """Submit
-0000e620: 2061 204b 4650 2070 6970 656c 696e 6520   a KFP pipeline 
-0000e630: 666f 7220 6578 6563 7574 696f 6e2e 0a0a  for execution...
-0000e640: 2020 2020 2020 2020 3a70 6172 616d 2070          :param p
-0000e650: 726f 6a65 6374 3a20 5468 6520 7072 6f6a  roject: The proj
-0000e660: 6563 7420 6f66 2074 6865 2070 6970 656c  ect of the pipel
-0000e670: 696e 650a 2020 2020 2020 2020 3a70 6172  ine.        :par
-0000e680: 616d 2070 6970 656c 696e 653a 2050 6970  am pipeline: Pip
-0000e690: 656c 696e 6520 6675 6e63 7469 6f6e 206f  eline function o
-0000e6a0: 7220 7061 7468 2074 6f20 2e79 616d 6c2f  r path to .yaml/
-0000e6b0: 2e7a 6970 2070 6970 656c 696e 6520 6669  .zip pipeline fi
-0000e6c0: 6c65 2e0a 2020 2020 2020 2020 3a70 6172  le..        :par
-0000e6d0: 616d 2061 7267 756d 656e 7473 3a20 4120  am arguments: A 
-0000e6e0: 6469 6374 696f 6e61 7279 206f 6620 6172  dictionary of ar
-0000e6f0: 6775 6d65 6e74 7320 746f 2070 6173 7320  guments to pass 
-0000e700: 746f 2074 6865 2070 6970 656c 696e 652e  to the pipeline.
-0000e710: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-0000e720: 6578 7065 7269 6d65 6e74 3a20 4120 6e61  experiment: A na
-0000e730: 6d65 2074 6f20 6173 7369 676e 2066 6f72  me to assign for
-0000e740: 2074 6865 2073 7065 6369 6669 6320 6578   the specific ex
-0000e750: 7065 7269 6d65 6e74 2e0a 2020 2020 2020  periment..      
-0000e760: 2020 3a70 6172 616d 2072 756e 3a20 4120    :param run: A 
-0000e770: 6e61 6d65 2066 6f72 2074 6869 7320 7370  name for this sp
-0000e780: 6563 6966 6963 2072 756e 2e0a 2020 2020  ecific run..    
-0000e790: 2020 2020 3a70 6172 616d 206e 616d 6573      :param names
-0000e7a0: 7061 6365 3a20 4b75 6265 726e 6574 6573  pace: Kubernetes
-0000e7b0: 206e 616d 6573 7061 6365 2074 6f20 6578   namespace to ex
-0000e7c0: 6563 7574 6520 7468 6520 7069 7065 6c69  ecute the pipeli
-0000e7d0: 6e65 2069 6e2e 0a20 2020 2020 2020 203a  ne in..        :
-0000e7e0: 7061 7261 6d20 6172 7469 6661 6374 5f70  param artifact_p
-0000e7f0: 6174 683a 2041 2070 6174 6820 746f 2061  ath: A path to a
-0000e800: 7274 6966 6163 7473 2075 7365 6420 6279  rtifacts used by
-0000e810: 2074 6869 7320 7069 7065 6c69 6e65 2e0a   this pipeline..
-0000e820: 2020 2020 2020 2020 3a70 6172 616d 206f          :param o
-0000e830: 7073 3a20 5472 616e 7366 6f72 6d65 7273  ps: Transformers
-0000e840: 2074 6f20 6170 706c 7920 6f6e 2061 6c6c   to apply on all
-0000e850: 206f 7073 2069 6e20 7468 6520 7069 7065   ops in the pipe
-0000e860: 6c69 6e65 2e0a 2020 2020 2020 2020 3a70  line..        :p
-0000e870: 6172 616d 2074 746c 3a20 7069 7065 6c69  aram ttl: pipeli
-0000e880: 6e65 2063 6c65 616e 7570 2074 746c 2069  ne cleanup ttl i
-0000e890: 6e20 7365 6373 2028 7469 6d65 2074 6f20  n secs (time to 
-0000e8a0: 7761 6974 2061 6674 6572 2077 6f72 6b66  wait after workf
-0000e8b0: 6c6f 7720 636f 6d70 6c65 7469 6f6e 2c20  low completion, 
-0000e8c0: 6174 2077 6869 6368 2070 6f69 6e74 2074  at which point t
-0000e8d0: 6865 2077 6f72 6b66 6c6f 770a 2020 2020  he workflow.    
-0000e8e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e8f0: 616e 6420 616c 6c20 6974 7320 7265 736f  and all its reso
-0000e900: 7572 6365 7320 6172 6520 6465 6c65 7465  urces are delete
-0000e910: 6429 2028 6465 7072 6563 6174 6564 2c20  d) (deprecated, 
-0000e920: 7573 6520 636c 6561 6e75 705f 7474 6c20  use cleanup_ttl 
-0000e930: 696e 7374 6561 6429 0a20 2020 2020 2020  instead).       
-0000e940: 203a 7061 7261 6d20 636c 6561 6e75 705f   :param cleanup_
-0000e950: 7474 6c3a 2070 6970 656c 696e 6520 636c  ttl: pipeline cl
-0000e960: 6561 6e75 7020 7474 6c20 696e 2073 6563  eanup ttl in sec
-0000e970: 7320 2874 696d 6520 746f 2077 6169 7420  s (time to wait 
-0000e980: 6166 7465 7220 776f 726b 666c 6f77 2063  after workflow c
-0000e990: 6f6d 706c 6574 696f 6e2c 2061 7420 7768  ompletion, at wh
-0000e9a0: 6963 6820 706f 696e 7420 7468 650a 2020  ich point the.  
-0000e9b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e9c0: 2020 2020 2020 2020 2020 776f 726b 666c            workfl
-0000e9d0: 6f77 2061 6e64 2061 6c6c 2069 7473 2072  ow and all its r
-0000e9e0: 6573 6f75 7263 6573 2061 7265 2064 656c  esources are del
-0000e9f0: 6574 6564 290a 2020 2020 2020 2020 2222  eted).        ""
-0000ea00: 220a 0a20 2020 2020 2020 2069 6620 7474  "..        if tt
-0000ea10: 6c3a 0a20 2020 2020 2020 2020 2020 2077  l:.            w
-0000ea20: 6172 6e69 6e67 732e 7761 726e 280a 2020  arnings.warn(.  
-0000ea30: 2020 2020 2020 2020 2020 2020 2020 2227                "'
-0000ea40: 7474 6c27 2069 7320 6465 7072 6563 6174  ttl' is deprecat
-0000ea50: 6564 2c20 7573 6520 2763 6c65 616e 7570  ed, use 'cleanup
-0000ea60: 5f74 746c 2720 696e 7374 6561 642e 2022  _ttl' instead. "
-0000ea70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000ea80: 2022 5468 6973 2077 696c 6c20 6265 2072   "This will be r
-0000ea90: 656d 6f76 6564 2069 6e20 312e 352e 3022  emoved in 1.5.0"
-0000eaa0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000eab0: 2020 2320 544f 444f 3a20 5265 6d6f 7665    # TODO: Remove
-0000eac0: 2074 6869 7320 696e 2031 2e35 2e30 0a20   this in 1.5.0. 
-0000ead0: 2020 2020 2020 2020 2020 2020 2020 2046                 F
-0000eae0: 7574 7572 6557 6172 6e69 6e67 2c0a 2020  utureWarning,.  
-0000eaf0: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
-0000eb00: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
-0000eb10: 6365 2870 6970 656c 696e 652c 2073 7472  ce(pipeline, str
-0000eb20: 293a 0a20 2020 2020 2020 2020 2020 2070  ):.            p
-0000eb30: 6970 655f 6669 6c65 203d 2070 6970 656c  ipe_file = pipel
-0000eb40: 696e 650a 2020 2020 2020 2020 656c 7365  ine.        else
-0000eb50: 3a0a 2020 2020 2020 2020 2020 2020 7069  :.            pi
-0000eb60: 7065 5f66 696c 6520 3d20 7465 6d70 6669  pe_file = tempfi
-0000eb70: 6c65 2e4e 616d 6564 5465 6d70 6f72 6172  le.NamedTemporar
-0000eb80: 7946 696c 6528 7375 6666 6978 3d22 2e79  yFile(suffix=".y
-0000eb90: 616d 6c22 2c20 6465 6c65 7465 3d46 616c  aml", delete=Fal
-0000eba0: 7365 292e 6e61 6d65 0a20 2020 2020 2020  se).name.       
-0000ebb0: 2020 2020 2063 6f6e 6620 3d20 6e65 775f       conf = new_
-0000ebc0: 7069 7065 5f6d 6574 6164 6174 6128 0a20  pipe_metadata(. 
-0000ebd0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-0000ebe0: 7274 6966 6163 745f 7061 7468 3d61 7274  rtifact_path=art
-0000ebf0: 6966 6163 745f 7061 7468 2c0a 2020 2020  ifact_path,.    
-0000ec00: 2020 2020 2020 2020 2020 2020 636c 6561              clea
-0000ec10: 6e75 705f 7474 6c3d 636c 6561 6e75 705f  nup_ttl=cleanup_
-0000ec20: 7474 6c20 6f72 2074 746c 2c0a 2020 2020  ttl or ttl,.    
-0000ec30: 2020 2020 2020 2020 2020 2020 6f70 5f74              op_t
-0000ec40: 7261 6e73 666f 726d 6572 733d 6f70 732c  ransformers=ops,
-0000ec50: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-0000ec60: 2020 2020 2020 2020 2020 206b 6670 2e63             kfp.c
-0000ec70: 6f6d 7069 6c65 722e 436f 6d70 696c 6572  ompiler.Compiler
-0000ec80: 2829 2e63 6f6d 7069 6c65 280a 2020 2020  ().compile(.    
-0000ec90: 2020 2020 2020 2020 2020 2020 7069 7065              pipe
-0000eca0: 6c69 6e65 2c20 7069 7065 5f66 696c 652c  line, pipe_file,
-0000ecb0: 2074 7970 655f 6368 6563 6b3d 4661 6c73   type_check=Fals
-0000ecc0: 652c 2070 6970 656c 696e 655f 636f 6e66  e, pipeline_conf
-0000ecd0: 3d63 6f6e 660a 2020 2020 2020 2020 2020  =conf.          
-0000ece0: 2020 290a 0a20 2020 2020 2020 2069 6620    )..        if 
-0000ecf0: 7069 7065 5f66 696c 652e 656e 6473 7769  pipe_file.endswi
-0000ed00: 7468 2822 2e79 616d 6c22 293a 0a20 2020  th(".yaml"):.   
-0000ed10: 2020 2020 2020 2020 2068 6561 6465 7273           headers
-0000ed20: 203d 207b 2263 6f6e 7465 6e74 2d74 7970   = {"content-typ
-0000ed30: 6522 3a20 2261 7070 6c69 6361 7469 6f6e  e": "application
-0000ed40: 2f79 616d 6c22 7d0a 2020 2020 2020 2020  /yaml"}.        
-0000ed50: 656c 6966 2070 6970 655f 6669 6c65 2e65  elif pipe_file.e
-0000ed60: 6e64 7377 6974 6828 222e 7a69 7022 293a  ndswith(".zip"):
-0000ed70: 0a20 2020 2020 2020 2020 2020 2068 6561  .            hea
-0000ed80: 6465 7273 203d 207b 2263 6f6e 7465 6e74  ders = {"content
-0000ed90: 2d74 7970 6522 3a20 2261 7070 6c69 6361  -type": "applica
-0000eda0: 7469 6f6e 2f7a 6970 227d 0a20 2020 2020  tion/zip"}.     
-0000edb0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0000edc0: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-0000edd0: 4572 726f 7228 2270 6970 656c 696e 6520  Error("pipeline 
-0000ede0: 6669 6c65 206d 7573 7420 6265 202e 7961  file must be .ya
-0000edf0: 6d6c 206f 7220 2e7a 6970 2229 0a20 2020  ml or .zip").   
-0000ee00: 2020 2020 2069 6620 6172 6775 6d65 6e74       if argument
-0000ee10: 733a 0a20 2020 2020 2020 2020 2020 2069  s:.            i
-0000ee20: 6620 6e6f 7420 6973 696e 7374 616e 6365  f not isinstance
-0000ee30: 2861 7267 756d 656e 7473 2c20 6469 6374  (arguments, dict
-0000ee40: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-0000ee50: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-0000ee60: 726f 7228 2261 7267 756d 656e 7473 206d  ror("arguments m
-0000ee70: 7573 7420 6265 2064 6963 7420 7479 7065  ust be dict type
-0000ee80: 2229 0a20 2020 2020 2020 2020 2020 2068  ").            h
-0000ee90: 6561 6465 7273 5b6d 6c72 756e 2e63 6f6d  eaders[mlrun.com
-0000eea0: 6d6f 6e2e 7363 6865 6d61 732e 4865 6164  mon.schemas.Head
-0000eeb0: 6572 4e61 6d65 732e 7069 7065 6c69 6e65  erNames.pipeline
-0000eec0: 5f61 7267 756d 656e 7473 5d20 3d20 7374  _arguments] = st
-0000eed0: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
-0000eee0: 2020 2061 7267 756d 656e 7473 0a20 2020     arguments.   
-0000eef0: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-0000ef00: 2020 2020 6966 206e 6f74 2070 6174 682e      if not path.
-0000ef10: 6973 6669 6c65 2870 6970 655f 6669 6c65  isfile(pipe_file
-0000ef20: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
-0000ef30: 6169 7365 204f 5345 7272 6f72 2866 2266  aise OSError(f"f
-0000ef40: 696c 6520 7b70 6970 655f 6669 6c65 7d20  ile {pipe_file} 
-0000ef50: 646f 6573 6e74 2065 7869 7374 2229 0a20  doesnt exist"). 
-0000ef60: 2020 2020 2020 2077 6974 6820 6f70 656e         with open
-0000ef70: 2870 6970 655f 6669 6c65 2c20 2272 6222  (pipe_file, "rb"
-0000ef80: 2920 6173 2066 703a 0a20 2020 2020 2020  ) as fp:.       
-0000ef90: 2020 2020 2064 6174 6120 3d20 6670 2e72       data = fp.r
-0000efa0: 6561 6428 290a 2020 2020 2020 2020 6966  ead().        if
-0000efb0: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
-0000efc0: 7069 7065 6c69 6e65 2c20 7374 7229 3a0a  pipeline, str):.
-0000efd0: 2020 2020 2020 2020 2020 2020 7265 6d6f              remo
-0000efe0: 7665 2870 6970 655f 6669 6c65 290a 0a20  ve(pipe_file).. 
-0000eff0: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
-0000f000: 2020 2020 2020 2020 7061 7261 6d73 203d          params =
-0000f010: 207b 226e 616d 6573 7061 6365 223a 206e   {"namespace": n
-0000f020: 616d 6573 7061 6365 2c20 2265 7870 6572  amespace, "exper
-0000f030: 696d 656e 7422 3a20 6578 7065 7269 6d65  iment": experime
-0000f040: 6e74 2c20 2272 756e 223a 2072 756e 7d0a  nt, "run": run}.
-0000f050: 2020 2020 2020 2020 2020 2020 7265 7370              resp
-0000f060: 203d 2073 656c 662e 6170 695f 6361 6c6c   = self.api_call
-0000f070: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0000f080: 2020 2250 4f53 5422 2c0a 2020 2020 2020    "POST",.      
-0000f090: 2020 2020 2020 2020 2020 6622 7072 6f6a            f"proj
-0000f0a0: 6563 7473 2f7b 7072 6f6a 6563 747d 2f70  ects/{project}/p
-0000f0b0: 6970 656c 696e 6573 222c 0a20 2020 2020  ipelines",.     
-0000f0c0: 2020 2020 2020 2020 2020 2070 6172 616d             param
-0000f0d0: 733d 7061 7261 6d73 2c0a 2020 2020 2020  s=params,.      
-0000f0e0: 2020 2020 2020 2020 2020 7469 6d65 6f75            timeou
-0000f0f0: 743d 3230 2c0a 2020 2020 2020 2020 2020  t=20,.          
-0000f100: 2020 2020 2020 626f 6479 3d64 6174 612c        body=data,
-0000f110: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000f120: 2068 6561 6465 7273 3d68 6561 6465 7273   headers=headers
-0000f130: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
-0000f140: 2020 2020 2020 2020 6578 6365 7074 204f          except O
-0000f150: 5345 7272 6f72 2061 7320 6572 723a 0a20  SError as err:. 
-0000f160: 2020 2020 2020 2020 2020 206c 6f67 6765             logge
-0000f170: 722e 6572 726f 7228 6622 6572 726f 7220  r.error(f"error 
-0000f180: 6361 6e6e 6f74 2073 7562 6d69 7420 7069  cannot submit pi
-0000f190: 7065 6c69 6e65 3a20 7b65 7272 5f74 6f5f  peline: {err_to_
-0000f1a0: 7374 7228 6572 7229 7d22 290a 2020 2020  str(err)}").    
-0000f1b0: 2020 2020 2020 2020 7261 6973 6520 4f53          raise OS
-0000f1c0: 4572 726f 7228 6622 6572 726f 723a 2063  Error(f"error: c
-0000f1d0: 616e 6e6f 7420 6361 6e6e 6f74 2073 7562  annot cannot sub
-0000f1e0: 6d69 7420 7069 7065 6c69 6e65 2c20 7b65  mit pipeline, {e
-0000f1f0: 7272 5f74 6f5f 7374 7228 6572 7229 7d22  rr_to_str(err)}"
-0000f200: 290a 0a20 2020 2020 2020 2069 6620 6e6f  )..        if no
-0000f210: 7420 7265 7370 2e6f 6b3a 0a20 2020 2020  t resp.ok:.     
-0000f220: 2020 2020 2020 206c 6f67 6765 722e 6572         logger.er
-0000f230: 726f 7228 6622 6261 6420 7265 7370 2121  ror(f"bad resp!!
-0000f240: 5c6e 7b72 6573 702e 7465 7874 7d22 290a  \n{resp.text}").
-0000f250: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-0000f260: 6520 5661 6c75 6545 7272 6f72 2866 2262  e ValueError(f"b
-0000f270: 6164 2073 7562 6d69 7420 7069 7065 6c69  ad submit pipeli
-0000f280: 6e65 2072 6573 706f 6e73 652c 207b 7265  ne response, {re
-0000f290: 7370 2e74 6578 747d 2229 0a0a 2020 2020  sp.text}")..    
-0000f2a0: 2020 2020 7265 7370 203d 2072 6573 702e      resp = resp.
-0000f2b0: 6a73 6f6e 2829 0a20 2020 2020 2020 206c  json().        l
-0000f2c0: 6f67 6765 722e 696e 666f 2866 2273 7562  ogger.info(f"sub
-0000f2d0: 6d69 7474 6564 2070 6970 656c 696e 6520  mitted pipeline 
-0000f2e0: 7b72 6573 705b 276e 616d 6527 5d7d 2069  {resp['name']} i
-0000f2f0: 643d 7b72 6573 705b 2769 6427 5d7d 2229  d={resp['id']}")
-0000f300: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0000f310: 7265 7370 5b22 6964 225d 0a0a 2020 2020  resp["id"]..    
-0000f320: 6465 6620 6c69 7374 5f70 6970 656c 696e  def list_pipelin
-0000f330: 6573 280a 2020 2020 2020 2020 7365 6c66  es(.        self
-0000f340: 2c0a 2020 2020 2020 2020 7072 6f6a 6563  ,.        projec
-0000f350: 743a 2073 7472 2c0a 2020 2020 2020 2020  t: str,.        
-0000f360: 6e61 6d65 7370 6163 653a 2073 7472 203d  namespace: str =
-0000f370: 204e 6f6e 652c 0a20 2020 2020 2020 2073   None,.        s
-0000f380: 6f72 745f 6279 3a20 7374 7220 3d20 2222  ort_by: str = ""
-0000f390: 2c0a 2020 2020 2020 2020 7061 6765 5f74  ,.        page_t
-0000f3a0: 6f6b 656e 3a20 7374 7220 3d20 2222 2c0a  oken: str = "",.
-0000f3b0: 2020 2020 2020 2020 6669 6c74 6572 5f3a          filter_:
-0000f3c0: 2073 7472 203d 2022 222c 0a20 2020 2020   str = "",.     
-0000f3d0: 2020 2066 6f72 6d61 745f 3a20 556e 696f     format_: Unio
-0000f3e0: 6e5b 0a20 2020 2020 2020 2020 2020 2073  n[.            s
-0000f3f0: 7472 2c20 6d6c 7275 6e2e 636f 6d6d 6f6e  tr, mlrun.common
-0000f400: 2e73 6368 656d 6173 2e50 6970 656c 696e  .schemas.Pipelin
-0000f410: 6573 466f 726d 6174 0a20 2020 2020 2020  esFormat.       
-0000f420: 205d 203d 206d 6c72 756e 2e63 6f6d 6d6f   ] = mlrun.commo
-0000f430: 6e2e 7363 6865 6d61 732e 5069 7065 6c69  n.schemas.Pipeli
-0000f440: 6e65 7346 6f72 6d61 742e 6d65 7461 6461  nesFormat.metada
-0000f450: 7461 5f6f 6e6c 792c 0a20 2020 2020 2020  ta_only,.       
-0000f460: 2070 6167 655f 7369 7a65 3a20 696e 7420   page_size: int 
-0000f470: 3d20 4e6f 6e65 2c0a 2020 2020 2920 2d3e  = None,.    ) ->
-0000f480: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
-0000f490: 6865 6d61 732e 5069 7065 6c69 6e65 734f  hemas.PipelinesO
-0000f4a0: 7574 7075 743a 0a20 2020 2020 2020 2022  utput:.        "
-0000f4b0: 2222 5265 7472 6965 7665 2061 206c 6973  ""Retrieve a lis
-0000f4c0: 7420 6f66 204b 4650 2070 6970 656c 696e  t of KFP pipelin
-0000f4d0: 6573 2e20 5468 6973 2066 756e 6374 696f  es. This functio
-0000f4e0: 6e20 6361 6e20 6265 2069 6e76 6f6b 6564  n can be invoked
-0000f4f0: 2074 6f20 6765 7420 616c 6c20 7069 7065   to get all pipe
-0000f500: 6c69 6e65 7320 6672 6f6d 2061 6c6c 2070  lines from all p
-0000f510: 726f 6a65 6374 732c 0a20 2020 2020 2020  rojects,.       
-0000f520: 2062 7920 7370 6563 6966 7969 6e67 2060   by specifying `
-0000f530: 6070 726f 6a65 6374 3d2a 6060 2c20 696e  `project=*``, in
-0000f540: 2077 6869 6368 2063 6173 6520 7061 6769   which case pagi
-0000f550: 6e61 7469 6f6e 2063 616e 2062 6520 7573  nation can be us
-0000f560: 6564 2061 6e64 2074 6865 2076 6172 696f  ed and the vario
-0000f570: 7573 2073 6f72 7469 6e67 2061 6e64 2070  us sorting and p
-0000f580: 6167 696e 6174 696f 6e0a 2020 2020 2020  agination.      
-0000f590: 2020 7072 6f70 6572 7469 6573 2063 616e    properties can
-0000f5a0: 2062 6520 6170 706c 6965 642e 2049 6620   be applied. If 
-0000f5b0: 6120 7370 6563 6966 6963 2070 726f 6a65  a specific proje
-0000f5c0: 6374 2069 7320 7265 7175 6573 7465 642c  ct is requested,
-0000f5d0: 2074 6865 6e20 7468 6520 7061 6769 6e61   then the pagina
-0000f5e0: 7469 6f6e 206f 7074 696f 6e73 2063 616e  tion options can
-0000f5f0: 6e6f 7420 6265 0a20 2020 2020 2020 2075  not be.        u
-0000f600: 7365 6420 616e 6420 7061 6769 6e61 7469  sed and paginati
-0000f610: 6f6e 2069 7320 6e6f 7420 6170 706c 6965  on is not applie
-0000f620: 642e 0a0a 2020 2020 2020 2020 3a70 6172  d...        :par
-0000f630: 616d 2070 726f 6a65 6374 3a20 5072 6f6a  am project: Proj
-0000f640: 6563 7420 6e61 6d65 2e20 4361 6e20 6265  ect name. Can be
-0000f650: 2060 602a 6060 2066 6f72 2071 7565 7279   ``*`` for query
-0000f660: 2061 6372 6f73 7320 616c 6c20 7072 6f6a   across all proj
-0000f670: 6563 7473 2e0a 2020 2020 2020 2020 3a70  ects..        :p
-0000f680: 6172 616d 206e 616d 6573 7061 6365 3a20  aram namespace: 
-0000f690: 4b75 6265 726e 6574 6573 206e 616d 6573  Kubernetes names
-0000f6a0: 7061 6365 2069 6e20 7768 6963 6820 7468  pace in which th
-0000f6b0: 6520 7069 7065 6c69 6e65 7320 6172 6520  e pipelines are 
-0000f6c0: 6578 6563 7574 696e 672e 0a20 2020 2020  executing..     
-0000f6d0: 2020 203a 7061 7261 6d20 736f 7274 5f62     :param sort_b
-0000f6e0: 793a 2046 6965 6c64 2074 6f20 736f 7274  y: Field to sort
-0000f6f0: 2074 6865 2072 6573 756c 7473 2062 792e   the results by.
-0000f700: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-0000f710: 7061 6765 5f74 6f6b 656e 3a20 5573 6520  page_token: Use 
-0000f720: 666f 7220 7061 6769 6e61 7469 6f6e 2c20  for pagination, 
-0000f730: 746f 2072 6574 7269 6576 6520 6e65 7874  to retrieve next
-0000f740: 2070 6167 652e 0a20 2020 2020 2020 203a   page..        :
-0000f750: 7061 7261 6d20 6669 6c74 6572 5f3a 204b  param filter_: K
-0000f760: 7562 6572 6e65 7465 7320 6669 6c74 6572  ubernetes filter
-0000f770: 2074 6f20 6170 706c 7920 746f 2074 6865   to apply to the
-0000f780: 2071 7565 7279 2c20 6361 6e20 6265 2075   query, can be u
-0000f790: 7365 6420 746f 2066 696c 7465 7220 6f6e  sed to filter on
-0000f7a0: 2073 7065 6369 6669 6320 6f62 6a65 6374   specific object
-0000f7b0: 2066 6965 6c64 732e 0a20 2020 2020 2020   fields..       
-0000f7c0: 203a 7061 7261 6d20 666f 726d 6174 5f3a   :param format_:
-0000f7d0: 2052 6573 756c 7420 666f 726d 6174 2e20   Result format. 
-0000f7e0: 4361 6e20 6265 206f 6e65 206f 663a 0a0a  Can be one of:..
-0000f7f0: 2020 2020 2020 2020 2020 2020 2d20 6060              - ``
-0000f800: 6675 6c6c 6060 202d 2072 6574 7572 6e20  full`` - return 
-0000f810: 7468 6520 6675 6c6c 206f 626a 6563 7473  the full objects
-0000f820: 2e0a 2020 2020 2020 2020 2020 2020 2d20  ..            - 
-0000f830: 6060 6d65 7461 6461 7461 5f6f 6e6c 7960  ``metadata_only`
-0000f840: 6020 2864 6566 6175 6c74 2920 2d20 7265  ` (default) - re
-0000f850: 7475 726e 206a 7573 7420 6d65 7461 6461  turn just metada
-0000f860: 7461 206f 6620 7468 6520 7069 7065 6c69  ta of the pipeli
-0000f870: 6e65 7320 6f62 6a65 6374 732e 0a20 2020  nes objects..   
-0000f880: 2020 2020 2020 2020 202d 2060 606e 616d           - ``nam
-0000f890: 655f 6f6e 6c79 6060 202d 2072 6574 7572  e_only`` - retur
-0000f8a0: 6e20 6a75 7374 2074 6865 206e 616d 6573  n just the names
-0000f8b0: 206f 6620 7468 6520 7069 7065 6c69 6e65   of the pipeline
-0000f8c0: 206f 626a 6563 7473 2e0a 2020 2020 2020   objects..      
-0000f8d0: 2020 3a70 6172 616d 2070 6167 655f 7369    :param page_si
-0000f8e0: 7a65 3a20 5369 7a65 206f 6620 6120 7369  ze: Size of a si
-0000f8f0: 6e67 6c65 2070 6167 6520 7768 656e 2061  ngle page when a
-0000f900: 7070 6c79 696e 6720 7061 6769 6e61 7469  pplying paginati
-0000f910: 6f6e 2e0a 2020 2020 2020 2020 2222 220a  on..        """.
-0000f920: 0a20 2020 2020 2020 2069 6620 7072 6f6a  .        if proj
-0000f930: 6563 7420 213d 2022 2a22 2061 6e64 2028  ect != "*" and (
-0000f940: 7061 6765 5f74 6f6b 656e 206f 7220 7061  page_token or pa
-0000f950: 6765 5f73 697a 6529 3a0a 2020 2020 2020  ge_size):.      
-0000f960: 2020 2020 2020 7261 6973 6520 6d6c 7275        raise mlru
-0000f970: 6e2e 6572 726f 7273 2e4d 4c52 756e 496e  n.errors.MLRunIn
-0000f980: 7661 6c69 6441 7267 756d 656e 7445 7272  validArgumentErr
-0000f990: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
-0000f9a0: 2020 2020 2246 696c 7465 7269 6e67 2062      "Filtering b
-0000f9b0: 7920 7072 6f6a 6563 7420 6361 6e20 6e6f  y project can no
-0000f9c0: 7420 6265 2075 7365 6420 746f 6765 7468  t be used togeth
-0000f9d0: 6572 2077 6974 6820 7061 6769 6e61 7469  er with paginati
-0000f9e0: 6f6e 220a 2020 2020 2020 2020 2020 2020  on".            
-0000f9f0: 290a 2020 2020 2020 2020 7061 7261 6d73  ).        params
-0000fa00: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
-0000fa10: 2022 6e61 6d65 7370 6163 6522 3a20 6e61   "namespace": na
-0000fa20: 6d65 7370 6163 652c 0a20 2020 2020 2020  mespace,.       
-0000fa30: 2020 2020 2022 736f 7274 5f62 7922 3a20       "sort_by": 
-0000fa40: 736f 7274 5f62 792c 0a20 2020 2020 2020  sort_by,.       
-0000fa50: 2020 2020 2022 7061 6765 5f74 6f6b 656e       "page_token
-0000fa60: 223a 2070 6167 655f 746f 6b65 6e2c 0a20  ": page_token,. 
-0000fa70: 2020 2020 2020 2020 2020 2022 6669 6c74             "filt
-0000fa80: 6572 223a 2066 696c 7465 725f 2c0a 2020  er": filter_,.  
-0000fa90: 2020 2020 2020 2020 2020 2266 6f72 6d61            "forma
-0000faa0: 7422 3a20 666f 726d 6174 5f2c 0a20 2020  t": format_,.   
-0000fab0: 2020 2020 2020 2020 2022 7061 6765 5f73           "page_s
-0000fac0: 697a 6522 3a20 7061 6765 5f73 697a 652c  ize": page_size,
-0000fad0: 0a20 2020 2020 2020 207d 0a0a 2020 2020  .        }..    
-0000fae0: 2020 2020 6572 726f 725f 6d65 7373 6167      error_messag
-0000faf0: 6520 3d20 6622 4661 696c 6564 206c 6973  e = f"Failed lis
-0000fb00: 7469 6e67 2070 6970 656c 696e 6573 2c20  ting pipelines, 
-0000fb10: 7175 6572 793a 207b 7061 7261 6d73 7d22  query: {params}"
-0000fb20: 0a20 2020 2020 2020 2072 6573 706f 6e73  .        respons
-0000fb30: 6520 3d20 7365 6c66 2e61 7069 5f63 616c  e = self.api_cal
-0000fb40: 6c28 0a20 2020 2020 2020 2020 2020 2022  l(.            "
-0000fb50: 4745 5422 2c20 6622 7072 6f6a 6563 7473  GET", f"projects
-0000fb60: 2f7b 7072 6f6a 6563 747d 2f70 6970 656c  /{project}/pipel
-0000fb70: 696e 6573 222c 2065 7272 6f72 5f6d 6573  ines", error_mes
-0000fb80: 7361 6765 2c20 7061 7261 6d73 3d70 6172  sage, params=par
-0000fb90: 616d 730a 2020 2020 2020 2020 290a 2020  ams.        ).  
-0000fba0: 2020 2020 2020 7265 7475 726e 206d 6c72        return mlr
-0000fbb0: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
-0000fbc0: 732e 5069 7065 6c69 6e65 734f 7574 7075  s.PipelinesOutpu
-0000fbd0: 7428 2a2a 7265 7370 6f6e 7365 2e6a 736f  t(**response.jso
-0000fbe0: 6e28 2929 0a0a 2020 2020 6465 6620 6765  n())..    def ge
-0000fbf0: 745f 7069 7065 6c69 6e65 280a 2020 2020  t_pipeline(.    
-0000fc00: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-0000fc10: 2020 7275 6e5f 6964 3a20 7374 722c 0a20    run_id: str,. 
-0000fc20: 2020 2020 2020 206e 616d 6573 7061 6365         namespace
-0000fc30: 3a20 7374 7220 3d20 4e6f 6e65 2c0a 2020  : str = None,.  
-0000fc40: 2020 2020 2020 7469 6d65 6f75 743a 2069        timeout: i
-0000fc50: 6e74 203d 2031 302c 0a20 2020 2020 2020  nt = 10,.       
-0000fc60: 2066 6f72 6d61 745f 3a20 556e 696f 6e5b   format_: Union[
-0000fc70: 0a20 2020 2020 2020 2020 2020 2073 7472  .            str
-0000fc80: 2c20 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  , mlrun.common.s
-0000fc90: 6368 656d 6173 2e50 6970 656c 696e 6573  chemas.Pipelines
-0000fca0: 466f 726d 6174 0a20 2020 2020 2020 205d  Format.        ]
-0000fcb0: 203d 206d 6c72 756e 2e63 6f6d 6d6f 6e2e   = mlrun.common.
-0000fcc0: 7363 6865 6d61 732e 5069 7065 6c69 6e65  schemas.Pipeline
-0000fcd0: 7346 6f72 6d61 742e 7375 6d6d 6172 792c  sFormat.summary,
-0000fce0: 0a20 2020 2020 2020 2070 726f 6a65 6374  .        project
-0000fcf0: 3a20 7374 7220 3d20 4e6f 6e65 2c0a 2020  : str = None,.  
-0000fd00: 2020 293a 0a20 2020 2020 2020 2022 2222    ):.        """
-0000fd10: 5265 7472 6965 7665 2064 6574 6169 6c73  Retrieve details
-0000fd20: 206f 6620 6120 7370 6563 6966 6963 2070   of a specific p
-0000fd30: 6970 656c 696e 6520 7573 696e 6720 6974  ipeline using it
-0000fd40: 7320 7275 6e20 4944 2028 6173 2070 726f  s run ID (as pro
-0000fd50: 7669 6465 6420 7768 656e 2074 6865 2070  vided when the p
-0000fd60: 6970 656c 696e 6520 7761 7320 6578 6563  ipeline was exec
-0000fd70: 7574 6564 292e 2222 220a 0a20 2020 2020  uted)."""..     
-0000fd80: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
-0000fd90: 2020 2020 7061 7261 6d73 203d 207b 7d0a      params = {}.
-0000fda0: 2020 2020 2020 2020 2020 2020 6966 206e              if n
-0000fdb0: 616d 6573 7061 6365 3a0a 2020 2020 2020  amespace:.      
-0000fdc0: 2020 2020 2020 2020 2020 7061 7261 6d73            params
-0000fdd0: 5b22 6e61 6d65 7370 6163 6522 5d20 3d20  ["namespace"] = 
-0000fde0: 6e61 6d65 7370 6163 650a 2020 2020 2020  namespace.      
-0000fdf0: 2020 2020 2020 7061 7261 6d73 5b22 666f        params["fo
-0000fe00: 726d 6174 225d 203d 2066 6f72 6d61 745f  rmat"] = format_
-0000fe10: 0a20 2020 2020 2020 2020 2020 2070 726f  .            pro
-0000fe20: 6a65 6374 5f70 6174 6820 3d20 7072 6f6a  ject_path = proj
-0000fe30: 6563 7420 6966 2070 726f 6a65 6374 2065  ect if project e
-0000fe40: 6c73 6520 222a 220a 2020 2020 2020 2020  lse "*".        
-0000fe50: 2020 2020 7265 7370 203d 2073 656c 662e      resp = self.
-0000fe60: 6170 695f 6361 6c6c 280a 2020 2020 2020  api_call(.      
-0000fe70: 2020 2020 2020 2020 2020 2247 4554 222c            "GET",
-0000fe80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000fe90: 2066 2270 726f 6a65 6374 732f 7b70 726f   f"projects/{pro
-0000fea0: 6a65 6374 5f70 6174 687d 2f70 6970 656c  ject_path}/pipel
-0000feb0: 696e 6573 2f7b 7275 6e5f 6964 7d22 2c0a  ines/{run_id}",.
-0000fec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fed0: 7061 7261 6d73 3d70 6172 616d 732c 0a20  params=params,. 
-0000fee0: 2020 2020 2020 2020 2020 2020 2020 2074                 t
-0000fef0: 696d 656f 7574 3d74 696d 656f 7574 2c0a  imeout=timeout,.
-0000ff00: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-0000ff10: 2020 2020 2020 6578 6365 7074 204f 5345        except OSE
-0000ff20: 7272 6f72 2061 7320 6572 723a 0a20 2020  rror as err:.   
-0000ff30: 2020 2020 2020 2020 206c 6f67 6765 722e           logger.
-0000ff40: 6572 726f 7228 6622 6572 726f 7220 6361  error(f"error ca
-0000ff50: 6e6e 6f74 2067 6574 2070 6970 656c 696e  nnot get pipelin
-0000ff60: 653a 207b 6572 725f 746f 5f73 7472 2865  e: {err_to_str(e
-0000ff70: 7272 297d 2229 0a20 2020 2020 2020 2020  rr)}").         
-0000ff80: 2020 2072 6169 7365 204f 5345 7272 6f72     raise OSError
-0000ff90: 2866 2265 7272 6f72 3a20 6361 6e6e 6f74  (f"error: cannot
-0000ffa0: 2067 6574 2070 6970 656c 696e 652c 207b   get pipeline, {
-0000ffb0: 6572 725f 746f 5f73 7472 2865 7272 297d  err_to_str(err)}
-0000ffc0: 2229 0a0a 2020 2020 2020 2020 6966 206e  ")..        if n
-0000ffd0: 6f74 2072 6573 702e 6f6b 3a0a 2020 2020  ot resp.ok:.    
-0000ffe0: 2020 2020 2020 2020 6c6f 6767 6572 2e65          logger.e
-0000fff0: 7272 6f72 2866 2262 6164 2072 6573 7021  rror(f"bad resp!
-00010000: 215c 6e7b 7265 7370 2e74 6578 747d 2229  !\n{resp.text}")
-00010010: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-00010020: 7365 2056 616c 7565 4572 726f 7228 6622  se ValueError(f"
-00010030: 6261 6420 6765 7420 7069 7065 6c69 6e65  bad get pipeline
-00010040: 2072 6573 706f 6e73 652c 207b 7265 7370   response, {resp
-00010050: 2e74 6578 747d 2229 0a0a 2020 2020 2020  .text}")..      
-00010060: 2020 7265 7475 726e 2072 6573 702e 6a73    return resp.js
-00010070: 6f6e 2829 0a0a 2020 2020 4073 7461 7469  on()..    @stati
-00010080: 636d 6574 686f 640a 2020 2020 6465 6620  cmethod.    def 
-00010090: 5f72 6573 6f6c 7665 5f72 6566 6572 656e  _resolve_referen
-000100a0: 6365 2874 6167 2c20 7569 6429 3a0a 2020  ce(tag, uid):.  
-000100b0: 2020 2020 2020 6966 2075 6964 2061 6e64        if uid and
-000100c0: 2074 6167 3a0a 2020 2020 2020 2020 2020   tag:.          
-000100d0: 2020 7261 6973 6520 4d4c 5275 6e49 6e76    raise MLRunInv
-000100e0: 616c 6964 4172 6775 6d65 6e74 4572 726f  alidArgumentErro
-000100f0: 7228 2262 6f74 6820 7569 6420 616e 6420  r("both uid and 
-00010100: 7461 6720 7765 7265 2070 726f 7669 6465  tag were provide
-00010110: 6422 290a 2020 2020 2020 2020 7265 7475  d").        retu
-00010120: 726e 2075 6964 206f 7220 7461 6720 6f72  rn uid or tag or
-00010130: 2022 6c61 7465 7374 220a 0a20 2020 2064   "latest"..    d
-00010140: 6566 2063 7265 6174 655f 6665 6174 7572  ef create_featur
-00010150: 655f 7365 7428 0a20 2020 2020 2020 2073  e_set(.        s
-00010160: 656c 662c 0a20 2020 2020 2020 2066 6561  elf,.        fea
-00010170: 7475 7265 5f73 6574 3a20 556e 696f 6e5b  ture_set: Union[
-00010180: 6469 6374 2c20 6d6c 7275 6e2e 636f 6d6d  dict, mlrun.comm
-00010190: 6f6e 2e73 6368 656d 6173 2e46 6561 7475  on.schemas.Featu
-000101a0: 7265 5365 742c 2046 6561 7475 7265 5365  reSet, FeatureSe
-000101b0: 745d 2c0a 2020 2020 2020 2020 7072 6f6a  t],.        proj
-000101c0: 6563 743d 2222 2c0a 2020 2020 2020 2020  ect="",.        
-000101d0: 7665 7273 696f 6e65 643d 5472 7565 2c0a  versioned=True,.
-000101e0: 2020 2020 2920 2d3e 2064 6963 743a 0a20      ) -> dict:. 
-000101f0: 2020 2020 2020 2022 2222 4372 6561 7465         """Create
-00010200: 2061 206e 6577 203a 7079 3a63 6c61 7373   a new :py:class
-00010210: 3a60 7e6d 6c72 756e 2e66 6561 7475 7265  :`~mlrun.feature
-00010220: 5f73 746f 7265 2e46 6561 7475 7265 5365  _store.FeatureSe
-00010230: 7460 2061 6e64 2073 6176 6520 696e 2074  t` and save in t
-00010240: 6865 203a 7079 3a6d 6f64 3a60 6d6c 7275  he :py:mod:`mlru
-00010250: 6e60 2044 422e 2054 6865 0a20 2020 2020  n` DB. The.     
-00010260: 2020 2066 6561 7475 7265 2d73 6574 206d     feature-set m
-00010270: 7573 7420 6e6f 7420 7072 6576 696f 7573  ust not previous
-00010280: 6c79 2065 7869 7374 2069 6e20 7468 6520  ly exist in the 
-00010290: 4442 2e0a 0a20 2020 2020 2020 203a 7061  DB...        :pa
-000102a0: 7261 6d20 6665 6174 7572 655f 7365 743a  ram feature_set:
-000102b0: 2054 6865 206e 6577 203a 7079 3a63 6c61   The new :py:cla
-000102c0: 7373 3a60 7e6d 6c72 756e 2e66 6561 7475  ss:`~mlrun.featu
-000102d0: 7265 5f73 746f 7265 2e46 6561 7475 7265  re_store.Feature
-000102e0: 5365 7460 2074 6f20 6372 6561 7465 2e0a  Set` to create..
-000102f0: 2020 2020 2020 2020 3a70 6172 616d 2070          :param p
-00010300: 726f 6a65 6374 3a20 4e61 6d65 206f 6620  roject: Name of 
-00010310: 7072 6f6a 6563 7420 7468 6973 2066 6561  project this fea
-00010320: 7475 7265 2d73 6574 2062 656c 6f6e 6773  ture-set belongs
-00010330: 2074 6f2e 0a20 2020 2020 2020 203a 7061   to..        :pa
-00010340: 7261 6d20 7665 7273 696f 6e65 643a 2057  ram versioned: W
-00010350: 6865 7468 6572 2074 6f20 6d61 696e 7461  hether to mainta
-00010360: 696e 2076 6572 7369 6f6e 7320 666f 7220  in versions for 
-00010370: 7468 6973 2066 6561 7475 7265 2d73 6574  this feature-set
-00010380: 2e20 416c 6c20 7665 7273 696f 6e73 206f  . All versions o
-00010390: 6620 6120 7665 7273 696f 6e65 6420 6f62  f a versioned ob
-000103a0: 6a65 6374 0a20 2020 2020 2020 2020 2020  ject.           
-000103b0: 2077 696c 6c20 6265 206b 6570 7420 696e   will be kept in
-000103c0: 2074 6865 2044 4220 616e 6420 6361 6e20   the DB and can 
-000103d0: 6265 2072 6574 7269 6576 6564 2075 6e74  be retrieved unt
-000103e0: 696c 2065 7870 6c69 6369 746c 7920 6465  il explicitly de
-000103f0: 6c65 7465 642e 0a20 2020 2020 2020 203a  leted..        :
-00010400: 7265 7475 726e 733a 2054 6865 203a 7079  returns: The :py
-00010410: 3a63 6c61 7373 3a60 7e6d 6c72 756e 2e66  :class:`~mlrun.f
-00010420: 6561 7475 7265 5f73 746f 7265 2e46 6561  eature_store.Fea
-00010430: 7475 7265 5365 7460 206f 626a 6563 7420  tureSet` object 
-00010440: 2861 7320 6469 6374 292e 0a20 2020 2020  (as dict)..     
-00010450: 2020 2022 2222 0a20 2020 2020 2020 2069     """.        i
-00010460: 6620 6973 696e 7374 616e 6365 2866 6561  f isinstance(fea
-00010470: 7475 7265 5f73 6574 2c20 6d6c 7275 6e2e  ture_set, mlrun.
-00010480: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e46  common.schemas.F
-00010490: 6561 7475 7265 5365 7429 3a0a 2020 2020  eatureSet):.    
-000104a0: 2020 2020 2020 2020 6665 6174 7572 655f          feature_
-000104b0: 7365 7420 3d20 6665 6174 7572 655f 7365  set = feature_se
-000104c0: 742e 6469 6374 2829 0a20 2020 2020 2020  t.dict().       
-000104d0: 2065 6c69 6620 6973 696e 7374 616e 6365   elif isinstance
-000104e0: 2866 6561 7475 7265 5f73 6574 2c20 4665  (feature_set, Fe
-000104f0: 6174 7572 6553 6574 293a 0a20 2020 2020  atureSet):.     
-00010500: 2020 2020 2020 2066 6561 7475 7265 5f73         feature_s
-00010510: 6574 203d 2066 6561 7475 7265 5f73 6574  et = feature_set
-00010520: 2e74 6f5f 6469 6374 2829 0a0a 2020 2020  .to_dict()..    
-00010530: 2020 2020 7072 6f6a 6563 7420 3d20 280a      project = (.
-00010540: 2020 2020 2020 2020 2020 2020 7072 6f6a              proj
-00010550: 6563 740a 2020 2020 2020 2020 2020 2020  ect.            
-00010560: 6f72 2066 6561 7475 7265 5f73 6574 5b22  or feature_set["
-00010570: 6d65 7461 6461 7461 225d 2e67 6574 2822  metadata"].get("
-00010580: 7072 6f6a 6563 7422 2c20 4e6f 6e65 290a  project", None).
-00010590: 2020 2020 2020 2020 2020 2020 6f72 2063              or c
-000105a0: 6f6e 6669 672e 6465 6661 756c 745f 7072  onfig.default_pr
-000105b0: 6f6a 6563 740a 2020 2020 2020 2020 290a  oject.        ).
-000105c0: 2020 2020 2020 2020 7061 7468 203d 2066          path = f
-000105d0: 2270 726f 6a65 6374 732f 7b70 726f 6a65  "projects/{proje
-000105e0: 6374 7d2f 6665 6174 7572 652d 7365 7473  ct}/feature-sets
-000105f0: 220a 2020 2020 2020 2020 7061 7261 6d73  ".        params
-00010600: 203d 207b 2276 6572 7369 6f6e 6564 223a   = {"versioned":
-00010610: 2076 6572 7369 6f6e 6564 7d0a 0a20 2020   versioned}..   
-00010620: 2020 2020 206e 616d 6520 3d20 6665 6174       name = feat
-00010630: 7572 655f 7365 745b 226d 6574 6164 6174  ure_set["metadat
-00010640: 6122 5d5b 226e 616d 6522 5d0a 2020 2020  a"]["name"].    
-00010650: 2020 2020 6572 726f 725f 6d65 7373 6167      error_messag
-00010660: 6520 3d20 6622 4661 696c 6564 2063 7265  e = f"Failed cre
-00010670: 6174 696e 6720 6665 6174 7572 652d 7365  ating feature-se
-00010680: 7420 7b70 726f 6a65 6374 7d2f 7b6e 616d  t {project}/{nam
-00010690: 657d 220a 2020 2020 2020 2020 7265 7370  e}".        resp
-000106a0: 203d 2073 656c 662e 6170 695f 6361 6c6c   = self.api_call
-000106b0: 280a 2020 2020 2020 2020 2020 2020 2250  (.            "P
-000106c0: 4f53 5422 2c0a 2020 2020 2020 2020 2020  OST",.          
-000106d0: 2020 7061 7468 2c0a 2020 2020 2020 2020    path,.        
-000106e0: 2020 2020 6572 726f 725f 6d65 7373 6167      error_messag
-000106f0: 652c 0a20 2020 2020 2020 2020 2020 2070  e,.            p
-00010700: 6172 616d 733d 7061 7261 6d73 2c0a 2020  arams=params,.  
-00010710: 2020 2020 2020 2020 2020 626f 6479 3d64            body=d
-00010720: 6963 745f 746f 5f6a 736f 6e28 6665 6174  ict_to_json(feat
-00010730: 7572 655f 7365 7429 2c0a 2020 2020 2020  ure_set),.      
-00010740: 2020 290a 2020 2020 2020 2020 7265 7475    ).        retu
-00010750: 726e 2072 6573 702e 6a73 6f6e 2829 0a0a  rn resp.json()..
-00010760: 2020 2020 6465 6620 6765 745f 6665 6174      def get_feat
-00010770: 7572 655f 7365 7428 0a20 2020 2020 2020  ure_set(.       
-00010780: 2073 656c 662c 206e 616d 653a 2073 7472   self, name: str
-00010790: 2c20 7072 6f6a 6563 743a 2073 7472 203d  , project: str =
-000107a0: 2022 222c 2074 6167 3a20 7374 7220 3d20   "", tag: str = 
-000107b0: 4e6f 6e65 2c20 7569 643a 2073 7472 203d  None, uid: str =
-000107c0: 204e 6f6e 650a 2020 2020 2920 2d3e 2046   None.    ) -> F
-000107d0: 6561 7475 7265 5365 743a 0a20 2020 2020  eatureSet:.     
-000107e0: 2020 2022 2222 5265 7472 6965 7665 2061     """Retrieve a
-000107f0: 207e 6d6c 7275 6e2e 6665 6174 7572 655f   ~mlrun.feature_
-00010800: 7374 6f72 652e 4665 6174 7572 6553 6574  store.FeatureSet
-00010810: 6020 6f62 6a65 6374 2e20 4966 2062 6f74  ` object. If bot
-00010820: 6820 6060 7461 6760 6020 616e 6420 6060  h ``tag`` and ``
-00010830: 7569 6460 6020 6172 6520 6e6f 7420 7370  uid`` are not sp
-00010840: 6563 6966 6965 642c 2074 6865 6e0a 2020  ecified, then.  
-00010850: 2020 2020 2020 7468 6520 6f62 6a65 6374        the object
-00010860: 2074 6167 6765 6420 6060 6c61 7465 7374   tagged ``latest
-00010870: 6060 2077 696c 6c20 6265 2072 6574 7269  `` will be retri
-00010880: 6576 6564 2e0a 0a20 2020 2020 2020 203a  eved...        :
-00010890: 7061 7261 6d20 6e61 6d65 3a20 4e61 6d65  param name: Name
-000108a0: 206f 6620 6f62 6a65 6374 2074 6f20 7265   of object to re
-000108b0: 7472 6965 7665 2e0a 2020 2020 2020 2020  trieve..        
-000108c0: 3a70 6172 616d 2070 726f 6a65 6374 3a20  :param project: 
-000108d0: 5072 6f6a 6563 7420 7468 6520 4665 6174  Project the Feat
-000108e0: 7572 6553 6574 2062 656c 6f6e 6773 2074  ureSet belongs t
-000108f0: 6f2e 0a20 2020 2020 2020 203a 7061 7261  o..        :para
-00010900: 6d20 7461 673a 2054 6167 206f 6620 7468  m tag: Tag of th
-00010910: 6520 7370 6563 6966 6963 206f 626a 6563  e specific objec
-00010920: 7420 7665 7273 696f 6e20 746f 2072 6574  t version to ret
-00010930: 7269 6576 652e 0a20 2020 2020 2020 203a  rieve..        :
-00010940: 7061 7261 6d20 7569 643a 2075 6964 206f  param uid: uid o
-00010950: 6620 7468 6520 6f62 6a65 6374 2074 6f20  f the object to 
-00010960: 7265 7472 6965 7665 2028 6361 6e20 6f6e  retrieve (can on
-00010970: 6c79 2062 6520 7573 6564 2066 6f72 2076  ly be used for v
-00010980: 6572 7369 6f6e 6564 206f 626a 6563 7473  ersioned objects
-00010990: 292e 0a20 2020 2020 2020 2022 2222 0a0a  )..        """..
-000109a0: 2020 2020 2020 2020 7072 6f6a 6563 7420          project 
-000109b0: 3d20 7072 6f6a 6563 7420 6f72 2063 6f6e  = project or con
-000109c0: 6669 672e 6465 6661 756c 745f 7072 6f6a  fig.default_proj
-000109d0: 6563 740a 2020 2020 2020 2020 7265 6665  ect.        refe
-000109e0: 7265 6e63 6520 3d20 7365 6c66 2e5f 7265  rence = self._re
-000109f0: 736f 6c76 655f 7265 6665 7265 6e63 6528  solve_reference(
-00010a00: 7461 672c 2075 6964 290a 2020 2020 2020  tag, uid).      
-00010a10: 2020 7061 7468 203d 2066 2270 726f 6a65    path = f"proje
-00010a20: 6374 732f 7b70 726f 6a65 6374 7d2f 6665  cts/{project}/fe
-00010a30: 6174 7572 652d 7365 7473 2f7b 6e61 6d65  ature-sets/{name
-00010a40: 7d2f 7265 6665 7265 6e63 6573 2f7b 7265  }/references/{re
-00010a50: 6665 7265 6e63 657d 220a 2020 2020 2020  ference}".      
-00010a60: 2020 6572 726f 725f 6d65 7373 6167 6520    error_message 
-00010a70: 3d20 6622 4661 696c 6564 2072 6574 7269  = f"Failed retri
-00010a80: 6576 696e 6720 6665 6174 7572 652d 7365  eving feature-se
-00010a90: 7420 7b70 726f 6a65 6374 7d2f 7b6e 616d  t {project}/{nam
-00010aa0: 657d 220a 2020 2020 2020 2020 7265 7370  e}".        resp
-00010ab0: 203d 2073 656c 662e 6170 695f 6361 6c6c   = self.api_call
-00010ac0: 2822 4745 5422 2c20 7061 7468 2c20 6572  ("GET", path, er
-00010ad0: 726f 725f 6d65 7373 6167 6529 0a20 2020  ror_message).   
-00010ae0: 2020 2020 2072 6574 7572 6e20 4665 6174       return Feat
-00010af0: 7572 6553 6574 2e66 726f 6d5f 6469 6374  ureSet.from_dict
-00010b00: 2872 6573 702e 6a73 6f6e 2829 290a 0a20  (resp.json()).. 
-00010b10: 2020 2064 6566 206c 6973 745f 6665 6174     def list_feat
-00010b20: 7572 6573 280a 2020 2020 2020 2020 7365  ures(.        se
-00010b30: 6c66 2c0a 2020 2020 2020 2020 7072 6f6a  lf,.        proj
-00010b40: 6563 743a 2073 7472 2c0a 2020 2020 2020  ect: str,.      
-00010b50: 2020 6e61 6d65 3a20 7374 7220 3d20 4e6f    name: str = No
-00010b60: 6e65 2c0a 2020 2020 2020 2020 7461 673a  ne,.        tag:
-00010b70: 2073 7472 203d 204e 6f6e 652c 0a20 2020   str = None,.   
-00010b80: 2020 2020 2065 6e74 6974 6965 733a 204c       entities: L
-00010b90: 6973 745b 7374 725d 203d 204e 6f6e 652c  ist[str] = None,
-00010ba0: 0a20 2020 2020 2020 206c 6162 656c 733a  .        labels:
-00010bb0: 204c 6973 745b 7374 725d 203d 204e 6f6e   List[str] = Non
-00010bc0: 652c 0a20 2020 2029 202d 3e20 4c69 7374  e,.    ) -> List
-00010bd0: 5b64 6963 745d 3a0a 2020 2020 2020 2020  [dict]:.        
-00010be0: 2222 224c 6973 7420 6665 6174 7572 652d  """List feature-
-00010bf0: 7365 7473 2077 6869 6368 2063 6f6e 7461  sets which conta
-00010c00: 696e 2073 7065 6369 6669 6320 6665 6174  in specific feat
-00010c10: 7572 6573 2e20 5468 6973 2066 756e 6374  ures. This funct
-00010c20: 696f 6e20 6d61 7920 7265 7475 726e 206d  ion may return m
-00010c30: 756c 7469 706c 6520 7665 7273 696f 6e73  ultiple versions
-00010c40: 206f 6620 7468 6520 7361 6d65 0a20 2020   of the same.   
-00010c50: 2020 2020 2066 6561 7475 7265 2d73 6574       feature-set
-00010c60: 2069 6620 6120 7370 6563 6966 6963 2074   if a specific t
-00010c70: 6167 2069 7320 6e6f 7420 7265 7175 6573  ag is not reques
-00010c80: 7465 642e 204e 6f74 6520 7468 6174 2074  ted. Note that t
-00010c90: 6865 2076 6172 696f 7573 2066 696c 7465  he various filte
-00010ca0: 7273 206f 6620 7468 6973 2066 756e 6374  rs of this funct
-00010cb0: 696f 6e20 6163 7475 616c 6c79 0a20 2020  ion actually.   
-00010cc0: 2020 2020 2072 6566 6572 2074 6f20 7468       refer to th
-00010cd0: 6520 6665 6174 7572 652d 7365 7420 6f62  e feature-set ob
-00010ce0: 6a65 6374 2063 6f6e 7461 696e 696e 6720  ject containing 
-00010cf0: 7468 6520 6665 6174 7572 6573 2c20 6e6f  the features, no
-00010d00: 7420 746f 2074 6865 2066 6561 7475 7265  t to the feature
-00010d10: 7320 7468 656d 7365 6c76 6573 2e0a 0a20  s themselves... 
-00010d20: 2020 2020 2020 203a 7061 7261 6d20 7072         :param pr
-00010d30: 6f6a 6563 743a 2050 726f 6a65 6374 2077  oject: Project w
-00010d40: 6869 6368 2063 6f6e 7461 696e 7320 7468  hich contains th
-00010d50: 6573 6520 6665 6174 7572 6573 2e0a 2020  ese features..  
-00010d60: 2020 2020 2020 3a70 6172 616d 206e 616d        :param nam
-00010d70: 653a 204e 616d 6520 6f66 2074 6865 2066  e: Name of the f
-00010d80: 6561 7475 7265 2074 6f20 6c6f 6f6b 2066  eature to look f
-00010d90: 6f72 2e20 5468 6520 6e61 6d65 2069 7320  or. The name is 
-00010da0: 7573 6564 2069 6e20 6120 6c69 6b65 2071  used in a like q
-00010db0: 7565 7279 2c20 616e 6420 6973 206e 6f74  uery, and is not
-00010dc0: 2063 6173 652d 7365 6e73 6974 6976 652e   case-sensitive.
-00010dd0: 2046 6f72 0a20 2020 2020 2020 2020 2020   For.           
-00010de0: 2065 7861 6d70 6c65 2c20 6c6f 6f6b 696e   example, lookin
-00010df0: 6720 666f 7220 6060 6665 6174 6060 2077  g for ``feat`` w
-00010e00: 696c 6c20 7265 7475 726e 2066 6561 7475  ill return featu
-00010e10: 7265 7320 7768 6963 6820 6172 6520 6e61  res which are na
-00010e20: 6d65 6420 6060 4d79 4665 6174 7572 6560  med ``MyFeature`
-00010e30: 6020 6173 2077 656c 6c20 6173 2060 6064  ` as well as ``d
-00010e40: 6566 6561 7460 602e 0a20 2020 2020 2020  efeat``..       
-00010e50: 203a 7061 7261 6d20 7461 673a 2052 6574   :param tag: Ret
-00010e60: 7572 6e20 6665 6174 7572 652d 7365 7473  urn feature-sets
-00010e70: 2077 6869 6368 2063 6f6e 7461 696e 2074   which contain t
-00010e80: 6865 2066 6561 7475 7265 7320 6c6f 6f6b  he features look
-00010e90: 6564 2066 6f72 2c20 616e 6420 6172 6520  ed for, and are 
-00010ea0: 7461 6767 6564 2077 6974 6820 7468 6520  tagged with the 
-00010eb0: 7370 6563 6966 6963 2074 6167 2e0a 2020  specific tag..  
-00010ec0: 2020 2020 2020 3a70 6172 616d 2065 6e74        :param ent
-00010ed0: 6974 6965 733a 2052 6574 7572 6e20 6f6e  ities: Return on
-00010ee0: 6c79 2066 6561 7475 7265 2d73 6574 7320  ly feature-sets 
-00010ef0: 7768 6963 6820 636f 6e74 6169 6e20 616e  which contain an
-00010f00: 2065 6e74 6974 7920 7768 6f73 6520 6e61   entity whose na
-00010f10: 6d65 2069 7320 636f 6e74 6169 6e65 6420  me is contained 
-00010f20: 696e 2074 6869 7320 6c69 7374 2e0a 2020  in this list..  
-00010f30: 2020 2020 2020 3a70 6172 616d 206c 6162        :param lab
-00010f40: 656c 733a 2052 6574 7572 6e20 6f6e 6c79  els: Return only
-00010f50: 2066 6561 7475 7265 2d73 6574 7320 7768   feature-sets wh
-00010f60: 6963 6820 6172 6520 6c61 6265 6c65 6420  ich are labeled 
-00010f70: 6173 2072 6571 7565 7374 6564 2e0a 2020  as requested..  
-00010f80: 2020 2020 2020 3a72 6574 7572 6e73 3a20        :returns: 
-00010f90: 4120 6c69 7374 206f 6620 6d61 7070 696e  A list of mappin
-00010fa0: 6720 6672 6f6d 2066 6561 7475 7265 2074  g from feature t
-00010fb0: 6f20 6120 6469 6765 7374 206f 6620 7468  o a digest of th
-00010fc0: 6520 6665 6174 7572 652d 7365 742c 2077  e feature-set, w
-00010fd0: 6869 6368 2063 6f6e 7461 696e 7320 7468  hich contains th
-00010fe0: 6520 6665 6174 7572 652d 7365 740a 2020  e feature-set.  
-00010ff0: 2020 2020 2020 2020 2020 6d65 7461 2d64            meta-d
-00011000: 6174 612e 204d 756c 7469 706c 6520 656e  ata. Multiple en
-00011010: 7472 6965 7320 6d61 7920 6265 2072 6574  tries may be ret
-00011020: 7572 6e65 6420 666f 7220 616e 7920 7370  urned for any sp
-00011030: 6563 6966 6963 2066 6561 7475 7265 2064  ecific feature d
-00011040: 7565 2074 6f20 6d75 6c74 6970 6c65 2074  ue to multiple t
-00011050: 6167 7320 6f72 2076 6572 7369 6f6e 730a  ags or versions.
-00011060: 2020 2020 2020 2020 2020 2020 6f66 2074              of t
-00011070: 6865 2066 6561 7475 7265 2d73 6574 2e0a  he feature-set..
-00011080: 2020 2020 2020 2020 2222 220a 0a20 2020          """..   
-00011090: 2020 2020 2070 726f 6a65 6374 203d 2070       project = p
-000110a0: 726f 6a65 6374 206f 7220 636f 6e66 6967  roject or config
-000110b0: 2e64 6566 6175 6c74 5f70 726f 6a65 6374  .default_project
-000110c0: 0a20 2020 2020 2020 2070 6172 616d 7320  .        params 
-000110d0: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
-000110e0: 226e 616d 6522 3a20 6e61 6d65 2c0a 2020  "name": name,.  
-000110f0: 2020 2020 2020 2020 2020 2274 6167 223a            "tag":
-00011100: 2074 6167 2c0a 2020 2020 2020 2020 2020   tag,.          
-00011110: 2020 2265 6e74 6974 7922 3a20 656e 7469    "entity": enti
-00011120: 7469 6573 206f 7220 5b5d 2c0a 2020 2020  ties or [],.    
-00011130: 2020 2020 2020 2020 226c 6162 656c 223a          "label":
-00011140: 206c 6162 656c 7320 6f72 205b 5d2c 0a20   labels or [],. 
-00011150: 2020 2020 2020 207d 0a0a 2020 2020 2020         }..      
-00011160: 2020 7061 7468 203d 2066 2270 726f 6a65    path = f"proje
-00011170: 6374 732f 7b70 726f 6a65 6374 7d2f 6665  cts/{project}/fe
-00011180: 6174 7572 6573 220a 0a20 2020 2020 2020  atures"..       
-00011190: 2065 7272 6f72 5f6d 6573 7361 6765 203d   error_message =
-000111a0: 2066 2246 6169 6c65 6420 6c69 7374 696e   f"Failed listin
-000111b0: 6720 6665 6174 7572 6573 2c20 7072 6f6a  g features, proj
-000111c0: 6563 743a 207b 7072 6f6a 6563 747d 2c20  ect: {project}, 
-000111d0: 7175 6572 793a 207b 7061 7261 6d73 7d22  query: {params}"
-000111e0: 0a20 2020 2020 2020 2072 6573 7020 3d20  .        resp = 
-000111f0: 7365 6c66 2e61 7069 5f63 616c 6c28 2247  self.api_call("G
-00011200: 4554 222c 2070 6174 682c 2065 7272 6f72  ET", path, error
-00011210: 5f6d 6573 7361 6765 2c20 7061 7261 6d73  _message, params
-00011220: 3d70 6172 616d 7329 0a20 2020 2020 2020  =params).       
-00011230: 2072 6574 7572 6e20 7265 7370 2e6a 736f   return resp.jso
-00011240: 6e28 295b 2266 6561 7475 7265 7322 5d0a  n()["features"].
-00011250: 0a20 2020 2064 6566 206c 6973 745f 656e  .    def list_en
-00011260: 7469 7469 6573 280a 2020 2020 2020 2020  tities(.        
-00011270: 7365 6c66 2c0a 2020 2020 2020 2020 7072  self,.        pr
-00011280: 6f6a 6563 743a 2073 7472 2c0a 2020 2020  oject: str,.    
-00011290: 2020 2020 6e61 6d65 3a20 7374 7220 3d20      name: str = 
-000112a0: 4e6f 6e65 2c0a 2020 2020 2020 2020 7461  None,.        ta
-000112b0: 673a 2073 7472 203d 204e 6f6e 652c 0a20  g: str = None,. 
-000112c0: 2020 2020 2020 206c 6162 656c 733a 204c         labels: L
-000112d0: 6973 745b 7374 725d 203d 204e 6f6e 652c  ist[str] = None,
-000112e0: 0a20 2020 2029 202d 3e20 4c69 7374 5b64  .    ) -> List[d
-000112f0: 6963 745d 3a0a 2020 2020 2020 2020 2222  ict]:.        ""
-00011300: 2252 6574 7269 6576 6520 6120 6c69 7374  "Retrieve a list
-00011310: 206f 6620 656e 7469 7469 6573 2061 6e64   of entities and
-00011320: 2074 6865 6972 206d 6170 7069 6e67 2074   their mapping t
-00011330: 6f20 7468 6520 636f 6e74 6169 6e69 6e67  o the containing
-00011340: 2066 6561 7475 7265 2d73 6574 732e 2054   feature-sets. T
-00011350: 6869 7320 6675 6e63 7469 6f6e 2069 7320  his function is 
-00011360: 7369 6d69 6c61 720a 2020 2020 2020 2020  similar.        
-00011370: 746f 2074 6865 203a 7079 3a66 756e 633a  to the :py:func:
-00011380: 607e 6c69 7374 5f66 6561 7475 7265 7360  `~list_features`
-00011390: 2066 756e 6374 696f 6e2c 2061 6e64 2075   function, and u
-000113a0: 7365 7320 7468 6520 7361 6d65 206c 6f67  ses the same log
-000113b0: 6963 2e20 486f 7765 7665 722c 2074 6865  ic. However, the
-000113c0: 2065 6e74 6974 6965 7320 6172 6520 6d61   entities are ma
-000113d0: 7463 6865 640a 2020 2020 2020 2020 6167  tched.        ag
-000113e0: 6169 6e73 7420 7468 6520 6e61 6d65 2072  ainst the name r
-000113f0: 6174 6865 7220 7468 616e 2074 6865 2066  ather than the f
-00011400: 6561 7475 7265 732e 0a20 2020 2020 2020  eatures..       
-00011410: 2022 2222 0a0a 2020 2020 2020 2020 7072   """..        pr
-00011420: 6f6a 6563 7420 3d20 7072 6f6a 6563 7420  oject = project 
-00011430: 6f72 2063 6f6e 6669 672e 6465 6661 756c  or config.defaul
-00011440: 745f 7072 6f6a 6563 740a 2020 2020 2020  t_project.      
-00011450: 2020 7061 7261 6d73 203d 207b 0a20 2020    params = {.   
-00011460: 2020 2020 2020 2020 2022 6e61 6d65 223a           "name":
-00011470: 206e 616d 652c 0a20 2020 2020 2020 2020   name,.         
-00011480: 2020 2022 7461 6722 3a20 7461 672c 0a20     "tag": tag,. 
-00011490: 2020 2020 2020 2020 2020 2022 6c61 6265             "labe
-000114a0: 6c22 3a20 6c61 6265 6c73 206f 7220 5b5d  l": labels or []
-000114b0: 2c0a 2020 2020 2020 2020 7d0a 0a20 2020  ,.        }..   
-000114c0: 2020 2020 2070 6174 6820 3d20 6622 7072       path = f"pr
-000114d0: 6f6a 6563 7473 2f7b 7072 6f6a 6563 747d  ojects/{project}
-000114e0: 2f65 6e74 6974 6965 7322 0a0a 2020 2020  /entities"..    
-000114f0: 2020 2020 6572 726f 725f 6d65 7373 6167      error_messag
-00011500: 6520 3d20 6622 4661 696c 6564 206c 6973  e = f"Failed lis
-00011510: 7469 6e67 2065 6e74 6974 6965 732c 2070  ting entities, p
-00011520: 726f 6a65 6374 3a20 7b70 726f 6a65 6374  roject: {project
-00011530: 7d2c 2071 7565 7279 3a20 7b70 6172 616d  }, query: {param
-00011540: 737d 220a 2020 2020 2020 2020 7265 7370  s}".        resp
-00011550: 203d 2073 656c 662e 6170 695f 6361 6c6c   = self.api_call
-00011560: 2822 4745 5422 2c20 7061 7468 2c20 6572  ("GET", path, er
-00011570: 726f 725f 6d65 7373 6167 652c 2070 6172  ror_message, par
-00011580: 616d 733d 7061 7261 6d73 290a 2020 2020  ams=params).    
-00011590: 2020 2020 7265 7475 726e 2072 6573 702e      return resp.
-000115a0: 6a73 6f6e 2829 5b22 656e 7469 7469 6573  json()["entities
-000115b0: 225d 0a0a 2020 2020 4073 7461 7469 636d  "]..    @staticm
-000115c0: 6574 686f 640a 2020 2020 6465 6620 5f67  ethod.    def _g
-000115d0: 656e 6572 6174 655f 7061 7274 6974 696f  enerate_partitio
-000115e0: 6e5f 6279 5f70 6172 616d 7328 0a20 2020  n_by_params(.   
-000115f0: 2020 2020 2070 6172 7469 7469 6f6e 5f62       partition_b
-00011600: 795f 636c 732c 0a20 2020 2020 2020 2070  y_cls,.        p
-00011610: 6172 7469 7469 6f6e 5f62 792c 0a20 2020  artition_by,.   
-00011620: 2020 2020 2072 6f77 735f 7065 725f 7061       rows_per_pa
-00011630: 7274 6974 696f 6e2c 0a20 2020 2020 2020  rtition,.       
-00011640: 2073 6f72 745f 6279 2c0a 2020 2020 2020   sort_by,.      
-00011650: 2020 6f72 6465 722c 0a20 2020 2020 2020    order,.       
-00011660: 206d 6178 5f70 6172 7469 7469 6f6e 733d   max_partitions=
-00011670: 4e6f 6e65 2c0a 2020 2020 293a 0a0a 2020  None,.    ):..  
-00011680: 2020 2020 2020 7061 7274 6974 696f 6e5f        partition_
-00011690: 7061 7261 6d73 203d 207b 0a20 2020 2020  params = {.     
-000116a0: 2020 2020 2020 2022 7061 7274 6974 696f         "partitio
-000116b0: 6e2d 6279 223a 2070 6172 7469 7469 6f6e  n-by": partition
-000116c0: 5f62 792c 0a20 2020 2020 2020 2020 2020  _by,.           
-000116d0: 2022 726f 7773 2d70 6572 2d70 6172 7469   "rows-per-parti
-000116e0: 7469 6f6e 223a 2072 6f77 735f 7065 725f  tion": rows_per_
-000116f0: 7061 7274 6974 696f 6e2c 0a20 2020 2020  partition,.     
-00011700: 2020 2020 2020 2022 7061 7274 6974 696f         "partitio
-00011710: 6e2d 736f 7274 2d62 7922 3a20 736f 7274  n-sort-by": sort
-00011720: 5f62 792c 0a20 2020 2020 2020 2020 2020  _by,.           
-00011730: 2022 7061 7274 6974 696f 6e2d 6f72 6465   "partition-orde
-00011740: 7222 3a20 6f72 6465 722c 0a20 2020 2020  r": order,.     
-00011750: 2020 207d 0a20 2020 2020 2020 2069 6620     }.        if 
-00011760: 6d61 785f 7061 7274 6974 696f 6e73 2069  max_partitions i
-00011770: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-00011780: 2020 2020 2020 2020 7061 7274 6974 696f          partitio
-00011790: 6e5f 7061 7261 6d73 5b22 6d61 782d 7061  n_params["max-pa
-000117a0: 7274 6974 696f 6e73 225d 203d 206d 6178  rtitions"] = max
-000117b0: 5f70 6172 7469 7469 6f6e 730a 2020 2020  _partitions.    
-000117c0: 2020 2020 7265 7475 726e 2070 6172 7469      return parti
-000117d0: 7469 6f6e 5f70 6172 616d 730a 0a20 2020  tion_params..   
-000117e0: 2064 6566 206c 6973 745f 6665 6174 7572   def list_featur
-000117f0: 655f 7365 7473 280a 2020 2020 2020 2020  e_sets(.        
-00011800: 7365 6c66 2c0a 2020 2020 2020 2020 7072  self,.        pr
-00011810: 6f6a 6563 743a 2073 7472 203d 2022 222c  oject: str = "",
-00011820: 0a20 2020 2020 2020 206e 616d 653a 2073  .        name: s
-00011830: 7472 203d 204e 6f6e 652c 0a20 2020 2020  tr = None,.     
-00011840: 2020 2074 6167 3a20 7374 7220 3d20 4e6f     tag: str = No
-00011850: 6e65 2c0a 2020 2020 2020 2020 7374 6174  ne,.        stat
-00011860: 653a 2073 7472 203d 204e 6f6e 652c 0a20  e: str = None,. 
-00011870: 2020 2020 2020 2065 6e74 6974 6965 733a         entities:
-00011880: 204c 6973 745b 7374 725d 203d 204e 6f6e   List[str] = Non
-00011890: 652c 0a20 2020 2020 2020 2066 6561 7475  e,.        featu
-000118a0: 7265 733a 204c 6973 745b 7374 725d 203d  res: List[str] =
-000118b0: 204e 6f6e 652c 0a20 2020 2020 2020 206c   None,.        l
-000118c0: 6162 656c 733a 204c 6973 745b 7374 725d  abels: List[str]
-000118d0: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-000118e0: 2070 6172 7469 7469 6f6e 5f62 793a 2055   partition_by: U
-000118f0: 6e69 6f6e 5b0a 2020 2020 2020 2020 2020  nion[.          
-00011900: 2020 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73    mlrun.common.s
-00011910: 6368 656d 6173 2e46 6561 7475 7265 5374  chemas.FeatureSt
-00011920: 6f72 6550 6172 7469 7469 6f6e 4279 4669  orePartitionByFi
-00011930: 656c 642c 2073 7472 0a20 2020 2020 2020  eld, str.       
-00011940: 205d 203d 204e 6f6e 652c 0a20 2020 2020   ] = None,.     
-00011950: 2020 2072 6f77 735f 7065 725f 7061 7274     rows_per_part
-00011960: 6974 696f 6e3a 2069 6e74 203d 2031 2c0a  ition: int = 1,.
-00011970: 2020 2020 2020 2020 7061 7274 6974 696f          partitio
-00011980: 6e5f 736f 7274 5f62 793a 2055 6e69 6f6e  n_sort_by: Union
-00011990: 5b6d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363  [mlrun.common.sc
-000119a0: 6865 6d61 732e 536f 7274 4669 656c 642c  hemas.SortField,
-000119b0: 2073 7472 5d20 3d20 4e6f 6e65 2c0a 2020   str] = None,.  
-000119c0: 2020 2020 2020 7061 7274 6974 696f 6e5f        partition_
-000119d0: 6f72 6465 723a 2055 6e69 6f6e 5b0a 2020  order: Union[.  
-000119e0: 2020 2020 2020 2020 2020 6d6c 7275 6e2e            mlrun.
-000119f0: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e4f  common.schemas.O
-00011a00: 7264 6572 5479 7065 2c20 7374 720a 2020  rderType, str.  
-00011a10: 2020 2020 2020 5d20 3d20 6d6c 7275 6e2e        ] = mlrun.
-00011a20: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e4f  common.schemas.O
-00011a30: 7264 6572 5479 7065 2e64 6573 632c 0a20  rderType.desc,. 
-00011a40: 2020 2029 202d 3e20 4c69 7374 5b46 6561     ) -> List[Fea
-00011a50: 7475 7265 5365 745d 3a0a 2020 2020 2020  tureSet]:.      
-00011a60: 2020 2222 2252 6574 7269 6576 6520 6120    """Retrieve a 
-00011a70: 6c69 7374 206f 6620 6665 6174 7572 652d  list of feature-
-00011a80: 7365 7473 206d 6174 6368 696e 6720 7468  sets matching th
-00011a90: 6520 6372 6974 6572 6961 2070 726f 7669  e criteria provi
-00011aa0: 6465 642e 0a0a 2020 2020 2020 2020 3a70  ded...        :p
-00011ab0: 6172 616d 2070 726f 6a65 6374 3a20 5072  aram project: Pr
-00011ac0: 6f6a 6563 7420 6e61 6d65 2e0a 2020 2020  oject name..    
-00011ad0: 2020 2020 3a70 6172 616d 206e 616d 653a      :param name:
-00011ae0: 204e 616d 6520 6f66 2066 6561 7475 7265   Name of feature
-00011af0: 2d73 6574 2074 6f20 6d61 7463 682e 2054  -set to match. T
-00011b00: 6869 7320 6973 2061 206c 696b 6520 7175  his is a like qu
-00011b10: 6572 792c 2061 6e64 2069 7320 6361 7365  ery, and is case
-00011b20: 2d69 6e73 656e 7369 7469 7665 2e0a 2020  -insensitive..  
-00011b30: 2020 2020 2020 3a70 6172 616d 2074 6167        :param tag
-00011b40: 3a20 4d61 7463 6820 6665 6174 7572 652d  : Match feature-
-00011b50: 7365 7473 2077 6974 6820 7370 6563 6966  sets with specif
-00011b60: 6963 2074 6167 2e0a 2020 2020 2020 2020  ic tag..        
-00011b70: 3a70 6172 616d 2073 7461 7465 3a20 4d61  :param state: Ma
-00011b80: 7463 6820 6665 6174 7572 652d 7365 7473  tch feature-sets
-00011b90: 2077 6974 6820 6120 7370 6563 6966 6963   with a specific
-00011ba0: 2073 7461 7465 2e0a 2020 2020 2020 2020   state..        
-00011bb0: 3a70 6172 616d 2065 6e74 6974 6965 733a  :param entities:
-00011bc0: 204d 6174 6368 2066 6561 7475 7265 2d73   Match feature-s
-00011bd0: 6574 7320 7768 6963 6820 636f 6e74 6169  ets which contai
-00011be0: 6e20 656e 7469 7469 6573 2077 686f 7365  n entities whose
-00011bf0: 206e 616d 6520 6973 2069 6e20 7468 6973   name is in this
-00011c00: 206c 6973 742e 0a20 2020 2020 2020 203a   list..        :
-00011c10: 7061 7261 6d20 6665 6174 7572 6573 3a20  param features: 
-00011c20: 4d61 7463 6820 6665 6174 7572 652d 7365  Match feature-se
-00011c30: 7473 2077 6869 6368 2063 6f6e 7461 696e  ts which contain
-00011c40: 2066 6561 7475 7265 7320 7768 6f73 6520   features whose 
-00011c50: 6e61 6d65 2069 7320 696e 2074 6869 7320  name is in this 
-00011c60: 6c69 7374 2e0a 2020 2020 2020 2020 3a70  list..        :p
-00011c70: 6172 616d 206c 6162 656c 733a 204d 6174  aram labels: Mat
-00011c80: 6368 2066 6561 7475 7265 2d73 6574 7320  ch feature-sets 
-00011c90: 7768 6963 6820 6861 7665 2074 6865 7365  which have these
-00011ca0: 206c 6162 656c 732e 0a20 2020 2020 2020   labels..       
-00011cb0: 203a 7061 7261 6d20 7061 7274 6974 696f   :param partitio
-00011cc0: 6e5f 6279 3a20 4669 656c 6420 746f 2067  n_by: Field to g
-00011cd0: 726f 7570 2072 6573 756c 7473 2062 792e  roup results by.
-00011ce0: 204f 6e6c 7920 616c 6c6f 7765 6420 7661   Only allowed va
-00011cf0: 6c75 6520 6973 2060 6e61 6d65 602e 2057  lue is `name`. W
-00011d00: 6865 6e20 6070 6172 7469 7469 6f6e 5f62  hen `partition_b
-00011d10: 7960 2069 7320 7370 6563 6966 6965 642c  y` is specified,
-00011d20: 0a20 2020 2020 2020 2020 2020 2074 6865  .            the
-00011d30: 2060 7061 7274 6974 696f 6e5f 736f 7274   `partition_sort
-00011d40: 5f62 7960 2070 6172 616d 6574 6572 206d  _by` parameter m
-00011d50: 7573 7420 6265 2070 726f 7669 6465 6420  ust be provided 
-00011d60: 6173 2077 656c 6c2e 0a20 2020 2020 2020  as well..       
-00011d70: 203a 7061 7261 6d20 726f 7773 5f70 6572   :param rows_per
-00011d80: 5f70 6172 7469 7469 6f6e 3a20 486f 7720  _partition: How 
-00011d90: 6d61 6e79 2074 6f70 2072 6f77 7320 2870  many top rows (p
-00011da0: 6572 2073 6f72 7469 6e67 2064 6566 696e  er sorting defin
-00011db0: 6564 2062 7920 6070 6172 7469 7469 6f6e  ed by `partition
-00011dc0: 5f73 6f72 745f 6279 6020 616e 6420 6070  _sort_by` and `p
-00011dd0: 6172 7469 7469 6f6e 5f6f 7264 6572 6029  artition_order`)
-00011de0: 0a20 2020 2020 2020 2020 2020 2074 6f20  .            to 
-00011df0: 7265 7475 726e 2070 6572 2067 726f 7570  return per group
-00011e00: 2e20 4465 6661 756c 7420 7661 6c75 6520  . Default value 
-00011e10: 6973 2031 2e0a 2020 2020 2020 2020 3a70  is 1..        :p
-00011e20: 6172 616d 2070 6172 7469 7469 6f6e 5f73  aram partition_s
-00011e30: 6f72 745f 6279 3a20 5768 6174 2066 6965  ort_by: What fie
-00011e40: 6c64 2074 6f20 736f 7274 2074 6865 2072  ld to sort the r
-00011e50: 6573 756c 7473 2062 792c 2077 6974 6869  esults by, withi
-00011e60: 6e20 6561 6368 2070 6172 7469 7469 6f6e  n each partition
-00011e70: 2064 6566 696e 6564 2062 7920 6070 6172   defined by `par
-00011e80: 7469 7469 6f6e 5f62 7960 2e0a 2020 2020  tition_by`..    
-00011e90: 2020 2020 2020 2020 4375 7272 656e 746c          Currentl
-00011ea0: 7920 7468 6520 6f6e 6c79 2061 6c6c 6f77  y the only allow
-00011eb0: 6564 2076 616c 7565 2061 7265 2060 6372  ed value are `cr
-00011ec0: 6561 7465 6460 2061 6e64 2060 7570 6461  eated` and `upda
-00011ed0: 7465 6460 2e0a 2020 2020 2020 2020 3a70  ted`..        :p
-00011ee0: 6172 616d 2070 6172 7469 7469 6f6e 5f6f  aram partition_o
-00011ef0: 7264 6572 3a20 4f72 6465 7220 6f66 2073  rder: Order of s
-00011f00: 6f72 7469 6e67 2077 6974 6869 6e20 7061  orting within pa
-00011f10: 7274 6974 696f 6e73 202d 2060 6173 6360  rtitions - `asc`
-00011f20: 206f 7220 6064 6573 6360 2e20 4465 6661   or `desc`. Defa
-00011f30: 756c 7420 6973 2060 6465 7363 602e 0a20  ult is `desc`.. 
-00011f40: 2020 2020 2020 203a 7265 7475 726e 733a         :returns:
-00011f50: 204c 6973 7420 6f66 206d 6174 6368 696e   List of matchin
-00011f60: 6720 3a70 793a 636c 6173 733a 607e 6d6c  g :py:class:`~ml
-00011f70: 7275 6e2e 6665 6174 7572 655f 7374 6f72  run.feature_stor
-00011f80: 652e 4665 6174 7572 6553 6574 6020 6f62  e.FeatureSet` ob
-00011f90: 6a65 6374 732e 0a20 2020 2020 2020 2022  jects..        "
-00011fa0: 2222 0a0a 2020 2020 2020 2020 7072 6f6a  ""..        proj
-00011fb0: 6563 7420 3d20 7072 6f6a 6563 7420 6f72  ect = project or
-00011fc0: 2063 6f6e 6669 672e 6465 6661 756c 745f   config.default_
-00011fd0: 7072 6f6a 6563 740a 0a20 2020 2020 2020  project..       
-00011fe0: 2070 6172 616d 7320 3d20 7b0a 2020 2020   params = {.    
-00011ff0: 2020 2020 2020 2020 226e 616d 6522 3a20          "name": 
-00012000: 6e61 6d65 2c0a 2020 2020 2020 2020 2020  name,.          
-00012010: 2020 2273 7461 7465 223a 2073 7461 7465    "state": state
-00012020: 2c0a 2020 2020 2020 2020 2020 2020 2274  ,.            "t
-00012030: 6167 223a 2074 6167 2c0a 2020 2020 2020  ag": tag,.      
-00012040: 2020 2020 2020 2265 6e74 6974 7922 3a20        "entity": 
-00012050: 656e 7469 7469 6573 206f 7220 5b5d 2c0a  entities or [],.
-00012060: 2020 2020 2020 2020 2020 2020 2266 6561              "fea
-00012070: 7475 7265 223a 2066 6561 7475 7265 7320  ture": features 
-00012080: 6f72 205b 5d2c 0a20 2020 2020 2020 2020  or [],.         
-00012090: 2020 2022 6c61 6265 6c22 3a20 6c61 6265     "label": labe
-000120a0: 6c73 206f 7220 5b5d 2c0a 2020 2020 2020  ls or [],.      
-000120b0: 2020 7d0a 2020 2020 2020 2020 6966 2070    }.        if p
-000120c0: 6172 7469 7469 6f6e 5f62 793a 0a20 2020  artition_by:.   
-000120d0: 2020 2020 2020 2020 2070 6172 616d 732e           params.
-000120e0: 7570 6461 7465 280a 2020 2020 2020 2020  update(.        
-000120f0: 2020 2020 2020 2020 7365 6c66 2e5f 6765          self._ge
-00012100: 6e65 7261 7465 5f70 6172 7469 7469 6f6e  nerate_partition
-00012110: 5f62 795f 7061 7261 6d73 280a 2020 2020  _by_params(.    
-00012120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012130: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
-00012140: 656d 6173 2e46 6561 7475 7265 5374 6f72  emas.FeatureStor
-00012150: 6550 6172 7469 7469 6f6e 4279 4669 656c  ePartitionByFiel
-00012160: 642c 0a20 2020 2020 2020 2020 2020 2020  d,.             
-00012170: 2020 2020 2020 2070 6172 7469 7469 6f6e         partition
-00012180: 5f62 792c 0a20 2020 2020 2020 2020 2020  _by,.           
-00012190: 2020 2020 2020 2020 2072 6f77 735f 7065           rows_pe
-000121a0: 725f 7061 7274 6974 696f 6e2c 0a20 2020  r_partition,.   
-000121b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000121c0: 2070 6172 7469 7469 6f6e 5f73 6f72 745f   partition_sort_
-000121d0: 6279 2c0a 2020 2020 2020 2020 2020 2020  by,.            
-000121e0: 2020 2020 2020 2020 7061 7274 6974 696f          partitio
-000121f0: 6e5f 6f72 6465 722c 0a20 2020 2020 2020  n_order,.       
-00012200: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00012210: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-00012220: 2020 7061 7468 203d 2066 2270 726f 6a65    path = f"proje
-00012230: 6374 732f 7b70 726f 6a65 6374 7d2f 6665  cts/{project}/fe
-00012240: 6174 7572 652d 7365 7473 220a 0a20 2020  ature-sets"..   
-00012250: 2020 2020 2065 7272 6f72 5f6d 6573 7361       error_messa
-00012260: 6765 203d 2028 0a20 2020 2020 2020 2020  ge = (.         
-00012270: 2020 2066 2246 6169 6c65 6420 6c69 7374     f"Failed list
-00012280: 696e 6720 6665 6174 7572 652d 7365 7473  ing feature-sets
-00012290: 2c20 7072 6f6a 6563 743a 207b 7072 6f6a  , project: {proj
-000122a0: 6563 747d 2c20 7175 6572 793a 207b 7061  ect}, query: {pa
-000122b0: 7261 6d73 7d22 0a20 2020 2020 2020 2029  rams}".        )
-000122c0: 0a20 2020 2020 2020 2072 6573 7020 3d20  .        resp = 
-000122d0: 7365 6c66 2e61 7069 5f63 616c 6c28 2247  self.api_call("G
-000122e0: 4554 222c 2070 6174 682c 2065 7272 6f72  ET", path, error
-000122f0: 5f6d 6573 7361 6765 2c20 7061 7261 6d73  _message, params
-00012300: 3d70 6172 616d 7329 0a20 2020 2020 2020  =params).       
-00012310: 2066 6561 7475 7265 5f73 6574 7320 3d20   feature_sets = 
-00012320: 7265 7370 2e6a 736f 6e28 295b 2266 6561  resp.json()["fea
-00012330: 7475 7265 5f73 6574 7322 5d0a 2020 2020  ture_sets"].    
-00012340: 2020 2020 6966 2066 6561 7475 7265 5f73      if feature_s
-00012350: 6574 733a 0a20 2020 2020 2020 2020 2020  ets:.           
-00012360: 2072 6574 7572 6e20 5b46 6561 7475 7265   return [Feature
-00012370: 5365 742e 6672 6f6d 5f64 6963 7428 6f62  Set.from_dict(ob
-00012380: 6a29 2066 6f72 206f 626a 2069 6e20 6665  j) for obj in fe
-00012390: 6174 7572 655f 7365 7473 5d0a 0a20 2020  ature_sets]..   
-000123a0: 2064 6566 2073 746f 7265 5f66 6561 7475   def store_featu
-000123b0: 7265 5f73 6574 280a 2020 2020 2020 2020  re_set(.        
-000123c0: 7365 6c66 2c0a 2020 2020 2020 2020 6665  self,.        fe
-000123d0: 6174 7572 655f 7365 743a 2055 6e69 6f6e  ature_set: Union
-000123e0: 5b64 6963 742c 206d 6c72 756e 2e63 6f6d  [dict, mlrun.com
-000123f0: 6d6f 6e2e 7363 6865 6d61 732e 4665 6174  mon.schemas.Feat
-00012400: 7572 6553 6574 2c20 4665 6174 7572 6553  ureSet, FeatureS
-00012410: 6574 5d2c 0a20 2020 2020 2020 206e 616d  et],.        nam
-00012420: 653d 4e6f 6e65 2c0a 2020 2020 2020 2020  e=None,.        
-00012430: 7072 6f6a 6563 743d 2222 2c0a 2020 2020  project="",.    
-00012440: 2020 2020 7461 673d 4e6f 6e65 2c0a 2020      tag=None,.  
-00012450: 2020 2020 2020 7569 643d 4e6f 6e65 2c0a        uid=None,.
-00012460: 2020 2020 2020 2020 7665 7273 696f 6e65          versione
-00012470: 643d 5472 7565 2c0a 2020 2020 2920 2d3e  d=True,.    ) ->
-00012480: 2064 6963 743a 0a20 2020 2020 2020 2022   dict:.        "
-00012490: 2222 5361 7665 2061 203a 7079 3a63 6c61  ""Save a :py:cla
-000124a0: 7373 3a60 7e6d 6c72 756e 2e66 6561 7475  ss:`~mlrun.featu
-000124b0: 7265 5f73 746f 7265 2e46 6561 7475 7265  re_store.Feature
-000124c0: 5365 7460 206f 626a 6563 7420 696e 2074  Set` object in t
-000124d0: 6865 203a 7079 3a6d 6f64 3a60 6d6c 7275  he :py:mod:`mlru
-000124e0: 6e60 2044 422e 2054 6865 0a20 2020 2020  n` DB. The.     
-000124f0: 2020 2066 6561 7475 7265 2d73 6574 2063     feature-set c
-00012500: 616e 2062 6520 6569 7468 6572 2061 206e  an be either a n
-00012510: 6577 206f 626a 6563 7420 6f72 2061 206d  ew object or a m
-00012520: 6f64 6966 6963 6174 696f 6e20 746f 2065  odification to e
-00012530: 7869 7374 696e 6720 6f62 6a65 6374 2072  xisting object r
-00012540: 6566 6572 656e 6365 6420 6279 2074 6865  eferenced by the
-00012550: 2070 6172 616d 7320 6f66 0a20 2020 2020   params of.     
-00012560: 2020 2074 6865 2066 756e 6374 696f 6e2e     the function.
-00012570: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00012580: 2066 6561 7475 7265 5f73 6574 3a20 5468   feature_set: Th
-00012590: 6520 3a70 793a 636c 6173 733a 607e 6d6c  e :py:class:`~ml
-000125a0: 7275 6e2e 6665 6174 7572 655f 7374 6f72  run.feature_stor
-000125b0: 652e 4665 6174 7572 6553 6574 6020 746f  e.FeatureSet` to
-000125c0: 2073 746f 7265 2e0a 2020 2020 2020 2020   store..        
-000125d0: 3a70 6172 616d 206e 616d 653a 2020 2020  :param name:    
-000125e0: 4e61 6d65 206f 6620 6665 6174 7572 6520  Name of feature 
-000125f0: 7365 742e 0a20 2020 2020 2020 203a 7061  set..        :pa
-00012600: 7261 6d20 7072 6f6a 6563 743a 204e 616d  ram project: Nam
-00012610: 6520 6f66 2070 726f 6a65 6374 2074 6869  e of project thi
-00012620: 7320 6665 6174 7572 652d 7365 7420 6265  s feature-set be
-00012630: 6c6f 6e67 7320 746f 2e0a 2020 2020 2020  longs to..      
-00012640: 2020 3a70 6172 616d 2074 6167 3a20 5468    :param tag: Th
-00012650: 6520 6060 7461 6760 6020 6f66 2074 6865  e ``tag`` of the
-00012660: 206f 626a 6563 7420 746f 2072 6570 6c61   object to repla
-00012670: 6365 2069 6e20 7468 6520 4442 2c20 666f  ce in the DB, fo
-00012680: 7220 6578 616d 706c 6520 6060 6c61 7465  r example ``late
-00012690: 7374 6060 2e0a 2020 2020 2020 2020 3a70  st``..        :p
-000126a0: 6172 616d 2075 6964 3a20 5468 6520 6060  aram uid: The ``
-000126b0: 7569 6460 6020 6f66 2074 6865 206f 626a  uid`` of the obj
-000126c0: 6563 7420 746f 2072 6570 6c61 6365 2069  ect to replace i
-000126d0: 6e20 7468 6520 4442 2e20 4966 2075 7369  n the DB. If usi
-000126e0: 6e67 2074 6869 7320 7061 7261 6d65 7465  ng this paramete
-000126f0: 722c 2074 6865 206d 6f64 6966 6965 6420  r, the modified 
-00012700: 6f62 6a65 6374 0a20 2020 2020 2020 2020  object.         
-00012710: 2020 206d 7573 7420 6861 7665 2074 6865     must have the
-00012720: 2073 616d 6520 6060 7569 6460 6020 6f66   same ``uid`` of
-00012730: 2074 6865 2070 7265 7669 6f75 736c 792d   the previously-
-00012740: 6578 6973 7469 6e67 206f 626a 6563 742e  existing object.
-00012750: 2054 6869 7320 6361 6e6e 6f74 2062 6520   This cannot be 
-00012760: 7573 6564 2066 6f72 206e 6f6e 2d76 6572  used for non-ver
-00012770: 7369 6f6e 6564 206f 626a 6563 7473 2e0a  sioned objects..
-00012780: 2020 2020 2020 2020 3a70 6172 616d 2076          :param v
-00012790: 6572 7369 6f6e 6564 3a20 5768 6574 6865  ersioned: Whethe
-000127a0: 7220 746f 206d 6169 6e74 6169 6e20 7665  r to maintain ve
-000127b0: 7273 696f 6e73 2066 6f72 2074 6869 7320  rsions for this 
-000127c0: 6665 6174 7572 652d 7365 742e 2041 6c6c  feature-set. All
-000127d0: 2076 6572 7369 6f6e 7320 6f66 2061 2076   versions of a v
-000127e0: 6572 7369 6f6e 6564 206f 626a 6563 740a  ersioned object.
-000127f0: 2020 2020 2020 2020 2020 2020 7769 6c6c              will
-00012800: 2062 6520 6b65 7074 2069 6e20 7468 6520   be kept in the 
-00012810: 4442 2061 6e64 2063 616e 2062 6520 7265  DB and can be re
-00012820: 7472 6965 7665 6420 756e 7469 6c20 6578  trieved until ex
-00012830: 706c 6963 6974 6c79 2064 656c 6574 6564  plicitly deleted
-00012840: 2e0a 2020 2020 2020 2020 3a72 6574 7572  ..        :retur
-00012850: 6e73 3a20 5468 6520 3a70 793a 636c 6173  ns: The :py:clas
-00012860: 733a 607e 6d6c 7275 6e2e 6665 6174 7572  s:`~mlrun.featur
-00012870: 655f 7374 6f72 652e 4665 6174 7572 6553  e_store.FeatureS
-00012880: 6574 6020 6f62 6a65 6374 2028 6173 2064  et` object (as d
-00012890: 6963 7429 2e0a 2020 2020 2020 2020 2222  ict)..        ""
-000128a0: 220a 0a20 2020 2020 2020 2072 6566 6572  "..        refer
-000128b0: 656e 6365 203d 2073 656c 662e 5f72 6573  ence = self._res
-000128c0: 6f6c 7665 5f72 6566 6572 656e 6365 2874  olve_reference(t
-000128d0: 6167 2c20 7569 6429 0a20 2020 2020 2020  ag, uid).       
-000128e0: 2070 6172 616d 7320 3d20 7b22 7665 7273   params = {"vers
-000128f0: 696f 6e65 6422 3a20 7665 7273 696f 6e65  ioned": versione
-00012900: 647d 0a0a 2020 2020 2020 2020 6966 2069  d}..        if i
-00012910: 7369 6e73 7461 6e63 6528 6665 6174 7572  sinstance(featur
-00012920: 655f 7365 742c 206d 6c72 756e 2e63 6f6d  e_set, mlrun.com
-00012930: 6d6f 6e2e 7363 6865 6d61 732e 4665 6174  mon.schemas.Feat
-00012940: 7572 6553 6574 293a 0a20 2020 2020 2020  ureSet):.       
-00012950: 2020 2020 2066 6561 7475 7265 5f73 6574       feature_set
-00012960: 203d 2066 6561 7475 7265 5f73 6574 2e64   = feature_set.d
-00012970: 6963 7428 290a 2020 2020 2020 2020 656c  ict().        el
-00012980: 6966 2069 7369 6e73 7461 6e63 6528 6665  if isinstance(fe
-00012990: 6174 7572 655f 7365 742c 2046 6561 7475  ature_set, Featu
-000129a0: 7265 5365 7429 3a0a 2020 2020 2020 2020  reSet):.        
-000129b0: 2020 2020 6665 6174 7572 655f 7365 7420      feature_set 
-000129c0: 3d20 6665 6174 7572 655f 7365 742e 746f  = feature_set.to
-000129d0: 5f64 6963 7428 290a 0a20 2020 2020 2020  _dict()..       
-000129e0: 206e 616d 6520 3d20 6e61 6d65 206f 7220   name = name or 
-000129f0: 6665 6174 7572 655f 7365 745b 226d 6574  feature_set["met
-00012a00: 6164 6174 6122 5d5b 226e 616d 6522 5d0a  adata"]["name"].
-00012a10: 2020 2020 2020 2020 7072 6f6a 6563 7420          project 
-00012a20: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
-00012a30: 7072 6f6a 6563 7420 6f72 2066 6561 7475  project or featu
-00012a40: 7265 5f73 6574 5b22 6d65 7461 6461 7461  re_set["metadata
-00012a50: 225d 2e67 6574 2822 7072 6f6a 6563 7422  "].get("project"
-00012a60: 2920 6f72 2063 6f6e 6669 672e 6465 6661  ) or config.defa
-00012a70: 756c 745f 7072 6f6a 6563 740a 2020 2020  ult_project.    
-00012a80: 2020 2020 290a 2020 2020 2020 2020 7061      ).        pa
-00012a90: 7468 203d 2066 2270 726f 6a65 6374 732f  th = f"projects/
-00012aa0: 7b70 726f 6a65 6374 7d2f 6665 6174 7572  {project}/featur
-00012ab0: 652d 7365 7473 2f7b 6e61 6d65 7d2f 7265  e-sets/{name}/re
-00012ac0: 6665 7265 6e63 6573 2f7b 7265 6665 7265  ferences/{refere
-00012ad0: 6e63 657d 220a 2020 2020 2020 2020 6572  nce}".        er
-00012ae0: 726f 725f 6d65 7373 6167 6520 3d20 6622  ror_message = f"
-00012af0: 4661 696c 6564 2073 746f 7269 6e67 2066  Failed storing f
-00012b00: 6561 7475 7265 2d73 6574 207b 7072 6f6a  eature-set {proj
-00012b10: 6563 747d 2f7b 6e61 6d65 7d22 0a20 2020  ect}/{name}".   
-00012b20: 2020 2020 2072 6573 7020 3d20 7365 6c66       resp = self
-00012b30: 2e61 7069 5f63 616c 6c28 0a20 2020 2020  .api_call(.     
-00012b40: 2020 2020 2020 2022 5055 5422 2c20 7061         "PUT", pa
-00012b50: 7468 2c20 6572 726f 725f 6d65 7373 6167  th, error_messag
-00012b60: 652c 2070 6172 616d 733d 7061 7261 6d73  e, params=params
-00012b70: 2c20 626f 6479 3d64 6963 745f 746f 5f6a  , body=dict_to_j
-00012b80: 736f 6e28 6665 6174 7572 655f 7365 7429  son(feature_set)
-00012b90: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-00012ba0: 2020 2072 6574 7572 6e20 7265 7370 2e6a     return resp.j
-00012bb0: 736f 6e28 290a 0a20 2020 2064 6566 2070  son()..    def p
-00012bc0: 6174 6368 5f66 6561 7475 7265 5f73 6574  atch_feature_set
-00012bd0: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-00012be0: 2020 2020 2020 2020 6e61 6d65 2c0a 2020          name,.  
-00012bf0: 2020 2020 2020 6665 6174 7572 655f 7365        feature_se
-00012c00: 745f 7570 6461 7465 3a20 6469 6374 2c0a  t_update: dict,.
-00012c10: 2020 2020 2020 2020 7072 6f6a 6563 743d          project=
-00012c20: 2222 2c0a 2020 2020 2020 2020 7461 673d  "",.        tag=
-00012c30: 4e6f 6e65 2c0a 2020 2020 2020 2020 7569  None,.        ui
-00012c40: 643d 4e6f 6e65 2c0a 2020 2020 2020 2020  d=None,.        
-00012c50: 7061 7463 685f 6d6f 6465 3a20 556e 696f  patch_mode: Unio
-00012c60: 6e5b 0a20 2020 2020 2020 2020 2020 2073  n[.            s
-00012c70: 7472 2c20 6d6c 7275 6e2e 636f 6d6d 6f6e  tr, mlrun.common
-00012c80: 2e73 6368 656d 6173 2e50 6174 6368 4d6f  .schemas.PatchMo
-00012c90: 6465 0a20 2020 2020 2020 205d 203d 206d  de.        ] = m
-00012ca0: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
-00012cb0: 6d61 732e 5061 7463 684d 6f64 652e 7265  mas.PatchMode.re
-00012cc0: 706c 6163 652c 0a20 2020 2029 3a0a 2020  place,.    ):.  
-00012cd0: 2020 2020 2020 2222 224d 6f64 6966 7920        """Modify 
-00012ce0: 2870 6174 6368 2920 616e 2065 7869 7374  (patch) an exist
-00012cf0: 696e 6720 3a70 793a 636c 6173 733a 607e  ing :py:class:`~
-00012d00: 6d6c 7275 6e2e 6665 6174 7572 655f 7374  mlrun.feature_st
-00012d10: 6f72 652e 4665 6174 7572 6553 6574 6020  ore.FeatureSet` 
-00012d20: 6f62 6a65 6374 2e0a 2020 2020 2020 2020  object..        
-00012d30: 5468 6520 6f62 6a65 6374 2069 7320 6964  The object is id
-00012d40: 656e 7469 6669 6564 2062 7920 6974 7320  entified by its 
-00012d50: 6e61 6d65 2028 616e 6420 7072 6f6a 6563  name (and projec
-00012d60: 7420 6974 2062 656c 6f6e 6773 2074 6f29  t it belongs to)
-00012d70: 2c20 6173 2077 656c 6c20 6173 206f 7074  , as well as opt
-00012d80: 696f 6e61 6c6c 7920 6120 6060 7461 6760  ionally a ``tag`
-00012d90: 6020 6f72 2069 7473 0a20 2020 2020 2020  ` or its.       
-00012da0: 2060 6075 6964 6060 2028 666f 7220 7665   ``uid`` (for ve
-00012db0: 7273 696f 6e65 6420 6f62 6a65 6374 292e  rsioned object).
-00012dc0: 2049 6620 626f 7468 2060 6074 6167 6060   If both ``tag``
-00012dd0: 2061 6e64 2060 6075 6964 6060 2061 7265   and ``uid`` are
-00012de0: 206f 6d69 7474 6564 2074 6865 6e20 7468   omitted then th
-00012df0: 6520 6f62 6a65 6374 2077 6974 6820 7461  e object with ta
-00012e00: 6720 6060 6c61 7465 7374 6060 0a20 2020  g ``latest``.   
-00012e10: 2020 2020 2069 7320 6d6f 6469 6669 6564       is modified
-00012e20: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
-00012e30: 6d20 6e61 6d65 3a20 4e61 6d65 206f 6620  m name: Name of 
-00012e40: 7468 6520 6f62 6a65 6374 2074 6f20 7061  the object to pa
-00012e50: 7463 682e 0a20 2020 2020 2020 203a 7061  tch..        :pa
-00012e60: 7261 6d20 6665 6174 7572 655f 7365 745f  ram feature_set_
-00012e70: 7570 6461 7465 3a20 5468 6520 6d6f 6469  update: The modi
-00012e80: 6669 6361 7469 6f6e 7320 6e65 6564 6564  fications needed
-00012e90: 2069 6e20 7468 6520 6f62 6a65 6374 2e20   in the object. 
-00012ea0: 5468 6973 2070 6172 616d 6574 6572 206f  This parameter o
-00012eb0: 6e6c 7920 6861 7320 7468 6520 6368 616e  nly has the chan
-00012ec0: 6765 7320 696e 2069 742c 0a20 2020 2020  ges in it,.     
-00012ed0: 2020 2020 2020 206e 6f74 2061 2066 756c         not a ful
-00012ee0: 6c20 6f62 6a65 6374 2e0a 2020 2020 2020  l object..      
-00012ef0: 2020 2020 2020 4578 616d 706c 653a 3a0a        Example::.
-00012f00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00012f10: 2066 6561 7475 7265 5f73 6574 5f75 7064   feature_set_upd
-00012f20: 6174 6520 3d20 7b22 7374 6174 7573 223a  ate = {"status":
-00012f30: 207b 2270 726f 6365 7373 6564 2220 3a20   {"processed" : 
-00012f40: 5472 7565 7d7d 0a0a 2020 2020 2020 2020  True}}..        
-00012f50: 2020 2020 5769 6c6c 2061 7070 6c79 2074      Will apply t
-00012f60: 6865 2066 6965 6c64 2060 6073 7461 7475  he field ``statu
-00012f70: 732e 7072 6f63 6573 7365 6460 6020 746f  s.processed`` to
-00012f80: 2074 6865 2065 7869 7374 696e 6720 6f62   the existing ob
-00012f90: 6a65 6374 2e0a 2020 2020 2020 2020 3a70  ject..        :p
-00012fa0: 6172 616d 2070 726f 6a65 6374 3a20 5072  aram project: Pr
-00012fb0: 6f6a 6563 7420 7768 6963 6820 636f 6e74  oject which cont
-00012fc0: 6169 6e73 2074 6865 206d 6f64 6966 6965  ains the modifie
-00012fd0: 6420 6f62 6a65 6374 2e0a 2020 2020 2020  d object..      
-00012fe0: 2020 3a70 6172 616d 2074 6167 3a20 5468    :param tag: Th
-00012ff0: 6520 7461 6720 6f66 2074 6865 206f 626a  e tag of the obj
-00013000: 6563 7420 746f 206d 6f64 6966 792e 0a20  ect to modify.. 
-00013010: 2020 2020 2020 203a 7061 7261 6d20 7569         :param ui
-00013020: 643a 2075 6964 206f 6620 7468 6520 6f62  d: uid of the ob
-00013030: 6a65 6374 2074 6f20 6d6f 6469 6679 2e0a  ject to modify..
-00013040: 2020 2020 2020 2020 3a70 6172 616d 2070          :param p
-00013050: 6174 6368 5f6d 6f64 653a 2054 6865 2073  atch_mode: The s
-00013060: 7472 6174 6567 7920 666f 7220 6d65 7267  trategy for merg
-00013070: 696e 6720 7468 6520 6368 616e 6765 7320  ing the changes 
-00013080: 7769 7468 2074 6865 2065 7869 7374 696e  with the existin
-00013090: 6720 6f62 6a65 6374 2e20 4361 6e20 6265  g object. Can be
-000130a0: 2065 6974 6865 7220 6060 7265 706c 6163   either ``replac
-000130b0: 6560 600a 2020 2020 2020 2020 2020 2020  e``.            
-000130c0: 6f72 2060 6061 6464 6974 6976 6560 602e  or ``additive``.
-000130d0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-000130e0: 2020 2020 2070 726f 6a65 6374 203d 2070       project = p
-000130f0: 726f 6a65 6374 206f 7220 636f 6e66 6967  roject or config
-00013100: 2e64 6566 6175 6c74 5f70 726f 6a65 6374  .default_project
-00013110: 0a20 2020 2020 2020 2072 6566 6572 656e  .        referen
-00013120: 6365 203d 2073 656c 662e 5f72 6573 6f6c  ce = self._resol
-00013130: 7665 5f72 6566 6572 656e 6365 2874 6167  ve_reference(tag
-00013140: 2c20 7569 6429 0a20 2020 2020 2020 2068  , uid).        h
-00013150: 6561 6465 7273 203d 207b 6d6c 7275 6e2e  eaders = {mlrun.
-00013160: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e48  common.schemas.H
-00013170: 6561 6465 724e 616d 6573 2e70 6174 6368  eaderNames.patch
-00013180: 5f6d 6f64 653a 2070 6174 6368 5f6d 6f64  _mode: patch_mod
-00013190: 657d 0a20 2020 2020 2020 2070 6174 6820  e}.        path 
-000131a0: 3d20 6622 7072 6f6a 6563 7473 2f7b 7072  = f"projects/{pr
-000131b0: 6f6a 6563 747d 2f66 6561 7475 7265 2d73  oject}/feature-s
-000131c0: 6574 732f 7b6e 616d 657d 2f72 6566 6572  ets/{name}/refer
-000131d0: 656e 6365 732f 7b72 6566 6572 656e 6365  ences/{reference
-000131e0: 7d22 0a20 2020 2020 2020 2065 7272 6f72  }".        error
-000131f0: 5f6d 6573 7361 6765 203d 2066 2246 6169  _message = f"Fai
-00013200: 6c65 6420 7570 6461 7469 6e67 2066 6561  led updating fea
-00013210: 7475 7265 2d73 6574 207b 7072 6f6a 6563  ture-set {projec
-00013220: 747d 2f7b 6e61 6d65 7d22 0a20 2020 2020  t}/{name}".     
-00013230: 2020 2073 656c 662e 6170 695f 6361 6c6c     self.api_call
-00013240: 280a 2020 2020 2020 2020 2020 2020 2250  (.            "P
-00013250: 4154 4348 222c 0a20 2020 2020 2020 2020  ATCH",.         
-00013260: 2020 2070 6174 682c 0a20 2020 2020 2020     path,.       
-00013270: 2020 2020 2065 7272 6f72 5f6d 6573 7361       error_messa
-00013280: 6765 2c0a 2020 2020 2020 2020 2020 2020  ge,.            
-00013290: 626f 6479 3d64 6963 745f 746f 5f6a 736f  body=dict_to_jso
-000132a0: 6e28 6665 6174 7572 655f 7365 745f 7570  n(feature_set_up
-000132b0: 6461 7465 292c 0a20 2020 2020 2020 2020  date),.         
-000132c0: 2020 2068 6561 6465 7273 3d68 6561 6465     headers=heade
-000132d0: 7273 2c0a 2020 2020 2020 2020 290a 0a20  rs,.        ).. 
-000132e0: 2020 2064 6566 2064 656c 6574 655f 6665     def delete_fe
-000132f0: 6174 7572 655f 7365 7428 7365 6c66 2c20  ature_set(self, 
-00013300: 6e61 6d65 2c20 7072 6f6a 6563 743d 2222  name, project=""
-00013310: 2c20 7461 673d 4e6f 6e65 2c20 7569 643d  , tag=None, uid=
-00013320: 4e6f 6e65 293a 0a20 2020 2020 2020 2022  None):.        "
-00013330: 2222 4465 6c65 7465 2061 203a 7079 3a63  ""Delete a :py:c
-00013340: 6c61 7373 3a60 7e6d 6c72 756e 2e66 6561  lass:`~mlrun.fea
-00013350: 7475 7265 5f73 746f 7265 2e46 6561 7475  ture_store.Featu
-00013360: 7265 5365 7460 206f 626a 6563 7420 6672  reSet` object fr
-00013370: 6f6d 2074 6865 2044 422e 0a20 2020 2020  om the DB..     
-00013380: 2020 2049 6620 6060 7461 6760 6020 6f72     If ``tag`` or
-00013390: 2060 6075 6964 6060 2061 7265 2073 7065   ``uid`` are spe
-000133a0: 6369 6669 6564 2c20 7468 656e 206a 7573  cified, then jus
-000133b0: 7420 7468 6520 7665 7273 696f 6e20 7265  t the version re
-000133c0: 6665 7265 6e63 6564 2062 7920 7468 656d  ferenced by them
-000133d0: 2077 696c 6c20 6265 2064 656c 6574 6564   will be deleted
-000133e0: 2e20 5573 696e 6720 626f 7468 0a20 2020  . Using both.   
-000133f0: 2020 2020 2069 7320 6e6f 7420 616c 6c6f       is not allo
-00013400: 7765 642e 0a20 2020 2020 2020 2049 6620  wed..        If 
-00013410: 6e6f 6e65 2061 7265 2073 7065 6369 6669  none are specifi
-00013420: 6564 2c20 7468 656e 2061 6c6c 2069 6e73  ed, then all ins
-00013430: 7461 6e63 6573 206f 6620 7468 6520 6f62  tances of the ob
-00013440: 6a65 6374 2077 686f 7365 206e 616d 6520  ject whose name 
-00013450: 6973 2060 606e 616d 6560 6020 7769 6c6c  is ``name`` will
-00013460: 2062 6520 6465 6c65 7465 642e 0a20 2020   be deleted..   
-00013470: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00013480: 2070 726f 6a65 6374 203d 2070 726f 6a65   project = proje
-00013490: 6374 206f 7220 636f 6e66 6967 2e64 6566  ct or config.def
-000134a0: 6175 6c74 5f70 726f 6a65 6374 0a20 2020  ault_project.   
-000134b0: 2020 2020 2070 6174 6820 3d20 6622 7072       path = f"pr
-000134c0: 6f6a 6563 7473 2f7b 7072 6f6a 6563 747d  ojects/{project}
-000134d0: 2f66 6561 7475 7265 2d73 6574 732f 7b6e  /feature-sets/{n
-000134e0: 616d 657d 220a 0a20 2020 2020 2020 2069  ame}"..        i
-000134f0: 6620 7461 6720 6f72 2075 6964 3a0a 2020  f tag or uid:.  
-00013500: 2020 2020 2020 2020 2020 7265 6665 7265            refere
-00013510: 6e63 6520 3d20 7365 6c66 2e5f 7265 736f  nce = self._reso
-00013520: 6c76 655f 7265 6665 7265 6e63 6528 7461  lve_reference(ta
-00013530: 672c 2075 6964 290a 2020 2020 2020 2020  g, uid).        
-00013540: 2020 2020 7061 7468 203d 2070 6174 6820      path = path 
-00013550: 2b20 6622 2f72 6566 6572 656e 6365 732f  + f"/references/
-00013560: 7b72 6566 6572 656e 6365 7d22 0a0a 2020  {reference}"..  
-00013570: 2020 2020 2020 6572 726f 725f 6d65 7373        error_mess
-00013580: 6167 6520 3d20 6622 4661 696c 6564 2064  age = f"Failed d
-00013590: 656c 6574 696e 6720 6665 6174 7572 652d  eleting feature-
-000135a0: 7365 7420 7b6e 616d 657d 220a 2020 2020  set {name}".    
-000135b0: 2020 2020 7365 6c66 2e61 7069 5f63 616c      self.api_cal
-000135c0: 6c28 2244 454c 4554 4522 2c20 7061 7468  l("DELETE", path
-000135d0: 2c20 6572 726f 725f 6d65 7373 6167 6529  , error_message)
-000135e0: 0a0a 2020 2020 6465 6620 6372 6561 7465  ..    def create
-000135f0: 5f66 6561 7475 7265 5f76 6563 746f 7228  _feature_vector(
-00013600: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-00013610: 2020 2020 2020 2066 6561 7475 7265 5f76         feature_v
-00013620: 6563 746f 723a 2055 6e69 6f6e 5b64 6963  ector: Union[dic
-00013630: 742c 206d 6c72 756e 2e63 6f6d 6d6f 6e2e  t, mlrun.common.
-00013640: 7363 6865 6d61 732e 4665 6174 7572 6556  schemas.FeatureV
-00013650: 6563 746f 722c 2046 6561 7475 7265 5665  ector, FeatureVe
-00013660: 6374 6f72 5d2c 0a20 2020 2020 2020 2070  ctor],.        p
-00013670: 726f 6a65 6374 3d22 222c 0a20 2020 2020  roject="",.     
-00013680: 2020 2076 6572 7369 6f6e 6564 3d54 7275     versioned=Tru
-00013690: 652c 0a20 2020 2029 202d 3e20 6469 6374  e,.    ) -> dict
-000136a0: 3a0a 2020 2020 2020 2020 2222 2243 7265  :.        """Cre
-000136b0: 6174 6520 6120 6e65 7720 3a70 793a 636c  ate a new :py:cl
-000136c0: 6173 733a 607e 6d6c 7275 6e2e 6665 6174  ass:`~mlrun.feat
-000136d0: 7572 655f 7374 6f72 652e 4665 6174 7572  ure_store.Featur
-000136e0: 6556 6563 746f 7260 2061 6e64 2073 6176  eVector` and sav
-000136f0: 6520 696e 2074 6865 203a 7079 3a6d 6f64  e in the :py:mod
-00013700: 3a60 6d6c 7275 6e60 2044 422e 0a0a 2020  :`mlrun` DB...  
-00013710: 2020 2020 2020 3a70 6172 616d 2066 6561        :param fea
-00013720: 7475 7265 5f76 6563 746f 723a 2054 6865  ture_vector: The
-00013730: 206e 6577 203a 7079 3a63 6c61 7373 3a60   new :py:class:`
-00013740: 7e6d 6c72 756e 2e66 6561 7475 7265 5f73  ~mlrun.feature_s
-00013750: 746f 7265 2e46 6561 7475 7265 5665 6374  tore.FeatureVect
-00013760: 6f72 6020 746f 2063 7265 6174 652e 0a20  or` to create.. 
-00013770: 2020 2020 2020 203a 7061 7261 6d20 7072         :param pr
-00013780: 6f6a 6563 743a 204e 616d 6520 6f66 2070  oject: Name of p
-00013790: 726f 6a65 6374 2074 6869 7320 6665 6174  roject this feat
-000137a0: 7572 652d 7665 6374 6f72 2062 656c 6f6e  ure-vector belon
-000137b0: 6773 2074 6f2e 0a20 2020 2020 2020 203a  gs to..        :
-000137c0: 7061 7261 6d20 7665 7273 696f 6e65 643a  param versioned:
-000137d0: 2057 6865 7468 6572 2074 6f20 6d61 696e   Whether to main
-000137e0: 7461 696e 2076 6572 7369 6f6e 7320 666f  tain versions fo
-000137f0: 7220 7468 6973 2066 6561 7475 7265 2d76  r this feature-v
-00013800: 6563 746f 722e 2041 6c6c 2076 6572 7369  ector. All versi
-00013810: 6f6e 7320 6f66 2061 2076 6572 7369 6f6e  ons of a version
-00013820: 6564 206f 626a 6563 740a 2020 2020 2020  ed object.      
-00013830: 2020 2020 2020 7769 6c6c 2062 6520 6b65        will be ke
-00013840: 7074 2069 6e20 7468 6520 4442 2061 6e64  pt in the DB and
-00013850: 2063 616e 2062 6520 7265 7472 6965 7665   can be retrieve
-00013860: 6420 756e 7469 6c20 6578 706c 6963 6974  d until explicit
-00013870: 6c79 2064 656c 6574 6564 2e0a 2020 2020  ly deleted..    
-00013880: 2020 2020 3a72 6574 7572 6e73 3a20 5468      :returns: Th
-00013890: 6520 3a70 793a 636c 6173 733a 607e 6d6c  e :py:class:`~ml
-000138a0: 7275 6e2e 6665 6174 7572 655f 7374 6f72  run.feature_stor
-000138b0: 652e 4665 6174 7572 6556 6563 746f 7260  e.FeatureVector`
-000138c0: 206f 626a 6563 7420 2861 7320 6469 6374   object (as dict
-000138d0: 292e 0a20 2020 2020 2020 2022 2222 0a20  )..        """. 
-000138e0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-000138f0: 616e 6365 2866 6561 7475 7265 5f76 6563  ance(feature_vec
-00013900: 746f 722c 206d 6c72 756e 2e63 6f6d 6d6f  tor, mlrun.commo
-00013910: 6e2e 7363 6865 6d61 732e 4665 6174 7572  n.schemas.Featur
-00013920: 6556 6563 746f 7229 3a0a 2020 2020 2020  eVector):.      
-00013930: 2020 2020 2020 6665 6174 7572 655f 7665        feature_ve
-00013940: 6374 6f72 203d 2066 6561 7475 7265 5f76  ctor = feature_v
-00013950: 6563 746f 722e 6469 6374 2829 0a20 2020  ector.dict().   
-00013960: 2020 2020 2065 6c69 6620 6973 696e 7374       elif isinst
-00013970: 616e 6365 2866 6561 7475 7265 5f76 6563  ance(feature_vec
-00013980: 746f 722c 2046 6561 7475 7265 5665 6374  tor, FeatureVect
-00013990: 6f72 293a 0a20 2020 2020 2020 2020 2020  or):.           
-000139a0: 2066 6561 7475 7265 5f76 6563 746f 7220   feature_vector 
-000139b0: 3d20 6665 6174 7572 655f 7665 6374 6f72  = feature_vector
-000139c0: 2e74 6f5f 6469 6374 2829 0a0a 2020 2020  .to_dict()..    
-000139d0: 2020 2020 7072 6f6a 6563 7420 3d20 280a      project = (.
-000139e0: 2020 2020 2020 2020 2020 2020 7072 6f6a              proj
-000139f0: 6563 740a 2020 2020 2020 2020 2020 2020  ect.            
-00013a00: 6f72 2066 6561 7475 7265 5f76 6563 746f  or feature_vecto
-00013a10: 725b 226d 6574 6164 6174 6122 5d2e 6765  r["metadata"].ge
-00013a20: 7428 2270 726f 6a65 6374 222c 204e 6f6e  t("project", Non
-00013a30: 6529 0a20 2020 2020 2020 2020 2020 206f  e).            o
-00013a40: 7220 636f 6e66 6967 2e64 6566 6175 6c74  r config.default
-00013a50: 5f70 726f 6a65 6374 0a20 2020 2020 2020  _project.       
-00013a60: 2029 0a20 2020 2020 2020 2070 6174 6820   ).        path 
-00013a70: 3d20 6622 7072 6f6a 6563 7473 2f7b 7072  = f"projects/{pr
-00013a80: 6f6a 6563 747d 2f66 6561 7475 7265 2d76  oject}/feature-v
-00013a90: 6563 746f 7273 220a 2020 2020 2020 2020  ectors".        
-00013aa0: 7061 7261 6d73 203d 207b 2276 6572 7369  params = {"versi
-00013ab0: 6f6e 6564 223a 2076 6572 7369 6f6e 6564  oned": versioned
-00013ac0: 7d0a 0a20 2020 2020 2020 206e 616d 6520  }..        name 
-00013ad0: 3d20 6665 6174 7572 655f 7665 6374 6f72  = feature_vector
-00013ae0: 5b22 6d65 7461 6461 7461 225d 5b22 6e61  ["metadata"]["na
-00013af0: 6d65 225d 0a20 2020 2020 2020 2065 7272  me"].        err
-00013b00: 6f72 5f6d 6573 7361 6765 203d 2066 2246  or_message = f"F
-00013b10: 6169 6c65 6420 6372 6561 7469 6e67 2066  ailed creating f
-00013b20: 6561 7475 7265 2d76 6563 746f 7220 7b70  eature-vector {p
-00013b30: 726f 6a65 6374 7d2f 7b6e 616d 657d 220a  roject}/{name}".
-00013b40: 2020 2020 2020 2020 7265 7370 203d 2073          resp = s
-00013b50: 656c 662e 6170 695f 6361 6c6c 280a 2020  elf.api_call(.  
-00013b60: 2020 2020 2020 2020 2020 2250 4f53 5422            "POST"
-00013b70: 2c0a 2020 2020 2020 2020 2020 2020 7061  ,.            pa
-00013b80: 7468 2c0a 2020 2020 2020 2020 2020 2020  th,.            
-00013b90: 6572 726f 725f 6d65 7373 6167 652c 0a20  error_message,. 
-00013ba0: 2020 2020 2020 2020 2020 2070 6172 616d             param
-00013bb0: 733d 7061 7261 6d73 2c0a 2020 2020 2020  s=params,.      
-00013bc0: 2020 2020 2020 626f 6479 3d64 6963 745f        body=dict_
-00013bd0: 746f 5f6a 736f 6e28 6665 6174 7572 655f  to_json(feature_
-00013be0: 7665 6374 6f72 292c 0a20 2020 2020 2020  vector),.       
-00013bf0: 2029 0a20 2020 2020 2020 2072 6574 7572   ).        retur
-00013c00: 6e20 7265 7370 2e6a 736f 6e28 290a 0a20  n resp.json().. 
-00013c10: 2020 2064 6566 2067 6574 5f66 6561 7475     def get_featu
-00013c20: 7265 5f76 6563 746f 7228 0a20 2020 2020  re_vector(.     
-00013c30: 2020 2073 656c 662c 206e 616d 653a 2073     self, name: s
-00013c40: 7472 2c20 7072 6f6a 6563 743a 2073 7472  tr, project: str
-00013c50: 203d 2022 222c 2074 6167 3a20 7374 7220   = "", tag: str 
-00013c60: 3d20 4e6f 6e65 2c20 7569 643a 2073 7472  = None, uid: str
-00013c70: 203d 204e 6f6e 650a 2020 2020 2920 2d3e   = None.    ) ->
-00013c80: 2046 6561 7475 7265 5665 6374 6f72 3a0a   FeatureVector:.
-00013c90: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
-00013ca0: 6e20 6120 7370 6563 6966 6963 2066 6561  n a specific fea
-00013cb0: 7475 7265 2d76 6563 746f 7220 7265 6665  ture-vector refe
-00013cc0: 7265 6e63 6564 2062 7920 6974 7320 7461  renced by its ta
-00013cd0: 6720 6f72 2075 6964 2e20 4966 206e 6f6e  g or uid. If non
-00013ce0: 6520 6172 6520 7072 6f76 6964 6564 2c20  e are provided, 
-00013cf0: 6060 6c61 7465 7374 6060 2074 6167 2077  ``latest`` tag w
-00013d00: 696c 6c0a 2020 2020 2020 2020 6265 2075  ill.        be u
-00013d10: 7365 642e 2222 220a 0a20 2020 2020 2020  sed."""..       
-00013d20: 2070 726f 6a65 6374 203d 2070 726f 6a65   project = proje
-00013d30: 6374 206f 7220 636f 6e66 6967 2e64 6566  ct or config.def
-00013d40: 6175 6c74 5f70 726f 6a65 6374 0a20 2020  ault_project.   
-00013d50: 2020 2020 2072 6566 6572 656e 6365 203d       reference =
-00013d60: 2073 656c 662e 5f72 6573 6f6c 7665 5f72   self._resolve_r
-00013d70: 6566 6572 656e 6365 2874 6167 2c20 7569  eference(tag, ui
-00013d80: 6429 0a20 2020 2020 2020 2070 6174 6820  d).        path 
-00013d90: 3d20 6622 7072 6f6a 6563 7473 2f7b 7072  = f"projects/{pr
-00013da0: 6f6a 6563 747d 2f66 6561 7475 7265 2d76  oject}/feature-v
-00013db0: 6563 746f 7273 2f7b 6e61 6d65 7d2f 7265  ectors/{name}/re
-00013dc0: 6665 7265 6e63 6573 2f7b 7265 6665 7265  ferences/{refere
-00013dd0: 6e63 657d 220a 2020 2020 2020 2020 6572  nce}".        er
-00013de0: 726f 725f 6d65 7373 6167 6520 3d20 6622  ror_message = f"
-00013df0: 4661 696c 6564 2072 6574 7269 6576 696e  Failed retrievin
-00013e00: 6720 6665 6174 7572 652d 7665 6374 6f72  g feature-vector
-00013e10: 207b 7072 6f6a 6563 747d 2f7b 6e61 6d65   {project}/{name
-00013e20: 7d22 0a20 2020 2020 2020 2072 6573 7020  }".        resp 
-00013e30: 3d20 7365 6c66 2e61 7069 5f63 616c 6c28  = self.api_call(
-00013e40: 2247 4554 222c 2070 6174 682c 2065 7272  "GET", path, err
-00013e50: 6f72 5f6d 6573 7361 6765 290a 2020 2020  or_message).    
-00013e60: 2020 2020 7265 7475 726e 2046 6561 7475      return Featu
-00013e70: 7265 5665 6374 6f72 2e66 726f 6d5f 6469  reVector.from_di
-00013e80: 6374 2872 6573 702e 6a73 6f6e 2829 290a  ct(resp.json()).
-00013e90: 0a20 2020 2064 6566 206c 6973 745f 6665  .    def list_fe
-00013ea0: 6174 7572 655f 7665 6374 6f72 7328 0a20  ature_vectors(. 
-00013eb0: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-00013ec0: 2020 2020 2070 726f 6a65 6374 3a20 7374       project: st
-00013ed0: 7220 3d20 2222 2c0a 2020 2020 2020 2020  r = "",.        
-00013ee0: 6e61 6d65 3a20 7374 7220 3d20 4e6f 6e65  name: str = None
-00013ef0: 2c0a 2020 2020 2020 2020 7461 673a 2073  ,.        tag: s
-00013f00: 7472 203d 204e 6f6e 652c 0a20 2020 2020  tr = None,.     
-00013f10: 2020 2073 7461 7465 3a20 7374 7220 3d20     state: str = 
-00013f20: 4e6f 6e65 2c0a 2020 2020 2020 2020 6c61  None,.        la
-00013f30: 6265 6c73 3a20 4c69 7374 5b73 7472 5d20  bels: List[str] 
-00013f40: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-00013f50: 7061 7274 6974 696f 6e5f 6279 3a20 556e  partition_by: Un
-00013f60: 696f 6e5b 0a20 2020 2020 2020 2020 2020  ion[.           
-00013f70: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
-00013f80: 6865 6d61 732e 4665 6174 7572 6553 746f  hemas.FeatureSto
-00013f90: 7265 5061 7274 6974 696f 6e42 7946 6965  rePartitionByFie
-00013fa0: 6c64 2c20 7374 720a 2020 2020 2020 2020  ld, str.        
-00013fb0: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
-00013fc0: 2020 726f 7773 5f70 6572 5f70 6172 7469    rows_per_parti
-00013fd0: 7469 6f6e 3a20 696e 7420 3d20 312c 0a20  tion: int = 1,. 
-00013fe0: 2020 2020 2020 2070 6172 7469 7469 6f6e         partition
-00013ff0: 5f73 6f72 745f 6279 3a20 556e 696f 6e5b  _sort_by: Union[
-00014000: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
-00014010: 656d 6173 2e53 6f72 7446 6965 6c64 2c20  emas.SortField, 
-00014020: 7374 725d 203d 204e 6f6e 652c 0a20 2020  str] = None,.   
-00014030: 2020 2020 2070 6172 7469 7469 6f6e 5f6f       partition_o
-00014040: 7264 6572 3a20 556e 696f 6e5b 0a20 2020  rder: Union[.   
-00014050: 2020 2020 2020 2020 206d 6c72 756e 2e63           mlrun.c
-00014060: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 4f72  ommon.schemas.Or
-00014070: 6465 7254 7970 652c 2073 7472 0a20 2020  derType, str.   
-00014080: 2020 2020 205d 203d 206d 6c72 756e 2e63       ] = mlrun.c
-00014090: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 4f72  ommon.schemas.Or
-000140a0: 6465 7254 7970 652e 6465 7363 2c0a 2020  derType.desc,.  
-000140b0: 2020 2920 2d3e 204c 6973 745b 4665 6174    ) -> List[Feat
-000140c0: 7572 6556 6563 746f 725d 3a0a 2020 2020  ureVector]:.    
-000140d0: 2020 2020 2222 2252 6574 7269 6576 6520      """Retrieve 
-000140e0: 6120 6c69 7374 206f 6620 6665 6174 7572  a list of featur
-000140f0: 652d 7665 6374 6f72 7320 6d61 7463 6869  e-vectors matchi
-00014100: 6e67 2074 6865 2063 7269 7465 7269 6120  ng the criteria 
-00014110: 7072 6f76 6964 6564 2e0a 0a20 2020 2020  provided...     
-00014120: 2020 203a 7061 7261 6d20 7072 6f6a 6563     :param projec
-00014130: 743a 2050 726f 6a65 6374 206e 616d 652e  t: Project name.
-00014140: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00014150: 6e61 6d65 3a20 4e61 6d65 206f 6620 6665  name: Name of fe
-00014160: 6174 7572 652d 7665 6374 6f72 2074 6f20  ature-vector to 
-00014170: 6d61 7463 682e 2054 6869 7320 6973 2061  match. This is a
-00014180: 206c 696b 6520 7175 6572 792c 2061 6e64   like query, and
-00014190: 2069 7320 6361 7365 2d69 6e73 656e 7369   is case-insensi
-000141a0: 7469 7665 2e0a 2020 2020 2020 2020 3a70  tive..        :p
-000141b0: 6172 616d 2074 6167 3a20 4d61 7463 6820  aram tag: Match 
-000141c0: 6665 6174 7572 652d 7665 6374 6f72 7320  feature-vectors 
-000141d0: 7769 7468 2073 7065 6369 6669 6320 7461  with specific ta
-000141e0: 672e 0a20 2020 2020 2020 203a 7061 7261  g..        :para
-000141f0: 6d20 7374 6174 653a 204d 6174 6368 2066  m state: Match f
-00014200: 6561 7475 7265 2d76 6563 746f 7273 2077  eature-vectors w
-00014210: 6974 6820 6120 7370 6563 6966 6963 2073  ith a specific s
-00014220: 7461 7465 2e0a 2020 2020 2020 2020 3a70  tate..        :p
-00014230: 6172 616d 206c 6162 656c 733a 204d 6174  aram labels: Mat
-00014240: 6368 2066 6561 7475 7265 2d76 6563 746f  ch feature-vecto
-00014250: 7273 2077 6869 6368 2068 6176 6520 7468  rs which have th
-00014260: 6573 6520 6c61 6265 6c73 2e0a 2020 2020  ese labels..    
-00014270: 2020 2020 3a70 6172 616d 2070 6172 7469      :param parti
-00014280: 7469 6f6e 5f62 793a 2046 6965 6c64 2074  tion_by: Field t
-00014290: 6f20 6772 6f75 7020 7265 7375 6c74 7320  o group results 
-000142a0: 6279 2e20 4f6e 6c79 2061 6c6c 6f77 6564  by. Only allowed
-000142b0: 2076 616c 7565 2069 7320 606e 616d 6560   value is `name`
-000142c0: 2e20 5768 656e 2060 7061 7274 6974 696f  . When `partitio
-000142d0: 6e5f 6279 6020 6973 2073 7065 6369 6669  n_by` is specifi
-000142e0: 6564 2c0a 2020 2020 2020 2020 2020 2020  ed,.            
-000142f0: 7468 6520 6070 6172 7469 7469 6f6e 5f73  the `partition_s
-00014300: 6f72 745f 6279 6020 7061 7261 6d65 7465  ort_by` paramete
-00014310: 7220 6d75 7374 2062 6520 7072 6f76 6964  r must be provid
-00014320: 6564 2061 7320 7765 6c6c 2e0a 2020 2020  ed as well..    
-00014330: 2020 2020 3a70 6172 616d 2072 6f77 735f      :param rows_
-00014340: 7065 725f 7061 7274 6974 696f 6e3a 2048  per_partition: H
-00014350: 6f77 206d 616e 7920 746f 7020 726f 7773  ow many top rows
-00014360: 2028 7065 7220 736f 7274 696e 6720 6465   (per sorting de
-00014370: 6669 6e65 6420 6279 2060 7061 7274 6974  fined by `partit
-00014380: 696f 6e5f 736f 7274 5f62 7960 2061 6e64  ion_sort_by` and
-00014390: 2060 7061 7274 6974 696f 6e5f 6f72 6465   `partition_orde
-000143a0: 7260 290a 2020 2020 2020 2020 2020 2020  r`).            
-000143b0: 746f 2072 6574 7572 6e20 7065 7220 6772  to return per gr
-000143c0: 6f75 702e 2044 6566 6175 6c74 2076 616c  oup. Default val
-000143d0: 7565 2069 7320 312e 0a20 2020 2020 2020  ue is 1..       
-000143e0: 203a 7061 7261 6d20 7061 7274 6974 696f   :param partitio
-000143f0: 6e5f 736f 7274 5f62 793a 2057 6861 7420  n_sort_by: What 
-00014400: 6669 656c 6420 746f 2073 6f72 7420 7468  field to sort th
-00014410: 6520 7265 7375 6c74 7320 6279 2c20 7769  e results by, wi
-00014420: 7468 696e 2065 6163 6820 7061 7274 6974  thin each partit
-00014430: 696f 6e20 6465 6669 6e65 6420 6279 2060  ion defined by `
-00014440: 7061 7274 6974 696f 6e5f 6279 602e 0a20  partition_by`.. 
-00014450: 2020 2020 2020 2020 2020 2043 7572 7265             Curre
-00014460: 6e74 6c79 2074 6865 206f 6e6c 7920 616c  ntly the only al
-00014470: 6c6f 7765 6420 7661 6c75 6573 2061 7265  lowed values are
-00014480: 2060 6372 6561 7465 6460 2061 6e64 2060   `created` and `
-00014490: 7570 6461 7465 6460 2e0a 2020 2020 2020  updated`..      
-000144a0: 2020 3a70 6172 616d 2070 6172 7469 7469    :param partiti
-000144b0: 6f6e 5f6f 7264 6572 3a20 4f72 6465 7220  on_order: Order 
-000144c0: 6f66 2073 6f72 7469 6e67 2077 6974 6869  of sorting withi
-000144d0: 6e20 7061 7274 6974 696f 6e73 202d 2060  n partitions - `
-000144e0: 6173 6360 206f 7220 6064 6573 6360 2e20  asc` or `desc`. 
-000144f0: 4465 6661 756c 7420 6973 2060 6465 7363  Default is `desc
-00014500: 602e 0a20 2020 2020 2020 203a 7265 7475  `..        :retu
-00014510: 726e 733a 204c 6973 7420 6f66 206d 6174  rns: List of mat
-00014520: 6368 696e 6720 3a70 793a 636c 6173 733a  ching :py:class:
-00014530: 607e 6d6c 7275 6e2e 6665 6174 7572 655f  `~mlrun.feature_
-00014540: 7374 6f72 652e 4665 6174 7572 6556 6563  store.FeatureVec
-00014550: 746f 7260 206f 626a 6563 7473 2e0a 2020  tor` objects..  
-00014560: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
-00014570: 2020 2070 726f 6a65 6374 203d 2070 726f     project = pro
-00014580: 6a65 6374 206f 7220 636f 6e66 6967 2e64  ject or config.d
-00014590: 6566 6175 6c74 5f70 726f 6a65 6374 0a0a  efault_project..
-000145a0: 2020 2020 2020 2020 7061 7261 6d73 203d          params =
-000145b0: 207b 0a20 2020 2020 2020 2020 2020 2022   {.            "
-000145c0: 6e61 6d65 223a 206e 616d 652c 0a20 2020  name": name,.   
-000145d0: 2020 2020 2020 2020 2022 7374 6174 6522           "state"
-000145e0: 3a20 7374 6174 652c 0a20 2020 2020 2020  : state,.       
-000145f0: 2020 2020 2022 7461 6722 3a20 7461 672c       "tag": tag,
-00014600: 0a20 2020 2020 2020 2020 2020 2022 6c61  .            "la
-00014610: 6265 6c22 3a20 6c61 6265 6c73 206f 7220  bel": labels or 
-00014620: 5b5d 2c0a 2020 2020 2020 2020 7d0a 2020  [],.        }.  
-00014630: 2020 2020 2020 6966 2070 6172 7469 7469        if partiti
-00014640: 6f6e 5f62 793a 0a20 2020 2020 2020 2020  on_by:.         
-00014650: 2020 2070 6172 616d 732e 7570 6461 7465     params.update
-00014660: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00014670: 2020 7365 6c66 2e5f 6765 6e65 7261 7465    self._generate
-00014680: 5f70 6172 7469 7469 6f6e 5f62 795f 7061  _partition_by_pa
-00014690: 7261 6d73 280a 2020 2020 2020 2020 2020  rams(.          
-000146a0: 2020 2020 2020 2020 2020 6d6c 7275 6e2e            mlrun.
-000146b0: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e46  common.schemas.F
-000146c0: 6561 7475 7265 5374 6f72 6550 6172 7469  eatureStoreParti
-000146d0: 7469 6f6e 4279 4669 656c 642c 0a20 2020  tionByField,.   
-000146e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000146f0: 2070 6172 7469 7469 6f6e 5f62 792c 0a20   partition_by,. 
-00014700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014710: 2020 2072 6f77 735f 7065 725f 7061 7274     rows_per_part
-00014720: 6974 696f 6e2c 0a20 2020 2020 2020 2020  ition,.         
-00014730: 2020 2020 2020 2020 2020 2070 6172 7469             parti
-00014740: 7469 6f6e 5f73 6f72 745f 6279 2c0a 2020  tion_sort_by,.  
+0000c8a0: 2020 206f 6666 7365 743a 2069 6e74 203d     offset: int =
+0000c8b0: 2030 2c0a 2020 2020 2020 2020 6c6f 6773   0,.        logs
+0000c8c0: 3a20 626f 6f6c 203d 2054 7275 652c 0a20  : bool = True,. 
+0000c8d0: 2020 2020 2020 206c 6173 745f 6c6f 675f         last_log_
+0000c8e0: 7469 6d65 7374 616d 703a 2066 6c6f 6174  timestamp: float
+0000c8f0: 203d 2030 2e30 2c0a 2020 2020 2020 2020   = 0.0,.        
+0000c900: 7665 7262 6f73 653a 2062 6f6f 6c20 3d20  verbose: bool = 
+0000c910: 4661 6c73 652c 0a20 2020 2029 3a0a 2020  False,.    ):.  
+0000c920: 2020 2020 2020 2222 2252 6574 7269 6576        """Retriev
+0000c930: 6520 7468 6520 7374 6174 7573 206f 6620  e the status of 
+0000c940: 6120 6275 696c 6420 6f70 6572 6174 696f  a build operatio
+0000c950: 6e20 6375 7272 656e 746c 7920 696e 2070  n currently in p
+0000c960: 726f 6772 6573 732e 0a0a 2020 2020 2020  rogress...      
+0000c970: 2020 3a70 6172 616d 2066 756e 633a 2020    :param func:  
+0000c980: 2020 2020 2020 2020 2020 2020 2020 4675                Fu
+0000c990: 6e63 7469 6f6e 206f 626a 6563 7420 7468  nction object th
+0000c9a0: 6174 2069 7320 6265 696e 6720 6275 696c  at is being buil
+0000c9b0: 742e 0a20 2020 2020 2020 203a 7061 7261  t..        :para
+0000c9c0: 6d20 6f66 6673 6574 3a20 2020 2020 2020  m offset:       
+0000c9d0: 2020 2020 2020 204f 6666 7365 7420 696e         Offset in
+0000c9e0: 746f 2074 6865 2062 7569 6c64 206c 6f67  to the build log
+0000c9f0: 7320 746f 2072 6574 7269 6576 6520 6c6f  s to retrieve lo
+0000ca00: 6773 2066 726f 6d2e 0a20 2020 2020 2020  gs from..       
+0000ca10: 203a 7061 7261 6d20 6c6f 6773 3a20 2020   :param logs:   
+0000ca20: 2020 2020 2020 2020 2020 2020 2053 686f               Sho
+0000ca30: 756c 6420 6275 696c 6420 6c6f 6773 2062  uld build logs b
+0000ca40: 6520 7265 7472 6965 7665 642e 0a20 2020  e retrieved..   
+0000ca50: 2020 2020 203a 7061 7261 6d20 6c61 7374       :param last
+0000ca60: 5f6c 6f67 5f74 696d 6573 7461 6d70 3a20  _log_timestamp: 
+0000ca70: 204c 6173 7420 7469 6d65 7374 616d 7020   Last timestamp 
+0000ca80: 6f66 206c 6f67 7320 7468 6174 2077 6572  of logs that wer
+0000ca90: 6520 616c 7265 6164 7920 7265 7472 6965  e already retrie
+0000caa0: 7665 642e 2046 756e 6374 696f 6e20 7769  ved. Function wi
+0000cab0: 6c6c 2072 6574 7572 6e20 6f6e 6c79 206c  ll return only l
+0000cac0: 6f67 730a 2020 2020 2020 2020 2020 2020  ogs.            
+0000cad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cae0: 2020 2020 2020 2020 6c61 7465 7220 7468          later th
+0000caf0: 616e 2074 6869 7320 7061 7261 6d65 7465  an this paramete
+0000cb00: 722e 0a20 2020 2020 2020 203a 7061 7261  r..        :para
+0000cb10: 6d20 7665 7262 6f73 653a 2020 2020 2020  m verbose:      
+0000cb20: 2020 2020 2020 2041 6464 2076 6572 626f         Add verbo
+0000cb30: 7365 206c 6f67 7320 696e 746f 2074 6865  se logs into the
+0000cb40: 206f 7574 7075 742e 0a0a 2020 2020 2020   output...      
+0000cb50: 2020 3a72 6574 7572 6e73 3a20 5468 6520    :returns: The 
+0000cb60: 666f 6c6c 6f77 696e 6720 7061 7261 6d65  following parame
+0000cb70: 7465 7273 3a0a 0a20 2020 2020 2020 2020  ters:..         
+0000cb80: 2020 202d 2054 6578 7420 6f66 2062 7569     - Text of bui
+0000cb90: 6c64 6572 206c 6f67 732e 0a20 2020 2020  lder logs..     
+0000cba0: 2020 2020 2020 202d 2054 696d 6573 7461         - Timesta
+0000cbb0: 6d70 206f 6620 6c61 7374 206c 6f67 2072  mp of last log r
+0000cbc0: 6574 7269 6576 6564 2c20 746f 2062 6520  etrieved, to be 
+0000cbd0: 7573 6564 2069 6e20 7375 6273 6571 7565  used in subseque
+0000cbe0: 6e74 2063 616c 6c73 2074 6f20 7468 6973  nt calls to this
+0000cbf0: 2066 756e 6374 696f 6e2e 0a0a 2020 2020   function...    
+0000cc00: 2020 2020 2020 2020 5468 6520 6675 6e63          The func
+0000cc10: 7469 6f6e 2061 6c73 6f20 7570 6461 7465  tion also update
+0000cc20: 7320 696e 7465 726e 616c 206d 656d 6265  s internal membe
+0000cc30: 7273 206f 6620 7468 6520 6060 6675 6e63  rs of the ``func
+0000cc40: 6060 206f 626a 6563 7420 746f 2072 6566  `` object to ref
+0000cc50: 6c65 6374 2062 7569 6c64 2070 726f 6365  lect build proce
+0000cc60: 7373 2069 6e66 6f2e 0a20 2020 2020 2020  ss info..       
+0000cc70: 2022 2222 0a0a 2020 2020 2020 2020 7472   """..        tr
+0000cc80: 793a 0a20 2020 2020 2020 2020 2020 2070  y:.            p
+0000cc90: 6172 616d 7320 3d20 7b0a 2020 2020 2020  arams = {.      
+0000cca0: 2020 2020 2020 2020 2020 226e 616d 6522            "name"
+0000ccb0: 3a20 6e6f 726d 616c 697a 655f 6e61 6d65  : normalize_name
+0000ccc0: 2866 756e 632e 6d65 7461 6461 7461 2e6e  (func.metadata.n
+0000ccd0: 616d 6529 2c0a 2020 2020 2020 2020 2020  ame),.          
+0000cce0: 2020 2020 2020 2270 726f 6a65 6374 223a        "project":
+0000ccf0: 2066 756e 632e 6d65 7461 6461 7461 2e70   func.metadata.p
+0000cd00: 726f 6a65 6374 2c0a 2020 2020 2020 2020  roject,.        
+0000cd10: 2020 2020 2020 2020 2274 6167 223a 2066          "tag": f
+0000cd20: 756e 632e 6d65 7461 6461 7461 2e74 6167  unc.metadata.tag
+0000cd30: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000cd40: 2020 226c 6f67 7322 3a20 626f 6f6c 3273    "logs": bool2s
+0000cd50: 7472 286c 6f67 7329 2c0a 2020 2020 2020  tr(logs),.      
+0000cd60: 2020 2020 2020 2020 2020 226f 6666 7365            "offse
+0000cd70: 7422 3a20 7374 7228 6f66 6673 6574 292c  t": str(offset),
+0000cd80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000cd90: 2022 6c61 7374 5f6c 6f67 5f74 696d 6573   "last_log_times
+0000cda0: 7461 6d70 223a 2073 7472 286c 6173 745f  tamp": str(last_
+0000cdb0: 6c6f 675f 7469 6d65 7374 616d 7029 2c0a  log_timestamp),.
+0000cdc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cdd0: 2276 6572 626f 7365 223a 2062 6f6f 6c32  "verbose": bool2
+0000cde0: 7374 7228 7665 7262 6f73 6529 2c0a 2020  str(verbose),.  
+0000cdf0: 2020 2020 2020 2020 2020 7d0a 2020 2020            }.    
+0000ce00: 2020 2020 2020 2020 7265 7370 203d 2073          resp = s
+0000ce10: 656c 662e 6170 695f 6361 6c6c 2822 4745  elf.api_call("GE
+0000ce20: 5422 2c20 2262 7569 6c64 2f73 7461 7475  T", "build/statu
+0000ce30: 7322 2c20 7061 7261 6d73 3d70 6172 616d  s", params=param
+0000ce40: 7329 0a20 2020 2020 2020 2065 7863 6570  s).        excep
+0000ce50: 7420 4f53 4572 726f 7220 6173 2065 7272  t OSError as err
+0000ce60: 3a0a 2020 2020 2020 2020 2020 2020 6c6f  :.            lo
+0000ce70: 6767 6572 2e65 7272 6f72 2866 2265 7272  gger.error(f"err
+0000ce80: 6f72 2067 6574 7469 6e67 2062 7569 6c64  or getting build
+0000ce90: 2073 7461 7475 733a 207b 6572 725f 746f   status: {err_to
+0000cea0: 5f73 7472 2865 7272 297d 2229 0a20 2020  _str(err)}").   
+0000ceb0: 2020 2020 2020 2020 2072 6169 7365 204f           raise O
+0000cec0: 5345 7272 6f72 2866 2265 7272 6f72 3a20  SError(f"error: 
+0000ced0: 6361 6e6e 6f74 2067 6574 2062 7569 6c64  cannot get build
+0000cee0: 2073 7461 7475 732c 207b 6572 725f 746f   status, {err_to
+0000cef0: 5f73 7472 2865 7272 297d 2229 0a0a 2020  _str(err)}")..  
+0000cf00: 2020 2020 2020 6966 206e 6f74 2072 6573        if not res
+0000cf10: 702e 6f6b 3a0a 2020 2020 2020 2020 2020  p.ok:.          
+0000cf20: 2020 6c6f 6767 6572 2e77 6172 6e69 6e67    logger.warning
+0000cf30: 2866 2266 6169 6c65 6420 7265 7370 2c20  (f"failed resp, 
+0000cf40: 7b72 6573 702e 7465 7874 7d22 290a 2020  {resp.text}").  
+0000cf50: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0000cf60: 5275 6e44 4245 7272 6f72 2822 6261 6420  RunDBError("bad 
+0000cf70: 6675 6e63 7469 6f6e 2062 7569 6c64 2072  function build r
+0000cf80: 6573 706f 6e73 6522 290a 0a20 2020 2020  esponse")..     
+0000cf90: 2020 2069 6620 7265 7370 2e68 6561 6465     if resp.heade
+0000cfa0: 7273 3a0a 2020 2020 2020 2020 2020 2020  rs:.            
+0000cfb0: 6675 6e63 2e73 7461 7475 732e 7374 6174  func.status.stat
+0000cfc0: 6520 3d20 7265 7370 2e68 6561 6465 7273  e = resp.headers
+0000cfd0: 2e67 6574 2822 782d 6d6c 7275 6e2d 6675  .get("x-mlrun-fu
+0000cfe0: 6e63 7469 6f6e 2d73 7461 7475 7322 2c20  nction-status", 
+0000cff0: 2222 290a 2020 2020 2020 2020 2020 2020  "").            
+0000d000: 6c61 7374 5f6c 6f67 5f74 696d 6573 7461  last_log_timesta
+0000d010: 6d70 203d 2066 6c6f 6174 280a 2020 2020  mp = float(.    
+0000d020: 2020 2020 2020 2020 2020 2020 7265 7370              resp
+0000d030: 2e68 6561 6465 7273 2e67 6574 2822 782d  .headers.get("x-
+0000d040: 6d6c 7275 6e2d 6c61 7374 2d74 696d 6573  mlrun-last-times
+0000d050: 7461 6d70 222c 2022 302e 3022 290a 2020  tamp", "0.0").  
+0000d060: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+0000d070: 2020 2020 2020 2020 6966 2066 756e 632e          if func.
+0000d080: 6b69 6e64 2069 6e20 6d6c 7275 6e2e 7275  kind in mlrun.ru
+0000d090: 6e74 696d 6573 2e52 756e 7469 6d65 4b69  ntimes.RuntimeKi
+0000d0a0: 6e64 732e 6e75 636c 696f 5f72 756e 7469  nds.nuclio_runti
+0000d0b0: 6d65 7328 293a 0a20 2020 2020 2020 2020  mes():.         
+0000d0c0: 2020 2020 2020 2066 756e 632e 7374 6174         func.stat
+0000d0d0: 7573 2e61 6464 7265 7373 203d 2072 6573  us.address = res
+0000d0e0: 702e 6865 6164 6572 732e 6765 7428 2278  p.headers.get("x
+0000d0f0: 2d6d 6c72 756e 2d61 6464 7265 7373 222c  -mlrun-address",
+0000d100: 2022 2229 0a20 2020 2020 2020 2020 2020   "").           
+0000d110: 2020 2020 2066 756e 632e 7374 6174 7573       func.status
+0000d120: 2e6e 7563 6c69 6f5f 6e61 6d65 203d 2072  .nuclio_name = r
+0000d130: 6573 702e 6865 6164 6572 732e 6765 7428  esp.headers.get(
+0000d140: 2278 2d6d 6c72 756e 2d6e 616d 6522 2c20  "x-mlrun-name", 
+0000d150: 2222 290a 2020 2020 2020 2020 2020 2020  "").            
+0000d160: 2020 2020 6675 6e63 2e73 7461 7475 732e      func.status.
+0000d170: 696e 7465 726e 616c 5f69 6e76 6f63 6174  internal_invocat
+0000d180: 696f 6e5f 7572 6c73 203d 2072 6573 702e  ion_urls = resp.
+0000d190: 6865 6164 6572 732e 6765 7428 0a20 2020  headers.get(.   
+0000d1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d1b0: 2022 782d 6d6c 7275 6e2d 696e 7465 726e   "x-mlrun-intern
+0000d1c0: 616c 2d69 6e76 6f63 6174 696f 6e2d 7572  al-invocation-ur
+0000d1d0: 6c73 222c 2022 220a 2020 2020 2020 2020  ls", "".        
+0000d1e0: 2020 2020 2020 2020 292e 7370 6c69 7428          ).split(
+0000d1f0: 222c 2229 0a20 2020 2020 2020 2020 2020  ",").           
+0000d200: 2020 2020 2066 756e 632e 7374 6174 7573       func.status
+0000d210: 2e65 7874 6572 6e61 6c5f 696e 766f 6361  .external_invoca
+0000d220: 7469 6f6e 5f75 726c 7320 3d20 7265 7370  tion_urls = resp
+0000d230: 2e68 6561 6465 7273 2e67 6574 280a 2020  .headers.get(.  
+0000d240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d250: 2020 2278 2d6d 6c72 756e 2d65 7874 6572    "x-mlrun-exter
+0000d260: 6e61 6c2d 696e 766f 6361 7469 6f6e 2d75  nal-invocation-u
+0000d270: 726c 7322 2c20 2222 0a20 2020 2020 2020  rls", "".       
+0000d280: 2020 2020 2020 2020 2029 2e73 706c 6974           ).split
+0000d290: 2822 2c22 290a 2020 2020 2020 2020 2020  (",").          
+0000d2a0: 2020 2020 2020 6675 6e63 2e73 7461 7475        func.statu
+0000d2b0: 732e 636f 6e74 6169 6e65 725f 696d 6167  s.container_imag
+0000d2c0: 6520 3d20 7265 7370 2e68 6561 6465 7273  e = resp.headers
+0000d2d0: 2e67 6574 280a 2020 2020 2020 2020 2020  .get(.          
+0000d2e0: 2020 2020 2020 2020 2020 2278 2d6d 6c72            "x-mlr
+0000d2f0: 756e 2d63 6f6e 7461 696e 6572 2d69 6d61  un-container-ima
+0000d300: 6765 222c 2022 220a 2020 2020 2020 2020  ge", "".        
+0000d310: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0000d320: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0000d330: 2020 2020 2020 2020 2020 2020 6675 6e63              func
+0000d340: 2e73 7461 7475 732e 6275 696c 645f 706f  .status.build_po
+0000d350: 6420 3d20 7265 7370 2e68 6561 6465 7273  d = resp.headers
+0000d360: 2e67 6574 2822 6275 696c 6465 725f 706f  .get("builder_po
+0000d370: 6422 2c20 2222 290a 2020 2020 2020 2020  d", "").        
+0000d380: 2020 2020 2020 2020 6675 6e63 2e73 7065          func.spe
+0000d390: 632e 696d 6167 6520 3d20 7265 7370 2e68  c.image = resp.h
+0000d3a0: 6561 6465 7273 2e67 6574 2822 6675 6e63  eaders.get("func
+0000d3b0: 7469 6f6e 5f69 6d61 6765 222c 2022 2229  tion_image", "")
+0000d3c0: 0a0a 2020 2020 2020 2020 7465 7874 203d  ..        text =
+0000d3d0: 2022 220a 2020 2020 2020 2020 6966 2072   "".        if r
+0000d3e0: 6573 702e 636f 6e74 656e 743a 0a20 2020  esp.content:.   
+0000d3f0: 2020 2020 2020 2020 2074 6578 7420 3d20           text = 
+0000d400: 7265 7370 2e63 6f6e 7465 6e74 2e64 6563  resp.content.dec
+0000d410: 6f64 6528 290a 2020 2020 2020 2020 7265  ode().        re
+0000d420: 7475 726e 2074 6578 742c 206c 6173 745f  turn text, last_
+0000d430: 6c6f 675f 7469 6d65 7374 616d 700a 0a20  log_timestamp.. 
+0000d440: 2020 2064 6566 2072 656d 6f74 655f 7374     def remote_st
+0000d450: 6172 7428 7365 6c66 2c20 6675 6e63 5f75  art(self, func_u
+0000d460: 726c 2920 2d3e 206d 6c72 756e 2e63 6f6d  rl) -> mlrun.com
+0000d470: 6d6f 6e2e 7363 6865 6d61 732e 4261 636b  mon.schemas.Back
+0000d480: 6772 6f75 6e64 5461 736b 3a0a 2020 2020  groundTask:.    
+0000d490: 2020 2020 2222 2245 7865 6375 7465 2061      """Execute a
+0000d4a0: 2066 756e 6374 696f 6e20 7265 6d6f 7465   function remote
+0000d4b0: 6c79 2c20 5573 6564 2066 6f72 2060 6064  ly, Used for ``d
+0000d4c0: 6173 6b60 6020 6675 6e63 7469 6f6e 732e  ask`` functions.
+0000d4d0: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+0000d4e0: 2066 756e 635f 7572 6c3a 2055 524c 2074   func_url: URL t
+0000d4f0: 6f20 7468 6520 6675 6e63 7469 6f6e 2074  o the function t
+0000d500: 6f20 6265 2065 7865 6375 7465 642e 0a20  o be executed.. 
+0000d510: 2020 2020 2020 203a 7265 7475 726e 733a         :returns:
+0000d520: 2041 2042 6163 6b67 726f 756e 6454 6173   A BackgroundTas
+0000d530: 6b20 6f62 6a65 6374 2c20 7769 7468 2064  k object, with d
+0000d540: 6574 6169 6c73 206f 6e20 6578 6563 7574  etails on execut
+0000d550: 696f 6e20 7072 6f63 6573 7320 616e 6420  ion process and 
+0000d560: 6974 7320 7374 6174 7573 2e0a 2020 2020  its status..    
+0000d570: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
+0000d580: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
+0000d590: 2020 7265 7120 3d20 7b22 6675 6e63 7469    req = {"functi
+0000d5a0: 6f6e 5572 6c22 3a20 6675 6e63 5f75 726c  onUrl": func_url
+0000d5b0: 7d0a 2020 2020 2020 2020 2020 2020 7265  }.            re
+0000d5c0: 7370 203d 2073 656c 662e 6170 695f 6361  sp = self.api_ca
+0000d5d0: 6c6c 280a 2020 2020 2020 2020 2020 2020  ll(.            
+0000d5e0: 2020 2020 2250 4f53 5422 2c0a 2020 2020      "POST",.    
+0000d5f0: 2020 2020 2020 2020 2020 2020 2273 7461              "sta
+0000d600: 7274 2f66 756e 6374 696f 6e22 2c0a 2020  rt/function",.  
+0000d610: 2020 2020 2020 2020 2020 2020 2020 6a73                js
+0000d620: 6f6e 3d72 6571 2c0a 2020 2020 2020 2020  on=req,.        
+0000d630: 2020 2020 2020 2020 7469 6d65 6f75 743d          timeout=
+0000d640: 696e 7428 636f 6e66 6967 2e73 7562 6d69  int(config.submi
+0000d650: 745f 7469 6d65 6f75 7429 206f 7220 3630  t_timeout) or 60
+0000d660: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
+0000d670: 2020 2020 2020 2020 6578 6365 7074 204f          except O
+0000d680: 5345 7272 6f72 2061 7320 6572 723a 0a20  SError as err:. 
+0000d690: 2020 2020 2020 2020 2020 206c 6f67 6765             logge
+0000d6a0: 722e 6572 726f 7228 6622 6572 726f 7220  r.error(f"error 
+0000d6b0: 7374 6172 7469 6e67 2066 756e 6374 696f  starting functio
+0000d6c0: 6e3a 207b 6572 725f 746f 5f73 7472 2865  n: {err_to_str(e
+0000d6d0: 7272 297d 2229 0a20 2020 2020 2020 2020  rr)}").         
+0000d6e0: 2020 2072 6169 7365 204f 5345 7272 6f72     raise OSError
+0000d6f0: 2866 2265 7272 6f72 3a20 6361 6e6e 6f74  (f"error: cannot
+0000d700: 2073 7461 7274 2066 756e 6374 696f 6e2c   start function,
+0000d710: 207b 6572 725f 746f 5f73 7472 2865 7272   {err_to_str(err
+0000d720: 297d 2229 0a0a 2020 2020 2020 2020 6966  )}")..        if
+0000d730: 206e 6f74 2072 6573 702e 6f6b 3a0a 2020   not resp.ok:.  
+0000d740: 2020 2020 2020 2020 2020 6c6f 6767 6572            logger
+0000d750: 2e65 7272 6f72 2866 2262 6164 2072 6573  .error(f"bad res
+0000d760: 7021 215c 6e7b 7265 7370 2e74 6578 747d  p!!\n{resp.text}
+0000d770: 2229 0a20 2020 2020 2020 2020 2020 2072  ").            r
+0000d780: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+0000d790: 2262 6164 2066 756e 6374 696f 6e20 7374  "bad function st
+0000d7a0: 6172 7420 7265 7370 6f6e 7365 2229 0a0a  art response")..
+0000d7b0: 2020 2020 2020 2020 7265 7475 726e 206d          return m
+0000d7c0: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
+0000d7d0: 6d61 732e 4261 636b 6772 6f75 6e64 5461  mas.BackgroundTa
+0000d7e0: 736b 282a 2a72 6573 702e 6a73 6f6e 2829  sk(**resp.json()
+0000d7f0: 290a 0a20 2020 2064 6566 2067 6574 5f70  )..    def get_p
+0000d800: 726f 6a65 6374 5f62 6163 6b67 726f 756e  roject_backgroun
+0000d810: 645f 7461 736b 280a 2020 2020 2020 2020  d_task(.        
+0000d820: 7365 6c66 2c0a 2020 2020 2020 2020 7072  self,.        pr
+0000d830: 6f6a 6563 743a 2073 7472 2c0a 2020 2020  oject: str,.    
+0000d840: 2020 2020 6e61 6d65 3a20 7374 722c 0a20      name: str,. 
+0000d850: 2020 2029 202d 3e20 6d6c 7275 6e2e 636f     ) -> mlrun.co
+0000d860: 6d6d 6f6e 2e73 6368 656d 6173 2e42 6163  mmon.schemas.Bac
+0000d870: 6b67 726f 756e 6454 6173 6b3a 0a20 2020  kgroundTask:.   
+0000d880: 2020 2020 2022 2222 5265 7472 6965 7665       """Retrieve
+0000d890: 2075 7064 6174 6564 2069 6e66 6f72 6d61   updated informa
+0000d8a0: 7469 6f6e 206f 6e20 6120 7072 6f6a 6563  tion on a projec
+0000d8b0: 7420 6261 636b 6772 6f75 6e64 2074 6173  t background tas
+0000d8c0: 6b20 6265 696e 6720 6578 6563 7574 6564  k being executed
+0000d8d0: 2e22 2222 0a0a 2020 2020 2020 2020 7072  ."""..        pr
+0000d8e0: 6f6a 6563 7420 3d20 7072 6f6a 6563 7420  oject = project 
+0000d8f0: 6f72 2063 6f6e 6669 672e 6465 6661 756c  or config.defaul
+0000d900: 745f 7072 6f6a 6563 740a 2020 2020 2020  t_project.      
+0000d910: 2020 7061 7468 203d 2066 2270 726f 6a65    path = f"proje
+0000d920: 6374 732f 7b70 726f 6a65 6374 7d2f 6261  cts/{project}/ba
+0000d930: 636b 6772 6f75 6e64 2d74 6173 6b73 2f7b  ckground-tasks/{
+0000d940: 6e61 6d65 7d22 0a20 2020 2020 2020 2065  name}".        e
+0000d950: 7272 6f72 5f6d 6573 7361 6765 203d 2028  rror_message = (
+0000d960: 0a20 2020 2020 2020 2020 2020 2066 2246  .            f"F
+0000d970: 6169 6c65 6420 6765 7474 696e 6720 7072  ailed getting pr
+0000d980: 6f6a 6563 7420 6261 636b 6772 6f75 6e64  oject background
+0000d990: 2074 6173 6b2e 2070 726f 6a65 6374 3d7b   task. project={
+0000d9a0: 7072 6f6a 6563 747d 2c20 6e61 6d65 3d7b  project}, name={
+0000d9b0: 6e61 6d65 7d22 0a20 2020 2020 2020 2029  name}".        )
+0000d9c0: 0a20 2020 2020 2020 2072 6573 706f 6e73  .        respons
+0000d9d0: 6520 3d20 7365 6c66 2e61 7069 5f63 616c  e = self.api_cal
+0000d9e0: 6c28 2247 4554 222c 2070 6174 682c 2065  l("GET", path, e
+0000d9f0: 7272 6f72 5f6d 6573 7361 6765 290a 2020  rror_message).  
+0000da00: 2020 2020 2020 7265 7475 726e 206d 6c72        return mlr
+0000da10: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
+0000da20: 732e 4261 636b 6772 6f75 6e64 5461 736b  s.BackgroundTask
+0000da30: 282a 2a72 6573 706f 6e73 652e 6a73 6f6e  (**response.json
+0000da40: 2829 290a 0a20 2020 2064 6566 2067 6574  ())..    def get
+0000da50: 5f62 6163 6b67 726f 756e 645f 7461 736b  _background_task
+0000da60: 2873 656c 662c 206e 616d 653a 2073 7472  (self, name: str
+0000da70: 2920 2d3e 206d 6c72 756e 2e63 6f6d 6d6f  ) -> mlrun.commo
+0000da80: 6e2e 7363 6865 6d61 732e 4261 636b 6772  n.schemas.Backgr
+0000da90: 6f75 6e64 5461 736b 3a0a 2020 2020 2020  oundTask:.      
+0000daa0: 2020 2222 2252 6574 7269 6576 6520 7570    """Retrieve up
+0000dab0: 6461 7465 6420 696e 666f 726d 6174 696f  dated informatio
+0000dac0: 6e20 6f6e 2061 2062 6163 6b67 726f 756e  n on a backgroun
+0000dad0: 6420 7461 736b 2062 6569 6e67 2065 7865  d task being exe
+0000dae0: 6375 7465 642e 2222 220a 0a20 2020 2020  cuted."""..     
+0000daf0: 2020 2070 6174 6820 3d20 6622 6261 636b     path = f"back
+0000db00: 6772 6f75 6e64 2d74 6173 6b73 2f7b 6e61  ground-tasks/{na
+0000db10: 6d65 7d22 0a20 2020 2020 2020 2065 7272  me}".        err
+0000db20: 6f72 5f6d 6573 7361 6765 203d 2066 2246  or_message = f"F
+0000db30: 6169 6c65 6420 6765 7474 696e 6720 6261  ailed getting ba
+0000db40: 636b 6772 6f75 6e64 2074 6173 6b2e 206e  ckground task. n
+0000db50: 616d 653d 7b6e 616d 657d 220a 2020 2020  ame={name}".    
+0000db60: 2020 2020 7265 7370 6f6e 7365 203d 2073      response = s
+0000db70: 656c 662e 6170 695f 6361 6c6c 2822 4745  elf.api_call("GE
+0000db80: 5422 2c20 7061 7468 2c20 6572 726f 725f  T", path, error_
+0000db90: 6d65 7373 6167 6529 0a20 2020 2020 2020  message).       
+0000dba0: 2072 6574 7572 6e20 6d6c 7275 6e2e 636f   return mlrun.co
+0000dbb0: 6d6d 6f6e 2e73 6368 656d 6173 2e42 6163  mmon.schemas.Bac
+0000dbc0: 6b67 726f 756e 6454 6173 6b28 2a2a 7265  kgroundTask(**re
+0000dbd0: 7370 6f6e 7365 2e6a 736f 6e28 2929 0a0a  sponse.json())..
+0000dbe0: 2020 2020 6465 6620 7265 6d6f 7465 5f73      def remote_s
+0000dbf0: 7461 7475 7328 7365 6c66 2c20 7072 6f6a  tatus(self, proj
+0000dc00: 6563 742c 206e 616d 652c 206b 696e 642c  ect, name, kind,
+0000dc10: 2073 656c 6563 746f 7229 3a0a 2020 2020   selector):.    
+0000dc20: 2020 2020 2222 2252 6574 7269 6576 6520      """Retrieve 
+0000dc30: 7374 6174 7573 206f 6620 6120 6675 6e63  status of a func
+0000dc40: 7469 6f6e 2062 6569 6e67 2065 7865 6375  tion being execu
+0000dc50: 7465 6420 7265 6d6f 7465 6c79 2028 7265  ted remotely (re
+0000dc60: 6c65 7661 6e74 2074 6f20 6060 6461 736b  levant to ``dask
+0000dc70: 6060 2066 756e 6374 696f 6e73 292e 0a0a  `` functions)...
+0000dc80: 2020 2020 2020 2020 3a70 6172 616d 2070          :param p
+0000dc90: 726f 6a65 6374 3a20 5468 6520 7072 6f6a  roject: The proj
+0000dca0: 6563 7420 6f66 2074 6865 2066 756e 6374  ect of the funct
+0000dcb0: 696f 6e0a 2020 2020 2020 2020 3a70 6172  ion.        :par
+0000dcc0: 616d 206e 616d 653a 2054 6865 206e 616d  am name: The nam
+0000dcd0: 6520 6f66 2074 6865 2066 756e 6374 696f  e of the functio
+0000dce0: 6e0a 2020 2020 2020 2020 3a70 6172 616d  n.        :param
+0000dcf0: 206b 696e 643a 2054 6865 206b 696e 6420   kind: The kind 
+0000dd00: 6f66 2074 6865 2066 756e 6374 696f 6e2c  of the function,
+0000dd10: 2063 7572 7265 6e74 6c79 2060 6064 6173   currently ``das
+0000dd20: 6b60 6020 6973 2073 7570 706f 7274 6564  k`` is supported
+0000dd30: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+0000dd40: 2073 656c 6563 746f 723a 2053 656c 6563   selector: Selec
+0000dd50: 746f 7220 636c 6175 7365 2074 6f20 6265  tor clause to be
+0000dd60: 2061 7070 6c69 6564 2074 6f20 7468 6520   applied to the 
+0000dd70: 4b75 6265 726e 6574 6573 2073 7461 7475  Kubernetes statu
+0000dd80: 7320 7175 6572 7920 746f 2066 696c 7465  s query to filte
+0000dd90: 7220 7468 6520 7265 7375 6c74 732e 0a20  r the results.. 
+0000dda0: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
+0000ddb0: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
+0000ddc0: 2020 2020 2072 6571 203d 207b 226b 696e       req = {"kin
+0000ddd0: 6422 3a20 6b69 6e64 2c20 2273 656c 6563  d": kind, "selec
+0000dde0: 746f 7222 3a20 7365 6c65 6374 6f72 2c20  tor": selector, 
+0000ddf0: 2270 726f 6a65 6374 223a 2070 726f 6a65  "project": proje
+0000de00: 6374 2c20 226e 616d 6522 3a20 6e61 6d65  ct, "name": name
+0000de10: 7d0a 2020 2020 2020 2020 2020 2020 7265  }.            re
+0000de20: 7370 203d 2073 656c 662e 6170 695f 6361  sp = self.api_ca
+0000de30: 6c6c 2822 504f 5354 222c 2022 7374 6174  ll("POST", "stat
+0000de40: 7573 2f66 756e 6374 696f 6e22 2c20 6a73  us/function", js
+0000de50: 6f6e 3d72 6571 290a 2020 2020 2020 2020  on=req).        
+0000de60: 6578 6365 7074 204f 5345 7272 6f72 2061  except OSError a
+0000de70: 7320 6572 723a 0a20 2020 2020 2020 2020  s err:.         
+0000de80: 2020 206c 6f67 6765 722e 6572 726f 7228     logger.error(
+0000de90: 6622 6572 726f 7220 7374 6172 7469 6e67  f"error starting
+0000dea0: 2066 756e 6374 696f 6e3a 207b 6572 725f   function: {err_
+0000deb0: 746f 5f73 7472 2865 7272 297d 2229 0a20  to_str(err)}"). 
+0000dec0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+0000ded0: 204f 5345 7272 6f72 2866 2265 7272 6f72   OSError(f"error
+0000dee0: 3a20 6361 6e6e 6f74 2073 7461 7274 2066  : cannot start f
+0000def0: 756e 6374 696f 6e2c 207b 6572 725f 746f  unction, {err_to
+0000df00: 5f73 7472 2865 7272 297d 2229 0a0a 2020  _str(err)}")..  
+0000df10: 2020 2020 2020 6966 206e 6f74 2072 6573        if not res
+0000df20: 702e 6f6b 3a0a 2020 2020 2020 2020 2020  p.ok:.          
+0000df30: 2020 6c6f 6767 6572 2e65 7272 6f72 2866    logger.error(f
+0000df40: 2262 6164 2072 6573 7021 215c 6e7b 7265  "bad resp!!\n{re
+0000df50: 7370 2e74 6578 747d 2229 0a20 2020 2020  sp.text}").     
+0000df60: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+0000df70: 7565 4572 726f 7228 2262 6164 2066 756e  ueError("bad fun
+0000df80: 6374 696f 6e20 7374 6174 7573 2072 6573  ction status res
+0000df90: 706f 6e73 6522 290a 0a20 2020 2020 2020  ponse")..       
+0000dfa0: 2072 6574 7572 6e20 7265 7370 2e6a 736f   return resp.jso
+0000dfb0: 6e28 295b 2264 6174 6122 5d0a 0a20 2020  n()["data"]..   
+0000dfc0: 2064 6566 2073 7562 6d69 745f 6a6f 6228   def submit_job(
+0000dfd0: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+0000dfe0: 2020 2020 2020 2072 756e 7370 6563 2c0a         runspec,.
+0000dff0: 2020 2020 2020 2020 7363 6865 6475 6c65          schedule
+0000e000: 3a20 556e 696f 6e5b 7374 722c 206d 6c72  : Union[str, mlr
+0000e010: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
+0000e020: 732e 5363 6865 6475 6c65 4372 6f6e 5472  s.ScheduleCronTr
+0000e030: 6967 6765 725d 203d 204e 6f6e 652c 0a20  igger] = None,. 
+0000e040: 2020 2029 3a0a 2020 2020 2020 2020 2222     ):.        ""
+0000e050: 2253 7562 6d69 7420 6120 6a6f 6220 666f  "Submit a job fo
+0000e060: 7220 7265 6d6f 7465 2065 7865 6375 7469  r remote executi
+0000e070: 6f6e 2e0a 0a20 2020 2020 2020 203a 7061  on...        :pa
+0000e080: 7261 6d20 7275 6e73 7065 633a 2054 6865  ram runspec: The
+0000e090: 2072 756e 7469 6d65 206f 626a 6563 7420   runtime object 
+0000e0a0: 7370 6563 2028 5461 736b 2920 746f 2065  spec (Task) to e
+0000e0b0: 7865 6375 7465 2e0a 2020 2020 2020 2020  xecute..        
+0000e0c0: 3a70 6172 616d 2073 6368 6564 756c 653a  :param schedule:
+0000e0d0: 2057 6865 7468 6572 2074 6f20 7363 6865   Whether to sche
+0000e0e0: 6475 6c65 2074 6869 7320 6a6f 6220 7573  dule this job us
+0000e0f0: 696e 6720 6120 4372 6f6e 2074 7269 6767  ing a Cron trigg
+0000e100: 6572 2e20 4966 206e 6f74 2073 7065 6369  er. If not speci
+0000e110: 6669 6564 2c20 7468 6520 6a6f 6220 7769  fied, the job wi
+0000e120: 6c6c 2062 6520 7375 626d 6974 7465 640a  ll be submitted.
+0000e130: 2020 2020 2020 2020 2020 2020 696d 6d65              imme
+0000e140: 6469 6174 656c 792e 0a20 2020 2020 2020  diately..       
+0000e150: 2022 2222 0a0a 2020 2020 2020 2020 7472   """..        tr
+0000e160: 793a 0a20 2020 2020 2020 2020 2020 2072  y:.            r
+0000e170: 6571 203d 207b 2274 6173 6b22 3a20 7275  eq = {"task": ru
+0000e180: 6e73 7065 632e 746f 5f64 6963 7428 297d  nspec.to_dict()}
+0000e190: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0000e1a0: 7363 6865 6475 6c65 3a0a 2020 2020 2020  schedule:.      
+0000e1b0: 2020 2020 2020 2020 2020 6966 2069 7369            if isi
+0000e1c0: 6e73 7461 6e63 6528 7363 6865 6475 6c65  nstance(schedule
+0000e1d0: 2c20 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  , mlrun.common.s
+0000e1e0: 6368 656d 6173 2e53 6368 6564 756c 6543  chemas.ScheduleC
+0000e1f0: 726f 6e54 7269 6767 6572 293a 0a20 2020  ronTrigger):.   
+0000e200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e210: 2073 6368 6564 756c 6520 3d20 7363 6865   schedule = sche
+0000e220: 6475 6c65 2e64 6963 7428 290a 2020 2020  dule.dict().    
+0000e230: 2020 2020 2020 2020 2020 2020 7265 715b              req[
+0000e240: 2273 6368 6564 756c 6522 5d20 3d20 7363  "schedule"] = sc
+0000e250: 6865 6475 6c65 0a20 2020 2020 2020 2020  hedule.         
+0000e260: 2020 2074 696d 656f 7574 203d 2028 696e     timeout = (in
+0000e270: 7428 636f 6e66 6967 2e73 7562 6d69 745f  t(config.submit_
+0000e280: 7469 6d65 6f75 7429 206f 7220 3132 3029  timeout) or 120)
+0000e290: 202b 2032 300a 2020 2020 2020 2020 2020   + 20.          
+0000e2a0: 2020 7265 7370 203d 2073 656c 662e 6170    resp = self.ap
+0000e2b0: 695f 6361 6c6c 2822 504f 5354 222c 2022  i_call("POST", "
+0000e2c0: 7375 626d 6974 5f6a 6f62 222c 206a 736f  submit_job", jso
+0000e2d0: 6e3d 7265 712c 2074 696d 656f 7574 3d74  n=req, timeout=t
+0000e2e0: 696d 656f 7574 290a 0a20 2020 2020 2020  imeout)..       
+0000e2f0: 2065 7863 6570 7420 7265 7175 6573 7473   except requests
+0000e300: 2e48 5454 5045 7272 6f72 2061 7320 6572  .HTTPError as er
+0000e310: 723a 0a20 2020 2020 2020 2020 2020 206c  r:.            l
+0000e320: 6f67 6765 722e 6572 726f 7228 6622 6572  ogger.error(f"er
+0000e330: 726f 7220 7375 626d 6974 7469 6e67 2074  ror submitting t
+0000e340: 6173 6b3a 207b 6572 725f 746f 5f73 7472  ask: {err_to_str
+0000e350: 2865 7272 297d 2229 0a20 2020 2020 2020  (err)}").       
+0000e360: 2020 2020 2023 206e 6f74 2063 7265 6174       # not creat
+0000e370: 696e 6720 6120 6e65 7720 6578 6365 7074  ing a new except
+0000e380: 696f 6e20 6865 7265 2c20 696e 206f 7264  ion here, in ord
+0000e390: 6572 2074 6f20 6b65 6570 2074 6865 2072  er to keep the r
+0000e3a0: 6573 706f 6e73 6520 616e 6420 7374 6174  esponse and stat
+0000e3b0: 7573 2063 6f64 6520 696e 2074 6865 2065  us code in the e
+0000e3c0: 7863 6570 7469 6f6e 0a20 2020 2020 2020  xception.       
+0000e3d0: 2020 2020 2072 6169 7365 0a0a 2020 2020       raise..    
+0000e3e0: 2020 2020 6578 6365 7074 204f 5345 7272      except OSErr
+0000e3f0: 6f72 2061 7320 6572 723a 0a20 2020 2020  or as err:.     
+0000e400: 2020 2020 2020 206c 6f67 6765 722e 6572         logger.er
+0000e410: 726f 7228 6622 6572 726f 7220 7375 626d  ror(f"error subm
+0000e420: 6974 7469 6e67 2074 6173 6b3a 207b 6572  itting task: {er
+0000e430: 725f 746f 5f73 7472 2865 7272 297d 2229  r_to_str(err)}")
+0000e440: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+0000e450: 7365 204f 5345 7272 6f72 2822 6572 726f  se OSError("erro
+0000e460: 723a 2063 616e 6e6f 7420 7375 626d 6974  r: cannot submit
+0000e470: 2074 6173 6b22 2920 6672 6f6d 2065 7272   task") from err
+0000e480: 0a0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
+0000e490: 2072 6573 702e 6f6b 3a0a 2020 2020 2020   resp.ok:.      
+0000e4a0: 2020 2020 2020 6c6f 6767 6572 2e65 7272        logger.err
+0000e4b0: 6f72 2866 2262 6164 2072 6573 7021 215c  or(f"bad resp!!\
+0000e4c0: 6e7b 7265 7370 2e74 6578 747d 2229 0a20  n{resp.text}"). 
+0000e4d0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+0000e4e0: 2056 616c 7565 4572 726f 7228 6622 6261   ValueError(f"ba
+0000e4f0: 6420 6675 6e63 7469 6f6e 2072 756e 2072  d function run r
+0000e500: 6573 706f 6e73 652c 207b 7265 7370 2e74  esponse, {resp.t
+0000e510: 6578 747d 2229 0a0a 2020 2020 2020 2020  ext}")..        
+0000e520: 7265 7370 203d 2072 6573 702e 6a73 6f6e  resp = resp.json
+0000e530: 2829 0a20 2020 2020 2020 2072 6574 7572  ().        retur
+0000e540: 6e20 7265 7370 5b22 6461 7461 225d 0a0a  n resp["data"]..
+0000e550: 2020 2020 6465 6620 7375 626d 6974 5f70      def submit_p
+0000e560: 6970 656c 696e 6528 0a20 2020 2020 2020  ipeline(.       
+0000e570: 2073 656c 662c 0a20 2020 2020 2020 2070   self,.        p
+0000e580: 726f 6a65 6374 2c0a 2020 2020 2020 2020  roject,.        
+0000e590: 7069 7065 6c69 6e65 2c0a 2020 2020 2020  pipeline,.      
+0000e5a0: 2020 6172 6775 6d65 6e74 733d 4e6f 6e65    arguments=None
+0000e5b0: 2c0a 2020 2020 2020 2020 6578 7065 7269  ,.        experi
+0000e5c0: 6d65 6e74 3d4e 6f6e 652c 0a20 2020 2020  ment=None,.     
+0000e5d0: 2020 2072 756e 3d4e 6f6e 652c 0a20 2020     run=None,.   
+0000e5e0: 2020 2020 206e 616d 6573 7061 6365 3d4e       namespace=N
+0000e5f0: 6f6e 652c 0a20 2020 2020 2020 2061 7274  one,.        art
+0000e600: 6966 6163 745f 7061 7468 3d4e 6f6e 652c  ifact_path=None,
+0000e610: 0a20 2020 2020 2020 206f 7073 3d4e 6f6e  .        ops=Non
+0000e620: 652c 0a20 2020 2020 2020 2023 2054 4f44  e,.        # TOD
+0000e630: 4f3a 2064 6570 7265 6361 7465 642c 2072  O: deprecated, r
+0000e640: 656d 6f76 6520 696e 2031 2e35 2e30 0a20  emove in 1.5.0. 
+0000e650: 2020 2020 2020 2074 746c 3d4e 6f6e 652c         ttl=None,
+0000e660: 0a20 2020 2020 2020 2063 6c65 616e 7570  .        cleanup
+0000e670: 5f74 746c 3d4e 6f6e 652c 0a20 2020 2029  _ttl=None,.    )
+0000e680: 3a0a 2020 2020 2020 2020 2222 2253 7562  :.        """Sub
+0000e690: 6d69 7420 6120 4b46 5020 7069 7065 6c69  mit a KFP pipeli
+0000e6a0: 6e65 2066 6f72 2065 7865 6375 7469 6f6e  ne for execution
+0000e6b0: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
+0000e6c0: 6d20 7072 6f6a 6563 743a 2054 6865 2070  m project: The p
+0000e6d0: 726f 6a65 6374 206f 6620 7468 6520 7069  roject of the pi
+0000e6e0: 7065 6c69 6e65 0a20 2020 2020 2020 203a  peline.        :
+0000e6f0: 7061 7261 6d20 7069 7065 6c69 6e65 3a20  param pipeline: 
+0000e700: 5069 7065 6c69 6e65 2066 756e 6374 696f  Pipeline functio
+0000e710: 6e20 6f72 2070 6174 6820 746f 202e 7961  n or path to .ya
+0000e720: 6d6c 2f2e 7a69 7020 7069 7065 6c69 6e65  ml/.zip pipeline
+0000e730: 2066 696c 652e 0a20 2020 2020 2020 203a   file..        :
+0000e740: 7061 7261 6d20 6172 6775 6d65 6e74 733a  param arguments:
+0000e750: 2041 2064 6963 7469 6f6e 6172 7920 6f66   A dictionary of
+0000e760: 2061 7267 756d 656e 7473 2074 6f20 7061   arguments to pa
+0000e770: 7373 2074 6f20 7468 6520 7069 7065 6c69  ss to the pipeli
+0000e780: 6e65 2e0a 2020 2020 2020 2020 3a70 6172  ne..        :par
+0000e790: 616d 2065 7870 6572 696d 656e 743a 2041  am experiment: A
+0000e7a0: 206e 616d 6520 746f 2061 7373 6967 6e20   name to assign 
+0000e7b0: 666f 7220 7468 6520 7370 6563 6966 6963  for the specific
+0000e7c0: 2065 7870 6572 696d 656e 742e 0a20 2020   experiment..   
+0000e7d0: 2020 2020 203a 7061 7261 6d20 7275 6e3a       :param run:
+0000e7e0: 2041 206e 616d 6520 666f 7220 7468 6973   A name for this
+0000e7f0: 2073 7065 6369 6669 6320 7275 6e2e 0a20   specific run.. 
+0000e800: 2020 2020 2020 203a 7061 7261 6d20 6e61         :param na
+0000e810: 6d65 7370 6163 653a 204b 7562 6572 6e65  mespace: Kuberne
+0000e820: 7465 7320 6e61 6d65 7370 6163 6520 746f  tes namespace to
+0000e830: 2065 7865 6375 7465 2074 6865 2070 6970   execute the pip
+0000e840: 656c 696e 6520 696e 2e0a 2020 2020 2020  eline in..      
+0000e850: 2020 3a70 6172 616d 2061 7274 6966 6163    :param artifac
+0000e860: 745f 7061 7468 3a20 4120 7061 7468 2074  t_path: A path t
+0000e870: 6f20 6172 7469 6661 6374 7320 7573 6564  o artifacts used
+0000e880: 2062 7920 7468 6973 2070 6970 656c 696e   by this pipelin
+0000e890: 652e 0a20 2020 2020 2020 203a 7061 7261  e..        :para
+0000e8a0: 6d20 6f70 733a 2054 7261 6e73 666f 726d  m ops: Transform
+0000e8b0: 6572 7320 746f 2061 7070 6c79 206f 6e20  ers to apply on 
+0000e8c0: 616c 6c20 6f70 7320 696e 2074 6865 2070  all ops in the p
+0000e8d0: 6970 656c 696e 652e 0a20 2020 2020 2020  ipeline..       
+0000e8e0: 203a 7061 7261 6d20 7474 6c3a 2070 6970   :param ttl: pip
+0000e8f0: 656c 696e 6520 636c 6561 6e75 7020 7474  eline cleanup tt
+0000e900: 6c20 696e 2073 6563 7320 2874 696d 6520  l in secs (time 
+0000e910: 746f 2077 6169 7420 6166 7465 7220 776f  to wait after wo
+0000e920: 726b 666c 6f77 2063 6f6d 706c 6574 696f  rkflow completio
+0000e930: 6e2c 2061 7420 7768 6963 6820 706f 696e  n, at which poin
+0000e940: 7420 7468 6520 776f 726b 666c 6f77 0a20  t the workflow. 
+0000e950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e960: 2020 2061 6e64 2061 6c6c 2069 7473 2072     and all its r
+0000e970: 6573 6f75 7263 6573 2061 7265 2064 656c  esources are del
+0000e980: 6574 6564 2920 2864 6570 7265 6361 7465  eted) (deprecate
+0000e990: 642c 2075 7365 2063 6c65 616e 7570 5f74  d, use cleanup_t
+0000e9a0: 746c 2069 6e73 7465 6164 290a 2020 2020  tl instead).    
+0000e9b0: 2020 2020 3a70 6172 616d 2063 6c65 616e      :param clean
+0000e9c0: 7570 5f74 746c 3a20 7069 7065 6c69 6e65  up_ttl: pipeline
+0000e9d0: 2063 6c65 616e 7570 2074 746c 2069 6e20   cleanup ttl in 
+0000e9e0: 7365 6373 2028 7469 6d65 2074 6f20 7761  secs (time to wa
+0000e9f0: 6974 2061 6674 6572 2077 6f72 6b66 6c6f  it after workflo
+0000ea00: 7720 636f 6d70 6c65 7469 6f6e 2c20 6174  w completion, at
+0000ea10: 2077 6869 6368 2070 6f69 6e74 2074 6865   which point the
+0000ea20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000ea30: 2020 2020 2020 2020 2020 2020 2077 6f72               wor
+0000ea40: 6b66 6c6f 7720 616e 6420 616c 6c20 6974  kflow and all it
+0000ea50: 7320 7265 736f 7572 6365 7320 6172 6520  s resources are 
+0000ea60: 6465 6c65 7465 6429 0a20 2020 2020 2020  deleted).       
+0000ea70: 2022 2222 0a0a 2020 2020 2020 2020 6966   """..        if
+0000ea80: 2074 746c 3a0a 2020 2020 2020 2020 2020   ttl:.          
+0000ea90: 2020 7761 726e 696e 6773 2e77 6172 6e28    warnings.warn(
+0000eaa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000eab0: 2022 2774 746c 2720 6973 2064 6570 7265   "'ttl' is depre
+0000eac0: 6361 7465 642c 2075 7365 2027 636c 6561  cated, use 'clea
+0000ead0: 6e75 705f 7474 6c27 2069 6e73 7465 6164  nup_ttl' instead
+0000eae0: 2e20 220a 2020 2020 2020 2020 2020 2020  . ".            
+0000eaf0: 2020 2020 2254 6869 7320 7769 6c6c 2062      "This will b
+0000eb00: 6520 7265 6d6f 7665 6420 696e 2031 2e35  e removed in 1.5
+0000eb10: 2e30 222c 0a20 2020 2020 2020 2020 2020  .0",.           
+0000eb20: 2020 2020 2023 2054 4f44 4f3a 2052 656d       # TODO: Rem
+0000eb30: 6f76 6520 7468 6973 2069 6e20 312e 352e  ove this in 1.5.
+0000eb40: 300a 2020 2020 2020 2020 2020 2020 2020  0.              
+0000eb50: 2020 4675 7475 7265 5761 726e 696e 672c    FutureWarning,
+0000eb60: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
+0000eb70: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+0000eb80: 7461 6e63 6528 7069 7065 6c69 6e65 2c20  tance(pipeline, 
+0000eb90: 7374 7229 3a0a 2020 2020 2020 2020 2020  str):.          
+0000eba0: 2020 7069 7065 5f66 696c 6520 3d20 7069    pipe_file = pi
+0000ebb0: 7065 6c69 6e65 0a20 2020 2020 2020 2065  peline.        e
+0000ebc0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+0000ebd0: 2070 6970 655f 6669 6c65 203d 2074 656d   pipe_file = tem
+0000ebe0: 7066 696c 652e 4e61 6d65 6454 656d 706f  pfile.NamedTempo
+0000ebf0: 7261 7279 4669 6c65 2873 7566 6669 783d  raryFile(suffix=
+0000ec00: 222e 7961 6d6c 222c 2064 656c 6574 653d  ".yaml", delete=
+0000ec10: 4661 6c73 6529 2e6e 616d 650a 2020 2020  False).name.    
+0000ec20: 2020 2020 2020 2020 636f 6e66 203d 206e          conf = n
+0000ec30: 6577 5f70 6970 655f 6d65 7461 6461 7461  ew_pipe_metadata
+0000ec40: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0000ec50: 2020 6172 7469 6661 6374 5f70 6174 683d    artifact_path=
+0000ec60: 6172 7469 6661 6374 5f70 6174 682c 0a20  artifact_path,. 
+0000ec70: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+0000ec80: 6c65 616e 7570 5f74 746c 3d63 6c65 616e  leanup_ttl=clean
+0000ec90: 7570 5f74 746c 206f 7220 7474 6c2c 0a20  up_ttl or ttl,. 
+0000eca0: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+0000ecb0: 705f 7472 616e 7366 6f72 6d65 7273 3d6f  p_transformers=o
+0000ecc0: 7073 2c0a 2020 2020 2020 2020 2020 2020  ps,.            
+0000ecd0: 290a 2020 2020 2020 2020 2020 2020 6b66  ).            kf
+0000ece0: 702e 636f 6d70 696c 6572 2e43 6f6d 7069  p.compiler.Compi
+0000ecf0: 6c65 7228 292e 636f 6d70 696c 6528 0a20  ler().compile(. 
+0000ed00: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0000ed10: 6970 656c 696e 652c 2070 6970 655f 6669  ipeline, pipe_fi
+0000ed20: 6c65 2c20 7479 7065 5f63 6865 636b 3d46  le, type_check=F
+0000ed30: 616c 7365 2c20 7069 7065 6c69 6e65 5f63  alse, pipeline_c
+0000ed40: 6f6e 663d 636f 6e66 0a20 2020 2020 2020  onf=conf.       
+0000ed50: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+0000ed60: 6966 2070 6970 655f 6669 6c65 2e65 6e64  if pipe_file.end
+0000ed70: 7377 6974 6828 222e 7961 6d6c 2229 3a0a  swith(".yaml"):.
+0000ed80: 2020 2020 2020 2020 2020 2020 6865 6164              head
+0000ed90: 6572 7320 3d20 7b22 636f 6e74 656e 742d  ers = {"content-
+0000eda0: 7479 7065 223a 2022 6170 706c 6963 6174  type": "applicat
+0000edb0: 696f 6e2f 7961 6d6c 227d 0a20 2020 2020  ion/yaml"}.     
+0000edc0: 2020 2065 6c69 6620 7069 7065 5f66 696c     elif pipe_fil
+0000edd0: 652e 656e 6473 7769 7468 2822 2e7a 6970  e.endswith(".zip
+0000ede0: 2229 3a0a 2020 2020 2020 2020 2020 2020  "):.            
+0000edf0: 6865 6164 6572 7320 3d20 7b22 636f 6e74  headers = {"cont
+0000ee00: 656e 742d 7479 7065 223a 2022 6170 706c  ent-type": "appl
+0000ee10: 6963 6174 696f 6e2f 7a69 7022 7d0a 2020  ication/zip"}.  
+0000ee20: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0000ee30: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+0000ee40: 6c75 6545 7272 6f72 2822 7069 7065 6c69  lueError("pipeli
+0000ee50: 6e65 2066 696c 6520 6d75 7374 2062 6520  ne file must be 
+0000ee60: 2e79 616d 6c20 6f72 202e 7a69 7022 290a  .yaml or .zip").
+0000ee70: 2020 2020 2020 2020 6966 2061 7267 756d          if argum
+0000ee80: 656e 7473 3a0a 2020 2020 2020 2020 2020  ents:.          
+0000ee90: 2020 6966 206e 6f74 2069 7369 6e73 7461    if not isinsta
+0000eea0: 6e63 6528 6172 6775 6d65 6e74 732c 2064  nce(arguments, d
+0000eeb0: 6963 7429 3a0a 2020 2020 2020 2020 2020  ict):.          
+0000eec0: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+0000eed0: 6545 7272 6f72 2822 6172 6775 6d65 6e74  eError("argument
+0000eee0: 7320 6d75 7374 2062 6520 6469 6374 2074  s must be dict t
+0000eef0: 7970 6522 290a 2020 2020 2020 2020 2020  ype").          
+0000ef00: 2020 6865 6164 6572 735b 6d6c 7275 6e2e    headers[mlrun.
+0000ef10: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e48  common.schemas.H
+0000ef20: 6561 6465 724e 616d 6573 2e70 6970 656c  eaderNames.pipel
+0000ef30: 696e 655f 6172 6775 6d65 6e74 735d 203d  ine_arguments] =
+0000ef40: 2073 7472 280a 2020 2020 2020 2020 2020   str(.          
+0000ef50: 2020 2020 2020 6172 6775 6d65 6e74 730a        arguments.
+0000ef60: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+0000ef70: 2020 2020 2020 2069 6620 6e6f 7420 7061         if not pa
+0000ef80: 7468 2e69 7366 696c 6528 7069 7065 5f66  th.isfile(pipe_f
+0000ef90: 696c 6529 3a0a 2020 2020 2020 2020 2020  ile):.          
+0000efa0: 2020 7261 6973 6520 4f53 4572 726f 7228    raise OSError(
+0000efb0: 6622 6669 6c65 207b 7069 7065 5f66 696c  f"file {pipe_fil
+0000efc0: 657d 2064 6f65 736e 7420 6578 6973 7422  e} doesnt exist"
+0000efd0: 290a 2020 2020 2020 2020 7769 7468 206f  ).        with o
+0000efe0: 7065 6e28 7069 7065 5f66 696c 652c 2022  pen(pipe_file, "
+0000eff0: 7262 2229 2061 7320 6670 3a0a 2020 2020  rb") as fp:.    
+0000f000: 2020 2020 2020 2020 6461 7461 203d 2066          data = f
+0000f010: 702e 7265 6164 2829 0a20 2020 2020 2020  p.read().       
+0000f020: 2069 6620 6e6f 7420 6973 696e 7374 616e   if not isinstan
+0000f030: 6365 2870 6970 656c 696e 652c 2073 7472  ce(pipeline, str
+0000f040: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
+0000f050: 656d 6f76 6528 7069 7065 5f66 696c 6529  emove(pipe_file)
+0000f060: 0a0a 2020 2020 2020 2020 7472 793a 0a20  ..        try:. 
+0000f070: 2020 2020 2020 2020 2020 2070 6172 616d             param
+0000f080: 7320 3d20 7b22 6e61 6d65 7370 6163 6522  s = {"namespace"
+0000f090: 3a20 6e61 6d65 7370 6163 652c 2022 6578  : namespace, "ex
+0000f0a0: 7065 7269 6d65 6e74 223a 2065 7870 6572  periment": exper
+0000f0b0: 696d 656e 742c 2022 7275 6e22 3a20 7275  iment, "run": ru
+0000f0c0: 6e7d 0a20 2020 2020 2020 2020 2020 2072  n}.            r
+0000f0d0: 6573 7020 3d20 7365 6c66 2e61 7069 5f63  esp = self.api_c
+0000f0e0: 616c 6c28 0a20 2020 2020 2020 2020 2020  all(.           
+0000f0f0: 2020 2020 2022 504f 5354 222c 0a20 2020       "POST",.   
+0000f100: 2020 2020 2020 2020 2020 2020 2066 2270               f"p
+0000f110: 726f 6a65 6374 732f 7b70 726f 6a65 6374  rojects/{project
+0000f120: 7d2f 7069 7065 6c69 6e65 7322 2c0a 2020  }/pipelines",.  
+0000f130: 2020 2020 2020 2020 2020 2020 2020 7061                pa
+0000f140: 7261 6d73 3d70 6172 616d 732c 0a20 2020  rams=params,.   
+0000f150: 2020 2020 2020 2020 2020 2020 2074 696d               tim
+0000f160: 656f 7574 3d32 302c 0a20 2020 2020 2020  eout=20,.       
+0000f170: 2020 2020 2020 2020 2062 6f64 793d 6461           body=da
+0000f180: 7461 2c0a 2020 2020 2020 2020 2020 2020  ta,.            
+0000f190: 2020 2020 6865 6164 6572 733d 6865 6164      headers=head
+0000f1a0: 6572 732c 0a20 2020 2020 2020 2020 2020  ers,.           
+0000f1b0: 2029 0a20 2020 2020 2020 2065 7863 6570   ).        excep
+0000f1c0: 7420 4f53 4572 726f 7220 6173 2065 7272  t OSError as err
+0000f1d0: 3a0a 2020 2020 2020 2020 2020 2020 6c6f  :.            lo
+0000f1e0: 6767 6572 2e65 7272 6f72 2866 2265 7272  gger.error(f"err
+0000f1f0: 6f72 2063 616e 6e6f 7420 7375 626d 6974  or cannot submit
+0000f200: 2070 6970 656c 696e 653a 207b 6572 725f   pipeline: {err_
+0000f210: 746f 5f73 7472 2865 7272 297d 2229 0a20  to_str(err)}"). 
+0000f220: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+0000f230: 204f 5345 7272 6f72 2866 2265 7272 6f72   OSError(f"error
+0000f240: 3a20 6361 6e6e 6f74 2063 616e 6e6f 7420  : cannot cannot 
+0000f250: 7375 626d 6974 2070 6970 656c 696e 652c  submit pipeline,
+0000f260: 207b 6572 725f 746f 5f73 7472 2865 7272   {err_to_str(err
+0000f270: 297d 2229 0a0a 2020 2020 2020 2020 6966  )}")..        if
+0000f280: 206e 6f74 2072 6573 702e 6f6b 3a0a 2020   not resp.ok:.  
+0000f290: 2020 2020 2020 2020 2020 6c6f 6767 6572            logger
+0000f2a0: 2e65 7272 6f72 2866 2262 6164 2072 6573  .error(f"bad res
+0000f2b0: 7021 215c 6e7b 7265 7370 2e74 6578 747d  p!!\n{resp.text}
+0000f2c0: 2229 0a20 2020 2020 2020 2020 2020 2072  ").            r
+0000f2d0: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+0000f2e0: 6622 6261 6420 7375 626d 6974 2070 6970  f"bad submit pip
+0000f2f0: 656c 696e 6520 7265 7370 6f6e 7365 2c20  eline response, 
+0000f300: 7b72 6573 702e 7465 7874 7d22 290a 0a20  {resp.text}").. 
+0000f310: 2020 2020 2020 2072 6573 7020 3d20 7265         resp = re
+0000f320: 7370 2e6a 736f 6e28 290a 2020 2020 2020  sp.json().      
+0000f330: 2020 6c6f 6767 6572 2e69 6e66 6f28 6622    logger.info(f"
+0000f340: 7375 626d 6974 7465 6420 7069 7065 6c69  submitted pipeli
+0000f350: 6e65 207b 7265 7370 5b27 6e61 6d65 275d  ne {resp['name']
+0000f360: 7d20 6964 3d7b 7265 7370 5b27 6964 275d  } id={resp['id']
+0000f370: 7d22 290a 2020 2020 2020 2020 7265 7475  }").        retu
+0000f380: 726e 2072 6573 705b 2269 6422 5d0a 0a20  rn resp["id"].. 
+0000f390: 2020 2064 6566 206c 6973 745f 7069 7065     def list_pipe
+0000f3a0: 6c69 6e65 7328 0a20 2020 2020 2020 2073  lines(.        s
+0000f3b0: 656c 662c 0a20 2020 2020 2020 2070 726f  elf,.        pro
+0000f3c0: 6a65 6374 3a20 7374 722c 0a20 2020 2020  ject: str,.     
+0000f3d0: 2020 206e 616d 6573 7061 6365 3a20 7374     namespace: st
+0000f3e0: 7220 3d20 4e6f 6e65 2c0a 2020 2020 2020  r = None,.      
+0000f3f0: 2020 736f 7274 5f62 793a 2073 7472 203d    sort_by: str =
+0000f400: 2022 222c 0a20 2020 2020 2020 2070 6167   "",.        pag
+0000f410: 655f 746f 6b65 6e3a 2073 7472 203d 2022  e_token: str = "
+0000f420: 222c 0a20 2020 2020 2020 2066 696c 7465  ",.        filte
+0000f430: 725f 3a20 7374 7220 3d20 2222 2c0a 2020  r_: str = "",.  
+0000f440: 2020 2020 2020 666f 726d 6174 5f3a 2055        format_: U
+0000f450: 6e69 6f6e 5b0a 2020 2020 2020 2020 2020  nion[.          
+0000f460: 2020 7374 722c 206d 6c72 756e 2e63 6f6d    str, mlrun.com
+0000f470: 6d6f 6e2e 7363 6865 6d61 732e 5069 7065  mon.schemas.Pipe
+0000f480: 6c69 6e65 7346 6f72 6d61 740a 2020 2020  linesFormat.    
+0000f490: 2020 2020 5d20 3d20 6d6c 7275 6e2e 636f      ] = mlrun.co
+0000f4a0: 6d6d 6f6e 2e73 6368 656d 6173 2e50 6970  mmon.schemas.Pip
+0000f4b0: 656c 696e 6573 466f 726d 6174 2e6d 6574  elinesFormat.met
+0000f4c0: 6164 6174 615f 6f6e 6c79 2c0a 2020 2020  adata_only,.    
+0000f4d0: 2020 2020 7061 6765 5f73 697a 653a 2069      page_size: i
+0000f4e0: 6e74 203d 204e 6f6e 652c 0a20 2020 2029  nt = None,.    )
+0000f4f0: 202d 3e20 6d6c 7275 6e2e 636f 6d6d 6f6e   -> mlrun.common
+0000f500: 2e73 6368 656d 6173 2e50 6970 656c 696e  .schemas.Pipelin
+0000f510: 6573 4f75 7470 7574 3a0a 2020 2020 2020  esOutput:.      
+0000f520: 2020 2222 2252 6574 7269 6576 6520 6120    """Retrieve a 
+0000f530: 6c69 7374 206f 6620 4b46 5020 7069 7065  list of KFP pipe
+0000f540: 6c69 6e65 732e 2054 6869 7320 6675 6e63  lines. This func
+0000f550: 7469 6f6e 2063 616e 2062 6520 696e 766f  tion can be invo
+0000f560: 6b65 6420 746f 2067 6574 2061 6c6c 2070  ked to get all p
+0000f570: 6970 656c 696e 6573 2066 726f 6d20 616c  ipelines from al
+0000f580: 6c20 7072 6f6a 6563 7473 2c0a 2020 2020  l projects,.    
+0000f590: 2020 2020 6279 2073 7065 6369 6679 696e      by specifyin
+0000f5a0: 6720 6060 7072 6f6a 6563 743d 2a60 602c  g ``project=*``,
+0000f5b0: 2069 6e20 7768 6963 6820 6361 7365 2070   in which case p
+0000f5c0: 6167 696e 6174 696f 6e20 6361 6e20 6265  agination can be
+0000f5d0: 2075 7365 6420 616e 6420 7468 6520 7661   used and the va
+0000f5e0: 7269 6f75 7320 736f 7274 696e 6720 616e  rious sorting an
+0000f5f0: 6420 7061 6769 6e61 7469 6f6e 0a20 2020  d pagination.   
+0000f600: 2020 2020 2070 726f 7065 7274 6965 7320       properties 
+0000f610: 6361 6e20 6265 2061 7070 6c69 6564 2e20  can be applied. 
+0000f620: 4966 2061 2073 7065 6369 6669 6320 7072  If a specific pr
+0000f630: 6f6a 6563 7420 6973 2072 6571 7565 7374  oject is request
+0000f640: 6564 2c20 7468 656e 2074 6865 2070 6167  ed, then the pag
+0000f650: 696e 6174 696f 6e20 6f70 7469 6f6e 7320  ination options 
+0000f660: 6361 6e6e 6f74 2062 650a 2020 2020 2020  cannot be.      
+0000f670: 2020 7573 6564 2061 6e64 2070 6167 696e    used and pagin
+0000f680: 6174 696f 6e20 6973 206e 6f74 2061 7070  ation is not app
+0000f690: 6c69 6564 2e0a 0a20 2020 2020 2020 203a  lied...        :
+0000f6a0: 7061 7261 6d20 7072 6f6a 6563 743a 2050  param project: P
+0000f6b0: 726f 6a65 6374 206e 616d 652e 2043 616e  roject name. Can
+0000f6c0: 2062 6520 6060 2a60 6020 666f 7220 7175   be ``*`` for qu
+0000f6d0: 6572 7920 6163 726f 7373 2061 6c6c 2070  ery across all p
+0000f6e0: 726f 6a65 6374 732e 0a20 2020 2020 2020  rojects..       
+0000f6f0: 203a 7061 7261 6d20 6e61 6d65 7370 6163   :param namespac
+0000f700: 653a 204b 7562 6572 6e65 7465 7320 6e61  e: Kubernetes na
+0000f710: 6d65 7370 6163 6520 696e 2077 6869 6368  mespace in which
+0000f720: 2074 6865 2070 6970 656c 696e 6573 2061   the pipelines a
+0000f730: 7265 2065 7865 6375 7469 6e67 2e0a 2020  re executing..  
+0000f740: 2020 2020 2020 3a70 6172 616d 2073 6f72        :param sor
+0000f750: 745f 6279 3a20 4669 656c 6420 746f 2073  t_by: Field to s
+0000f760: 6f72 7420 7468 6520 7265 7375 6c74 7320  ort the results 
+0000f770: 6279 2e0a 2020 2020 2020 2020 3a70 6172  by..        :par
+0000f780: 616d 2070 6167 655f 746f 6b65 6e3a 2055  am page_token: U
+0000f790: 7365 2066 6f72 2070 6167 696e 6174 696f  se for paginatio
+0000f7a0: 6e2c 2074 6f20 7265 7472 6965 7665 206e  n, to retrieve n
+0000f7b0: 6578 7420 7061 6765 2e0a 2020 2020 2020  ext page..      
+0000f7c0: 2020 3a70 6172 616d 2066 696c 7465 725f    :param filter_
+0000f7d0: 3a20 4b75 6265 726e 6574 6573 2066 696c  : Kubernetes fil
+0000f7e0: 7465 7220 746f 2061 7070 6c79 2074 6f20  ter to apply to 
+0000f7f0: 7468 6520 7175 6572 792c 2063 616e 2062  the query, can b
+0000f800: 6520 7573 6564 2074 6f20 6669 6c74 6572  e used to filter
+0000f810: 206f 6e20 7370 6563 6966 6963 206f 626a   on specific obj
+0000f820: 6563 7420 6669 656c 6473 2e0a 2020 2020  ect fields..    
+0000f830: 2020 2020 3a70 6172 616d 2066 6f72 6d61      :param forma
+0000f840: 745f 3a20 5265 7375 6c74 2066 6f72 6d61  t_: Result forma
+0000f850: 742e 2043 616e 2062 6520 6f6e 6520 6f66  t. Can be one of
+0000f860: 3a0a 0a20 2020 2020 2020 2020 2020 202d  :..            -
+0000f870: 2060 6066 756c 6c60 6020 2d20 7265 7475   ``full`` - retu
+0000f880: 726e 2074 6865 2066 756c 6c20 6f62 6a65  rn the full obje
+0000f890: 6374 732e 0a20 2020 2020 2020 2020 2020  cts..           
+0000f8a0: 202d 2060 606d 6574 6164 6174 615f 6f6e   - ``metadata_on
+0000f8b0: 6c79 6060 2028 6465 6661 756c 7429 202d  ly`` (default) -
+0000f8c0: 2072 6574 7572 6e20 6a75 7374 206d 6574   return just met
+0000f8d0: 6164 6174 6120 6f66 2074 6865 2070 6970  adata of the pip
+0000f8e0: 656c 696e 6573 206f 626a 6563 7473 2e0a  elines objects..
+0000f8f0: 2020 2020 2020 2020 2020 2020 2d20 6060              - ``
+0000f900: 6e61 6d65 5f6f 6e6c 7960 6020 2d20 7265  name_only`` - re
+0000f910: 7475 726e 206a 7573 7420 7468 6520 6e61  turn just the na
+0000f920: 6d65 7320 6f66 2074 6865 2070 6970 656c  mes of the pipel
+0000f930: 696e 6520 6f62 6a65 6374 732e 0a20 2020  ine objects..   
+0000f940: 2020 2020 203a 7061 7261 6d20 7061 6765       :param page
+0000f950: 5f73 697a 653a 2053 697a 6520 6f66 2061  _size: Size of a
+0000f960: 2073 696e 676c 6520 7061 6765 2077 6865   single page whe
+0000f970: 6e20 6170 706c 7969 6e67 2070 6167 696e  n applying pagin
+0000f980: 6174 696f 6e2e 0a20 2020 2020 2020 2022  ation..        "
+0000f990: 2222 0a0a 2020 2020 2020 2020 6966 2070  ""..        if p
+0000f9a0: 726f 6a65 6374 2021 3d20 222a 2220 616e  roject != "*" an
+0000f9b0: 6420 2870 6167 655f 746f 6b65 6e20 6f72  d (page_token or
+0000f9c0: 2070 6167 655f 7369 7a65 293a 0a20 2020   page_size):.   
+0000f9d0: 2020 2020 2020 2020 2072 6169 7365 206d           raise m
+0000f9e0: 6c72 756e 2e65 7272 6f72 732e 4d4c 5275  lrun.errors.MLRu
+0000f9f0: 6e49 6e76 616c 6964 4172 6775 6d65 6e74  nInvalidArgument
+0000fa00: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
+0000fa10: 2020 2020 2020 2022 4669 6c74 6572 696e         "Filterin
+0000fa20: 6720 6279 2070 726f 6a65 6374 2063 616e  g by project can
+0000fa30: 206e 6f74 2062 6520 7573 6564 2074 6f67   not be used tog
+0000fa40: 6574 6865 7220 7769 7468 2070 6167 696e  ether with pagin
+0000fa50: 6174 696f 6e22 0a20 2020 2020 2020 2020  ation".         
+0000fa60: 2020 2029 0a20 2020 2020 2020 2070 6172     ).        par
+0000fa70: 616d 7320 3d20 7b0a 2020 2020 2020 2020  ams = {.        
+0000fa80: 2020 2020 226e 616d 6573 7061 6365 223a      "namespace":
+0000fa90: 206e 616d 6573 7061 6365 2c0a 2020 2020   namespace,.    
+0000faa0: 2020 2020 2020 2020 2273 6f72 745f 6279          "sort_by
+0000fab0: 223a 2073 6f72 745f 6279 2c0a 2020 2020  ": sort_by,.    
+0000fac0: 2020 2020 2020 2020 2270 6167 655f 746f          "page_to
+0000fad0: 6b65 6e22 3a20 7061 6765 5f74 6f6b 656e  ken": page_token
+0000fae0: 2c0a 2020 2020 2020 2020 2020 2020 2266  ,.            "f
+0000faf0: 696c 7465 7222 3a20 6669 6c74 6572 5f2c  ilter": filter_,
+0000fb00: 0a20 2020 2020 2020 2020 2020 2022 666f  .            "fo
+0000fb10: 726d 6174 223a 2066 6f72 6d61 745f 2c0a  rmat": format_,.
+0000fb20: 2020 2020 2020 2020 2020 2020 2270 6167              "pag
+0000fb30: 655f 7369 7a65 223a 2070 6167 655f 7369  e_size": page_si
+0000fb40: 7a65 2c0a 2020 2020 2020 2020 7d0a 0a20  ze,.        }.. 
+0000fb50: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
+0000fb60: 7361 6765 203d 2066 2246 6169 6c65 6420  sage = f"Failed 
+0000fb70: 6c69 7374 696e 6720 7069 7065 6c69 6e65  listing pipeline
+0000fb80: 732c 2071 7565 7279 3a20 7b70 6172 616d  s, query: {param
+0000fb90: 737d 220a 2020 2020 2020 2020 7265 7370  s}".        resp
+0000fba0: 6f6e 7365 203d 2073 656c 662e 6170 695f  onse = self.api_
+0000fbb0: 6361 6c6c 280a 2020 2020 2020 2020 2020  call(.          
+0000fbc0: 2020 2247 4554 222c 2066 2270 726f 6a65    "GET", f"proje
+0000fbd0: 6374 732f 7b70 726f 6a65 6374 7d2f 7069  cts/{project}/pi
+0000fbe0: 7065 6c69 6e65 7322 2c20 6572 726f 725f  pelines", error_
+0000fbf0: 6d65 7373 6167 652c 2070 6172 616d 733d  message, params=
+0000fc00: 7061 7261 6d73 0a20 2020 2020 2020 2029  params.        )
+0000fc10: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0000fc20: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
+0000fc30: 656d 6173 2e50 6970 656c 696e 6573 4f75  emas.PipelinesOu
+0000fc40: 7470 7574 282a 2a72 6573 706f 6e73 652e  tput(**response.
+0000fc50: 6a73 6f6e 2829 290a 0a20 2020 2064 6566  json())..    def
+0000fc60: 2067 6574 5f70 6970 656c 696e 6528 0a20   get_pipeline(. 
+0000fc70: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+0000fc80: 2020 2020 2072 756e 5f69 643a 2073 7472       run_id: str
+0000fc90: 2c0a 2020 2020 2020 2020 6e61 6d65 7370  ,.        namesp
+0000fca0: 6163 653a 2073 7472 203d 204e 6f6e 652c  ace: str = None,
+0000fcb0: 0a20 2020 2020 2020 2074 696d 656f 7574  .        timeout
+0000fcc0: 3a20 696e 7420 3d20 3130 2c0a 2020 2020  : int = 10,.    
+0000fcd0: 2020 2020 666f 726d 6174 5f3a 2055 6e69      format_: Uni
+0000fce0: 6f6e 5b0a 2020 2020 2020 2020 2020 2020  on[.            
+0000fcf0: 7374 722c 206d 6c72 756e 2e63 6f6d 6d6f  str, mlrun.commo
+0000fd00: 6e2e 7363 6865 6d61 732e 5069 7065 6c69  n.schemas.Pipeli
+0000fd10: 6e65 7346 6f72 6d61 740a 2020 2020 2020  nesFormat.      
+0000fd20: 2020 5d20 3d20 6d6c 7275 6e2e 636f 6d6d    ] = mlrun.comm
+0000fd30: 6f6e 2e73 6368 656d 6173 2e50 6970 656c  on.schemas.Pipel
+0000fd40: 696e 6573 466f 726d 6174 2e73 756d 6d61  inesFormat.summa
+0000fd50: 7279 2c0a 2020 2020 2020 2020 7072 6f6a  ry,.        proj
+0000fd60: 6563 743a 2073 7472 203d 204e 6f6e 652c  ect: str = None,
+0000fd70: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
+0000fd80: 2222 2252 6574 7269 6576 6520 6465 7461  """Retrieve deta
+0000fd90: 696c 7320 6f66 2061 2073 7065 6369 6669  ils of a specifi
+0000fda0: 6320 7069 7065 6c69 6e65 2075 7369 6e67  c pipeline using
+0000fdb0: 2069 7473 2072 756e 2049 4420 2861 7320   its run ID (as 
+0000fdc0: 7072 6f76 6964 6564 2077 6865 6e20 7468  provided when th
+0000fdd0: 6520 7069 7065 6c69 6e65 2077 6173 2065  e pipeline was e
+0000fde0: 7865 6375 7465 6429 2e22 2222 0a0a 2020  xecuted)."""..  
+0000fdf0: 2020 2020 2020 7472 793a 0a20 2020 2020        try:.     
+0000fe00: 2020 2020 2020 2070 6172 616d 7320 3d20         params = 
+0000fe10: 7b7d 0a20 2020 2020 2020 2020 2020 2069  {}.            i
+0000fe20: 6620 6e61 6d65 7370 6163 653a 0a20 2020  f namespace:.   
+0000fe30: 2020 2020 2020 2020 2020 2020 2070 6172               par
+0000fe40: 616d 735b 226e 616d 6573 7061 6365 225d  ams["namespace"]
+0000fe50: 203d 206e 616d 6573 7061 6365 0a20 2020   = namespace.   
+0000fe60: 2020 2020 2020 2020 2070 6172 616d 735b           params[
+0000fe70: 2266 6f72 6d61 7422 5d20 3d20 666f 726d  "format"] = form
+0000fe80: 6174 5f0a 2020 2020 2020 2020 2020 2020  at_.            
+0000fe90: 7072 6f6a 6563 745f 7061 7468 203d 2070  project_path = p
+0000fea0: 726f 6a65 6374 2069 6620 7072 6f6a 6563  roject if projec
+0000feb0: 7420 656c 7365 2022 2a22 0a20 2020 2020  t else "*".     
+0000fec0: 2020 2020 2020 2072 6573 7020 3d20 7365         resp = se
+0000fed0: 6c66 2e61 7069 5f63 616c 6c28 0a20 2020  lf.api_call(.   
+0000fee0: 2020 2020 2020 2020 2020 2020 2022 4745               "GE
+0000fef0: 5422 2c0a 2020 2020 2020 2020 2020 2020  T",.            
+0000ff00: 2020 2020 6622 7072 6f6a 6563 7473 2f7b      f"projects/{
+0000ff10: 7072 6f6a 6563 745f 7061 7468 7d2f 7069  project_path}/pi
+0000ff20: 7065 6c69 6e65 732f 7b72 756e 5f69 647d  pelines/{run_id}
+0000ff30: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+0000ff40: 2020 2070 6172 616d 733d 7061 7261 6d73     params=params
+0000ff50: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000ff60: 2020 7469 6d65 6f75 743d 7469 6d65 6f75    timeout=timeou
+0000ff70: 742c 0a20 2020 2020 2020 2020 2020 2029  t,.            )
+0000ff80: 0a20 2020 2020 2020 2065 7863 6570 7420  .        except 
+0000ff90: 4f53 4572 726f 7220 6173 2065 7272 3a0a  OSError as err:.
+0000ffa0: 2020 2020 2020 2020 2020 2020 6c6f 6767              logg
+0000ffb0: 6572 2e65 7272 6f72 2866 2265 7272 6f72  er.error(f"error
+0000ffc0: 2063 616e 6e6f 7420 6765 7420 7069 7065   cannot get pipe
+0000ffd0: 6c69 6e65 3a20 7b65 7272 5f74 6f5f 7374  line: {err_to_st
+0000ffe0: 7228 6572 7229 7d22 290a 2020 2020 2020  r(err)}").      
+0000fff0: 2020 2020 2020 7261 6973 6520 4f53 4572        raise OSEr
+00010000: 726f 7228 6622 6572 726f 723a 2063 616e  ror(f"error: can
+00010010: 6e6f 7420 6765 7420 7069 7065 6c69 6e65  not get pipeline
+00010020: 2c20 7b65 7272 5f74 6f5f 7374 7228 6572  , {err_to_str(er
+00010030: 7229 7d22 290a 0a20 2020 2020 2020 2069  r)}")..        i
+00010040: 6620 6e6f 7420 7265 7370 2e6f 6b3a 0a20  f not resp.ok:. 
+00010050: 2020 2020 2020 2020 2020 206c 6f67 6765             logge
+00010060: 722e 6572 726f 7228 6622 6261 6420 7265  r.error(f"bad re
+00010070: 7370 2121 5c6e 7b72 6573 702e 7465 7874  sp!!\n{resp.text
+00010080: 7d22 290a 2020 2020 2020 2020 2020 2020  }").            
+00010090: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+000100a0: 2866 2262 6164 2067 6574 2070 6970 656c  (f"bad get pipel
+000100b0: 696e 6520 7265 7370 6f6e 7365 2c20 7b72  ine response, {r
+000100c0: 6573 702e 7465 7874 7d22 290a 0a20 2020  esp.text}")..   
+000100d0: 2020 2020 2072 6574 7572 6e20 7265 7370       return resp
+000100e0: 2e6a 736f 6e28 290a 0a20 2020 2040 7374  .json()..    @st
+000100f0: 6174 6963 6d65 7468 6f64 0a20 2020 2064  aticmethod.    d
+00010100: 6566 205f 7265 736f 6c76 655f 7265 6665  ef _resolve_refe
+00010110: 7265 6e63 6528 7461 672c 2075 6964 293a  rence(tag, uid):
+00010120: 0a20 2020 2020 2020 2069 6620 7569 6420  .        if uid 
+00010130: 616e 6420 7461 673a 0a20 2020 2020 2020  and tag:.       
+00010140: 2020 2020 2072 6169 7365 204d 4c52 756e       raise MLRun
+00010150: 496e 7661 6c69 6441 7267 756d 656e 7445  InvalidArgumentE
+00010160: 7272 6f72 2822 626f 7468 2075 6964 2061  rror("both uid a
+00010170: 6e64 2074 6167 2077 6572 6520 7072 6f76  nd tag were prov
+00010180: 6964 6564 2229 0a20 2020 2020 2020 2072  ided").        r
+00010190: 6574 7572 6e20 7569 6420 6f72 2074 6167  eturn uid or tag
+000101a0: 206f 7220 226c 6174 6573 7422 0a0a 2020   or "latest"..  
+000101b0: 2020 6465 6620 6372 6561 7465 5f66 6561    def create_fea
+000101c0: 7475 7265 5f73 6574 280a 2020 2020 2020  ture_set(.      
+000101d0: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+000101e0: 6665 6174 7572 655f 7365 743a 2055 6e69  feature_set: Uni
+000101f0: 6f6e 5b64 6963 742c 206d 6c72 756e 2e63  on[dict, mlrun.c
+00010200: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 4665  ommon.schemas.Fe
+00010210: 6174 7572 6553 6574 2c20 4665 6174 7572  atureSet, Featur
+00010220: 6553 6574 5d2c 0a20 2020 2020 2020 2070  eSet],.        p
+00010230: 726f 6a65 6374 3d22 222c 0a20 2020 2020  roject="",.     
+00010240: 2020 2076 6572 7369 6f6e 6564 3d54 7275     versioned=Tru
+00010250: 652c 0a20 2020 2029 202d 3e20 6469 6374  e,.    ) -> dict
+00010260: 3a0a 2020 2020 2020 2020 2222 2243 7265  :.        """Cre
+00010270: 6174 6520 6120 6e65 7720 3a70 793a 636c  ate a new :py:cl
+00010280: 6173 733a 607e 6d6c 7275 6e2e 6665 6174  ass:`~mlrun.feat
+00010290: 7572 655f 7374 6f72 652e 4665 6174 7572  ure_store.Featur
+000102a0: 6553 6574 6020 616e 6420 7361 7665 2069  eSet` and save i
+000102b0: 6e20 7468 6520 3a70 793a 6d6f 643a 606d  n the :py:mod:`m
+000102c0: 6c72 756e 6020 4442 2e20 5468 650a 2020  lrun` DB. The.  
+000102d0: 2020 2020 2020 6665 6174 7572 652d 7365        feature-se
+000102e0: 7420 6d75 7374 206e 6f74 2070 7265 7669  t must not previ
+000102f0: 6f75 736c 7920 6578 6973 7420 696e 2074  ously exist in t
+00010300: 6865 2044 422e 0a0a 2020 2020 2020 2020  he DB...        
+00010310: 3a70 6172 616d 2066 6561 7475 7265 5f73  :param feature_s
+00010320: 6574 3a20 5468 6520 6e65 7720 3a70 793a  et: The new :py:
+00010330: 636c 6173 733a 607e 6d6c 7275 6e2e 6665  class:`~mlrun.fe
+00010340: 6174 7572 655f 7374 6f72 652e 4665 6174  ature_store.Feat
+00010350: 7572 6553 6574 6020 746f 2063 7265 6174  ureSet` to creat
+00010360: 652e 0a20 2020 2020 2020 203a 7061 7261  e..        :para
+00010370: 6d20 7072 6f6a 6563 743a 204e 616d 6520  m project: Name 
+00010380: 6f66 2070 726f 6a65 6374 2074 6869 7320  of project this 
+00010390: 6665 6174 7572 652d 7365 7420 6265 6c6f  feature-set belo
+000103a0: 6e67 7320 746f 2e0a 2020 2020 2020 2020  ngs to..        
+000103b0: 3a70 6172 616d 2076 6572 7369 6f6e 6564  :param versioned
+000103c0: 3a20 5768 6574 6865 7220 746f 206d 6169  : Whether to mai
+000103d0: 6e74 6169 6e20 7665 7273 696f 6e73 2066  ntain versions f
+000103e0: 6f72 2074 6869 7320 6665 6174 7572 652d  or this feature-
+000103f0: 7365 742e 2041 6c6c 2076 6572 7369 6f6e  set. All version
+00010400: 7320 6f66 2061 2076 6572 7369 6f6e 6564  s of a versioned
+00010410: 206f 626a 6563 740a 2020 2020 2020 2020   object.        
+00010420: 2020 2020 7769 6c6c 2062 6520 6b65 7074      will be kept
+00010430: 2069 6e20 7468 6520 4442 2061 6e64 2063   in the DB and c
+00010440: 616e 2062 6520 7265 7472 6965 7665 6420  an be retrieved 
+00010450: 756e 7469 6c20 6578 706c 6963 6974 6c79  until explicitly
+00010460: 2064 656c 6574 6564 2e0a 2020 2020 2020   deleted..      
+00010470: 2020 3a72 6574 7572 6e73 3a20 5468 6520    :returns: The 
+00010480: 3a70 793a 636c 6173 733a 607e 6d6c 7275  :py:class:`~mlru
+00010490: 6e2e 6665 6174 7572 655f 7374 6f72 652e  n.feature_store.
+000104a0: 4665 6174 7572 6553 6574 6020 6f62 6a65  FeatureSet` obje
+000104b0: 6374 2028 6173 2064 6963 7429 2e0a 2020  ct (as dict)..  
+000104c0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+000104d0: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+000104e0: 6665 6174 7572 655f 7365 742c 206d 6c72  feature_set, mlr
+000104f0: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
+00010500: 732e 4665 6174 7572 6553 6574 293a 0a20  s.FeatureSet):. 
+00010510: 2020 2020 2020 2020 2020 2066 6561 7475             featu
+00010520: 7265 5f73 6574 203d 2066 6561 7475 7265  re_set = feature
+00010530: 5f73 6574 2e64 6963 7428 290a 2020 2020  _set.dict().    
+00010540: 2020 2020 656c 6966 2069 7369 6e73 7461      elif isinsta
+00010550: 6e63 6528 6665 6174 7572 655f 7365 742c  nce(feature_set,
+00010560: 2046 6561 7475 7265 5365 7429 3a0a 2020   FeatureSet):.  
+00010570: 2020 2020 2020 2020 2020 6665 6174 7572            featur
+00010580: 655f 7365 7420 3d20 6665 6174 7572 655f  e_set = feature_
+00010590: 7365 742e 746f 5f64 6963 7428 290a 0a20  set.to_dict().. 
+000105a0: 2020 2020 2020 2070 726f 6a65 6374 203d         project =
+000105b0: 2028 0a20 2020 2020 2020 2020 2020 2070   (.            p
+000105c0: 726f 6a65 6374 0a20 2020 2020 2020 2020  roject.         
+000105d0: 2020 206f 7220 6665 6174 7572 655f 7365     or feature_se
+000105e0: 745b 226d 6574 6164 6174 6122 5d2e 6765  t["metadata"].ge
+000105f0: 7428 2270 726f 6a65 6374 222c 204e 6f6e  t("project", Non
+00010600: 6529 0a20 2020 2020 2020 2020 2020 206f  e).            o
+00010610: 7220 636f 6e66 6967 2e64 6566 6175 6c74  r config.default
+00010620: 5f70 726f 6a65 6374 0a20 2020 2020 2020  _project.       
+00010630: 2029 0a20 2020 2020 2020 2070 6174 6820   ).        path 
+00010640: 3d20 6622 7072 6f6a 6563 7473 2f7b 7072  = f"projects/{pr
+00010650: 6f6a 6563 747d 2f66 6561 7475 7265 2d73  oject}/feature-s
+00010660: 6574 7322 0a20 2020 2020 2020 2070 6172  ets".        par
+00010670: 616d 7320 3d20 7b22 7665 7273 696f 6e65  ams = {"versione
+00010680: 6422 3a20 7665 7273 696f 6e65 647d 0a0a  d": versioned}..
+00010690: 2020 2020 2020 2020 6e61 6d65 203d 2066          name = f
+000106a0: 6561 7475 7265 5f73 6574 5b22 6d65 7461  eature_set["meta
+000106b0: 6461 7461 225d 5b22 6e61 6d65 225d 0a20  data"]["name"]. 
+000106c0: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
+000106d0: 7361 6765 203d 2066 2246 6169 6c65 6420  sage = f"Failed 
+000106e0: 6372 6561 7469 6e67 2066 6561 7475 7265  creating feature
+000106f0: 2d73 6574 207b 7072 6f6a 6563 747d 2f7b  -set {project}/{
+00010700: 6e61 6d65 7d22 0a20 2020 2020 2020 2072  name}".        r
+00010710: 6573 7020 3d20 7365 6c66 2e61 7069 5f63  esp = self.api_c
+00010720: 616c 6c28 0a20 2020 2020 2020 2020 2020  all(.           
+00010730: 2022 504f 5354 222c 0a20 2020 2020 2020   "POST",.       
+00010740: 2020 2020 2070 6174 682c 0a20 2020 2020       path,.     
+00010750: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
+00010760: 7361 6765 2c0a 2020 2020 2020 2020 2020  sage,.          
+00010770: 2020 7061 7261 6d73 3d70 6172 616d 732c    params=params,
+00010780: 0a20 2020 2020 2020 2020 2020 2062 6f64  .            bod
+00010790: 793d 6469 6374 5f74 6f5f 6a73 6f6e 2866  y=dict_to_json(f
+000107a0: 6561 7475 7265 5f73 6574 292c 0a20 2020  eature_set),.   
+000107b0: 2020 2020 2029 0a20 2020 2020 2020 2072       ).        r
+000107c0: 6574 7572 6e20 7265 7370 2e6a 736f 6e28  eturn resp.json(
+000107d0: 290a 0a20 2020 2064 6566 2067 6574 5f66  )..    def get_f
+000107e0: 6561 7475 7265 5f73 6574 280a 2020 2020  eature_set(.    
+000107f0: 2020 2020 7365 6c66 2c20 6e61 6d65 3a20      self, name: 
+00010800: 7374 722c 2070 726f 6a65 6374 3a20 7374  str, project: st
+00010810: 7220 3d20 2222 2c20 7461 673a 2073 7472  r = "", tag: str
+00010820: 203d 204e 6f6e 652c 2075 6964 3a20 7374   = None, uid: st
+00010830: 7220 3d20 4e6f 6e65 0a20 2020 2029 202d  r = None.    ) -
+00010840: 3e20 4665 6174 7572 6553 6574 3a0a 2020  > FeatureSet:.  
+00010850: 2020 2020 2020 2222 2252 6574 7269 6576        """Retriev
+00010860: 6520 6120 7e6d 6c72 756e 2e66 6561 7475  e a ~mlrun.featu
+00010870: 7265 5f73 746f 7265 2e46 6561 7475 7265  re_store.Feature
+00010880: 5365 7460 206f 626a 6563 742e 2049 6620  Set` object. If 
+00010890: 626f 7468 2060 6074 6167 6060 2061 6e64  both ``tag`` and
+000108a0: 2060 6075 6964 6060 2061 7265 206e 6f74   ``uid`` are not
+000108b0: 2073 7065 6369 6669 6564 2c20 7468 656e   specified, then
+000108c0: 0a20 2020 2020 2020 2074 6865 206f 626a  .        the obj
+000108d0: 6563 7420 7461 6767 6564 2060 606c 6174  ect tagged ``lat
+000108e0: 6573 7460 6020 7769 6c6c 2062 6520 7265  est`` will be re
+000108f0: 7472 6965 7665 642e 0a0a 2020 2020 2020  trieved...      
+00010900: 2020 3a70 6172 616d 206e 616d 653a 204e    :param name: N
+00010910: 616d 6520 6f66 206f 626a 6563 7420 746f  ame of object to
+00010920: 2072 6574 7269 6576 652e 0a20 2020 2020   retrieve..     
+00010930: 2020 203a 7061 7261 6d20 7072 6f6a 6563     :param projec
+00010940: 743a 2050 726f 6a65 6374 2074 6865 2046  t: Project the F
+00010950: 6561 7475 7265 5365 7420 6265 6c6f 6e67  eatureSet belong
+00010960: 7320 746f 2e0a 2020 2020 2020 2020 3a70  s to..        :p
+00010970: 6172 616d 2074 6167 3a20 5461 6720 6f66  aram tag: Tag of
+00010980: 2074 6865 2073 7065 6369 6669 6320 6f62   the specific ob
+00010990: 6a65 6374 2076 6572 7369 6f6e 2074 6f20  ject version to 
+000109a0: 7265 7472 6965 7665 2e0a 2020 2020 2020  retrieve..      
+000109b0: 2020 3a70 6172 616d 2075 6964 3a20 7569    :param uid: ui
+000109c0: 6420 6f66 2074 6865 206f 626a 6563 7420  d of the object 
+000109d0: 746f 2072 6574 7269 6576 6520 2863 616e  to retrieve (can
+000109e0: 206f 6e6c 7920 6265 2075 7365 6420 666f   only be used fo
+000109f0: 7220 7665 7273 696f 6e65 6420 6f62 6a65  r versioned obje
+00010a00: 6374 7329 2e0a 2020 2020 2020 2020 2222  cts)..        ""
+00010a10: 220a 0a20 2020 2020 2020 2070 726f 6a65  "..        proje
+00010a20: 6374 203d 2070 726f 6a65 6374 206f 7220  ct = project or 
+00010a30: 636f 6e66 6967 2e64 6566 6175 6c74 5f70  config.default_p
+00010a40: 726f 6a65 6374 0a20 2020 2020 2020 2072  roject.        r
+00010a50: 6566 6572 656e 6365 203d 2073 656c 662e  eference = self.
+00010a60: 5f72 6573 6f6c 7665 5f72 6566 6572 656e  _resolve_referen
+00010a70: 6365 2874 6167 2c20 7569 6429 0a20 2020  ce(tag, uid).   
+00010a80: 2020 2020 2070 6174 6820 3d20 6622 7072       path = f"pr
+00010a90: 6f6a 6563 7473 2f7b 7072 6f6a 6563 747d  ojects/{project}
+00010aa0: 2f66 6561 7475 7265 2d73 6574 732f 7b6e  /feature-sets/{n
+00010ab0: 616d 657d 2f72 6566 6572 656e 6365 732f  ame}/references/
+00010ac0: 7b72 6566 6572 656e 6365 7d22 0a20 2020  {reference}".   
+00010ad0: 2020 2020 2065 7272 6f72 5f6d 6573 7361       error_messa
+00010ae0: 6765 203d 2066 2246 6169 6c65 6420 7265  ge = f"Failed re
+00010af0: 7472 6965 7669 6e67 2066 6561 7475 7265  trieving feature
+00010b00: 2d73 6574 207b 7072 6f6a 6563 747d 2f7b  -set {project}/{
+00010b10: 6e61 6d65 7d22 0a20 2020 2020 2020 2072  name}".        r
+00010b20: 6573 7020 3d20 7365 6c66 2e61 7069 5f63  esp = self.api_c
+00010b30: 616c 6c28 2247 4554 222c 2070 6174 682c  all("GET", path,
+00010b40: 2065 7272 6f72 5f6d 6573 7361 6765 290a   error_message).
+00010b50: 2020 2020 2020 2020 7265 7475 726e 2046          return F
+00010b60: 6561 7475 7265 5365 742e 6672 6f6d 5f64  eatureSet.from_d
+00010b70: 6963 7428 7265 7370 2e6a 736f 6e28 2929  ict(resp.json())
+00010b80: 0a0a 2020 2020 6465 6620 6c69 7374 5f66  ..    def list_f
+00010b90: 6561 7475 7265 7328 0a20 2020 2020 2020  eatures(.       
+00010ba0: 2073 656c 662c 0a20 2020 2020 2020 2070   self,.        p
+00010bb0: 726f 6a65 6374 3a20 7374 722c 0a20 2020  roject: str,.   
+00010bc0: 2020 2020 206e 616d 653a 2073 7472 203d       name: str =
+00010bd0: 204e 6f6e 652c 0a20 2020 2020 2020 2074   None,.        t
+00010be0: 6167 3a20 7374 7220 3d20 4e6f 6e65 2c0a  ag: str = None,.
+00010bf0: 2020 2020 2020 2020 656e 7469 7469 6573          entities
+00010c00: 3a20 4c69 7374 5b73 7472 5d20 3d20 4e6f  : List[str] = No
+00010c10: 6e65 2c0a 2020 2020 2020 2020 6c61 6265  ne,.        labe
+00010c20: 6c73 3a20 4c69 7374 5b73 7472 5d20 3d20  ls: List[str] = 
+00010c30: 4e6f 6e65 2c0a 2020 2020 2920 2d3e 204c  None,.    ) -> L
+00010c40: 6973 745b 6469 6374 5d3a 0a20 2020 2020  ist[dict]:.     
+00010c50: 2020 2022 2222 4c69 7374 2066 6561 7475     """List featu
+00010c60: 7265 2d73 6574 7320 7768 6963 6820 636f  re-sets which co
+00010c70: 6e74 6169 6e20 7370 6563 6966 6963 2066  ntain specific f
+00010c80: 6561 7475 7265 732e 2054 6869 7320 6675  eatures. This fu
+00010c90: 6e63 7469 6f6e 206d 6179 2072 6574 7572  nction may retur
+00010ca0: 6e20 6d75 6c74 6970 6c65 2076 6572 7369  n multiple versi
+00010cb0: 6f6e 7320 6f66 2074 6865 2073 616d 650a  ons of the same.
+00010cc0: 2020 2020 2020 2020 6665 6174 7572 652d          feature-
+00010cd0: 7365 7420 6966 2061 2073 7065 6369 6669  set if a specifi
+00010ce0: 6320 7461 6720 6973 206e 6f74 2072 6571  c tag is not req
+00010cf0: 7565 7374 6564 2e20 4e6f 7465 2074 6861  uested. Note tha
+00010d00: 7420 7468 6520 7661 7269 6f75 7320 6669  t the various fi
+00010d10: 6c74 6572 7320 6f66 2074 6869 7320 6675  lters of this fu
+00010d20: 6e63 7469 6f6e 2061 6374 7561 6c6c 790a  nction actually.
+00010d30: 2020 2020 2020 2020 7265 6665 7220 746f          refer to
+00010d40: 2074 6865 2066 6561 7475 7265 2d73 6574   the feature-set
+00010d50: 206f 626a 6563 7420 636f 6e74 6169 6e69   object containi
+00010d60: 6e67 2074 6865 2066 6561 7475 7265 732c  ng the features,
+00010d70: 206e 6f74 2074 6f20 7468 6520 6665 6174   not to the feat
+00010d80: 7572 6573 2074 6865 6d73 656c 7665 732e  ures themselves.
+00010d90: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00010da0: 2070 726f 6a65 6374 3a20 5072 6f6a 6563   project: Projec
+00010db0: 7420 7768 6963 6820 636f 6e74 6169 6e73  t which contains
+00010dc0: 2074 6865 7365 2066 6561 7475 7265 732e   these features.
+00010dd0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00010de0: 6e61 6d65 3a20 4e61 6d65 206f 6620 7468  name: Name of th
+00010df0: 6520 6665 6174 7572 6520 746f 206c 6f6f  e feature to loo
+00010e00: 6b20 666f 722e 2054 6865 206e 616d 6520  k for. The name 
+00010e10: 6973 2075 7365 6420 696e 2061 206c 696b  is used in a lik
+00010e20: 6520 7175 6572 792c 2061 6e64 2069 7320  e query, and is 
+00010e30: 6e6f 7420 6361 7365 2d73 656e 7369 7469  not case-sensiti
+00010e40: 7665 2e20 466f 720a 2020 2020 2020 2020  ve. For.        
+00010e50: 2020 2020 6578 616d 706c 652c 206c 6f6f      example, loo
+00010e60: 6b69 6e67 2066 6f72 2060 6066 6561 7460  king for ``feat`
+00010e70: 6020 7769 6c6c 2072 6574 7572 6e20 6665  ` will return fe
+00010e80: 6174 7572 6573 2077 6869 6368 2061 7265  atures which are
+00010e90: 206e 616d 6564 2060 604d 7946 6561 7475   named ``MyFeatu
+00010ea0: 7265 6060 2061 7320 7765 6c6c 2061 7320  re`` as well as 
+00010eb0: 6060 6465 6665 6174 6060 2e0a 2020 2020  ``defeat``..    
+00010ec0: 2020 2020 3a70 6172 616d 2074 6167 3a20      :param tag: 
+00010ed0: 5265 7475 726e 2066 6561 7475 7265 2d73  Return feature-s
+00010ee0: 6574 7320 7768 6963 6820 636f 6e74 6169  ets which contai
+00010ef0: 6e20 7468 6520 6665 6174 7572 6573 206c  n the features l
+00010f00: 6f6f 6b65 6420 666f 722c 2061 6e64 2061  ooked for, and a
+00010f10: 7265 2074 6167 6765 6420 7769 7468 2074  re tagged with t
+00010f20: 6865 2073 7065 6369 6669 6320 7461 672e  he specific tag.
+00010f30: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00010f40: 656e 7469 7469 6573 3a20 5265 7475 726e  entities: Return
+00010f50: 206f 6e6c 7920 6665 6174 7572 652d 7365   only feature-se
+00010f60: 7473 2077 6869 6368 2063 6f6e 7461 696e  ts which contain
+00010f70: 2061 6e20 656e 7469 7479 2077 686f 7365   an entity whose
+00010f80: 206e 616d 6520 6973 2063 6f6e 7461 696e   name is contain
+00010f90: 6564 2069 6e20 7468 6973 206c 6973 742e  ed in this list.
+00010fa0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00010fb0: 6c61 6265 6c73 3a20 5265 7475 726e 206f  labels: Return o
+00010fc0: 6e6c 7920 6665 6174 7572 652d 7365 7473  nly feature-sets
+00010fd0: 2077 6869 6368 2061 7265 206c 6162 656c   which are label
+00010fe0: 6564 2061 7320 7265 7175 6573 7465 642e  ed as requested.
+00010ff0: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
+00011000: 733a 2041 206c 6973 7420 6f66 206d 6170  s: A list of map
+00011010: 7069 6e67 2066 726f 6d20 6665 6174 7572  ping from featur
+00011020: 6520 746f 2061 2064 6967 6573 7420 6f66  e to a digest of
+00011030: 2074 6865 2066 6561 7475 7265 2d73 6574   the feature-set
+00011040: 2c20 7768 6963 6820 636f 6e74 6169 6e73  , which contains
+00011050: 2074 6865 2066 6561 7475 7265 2d73 6574   the feature-set
+00011060: 0a20 2020 2020 2020 2020 2020 206d 6574  .            met
+00011070: 612d 6461 7461 2e20 4d75 6c74 6970 6c65  a-data. Multiple
+00011080: 2065 6e74 7269 6573 206d 6179 2062 6520   entries may be 
+00011090: 7265 7475 726e 6564 2066 6f72 2061 6e79  returned for any
+000110a0: 2073 7065 6369 6669 6320 6665 6174 7572   specific featur
+000110b0: 6520 6475 6520 746f 206d 756c 7469 706c  e due to multipl
+000110c0: 6520 7461 6773 206f 7220 7665 7273 696f  e tags or versio
+000110d0: 6e73 0a20 2020 2020 2020 2020 2020 206f  ns.            o
+000110e0: 6620 7468 6520 6665 6174 7572 652d 7365  f the feature-se
+000110f0: 742e 0a20 2020 2020 2020 2022 2222 0a0a  t..        """..
+00011100: 2020 2020 2020 2020 7072 6f6a 6563 7420          project 
+00011110: 3d20 7072 6f6a 6563 7420 6f72 2063 6f6e  = project or con
+00011120: 6669 672e 6465 6661 756c 745f 7072 6f6a  fig.default_proj
+00011130: 6563 740a 2020 2020 2020 2020 7061 7261  ect.        para
+00011140: 6d73 203d 207b 0a20 2020 2020 2020 2020  ms = {.         
+00011150: 2020 2022 6e61 6d65 223a 206e 616d 652c     "name": name,
+00011160: 0a20 2020 2020 2020 2020 2020 2022 7461  .            "ta
+00011170: 6722 3a20 7461 672c 0a20 2020 2020 2020  g": tag,.       
+00011180: 2020 2020 2022 656e 7469 7479 223a 2065       "entity": e
+00011190: 6e74 6974 6965 7320 6f72 205b 5d2c 0a20  ntities or [],. 
+000111a0: 2020 2020 2020 2020 2020 2022 6c61 6265             "labe
+000111b0: 6c22 3a20 6c61 6265 6c73 206f 7220 5b5d  l": labels or []
+000111c0: 2c0a 2020 2020 2020 2020 7d0a 0a20 2020  ,.        }..   
+000111d0: 2020 2020 2070 6174 6820 3d20 6622 7072       path = f"pr
+000111e0: 6f6a 6563 7473 2f7b 7072 6f6a 6563 747d  ojects/{project}
+000111f0: 2f66 6561 7475 7265 7322 0a0a 2020 2020  /features"..    
+00011200: 2020 2020 6572 726f 725f 6d65 7373 6167      error_messag
+00011210: 6520 3d20 6622 4661 696c 6564 206c 6973  e = f"Failed lis
+00011220: 7469 6e67 2066 6561 7475 7265 732c 2070  ting features, p
+00011230: 726f 6a65 6374 3a20 7b70 726f 6a65 6374  roject: {project
+00011240: 7d2c 2071 7565 7279 3a20 7b70 6172 616d  }, query: {param
+00011250: 737d 220a 2020 2020 2020 2020 7265 7370  s}".        resp
+00011260: 203d 2073 656c 662e 6170 695f 6361 6c6c   = self.api_call
+00011270: 2822 4745 5422 2c20 7061 7468 2c20 6572  ("GET", path, er
+00011280: 726f 725f 6d65 7373 6167 652c 2070 6172  ror_message, par
+00011290: 616d 733d 7061 7261 6d73 290a 2020 2020  ams=params).    
+000112a0: 2020 2020 7265 7475 726e 2072 6573 702e      return resp.
+000112b0: 6a73 6f6e 2829 5b22 6665 6174 7572 6573  json()["features
+000112c0: 225d 0a0a 2020 2020 6465 6620 6c69 7374  "]..    def list
+000112d0: 5f65 6e74 6974 6965 7328 0a20 2020 2020  _entities(.     
+000112e0: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+000112f0: 2070 726f 6a65 6374 3a20 7374 722c 0a20   project: str,. 
+00011300: 2020 2020 2020 206e 616d 653a 2073 7472         name: str
+00011310: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+00011320: 2074 6167 3a20 7374 7220 3d20 4e6f 6e65   tag: str = None
+00011330: 2c0a 2020 2020 2020 2020 6c61 6265 6c73  ,.        labels
+00011340: 3a20 4c69 7374 5b73 7472 5d20 3d20 4e6f  : List[str] = No
+00011350: 6e65 2c0a 2020 2020 2920 2d3e 204c 6973  ne,.    ) -> Lis
+00011360: 745b 6469 6374 5d3a 0a20 2020 2020 2020  t[dict]:.       
+00011370: 2022 2222 5265 7472 6965 7665 2061 206c   """Retrieve a l
+00011380: 6973 7420 6f66 2065 6e74 6974 6965 7320  ist of entities 
+00011390: 616e 6420 7468 6569 7220 6d61 7070 696e  and their mappin
+000113a0: 6720 746f 2074 6865 2063 6f6e 7461 696e  g to the contain
+000113b0: 696e 6720 6665 6174 7572 652d 7365 7473  ing feature-sets
+000113c0: 2e20 5468 6973 2066 756e 6374 696f 6e20  . This function 
+000113d0: 6973 2073 696d 696c 6172 0a20 2020 2020  is similar.     
+000113e0: 2020 2074 6f20 7468 6520 3a70 793a 6675     to the :py:fu
+000113f0: 6e63 3a60 7e6c 6973 745f 6665 6174 7572  nc:`~list_featur
+00011400: 6573 6020 6675 6e63 7469 6f6e 2c20 616e  es` function, an
+00011410: 6420 7573 6573 2074 6865 2073 616d 6520  d uses the same 
+00011420: 6c6f 6769 632e 2048 6f77 6576 6572 2c20  logic. However, 
+00011430: 7468 6520 656e 7469 7469 6573 2061 7265  the entities are
+00011440: 206d 6174 6368 6564 0a20 2020 2020 2020   matched.       
+00011450: 2061 6761 696e 7374 2074 6865 206e 616d   against the nam
+00011460: 6520 7261 7468 6572 2074 6861 6e20 7468  e rather than th
+00011470: 6520 6665 6174 7572 6573 2e0a 2020 2020  e features..    
+00011480: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
+00011490: 2070 726f 6a65 6374 203d 2070 726f 6a65   project = proje
+000114a0: 6374 206f 7220 636f 6e66 6967 2e64 6566  ct or config.def
+000114b0: 6175 6c74 5f70 726f 6a65 6374 0a20 2020  ault_project.   
+000114c0: 2020 2020 2070 6172 616d 7320 3d20 7b0a       params = {.
+000114d0: 2020 2020 2020 2020 2020 2020 226e 616d              "nam
+000114e0: 6522 3a20 6e61 6d65 2c0a 2020 2020 2020  e": name,.      
+000114f0: 2020 2020 2020 2274 6167 223a 2074 6167        "tag": tag
+00011500: 2c0a 2020 2020 2020 2020 2020 2020 226c  ,.            "l
+00011510: 6162 656c 223a 206c 6162 656c 7320 6f72  abel": labels or
+00011520: 205b 5d2c 0a20 2020 2020 2020 207d 0a0a   [],.        }..
+00011530: 2020 2020 2020 2020 7061 7468 203d 2066          path = f
+00011540: 2270 726f 6a65 6374 732f 7b70 726f 6a65  "projects/{proje
+00011550: 6374 7d2f 656e 7469 7469 6573 220a 0a20  ct}/entities".. 
+00011560: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
+00011570: 7361 6765 203d 2066 2246 6169 6c65 6420  sage = f"Failed 
+00011580: 6c69 7374 696e 6720 656e 7469 7469 6573  listing entities
+00011590: 2c20 7072 6f6a 6563 743a 207b 7072 6f6a  , project: {proj
+000115a0: 6563 747d 2c20 7175 6572 793a 207b 7061  ect}, query: {pa
+000115b0: 7261 6d73 7d22 0a20 2020 2020 2020 2072  rams}".        r
+000115c0: 6573 7020 3d20 7365 6c66 2e61 7069 5f63  esp = self.api_c
+000115d0: 616c 6c28 2247 4554 222c 2070 6174 682c  all("GET", path,
+000115e0: 2065 7272 6f72 5f6d 6573 7361 6765 2c20   error_message, 
+000115f0: 7061 7261 6d73 3d70 6172 616d 7329 0a20  params=params). 
+00011600: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
+00011610: 7370 2e6a 736f 6e28 295b 2265 6e74 6974  sp.json()["entit
+00011620: 6965 7322 5d0a 0a20 2020 2040 7374 6174  ies"]..    @stat
+00011630: 6963 6d65 7468 6f64 0a20 2020 2064 6566  icmethod.    def
+00011640: 205f 6765 6e65 7261 7465 5f70 6172 7469   _generate_parti
+00011650: 7469 6f6e 5f62 795f 7061 7261 6d73 280a  tion_by_params(.
+00011660: 2020 2020 2020 2020 7061 7274 6974 696f          partitio
+00011670: 6e5f 6279 5f63 6c73 2c0a 2020 2020 2020  n_by_cls,.      
+00011680: 2020 7061 7274 6974 696f 6e5f 6279 2c0a    partition_by,.
+00011690: 2020 2020 2020 2020 726f 7773 5f70 6572          rows_per
+000116a0: 5f70 6172 7469 7469 6f6e 2c0a 2020 2020  _partition,.    
+000116b0: 2020 2020 736f 7274 5f62 792c 0a20 2020      sort_by,.   
+000116c0: 2020 2020 206f 7264 6572 2c0a 2020 2020       order,.    
+000116d0: 2020 2020 6d61 785f 7061 7274 6974 696f      max_partitio
+000116e0: 6e73 3d4e 6f6e 652c 0a20 2020 2029 3a0a  ns=None,.    ):.
+000116f0: 0a20 2020 2020 2020 2070 6172 7469 7469  .        partiti
+00011700: 6f6e 5f70 6172 616d 7320 3d20 7b0a 2020  on_params = {.  
+00011710: 2020 2020 2020 2020 2020 2270 6172 7469            "parti
+00011720: 7469 6f6e 2d62 7922 3a20 7061 7274 6974  tion-by": partit
+00011730: 696f 6e5f 6279 2c0a 2020 2020 2020 2020  ion_by,.        
+00011740: 2020 2020 2272 6f77 732d 7065 722d 7061      "rows-per-pa
+00011750: 7274 6974 696f 6e22 3a20 726f 7773 5f70  rtition": rows_p
+00011760: 6572 5f70 6172 7469 7469 6f6e 2c0a 2020  er_partition,.  
+00011770: 2020 2020 2020 2020 2020 2270 6172 7469            "parti
+00011780: 7469 6f6e 2d73 6f72 742d 6279 223a 2073  tion-sort-by": s
+00011790: 6f72 745f 6279 2c0a 2020 2020 2020 2020  ort_by,.        
+000117a0: 2020 2020 2270 6172 7469 7469 6f6e 2d6f      "partition-o
+000117b0: 7264 6572 223a 206f 7264 6572 2c0a 2020  rder": order,.  
+000117c0: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
+000117d0: 6966 206d 6178 5f70 6172 7469 7469 6f6e  if max_partition
+000117e0: 7320 6973 206e 6f74 204e 6f6e 653a 0a20  s is not None:. 
+000117f0: 2020 2020 2020 2020 2020 2070 6172 7469             parti
+00011800: 7469 6f6e 5f70 6172 616d 735b 226d 6178  tion_params["max
+00011810: 2d70 6172 7469 7469 6f6e 7322 5d20 3d20  -partitions"] = 
+00011820: 6d61 785f 7061 7274 6974 696f 6e73 0a20  max_partitions. 
+00011830: 2020 2020 2020 2072 6574 7572 6e20 7061         return pa
+00011840: 7274 6974 696f 6e5f 7061 7261 6d73 0a0a  rtition_params..
+00011850: 2020 2020 6465 6620 6c69 7374 5f66 6561      def list_fea
+00011860: 7475 7265 5f73 6574 7328 0a20 2020 2020  ture_sets(.     
+00011870: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+00011880: 2070 726f 6a65 6374 3a20 7374 7220 3d20   project: str = 
+00011890: 2222 2c0a 2020 2020 2020 2020 6e61 6d65  "",.        name
+000118a0: 3a20 7374 7220 3d20 4e6f 6e65 2c0a 2020  : str = None,.  
+000118b0: 2020 2020 2020 7461 673a 2073 7472 203d        tag: str =
+000118c0: 204e 6f6e 652c 0a20 2020 2020 2020 2073   None,.        s
+000118d0: 7461 7465 3a20 7374 7220 3d20 4e6f 6e65  tate: str = None
+000118e0: 2c0a 2020 2020 2020 2020 656e 7469 7469  ,.        entiti
+000118f0: 6573 3a20 4c69 7374 5b73 7472 5d20 3d20  es: List[str] = 
+00011900: 4e6f 6e65 2c0a 2020 2020 2020 2020 6665  None,.        fe
+00011910: 6174 7572 6573 3a20 4c69 7374 5b73 7472  atures: List[str
+00011920: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
+00011930: 2020 6c61 6265 6c73 3a20 4c69 7374 5b73    labels: List[s
+00011940: 7472 5d20 3d20 4e6f 6e65 2c0a 2020 2020  tr] = None,.    
+00011950: 2020 2020 7061 7274 6974 696f 6e5f 6279      partition_by
+00011960: 3a20 556e 696f 6e5b 0a20 2020 2020 2020  : Union[.       
+00011970: 2020 2020 206d 6c72 756e 2e63 6f6d 6d6f       mlrun.commo
+00011980: 6e2e 7363 6865 6d61 732e 4665 6174 7572  n.schemas.Featur
+00011990: 6553 746f 7265 5061 7274 6974 696f 6e42  eStorePartitionB
+000119a0: 7946 6965 6c64 2c20 7374 720a 2020 2020  yField, str.    
+000119b0: 2020 2020 5d20 3d20 4e6f 6e65 2c0a 2020      ] = None,.  
+000119c0: 2020 2020 2020 726f 7773 5f70 6572 5f70        rows_per_p
+000119d0: 6172 7469 7469 6f6e 3a20 696e 7420 3d20  artition: int = 
+000119e0: 312c 0a20 2020 2020 2020 2070 6172 7469  1,.        parti
+000119f0: 7469 6f6e 5f73 6f72 745f 6279 3a20 556e  tion_sort_by: Un
+00011a00: 696f 6e5b 6d6c 7275 6e2e 636f 6d6d 6f6e  ion[mlrun.common
+00011a10: 2e73 6368 656d 6173 2e53 6f72 7446 6965  .schemas.SortFie
+00011a20: 6c64 2c20 7374 725d 203d 204e 6f6e 652c  ld, str] = None,
+00011a30: 0a20 2020 2020 2020 2070 6172 7469 7469  .        partiti
+00011a40: 6f6e 5f6f 7264 6572 3a20 556e 696f 6e5b  on_order: Union[
+00011a50: 0a20 2020 2020 2020 2020 2020 206d 6c72  .            mlr
+00011a60: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
+00011a70: 732e 4f72 6465 7254 7970 652c 2073 7472  s.OrderType, str
+00011a80: 0a20 2020 2020 2020 205d 203d 206d 6c72  .        ] = mlr
+00011a90: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
+00011aa0: 732e 4f72 6465 7254 7970 652e 6465 7363  s.OrderType.desc
+00011ab0: 2c0a 2020 2020 2920 2d3e 204c 6973 745b  ,.    ) -> List[
+00011ac0: 4665 6174 7572 6553 6574 5d3a 0a20 2020  FeatureSet]:.   
+00011ad0: 2020 2020 2022 2222 5265 7472 6965 7665       """Retrieve
+00011ae0: 2061 206c 6973 7420 6f66 2066 6561 7475   a list of featu
+00011af0: 7265 2d73 6574 7320 6d61 7463 6869 6e67  re-sets matching
+00011b00: 2074 6865 2063 7269 7465 7269 6120 7072   the criteria pr
+00011b10: 6f76 6964 6564 2e0a 0a20 2020 2020 2020  ovided...       
+00011b20: 203a 7061 7261 6d20 7072 6f6a 6563 743a   :param project:
+00011b30: 2050 726f 6a65 6374 206e 616d 652e 0a20   Project name.. 
+00011b40: 2020 2020 2020 203a 7061 7261 6d20 6e61         :param na
+00011b50: 6d65 3a20 4e61 6d65 206f 6620 6665 6174  me: Name of feat
+00011b60: 7572 652d 7365 7420 746f 206d 6174 6368  ure-set to match
+00011b70: 2e20 5468 6973 2069 7320 6120 6c69 6b65  . This is a like
+00011b80: 2071 7565 7279 2c20 616e 6420 6973 2063   query, and is c
+00011b90: 6173 652d 696e 7365 6e73 6974 6976 652e  ase-insensitive.
+00011ba0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00011bb0: 7461 673a 204d 6174 6368 2066 6561 7475  tag: Match featu
+00011bc0: 7265 2d73 6574 7320 7769 7468 2073 7065  re-sets with spe
+00011bd0: 6369 6669 6320 7461 672e 0a20 2020 2020  cific tag..     
+00011be0: 2020 203a 7061 7261 6d20 7374 6174 653a     :param state:
+00011bf0: 204d 6174 6368 2066 6561 7475 7265 2d73   Match feature-s
+00011c00: 6574 7320 7769 7468 2061 2073 7065 6369  ets with a speci
+00011c10: 6669 6320 7374 6174 652e 0a20 2020 2020  fic state..     
+00011c20: 2020 203a 7061 7261 6d20 656e 7469 7469     :param entiti
+00011c30: 6573 3a20 4d61 7463 6820 6665 6174 7572  es: Match featur
+00011c40: 652d 7365 7473 2077 6869 6368 2063 6f6e  e-sets which con
+00011c50: 7461 696e 2065 6e74 6974 6965 7320 7768  tain entities wh
+00011c60: 6f73 6520 6e61 6d65 2069 7320 696e 2074  ose name is in t
+00011c70: 6869 7320 6c69 7374 2e0a 2020 2020 2020  his list..      
+00011c80: 2020 3a70 6172 616d 2066 6561 7475 7265    :param feature
+00011c90: 733a 204d 6174 6368 2066 6561 7475 7265  s: Match feature
+00011ca0: 2d73 6574 7320 7768 6963 6820 636f 6e74  -sets which cont
+00011cb0: 6169 6e20 6665 6174 7572 6573 2077 686f  ain features who
+00011cc0: 7365 206e 616d 6520 6973 2069 6e20 7468  se name is in th
+00011cd0: 6973 206c 6973 742e 0a20 2020 2020 2020  is list..       
+00011ce0: 203a 7061 7261 6d20 6c61 6265 6c73 3a20   :param labels: 
+00011cf0: 4d61 7463 6820 6665 6174 7572 652d 7365  Match feature-se
+00011d00: 7473 2077 6869 6368 2068 6176 6520 7468  ts which have th
+00011d10: 6573 6520 6c61 6265 6c73 2e0a 2020 2020  ese labels..    
+00011d20: 2020 2020 3a70 6172 616d 2070 6172 7469      :param parti
+00011d30: 7469 6f6e 5f62 793a 2046 6965 6c64 2074  tion_by: Field t
+00011d40: 6f20 6772 6f75 7020 7265 7375 6c74 7320  o group results 
+00011d50: 6279 2e20 4f6e 6c79 2061 6c6c 6f77 6564  by. Only allowed
+00011d60: 2076 616c 7565 2069 7320 606e 616d 6560   value is `name`
+00011d70: 2e20 5768 656e 2060 7061 7274 6974 696f  . When `partitio
+00011d80: 6e5f 6279 6020 6973 2073 7065 6369 6669  n_by` is specifi
+00011d90: 6564 2c0a 2020 2020 2020 2020 2020 2020  ed,.            
+00011da0: 7468 6520 6070 6172 7469 7469 6f6e 5f73  the `partition_s
+00011db0: 6f72 745f 6279 6020 7061 7261 6d65 7465  ort_by` paramete
+00011dc0: 7220 6d75 7374 2062 6520 7072 6f76 6964  r must be provid
+00011dd0: 6564 2061 7320 7765 6c6c 2e0a 2020 2020  ed as well..    
+00011de0: 2020 2020 3a70 6172 616d 2072 6f77 735f      :param rows_
+00011df0: 7065 725f 7061 7274 6974 696f 6e3a 2048  per_partition: H
+00011e00: 6f77 206d 616e 7920 746f 7020 726f 7773  ow many top rows
+00011e10: 2028 7065 7220 736f 7274 696e 6720 6465   (per sorting de
+00011e20: 6669 6e65 6420 6279 2060 7061 7274 6974  fined by `partit
+00011e30: 696f 6e5f 736f 7274 5f62 7960 2061 6e64  ion_sort_by` and
+00011e40: 2060 7061 7274 6974 696f 6e5f 6f72 6465   `partition_orde
+00011e50: 7260 290a 2020 2020 2020 2020 2020 2020  r`).            
+00011e60: 746f 2072 6574 7572 6e20 7065 7220 6772  to return per gr
+00011e70: 6f75 702e 2044 6566 6175 6c74 2076 616c  oup. Default val
+00011e80: 7565 2069 7320 312e 0a20 2020 2020 2020  ue is 1..       
+00011e90: 203a 7061 7261 6d20 7061 7274 6974 696f   :param partitio
+00011ea0: 6e5f 736f 7274 5f62 793a 2057 6861 7420  n_sort_by: What 
+00011eb0: 6669 656c 6420 746f 2073 6f72 7420 7468  field to sort th
+00011ec0: 6520 7265 7375 6c74 7320 6279 2c20 7769  e results by, wi
+00011ed0: 7468 696e 2065 6163 6820 7061 7274 6974  thin each partit
+00011ee0: 696f 6e20 6465 6669 6e65 6420 6279 2060  ion defined by `
+00011ef0: 7061 7274 6974 696f 6e5f 6279 602e 0a20  partition_by`.. 
+00011f00: 2020 2020 2020 2020 2020 2043 7572 7265             Curre
+00011f10: 6e74 6c79 2074 6865 206f 6e6c 7920 616c  ntly the only al
+00011f20: 6c6f 7765 6420 7661 6c75 6520 6172 6520  lowed value are 
+00011f30: 6063 7265 6174 6564 6020 616e 6420 6075  `created` and `u
+00011f40: 7064 6174 6564 602e 0a20 2020 2020 2020  pdated`..       
+00011f50: 203a 7061 7261 6d20 7061 7274 6974 696f   :param partitio
+00011f60: 6e5f 6f72 6465 723a 204f 7264 6572 206f  n_order: Order o
+00011f70: 6620 736f 7274 696e 6720 7769 7468 696e  f sorting within
+00011f80: 2070 6172 7469 7469 6f6e 7320 2d20 6061   partitions - `a
+00011f90: 7363 6020 6f72 2060 6465 7363 602e 2044  sc` or `desc`. D
+00011fa0: 6566 6175 6c74 2069 7320 6064 6573 6360  efault is `desc`
+00011fb0: 2e0a 2020 2020 2020 2020 3a72 6574 7572  ..        :retur
+00011fc0: 6e73 3a20 4c69 7374 206f 6620 6d61 7463  ns: List of matc
+00011fd0: 6869 6e67 203a 7079 3a63 6c61 7373 3a60  hing :py:class:`
+00011fe0: 7e6d 6c72 756e 2e66 6561 7475 7265 5f73  ~mlrun.feature_s
+00011ff0: 746f 7265 2e46 6561 7475 7265 5365 7460  tore.FeatureSet`
+00012000: 206f 626a 6563 7473 2e0a 2020 2020 2020   objects..      
+00012010: 2020 2222 220a 0a20 2020 2020 2020 2070    """..        p
+00012020: 726f 6a65 6374 203d 2070 726f 6a65 6374  roject = project
+00012030: 206f 7220 636f 6e66 6967 2e64 6566 6175   or config.defau
+00012040: 6c74 5f70 726f 6a65 6374 0a0a 2020 2020  lt_project..    
+00012050: 2020 2020 7061 7261 6d73 203d 207b 0a20      params = {. 
+00012060: 2020 2020 2020 2020 2020 2022 6e61 6d65             "name
+00012070: 223a 206e 616d 652c 0a20 2020 2020 2020  ": name,.       
+00012080: 2020 2020 2022 7374 6174 6522 3a20 7374       "state": st
+00012090: 6174 652c 0a20 2020 2020 2020 2020 2020  ate,.           
+000120a0: 2022 7461 6722 3a20 7461 672c 0a20 2020   "tag": tag,.   
+000120b0: 2020 2020 2020 2020 2022 656e 7469 7479           "entity
+000120c0: 223a 2065 6e74 6974 6965 7320 6f72 205b  ": entities or [
+000120d0: 5d2c 0a20 2020 2020 2020 2020 2020 2022  ],.            "
+000120e0: 6665 6174 7572 6522 3a20 6665 6174 7572  feature": featur
+000120f0: 6573 206f 7220 5b5d 2c0a 2020 2020 2020  es or [],.      
+00012100: 2020 2020 2020 226c 6162 656c 223a 206c        "label": l
+00012110: 6162 656c 7320 6f72 205b 5d2c 0a20 2020  abels or [],.   
+00012120: 2020 2020 207d 0a20 2020 2020 2020 2069       }.        i
+00012130: 6620 7061 7274 6974 696f 6e5f 6279 3a0a  f partition_by:.
+00012140: 2020 2020 2020 2020 2020 2020 7061 7261              para
+00012150: 6d73 2e75 7064 6174 6528 0a20 2020 2020  ms.update(.     
+00012160: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00012170: 5f67 656e 6572 6174 655f 7061 7274 6974  _generate_partit
+00012180: 696f 6e5f 6279 5f70 6172 616d 7328 0a20  ion_by_params(. 
+00012190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000121a0: 2020 206d 6c72 756e 2e63 6f6d 6d6f 6e2e     mlrun.common.
+000121b0: 7363 6865 6d61 732e 4665 6174 7572 6553  schemas.FeatureS
+000121c0: 746f 7265 5061 7274 6974 696f 6e42 7946  torePartitionByF
+000121d0: 6965 6c64 2c0a 2020 2020 2020 2020 2020  ield,.          
+000121e0: 2020 2020 2020 2020 2020 7061 7274 6974            partit
+000121f0: 696f 6e5f 6279 2c0a 2020 2020 2020 2020  ion_by,.        
+00012200: 2020 2020 2020 2020 2020 2020 726f 7773              rows
+00012210: 5f70 6572 5f70 6172 7469 7469 6f6e 2c0a  _per_partition,.
+00012220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012230: 2020 2020 7061 7274 6974 696f 6e5f 736f      partition_so
+00012240: 7274 5f62 792c 0a20 2020 2020 2020 2020  rt_by,.         
+00012250: 2020 2020 2020 2020 2020 2070 6172 7469             parti
+00012260: 7469 6f6e 5f6f 7264 6572 2c0a 2020 2020  tion_order,.    
+00012270: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00012280: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+00012290: 2020 2020 2070 6174 6820 3d20 6622 7072       path = f"pr
+000122a0: 6f6a 6563 7473 2f7b 7072 6f6a 6563 747d  ojects/{project}
+000122b0: 2f66 6561 7475 7265 2d73 6574 7322 0a0a  /feature-sets"..
+000122c0: 2020 2020 2020 2020 6572 726f 725f 6d65          error_me
+000122d0: 7373 6167 6520 3d20 280a 2020 2020 2020  ssage = (.      
+000122e0: 2020 2020 2020 6622 4661 696c 6564 206c        f"Failed l
+000122f0: 6973 7469 6e67 2066 6561 7475 7265 2d73  isting feature-s
+00012300: 6574 732c 2070 726f 6a65 6374 3a20 7b70  ets, project: {p
+00012310: 726f 6a65 6374 7d2c 2071 7565 7279 3a20  roject}, query: 
+00012320: 7b70 6172 616d 737d 220a 2020 2020 2020  {params}".      
+00012330: 2020 290a 2020 2020 2020 2020 7265 7370    ).        resp
+00012340: 203d 2073 656c 662e 6170 695f 6361 6c6c   = self.api_call
+00012350: 2822 4745 5422 2c20 7061 7468 2c20 6572  ("GET", path, er
+00012360: 726f 725f 6d65 7373 6167 652c 2070 6172  ror_message, par
+00012370: 616d 733d 7061 7261 6d73 290a 2020 2020  ams=params).    
+00012380: 2020 2020 6665 6174 7572 655f 7365 7473      feature_sets
+00012390: 203d 2072 6573 702e 6a73 6f6e 2829 5b22   = resp.json()["
+000123a0: 6665 6174 7572 655f 7365 7473 225d 0a20  feature_sets"]. 
+000123b0: 2020 2020 2020 2069 6620 6665 6174 7572         if featur
+000123c0: 655f 7365 7473 3a0a 2020 2020 2020 2020  e_sets:.        
+000123d0: 2020 2020 7265 7475 726e 205b 4665 6174      return [Feat
+000123e0: 7572 6553 6574 2e66 726f 6d5f 6469 6374  ureSet.from_dict
+000123f0: 286f 626a 2920 666f 7220 6f62 6a20 696e  (obj) for obj in
+00012400: 2066 6561 7475 7265 5f73 6574 735d 0a0a   feature_sets]..
+00012410: 2020 2020 6465 6620 7374 6f72 655f 6665      def store_fe
+00012420: 6174 7572 655f 7365 7428 0a20 2020 2020  ature_set(.     
+00012430: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+00012440: 2066 6561 7475 7265 5f73 6574 3a20 556e   feature_set: Un
+00012450: 696f 6e5b 6469 6374 2c20 6d6c 7275 6e2e  ion[dict, mlrun.
+00012460: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e46  common.schemas.F
+00012470: 6561 7475 7265 5365 742c 2046 6561 7475  eatureSet, Featu
+00012480: 7265 5365 745d 2c0a 2020 2020 2020 2020  reSet],.        
+00012490: 6e61 6d65 3d4e 6f6e 652c 0a20 2020 2020  name=None,.     
+000124a0: 2020 2070 726f 6a65 6374 3d22 222c 0a20     project="",. 
+000124b0: 2020 2020 2020 2074 6167 3d4e 6f6e 652c         tag=None,
+000124c0: 0a20 2020 2020 2020 2075 6964 3d4e 6f6e  .        uid=Non
+000124d0: 652c 0a20 2020 2020 2020 2076 6572 7369  e,.        versi
+000124e0: 6f6e 6564 3d54 7275 652c 0a20 2020 2029  oned=True,.    )
+000124f0: 202d 3e20 6469 6374 3a0a 2020 2020 2020   -> dict:.      
+00012500: 2020 2222 2253 6176 6520 6120 3a70 793a    """Save a :py:
+00012510: 636c 6173 733a 607e 6d6c 7275 6e2e 6665  class:`~mlrun.fe
+00012520: 6174 7572 655f 7374 6f72 652e 4665 6174  ature_store.Feat
+00012530: 7572 6553 6574 6020 6f62 6a65 6374 2069  ureSet` object i
+00012540: 6e20 7468 6520 3a70 793a 6d6f 643a 606d  n the :py:mod:`m
+00012550: 6c72 756e 6020 4442 2e20 5468 650a 2020  lrun` DB. The.  
+00012560: 2020 2020 2020 6665 6174 7572 652d 7365        feature-se
+00012570: 7420 6361 6e20 6265 2065 6974 6865 7220  t can be either 
+00012580: 6120 6e65 7720 6f62 6a65 6374 206f 7220  a new object or 
+00012590: 6120 6d6f 6469 6669 6361 7469 6f6e 2074  a modification t
+000125a0: 6f20 6578 6973 7469 6e67 206f 626a 6563  o existing objec
+000125b0: 7420 7265 6665 7265 6e63 6564 2062 7920  t referenced by 
+000125c0: 7468 6520 7061 7261 6d73 206f 660a 2020  the params of.  
+000125d0: 2020 2020 2020 7468 6520 6675 6e63 7469        the functi
+000125e0: 6f6e 2e0a 0a20 2020 2020 2020 203a 7061  on...        :pa
+000125f0: 7261 6d20 6665 6174 7572 655f 7365 743a  ram feature_set:
+00012600: 2054 6865 203a 7079 3a63 6c61 7373 3a60   The :py:class:`
+00012610: 7e6d 6c72 756e 2e66 6561 7475 7265 5f73  ~mlrun.feature_s
+00012620: 746f 7265 2e46 6561 7475 7265 5365 7460  tore.FeatureSet`
+00012630: 2074 6f20 7374 6f72 652e 0a20 2020 2020   to store..     
+00012640: 2020 203a 7061 7261 6d20 6e61 6d65 3a20     :param name: 
+00012650: 2020 204e 616d 6520 6f66 2066 6561 7475     Name of featu
+00012660: 7265 2073 6574 2e0a 2020 2020 2020 2020  re set..        
+00012670: 3a70 6172 616d 2070 726f 6a65 6374 3a20  :param project: 
+00012680: 4e61 6d65 206f 6620 7072 6f6a 6563 7420  Name of project 
+00012690: 7468 6973 2066 6561 7475 7265 2d73 6574  this feature-set
+000126a0: 2062 656c 6f6e 6773 2074 6f2e 0a20 2020   belongs to..   
+000126b0: 2020 2020 203a 7061 7261 6d20 7461 673a       :param tag:
+000126c0: 2054 6865 2060 6074 6167 6060 206f 6620   The ``tag`` of 
+000126d0: 7468 6520 6f62 6a65 6374 2074 6f20 7265  the object to re
+000126e0: 706c 6163 6520 696e 2074 6865 2044 422c  place in the DB,
+000126f0: 2066 6f72 2065 7861 6d70 6c65 2060 606c   for example ``l
+00012700: 6174 6573 7460 602e 0a20 2020 2020 2020  atest``..       
+00012710: 203a 7061 7261 6d20 7569 643a 2054 6865   :param uid: The
+00012720: 2060 6075 6964 6060 206f 6620 7468 6520   ``uid`` of the 
+00012730: 6f62 6a65 6374 2074 6f20 7265 706c 6163  object to replac
+00012740: 6520 696e 2074 6865 2044 422e 2049 6620  e in the DB. If 
+00012750: 7573 696e 6720 7468 6973 2070 6172 616d  using this param
+00012760: 6574 6572 2c20 7468 6520 6d6f 6469 6669  eter, the modifi
+00012770: 6564 206f 626a 6563 740a 2020 2020 2020  ed object.      
+00012780: 2020 2020 2020 6d75 7374 2068 6176 6520        must have 
+00012790: 7468 6520 7361 6d65 2060 6075 6964 6060  the same ``uid``
+000127a0: 206f 6620 7468 6520 7072 6576 696f 7573   of the previous
+000127b0: 6c79 2d65 7869 7374 696e 6720 6f62 6a65  ly-existing obje
+000127c0: 6374 2e20 5468 6973 2063 616e 6e6f 7420  ct. This cannot 
+000127d0: 6265 2075 7365 6420 666f 7220 6e6f 6e2d  be used for non-
+000127e0: 7665 7273 696f 6e65 6420 6f62 6a65 6374  versioned object
+000127f0: 732e 0a20 2020 2020 2020 203a 7061 7261  s..        :para
+00012800: 6d20 7665 7273 696f 6e65 643a 2057 6865  m versioned: Whe
+00012810: 7468 6572 2074 6f20 6d61 696e 7461 696e  ther to maintain
+00012820: 2076 6572 7369 6f6e 7320 666f 7220 7468   versions for th
+00012830: 6973 2066 6561 7475 7265 2d73 6574 2e20  is feature-set. 
+00012840: 416c 6c20 7665 7273 696f 6e73 206f 6620  All versions of 
+00012850: 6120 7665 7273 696f 6e65 6420 6f62 6a65  a versioned obje
+00012860: 6374 0a20 2020 2020 2020 2020 2020 2077  ct.            w
+00012870: 696c 6c20 6265 206b 6570 7420 696e 2074  ill be kept in t
+00012880: 6865 2044 4220 616e 6420 6361 6e20 6265  he DB and can be
+00012890: 2072 6574 7269 6576 6564 2075 6e74 696c   retrieved until
+000128a0: 2065 7870 6c69 6369 746c 7920 6465 6c65   explicitly dele
+000128b0: 7465 642e 0a20 2020 2020 2020 203a 7265  ted..        :re
+000128c0: 7475 726e 733a 2054 6865 203a 7079 3a63  turns: The :py:c
+000128d0: 6c61 7373 3a60 7e6d 6c72 756e 2e66 6561  lass:`~mlrun.fea
+000128e0: 7475 7265 5f73 746f 7265 2e46 6561 7475  ture_store.Featu
+000128f0: 7265 5365 7460 206f 626a 6563 7420 2861  reSet` object (a
+00012900: 7320 6469 6374 292e 0a20 2020 2020 2020  s dict)..       
+00012910: 2022 2222 0a0a 2020 2020 2020 2020 7265   """..        re
+00012920: 6665 7265 6e63 6520 3d20 7365 6c66 2e5f  ference = self._
+00012930: 7265 736f 6c76 655f 7265 6665 7265 6e63  resolve_referenc
+00012940: 6528 7461 672c 2075 6964 290a 2020 2020  e(tag, uid).    
+00012950: 2020 2020 7061 7261 6d73 203d 207b 2276      params = {"v
+00012960: 6572 7369 6f6e 6564 223a 2076 6572 7369  ersioned": versi
+00012970: 6f6e 6564 7d0a 0a20 2020 2020 2020 2069  oned}..        i
+00012980: 6620 6973 696e 7374 616e 6365 2866 6561  f isinstance(fea
+00012990: 7475 7265 5f73 6574 2c20 6d6c 7275 6e2e  ture_set, mlrun.
+000129a0: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e46  common.schemas.F
+000129b0: 6561 7475 7265 5365 7429 3a0a 2020 2020  eatureSet):.    
+000129c0: 2020 2020 2020 2020 6665 6174 7572 655f          feature_
+000129d0: 7365 7420 3d20 6665 6174 7572 655f 7365  set = feature_se
+000129e0: 742e 6469 6374 2829 0a20 2020 2020 2020  t.dict().       
+000129f0: 2065 6c69 6620 6973 696e 7374 616e 6365   elif isinstance
+00012a00: 2866 6561 7475 7265 5f73 6574 2c20 4665  (feature_set, Fe
+00012a10: 6174 7572 6553 6574 293a 0a20 2020 2020  atureSet):.     
+00012a20: 2020 2020 2020 2066 6561 7475 7265 5f73         feature_s
+00012a30: 6574 203d 2066 6561 7475 7265 5f73 6574  et = feature_set
+00012a40: 2e74 6f5f 6469 6374 2829 0a0a 2020 2020  .to_dict()..    
+00012a50: 2020 2020 6e61 6d65 203d 206e 616d 6520      name = name 
+00012a60: 6f72 2066 6561 7475 7265 5f73 6574 5b22  or feature_set["
+00012a70: 6d65 7461 6461 7461 225d 5b22 6e61 6d65  metadata"]["name
+00012a80: 225d 0a20 2020 2020 2020 2070 726f 6a65  "].        proje
+00012a90: 6374 203d 2028 0a20 2020 2020 2020 2020  ct = (.         
+00012aa0: 2020 2070 726f 6a65 6374 206f 7220 6665     project or fe
+00012ab0: 6174 7572 655f 7365 745b 226d 6574 6164  ature_set["metad
+00012ac0: 6174 6122 5d2e 6765 7428 2270 726f 6a65  ata"].get("proje
+00012ad0: 6374 2229 206f 7220 636f 6e66 6967 2e64  ct") or config.d
+00012ae0: 6566 6175 6c74 5f70 726f 6a65 6374 0a20  efault_project. 
+00012af0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00012b00: 2070 6174 6820 3d20 6622 7072 6f6a 6563   path = f"projec
+00012b10: 7473 2f7b 7072 6f6a 6563 747d 2f66 6561  ts/{project}/fea
+00012b20: 7475 7265 2d73 6574 732f 7b6e 616d 657d  ture-sets/{name}
+00012b30: 2f72 6566 6572 656e 6365 732f 7b72 6566  /references/{ref
+00012b40: 6572 656e 6365 7d22 0a20 2020 2020 2020  erence}".       
+00012b50: 2065 7272 6f72 5f6d 6573 7361 6765 203d   error_message =
+00012b60: 2066 2246 6169 6c65 6420 7374 6f72 696e   f"Failed storin
+00012b70: 6720 6665 6174 7572 652d 7365 7420 7b70  g feature-set {p
+00012b80: 726f 6a65 6374 7d2f 7b6e 616d 657d 220a  roject}/{name}".
+00012b90: 2020 2020 2020 2020 7265 7370 203d 2073          resp = s
+00012ba0: 656c 662e 6170 695f 6361 6c6c 280a 2020  elf.api_call(.  
+00012bb0: 2020 2020 2020 2020 2020 2250 5554 222c            "PUT",
+00012bc0: 2070 6174 682c 2065 7272 6f72 5f6d 6573   path, error_mes
+00012bd0: 7361 6765 2c20 7061 7261 6d73 3d70 6172  sage, params=par
+00012be0: 616d 732c 2062 6f64 793d 6469 6374 5f74  ams, body=dict_t
+00012bf0: 6f5f 6a73 6f6e 2866 6561 7475 7265 5f73  o_json(feature_s
+00012c00: 6574 290a 2020 2020 2020 2020 290a 2020  et).        ).  
+00012c10: 2020 2020 2020 7265 7475 726e 2072 6573        return res
+00012c20: 702e 6a73 6f6e 2829 0a0a 2020 2020 6465  p.json()..    de
+00012c30: 6620 7061 7463 685f 6665 6174 7572 655f  f patch_feature_
+00012c40: 7365 7428 0a20 2020 2020 2020 2073 656c  set(.        sel
+00012c50: 662c 0a20 2020 2020 2020 206e 616d 652c  f,.        name,
+00012c60: 0a20 2020 2020 2020 2066 6561 7475 7265  .        feature
+00012c70: 5f73 6574 5f75 7064 6174 653a 2064 6963  _set_update: dic
+00012c80: 742c 0a20 2020 2020 2020 2070 726f 6a65  t,.        proje
+00012c90: 6374 3d22 222c 0a20 2020 2020 2020 2074  ct="",.        t
+00012ca0: 6167 3d4e 6f6e 652c 0a20 2020 2020 2020  ag=None,.       
+00012cb0: 2075 6964 3d4e 6f6e 652c 0a20 2020 2020   uid=None,.     
+00012cc0: 2020 2070 6174 6368 5f6d 6f64 653a 2055     patch_mode: U
+00012cd0: 6e69 6f6e 5b0a 2020 2020 2020 2020 2020  nion[.          
+00012ce0: 2020 7374 722c 206d 6c72 756e 2e63 6f6d    str, mlrun.com
+00012cf0: 6d6f 6e2e 7363 6865 6d61 732e 5061 7463  mon.schemas.Patc
+00012d00: 684d 6f64 650a 2020 2020 2020 2020 5d20  hMode.        ] 
+00012d10: 3d20 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  = mlrun.common.s
+00012d20: 6368 656d 6173 2e50 6174 6368 4d6f 6465  chemas.PatchMode
+00012d30: 2e72 6570 6c61 6365 2c0a 2020 2020 293a  .replace,.    ):
+00012d40: 0a20 2020 2020 2020 2022 2222 4d6f 6469  .        """Modi
+00012d50: 6679 2028 7061 7463 6829 2061 6e20 6578  fy (patch) an ex
+00012d60: 6973 7469 6e67 203a 7079 3a63 6c61 7373  isting :py:class
+00012d70: 3a60 7e6d 6c72 756e 2e66 6561 7475 7265  :`~mlrun.feature
+00012d80: 5f73 746f 7265 2e46 6561 7475 7265 5365  _store.FeatureSe
+00012d90: 7460 206f 626a 6563 742e 0a20 2020 2020  t` object..     
+00012da0: 2020 2054 6865 206f 626a 6563 7420 6973     The object is
+00012db0: 2069 6465 6e74 6966 6965 6420 6279 2069   identified by i
+00012dc0: 7473 206e 616d 6520 2861 6e64 2070 726f  ts name (and pro
+00012dd0: 6a65 6374 2069 7420 6265 6c6f 6e67 7320  ject it belongs 
+00012de0: 746f 292c 2061 7320 7765 6c6c 2061 7320  to), as well as 
+00012df0: 6f70 7469 6f6e 616c 6c79 2061 2060 6074  optionally a ``t
+00012e00: 6167 6060 206f 7220 6974 730a 2020 2020  ag`` or its.    
+00012e10: 2020 2020 6060 7569 6460 6020 2866 6f72      ``uid`` (for
+00012e20: 2076 6572 7369 6f6e 6564 206f 626a 6563   versioned objec
+00012e30: 7429 2e20 4966 2062 6f74 6820 6060 7461  t). If both ``ta
+00012e40: 6760 6020 616e 6420 6060 7569 6460 6020  g`` and ``uid`` 
+00012e50: 6172 6520 6f6d 6974 7465 6420 7468 656e  are omitted then
+00012e60: 2074 6865 206f 626a 6563 7420 7769 7468   the object with
+00012e70: 2074 6167 2060 606c 6174 6573 7460 600a   tag ``latest``.
+00012e80: 2020 2020 2020 2020 6973 206d 6f64 6966          is modif
+00012e90: 6965 642e 0a0a 2020 2020 2020 2020 3a70  ied...        :p
+00012ea0: 6172 616d 206e 616d 653a 204e 616d 6520  aram name: Name 
+00012eb0: 6f66 2074 6865 206f 626a 6563 7420 746f  of the object to
+00012ec0: 2070 6174 6368 2e0a 2020 2020 2020 2020   patch..        
+00012ed0: 3a70 6172 616d 2066 6561 7475 7265 5f73  :param feature_s
+00012ee0: 6574 5f75 7064 6174 653a 2054 6865 206d  et_update: The m
+00012ef0: 6f64 6966 6963 6174 696f 6e73 206e 6565  odifications nee
+00012f00: 6465 6420 696e 2074 6865 206f 626a 6563  ded in the objec
+00012f10: 742e 2054 6869 7320 7061 7261 6d65 7465  t. This paramete
+00012f20: 7220 6f6e 6c79 2068 6173 2074 6865 2063  r only has the c
+00012f30: 6861 6e67 6573 2069 6e20 6974 2c0a 2020  hanges in it,.  
+00012f40: 2020 2020 2020 2020 2020 6e6f 7420 6120            not a 
+00012f50: 6675 6c6c 206f 626a 6563 742e 0a20 2020  full object..   
+00012f60: 2020 2020 2020 2020 2045 7861 6d70 6c65           Example
+00012f70: 3a3a 0a0a 2020 2020 2020 2020 2020 2020  ::..            
+00012f80: 2020 2020 6665 6174 7572 655f 7365 745f      feature_set_
+00012f90: 7570 6461 7465 203d 207b 2273 7461 7475  update = {"statu
+00012fa0: 7322 3a20 7b22 7072 6f63 6573 7365 6422  s": {"processed"
+00012fb0: 203a 2054 7275 657d 7d0a 0a20 2020 2020   : True}}..     
+00012fc0: 2020 2020 2020 2057 696c 6c20 6170 706c         Will appl
+00012fd0: 7920 7468 6520 6669 656c 6420 6060 7374  y the field ``st
+00012fe0: 6174 7573 2e70 726f 6365 7373 6564 6060  atus.processed``
+00012ff0: 2074 6f20 7468 6520 6578 6973 7469 6e67   to the existing
+00013000: 206f 626a 6563 742e 0a20 2020 2020 2020   object..       
+00013010: 203a 7061 7261 6d20 7072 6f6a 6563 743a   :param project:
+00013020: 2050 726f 6a65 6374 2077 6869 6368 2063   Project which c
+00013030: 6f6e 7461 696e 7320 7468 6520 6d6f 6469  ontains the modi
+00013040: 6669 6564 206f 626a 6563 742e 0a20 2020  fied object..   
+00013050: 2020 2020 203a 7061 7261 6d20 7461 673a       :param tag:
+00013060: 2054 6865 2074 6167 206f 6620 7468 6520   The tag of the 
+00013070: 6f62 6a65 6374 2074 6f20 6d6f 6469 6679  object to modify
+00013080: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00013090: 2075 6964 3a20 7569 6420 6f66 2074 6865   uid: uid of the
+000130a0: 206f 626a 6563 7420 746f 206d 6f64 6966   object to modif
+000130b0: 792e 0a20 2020 2020 2020 203a 7061 7261  y..        :para
+000130c0: 6d20 7061 7463 685f 6d6f 6465 3a20 5468  m patch_mode: Th
+000130d0: 6520 7374 7261 7465 6779 2066 6f72 206d  e strategy for m
+000130e0: 6572 6769 6e67 2074 6865 2063 6861 6e67  erging the chang
+000130f0: 6573 2077 6974 6820 7468 6520 6578 6973  es with the exis
+00013100: 7469 6e67 206f 626a 6563 742e 2043 616e  ting object. Can
+00013110: 2062 6520 6569 7468 6572 2060 6072 6570   be either ``rep
+00013120: 6c61 6365 6060 0a20 2020 2020 2020 2020  lace``.         
+00013130: 2020 206f 7220 6060 6164 6469 7469 7665     or ``additive
+00013140: 6060 2e0a 2020 2020 2020 2020 2222 220a  ``..        """.
+00013150: 2020 2020 2020 2020 7072 6f6a 6563 7420          project 
+00013160: 3d20 7072 6f6a 6563 7420 6f72 2063 6f6e  = project or con
+00013170: 6669 672e 6465 6661 756c 745f 7072 6f6a  fig.default_proj
+00013180: 6563 740a 2020 2020 2020 2020 7265 6665  ect.        refe
+00013190: 7265 6e63 6520 3d20 7365 6c66 2e5f 7265  rence = self._re
+000131a0: 736f 6c76 655f 7265 6665 7265 6e63 6528  solve_reference(
+000131b0: 7461 672c 2075 6964 290a 2020 2020 2020  tag, uid).      
+000131c0: 2020 6865 6164 6572 7320 3d20 7b6d 6c72    headers = {mlr
+000131d0: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
+000131e0: 732e 4865 6164 6572 4e61 6d65 732e 7061  s.HeaderNames.pa
+000131f0: 7463 685f 6d6f 6465 3a20 7061 7463 685f  tch_mode: patch_
+00013200: 6d6f 6465 7d0a 2020 2020 2020 2020 7061  mode}.        pa
+00013210: 7468 203d 2066 2270 726f 6a65 6374 732f  th = f"projects/
+00013220: 7b70 726f 6a65 6374 7d2f 6665 6174 7572  {project}/featur
+00013230: 652d 7365 7473 2f7b 6e61 6d65 7d2f 7265  e-sets/{name}/re
+00013240: 6665 7265 6e63 6573 2f7b 7265 6665 7265  ferences/{refere
+00013250: 6e63 657d 220a 2020 2020 2020 2020 6572  nce}".        er
+00013260: 726f 725f 6d65 7373 6167 6520 3d20 6622  ror_message = f"
+00013270: 4661 696c 6564 2075 7064 6174 696e 6720  Failed updating 
+00013280: 6665 6174 7572 652d 7365 7420 7b70 726f  feature-set {pro
+00013290: 6a65 6374 7d2f 7b6e 616d 657d 220a 2020  ject}/{name}".  
+000132a0: 2020 2020 2020 7365 6c66 2e61 7069 5f63        self.api_c
+000132b0: 616c 6c28 0a20 2020 2020 2020 2020 2020  all(.           
+000132c0: 2022 5041 5443 4822 2c0a 2020 2020 2020   "PATCH",.      
+000132d0: 2020 2020 2020 7061 7468 2c0a 2020 2020        path,.    
+000132e0: 2020 2020 2020 2020 6572 726f 725f 6d65          error_me
+000132f0: 7373 6167 652c 0a20 2020 2020 2020 2020  ssage,.         
+00013300: 2020 2062 6f64 793d 6469 6374 5f74 6f5f     body=dict_to_
+00013310: 6a73 6f6e 2866 6561 7475 7265 5f73 6574  json(feature_set
+00013320: 5f75 7064 6174 6529 2c0a 2020 2020 2020  _update),.      
+00013330: 2020 2020 2020 6865 6164 6572 733d 6865        headers=he
+00013340: 6164 6572 732c 0a20 2020 2020 2020 2029  aders,.        )
+00013350: 0a0a 2020 2020 6465 6620 6465 6c65 7465  ..    def delete
+00013360: 5f66 6561 7475 7265 5f73 6574 2873 656c  _feature_set(sel
+00013370: 662c 206e 616d 652c 2070 726f 6a65 6374  f, name, project
+00013380: 3d22 222c 2074 6167 3d4e 6f6e 652c 2075  ="", tag=None, u
+00013390: 6964 3d4e 6f6e 6529 3a0a 2020 2020 2020  id=None):.      
+000133a0: 2020 2222 2244 656c 6574 6520 6120 3a70    """Delete a :p
+000133b0: 793a 636c 6173 733a 607e 6d6c 7275 6e2e  y:class:`~mlrun.
+000133c0: 6665 6174 7572 655f 7374 6f72 652e 4665  feature_store.Fe
+000133d0: 6174 7572 6553 6574 6020 6f62 6a65 6374  atureSet` object
+000133e0: 2066 726f 6d20 7468 6520 4442 2e0a 2020   from the DB..  
+000133f0: 2020 2020 2020 4966 2060 6074 6167 6060        If ``tag``
+00013400: 206f 7220 6060 7569 6460 6020 6172 6520   or ``uid`` are 
+00013410: 7370 6563 6966 6965 642c 2074 6865 6e20  specified, then 
+00013420: 6a75 7374 2074 6865 2076 6572 7369 6f6e  just the version
+00013430: 2072 6566 6572 656e 6365 6420 6279 2074   referenced by t
+00013440: 6865 6d20 7769 6c6c 2062 6520 6465 6c65  hem will be dele
+00013450: 7465 642e 2055 7369 6e67 2062 6f74 680a  ted. Using both.
+00013460: 2020 2020 2020 2020 6973 206e 6f74 2061          is not a
+00013470: 6c6c 6f77 6564 2e0a 2020 2020 2020 2020  llowed..        
+00013480: 4966 206e 6f6e 6520 6172 6520 7370 6563  If none are spec
+00013490: 6966 6965 642c 2074 6865 6e20 616c 6c20  ified, then all 
+000134a0: 696e 7374 616e 6365 7320 6f66 2074 6865  instances of the
+000134b0: 206f 626a 6563 7420 7768 6f73 6520 6e61   object whose na
+000134c0: 6d65 2069 7320 6060 6e61 6d65 6060 2077  me is ``name`` w
+000134d0: 696c 6c20 6265 2064 656c 6574 6564 2e0a  ill be deleted..
+000134e0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+000134f0: 2020 2020 7072 6f6a 6563 7420 3d20 7072      project = pr
+00013500: 6f6a 6563 7420 6f72 2063 6f6e 6669 672e  oject or config.
+00013510: 6465 6661 756c 745f 7072 6f6a 6563 740a  default_project.
+00013520: 2020 2020 2020 2020 7061 7468 203d 2066          path = f
+00013530: 2270 726f 6a65 6374 732f 7b70 726f 6a65  "projects/{proje
+00013540: 6374 7d2f 6665 6174 7572 652d 7365 7473  ct}/feature-sets
+00013550: 2f7b 6e61 6d65 7d22 0a0a 2020 2020 2020  /{name}"..      
+00013560: 2020 6966 2074 6167 206f 7220 7569 643a    if tag or uid:
+00013570: 0a20 2020 2020 2020 2020 2020 2072 6566  .            ref
+00013580: 6572 656e 6365 203d 2073 656c 662e 5f72  erence = self._r
+00013590: 6573 6f6c 7665 5f72 6566 6572 656e 6365  esolve_reference
+000135a0: 2874 6167 2c20 7569 6429 0a20 2020 2020  (tag, uid).     
+000135b0: 2020 2020 2020 2070 6174 6820 3d20 7061         path = pa
+000135c0: 7468 202b 2066 222f 7265 6665 7265 6e63  th + f"/referenc
+000135d0: 6573 2f7b 7265 6665 7265 6e63 657d 220a  es/{reference}".
+000135e0: 0a20 2020 2020 2020 2065 7272 6f72 5f6d  .        error_m
+000135f0: 6573 7361 6765 203d 2066 2246 6169 6c65  essage = f"Faile
+00013600: 6420 6465 6c65 7469 6e67 2066 6561 7475  d deleting featu
+00013610: 7265 2d73 6574 207b 6e61 6d65 7d22 0a20  re-set {name}". 
+00013620: 2020 2020 2020 2073 656c 662e 6170 695f         self.api_
+00013630: 6361 6c6c 2822 4445 4c45 5445 222c 2070  call("DELETE", p
+00013640: 6174 682c 2065 7272 6f72 5f6d 6573 7361  ath, error_messa
+00013650: 6765 290a 0a20 2020 2064 6566 2063 7265  ge)..    def cre
+00013660: 6174 655f 6665 6174 7572 655f 7665 6374  ate_feature_vect
+00013670: 6f72 280a 2020 2020 2020 2020 7365 6c66  or(.        self
+00013680: 2c0a 2020 2020 2020 2020 6665 6174 7572  ,.        featur
+00013690: 655f 7665 6374 6f72 3a20 556e 696f 6e5b  e_vector: Union[
+000136a0: 6469 6374 2c20 6d6c 7275 6e2e 636f 6d6d  dict, mlrun.comm
+000136b0: 6f6e 2e73 6368 656d 6173 2e46 6561 7475  on.schemas.Featu
+000136c0: 7265 5665 6374 6f72 2c20 4665 6174 7572  reVector, Featur
+000136d0: 6556 6563 746f 725d 2c0a 2020 2020 2020  eVector],.      
+000136e0: 2020 7072 6f6a 6563 743d 2222 2c0a 2020    project="",.  
+000136f0: 2020 2020 2020 7665 7273 696f 6e65 643d        versioned=
+00013700: 5472 7565 2c0a 2020 2020 2920 2d3e 2064  True,.    ) -> d
+00013710: 6963 743a 0a20 2020 2020 2020 2022 2222  ict:.        """
+00013720: 4372 6561 7465 2061 206e 6577 203a 7079  Create a new :py
+00013730: 3a63 6c61 7373 3a60 7e6d 6c72 756e 2e66  :class:`~mlrun.f
+00013740: 6561 7475 7265 5f73 746f 7265 2e46 6561  eature_store.Fea
+00013750: 7475 7265 5665 6374 6f72 6020 616e 6420  tureVector` and 
+00013760: 7361 7665 2069 6e20 7468 6520 3a70 793a  save in the :py:
+00013770: 6d6f 643a 606d 6c72 756e 6020 4442 2e0a  mod:`mlrun` DB..
+00013780: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00013790: 6665 6174 7572 655f 7665 6374 6f72 3a20  feature_vector: 
+000137a0: 5468 6520 6e65 7720 3a70 793a 636c 6173  The new :py:clas
+000137b0: 733a 607e 6d6c 7275 6e2e 6665 6174 7572  s:`~mlrun.featur
+000137c0: 655f 7374 6f72 652e 4665 6174 7572 6556  e_store.FeatureV
+000137d0: 6563 746f 7260 2074 6f20 6372 6561 7465  ector` to create
+000137e0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+000137f0: 2070 726f 6a65 6374 3a20 4e61 6d65 206f   project: Name o
+00013800: 6620 7072 6f6a 6563 7420 7468 6973 2066  f project this f
+00013810: 6561 7475 7265 2d76 6563 746f 7220 6265  eature-vector be
+00013820: 6c6f 6e67 7320 746f 2e0a 2020 2020 2020  longs to..      
+00013830: 2020 3a70 6172 616d 2076 6572 7369 6f6e    :param version
+00013840: 6564 3a20 5768 6574 6865 7220 746f 206d  ed: Whether to m
+00013850: 6169 6e74 6169 6e20 7665 7273 696f 6e73  aintain versions
+00013860: 2066 6f72 2074 6869 7320 6665 6174 7572   for this featur
+00013870: 652d 7665 6374 6f72 2e20 416c 6c20 7665  e-vector. All ve
+00013880: 7273 696f 6e73 206f 6620 6120 7665 7273  rsions of a vers
+00013890: 696f 6e65 6420 6f62 6a65 6374 0a20 2020  ioned object.   
+000138a0: 2020 2020 2020 2020 2077 696c 6c20 6265           will be
+000138b0: 206b 6570 7420 696e 2074 6865 2044 4220   kept in the DB 
+000138c0: 616e 6420 6361 6e20 6265 2072 6574 7269  and can be retri
+000138d0: 6576 6564 2075 6e74 696c 2065 7870 6c69  eved until expli
+000138e0: 6369 746c 7920 6465 6c65 7465 642e 0a20  citly deleted.. 
+000138f0: 2020 2020 2020 203a 7265 7475 726e 733a         :returns:
+00013900: 2054 6865 203a 7079 3a63 6c61 7373 3a60   The :py:class:`
+00013910: 7e6d 6c72 756e 2e66 6561 7475 7265 5f73  ~mlrun.feature_s
+00013920: 746f 7265 2e46 6561 7475 7265 5665 6374  tore.FeatureVect
+00013930: 6f72 6020 6f62 6a65 6374 2028 6173 2064  or` object (as d
+00013940: 6963 7429 2e0a 2020 2020 2020 2020 2222  ict)..        ""
+00013950: 220a 2020 2020 2020 2020 6966 2069 7369  ".        if isi
+00013960: 6e73 7461 6e63 6528 6665 6174 7572 655f  nstance(feature_
+00013970: 7665 6374 6f72 2c20 6d6c 7275 6e2e 636f  vector, mlrun.co
+00013980: 6d6d 6f6e 2e73 6368 656d 6173 2e46 6561  mmon.schemas.Fea
+00013990: 7475 7265 5665 6374 6f72 293a 0a20 2020  tureVector):.   
+000139a0: 2020 2020 2020 2020 2066 6561 7475 7265           feature
+000139b0: 5f76 6563 746f 7220 3d20 6665 6174 7572  _vector = featur
+000139c0: 655f 7665 6374 6f72 2e64 6963 7428 290a  e_vector.dict().
+000139d0: 2020 2020 2020 2020 656c 6966 2069 7369          elif isi
+000139e0: 6e73 7461 6e63 6528 6665 6174 7572 655f  nstance(feature_
+000139f0: 7665 6374 6f72 2c20 4665 6174 7572 6556  vector, FeatureV
+00013a00: 6563 746f 7229 3a0a 2020 2020 2020 2020  ector):.        
+00013a10: 2020 2020 6665 6174 7572 655f 7665 6374      feature_vect
+00013a20: 6f72 203d 2066 6561 7475 7265 5f76 6563  or = feature_vec
+00013a30: 746f 722e 746f 5f64 6963 7428 290a 0a20  tor.to_dict().. 
+00013a40: 2020 2020 2020 2070 726f 6a65 6374 203d         project =
+00013a50: 2028 0a20 2020 2020 2020 2020 2020 2070   (.            p
+00013a60: 726f 6a65 6374 0a20 2020 2020 2020 2020  roject.         
+00013a70: 2020 206f 7220 6665 6174 7572 655f 7665     or feature_ve
+00013a80: 6374 6f72 5b22 6d65 7461 6461 7461 225d  ctor["metadata"]
+00013a90: 2e67 6574 2822 7072 6f6a 6563 7422 2c20  .get("project", 
+00013aa0: 4e6f 6e65 290a 2020 2020 2020 2020 2020  None).          
+00013ab0: 2020 6f72 2063 6f6e 6669 672e 6465 6661    or config.defa
+00013ac0: 756c 745f 7072 6f6a 6563 740a 2020 2020  ult_project.    
+00013ad0: 2020 2020 290a 2020 2020 2020 2020 7061      ).        pa
+00013ae0: 7468 203d 2066 2270 726f 6a65 6374 732f  th = f"projects/
+00013af0: 7b70 726f 6a65 6374 7d2f 6665 6174 7572  {project}/featur
+00013b00: 652d 7665 6374 6f72 7322 0a20 2020 2020  e-vectors".     
+00013b10: 2020 2070 6172 616d 7320 3d20 7b22 7665     params = {"ve
+00013b20: 7273 696f 6e65 6422 3a20 7665 7273 696f  rsioned": versio
+00013b30: 6e65 647d 0a0a 2020 2020 2020 2020 6e61  ned}..        na
+00013b40: 6d65 203d 2066 6561 7475 7265 5f76 6563  me = feature_vec
+00013b50: 746f 725b 226d 6574 6164 6174 6122 5d5b  tor["metadata"][
+00013b60: 226e 616d 6522 5d0a 2020 2020 2020 2020  "name"].        
+00013b70: 6572 726f 725f 6d65 7373 6167 6520 3d20  error_message = 
+00013b80: 6622 4661 696c 6564 2063 7265 6174 696e  f"Failed creatin
+00013b90: 6720 6665 6174 7572 652d 7665 6374 6f72  g feature-vector
+00013ba0: 207b 7072 6f6a 6563 747d 2f7b 6e61 6d65   {project}/{name
+00013bb0: 7d22 0a20 2020 2020 2020 2072 6573 7020  }".        resp 
+00013bc0: 3d20 7365 6c66 2e61 7069 5f63 616c 6c28  = self.api_call(
+00013bd0: 0a20 2020 2020 2020 2020 2020 2022 504f  .            "PO
+00013be0: 5354 222c 0a20 2020 2020 2020 2020 2020  ST",.           
+00013bf0: 2070 6174 682c 0a20 2020 2020 2020 2020   path,.         
+00013c00: 2020 2065 7272 6f72 5f6d 6573 7361 6765     error_message
+00013c10: 2c0a 2020 2020 2020 2020 2020 2020 7061  ,.            pa
+00013c20: 7261 6d73 3d70 6172 616d 732c 0a20 2020  rams=params,.   
+00013c30: 2020 2020 2020 2020 2062 6f64 793d 6469           body=di
+00013c40: 6374 5f74 6f5f 6a73 6f6e 2866 6561 7475  ct_to_json(featu
+00013c50: 7265 5f76 6563 746f 7229 2c0a 2020 2020  re_vector),.    
+00013c60: 2020 2020 290a 2020 2020 2020 2020 7265      ).        re
+00013c70: 7475 726e 2072 6573 702e 6a73 6f6e 2829  turn resp.json()
+00013c80: 0a0a 2020 2020 6465 6620 6765 745f 6665  ..    def get_fe
+00013c90: 6174 7572 655f 7665 6374 6f72 280a 2020  ature_vector(.  
+00013ca0: 2020 2020 2020 7365 6c66 2c20 6e61 6d65        self, name
+00013cb0: 3a20 7374 722c 2070 726f 6a65 6374 3a20  : str, project: 
+00013cc0: 7374 7220 3d20 2222 2c20 7461 673a 2073  str = "", tag: s
+00013cd0: 7472 203d 204e 6f6e 652c 2075 6964 3a20  tr = None, uid: 
+00013ce0: 7374 7220 3d20 4e6f 6e65 0a20 2020 2029  str = None.    )
+00013cf0: 202d 3e20 4665 6174 7572 6556 6563 746f   -> FeatureVecto
+00013d00: 723a 0a20 2020 2020 2020 2022 2222 5265  r:.        """Re
+00013d10: 7475 726e 2061 2073 7065 6369 6669 6320  turn a specific 
+00013d20: 6665 6174 7572 652d 7665 6374 6f72 2072  feature-vector r
+00013d30: 6566 6572 656e 6365 6420 6279 2069 7473  eferenced by its
+00013d40: 2074 6167 206f 7220 7569 642e 2049 6620   tag or uid. If 
+00013d50: 6e6f 6e65 2061 7265 2070 726f 7669 6465  none are provide
+00013d60: 642c 2060 606c 6174 6573 7460 6020 7461  d, ``latest`` ta
+00013d70: 6720 7769 6c6c 0a20 2020 2020 2020 2062  g will.        b
+00013d80: 6520 7573 6564 2e22 2222 0a0a 2020 2020  e used."""..    
+00013d90: 2020 2020 7072 6f6a 6563 7420 3d20 7072      project = pr
+00013da0: 6f6a 6563 7420 6f72 2063 6f6e 6669 672e  oject or config.
+00013db0: 6465 6661 756c 745f 7072 6f6a 6563 740a  default_project.
+00013dc0: 2020 2020 2020 2020 7265 6665 7265 6e63          referenc
+00013dd0: 6520 3d20 7365 6c66 2e5f 7265 736f 6c76  e = self._resolv
+00013de0: 655f 7265 6665 7265 6e63 6528 7461 672c  e_reference(tag,
+00013df0: 2075 6964 290a 2020 2020 2020 2020 7061   uid).        pa
+00013e00: 7468 203d 2066 2270 726f 6a65 6374 732f  th = f"projects/
+00013e10: 7b70 726f 6a65 6374 7d2f 6665 6174 7572  {project}/featur
+00013e20: 652d 7665 6374 6f72 732f 7b6e 616d 657d  e-vectors/{name}
+00013e30: 2f72 6566 6572 656e 6365 732f 7b72 6566  /references/{ref
+00013e40: 6572 656e 6365 7d22 0a20 2020 2020 2020  erence}".       
+00013e50: 2065 7272 6f72 5f6d 6573 7361 6765 203d   error_message =
+00013e60: 2066 2246 6169 6c65 6420 7265 7472 6965   f"Failed retrie
+00013e70: 7669 6e67 2066 6561 7475 7265 2d76 6563  ving feature-vec
+00013e80: 746f 7220 7b70 726f 6a65 6374 7d2f 7b6e  tor {project}/{n
+00013e90: 616d 657d 220a 2020 2020 2020 2020 7265  ame}".        re
+00013ea0: 7370 203d 2073 656c 662e 6170 695f 6361  sp = self.api_ca
+00013eb0: 6c6c 2822 4745 5422 2c20 7061 7468 2c20  ll("GET", path, 
+00013ec0: 6572 726f 725f 6d65 7373 6167 6529 0a20  error_message). 
+00013ed0: 2020 2020 2020 2072 6574 7572 6e20 4665         return Fe
+00013ee0: 6174 7572 6556 6563 746f 722e 6672 6f6d  atureVector.from
+00013ef0: 5f64 6963 7428 7265 7370 2e6a 736f 6e28  _dict(resp.json(
+00013f00: 2929 0a0a 2020 2020 6465 6620 6c69 7374  ))..    def list
+00013f10: 5f66 6561 7475 7265 5f76 6563 746f 7273  _feature_vectors
+00013f20: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+00013f30: 2020 2020 2020 2020 7072 6f6a 6563 743a          project:
+00013f40: 2073 7472 203d 2022 222c 0a20 2020 2020   str = "",.     
+00013f50: 2020 206e 616d 653a 2073 7472 203d 204e     name: str = N
+00013f60: 6f6e 652c 0a20 2020 2020 2020 2074 6167  one,.        tag
+00013f70: 3a20 7374 7220 3d20 4e6f 6e65 2c0a 2020  : str = None,.  
+00013f80: 2020 2020 2020 7374 6174 653a 2073 7472        state: str
+00013f90: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+00013fa0: 206c 6162 656c 733a 204c 6973 745b 7374   labels: List[st
+00013fb0: 725d 203d 204e 6f6e 652c 0a20 2020 2020  r] = None,.     
+00013fc0: 2020 2070 6172 7469 7469 6f6e 5f62 793a     partition_by:
+00013fd0: 2055 6e69 6f6e 5b0a 2020 2020 2020 2020   Union[.        
+00013fe0: 2020 2020 6d6c 7275 6e2e 636f 6d6d 6f6e      mlrun.common
+00013ff0: 2e73 6368 656d 6173 2e46 6561 7475 7265  .schemas.Feature
+00014000: 5374 6f72 6550 6172 7469 7469 6f6e 4279  StorePartitionBy
+00014010: 4669 656c 642c 2073 7472 0a20 2020 2020  Field, str.     
+00014020: 2020 205d 203d 204e 6f6e 652c 0a20 2020     ] = None,.   
+00014030: 2020 2020 2072 6f77 735f 7065 725f 7061       rows_per_pa
+00014040: 7274 6974 696f 6e3a 2069 6e74 203d 2031  rtition: int = 1
+00014050: 2c0a 2020 2020 2020 2020 7061 7274 6974  ,.        partit
+00014060: 696f 6e5f 736f 7274 5f62 793a 2055 6e69  ion_sort_by: Uni
+00014070: 6f6e 5b6d 6c72 756e 2e63 6f6d 6d6f 6e2e  on[mlrun.common.
+00014080: 7363 6865 6d61 732e 536f 7274 4669 656c  schemas.SortFiel
+00014090: 642c 2073 7472 5d20 3d20 4e6f 6e65 2c0a  d, str] = None,.
+000140a0: 2020 2020 2020 2020 7061 7274 6974 696f          partitio
+000140b0: 6e5f 6f72 6465 723a 2055 6e69 6f6e 5b0a  n_order: Union[.
+000140c0: 2020 2020 2020 2020 2020 2020 6d6c 7275              mlru
+000140d0: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
+000140e0: 2e4f 7264 6572 5479 7065 2c20 7374 720a  .OrderType, str.
+000140f0: 2020 2020 2020 2020 5d20 3d20 6d6c 7275          ] = mlru
+00014100: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
+00014110: 2e4f 7264 6572 5479 7065 2e64 6573 632c  .OrderType.desc,
+00014120: 0a20 2020 2029 202d 3e20 4c69 7374 5b46  .    ) -> List[F
+00014130: 6561 7475 7265 5665 6374 6f72 5d3a 0a20  eatureVector]:. 
+00014140: 2020 2020 2020 2022 2222 5265 7472 6965         """Retrie
+00014150: 7665 2061 206c 6973 7420 6f66 2066 6561  ve a list of fea
+00014160: 7475 7265 2d76 6563 746f 7273 206d 6174  ture-vectors mat
+00014170: 6368 696e 6720 7468 6520 6372 6974 6572  ching the criter
+00014180: 6961 2070 726f 7669 6465 642e 0a0a 2020  ia provided...  
+00014190: 2020 2020 2020 3a70 6172 616d 2070 726f        :param pro
+000141a0: 6a65 6374 3a20 5072 6f6a 6563 7420 6e61  ject: Project na
+000141b0: 6d65 2e0a 2020 2020 2020 2020 3a70 6172  me..        :par
+000141c0: 616d 206e 616d 653a 204e 616d 6520 6f66  am name: Name of
+000141d0: 2066 6561 7475 7265 2d76 6563 746f 7220   feature-vector 
+000141e0: 746f 206d 6174 6368 2e20 5468 6973 2069  to match. This i
+000141f0: 7320 6120 6c69 6b65 2071 7565 7279 2c20  s a like query, 
+00014200: 616e 6420 6973 2063 6173 652d 696e 7365  and is case-inse
+00014210: 6e73 6974 6976 652e 0a20 2020 2020 2020  nsitive..       
+00014220: 203a 7061 7261 6d20 7461 673a 204d 6174   :param tag: Mat
+00014230: 6368 2066 6561 7475 7265 2d76 6563 746f  ch feature-vecto
+00014240: 7273 2077 6974 6820 7370 6563 6966 6963  rs with specific
+00014250: 2074 6167 2e0a 2020 2020 2020 2020 3a70   tag..        :p
+00014260: 6172 616d 2073 7461 7465 3a20 4d61 7463  aram state: Matc
+00014270: 6820 6665 6174 7572 652d 7665 6374 6f72  h feature-vector
+00014280: 7320 7769 7468 2061 2073 7065 6369 6669  s with a specifi
+00014290: 6320 7374 6174 652e 0a20 2020 2020 2020  c state..       
+000142a0: 203a 7061 7261 6d20 6c61 6265 6c73 3a20   :param labels: 
+000142b0: 4d61 7463 6820 6665 6174 7572 652d 7665  Match feature-ve
+000142c0: 6374 6f72 7320 7768 6963 6820 6861 7665  ctors which have
+000142d0: 2074 6865 7365 206c 6162 656c 732e 0a20   these labels.. 
+000142e0: 2020 2020 2020 203a 7061 7261 6d20 7061         :param pa
+000142f0: 7274 6974 696f 6e5f 6279 3a20 4669 656c  rtition_by: Fiel
+00014300: 6420 746f 2067 726f 7570 2072 6573 756c  d to group resul
+00014310: 7473 2062 792e 204f 6e6c 7920 616c 6c6f  ts by. Only allo
+00014320: 7765 6420 7661 6c75 6520 6973 2060 6e61  wed value is `na
+00014330: 6d65 602e 2057 6865 6e20 6070 6172 7469  me`. When `parti
+00014340: 7469 6f6e 5f62 7960 2069 7320 7370 6563  tion_by` is spec
+00014350: 6966 6965 642c 0a20 2020 2020 2020 2020  ified,.         
+00014360: 2020 2074 6865 2060 7061 7274 6974 696f     the `partitio
+00014370: 6e5f 736f 7274 5f62 7960 2070 6172 616d  n_sort_by` param
+00014380: 6574 6572 206d 7573 7420 6265 2070 726f  eter must be pro
+00014390: 7669 6465 6420 6173 2077 656c 6c2e 0a20  vided as well.. 
+000143a0: 2020 2020 2020 203a 7061 7261 6d20 726f         :param ro
+000143b0: 7773 5f70 6572 5f70 6172 7469 7469 6f6e  ws_per_partition
+000143c0: 3a20 486f 7720 6d61 6e79 2074 6f70 2072  : How many top r
+000143d0: 6f77 7320 2870 6572 2073 6f72 7469 6e67  ows (per sorting
+000143e0: 2064 6566 696e 6564 2062 7920 6070 6172   defined by `par
+000143f0: 7469 7469 6f6e 5f73 6f72 745f 6279 6020  tition_sort_by` 
+00014400: 616e 6420 6070 6172 7469 7469 6f6e 5f6f  and `partition_o
+00014410: 7264 6572 6029 0a20 2020 2020 2020 2020  rder`).         
+00014420: 2020 2074 6f20 7265 7475 726e 2070 6572     to return per
+00014430: 2067 726f 7570 2e20 4465 6661 756c 7420   group. Default 
+00014440: 7661 6c75 6520 6973 2031 2e0a 2020 2020  value is 1..    
+00014450: 2020 2020 3a70 6172 616d 2070 6172 7469      :param parti
+00014460: 7469 6f6e 5f73 6f72 745f 6279 3a20 5768  tion_sort_by: Wh
+00014470: 6174 2066 6965 6c64 2074 6f20 736f 7274  at field to sort
+00014480: 2074 6865 2072 6573 756c 7473 2062 792c   the results by,
+00014490: 2077 6974 6869 6e20 6561 6368 2070 6172   within each par
+000144a0: 7469 7469 6f6e 2064 6566 696e 6564 2062  tition defined b
+000144b0: 7920 6070 6172 7469 7469 6f6e 5f62 7960  y `partition_by`
+000144c0: 2e0a 2020 2020 2020 2020 2020 2020 4375  ..            Cu
+000144d0: 7272 656e 746c 7920 7468 6520 6f6e 6c79  rrently the only
+000144e0: 2061 6c6c 6f77 6564 2076 616c 7565 7320   allowed values 
+000144f0: 6172 6520 6063 7265 6174 6564 6020 616e  are `created` an
+00014500: 6420 6075 7064 6174 6564 602e 0a20 2020  d `updated`..   
+00014510: 2020 2020 203a 7061 7261 6d20 7061 7274       :param part
+00014520: 6974 696f 6e5f 6f72 6465 723a 204f 7264  ition_order: Ord
+00014530: 6572 206f 6620 736f 7274 696e 6720 7769  er of sorting wi
+00014540: 7468 696e 2070 6172 7469 7469 6f6e 7320  thin partitions 
+00014550: 2d20 6061 7363 6020 6f72 2060 6465 7363  - `asc` or `desc
+00014560: 602e 2044 6566 6175 6c74 2069 7320 6064  `. Default is `d
+00014570: 6573 6360 2e0a 2020 2020 2020 2020 3a72  esc`..        :r
+00014580: 6574 7572 6e73 3a20 4c69 7374 206f 6620  eturns: List of 
+00014590: 6d61 7463 6869 6e67 203a 7079 3a63 6c61  matching :py:cla
+000145a0: 7373 3a60 7e6d 6c72 756e 2e66 6561 7475  ss:`~mlrun.featu
+000145b0: 7265 5f73 746f 7265 2e46 6561 7475 7265  re_store.Feature
+000145c0: 5665 6374 6f72 6020 6f62 6a65 6374 732e  Vector` objects.
+000145d0: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
+000145e0: 2020 2020 2020 7072 6f6a 6563 7420 3d20        project = 
+000145f0: 7072 6f6a 6563 7420 6f72 2063 6f6e 6669  project or confi
+00014600: 672e 6465 6661 756c 745f 7072 6f6a 6563  g.default_projec
+00014610: 740a 0a20 2020 2020 2020 2070 6172 616d  t..        param
+00014620: 7320 3d20 7b0a 2020 2020 2020 2020 2020  s = {.          
+00014630: 2020 226e 616d 6522 3a20 6e61 6d65 2c0a    "name": name,.
+00014640: 2020 2020 2020 2020 2020 2020 2273 7461              "sta
+00014650: 7465 223a 2073 7461 7465 2c0a 2020 2020  te": state,.    
+00014660: 2020 2020 2020 2020 2274 6167 223a 2074          "tag": t
+00014670: 6167 2c0a 2020 2020 2020 2020 2020 2020  ag,.            
+00014680: 226c 6162 656c 223a 206c 6162 656c 7320  "label": labels 
+00014690: 6f72 205b 5d2c 0a20 2020 2020 2020 207d  or [],.        }
+000146a0: 0a20 2020 2020 2020 2069 6620 7061 7274  .        if part
+000146b0: 6974 696f 6e5f 6279 3a0a 2020 2020 2020  ition_by:.      
+000146c0: 2020 2020 2020 7061 7261 6d73 2e75 7064        params.upd
+000146d0: 6174 6528 0a20 2020 2020 2020 2020 2020  ate(.           
+000146e0: 2020 2020 2073 656c 662e 5f67 656e 6572       self._gener
+000146f0: 6174 655f 7061 7274 6974 696f 6e5f 6279  ate_partition_by
+00014700: 5f70 6172 616d 7328 0a20 2020 2020 2020  _params(.       
+00014710: 2020 2020 2020 2020 2020 2020 206d 6c72               mlr
+00014720: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
+00014730: 732e 4665 6174 7572 6553 746f 7265 5061  s.FeatureStorePa
+00014740: 7274 6974 696f 6e42 7946 6965 6c64 2c0a  rtitionByField,.
 00014750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014760: 2020 7061 7274 6974 696f 6e5f 6f72 6465    partition_orde
-00014770: 722c 0a20 2020 2020 2020 2020 2020 2020  r,.             
-00014780: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-00014790: 2029 0a0a 2020 2020 2020 2020 7061 7468   )..        path
-000147a0: 203d 2066 2270 726f 6a65 6374 732f 7b70   = f"projects/{p
-000147b0: 726f 6a65 6374 7d2f 6665 6174 7572 652d  roject}/feature-
-000147c0: 7665 6374 6f72 7322 0a0a 2020 2020 2020  vectors"..      
-000147d0: 2020 6572 726f 725f 6d65 7373 6167 6520    error_message 
-000147e0: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
-000147f0: 6622 4661 696c 6564 206c 6973 7469 6e67  f"Failed listing
-00014800: 2066 6561 7475 7265 2d76 6563 746f 7273   feature-vectors
-00014810: 2c20 7072 6f6a 6563 743a 207b 7072 6f6a  , project: {proj
-00014820: 6563 747d 2c20 7175 6572 793a 207b 7061  ect}, query: {pa
-00014830: 7261 6d73 7d22 0a20 2020 2020 2020 2029  rams}".        )
-00014840: 0a20 2020 2020 2020 2072 6573 7020 3d20  .        resp = 
-00014850: 7365 6c66 2e61 7069 5f63 616c 6c28 2247  self.api_call("G
-00014860: 4554 222c 2070 6174 682c 2065 7272 6f72  ET", path, error
-00014870: 5f6d 6573 7361 6765 2c20 7061 7261 6d73  _message, params
-00014880: 3d70 6172 616d 7329 0a20 2020 2020 2020  =params).       
-00014890: 2066 6561 7475 7265 5f76 6563 746f 7273   feature_vectors
-000148a0: 203d 2072 6573 702e 6a73 6f6e 2829 5b22   = resp.json()["
-000148b0: 6665 6174 7572 655f 7665 6374 6f72 7322  feature_vectors"
-000148c0: 5d0a 2020 2020 2020 2020 6966 2066 6561  ].        if fea
-000148d0: 7475 7265 5f76 6563 746f 7273 3a0a 2020  ture_vectors:.  
-000148e0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-000148f0: 205b 4665 6174 7572 6556 6563 746f 722e   [FeatureVector.
-00014900: 6672 6f6d 5f64 6963 7428 6f62 6a29 2066  from_dict(obj) f
-00014910: 6f72 206f 626a 2069 6e20 6665 6174 7572  or obj in featur
-00014920: 655f 7665 6374 6f72 735d 0a0a 2020 2020  e_vectors]..    
-00014930: 6465 6620 7374 6f72 655f 6665 6174 7572  def store_featur
-00014940: 655f 7665 6374 6f72 280a 2020 2020 2020  e_vector(.      
-00014950: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-00014960: 6665 6174 7572 655f 7665 6374 6f72 3a20  feature_vector: 
-00014970: 556e 696f 6e5b 6469 6374 2c20 6d6c 7275  Union[dict, mlru
-00014980: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
-00014990: 2e46 6561 7475 7265 5665 6374 6f72 2c20  .FeatureVector, 
-000149a0: 4665 6174 7572 6556 6563 746f 725d 2c0a  FeatureVector],.
-000149b0: 2020 2020 2020 2020 6e61 6d65 3d4e 6f6e          name=Non
-000149c0: 652c 0a20 2020 2020 2020 2070 726f 6a65  e,.        proje
-000149d0: 6374 3d22 222c 0a20 2020 2020 2020 2074  ct="",.        t
-000149e0: 6167 3d4e 6f6e 652c 0a20 2020 2020 2020  ag=None,.       
-000149f0: 2075 6964 3d4e 6f6e 652c 0a20 2020 2020   uid=None,.     
-00014a00: 2020 2076 6572 7369 6f6e 6564 3d54 7275     versioned=Tru
-00014a10: 652c 0a20 2020 2029 202d 3e20 6469 6374  e,.    ) -> dict
-00014a20: 3a0a 2020 2020 2020 2020 2222 2253 746f  :.        """Sto
-00014a30: 7265 2061 203a 7079 3a63 6c61 7373 3a60  re a :py:class:`
-00014a40: 7e6d 6c72 756e 2e66 6561 7475 7265 5f73  ~mlrun.feature_s
-00014a50: 746f 7265 2e46 6561 7475 7265 5665 6374  tore.FeatureVect
-00014a60: 6f72 6020 6f62 6a65 6374 2069 6e20 7468  or` object in th
-00014a70: 6520 3a70 793a 6d6f 643a 606d 6c72 756e  e :py:mod:`mlrun
-00014a80: 6020 4442 2e20 5468 650a 2020 2020 2020  ` DB. The.      
-00014a90: 2020 6665 6174 7572 652d 7665 6374 6f72    feature-vector
-00014aa0: 2063 616e 2062 6520 6569 7468 6572 2061   can be either a
-00014ab0: 206e 6577 206f 626a 6563 7420 6f72 2061   new object or a
-00014ac0: 206d 6f64 6966 6963 6174 696f 6e20 746f   modification to
-00014ad0: 2065 7869 7374 696e 6720 6f62 6a65 6374   existing object
-00014ae0: 2072 6566 6572 656e 6365 6420 6279 2074   referenced by t
-00014af0: 6865 2070 6172 616d 730a 2020 2020 2020  he params.      
-00014b00: 2020 6f66 2074 6865 2066 756e 6374 696f    of the functio
-00014b10: 6e2e 0a0a 2020 2020 2020 2020 3a70 6172  n...        :par
-00014b20: 616d 2066 6561 7475 7265 5f76 6563 746f  am feature_vecto
-00014b30: 723a 2054 6865 203a 7079 3a63 6c61 7373  r: The :py:class
-00014b40: 3a60 7e6d 6c72 756e 2e66 6561 7475 7265  :`~mlrun.feature
-00014b50: 5f73 746f 7265 2e46 6561 7475 7265 5665  _store.FeatureVe
-00014b60: 6374 6f72 6020 746f 2073 746f 7265 2e0a  ctor` to store..
-00014b70: 2020 2020 2020 2020 3a70 6172 616d 206e          :param n
-00014b80: 616d 653a 2020 2020 4e61 6d65 206f 6620  ame:    Name of 
-00014b90: 6665 6174 7572 6520 7665 6374 6f72 2e0a  feature vector..
-00014ba0: 2020 2020 2020 2020 3a70 6172 616d 2070          :param p
-00014bb0: 726f 6a65 6374 3a20 4e61 6d65 206f 6620  roject: Name of 
-00014bc0: 7072 6f6a 6563 7420 7468 6973 2066 6561  project this fea
-00014bd0: 7475 7265 2d76 6563 746f 7220 6265 6c6f  ture-vector belo
-00014be0: 6e67 7320 746f 2e0a 2020 2020 2020 2020  ngs to..        
-00014bf0: 3a70 6172 616d 2074 6167 3a20 5468 6520  :param tag: The 
-00014c00: 6060 7461 6760 6020 6f66 2074 6865 206f  ``tag`` of the o
-00014c10: 626a 6563 7420 746f 2072 6570 6c61 6365  bject to replace
-00014c20: 2069 6e20 7468 6520 4442 2c20 666f 7220   in the DB, for 
-00014c30: 6578 616d 706c 6520 6060 6c61 7465 7374  example ``latest
-00014c40: 6060 2e0a 2020 2020 2020 2020 3a70 6172  ``..        :par
-00014c50: 616d 2075 6964 3a20 5468 6520 6060 7569  am uid: The ``ui
-00014c60: 6460 6020 6f66 2074 6865 206f 626a 6563  d`` of the objec
-00014c70: 7420 746f 2072 6570 6c61 6365 2069 6e20  t to replace in 
-00014c80: 7468 6520 4442 2e20 4966 2075 7369 6e67  the DB. If using
-00014c90: 2074 6869 7320 7061 7261 6d65 7465 722c   this parameter,
-00014ca0: 2074 6865 206d 6f64 6966 6965 6420 6f62   the modified ob
-00014cb0: 6a65 6374 0a20 2020 2020 2020 2020 2020  ject.           
-00014cc0: 206d 7573 7420 6861 7665 2074 6865 2073   must have the s
-00014cd0: 616d 6520 6060 7569 6460 6020 6f66 2074  ame ``uid`` of t
-00014ce0: 6865 2070 7265 7669 6f75 736c 792d 6578  he previously-ex
-00014cf0: 6973 7469 6e67 206f 626a 6563 742e 2054  isting object. T
-00014d00: 6869 7320 6361 6e6e 6f74 2062 6520 7573  his cannot be us
-00014d10: 6564 2066 6f72 206e 6f6e 2d76 6572 7369  ed for non-versi
-00014d20: 6f6e 6564 206f 626a 6563 7473 2e0a 2020  oned objects..  
-00014d30: 2020 2020 2020 3a70 6172 616d 2076 6572        :param ver
-00014d40: 7369 6f6e 6564 3a20 5768 6574 6865 7220  sioned: Whether 
-00014d50: 746f 206d 6169 6e74 6169 6e20 7665 7273  to maintain vers
-00014d60: 696f 6e73 2066 6f72 2074 6869 7320 6665  ions for this fe
-00014d70: 6174 7572 652d 7665 6374 6f72 2e20 416c  ature-vector. Al
-00014d80: 6c20 7665 7273 696f 6e73 206f 6620 6120  l versions of a 
-00014d90: 7665 7273 696f 6e65 6420 6f62 6a65 6374  versioned object
-00014da0: 0a20 2020 2020 2020 2020 2020 2077 696c  .            wil
-00014db0: 6c20 6265 206b 6570 7420 696e 2074 6865  l be kept in the
-00014dc0: 2044 4220 616e 6420 6361 6e20 6265 2072   DB and can be r
-00014dd0: 6574 7269 6576 6564 2075 6e74 696c 2065  etrieved until e
-00014de0: 7870 6c69 6369 746c 7920 6465 6c65 7465  xplicitly delete
-00014df0: 642e 0a20 2020 2020 2020 203a 7265 7475  d..        :retu
-00014e00: 726e 733a 2054 6865 203a 7079 3a63 6c61  rns: The :py:cla
-00014e10: 7373 3a60 7e6d 6c72 756e 2e66 6561 7475  ss:`~mlrun.featu
-00014e20: 7265 5f73 746f 7265 2e46 6561 7475 7265  re_store.Feature
-00014e30: 5665 6374 6f72 6020 6f62 6a65 6374 2028  Vector` object (
-00014e40: 6173 2064 6963 7429 2e0a 2020 2020 2020  as dict)..      
-00014e50: 2020 2222 220a 0a20 2020 2020 2020 2072    """..        r
-00014e60: 6566 6572 656e 6365 203d 2073 656c 662e  eference = self.
-00014e70: 5f72 6573 6f6c 7665 5f72 6566 6572 656e  _resolve_referen
-00014e80: 6365 2874 6167 2c20 7569 6429 0a20 2020  ce(tag, uid).   
-00014e90: 2020 2020 2070 6172 616d 7320 3d20 7b22       params = {"
-00014ea0: 7665 7273 696f 6e65 6422 3a20 7665 7273  versioned": vers
-00014eb0: 696f 6e65 647d 0a0a 2020 2020 2020 2020  ioned}..        
-00014ec0: 6966 2069 7369 6e73 7461 6e63 6528 6665  if isinstance(fe
-00014ed0: 6174 7572 655f 7665 6374 6f72 2c20 6d6c  ature_vector, ml
-00014ee0: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
-00014ef0: 6173 2e46 6561 7475 7265 5665 6374 6f72  as.FeatureVector
-00014f00: 293a 0a20 2020 2020 2020 2020 2020 2066  ):.            f
-00014f10: 6561 7475 7265 5f76 6563 746f 7220 3d20  eature_vector = 
-00014f20: 6665 6174 7572 655f 7665 6374 6f72 2e64  feature_vector.d
-00014f30: 6963 7428 290a 2020 2020 2020 2020 656c  ict().        el
-00014f40: 6966 2069 7369 6e73 7461 6e63 6528 6665  if isinstance(fe
-00014f50: 6174 7572 655f 7665 6374 6f72 2c20 4665  ature_vector, Fe
-00014f60: 6174 7572 6556 6563 746f 7229 3a0a 2020  atureVector):.  
-00014f70: 2020 2020 2020 2020 2020 6665 6174 7572            featur
-00014f80: 655f 7665 6374 6f72 203d 2066 6561 7475  e_vector = featu
-00014f90: 7265 5f76 6563 746f 722e 746f 5f64 6963  re_vector.to_dic
-00014fa0: 7428 290a 0a20 2020 2020 2020 206e 616d  t()..        nam
-00014fb0: 6520 3d20 6e61 6d65 206f 7220 6665 6174  e = name or feat
-00014fc0: 7572 655f 7665 6374 6f72 5b22 6d65 7461  ure_vector["meta
-00014fd0: 6461 7461 225d 5b22 6e61 6d65 225d 0a20  data"]["name"]. 
-00014fe0: 2020 2020 2020 2070 726f 6a65 6374 203d         project =
-00014ff0: 2028 0a20 2020 2020 2020 2020 2020 2070   (.            p
-00015000: 726f 6a65 6374 0a20 2020 2020 2020 2020  roject.         
-00015010: 2020 206f 7220 6665 6174 7572 655f 7665     or feature_ve
-00015020: 6374 6f72 5b22 6d65 7461 6461 7461 225d  ctor["metadata"]
-00015030: 2e67 6574 2822 7072 6f6a 6563 7422 290a  .get("project").
-00015040: 2020 2020 2020 2020 2020 2020 6f72 2063              or c
-00015050: 6f6e 6669 672e 6465 6661 756c 745f 7072  onfig.default_pr
-00015060: 6f6a 6563 740a 2020 2020 2020 2020 290a  oject.        ).
-00015070: 2020 2020 2020 2020 7061 7468 203d 2066          path = f
-00015080: 2270 726f 6a65 6374 732f 7b70 726f 6a65  "projects/{proje
-00015090: 6374 7d2f 6665 6174 7572 652d 7665 6374  ct}/feature-vect
-000150a0: 6f72 732f 7b6e 616d 657d 2f72 6566 6572  ors/{name}/refer
-000150b0: 656e 6365 732f 7b72 6566 6572 656e 6365  ences/{reference
-000150c0: 7d22 0a20 2020 2020 2020 2065 7272 6f72  }".        error
-000150d0: 5f6d 6573 7361 6765 203d 2066 2246 6169  _message = f"Fai
-000150e0: 6c65 6420 7374 6f72 696e 6720 6665 6174  led storing feat
-000150f0: 7572 652d 7665 6374 6f72 207b 7072 6f6a  ure-vector {proj
-00015100: 6563 747d 2f7b 6e61 6d65 7d22 0a20 2020  ect}/{name}".   
-00015110: 2020 2020 2072 6573 7020 3d20 7365 6c66       resp = self
-00015120: 2e61 7069 5f63 616c 6c28 0a20 2020 2020  .api_call(.     
-00015130: 2020 2020 2020 2022 5055 5422 2c20 7061         "PUT", pa
-00015140: 7468 2c20 6572 726f 725f 6d65 7373 6167  th, error_messag
-00015150: 652c 2070 6172 616d 733d 7061 7261 6d73  e, params=params
-00015160: 2c20 626f 6479 3d64 6963 745f 746f 5f6a  , body=dict_to_j
-00015170: 736f 6e28 6665 6174 7572 655f 7665 6374  son(feature_vect
-00015180: 6f72 290a 2020 2020 2020 2020 290a 2020  or).        ).  
-00015190: 2020 2020 2020 7265 7475 726e 2072 6573        return res
-000151a0: 702e 6a73 6f6e 2829 0a0a 2020 2020 6465  p.json()..    de
-000151b0: 6620 7061 7463 685f 6665 6174 7572 655f  f patch_feature_
-000151c0: 7665 6374 6f72 280a 2020 2020 2020 2020  vector(.        
-000151d0: 7365 6c66 2c0a 2020 2020 2020 2020 6e61  self,.        na
-000151e0: 6d65 2c0a 2020 2020 2020 2020 6665 6174  me,.        feat
-000151f0: 7572 655f 7665 6374 6f72 5f75 7064 6174  ure_vector_updat
-00015200: 653a 2064 6963 742c 0a20 2020 2020 2020  e: dict,.       
-00015210: 2070 726f 6a65 6374 3d22 222c 0a20 2020   project="",.   
-00015220: 2020 2020 2074 6167 3d4e 6f6e 652c 0a20       tag=None,. 
-00015230: 2020 2020 2020 2075 6964 3d4e 6f6e 652c         uid=None,
-00015240: 0a20 2020 2020 2020 2070 6174 6368 5f6d  .        patch_m
-00015250: 6f64 653a 2055 6e69 6f6e 5b0a 2020 2020  ode: Union[.    
-00015260: 2020 2020 2020 2020 7374 722c 206d 6c72          str, mlr
-00015270: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
-00015280: 732e 5061 7463 684d 6f64 650a 2020 2020  s.PatchMode.    
-00015290: 2020 2020 5d20 3d20 6d6c 7275 6e2e 636f      ] = mlrun.co
-000152a0: 6d6d 6f6e 2e73 6368 656d 6173 2e50 6174  mmon.schemas.Pat
-000152b0: 6368 4d6f 6465 2e72 6570 6c61 6365 2c0a  chMode.replace,.
-000152c0: 2020 2020 293a 0a20 2020 2020 2020 2022      ):.        "
-000152d0: 2222 4d6f 6469 6679 2028 7061 7463 6829  ""Modify (patch)
-000152e0: 2061 6e20 6578 6973 7469 6e67 203a 7079   an existing :py
-000152f0: 3a63 6c61 7373 3a60 7e6d 6c72 756e 2e66  :class:`~mlrun.f
-00015300: 6561 7475 7265 5f73 746f 7265 2e46 6561  eature_store.Fea
-00015310: 7475 7265 5665 6374 6f72 6020 6f62 6a65  tureVector` obje
-00015320: 6374 2e0a 2020 2020 2020 2020 5468 6520  ct..        The 
-00015330: 6f62 6a65 6374 2069 7320 6964 656e 7469  object is identi
-00015340: 6669 6564 2062 7920 6974 7320 6e61 6d65  fied by its name
-00015350: 2028 616e 6420 7072 6f6a 6563 7420 6974   (and project it
-00015360: 2062 656c 6f6e 6773 2074 6f29 2c20 6173   belongs to), as
-00015370: 2077 656c 6c20 6173 206f 7074 696f 6e61   well as optiona
-00015380: 6c6c 7920 6120 6060 7461 6760 6020 6f72  lly a ``tag`` or
-00015390: 2069 7473 0a20 2020 2020 2020 2060 6075   its.        ``u
-000153a0: 6964 6060 2028 666f 7220 7665 7273 696f  id`` (for versio
-000153b0: 6e65 6420 6f62 6a65 6374 292e 2049 6620  ned object). If 
-000153c0: 626f 7468 2060 6074 6167 6060 2061 6e64  both ``tag`` and
-000153d0: 2060 6075 6964 6060 2061 7265 206f 6d69   ``uid`` are omi
-000153e0: 7474 6564 2074 6865 6e20 7468 6520 6f62  tted then the ob
-000153f0: 6a65 6374 2077 6974 6820 7461 6720 6060  ject with tag ``
-00015400: 6c61 7465 7374 6060 0a20 2020 2020 2020  latest``.       
-00015410: 2069 7320 6d6f 6469 6669 6564 2e0a 0a20   is modified... 
-00015420: 2020 2020 2020 203a 7061 7261 6d20 6e61         :param na
-00015430: 6d65 3a20 4e61 6d65 206f 6620 7468 6520  me: Name of the 
-00015440: 6f62 6a65 6374 2074 6f20 7061 7463 682e  object to patch.
-00015450: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00015460: 6665 6174 7572 655f 7665 6374 6f72 5f75  feature_vector_u
-00015470: 7064 6174 653a 2054 6865 206d 6f64 6966  pdate: The modif
-00015480: 6963 6174 696f 6e73 206e 6565 6465 6420  ications needed 
-00015490: 696e 2074 6865 206f 626a 6563 742e 2054  in the object. T
-000154a0: 6869 7320 7061 7261 6d65 7465 7220 6f6e  his parameter on
-000154b0: 6c79 2068 6173 2074 6865 2063 6861 6e67  ly has the chang
-000154c0: 6573 2069 6e20 6974 2c0a 2020 2020 2020  es in it,.      
-000154d0: 2020 2020 2020 6e6f 7420 6120 6675 6c6c        not a full
-000154e0: 206f 626a 6563 742e 0a20 2020 2020 2020   object..       
-000154f0: 203a 7061 7261 6d20 7072 6f6a 6563 743a   :param project:
-00015500: 2050 726f 6a65 6374 2077 6869 6368 2063   Project which c
-00015510: 6f6e 7461 696e 7320 7468 6520 6d6f 6469  ontains the modi
-00015520: 6669 6564 206f 626a 6563 742e 0a20 2020  fied object..   
-00015530: 2020 2020 203a 7061 7261 6d20 7461 673a       :param tag:
-00015540: 2054 6865 2074 6167 206f 6620 7468 6520   The tag of the 
-00015550: 6f62 6a65 6374 2074 6f20 6d6f 6469 6679  object to modify
-00015560: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00015570: 2075 6964 3a20 7569 6420 6f66 2074 6865   uid: uid of the
-00015580: 206f 626a 6563 7420 746f 206d 6f64 6966   object to modif
-00015590: 792e 0a20 2020 2020 2020 203a 7061 7261  y..        :para
-000155a0: 6d20 7061 7463 685f 6d6f 6465 3a20 5468  m patch_mode: Th
-000155b0: 6520 7374 7261 7465 6779 2066 6f72 206d  e strategy for m
-000155c0: 6572 6769 6e67 2074 6865 2063 6861 6e67  erging the chang
-000155d0: 6573 2077 6974 6820 7468 6520 6578 6973  es with the exis
-000155e0: 7469 6e67 206f 626a 6563 742e 2043 616e  ting object. Can
-000155f0: 2062 6520 6569 7468 6572 2060 6072 6570   be either ``rep
-00015600: 6c61 6365 6060 0a20 2020 2020 2020 2020  lace``.         
-00015610: 2020 206f 7220 6060 6164 6469 7469 7665     or ``additive
-00015620: 6060 2e0a 2020 2020 2020 2020 2222 220a  ``..        """.
-00015630: 2020 2020 2020 2020 7265 6665 7265 6e63          referenc
-00015640: 6520 3d20 7365 6c66 2e5f 7265 736f 6c76  e = self._resolv
-00015650: 655f 7265 6665 7265 6e63 6528 7461 672c  e_reference(tag,
-00015660: 2075 6964 290a 2020 2020 2020 2020 7072   uid).        pr
-00015670: 6f6a 6563 7420 3d20 7072 6f6a 6563 7420  oject = project 
-00015680: 6f72 2063 6f6e 6669 672e 6465 6661 756c  or config.defaul
-00015690: 745f 7072 6f6a 6563 740a 2020 2020 2020  t_project.      
-000156a0: 2020 6865 6164 6572 7320 3d20 7b6d 6c72    headers = {mlr
-000156b0: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
-000156c0: 732e 4865 6164 6572 4e61 6d65 732e 7061  s.HeaderNames.pa
-000156d0: 7463 685f 6d6f 6465 3a20 7061 7463 685f  tch_mode: patch_
-000156e0: 6d6f 6465 7d0a 2020 2020 2020 2020 7061  mode}.        pa
-000156f0: 7468 203d 2066 2270 726f 6a65 6374 732f  th = f"projects/
-00015700: 7b70 726f 6a65 6374 7d2f 6665 6174 7572  {project}/featur
-00015710: 652d 7665 6374 6f72 732f 7b6e 616d 657d  e-vectors/{name}
-00015720: 2f72 6566 6572 656e 6365 732f 7b72 6566  /references/{ref
-00015730: 6572 656e 6365 7d22 0a20 2020 2020 2020  erence}".       
-00015740: 2065 7272 6f72 5f6d 6573 7361 6765 203d   error_message =
-00015750: 2066 2246 6169 6c65 6420 7570 6461 7469   f"Failed updati
-00015760: 6e67 2066 6561 7475 7265 2d76 6563 746f  ng feature-vecto
-00015770: 7220 7b70 726f 6a65 6374 7d2f 7b6e 616d  r {project}/{nam
-00015780: 657d 220a 2020 2020 2020 2020 7365 6c66  e}".        self
-00015790: 2e61 7069 5f63 616c 6c28 0a20 2020 2020  .api_call(.     
-000157a0: 2020 2020 2020 2022 5041 5443 4822 2c0a         "PATCH",.
-000157b0: 2020 2020 2020 2020 2020 2020 7061 7468              path
-000157c0: 2c0a 2020 2020 2020 2020 2020 2020 6572  ,.            er
-000157d0: 726f 725f 6d65 7373 6167 652c 0a20 2020  ror_message,.   
-000157e0: 2020 2020 2020 2020 2062 6f64 793d 6469           body=di
-000157f0: 6374 5f74 6f5f 6a73 6f6e 2866 6561 7475  ct_to_json(featu
-00015800: 7265 5f76 6563 746f 725f 7570 6461 7465  re_vector_update
-00015810: 292c 0a20 2020 2020 2020 2020 2020 2068  ),.            h
-00015820: 6561 6465 7273 3d68 6561 6465 7273 2c0a  eaders=headers,.
-00015830: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
-00015840: 6566 2064 656c 6574 655f 6665 6174 7572  ef delete_featur
-00015850: 655f 7665 6374 6f72 2873 656c 662c 206e  e_vector(self, n
-00015860: 616d 652c 2070 726f 6a65 6374 3d22 222c  ame, project="",
-00015870: 2074 6167 3d4e 6f6e 652c 2075 6964 3d4e   tag=None, uid=N
-00015880: 6f6e 6529 3a0a 2020 2020 2020 2020 2222  one):.        ""
-00015890: 2244 656c 6574 6520 6120 3a70 793a 636c  "Delete a :py:cl
-000158a0: 6173 733a 607e 6d6c 7275 6e2e 6665 6174  ass:`~mlrun.feat
-000158b0: 7572 655f 7374 6f72 652e 4665 6174 7572  ure_store.Featur
-000158c0: 6556 6563 746f 7260 206f 626a 6563 7420  eVector` object 
-000158d0: 6672 6f6d 2074 6865 2044 422e 0a20 2020  from the DB..   
-000158e0: 2020 2020 2049 6620 6060 7461 6760 6020       If ``tag`` 
-000158f0: 6f72 2060 6075 6964 6060 2061 7265 2073  or ``uid`` are s
-00015900: 7065 6369 6669 6564 2c20 7468 656e 206a  pecified, then j
-00015910: 7573 7420 7468 6520 7665 7273 696f 6e20  ust the version 
-00015920: 7265 6665 7265 6e63 6564 2062 7920 7468  referenced by th
-00015930: 656d 2077 696c 6c20 6265 2064 656c 6574  em will be delet
-00015940: 6564 2e20 5573 696e 6720 626f 7468 0a20  ed. Using both. 
-00015950: 2020 2020 2020 2069 7320 6e6f 7420 616c         is not al
-00015960: 6c6f 7765 642e 0a20 2020 2020 2020 2049  lowed..        I
-00015970: 6620 6e6f 6e65 2061 7265 2073 7065 6369  f none are speci
-00015980: 6669 6564 2c20 7468 656e 2061 6c6c 2069  fied, then all i
-00015990: 6e73 7461 6e63 6573 206f 6620 7468 6520  nstances of the 
-000159a0: 6f62 6a65 6374 2077 686f 7365 206e 616d  object whose nam
-000159b0: 6520 6973 2060 606e 616d 6560 6020 7769  e is ``name`` wi
-000159c0: 6c6c 2062 6520 6465 6c65 7465 642e 0a20  ll be deleted.. 
-000159d0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-000159e0: 2020 2070 726f 6a65 6374 203d 2070 726f     project = pro
-000159f0: 6a65 6374 206f 7220 636f 6e66 6967 2e64  ject or config.d
-00015a00: 6566 6175 6c74 5f70 726f 6a65 6374 0a20  efault_project. 
-00015a10: 2020 2020 2020 2070 6174 6820 3d20 6622         path = f"
-00015a20: 7072 6f6a 6563 7473 2f7b 7072 6f6a 6563  projects/{projec
-00015a30: 747d 2f66 6561 7475 7265 2d76 6563 746f  t}/feature-vecto
-00015a40: 7273 2f7b 6e61 6d65 7d22 0a20 2020 2020  rs/{name}".     
-00015a50: 2020 2069 6620 7461 6720 6f72 2075 6964     if tag or uid
-00015a60: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-00015a70: 6665 7265 6e63 6520 3d20 7365 6c66 2e5f  ference = self._
-00015a80: 7265 736f 6c76 655f 7265 6665 7265 6e63  resolve_referenc
-00015a90: 6528 7461 672c 2075 6964 290a 2020 2020  e(tag, uid).    
-00015aa0: 2020 2020 2020 2020 7061 7468 203d 2070          path = p
-00015ab0: 6174 6820 2b20 6622 2f72 6566 6572 656e  ath + f"/referen
-00015ac0: 6365 732f 7b72 6566 6572 656e 6365 7d22  ces/{reference}"
-00015ad0: 0a0a 2020 2020 2020 2020 6572 726f 725f  ..        error_
-00015ae0: 6d65 7373 6167 6520 3d20 6622 4661 696c  message = f"Fail
-00015af0: 6564 2064 656c 6574 696e 6720 6665 6174  ed deleting feat
-00015b00: 7572 652d 7665 6374 6f72 207b 6e61 6d65  ure-vector {name
-00015b10: 7d22 0a20 2020 2020 2020 2073 656c 662e  }".        self.
-00015b20: 6170 695f 6361 6c6c 2822 4445 4c45 5445  api_call("DELETE
-00015b30: 222c 2070 6174 682c 2065 7272 6f72 5f6d  ", path, error_m
-00015b40: 6573 7361 6765 290a 0a20 2020 2064 6566  essage)..    def
-00015b50: 2074 6167 5f6f 626a 6563 7473 280a 2020   tag_objects(.  
-00015b60: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-00015b70: 2020 2020 7072 6f6a 6563 743a 2073 7472      project: str
-00015b80: 2c0a 2020 2020 2020 2020 7461 675f 6e61  ,.        tag_na
-00015b90: 6d65 3a20 7374 722c 0a20 2020 2020 2020  me: str,.       
-00015ba0: 206f 626a 6563 7473 3a20 556e 696f 6e5b   objects: Union[
-00015bb0: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
-00015bc0: 656d 6173 2e54 6167 4f62 6a65 6374 732c  emas.TagObjects,
-00015bd0: 2064 6963 745d 2c0a 2020 2020 2020 2020   dict],.        
-00015be0: 7265 706c 6163 653a 2062 6f6f 6c20 3d20  replace: bool = 
-00015bf0: 4661 6c73 652c 0a20 2020 2029 3a0a 2020  False,.    ):.  
-00015c00: 2020 2020 2020 2222 2254 6167 2061 206c        """Tag a l
-00015c10: 6973 7420 6f66 206f 626a 6563 7473 2e0a  ist of objects..
-00015c20: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00015c30: 7072 6f6a 6563 743a 2050 726f 6a65 6374  project: Project
-00015c40: 2077 6869 6368 2063 6f6e 7461 696e 7320   which contains 
-00015c50: 7468 6520 6f62 6a65 6374 732e 0a20 2020  the objects..   
-00015c60: 2020 2020 203a 7061 7261 6d20 7461 675f       :param tag_
-00015c70: 6e61 6d65 3a20 5468 6520 7461 6720 746f  name: The tag to
-00015c80: 2073 6574 206f 6e20 7468 6520 6f62 6a65   set on the obje
-00015c90: 6374 732e 0a20 2020 2020 2020 203a 7061  cts..        :pa
-00015ca0: 7261 6d20 6f62 6a65 6374 733a 2054 6865  ram objects: The
-00015cb0: 206f 626a 6563 7473 2074 6f20 7461 672e   objects to tag.
-00015cc0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00015cd0: 7265 706c 6163 653a 2057 6865 7468 6572  replace: Whether
-00015ce0: 2074 6f20 7265 706c 6163 6520 7468 6520   to replace the 
-00015cf0: 6578 6973 7469 6e67 2074 6167 7320 6f66  existing tags of
-00015d00: 2074 6865 206f 626a 6563 7473 206f 7220   the objects or 
-00015d10: 746f 2061 6464 2074 6865 206e 6577 2074  to add the new t
-00015d20: 6167 2074 6f20 7468 656d 2e0a 2020 2020  ag to them..    
-00015d30: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
-00015d40: 2070 6174 6820 3d20 6622 7072 6f6a 6563   path = f"projec
-00015d50: 7473 2f7b 7072 6f6a 6563 747d 2f74 6167  ts/{project}/tag
-00015d60: 732f 7b74 6167 5f6e 616d 657d 220a 2020  s/{tag_name}".  
-00015d70: 2020 2020 2020 6572 726f 725f 6d65 7373        error_mess
-00015d80: 6167 6520 3d20 6622 4661 696c 6564 2074  age = f"Failed t
-00015d90: 6f20 7461 6720 7b74 6167 5f6e 616d 657d  o tag {tag_name}
-00015da0: 206f 6e20 6f62 6a65 6374 7320 7b6f 626a   on objects {obj
-00015db0: 6563 7473 7d22 0a20 2020 2020 2020 206d  ects}".        m
-00015dc0: 6574 686f 6420 3d20 2250 4f53 5422 2069  ethod = "POST" i
-00015dd0: 6620 7265 706c 6163 6520 656c 7365 2022  f replace else "
-00015de0: 5055 5422 0a20 2020 2020 2020 2073 656c  PUT".        sel
-00015df0: 662e 6170 695f 6361 6c6c 280a 2020 2020  f.api_call(.    
-00015e00: 2020 2020 2020 2020 6d65 7468 6f64 2c0a          method,.
-00015e10: 2020 2020 2020 2020 2020 2020 7061 7468              path
-00015e20: 2c0a 2020 2020 2020 2020 2020 2020 6572  ,.            er
-00015e30: 726f 725f 6d65 7373 6167 652c 0a20 2020  ror_message,.   
-00015e40: 2020 2020 2020 2020 2062 6f64 793d 6469           body=di
-00015e50: 6374 5f74 6f5f 6a73 6f6e 280a 2020 2020  ct_to_json(.    
-00015e60: 2020 2020 2020 2020 2020 2020 6f62 6a65              obje
-00015e70: 6374 732e 6469 6374 2829 0a20 2020 2020  cts.dict().     
-00015e80: 2020 2020 2020 2020 2020 2069 6620 6973             if is
-00015e90: 696e 7374 616e 6365 286f 626a 6563 7473  instance(objects
-00015ea0: 2c20 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  , mlrun.common.s
-00015eb0: 6368 656d 6173 2e54 6167 4f62 6a65 6374  chemas.TagObject
-00015ec0: 7329 0a20 2020 2020 2020 2020 2020 2020  s).             
-00015ed0: 2020 2065 6c73 6520 6f62 6a65 6374 730a     else objects.
-00015ee0: 2020 2020 2020 2020 2020 2020 292c 0a20              ),. 
-00015ef0: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
-00015f00: 6620 6465 6c65 7465 5f6f 626a 6563 7473  f delete_objects
-00015f10: 5f74 6167 280a 2020 2020 2020 2020 7365  _tag(.        se
-00015f20: 6c66 2c0a 2020 2020 2020 2020 7072 6f6a  lf,.        proj
-00015f30: 6563 743a 2073 7472 2c0a 2020 2020 2020  ect: str,.      
-00015f40: 2020 7461 675f 6e61 6d65 3a20 7374 722c    tag_name: str,
-00015f50: 0a20 2020 2020 2020 2074 6167 5f6f 626a  .        tag_obj
-00015f60: 6563 7473 3a20 556e 696f 6e5b 6d6c 7275  ects: Union[mlru
-00015f70: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
-00015f80: 2e54 6167 4f62 6a65 6374 732c 2064 6963  .TagObjects, dic
-00015f90: 745d 2c0a 2020 2020 293a 0a20 2020 2020  t],.    ):.     
-00015fa0: 2020 2022 2222 4465 6c65 7465 2061 2074     """Delete a t
-00015fb0: 6167 2066 726f 6d20 6120 6c69 7374 206f  ag from a list o
-00015fc0: 6620 6f62 6a65 6374 732e 0a0a 2020 2020  f objects...    
-00015fd0: 2020 2020 3a70 6172 616d 2070 726f 6a65      :param proje
-00015fe0: 6374 3a20 5072 6f6a 6563 7420 7768 6963  ct: Project whic
-00015ff0: 6820 636f 6e74 6169 6e73 2074 6865 206f  h contains the o
-00016000: 626a 6563 7473 2e0a 2020 2020 2020 2020  bjects..        
-00016010: 3a70 6172 616d 2074 6167 5f6e 616d 653a  :param tag_name:
-00016020: 2054 6865 2074 6167 2074 6f20 6465 6c65   The tag to dele
-00016030: 7465 2066 726f 6d20 7468 6520 6f62 6a65  te from the obje
-00016040: 6374 732e 0a20 2020 2020 2020 203a 7061  cts..        :pa
-00016050: 7261 6d20 7461 675f 6f62 6a65 6374 733a  ram tag_objects:
-00016060: 2054 6865 206f 626a 6563 7473 2074 6f20   The objects to 
-00016070: 6465 6c65 7465 2074 6865 2074 6167 2066  delete the tag f
-00016080: 726f 6d2e 0a0a 2020 2020 2020 2020 2222  rom...        ""
-00016090: 220a 2020 2020 2020 2020 7061 7468 203d  ".        path =
-000160a0: 2066 2270 726f 6a65 6374 732f 7b70 726f   f"projects/{pro
-000160b0: 6a65 6374 7d2f 7461 6773 2f7b 7461 675f  ject}/tags/{tag_
-000160c0: 6e61 6d65 7d22 0a20 2020 2020 2020 2065  name}".        e
-000160d0: 7272 6f72 5f6d 6573 7361 6765 203d 2066  rror_message = f
-000160e0: 2246 6169 6c65 6420 6465 6c65 7469 6e67  "Failed deleting
-000160f0: 2074 6167 2066 726f 6d20 7b74 6167 5f6e   tag from {tag_n
-00016100: 616d 657d 220a 2020 2020 2020 2020 7365  ame}".        se
-00016110: 6c66 2e61 7069 5f63 616c 6c28 0a20 2020  lf.api_call(.   
-00016120: 2020 2020 2020 2020 2022 4445 4c45 5445           "DELETE
-00016130: 222c 0a20 2020 2020 2020 2020 2020 2070  ",.            p
-00016140: 6174 682c 0a20 2020 2020 2020 2020 2020  ath,.           
-00016150: 2065 7272 6f72 5f6d 6573 7361 6765 2c0a   error_message,.
-00016160: 2020 2020 2020 2020 2020 2020 626f 6479              body
-00016170: 3d64 6963 745f 746f 5f6a 736f 6e28 0a20  =dict_to_json(. 
-00016180: 2020 2020 2020 2020 2020 2020 2020 2074                 t
-00016190: 6167 5f6f 626a 6563 7473 2e64 6963 7428  ag_objects.dict(
-000161a0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-000161b0: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-000161c0: 7461 675f 6f62 6a65 6374 732c 206d 6c72  tag_objects, mlr
-000161d0: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
-000161e0: 732e 5461 674f 626a 6563 7473 290a 2020  s.TagObjects).  
-000161f0: 2020 2020 2020 2020 2020 2020 2020 656c                el
-00016200: 7365 2074 6167 5f6f 626a 6563 7473 0a20  se tag_objects. 
-00016210: 2020 2020 2020 2020 2020 2029 2c0a 2020             ),.  
-00016220: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
-00016230: 2074 6167 5f61 7274 6966 6163 7473 280a   tag_artifacts(.
-00016240: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-00016250: 2020 2020 2020 6172 7469 6661 6374 733a        artifacts:
-00016260: 2055 6e69 6f6e 5b4c 6973 745b 4172 7469   Union[List[Arti
-00016270: 6661 6374 5d2c 204c 6973 745b 6469 6374  fact], List[dict
-00016280: 5d2c 2041 7274 6966 6163 742c 2064 6963  ], Artifact, dic
-00016290: 745d 2c0a 2020 2020 2020 2020 7072 6f6a  t],.        proj
-000162a0: 6563 743a 2073 7472 2c0a 2020 2020 2020  ect: str,.      
-000162b0: 2020 7461 675f 6e61 6d65 3a20 7374 722c    tag_name: str,
-000162c0: 0a20 2020 2020 2020 2072 6570 6c61 6365  .        replace
-000162d0: 3a20 626f 6f6c 203d 2046 616c 7365 2c0a  : bool = False,.
-000162e0: 2020 2020 293a 0a20 2020 2020 2020 2022      ):.        "
-000162f0: 2222 5461 6720 6120 6c69 7374 206f 6620  ""Tag a list of 
-00016300: 6172 7469 6661 6374 732e 0a0a 2020 2020  artifacts...    
-00016310: 2020 2020 3a70 6172 616d 2061 7274 6966      :param artif
-00016320: 6163 7473 3a20 5468 6520 6172 7469 6661  acts: The artifa
-00016330: 6374 7320 746f 2074 6167 2e20 4361 6e20  cts to tag. Can 
-00016340: 6265 2061 206c 6973 7420 6f66 203a 7079  be a list of :py
-00016350: 3a63 6c61 7373 3a60 7e6d 6c72 756e 2e61  :class:`~mlrun.a
-00016360: 7274 6966 6163 7473 2e41 7274 6966 6163  rtifacts.Artifac
-00016370: 7460 206f 626a 6563 7473 206f 720a 2020  t` objects or.  
-00016380: 2020 2020 2020 2020 2020 6469 6374 696f            dictio
-00016390: 6e61 7269 6573 2c20 6f72 2061 2073 696e  naries, or a sin
-000163a0: 676c 6520 6f62 6a65 6374 2e0a 2020 2020  gle object..    
-000163b0: 2020 2020 3a70 6172 616d 2070 726f 6a65      :param proje
-000163c0: 6374 3a20 5072 6f6a 6563 7420 7768 6963  ct: Project whic
-000163d0: 6820 636f 6e74 6169 6e73 2074 6865 2061  h contains the a
-000163e0: 7274 6966 6163 7473 2e0a 2020 2020 2020  rtifacts..      
-000163f0: 2020 3a70 6172 616d 2074 6167 5f6e 616d    :param tag_nam
-00016400: 653a 2054 6865 2074 6167 2074 6f20 7365  e: The tag to se
-00016410: 7420 6f6e 2074 6865 2061 7274 6966 6163  t on the artifac
-00016420: 7473 2e0a 2020 2020 2020 2020 3a70 6172  ts..        :par
-00016430: 616d 2072 6570 6c61 6365 3a20 4966 2054  am replace: If T
-00016440: 7275 652c 2072 6570 6c61 6365 2065 7869  rue, replace exi
-00016450: 7374 696e 6720 7461 6773 2c20 6f74 6865  sting tags, othe
-00016460: 7277 6973 6520 6170 7065 6e64 2074 6f20  rwise append to 
-00016470: 6578 6973 7469 6e67 2074 6167 732e 0a20  existing tags.. 
-00016480: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00016490: 2020 2074 6167 5f6f 626a 6563 7473 203d     tag_objects =
-000164a0: 2073 656c 662e 5f72 6573 6f6c 7665 5f61   self._resolve_a
-000164b0: 7274 6966 6163 7473 5f74 6f5f 7461 675f  rtifacts_to_tag_
-000164c0: 6f62 6a65 6374 7328 6172 7469 6661 6374  objects(artifact
-000164d0: 7329 0a20 2020 2020 2020 2073 656c 662e  s).        self.
-000164e0: 7461 675f 6f62 6a65 6374 7328 7072 6f6a  tag_objects(proj
-000164f0: 6563 742c 2074 6167 5f6e 616d 652c 206f  ect, tag_name, o
-00016500: 626a 6563 7473 3d74 6167 5f6f 626a 6563  bjects=tag_objec
-00016510: 7473 2c20 7265 706c 6163 653d 7265 706c  ts, replace=repl
-00016520: 6163 6529 0a0a 2020 2020 6465 6620 6465  ace)..    def de
-00016530: 6c65 7465 5f61 7274 6966 6163 7473 5f74  lete_artifacts_t
-00016540: 6167 7328 0a20 2020 2020 2020 2073 656c  ags(.        sel
-00016550: 662c 0a20 2020 2020 2020 2061 7274 6966  f,.        artif
-00016560: 6163 7473 2c0a 2020 2020 2020 2020 7072  acts,.        pr
-00016570: 6f6a 6563 743a 2073 7472 2c0a 2020 2020  oject: str,.    
-00016580: 2020 2020 7461 675f 6e61 6d65 3a20 7374      tag_name: st
-00016590: 722c 0a20 2020 2029 3a0a 2020 2020 2020  r,.    ):.      
-000165a0: 2020 2222 2244 656c 6574 6520 7461 6720    """Delete tag 
-000165b0: 6672 6f6d 2061 206c 6973 7420 6f66 2061  from a list of a
-000165c0: 7274 6966 6163 7473 2e0a 0a20 2020 2020  rtifacts...     
-000165d0: 2020 203a 7061 7261 6d20 6172 7469 6661     :param artifa
-000165e0: 6374 733a 2054 6865 2061 7274 6966 6163  cts: The artifac
-000165f0: 7473 2074 6f20 6465 6c65 7465 2074 6865  ts to delete the
-00016600: 2074 6167 2066 726f 6d2e 2043 616e 2062   tag from. Can b
-00016610: 6520 6120 6c69 7374 206f 6620 3a70 793a  e a list of :py:
-00016620: 636c 6173 733a 607e 6d6c 7275 6e2e 6172  class:`~mlrun.ar
-00016630: 7469 6661 6374 732e 4172 7469 6661 6374  tifacts.Artifact
-00016640: 600a 2020 2020 2020 2020 2020 2020 6f62  `.            ob
-00016650: 6a65 6374 7320 6f72 2064 6963 7469 6f6e  jects or diction
-00016660: 6172 6965 732c 206f 7220 6120 7369 6e67  aries, or a sing
-00016670: 6c65 206f 626a 6563 742e 0a20 2020 2020  le object..     
-00016680: 2020 203a 7061 7261 6d20 7072 6f6a 6563     :param projec
-00016690: 743a 2050 726f 6a65 6374 2077 6869 6368  t: Project which
-000166a0: 2063 6f6e 7461 696e 7320 7468 6520 6172   contains the ar
-000166b0: 7469 6661 6374 732e 0a20 2020 2020 2020  tifacts..       
-000166c0: 203a 7061 7261 6d20 7461 675f 6e61 6d65   :param tag_name
-000166d0: 3a20 5468 6520 7461 6720 746f 2073 6574  : The tag to set
-000166e0: 206f 6e20 7468 6520 6172 7469 6661 6374   on the artifact
-000166f0: 732e 0a20 2020 2020 2020 2022 2222 0a20  s..        """. 
-00016700: 2020 2020 2020 2074 6167 5f6f 626a 6563         tag_objec
-00016710: 7473 203d 2073 656c 662e 5f72 6573 6f6c  ts = self._resol
-00016720: 7665 5f61 7274 6966 6163 7473 5f74 6f5f  ve_artifacts_to_
-00016730: 7461 675f 6f62 6a65 6374 7328 6172 7469  tag_objects(arti
-00016740: 6661 6374 7329 0a20 2020 2020 2020 2073  facts).        s
-00016750: 656c 662e 6465 6c65 7465 5f6f 626a 6563  elf.delete_objec
-00016760: 7473 5f74 6167 2870 726f 6a65 6374 2c20  ts_tag(project, 
-00016770: 7461 675f 6e61 6d65 2c20 7461 675f 6f62  tag_name, tag_ob
-00016780: 6a65 6374 7329 0a0a 2020 2020 6465 6620  jects)..    def 
-00016790: 6c69 7374 5f70 726f 6a65 6374 7328 0a20  list_projects(. 
-000167a0: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-000167b0: 2020 2020 206f 776e 6572 3a20 7374 7220       owner: str 
-000167c0: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-000167d0: 666f 726d 6174 5f3a 2055 6e69 6f6e 5b0a  format_: Union[.
-000167e0: 2020 2020 2020 2020 2020 2020 7374 722c              str,
-000167f0: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
-00016800: 6865 6d61 732e 5072 6f6a 6563 7473 466f  hemas.ProjectsFo
-00016810: 726d 6174 0a20 2020 2020 2020 205d 203d  rmat.        ] =
-00016820: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
-00016830: 6865 6d61 732e 5072 6f6a 6563 7473 466f  hemas.ProjectsFo
-00016840: 726d 6174 2e66 756c 6c2c 0a20 2020 2020  rmat.full,.     
-00016850: 2020 206c 6162 656c 733a 204c 6973 745b     labels: List[
-00016860: 7374 725d 203d 204e 6f6e 652c 0a20 2020  str] = None,.   
-00016870: 2020 2020 2073 7461 7465 3a20 556e 696f       state: Unio
-00016880: 6e5b 7374 722c 206d 6c72 756e 2e63 6f6d  n[str, mlrun.com
-00016890: 6d6f 6e2e 7363 6865 6d61 732e 5072 6f6a  mon.schemas.Proj
-000168a0: 6563 7453 7461 7465 5d20 3d20 4e6f 6e65  ectState] = None
-000168b0: 2c0a 2020 2020 2920 2d3e 204c 6973 745b  ,.    ) -> List[
-000168c0: 556e 696f 6e5b 6d6c 7275 6e2e 7072 6f6a  Union[mlrun.proj
-000168d0: 6563 7473 2e4d 6c72 756e 5072 6f6a 6563  ects.MlrunProjec
-000168e0: 742c 2073 7472 5d5d 3a0a 2020 2020 2020  t, str]]:.      
-000168f0: 2020 2222 2252 6574 7572 6e20 6120 6c69    """Return a li
-00016900: 7374 206f 6620 7468 6520 6578 6973 7469  st of the existi
-00016910: 6e67 2070 726f 6a65 6374 732c 2070 6f74  ng projects, pot
-00016920: 656e 7469 616c 6c79 2066 696c 7465 7265  entially filtere
-00016930: 6420 6279 2073 7065 6369 6669 6320 6372  d by specific cr
-00016940: 6974 6572 6961 2e0a 0a20 2020 2020 2020  iteria...       
-00016950: 203a 7061 7261 6d20 6f77 6e65 723a 204c   :param owner: L
-00016960: 6973 7420 6f6e 6c79 2070 726f 6a65 6374  ist only project
-00016970: 7320 6265 6c6f 6e67 696e 6720 746f 2074  s belonging to t
-00016980: 6869 7320 7370 6563 6966 6963 206f 776e  his specific own
-00016990: 6572 2e0a 2020 2020 2020 2020 3a70 6172  er..        :par
-000169a0: 616d 2066 6f72 6d61 745f 3a20 466f 726d  am format_: Form
-000169b0: 6174 206f 6620 7468 6520 7265 7375 6c74  at of the result
-000169c0: 732e 2050 6f73 7369 626c 6520 7661 6c75  s. Possible valu
-000169d0: 6573 2061 7265 3a0a 0a20 2020 2020 2020  es are:..       
-000169e0: 2020 2020 202d 2060 6066 756c 6c60 6020       - ``full`` 
-000169f0: 2864 6566 6175 6c74 2076 616c 7565 2920  (default value) 
-00016a00: 2d20 5265 7475 726e 2066 756c 6c20 7072  - Return full pr
-00016a10: 6f6a 6563 7420 6f62 6a65 6374 732e 0a20  oject objects.. 
-00016a20: 2020 2020 2020 2020 2020 202d 2060 606d             - ``m
-00016a30: 696e 696d 616c 6060 202d 2052 6574 7572  inimal`` - Retur
-00016a40: 6e20 6d69 6e69 6d61 6c20 7072 6f6a 6563  n minimal projec
-00016a50: 7420 6f62 6a65 6374 7320 286d 696e 696d  t objects (minim
-00016a60: 697a 6174 696f 6e20 6861 7070 656e 7320  ization happens 
-00016a70: 696e 2074 6865 2042 4529 2e0a 2020 2020  in the BE)..    
-00016a80: 2020 2020 2020 2020 2d20 6060 6e61 6d65          - ``name
-00016a90: 5f6f 6e6c 7960 6020 2d20 5265 7475 726e  _only`` - Return
-00016aa0: 206a 7573 7420 7468 6520 6e61 6d65 7320   just the names 
-00016ab0: 6f66 2074 6865 2070 726f 6a65 6374 732e  of the projects.
-00016ac0: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00016ad0: 206c 6162 656c 733a 2046 696c 7465 7220   labels: Filter 
-00016ae0: 6279 206c 6162 656c 7320 6174 7461 6368  by labels attach
-00016af0: 6564 2074 6f20 7468 6520 7072 6f6a 6563  ed to the projec
-00016b00: 742e 0a20 2020 2020 2020 203a 7061 7261  t..        :para
-00016b10: 6d20 7374 6174 653a 2046 696c 7465 7220  m state: Filter 
-00016b20: 6279 2070 726f 6a65 6374 2773 2073 7461  by project's sta
-00016b30: 7465 2e20 4361 6e20 6265 2065 6974 6865  te. Can be eithe
-00016b40: 7220 6060 6f6e 6c69 6e65 6060 206f 7220  r ``online`` or 
-00016b50: 6060 6172 6368 6976 6564 6060 2e0a 2020  ``archived``..  
-00016b60: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
-00016b70: 2020 2070 6172 616d 7320 3d20 7b0a 2020     params = {.  
-00016b80: 2020 2020 2020 2020 2020 226f 776e 6572            "owner
-00016b90: 223a 206f 776e 6572 2c0a 2020 2020 2020  ": owner,.      
-00016ba0: 2020 2020 2020 2273 7461 7465 223a 2073        "state": s
-00016bb0: 7461 7465 2c0a 2020 2020 2020 2020 2020  tate,.          
-00016bc0: 2020 2266 6f72 6d61 7422 3a20 666f 726d    "format": form
-00016bd0: 6174 5f2c 0a20 2020 2020 2020 2020 2020  at_,.           
-00016be0: 2022 6c61 6265 6c22 3a20 6c61 6265 6c73   "label": labels
-00016bf0: 206f 7220 5b5d 2c0a 2020 2020 2020 2020   or [],.        
-00016c00: 7d0a 0a20 2020 2020 2020 2065 7272 6f72  }..        error
-00016c10: 5f6d 6573 7361 6765 203d 2066 2246 6169  _message = f"Fai
-00016c20: 6c65 6420 6c69 7374 696e 6720 7072 6f6a  led listing proj
-00016c30: 6563 7473 2c20 7175 6572 793a 207b 7061  ects, query: {pa
-00016c40: 7261 6d73 7d22 0a20 2020 2020 2020 2072  rams}".        r
-00016c50: 6573 706f 6e73 6520 3d20 7365 6c66 2e61  esponse = self.a
-00016c60: 7069 5f63 616c 6c28 2247 4554 222c 2022  pi_call("GET", "
-00016c70: 7072 6f6a 6563 7473 222c 2065 7272 6f72  projects", error
-00016c80: 5f6d 6573 7361 6765 2c20 7061 7261 6d73  _message, params
-00016c90: 3d70 6172 616d 7329 0a20 2020 2020 2020  =params).       
-00016ca0: 2069 6620 666f 726d 6174 5f20 3d3d 206d   if format_ == m
-00016cb0: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
-00016cc0: 6d61 732e 5072 6f6a 6563 7473 466f 726d  mas.ProjectsForm
-00016cd0: 6174 2e6e 616d 655f 6f6e 6c79 3a0a 2020  at.name_only:.  
-00016ce0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00016cf0: 2072 6573 706f 6e73 652e 6a73 6f6e 2829   response.json()
-00016d00: 5b22 7072 6f6a 6563 7473 225d 0a20 2020  ["projects"].   
-00016d10: 2020 2020 2065 6c69 6620 666f 726d 6174       elif format
-00016d20: 5f20 696e 205b 0a20 2020 2020 2020 2020  _ in [.         
-00016d30: 2020 206d 6c72 756e 2e63 6f6d 6d6f 6e2e     mlrun.common.
-00016d40: 7363 6865 6d61 732e 5072 6f6a 6563 7473  schemas.Projects
-00016d50: 466f 726d 6174 2e66 756c 6c2c 0a20 2020  Format.full,.   
-00016d60: 2020 2020 2020 2020 206d 6c72 756e 2e63           mlrun.c
-00016d70: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 5072  ommon.schemas.Pr
-00016d80: 6f6a 6563 7473 466f 726d 6174 2e6d 696e  ojectsFormat.min
-00016d90: 696d 616c 2c0a 2020 2020 2020 2020 5d3a  imal,.        ]:
-00016da0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00016db0: 7572 6e20 5b0a 2020 2020 2020 2020 2020  urn [.          
-00016dc0: 2020 2020 2020 6d6c 7275 6e2e 7072 6f6a        mlrun.proj
-00016dd0: 6563 7473 2e4d 6c72 756e 5072 6f6a 6563  ects.MlrunProjec
-00016de0: 742e 6672 6f6d 5f64 6963 7428 7072 6f6a  t.from_dict(proj
-00016df0: 6563 745f 6469 6374 290a 2020 2020 2020  ect_dict).      
-00016e00: 2020 2020 2020 2020 2020 666f 7220 7072            for pr
-00016e10: 6f6a 6563 745f 6469 6374 2069 6e20 7265  oject_dict in re
-00016e20: 7370 6f6e 7365 2e6a 736f 6e28 295b 2270  sponse.json()["p
-00016e30: 726f 6a65 6374 7322 5d0a 2020 2020 2020  rojects"].      
-00016e40: 2020 2020 2020 5d0a 2020 2020 2020 2020        ].        
-00016e50: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00016e60: 2020 7261 6973 6520 4e6f 7449 6d70 6c65    raise NotImple
-00016e70: 6d65 6e74 6564 4572 726f 7228 0a20 2020  mentedError(.   
-00016e80: 2020 2020 2020 2020 2020 2020 2066 2250               f"P
-00016e90: 726f 7669 6465 6420 666f 726d 6174 2069  rovided format i
-00016ea0: 7320 6e6f 7420 7375 7070 6f72 7465 642e  s not supported.
-00016eb0: 2066 6f72 6d61 743d 7b66 6f72 6d61 745f   format={format_
-00016ec0: 7d22 0a20 2020 2020 2020 2020 2020 2029  }".            )
-00016ed0: 0a0a 2020 2020 6465 6620 6765 745f 7072  ..    def get_pr
-00016ee0: 6f6a 6563 7428 7365 6c66 2c20 6e61 6d65  oject(self, name
-00016ef0: 3a20 7374 7229 202d 3e20 6d6c 7275 6e2e  : str) -> mlrun.
-00016f00: 7072 6f6a 6563 7473 2e4d 6c72 756e 5072  projects.MlrunPr
-00016f10: 6f6a 6563 743a 0a20 2020 2020 2020 2022  oject:.        "
-00016f20: 2222 4765 7420 6465 7461 696c 7320 666f  ""Get details fo
-00016f30: 7220 6120 7370 6563 6966 6963 2070 726f  r a specific pro
-00016f40: 6a65 6374 2e22 2222 0a0a 2020 2020 2020  ject."""..      
-00016f50: 2020 6966 206e 6f74 206e 616d 653a 0a20    if not name:. 
-00016f60: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00016f70: 204d 4c52 756e 496e 7661 6c69 6441 7267   MLRunInvalidArg
-00016f80: 756d 656e 7445 7272 6f72 2822 4e61 6d65  umentError("Name
-00016f90: 206d 7573 7420 6265 2070 726f 7669 6465   must be provide
-00016fa0: 6422 290a 0a20 2020 2020 2020 2070 6174  d")..        pat
-00016fb0: 6820 3d20 6622 7072 6f6a 6563 7473 2f7b  h = f"projects/{
-00016fc0: 6e61 6d65 7d22 0a20 2020 2020 2020 2065  name}".        e
-00016fd0: 7272 6f72 5f6d 6573 7361 6765 203d 2066  rror_message = f
-00016fe0: 2246 6169 6c65 6420 7265 7472 6965 7669  "Failed retrievi
-00016ff0: 6e67 2070 726f 6a65 6374 207b 6e61 6d65  ng project {name
-00017000: 7d22 0a20 2020 2020 2020 2072 6573 706f  }".        respo
-00017010: 6e73 6520 3d20 7365 6c66 2e61 7069 5f63  nse = self.api_c
-00017020: 616c 6c28 2247 4554 222c 2070 6174 682c  all("GET", path,
-00017030: 2065 7272 6f72 5f6d 6573 7361 6765 290a   error_message).
-00017040: 2020 2020 2020 2020 7265 7475 726e 206d          return m
-00017050: 6c72 756e 2e70 726f 6a65 6374 732e 4d6c  lrun.projects.Ml
-00017060: 7275 6e50 726f 6a65 6374 2e66 726f 6d5f  runProject.from_
-00017070: 6469 6374 2872 6573 706f 6e73 652e 6a73  dict(response.js
-00017080: 6f6e 2829 290a 0a20 2020 2064 6566 2064  on())..    def d
-00017090: 656c 6574 655f 7072 6f6a 6563 7428 0a20  elete_project(. 
-000170a0: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-000170b0: 2020 2020 206e 616d 653a 2073 7472 2c0a       name: str,.
-000170c0: 2020 2020 2020 2020 6465 6c65 7469 6f6e          deletion
-000170d0: 5f73 7472 6174 6567 793a 2055 6e69 6f6e  _strategy: Union
-000170e0: 5b0a 2020 2020 2020 2020 2020 2020 7374  [.            st
-000170f0: 722c 206d 6c72 756e 2e63 6f6d 6d6f 6e2e  r, mlrun.common.
-00017100: 7363 6865 6d61 732e 4465 6c65 7469 6f6e  schemas.Deletion
-00017110: 5374 7261 7465 6779 0a20 2020 2020 2020  Strategy.       
-00017120: 205d 203d 206d 6c72 756e 2e63 6f6d 6d6f   ] = mlrun.commo
-00017130: 6e2e 7363 6865 6d61 732e 4465 6c65 7469  n.schemas.Deleti
-00017140: 6f6e 5374 7261 7465 6779 2e64 6566 6175  onStrategy.defau
-00017150: 6c74 2829 2c0a 2020 2020 293a 0a20 2020  lt(),.    ):.   
-00017160: 2020 2020 2022 2222 4465 6c65 7465 2061       """Delete a
-00017170: 2070 726f 6a65 6374 2e0a 0a20 2020 2020   project...     
-00017180: 2020 203a 7061 7261 6d20 6e61 6d65 3a20     :param name: 
-00017190: 4e61 6d65 206f 6620 7468 6520 7072 6f6a  Name of the proj
-000171a0: 6563 7420 746f 2064 656c 6574 652e 0a20  ect to delete.. 
-000171b0: 2020 2020 2020 203a 7061 7261 6d20 6465         :param de
-000171c0: 6c65 7469 6f6e 5f73 7472 6174 6567 793a  letion_strategy:
-000171d0: 2048 6f77 2074 6f20 7472 6561 7420 6368   How to treat ch
-000171e0: 696c 6420 6f62 6a65 6374 7320 6f66 2074  ild objects of t
-000171f0: 6865 2070 726f 6a65 6374 2e20 506f 7373  he project. Poss
-00017200: 6962 6c65 2076 616c 7565 7320 6172 653a  ible values are:
-00017210: 0a0a 2020 2020 2020 2020 2020 2020 2d20  ..            - 
-00017220: 6060 7265 7374 7269 6374 6060 2028 6465  ``restrict`` (de
-00017230: 6661 756c 7429 202d 2050 726f 6a65 6374  fault) - Project
-00017240: 206d 7573 7420 6e6f 7420 6861 7665 2061   must not have a
-00017250: 6e79 2063 6869 6c64 206f 626a 6563 7473  ny child objects
-00017260: 2077 6865 6e20 6465 6c65 7465 642e 2049   when deleted. I
-00017270: 6620 7573 696e 6720 7468 6973 206d 6f64  f using this mod
-00017280: 6520 7768 696c 650a 2020 2020 2020 2020  e while.        
-00017290: 2020 2020 2020 6368 696c 6420 6f62 6a65        child obje
-000172a0: 6374 7320 6578 6973 742c 2074 6865 206f  cts exist, the o
-000172b0: 7065 7261 7469 6f6e 2077 696c 6c20 6661  peration will fa
-000172c0: 696c 2e0a 2020 2020 2020 2020 2020 2020  il..            
-000172d0: 2d20 6060 6361 7363 6164 6560 6020 2d20  - ``cascade`` - 
-000172e0: 4175 746f 6d61 7469 6361 6c6c 7920 6465  Automatically de
-000172f0: 6c65 7465 2061 6c6c 2063 6869 6c64 206f  lete all child o
-00017300: 626a 6563 7473 2077 6865 6e20 6465 6c65  bjects when dele
-00017310: 7469 6e67 2074 6865 2070 726f 6a65 6374  ting the project
-00017320: 2e0a 2020 2020 2020 2020 2222 220a 0a20  ..        """.. 
-00017330: 2020 2020 2020 2070 6174 6820 3d20 6622         path = f"
-00017340: 7072 6f6a 6563 7473 2f7b 6e61 6d65 7d22  projects/{name}"
-00017350: 0a20 2020 2020 2020 2068 6561 6465 7273  .        headers
-00017360: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
-00017370: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
-00017380: 6865 6d61 732e 4865 6164 6572 4e61 6d65  hemas.HeaderName
-00017390: 732e 6465 6c65 7469 6f6e 5f73 7472 6174  s.deletion_strat
-000173a0: 6567 793a 2064 656c 6574 696f 6e5f 7374  egy: deletion_st
-000173b0: 7261 7465 6779 0a20 2020 2020 2020 207d  rategy.        }
-000173c0: 0a20 2020 2020 2020 2065 7272 6f72 5f6d  .        error_m
-000173d0: 6573 7361 6765 203d 2066 2246 6169 6c65  essage = f"Faile
-000173e0: 6420 6465 6c65 7469 6e67 2070 726f 6a65  d deleting proje
-000173f0: 6374 207b 6e61 6d65 7d22 0a20 2020 2020  ct {name}".     
-00017400: 2020 2072 6573 706f 6e73 6520 3d20 7365     response = se
-00017410: 6c66 2e61 7069 5f63 616c 6c28 2244 454c  lf.api_call("DEL
-00017420: 4554 4522 2c20 7061 7468 2c20 6572 726f  ETE", path, erro
-00017430: 725f 6d65 7373 6167 652c 2068 6561 6465  r_message, heade
-00017440: 7273 3d68 6561 6465 7273 290a 2020 2020  rs=headers).    
-00017450: 2020 2020 6966 2072 6573 706f 6e73 652e      if response.
-00017460: 7374 6174 7573 5f63 6f64 6520 3d3d 2068  status_code == h
-00017470: 7474 702e 4854 5450 5374 6174 7573 2e41  ttp.HTTPStatus.A
-00017480: 4343 4550 5445 443a 0a20 2020 2020 2020  CCEPTED:.       
-00017490: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-000174a0: 2e5f 7761 6974 5f66 6f72 5f70 726f 6a65  ._wait_for_proje
-000174b0: 6374 5f74 6f5f 6265 5f64 656c 6574 6564  ct_to_be_deleted
-000174c0: 286e 616d 6529 0a0a 2020 2020 6465 6620  (name)..    def 
-000174d0: 7374 6f72 655f 7072 6f6a 6563 7428 0a20  store_project(. 
-000174e0: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-000174f0: 2020 2020 206e 616d 653a 2073 7472 2c0a       name: str,.
-00017500: 2020 2020 2020 2020 7072 6f6a 6563 743a          project:
-00017510: 2055 6e69 6f6e 5b64 6963 742c 206d 6c72   Union[dict, mlr
-00017520: 756e 2e70 726f 6a65 6374 732e 4d6c 7275  un.projects.Mlru
-00017530: 6e50 726f 6a65 6374 2c20 6d6c 7275 6e2e  nProject, mlrun.
-00017540: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e50  common.schemas.P
-00017550: 726f 6a65 6374 5d2c 0a20 2020 2029 202d  roject],.    ) -
-00017560: 3e20 6d6c 7275 6e2e 7072 6f6a 6563 7473  > mlrun.projects
-00017570: 2e4d 6c72 756e 5072 6f6a 6563 743a 0a20  .MlrunProject:. 
-00017580: 2020 2020 2020 2022 2222 5374 6f72 6520         """Store 
-00017590: 6120 7072 6f6a 6563 7420 696e 2074 6865  a project in the
-000175a0: 2044 422e 2054 6869 7320 6f70 6572 6174   DB. This operat
-000175b0: 696f 6e20 7769 6c6c 206f 7665 7277 7269  ion will overwri
-000175c0: 7465 2065 7869 7374 696e 6720 7072 6f6a  te existing proj
-000175d0: 6563 7420 6f66 2074 6865 2073 616d 6520  ect of the same 
-000175e0: 6e61 6d65 2069 6620 6578 6973 7473 2e22  name if exists."
-000175f0: 2222 0a0a 2020 2020 2020 2020 7061 7468  ""..        path
-00017600: 203d 2066 2270 726f 6a65 6374 732f 7b6e   = f"projects/{n
-00017610: 616d 657d 220a 2020 2020 2020 2020 6572  ame}".        er
-00017620: 726f 725f 6d65 7373 6167 6520 3d20 6622  ror_message = f"
-00017630: 4661 696c 6564 2073 746f 7269 6e67 2070  Failed storing p
-00017640: 726f 6a65 6374 207b 6e61 6d65 7d22 0a20  roject {name}". 
-00017650: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-00017660: 616e 6365 2870 726f 6a65 6374 2c20 6d6c  ance(project, ml
-00017670: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
-00017680: 6173 2e50 726f 6a65 6374 293a 0a20 2020  as.Project):.   
-00017690: 2020 2020 2020 2020 2070 726f 6a65 6374           project
-000176a0: 203d 2070 726f 6a65 6374 2e64 6963 7428   = project.dict(
-000176b0: 290a 2020 2020 2020 2020 656c 6966 2069  ).        elif i
-000176c0: 7369 6e73 7461 6e63 6528 7072 6f6a 6563  sinstance(projec
-000176d0: 742c 206d 6c72 756e 2e70 726f 6a65 6374  t, mlrun.project
-000176e0: 732e 4d6c 7275 6e50 726f 6a65 6374 293a  s.MlrunProject):
-000176f0: 0a20 2020 2020 2020 2020 2020 2070 726f  .            pro
-00017700: 6a65 6374 203d 2070 726f 6a65 6374 2e74  ject = project.t
-00017710: 6f5f 6469 6374 2829 0a20 2020 2020 2020  o_dict().       
-00017720: 2072 6573 706f 6e73 6520 3d20 7365 6c66   response = self
-00017730: 2e61 7069 5f63 616c 6c28 0a20 2020 2020  .api_call(.     
-00017740: 2020 2020 2020 2022 5055 5422 2c0a 2020         "PUT",.  
-00017750: 2020 2020 2020 2020 2020 7061 7468 2c0a            path,.
-00017760: 2020 2020 2020 2020 2020 2020 6572 726f              erro
-00017770: 725f 6d65 7373 6167 652c 0a20 2020 2020  r_message,.     
-00017780: 2020 2020 2020 2062 6f64 793d 6469 6374         body=dict
-00017790: 5f74 6f5f 6a73 6f6e 2870 726f 6a65 6374  _to_json(project
-000177a0: 292c 0a20 2020 2020 2020 2029 0a20 2020  ),.        ).   
-000177b0: 2020 2020 2069 6620 7265 7370 6f6e 7365       if response
-000177c0: 2e73 7461 7475 735f 636f 6465 203d 3d20  .status_code == 
-000177d0: 6874 7470 2e48 5454 5053 7461 7475 732e  http.HTTPStatus.
-000177e0: 4143 4345 5054 4544 3a0a 2020 2020 2020  ACCEPTED:.      
-000177f0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00017800: 662e 5f77 6169 745f 666f 725f 7072 6f6a  f._wait_for_proj
-00017810: 6563 745f 746f 5f72 6561 6368 5f74 6572  ect_to_reach_ter
-00017820: 6d69 6e61 6c5f 7374 6174 6528 6e61 6d65  minal_state(name
-00017830: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-00017840: 206d 6c72 756e 2e70 726f 6a65 6374 732e   mlrun.projects.
-00017850: 4d6c 7275 6e50 726f 6a65 6374 2e66 726f  MlrunProject.fro
-00017860: 6d5f 6469 6374 2872 6573 706f 6e73 652e  m_dict(response.
-00017870: 6a73 6f6e 2829 290a 0a20 2020 2064 6566  json())..    def
-00017880: 2070 6174 6368 5f70 726f 6a65 6374 280a   patch_project(.
-00017890: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-000178a0: 2020 2020 2020 6e61 6d65 3a20 7374 722c        name: str,
-000178b0: 0a20 2020 2020 2020 2070 726f 6a65 6374  .        project
-000178c0: 3a20 6469 6374 2c0a 2020 2020 2020 2020  : dict,.        
-000178d0: 7061 7463 685f 6d6f 6465 3a20 556e 696f  patch_mode: Unio
-000178e0: 6e5b 0a20 2020 2020 2020 2020 2020 2073  n[.            s
-000178f0: 7472 2c20 6d6c 7275 6e2e 636f 6d6d 6f6e  tr, mlrun.common
-00017900: 2e73 6368 656d 6173 2e50 6174 6368 4d6f  .schemas.PatchMo
-00017910: 6465 0a20 2020 2020 2020 205d 203d 206d  de.        ] = m
-00017920: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
-00017930: 6d61 732e 5061 7463 684d 6f64 652e 7265  mas.PatchMode.re
-00017940: 706c 6163 652c 0a20 2020 2029 202d 3e20  place,.    ) -> 
-00017950: 6d6c 7275 6e2e 7072 6f6a 6563 7473 2e4d  mlrun.projects.M
-00017960: 6c72 756e 5072 6f6a 6563 743a 0a20 2020  lrunProject:.   
-00017970: 2020 2020 2022 2222 5061 7463 6820 616e       """Patch an
-00017980: 2065 7869 7374 696e 6720 7072 6f6a 6563   existing projec
-00017990: 7420 6f62 6a65 6374 2e0a 0a20 2020 2020  t object...     
-000179a0: 2020 203a 7061 7261 6d20 6e61 6d65 3a20     :param name: 
-000179b0: 4e61 6d65 206f 6620 7072 6f6a 6563 7420  Name of project 
-000179c0: 746f 2070 6174 6368 2e0a 2020 2020 2020  to patch..      
-000179d0: 2020 3a70 6172 616d 2070 726f 6a65 6374    :param project
-000179e0: 3a20 5468 6520 6163 7475 616c 2063 6861  : The actual cha
-000179f0: 6e67 6573 2074 6f20 7468 6520 7072 6f6a  nges to the proj
-00017a00: 6563 7420 6f62 6a65 6374 2e0a 2020 2020  ect object..    
-00017a10: 2020 2020 3a70 6172 616d 2070 6174 6368      :param patch
-00017a20: 5f6d 6f64 653a 2054 6865 2073 7472 6174  _mode: The strat
-00017a30: 6567 7920 666f 7220 6d65 7267 696e 6720  egy for merging 
-00017a40: 7468 6520 6368 616e 6765 7320 7769 7468  the changes with
-00017a50: 2074 6865 2065 7869 7374 696e 6720 6f62   the existing ob
-00017a60: 6a65 6374 2e20 4361 6e20 6265 2065 6974  ject. Can be eit
-00017a70: 6865 7220 6060 7265 706c 6163 6560 600a  her ``replace``.
-00017a80: 2020 2020 2020 2020 2020 2020 6f72 2060              or `
-00017a90: 6061 6464 6974 6976 6560 602e 0a20 2020  `additive``..   
-00017aa0: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
-00017ab0: 2020 7061 7468 203d 2066 2270 726f 6a65    path = f"proje
-00017ac0: 6374 732f 7b6e 616d 657d 220a 2020 2020  cts/{name}".    
-00017ad0: 2020 2020 6865 6164 6572 7320 3d20 7b6d      headers = {m
-00017ae0: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
-00017af0: 6d61 732e 4865 6164 6572 4e61 6d65 732e  mas.HeaderNames.
-00017b00: 7061 7463 685f 6d6f 6465 3a20 7061 7463  patch_mode: patc
-00017b10: 685f 6d6f 6465 7d0a 2020 2020 2020 2020  h_mode}.        
-00017b20: 6572 726f 725f 6d65 7373 6167 6520 3d20  error_message = 
-00017b30: 6622 4661 696c 6564 2070 6174 6368 696e  f"Failed patchin
-00017b40: 6720 7072 6f6a 6563 7420 7b6e 616d 657d  g project {name}
-00017b50: 220a 2020 2020 2020 2020 7265 7370 6f6e  ".        respon
-00017b60: 7365 203d 2073 656c 662e 6170 695f 6361  se = self.api_ca
-00017b70: 6c6c 280a 2020 2020 2020 2020 2020 2020  ll(.            
-00017b80: 2250 4154 4348 222c 2070 6174 682c 2065  "PATCH", path, e
-00017b90: 7272 6f72 5f6d 6573 7361 6765 2c20 626f  rror_message, bo
-00017ba0: 6479 3d64 6963 745f 746f 5f6a 736f 6e28  dy=dict_to_json(
-00017bb0: 7072 6f6a 6563 7429 2c20 6865 6164 6572  project), header
-00017bc0: 733d 6865 6164 6572 730a 2020 2020 2020  s=headers.      
-00017bd0: 2020 290a 2020 2020 2020 2020 7265 7475    ).        retu
-00017be0: 726e 206d 6c72 756e 2e70 726f 6a65 6374  rn mlrun.project
-00017bf0: 732e 4d6c 7275 6e50 726f 6a65 6374 2e66  s.MlrunProject.f
-00017c00: 726f 6d5f 6469 6374 2872 6573 706f 6e73  rom_dict(respons
-00017c10: 652e 6a73 6f6e 2829 290a 0a20 2020 2064  e.json())..    d
-00017c20: 6566 2063 7265 6174 655f 7072 6f6a 6563  ef create_projec
-00017c30: 7428 0a20 2020 2020 2020 2073 656c 662c  t(.        self,
-00017c40: 0a20 2020 2020 2020 2070 726f 6a65 6374  .        project
-00017c50: 3a20 556e 696f 6e5b 6469 6374 2c20 6d6c  : Union[dict, ml
-00017c60: 7275 6e2e 7072 6f6a 6563 7473 2e4d 6c72  run.projects.Mlr
-00017c70: 756e 5072 6f6a 6563 742c 206d 6c72 756e  unProject, mlrun
-00017c80: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
-00017c90: 5072 6f6a 6563 745d 2c0a 2020 2020 2920  Project],.    ) 
-00017ca0: 2d3e 206d 6c72 756e 2e70 726f 6a65 6374  -> mlrun.project
-00017cb0: 732e 4d6c 7275 6e50 726f 6a65 6374 3a0a  s.MlrunProject:.
-00017cc0: 2020 2020 2020 2020 2222 2243 7265 6174          """Creat
-00017cd0: 6520 6120 6e65 7720 7072 6f6a 6563 742e  e a new project.
-00017ce0: 2041 2070 726f 6a65 6374 2077 6974 6820   A project with 
-00017cf0: 7468 6520 7361 6d65 206e 616d 6520 6d75  the same name mu
-00017d00: 7374 206e 6f74 2065 7869 7374 2070 7269  st not exist pri
-00017d10: 6f72 2074 6f20 6372 6561 7469 6f6e 2e22  or to creation."
-00017d20: 2222 0a0a 2020 2020 2020 2020 6966 2069  ""..        if i
-00017d30: 7369 6e73 7461 6e63 6528 7072 6f6a 6563  sinstance(projec
-00017d40: 742c 206d 6c72 756e 2e63 6f6d 6d6f 6e2e  t, mlrun.common.
-00017d50: 7363 6865 6d61 732e 5072 6f6a 6563 7429  schemas.Project)
-00017d60: 3a0a 2020 2020 2020 2020 2020 2020 7072  :.            pr
-00017d70: 6f6a 6563 7420 3d20 7072 6f6a 6563 742e  oject = project.
-00017d80: 6469 6374 2829 0a20 2020 2020 2020 2065  dict().        e
-00017d90: 6c69 6620 6973 696e 7374 616e 6365 2870  lif isinstance(p
-00017da0: 726f 6a65 6374 2c20 6d6c 7275 6e2e 7072  roject, mlrun.pr
-00017db0: 6f6a 6563 7473 2e4d 6c72 756e 5072 6f6a  ojects.MlrunProj
-00017dc0: 6563 7429 3a0a 2020 2020 2020 2020 2020  ect):.          
-00017dd0: 2020 7072 6f6a 6563 7420 3d20 7072 6f6a    project = proj
-00017de0: 6563 742e 746f 5f64 6963 7428 290a 2020  ect.to_dict().  
-00017df0: 2020 2020 2020 7072 6f6a 6563 745f 6e61        project_na
-00017e00: 6d65 203d 2070 726f 6a65 6374 5b22 6d65  me = project["me
-00017e10: 7461 6461 7461 225d 5b22 6e61 6d65 225d  tadata"]["name"]
-00017e20: 0a20 2020 2020 2020 2065 7272 6f72 5f6d  .        error_m
-00017e30: 6573 7361 6765 203d 2066 2246 6169 6c65  essage = f"Faile
-00017e40: 6420 6372 6561 7469 6e67 2070 726f 6a65  d creating proje
-00017e50: 6374 207b 7072 6f6a 6563 745f 6e61 6d65  ct {project_name
-00017e60: 7d22 0a20 2020 2020 2020 2072 6573 706f  }".        respo
-00017e70: 6e73 6520 3d20 7365 6c66 2e61 7069 5f63  nse = self.api_c
-00017e80: 616c 6c28 0a20 2020 2020 2020 2020 2020  all(.           
-00017e90: 2022 504f 5354 222c 0a20 2020 2020 2020   "POST",.       
-00017ea0: 2020 2020 2022 7072 6f6a 6563 7473 222c       "projects",
-00017eb0: 0a20 2020 2020 2020 2020 2020 2065 7272  .            err
-00017ec0: 6f72 5f6d 6573 7361 6765 2c0a 2020 2020  or_message,.    
-00017ed0: 2020 2020 2020 2020 626f 6479 3d64 6963          body=dic
-00017ee0: 745f 746f 5f6a 736f 6e28 7072 6f6a 6563  t_to_json(projec
-00017ef0: 7429 2c0a 2020 2020 2020 2020 290a 2020  t),.        ).  
-00017f00: 2020 2020 2020 6966 2072 6573 706f 6e73        if respons
-00017f10: 652e 7374 6174 7573 5f63 6f64 6520 3d3d  e.status_code ==
-00017f20: 2068 7474 702e 4854 5450 5374 6174 7573   http.HTTPStatus
-00017f30: 2e41 4343 4550 5445 443a 0a20 2020 2020  .ACCEPTED:.     
-00017f40: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00017f50: 6c66 2e5f 7761 6974 5f66 6f72 5f70 726f  lf._wait_for_pro
-00017f60: 6a65 6374 5f74 6f5f 7265 6163 685f 7465  ject_to_reach_te
-00017f70: 726d 696e 616c 5f73 7461 7465 2870 726f  rminal_state(pro
-00017f80: 6a65 6374 5f6e 616d 6529 0a20 2020 2020  ject_name).     
-00017f90: 2020 2072 6574 7572 6e20 6d6c 7275 6e2e     return mlrun.
-00017fa0: 7072 6f6a 6563 7473 2e4d 6c72 756e 5072  projects.MlrunPr
-00017fb0: 6f6a 6563 742e 6672 6f6d 5f64 6963 7428  oject.from_dict(
-00017fc0: 7265 7370 6f6e 7365 2e6a 736f 6e28 2929  response.json())
-00017fd0: 0a0a 2020 2020 6465 6620 5f77 6169 745f  ..    def _wait_
-00017fe0: 666f 725f 7072 6f6a 6563 745f 746f 5f72  for_project_to_r
-00017ff0: 6561 6368 5f74 6572 6d69 6e61 6c5f 7374  each_terminal_st
-00018000: 6174 6528 0a20 2020 2020 2020 2073 656c  ate(.        sel
-00018010: 662c 2070 726f 6a65 6374 5f6e 616d 653a  f, project_name:
-00018020: 2073 7472 0a20 2020 2029 202d 3e20 6d6c   str.    ) -> ml
-00018030: 7275 6e2e 7072 6f6a 6563 7473 2e4d 6c72  run.projects.Mlr
-00018040: 756e 5072 6f6a 6563 743a 0a20 2020 2020  unProject:.     
-00018050: 2020 2064 6566 205f 7665 7269 6679 5f70     def _verify_p
-00018060: 726f 6a65 6374 5f69 6e5f 7465 726d 696e  roject_in_termin
-00018070: 616c 5f73 7461 7465 2829 3a0a 2020 2020  al_state():.    
-00018080: 2020 2020 2020 2020 7072 6f6a 6563 7420          project 
-00018090: 3d20 7365 6c66 2e67 6574 5f70 726f 6a65  = self.get_proje
-000180a0: 6374 2870 726f 6a65 6374 5f6e 616d 6529  ct(project_name)
-000180b0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000180c0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-000180d0: 2020 7072 6f6a 6563 742e 7374 6174 7573    project.status
-000180e0: 2e73 7461 7465 0a20 2020 2020 2020 2020  .state.         
-000180f0: 2020 2020 2020 206e 6f74 2069 6e20 6d6c         not in ml
-00018100: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
-00018110: 6173 2e50 726f 6a65 6374 5374 6174 652e  as.ProjectState.
-00018120: 7465 726d 696e 616c 5f73 7461 7465 7328  terminal_states(
-00018130: 290a 2020 2020 2020 2020 2020 2020 293a  ).            ):
-00018140: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00018150: 2072 6169 7365 2045 7863 6570 7469 6f6e   raise Exception
-00018160: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00018170: 2020 2020 2020 6622 5072 6f6a 6563 7420        f"Project 
-00018180: 6e6f 7420 696e 2074 6572 6d69 6e61 6c20  not in terminal 
-00018190: 7374 6174 652e 2053 7461 7465 3a20 7b70  state. State: {p
-000181a0: 726f 6a65 6374 2e73 7461 7475 732e 7374  roject.status.st
-000181b0: 6174 657d 220a 2020 2020 2020 2020 2020  ate}".          
-000181c0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-000181d0: 2020 2020 7265 7475 726e 2070 726f 6a65      return proje
-000181e0: 6374 0a0a 2020 2020 2020 2020 7265 7475  ct..        retu
-000181f0: 726e 206d 6c72 756e 2e75 7469 6c73 2e68  rn mlrun.utils.h
-00018200: 656c 7065 7273 2e72 6574 7279 5f75 6e74  elpers.retry_unt
-00018210: 696c 5f73 7563 6365 7373 6675 6c28 0a20  il_successful(. 
-00018220: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00018230: 5f77 6169 745f 666f 725f 7072 6f6a 6563  _wait_for_projec
-00018240: 745f 7465 726d 696e 616c 5f73 7461 7465  t_terminal_state
-00018250: 5f72 6574 7279 5f69 6e74 6572 7661 6c2c  _retry_interval,
-00018260: 0a20 2020 2020 2020 2020 2020 2031 3230  .            120
-00018270: 2c0a 2020 2020 2020 2020 2020 2020 6c6f  ,.            lo
-00018280: 6767 6572 2c0a 2020 2020 2020 2020 2020  gger,.          
-00018290: 2020 4661 6c73 652c 0a20 2020 2020 2020    False,.       
-000182a0: 2020 2020 205f 7665 7269 6679 5f70 726f       _verify_pro
-000182b0: 6a65 6374 5f69 6e5f 7465 726d 696e 616c  ject_in_terminal
-000182c0: 5f73 7461 7465 2c0a 2020 2020 2020 2020  _state,.        
-000182d0: 290a 0a20 2020 2064 6566 205f 7761 6974  )..    def _wait
-000182e0: 5f66 6f72 5f62 6163 6b67 726f 756e 645f  _for_background_
-000182f0: 7461 736b 5f74 6f5f 7265 6163 685f 7465  task_to_reach_te
-00018300: 726d 696e 616c 5f73 7461 7465 280a 2020  rminal_state(.  
-00018310: 2020 2020 2020 7365 6c66 2c20 6e61 6d65        self, name
-00018320: 3a20 7374 720a 2020 2020 2920 2d3e 206d  : str.    ) -> m
-00018330: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
-00018340: 6d61 732e 4261 636b 6772 6f75 6e64 5461  mas.BackgroundTa
-00018350: 736b 3a0a 2020 2020 2020 2020 6465 6620  sk:.        def 
-00018360: 5f76 6572 6966 795f 6261 636b 6772 6f75  _verify_backgrou
-00018370: 6e64 5f74 6173 6b5f 696e 5f74 6572 6d69  nd_task_in_termi
-00018380: 6e61 6c5f 7374 6174 6528 293a 0a20 2020  nal_state():.   
-00018390: 2020 2020 2020 2020 2062 6163 6b67 726f           backgro
-000183a0: 756e 645f 7461 736b 203d 2073 656c 662e  und_task = self.
-000183b0: 6765 745f 6261 636b 6772 6f75 6e64 5f74  get_background_t
-000183c0: 6173 6b28 6e61 6d65 290a 2020 2020 2020  ask(name).      
-000183d0: 2020 2020 2020 7374 6174 6520 3d20 6261        state = ba
-000183e0: 636b 6772 6f75 6e64 5f74 6173 6b2e 7374  ckground_task.st
-000183f0: 6174 7573 2e73 7461 7465 0a20 2020 2020  atus.state.     
-00018400: 2020 2020 2020 2069 6620 7374 6174 6520         if state 
-00018410: 6e6f 7420 696e 206d 6c72 756e 2e63 6f6d  not in mlrun.com
-00018420: 6d6f 6e2e 7363 6865 6d61 732e 4261 636b  mon.schemas.Back
-00018430: 6772 6f75 6e64 5461 736b 5374 6174 652e  groundTaskState.
-00018440: 7465 726d 696e 616c 5f73 7461 7465 7328  terminal_states(
-00018450: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00018460: 2020 2072 6169 7365 2045 7863 6570 7469     raise Excepti
-00018470: 6f6e 280a 2020 2020 2020 2020 2020 2020  on(.            
-00018480: 2020 2020 2020 2020 6622 4261 636b 6772          f"Backgr
-00018490: 6f75 6e64 2074 6173 6b20 6e6f 7420 696e  ound task not in
-000184a0: 2074 6572 6d69 6e61 6c20 7374 6174 652e   terminal state.
-000184b0: 206e 616d 653d 7b6e 616d 657d 2c20 7374   name={name}, st
-000184c0: 6174 653d 7b73 7461 7465 7d22 0a20 2020  ate={state}".   
-000184d0: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
-000184e0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-000184f0: 6e20 6261 636b 6772 6f75 6e64 5f74 6173  n background_tas
-00018500: 6b0a 0a20 2020 2020 2020 2072 6574 7572  k..        retur
-00018510: 6e20 6d6c 7275 6e2e 7574 696c 732e 6865  n mlrun.utils.he
-00018520: 6c70 6572 732e 7265 7472 795f 756e 7469  lpers.retry_unti
-00018530: 6c5f 7375 6363 6573 7366 756c 280a 2020  l_successful(.  
-00018540: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-00018550: 7761 6974 5f66 6f72 5f62 6163 6b67 726f  wait_for_backgro
-00018560: 756e 645f 7461 736b 5f74 6572 6d69 6e61  und_task_termina
-00018570: 6c5f 7374 6174 655f 7265 7472 795f 696e  l_state_retry_in
-00018580: 7465 7276 616c 2c0a 2020 2020 2020 2020  terval,.        
-00018590: 2020 2020 3630 202a 2036 302c 0a20 2020      60 * 60,.   
-000185a0: 2020 2020 2020 2020 206c 6f67 6765 722c           logger,
-000185b0: 0a20 2020 2020 2020 2020 2020 2046 616c  .            Fal
-000185c0: 7365 2c0a 2020 2020 2020 2020 2020 2020  se,.            
-000185d0: 5f76 6572 6966 795f 6261 636b 6772 6f75  _verify_backgrou
-000185e0: 6e64 5f74 6173 6b5f 696e 5f74 6572 6d69  nd_task_in_termi
-000185f0: 6e61 6c5f 7374 6174 652c 0a20 2020 2020  nal_state,.     
-00018600: 2020 2029 0a0a 2020 2020 6465 6620 5f77     )..    def _w
-00018610: 6169 745f 666f 725f 7072 6f6a 6563 745f  ait_for_project_
-00018620: 746f 5f62 655f 6465 6c65 7465 6428 7365  to_be_deleted(se
-00018630: 6c66 2c20 7072 6f6a 6563 745f 6e61 6d65  lf, project_name
-00018640: 3a20 7374 7229 3a0a 2020 2020 2020 2020  : str):.        
-00018650: 6465 6620 5f76 6572 6966 795f 7072 6f6a  def _verify_proj
-00018660: 6563 745f 6465 6c65 7465 6428 293a 0a20  ect_deleted():. 
-00018670: 2020 2020 2020 2020 2020 2070 726f 6a65             proje
-00018680: 6374 7320 3d20 7365 6c66 2e6c 6973 745f  cts = self.list_
-00018690: 7072 6f6a 6563 7473 280a 2020 2020 2020  projects(.      
-000186a0: 2020 2020 2020 2020 2020 666f 726d 6174            format
-000186b0: 5f3d 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  _=mlrun.common.s
-000186c0: 6368 656d 6173 2e50 726f 6a65 6374 7346  chemas.ProjectsF
-000186d0: 6f72 6d61 742e 6e61 6d65 5f6f 6e6c 790a  ormat.name_only.
-000186e0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-000186f0: 2020 2020 2020 2020 2020 6966 2070 726f            if pro
-00018700: 6a65 6374 5f6e 616d 6520 696e 2070 726f  ject_name in pro
-00018710: 6a65 6374 733a 0a20 2020 2020 2020 2020  jects:.         
-00018720: 2020 2020 2020 2072 6169 7365 2045 7863         raise Exc
-00018730: 6570 7469 6f6e 2822 5072 6f6a 6563 7420  eption("Project 
-00018740: 7374 696c 6c20 6578 6973 7473 2229 0a0a  still exists")..
-00018750: 2020 2020 2020 2020 7265 7475 726e 206d          return m
-00018760: 6c72 756e 2e75 7469 6c73 2e68 656c 7065  lrun.utils.helpe
-00018770: 7273 2e72 6574 7279 5f75 6e74 696c 5f73  rs.retry_until_s
-00018780: 7563 6365 7373 6675 6c28 0a20 2020 2020  uccessful(.     
-00018790: 2020 2020 2020 2073 656c 662e 5f77 6169         self._wai
-000187a0: 745f 666f 725f 7072 6f6a 6563 745f 6465  t_for_project_de
-000187b0: 6c65 7469 6f6e 5f69 6e74 6572 7661 6c2c  letion_interval,
-000187c0: 0a20 2020 2020 2020 2020 2020 2031 3230  .            120
-000187d0: 2c0a 2020 2020 2020 2020 2020 2020 6c6f  ,.            lo
-000187e0: 6767 6572 2c0a 2020 2020 2020 2020 2020  gger,.          
-000187f0: 2020 4661 6c73 652c 0a20 2020 2020 2020    False,.       
-00018800: 2020 2020 205f 7665 7269 6679 5f70 726f       _verify_pro
-00018810: 6a65 6374 5f64 656c 6574 6564 2c0a 2020  ject_deleted,.  
-00018820: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
-00018830: 2063 7265 6174 655f 7072 6f6a 6563 745f   create_project_
-00018840: 7365 6372 6574 7328 0a20 2020 2020 2020  secrets(.       
-00018850: 2073 656c 662c 0a20 2020 2020 2020 2070   self,.        p
-00018860: 726f 6a65 6374 3a20 7374 722c 0a20 2020  roject: str,.   
-00018870: 2020 2020 2070 726f 7669 6465 723a 2055       provider: U
-00018880: 6e69 6f6e 5b0a 2020 2020 2020 2020 2020  nion[.          
-00018890: 2020 7374 722c 206d 6c72 756e 2e63 6f6d    str, mlrun.com
-000188a0: 6d6f 6e2e 7363 6865 6d61 732e 5365 6372  mon.schemas.Secr
-000188b0: 6574 5072 6f76 6964 6572 4e61 6d65 0a20  etProviderName. 
-000188c0: 2020 2020 2020 205d 203d 206d 6c72 756e         ] = mlrun
-000188d0: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
-000188e0: 5365 6372 6574 5072 6f76 6964 6572 4e61  SecretProviderNa
-000188f0: 6d65 2e6b 7562 6572 6e65 7465 732c 0a20  me.kubernetes,. 
-00018900: 2020 2020 2020 2073 6563 7265 7473 3a20         secrets: 
-00018910: 6469 6374 203d 204e 6f6e 652c 0a20 2020  dict = None,.   
-00018920: 2029 3a0a 2020 2020 2020 2020 2222 2243   ):.        """C
-00018930: 7265 6174 6520 7072 6f6a 6563 742d 636f  reate project-co
-00018940: 6e74 6578 7420 7365 6372 6574 7320 7573  ntext secrets us
-00018950: 696e 6720 6569 7468 6572 2060 6076 6175  ing either ``vau
-00018960: 6c74 6060 206f 7220 6060 6b75 6265 726e  lt`` or ``kubern
-00018970: 6574 6573 6060 2070 726f 7669 6465 722e  etes`` provider.
-00018980: 0a20 2020 2020 2020 2057 6865 6e20 7573  .        When us
-00018990: 696e 6720 7769 7468 2056 6175 6c74 2c20  ing with Vault, 
-000189a0: 7468 6973 2077 696c 6c20 6372 6561 7465  this will create
-000189b0: 206e 6565 6465 6420 5661 756c 7420 7374   needed Vault st
-000189c0: 7275 6374 7572 6573 2066 6f72 2073 746f  ructures for sto
-000189d0: 7269 6e67 2073 6563 7265 7473 2069 6e20  ring secrets in 
-000189e0: 7072 6f6a 6563 742d 636f 6e74 6578 742c  project-context,
-000189f0: 2061 6e64 0a20 2020 2020 2020 2073 746f   and.        sto
-00018a00: 7265 2061 2073 6574 206f 6620 7365 6372  re a set of secr
-00018a10: 6574 2076 616c 7565 732e 2054 6865 206d  et values. The m
-00018a20: 6574 686f 6420 6765 6e65 7261 7465 7320  ethod generates 
-00018a30: 4b75 6265 726e 6574 6573 2073 6572 7669  Kubernetes servi
-00018a40: 6365 2d61 6363 6f75 6e74 2061 6e64 2074  ce-account and t
-00018a50: 6865 2056 6175 6c74 2061 7574 6865 6e74  he Vault authent
-00018a60: 6963 6174 696f 6e0a 2020 2020 2020 2020  ication.        
-00018a70: 7374 7275 6374 7572 6573 2074 6861 7420  structures that 
-00018a80: 6172 6520 7265 7175 6972 6564 2066 6f72  are required for
-00018a90: 2066 756e 6374 696f 6e20 506f 6473 2074   function Pods t
-00018aa0: 6f20 6175 7468 656e 7469 6361 7465 2077  o authenticate w
-00018ab0: 6974 6820 5661 756c 7420 616e 6420 6265  ith Vault and be
-00018ac0: 2061 626c 6520 746f 2065 7874 7261 6374   able to extract
-00018ad0: 2073 6563 7265 7420 7661 6c75 6573 0a20   secret values. 
-00018ae0: 2020 2020 2020 2070 6173 7365 6420 6173         passed as
-00018af0: 2070 6172 7420 6f66 2074 6865 6972 2063   part of their c
-00018b00: 6f6e 7465 7874 2e0a 0a20 2020 2020 2020  ontext...       
-00018b10: 204e 6f74 653a 0a20 2020 2020 2020 2020   Note:.         
-00018b20: 2020 2020 2020 2054 6869 7320 6d65 7468         This meth
-00018b30: 6f64 2075 7365 6420 7769 7468 2056 6175  od used with Vau
-00018b40: 6c74 2069 7320 6375 7272 656e 746c 7920  lt is currently 
-00018b50: 696e 2074 6563 686e 6963 616c 2070 7265  in technical pre
-00018b60: 7669 6577 2c20 616e 6420 7265 7175 6972  view, and requir
-00018b70: 6573 2061 2048 6173 6869 436f 7270 2056  es a HashiCorp V
-00018b80: 6175 6c74 0a20 2020 2020 2020 2020 2020  ault.           
-00018b90: 2020 2020 2069 6e66 7261 7374 7275 6374       infrastruct
-00018ba0: 7572 6520 7072 6f70 6572 6c79 2073 6574  ure properly set
-00018bb0: 2075 7020 616e 6420 636f 6e6e 6563 7465   up and connecte
-00018bc0: 6420 746f 2074 6865 204d 4c52 756e 2041  d to the MLRun A
-00018bd0: 5049 2073 6572 7665 722e 0a0a 2020 2020  PI server...    
-00018be0: 2020 2020 5768 656e 2075 7365 6420 7769      When used wi
-00018bf0: 7468 204b 7562 6572 6e65 7465 732c 2074  th Kubernetes, t
-00018c00: 6869 7320 7769 6c6c 206d 616b 6520 7375  his will make su
-00018c10: 7265 2074 6861 7420 7468 6520 7072 6f6a  re that the proj
-00018c20: 6563 742d 7370 6563 6966 6963 206b 3873  ect-specific k8s
-00018c30: 2073 6563 7265 7420 6973 2063 7265 6174   secret is creat
-00018c40: 6564 2c20 616e 6420 7769 6c6c 0a20 2020  ed, and will.   
-00018c50: 2020 2020 2070 6f70 756c 6174 6520 6974       populate it
-00018c60: 2077 6974 6820 7468 6520 7365 6372 6574   with the secret
-00018c70: 7320 7072 6f76 6964 6564 2c20 7265 706c  s provided, repl
-00018c80: 6163 696e 6720 7468 6569 7220 7661 6c75  acing their valu
-00018c90: 6573 2069 6620 7468 6579 2065 7869 7374  es if they exist
-00018ca0: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
-00018cb0: 6d20 7072 6f6a 6563 743a 2054 6865 2070  m project: The p
-00018cc0: 726f 6a65 6374 2063 6f6e 7465 7874 2066  roject context f
-00018cd0: 6f72 2077 6869 6368 2074 6f20 6765 6e65  or which to gene
-00018ce0: 7261 7465 2074 6865 2069 6e66 7261 2061  rate the infra a
-00018cf0: 6e64 2073 746f 7265 2073 6563 7265 7473  nd store secrets
-00018d00: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00018d10: 2070 726f 7669 6465 723a 2054 6865 206e   provider: The n
-00018d20: 616d 6520 6f66 2074 6865 2073 6563 7265  ame of the secre
-00018d30: 7473 2d70 726f 7669 6465 7220 746f 2077  ts-provider to w
-00018d40: 6f72 6b20 7769 7468 2e20 4163 6365 7074  ork with. Accept
-00018d50: 7320 610a 2020 2020 2020 2020 2020 2020  s a.            
-00018d60: 3a70 793a 636c 6173 733a 607e 6d6c 7275  :py:class:`~mlru
-00018d70: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
-00018d80: 2e73 6563 7265 742e 5365 6372 6574 5072  .secret.SecretPr
-00018d90: 6f76 6964 6572 4e61 6d65 6020 656e 756d  oviderName` enum
-00018da0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00018db0: 2073 6563 7265 7473 3a20 4120 7365 7420   secrets: A set 
-00018dc0: 6f66 2073 6563 7265 7420 7661 6c75 6573  of secret values
-00018dd0: 2074 6f20 7374 6f72 652e 0a20 2020 2020   to store..     
-00018de0: 2020 2020 2020 2045 7861 6d70 6c65 3a3a         Example::
-00018df0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00018e00: 2020 7365 6372 6574 7320 3d20 7b27 7061    secrets = {'pa
-00018e10: 7373 776f 7264 273a 2027 6d79 5061 7373  ssword': 'myPass
-00018e20: 7730 7264 272c 2027 6177 735f 6b65 7927  w0rd', 'aws_key'
-00018e30: 3a20 2731 3131 3232 3233 3333 277d 0a20  : '111222333'}. 
-00018e40: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-00018e50: 622e 6372 6561 7465 5f70 726f 6a65 6374  b.create_project
-00018e60: 5f73 6563 7265 7473 280a 2020 2020 2020  _secrets(.      
-00018e70: 2020 2020 2020 2020 2020 2020 2020 2270                "p
-00018e80: 726f 6a65 6374 3122 2c0a 2020 2020 2020  roject1",.      
-00018e90: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-00018ea0: 6f76 6964 6572 3d6d 6c72 756e 2e63 6f6d  ovider=mlrun.com
-00018eb0: 6d6f 6e2e 7363 6865 6d61 732e 5365 6372  mon.schemas.Secr
-00018ec0: 6574 5072 6f76 6964 6572 4e61 6d65 2e6b  etProviderName.k
-00018ed0: 7562 6572 6e65 7465 732c 0a20 2020 2020  ubernetes,.     
-00018ee0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00018ef0: 6563 7265 7473 3d73 6563 7265 7473 0a20  ecrets=secrets. 
-00018f00: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-00018f10: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00018f20: 2020 2020 2070 6174 6820 3d20 6622 7072       path = f"pr
-00018f30: 6f6a 6563 7473 2f7b 7072 6f6a 6563 747d  ojects/{project}
-00018f40: 2f73 6563 7265 7473 220a 2020 2020 2020  /secrets".      
-00018f50: 2020 7365 6372 6574 735f 696e 7075 7420    secrets_input 
-00018f60: 3d20 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  = mlrun.common.s
-00018f70: 6368 656d 6173 2e53 6563 7265 7473 4461  chemas.SecretsDa
-00018f80: 7461 280a 2020 2020 2020 2020 2020 2020  ta(.            
-00018f90: 7365 6372 6574 733d 7365 6372 6574 732c  secrets=secrets,
-00018fa0: 2070 726f 7669 6465 723d 7072 6f76 6964   provider=provid
-00018fb0: 6572 0a20 2020 2020 2020 2029 0a20 2020  er.        ).   
-00018fc0: 2020 2020 2062 6f64 7920 3d20 7365 6372       body = secr
-00018fd0: 6574 735f 696e 7075 742e 6469 6374 2829  ets_input.dict()
-00018fe0: 0a20 2020 2020 2020 2065 7272 6f72 5f6d  .        error_m
-00018ff0: 6573 7361 6765 203d 2066 2246 6169 6c65  essage = f"Faile
-00019000: 6420 6372 6561 7469 6e67 2073 6563 7265  d creating secre
-00019010: 7420 7072 6f76 6964 6572 207b 7072 6f6a  t provider {proj
-00019020: 6563 747d 2f7b 7072 6f76 6964 6572 7d22  ect}/{provider}"
-00019030: 0a20 2020 2020 2020 2073 656c 662e 6170  .        self.ap
-00019040: 695f 6361 6c6c 280a 2020 2020 2020 2020  i_call(.        
-00019050: 2020 2020 2250 4f53 5422 2c0a 2020 2020      "POST",.    
-00019060: 2020 2020 2020 2020 7061 7468 2c0a 2020          path,.  
-00019070: 2020 2020 2020 2020 2020 6572 726f 725f            error_
-00019080: 6d65 7373 6167 652c 0a20 2020 2020 2020  message,.       
-00019090: 2020 2020 2062 6f64 793d 6469 6374 5f74       body=dict_t
-000190a0: 6f5f 6a73 6f6e 2862 6f64 7929 2c0a 2020  o_json(body),.  
-000190b0: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
-000190c0: 206c 6973 745f 7072 6f6a 6563 745f 7365   list_project_se
-000190d0: 6372 6574 7328 0a20 2020 2020 2020 2073  crets(.        s
-000190e0: 656c 662c 0a20 2020 2020 2020 2070 726f  elf,.        pro
-000190f0: 6a65 6374 3a20 7374 722c 0a20 2020 2020  ject: str,.     
-00019100: 2020 2074 6f6b 656e 3a20 7374 7220 3d20     token: str = 
-00019110: 4e6f 6e65 2c0a 2020 2020 2020 2020 7072  None,.        pr
-00019120: 6f76 6964 6572 3a20 556e 696f 6e5b 0a20  ovider: Union[. 
-00019130: 2020 2020 2020 2020 2020 2073 7472 2c20             str, 
-00019140: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
-00019150: 656d 6173 2e53 6563 7265 7450 726f 7669  emas.SecretProvi
-00019160: 6465 724e 616d 650a 2020 2020 2020 2020  derName.        
-00019170: 5d20 3d20 6d6c 7275 6e2e 636f 6d6d 6f6e  ] = mlrun.common
-00019180: 2e73 6368 656d 6173 2e53 6563 7265 7450  .schemas.SecretP
-00019190: 726f 7669 6465 724e 616d 652e 6b75 6265  roviderName.kube
-000191a0: 726e 6574 6573 2c0a 2020 2020 2020 2020  rnetes,.        
-000191b0: 7365 6372 6574 733a 204c 6973 745b 7374  secrets: List[st
-000191c0: 725d 203d 204e 6f6e 652c 0a20 2020 2029  r] = None,.    )
-000191d0: 202d 3e20 6d6c 7275 6e2e 636f 6d6d 6f6e   -> mlrun.common
-000191e0: 2e73 6368 656d 6173 2e53 6563 7265 7473  .schemas.Secrets
-000191f0: 4461 7461 3a0a 2020 2020 2020 2020 2222  Data:.        ""
-00019200: 2252 6574 7269 6576 6520 7072 6f6a 6563  "Retrieve projec
-00019210: 742d 636f 6e74 6578 7420 7365 6372 6574  t-context secret
-00019220: 7320 6672 6f6d 2056 6175 6c74 2e0a 0a20  s from Vault... 
-00019230: 2020 2020 2020 204e 6f74 653a 0a20 2020         Note:.   
-00019240: 2020 2020 2020 2020 2020 2020 2054 6869               Thi
-00019250: 7320 6d65 7468 6f64 2066 6f72 2056 6175  s method for Vau
-00019260: 6c74 2066 756e 6374 696f 6e61 6c69 7479  lt functionality
-00019270: 2069 7320 6375 7272 656e 746c 7920 696e   is currently in
-00019280: 2074 6563 686e 6963 616c 2070 7265 7669   technical previ
-00019290: 6577 2c20 616e 6420 7265 7175 6972 6573  ew, and requires
-000192a0: 2061 2048 6173 6869 436f 7270 2056 6175   a HashiCorp Vau
-000192b0: 6c74 0a20 2020 2020 2020 2020 2020 2020  lt.             
-000192c0: 2020 2069 6e66 7261 7374 7275 6374 7572     infrastructur
-000192d0: 6520 7072 6f70 6572 6c79 2073 6574 2075  e properly set u
-000192e0: 7020 616e 6420 636f 6e6e 6563 7465 6420  p and connected 
-000192f0: 746f 2074 6865 204d 4c52 756e 2041 5049  to the MLRun API
-00019300: 2073 6572 7665 722e 0a0a 2020 2020 2020   server...      
-00019310: 2020 3a70 6172 616d 2070 726f 6a65 6374    :param project
-00019320: 3a20 5468 6520 7072 6f6a 6563 7420 6e61  : The project na
-00019330: 6d65 2e0a 2020 2020 2020 2020 3a70 6172  me..        :par
-00019340: 616d 2074 6f6b 656e 3a20 5661 756c 7420  am token: Vault 
-00019350: 746f 6b65 6e20 746f 2075 7365 2066 6f72  token to use for
-00019360: 2072 6574 7269 6576 696e 6720 7365 6372   retrieving secr
-00019370: 6574 732e 0a20 2020 2020 2020 2020 2020  ets..           
-00019380: 204d 7573 7420 6265 2061 2076 616c 6964   Must be a valid
-00019390: 2056 6175 6c74 2074 6f6b 656e 2c20 7769   Vault token, wi
-000193a0: 7468 2070 6572 6d69 7373 696f 6e73 2074  th permissions t
-000193b0: 6f20 7265 7472 6965 7665 2073 6563 7265  o retrieve secre
-000193c0: 7473 206f 6620 7468 6520 7072 6f6a 6563  ts of the projec
-000193d0: 7420 696e 2071 7565 7374 696f 6e2e 0a20  t in question.. 
-000193e0: 2020 2020 2020 203a 7061 7261 6d20 7072         :param pr
-000193f0: 6f76 6964 6572 3a20 5468 6520 6e61 6d65  ovider: The name
-00019400: 206f 6620 7468 6520 7365 6372 6574 732d   of the secrets-
-00019410: 7072 6f76 6964 6572 2074 6f20 776f 726b  provider to work
-00019420: 2077 6974 682e 2043 7572 7265 6e74 6c79   with. Currently
-00019430: 206f 6e6c 7920 6060 7661 756c 7460 6020   only ``vault`` 
-00019440: 6973 2061 6363 6570 7465 642e 0a20 2020  is accepted..   
-00019450: 2020 2020 203a 7061 7261 6d20 7365 6372       :param secr
-00019460: 6574 733a 2041 206c 6973 7420 6f66 2073  ets: A list of s
-00019470: 6563 7265 7420 6e61 6d65 7320 746f 2072  ecret names to r
-00019480: 6574 7269 6576 652e 2041 6e20 656d 7074  etrieve. An empt
-00019490: 7920 6c69 7374 2060 605b 5d60 6020 7769  y list ``[]`` wi
-000194a0: 6c6c 2072 6574 7269 6576 6520 616c 6c20  ll retrieve all 
-000194b0: 7365 6372 6574 7320 6173 7369 676e 6564  secrets assigned
-000194c0: 0a20 2020 2020 2020 2020 2020 2074 6f20  .            to 
-000194d0: 7468 6973 2073 7065 6369 6669 6320 7072  this specific pr
-000194e0: 6f6a 6563 742e 2060 606b 7562 6572 6e65  oject. ``kuberne
-000194f0: 7465 7360 6020 7072 6f76 6964 6572 206f  tes`` provider o
-00019500: 6e6c 7920 7375 7070 6f72 7473 2061 6e20  nly supports an 
-00019510: 656d 7074 7920 6c69 7374 2e0a 2020 2020  empty list..    
-00019520: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
-00019530: 2069 6620 280a 2020 2020 2020 2020 2020   if (.          
-00019540: 2020 7072 6f76 6964 6572 203d 3d20 6d6c    provider == ml
-00019550: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
-00019560: 6173 2e53 6563 7265 7450 726f 7669 6465  as.SecretProvide
-00019570: 724e 616d 652e 7661 756c 742e 7661 6c75  rName.vault.valu
-00019580: 650a 2020 2020 2020 2020 2020 2020 616e  e.            an
-00019590: 6420 6e6f 7420 746f 6b65 6e0a 2020 2020  d not token.    
-000195a0: 2020 2020 293a 0a20 2020 2020 2020 2020      ):.         
-000195b0: 2020 2072 6169 7365 204d 4c52 756e 496e     raise MLRunIn
-000195c0: 7661 6c69 6441 7267 756d 656e 7445 7272  validArgumentErr
-000195d0: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
-000195e0: 2020 2020 2241 2076 6175 6c74 2074 6f6b      "A vault tok
-000195f0: 656e 206d 7573 7420 6265 2070 726f 7669  en must be provi
-00019600: 6465 6420 7768 656e 2061 6363 6573 7369  ded when accessi
-00019610: 6e67 2076 6175 6c74 2073 6563 7265 7473  ng vault secrets
-00019620: 220a 2020 2020 2020 2020 2020 2020 290a  ".            ).
-00019630: 0a20 2020 2020 2020 2070 6174 6820 3d20  .        path = 
-00019640: 6622 7072 6f6a 6563 7473 2f7b 7072 6f6a  f"projects/{proj
-00019650: 6563 747d 2f73 6563 7265 7473 220a 2020  ect}/secrets".  
-00019660: 2020 2020 2020 7061 7261 6d73 203d 207b        params = {
-00019670: 2270 726f 7669 6465 7222 3a20 7072 6f76  "provider": prov
-00019680: 6964 6572 2c20 2273 6563 7265 7422 3a20  ider, "secret": 
-00019690: 7365 6372 6574 737d 0a20 2020 2020 2020  secrets}.       
-000196a0: 2068 6561 6465 7273 203d 207b 6d6c 7275   headers = {mlru
-000196b0: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
-000196c0: 2e48 6561 6465 724e 616d 6573 2e73 6563  .HeaderNames.sec
-000196d0: 7265 745f 7374 6f72 655f 746f 6b65 6e3a  ret_store_token:
-000196e0: 2074 6f6b 656e 7d0a 2020 2020 2020 2020   token}.        
-000196f0: 6572 726f 725f 6d65 7373 6167 6520 3d20  error_message = 
-00019700: 6622 4661 696c 6564 2072 6574 7269 6576  f"Failed retriev
-00019710: 696e 6720 7365 6372 6574 7320 7b70 726f  ing secrets {pro
-00019720: 6a65 6374 7d2f 7b70 726f 7669 6465 727d  ject}/{provider}
-00019730: 220a 2020 2020 2020 2020 7265 7375 6c74  ".        result
-00019740: 203d 2073 656c 662e 6170 695f 6361 6c6c   = self.api_call
-00019750: 280a 2020 2020 2020 2020 2020 2020 2247  (.            "G
-00019760: 4554 222c 0a20 2020 2020 2020 2020 2020  ET",.           
-00019770: 2070 6174 682c 0a20 2020 2020 2020 2020   path,.         
-00019780: 2020 2065 7272 6f72 5f6d 6573 7361 6765     error_message
-00019790: 2c0a 2020 2020 2020 2020 2020 2020 7061  ,.            pa
-000197a0: 7261 6d73 3d70 6172 616d 732c 0a20 2020  rams=params,.   
-000197b0: 2020 2020 2020 2020 2068 6561 6465 7273           headers
-000197c0: 3d68 6561 6465 7273 2c0a 2020 2020 2020  =headers,.      
-000197d0: 2020 290a 2020 2020 2020 2020 7265 7475    ).        retu
-000197e0: 726e 206d 6c72 756e 2e63 6f6d 6d6f 6e2e  rn mlrun.common.
-000197f0: 7363 6865 6d61 732e 5365 6372 6574 7344  schemas.SecretsD
-00019800: 6174 6128 2a2a 7265 7375 6c74 2e6a 736f  ata(**result.jso
-00019810: 6e28 2929 0a0a 2020 2020 6465 6620 6c69  n())..    def li
-00019820: 7374 5f70 726f 6a65 6374 5f73 6563 7265  st_project_secre
-00019830: 745f 6b65 7973 280a 2020 2020 2020 2020  t_keys(.        
-00019840: 7365 6c66 2c0a 2020 2020 2020 2020 7072  self,.        pr
-00019850: 6f6a 6563 743a 2073 7472 2c0a 2020 2020  oject: str,.    
-00019860: 2020 2020 7072 6f76 6964 6572 3a20 556e      provider: Un
-00019870: 696f 6e5b 0a20 2020 2020 2020 2020 2020  ion[.           
-00019880: 2073 7472 2c20 6d6c 7275 6e2e 636f 6d6d   str, mlrun.comm
-00019890: 6f6e 2e73 6368 656d 6173 2e53 6563 7265  on.schemas.Secre
-000198a0: 7450 726f 7669 6465 724e 616d 650a 2020  tProviderName.  
-000198b0: 2020 2020 2020 5d20 3d20 6d6c 7275 6e2e        ] = mlrun.
-000198c0: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e53  common.schemas.S
-000198d0: 6563 7265 7450 726f 7669 6465 724e 616d  ecretProviderNam
-000198e0: 652e 6b75 6265 726e 6574 6573 2c0a 2020  e.kubernetes,.  
-000198f0: 2020 2020 2020 746f 6b65 6e3a 2073 7472        token: str
-00019900: 203d 204e 6f6e 652c 0a20 2020 2029 202d   = None,.    ) -
-00019910: 3e20 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  > mlrun.common.s
-00019920: 6368 656d 6173 2e53 6563 7265 744b 6579  chemas.SecretKey
-00019930: 7344 6174 613a 0a20 2020 2020 2020 2022  sData:.        "
-00019940: 2222 5265 7472 6965 7665 2070 726f 6a65  ""Retrieve proje
-00019950: 6374 2d63 6f6e 7465 7874 2073 6563 7265  ct-context secre
-00019960: 7420 6b65 7973 2066 726f 6d20 5661 756c  t keys from Vaul
-00019970: 7420 6f72 204b 7562 6572 6e65 7465 732e  t or Kubernetes.
-00019980: 0a0a 2020 2020 2020 2020 4e6f 7465 3a0a  ..        Note:.
-00019990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000199a0: 5468 6973 206d 6574 686f 6420 666f 7220  This method for 
-000199b0: 5661 756c 7420 6675 6e63 7469 6f6e 616c  Vault functional
-000199c0: 6974 7920 6973 2063 7572 7265 6e74 6c79  ity is currently
-000199d0: 2069 6e20 7465 6368 6e69 6361 6c20 7072   in technical pr
-000199e0: 6576 6965 772c 2061 6e64 2072 6571 7569  eview, and requi
-000199f0: 7265 7320 6120 4861 7368 6943 6f72 7020  res a HashiCorp 
-00019a00: 5661 756c 740a 2020 2020 2020 2020 2020  Vault.          
-00019a10: 2020 2020 2020 696e 6672 6173 7472 7563        infrastruc
-00019a20: 7475 7265 2070 726f 7065 726c 7920 7365  ture properly se
-00019a30: 7420 7570 2061 6e64 2063 6f6e 6e65 6374  t up and connect
-00019a40: 6564 2074 6f20 7468 6520 4d4c 5275 6e20  ed to the MLRun 
-00019a50: 4150 4920 7365 7276 6572 2e0a 0a20 2020  API server...   
-00019a60: 2020 2020 203a 7061 7261 6d20 7072 6f6a       :param proj
-00019a70: 6563 743a 2054 6865 2070 726f 6a65 6374  ect: The project
-00019a80: 206e 616d 652e 0a20 2020 2020 2020 203a   name..        :
-00019a90: 7061 7261 6d20 7072 6f76 6964 6572 3a20  param provider: 
-00019aa0: 5468 6520 6e61 6d65 206f 6620 7468 6520  The name of the 
-00019ab0: 7365 6372 6574 732d 7072 6f76 6964 6572  secrets-provider
-00019ac0: 2074 6f20 776f 726b 2077 6974 682e 2041   to work with. A
-00019ad0: 6363 6570 7473 2061 0a20 2020 2020 2020  ccepts a.       
-00019ae0: 2020 2020 203a 7079 3a63 6c61 7373 3a60       :py:class:`
-00019af0: 7e6d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363  ~mlrun.common.sc
-00019b00: 6865 6d61 732e 7365 6372 6574 2e53 6563  hemas.secret.Sec
-00019b10: 7265 7450 726f 7669 6465 724e 616d 6560  retProviderName`
-00019b20: 2065 6e75 6d2e 0a20 2020 2020 2020 203a   enum..        :
-00019b30: 7061 7261 6d20 746f 6b65 6e3a 2056 6175  param token: Vau
-00019b40: 6c74 2074 6f6b 656e 2074 6f20 7573 6520  lt token to use 
-00019b50: 666f 7220 7265 7472 6965 7669 6e67 2073  for retrieving s
-00019b60: 6563 7265 7473 2e20 4f6e 6c79 2069 6e20  ecrets. Only in 
-00019b70: 7573 6520 6966 2060 6070 726f 7669 6465  use if ``provide
-00019b80: 7260 6020 6973 2060 6076 6175 6c74 6060  r`` is ``vault``
-00019b90: 2e0a 2020 2020 2020 2020 2020 2020 4d75  ..            Mu
-00019ba0: 7374 2062 6520 6120 7661 6c69 6420 5661  st be a valid Va
-00019bb0: 756c 7420 746f 6b65 6e2c 2077 6974 6820  ult token, with 
-00019bc0: 7065 726d 6973 7369 6f6e 7320 746f 2072  permissions to r
-00019bd0: 6574 7269 6576 6520 7365 6372 6574 7320  etrieve secrets 
-00019be0: 6f66 2074 6865 2070 726f 6a65 6374 2069  of the project i
-00019bf0: 6e20 7175 6573 7469 6f6e 2e0a 2020 2020  n question..    
-00019c00: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
-00019c10: 2069 6620 280a 2020 2020 2020 2020 2020   if (.          
-00019c20: 2020 7072 6f76 6964 6572 203d 3d20 6d6c    provider == ml
-00019c30: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
-00019c40: 6173 2e53 6563 7265 7450 726f 7669 6465  as.SecretProvide
-00019c50: 724e 616d 652e 7661 756c 742e 7661 6c75  rName.vault.valu
-00019c60: 650a 2020 2020 2020 2020 2020 2020 616e  e.            an
-00019c70: 6420 6e6f 7420 746f 6b65 6e0a 2020 2020  d not token.    
-00019c80: 2020 2020 293a 0a20 2020 2020 2020 2020      ):.         
-00019c90: 2020 2072 6169 7365 204d 4c52 756e 496e     raise MLRunIn
-00019ca0: 7661 6c69 6441 7267 756d 656e 7445 7272  validArgumentErr
-00019cb0: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
-00019cc0: 2020 2020 2241 2076 6175 6c74 2074 6f6b      "A vault tok
-00019cd0: 656e 206d 7573 7420 6265 2070 726f 7669  en must be provi
-00019ce0: 6465 6420 7768 656e 2061 6363 6573 7369  ded when accessi
-00019cf0: 6e67 2076 6175 6c74 2073 6563 7265 7473  ng vault secrets
-00019d00: 220a 2020 2020 2020 2020 2020 2020 290a  ".            ).
-00019d10: 0a20 2020 2020 2020 2070 6174 6820 3d20  .        path = 
-00019d20: 6622 7072 6f6a 6563 7473 2f7b 7072 6f6a  f"projects/{proj
-00019d30: 6563 747d 2f73 6563 7265 742d 6b65 7973  ect}/secret-keys
-00019d40: 220a 2020 2020 2020 2020 7061 7261 6d73  ".        params
-00019d50: 203d 207b 2270 726f 7669 6465 7222 3a20   = {"provider": 
-00019d60: 7072 6f76 6964 6572 7d0a 2020 2020 2020  provider}.      
-00019d70: 2020 6865 6164 6572 7320 3d20 280a 2020    headers = (.  
-00019d80: 2020 2020 2020 2020 2020 7b6d 6c72 756e            {mlrun
-00019d90: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
-00019da0: 4865 6164 6572 4e61 6d65 732e 7365 6372  HeaderNames.secr
-00019db0: 6574 5f73 746f 7265 5f74 6f6b 656e 3a20  et_store_token: 
-00019dc0: 746f 6b65 6e7d 0a20 2020 2020 2020 2020  token}.         
-00019dd0: 2020 2069 6620 7072 6f76 6964 6572 203d     if provider =
-00019de0: 3d20 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  = mlrun.common.s
-00019df0: 6368 656d 6173 2e53 6563 7265 7450 726f  chemas.SecretPro
-00019e00: 7669 6465 724e 616d 652e 7661 756c 742e  viderName.vault.
-00019e10: 7661 6c75 650a 2020 2020 2020 2020 2020  value.          
-00019e20: 2020 656c 7365 204e 6f6e 650a 2020 2020    else None.    
-00019e30: 2020 2020 290a 2020 2020 2020 2020 6572      ).        er
-00019e40: 726f 725f 6d65 7373 6167 6520 3d20 6622  ror_message = f"
-00019e50: 4661 696c 6564 2072 6574 7269 6576 696e  Failed retrievin
-00019e60: 6720 7365 6372 6574 206b 6579 7320 7b70  g secret keys {p
-00019e70: 726f 6a65 6374 7d2f 7b70 726f 7669 6465  roject}/{provide
-00019e80: 727d 220a 2020 2020 2020 2020 7265 7375  r}".        resu
-00019e90: 6c74 203d 2073 656c 662e 6170 695f 6361  lt = self.api_ca
-00019ea0: 6c6c 280a 2020 2020 2020 2020 2020 2020  ll(.            
-00019eb0: 2247 4554 222c 0a20 2020 2020 2020 2020  "GET",.         
-00019ec0: 2020 2070 6174 682c 0a20 2020 2020 2020     path,.       
-00019ed0: 2020 2020 2065 7272 6f72 5f6d 6573 7361       error_messa
-00019ee0: 6765 2c0a 2020 2020 2020 2020 2020 2020  ge,.            
-00019ef0: 7061 7261 6d73 3d70 6172 616d 732c 0a20  params=params,. 
-00019f00: 2020 2020 2020 2020 2020 2068 6561 6465             heade
-00019f10: 7273 3d68 6561 6465 7273 2c0a 2020 2020  rs=headers,.    
-00019f20: 2020 2020 290a 2020 2020 2020 2020 7265      ).        re
-00019f30: 7475 726e 206d 6c72 756e 2e63 6f6d 6d6f  turn mlrun.commo
-00019f40: 6e2e 7363 6865 6d61 732e 5365 6372 6574  n.schemas.Secret
-00019f50: 4b65 7973 4461 7461 282a 2a72 6573 756c  KeysData(**resul
-00019f60: 742e 6a73 6f6e 2829 290a 0a20 2020 2064  t.json())..    d
-00019f70: 6566 2064 656c 6574 655f 7072 6f6a 6563  ef delete_projec
-00019f80: 745f 7365 6372 6574 7328 0a20 2020 2020  t_secrets(.     
-00019f90: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-00019fa0: 2070 726f 6a65 6374 3a20 7374 722c 0a20   project: str,. 
-00019fb0: 2020 2020 2020 2070 726f 7669 6465 723a         provider:
-00019fc0: 2055 6e69 6f6e 5b0a 2020 2020 2020 2020   Union[.        
-00019fd0: 2020 2020 7374 722c 206d 6c72 756e 2e63      str, mlrun.c
-00019fe0: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 5365  ommon.schemas.Se
-00019ff0: 6372 6574 5072 6f76 6964 6572 4e61 6d65  cretProviderName
-0001a000: 0a20 2020 2020 2020 205d 203d 206d 6c72  .        ] = mlr
-0001a010: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
-0001a020: 732e 5365 6372 6574 5072 6f76 6964 6572  s.SecretProvider
-0001a030: 4e61 6d65 2e6b 7562 6572 6e65 7465 732c  Name.kubernetes,
-0001a040: 0a20 2020 2020 2020 2073 6563 7265 7473  .        secrets
-0001a050: 3a20 4c69 7374 5b73 7472 5d20 3d20 4e6f  : List[str] = No
-0001a060: 6e65 2c0a 2020 2020 293a 0a20 2020 2020  ne,.    ):.     
-0001a070: 2020 2022 2222 4465 6c65 7465 2070 726f     """Delete pro
-0001a080: 6a65 6374 2d63 6f6e 7465 7874 2073 6563  ject-context sec
-0001a090: 7265 7473 2066 726f 6d20 4b75 6265 726e  rets from Kubern
-0001a0a0: 6574 6573 2e0a 0a20 2020 2020 2020 203a  etes...        :
-0001a0b0: 7061 7261 6d20 7072 6f6a 6563 743a 2054  param project: T
-0001a0c0: 6865 2070 726f 6a65 6374 206e 616d 652e  he project name.
-0001a0d0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-0001a0e0: 7072 6f76 6964 6572 3a20 5468 6520 6e61  provider: The na
-0001a0f0: 6d65 206f 6620 7468 6520 7365 6372 6574  me of the secret
-0001a100: 732d 7072 6f76 6964 6572 2074 6f20 776f  s-provider to wo
-0001a110: 726b 2077 6974 682e 2043 7572 7265 6e74  rk with. Current
-0001a120: 6c79 206f 6e6c 7920 6060 6b75 6265 726e  ly only ``kubern
-0001a130: 6574 6573 6060 2069 7320 7375 7070 6f72  etes`` is suppor
-0001a140: 7465 642e 0a20 2020 2020 2020 203a 7061  ted..        :pa
-0001a150: 7261 6d20 7365 6372 6574 733a 2041 206c  ram secrets: A l
-0001a160: 6973 7420 6f66 2073 6563 7265 7420 6e61  ist of secret na
-0001a170: 6d65 7320 746f 2064 656c 6574 652e 2041  mes to delete. A
-0001a180: 6e20 656d 7074 7920 6c69 7374 2077 696c  n empty list wil
-0001a190: 6c20 6465 6c65 7465 2061 6c6c 2073 6563  l delete all sec
-0001a1a0: 7265 7473 2061 7373 6967 6e65 640a 2020  rets assigned.  
-0001a1b0: 2020 2020 2020 2020 2020 746f 2074 6869            to thi
-0001a1c0: 7320 7370 6563 6966 6963 2070 726f 6a65  s specific proje
-0001a1d0: 6374 2e0a 2020 2020 2020 2020 2222 220a  ct..        """.
-0001a1e0: 0a20 2020 2020 2020 2070 6174 6820 3d20  .        path = 
-0001a1f0: 6622 7072 6f6a 6563 7473 2f7b 7072 6f6a  f"projects/{proj
-0001a200: 6563 747d 2f73 6563 7265 7473 220a 2020  ect}/secrets".  
-0001a210: 2020 2020 2020 7061 7261 6d73 203d 207b        params = {
-0001a220: 2270 726f 7669 6465 7222 3a20 7072 6f76  "provider": prov
-0001a230: 6964 6572 2c20 2273 6563 7265 7422 3a20  ider, "secret": 
-0001a240: 7365 6372 6574 737d 0a20 2020 2020 2020  secrets}.       
-0001a250: 2065 7272 6f72 5f6d 6573 7361 6765 203d   error_message =
-0001a260: 2066 2246 6169 6c65 6420 6465 6c65 7469   f"Failed deleti
-0001a270: 6e67 2073 6563 7265 7473 207b 7072 6f6a  ng secrets {proj
-0001a280: 6563 747d 2f7b 7072 6f76 6964 6572 7d22  ect}/{provider}"
-0001a290: 0a20 2020 2020 2020 2073 656c 662e 6170  .        self.ap
-0001a2a0: 695f 6361 6c6c 280a 2020 2020 2020 2020  i_call(.        
-0001a2b0: 2020 2020 2244 454c 4554 4522 2c0a 2020      "DELETE",.  
-0001a2c0: 2020 2020 2020 2020 2020 7061 7468 2c0a            path,.
-0001a2d0: 2020 2020 2020 2020 2020 2020 6572 726f              erro
-0001a2e0: 725f 6d65 7373 6167 652c 0a20 2020 2020  r_message,.     
-0001a2f0: 2020 2020 2020 2070 6172 616d 733d 7061         params=pa
-0001a300: 7261 6d73 2c0a 2020 2020 2020 2020 290a  rams,.        ).
-0001a310: 0a20 2020 2064 6566 2063 7265 6174 655f  .    def create_
-0001a320: 7573 6572 5f73 6563 7265 7473 280a 2020  user_secrets(.  
-0001a330: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-0001a340: 2020 2020 7573 6572 3a20 7374 722c 0a20      user: str,. 
-0001a350: 2020 2020 2020 2070 726f 7669 6465 723a         provider:
-0001a360: 2055 6e69 6f6e 5b0a 2020 2020 2020 2020   Union[.        
-0001a370: 2020 2020 7374 722c 206d 6c72 756e 2e63      str, mlrun.c
-0001a380: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 5365  ommon.schemas.Se
-0001a390: 6372 6574 5072 6f76 6964 6572 4e61 6d65  cretProviderName
-0001a3a0: 0a20 2020 2020 2020 205d 203d 206d 6c72  .        ] = mlr
-0001a3b0: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
-0001a3c0: 732e 5365 6372 6574 5072 6f76 6964 6572  s.SecretProvider
-0001a3d0: 4e61 6d65 2e76 6175 6c74 2c0a 2020 2020  Name.vault,.    
-0001a3e0: 2020 2020 7365 6372 6574 733a 2064 6963      secrets: dic
-0001a3f0: 7420 3d20 4e6f 6e65 2c0a 2020 2020 293a  t = None,.    ):
-0001a400: 0a20 2020 2020 2020 2022 2222 4372 6561  .        """Crea
-0001a410: 7465 2075 7365 722d 636f 6e74 6578 7420  te user-context 
-0001a420: 7365 6372 6574 2069 6e20 5661 756c 742e  secret in Vault.
-0001a430: 2050 6c65 6173 6520 7265 6665 7220 746f   Please refer to
-0001a440: 203a 7079 3a66 756e 633a 6063 7265 6174   :py:func:`creat
-0001a450: 655f 7072 6f6a 6563 745f 7365 6372 6574  e_project_secret
-0001a460: 7360 2066 6f72 206d 6f72 6520 6465 7461  s` for more deta
-0001a470: 696c 730a 2020 2020 2020 2020 616e 6420  ils.        and 
-0001a480: 7374 6174 7573 206f 6620 7468 6973 2066  status of this f
-0001a490: 756e 6374 696f 6e61 6c69 7479 2e0a 0a20  unctionality... 
-0001a4a0: 2020 2020 2020 204e 6f74 653a 0a20 2020         Note:.   
-0001a4b0: 2020 2020 2020 2020 2020 2020 2054 6869               Thi
-0001a4c0: 7320 6d65 7468 6f64 2069 7320 6375 7272  s method is curr
-0001a4d0: 656e 746c 7920 696e 2074 6563 686e 6963  ently in technic
-0001a4e0: 616c 2070 7265 7669 6577 2c20 616e 6420  al preview, and 
-0001a4f0: 7265 7175 6972 6573 2061 2048 6173 6869  requires a Hashi
-0001a500: 436f 7270 2056 6175 6c74 2069 6e66 7261  Corp Vault infra
-0001a510: 7374 7275 6374 7572 650a 2020 2020 2020  structure.      
-0001a520: 2020 2020 2020 2020 2020 7072 6f70 6572            proper
-0001a530: 6c79 2073 6574 2075 7020 616e 6420 636f  ly set up and co
-0001a540: 6e6e 6563 7465 6420 746f 2074 6865 204d  nnected to the M
-0001a550: 4c52 756e 2041 5049 2073 6572 7665 722e  LRun API server.
-0001a560: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-0001a570: 2075 7365 723a 2054 6865 2075 7365 7220   user: The user 
-0001a580: 636f 6e74 6578 7420 666f 7220 7768 6963  context for whic
-0001a590: 6820 746f 2067 656e 6572 6174 6520 7468  h to generate th
-0001a5a0: 6520 696e 6672 6120 616e 6420 7374 6f72  e infra and stor
-0001a5b0: 6520 7365 6372 6574 732e 0a20 2020 2020  e secrets..     
-0001a5c0: 2020 203a 7061 7261 6d20 7072 6f76 6964     :param provid
-0001a5d0: 6572 3a20 5468 6520 6e61 6d65 206f 6620  er: The name of 
-0001a5e0: 7468 6520 7365 6372 6574 732d 7072 6f76  the secrets-prov
-0001a5f0: 6964 6572 2074 6f20 776f 726b 2077 6974  ider to work wit
-0001a600: 682e 2043 7572 7265 6e74 6c79 206f 6e6c  h. Currently onl
-0001a610: 7920 6060 7661 756c 7460 6020 6973 2073  y ``vault`` is s
-0001a620: 7570 706f 7274 6564 2e0a 2020 2020 2020  upported..      
-0001a630: 2020 3a70 6172 616d 2073 6563 7265 7473    :param secrets
-0001a640: 3a20 4120 7365 7420 6f66 2073 6563 7265  : A set of secre
-0001a650: 7420 7661 6c75 6573 2074 6f20 7374 6f72  t values to stor
-0001a660: 6520 7769 7468 696e 2074 6865 2056 6175  e within the Vau
-0001a670: 6c74 2e0a 2020 2020 2020 2020 2222 220a  lt..        """.
-0001a680: 2020 2020 2020 2020 7061 7468 203d 2022          path = "
-0001a690: 7573 6572 2d73 6563 7265 7473 220a 2020  user-secrets".  
-0001a6a0: 2020 2020 2020 7365 6372 6574 735f 6372        secrets_cr
-0001a6b0: 6561 7469 6f6e 5f72 6571 7565 7374 203d  eation_request =
-0001a6c0: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
-0001a6d0: 6865 6d61 732e 5573 6572 5365 6372 6574  hemas.UserSecret
-0001a6e0: 4372 6561 7469 6f6e 5265 7175 6573 7428  CreationRequest(
-0001a6f0: 0a20 2020 2020 2020 2020 2020 2075 7365  .            use
-0001a700: 723d 7573 6572 2c0a 2020 2020 2020 2020  r=user,.        
-0001a710: 2020 2020 7072 6f76 6964 6572 3d70 726f      provider=pro
-0001a720: 7669 6465 722c 0a20 2020 2020 2020 2020  vider,.         
-0001a730: 2020 2073 6563 7265 7473 3d73 6563 7265     secrets=secre
-0001a740: 7473 2c0a 2020 2020 2020 2020 290a 2020  ts,.        ).  
-0001a750: 2020 2020 2020 626f 6479 203d 2073 6563        body = sec
-0001a760: 7265 7473 5f63 7265 6174 696f 6e5f 7265  rets_creation_re
-0001a770: 7175 6573 742e 6469 6374 2829 0a20 2020  quest.dict().   
-0001a780: 2020 2020 2065 7272 6f72 5f6d 6573 7361       error_messa
-0001a790: 6765 203d 2066 2246 6169 6c65 6420 6372  ge = f"Failed cr
-0001a7a0: 6561 7469 6e67 2075 7365 7220 7365 6372  eating user secr
-0001a7b0: 6574 7320 2d20 7b75 7365 727d 220a 2020  ets - {user}".  
-0001a7c0: 2020 2020 2020 7365 6c66 2e61 7069 5f63        self.api_c
-0001a7d0: 616c 6c28 0a20 2020 2020 2020 2020 2020  all(.           
-0001a7e0: 2022 504f 5354 222c 0a20 2020 2020 2020   "POST",.       
-0001a7f0: 2020 2020 2070 6174 682c 0a20 2020 2020       path,.     
-0001a800: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
-0001a810: 7361 6765 2c0a 2020 2020 2020 2020 2020  sage,.          
-0001a820: 2020 626f 6479 3d64 6963 745f 746f 5f6a    body=dict_to_j
-0001a830: 736f 6e28 626f 6479 292c 0a20 2020 2020  son(body),.     
-0001a840: 2020 2029 0a0a 2020 2020 4073 7461 7469     )..    @stati
-0001a850: 636d 6574 686f 640a 2020 2020 6465 6620  cmethod.    def 
-0001a860: 5f76 616c 6964 6174 655f 7665 7273 696f  _validate_versio
-0001a870: 6e5f 636f 6d70 6174 6962 696c 6974 7928  n_compatibility(
-0001a880: 7365 7276 6572 5f76 6572 7369 6f6e 2c20  server_version, 
-0001a890: 636c 6965 6e74 5f76 6572 7369 6f6e 2920  client_version) 
-0001a8a0: 2d3e 2062 6f6f 6c3a 0a20 2020 2020 2020  -> bool:.       
-0001a8b0: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
-0001a8c0: 2020 7061 7273 6564 5f73 6572 7665 725f    parsed_server_
-0001a8d0: 7665 7273 696f 6e20 3d20 7365 6d76 6572  version = semver
-0001a8e0: 2e56 6572 7369 6f6e 496e 666f 2e70 6172  .VersionInfo.par
-0001a8f0: 7365 2873 6572 7665 725f 7665 7273 696f  se(server_versio
-0001a900: 6e29 0a20 2020 2020 2020 2020 2020 2070  n).            p
-0001a910: 6172 7365 645f 636c 6965 6e74 5f76 6572  arsed_client_ver
-0001a920: 7369 6f6e 203d 2073 656d 7665 722e 5665  sion = semver.Ve
-0001a930: 7273 696f 6e49 6e66 6f2e 7061 7273 6528  rsionInfo.parse(
-0001a940: 636c 6965 6e74 5f76 6572 7369 6f6e 290a  client_version).
-0001a950: 2020 2020 2020 2020 6578 6365 7074 2056          except V
-0001a960: 616c 7565 4572 726f 723a 0a20 2020 2020  alueError:.     
-0001a970: 2020 2020 2020 2023 2054 6869 7320 7769         # This wi
-0001a980: 6c6c 206d 6f73 746c 7920 6861 7070 656e  ll mostly happen
-0001a990: 2069 6e20 6465 7620 7363 656e 6172 696f   in dev scenario
-0001a9a0: 7320 7768 656e 2074 6865 2076 6572 7369  s when the versi
-0001a9b0: 6f6e 2069 7320 756e 7374 6162 6c65 2061  on is unstable a
-0001a9c0: 6e64 2073 7563 6820 2d20 7468 6572 6566  nd such - theref
-0001a9d0: 6f72 6520 7765 2772 6520 6967 6e6f 7269  ore we're ignori
-0001a9e0: 6e67 0a20 2020 2020 2020 2020 2020 206c  ng.            l
-0001a9f0: 6f67 6765 722e 7761 726e 696e 6728 0a20  ogger.warning(. 
-0001aa00: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0001aa10: 556e 6162 6c65 2074 6f20 7061 7273 6520  Unable to parse 
-0001aa20: 7365 7276 6572 206f 7220 636c 6965 6e74  server or client
-0001aa30: 2076 6572 7369 6f6e 2e20 4173 7375 6d69   version. Assumi
-0001aa40: 6e67 2063 6f6d 7061 7469 626c 6522 2c0a  ng compatible",.
-0001aa50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001aa60: 7365 7276 6572 5f76 6572 7369 6f6e 3d73  server_version=s
-0001aa70: 6572 7665 725f 7665 7273 696f 6e2c 0a20  erver_version,. 
-0001aa80: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-0001aa90: 6c69 656e 745f 7665 7273 696f 6e3d 636c  lient_version=cl
-0001aaa0: 6965 6e74 5f76 6572 7369 6f6e 2c0a 2020  ient_version,.  
-0001aab0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-0001aac0: 2020 2020 2020 2020 7265 7475 726e 2054          return T
-0001aad0: 7275 650a 2020 2020 2020 2020 6966 2028  rue.        if (
-0001aae0: 7061 7273 6564 5f73 6572 7665 725f 7665  parsed_server_ve
-0001aaf0: 7273 696f 6e2e 6d61 6a6f 7220 3d3d 2030  rsion.major == 0
-0001ab00: 2061 6e64 2070 6172 7365 645f 7365 7276   and parsed_serv
-0001ab10: 6572 5f76 6572 7369 6f6e 2e6d 696e 6f72  er_version.minor
-0001ab20: 203d 3d20 3029 206f 7220 280a 2020 2020   == 0) or (.    
-0001ab30: 2020 2020 2020 2020 7061 7273 6564 5f63          parsed_c
-0001ab40: 6c69 656e 745f 7665 7273 696f 6e2e 6d61  lient_version.ma
-0001ab50: 6a6f 7220 3d3d 2030 2061 6e64 2070 6172  jor == 0 and par
-0001ab60: 7365 645f 636c 6965 6e74 5f76 6572 7369  sed_client_versi
-0001ab70: 6f6e 2e6d 696e 6f72 203d 3d20 300a 2020  on.minor == 0.  
-0001ab80: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
-0001ab90: 2020 2020 206c 6f67 6765 722e 7761 726e       logger.warn
-0001aba0: 696e 6728 0a20 2020 2020 2020 2020 2020  ing(.           
-0001abb0: 2020 2020 2022 5365 7276 6572 206f 7220       "Server or 
-0001abc0: 636c 6965 6e74 2076 6572 7369 6f6e 2069  client version i
-0001abd0: 7320 756e 7374 6162 6c65 2e20 4173 7375  s unstable. Assu
-0001abe0: 6d69 6e67 2063 6f6d 7061 7469 626c 6522  ming compatible"
-0001abf0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001ac00: 2020 7365 7276 6572 5f76 6572 7369 6f6e    server_version
-0001ac10: 3d73 6572 7665 725f 7665 7273 696f 6e2c  =server_version,
-0001ac20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001ac30: 2063 6c69 656e 745f 7665 7273 696f 6e3d   client_version=
-0001ac40: 636c 6965 6e74 5f76 6572 7369 6f6e 2c0a  client_version,.
-0001ac50: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-0001ac60: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0001ac70: 2054 7275 650a 2020 2020 2020 2020 6966   True.        if
-0001ac80: 2070 6172 7365 645f 7365 7276 6572 5f76   parsed_server_v
-0001ac90: 6572 7369 6f6e 2e6d 616a 6f72 2021 3d20  ersion.major != 
-0001aca0: 7061 7273 6564 5f63 6c69 656e 745f 7665  parsed_client_ve
-0001acb0: 7273 696f 6e2e 6d61 6a6f 723a 0a20 2020  rsion.major:.   
-0001acc0: 2020 2020 2020 2020 206c 6f67 6765 722e           logger.
-0001acd0: 7761 726e 696e 6728 0a20 2020 2020 2020  warning(.       
-0001ace0: 2020 2020 2020 2020 2022 5365 7276 6572           "Server
-0001acf0: 2061 6e64 2063 6c69 656e 7420 7665 7273   and client vers
-0001ad00: 696f 6e73 2061 7265 2069 6e63 6f6d 7061  ions are incompa
-0001ad10: 7469 626c 6522 2c0a 2020 2020 2020 2020  tible",.        
-0001ad20: 2020 2020 2020 2020 7061 7273 6564 5f73          parsed_s
-0001ad30: 6572 7665 725f 7665 7273 696f 6e3d 7061  erver_version=pa
-0001ad40: 7273 6564 5f73 6572 7665 725f 7665 7273  rsed_server_vers
-0001ad50: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
-0001ad60: 2020 2020 2070 6172 7365 645f 636c 6965       parsed_clie
-0001ad70: 6e74 5f76 6572 7369 6f6e 3d70 6172 7365  nt_version=parse
-0001ad80: 645f 636c 6965 6e74 5f76 6572 7369 6f6e  d_client_version
-0001ad90: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
-0001ada0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0001adb0: 726e 2046 616c 7365 0a20 2020 2020 2020  rn False.       
-0001adc0: 2069 6620 7061 7273 6564 5f73 6572 7665   if parsed_serve
-0001add0: 725f 7665 7273 696f 6e2e 6d69 6e6f 7220  r_version.minor 
-0001ade0: 3e20 7061 7273 6564 5f63 6c69 656e 745f  > parsed_client_
-0001adf0: 7665 7273 696f 6e2e 6d69 6e6f 7220 2b20  version.minor + 
-0001ae00: 323a 0a20 2020 2020 2020 2020 2020 206c  2:.            l
-0001ae10: 6f67 6765 722e 696e 666f 280a 2020 2020  ogger.info(.    
-0001ae20: 2020 2020 2020 2020 2020 2020 2242 6163              "Bac
-0001ae30: 6b77 6172 6473 2063 6f6d 7061 7469 6269  kwards compatibi
-0001ae40: 6c69 7479 206d 6967 6874 206e 6f74 2061  lity might not a
-0001ae50: 7070 6c79 2062 6574 7765 656e 2074 6865  pply between the
-0001ae60: 2073 6572 7665 7220 616e 6420 636c 6965   server and clie
-0001ae70: 6e74 2076 6572 7369 6f6e 222c 0a20 2020  nt version",.   
-0001ae80: 2020 2020 2020 2020 2020 2020 2070 6172               par
-0001ae90: 7365 645f 7365 7276 6572 5f76 6572 7369  sed_server_versi
-0001aea0: 6f6e 3d70 6172 7365 645f 7365 7276 6572  on=parsed_server
-0001aeb0: 5f76 6572 7369 6f6e 2c0a 2020 2020 2020  _version,.      
-0001aec0: 2020 2020 2020 2020 2020 7061 7273 6564            parsed
-0001aed0: 5f63 6c69 656e 745f 7665 7273 696f 6e3d  _client_version=
-0001aee0: 7061 7273 6564 5f63 6c69 656e 745f 7665  parsed_client_ve
-0001aef0: 7273 696f 6e2c 0a20 2020 2020 2020 2020  rsion,.         
-0001af00: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-0001af10: 2072 6574 7572 6e20 4661 6c73 650a 2020   return False.  
-0001af20: 2020 2020 2020 6966 2070 6172 7365 645f        if parsed_
-0001af30: 636c 6965 6e74 5f76 6572 7369 6f6e 2e6d  client_version.m
-0001af40: 696e 6f72 203e 2070 6172 7365 645f 7365  inor > parsed_se
-0001af50: 7276 6572 5f76 6572 7369 6f6e 2e6d 696e  rver_version.min
-0001af60: 6f72 3a0a 2020 2020 2020 2020 2020 2020  or:.            
-0001af70: 6c6f 6767 6572 2e77 6172 6e69 6e67 280a  logger.warning(.
-0001af80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001af90: 2243 6c69 656e 7420 7665 7273 696f 6e20  "Client version 
-0001afa0: 7769 7468 2068 6967 6865 7220 7665 7273  with higher vers
-0001afb0: 696f 6e20 7468 616e 2073 6572 7665 7220  ion than server 
-0001afc0: 7665 7273 696f 6e20 6973 6e27 7420 7375  version isn't su
-0001afd0: 7070 6f72 7465 642c 220a 2020 2020 2020  pported,".      
-0001afe0: 2020 2020 2020 2020 2020 2220 616c 6967            " alig
-0001aff0: 6e20 796f 7572 2063 6c69 656e 7420 746f  n your client to
-0001b000: 2074 6865 2073 6572 7665 7220 7665 7273   the server vers
-0001b010: 696f 6e22 2c0a 2020 2020 2020 2020 2020  ion",.          
-0001b020: 2020 2020 2020 7061 7273 6564 5f73 6572        parsed_ser
-0001b030: 7665 725f 7665 7273 696f 6e3d 7061 7273  ver_version=pars
-0001b040: 6564 5f73 6572 7665 725f 7665 7273 696f  ed_server_versio
-0001b050: 6e2c 0a20 2020 2020 2020 2020 2020 2020  n,.             
-0001b060: 2020 2070 6172 7365 645f 636c 6965 6e74     parsed_client
-0001b070: 5f76 6572 7369 6f6e 3d70 6172 7365 645f  _version=parsed_
-0001b080: 636c 6965 6e74 5f76 6572 7369 6f6e 2c0a  client_version,.
-0001b090: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-0001b0a0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0001b0b0: 2046 616c 7365 0a20 2020 2020 2020 2069   False.        i
-0001b0c0: 6620 7061 7273 6564 5f73 6572 7665 725f  f parsed_server_
-0001b0d0: 7665 7273 696f 6e2e 6d69 6e6f 7220 213d  version.minor !=
-0001b0e0: 2070 6172 7365 645f 636c 6965 6e74 5f76   parsed_client_v
-0001b0f0: 6572 7369 6f6e 2e6d 696e 6f72 3a0a 2020  ersion.minor:.  
-0001b100: 2020 2020 2020 2020 2020 6c6f 6767 6572            logger
-0001b110: 2e69 6e66 6f28 0a20 2020 2020 2020 2020  .info(.         
-0001b120: 2020 2020 2020 2022 5365 7276 6572 2061         "Server a
-0001b130: 6e64 2063 6c69 656e 7420 7665 7273 696f  nd client versio
-0001b140: 6e73 2061 7265 206e 6f74 2074 6865 2073  ns are not the s
-0001b150: 616d 6520 6275 7420 636f 6d70 6174 6962  ame but compatib
-0001b160: 6c65 222c 0a20 2020 2020 2020 2020 2020  le",.           
-0001b170: 2020 2020 2070 6172 7365 645f 7365 7276       parsed_serv
-0001b180: 6572 5f76 6572 7369 6f6e 3d70 6172 7365  er_version=parse
-0001b190: 645f 7365 7276 6572 5f76 6572 7369 6f6e  d_server_version
-0001b1a0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001b1b0: 2020 7061 7273 6564 5f63 6c69 656e 745f    parsed_client_
-0001b1c0: 7665 7273 696f 6e3d 7061 7273 6564 5f63  version=parsed_c
-0001b1d0: 6c69 656e 745f 7665 7273 696f 6e2c 0a20  lient_version,. 
-0001b1e0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-0001b1f0: 2020 2020 2072 6574 7572 6e20 5472 7565       return True
-0001b200: 0a0a 2020 2020 6465 6620 6372 6561 7465  ..    def create
-0001b210: 5f6d 6f64 656c 5f65 6e64 706f 696e 7428  _model_endpoint(
-0001b220: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-0001b230: 2020 2020 2020 2070 726f 6a65 6374 3a20         project: 
-0001b240: 7374 722c 0a20 2020 2020 2020 2065 6e64  str,.        end
-0001b250: 706f 696e 745f 6964 3a20 7374 722c 0a20  point_id: str,. 
-0001b260: 2020 2020 2020 206d 6f64 656c 5f65 6e64         model_end
-0001b270: 706f 696e 743a 2055 6e69 6f6e 5b0a 2020  point: Union[.  
-0001b280: 2020 2020 2020 2020 2020 6d6c 7275 6e2e            mlrun.
-0001b290: 6d6f 6465 6c5f 6d6f 6e69 746f 7269 6e67  model_monitoring
-0001b2a0: 2e6d 6f64 656c 5f65 6e64 706f 696e 742e  .model_endpoint.
-0001b2b0: 4d6f 6465 6c45 6e64 706f 696e 742c 2064  ModelEndpoint, d
-0001b2c0: 6963 740a 2020 2020 2020 2020 5d2c 0a20  ict.        ],. 
-0001b2d0: 2020 2029 3a0a 2020 2020 2020 2020 2222     ):.        ""
-0001b2e0: 220a 2020 2020 2020 2020 4372 6561 7465  ".        Create
-0001b2f0: 7320 6120 4442 2072 6563 6f72 6420 7769  s a DB record wi
-0001b300: 7468 2074 6865 2067 6976 656e 206d 6f64  th the given mod
-0001b310: 656c 5f65 6e64 706f 696e 7420 7265 636f  el_endpoint reco
-0001b320: 7264 2e0a 0a20 2020 2020 2020 203a 7061  rd...        :pa
-0001b330: 7261 6d20 7072 6f6a 6563 743a 2054 6865  ram project: The
-0001b340: 206e 616d 6520 6f66 2074 6865 2070 726f   name of the pro
-0001b350: 6a65 6374 2e0a 2020 2020 2020 2020 3a70  ject..        :p
-0001b360: 6172 616d 2065 6e64 706f 696e 745f 6964  aram endpoint_id
-0001b370: 3a20 5468 6520 6964 206f 6620 7468 6520  : The id of the 
-0001b380: 656e 6470 6f69 6e74 2e0a 2020 2020 2020  endpoint..      
-0001b390: 2020 3a70 6172 616d 206d 6f64 656c 5f65    :param model_e
-0001b3a0: 6e64 706f 696e 743a 2041 6e20 6f62 6a65  ndpoint: An obje
-0001b3b0: 6374 2072 6570 7265 7365 6e74 696e 6720  ct representing 
-0001b3c0: 7468 6520 6d6f 6465 6c20 656e 6470 6f69  the model endpoi
-0001b3d0: 6e74 2e0a 2020 2020 2020 2020 2222 220a  nt..        """.
-0001b3e0: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
-0001b3f0: 7374 616e 6365 280a 2020 2020 2020 2020  stance(.        
-0001b400: 2020 2020 6d6f 6465 6c5f 656e 6470 6f69      model_endpoi
-0001b410: 6e74 2c20 6d6c 7275 6e2e 6d6f 6465 6c5f  nt, mlrun.model_
-0001b420: 6d6f 6e69 746f 7269 6e67 2e6d 6f64 656c  monitoring.model
-0001b430: 5f65 6e64 706f 696e 742e 4d6f 6465 6c45  _endpoint.ModelE
-0001b440: 6e64 706f 696e 740a 2020 2020 2020 2020  ndpoint.        
-0001b450: 293a 0a20 2020 2020 2020 2020 2020 206d  ):.            m
-0001b460: 6f64 656c 5f65 6e64 706f 696e 7420 3d20  odel_endpoint = 
-0001b470: 6d6f 6465 6c5f 656e 6470 6f69 6e74 2e74  model_endpoint.t
-0001b480: 6f5f 6469 6374 2829 0a0a 2020 2020 2020  o_dict()..      
-0001b490: 2020 7061 7468 203d 2066 2270 726f 6a65    path = f"proje
-0001b4a0: 6374 732f 7b70 726f 6a65 6374 7d2f 6d6f  cts/{project}/mo
-0001b4b0: 6465 6c2d 656e 6470 6f69 6e74 732f 7b65  del-endpoints/{e
-0001b4c0: 6e64 706f 696e 745f 6964 7d22 0a20 2020  ndpoint_id}".   
-0001b4d0: 2020 2020 2073 656c 662e 6170 695f 6361       self.api_ca
-0001b4e0: 6c6c 280a 2020 2020 2020 2020 2020 2020  ll(.            
-0001b4f0: 6d65 7468 6f64 3d22 504f 5354 222c 0a20  method="POST",. 
-0001b500: 2020 2020 2020 2020 2020 2070 6174 683d             path=
-0001b510: 7061 7468 2c0a 2020 2020 2020 2020 2020  path,.          
-0001b520: 2020 626f 6479 3d64 6963 745f 746f 5f6a    body=dict_to_j
-0001b530: 736f 6e28 6d6f 6465 6c5f 656e 6470 6f69  son(model_endpoi
-0001b540: 6e74 292c 0a20 2020 2020 2020 2029 0a0a  nt),.        )..
-0001b550: 2020 2020 6465 6620 6465 6c65 7465 5f6d      def delete_m
-0001b560: 6f64 656c 5f65 6e64 706f 696e 7428 0a20  odel_endpoint(. 
-0001b570: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-0001b580: 2020 2020 2070 726f 6a65 6374 3a20 7374       project: st
-0001b590: 722c 0a20 2020 2020 2020 2065 6e64 706f  r,.        endpo
-0001b5a0: 696e 745f 6964 3a20 7374 722c 0a20 2020  int_id: str,.   
-0001b5b0: 2029 3a0a 2020 2020 2020 2020 2222 220a   ):.        """.
-0001b5c0: 2020 2020 2020 2020 4465 6c65 7465 7320          Deletes 
-0001b5d0: 7468 6520 4442 2072 6563 6f72 6420 6f66  the DB record of
-0001b5e0: 2061 2067 6976 656e 206d 6f64 656c 2065   a given model e
-0001b5f0: 6e64 706f 696e 742c 2070 726f 6a65 6374  ndpoint, project
-0001b600: 2061 6e64 2065 6e64 706f 696e 745f 6964   and endpoint_id
-0001b610: 2061 7265 2075 7365 6420 666f 7220 6c6f   are used for lo
-0001b620: 6f6b 7570 0a0a 2020 2020 2020 2020 3a70  okup..        :p
-0001b630: 6172 616d 2070 726f 6a65 6374 3a20 5468  aram project: Th
-0001b640: 6520 6e61 6d65 206f 6620 7468 6520 7072  e name of the pr
-0001b650: 6f6a 6563 740a 2020 2020 2020 2020 3a70  oject.        :p
-0001b660: 6172 616d 2065 6e64 706f 696e 745f 6964  aram endpoint_id
-0001b670: 3a20 5468 6520 6964 206f 6620 7468 6520  : The id of the 
-0001b680: 656e 6470 6f69 6e74 0a20 2020 2020 2020  endpoint.       
-0001b690: 2022 2222 0a0a 2020 2020 2020 2020 7061   """..        pa
-0001b6a0: 7468 203d 2066 2270 726f 6a65 6374 732f  th = f"projects/
-0001b6b0: 7b70 726f 6a65 6374 7d2f 6d6f 6465 6c2d  {project}/model-
-0001b6c0: 656e 6470 6f69 6e74 732f 7b65 6e64 706f  endpoints/{endpo
-0001b6d0: 696e 745f 6964 7d22 0a20 2020 2020 2020  int_id}".       
-0001b6e0: 2073 656c 662e 6170 695f 6361 6c6c 280a   self.api_call(.
-0001b6f0: 2020 2020 2020 2020 2020 2020 6d65 7468              meth
-0001b700: 6f64 3d22 4445 4c45 5445 222c 0a20 2020  od="DELETE",.   
-0001b710: 2020 2020 2020 2020 2070 6174 683d 7061           path=pa
-0001b720: 7468 2c0a 2020 2020 2020 2020 290a 0a20  th,.        ).. 
-0001b730: 2020 2064 6566 206c 6973 745f 6d6f 6465     def list_mode
-0001b740: 6c5f 656e 6470 6f69 6e74 7328 0a20 2020  l_endpoints(.   
-0001b750: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-0001b760: 2020 2070 726f 6a65 6374 3a20 7374 722c     project: str,
-0001b770: 0a20 2020 2020 2020 206d 6f64 656c 3a20  .        model: 
-0001b780: 4f70 7469 6f6e 616c 5b73 7472 5d20 3d20  Optional[str] = 
-0001b790: 4e6f 6e65 2c0a 2020 2020 2020 2020 6675  None,.        fu
-0001b7a0: 6e63 7469 6f6e 3a20 4f70 7469 6f6e 616c  nction: Optional
-0001b7b0: 5b73 7472 5d20 3d20 4e6f 6e65 2c0a 2020  [str] = None,.  
-0001b7c0: 2020 2020 2020 6c61 6265 6c73 3a20 4c69        labels: Li
-0001b7d0: 7374 5b73 7472 5d20 3d20 4e6f 6e65 2c0a  st[str] = None,.
-0001b7e0: 2020 2020 2020 2020 7374 6172 743a 2073          start: s
-0001b7f0: 7472 203d 2022 6e6f 772d 3168 222c 0a20  tr = "now-1h",. 
-0001b800: 2020 2020 2020 2065 6e64 3a20 7374 7220         end: str 
-0001b810: 3d20 226e 6f77 222c 0a20 2020 2020 2020  = "now",.       
-0001b820: 206d 6574 7269 6373 3a20 4f70 7469 6f6e   metrics: Option
-0001b830: 616c 5b4c 6973 745b 7374 725d 5d20 3d20  al[List[str]] = 
-0001b840: 4e6f 6e65 2c0a 2020 2020 2020 2020 746f  None,.        to
-0001b850: 705f 6c65 7665 6c3a 2062 6f6f 6c20 3d20  p_level: bool = 
-0001b860: 4661 6c73 652c 0a20 2020 2020 2020 2075  False,.        u
-0001b870: 6964 733a 204f 7074 696f 6e61 6c5b 4c69  ids: Optional[Li
-0001b880: 7374 5b73 7472 5d5d 203d 204e 6f6e 652c  st[str]] = None,
-0001b890: 0a20 2020 2029 202d 3e20 4c69 7374 5b6d  .    ) -> List[m
-0001b8a0: 6c72 756e 2e6d 6f64 656c 5f6d 6f6e 6974  lrun.model_monit
-0001b8b0: 6f72 696e 672e 6d6f 6465 6c5f 656e 6470  oring.model_endp
-0001b8c0: 6f69 6e74 2e4d 6f64 656c 456e 6470 6f69  oint.ModelEndpoi
-0001b8d0: 6e74 5d3a 0a20 2020 2020 2020 2022 2222  nt]:.        """
-0001b8e0: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-0001b8f0: 2061 206c 6973 7420 6f66 2060 4d6f 6465   a list of `Mode
-0001b900: 6c45 6e64 706f 696e 7460 206f 626a 6563  lEndpoint` objec
-0001b910: 7473 2e20 4561 6368 2060 4d6f 6465 6c45  ts. Each `ModelE
-0001b920: 6e64 706f 696e 7460 206f 626a 6563 7420  ndpoint` object 
-0001b930: 7265 7072 6573 656e 7473 2074 6865 2063  represents the c
-0001b940: 7572 7265 6e74 2073 7461 7465 206f 6620  urrent state of 
-0001b950: 610a 2020 2020 2020 2020 6d6f 6465 6c20  a.        model 
-0001b960: 656e 6470 6f69 6e74 2e20 5468 6973 2066  endpoint. This f
-0001b970: 756e 6374 696f 6e73 2073 7570 706f 7274  unctions support
-0001b980: 7320 6669 6c74 6572 696e 6720 6279 2074  s filtering by t
-0001b990: 6865 2066 6f6c 6c6f 7769 6e67 2070 6172  he following par
-0001b9a0: 616d 6574 6572 733a 0a20 2020 2020 2020  ameters:.       
-0001b9b0: 2031 2920 6d6f 6465 6c0a 2020 2020 2020   1) model.      
-0001b9c0: 2020 3229 2066 756e 6374 696f 6e0a 2020    2) function.  
-0001b9d0: 2020 2020 2020 3329 206c 6162 656c 730a        3) labels.
-0001b9e0: 2020 2020 2020 2020 3429 2074 6f70 206c          4) top l
-0001b9f0: 6576 656c 0a20 2020 2020 2020 2035 2920  evel.        5) 
-0001ba00: 7569 6473 0a20 2020 2020 2020 2042 7920  uids.        By 
-0001ba10: 6465 6661 756c 742c 2077 6865 6e20 6e6f  default, when no
-0001ba20: 2066 696c 7465 7273 2061 7265 2061 7070   filters are app
-0001ba30: 6c69 6564 2c20 616c 6c20 6176 6169 6c61  lied, all availa
-0001ba40: 626c 6520 656e 6470 6f69 6e74 7320 666f  ble endpoints fo
-0001ba50: 7220 7468 6520 6769 7665 6e20 7072 6f6a  r the given proj
-0001ba60: 6563 7420 7769 6c6c 2062 6520 6c69 7374  ect will be list
-0001ba70: 6564 2e0a 0a20 2020 2020 2020 2049 6e20  ed...        In 
-0001ba80: 6164 6469 7469 6f6e 2c20 7468 6973 2066  addition, this f
-0001ba90: 756e 6374 696f 6e73 2070 726f 7669 6465  unctions provide
-0001baa0: 7320 6120 6661 6361 6465 2066 6f72 206c  s a facade for l
-0001bab0: 6973 7469 6e67 2065 6e64 706f 696e 7420  isting endpoint 
-0001bac0: 7265 6c61 7465 6420 6d65 7472 6963 732e  related metrics.
-0001bad0: 2054 6869 7320 6661 6361 6465 2069 7320   This facade is 
-0001bae0: 7469 6d65 2d62 6173 6564 0a20 2020 2020  time-based.     
-0001baf0: 2020 2061 6e64 2064 6570 656e 6473 206f     and depends o
-0001bb00: 6e20 7468 6520 2773 7461 7274 2720 616e  n the 'start' an
-0001bb10: 6420 2765 6e64 2720 7061 7261 6d65 7465  d 'end' paramete
-0001bb20: 7273 2e20 4279 2064 6566 6175 6c74 2c20  rs. By default, 
-0001bb30: 7768 656e 2074 6865 206d 6574 7269 6373  when the metrics
-0001bb40: 2070 6172 616d 6574 6572 2069 7320 4e6f   parameter is No
-0001bb50: 6e65 2c20 6e6f 206d 6574 7269 6373 2061  ne, no metrics a
-0001bb60: 7265 0a20 2020 2020 2020 2061 6464 6564  re.        added
-0001bb70: 2074 6f20 7468 6520 6f75 7470 7574 206f   to the output o
-0001bb80: 6620 7468 6973 2066 756e 6374 696f 6e2e  f this function.
-0001bb90: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-0001bba0: 2070 726f 6a65 6374 3a20 5468 6520 6e61   project: The na
-0001bbb0: 6d65 206f 6620 7468 6520 7072 6f6a 6563  me of the projec
-0001bbc0: 740a 2020 2020 2020 2020 3a70 6172 616d  t.        :param
-0001bbd0: 206d 6f64 656c 3a20 5468 6520 6e61 6d65   model: The name
-0001bbe0: 206f 6620 7468 6520 6d6f 6465 6c20 746f   of the model to
-0001bbf0: 2066 696c 7465 7220 6279 0a20 2020 2020   filter by.     
-0001bc00: 2020 203a 7061 7261 6d20 6675 6e63 7469     :param functi
-0001bc10: 6f6e 3a20 5468 6520 6e61 6d65 206f 6620  on: The name of 
-0001bc20: 7468 6520 6675 6e63 7469 6f6e 2074 6f20  the function to 
-0001bc30: 6669 6c74 6572 2062 790a 2020 2020 2020  filter by.      
-0001bc40: 2020 3a70 6172 616d 206c 6162 656c 733a    :param labels:
-0001bc50: 2041 206c 6973 7420 6f66 206c 6162 656c   A list of label
-0001bc60: 7320 746f 2066 696c 7465 7220 6279 2e20  s to filter by. 
-0001bc70: 4c61 6265 6c20 6669 6c74 6572 7320 776f  Label filters wo
-0001bc80: 726b 2062 7920 6569 7468 6572 2066 696c  rk by either fil
-0001bc90: 7465 7269 6e67 2061 2073 7065 6369 6669  tering a specifi
-0001bca0: 6320 7661 6c75 6520 6f66 2061 0a20 2020  c value of a.   
-0001bcb0: 2020 2020 2020 6c61 6265 6c20 2869 2e65        label (i.e
-0001bcc0: 2e20 6c69 7374 2822 6b65 793d 7661 6c75  . list("key=valu
-0001bcd0: 6522 2929 206f 7220 6279 206c 6f6f 6b69  e")) or by looki
-0001bce0: 6e67 2066 6f72 2074 6865 2065 7869 7374  ng for the exist
-0001bcf0: 656e 6365 206f 6620 6120 6769 7665 6e20  ence of a given 
-0001bd00: 6b65 7920 2869 2e65 2e20 226b 6579 2229  key (i.e. "key")
-0001bd10: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-0001bd20: 6d65 7472 6963 733a 2041 206c 6973 7420  metrics: A list 
-0001bd30: 6f66 206d 6574 7269 6373 2074 6f20 7265  of metrics to re
-0001bd40: 7475 726e 2066 6f72 2065 6163 6820 656e  turn for each en
-0001bd50: 6470 6f69 6e74 2c20 7265 6164 206d 6f72  dpoint, read mor
-0001bd60: 6520 696e 2027 5469 6d65 4d65 7472 6963  e in 'TimeMetric
-0001bd70: 270a 2020 2020 2020 2020 3a70 6172 616d  '.        :param
-0001bd80: 2073 7461 7274 3a20 5468 6520 7374 6172   start: The star
-0001bd90: 7420 7469 6d65 206f 6620 7468 6520 6d65  t time of the me
-0001bda0: 7472 6963 732e 2043 616e 2062 6520 7265  trics. Can be re
-0001bdb0: 7072 6573 656e 7465 6420 6279 2061 2073  presented by a s
-0001bdc0: 7472 696e 6720 636f 6e74 6169 6e69 6e67  tring containing
-0001bdd0: 2061 6e20 5246 4320 3333 3339 0a20 2020   an RFC 3339.   
-0001bde0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bdf0: 2020 2020 2020 2020 2020 2020 2020 7469                ti
-0001be00: 6d65 2c20 6120 556e 6978 2074 696d 6573  me, a Unix times
-0001be10: 7461 6d70 2069 6e20 6d69 6c6c 6973 6563  tamp in millisec
-0001be20: 6f6e 6473 2c20 6120 7265 6c61 7469 7665  onds, a relative
-0001be30: 2074 696d 6520 2860 276e 6f77 2760 206f   time (`'now'` o
-0001be40: 720a 2020 2020 2020 2020 2020 2020 2020  r.              
+00014760: 2020 2020 7061 7274 6974 696f 6e5f 6279      partition_by
+00014770: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00014780: 2020 2020 2020 726f 7773 5f70 6572 5f70        rows_per_p
+00014790: 6172 7469 7469 6f6e 2c0a 2020 2020 2020  artition,.      
+000147a0: 2020 2020 2020 2020 2020 2020 2020 7061                pa
+000147b0: 7274 6974 696f 6e5f 736f 7274 5f62 792c  rtition_sort_by,
+000147c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000147d0: 2020 2020 2070 6172 7469 7469 6f6e 5f6f       partition_o
+000147e0: 7264 6572 2c0a 2020 2020 2020 2020 2020  rder,.          
+000147f0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00014800: 2020 2020 290a 0a20 2020 2020 2020 2070      )..        p
+00014810: 6174 6820 3d20 6622 7072 6f6a 6563 7473  ath = f"projects
+00014820: 2f7b 7072 6f6a 6563 747d 2f66 6561 7475  /{project}/featu
+00014830: 7265 2d76 6563 746f 7273 220a 0a20 2020  re-vectors"..   
+00014840: 2020 2020 2065 7272 6f72 5f6d 6573 7361       error_messa
+00014850: 6765 203d 2028 0a20 2020 2020 2020 2020  ge = (.         
+00014860: 2020 2066 2246 6169 6c65 6420 6c69 7374     f"Failed list
+00014870: 696e 6720 6665 6174 7572 652d 7665 6374  ing feature-vect
+00014880: 6f72 732c 2070 726f 6a65 6374 3a20 7b70  ors, project: {p
+00014890: 726f 6a65 6374 7d2c 2071 7565 7279 3a20  roject}, query: 
+000148a0: 7b70 6172 616d 737d 220a 2020 2020 2020  {params}".      
+000148b0: 2020 290a 2020 2020 2020 2020 7265 7370    ).        resp
+000148c0: 203d 2073 656c 662e 6170 695f 6361 6c6c   = self.api_call
+000148d0: 2822 4745 5422 2c20 7061 7468 2c20 6572  ("GET", path, er
+000148e0: 726f 725f 6d65 7373 6167 652c 2070 6172  ror_message, par
+000148f0: 616d 733d 7061 7261 6d73 290a 2020 2020  ams=params).    
+00014900: 2020 2020 6665 6174 7572 655f 7665 6374      feature_vect
+00014910: 6f72 7320 3d20 7265 7370 2e6a 736f 6e28  ors = resp.json(
+00014920: 295b 2266 6561 7475 7265 5f76 6563 746f  )["feature_vecto
+00014930: 7273 225d 0a20 2020 2020 2020 2069 6620  rs"].        if 
+00014940: 6665 6174 7572 655f 7665 6374 6f72 733a  feature_vectors:
+00014950: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00014960: 7572 6e20 5b46 6561 7475 7265 5665 6374  urn [FeatureVect
+00014970: 6f72 2e66 726f 6d5f 6469 6374 286f 626a  or.from_dict(obj
+00014980: 2920 666f 7220 6f62 6a20 696e 2066 6561  ) for obj in fea
+00014990: 7475 7265 5f76 6563 746f 7273 5d0a 0a20  ture_vectors].. 
+000149a0: 2020 2064 6566 2073 746f 7265 5f66 6561     def store_fea
+000149b0: 7475 7265 5f76 6563 746f 7228 0a20 2020  ture_vector(.   
+000149c0: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+000149d0: 2020 2066 6561 7475 7265 5f76 6563 746f     feature_vecto
+000149e0: 723a 2055 6e69 6f6e 5b64 6963 742c 206d  r: Union[dict, m
+000149f0: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
+00014a00: 6d61 732e 4665 6174 7572 6556 6563 746f  mas.FeatureVecto
+00014a10: 722c 2046 6561 7475 7265 5665 6374 6f72  r, FeatureVector
+00014a20: 5d2c 0a20 2020 2020 2020 206e 616d 653d  ],.        name=
+00014a30: 4e6f 6e65 2c0a 2020 2020 2020 2020 7072  None,.        pr
+00014a40: 6f6a 6563 743d 2222 2c0a 2020 2020 2020  oject="",.      
+00014a50: 2020 7461 673d 4e6f 6e65 2c0a 2020 2020    tag=None,.    
+00014a60: 2020 2020 7569 643d 4e6f 6e65 2c0a 2020      uid=None,.  
+00014a70: 2020 2020 2020 7665 7273 696f 6e65 643d        versioned=
+00014a80: 5472 7565 2c0a 2020 2020 2920 2d3e 2064  True,.    ) -> d
+00014a90: 6963 743a 0a20 2020 2020 2020 2022 2222  ict:.        """
+00014aa0: 5374 6f72 6520 6120 3a70 793a 636c 6173  Store a :py:clas
+00014ab0: 733a 607e 6d6c 7275 6e2e 6665 6174 7572  s:`~mlrun.featur
+00014ac0: 655f 7374 6f72 652e 4665 6174 7572 6556  e_store.FeatureV
+00014ad0: 6563 746f 7260 206f 626a 6563 7420 696e  ector` object in
+00014ae0: 2074 6865 203a 7079 3a6d 6f64 3a60 6d6c   the :py:mod:`ml
+00014af0: 7275 6e60 2044 422e 2054 6865 0a20 2020  run` DB. The.   
+00014b00: 2020 2020 2066 6561 7475 7265 2d76 6563       feature-vec
+00014b10: 746f 7220 6361 6e20 6265 2065 6974 6865  tor can be eithe
+00014b20: 7220 6120 6e65 7720 6f62 6a65 6374 206f  r a new object o
+00014b30: 7220 6120 6d6f 6469 6669 6361 7469 6f6e  r a modification
+00014b40: 2074 6f20 6578 6973 7469 6e67 206f 626a   to existing obj
+00014b50: 6563 7420 7265 6665 7265 6e63 6564 2062  ect referenced b
+00014b60: 7920 7468 6520 7061 7261 6d73 0a20 2020  y the params.   
+00014b70: 2020 2020 206f 6620 7468 6520 6675 6e63       of the func
+00014b80: 7469 6f6e 2e0a 0a20 2020 2020 2020 203a  tion...        :
+00014b90: 7061 7261 6d20 6665 6174 7572 655f 7665  param feature_ve
+00014ba0: 6374 6f72 3a20 5468 6520 3a70 793a 636c  ctor: The :py:cl
+00014bb0: 6173 733a 607e 6d6c 7275 6e2e 6665 6174  ass:`~mlrun.feat
+00014bc0: 7572 655f 7374 6f72 652e 4665 6174 7572  ure_store.Featur
+00014bd0: 6556 6563 746f 7260 2074 6f20 7374 6f72  eVector` to stor
+00014be0: 652e 0a20 2020 2020 2020 203a 7061 7261  e..        :para
+00014bf0: 6d20 6e61 6d65 3a20 2020 204e 616d 6520  m name:    Name 
+00014c00: 6f66 2066 6561 7475 7265 2076 6563 746f  of feature vecto
+00014c10: 722e 0a20 2020 2020 2020 203a 7061 7261  r..        :para
+00014c20: 6d20 7072 6f6a 6563 743a 204e 616d 6520  m project: Name 
+00014c30: 6f66 2070 726f 6a65 6374 2074 6869 7320  of project this 
+00014c40: 6665 6174 7572 652d 7665 6374 6f72 2062  feature-vector b
+00014c50: 656c 6f6e 6773 2074 6f2e 0a20 2020 2020  elongs to..     
+00014c60: 2020 203a 7061 7261 6d20 7461 673a 2054     :param tag: T
+00014c70: 6865 2060 6074 6167 6060 206f 6620 7468  he ``tag`` of th
+00014c80: 6520 6f62 6a65 6374 2074 6f20 7265 706c  e object to repl
+00014c90: 6163 6520 696e 2074 6865 2044 422c 2066  ace in the DB, f
+00014ca0: 6f72 2065 7861 6d70 6c65 2060 606c 6174  or example ``lat
+00014cb0: 6573 7460 602e 0a20 2020 2020 2020 203a  est``..        :
+00014cc0: 7061 7261 6d20 7569 643a 2054 6865 2060  param uid: The `
+00014cd0: 6075 6964 6060 206f 6620 7468 6520 6f62  `uid`` of the ob
+00014ce0: 6a65 6374 2074 6f20 7265 706c 6163 6520  ject to replace 
+00014cf0: 696e 2074 6865 2044 422e 2049 6620 7573  in the DB. If us
+00014d00: 696e 6720 7468 6973 2070 6172 616d 6574  ing this paramet
+00014d10: 6572 2c20 7468 6520 6d6f 6469 6669 6564  er, the modified
+00014d20: 206f 626a 6563 740a 2020 2020 2020 2020   object.        
+00014d30: 2020 2020 6d75 7374 2068 6176 6520 7468      must have th
+00014d40: 6520 7361 6d65 2060 6075 6964 6060 206f  e same ``uid`` o
+00014d50: 6620 7468 6520 7072 6576 696f 7573 6c79  f the previously
+00014d60: 2d65 7869 7374 696e 6720 6f62 6a65 6374  -existing object
+00014d70: 2e20 5468 6973 2063 616e 6e6f 7420 6265  . This cannot be
+00014d80: 2075 7365 6420 666f 7220 6e6f 6e2d 7665   used for non-ve
+00014d90: 7273 696f 6e65 6420 6f62 6a65 6374 732e  rsioned objects.
+00014da0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00014db0: 7665 7273 696f 6e65 643a 2057 6865 7468  versioned: Wheth
+00014dc0: 6572 2074 6f20 6d61 696e 7461 696e 2076  er to maintain v
+00014dd0: 6572 7369 6f6e 7320 666f 7220 7468 6973  ersions for this
+00014de0: 2066 6561 7475 7265 2d76 6563 746f 722e   feature-vector.
+00014df0: 2041 6c6c 2076 6572 7369 6f6e 7320 6f66   All versions of
+00014e00: 2061 2076 6572 7369 6f6e 6564 206f 626a   a versioned obj
+00014e10: 6563 740a 2020 2020 2020 2020 2020 2020  ect.            
+00014e20: 7769 6c6c 2062 6520 6b65 7074 2069 6e20  will be kept in 
+00014e30: 7468 6520 4442 2061 6e64 2063 616e 2062  the DB and can b
+00014e40: 6520 7265 7472 6965 7665 6420 756e 7469  e retrieved unti
+00014e50: 6c20 6578 706c 6963 6974 6c79 2064 656c  l explicitly del
+00014e60: 6574 6564 2e0a 2020 2020 2020 2020 3a72  eted..        :r
+00014e70: 6574 7572 6e73 3a20 5468 6520 3a70 793a  eturns: The :py:
+00014e80: 636c 6173 733a 607e 6d6c 7275 6e2e 6665  class:`~mlrun.fe
+00014e90: 6174 7572 655f 7374 6f72 652e 4665 6174  ature_store.Feat
+00014ea0: 7572 6556 6563 746f 7260 206f 626a 6563  ureVector` objec
+00014eb0: 7420 2861 7320 6469 6374 292e 0a20 2020  t (as dict)..   
+00014ec0: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
+00014ed0: 2020 7265 6665 7265 6e63 6520 3d20 7365    reference = se
+00014ee0: 6c66 2e5f 7265 736f 6c76 655f 7265 6665  lf._resolve_refe
+00014ef0: 7265 6e63 6528 7461 672c 2075 6964 290a  rence(tag, uid).
+00014f00: 2020 2020 2020 2020 7061 7261 6d73 203d          params =
+00014f10: 207b 2276 6572 7369 6f6e 6564 223a 2076   {"versioned": v
+00014f20: 6572 7369 6f6e 6564 7d0a 0a20 2020 2020  ersioned}..     
+00014f30: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+00014f40: 2866 6561 7475 7265 5f76 6563 746f 722c  (feature_vector,
+00014f50: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
+00014f60: 6865 6d61 732e 4665 6174 7572 6556 6563  hemas.FeatureVec
+00014f70: 746f 7229 3a0a 2020 2020 2020 2020 2020  tor):.          
+00014f80: 2020 6665 6174 7572 655f 7665 6374 6f72    feature_vector
+00014f90: 203d 2066 6561 7475 7265 5f76 6563 746f   = feature_vecto
+00014fa0: 722e 6469 6374 2829 0a20 2020 2020 2020  r.dict().       
+00014fb0: 2065 6c69 6620 6973 696e 7374 616e 6365   elif isinstance
+00014fc0: 2866 6561 7475 7265 5f76 6563 746f 722c  (feature_vector,
+00014fd0: 2046 6561 7475 7265 5665 6374 6f72 293a   FeatureVector):
+00014fe0: 0a20 2020 2020 2020 2020 2020 2066 6561  .            fea
+00014ff0: 7475 7265 5f76 6563 746f 7220 3d20 6665  ture_vector = fe
+00015000: 6174 7572 655f 7665 6374 6f72 2e74 6f5f  ature_vector.to_
+00015010: 6469 6374 2829 0a0a 2020 2020 2020 2020  dict()..        
+00015020: 6e61 6d65 203d 206e 616d 6520 6f72 2066  name = name or f
+00015030: 6561 7475 7265 5f76 6563 746f 725b 226d  eature_vector["m
+00015040: 6574 6164 6174 6122 5d5b 226e 616d 6522  etadata"]["name"
+00015050: 5d0a 2020 2020 2020 2020 7072 6f6a 6563  ].        projec
+00015060: 7420 3d20 280a 2020 2020 2020 2020 2020  t = (.          
+00015070: 2020 7072 6f6a 6563 740a 2020 2020 2020    project.      
+00015080: 2020 2020 2020 6f72 2066 6561 7475 7265        or feature
+00015090: 5f76 6563 746f 725b 226d 6574 6164 6174  _vector["metadat
+000150a0: 6122 5d2e 6765 7428 2270 726f 6a65 6374  a"].get("project
+000150b0: 2229 0a20 2020 2020 2020 2020 2020 206f  ").            o
+000150c0: 7220 636f 6e66 6967 2e64 6566 6175 6c74  r config.default
+000150d0: 5f70 726f 6a65 6374 0a20 2020 2020 2020  _project.       
+000150e0: 2029 0a20 2020 2020 2020 2070 6174 6820   ).        path 
+000150f0: 3d20 6622 7072 6f6a 6563 7473 2f7b 7072  = f"projects/{pr
+00015100: 6f6a 6563 747d 2f66 6561 7475 7265 2d76  oject}/feature-v
+00015110: 6563 746f 7273 2f7b 6e61 6d65 7d2f 7265  ectors/{name}/re
+00015120: 6665 7265 6e63 6573 2f7b 7265 6665 7265  ferences/{refere
+00015130: 6e63 657d 220a 2020 2020 2020 2020 6572  nce}".        er
+00015140: 726f 725f 6d65 7373 6167 6520 3d20 6622  ror_message = f"
+00015150: 4661 696c 6564 2073 746f 7269 6e67 2066  Failed storing f
+00015160: 6561 7475 7265 2d76 6563 746f 7220 7b70  eature-vector {p
+00015170: 726f 6a65 6374 7d2f 7b6e 616d 657d 220a  roject}/{name}".
+00015180: 2020 2020 2020 2020 7265 7370 203d 2073          resp = s
+00015190: 656c 662e 6170 695f 6361 6c6c 280a 2020  elf.api_call(.  
+000151a0: 2020 2020 2020 2020 2020 2250 5554 222c            "PUT",
+000151b0: 2070 6174 682c 2065 7272 6f72 5f6d 6573   path, error_mes
+000151c0: 7361 6765 2c20 7061 7261 6d73 3d70 6172  sage, params=par
+000151d0: 616d 732c 2062 6f64 793d 6469 6374 5f74  ams, body=dict_t
+000151e0: 6f5f 6a73 6f6e 2866 6561 7475 7265 5f76  o_json(feature_v
+000151f0: 6563 746f 7229 0a20 2020 2020 2020 2029  ector).        )
+00015200: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00015210: 7265 7370 2e6a 736f 6e28 290a 0a20 2020  resp.json()..   
+00015220: 2064 6566 2070 6174 6368 5f66 6561 7475   def patch_featu
+00015230: 7265 5f76 6563 746f 7228 0a20 2020 2020  re_vector(.     
+00015240: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+00015250: 206e 616d 652c 0a20 2020 2020 2020 2066   name,.        f
+00015260: 6561 7475 7265 5f76 6563 746f 725f 7570  eature_vector_up
+00015270: 6461 7465 3a20 6469 6374 2c0a 2020 2020  date: dict,.    
+00015280: 2020 2020 7072 6f6a 6563 743d 2222 2c0a      project="",.
+00015290: 2020 2020 2020 2020 7461 673d 4e6f 6e65          tag=None
+000152a0: 2c0a 2020 2020 2020 2020 7569 643d 4e6f  ,.        uid=No
+000152b0: 6e65 2c0a 2020 2020 2020 2020 7061 7463  ne,.        patc
+000152c0: 685f 6d6f 6465 3a20 556e 696f 6e5b 0a20  h_mode: Union[. 
+000152d0: 2020 2020 2020 2020 2020 2073 7472 2c20             str, 
+000152e0: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
+000152f0: 656d 6173 2e50 6174 6368 4d6f 6465 0a20  emas.PatchMode. 
+00015300: 2020 2020 2020 205d 203d 206d 6c72 756e         ] = mlrun
+00015310: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
+00015320: 5061 7463 684d 6f64 652e 7265 706c 6163  PatchMode.replac
+00015330: 652c 0a20 2020 2029 3a0a 2020 2020 2020  e,.    ):.      
+00015340: 2020 2222 224d 6f64 6966 7920 2870 6174    """Modify (pat
+00015350: 6368 2920 616e 2065 7869 7374 696e 6720  ch) an existing 
+00015360: 3a70 793a 636c 6173 733a 607e 6d6c 7275  :py:class:`~mlru
+00015370: 6e2e 6665 6174 7572 655f 7374 6f72 652e  n.feature_store.
+00015380: 4665 6174 7572 6556 6563 746f 7260 206f  FeatureVector` o
+00015390: 626a 6563 742e 0a20 2020 2020 2020 2054  bject..        T
+000153a0: 6865 206f 626a 6563 7420 6973 2069 6465  he object is ide
+000153b0: 6e74 6966 6965 6420 6279 2069 7473 206e  ntified by its n
+000153c0: 616d 6520 2861 6e64 2070 726f 6a65 6374  ame (and project
+000153d0: 2069 7420 6265 6c6f 6e67 7320 746f 292c   it belongs to),
+000153e0: 2061 7320 7765 6c6c 2061 7320 6f70 7469   as well as opti
+000153f0: 6f6e 616c 6c79 2061 2060 6074 6167 6060  onally a ``tag``
+00015400: 206f 7220 6974 730a 2020 2020 2020 2020   or its.        
+00015410: 6060 7569 6460 6020 2866 6f72 2076 6572  ``uid`` (for ver
+00015420: 7369 6f6e 6564 206f 626a 6563 7429 2e20  sioned object). 
+00015430: 4966 2062 6f74 6820 6060 7461 6760 6020  If both ``tag`` 
+00015440: 616e 6420 6060 7569 6460 6020 6172 6520  and ``uid`` are 
+00015450: 6f6d 6974 7465 6420 7468 656e 2074 6865  omitted then the
+00015460: 206f 626a 6563 7420 7769 7468 2074 6167   object with tag
+00015470: 2060 606c 6174 6573 7460 600a 2020 2020   ``latest``.    
+00015480: 2020 2020 6973 206d 6f64 6966 6965 642e      is modified.
+00015490: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+000154a0: 206e 616d 653a 204e 616d 6520 6f66 2074   name: Name of t
+000154b0: 6865 206f 626a 6563 7420 746f 2070 6174  he object to pat
+000154c0: 6368 2e0a 2020 2020 2020 2020 3a70 6172  ch..        :par
+000154d0: 616d 2066 6561 7475 7265 5f76 6563 746f  am feature_vecto
+000154e0: 725f 7570 6461 7465 3a20 5468 6520 6d6f  r_update: The mo
+000154f0: 6469 6669 6361 7469 6f6e 7320 6e65 6564  difications need
+00015500: 6564 2069 6e20 7468 6520 6f62 6a65 6374  ed in the object
+00015510: 2e20 5468 6973 2070 6172 616d 6574 6572  . This parameter
+00015520: 206f 6e6c 7920 6861 7320 7468 6520 6368   only has the ch
+00015530: 616e 6765 7320 696e 2069 742c 0a20 2020  anges in it,.   
+00015540: 2020 2020 2020 2020 206e 6f74 2061 2066           not a f
+00015550: 756c 6c20 6f62 6a65 6374 2e0a 2020 2020  ull object..    
+00015560: 2020 2020 3a70 6172 616d 2070 726f 6a65      :param proje
+00015570: 6374 3a20 5072 6f6a 6563 7420 7768 6963  ct: Project whic
+00015580: 6820 636f 6e74 6169 6e73 2074 6865 206d  h contains the m
+00015590: 6f64 6966 6965 6420 6f62 6a65 6374 2e0a  odified object..
+000155a0: 2020 2020 2020 2020 3a70 6172 616d 2074          :param t
+000155b0: 6167 3a20 5468 6520 7461 6720 6f66 2074  ag: The tag of t
+000155c0: 6865 206f 626a 6563 7420 746f 206d 6f64  he object to mod
+000155d0: 6966 792e 0a20 2020 2020 2020 203a 7061  ify..        :pa
+000155e0: 7261 6d20 7569 643a 2075 6964 206f 6620  ram uid: uid of 
+000155f0: 7468 6520 6f62 6a65 6374 2074 6f20 6d6f  the object to mo
+00015600: 6469 6679 2e0a 2020 2020 2020 2020 3a70  dify..        :p
+00015610: 6172 616d 2070 6174 6368 5f6d 6f64 653a  aram patch_mode:
+00015620: 2054 6865 2073 7472 6174 6567 7920 666f   The strategy fo
+00015630: 7220 6d65 7267 696e 6720 7468 6520 6368  r merging the ch
+00015640: 616e 6765 7320 7769 7468 2074 6865 2065  anges with the e
+00015650: 7869 7374 696e 6720 6f62 6a65 6374 2e20  xisting object. 
+00015660: 4361 6e20 6265 2065 6974 6865 7220 6060  Can be either ``
+00015670: 7265 706c 6163 6560 600a 2020 2020 2020  replace``.      
+00015680: 2020 2020 2020 6f72 2060 6061 6464 6974        or ``addit
+00015690: 6976 6560 602e 0a20 2020 2020 2020 2022  ive``..        "
+000156a0: 2222 0a20 2020 2020 2020 2072 6566 6572  "".        refer
+000156b0: 656e 6365 203d 2073 656c 662e 5f72 6573  ence = self._res
+000156c0: 6f6c 7665 5f72 6566 6572 656e 6365 2874  olve_reference(t
+000156d0: 6167 2c20 7569 6429 0a20 2020 2020 2020  ag, uid).       
+000156e0: 2070 726f 6a65 6374 203d 2070 726f 6a65   project = proje
+000156f0: 6374 206f 7220 636f 6e66 6967 2e64 6566  ct or config.def
+00015700: 6175 6c74 5f70 726f 6a65 6374 0a20 2020  ault_project.   
+00015710: 2020 2020 2068 6561 6465 7273 203d 207b       headers = {
+00015720: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
+00015730: 656d 6173 2e48 6561 6465 724e 616d 6573  emas.HeaderNames
+00015740: 2e70 6174 6368 5f6d 6f64 653a 2070 6174  .patch_mode: pat
+00015750: 6368 5f6d 6f64 657d 0a20 2020 2020 2020  ch_mode}.       
+00015760: 2070 6174 6820 3d20 6622 7072 6f6a 6563   path = f"projec
+00015770: 7473 2f7b 7072 6f6a 6563 747d 2f66 6561  ts/{project}/fea
+00015780: 7475 7265 2d76 6563 746f 7273 2f7b 6e61  ture-vectors/{na
+00015790: 6d65 7d2f 7265 6665 7265 6e63 6573 2f7b  me}/references/{
+000157a0: 7265 6665 7265 6e63 657d 220a 2020 2020  reference}".    
+000157b0: 2020 2020 6572 726f 725f 6d65 7373 6167      error_messag
+000157c0: 6520 3d20 6622 4661 696c 6564 2075 7064  e = f"Failed upd
+000157d0: 6174 696e 6720 6665 6174 7572 652d 7665  ating feature-ve
+000157e0: 6374 6f72 207b 7072 6f6a 6563 747d 2f7b  ctor {project}/{
+000157f0: 6e61 6d65 7d22 0a20 2020 2020 2020 2073  name}".        s
+00015800: 656c 662e 6170 695f 6361 6c6c 280a 2020  elf.api_call(.  
+00015810: 2020 2020 2020 2020 2020 2250 4154 4348            "PATCH
+00015820: 222c 0a20 2020 2020 2020 2020 2020 2070  ",.            p
+00015830: 6174 682c 0a20 2020 2020 2020 2020 2020  ath,.           
+00015840: 2065 7272 6f72 5f6d 6573 7361 6765 2c0a   error_message,.
+00015850: 2020 2020 2020 2020 2020 2020 626f 6479              body
+00015860: 3d64 6963 745f 746f 5f6a 736f 6e28 6665  =dict_to_json(fe
+00015870: 6174 7572 655f 7665 6374 6f72 5f75 7064  ature_vector_upd
+00015880: 6174 6529 2c0a 2020 2020 2020 2020 2020  ate),.          
+00015890: 2020 6865 6164 6572 733d 6865 6164 6572    headers=header
+000158a0: 732c 0a20 2020 2020 2020 2029 0a0a 2020  s,.        )..  
+000158b0: 2020 6465 6620 6465 6c65 7465 5f66 6561    def delete_fea
+000158c0: 7475 7265 5f76 6563 746f 7228 7365 6c66  ture_vector(self
+000158d0: 2c20 6e61 6d65 2c20 7072 6f6a 6563 743d  , name, project=
+000158e0: 2222 2c20 7461 673d 4e6f 6e65 2c20 7569  "", tag=None, ui
+000158f0: 643d 4e6f 6e65 293a 0a20 2020 2020 2020  d=None):.       
+00015900: 2022 2222 4465 6c65 7465 2061 203a 7079   """Delete a :py
+00015910: 3a63 6c61 7373 3a60 7e6d 6c72 756e 2e66  :class:`~mlrun.f
+00015920: 6561 7475 7265 5f73 746f 7265 2e46 6561  eature_store.Fea
+00015930: 7475 7265 5665 6374 6f72 6020 6f62 6a65  tureVector` obje
+00015940: 6374 2066 726f 6d20 7468 6520 4442 2e0a  ct from the DB..
+00015950: 2020 2020 2020 2020 4966 2060 6074 6167          If ``tag
+00015960: 6060 206f 7220 6060 7569 6460 6020 6172  `` or ``uid`` ar
+00015970: 6520 7370 6563 6966 6965 642c 2074 6865  e specified, the
+00015980: 6e20 6a75 7374 2074 6865 2076 6572 7369  n just the versi
+00015990: 6f6e 2072 6566 6572 656e 6365 6420 6279  on referenced by
+000159a0: 2074 6865 6d20 7769 6c6c 2062 6520 6465   them will be de
+000159b0: 6c65 7465 642e 2055 7369 6e67 2062 6f74  leted. Using bot
+000159c0: 680a 2020 2020 2020 2020 6973 206e 6f74  h.        is not
+000159d0: 2061 6c6c 6f77 6564 2e0a 2020 2020 2020   allowed..      
+000159e0: 2020 4966 206e 6f6e 6520 6172 6520 7370    If none are sp
+000159f0: 6563 6966 6965 642c 2074 6865 6e20 616c  ecified, then al
+00015a00: 6c20 696e 7374 616e 6365 7320 6f66 2074  l instances of t
+00015a10: 6865 206f 626a 6563 7420 7768 6f73 6520  he object whose 
+00015a20: 6e61 6d65 2069 7320 6060 6e61 6d65 6060  name is ``name``
+00015a30: 2077 696c 6c20 6265 2064 656c 6574 6564   will be deleted
+00015a40: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+00015a50: 2020 2020 2020 7072 6f6a 6563 7420 3d20        project = 
+00015a60: 7072 6f6a 6563 7420 6f72 2063 6f6e 6669  project or confi
+00015a70: 672e 6465 6661 756c 745f 7072 6f6a 6563  g.default_projec
+00015a80: 740a 2020 2020 2020 2020 7061 7468 203d  t.        path =
+00015a90: 2066 2270 726f 6a65 6374 732f 7b70 726f   f"projects/{pro
+00015aa0: 6a65 6374 7d2f 6665 6174 7572 652d 7665  ject}/feature-ve
+00015ab0: 6374 6f72 732f 7b6e 616d 657d 220a 2020  ctors/{name}".  
+00015ac0: 2020 2020 2020 6966 2074 6167 206f 7220        if tag or 
+00015ad0: 7569 643a 0a20 2020 2020 2020 2020 2020  uid:.           
+00015ae0: 2072 6566 6572 656e 6365 203d 2073 656c   reference = sel
+00015af0: 662e 5f72 6573 6f6c 7665 5f72 6566 6572  f._resolve_refer
+00015b00: 656e 6365 2874 6167 2c20 7569 6429 0a20  ence(tag, uid). 
+00015b10: 2020 2020 2020 2020 2020 2070 6174 6820             path 
+00015b20: 3d20 7061 7468 202b 2066 222f 7265 6665  = path + f"/refe
+00015b30: 7265 6e63 6573 2f7b 7265 6665 7265 6e63  rences/{referenc
+00015b40: 657d 220a 0a20 2020 2020 2020 2065 7272  e}"..        err
+00015b50: 6f72 5f6d 6573 7361 6765 203d 2066 2246  or_message = f"F
+00015b60: 6169 6c65 6420 6465 6c65 7469 6e67 2066  ailed deleting f
+00015b70: 6561 7475 7265 2d76 6563 746f 7220 7b6e  eature-vector {n
+00015b80: 616d 657d 220a 2020 2020 2020 2020 7365  ame}".        se
+00015b90: 6c66 2e61 7069 5f63 616c 6c28 2244 454c  lf.api_call("DEL
+00015ba0: 4554 4522 2c20 7061 7468 2c20 6572 726f  ETE", path, erro
+00015bb0: 725f 6d65 7373 6167 6529 0a0a 2020 2020  r_message)..    
+00015bc0: 6465 6620 7461 675f 6f62 6a65 6374 7328  def tag_objects(
+00015bd0: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+00015be0: 2020 2020 2020 2070 726f 6a65 6374 3a20         project: 
+00015bf0: 7374 722c 0a20 2020 2020 2020 2074 6167  str,.        tag
+00015c00: 5f6e 616d 653a 2073 7472 2c0a 2020 2020  _name: str,.    
+00015c10: 2020 2020 6f62 6a65 6374 733a 2055 6e69      objects: Uni
+00015c20: 6f6e 5b6d 6c72 756e 2e63 6f6d 6d6f 6e2e  on[mlrun.common.
+00015c30: 7363 6865 6d61 732e 5461 674f 626a 6563  schemas.TagObjec
+00015c40: 7473 2c20 6469 6374 5d2c 0a20 2020 2020  ts, dict],.     
+00015c50: 2020 2072 6570 6c61 6365 3a20 626f 6f6c     replace: bool
+00015c60: 203d 2046 616c 7365 2c0a 2020 2020 293a   = False,.    ):
+00015c70: 0a20 2020 2020 2020 2022 2222 5461 6720  .        """Tag 
+00015c80: 6120 6c69 7374 206f 6620 6f62 6a65 6374  a list of object
+00015c90: 732e 0a0a 2020 2020 2020 2020 3a70 6172  s...        :par
+00015ca0: 616d 2070 726f 6a65 6374 3a20 5072 6f6a  am project: Proj
+00015cb0: 6563 7420 7768 6963 6820 636f 6e74 6169  ect which contai
+00015cc0: 6e73 2074 6865 206f 626a 6563 7473 2e0a  ns the objects..
+00015cd0: 2020 2020 2020 2020 3a70 6172 616d 2074          :param t
+00015ce0: 6167 5f6e 616d 653a 2054 6865 2074 6167  ag_name: The tag
+00015cf0: 2074 6f20 7365 7420 6f6e 2074 6865 206f   to set on the o
+00015d00: 626a 6563 7473 2e0a 2020 2020 2020 2020  bjects..        
+00015d10: 3a70 6172 616d 206f 626a 6563 7473 3a20  :param objects: 
+00015d20: 5468 6520 6f62 6a65 6374 7320 746f 2074  The objects to t
+00015d30: 6167 2e0a 2020 2020 2020 2020 3a70 6172  ag..        :par
+00015d40: 616d 2072 6570 6c61 6365 3a20 5768 6574  am replace: Whet
+00015d50: 6865 7220 746f 2072 6570 6c61 6365 2074  her to replace t
+00015d60: 6865 2065 7869 7374 696e 6720 7461 6773  he existing tags
+00015d70: 206f 6620 7468 6520 6f62 6a65 6374 7320   of the objects 
+00015d80: 6f72 2074 6f20 6164 6420 7468 6520 6e65  or to add the ne
+00015d90: 7720 7461 6720 746f 2074 6865 6d2e 0a20  w tag to them.. 
+00015da0: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
+00015db0: 2020 2020 7061 7468 203d 2066 2270 726f      path = f"pro
+00015dc0: 6a65 6374 732f 7b70 726f 6a65 6374 7d2f  jects/{project}/
+00015dd0: 7461 6773 2f7b 7461 675f 6e61 6d65 7d22  tags/{tag_name}"
+00015de0: 0a20 2020 2020 2020 2065 7272 6f72 5f6d  .        error_m
+00015df0: 6573 7361 6765 203d 2066 2246 6169 6c65  essage = f"Faile
+00015e00: 6420 746f 2074 6167 207b 7461 675f 6e61  d to tag {tag_na
+00015e10: 6d65 7d20 6f6e 206f 626a 6563 7473 207b  me} on objects {
+00015e20: 6f62 6a65 6374 737d 220a 2020 2020 2020  objects}".      
+00015e30: 2020 6d65 7468 6f64 203d 2022 504f 5354    method = "POST
+00015e40: 2220 6966 2072 6570 6c61 6365 2065 6c73  " if replace els
+00015e50: 6520 2250 5554 220a 2020 2020 2020 2020  e "PUT".        
+00015e60: 7365 6c66 2e61 7069 5f63 616c 6c28 0a20  self.api_call(. 
+00015e70: 2020 2020 2020 2020 2020 206d 6574 686f             metho
+00015e80: 642c 0a20 2020 2020 2020 2020 2020 2070  d,.            p
+00015e90: 6174 682c 0a20 2020 2020 2020 2020 2020  ath,.           
+00015ea0: 2065 7272 6f72 5f6d 6573 7361 6765 2c0a   error_message,.
+00015eb0: 2020 2020 2020 2020 2020 2020 626f 6479              body
+00015ec0: 3d64 6963 745f 746f 5f6a 736f 6e28 0a20  =dict_to_json(. 
+00015ed0: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+00015ee0: 626a 6563 7473 2e64 6963 7428 290a 2020  bjects.dict().  
+00015ef0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00015f00: 2069 7369 6e73 7461 6e63 6528 6f62 6a65   isinstance(obje
+00015f10: 6374 732c 206d 6c72 756e 2e63 6f6d 6d6f  cts, mlrun.commo
+00015f20: 6e2e 7363 6865 6d61 732e 5461 674f 626a  n.schemas.TagObj
+00015f30: 6563 7473 290a 2020 2020 2020 2020 2020  ects).          
+00015f40: 2020 2020 2020 656c 7365 206f 626a 6563        else objec
+00015f50: 7473 0a20 2020 2020 2020 2020 2020 2029  ts.            )
+00015f60: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
+00015f70: 2064 6566 2064 656c 6574 655f 6f62 6a65   def delete_obje
+00015f80: 6374 735f 7461 6728 0a20 2020 2020 2020  cts_tag(.       
+00015f90: 2073 656c 662c 0a20 2020 2020 2020 2070   self,.        p
+00015fa0: 726f 6a65 6374 3a20 7374 722c 0a20 2020  roject: str,.   
+00015fb0: 2020 2020 2074 6167 5f6e 616d 653a 2073       tag_name: s
+00015fc0: 7472 2c0a 2020 2020 2020 2020 7461 675f  tr,.        tag_
+00015fd0: 6f62 6a65 6374 733a 2055 6e69 6f6e 5b6d  objects: Union[m
+00015fe0: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
+00015ff0: 6d61 732e 5461 674f 626a 6563 7473 2c20  mas.TagObjects, 
+00016000: 6469 6374 5d2c 0a20 2020 2029 3a0a 2020  dict],.    ):.  
+00016010: 2020 2020 2020 2222 2244 656c 6574 6520        """Delete 
+00016020: 6120 7461 6720 6672 6f6d 2061 206c 6973  a tag from a lis
+00016030: 7420 6f66 206f 626a 6563 7473 2e0a 0a20  t of objects... 
+00016040: 2020 2020 2020 203a 7061 7261 6d20 7072         :param pr
+00016050: 6f6a 6563 743a 2050 726f 6a65 6374 2077  oject: Project w
+00016060: 6869 6368 2063 6f6e 7461 696e 7320 7468  hich contains th
+00016070: 6520 6f62 6a65 6374 732e 0a20 2020 2020  e objects..     
+00016080: 2020 203a 7061 7261 6d20 7461 675f 6e61     :param tag_na
+00016090: 6d65 3a20 5468 6520 7461 6720 746f 2064  me: The tag to d
+000160a0: 656c 6574 6520 6672 6f6d 2074 6865 206f  elete from the o
+000160b0: 626a 6563 7473 2e0a 2020 2020 2020 2020  bjects..        
+000160c0: 3a70 6172 616d 2074 6167 5f6f 626a 6563  :param tag_objec
+000160d0: 7473 3a20 5468 6520 6f62 6a65 6374 7320  ts: The objects 
+000160e0: 746f 2064 656c 6574 6520 7468 6520 7461  to delete the ta
+000160f0: 6720 6672 6f6d 2e0a 0a20 2020 2020 2020  g from...       
+00016100: 2022 2222 0a20 2020 2020 2020 2070 6174   """.        pat
+00016110: 6820 3d20 6622 7072 6f6a 6563 7473 2f7b  h = f"projects/{
+00016120: 7072 6f6a 6563 747d 2f74 6167 732f 7b74  project}/tags/{t
+00016130: 6167 5f6e 616d 657d 220a 2020 2020 2020  ag_name}".      
+00016140: 2020 6572 726f 725f 6d65 7373 6167 6520    error_message 
+00016150: 3d20 6622 4661 696c 6564 2064 656c 6574  = f"Failed delet
+00016160: 696e 6720 7461 6720 6672 6f6d 207b 7461  ing tag from {ta
+00016170: 675f 6e61 6d65 7d22 0a20 2020 2020 2020  g_name}".       
+00016180: 2073 656c 662e 6170 695f 6361 6c6c 280a   self.api_call(.
+00016190: 2020 2020 2020 2020 2020 2020 2244 454c              "DEL
+000161a0: 4554 4522 2c0a 2020 2020 2020 2020 2020  ETE",.          
+000161b0: 2020 7061 7468 2c0a 2020 2020 2020 2020    path,.        
+000161c0: 2020 2020 6572 726f 725f 6d65 7373 6167      error_messag
+000161d0: 652c 0a20 2020 2020 2020 2020 2020 2062  e,.            b
+000161e0: 6f64 793d 6469 6374 5f74 6f5f 6a73 6f6e  ody=dict_to_json
+000161f0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00016200: 2020 7461 675f 6f62 6a65 6374 732e 6469    tag_objects.di
+00016210: 6374 2829 0a20 2020 2020 2020 2020 2020  ct().           
+00016220: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+00016230: 6365 2874 6167 5f6f 626a 6563 7473 2c20  ce(tag_objects, 
+00016240: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
+00016250: 656d 6173 2e54 6167 4f62 6a65 6374 7329  emas.TagObjects)
+00016260: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00016270: 2065 6c73 6520 7461 675f 6f62 6a65 6374   else tag_object
+00016280: 730a 2020 2020 2020 2020 2020 2020 292c  s.            ),
+00016290: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+000162a0: 6465 6620 7461 675f 6172 7469 6661 6374  def tag_artifact
+000162b0: 7328 0a20 2020 2020 2020 2073 656c 662c  s(.        self,
+000162c0: 0a20 2020 2020 2020 2061 7274 6966 6163  .        artifac
+000162d0: 7473 3a20 556e 696f 6e5b 4c69 7374 5b41  ts: Union[List[A
+000162e0: 7274 6966 6163 745d 2c20 4c69 7374 5b64  rtifact], List[d
+000162f0: 6963 745d 2c20 4172 7469 6661 6374 2c20  ict], Artifact, 
+00016300: 6469 6374 5d2c 0a20 2020 2020 2020 2070  dict],.        p
+00016310: 726f 6a65 6374 3a20 7374 722c 0a20 2020  roject: str,.   
+00016320: 2020 2020 2074 6167 5f6e 616d 653a 2073       tag_name: s
+00016330: 7472 2c0a 2020 2020 2020 2020 7265 706c  tr,.        repl
+00016340: 6163 653a 2062 6f6f 6c20 3d20 4661 6c73  ace: bool = Fals
+00016350: 652c 0a20 2020 2029 3a0a 2020 2020 2020  e,.    ):.      
+00016360: 2020 2222 2254 6167 2061 206c 6973 7420    """Tag a list 
+00016370: 6f66 2061 7274 6966 6163 7473 2e0a 0a20  of artifacts... 
+00016380: 2020 2020 2020 203a 7061 7261 6d20 6172         :param ar
+00016390: 7469 6661 6374 733a 2054 6865 2061 7274  tifacts: The art
+000163a0: 6966 6163 7473 2074 6f20 7461 672e 2043  ifacts to tag. C
+000163b0: 616e 2062 6520 6120 6c69 7374 206f 6620  an be a list of 
+000163c0: 3a70 793a 636c 6173 733a 607e 6d6c 7275  :py:class:`~mlru
+000163d0: 6e2e 6172 7469 6661 6374 732e 4172 7469  n.artifacts.Arti
+000163e0: 6661 6374 6020 6f62 6a65 6374 7320 6f72  fact` objects or
+000163f0: 0a20 2020 2020 2020 2020 2020 2064 6963  .            dic
+00016400: 7469 6f6e 6172 6965 732c 206f 7220 6120  tionaries, or a 
+00016410: 7369 6e67 6c65 206f 626a 6563 742e 0a20  single object.. 
+00016420: 2020 2020 2020 203a 7061 7261 6d20 7072         :param pr
+00016430: 6f6a 6563 743a 2050 726f 6a65 6374 2077  oject: Project w
+00016440: 6869 6368 2063 6f6e 7461 696e 7320 7468  hich contains th
+00016450: 6520 6172 7469 6661 6374 732e 0a20 2020  e artifacts..   
+00016460: 2020 2020 203a 7061 7261 6d20 7461 675f       :param tag_
+00016470: 6e61 6d65 3a20 5468 6520 7461 6720 746f  name: The tag to
+00016480: 2073 6574 206f 6e20 7468 6520 6172 7469   set on the arti
+00016490: 6661 6374 732e 0a20 2020 2020 2020 203a  facts..        :
+000164a0: 7061 7261 6d20 7265 706c 6163 653a 2049  param replace: I
+000164b0: 6620 5472 7565 2c20 7265 706c 6163 6520  f True, replace 
+000164c0: 6578 6973 7469 6e67 2074 6167 732c 206f  existing tags, o
+000164d0: 7468 6572 7769 7365 2061 7070 656e 6420  therwise append 
+000164e0: 746f 2065 7869 7374 696e 6720 7461 6773  to existing tags
+000164f0: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+00016500: 2020 2020 2020 7461 675f 6f62 6a65 6374        tag_object
+00016510: 7320 3d20 7365 6c66 2e5f 7265 736f 6c76  s = self._resolv
+00016520: 655f 6172 7469 6661 6374 735f 746f 5f74  e_artifacts_to_t
+00016530: 6167 5f6f 626a 6563 7473 2861 7274 6966  ag_objects(artif
+00016540: 6163 7473 290a 2020 2020 2020 2020 7365  acts).        se
+00016550: 6c66 2e74 6167 5f6f 626a 6563 7473 2870  lf.tag_objects(p
+00016560: 726f 6a65 6374 2c20 7461 675f 6e61 6d65  roject, tag_name
+00016570: 2c20 6f62 6a65 6374 733d 7461 675f 6f62  , objects=tag_ob
+00016580: 6a65 6374 732c 2072 6570 6c61 6365 3d72  jects, replace=r
+00016590: 6570 6c61 6365 290a 0a20 2020 2064 6566  eplace)..    def
+000165a0: 2064 656c 6574 655f 6172 7469 6661 6374   delete_artifact
+000165b0: 735f 7461 6773 280a 2020 2020 2020 2020  s_tags(.        
+000165c0: 7365 6c66 2c0a 2020 2020 2020 2020 6172  self,.        ar
+000165d0: 7469 6661 6374 732c 0a20 2020 2020 2020  tifacts,.       
+000165e0: 2070 726f 6a65 6374 3a20 7374 722c 0a20   project: str,. 
+000165f0: 2020 2020 2020 2074 6167 5f6e 616d 653a         tag_name:
+00016600: 2073 7472 2c0a 2020 2020 293a 0a20 2020   str,.    ):.   
+00016610: 2020 2020 2022 2222 4465 6c65 7465 2074       """Delete t
+00016620: 6167 2066 726f 6d20 6120 6c69 7374 206f  ag from a list o
+00016630: 6620 6172 7469 6661 6374 732e 0a0a 2020  f artifacts...  
+00016640: 2020 2020 2020 3a70 6172 616d 2061 7274        :param art
+00016650: 6966 6163 7473 3a20 5468 6520 6172 7469  ifacts: The arti
+00016660: 6661 6374 7320 746f 2064 656c 6574 6520  facts to delete 
+00016670: 7468 6520 7461 6720 6672 6f6d 2e20 4361  the tag from. Ca
+00016680: 6e20 6265 2061 206c 6973 7420 6f66 203a  n be a list of :
+00016690: 7079 3a63 6c61 7373 3a60 7e6d 6c72 756e  py:class:`~mlrun
+000166a0: 2e61 7274 6966 6163 7473 2e41 7274 6966  .artifacts.Artif
+000166b0: 6163 7460 0a20 2020 2020 2020 2020 2020  act`.           
+000166c0: 206f 626a 6563 7473 206f 7220 6469 6374   objects or dict
+000166d0: 696f 6e61 7269 6573 2c20 6f72 2061 2073  ionaries, or a s
+000166e0: 696e 676c 6520 6f62 6a65 6374 2e0a 2020  ingle object..  
+000166f0: 2020 2020 2020 3a70 6172 616d 2070 726f        :param pro
+00016700: 6a65 6374 3a20 5072 6f6a 6563 7420 7768  ject: Project wh
+00016710: 6963 6820 636f 6e74 6169 6e73 2074 6865  ich contains the
+00016720: 2061 7274 6966 6163 7473 2e0a 2020 2020   artifacts..    
+00016730: 2020 2020 3a70 6172 616d 2074 6167 5f6e      :param tag_n
+00016740: 616d 653a 2054 6865 2074 6167 2074 6f20  ame: The tag to 
+00016750: 7365 7420 6f6e 2074 6865 2061 7274 6966  set on the artif
+00016760: 6163 7473 2e0a 2020 2020 2020 2020 2222  acts..        ""
+00016770: 220a 2020 2020 2020 2020 7461 675f 6f62  ".        tag_ob
+00016780: 6a65 6374 7320 3d20 7365 6c66 2e5f 7265  jects = self._re
+00016790: 736f 6c76 655f 6172 7469 6661 6374 735f  solve_artifacts_
+000167a0: 746f 5f74 6167 5f6f 626a 6563 7473 2861  to_tag_objects(a
+000167b0: 7274 6966 6163 7473 290a 2020 2020 2020  rtifacts).      
+000167c0: 2020 7365 6c66 2e64 656c 6574 655f 6f62    self.delete_ob
+000167d0: 6a65 6374 735f 7461 6728 7072 6f6a 6563  jects_tag(projec
+000167e0: 742c 2074 6167 5f6e 616d 652c 2074 6167  t, tag_name, tag
+000167f0: 5f6f 626a 6563 7473 290a 0a20 2020 2064  _objects)..    d
+00016800: 6566 206c 6973 745f 7072 6f6a 6563 7473  ef list_projects
+00016810: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+00016820: 2020 2020 2020 2020 6f77 6e65 723a 2073          owner: s
+00016830: 7472 203d 204e 6f6e 652c 0a20 2020 2020  tr = None,.     
+00016840: 2020 2066 6f72 6d61 745f 3a20 556e 696f     format_: Unio
+00016850: 6e5b 0a20 2020 2020 2020 2020 2020 2073  n[.            s
+00016860: 7472 2c20 6d6c 7275 6e2e 636f 6d6d 6f6e  tr, mlrun.common
+00016870: 2e73 6368 656d 6173 2e50 726f 6a65 6374  .schemas.Project
+00016880: 7346 6f72 6d61 740a 2020 2020 2020 2020  sFormat.        
+00016890: 5d20 3d20 6d6c 7275 6e2e 636f 6d6d 6f6e  ] = mlrun.common
+000168a0: 2e73 6368 656d 6173 2e50 726f 6a65 6374  .schemas.Project
+000168b0: 7346 6f72 6d61 742e 6675 6c6c 2c0a 2020  sFormat.full,.  
+000168c0: 2020 2020 2020 6c61 6265 6c73 3a20 4c69        labels: Li
+000168d0: 7374 5b73 7472 5d20 3d20 4e6f 6e65 2c0a  st[str] = None,.
+000168e0: 2020 2020 2020 2020 7374 6174 653a 2055          state: U
+000168f0: 6e69 6f6e 5b73 7472 2c20 6d6c 7275 6e2e  nion[str, mlrun.
+00016900: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e50  common.schemas.P
+00016910: 726f 6a65 6374 5374 6174 655d 203d 204e  rojectState] = N
+00016920: 6f6e 652c 0a20 2020 2029 202d 3e20 4c69  one,.    ) -> Li
+00016930: 7374 5b55 6e69 6f6e 5b6d 6c72 756e 2e70  st[Union[mlrun.p
+00016940: 726f 6a65 6374 732e 4d6c 7275 6e50 726f  rojects.MlrunPro
+00016950: 6a65 6374 2c20 7374 725d 5d3a 0a20 2020  ject, str]]:.   
+00016960: 2020 2020 2022 2222 5265 7475 726e 2061       """Return a
+00016970: 206c 6973 7420 6f66 2074 6865 2065 7869   list of the exi
+00016980: 7374 696e 6720 7072 6f6a 6563 7473 2c20  sting projects, 
+00016990: 706f 7465 6e74 6961 6c6c 7920 6669 6c74  potentially filt
+000169a0: 6572 6564 2062 7920 7370 6563 6966 6963  ered by specific
+000169b0: 2063 7269 7465 7269 612e 0a0a 2020 2020   criteria...    
+000169c0: 2020 2020 3a70 6172 616d 206f 776e 6572      :param owner
+000169d0: 3a20 4c69 7374 206f 6e6c 7920 7072 6f6a  : List only proj
+000169e0: 6563 7473 2062 656c 6f6e 6769 6e67 2074  ects belonging t
+000169f0: 6f20 7468 6973 2073 7065 6369 6669 6320  o this specific 
+00016a00: 6f77 6e65 722e 0a20 2020 2020 2020 203a  owner..        :
+00016a10: 7061 7261 6d20 666f 726d 6174 5f3a 2046  param format_: F
+00016a20: 6f72 6d61 7420 6f66 2074 6865 2072 6573  ormat of the res
+00016a30: 756c 7473 2e20 506f 7373 6962 6c65 2076  ults. Possible v
+00016a40: 616c 7565 7320 6172 653a 0a0a 2020 2020  alues are:..    
+00016a50: 2020 2020 2020 2020 2d20 6060 6675 6c6c          - ``full
+00016a60: 6060 2028 6465 6661 756c 7420 7661 6c75  `` (default valu
+00016a70: 6529 202d 2052 6574 7572 6e20 6675 6c6c  e) - Return full
+00016a80: 2070 726f 6a65 6374 206f 626a 6563 7473   project objects
+00016a90: 2e0a 2020 2020 2020 2020 2020 2020 2d20  ..            - 
+00016aa0: 6060 6d69 6e69 6d61 6c60 6020 2d20 5265  ``minimal`` - Re
+00016ab0: 7475 726e 206d 696e 696d 616c 2070 726f  turn minimal pro
+00016ac0: 6a65 6374 206f 626a 6563 7473 2028 6d69  ject objects (mi
+00016ad0: 6e69 6d69 7a61 7469 6f6e 2068 6170 7065  nimization happe
+00016ae0: 6e73 2069 6e20 7468 6520 4245 292e 0a20  ns in the BE).. 
+00016af0: 2020 2020 2020 2020 2020 202d 2060 606e             - ``n
+00016b00: 616d 655f 6f6e 6c79 6060 202d 2052 6574  ame_only`` - Ret
+00016b10: 7572 6e20 6a75 7374 2074 6865 206e 616d  urn just the nam
+00016b20: 6573 206f 6620 7468 6520 7072 6f6a 6563  es of the projec
+00016b30: 7473 2e0a 0a20 2020 2020 2020 203a 7061  ts...        :pa
+00016b40: 7261 6d20 6c61 6265 6c73 3a20 4669 6c74  ram labels: Filt
+00016b50: 6572 2062 7920 6c61 6265 6c73 2061 7474  er by labels att
+00016b60: 6163 6865 6420 746f 2074 6865 2070 726f  ached to the pro
+00016b70: 6a65 6374 2e0a 2020 2020 2020 2020 3a70  ject..        :p
+00016b80: 6172 616d 2073 7461 7465 3a20 4669 6c74  aram state: Filt
+00016b90: 6572 2062 7920 7072 6f6a 6563 7427 7320  er by project's 
+00016ba0: 7374 6174 652e 2043 616e 2062 6520 6569  state. Can be ei
+00016bb0: 7468 6572 2060 606f 6e6c 696e 6560 6020  ther ``online`` 
+00016bc0: 6f72 2060 6061 7263 6869 7665 6460 602e  or ``archived``.
+00016bd0: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
+00016be0: 2020 2020 2020 7061 7261 6d73 203d 207b        params = {
+00016bf0: 0a20 2020 2020 2020 2020 2020 2022 6f77  .            "ow
+00016c00: 6e65 7222 3a20 6f77 6e65 722c 0a20 2020  ner": owner,.   
+00016c10: 2020 2020 2020 2020 2022 7374 6174 6522           "state"
+00016c20: 3a20 7374 6174 652c 0a20 2020 2020 2020  : state,.       
+00016c30: 2020 2020 2022 666f 726d 6174 223a 2066       "format": f
+00016c40: 6f72 6d61 745f 2c0a 2020 2020 2020 2020  ormat_,.        
+00016c50: 2020 2020 226c 6162 656c 223a 206c 6162      "label": lab
+00016c60: 656c 7320 6f72 205b 5d2c 0a20 2020 2020  els or [],.     
+00016c70: 2020 207d 0a0a 2020 2020 2020 2020 6572     }..        er
+00016c80: 726f 725f 6d65 7373 6167 6520 3d20 6622  ror_message = f"
+00016c90: 4661 696c 6564 206c 6973 7469 6e67 2070  Failed listing p
+00016ca0: 726f 6a65 6374 732c 2071 7565 7279 3a20  rojects, query: 
+00016cb0: 7b70 6172 616d 737d 220a 2020 2020 2020  {params}".      
+00016cc0: 2020 7265 7370 6f6e 7365 203d 2073 656c    response = sel
+00016cd0: 662e 6170 695f 6361 6c6c 2822 4745 5422  f.api_call("GET"
+00016ce0: 2c20 2270 726f 6a65 6374 7322 2c20 6572  , "projects", er
+00016cf0: 726f 725f 6d65 7373 6167 652c 2070 6172  ror_message, par
+00016d00: 616d 733d 7061 7261 6d73 290a 2020 2020  ams=params).    
+00016d10: 2020 2020 6966 2066 6f72 6d61 745f 203d      if format_ =
+00016d20: 3d20 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  = mlrun.common.s
+00016d30: 6368 656d 6173 2e50 726f 6a65 6374 7346  chemas.ProjectsF
+00016d40: 6f72 6d61 742e 6e61 6d65 5f6f 6e6c 793a  ormat.name_only:
+00016d50: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00016d60: 7572 6e20 7265 7370 6f6e 7365 2e6a 736f  urn response.jso
+00016d70: 6e28 295b 2270 726f 6a65 6374 7322 5d0a  n()["projects"].
+00016d80: 2020 2020 2020 2020 656c 6966 2066 6f72          elif for
+00016d90: 6d61 745f 2069 6e20 5b0a 2020 2020 2020  mat_ in [.      
+00016da0: 2020 2020 2020 6d6c 7275 6e2e 636f 6d6d        mlrun.comm
+00016db0: 6f6e 2e73 6368 656d 6173 2e50 726f 6a65  on.schemas.Proje
+00016dc0: 6374 7346 6f72 6d61 742e 6675 6c6c 2c0a  ctsFormat.full,.
+00016dd0: 2020 2020 2020 2020 2020 2020 6d6c 7275              mlru
+00016de0: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
+00016df0: 2e50 726f 6a65 6374 7346 6f72 6d61 742e  .ProjectsFormat.
+00016e00: 6d69 6e69 6d61 6c2c 0a20 2020 2020 2020  minimal,.       
+00016e10: 205d 3a0a 2020 2020 2020 2020 2020 2020   ]:.            
+00016e20: 7265 7475 726e 205b 0a20 2020 2020 2020  return [.       
+00016e30: 2020 2020 2020 2020 206d 6c72 756e 2e70           mlrun.p
+00016e40: 726f 6a65 6374 732e 4d6c 7275 6e50 726f  rojects.MlrunPro
+00016e50: 6a65 6374 2e66 726f 6d5f 6469 6374 2870  ject.from_dict(p
+00016e60: 726f 6a65 6374 5f64 6963 7429 0a20 2020  roject_dict).   
+00016e70: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+00016e80: 2070 726f 6a65 6374 5f64 6963 7420 696e   project_dict in
+00016e90: 2072 6573 706f 6e73 652e 6a73 6f6e 2829   response.json()
+00016ea0: 5b22 7072 6f6a 6563 7473 225d 0a20 2020  ["projects"].   
+00016eb0: 2020 2020 2020 2020 205d 0a20 2020 2020           ].     
+00016ec0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00016ed0: 2020 2020 2072 6169 7365 204e 6f74 496d       raise NotIm
+00016ee0: 706c 656d 656e 7465 6445 7272 6f72 280a  plementedError(.
+00016ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016f00: 6622 5072 6f76 6964 6564 2066 6f72 6d61  f"Provided forma
+00016f10: 7420 6973 206e 6f74 2073 7570 706f 7274  t is not support
+00016f20: 6564 2e20 666f 726d 6174 3d7b 666f 726d  ed. format={form
+00016f30: 6174 5f7d 220a 2020 2020 2020 2020 2020  at_}".          
+00016f40: 2020 290a 0a20 2020 2064 6566 2067 6574    )..    def get
+00016f50: 5f70 726f 6a65 6374 2873 656c 662c 206e  _project(self, n
+00016f60: 616d 653a 2073 7472 2920 2d3e 206d 6c72  ame: str) -> mlr
+00016f70: 756e 2e70 726f 6a65 6374 732e 4d6c 7275  un.projects.Mlru
+00016f80: 6e50 726f 6a65 6374 3a0a 2020 2020 2020  nProject:.      
+00016f90: 2020 2222 2247 6574 2064 6574 6169 6c73    """Get details
+00016fa0: 2066 6f72 2061 2073 7065 6369 6669 6320   for a specific 
+00016fb0: 7072 6f6a 6563 742e 2222 220a 0a20 2020  project."""..   
+00016fc0: 2020 2020 2069 6620 6e6f 7420 6e61 6d65       if not name
+00016fd0: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+00016fe0: 6973 6520 4d4c 5275 6e49 6e76 616c 6964  ise MLRunInvalid
+00016ff0: 4172 6775 6d65 6e74 4572 726f 7228 224e  ArgumentError("N
+00017000: 616d 6520 6d75 7374 2062 6520 7072 6f76  ame must be prov
+00017010: 6964 6564 2229 0a0a 2020 2020 2020 2020  ided")..        
+00017020: 7061 7468 203d 2066 2270 726f 6a65 6374  path = f"project
+00017030: 732f 7b6e 616d 657d 220a 2020 2020 2020  s/{name}".      
+00017040: 2020 6572 726f 725f 6d65 7373 6167 6520    error_message 
+00017050: 3d20 6622 4661 696c 6564 2072 6574 7269  = f"Failed retri
+00017060: 6576 696e 6720 7072 6f6a 6563 7420 7b6e  eving project {n
+00017070: 616d 657d 220a 2020 2020 2020 2020 7265  ame}".        re
+00017080: 7370 6f6e 7365 203d 2073 656c 662e 6170  sponse = self.ap
+00017090: 695f 6361 6c6c 2822 4745 5422 2c20 7061  i_call("GET", pa
+000170a0: 7468 2c20 6572 726f 725f 6d65 7373 6167  th, error_messag
+000170b0: 6529 0a20 2020 2020 2020 2072 6574 7572  e).        retur
+000170c0: 6e20 6d6c 7275 6e2e 7072 6f6a 6563 7473  n mlrun.projects
+000170d0: 2e4d 6c72 756e 5072 6f6a 6563 742e 6672  .MlrunProject.fr
+000170e0: 6f6d 5f64 6963 7428 7265 7370 6f6e 7365  om_dict(response
+000170f0: 2e6a 736f 6e28 2929 0a0a 2020 2020 6465  .json())..    de
+00017100: 6620 6465 6c65 7465 5f70 726f 6a65 6374  f delete_project
+00017110: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+00017120: 2020 2020 2020 2020 6e61 6d65 3a20 7374          name: st
+00017130: 722c 0a20 2020 2020 2020 2064 656c 6574  r,.        delet
+00017140: 696f 6e5f 7374 7261 7465 6779 3a20 556e  ion_strategy: Un
+00017150: 696f 6e5b 0a20 2020 2020 2020 2020 2020  ion[.           
+00017160: 2073 7472 2c20 6d6c 7275 6e2e 636f 6d6d   str, mlrun.comm
+00017170: 6f6e 2e73 6368 656d 6173 2e44 656c 6574  on.schemas.Delet
+00017180: 696f 6e53 7472 6174 6567 790a 2020 2020  ionStrategy.    
+00017190: 2020 2020 5d20 3d20 6d6c 7275 6e2e 636f      ] = mlrun.co
+000171a0: 6d6d 6f6e 2e73 6368 656d 6173 2e44 656c  mmon.schemas.Del
+000171b0: 6574 696f 6e53 7472 6174 6567 792e 6465  etionStrategy.de
+000171c0: 6661 756c 7428 292c 0a20 2020 2029 3a0a  fault(),.    ):.
+000171d0: 2020 2020 2020 2020 2222 2244 656c 6574          """Delet
+000171e0: 6520 6120 7072 6f6a 6563 742e 0a0a 2020  e a project...  
+000171f0: 2020 2020 2020 3a70 6172 616d 206e 616d        :param nam
+00017200: 653a 204e 616d 6520 6f66 2074 6865 2070  e: Name of the p
+00017210: 726f 6a65 6374 2074 6f20 6465 6c65 7465  roject to delete
+00017220: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00017230: 2064 656c 6574 696f 6e5f 7374 7261 7465   deletion_strate
+00017240: 6779 3a20 486f 7720 746f 2074 7265 6174  gy: How to treat
+00017250: 2063 6869 6c64 206f 626a 6563 7473 206f   child objects o
+00017260: 6620 7468 6520 7072 6f6a 6563 742e 2050  f the project. P
+00017270: 6f73 7369 626c 6520 7661 6c75 6573 2061  ossible values a
+00017280: 7265 3a0a 0a20 2020 2020 2020 2020 2020  re:..           
+00017290: 202d 2060 6072 6573 7472 6963 7460 6020   - ``restrict`` 
+000172a0: 2864 6566 6175 6c74 2920 2d20 5072 6f6a  (default) - Proj
+000172b0: 6563 7420 6d75 7374 206e 6f74 2068 6176  ect must not hav
+000172c0: 6520 616e 7920 6368 696c 6420 6f62 6a65  e any child obje
+000172d0: 6374 7320 7768 656e 2064 656c 6574 6564  cts when deleted
+000172e0: 2e20 4966 2075 7369 6e67 2074 6869 7320  . If using this 
+000172f0: 6d6f 6465 2077 6869 6c65 0a20 2020 2020  mode while.     
+00017300: 2020 2020 2020 2020 2063 6869 6c64 206f           child o
+00017310: 626a 6563 7473 2065 7869 7374 2c20 7468  bjects exist, th
+00017320: 6520 6f70 6572 6174 696f 6e20 7769 6c6c  e operation will
+00017330: 2066 6169 6c2e 0a20 2020 2020 2020 2020   fail..         
+00017340: 2020 202d 2060 6063 6173 6361 6465 6060     - ``cascade``
+00017350: 202d 2041 7574 6f6d 6174 6963 616c 6c79   - Automatically
+00017360: 2064 656c 6574 6520 616c 6c20 6368 696c   delete all chil
+00017370: 6420 6f62 6a65 6374 7320 7768 656e 2064  d objects when d
+00017380: 656c 6574 696e 6720 7468 6520 7072 6f6a  eleting the proj
+00017390: 6563 742e 0a20 2020 2020 2020 2022 2222  ect..        """
+000173a0: 0a0a 2020 2020 2020 2020 7061 7468 203d  ..        path =
+000173b0: 2066 2270 726f 6a65 6374 732f 7b6e 616d   f"projects/{nam
+000173c0: 657d 220a 2020 2020 2020 2020 6865 6164  e}".        head
+000173d0: 6572 7320 3d20 7b0a 2020 2020 2020 2020  ers = {.        
+000173e0: 2020 2020 6d6c 7275 6e2e 636f 6d6d 6f6e      mlrun.common
+000173f0: 2e73 6368 656d 6173 2e48 6561 6465 724e  .schemas.HeaderN
+00017400: 616d 6573 2e64 656c 6574 696f 6e5f 7374  ames.deletion_st
+00017410: 7261 7465 6779 3a20 6465 6c65 7469 6f6e  rategy: deletion
+00017420: 5f73 7472 6174 6567 790a 2020 2020 2020  _strategy.      
+00017430: 2020 7d0a 2020 2020 2020 2020 6572 726f    }.        erro
+00017440: 725f 6d65 7373 6167 6520 3d20 6622 4661  r_message = f"Fa
+00017450: 696c 6564 2064 656c 6574 696e 6720 7072  iled deleting pr
+00017460: 6f6a 6563 7420 7b6e 616d 657d 220a 2020  oject {name}".  
+00017470: 2020 2020 2020 7265 7370 6f6e 7365 203d        response =
+00017480: 2073 656c 662e 6170 695f 6361 6c6c 2822   self.api_call("
+00017490: 4445 4c45 5445 222c 2070 6174 682c 2065  DELETE", path, e
+000174a0: 7272 6f72 5f6d 6573 7361 6765 2c20 6865  rror_message, he
+000174b0: 6164 6572 733d 6865 6164 6572 7329 0a20  aders=headers). 
+000174c0: 2020 2020 2020 2069 6620 7265 7370 6f6e         if respon
+000174d0: 7365 2e73 7461 7475 735f 636f 6465 203d  se.status_code =
+000174e0: 3d20 6874 7470 2e48 5454 5053 7461 7475  = http.HTTPStatu
+000174f0: 732e 4143 4345 5054 4544 3a0a 2020 2020  s.ACCEPTED:.    
+00017500: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00017510: 656c 662e 5f77 6169 745f 666f 725f 7072  elf._wait_for_pr
+00017520: 6f6a 6563 745f 746f 5f62 655f 6465 6c65  oject_to_be_dele
+00017530: 7465 6428 6e61 6d65 290a 0a20 2020 2064  ted(name)..    d
+00017540: 6566 2073 746f 7265 5f70 726f 6a65 6374  ef store_project
+00017550: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+00017560: 2020 2020 2020 2020 6e61 6d65 3a20 7374          name: st
+00017570: 722c 0a20 2020 2020 2020 2070 726f 6a65  r,.        proje
+00017580: 6374 3a20 556e 696f 6e5b 6469 6374 2c20  ct: Union[dict, 
+00017590: 6d6c 7275 6e2e 7072 6f6a 6563 7473 2e4d  mlrun.projects.M
+000175a0: 6c72 756e 5072 6f6a 6563 742c 206d 6c72  lrunProject, mlr
+000175b0: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
+000175c0: 732e 5072 6f6a 6563 745d 2c0a 2020 2020  s.Project],.    
+000175d0: 2920 2d3e 206d 6c72 756e 2e70 726f 6a65  ) -> mlrun.proje
+000175e0: 6374 732e 4d6c 7275 6e50 726f 6a65 6374  cts.MlrunProject
+000175f0: 3a0a 2020 2020 2020 2020 2222 2253 746f  :.        """Sto
+00017600: 7265 2061 2070 726f 6a65 6374 2069 6e20  re a project in 
+00017610: 7468 6520 4442 2e20 5468 6973 206f 7065  the DB. This ope
+00017620: 7261 7469 6f6e 2077 696c 6c20 6f76 6572  ration will over
+00017630: 7772 6974 6520 6578 6973 7469 6e67 2070  write existing p
+00017640: 726f 6a65 6374 206f 6620 7468 6520 7361  roject of the sa
+00017650: 6d65 206e 616d 6520 6966 2065 7869 7374  me name if exist
+00017660: 732e 2222 220a 0a20 2020 2020 2020 2070  s."""..        p
+00017670: 6174 6820 3d20 6622 7072 6f6a 6563 7473  ath = f"projects
+00017680: 2f7b 6e61 6d65 7d22 0a20 2020 2020 2020  /{name}".       
+00017690: 2065 7272 6f72 5f6d 6573 7361 6765 203d   error_message =
+000176a0: 2066 2246 6169 6c65 6420 7374 6f72 696e   f"Failed storin
+000176b0: 6720 7072 6f6a 6563 7420 7b6e 616d 657d  g project {name}
+000176c0: 220a 2020 2020 2020 2020 6966 2069 7369  ".        if isi
+000176d0: 6e73 7461 6e63 6528 7072 6f6a 6563 742c  nstance(project,
+000176e0: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
+000176f0: 6865 6d61 732e 5072 6f6a 6563 7429 3a0a  hemas.Project):.
+00017700: 2020 2020 2020 2020 2020 2020 7072 6f6a              proj
+00017710: 6563 7420 3d20 7072 6f6a 6563 742e 6469  ect = project.di
+00017720: 6374 2829 0a20 2020 2020 2020 2065 6c69  ct().        eli
+00017730: 6620 6973 696e 7374 616e 6365 2870 726f  f isinstance(pro
+00017740: 6a65 6374 2c20 6d6c 7275 6e2e 7072 6f6a  ject, mlrun.proj
+00017750: 6563 7473 2e4d 6c72 756e 5072 6f6a 6563  ects.MlrunProjec
+00017760: 7429 3a0a 2020 2020 2020 2020 2020 2020  t):.            
+00017770: 7072 6f6a 6563 7420 3d20 7072 6f6a 6563  project = projec
+00017780: 742e 746f 5f64 6963 7428 290a 2020 2020  t.to_dict().    
+00017790: 2020 2020 7265 7370 6f6e 7365 203d 2073      response = s
+000177a0: 656c 662e 6170 695f 6361 6c6c 280a 2020  elf.api_call(.  
+000177b0: 2020 2020 2020 2020 2020 2250 5554 222c            "PUT",
+000177c0: 0a20 2020 2020 2020 2020 2020 2070 6174  .            pat
+000177d0: 682c 0a20 2020 2020 2020 2020 2020 2065  h,.            e
+000177e0: 7272 6f72 5f6d 6573 7361 6765 2c0a 2020  rror_message,.  
+000177f0: 2020 2020 2020 2020 2020 626f 6479 3d64            body=d
+00017800: 6963 745f 746f 5f6a 736f 6e28 7072 6f6a  ict_to_json(proj
+00017810: 6563 7429 2c0a 2020 2020 2020 2020 290a  ect),.        ).
+00017820: 2020 2020 2020 2020 6966 2072 6573 706f          if respo
+00017830: 6e73 652e 7374 6174 7573 5f63 6f64 6520  nse.status_code 
+00017840: 3d3d 2068 7474 702e 4854 5450 5374 6174  == http.HTTPStat
+00017850: 7573 2e41 4343 4550 5445 443a 0a20 2020  us.ACCEPTED:.   
+00017860: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00017870: 7365 6c66 2e5f 7761 6974 5f66 6f72 5f70  self._wait_for_p
+00017880: 726f 6a65 6374 5f74 6f5f 7265 6163 685f  roject_to_reach_
+00017890: 7465 726d 696e 616c 5f73 7461 7465 286e  terminal_state(n
+000178a0: 616d 6529 0a20 2020 2020 2020 2072 6574  ame).        ret
+000178b0: 7572 6e20 6d6c 7275 6e2e 7072 6f6a 6563  urn mlrun.projec
+000178c0: 7473 2e4d 6c72 756e 5072 6f6a 6563 742e  ts.MlrunProject.
+000178d0: 6672 6f6d 5f64 6963 7428 7265 7370 6f6e  from_dict(respon
+000178e0: 7365 2e6a 736f 6e28 2929 0a0a 2020 2020  se.json())..    
+000178f0: 6465 6620 7061 7463 685f 7072 6f6a 6563  def patch_projec
+00017900: 7428 0a20 2020 2020 2020 2073 656c 662c  t(.        self,
+00017910: 0a20 2020 2020 2020 206e 616d 653a 2073  .        name: s
+00017920: 7472 2c0a 2020 2020 2020 2020 7072 6f6a  tr,.        proj
+00017930: 6563 743a 2064 6963 742c 0a20 2020 2020  ect: dict,.     
+00017940: 2020 2070 6174 6368 5f6d 6f64 653a 2055     patch_mode: U
+00017950: 6e69 6f6e 5b0a 2020 2020 2020 2020 2020  nion[.          
+00017960: 2020 7374 722c 206d 6c72 756e 2e63 6f6d    str, mlrun.com
+00017970: 6d6f 6e2e 7363 6865 6d61 732e 5061 7463  mon.schemas.Patc
+00017980: 684d 6f64 650a 2020 2020 2020 2020 5d20  hMode.        ] 
+00017990: 3d20 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  = mlrun.common.s
+000179a0: 6368 656d 6173 2e50 6174 6368 4d6f 6465  chemas.PatchMode
+000179b0: 2e72 6570 6c61 6365 2c0a 2020 2020 2920  .replace,.    ) 
+000179c0: 2d3e 206d 6c72 756e 2e70 726f 6a65 6374  -> mlrun.project
+000179d0: 732e 4d6c 7275 6e50 726f 6a65 6374 3a0a  s.MlrunProject:.
+000179e0: 2020 2020 2020 2020 2222 2250 6174 6368          """Patch
+000179f0: 2061 6e20 6578 6973 7469 6e67 2070 726f   an existing pro
+00017a00: 6a65 6374 206f 626a 6563 742e 0a0a 2020  ject object...  
+00017a10: 2020 2020 2020 3a70 6172 616d 206e 616d        :param nam
+00017a20: 653a 204e 616d 6520 6f66 2070 726f 6a65  e: Name of proje
+00017a30: 6374 2074 6f20 7061 7463 682e 0a20 2020  ct to patch..   
+00017a40: 2020 2020 203a 7061 7261 6d20 7072 6f6a       :param proj
+00017a50: 6563 743a 2054 6865 2061 6374 7561 6c20  ect: The actual 
+00017a60: 6368 616e 6765 7320 746f 2074 6865 2070  changes to the p
+00017a70: 726f 6a65 6374 206f 626a 6563 742e 0a20  roject object.. 
+00017a80: 2020 2020 2020 203a 7061 7261 6d20 7061         :param pa
+00017a90: 7463 685f 6d6f 6465 3a20 5468 6520 7374  tch_mode: The st
+00017aa0: 7261 7465 6779 2066 6f72 206d 6572 6769  rategy for mergi
+00017ab0: 6e67 2074 6865 2063 6861 6e67 6573 2077  ng the changes w
+00017ac0: 6974 6820 7468 6520 6578 6973 7469 6e67  ith the existing
+00017ad0: 206f 626a 6563 742e 2043 616e 2062 6520   object. Can be 
+00017ae0: 6569 7468 6572 2060 6072 6570 6c61 6365  either ``replace
+00017af0: 6060 0a20 2020 2020 2020 2020 2020 206f  ``.            o
+00017b00: 7220 6060 6164 6469 7469 7665 6060 2e0a  r ``additive``..
+00017b10: 2020 2020 2020 2020 2222 220a 0a20 2020          """..   
+00017b20: 2020 2020 2070 6174 6820 3d20 6622 7072       path = f"pr
+00017b30: 6f6a 6563 7473 2f7b 6e61 6d65 7d22 0a20  ojects/{name}". 
+00017b40: 2020 2020 2020 2068 6561 6465 7273 203d         headers =
+00017b50: 207b 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73   {mlrun.common.s
+00017b60: 6368 656d 6173 2e48 6561 6465 724e 616d  chemas.HeaderNam
+00017b70: 6573 2e70 6174 6368 5f6d 6f64 653a 2070  es.patch_mode: p
+00017b80: 6174 6368 5f6d 6f64 657d 0a20 2020 2020  atch_mode}.     
+00017b90: 2020 2065 7272 6f72 5f6d 6573 7361 6765     error_message
+00017ba0: 203d 2066 2246 6169 6c65 6420 7061 7463   = f"Failed patc
+00017bb0: 6869 6e67 2070 726f 6a65 6374 207b 6e61  hing project {na
+00017bc0: 6d65 7d22 0a20 2020 2020 2020 2072 6573  me}".        res
+00017bd0: 706f 6e73 6520 3d20 7365 6c66 2e61 7069  ponse = self.api
+00017be0: 5f63 616c 6c28 0a20 2020 2020 2020 2020  _call(.         
+00017bf0: 2020 2022 5041 5443 4822 2c20 7061 7468     "PATCH", path
+00017c00: 2c20 6572 726f 725f 6d65 7373 6167 652c  , error_message,
+00017c10: 2062 6f64 793d 6469 6374 5f74 6f5f 6a73   body=dict_to_js
+00017c20: 6f6e 2870 726f 6a65 6374 292c 2068 6561  on(project), hea
+00017c30: 6465 7273 3d68 6561 6465 7273 0a20 2020  ders=headers.   
+00017c40: 2020 2020 2029 0a20 2020 2020 2020 2072       ).        r
+00017c50: 6574 7572 6e20 6d6c 7275 6e2e 7072 6f6a  eturn mlrun.proj
+00017c60: 6563 7473 2e4d 6c72 756e 5072 6f6a 6563  ects.MlrunProjec
+00017c70: 742e 6672 6f6d 5f64 6963 7428 7265 7370  t.from_dict(resp
+00017c80: 6f6e 7365 2e6a 736f 6e28 2929 0a0a 2020  onse.json())..  
+00017c90: 2020 6465 6620 6372 6561 7465 5f70 726f    def create_pro
+00017ca0: 6a65 6374 280a 2020 2020 2020 2020 7365  ject(.        se
+00017cb0: 6c66 2c0a 2020 2020 2020 2020 7072 6f6a  lf,.        proj
+00017cc0: 6563 743a 2055 6e69 6f6e 5b64 6963 742c  ect: Union[dict,
+00017cd0: 206d 6c72 756e 2e70 726f 6a65 6374 732e   mlrun.projects.
+00017ce0: 4d6c 7275 6e50 726f 6a65 6374 2c20 6d6c  MlrunProject, ml
+00017cf0: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
+00017d00: 6173 2e50 726f 6a65 6374 5d2c 0a20 2020  as.Project],.   
+00017d10: 2029 202d 3e20 6d6c 7275 6e2e 7072 6f6a   ) -> mlrun.proj
+00017d20: 6563 7473 2e4d 6c72 756e 5072 6f6a 6563  ects.MlrunProjec
+00017d30: 743a 0a20 2020 2020 2020 2022 2222 4372  t:.        """Cr
+00017d40: 6561 7465 2061 206e 6577 2070 726f 6a65  eate a new proje
+00017d50: 6374 2e20 4120 7072 6f6a 6563 7420 7769  ct. A project wi
+00017d60: 7468 2074 6865 2073 616d 6520 6e61 6d65  th the same name
+00017d70: 206d 7573 7420 6e6f 7420 6578 6973 7420   must not exist 
+00017d80: 7072 696f 7220 746f 2063 7265 6174 696f  prior to creatio
+00017d90: 6e2e 2222 220a 0a20 2020 2020 2020 2069  n."""..        i
+00017da0: 6620 6973 696e 7374 616e 6365 2870 726f  f isinstance(pro
+00017db0: 6a65 6374 2c20 6d6c 7275 6e2e 636f 6d6d  ject, mlrun.comm
+00017dc0: 6f6e 2e73 6368 656d 6173 2e50 726f 6a65  on.schemas.Proje
+00017dd0: 6374 293a 0a20 2020 2020 2020 2020 2020  ct):.           
+00017de0: 2070 726f 6a65 6374 203d 2070 726f 6a65   project = proje
+00017df0: 6374 2e64 6963 7428 290a 2020 2020 2020  ct.dict().      
+00017e00: 2020 656c 6966 2069 7369 6e73 7461 6e63    elif isinstanc
+00017e10: 6528 7072 6f6a 6563 742c 206d 6c72 756e  e(project, mlrun
+00017e20: 2e70 726f 6a65 6374 732e 4d6c 7275 6e50  .projects.MlrunP
+00017e30: 726f 6a65 6374 293a 0a20 2020 2020 2020  roject):.       
+00017e40: 2020 2020 2070 726f 6a65 6374 203d 2070       project = p
+00017e50: 726f 6a65 6374 2e74 6f5f 6469 6374 2829  roject.to_dict()
+00017e60: 0a20 2020 2020 2020 2070 726f 6a65 6374  .        project
+00017e70: 5f6e 616d 6520 3d20 7072 6f6a 6563 745b  _name = project[
+00017e80: 226d 6574 6164 6174 6122 5d5b 226e 616d  "metadata"]["nam
+00017e90: 6522 5d0a 2020 2020 2020 2020 6572 726f  e"].        erro
+00017ea0: 725f 6d65 7373 6167 6520 3d20 6622 4661  r_message = f"Fa
+00017eb0: 696c 6564 2063 7265 6174 696e 6720 7072  iled creating pr
+00017ec0: 6f6a 6563 7420 7b70 726f 6a65 6374 5f6e  oject {project_n
+00017ed0: 616d 657d 220a 2020 2020 2020 2020 7265  ame}".        re
+00017ee0: 7370 6f6e 7365 203d 2073 656c 662e 6170  sponse = self.ap
+00017ef0: 695f 6361 6c6c 280a 2020 2020 2020 2020  i_call(.        
+00017f00: 2020 2020 2250 4f53 5422 2c0a 2020 2020      "POST",.    
+00017f10: 2020 2020 2020 2020 2270 726f 6a65 6374          "project
+00017f20: 7322 2c0a 2020 2020 2020 2020 2020 2020  s",.            
+00017f30: 6572 726f 725f 6d65 7373 6167 652c 0a20  error_message,. 
+00017f40: 2020 2020 2020 2020 2020 2062 6f64 793d             body=
+00017f50: 6469 6374 5f74 6f5f 6a73 6f6e 2870 726f  dict_to_json(pro
+00017f60: 6a65 6374 292c 0a20 2020 2020 2020 2029  ject),.        )
+00017f70: 0a20 2020 2020 2020 2069 6620 7265 7370  .        if resp
+00017f80: 6f6e 7365 2e73 7461 7475 735f 636f 6465  onse.status_code
+00017f90: 203d 3d20 6874 7470 2e48 5454 5053 7461   == http.HTTPSta
+00017fa0: 7475 732e 4143 4345 5054 4544 3a0a 2020  tus.ACCEPTED:.  
+00017fb0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00017fc0: 2073 656c 662e 5f77 6169 745f 666f 725f   self._wait_for_
+00017fd0: 7072 6f6a 6563 745f 746f 5f72 6561 6368  project_to_reach
+00017fe0: 5f74 6572 6d69 6e61 6c5f 7374 6174 6528  _terminal_state(
+00017ff0: 7072 6f6a 6563 745f 6e61 6d65 290a 2020  project_name).  
+00018000: 2020 2020 2020 7265 7475 726e 206d 6c72        return mlr
+00018010: 756e 2e70 726f 6a65 6374 732e 4d6c 7275  un.projects.Mlru
+00018020: 6e50 726f 6a65 6374 2e66 726f 6d5f 6469  nProject.from_di
+00018030: 6374 2872 6573 706f 6e73 652e 6a73 6f6e  ct(response.json
+00018040: 2829 290a 0a20 2020 2064 6566 205f 7761  ())..    def _wa
+00018050: 6974 5f66 6f72 5f70 726f 6a65 6374 5f74  it_for_project_t
+00018060: 6f5f 7265 6163 685f 7465 726d 696e 616c  o_reach_terminal
+00018070: 5f73 7461 7465 280a 2020 2020 2020 2020  _state(.        
+00018080: 7365 6c66 2c20 7072 6f6a 6563 745f 6e61  self, project_na
+00018090: 6d65 3a20 7374 720a 2020 2020 2920 2d3e  me: str.    ) ->
+000180a0: 206d 6c72 756e 2e70 726f 6a65 6374 732e   mlrun.projects.
+000180b0: 4d6c 7275 6e50 726f 6a65 6374 3a0a 2020  MlrunProject:.  
+000180c0: 2020 2020 2020 6465 6620 5f76 6572 6966        def _verif
+000180d0: 795f 7072 6f6a 6563 745f 696e 5f74 6572  y_project_in_ter
+000180e0: 6d69 6e61 6c5f 7374 6174 6528 293a 0a20  minal_state():. 
+000180f0: 2020 2020 2020 2020 2020 2070 726f 6a65             proje
+00018100: 6374 203d 2073 656c 662e 6765 745f 7072  ct = self.get_pr
+00018110: 6f6a 6563 7428 7072 6f6a 6563 745f 6e61  oject(project_na
+00018120: 6d65 290a 2020 2020 2020 2020 2020 2020  me).            
+00018130: 6966 2028 0a20 2020 2020 2020 2020 2020  if (.           
+00018140: 2020 2020 2070 726f 6a65 6374 2e73 7461       project.sta
+00018150: 7475 732e 7374 6174 650a 2020 2020 2020  tus.state.      
+00018160: 2020 2020 2020 2020 2020 6e6f 7420 696e            not in
+00018170: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
+00018180: 6865 6d61 732e 5072 6f6a 6563 7453 7461  hemas.ProjectSta
+00018190: 7465 2e74 6572 6d69 6e61 6c5f 7374 6174  te.terminal_stat
+000181a0: 6573 2829 0a20 2020 2020 2020 2020 2020  es().           
+000181b0: 2029 3a0a 2020 2020 2020 2020 2020 2020   ):.            
+000181c0: 2020 2020 7261 6973 6520 4578 6365 7074      raise Except
+000181d0: 696f 6e28 0a20 2020 2020 2020 2020 2020  ion(.           
+000181e0: 2020 2020 2020 2020 2066 2250 726f 6a65           f"Proje
+000181f0: 6374 206e 6f74 2069 6e20 7465 726d 696e  ct not in termin
+00018200: 616c 2073 7461 7465 2e20 5374 6174 653a  al state. State:
+00018210: 207b 7072 6f6a 6563 742e 7374 6174 7573   {project.status
+00018220: 2e73 7461 7465 7d22 0a20 2020 2020 2020  .state}".       
+00018230: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00018240: 2020 2020 2020 2072 6574 7572 6e20 7072         return pr
+00018250: 6f6a 6563 740a 0a20 2020 2020 2020 2072  oject..        r
+00018260: 6574 7572 6e20 6d6c 7275 6e2e 7574 696c  eturn mlrun.util
+00018270: 732e 6865 6c70 6572 732e 7265 7472 795f  s.helpers.retry_
+00018280: 756e 7469 6c5f 7375 6363 6573 7366 756c  until_successful
+00018290: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
+000182a0: 6c66 2e5f 7761 6974 5f66 6f72 5f70 726f  lf._wait_for_pro
+000182b0: 6a65 6374 5f74 6572 6d69 6e61 6c5f 7374  ject_terminal_st
+000182c0: 6174 655f 7265 7472 795f 696e 7465 7276  ate_retry_interv
+000182d0: 616c 2c0a 2020 2020 2020 2020 2020 2020  al,.            
+000182e0: 3132 302c 0a20 2020 2020 2020 2020 2020  120,.           
+000182f0: 206c 6f67 6765 722c 0a20 2020 2020 2020   logger,.       
+00018300: 2020 2020 2046 616c 7365 2c0a 2020 2020       False,.    
+00018310: 2020 2020 2020 2020 5f76 6572 6966 795f          _verify_
+00018320: 7072 6f6a 6563 745f 696e 5f74 6572 6d69  project_in_termi
+00018330: 6e61 6c5f 7374 6174 652c 0a20 2020 2020  nal_state,.     
+00018340: 2020 2029 0a0a 2020 2020 6465 6620 5f77     )..    def _w
+00018350: 6169 745f 666f 725f 6261 636b 6772 6f75  ait_for_backgrou
+00018360: 6e64 5f74 6173 6b5f 746f 5f72 6561 6368  nd_task_to_reach
+00018370: 5f74 6572 6d69 6e61 6c5f 7374 6174 6528  _terminal_state(
+00018380: 0a20 2020 2020 2020 2073 656c 662c 206e  .        self, n
+00018390: 616d 653a 2073 7472 0a20 2020 2029 202d  ame: str.    ) -
+000183a0: 3e20 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  > mlrun.common.s
+000183b0: 6368 656d 6173 2e42 6163 6b67 726f 756e  chemas.Backgroun
+000183c0: 6454 6173 6b3a 0a20 2020 2020 2020 2064  dTask:.        d
+000183d0: 6566 205f 7665 7269 6679 5f62 6163 6b67  ef _verify_backg
+000183e0: 726f 756e 645f 7461 736b 5f69 6e5f 7465  round_task_in_te
+000183f0: 726d 696e 616c 5f73 7461 7465 2829 3a0a  rminal_state():.
+00018400: 2020 2020 2020 2020 2020 2020 6261 636b              back
+00018410: 6772 6f75 6e64 5f74 6173 6b20 3d20 7365  ground_task = se
+00018420: 6c66 2e67 6574 5f62 6163 6b67 726f 756e  lf.get_backgroun
+00018430: 645f 7461 736b 286e 616d 6529 0a20 2020  d_task(name).   
+00018440: 2020 2020 2020 2020 2073 7461 7465 203d           state =
+00018450: 2062 6163 6b67 726f 756e 645f 7461 736b   background_task
+00018460: 2e73 7461 7475 732e 7374 6174 650a 2020  .status.state.  
+00018470: 2020 2020 2020 2020 2020 6966 2073 7461            if sta
+00018480: 7465 206e 6f74 2069 6e20 6d6c 7275 6e2e  te not in mlrun.
+00018490: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e42  common.schemas.B
+000184a0: 6163 6b67 726f 756e 6454 6173 6b53 7461  ackgroundTaskSta
+000184b0: 7465 2e74 6572 6d69 6e61 6c5f 7374 6174  te.terminal_stat
+000184c0: 6573 2829 3a0a 2020 2020 2020 2020 2020  es():.          
+000184d0: 2020 2020 2020 7261 6973 6520 4578 6365        raise Exce
+000184e0: 7074 696f 6e28 0a20 2020 2020 2020 2020  ption(.         
+000184f0: 2020 2020 2020 2020 2020 2066 2242 6163             f"Bac
+00018500: 6b67 726f 756e 6420 7461 736b 206e 6f74  kground task not
+00018510: 2069 6e20 7465 726d 696e 616c 2073 7461   in terminal sta
+00018520: 7465 2e20 6e61 6d65 3d7b 6e61 6d65 7d2c  te. name={name},
+00018530: 2073 7461 7465 3d7b 7374 6174 657d 220a   state={state}".
+00018540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018550: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
+00018560: 7475 726e 2062 6163 6b67 726f 756e 645f  turn background_
+00018570: 7461 736b 0a0a 2020 2020 2020 2020 7265  task..        re
+00018580: 7475 726e 206d 6c72 756e 2e75 7469 6c73  turn mlrun.utils
+00018590: 2e68 656c 7065 7273 2e72 6574 7279 5f75  .helpers.retry_u
+000185a0: 6e74 696c 5f73 7563 6365 7373 6675 6c28  ntil_successful(
+000185b0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+000185c0: 662e 5f77 6169 745f 666f 725f 6261 636b  f._wait_for_back
+000185d0: 6772 6f75 6e64 5f74 6173 6b5f 7465 726d  ground_task_term
+000185e0: 696e 616c 5f73 7461 7465 5f72 6574 7279  inal_state_retry
+000185f0: 5f69 6e74 6572 7661 6c2c 0a20 2020 2020  _interval,.     
+00018600: 2020 2020 2020 2036 3020 2a20 3630 2c0a         60 * 60,.
+00018610: 2020 2020 2020 2020 2020 2020 6c6f 6767              logg
+00018620: 6572 2c0a 2020 2020 2020 2020 2020 2020  er,.            
+00018630: 4661 6c73 652c 0a20 2020 2020 2020 2020  False,.         
+00018640: 2020 205f 7665 7269 6679 5f62 6163 6b67     _verify_backg
+00018650: 726f 756e 645f 7461 736b 5f69 6e5f 7465  round_task_in_te
+00018660: 726d 696e 616c 5f73 7461 7465 2c0a 2020  rminal_state,.  
+00018670: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
+00018680: 205f 7761 6974 5f66 6f72 5f70 726f 6a65   _wait_for_proje
+00018690: 6374 5f74 6f5f 6265 5f64 656c 6574 6564  ct_to_be_deleted
+000186a0: 2873 656c 662c 2070 726f 6a65 6374 5f6e  (self, project_n
+000186b0: 616d 653a 2073 7472 293a 0a20 2020 2020  ame: str):.     
+000186c0: 2020 2064 6566 205f 7665 7269 6679 5f70     def _verify_p
+000186d0: 726f 6a65 6374 5f64 656c 6574 6564 2829  roject_deleted()
+000186e0: 3a0a 2020 2020 2020 2020 2020 2020 7072  :.            pr
+000186f0: 6f6a 6563 7473 203d 2073 656c 662e 6c69  ojects = self.li
+00018700: 7374 5f70 726f 6a65 6374 7328 0a20 2020  st_projects(.   
+00018710: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+00018720: 6d61 745f 3d6d 6c72 756e 2e63 6f6d 6d6f  mat_=mlrun.commo
+00018730: 6e2e 7363 6865 6d61 732e 5072 6f6a 6563  n.schemas.Projec
+00018740: 7473 466f 726d 6174 2e6e 616d 655f 6f6e  tsFormat.name_on
+00018750: 6c79 0a20 2020 2020 2020 2020 2020 2029  ly.            )
+00018760: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00018770: 7072 6f6a 6563 745f 6e61 6d65 2069 6e20  project_name in 
+00018780: 7072 6f6a 6563 7473 3a0a 2020 2020 2020  projects:.      
+00018790: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+000187a0: 4578 6365 7074 696f 6e28 2250 726f 6a65  Exception("Proje
+000187b0: 6374 2073 7469 6c6c 2065 7869 7374 7322  ct still exists"
+000187c0: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
+000187d0: 6e20 6d6c 7275 6e2e 7574 696c 732e 6865  n mlrun.utils.he
+000187e0: 6c70 6572 732e 7265 7472 795f 756e 7469  lpers.retry_unti
+000187f0: 6c5f 7375 6363 6573 7366 756c 280a 2020  l_successful(.  
+00018800: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+00018810: 7761 6974 5f66 6f72 5f70 726f 6a65 6374  wait_for_project
+00018820: 5f64 656c 6574 696f 6e5f 696e 7465 7276  _deletion_interv
+00018830: 616c 2c0a 2020 2020 2020 2020 2020 2020  al,.            
+00018840: 3132 302c 0a20 2020 2020 2020 2020 2020  120,.           
+00018850: 206c 6f67 6765 722c 0a20 2020 2020 2020   logger,.       
+00018860: 2020 2020 2046 616c 7365 2c0a 2020 2020       False,.    
+00018870: 2020 2020 2020 2020 5f76 6572 6966 795f          _verify_
+00018880: 7072 6f6a 6563 745f 6465 6c65 7465 642c  project_deleted,
+00018890: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+000188a0: 6465 6620 6372 6561 7465 5f70 726f 6a65  def create_proje
+000188b0: 6374 5f73 6563 7265 7473 280a 2020 2020  ct_secrets(.    
+000188c0: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+000188d0: 2020 7072 6f6a 6563 743a 2073 7472 2c0a    project: str,.
+000188e0: 2020 2020 2020 2020 7072 6f76 6964 6572          provider
+000188f0: 3a20 556e 696f 6e5b 0a20 2020 2020 2020  : Union[.       
+00018900: 2020 2020 2073 7472 2c20 6d6c 7275 6e2e       str, mlrun.
+00018910: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e53  common.schemas.S
+00018920: 6563 7265 7450 726f 7669 6465 724e 616d  ecretProviderNam
+00018930: 650a 2020 2020 2020 2020 5d20 3d20 6d6c  e.        ] = ml
+00018940: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
+00018950: 6173 2e53 6563 7265 7450 726f 7669 6465  as.SecretProvide
+00018960: 724e 616d 652e 6b75 6265 726e 6574 6573  rName.kubernetes
+00018970: 2c0a 2020 2020 2020 2020 7365 6372 6574  ,.        secret
+00018980: 733a 2064 6963 7420 3d20 4e6f 6e65 2c0a  s: dict = None,.
+00018990: 2020 2020 293a 0a20 2020 2020 2020 2022      ):.        "
+000189a0: 2222 4372 6561 7465 2070 726f 6a65 6374  ""Create project
+000189b0: 2d63 6f6e 7465 7874 2073 6563 7265 7473  -context secrets
+000189c0: 2075 7369 6e67 2065 6974 6865 7220 6060   using either ``
+000189d0: 7661 756c 7460 6020 6f72 2060 606b 7562  vault`` or ``kub
+000189e0: 6572 6e65 7465 7360 6020 7072 6f76 6964  ernetes`` provid
+000189f0: 6572 2e0a 2020 2020 2020 2020 5768 656e  er..        When
+00018a00: 2075 7369 6e67 2077 6974 6820 5661 756c   using with Vaul
+00018a10: 742c 2074 6869 7320 7769 6c6c 2063 7265  t, this will cre
+00018a20: 6174 6520 6e65 6564 6564 2056 6175 6c74  ate needed Vault
+00018a30: 2073 7472 7563 7475 7265 7320 666f 7220   structures for 
+00018a40: 7374 6f72 696e 6720 7365 6372 6574 7320  storing secrets 
+00018a50: 696e 2070 726f 6a65 6374 2d63 6f6e 7465  in project-conte
+00018a60: 7874 2c20 616e 640a 2020 2020 2020 2020  xt, and.        
+00018a70: 7374 6f72 6520 6120 7365 7420 6f66 2073  store a set of s
+00018a80: 6563 7265 7420 7661 6c75 6573 2e20 5468  ecret values. Th
+00018a90: 6520 6d65 7468 6f64 2067 656e 6572 6174  e method generat
+00018aa0: 6573 204b 7562 6572 6e65 7465 7320 7365  es Kubernetes se
+00018ab0: 7276 6963 652d 6163 636f 756e 7420 616e  rvice-account an
+00018ac0: 6420 7468 6520 5661 756c 7420 6175 7468  d the Vault auth
+00018ad0: 656e 7469 6361 7469 6f6e 0a20 2020 2020  entication.     
+00018ae0: 2020 2073 7472 7563 7475 7265 7320 7468     structures th
+00018af0: 6174 2061 7265 2072 6571 7569 7265 6420  at are required 
+00018b00: 666f 7220 6675 6e63 7469 6f6e 2050 6f64  for function Pod
+00018b10: 7320 746f 2061 7574 6865 6e74 6963 6174  s to authenticat
+00018b20: 6520 7769 7468 2056 6175 6c74 2061 6e64  e with Vault and
+00018b30: 2062 6520 6162 6c65 2074 6f20 6578 7472   be able to extr
+00018b40: 6163 7420 7365 6372 6574 2076 616c 7565  act secret value
+00018b50: 730a 2020 2020 2020 2020 7061 7373 6564  s.        passed
+00018b60: 2061 7320 7061 7274 206f 6620 7468 6569   as part of thei
+00018b70: 7220 636f 6e74 6578 742e 0a0a 2020 2020  r context...    
+00018b80: 2020 2020 4e6f 7465 3a0a 2020 2020 2020      Note:.      
+00018b90: 2020 2020 2020 2020 2020 5468 6973 206d            This m
+00018ba0: 6574 686f 6420 7573 6564 2077 6974 6820  ethod used with 
+00018bb0: 5661 756c 7420 6973 2063 7572 7265 6e74  Vault is current
+00018bc0: 6c79 2069 6e20 7465 6368 6e69 6361 6c20  ly in technical 
+00018bd0: 7072 6576 6965 772c 2061 6e64 2072 6571  preview, and req
+00018be0: 7569 7265 7320 6120 4861 7368 6943 6f72  uires a HashiCor
+00018bf0: 7020 5661 756c 740a 2020 2020 2020 2020  p Vault.        
+00018c00: 2020 2020 2020 2020 696e 6672 6173 7472          infrastr
+00018c10: 7563 7475 7265 2070 726f 7065 726c 7920  ucture properly 
+00018c20: 7365 7420 7570 2061 6e64 2063 6f6e 6e65  set up and conne
+00018c30: 6374 6564 2074 6f20 7468 6520 4d4c 5275  cted to the MLRu
+00018c40: 6e20 4150 4920 7365 7276 6572 2e0a 0a20  n API server... 
+00018c50: 2020 2020 2020 2057 6865 6e20 7573 6564         When used
+00018c60: 2077 6974 6820 4b75 6265 726e 6574 6573   with Kubernetes
+00018c70: 2c20 7468 6973 2077 696c 6c20 6d61 6b65  , this will make
+00018c80: 2073 7572 6520 7468 6174 2074 6865 2070   sure that the p
+00018c90: 726f 6a65 6374 2d73 7065 6369 6669 6320  roject-specific 
+00018ca0: 6b38 7320 7365 6372 6574 2069 7320 6372  k8s secret is cr
+00018cb0: 6561 7465 642c 2061 6e64 2077 696c 6c0a  eated, and will.
+00018cc0: 2020 2020 2020 2020 706f 7075 6c61 7465          populate
+00018cd0: 2069 7420 7769 7468 2074 6865 2073 6563   it with the sec
+00018ce0: 7265 7473 2070 726f 7669 6465 642c 2072  rets provided, r
+00018cf0: 6570 6c61 6369 6e67 2074 6865 6972 2076  eplacing their v
+00018d00: 616c 7565 7320 6966 2074 6865 7920 6578  alues if they ex
+00018d10: 6973 742e 0a0a 2020 2020 2020 2020 3a70  ist...        :p
+00018d20: 6172 616d 2070 726f 6a65 6374 3a20 5468  aram project: Th
+00018d30: 6520 7072 6f6a 6563 7420 636f 6e74 6578  e project contex
+00018d40: 7420 666f 7220 7768 6963 6820 746f 2067  t for which to g
+00018d50: 656e 6572 6174 6520 7468 6520 696e 6672  enerate the infr
+00018d60: 6120 616e 6420 7374 6f72 6520 7365 6372  a and store secr
+00018d70: 6574 732e 0a20 2020 2020 2020 203a 7061  ets..        :pa
+00018d80: 7261 6d20 7072 6f76 6964 6572 3a20 5468  ram provider: Th
+00018d90: 6520 6e61 6d65 206f 6620 7468 6520 7365  e name of the se
+00018da0: 6372 6574 732d 7072 6f76 6964 6572 2074  crets-provider t
+00018db0: 6f20 776f 726b 2077 6974 682e 2041 6363  o work with. Acc
+00018dc0: 6570 7473 2061 0a20 2020 2020 2020 2020  epts a.         
+00018dd0: 2020 203a 7079 3a63 6c61 7373 3a60 7e6d     :py:class:`~m
+00018de0: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
+00018df0: 6d61 732e 7365 6372 6574 2e53 6563 7265  mas.secret.Secre
+00018e00: 7450 726f 7669 6465 724e 616d 6560 2065  tProviderName` e
+00018e10: 6e75 6d2e 0a20 2020 2020 2020 203a 7061  num..        :pa
+00018e20: 7261 6d20 7365 6372 6574 733a 2041 2073  ram secrets: A s
+00018e30: 6574 206f 6620 7365 6372 6574 2076 616c  et of secret val
+00018e40: 7565 7320 746f 2073 746f 7265 2e0a 2020  ues to store..  
+00018e50: 2020 2020 2020 2020 2020 4578 616d 706c            Exampl
+00018e60: 653a 3a0a 0a20 2020 2020 2020 2020 2020  e::..           
+00018e70: 2020 2020 2073 6563 7265 7473 203d 207b       secrets = {
+00018e80: 2770 6173 7377 6f72 6427 3a20 276d 7950  'password': 'myP
+00018e90: 6173 7377 3072 6427 2c20 2761 7773 5f6b  assw0rd', 'aws_k
+00018ea0: 6579 273a 2027 3131 3132 3232 3333 3327  ey': '111222333'
+00018eb0: 7d0a 2020 2020 2020 2020 2020 2020 2020  }.              
+00018ec0: 2020 6462 2e63 7265 6174 655f 7072 6f6a    db.create_proj
+00018ed0: 6563 745f 7365 6372 6574 7328 0a20 2020  ect_secrets(.   
+00018ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018ef0: 2022 7072 6f6a 6563 7431 222c 0a20 2020   "project1",.   
+00018f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018f10: 2070 726f 7669 6465 723d 6d6c 7275 6e2e   provider=mlrun.
+00018f20: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e53  common.schemas.S
+00018f30: 6563 7265 7450 726f 7669 6465 724e 616d  ecretProviderNam
+00018f40: 652e 6b75 6265 726e 6574 6573 2c0a 2020  e.kubernetes,.  
+00018f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018f60: 2020 7365 6372 6574 733d 7365 6372 6574    secrets=secret
+00018f70: 730a 2020 2020 2020 2020 2020 2020 2020  s.              
+00018f80: 2020 290a 2020 2020 2020 2020 2222 220a    ).        """.
+00018f90: 2020 2020 2020 2020 7061 7468 203d 2066          path = f
+00018fa0: 2270 726f 6a65 6374 732f 7b70 726f 6a65  "projects/{proje
+00018fb0: 6374 7d2f 7365 6372 6574 7322 0a20 2020  ct}/secrets".   
+00018fc0: 2020 2020 2073 6563 7265 7473 5f69 6e70       secrets_inp
+00018fd0: 7574 203d 206d 6c72 756e 2e63 6f6d 6d6f  ut = mlrun.commo
+00018fe0: 6e2e 7363 6865 6d61 732e 5365 6372 6574  n.schemas.Secret
+00018ff0: 7344 6174 6128 0a20 2020 2020 2020 2020  sData(.         
+00019000: 2020 2073 6563 7265 7473 3d73 6563 7265     secrets=secre
+00019010: 7473 2c20 7072 6f76 6964 6572 3d70 726f  ts, provider=pro
+00019020: 7669 6465 720a 2020 2020 2020 2020 290a  vider.        ).
+00019030: 2020 2020 2020 2020 626f 6479 203d 2073          body = s
+00019040: 6563 7265 7473 5f69 6e70 7574 2e64 6963  ecrets_input.dic
+00019050: 7428 290a 2020 2020 2020 2020 6572 726f  t().        erro
+00019060: 725f 6d65 7373 6167 6520 3d20 6622 4661  r_message = f"Fa
+00019070: 696c 6564 2063 7265 6174 696e 6720 7365  iled creating se
+00019080: 6372 6574 2070 726f 7669 6465 7220 7b70  cret provider {p
+00019090: 726f 6a65 6374 7d2f 7b70 726f 7669 6465  roject}/{provide
+000190a0: 727d 220a 2020 2020 2020 2020 7365 6c66  r}".        self
+000190b0: 2e61 7069 5f63 616c 6c28 0a20 2020 2020  .api_call(.     
+000190c0: 2020 2020 2020 2022 504f 5354 222c 0a20         "POST",. 
+000190d0: 2020 2020 2020 2020 2020 2070 6174 682c             path,
+000190e0: 0a20 2020 2020 2020 2020 2020 2065 7272  .            err
+000190f0: 6f72 5f6d 6573 7361 6765 2c0a 2020 2020  or_message,.    
+00019100: 2020 2020 2020 2020 626f 6479 3d64 6963          body=dic
+00019110: 745f 746f 5f6a 736f 6e28 626f 6479 292c  t_to_json(body),
+00019120: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+00019130: 6465 6620 6c69 7374 5f70 726f 6a65 6374  def list_project
+00019140: 5f73 6563 7265 7473 280a 2020 2020 2020  _secrets(.      
+00019150: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+00019160: 7072 6f6a 6563 743a 2073 7472 2c0a 2020  project: str,.  
+00019170: 2020 2020 2020 746f 6b65 6e3a 2073 7472        token: str
+00019180: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+00019190: 2070 726f 7669 6465 723a 2055 6e69 6f6e   provider: Union
+000191a0: 5b0a 2020 2020 2020 2020 2020 2020 7374  [.            st
+000191b0: 722c 206d 6c72 756e 2e63 6f6d 6d6f 6e2e  r, mlrun.common.
+000191c0: 7363 6865 6d61 732e 5365 6372 6574 5072  schemas.SecretPr
+000191d0: 6f76 6964 6572 4e61 6d65 0a20 2020 2020  oviderName.     
+000191e0: 2020 205d 203d 206d 6c72 756e 2e63 6f6d     ] = mlrun.com
+000191f0: 6d6f 6e2e 7363 6865 6d61 732e 5365 6372  mon.schemas.Secr
+00019200: 6574 5072 6f76 6964 6572 4e61 6d65 2e6b  etProviderName.k
+00019210: 7562 6572 6e65 7465 732c 0a20 2020 2020  ubernetes,.     
+00019220: 2020 2073 6563 7265 7473 3a20 4c69 7374     secrets: List
+00019230: 5b73 7472 5d20 3d20 4e6f 6e65 2c0a 2020  [str] = None,.  
+00019240: 2020 2920 2d3e 206d 6c72 756e 2e63 6f6d    ) -> mlrun.com
+00019250: 6d6f 6e2e 7363 6865 6d61 732e 5365 6372  mon.schemas.Secr
+00019260: 6574 7344 6174 613a 0a20 2020 2020 2020  etsData:.       
+00019270: 2022 2222 5265 7472 6965 7665 2070 726f   """Retrieve pro
+00019280: 6a65 6374 2d63 6f6e 7465 7874 2073 6563  ject-context sec
+00019290: 7265 7473 2066 726f 6d20 5661 756c 742e  rets from Vault.
+000192a0: 0a0a 2020 2020 2020 2020 4e6f 7465 3a0a  ..        Note:.
+000192b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000192c0: 5468 6973 206d 6574 686f 6420 666f 7220  This method for 
+000192d0: 5661 756c 7420 6675 6e63 7469 6f6e 616c  Vault functional
+000192e0: 6974 7920 6973 2063 7572 7265 6e74 6c79  ity is currently
+000192f0: 2069 6e20 7465 6368 6e69 6361 6c20 7072   in technical pr
+00019300: 6576 6965 772c 2061 6e64 2072 6571 7569  eview, and requi
+00019310: 7265 7320 6120 4861 7368 6943 6f72 7020  res a HashiCorp 
+00019320: 5661 756c 740a 2020 2020 2020 2020 2020  Vault.          
+00019330: 2020 2020 2020 696e 6672 6173 7472 7563        infrastruc
+00019340: 7475 7265 2070 726f 7065 726c 7920 7365  ture properly se
+00019350: 7420 7570 2061 6e64 2063 6f6e 6e65 6374  t up and connect
+00019360: 6564 2074 6f20 7468 6520 4d4c 5275 6e20  ed to the MLRun 
+00019370: 4150 4920 7365 7276 6572 2e0a 0a20 2020  API server...   
+00019380: 2020 2020 203a 7061 7261 6d20 7072 6f6a       :param proj
+00019390: 6563 743a 2054 6865 2070 726f 6a65 6374  ect: The project
+000193a0: 206e 616d 652e 0a20 2020 2020 2020 203a   name..        :
+000193b0: 7061 7261 6d20 746f 6b65 6e3a 2056 6175  param token: Vau
+000193c0: 6c74 2074 6f6b 656e 2074 6f20 7573 6520  lt token to use 
+000193d0: 666f 7220 7265 7472 6965 7669 6e67 2073  for retrieving s
+000193e0: 6563 7265 7473 2e0a 2020 2020 2020 2020  ecrets..        
+000193f0: 2020 2020 4d75 7374 2062 6520 6120 7661      Must be a va
+00019400: 6c69 6420 5661 756c 7420 746f 6b65 6e2c  lid Vault token,
+00019410: 2077 6974 6820 7065 726d 6973 7369 6f6e   with permission
+00019420: 7320 746f 2072 6574 7269 6576 6520 7365  s to retrieve se
+00019430: 6372 6574 7320 6f66 2074 6865 2070 726f  crets of the pro
+00019440: 6a65 6374 2069 6e20 7175 6573 7469 6f6e  ject in question
+00019450: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00019460: 2070 726f 7669 6465 723a 2054 6865 206e   provider: The n
+00019470: 616d 6520 6f66 2074 6865 2073 6563 7265  ame of the secre
+00019480: 7473 2d70 726f 7669 6465 7220 746f 2077  ts-provider to w
+00019490: 6f72 6b20 7769 7468 2e20 4375 7272 656e  ork with. Curren
+000194a0: 746c 7920 6f6e 6c79 2060 6076 6175 6c74  tly only ``vault
+000194b0: 6060 2069 7320 6163 6365 7074 6564 2e0a  `` is accepted..
+000194c0: 2020 2020 2020 2020 3a70 6172 616d 2073          :param s
+000194d0: 6563 7265 7473 3a20 4120 6c69 7374 206f  ecrets: A list o
+000194e0: 6620 7365 6372 6574 206e 616d 6573 2074  f secret names t
+000194f0: 6f20 7265 7472 6965 7665 2e20 416e 2065  o retrieve. An e
+00019500: 6d70 7479 206c 6973 7420 6060 5b5d 6060  mpty list ``[]``
+00019510: 2077 696c 6c20 7265 7472 6965 7665 2061   will retrieve a
+00019520: 6c6c 2073 6563 7265 7473 2061 7373 6967  ll secrets assig
+00019530: 6e65 640a 2020 2020 2020 2020 2020 2020  ned.            
+00019540: 746f 2074 6869 7320 7370 6563 6966 6963  to this specific
+00019550: 2070 726f 6a65 6374 2e20 6060 6b75 6265   project. ``kube
+00019560: 726e 6574 6573 6060 2070 726f 7669 6465  rnetes`` provide
+00019570: 7220 6f6e 6c79 2073 7570 706f 7274 7320  r only supports 
+00019580: 616e 2065 6d70 7479 206c 6973 742e 0a20  an empty list.. 
+00019590: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
+000195a0: 2020 2020 6966 2028 0a20 2020 2020 2020      if (.       
+000195b0: 2020 2020 2070 726f 7669 6465 7220 3d3d       provider ==
+000195c0: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
+000195d0: 6865 6d61 732e 5365 6372 6574 5072 6f76  hemas.SecretProv
+000195e0: 6964 6572 4e61 6d65 2e76 6175 6c74 2e76  iderName.vault.v
+000195f0: 616c 7565 0a20 2020 2020 2020 2020 2020  alue.           
+00019600: 2061 6e64 206e 6f74 2074 6f6b 656e 0a20   and not token. 
+00019610: 2020 2020 2020 2029 3a0a 2020 2020 2020         ):.      
+00019620: 2020 2020 2020 7261 6973 6520 4d4c 5275        raise MLRu
+00019630: 6e49 6e76 616c 6964 4172 6775 6d65 6e74  nInvalidArgument
+00019640: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
+00019650: 2020 2020 2020 2022 4120 7661 756c 7420         "A vault 
+00019660: 746f 6b65 6e20 6d75 7374 2062 6520 7072  token must be pr
+00019670: 6f76 6964 6564 2077 6865 6e20 6163 6365  ovided when acce
+00019680: 7373 696e 6720 7661 756c 7420 7365 6372  ssing vault secr
+00019690: 6574 7322 0a20 2020 2020 2020 2020 2020  ets".           
+000196a0: 2029 0a0a 2020 2020 2020 2020 7061 7468   )..        path
+000196b0: 203d 2066 2270 726f 6a65 6374 732f 7b70   = f"projects/{p
+000196c0: 726f 6a65 6374 7d2f 7365 6372 6574 7322  roject}/secrets"
+000196d0: 0a20 2020 2020 2020 2070 6172 616d 7320  .        params 
+000196e0: 3d20 7b22 7072 6f76 6964 6572 223a 2070  = {"provider": p
+000196f0: 726f 7669 6465 722c 2022 7365 6372 6574  rovider, "secret
+00019700: 223a 2073 6563 7265 7473 7d0a 2020 2020  ": secrets}.    
+00019710: 2020 2020 6865 6164 6572 7320 3d20 7b6d      headers = {m
+00019720: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
+00019730: 6d61 732e 4865 6164 6572 4e61 6d65 732e  mas.HeaderNames.
+00019740: 7365 6372 6574 5f73 746f 7265 5f74 6f6b  secret_store_tok
+00019750: 656e 3a20 746f 6b65 6e7d 0a20 2020 2020  en: token}.     
+00019760: 2020 2065 7272 6f72 5f6d 6573 7361 6765     error_message
+00019770: 203d 2066 2246 6169 6c65 6420 7265 7472   = f"Failed retr
+00019780: 6965 7669 6e67 2073 6563 7265 7473 207b  ieving secrets {
+00019790: 7072 6f6a 6563 747d 2f7b 7072 6f76 6964  project}/{provid
+000197a0: 6572 7d22 0a20 2020 2020 2020 2072 6573  er}".        res
+000197b0: 756c 7420 3d20 7365 6c66 2e61 7069 5f63  ult = self.api_c
+000197c0: 616c 6c28 0a20 2020 2020 2020 2020 2020  all(.           
+000197d0: 2022 4745 5422 2c0a 2020 2020 2020 2020   "GET",.        
+000197e0: 2020 2020 7061 7468 2c0a 2020 2020 2020      path,.      
+000197f0: 2020 2020 2020 6572 726f 725f 6d65 7373        error_mess
+00019800: 6167 652c 0a20 2020 2020 2020 2020 2020  age,.           
+00019810: 2070 6172 616d 733d 7061 7261 6d73 2c0a   params=params,.
+00019820: 2020 2020 2020 2020 2020 2020 6865 6164              head
+00019830: 6572 733d 6865 6164 6572 732c 0a20 2020  ers=headers,.   
+00019840: 2020 2020 2029 0a20 2020 2020 2020 2072       ).        r
+00019850: 6574 7572 6e20 6d6c 7275 6e2e 636f 6d6d  eturn mlrun.comm
+00019860: 6f6e 2e73 6368 656d 6173 2e53 6563 7265  on.schemas.Secre
+00019870: 7473 4461 7461 282a 2a72 6573 756c 742e  tsData(**result.
+00019880: 6a73 6f6e 2829 290a 0a20 2020 2064 6566  json())..    def
+00019890: 206c 6973 745f 7072 6f6a 6563 745f 7365   list_project_se
+000198a0: 6372 6574 5f6b 6579 7328 0a20 2020 2020  cret_keys(.     
+000198b0: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+000198c0: 2070 726f 6a65 6374 3a20 7374 722c 0a20   project: str,. 
+000198d0: 2020 2020 2020 2070 726f 7669 6465 723a         provider:
+000198e0: 2055 6e69 6f6e 5b0a 2020 2020 2020 2020   Union[.        
+000198f0: 2020 2020 7374 722c 206d 6c72 756e 2e63      str, mlrun.c
+00019900: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 5365  ommon.schemas.Se
+00019910: 6372 6574 5072 6f76 6964 6572 4e61 6d65  cretProviderName
+00019920: 0a20 2020 2020 2020 205d 203d 206d 6c72  .        ] = mlr
+00019930: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
+00019940: 732e 5365 6372 6574 5072 6f76 6964 6572  s.SecretProvider
+00019950: 4e61 6d65 2e6b 7562 6572 6e65 7465 732c  Name.kubernetes,
+00019960: 0a20 2020 2020 2020 2074 6f6b 656e 3a20  .        token: 
+00019970: 7374 7220 3d20 4e6f 6e65 2c0a 2020 2020  str = None,.    
+00019980: 2920 2d3e 206d 6c72 756e 2e63 6f6d 6d6f  ) -> mlrun.commo
+00019990: 6e2e 7363 6865 6d61 732e 5365 6372 6574  n.schemas.Secret
+000199a0: 4b65 7973 4461 7461 3a0a 2020 2020 2020  KeysData:.      
+000199b0: 2020 2222 2252 6574 7269 6576 6520 7072    """Retrieve pr
+000199c0: 6f6a 6563 742d 636f 6e74 6578 7420 7365  oject-context se
+000199d0: 6372 6574 206b 6579 7320 6672 6f6d 2056  cret keys from V
+000199e0: 6175 6c74 206f 7220 4b75 6265 726e 6574  ault or Kubernet
+000199f0: 6573 2e0a 0a20 2020 2020 2020 204e 6f74  es...        Not
+00019a00: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00019a10: 2020 2054 6869 7320 6d65 7468 6f64 2066     This method f
+00019a20: 6f72 2056 6175 6c74 2066 756e 6374 696f  or Vault functio
+00019a30: 6e61 6c69 7479 2069 7320 6375 7272 656e  nality is curren
+00019a40: 746c 7920 696e 2074 6563 686e 6963 616c  tly in technical
+00019a50: 2070 7265 7669 6577 2c20 616e 6420 7265   preview, and re
+00019a60: 7175 6972 6573 2061 2048 6173 6869 436f  quires a HashiCo
+00019a70: 7270 2056 6175 6c74 0a20 2020 2020 2020  rp Vault.       
+00019a80: 2020 2020 2020 2020 2069 6e66 7261 7374           infrast
+00019a90: 7275 6374 7572 6520 7072 6f70 6572 6c79  ructure properly
+00019aa0: 2073 6574 2075 7020 616e 6420 636f 6e6e   set up and conn
+00019ab0: 6563 7465 6420 746f 2074 6865 204d 4c52  ected to the MLR
+00019ac0: 756e 2041 5049 2073 6572 7665 722e 0a0a  un API server...
+00019ad0: 2020 2020 2020 2020 3a70 6172 616d 2070          :param p
+00019ae0: 726f 6a65 6374 3a20 5468 6520 7072 6f6a  roject: The proj
+00019af0: 6563 7420 6e61 6d65 2e0a 2020 2020 2020  ect name..      
+00019b00: 2020 3a70 6172 616d 2070 726f 7669 6465    :param provide
+00019b10: 723a 2054 6865 206e 616d 6520 6f66 2074  r: The name of t
+00019b20: 6865 2073 6563 7265 7473 2d70 726f 7669  he secrets-provi
+00019b30: 6465 7220 746f 2077 6f72 6b20 7769 7468  der to work with
+00019b40: 2e20 4163 6365 7074 7320 610a 2020 2020  . Accepts a.    
+00019b50: 2020 2020 2020 2020 3a70 793a 636c 6173          :py:clas
+00019b60: 733a 607e 6d6c 7275 6e2e 636f 6d6d 6f6e  s:`~mlrun.common
+00019b70: 2e73 6368 656d 6173 2e73 6563 7265 742e  .schemas.secret.
+00019b80: 5365 6372 6574 5072 6f76 6964 6572 4e61  SecretProviderNa
+00019b90: 6d65 6020 656e 756d 2e0a 2020 2020 2020  me` enum..      
+00019ba0: 2020 3a70 6172 616d 2074 6f6b 656e 3a20    :param token: 
+00019bb0: 5661 756c 7420 746f 6b65 6e20 746f 2075  Vault token to u
+00019bc0: 7365 2066 6f72 2072 6574 7269 6576 696e  se for retrievin
+00019bd0: 6720 7365 6372 6574 732e 204f 6e6c 7920  g secrets. Only 
+00019be0: 696e 2075 7365 2069 6620 6060 7072 6f76  in use if ``prov
+00019bf0: 6964 6572 6060 2069 7320 6060 7661 756c  ider`` is ``vaul
+00019c00: 7460 602e 0a20 2020 2020 2020 2020 2020  t``..           
+00019c10: 204d 7573 7420 6265 2061 2076 616c 6964   Must be a valid
+00019c20: 2056 6175 6c74 2074 6f6b 656e 2c20 7769   Vault token, wi
+00019c30: 7468 2070 6572 6d69 7373 696f 6e73 2074  th permissions t
+00019c40: 6f20 7265 7472 6965 7665 2073 6563 7265  o retrieve secre
+00019c50: 7473 206f 6620 7468 6520 7072 6f6a 6563  ts of the projec
+00019c60: 7420 696e 2071 7565 7374 696f 6e2e 0a20  t in question.. 
+00019c70: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
+00019c80: 2020 2020 6966 2028 0a20 2020 2020 2020      if (.       
+00019c90: 2020 2020 2070 726f 7669 6465 7220 3d3d       provider ==
+00019ca0: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
+00019cb0: 6865 6d61 732e 5365 6372 6574 5072 6f76  hemas.SecretProv
+00019cc0: 6964 6572 4e61 6d65 2e76 6175 6c74 2e76  iderName.vault.v
+00019cd0: 616c 7565 0a20 2020 2020 2020 2020 2020  alue.           
+00019ce0: 2061 6e64 206e 6f74 2074 6f6b 656e 0a20   and not token. 
+00019cf0: 2020 2020 2020 2029 3a0a 2020 2020 2020         ):.      
+00019d00: 2020 2020 2020 7261 6973 6520 4d4c 5275        raise MLRu
+00019d10: 6e49 6e76 616c 6964 4172 6775 6d65 6e74  nInvalidArgument
+00019d20: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
+00019d30: 2020 2020 2020 2022 4120 7661 756c 7420         "A vault 
+00019d40: 746f 6b65 6e20 6d75 7374 2062 6520 7072  token must be pr
+00019d50: 6f76 6964 6564 2077 6865 6e20 6163 6365  ovided when acce
+00019d60: 7373 696e 6720 7661 756c 7420 7365 6372  ssing vault secr
+00019d70: 6574 7322 0a20 2020 2020 2020 2020 2020  ets".           
+00019d80: 2029 0a0a 2020 2020 2020 2020 7061 7468   )..        path
+00019d90: 203d 2066 2270 726f 6a65 6374 732f 7b70   = f"projects/{p
+00019da0: 726f 6a65 6374 7d2f 7365 6372 6574 2d6b  roject}/secret-k
+00019db0: 6579 7322 0a20 2020 2020 2020 2070 6172  eys".        par
+00019dc0: 616d 7320 3d20 7b22 7072 6f76 6964 6572  ams = {"provider
+00019dd0: 223a 2070 726f 7669 6465 727d 0a20 2020  ": provider}.   
+00019de0: 2020 2020 2068 6561 6465 7273 203d 2028       headers = (
+00019df0: 0a20 2020 2020 2020 2020 2020 207b 6d6c  .            {ml
+00019e00: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
+00019e10: 6173 2e48 6561 6465 724e 616d 6573 2e73  as.HeaderNames.s
+00019e20: 6563 7265 745f 7374 6f72 655f 746f 6b65  ecret_store_toke
+00019e30: 6e3a 2074 6f6b 656e 7d0a 2020 2020 2020  n: token}.      
+00019e40: 2020 2020 2020 6966 2070 726f 7669 6465        if provide
+00019e50: 7220 3d3d 206d 6c72 756e 2e63 6f6d 6d6f  r == mlrun.commo
+00019e60: 6e2e 7363 6865 6d61 732e 5365 6372 6574  n.schemas.Secret
+00019e70: 5072 6f76 6964 6572 4e61 6d65 2e76 6175  ProviderName.vau
+00019e80: 6c74 2e76 616c 7565 0a20 2020 2020 2020  lt.value.       
+00019e90: 2020 2020 2065 6c73 6520 4e6f 6e65 0a20       else None. 
+00019ea0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00019eb0: 2065 7272 6f72 5f6d 6573 7361 6765 203d   error_message =
+00019ec0: 2066 2246 6169 6c65 6420 7265 7472 6965   f"Failed retrie
+00019ed0: 7669 6e67 2073 6563 7265 7420 6b65 7973  ving secret keys
+00019ee0: 207b 7072 6f6a 6563 747d 2f7b 7072 6f76   {project}/{prov
+00019ef0: 6964 6572 7d22 0a20 2020 2020 2020 2072  ider}".        r
+00019f00: 6573 756c 7420 3d20 7365 6c66 2e61 7069  esult = self.api
+00019f10: 5f63 616c 6c28 0a20 2020 2020 2020 2020  _call(.         
+00019f20: 2020 2022 4745 5422 2c0a 2020 2020 2020     "GET",.      
+00019f30: 2020 2020 2020 7061 7468 2c0a 2020 2020        path,.    
+00019f40: 2020 2020 2020 2020 6572 726f 725f 6d65          error_me
+00019f50: 7373 6167 652c 0a20 2020 2020 2020 2020  ssage,.         
+00019f60: 2020 2070 6172 616d 733d 7061 7261 6d73     params=params
+00019f70: 2c0a 2020 2020 2020 2020 2020 2020 6865  ,.            he
+00019f80: 6164 6572 733d 6865 6164 6572 732c 0a20  aders=headers,. 
+00019f90: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00019fa0: 2072 6574 7572 6e20 6d6c 7275 6e2e 636f   return mlrun.co
+00019fb0: 6d6d 6f6e 2e73 6368 656d 6173 2e53 6563  mmon.schemas.Sec
+00019fc0: 7265 744b 6579 7344 6174 6128 2a2a 7265  retKeysData(**re
+00019fd0: 7375 6c74 2e6a 736f 6e28 2929 0a0a 2020  sult.json())..  
+00019fe0: 2020 6465 6620 6465 6c65 7465 5f70 726f    def delete_pro
+00019ff0: 6a65 6374 5f73 6563 7265 7473 280a 2020  ject_secrets(.  
+0001a000: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+0001a010: 2020 2020 7072 6f6a 6563 743a 2073 7472      project: str
+0001a020: 2c0a 2020 2020 2020 2020 7072 6f76 6964  ,.        provid
+0001a030: 6572 3a20 556e 696f 6e5b 0a20 2020 2020  er: Union[.     
+0001a040: 2020 2020 2020 2073 7472 2c20 6d6c 7275         str, mlru
+0001a050: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
+0001a060: 2e53 6563 7265 7450 726f 7669 6465 724e  .SecretProviderN
+0001a070: 616d 650a 2020 2020 2020 2020 5d20 3d20  ame.        ] = 
+0001a080: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
+0001a090: 656d 6173 2e53 6563 7265 7450 726f 7669  emas.SecretProvi
+0001a0a0: 6465 724e 616d 652e 6b75 6265 726e 6574  derName.kubernet
+0001a0b0: 6573 2c0a 2020 2020 2020 2020 7365 6372  es,.        secr
+0001a0c0: 6574 733a 204c 6973 745b 7374 725d 203d  ets: List[str] =
+0001a0d0: 204e 6f6e 652c 0a20 2020 2029 3a0a 2020   None,.    ):.  
+0001a0e0: 2020 2020 2020 2222 2244 656c 6574 6520        """Delete 
+0001a0f0: 7072 6f6a 6563 742d 636f 6e74 6578 7420  project-context 
+0001a100: 7365 6372 6574 7320 6672 6f6d 204b 7562  secrets from Kub
+0001a110: 6572 6e65 7465 732e 0a0a 2020 2020 2020  ernetes...      
+0001a120: 2020 3a70 6172 616d 2070 726f 6a65 6374    :param project
+0001a130: 3a20 5468 6520 7072 6f6a 6563 7420 6e61  : The project na
+0001a140: 6d65 2e0a 2020 2020 2020 2020 3a70 6172  me..        :par
+0001a150: 616d 2070 726f 7669 6465 723a 2054 6865  am provider: The
+0001a160: 206e 616d 6520 6f66 2074 6865 2073 6563   name of the sec
+0001a170: 7265 7473 2d70 726f 7669 6465 7220 746f  rets-provider to
+0001a180: 2077 6f72 6b20 7769 7468 2e20 4375 7272   work with. Curr
+0001a190: 656e 746c 7920 6f6e 6c79 2060 606b 7562  ently only ``kub
+0001a1a0: 6572 6e65 7465 7360 6020 6973 2073 7570  ernetes`` is sup
+0001a1b0: 706f 7274 6564 2e0a 2020 2020 2020 2020  ported..        
+0001a1c0: 3a70 6172 616d 2073 6563 7265 7473 3a20  :param secrets: 
+0001a1d0: 4120 6c69 7374 206f 6620 7365 6372 6574  A list of secret
+0001a1e0: 206e 616d 6573 2074 6f20 6465 6c65 7465   names to delete
+0001a1f0: 2e20 416e 2065 6d70 7479 206c 6973 7420  . An empty list 
+0001a200: 7769 6c6c 2064 656c 6574 6520 616c 6c20  will delete all 
+0001a210: 7365 6372 6574 7320 6173 7369 676e 6564  secrets assigned
+0001a220: 0a20 2020 2020 2020 2020 2020 2074 6f20  .            to 
+0001a230: 7468 6973 2073 7065 6369 6669 6320 7072  this specific pr
+0001a240: 6f6a 6563 742e 0a20 2020 2020 2020 2022  oject..        "
+0001a250: 2222 0a0a 2020 2020 2020 2020 7061 7468  ""..        path
+0001a260: 203d 2066 2270 726f 6a65 6374 732f 7b70   = f"projects/{p
+0001a270: 726f 6a65 6374 7d2f 7365 6372 6574 7322  roject}/secrets"
+0001a280: 0a20 2020 2020 2020 2070 6172 616d 7320  .        params 
+0001a290: 3d20 7b22 7072 6f76 6964 6572 223a 2070  = {"provider": p
+0001a2a0: 726f 7669 6465 722c 2022 7365 6372 6574  rovider, "secret
+0001a2b0: 223a 2073 6563 7265 7473 7d0a 2020 2020  ": secrets}.    
+0001a2c0: 2020 2020 6572 726f 725f 6d65 7373 6167      error_messag
+0001a2d0: 6520 3d20 6622 4661 696c 6564 2064 656c  e = f"Failed del
+0001a2e0: 6574 696e 6720 7365 6372 6574 7320 7b70  eting secrets {p
+0001a2f0: 726f 6a65 6374 7d2f 7b70 726f 7669 6465  roject}/{provide
+0001a300: 727d 220a 2020 2020 2020 2020 7365 6c66  r}".        self
+0001a310: 2e61 7069 5f63 616c 6c28 0a20 2020 2020  .api_call(.     
+0001a320: 2020 2020 2020 2022 4445 4c45 5445 222c         "DELETE",
+0001a330: 0a20 2020 2020 2020 2020 2020 2070 6174  .            pat
+0001a340: 682c 0a20 2020 2020 2020 2020 2020 2065  h,.            e
+0001a350: 7272 6f72 5f6d 6573 7361 6765 2c0a 2020  rror_message,.  
+0001a360: 2020 2020 2020 2020 2020 7061 7261 6d73            params
+0001a370: 3d70 6172 616d 732c 0a20 2020 2020 2020  =params,.       
+0001a380: 2029 0a0a 2020 2020 6465 6620 6372 6561   )..    def crea
+0001a390: 7465 5f75 7365 725f 7365 6372 6574 7328  te_user_secrets(
+0001a3a0: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+0001a3b0: 2020 2020 2020 2075 7365 723a 2073 7472         user: str
+0001a3c0: 2c0a 2020 2020 2020 2020 7072 6f76 6964  ,.        provid
+0001a3d0: 6572 3a20 556e 696f 6e5b 0a20 2020 2020  er: Union[.     
+0001a3e0: 2020 2020 2020 2073 7472 2c20 6d6c 7275         str, mlru
+0001a3f0: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
+0001a400: 2e53 6563 7265 7450 726f 7669 6465 724e  .SecretProviderN
+0001a410: 616d 650a 2020 2020 2020 2020 5d20 3d20  ame.        ] = 
+0001a420: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
+0001a430: 656d 6173 2e53 6563 7265 7450 726f 7669  emas.SecretProvi
+0001a440: 6465 724e 616d 652e 7661 756c 742c 0a20  derName.vault,. 
+0001a450: 2020 2020 2020 2073 6563 7265 7473 3a20         secrets: 
+0001a460: 6469 6374 203d 204e 6f6e 652c 0a20 2020  dict = None,.   
+0001a470: 2029 3a0a 2020 2020 2020 2020 2222 2243   ):.        """C
+0001a480: 7265 6174 6520 7573 6572 2d63 6f6e 7465  reate user-conte
+0001a490: 7874 2073 6563 7265 7420 696e 2056 6175  xt secret in Vau
+0001a4a0: 6c74 2e20 506c 6561 7365 2072 6566 6572  lt. Please refer
+0001a4b0: 2074 6f20 3a70 793a 6675 6e63 3a60 6372   to :py:func:`cr
+0001a4c0: 6561 7465 5f70 726f 6a65 6374 5f73 6563  eate_project_sec
+0001a4d0: 7265 7473 6020 666f 7220 6d6f 7265 2064  rets` for more d
+0001a4e0: 6574 6169 6c73 0a20 2020 2020 2020 2061  etails.        a
+0001a4f0: 6e64 2073 7461 7475 7320 6f66 2074 6869  nd status of thi
+0001a500: 7320 6675 6e63 7469 6f6e 616c 6974 792e  s functionality.
+0001a510: 0a0a 2020 2020 2020 2020 4e6f 7465 3a0a  ..        Note:.
+0001a520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a530: 5468 6973 206d 6574 686f 6420 6973 2063  This method is c
+0001a540: 7572 7265 6e74 6c79 2069 6e20 7465 6368  urrently in tech
+0001a550: 6e69 6361 6c20 7072 6576 6965 772c 2061  nical preview, a
+0001a560: 6e64 2072 6571 7569 7265 7320 6120 4861  nd requires a Ha
+0001a570: 7368 6943 6f72 7020 5661 756c 7420 696e  shiCorp Vault in
+0001a580: 6672 6173 7472 7563 7475 7265 0a20 2020  frastructure.   
+0001a590: 2020 2020 2020 2020 2020 2020 2070 726f               pro
+0001a5a0: 7065 726c 7920 7365 7420 7570 2061 6e64  perly set up and
+0001a5b0: 2063 6f6e 6e65 6374 6564 2074 6f20 7468   connected to th
+0001a5c0: 6520 4d4c 5275 6e20 4150 4920 7365 7276  e MLRun API serv
+0001a5d0: 6572 2e0a 0a20 2020 2020 2020 203a 7061  er...        :pa
+0001a5e0: 7261 6d20 7573 6572 3a20 5468 6520 7573  ram user: The us
+0001a5f0: 6572 2063 6f6e 7465 7874 2066 6f72 2077  er context for w
+0001a600: 6869 6368 2074 6f20 6765 6e65 7261 7465  hich to generate
+0001a610: 2074 6865 2069 6e66 7261 2061 6e64 2073   the infra and s
+0001a620: 746f 7265 2073 6563 7265 7473 2e0a 2020  tore secrets..  
+0001a630: 2020 2020 2020 3a70 6172 616d 2070 726f        :param pro
+0001a640: 7669 6465 723a 2054 6865 206e 616d 6520  vider: The name 
+0001a650: 6f66 2074 6865 2073 6563 7265 7473 2d70  of the secrets-p
+0001a660: 726f 7669 6465 7220 746f 2077 6f72 6b20  rovider to work 
+0001a670: 7769 7468 2e20 4375 7272 656e 746c 7920  with. Currently 
+0001a680: 6f6e 6c79 2060 6076 6175 6c74 6060 2069  only ``vault`` i
+0001a690: 7320 7375 7070 6f72 7465 642e 0a20 2020  s supported..   
+0001a6a0: 2020 2020 203a 7061 7261 6d20 7365 6372       :param secr
+0001a6b0: 6574 733a 2041 2073 6574 206f 6620 7365  ets: A set of se
+0001a6c0: 6372 6574 2076 616c 7565 7320 746f 2073  cret values to s
+0001a6d0: 746f 7265 2077 6974 6869 6e20 7468 6520  tore within the 
+0001a6e0: 5661 756c 742e 0a20 2020 2020 2020 2022  Vault..        "
+0001a6f0: 2222 0a20 2020 2020 2020 2070 6174 6820  "".        path 
+0001a700: 3d20 2275 7365 722d 7365 6372 6574 7322  = "user-secrets"
+0001a710: 0a20 2020 2020 2020 2073 6563 7265 7473  .        secrets
+0001a720: 5f63 7265 6174 696f 6e5f 7265 7175 6573  _creation_reques
+0001a730: 7420 3d20 6d6c 7275 6e2e 636f 6d6d 6f6e  t = mlrun.common
+0001a740: 2e73 6368 656d 6173 2e55 7365 7253 6563  .schemas.UserSec
+0001a750: 7265 7443 7265 6174 696f 6e52 6571 7565  retCreationReque
+0001a760: 7374 280a 2020 2020 2020 2020 2020 2020  st(.            
+0001a770: 7573 6572 3d75 7365 722c 0a20 2020 2020  user=user,.     
+0001a780: 2020 2020 2020 2070 726f 7669 6465 723d         provider=
+0001a790: 7072 6f76 6964 6572 2c0a 2020 2020 2020  provider,.      
+0001a7a0: 2020 2020 2020 7365 6372 6574 733d 7365        secrets=se
+0001a7b0: 6372 6574 732c 0a20 2020 2020 2020 2029  crets,.        )
+0001a7c0: 0a20 2020 2020 2020 2062 6f64 7920 3d20  .        body = 
+0001a7d0: 7365 6372 6574 735f 6372 6561 7469 6f6e  secrets_creation
+0001a7e0: 5f72 6571 7565 7374 2e64 6963 7428 290a  _request.dict().
+0001a7f0: 2020 2020 2020 2020 6572 726f 725f 6d65          error_me
+0001a800: 7373 6167 6520 3d20 6622 4661 696c 6564  ssage = f"Failed
+0001a810: 2063 7265 6174 696e 6720 7573 6572 2073   creating user s
+0001a820: 6563 7265 7473 202d 207b 7573 6572 7d22  ecrets - {user}"
+0001a830: 0a20 2020 2020 2020 2073 656c 662e 6170  .        self.ap
+0001a840: 695f 6361 6c6c 280a 2020 2020 2020 2020  i_call(.        
+0001a850: 2020 2020 2250 4f53 5422 2c0a 2020 2020      "POST",.    
+0001a860: 2020 2020 2020 2020 7061 7468 2c0a 2020          path,.  
+0001a870: 2020 2020 2020 2020 2020 6572 726f 725f            error_
+0001a880: 6d65 7373 6167 652c 0a20 2020 2020 2020  message,.       
+0001a890: 2020 2020 2062 6f64 793d 6469 6374 5f74       body=dict_t
+0001a8a0: 6f5f 6a73 6f6e 2862 6f64 7929 2c0a 2020  o_json(body),.  
+0001a8b0: 2020 2020 2020 290a 0a20 2020 2040 7374        )..    @st
+0001a8c0: 6174 6963 6d65 7468 6f64 0a20 2020 2064  aticmethod.    d
+0001a8d0: 6566 205f 7661 6c69 6461 7465 5f76 6572  ef _validate_ver
+0001a8e0: 7369 6f6e 5f63 6f6d 7061 7469 6269 6c69  sion_compatibili
+0001a8f0: 7479 2873 6572 7665 725f 7665 7273 696f  ty(server_versio
+0001a900: 6e2c 2063 6c69 656e 745f 7665 7273 696f  n, client_versio
+0001a910: 6e29 202d 3e20 626f 6f6c 3a0a 2020 2020  n) -> bool:.    
+0001a920: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
+0001a930: 2020 2020 2070 6172 7365 645f 7365 7276       parsed_serv
+0001a940: 6572 5f76 6572 7369 6f6e 203d 2073 656d  er_version = sem
+0001a950: 7665 722e 5665 7273 696f 6e49 6e66 6f2e  ver.VersionInfo.
+0001a960: 7061 7273 6528 7365 7276 6572 5f76 6572  parse(server_ver
+0001a970: 7369 6f6e 290a 2020 2020 2020 2020 2020  sion).          
+0001a980: 2020 7061 7273 6564 5f63 6c69 656e 745f    parsed_client_
+0001a990: 7665 7273 696f 6e20 3d20 7365 6d76 6572  version = semver
+0001a9a0: 2e56 6572 7369 6f6e 496e 666f 2e70 6172  .VersionInfo.par
+0001a9b0: 7365 2863 6c69 656e 745f 7665 7273 696f  se(client_versio
+0001a9c0: 6e29 0a20 2020 2020 2020 2065 7863 6570  n).        excep
+0001a9d0: 7420 5661 6c75 6545 7272 6f72 3a0a 2020  t ValueError:.  
+0001a9e0: 2020 2020 2020 2020 2020 2320 5468 6973            # This
+0001a9f0: 2077 696c 6c20 6d6f 7374 6c79 2068 6170   will mostly hap
+0001aa00: 7065 6e20 696e 2064 6576 2073 6365 6e61  pen in dev scena
+0001aa10: 7269 6f73 2077 6865 6e20 7468 6520 7665  rios when the ve
+0001aa20: 7273 696f 6e20 6973 2075 6e73 7461 626c  rsion is unstabl
+0001aa30: 6520 616e 6420 7375 6368 202d 2074 6865  e and such - the
+0001aa40: 7265 666f 7265 2077 6527 7265 2069 676e  refore we're ign
+0001aa50: 6f72 696e 670a 2020 2020 2020 2020 2020  oring.          
+0001aa60: 2020 6c6f 6767 6572 2e77 6172 6e69 6e67    logger.warning
+0001aa70: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0001aa80: 2020 2255 6e61 626c 6520 746f 2070 6172    "Unable to par
+0001aa90: 7365 2073 6572 7665 7220 6f72 2063 6c69  se server or cli
+0001aaa0: 656e 7420 7665 7273 696f 6e2e 2041 7373  ent version. Ass
+0001aab0: 756d 696e 6720 636f 6d70 6174 6962 6c65  uming compatible
+0001aac0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+0001aad0: 2020 2073 6572 7665 725f 7665 7273 696f     server_versio
+0001aae0: 6e3d 7365 7276 6572 5f76 6572 7369 6f6e  n=server_version
+0001aaf0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001ab00: 2020 636c 6965 6e74 5f76 6572 7369 6f6e    client_version
+0001ab10: 3d63 6c69 656e 745f 7665 7273 696f 6e2c  =client_version,
+0001ab20: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+0001ab30: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0001ab40: 6e20 5472 7565 0a20 2020 2020 2020 2069  n True.        i
+0001ab50: 6620 2870 6172 7365 645f 7365 7276 6572  f (parsed_server
+0001ab60: 5f76 6572 7369 6f6e 2e6d 616a 6f72 203d  _version.major =
+0001ab70: 3d20 3020 616e 6420 7061 7273 6564 5f73  = 0 and parsed_s
+0001ab80: 6572 7665 725f 7665 7273 696f 6e2e 6d69  erver_version.mi
+0001ab90: 6e6f 7220 3d3d 2030 2920 6f72 2028 0a20  nor == 0) or (. 
+0001aba0: 2020 2020 2020 2020 2020 2070 6172 7365             parse
+0001abb0: 645f 636c 6965 6e74 5f76 6572 7369 6f6e  d_client_version
+0001abc0: 2e6d 616a 6f72 203d 3d20 3020 616e 6420  .major == 0 and 
+0001abd0: 7061 7273 6564 5f63 6c69 656e 745f 7665  parsed_client_ve
+0001abe0: 7273 696f 6e2e 6d69 6e6f 7220 3d3d 2030  rsion.minor == 0
+0001abf0: 0a20 2020 2020 2020 2029 3a0a 2020 2020  .        ):.    
+0001ac00: 2020 2020 2020 2020 6c6f 6767 6572 2e77          logger.w
+0001ac10: 6172 6e69 6e67 280a 2020 2020 2020 2020  arning(.        
+0001ac20: 2020 2020 2020 2020 2253 6572 7665 7220          "Server 
+0001ac30: 6f72 2063 6c69 656e 7420 7665 7273 696f  or client versio
+0001ac40: 6e20 6973 2075 6e73 7461 626c 652e 2041  n is unstable. A
+0001ac50: 7373 756d 696e 6720 636f 6d70 6174 6962  ssuming compatib
+0001ac60: 6c65 222c 0a20 2020 2020 2020 2020 2020  le",.           
+0001ac70: 2020 2020 2073 6572 7665 725f 7665 7273       server_vers
+0001ac80: 696f 6e3d 7365 7276 6572 5f76 6572 7369  ion=server_versi
+0001ac90: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
+0001aca0: 2020 2020 636c 6965 6e74 5f76 6572 7369      client_versi
+0001acb0: 6f6e 3d63 6c69 656e 745f 7665 7273 696f  on=client_versio
+0001acc0: 6e2c 0a20 2020 2020 2020 2020 2020 2029  n,.            )
+0001acd0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0001ace0: 7572 6e20 5472 7565 0a20 2020 2020 2020  urn True.       
+0001acf0: 2069 6620 7061 7273 6564 5f73 6572 7665   if parsed_serve
+0001ad00: 725f 7665 7273 696f 6e2e 6d61 6a6f 7220  r_version.major 
+0001ad10: 213d 2070 6172 7365 645f 636c 6965 6e74  != parsed_client
+0001ad20: 5f76 6572 7369 6f6e 2e6d 616a 6f72 3a0a  _version.major:.
+0001ad30: 2020 2020 2020 2020 2020 2020 6c6f 6767              logg
+0001ad40: 6572 2e77 6172 6e69 6e67 280a 2020 2020  er.warning(.    
+0001ad50: 2020 2020 2020 2020 2020 2020 2253 6572              "Ser
+0001ad60: 7665 7220 616e 6420 636c 6965 6e74 2076  ver and client v
+0001ad70: 6572 7369 6f6e 7320 6172 6520 696e 636f  ersions are inco
+0001ad80: 6d70 6174 6962 6c65 222c 0a20 2020 2020  mpatible",.     
+0001ad90: 2020 2020 2020 2020 2020 2070 6172 7365             parse
+0001ada0: 645f 7365 7276 6572 5f76 6572 7369 6f6e  d_server_version
+0001adb0: 3d70 6172 7365 645f 7365 7276 6572 5f76  =parsed_server_v
+0001adc0: 6572 7369 6f6e 2c0a 2020 2020 2020 2020  ersion,.        
+0001add0: 2020 2020 2020 2020 7061 7273 6564 5f63          parsed_c
+0001ade0: 6c69 656e 745f 7665 7273 696f 6e3d 7061  lient_version=pa
+0001adf0: 7273 6564 5f63 6c69 656e 745f 7665 7273  rsed_client_vers
+0001ae00: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
+0001ae10: 2029 0a20 2020 2020 2020 2020 2020 2072   ).            r
+0001ae20: 6574 7572 6e20 4661 6c73 650a 2020 2020  eturn False.    
+0001ae30: 2020 2020 6966 2070 6172 7365 645f 7365      if parsed_se
+0001ae40: 7276 6572 5f76 6572 7369 6f6e 2e6d 696e  rver_version.min
+0001ae50: 6f72 203e 2070 6172 7365 645f 636c 6965  or > parsed_clie
+0001ae60: 6e74 5f76 6572 7369 6f6e 2e6d 696e 6f72  nt_version.minor
+0001ae70: 202b 2032 3a0a 2020 2020 2020 2020 2020   + 2:.          
+0001ae80: 2020 6c6f 6767 6572 2e69 6e66 6f28 0a20    logger.info(. 
+0001ae90: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0001aea0: 4261 636b 7761 7264 7320 636f 6d70 6174  Backwards compat
+0001aeb0: 6962 696c 6974 7920 6d69 6768 7420 6e6f  ibility might no
+0001aec0: 7420 6170 706c 7920 6265 7477 6565 6e20  t apply between 
+0001aed0: 7468 6520 7365 7276 6572 2061 6e64 2063  the server and c
+0001aee0: 6c69 656e 7420 7665 7273 696f 6e22 2c0a  lient version",.
+0001aef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001af00: 7061 7273 6564 5f73 6572 7665 725f 7665  parsed_server_ve
+0001af10: 7273 696f 6e3d 7061 7273 6564 5f73 6572  rsion=parsed_ser
+0001af20: 7665 725f 7665 7273 696f 6e2c 0a20 2020  ver_version,.   
+0001af30: 2020 2020 2020 2020 2020 2020 2070 6172               par
+0001af40: 7365 645f 636c 6965 6e74 5f76 6572 7369  sed_client_versi
+0001af50: 6f6e 3d70 6172 7365 645f 636c 6965 6e74  on=parsed_client
+0001af60: 5f76 6572 7369 6f6e 2c0a 2020 2020 2020  _version,.      
+0001af70: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0001af80: 2020 2020 7265 7475 726e 2046 616c 7365      return False
+0001af90: 0a20 2020 2020 2020 2069 6620 7061 7273  .        if pars
+0001afa0: 6564 5f63 6c69 656e 745f 7665 7273 696f  ed_client_versio
+0001afb0: 6e2e 6d69 6e6f 7220 3e20 7061 7273 6564  n.minor > parsed
+0001afc0: 5f73 6572 7665 725f 7665 7273 696f 6e2e  _server_version.
+0001afd0: 6d69 6e6f 723a 0a20 2020 2020 2020 2020  minor:.         
+0001afe0: 2020 206c 6f67 6765 722e 7761 726e 696e     logger.warnin
+0001aff0: 6728 0a20 2020 2020 2020 2020 2020 2020  g(.             
+0001b000: 2020 2022 436c 6965 6e74 2076 6572 7369     "Client versi
+0001b010: 6f6e 2077 6974 6820 6869 6768 6572 2076  on with higher v
+0001b020: 6572 7369 6f6e 2074 6861 6e20 7365 7276  ersion than serv
+0001b030: 6572 2076 6572 7369 6f6e 2069 736e 2774  er version isn't
+0001b040: 2073 7570 706f 7274 6564 2c22 0a20 2020   supported,".   
+0001b050: 2020 2020 2020 2020 2020 2020 2022 2061               " a
+0001b060: 6c69 676e 2079 6f75 7220 636c 6965 6e74  lign your client
+0001b070: 2074 6f20 7468 6520 7365 7276 6572 2076   to the server v
+0001b080: 6572 7369 6f6e 222c 0a20 2020 2020 2020  ersion",.       
+0001b090: 2020 2020 2020 2020 2070 6172 7365 645f           parsed_
+0001b0a0: 7365 7276 6572 5f76 6572 7369 6f6e 3d70  server_version=p
+0001b0b0: 6172 7365 645f 7365 7276 6572 5f76 6572  arsed_server_ver
+0001b0c0: 7369 6f6e 2c0a 2020 2020 2020 2020 2020  sion,.          
+0001b0d0: 2020 2020 2020 7061 7273 6564 5f63 6c69        parsed_cli
+0001b0e0: 656e 745f 7665 7273 696f 6e3d 7061 7273  ent_version=pars
+0001b0f0: 6564 5f63 6c69 656e 745f 7665 7273 696f  ed_client_versio
+0001b100: 6e2c 0a20 2020 2020 2020 2020 2020 2029  n,.            )
+0001b110: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0001b120: 7572 6e20 4661 6c73 650a 2020 2020 2020  urn False.      
+0001b130: 2020 6966 2070 6172 7365 645f 7365 7276    if parsed_serv
+0001b140: 6572 5f76 6572 7369 6f6e 2e6d 696e 6f72  er_version.minor
+0001b150: 2021 3d20 7061 7273 6564 5f63 6c69 656e   != parsed_clien
+0001b160: 745f 7665 7273 696f 6e2e 6d69 6e6f 723a  t_version.minor:
+0001b170: 0a20 2020 2020 2020 2020 2020 206c 6f67  .            log
+0001b180: 6765 722e 696e 666f 280a 2020 2020 2020  ger.info(.      
+0001b190: 2020 2020 2020 2020 2020 2253 6572 7665            "Serve
+0001b1a0: 7220 616e 6420 636c 6965 6e74 2076 6572  r and client ver
+0001b1b0: 7369 6f6e 7320 6172 6520 6e6f 7420 7468  sions are not th
+0001b1c0: 6520 7361 6d65 2062 7574 2063 6f6d 7061  e same but compa
+0001b1d0: 7469 626c 6522 2c0a 2020 2020 2020 2020  tible",.        
+0001b1e0: 2020 2020 2020 2020 7061 7273 6564 5f73          parsed_s
+0001b1f0: 6572 7665 725f 7665 7273 696f 6e3d 7061  erver_version=pa
+0001b200: 7273 6564 5f73 6572 7665 725f 7665 7273  rsed_server_vers
+0001b210: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
+0001b220: 2020 2020 2070 6172 7365 645f 636c 6965       parsed_clie
+0001b230: 6e74 5f76 6572 7369 6f6e 3d70 6172 7365  nt_version=parse
+0001b240: 645f 636c 6965 6e74 5f76 6572 7369 6f6e  d_client_version
+0001b250: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
+0001b260: 2020 2020 2020 2020 7265 7475 726e 2054          return T
+0001b270: 7275 650a 0a20 2020 2064 6566 2063 7265  rue..    def cre
+0001b280: 6174 655f 6d6f 6465 6c5f 656e 6470 6f69  ate_model_endpoi
+0001b290: 6e74 280a 2020 2020 2020 2020 7365 6c66  nt(.        self
+0001b2a0: 2c0a 2020 2020 2020 2020 7072 6f6a 6563  ,.        projec
+0001b2b0: 743a 2073 7472 2c0a 2020 2020 2020 2020  t: str,.        
+0001b2c0: 656e 6470 6f69 6e74 5f69 643a 2073 7472  endpoint_id: str
+0001b2d0: 2c0a 2020 2020 2020 2020 6d6f 6465 6c5f  ,.        model_
+0001b2e0: 656e 6470 6f69 6e74 3a20 556e 696f 6e5b  endpoint: Union[
+0001b2f0: 0a20 2020 2020 2020 2020 2020 206d 6c72  .            mlr
+0001b300: 756e 2e6d 6f64 656c 5f6d 6f6e 6974 6f72  un.model_monitor
+0001b310: 696e 672e 6d6f 6465 6c5f 656e 6470 6f69  ing.model_endpoi
+0001b320: 6e74 2e4d 6f64 656c 456e 6470 6f69 6e74  nt.ModelEndpoint
+0001b330: 2c20 6469 6374 0a20 2020 2020 2020 205d  , dict.        ]
+0001b340: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
+0001b350: 2022 2222 0a20 2020 2020 2020 2043 7265   """.        Cre
+0001b360: 6174 6573 2061 2044 4220 7265 636f 7264  ates a DB record
+0001b370: 2077 6974 6820 7468 6520 6769 7665 6e20   with the given 
+0001b380: 6d6f 6465 6c5f 656e 6470 6f69 6e74 2072  model_endpoint r
+0001b390: 6563 6f72 642e 0a0a 2020 2020 2020 2020  ecord...        
+0001b3a0: 3a70 6172 616d 2070 726f 6a65 6374 3a20  :param project: 
+0001b3b0: 5468 6520 6e61 6d65 206f 6620 7468 6520  The name of the 
+0001b3c0: 7072 6f6a 6563 742e 0a20 2020 2020 2020  project..       
+0001b3d0: 203a 7061 7261 6d20 656e 6470 6f69 6e74   :param endpoint
+0001b3e0: 5f69 643a 2054 6865 2069 6420 6f66 2074  _id: The id of t
+0001b3f0: 6865 2065 6e64 706f 696e 742e 0a20 2020  he endpoint..   
+0001b400: 2020 2020 203a 7061 7261 6d20 6d6f 6465       :param mode
+0001b410: 6c5f 656e 6470 6f69 6e74 3a20 416e 206f  l_endpoint: An o
+0001b420: 626a 6563 7420 7265 7072 6573 656e 7469  bject representi
+0001b430: 6e67 2074 6865 206d 6f64 656c 2065 6e64  ng the model end
+0001b440: 706f 696e 742e 0a20 2020 2020 2020 2022  point..        "
+0001b450: 2222 0a0a 2020 2020 2020 2020 6966 2069  ""..        if i
+0001b460: 7369 6e73 7461 6e63 6528 0a20 2020 2020  sinstance(.     
+0001b470: 2020 2020 2020 206d 6f64 656c 5f65 6e64         model_end
+0001b480: 706f 696e 742c 206d 6c72 756e 2e6d 6f64  point, mlrun.mod
+0001b490: 656c 5f6d 6f6e 6974 6f72 696e 672e 6d6f  el_monitoring.mo
+0001b4a0: 6465 6c5f 656e 6470 6f69 6e74 2e4d 6f64  del_endpoint.Mod
+0001b4b0: 656c 456e 6470 6f69 6e74 0a20 2020 2020  elEndpoint.     
+0001b4c0: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
+0001b4d0: 2020 6d6f 6465 6c5f 656e 6470 6f69 6e74    model_endpoint
+0001b4e0: 203d 206d 6f64 656c 5f65 6e64 706f 696e   = model_endpoin
+0001b4f0: 742e 746f 5f64 6963 7428 290a 0a20 2020  t.to_dict()..   
+0001b500: 2020 2020 2070 6174 6820 3d20 6622 7072       path = f"pr
+0001b510: 6f6a 6563 7473 2f7b 7072 6f6a 6563 747d  ojects/{project}
+0001b520: 2f6d 6f64 656c 2d65 6e64 706f 696e 7473  /model-endpoints
+0001b530: 2f7b 656e 6470 6f69 6e74 5f69 647d 220a  /{endpoint_id}".
+0001b540: 2020 2020 2020 2020 7365 6c66 2e61 7069          self.api
+0001b550: 5f63 616c 6c28 0a20 2020 2020 2020 2020  _call(.         
+0001b560: 2020 206d 6574 686f 643d 2250 4f53 5422     method="POST"
+0001b570: 2c0a 2020 2020 2020 2020 2020 2020 7061  ,.            pa
+0001b580: 7468 3d70 6174 682c 0a20 2020 2020 2020  th=path,.       
+0001b590: 2020 2020 2062 6f64 793d 6469 6374 5f74       body=dict_t
+0001b5a0: 6f5f 6a73 6f6e 286d 6f64 656c 5f65 6e64  o_json(model_end
+0001b5b0: 706f 696e 7429 2c0a 2020 2020 2020 2020  point),.        
+0001b5c0: 290a 0a20 2020 2064 6566 2064 656c 6574  )..    def delet
+0001b5d0: 655f 6d6f 6465 6c5f 656e 6470 6f69 6e74  e_model_endpoint
+0001b5e0: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+0001b5f0: 2020 2020 2020 2020 7072 6f6a 6563 743a          project:
+0001b600: 2073 7472 2c0a 2020 2020 2020 2020 656e   str,.        en
+0001b610: 6470 6f69 6e74 5f69 643a 2073 7472 2c0a  dpoint_id: str,.
+0001b620: 2020 2020 293a 0a20 2020 2020 2020 2022      ):.        "
+0001b630: 2222 0a20 2020 2020 2020 2044 656c 6574  "".        Delet
+0001b640: 6573 2074 6865 2044 4220 7265 636f 7264  es the DB record
+0001b650: 206f 6620 6120 6769 7665 6e20 6d6f 6465   of a given mode
+0001b660: 6c20 656e 6470 6f69 6e74 2c20 7072 6f6a  l endpoint, proj
+0001b670: 6563 7420 616e 6420 656e 6470 6f69 6e74  ect and endpoint
+0001b680: 5f69 6420 6172 6520 7573 6564 2066 6f72  _id are used for
+0001b690: 206c 6f6f 6b75 700a 0a20 2020 2020 2020   lookup..       
+0001b6a0: 203a 7061 7261 6d20 7072 6f6a 6563 743a   :param project:
+0001b6b0: 2054 6865 206e 616d 6520 6f66 2074 6865   The name of the
+0001b6c0: 2070 726f 6a65 6374 0a20 2020 2020 2020   project.       
+0001b6d0: 203a 7061 7261 6d20 656e 6470 6f69 6e74   :param endpoint
+0001b6e0: 5f69 643a 2054 6865 2069 6420 6f66 2074  _id: The id of t
+0001b6f0: 6865 2065 6e64 706f 696e 740a 2020 2020  he endpoint.    
+0001b700: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
+0001b710: 2070 6174 6820 3d20 6622 7072 6f6a 6563   path = f"projec
+0001b720: 7473 2f7b 7072 6f6a 6563 747d 2f6d 6f64  ts/{project}/mod
+0001b730: 656c 2d65 6e64 706f 696e 7473 2f7b 656e  el-endpoints/{en
+0001b740: 6470 6f69 6e74 5f69 647d 220a 2020 2020  dpoint_id}".    
+0001b750: 2020 2020 7365 6c66 2e61 7069 5f63 616c      self.api_cal
+0001b760: 6c28 0a20 2020 2020 2020 2020 2020 206d  l(.            m
+0001b770: 6574 686f 643d 2244 454c 4554 4522 2c0a  ethod="DELETE",.
+0001b780: 2020 2020 2020 2020 2020 2020 7061 7468              path
+0001b790: 3d70 6174 682c 0a20 2020 2020 2020 2029  =path,.        )
+0001b7a0: 0a0a 2020 2020 6465 6620 6c69 7374 5f6d  ..    def list_m
+0001b7b0: 6f64 656c 5f65 6e64 706f 696e 7473 280a  odel_endpoints(.
+0001b7c0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+0001b7d0: 2020 2020 2020 7072 6f6a 6563 743a 2073        project: s
+0001b7e0: 7472 2c0a 2020 2020 2020 2020 6d6f 6465  tr,.        mode
+0001b7f0: 6c3a 204f 7074 696f 6e61 6c5b 7374 725d  l: Optional[str]
+0001b800: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+0001b810: 2066 756e 6374 696f 6e3a 204f 7074 696f   function: Optio
+0001b820: 6e61 6c5b 7374 725d 203d 204e 6f6e 652c  nal[str] = None,
+0001b830: 0a20 2020 2020 2020 206c 6162 656c 733a  .        labels:
+0001b840: 204c 6973 745b 7374 725d 203d 204e 6f6e   List[str] = Non
+0001b850: 652c 0a20 2020 2020 2020 2073 7461 7274  e,.        start
+0001b860: 3a20 7374 7220 3d20 226e 6f77 2d31 6822  : str = "now-1h"
+0001b870: 2c0a 2020 2020 2020 2020 656e 643a 2073  ,.        end: s
+0001b880: 7472 203d 2022 6e6f 7722 2c0a 2020 2020  tr = "now",.    
+0001b890: 2020 2020 6d65 7472 6963 733a 204f 7074      metrics: Opt
+0001b8a0: 696f 6e61 6c5b 4c69 7374 5b73 7472 5d5d  ional[List[str]]
+0001b8b0: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+0001b8c0: 2074 6f70 5f6c 6576 656c 3a20 626f 6f6c   top_level: bool
+0001b8d0: 203d 2046 616c 7365 2c0a 2020 2020 2020   = False,.      
+0001b8e0: 2020 7569 6473 3a20 4f70 7469 6f6e 616c    uids: Optional
+0001b8f0: 5b4c 6973 745b 7374 725d 5d20 3d20 4e6f  [List[str]] = No
+0001b900: 6e65 2c0a 2020 2020 2920 2d3e 204c 6973  ne,.    ) -> Lis
+0001b910: 745b 6d6c 7275 6e2e 6d6f 6465 6c5f 6d6f  t[mlrun.model_mo
+0001b920: 6e69 746f 7269 6e67 2e6d 6f64 656c 5f65  nitoring.model_e
+0001b930: 6e64 706f 696e 742e 4d6f 6465 6c45 6e64  ndpoint.ModelEnd
+0001b940: 706f 696e 745d 3a0a 2020 2020 2020 2020  point]:.        
+0001b950: 2222 220a 2020 2020 2020 2020 5265 7475  """.        Retu
+0001b960: 726e 7320 6120 6c69 7374 206f 6620 604d  rns a list of `M
+0001b970: 6f64 656c 456e 6470 6f69 6e74 6020 6f62  odelEndpoint` ob
+0001b980: 6a65 6374 732e 2045 6163 6820 604d 6f64  jects. Each `Mod
+0001b990: 656c 456e 6470 6f69 6e74 6020 6f62 6a65  elEndpoint` obje
+0001b9a0: 6374 2072 6570 7265 7365 6e74 7320 7468  ct represents th
+0001b9b0: 6520 6375 7272 656e 7420 7374 6174 6520  e current state 
+0001b9c0: 6f66 2061 0a20 2020 2020 2020 206d 6f64  of a.        mod
+0001b9d0: 656c 2065 6e64 706f 696e 742e 2054 6869  el endpoint. Thi
+0001b9e0: 7320 6675 6e63 7469 6f6e 7320 7375 7070  s functions supp
+0001b9f0: 6f72 7473 2066 696c 7465 7269 6e67 2062  orts filtering b
+0001ba00: 7920 7468 6520 666f 6c6c 6f77 696e 6720  y the following 
+0001ba10: 7061 7261 6d65 7465 7273 3a0a 2020 2020  parameters:.    
+0001ba20: 2020 2020 3129 206d 6f64 656c 0a20 2020      1) model.   
+0001ba30: 2020 2020 2032 2920 6675 6e63 7469 6f6e       2) function
+0001ba40: 0a20 2020 2020 2020 2033 2920 6c61 6265  .        3) labe
+0001ba50: 6c73 0a20 2020 2020 2020 2034 2920 746f  ls.        4) to
+0001ba60: 7020 6c65 7665 6c0a 2020 2020 2020 2020  p level.        
+0001ba70: 3529 2075 6964 730a 2020 2020 2020 2020  5) uids.        
+0001ba80: 4279 2064 6566 6175 6c74 2c20 7768 656e  By default, when
+0001ba90: 206e 6f20 6669 6c74 6572 7320 6172 6520   no filters are 
+0001baa0: 6170 706c 6965 642c 2061 6c6c 2061 7661  applied, all ava
+0001bab0: 696c 6162 6c65 2065 6e64 706f 696e 7473  ilable endpoints
+0001bac0: 2066 6f72 2074 6865 2067 6976 656e 2070   for the given p
+0001bad0: 726f 6a65 6374 2077 696c 6c20 6265 206c  roject will be l
+0001bae0: 6973 7465 642e 0a0a 2020 2020 2020 2020  isted...        
+0001baf0: 496e 2061 6464 6974 696f 6e2c 2074 6869  In addition, thi
+0001bb00: 7320 6675 6e63 7469 6f6e 7320 7072 6f76  s functions prov
+0001bb10: 6964 6573 2061 2066 6163 6164 6520 666f  ides a facade fo
+0001bb20: 7220 6c69 7374 696e 6720 656e 6470 6f69  r listing endpoi
+0001bb30: 6e74 2072 656c 6174 6564 206d 6574 7269  nt related metri
+0001bb40: 6373 2e20 5468 6973 2066 6163 6164 6520  cs. This facade 
+0001bb50: 6973 2074 696d 652d 6261 7365 640a 2020  is time-based.  
+0001bb60: 2020 2020 2020 616e 6420 6465 7065 6e64        and depend
+0001bb70: 7320 6f6e 2074 6865 2027 7374 6172 7427  s on the 'start'
+0001bb80: 2061 6e64 2027 656e 6427 2070 6172 616d   and 'end' param
+0001bb90: 6574 6572 732e 2042 7920 6465 6661 756c  eters. By defaul
+0001bba0: 742c 2077 6865 6e20 7468 6520 6d65 7472  t, when the metr
+0001bbb0: 6963 7320 7061 7261 6d65 7465 7220 6973  ics parameter is
+0001bbc0: 204e 6f6e 652c 206e 6f20 6d65 7472 6963   None, no metric
+0001bbd0: 7320 6172 650a 2020 2020 2020 2020 6164  s are.        ad
+0001bbe0: 6465 6420 746f 2074 6865 206f 7574 7075  ded to the outpu
+0001bbf0: 7420 6f66 2074 6869 7320 6675 6e63 7469  t of this functi
+0001bc00: 6f6e 2e0a 0a20 2020 2020 2020 203a 7061  on...        :pa
+0001bc10: 7261 6d20 7072 6f6a 6563 743a 2054 6865  ram project: The
+0001bc20: 206e 616d 6520 6f66 2074 6865 2070 726f   name of the pro
+0001bc30: 6a65 6374 0a20 2020 2020 2020 203a 7061  ject.        :pa
+0001bc40: 7261 6d20 6d6f 6465 6c3a 2054 6865 206e  ram model: The n
+0001bc50: 616d 6520 6f66 2074 6865 206d 6f64 656c  ame of the model
+0001bc60: 2074 6f20 6669 6c74 6572 2062 790a 2020   to filter by.  
+0001bc70: 2020 2020 2020 3a70 6172 616d 2066 756e        :param fun
+0001bc80: 6374 696f 6e3a 2054 6865 206e 616d 6520  ction: The name 
+0001bc90: 6f66 2074 6865 2066 756e 6374 696f 6e20  of the function 
+0001bca0: 746f 2066 696c 7465 7220 6279 0a20 2020  to filter by.   
+0001bcb0: 2020 2020 203a 7061 7261 6d20 6c61 6265       :param labe
+0001bcc0: 6c73 3a20 4120 6c69 7374 206f 6620 6c61  ls: A list of la
+0001bcd0: 6265 6c73 2074 6f20 6669 6c74 6572 2062  bels to filter b
+0001bce0: 792e 204c 6162 656c 2066 696c 7465 7273  y. Label filters
+0001bcf0: 2077 6f72 6b20 6279 2065 6974 6865 7220   work by either 
+0001bd00: 6669 6c74 6572 696e 6720 6120 7370 6563  filtering a spec
+0001bd10: 6966 6963 2076 616c 7565 206f 6620 610a  ific value of a.
+0001bd20: 2020 2020 2020 2020 206c 6162 656c 2028           label (
+0001bd30: 692e 652e 206c 6973 7428 226b 6579 3d76  i.e. list("key=v
+0001bd40: 616c 7565 2229 2920 6f72 2062 7920 6c6f  alue")) or by lo
+0001bd50: 6f6b 696e 6720 666f 7220 7468 6520 6578  oking for the ex
+0001bd60: 6973 7465 6e63 6520 6f66 2061 2067 6976  istence of a giv
+0001bd70: 656e 206b 6579 2028 692e 652e 2022 6b65  en key (i.e. "ke
+0001bd80: 7922 290a 2020 2020 2020 2020 3a70 6172  y").        :par
+0001bd90: 616d 206d 6574 7269 6373 3a20 4120 6c69  am metrics: A li
+0001bda0: 7374 206f 6620 6d65 7472 6963 7320 746f  st of metrics to
+0001bdb0: 2072 6574 7572 6e20 666f 7220 6561 6368   return for each
+0001bdc0: 2065 6e64 706f 696e 742c 2072 6561 6420   endpoint, read 
+0001bdd0: 6d6f 7265 2069 6e20 2754 696d 654d 6574  more in 'TimeMet
+0001bde0: 7269 6327 0a20 2020 2020 2020 203a 7061  ric'.        :pa
+0001bdf0: 7261 6d20 7374 6172 743a 2054 6865 2073  ram start: The s
+0001be00: 7461 7274 2074 696d 6520 6f66 2074 6865  tart time of the
+0001be10: 206d 6574 7269 6373 2e20 4361 6e20 6265   metrics. Can be
+0001be20: 2072 6570 7265 7365 6e74 6564 2062 7920   represented by 
+0001be30: 6120 7374 7269 6e67 2063 6f6e 7461 696e  a string contain
+0001be40: 696e 6720 616e 2052 4643 2033 3333 390a  ing an RFC 3339.
 0001be50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001be60: 2020 2060 276e 6f77 2d5b 302d 395d 2b5b     `'now-[0-9]+[
-0001be70: 6d68 645d 2760 2c20 7768 6572 6520 606d  mhd]'`, where `m
-0001be80: 6020 3d20 6d69 6e75 7465 732c 2060 6860  ` = minutes, `h`
-0001be90: 203d 2068 6f75 7273 2c20 616e 6420 6027   = hours, and `'
-0001bea0: 6427 6020 3d0a 2020 2020 2020 2020 2020  d'` =.          
-0001beb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bec0: 2020 2020 2020 2064 6179 7329 2c20 6f72         days), or
-0001bed0: 2030 2066 6f72 2074 6865 2065 6172 6c69   0 for the earli
-0001bee0: 6573 7420 7469 6d65 2e0a 2020 2020 2020  est time..      
-0001bef0: 2020 3a70 6172 616d 2065 6e64 3a20 5468    :param end: Th
-0001bf00: 6520 656e 6420 7469 6d65 206f 6620 7468  e end time of th
-0001bf10: 6520 6d65 7472 6963 732e 2043 616e 2062  e metrics. Can b
-0001bf20: 6520 7265 7072 6573 656e 7465 6420 6279  e represented by
-0001bf30: 2061 2073 7472 696e 6720 636f 6e74 6169   a string contai
-0001bf40: 6e69 6e67 2061 6e20 5246 4320 3333 3339  ning an RFC 3339
-0001bf50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001bf60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bf70: 2020 7469 6d65 2c20 6120 556e 6978 2074    time, a Unix t
-0001bf80: 696d 6573 7461 6d70 2069 6e20 6d69 6c6c  imestamp in mill
-0001bf90: 6973 6563 6f6e 6473 2c20 6120 7265 6c61  iseconds, a rela
-0001bfa0: 7469 7665 2074 696d 6520 2860 276e 6f77  tive time (`'now
-0001bfb0: 2760 206f 720a 2020 2020 2020 2020 2020  '` or.          
-0001bfc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bfd0: 2020 2020 2020 2060 276e 6f77 2d5b 302d         `'now-[0-
-0001bfe0: 395d 2b5b 6d68 645d 2760 2c20 7768 6572  9]+[mhd]'`, wher
-0001bff0: 6520 606d 6020 3d20 6d69 6e75 7465 732c  e `m` = minutes,
-0001c000: 2060 6860 203d 2068 6f75 7273 2c20 616e   `h` = hours, an
-0001c010: 6420 6027 6427 6020 3d0a 2020 2020 2020  d `'d'` =.      
-0001c020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c030: 2020 2020 2020 2020 2020 2064 6179 7329             days)
-0001c040: 2c20 6f72 2030 2066 6f72 2074 6865 2065  , or 0 for the e
-0001c050: 6172 6c69 6573 7420 7469 6d65 2e0a 2020  arliest time..  
-0001c060: 2020 2020 2020 3a70 6172 616d 2074 6f70        :param top
-0001c070: 5f6c 6576 656c 3a20 6966 2074 7275 6520  _level: if true 
-0001c080: 7769 6c6c 2072 6574 7572 6e20 6f6e 6c79  will return only
-0001c090: 2072 6f75 7465 7273 2061 6e64 2065 6e64   routers and end
-0001c0a0: 706f 696e 7420 7468 6174 2061 7265 204e  point that are N
-0001c0b0: 4f54 2063 6869 6c64 7265 6e20 6f66 2061  OT children of a
-0001c0c0: 6e79 2072 6f75 7465 720a 2020 2020 2020  ny router.      
-0001c0d0: 2020 3a70 6172 616d 2075 6964 733a 2069    :param uids: i
-0001c0e0: 6620 7061 7373 6564 2077 696c 6c20 7265  f passed will re
-0001c0f0: 7475 726e 2061 206c 6973 7420 604d 6f64  turn a list `Mod
-0001c100: 656c 456e 6470 6f69 6e74 6020 6f62 6a65  elEndpoint` obje
-0001c110: 6374 2077 6974 6820 7569 6420 696e 2075  ct with uid in u
-0001c120: 6964 730a 2020 2020 2020 2020 2222 220a  ids.        """.
-0001c130: 0a20 2020 2020 2020 2070 6174 6820 3d20  .        path = 
-0001c140: 6622 7072 6f6a 6563 7473 2f7b 7072 6f6a  f"projects/{proj
-0001c150: 6563 747d 2f6d 6f64 656c 2d65 6e64 706f  ect}/model-endpo
-0001c160: 696e 7473 220a 0a20 2020 2020 2020 2069  ints"..        i
-0001c170: 6620 6c61 6265 6c73 2061 6e64 2069 7369  f labels and isi
-0001c180: 6e73 7461 6e63 6528 6c61 6265 6c73 2c20  nstance(labels, 
-0001c190: 6469 6374 293a 0a20 2020 2020 2020 2020  dict):.         
-0001c1a0: 2020 206c 6162 656c 7320 3d20 5b66 227b     labels = [f"{
-0001c1b0: 6b65 797d 3d7b 7661 6c75 657d 2220 666f  key}={value}" fo
-0001c1c0: 7220 6b65 792c 2076 616c 7565 2069 6e20  r key, value in 
-0001c1d0: 6c61 6265 6c73 2e69 7465 6d73 2829 5d0a  labels.items()].
-0001c1e0: 0a20 2020 2020 2020 2072 6573 706f 6e73  .        respons
-0001c1f0: 6520 3d20 7365 6c66 2e61 7069 5f63 616c  e = self.api_cal
-0001c200: 6c28 0a20 2020 2020 2020 2020 2020 206d  l(.            m
-0001c210: 6574 686f 643d 2247 4554 222c 0a20 2020  ethod="GET",.   
-0001c220: 2020 2020 2020 2020 2070 6174 683d 7061           path=pa
-0001c230: 7468 2c0a 2020 2020 2020 2020 2020 2020  th,.            
-0001c240: 7061 7261 6d73 3d7b 0a20 2020 2020 2020  params={.       
-0001c250: 2020 2020 2020 2020 2022 6d6f 6465 6c22           "model"
-0001c260: 3a20 6d6f 6465 6c2c 0a20 2020 2020 2020  : model,.       
-0001c270: 2020 2020 2020 2020 2022 6675 6e63 7469           "functi
-0001c280: 6f6e 223a 2066 756e 6374 696f 6e2c 0a20  on": function,. 
-0001c290: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0001c2a0: 6c61 6265 6c22 3a20 6c61 6265 6c73 206f  label": labels o
-0001c2b0: 7220 5b5d 2c0a 2020 2020 2020 2020 2020  r [],.          
-0001c2c0: 2020 2020 2020 2273 7461 7274 223a 2073        "start": s
-0001c2d0: 7461 7274 2c0a 2020 2020 2020 2020 2020  tart,.          
-0001c2e0: 2020 2020 2020 2265 6e64 223a 2065 6e64        "end": end
-0001c2f0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001c300: 2020 226d 6574 7269 6322 3a20 6d65 7472    "metric": metr
-0001c310: 6963 7320 6f72 205b 5d2c 0a20 2020 2020  ics or [],.     
-0001c320: 2020 2020 2020 2020 2020 2022 746f 702d             "top-
-0001c330: 6c65 7665 6c22 3a20 746f 705f 6c65 7665  level": top_leve
-0001c340: 6c2c 0a20 2020 2020 2020 2020 2020 2020  l,.             
-0001c350: 2020 2022 7569 6422 3a20 7569 6473 2c0a     "uid": uids,.
-0001c360: 2020 2020 2020 2020 2020 2020 7d2c 0a20              },. 
-0001c370: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-0001c380: 2020 2320 4765 6e65 7261 7465 2061 206c    # Generate a l
-0001c390: 6973 7420 6f66 2061 206d 6f64 656c 2065  ist of a model e
-0001c3a0: 6e64 706f 696e 7420 6469 6374 696f 6e61  ndpoint dictiona
-0001c3b0: 7269 6573 0a20 2020 2020 2020 206d 6f64  ries.        mod
-0001c3c0: 656c 5f65 6e64 706f 696e 7473 203d 2072  el_endpoints = r
-0001c3d0: 6573 706f 6e73 652e 6a73 6f6e 2829 5b22  esponse.json()["
-0001c3e0: 656e 6470 6f69 6e74 7322 5d0a 2020 2020  endpoints"].    
-0001c3f0: 2020 2020 6966 206d 6f64 656c 5f65 6e64      if model_end
-0001c400: 706f 696e 7473 3a0a 2020 2020 2020 2020  points:.        
-0001c410: 2020 2020 7265 7475 726e 205b 0a20 2020      return [.   
-0001c420: 2020 2020 2020 2020 2020 2020 206d 6c72               mlr
-0001c430: 756e 2e6d 6f64 656c 5f6d 6f6e 6974 6f72  un.model_monitor
-0001c440: 696e 672e 6d6f 6465 6c5f 656e 6470 6f69  ing.model_endpoi
-0001c450: 6e74 2e4d 6f64 656c 456e 6470 6f69 6e74  nt.ModelEndpoint
-0001c460: 2e66 726f 6d5f 6469 6374 286f 626a 290a  .from_dict(obj).
-0001c470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c480: 666f 7220 6f62 6a20 696e 206d 6f64 656c  for obj in model
-0001c490: 5f65 6e64 706f 696e 7473 0a20 2020 2020  _endpoints.     
-0001c4a0: 2020 2020 2020 205d 0a20 2020 2020 2020         ].       
-0001c4b0: 2072 6574 7572 6e20 5b5d 0a0a 2020 2020   return []..    
-0001c4c0: 6465 6620 6765 745f 6d6f 6465 6c5f 656e  def get_model_en
-0001c4d0: 6470 6f69 6e74 280a 2020 2020 2020 2020  dpoint(.        
-0001c4e0: 7365 6c66 2c0a 2020 2020 2020 2020 7072  self,.        pr
-0001c4f0: 6f6a 6563 743a 2073 7472 2c0a 2020 2020  oject: str,.    
-0001c500: 2020 2020 656e 6470 6f69 6e74 5f69 643a      endpoint_id:
-0001c510: 2073 7472 2c0a 2020 2020 2020 2020 7374   str,.        st
-0001c520: 6172 743a 204f 7074 696f 6e61 6c5b 7374  art: Optional[st
-0001c530: 725d 203d 204e 6f6e 652c 0a20 2020 2020  r] = None,.     
-0001c540: 2020 2065 6e64 3a20 4f70 7469 6f6e 616c     end: Optional
-0001c550: 5b73 7472 5d20 3d20 4e6f 6e65 2c0a 2020  [str] = None,.  
-0001c560: 2020 2020 2020 6d65 7472 6963 733a 204f        metrics: O
-0001c570: 7074 696f 6e61 6c5b 4c69 7374 5b73 7472  ptional[List[str
-0001c580: 5d5d 203d 204e 6f6e 652c 0a20 2020 2020  ]] = None,.     
-0001c590: 2020 2066 6561 7475 7265 5f61 6e61 6c79     feature_analy
-0001c5a0: 7369 733a 2062 6f6f 6c20 3d20 4661 6c73  sis: bool = Fals
-0001c5b0: 652c 0a20 2020 2029 202d 3e20 6d6c 7275  e,.    ) -> mlru
-0001c5c0: 6e2e 6d6f 6465 6c5f 6d6f 6e69 746f 7269  n.model_monitori
-0001c5d0: 6e67 2e6d 6f64 656c 5f65 6e64 706f 696e  ng.model_endpoin
-0001c5e0: 742e 4d6f 6465 6c45 6e64 706f 696e 743a  t.ModelEndpoint:
-0001c5f0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0001c600: 2020 2020 2052 6574 7572 6e73 2061 2073       Returns a s
-0001c610: 696e 676c 6520 604d 6f64 656c 456e 6470  ingle `ModelEndp
-0001c620: 6f69 6e74 6020 6f62 6a65 6374 2077 6974  oint` object wit
-0001c630: 6820 6164 6469 7469 6f6e 616c 206d 6574  h additional met
-0001c640: 7269 6373 2061 6e64 2066 6561 7475 7265  rics and feature
-0001c650: 2072 656c 6174 6564 2064 6174 612e 0a0a   related data...
-0001c660: 2020 2020 2020 2020 3a70 6172 616d 2070          :param p
-0001c670: 726f 6a65 6374 3a20 2020 2020 2020 2020  roject:         
-0001c680: 2020 2020 2020 2020 2020 2054 6865 206e             The n
-0001c690: 616d 6520 6f66 2074 6865 2070 726f 6a65  ame of the proje
-0001c6a0: 6374 0a20 2020 2020 2020 203a 7061 7261  ct.        :para
-0001c6b0: 6d20 656e 6470 6f69 6e74 5f69 643a 2020  m endpoint_id:  
-0001c6c0: 2020 2020 2020 2020 2020 2020 2020 5468                Th
-0001c6d0: 6520 756e 6971 7565 2069 6420 6f66 2074  e unique id of t
-0001c6e0: 6865 206d 6f64 656c 2065 6e64 706f 696e  he model endpoin
-0001c6f0: 742e 0a20 2020 2020 2020 203a 7061 7261  t..        :para
-0001c700: 6d20 7374 6172 743a 2020 2020 2020 2020  m start:        
-0001c710: 2020 2020 2020 2020 2020 2020 2020 5468                Th
-0001c720: 6520 7374 6172 7420 7469 6d65 206f 6620  e start time of 
-0001c730: 7468 6520 6d65 7472 6963 732e 2043 616e  the metrics. Can
-0001c740: 2062 6520 7265 7072 6573 656e 7465 6420   be represented 
-0001c750: 6279 2061 2073 7472 696e 6720 636f 6e74  by a string cont
-0001c760: 6169 6e69 6e67 2061 6e0a 2020 2020 2020  aining an.      
-0001c770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001be60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001be70: 2074 696d 652c 2061 2055 6e69 7820 7469   time, a Unix ti
+0001be80: 6d65 7374 616d 7020 696e 206d 696c 6c69  mestamp in milli
+0001be90: 7365 636f 6e64 732c 2061 2072 656c 6174  seconds, a relat
+0001bea0: 6976 6520 7469 6d65 2028 6027 6e6f 7727  ive time (`'now'
+0001beb0: 6020 6f72 0a20 2020 2020 2020 2020 2020  ` or.           
+0001bec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bed0: 2020 2020 2020 6027 6e6f 772d 5b30 2d39        `'now-[0-9
+0001bee0: 5d2b 5b6d 6864 5d27 602c 2077 6865 7265  ]+[mhd]'`, where
+0001bef0: 2060 6d60 203d 206d 696e 7574 6573 2c20   `m` = minutes, 
+0001bf00: 6068 6020 3d20 686f 7572 732c 2061 6e64  `h` = hours, and
+0001bf10: 2060 2764 2760 203d 0a20 2020 2020 2020   `'d'` =.       
+0001bf20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bf30: 2020 2020 2020 2020 2020 6461 7973 292c            days),
+0001bf40: 206f 7220 3020 666f 7220 7468 6520 6561   or 0 for the ea
+0001bf50: 726c 6965 7374 2074 696d 652e 0a20 2020  rliest time..   
+0001bf60: 2020 2020 203a 7061 7261 6d20 656e 643a       :param end:
+0001bf70: 2054 6865 2065 6e64 2074 696d 6520 6f66   The end time of
+0001bf80: 2074 6865 206d 6574 7269 6373 2e20 4361   the metrics. Ca
+0001bf90: 6e20 6265 2072 6570 7265 7365 6e74 6564  n be represented
+0001bfa0: 2062 7920 6120 7374 7269 6e67 2063 6f6e   by a string con
+0001bfb0: 7461 696e 696e 6720 616e 2052 4643 2033  taining an RFC 3
+0001bfc0: 3333 390a 2020 2020 2020 2020 2020 2020  339.            
+0001bfd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bfe0: 2020 2020 2074 696d 652c 2061 2055 6e69       time, a Uni
+0001bff0: 7820 7469 6d65 7374 616d 7020 696e 206d  x timestamp in m
+0001c000: 696c 6c69 7365 636f 6e64 732c 2061 2072  illiseconds, a r
+0001c010: 656c 6174 6976 6520 7469 6d65 2028 6027  elative time (`'
+0001c020: 6e6f 7727 6020 6f72 0a20 2020 2020 2020  now'` or.       
+0001c030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c040: 2020 2020 2020 2020 2020 6027 6e6f 772d            `'now-
+0001c050: 5b30 2d39 5d2b 5b6d 6864 5d27 602c 2077  [0-9]+[mhd]'`, w
+0001c060: 6865 7265 2060 6d60 203d 206d 696e 7574  here `m` = minut
+0001c070: 6573 2c20 6068 6020 3d20 686f 7572 732c  es, `h` = hours,
+0001c080: 2061 6e64 2060 2764 2760 203d 0a20 2020   and `'d'` =.   
+0001c090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c0a0: 2020 2020 2020 2020 2020 2020 2020 6461                da
+0001c0b0: 7973 292c 206f 7220 3020 666f 7220 7468  ys), or 0 for th
+0001c0c0: 6520 6561 726c 6965 7374 2074 696d 652e  e earliest time.
+0001c0d0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0001c0e0: 746f 705f 6c65 7665 6c3a 2069 6620 7472  top_level: if tr
+0001c0f0: 7565 2077 696c 6c20 7265 7475 726e 206f  ue will return o
+0001c100: 6e6c 7920 726f 7574 6572 7320 616e 6420  nly routers and 
+0001c110: 656e 6470 6f69 6e74 2074 6861 7420 6172  endpoint that ar
+0001c120: 6520 4e4f 5420 6368 696c 6472 656e 206f  e NOT children o
+0001c130: 6620 616e 7920 726f 7574 6572 0a20 2020  f any router.   
+0001c140: 2020 2020 203a 7061 7261 6d20 7569 6473       :param uids
+0001c150: 3a20 6966 2070 6173 7365 6420 7769 6c6c  : if passed will
+0001c160: 2072 6574 7572 6e20 6120 6c69 7374 2060   return a list `
+0001c170: 4d6f 6465 6c45 6e64 706f 696e 7460 206f  ModelEndpoint` o
+0001c180: 626a 6563 7420 7769 7468 2075 6964 2069  bject with uid i
+0001c190: 6e20 7569 6473 0a20 2020 2020 2020 2022  n uids.        "
+0001c1a0: 2222 0a0a 2020 2020 2020 2020 7061 7468  ""..        path
+0001c1b0: 203d 2066 2270 726f 6a65 6374 732f 7b70   = f"projects/{p
+0001c1c0: 726f 6a65 6374 7d2f 6d6f 6465 6c2d 656e  roject}/model-en
+0001c1d0: 6470 6f69 6e74 7322 0a0a 2020 2020 2020  dpoints"..      
+0001c1e0: 2020 6966 206c 6162 656c 7320 616e 6420    if labels and 
+0001c1f0: 6973 696e 7374 616e 6365 286c 6162 656c  isinstance(label
+0001c200: 732c 2064 6963 7429 3a0a 2020 2020 2020  s, dict):.      
+0001c210: 2020 2020 2020 6c61 6265 6c73 203d 205b        labels = [
+0001c220: 6622 7b6b 6579 7d3d 7b76 616c 7565 7d22  f"{key}={value}"
+0001c230: 2066 6f72 206b 6579 2c20 7661 6c75 6520   for key, value 
+0001c240: 696e 206c 6162 656c 732e 6974 656d 7328  in labels.items(
+0001c250: 295d 0a0a 2020 2020 2020 2020 7265 7370  )]..        resp
+0001c260: 6f6e 7365 203d 2073 656c 662e 6170 695f  onse = self.api_
+0001c270: 6361 6c6c 280a 2020 2020 2020 2020 2020  call(.          
+0001c280: 2020 6d65 7468 6f64 3d22 4745 5422 2c0a    method="GET",.
+0001c290: 2020 2020 2020 2020 2020 2020 7061 7468              path
+0001c2a0: 3d70 6174 682c 0a20 2020 2020 2020 2020  =path,.         
+0001c2b0: 2020 2070 6172 616d 733d 7b0a 2020 2020     params={.    
+0001c2c0: 2020 2020 2020 2020 2020 2020 226d 6f64              "mod
+0001c2d0: 656c 223a 206d 6f64 656c 2c0a 2020 2020  el": model,.    
+0001c2e0: 2020 2020 2020 2020 2020 2020 2266 756e              "fun
+0001c2f0: 6374 696f 6e22 3a20 6675 6e63 7469 6f6e  ction": function
+0001c300: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001c310: 2020 226c 6162 656c 223a 206c 6162 656c    "label": label
+0001c320: 7320 6f72 205b 5d2c 0a20 2020 2020 2020  s or [],.       
+0001c330: 2020 2020 2020 2020 2022 7374 6172 7422           "start"
+0001c340: 3a20 7374 6172 742c 0a20 2020 2020 2020  : start,.       
+0001c350: 2020 2020 2020 2020 2022 656e 6422 3a20           "end": 
+0001c360: 656e 642c 0a20 2020 2020 2020 2020 2020  end,.           
+0001c370: 2020 2020 2022 6d65 7472 6963 223a 206d       "metric": m
+0001c380: 6574 7269 6373 206f 7220 5b5d 2c0a 2020  etrics or [],.  
+0001c390: 2020 2020 2020 2020 2020 2020 2020 2274                "t
+0001c3a0: 6f70 2d6c 6576 656c 223a 2074 6f70 5f6c  op-level": top_l
+0001c3b0: 6576 656c 2c0a 2020 2020 2020 2020 2020  evel,.          
+0001c3c0: 2020 2020 2020 2275 6964 223a 2075 6964        "uid": uid
+0001c3d0: 732c 0a20 2020 2020 2020 2020 2020 207d  s,.            }
+0001c3e0: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
+0001c3f0: 2020 2020 2023 2047 656e 6572 6174 6520       # Generate 
+0001c400: 6120 6c69 7374 206f 6620 6120 6d6f 6465  a list of a mode
+0001c410: 6c20 656e 6470 6f69 6e74 2064 6963 7469  l endpoint dicti
+0001c420: 6f6e 6172 6965 730a 2020 2020 2020 2020  onaries.        
+0001c430: 6d6f 6465 6c5f 656e 6470 6f69 6e74 7320  model_endpoints 
+0001c440: 3d20 7265 7370 6f6e 7365 2e6a 736f 6e28  = response.json(
+0001c450: 295b 2265 6e64 706f 696e 7473 225d 0a20  )["endpoints"]. 
+0001c460: 2020 2020 2020 2069 6620 6d6f 6465 6c5f         if model_
+0001c470: 656e 6470 6f69 6e74 733a 0a20 2020 2020  endpoints:.     
+0001c480: 2020 2020 2020 2072 6574 7572 6e20 5b0a         return [.
+0001c490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c4a0: 6d6c 7275 6e2e 6d6f 6465 6c5f 6d6f 6e69  mlrun.model_moni
+0001c4b0: 746f 7269 6e67 2e6d 6f64 656c 5f65 6e64  toring.model_end
+0001c4c0: 706f 696e 742e 4d6f 6465 6c45 6e64 706f  point.ModelEndpo
+0001c4d0: 696e 742e 6672 6f6d 5f64 6963 7428 6f62  int.from_dict(ob
+0001c4e0: 6a29 0a20 2020 2020 2020 2020 2020 2020  j).             
+0001c4f0: 2020 2066 6f72 206f 626a 2069 6e20 6d6f     for obj in mo
+0001c500: 6465 6c5f 656e 6470 6f69 6e74 730a 2020  del_endpoints.  
+0001c510: 2020 2020 2020 2020 2020 5d0a 2020 2020            ].    
+0001c520: 2020 2020 7265 7475 726e 205b 5d0a 0a20      return [].. 
+0001c530: 2020 2064 6566 2067 6574 5f6d 6f64 656c     def get_model
+0001c540: 5f65 6e64 706f 696e 7428 0a20 2020 2020  _endpoint(.     
+0001c550: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+0001c560: 2070 726f 6a65 6374 3a20 7374 722c 0a20   project: str,. 
+0001c570: 2020 2020 2020 2065 6e64 706f 696e 745f         endpoint_
+0001c580: 6964 3a20 7374 722c 0a20 2020 2020 2020  id: str,.       
+0001c590: 2073 7461 7274 3a20 4f70 7469 6f6e 616c   start: Optional
+0001c5a0: 5b73 7472 5d20 3d20 4e6f 6e65 2c0a 2020  [str] = None,.  
+0001c5b0: 2020 2020 2020 656e 643a 204f 7074 696f        end: Optio
+0001c5c0: 6e61 6c5b 7374 725d 203d 204e 6f6e 652c  nal[str] = None,
+0001c5d0: 0a20 2020 2020 2020 206d 6574 7269 6373  .        metrics
+0001c5e0: 3a20 4f70 7469 6f6e 616c 5b4c 6973 745b  : Optional[List[
+0001c5f0: 7374 725d 5d20 3d20 4e6f 6e65 2c0a 2020  str]] = None,.  
+0001c600: 2020 2020 2020 6665 6174 7572 655f 616e        feature_an
+0001c610: 616c 7973 6973 3a20 626f 6f6c 203d 2046  alysis: bool = F
+0001c620: 616c 7365 2c0a 2020 2020 2920 2d3e 206d  alse,.    ) -> m
+0001c630: 6c72 756e 2e6d 6f64 656c 5f6d 6f6e 6974  lrun.model_monit
+0001c640: 6f72 696e 672e 6d6f 6465 6c5f 656e 6470  oring.model_endp
+0001c650: 6f69 6e74 2e4d 6f64 656c 456e 6470 6f69  oint.ModelEndpoi
+0001c660: 6e74 3a0a 2020 2020 2020 2020 2222 220a  nt:.        """.
+0001c670: 2020 2020 2020 2020 5265 7475 726e 7320          Returns 
+0001c680: 6120 7369 6e67 6c65 2060 4d6f 6465 6c45  a single `ModelE
+0001c690: 6e64 706f 696e 7460 206f 626a 6563 7420  ndpoint` object 
+0001c6a0: 7769 7468 2061 6464 6974 696f 6e61 6c20  with additional 
+0001c6b0: 6d65 7472 6963 7320 616e 6420 6665 6174  metrics and feat
+0001c6c0: 7572 6520 7265 6c61 7465 6420 6461 7461  ure related data
+0001c6d0: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
+0001c6e0: 6d20 7072 6f6a 6563 743a 2020 2020 2020  m project:      
+0001c6f0: 2020 2020 2020 2020 2020 2020 2020 5468                Th
+0001c700: 6520 6e61 6d65 206f 6620 7468 6520 7072  e name of the pr
+0001c710: 6f6a 6563 740a 2020 2020 2020 2020 3a70  oject.        :p
+0001c720: 6172 616d 2065 6e64 706f 696e 745f 6964  aram endpoint_id
+0001c730: 3a20 2020 2020 2020 2020 2020 2020 2020  :               
+0001c740: 2054 6865 2075 6e69 7175 6520 6964 206f   The unique id o
+0001c750: 6620 7468 6520 6d6f 6465 6c20 656e 6470  f the model endp
+0001c760: 6f69 6e74 2e0a 2020 2020 2020 2020 3a70  oint..        :p
+0001c770: 6172 616d 2073 7461 7274 3a20 2020 2020  aram start:     
 0001c780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c790: 2020 2020 2052 4643 2033 3333 3920 7469       RFC 3339 ti
-0001c7a0: 6d65 2c20 6120 556e 6978 2074 696d 6573  me, a Unix times
-0001c7b0: 7461 6d70 2069 6e20 6d69 6c6c 6973 6563  tamp in millisec
-0001c7c0: 6f6e 6473 2c20 6120 7265 6c61 7469 7665  onds, a relative
-0001c7d0: 2074 696d 6520 2860 276e 6f77 2760 206f   time (`'now'` o
-0001c7e0: 720a 2020 2020 2020 2020 2020 2020 2020  r.              
+0001c790: 2054 6865 2073 7461 7274 2074 696d 6520   The start time 
+0001c7a0: 6f66 2074 6865 206d 6574 7269 6373 2e20  of the metrics. 
+0001c7b0: 4361 6e20 6265 2072 6570 7265 7365 6e74  Can be represent
+0001c7c0: 6564 2062 7920 6120 7374 7269 6e67 2063  ed by a string c
+0001c7d0: 6f6e 7461 696e 696e 6720 616e 0a20 2020  ontaining an.   
+0001c7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001c7f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c800: 2020 2020 2020 2020 2020 2020 2060 276e               `'n
-0001c810: 6f77 2d5b 302d 395d 2b5b 6d68 645d 2760  ow-[0-9]+[mhd]'`
-0001c820: 2c20 7768 6572 6520 606d 6020 3d20 6d69  , where `m` = mi
-0001c830: 6e75 7465 732c 2060 6860 203d 2068 6f75  nutes, `h` = hou
-0001c840: 7273 2c20 616e 6420 6027 6427 6020 3d20  rs, and `'d'` = 
-0001c850: 6461 7973 292c 206f 720a 2020 2020 2020  days), or.      
+0001c800: 2020 2020 2020 2020 5246 4320 3333 3339          RFC 3339
+0001c810: 2074 696d 652c 2061 2055 6e69 7820 7469   time, a Unix ti
+0001c820: 6d65 7374 616d 7020 696e 206d 696c 6c69  mestamp in milli
+0001c830: 7365 636f 6e64 732c 2061 2072 656c 6174  seconds, a relat
+0001c840: 6976 6520 7469 6d65 2028 6027 6e6f 7727  ive time (`'now'
+0001c850: 6020 6f72 0a20 2020 2020 2020 2020 2020  ` or.           
 0001c860: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001c870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c880: 2020 2020 2030 2066 6f72 2074 6865 2065       0 for the e
-0001c890: 6172 6c69 6573 7420 7469 6d65 2e0a 2020  arliest time..  
-0001c8a0: 2020 2020 2020 3a70 6172 616d 2065 6e64        :param end
-0001c8b0: 3a20 2020 2020 2020 2020 2020 2020 2020  :               
-0001c8c0: 2020 2020 2020 2020 2054 6865 2065 6e64           The end
-0001c8d0: 2074 696d 6520 6f66 2074 6865 206d 6574   time of the met
-0001c8e0: 7269 6373 2e20 4361 6e20 6265 2072 6570  rics. Can be rep
-0001c8f0: 7265 7365 6e74 6564 2062 7920 6120 7374  resented by a st
-0001c900: 7269 6e67 2063 6f6e 7461 696e 696e 6720  ring containing 
-0001c910: 616e 0a20 2020 2020 2020 2020 2020 2020  an.             
-0001c920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c930: 2020 2020 2020 2020 2020 2020 2020 5246                RF
-0001c940: 4320 3333 3339 2074 696d 652c 2061 2055  C 3339 time, a U
-0001c950: 6e69 7820 7469 6d65 7374 616d 7020 696e  nix timestamp in
-0001c960: 206d 696c 6c69 7365 636f 6e64 732c 2061   milliseconds, a
-0001c970: 2072 656c 6174 6976 6520 7469 6d65 2028   relative time (
-0001c980: 6027 6e6f 7727 6020 6f72 0a20 2020 2020  `'now'` or.     
+0001c880: 6027 6e6f 772d 5b30 2d39 5d2b 5b6d 6864  `'now-[0-9]+[mhd
+0001c890: 5d27 602c 2077 6865 7265 2060 6d60 203d  ]'`, where `m` =
+0001c8a0: 206d 696e 7574 6573 2c20 6068 6020 3d20   minutes, `h` = 
+0001c8b0: 686f 7572 732c 2061 6e64 2060 2764 2760  hours, and `'d'`
+0001c8c0: 203d 2064 6179 7329 2c20 6f72 0a20 2020   = days), or.   
+0001c8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c8e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c8f0: 2020 2020 2020 2020 3020 666f 7220 7468          0 for th
+0001c900: 6520 6561 726c 6965 7374 2074 696d 652e  e earliest time.
+0001c910: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0001c920: 656e 643a 2020 2020 2020 2020 2020 2020  end:            
+0001c930: 2020 2020 2020 2020 2020 2020 5468 6520              The 
+0001c940: 656e 6420 7469 6d65 206f 6620 7468 6520  end time of the 
+0001c950: 6d65 7472 6963 732e 2043 616e 2062 6520  metrics. Can be 
+0001c960: 7265 7072 6573 656e 7465 6420 6279 2061  represented by a
+0001c970: 2073 7472 696e 6720 636f 6e74 6169 6e69   string containi
+0001c980: 6e67 2061 6e0a 2020 2020 2020 2020 2020  ng an.          
 0001c990: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001c9a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c9b0: 2020 2020 2020 6027 6e6f 772d 5b30 2d39        `'now-[0-9
-0001c9c0: 5d2b 5b6d 6864 5d27 602c 2077 6865 7265  ]+[mhd]'`, where
-0001c9d0: 2060 6d60 203d 206d 696e 7574 6573 2c20   `m` = minutes, 
-0001c9e0: 6068 6020 3d20 686f 7572 732c 2061 6e64  `h` = hours, and
-0001c9f0: 2060 2764 2760 203d 2064 6179 7329 2c20   `'d'` = days), 
-0001ca00: 6f72 0a20 2020 2020 2020 2020 2020 2020  or.             
+0001c9b0: 2052 4643 2033 3333 3920 7469 6d65 2c20   RFC 3339 time, 
+0001c9c0: 6120 556e 6978 2074 696d 6573 7461 6d70  a Unix timestamp
+0001c9d0: 2069 6e20 6d69 6c6c 6973 6563 6f6e 6473   in milliseconds
+0001c9e0: 2c20 6120 7265 6c61 7469 7665 2074 696d  , a relative tim
+0001c9f0: 6520 2860 276e 6f77 2760 206f 720a 2020  e (`'now'` or.  
+0001ca00: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001ca10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ca20: 2020 2020 2020 2020 2020 2020 2020 3020                0 
-0001ca30: 666f 7220 7468 6520 6561 726c 6965 7374  for the earliest
-0001ca40: 2074 696d 652e 0a20 2020 2020 2020 203a   time..        :
-0001ca50: 7061 7261 6d20 6d65 7472 6963 733a 2020  param metrics:  
-0001ca60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ca70: 2020 4120 6c69 7374 206f 6620 6d65 7472    A list of metr
-0001ca80: 6963 7320 746f 2072 6574 7572 6e20 666f  ics to return fo
-0001ca90: 7220 7468 6520 6d6f 6465 6c20 656e 6470  r the model endp
-0001caa0: 6f69 6e74 2e20 5468 6572 6520 6172 6520  oint. There are 
-0001cab0: 7072 652d 6465 6669 6e65 640a 2020 2020  pre-defined.    
-0001cac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cae0: 2020 2020 2020 206d 6574 7269 6373 2066         metrics f
-0001caf0: 6f72 206d 6f64 656c 2065 6e64 706f 696e  or model endpoin
-0001cb00: 7473 2073 7563 6820 6173 2070 7265 6469  ts such as predi
-0001cb10: 6374 696f 6e73 5f70 6572 5f73 6563 6f6e  ctions_per_secon
-0001cb20: 6420 616e 640a 2020 2020 2020 2020 2020  d and.          
+0001ca20: 2020 2020 2020 2020 2060 276e 6f77 2d5b           `'now-[
+0001ca30: 302d 395d 2b5b 6d68 645d 2760 2c20 7768  0-9]+[mhd]'`, wh
+0001ca40: 6572 6520 606d 6020 3d20 6d69 6e75 7465  ere `m` = minute
+0001ca50: 732c 2060 6860 203d 2068 6f75 7273 2c20  s, `h` = hours, 
+0001ca60: 616e 6420 6027 6427 6020 3d20 6461 7973  and `'d'` = days
+0001ca70: 292c 206f 720a 2020 2020 2020 2020 2020  ), or.          
+0001ca80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ca90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001caa0: 2030 2066 6f72 2074 6865 2065 6172 6c69   0 for the earli
+0001cab0: 6573 7420 7469 6d65 2e0a 2020 2020 2020  est time..      
+0001cac0: 2020 3a70 6172 616d 206d 6574 7269 6373    :param metrics
+0001cad0: 3a20 2020 2020 2020 2020 2020 2020 2020  :               
+0001cae0: 2020 2020 2041 206c 6973 7420 6f66 206d       A list of m
+0001caf0: 6574 7269 6373 2074 6f20 7265 7475 726e  etrics to return
+0001cb00: 2066 6f72 2074 6865 206d 6f64 656c 2065   for the model e
+0001cb10: 6e64 706f 696e 742e 2054 6865 7265 2061  ndpoint. There a
+0001cb20: 7265 2070 7265 2d64 6566 696e 6564 0a20  re pre-defined. 
 0001cb30: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001cb40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cb50: 206c 6174 656e 6379 5f61 7667 5f35 6d20   latency_avg_5m 
-0001cb60: 6275 7420 616c 736f 2063 7573 746f 6d20  but also custom 
-0001cb70: 6d65 7472 6963 7320 6465 6669 6e65 6420  metrics defined 
-0001cb80: 6279 2074 6865 2075 7365 722e 2050 6c65  by the user. Ple
-0001cb90: 6173 6520 6e6f 7465 2074 6861 740a 2020  ase note that.  
+0001cb50: 2020 2020 2020 2020 2020 6d65 7472 6963            metric
+0001cb60: 7320 666f 7220 6d6f 6465 6c20 656e 6470  s for model endp
+0001cb70: 6f69 6e74 7320 7375 6368 2061 7320 7072  oints such as pr
+0001cb80: 6564 6963 7469 6f6e 735f 7065 725f 7365  edictions_per_se
+0001cb90: 636f 6e64 2061 6e64 0a20 2020 2020 2020  cond and.       
 0001cba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001cbb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cbc0: 2020 2020 2020 2020 2074 6865 7365 206d           these m
-0001cbd0: 6574 7269 6373 2061 7265 2073 746f 7265  etrics are store
-0001cbe0: 6420 696e 2074 6865 2074 696d 6520 7365  d in the time se
-0001cbf0: 7269 6573 2044 4220 616e 6420 7468 6520  ries DB and the 
-0001cc00: 7265 7375 6c74 7320 7769 6c6c 2062 650a  results will be.
-0001cc10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cbc0: 2020 2020 6c61 7465 6e63 795f 6176 675f      latency_avg_
+0001cbd0: 356d 2062 7574 2061 6c73 6f20 6375 7374  5m but also cust
+0001cbe0: 6f6d 206d 6574 7269 6373 2064 6566 696e  om metrics defin
+0001cbf0: 6564 2062 7920 7468 6520 7573 6572 2e20  ed by the user. 
+0001cc00: 506c 6561 7365 206e 6f74 6520 7468 6174  Please note that
+0001cc10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 0001cc20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cc30: 2020 2020 2020 2020 2020 2061 7070 6561             appea
-0001cc40: 7265 6420 756e 6465 7220 6d6f 6465 6c5f  red under model_
-0001cc50: 656e 6470 6f69 6e74 2e73 7065 632e 6d65  endpoint.spec.me
-0001cc60: 7472 6963 732e 0a20 2020 2020 2020 203a  trics..        :
-0001cc70: 7061 7261 6d20 6665 6174 7572 655f 616e  param feature_an
-0001cc80: 616c 7973 6973 3a20 2020 2020 2020 2020  alysis:         
-0001cc90: 2020 5768 656e 2054 7275 652c 2074 6865    When True, the
-0001cca0: 2062 6173 6520 6665 6174 7572 6520 7374   base feature st
-0001ccb0: 6174 6973 7469 6373 2061 6e64 2063 7572  atistics and cur
-0001ccc0: 7265 6e74 2066 6561 7475 7265 2073 7461  rent feature sta
-0001ccd0: 7469 7374 6963 7320 7769 6c6c 0a20 2020  tistics will.   
-0001cce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ccf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cd00: 2020 2020 2020 2020 6265 2061 6464 6564          be added
-0001cd10: 2074 6f20 7468 6520 6f75 7470 7574 206f   to the output o
-0001cd20: 6620 7468 6520 7265 7375 6c74 696e 6720  f the resulting 
-0001cd30: 6f62 6a65 6374 2e0a 0a20 2020 2020 2020  object...       
-0001cd40: 203a 7265 7475 726e 3a20 4120 604d 6f64   :return: A `Mod
-0001cd50: 656c 456e 6470 6f69 6e74 6020 6f62 6a65  elEndpoint` obje
-0001cd60: 6374 2e0a 2020 2020 2020 2020 2222 220a  ct..        """.
-0001cd70: 0a20 2020 2020 2020 2070 6174 6820 3d20  .        path = 
-0001cd80: 6622 7072 6f6a 6563 7473 2f7b 7072 6f6a  f"projects/{proj
-0001cd90: 6563 747d 2f6d 6f64 656c 2d65 6e64 706f  ect}/model-endpo
-0001cda0: 696e 7473 2f7b 656e 6470 6f69 6e74 5f69  ints/{endpoint_i
-0001cdb0: 647d 220a 2020 2020 2020 2020 7265 7370  d}".        resp
-0001cdc0: 6f6e 7365 203d 2073 656c 662e 6170 695f  onse = self.api_
-0001cdd0: 6361 6c6c 280a 2020 2020 2020 2020 2020  call(.          
-0001cde0: 2020 6d65 7468 6f64 3d22 4745 5422 2c0a    method="GET",.
-0001cdf0: 2020 2020 2020 2020 2020 2020 7061 7468              path
-0001ce00: 3d70 6174 682c 0a20 2020 2020 2020 2020  =path,.         
-0001ce10: 2020 2070 6172 616d 733d 7b0a 2020 2020     params={.    
-0001ce20: 2020 2020 2020 2020 2020 2020 2273 7461              "sta
-0001ce30: 7274 223a 2073 7461 7274 2c0a 2020 2020  rt": start,.    
-0001ce40: 2020 2020 2020 2020 2020 2020 2265 6e64              "end
-0001ce50: 223a 2065 6e64 2c0a 2020 2020 2020 2020  ": end,.        
-0001ce60: 2020 2020 2020 2020 226d 6574 7269 6322          "metric"
-0001ce70: 3a20 6d65 7472 6963 7320 6f72 205b 5d2c  : metrics or [],
-0001ce80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001ce90: 2022 6665 6174 7572 655f 616e 616c 7973   "feature_analys
-0001cea0: 6973 223a 2066 6561 7475 7265 5f61 6e61  is": feature_ana
-0001ceb0: 6c79 7369 732c 0a20 2020 2020 2020 2020  lysis,.         
-0001cec0: 2020 207d 2c0a 2020 2020 2020 2020 290a     },.        ).
-0001ced0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0001cee0: 6d6c 7275 6e2e 6d6f 6465 6c5f 6d6f 6e69  mlrun.model_moni
-0001cef0: 746f 7269 6e67 2e6d 6f64 656c 5f65 6e64  toring.model_end
-0001cf00: 706f 696e 742e 4d6f 6465 6c45 6e64 706f  point.ModelEndpo
-0001cf10: 696e 742e 6672 6f6d 5f64 6963 7428 0a20  int.from_dict(. 
-0001cf20: 2020 2020 2020 2020 2020 2072 6573 706f             respo
-0001cf30: 6e73 652e 6a73 6f6e 2829 0a20 2020 2020  nse.json().     
-0001cf40: 2020 2029 0a0a 2020 2020 6465 6620 7061     )..    def pa
-0001cf50: 7463 685f 6d6f 6465 6c5f 656e 6470 6f69  tch_model_endpoi
-0001cf60: 6e74 280a 2020 2020 2020 2020 7365 6c66  nt(.        self
-0001cf70: 2c0a 2020 2020 2020 2020 7072 6f6a 6563  ,.        projec
-0001cf80: 743a 2073 7472 2c0a 2020 2020 2020 2020  t: str,.        
-0001cf90: 656e 6470 6f69 6e74 5f69 643a 2073 7472  endpoint_id: str
-0001cfa0: 2c0a 2020 2020 2020 2020 6174 7472 6962  ,.        attrib
-0001cfb0: 7574 6573 3a20 6469 6374 2c0a 2020 2020  utes: dict,.    
-0001cfc0: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
-0001cfd0: 2020 2020 2020 2055 7064 6174 6573 206d         Updates m
-0001cfe0: 6f64 656c 2065 6e64 706f 696e 7420 7769  odel endpoint wi
-0001cff0: 7468 2070 726f 7669 6465 6420 6174 7472  th provided attr
-0001d000: 6962 7574 6573 2e0a 0a20 2020 2020 2020  ibutes...       
-0001d010: 203a 7061 7261 6d20 7072 6f6a 6563 743a   :param project:
-0001d020: 2054 6865 206e 616d 6520 6f66 2074 6865   The name of the
-0001d030: 2070 726f 6a65 6374 2e0a 2020 2020 2020   project..      
-0001d040: 2020 3a70 6172 616d 2065 6e64 706f 696e    :param endpoin
-0001d050: 745f 6964 3a20 5468 6520 6964 206f 6620  t_id: The id of 
-0001d060: 7468 6520 656e 6470 6f69 6e74 2e0a 2020  the endpoint..  
-0001d070: 2020 2020 2020 3a70 6172 616d 2061 7474        :param att
-0001d080: 7269 6275 7465 733a 2044 6963 7469 6f6e  ributes: Diction
-0001d090: 6172 7920 6f66 2061 7474 7269 6275 7465  ary of attribute
-0001d0a0: 7320 7468 6174 2077 696c 6c20 6265 2075  s that will be u
-0001d0b0: 7365 6420 666f 7220 7570 6461 7465 2074  sed for update t
-0001d0c0: 6865 206d 6f64 656c 2065 6e64 706f 696e  he model endpoin
-0001d0d0: 742e 2054 6865 206b 6579 730a 2020 2020  t. The keys.    
-0001d0e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d0f0: 2020 2020 2020 206f 6620 7468 6973 2064         of this d
-0001d100: 6963 7469 6f6e 6172 7920 7368 6f75 6c64  ictionary should
-0001d110: 2065 7869 7374 2069 6e20 7468 6520 7461   exist in the ta
-0001d120: 7267 6574 2074 6162 6c65 2e20 4e6f 7465  rget table. Note
-0001d130: 2074 6861 7420 7468 6520 7661 6c75 6573   that the values
-0001d140: 2073 686f 756c 6420 6265 0a20 2020 2020   should be.     
+0001cc30: 2020 2020 2020 2020 2020 2020 7468 6573              thes
+0001cc40: 6520 6d65 7472 6963 7320 6172 6520 7374  e metrics are st
+0001cc50: 6f72 6564 2069 6e20 7468 6520 7469 6d65  ored in the time
+0001cc60: 2073 6572 6965 7320 4442 2061 6e64 2074   series DB and t
+0001cc70: 6865 2072 6573 756c 7473 2077 696c 6c20  he results will 
+0001cc80: 6265 0a20 2020 2020 2020 2020 2020 2020  be.             
+0001cc90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cca0: 2020 2020 2020 2020 2020 2020 2020 6170                ap
+0001ccb0: 7065 6172 6564 2075 6e64 6572 206d 6f64  peared under mod
+0001ccc0: 656c 5f65 6e64 706f 696e 742e 7370 6563  el_endpoint.spec
+0001ccd0: 2e6d 6574 7269 6373 2e0a 2020 2020 2020  .metrics..      
+0001cce0: 2020 3a70 6172 616d 2066 6561 7475 7265    :param feature
+0001ccf0: 5f61 6e61 6c79 7369 733a 2020 2020 2020  _analysis:      
+0001cd00: 2020 2020 2057 6865 6e20 5472 7565 2c20       When True, 
+0001cd10: 7468 6520 6261 7365 2066 6561 7475 7265  the base feature
+0001cd20: 2073 7461 7469 7374 6963 7320 616e 6420   statistics and 
+0001cd30: 6375 7272 656e 7420 6665 6174 7572 6520  current feature 
+0001cd40: 7374 6174 6973 7469 6373 2077 696c 6c0a  statistics will.
+0001cd50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cd60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cd70: 2020 2020 2020 2020 2020 2062 6520 6164             be ad
+0001cd80: 6465 6420 746f 2074 6865 206f 7574 7075  ded to the outpu
+0001cd90: 7420 6f66 2074 6865 2072 6573 756c 7469  t of the resulti
+0001cda0: 6e67 206f 626a 6563 742e 0a0a 2020 2020  ng object...    
+0001cdb0: 2020 2020 3a72 6574 7572 6e3a 2041 2060      :return: A `
+0001cdc0: 4d6f 6465 6c45 6e64 706f 696e 7460 206f  ModelEndpoint` o
+0001cdd0: 626a 6563 742e 0a20 2020 2020 2020 2022  bject..        "
+0001cde0: 2222 0a0a 2020 2020 2020 2020 7061 7468  ""..        path
+0001cdf0: 203d 2066 2270 726f 6a65 6374 732f 7b70   = f"projects/{p
+0001ce00: 726f 6a65 6374 7d2f 6d6f 6465 6c2d 656e  roject}/model-en
+0001ce10: 6470 6f69 6e74 732f 7b65 6e64 706f 696e  dpoints/{endpoin
+0001ce20: 745f 6964 7d22 0a20 2020 2020 2020 2072  t_id}".        r
+0001ce30: 6573 706f 6e73 6520 3d20 7365 6c66 2e61  esponse = self.a
+0001ce40: 7069 5f63 616c 6c28 0a20 2020 2020 2020  pi_call(.       
+0001ce50: 2020 2020 206d 6574 686f 643d 2247 4554       method="GET
+0001ce60: 222c 0a20 2020 2020 2020 2020 2020 2070  ",.            p
+0001ce70: 6174 683d 7061 7468 2c0a 2020 2020 2020  ath=path,.      
+0001ce80: 2020 2020 2020 7061 7261 6d73 3d7b 0a20        params={. 
+0001ce90: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0001cea0: 7374 6172 7422 3a20 7374 6172 742c 0a20  start": start,. 
+0001ceb0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0001cec0: 656e 6422 3a20 656e 642c 0a20 2020 2020  end": end,.     
+0001ced0: 2020 2020 2020 2020 2020 2022 6d65 7472             "metr
+0001cee0: 6963 223a 206d 6574 7269 6373 206f 7220  ic": metrics or 
+0001cef0: 5b5d 2c0a 2020 2020 2020 2020 2020 2020  [],.            
+0001cf00: 2020 2020 2266 6561 7475 7265 5f61 6e61      "feature_ana
+0001cf10: 6c79 7369 7322 3a20 6665 6174 7572 655f  lysis": feature_
+0001cf20: 616e 616c 7973 6973 2c0a 2020 2020 2020  analysis,.      
+0001cf30: 2020 2020 2020 7d2c 0a20 2020 2020 2020        },.       
+0001cf40: 2029 0a0a 2020 2020 2020 2020 7265 7475   )..        retu
+0001cf50: 726e 206d 6c72 756e 2e6d 6f64 656c 5f6d  rn mlrun.model_m
+0001cf60: 6f6e 6974 6f72 696e 672e 6d6f 6465 6c5f  onitoring.model_
+0001cf70: 656e 6470 6f69 6e74 2e4d 6f64 656c 456e  endpoint.ModelEn
+0001cf80: 6470 6f69 6e74 2e66 726f 6d5f 6469 6374  dpoint.from_dict
+0001cf90: 280a 2020 2020 2020 2020 2020 2020 7265  (.            re
+0001cfa0: 7370 6f6e 7365 2e6a 736f 6e28 290a 2020  sponse.json().  
+0001cfb0: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
+0001cfc0: 2070 6174 6368 5f6d 6f64 656c 5f65 6e64   patch_model_end
+0001cfd0: 706f 696e 7428 0a20 2020 2020 2020 2073  point(.        s
+0001cfe0: 656c 662c 0a20 2020 2020 2020 2070 726f  elf,.        pro
+0001cff0: 6a65 6374 3a20 7374 722c 0a20 2020 2020  ject: str,.     
+0001d000: 2020 2065 6e64 706f 696e 745f 6964 3a20     endpoint_id: 
+0001d010: 7374 722c 0a20 2020 2020 2020 2061 7474  str,.        att
+0001d020: 7269 6275 7465 733a 2064 6963 742c 0a20  ributes: dict,. 
+0001d030: 2020 2029 3a0a 2020 2020 2020 2020 2222     ):.        ""
+0001d040: 220a 2020 2020 2020 2020 5570 6461 7465  ".        Update
+0001d050: 7320 6d6f 6465 6c20 656e 6470 6f69 6e74  s model endpoint
+0001d060: 2077 6974 6820 7072 6f76 6964 6564 2061   with provided a
+0001d070: 7474 7269 6275 7465 732e 0a0a 2020 2020  ttributes...    
+0001d080: 2020 2020 3a70 6172 616d 2070 726f 6a65      :param proje
+0001d090: 6374 3a20 5468 6520 6e61 6d65 206f 6620  ct: The name of 
+0001d0a0: 7468 6520 7072 6f6a 6563 742e 0a20 2020  the project..   
+0001d0b0: 2020 2020 203a 7061 7261 6d20 656e 6470       :param endp
+0001d0c0: 6f69 6e74 5f69 643a 2054 6865 2069 6420  oint_id: The id 
+0001d0d0: 6f66 2074 6865 2065 6e64 706f 696e 742e  of the endpoint.
+0001d0e0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0001d0f0: 6174 7472 6962 7574 6573 3a20 4469 6374  attributes: Dict
+0001d100: 696f 6e61 7279 206f 6620 6174 7472 6962  ionary of attrib
+0001d110: 7574 6573 2074 6861 7420 7769 6c6c 2062  utes that will b
+0001d120: 6520 7573 6564 2066 6f72 2075 7064 6174  e used for updat
+0001d130: 6520 7468 6520 6d6f 6465 6c20 656e 6470  e the model endp
+0001d140: 6f69 6e74 2e20 5468 6520 6b65 7973 0a20  oint. The keys. 
 0001d150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d160: 2020 2020 2020 6672 6f6d 2074 7970 6520        from type 
-0001d170: 7374 7269 6e67 206f 7220 6672 6f6d 2061  string or from a
-0001d180: 2076 616c 6964 206e 756d 6572 6963 616c   valid numerical
-0001d190: 2074 7970 6520 7375 6368 2061 7320 696e   type such as in
-0001d1a0: 7420 6f72 2066 6c6f 6174 2e0a 2020 2020  t or float..    
-0001d1b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d1c0: 2020 2020 2020 2020 4d6f 7265 2064 6574          More det
-0001d1d0: 6169 6c73 2061 626f 7574 2074 6865 206d  ails about the m
-0001d1e0: 6f64 656c 2065 6e64 706f 696e 7420 6176  odel endpoint av
-0001d1f0: 6169 6c61 626c 6520 6174 7472 6962 7574  ailable attribut
-0001d200: 6573 2063 616e 2062 6520 666f 756e 6420  es can be found 
-0001d210: 756e 6465 720a 2020 2020 2020 2020 2020  under.          
+0001d160: 2020 2020 2020 2020 2020 6f66 2074 6869            of thi
+0001d170: 7320 6469 6374 696f 6e61 7279 2073 686f  s dictionary sho
+0001d180: 756c 6420 6578 6973 7420 696e 2074 6865  uld exist in the
+0001d190: 2074 6172 6765 7420 7461 626c 652e 204e   target table. N
+0001d1a0: 6f74 6520 7468 6174 2074 6865 2076 616c  ote that the val
+0001d1b0: 7565 7320 7368 6f75 6c64 2062 650a 2020  ues should be.  
+0001d1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d1d0: 2020 2020 2020 2020 2066 726f 6d20 7479           from ty
+0001d1e0: 7065 2073 7472 696e 6720 6f72 2066 726f  pe string or fro
+0001d1f0: 6d20 6120 7661 6c69 6420 6e75 6d65 7269  m a valid numeri
+0001d200: 6361 6c20 7479 7065 2073 7563 6820 6173  cal type such as
+0001d210: 2069 6e74 206f 7220 666c 6f61 742e 0a20   int or float.. 
 0001d220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d230: 203a 7079 3a63 6c61 7373 3a60 7e6d 6c72   :py:class:`~mlr
-0001d240: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
-0001d250: 732e 4d6f 6465 6c45 6e64 706f 696e 7460  s.ModelEndpoint`
-0001d260: 2e0a 0a20 2020 2020 2020 2020 2020 2020  ...             
-0001d270: 2020 2020 2020 2020 2020 2020 2020 4578                Ex
-0001d280: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
+0001d230: 2020 2020 2020 2020 2020 204d 6f72 6520             More 
+0001d240: 6465 7461 696c 7320 6162 6f75 7420 7468  details about th
+0001d250: 6520 6d6f 6465 6c20 656e 6470 6f69 6e74  e model endpoint
+0001d260: 2061 7661 696c 6162 6c65 2061 7474 7269   available attri
+0001d270: 6275 7465 7320 6361 6e20 6265 2066 6f75  butes can be fou
+0001d280: 6e64 2075 6e64 6572 0a20 2020 2020 2020  nd under.       
 0001d290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d2a0: 2020 2020 2020 2020 2023 2047 656e 6572           # Gener
-0001d2b0: 6174 6520 6375 7272 656e 7420 7374 6174  ate current stat
-0001d2c0: 7320 666f 7220 7477 6f20 6665 6174 7572  s for two featur
-0001d2d0: 6573 0a20 2020 2020 2020 2020 2020 2020  es.             
+0001d2a0: 2020 2020 3a70 793a 636c 6173 733a 607e      :py:class:`~
+0001d2b0: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
+0001d2c0: 656d 6173 2e4d 6f64 656c 456e 6470 6f69  emas.ModelEndpoi
+0001d2d0: 6e74 602e 0a0a 2020 2020 2020 2020 2020  nt`...          
 0001d2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d2f0: 2020 2063 7572 7265 6e74 5f73 7461 7473     current_stats
-0001d300: 203d 207b 2774 7664 5f73 756d 273a 2032   = {'tvd_sum': 2
-0001d310: 2e32 2c0a 2020 2020 2020 2020 2020 2020  .2,.            
-0001d320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d340: 2020 2020 2027 7476 645f 6d65 616e 273a       'tvd_mean':
-0001d350: 2030 2e35 2c0a 2020 2020 2020 2020 2020   0.5,.          
-0001d360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d380: 2020 2020 2020 2027 6865 6c6c 696e 6765         'hellinge
-0001d390: 725f 7375 6d27 3a20 332e 362c 0a20 2020  r_sum': 3.6,.   
+0001d2f0: 2045 7861 6d70 6c65 3a3a 0a0a 2020 2020   Example::..    
+0001d300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d310: 2020 2020 2020 2020 2020 2020 2320 4765              # Ge
+0001d320: 6e65 7261 7465 2063 7572 7265 6e74 2073  nerate current s
+0001d330: 7461 7473 2066 6f72 2074 776f 2066 6561  tats for two fea
+0001d340: 7475 7265 730a 2020 2020 2020 2020 2020  tures.          
+0001d350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d360: 2020 2020 2020 6375 7272 656e 745f 7374        current_st
+0001d370: 6174 7320 3d20 7b27 7476 645f 7375 6d27  ats = {'tvd_sum'
+0001d380: 3a20 322e 322c 0a20 2020 2020 2020 2020  : 2.2,.         
+0001d390: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001d3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d3c0: 2020 2020 2020 2020 2020 2020 2020 2768                'h
-0001d3d0: 656c 6c69 6e67 6572 5f6d 6561 6e27 3a20  ellinger_mean': 
-0001d3e0: 302e 392c 0a20 2020 2020 2020 2020 2020  0.9,.           
-0001d3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d410: 2020 2020 2020 276b 6c64 5f73 756d 273a        'kld_sum':
-0001d420: 2032 342e 322c 0a20 2020 2020 2020 2020   24.2,.         
+0001d3b0: 2020 2020 2020 2020 2774 7664 5f6d 6561          'tvd_mea
+0001d3c0: 6e27 3a20 302e 352c 0a20 2020 2020 2020  n': 0.5,.       
+0001d3d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d3f0: 2020 2020 2020 2020 2020 2768 656c 6c69            'helli
+0001d400: 6e67 6572 5f73 756d 273a 2033 2e36 2c0a  nger_sum': 3.6,.
+0001d410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d420: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001d430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d450: 2020 2020 2020 2020 276b 6c64 5f6d 6561          'kld_mea
-0001d460: 6e27 3a20 362e 302c 0a20 2020 2020 2020  n': 6.0,.       
+0001d440: 2027 6865 6c6c 696e 6765 725f 6d65 616e   'hellinger_mean
+0001d450: 273a 2030 2e39 2c0a 2020 2020 2020 2020  ': 0.9,.        
+0001d460: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001d470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d490: 2020 2020 2020 2020 2020 2766 3127 3a20            'f1': 
-0001d4a0: 7b27 7476 6427 3a20 302e 352c 2027 6865  {'tvd': 0.5, 'he
-0001d4b0: 6c6c 696e 6765 7227 3a20 312e 302c 2027  llinger': 1.0, '
-0001d4c0: 6b6c 6427 3a20 362e 347d 2c0a 2020 2020  kld': 6.4},.    
-0001d4d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d480: 2020 2020 2020 2020 2027 6b6c 645f 7375           'kld_su
+0001d490: 6d27 3a20 3234 2e32 2c0a 2020 2020 2020  m': 24.2,.      
+0001d4a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d4c0: 2020 2020 2020 2020 2020 2027 6b6c 645f             'kld_
+0001d4d0: 6d65 616e 273a 2036 2e30 2c0a 2020 2020  mean': 6.0,.    
 0001d4e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d4f0: 2020 2020 2020 2020 2020 2020 2027 6632               'f2
-0001d500: 273a 207b 2774 7664 273a 2030 2e35 2c20  ': {'tvd': 0.5, 
-0001d510: 2768 656c 6c69 6e67 6572 273a 2031 2e30  'hellinger': 1.0
-0001d520: 2c20 276b 6c64 273a 2036 2e35 7d7d 0a0a  , 'kld': 6.5}}..
-0001d530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d500: 2020 2020 2020 2020 2020 2020 2027 6631               'f1
+0001d510: 273a 207b 2774 7664 273a 2030 2e35 2c20  ': {'tvd': 0.5, 
+0001d520: 2768 656c 6c69 6e67 6572 273a 2031 2e30  'hellinger': 1.0
+0001d530: 2c20 276b 6c64 273a 2036 2e34 7d2c 0a20  , 'kld': 6.4},. 
 0001d540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d550: 2320 4372 6561 7465 2061 7474 7269 6275  # Create attribu
-0001d560: 7465 7320 6469 6374 696f 6e61 7279 2061  tes dictionary a
-0001d570: 6363 6f72 6469 6e67 2074 6f20 7468 6520  ccording to the 
-0001d580: 7265 7175 6972 6564 2066 6f72 6d61 740a  required format.
-0001d590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d5a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d5b0: 6174 7472 6962 7574 6573 203d 207b 6063  attributes = {`c
-0001d5c0: 7572 7265 6e74 5f73 7461 7473 603a 206a  urrent_stats`: j
-0001d5d0: 736f 6e2e 6475 6d70 7328 6375 7272 656e  son.dumps(curren
-0001d5e0: 745f 7374 6174 7329 2c0a 2020 2020 2020  t_stats),.      
-0001d5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d610: 2020 2020 2020 2020 6064 7269 6674 5f73          `drift_s
-0001d620: 7461 7475 7360 3a20 2244 5249 4654 5f44  tatus`: "DRIFT_D
-0001d630: 4554 4543 5445 4422 7d0a 0a20 2020 2020  ETECTED"}..     
-0001d640: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
-0001d650: 6174 7472 6962 7574 6573 203d 207b 2261  attributes = {"a
-0001d660: 7474 7269 6275 7465 7322 3a20 5f61 735f  ttributes": _as_
-0001d670: 6a73 6f6e 2861 7474 7269 6275 7465 7329  json(attributes)
-0001d680: 7d0a 2020 2020 2020 2020 7061 7468 203d  }.        path =
-0001d690: 2066 2270 726f 6a65 6374 732f 7b70 726f   f"projects/{pro
-0001d6a0: 6a65 6374 7d2f 6d6f 6465 6c2d 656e 6470  ject}/model-endp
-0001d6b0: 6f69 6e74 732f 7b65 6e64 706f 696e 745f  oints/{endpoint_
-0001d6c0: 6964 7d22 0a20 2020 2020 2020 2073 656c  id}".        sel
-0001d6d0: 662e 6170 695f 6361 6c6c 280a 2020 2020  f.api_call(.    
-0001d6e0: 2020 2020 2020 2020 6d65 7468 6f64 3d22          method="
-0001d6f0: 5041 5443 4822 2c0a 2020 2020 2020 2020  PATCH",.        
-0001d700: 2020 2020 7061 7468 3d70 6174 682c 0a20      path=path,. 
-0001d710: 2020 2020 2020 2020 2020 2070 6172 616d             param
-0001d720: 733d 6174 7472 6962 7574 6573 2c0a 2020  s=attributes,.  
-0001d730: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
-0001d740: 2063 7265 6174 655f 6875 625f 736f 7572   create_hub_sour
-0001d750: 6365 280a 2020 2020 2020 2020 7365 6c66  ce(.        self
-0001d760: 2c20 736f 7572 6365 3a20 556e 696f 6e5b  , source: Union[
-0001d770: 6469 6374 2c20 6d6c 7275 6e2e 636f 6d6d  dict, mlrun.comm
-0001d780: 6f6e 2e73 6368 656d 6173 2e49 6e64 6578  on.schemas.Index
-0001d790: 6564 4875 6253 6f75 7263 655d 0a20 2020  edHubSource].   
-0001d7a0: 2029 3a0a 2020 2020 2020 2020 2222 220a   ):.        """.
-0001d7b0: 2020 2020 2020 2020 4164 6420 6120 6e65          Add a ne
-0001d7c0: 7720 6875 6220 736f 7572 6365 2e0a 0a20  w hub source... 
-0001d7d0: 2020 2020 2020 204d 4c52 756e 206d 6169         MLRun mai
-0001d7e0: 6e74 6169 6e73 2061 6e20 6f72 6465 7265  ntains an ordere
-0001d7f0: 6420 6c69 7374 206f 6620 6875 6220 736f  d list of hub so
-0001d800: 7572 6365 7320 28e2 809c 736f 7572 6365  urces (...source
-0001d810: 73e2 809d 2920 4561 6368 2073 6f75 7263  s...) Each sourc
-0001d820: 6520 6861 730a 2020 2020 2020 2020 6974  e has.        it
-0001d830: 7320 6465 7461 696c 7320 7265 6769 7374  s details regist
-0001d840: 6572 6564 2061 6e64 2069 7473 206f 7264  ered and its ord
-0001d850: 6572 2077 6974 6869 6e20 7468 6520 6c69  er within the li
-0001d860: 7374 2e20 5768 656e 2063 7265 6174 696e  st. When creatin
-0001d870: 6720 6120 6e65 7720 736f 7572 6365 2c20  g a new source, 
-0001d880: 7468 6520 7370 6563 6961 6c20 6f72 6465  the special orde
-0001d890: 7220 6060 2d31 6060 0a20 2020 2020 2020  r ``-1``.       
-0001d8a0: 2063 616e 2062 6520 7573 6564 2074 6f20   can be used to 
-0001d8b0: 6d61 726b 2074 6869 7320 736f 7572 6365  mark this source
-0001d8c0: 2061 7320 6c61 7374 2069 6e20 7468 6520   as last in the 
-0001d8d0: 6c69 7374 2e20 486f 7765 7665 722c 206f  list. However, o
-0001d8e0: 6e63 6520 7468 6520 736f 7572 6365 2069  nce the source i
-0001d8f0: 7320 696e 2074 6865 204d 4c52 756e 206c  s in the MLRun l
-0001d900: 6973 742c 0a20 2020 2020 2020 2069 7473  ist,.        its
-0001d910: 206f 7264 6572 2077 696c 6c20 616c 7761   order will alwa
-0001d920: 7973 2062 6520 6060 3e30 6060 2e0a 0a20  ys be ``>0``... 
-0001d930: 2020 2020 2020 2054 6865 2067 6c6f 6261         The globa
-0001d940: 6c20 6875 6220 736f 7572 6365 2061 6c77  l hub source alw
-0001d950: 6179 7320 6578 6973 7473 2069 6e20 7468  ays exists in th
-0001d960: 6520 6c69 7374 2c20 616e 6420 6973 2061  e list, and is a
-0001d970: 6c77 6179 7320 7468 6520 6c61 7374 2073  lways the last s
-0001d980: 6f75 7263 650a 2020 2020 2020 2020 2860  ource.        (`
-0001d990: 606f 7264 6572 203d 202d 3160 6029 2e20  `order = -1``). 
-0001d9a0: 4974 2063 616e 6e6f 7420 6265 206d 6f64  It cannot be mod
-0001d9b0: 6966 6965 6420 6e6f 7220 6361 6e20 6974  ified nor can it
-0001d9c0: 2062 6520 6d6f 7665 6420 746f 2061 6e6f   be moved to ano
-0001d9d0: 7468 6572 206f 7264 6572 2069 6e20 7468  ther order in th
-0001d9e0: 6520 6c69 7374 2e0a 0a20 2020 2020 2020  e list...       
-0001d9f0: 2054 6865 2073 6f75 7263 6520 6f62 6a65   The source obje
-0001da00: 6374 206d 6179 2063 6f6e 7461 696e 2063  ct may contain c
-0001da10: 7265 6465 6e74 6961 6c73 2077 6869 6368  redentials which
-0001da20: 2061 7265 206e 6565 6465 6420 746f 2061   are needed to a
-0001da30: 6363 6573 7320 7468 6520 6461 7461 7374  ccess the datast
-0001da40: 6f72 6520 7768 6572 6520 7468 6520 736f  ore where the so
-0001da50: 7572 6365 2069 7320 7374 6f72 6564 2e0a  urce is stored..
-0001da60: 2020 2020 2020 2020 5468 6573 6520 6372          These cr
-0001da70: 6564 656e 7469 616c 7320 6172 6520 6e6f  edentials are no
-0001da80: 7420 6b65 7074 2069 6e20 7468 6520 4d4c  t kept in the ML
-0001da90: 5275 6e20 4442 2c20 6275 7420 6172 6520  Run DB, but are 
-0001daa0: 7374 6f72 6564 2069 6e73 6964 6520 6120  stored inside a 
-0001dab0: 6b75 6265 726e 6574 6573 2073 6563 7265  kubernetes secre
-0001dac0: 7420 6f62 6a65 6374 206d 6169 6e74 6169  t object maintai
-0001dad0: 6e65 6420 6279 0a20 2020 2020 2020 204d  ned by.        M
-0001dae0: 4c52 756e 2e20 5468 6579 2061 7265 206e  LRun. They are n
-0001daf0: 6f74 2072 6574 7572 6e65 6420 7468 726f  ot returned thro
-0001db00: 7567 6820 616e 7920 4150 4920 6672 6f6d  ugh any API from
-0001db10: 204d 4c52 756e 2e0a 0a20 2020 2020 2020   MLRun...       
-0001db20: 2045 7861 6d70 6c65 3a3a 0a0a 2020 2020   Example::..    
-0001db30: 2020 2020 2020 2020 696d 706f 7274 206d          import m
-0001db40: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
-0001db50: 6d61 730a 0a20 2020 2020 2020 2020 2020  mas..           
-0001db60: 2023 2041 6464 2061 2070 7269 7661 7465   # Add a private
-0001db70: 2073 6f75 7263 6520 6173 2074 6865 206c   source as the l
-0001db80: 6173 7420 6f6e 6520 2877 696c 6c20 6265  ast one (will be
-0001db90: 2023 3120 696e 2074 6865 206c 6973 7429   #1 in the list)
-0001dba0: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
-0001dbb0: 7661 7465 5f73 6f75 7263 6520 3d20 6d6c  vate_source = ml
-0001dbc0: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
-0001dbd0: 6173 2e49 6e64 6578 6564 4875 6265 536f  as.IndexedHubeSo
-0001dbe0: 7572 6365 280a 2020 2020 2020 2020 2020  urce(.          
-0001dbf0: 2020 2020 2020 6f72 6465 723d 2d31 2c0a        order=-1,.
-0001dc00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dc10: 736f 7572 6365 3d6d 6c72 756e 2e63 6f6d  source=mlrun.com
-0001dc20: 6d6f 6e2e 7363 6865 6d61 732e 4875 6253  mon.schemas.HubS
-0001dc30: 6f75 7263 6528 0a20 2020 2020 2020 2020  ource(.         
-0001dc40: 2020 2020 2020 2020 2020 206d 6574 6164             metad
-0001dc50: 6174 613d 6d6c 7275 6e2e 636f 6d6d 6f6e  ata=mlrun.common
-0001dc60: 2e73 6368 656d 6173 2e48 7562 4f62 6a65  .schemas.HubObje
-0001dc70: 6374 4d65 7461 6461 7461 280a 2020 2020  ctMetadata(.    
-0001dc80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dc90: 2020 2020 6e61 6d65 3d22 7072 6976 222c      name="priv",
-0001dca0: 2064 6573 6372 6970 7469 6f6e 3d22 6120   description="a 
-0001dcb0: 7072 6976 6174 6520 736f 7572 6365 220a  private source".
-0001dcc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dcd0: 2020 2020 292c 0a20 2020 2020 2020 2020      ),.         
-0001dce0: 2020 2020 2020 2020 2020 2073 7065 633d             spec=
-0001dcf0: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
-0001dd00: 656d 6173 2e48 7562 536f 7572 6365 5370  emas.HubSourceSp
-0001dd10: 6563 2870 6174 683d 222f 6c6f 6361 6c2f  ec(path="/local/
-0001dd20: 7061 7468 2f74 6f2f 736f 7572 6365 222c  path/to/source",
-0001dd30: 2063 6861 6e6e 656c 3d22 6465 7665 6c6f   channel="develo
-0001dd40: 706d 656e 7422 290a 2020 2020 2020 2020  pment").        
-0001dd50: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0001dd60: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0001dd70: 2020 2020 6462 2e63 7265 6174 655f 6875      db.create_hu
-0001dd80: 625f 736f 7572 6365 2870 7269 7661 7465  b_source(private
-0001dd90: 5f73 6f75 7263 6529 0a0a 2020 2020 2020  _source)..      
-0001dda0: 2020 2020 2020 2320 4164 6420 616e 6f74        # Add anot
-0001ddb0: 6865 7220 736f 7572 6365 2061 7320 3173  her source as 1s
-0001ddc0: 7420 696e 2074 6865 206c 6973 7420 2d20  t in the list - 
-0001ddd0: 7769 6c6c 2070 7573 6820 7072 6576 696f  will push previo
-0001dde0: 7573 206f 6e65 2074 6f20 6265 2023 320a  us one to be #2.
-0001ddf0: 2020 2020 2020 2020 2020 2020 616e 6f74              anot
-0001de00: 6865 725f 736f 7572 6365 203d 206d 6c72  her_source = mlr
-0001de10: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
-0001de20: 732e 496e 6465 7865 6448 7562 536f 7572  s.IndexedHubSour
-0001de30: 6365 280a 2020 2020 2020 2020 2020 2020  ce(.            
-0001de40: 2020 2020 6f72 6465 723d 312c 0a20 2020      order=1,.   
-0001de50: 2020 2020 2020 2020 2020 2020 2073 6f75               sou
-0001de60: 7263 653d 6d6c 7275 6e2e 636f 6d6d 6f6e  rce=mlrun.common
-0001de70: 2e73 6368 656d 6173 2e48 7562 536f 7572  .schemas.HubSour
-0001de80: 6365 280a 2020 2020 2020 2020 2020 2020  ce(.            
-0001de90: 2020 2020 2020 2020 6d65 7461 6461 7461          metadata
-0001dea0: 3d6d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363  =mlrun.common.sc
-0001deb0: 6865 6d61 732e 4875 624f 626a 6563 744d  hemas.HubObjectM
-0001dec0: 6574 6164 6174 6128 0a20 2020 2020 2020  etadata(.       
-0001ded0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dee0: 206e 616d 653d 2270 7269 762d 3222 2c20   name="priv-2", 
-0001def0: 6465 7363 7269 7074 696f 6e3d 2261 6e6f  description="ano
-0001df00: 7468 6572 2073 6f75 7263 6522 0a20 2020  ther source".   
-0001df10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001df20: 2029 2c0a 2020 2020 2020 2020 2020 2020   ),.            
-0001df30: 2020 2020 2020 2020 7370 6563 3d6d 6c72          spec=mlr
-0001df40: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
-0001df50: 732e 4875 6253 6f75 7263 6553 7065 6328  s.HubSourceSpec(
-0001df60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001df70: 2020 2020 2020 2020 2070 6174 683d 222f           path="/
-0001df80: 6c6f 6361 6c2f 7061 7468 2f74 6f2f 736f  local/path/to/so
-0001df90: 7572 6365 2f32 222c 0a20 2020 2020 2020  urce/2",.       
-0001dfa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dfb0: 2063 6861 6e6e 656c 3d22 6465 7665 6c6f   channel="develo
-0001dfc0: 706d 656e 7422 2c0a 2020 2020 2020 2020  pment",.        
-0001dfd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dfe0: 6372 6564 656e 7469 616c 733d 7b2e 2e2e  credentials={...
-0001dff0: 7d0a 2020 2020 2020 2020 2020 2020 2020  }.              
-0001e000: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0001e010: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0001e020: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0001e030: 2020 2020 6462 2e63 7265 6174 655f 6875      db.create_hu
-0001e040: 625f 736f 7572 6365 2861 6e6f 7468 6572  b_source(another
-0001e050: 5f73 6f75 7263 6529 0a0a 2020 2020 2020  _source)..      
-0001e060: 2020 3a70 6172 616d 2073 6f75 7263 653a    :param source:
-0001e070: 2054 6865 2073 6f75 7263 6520 616e 6420   The source and 
-0001e080: 6974 7320 6f72 6465 722c 206f 6620 7479  its order, of ty
-0001e090: 7065 0a20 2020 2020 2020 2020 2020 203a  pe.            :
-0001e0a0: 7079 3a63 6c61 7373 3a60 7e6d 6c72 756e  py:class:`~mlrun
-0001e0b0: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
-0001e0c0: 6875 622e 496e 6465 7865 6448 7562 536f  hub.IndexedHubSo
-0001e0d0: 7572 6365 602c 206f 7220 696e 2064 6963  urce`, or in dic
-0001e0e0: 7469 6f6e 6172 7920 666f 726d 2e0a 2020  tionary form..  
-0001e0f0: 2020 2020 2020 3a72 6574 7572 6e73 3a20        :returns: 
-0001e100: 5468 6520 736f 7572 6365 206f 626a 6563  The source objec
-0001e110: 7420 6173 2069 6e73 6572 7465 6420 696e  t as inserted in
-0001e120: 746f 2074 6865 2064 6174 6162 6173 652c  to the database,
-0001e130: 2077 6974 6820 6372 6564 656e 7469 616c   with credential
-0001e140: 7320 7374 7269 7070 6564 2e0a 2020 2020  s stripped..    
-0001e150: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0001e160: 7061 7468 203d 2022 6875 622f 736f 7572  path = "hub/sour
-0001e170: 6365 7322 0a20 2020 2020 2020 2069 6620  ces".        if 
-0001e180: 6973 696e 7374 616e 6365 2873 6f75 7263  isinstance(sourc
-0001e190: 652c 206d 6c72 756e 2e63 6f6d 6d6f 6e2e  e, mlrun.common.
-0001e1a0: 7363 6865 6d61 732e 496e 6465 7865 6448  schemas.IndexedH
-0001e1b0: 7562 536f 7572 6365 293a 0a20 2020 2020  ubSource):.     
-0001e1c0: 2020 2020 2020 2073 6f75 7263 6520 3d20         source = 
-0001e1d0: 736f 7572 6365 2e64 6963 7428 290a 2020  source.dict().  
-0001e1e0: 2020 2020 2020 7265 7370 6f6e 7365 203d        response =
-0001e1f0: 2073 656c 662e 6170 695f 6361 6c6c 286d   self.api_call(m
-0001e200: 6574 686f 643d 2250 4f53 5422 2c20 7061  ethod="POST", pa
-0001e210: 7468 3d70 6174 682c 206a 736f 6e3d 736f  th=path, json=so
-0001e220: 7572 6365 290a 2020 2020 2020 2020 7265  urce).        re
-0001e230: 7475 726e 206d 6c72 756e 2e63 6f6d 6d6f  turn mlrun.commo
-0001e240: 6e2e 7363 6865 6d61 732e 496e 6465 7865  n.schemas.Indexe
-0001e250: 6448 7562 536f 7572 6365 282a 2a72 6573  dHubSource(**res
-0001e260: 706f 6e73 652e 6a73 6f6e 2829 290a 0a20  ponse.json()).. 
-0001e270: 2020 2064 6566 2073 746f 7265 5f68 7562     def store_hub
-0001e280: 5f73 6f75 7263 6528 0a20 2020 2020 2020  _source(.       
-0001e290: 2073 656c 662c 0a20 2020 2020 2020 2073   self,.        s
-0001e2a0: 6f75 7263 655f 6e61 6d65 3a20 7374 722c  ource_name: str,
-0001e2b0: 0a20 2020 2020 2020 2073 6f75 7263 653a  .        source:
-0001e2c0: 2055 6e69 6f6e 5b64 6963 742c 206d 6c72   Union[dict, mlr
-0001e2d0: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
-0001e2e0: 732e 496e 6465 7865 6448 7562 536f 7572  s.IndexedHubSour
-0001e2f0: 6365 5d2c 0a20 2020 2029 3a0a 2020 2020  ce],.    ):.    
-0001e300: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0001e310: 4372 6561 7465 206f 7220 7265 706c 6163  Create or replac
-0001e320: 6520 6120 6875 6220 736f 7572 6365 2e0a  e a hub source..
-0001e330: 2020 2020 2020 2020 466f 7220 616e 2065          For an e
-0001e340: 7861 6d70 6c65 206f 6620 7468 6520 736f  xample of the so
-0001e350: 7572 6365 2066 6f72 6d61 7420 616e 6420  urce format and 
-0001e360: 6578 706c 616e 6174 696f 6e20 6f66 2074  explanation of t
-0001e370: 6865 2073 6f75 7263 6520 6f72 6465 7220  he source order 
-0001e380: 6c6f 6769 632c 0a20 2020 2020 2020 2070  logic,.        p
-0001e390: 6c65 6173 6520 7365 6520 3a70 793a 6675  lease see :py:fu
-0001e3a0: 6e63 3a60 7e63 7265 6174 655f 6875 625f  nc:`~create_hub_
-0001e3b0: 736f 7572 6365 602e 2054 6869 7320 6d65  source`. This me
-0001e3c0: 7468 6f64 2063 616e 2062 6520 7573 6564  thod can be used
-0001e3d0: 2074 6f20 6d6f 6469 6679 2074 6865 2073   to modify the s
-0001e3e0: 6f75 7263 6520 6974 7365 6c66 206f 7220  ource itself or 
-0001e3f0: 6974 730a 2020 2020 2020 2020 6f72 6465  its.        orde
-0001e400: 7220 696e 2074 6865 206c 6973 7420 6f66  r in the list of
-0001e410: 2073 6f75 7263 6573 2e0a 0a20 2020 2020   sources...     
-0001e420: 2020 203a 7061 7261 6d20 736f 7572 6365     :param source
-0001e430: 5f6e 616d 653a 204e 616d 6520 6f66 2074  _name: Name of t
-0001e440: 6865 2073 6f75 7263 6520 6f62 6a65 6374  he source object
-0001e450: 2074 6f20 6d6f 6469 6679 2f63 7265 6174   to modify/creat
-0001e460: 652e 2049 7420 6d75 7374 206d 6174 6368  e. It must match
-0001e470: 2074 6865 2060 6073 6f75 7263 652e 6d65   the ``source.me
-0001e480: 7461 6461 7461 2e6e 616d 6560 600a 2020  tadata.name``.  
-0001e490: 2020 2020 2020 2020 2020 7061 7261 6d65            parame
-0001e4a0: 7465 7220 696e 2074 6865 2073 6f75 7263  ter in the sourc
-0001e4b0: 6520 6974 7365 6c66 2e0a 2020 2020 2020  e itself..      
-0001e4c0: 2020 3a70 6172 616d 2073 6f75 7263 653a    :param source:
-0001e4d0: 2053 6f75 7263 6520 6f62 6a65 6374 2074   Source object t
-0001e4e0: 6f20 7374 6f72 6520 696e 2074 6865 2064  o store in the d
-0001e4f0: 6174 6162 6173 652e 0a20 2020 2020 2020  atabase..       
-0001e500: 203a 7265 7475 726e 733a 2054 6865 2073   :returns: The s
-0001e510: 6f75 7263 6520 6f62 6a65 6374 2061 7320  ource object as 
-0001e520: 7374 6f72 6564 2069 6e20 7468 6520 4442  stored in the DB
-0001e530: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-0001e540: 2020 2020 2020 7061 7468 203d 2066 2268        path = f"h
-0001e550: 7562 2f73 6f75 7263 6573 2f7b 736f 7572  ub/sources/{sour
-0001e560: 6365 5f6e 616d 657d 220a 2020 2020 2020  ce_name}".      
-0001e570: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-0001e580: 736f 7572 6365 2c20 6d6c 7275 6e2e 636f  source, mlrun.co
-0001e590: 6d6d 6f6e 2e73 6368 656d 6173 2e49 6e64  mmon.schemas.Ind
-0001e5a0: 6578 6564 4875 6253 6f75 7263 6529 3a0a  exedHubSource):.
-0001e5b0: 2020 2020 2020 2020 2020 2020 736f 7572              sour
-0001e5c0: 6365 203d 2073 6f75 7263 652e 6469 6374  ce = source.dict
-0001e5d0: 2829 0a0a 2020 2020 2020 2020 7265 7370  ()..        resp
-0001e5e0: 6f6e 7365 203d 2073 656c 662e 6170 695f  onse = self.api_
-0001e5f0: 6361 6c6c 286d 6574 686f 643d 2250 5554  call(method="PUT
-0001e600: 222c 2070 6174 683d 7061 7468 2c20 6a73  ", path=path, js
-0001e610: 6f6e 3d73 6f75 7263 6529 0a20 2020 2020  on=source).     
-0001e620: 2020 2072 6574 7572 6e20 6d6c 7275 6e2e     return mlrun.
-0001e630: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e49  common.schemas.I
-0001e640: 6e64 6578 6564 4875 6253 6f75 7263 6528  ndexedHubSource(
-0001e650: 2a2a 7265 7370 6f6e 7365 2e6a 736f 6e28  **response.json(
-0001e660: 2929 0a0a 2020 2020 6465 6620 6c69 7374  ))..    def list
-0001e670: 5f68 7562 5f73 6f75 7263 6573 2873 656c  _hub_sources(sel
-0001e680: 6629 3a0a 2020 2020 2020 2020 2222 220a  f):.        """.
-0001e690: 2020 2020 2020 2020 4c69 7374 2068 7562          List hub
-0001e6a0: 2073 6f75 7263 6573 2069 6e20 7468 6520   sources in the 
-0001e6b0: 4d4c 5275 6e20 4442 2e0a 2020 2020 2020  MLRun DB..      
-0001e6c0: 2020 2222 220a 2020 2020 2020 2020 7061    """.        pa
-0001e6d0: 7468 203d 2022 6875 622f 736f 7572 6365  th = "hub/source
-0001e6e0: 7322 0a20 2020 2020 2020 2072 6573 706f  s".        respo
-0001e6f0: 6e73 6520 3d20 7365 6c66 2e61 7069 5f63  nse = self.api_c
-0001e700: 616c 6c28 6d65 7468 6f64 3d22 4745 5422  all(method="GET"
-0001e710: 2c20 7061 7468 3d70 6174 6829 2e6a 736f  , path=path).jso
-0001e720: 6e28 290a 2020 2020 2020 2020 7265 7375  n().        resu
-0001e730: 6c74 7320 3d20 5b5d 0a20 2020 2020 2020  lts = [].       
-0001e740: 2066 6f72 2069 7465 6d20 696e 2072 6573   for item in res
-0001e750: 706f 6e73 653a 0a20 2020 2020 2020 2020  ponse:.         
-0001e760: 2020 2072 6573 756c 7473 2e61 7070 656e     results.appen
-0001e770: 6428 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  d(mlrun.common.s
-0001e780: 6368 656d 6173 2e49 6e64 6578 6564 4875  chemas.IndexedHu
-0001e790: 6253 6f75 7263 6528 2a2a 6974 656d 2929  bSource(**item))
-0001e7a0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0001e7b0: 7265 7375 6c74 730a 0a20 2020 2064 6566  results..    def
-0001e7c0: 2067 6574 5f68 7562 5f73 6f75 7263 6528   get_hub_source(
-0001e7d0: 7365 6c66 2c20 736f 7572 6365 5f6e 616d  self, source_nam
-0001e7e0: 653a 2073 7472 293a 0a20 2020 2020 2020  e: str):.       
-0001e7f0: 2022 2222 0a20 2020 2020 2020 2052 6574   """.        Ret
-0001e800: 7269 6576 6520 6120 6875 6220 736f 7572  rieve a hub sour
-0001e810: 6365 2066 726f 6d20 7468 6520 4442 2e0a  ce from the DB..
-0001e820: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-0001e830: 736f 7572 6365 5f6e 616d 653a 204e 616d  source_name: Nam
-0001e840: 6520 6f66 2074 6865 2068 7562 2073 6f75  e of the hub sou
-0001e850: 7263 6520 746f 2072 6574 7269 6576 652e  rce to retrieve.
-0001e860: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0001e870: 2020 2020 2070 6174 6820 3d20 6622 6875       path = f"hu
-0001e880: 622f 736f 7572 6365 732f 7b73 6f75 7263  b/sources/{sourc
-0001e890: 655f 6e61 6d65 7d22 0a20 2020 2020 2020  e_name}".       
-0001e8a0: 2072 6573 706f 6e73 6520 3d20 7365 6c66   response = self
-0001e8b0: 2e61 7069 5f63 616c 6c28 6d65 7468 6f64  .api_call(method
-0001e8c0: 3d22 4745 5422 2c20 7061 7468 3d70 6174  ="GET", path=pat
-0001e8d0: 6829 0a20 2020 2020 2020 2072 6574 7572  h).        retur
-0001e8e0: 6e20 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  n mlrun.common.s
-0001e8f0: 6368 656d 6173 2e49 6e64 6578 6564 4875  chemas.IndexedHu
-0001e900: 6253 6f75 7263 6528 2a2a 7265 7370 6f6e  bSource(**respon
-0001e910: 7365 2e6a 736f 6e28 2929 0a0a 2020 2020  se.json())..    
-0001e920: 6465 6620 6465 6c65 7465 5f68 7562 5f73  def delete_hub_s
-0001e930: 6f75 7263 6528 7365 6c66 2c20 736f 7572  ource(self, sour
-0001e940: 6365 5f6e 616d 653a 2073 7472 293a 0a20  ce_name: str):. 
-0001e950: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0001e960: 2020 2044 656c 6574 6520 6120 6875 6220     Delete a hub 
-0001e970: 736f 7572 6365 2066 726f 6d20 7468 6520  source from the 
-0001e980: 4442 2e0a 2020 2020 2020 2020 5468 6520  DB..        The 
-0001e990: 736f 7572 6365 2077 696c 6c20 6265 2064  source will be d
-0001e9a0: 656c 6574 6564 2066 726f 6d20 7468 6520  eleted from the 
-0001e9b0: 6c69 7374 2c20 616e 6420 616e 7920 666f  list, and any fo
-0001e9c0: 6c6c 6f77 696e 6720 736f 7572 6365 7320  llowing sources 
-0001e9d0: 7769 6c6c 2062 6520 7072 6f6d 6f74 6564  will be promoted
-0001e9e0: 202d 2066 6f72 2065 7861 6d70 6c65 2c20   - for example, 
-0001e9f0: 6966 2074 6865 0a20 2020 2020 2020 2031  if the.        1
-0001ea00: 7374 2073 6f75 7263 6520 6973 2064 656c  st source is del
-0001ea10: 6574 6564 2c20 7468 6520 326e 6420 736f  eted, the 2nd so
-0001ea20: 7572 6365 2077 696c 6c20 6265 636f 6d65  urce will become
-0001ea30: 2023 3120 696e 2074 6865 206c 6973 742e   #1 in the list.
-0001ea40: 0a20 2020 2020 2020 2054 6865 2067 6c6f  .        The glo
-0001ea50: 6261 6c20 6875 6220 736f 7572 6365 2063  bal hub source c
-0001ea60: 616e 6e6f 7420 6265 2064 656c 6574 6564  annot be deleted
-0001ea70: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
-0001ea80: 6d20 736f 7572 6365 5f6e 616d 653a 204e  m source_name: N
-0001ea90: 616d 6520 6f66 2074 6865 2068 7562 2073  ame of the hub s
-0001eaa0: 6f75 7263 6520 746f 2064 656c 6574 652e  ource to delete.
-0001eab0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0001eac0: 2020 2020 2070 6174 6820 3d20 6622 6875       path = f"hu
-0001ead0: 622f 736f 7572 6365 732f 7b73 6f75 7263  b/sources/{sourc
-0001eae0: 655f 6e61 6d65 7d22 0a20 2020 2020 2020  e_name}".       
-0001eaf0: 2073 656c 662e 6170 695f 6361 6c6c 286d   self.api_call(m
-0001eb00: 6574 686f 643d 2244 454c 4554 4522 2c20  ethod="DELETE", 
-0001eb10: 7061 7468 3d70 6174 6829 0a0a 2020 2020  path=path)..    
-0001eb20: 6465 6620 6765 745f 6875 625f 6361 7461  def get_hub_cata
-0001eb30: 6c6f 6728 0a20 2020 2020 2020 2073 656c  log(.        sel
-0001eb40: 662c 0a20 2020 2020 2020 2073 6f75 7263  f,.        sourc
-0001eb50: 655f 6e61 6d65 3a20 7374 722c 0a20 2020  e_name: str,.   
-0001eb60: 2020 2020 2076 6572 7369 6f6e 3a20 7374       version: st
-0001eb70: 7220 3d20 4e6f 6e65 2c0a 2020 2020 2020  r = None,.      
-0001eb80: 2020 7461 673a 2073 7472 203d 204e 6f6e    tag: str = Non
-0001eb90: 652c 0a20 2020 2020 2020 2066 6f72 6365  e,.        force
-0001eba0: 5f72 6566 7265 7368 3a20 626f 6f6c 203d  _refresh: bool =
-0001ebb0: 2046 616c 7365 2c0a 2020 2020 293a 0a20   False,.    ):. 
-0001ebc0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0001ebd0: 2020 2052 6574 7269 6576 6520 7468 6520     Retrieve the 
-0001ebe0: 6974 656d 2063 6174 616c 6f67 2066 6f72  item catalog for
-0001ebf0: 2061 2073 7065 6369 6669 6564 2068 7562   a specified hub
-0001ec00: 2073 6f75 7263 652e 0a20 2020 2020 2020   source..       
-0001ec10: 2054 6865 206c 6973 7420 6f66 2069 7465   The list of ite
-0001ec20: 6d73 2063 616e 2062 6520 6669 6c74 6572  ms can be filter
-0001ec30: 6564 2061 6363 6f72 6469 6e67 2074 6f20  ed according to 
-0001ec40: 7661 7269 6f75 7320 6669 6c74 6572 732c  various filters,
-0001ec50: 2075 7369 6e67 2069 7465 6d27 7320 6d65   using item's me
-0001ec60: 7461 6461 7461 2074 6f20 6669 6c74 6572  tadata to filter
-0001ec70: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
-0001ec80: 6d20 736f 7572 6365 5f6e 616d 653a 204e  m source_name: N
-0001ec90: 616d 6520 6f66 2074 6865 2073 6f75 7263  ame of the sourc
-0001eca0: 652e 0a20 2020 2020 2020 203a 7061 7261  e..        :para
-0001ecb0: 6d20 7665 7273 696f 6e3a 2046 696c 7465  m version: Filte
-0001ecc0: 7220 6974 656d 7320 6163 636f 7264 696e  r items accordin
-0001ecd0: 6720 746f 2074 6865 6972 2076 6572 7369  g to their versi
-0001ece0: 6f6e 2e0a 2020 2020 2020 2020 3a70 6172  on..        :par
-0001ecf0: 616d 2074 6167 3a20 4669 6c74 6572 2069  am tag: Filter i
-0001ed00: 7465 6d73 2062 6173 6564 206f 6e20 7461  tems based on ta
-0001ed10: 672e 0a20 2020 2020 2020 203a 7061 7261  g..        :para
-0001ed20: 6d20 666f 7263 655f 7265 6672 6573 683a  m force_refresh:
-0001ed30: 204d 616b 6520 7468 6520 7365 7276 6572   Make the server
-0001ed40: 2066 6574 6368 2074 6865 2063 6174 616c   fetch the catal
-0001ed50: 6f67 2066 726f 6d20 7468 6520 6163 7475  og from the actu
-0001ed60: 616c 2068 7562 2073 6f75 7263 652c 0a20  al hub source,. 
-0001ed70: 2020 2020 2020 2020 2020 2072 6174 6865             rathe
-0001ed80: 7220 7468 616e 2072 656c 7920 6f6e 2063  r than rely on c
-0001ed90: 6163 6865 6420 696e 666f 726d 6174 696f  ached informatio
-0001eda0: 6e20 7768 6963 6820 6d61 7920 6578 6973  n which may exis
-0001edb0: 7420 6672 6f6d 2070 7265 7669 6f75 7320  t from previous 
-0001edc0: 6765 7420 7265 7175 6573 7473 2e20 466f  get requests. Fo
-0001edd0: 7220 6578 616d 706c 652c 0a20 2020 2020  r example,.     
-0001ede0: 2020 2020 2020 2069 6620 7468 6520 736f         if the so
-0001edf0: 7572 6365 2077 6173 2072 652d 6275 696c  urce was re-buil
-0001ee00: 742c 0a20 2020 2020 2020 2020 2020 2074  t,.            t
-0001ee10: 6869 7320 7769 6c6c 206d 616b 6520 7468  his will make th
-0001ee20: 6520 7365 7276 6572 2067 6574 2074 6865  e server get the
-0001ee30: 2075 7064 6174 6564 2069 6e66 6f72 6d61   updated informa
-0001ee40: 7469 6f6e 2e20 4465 6661 756c 7420 6973  tion. Default is
-0001ee50: 2060 6046 616c 7365 6060 2e0a 2020 2020   ``False``..    
-0001ee60: 2020 2020 3a72 6574 7572 6e73 3a20 3a70      :returns: :p
-0001ee70: 793a 636c 6173 733a 607e 6d6c 7275 6e2e  y:class:`~mlrun.
-0001ee80: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e68  common.schemas.h
-0001ee90: 7562 2e48 7562 4361 7461 6c6f 6760 206f  ub.HubCatalog` o
-0001eea0: 626a 6563 742c 2077 6869 6368 2069 7320  bject, which is 
-0001eeb0: 6573 7365 6e74 6961 6c6c 7920 6120 6c69  essentially a li
-0001eec0: 7374 0a20 2020 2020 2020 2020 2020 206f  st.            o
-0001eed0: 6620 3a70 793a 636c 6173 733a 607e 6d6c  f :py:class:`~ml
-0001eee0: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
-0001eef0: 6173 2e68 7562 2e48 7562 4974 656d 6020  as.hub.HubItem` 
-0001ef00: 656e 7472 6965 732e 0a20 2020 2020 2020  entries..       
-0001ef10: 2022 2222 0a20 2020 2020 2020 2070 6174   """.        pat
-0001ef20: 6820 3d20 2866 2268 7562 2f73 6f75 7263  h = (f"hub/sourc
-0001ef30: 6573 2f7b 736f 7572 6365 5f6e 616d 657d  es/{source_name}
-0001ef40: 2f69 7465 6d73 222c 290a 2020 2020 2020  /items",).      
-0001ef50: 2020 7061 7261 6d73 203d 207b 0a20 2020    params = {.   
-0001ef60: 2020 2020 2020 2020 2022 7665 7273 696f           "versio
-0001ef70: 6e22 3a20 7665 7273 696f 6e2c 0a20 2020  n": version,.   
-0001ef80: 2020 2020 2020 2020 2022 7461 6722 3a20           "tag": 
-0001ef90: 7461 672c 0a20 2020 2020 2020 2020 2020  tag,.           
-0001efa0: 2022 666f 7263 652d 7265 6672 6573 6822   "force-refresh"
-0001efb0: 3a20 666f 7263 655f 7265 6672 6573 682c  : force_refresh,
-0001efc0: 0a20 2020 2020 2020 207d 0a20 2020 2020  .        }.     
-0001efd0: 2020 2072 6573 706f 6e73 6520 3d20 7365     response = se
-0001efe0: 6c66 2e61 7069 5f63 616c 6c28 6d65 7468  lf.api_call(meth
-0001eff0: 6f64 3d22 4745 5422 2c20 7061 7468 3d70  od="GET", path=p
-0001f000: 6174 682c 2070 6172 616d 733d 7061 7261  ath, params=para
-0001f010: 6d73 290a 2020 2020 2020 2020 7265 7475  ms).        retu
-0001f020: 726e 206d 6c72 756e 2e63 6f6d 6d6f 6e2e  rn mlrun.common.
-0001f030: 7363 6865 6d61 732e 4875 6243 6174 616c  schemas.HubCatal
-0001f040: 6f67 282a 2a72 6573 706f 6e73 652e 6a73  og(**response.js
-0001f050: 6f6e 2829 290a 0a20 2020 2064 6566 2067  on())..    def g
-0001f060: 6574 5f68 7562 5f69 7465 6d28 0a20 2020  et_hub_item(.   
-0001f070: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-0001f080: 2020 2073 6f75 7263 655f 6e61 6d65 3a20     source_name: 
-0001f090: 7374 722c 0a20 2020 2020 2020 2069 7465  str,.        ite
-0001f0a0: 6d5f 6e61 6d65 3a20 7374 722c 0a20 2020  m_name: str,.   
-0001f0b0: 2020 2020 2076 6572 7369 6f6e 3a20 7374       version: st
-0001f0c0: 7220 3d20 4e6f 6e65 2c0a 2020 2020 2020  r = None,.      
-0001f0d0: 2020 7461 673a 2073 7472 203d 2022 6c61    tag: str = "la
-0001f0e0: 7465 7374 222c 0a20 2020 2020 2020 2066  test",.        f
-0001f0f0: 6f72 6365 5f72 6566 7265 7368 3a20 626f  orce_refresh: bo
-0001f100: 6f6c 203d 2046 616c 7365 2c0a 2020 2020  ol = False,.    
-0001f110: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
-0001f120: 2020 2020 2020 2052 6574 7269 6576 6520         Retrieve 
-0001f130: 6120 7370 6563 6966 6963 2068 7562 2069  a specific hub i
-0001f140: 7465 6d2e 0a0a 2020 2020 2020 2020 3a70  tem...        :p
-0001f150: 6172 616d 2073 6f75 7263 655f 6e61 6d65  aram source_name
-0001f160: 3a20 4e61 6d65 206f 6620 736f 7572 6365  : Name of source
-0001f170: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-0001f180: 2069 7465 6d5f 6e61 6d65 3a20 4e61 6d65   item_name: Name
-0001f190: 206f 6620 7468 6520 6974 656d 2074 6f20   of the item to 
-0001f1a0: 7265 7472 6965 7665 2c20 6173 2069 7420  retrieve, as it 
-0001f1b0: 6170 7065 6172 7320 696e 2074 6865 2063  appears in the c
-0001f1c0: 6174 616c 6f67 2e0a 2020 2020 2020 2020  atalog..        
-0001f1d0: 3a70 6172 616d 2076 6572 7369 6f6e 3a20  :param version: 
-0001f1e0: 4765 7420 6120 7370 6563 6966 6963 2076  Get a specific v
-0001f1f0: 6572 7369 6f6e 206f 6620 7468 6520 6974  ersion of the it
-0001f200: 656d 2e20 4465 6661 756c 7420 6973 2060  em. Default is `
-0001f210: 604e 6f6e 6560 602e 0a20 2020 2020 2020  `None``..       
-0001f220: 203a 7061 7261 6d20 7461 673a 2047 6574   :param tag: Get
-0001f230: 2061 2073 7065 6369 6669 6320 7665 7273   a specific vers
-0001f240: 696f 6e20 6f66 2074 6865 2069 7465 6d20  ion of the item 
-0001f250: 6964 656e 7469 6669 6564 2062 7920 7461  identified by ta
-0001f260: 672e 2044 6566 6175 6c74 2069 7320 6060  g. Default is ``
-0001f270: 6c61 7465 7374 6060 2e0a 2020 2020 2020  latest``..      
-0001f280: 2020 3a70 6172 616d 2066 6f72 6365 5f72    :param force_r
-0001f290: 6566 7265 7368 3a20 4d61 6b65 2074 6865  efresh: Make the
-0001f2a0: 2073 6572 7665 7220 6665 7463 6820 7468   server fetch th
-0001f2b0: 6520 696e 666f 726d 6174 696f 6e20 6672  e information fr
-0001f2c0: 6f6d 2074 6865 2061 6374 7561 6c20 6875  om the actual hu
-0001f2d0: 620a 2020 2020 2020 2020 2020 2020 736f  b.            so
-0001f2e0: 7572 6365 2c20 7261 7468 6572 2074 6861  urce, rather tha
-0001f2f0: 6e0a 2020 2020 2020 2020 2020 2020 7265  n.            re
-0001f300: 6c79 206f 6e20 6361 6368 6564 2069 6e66  ly on cached inf
-0001f310: 6f72 6d61 7469 6f6e 2e20 4465 6661 756c  ormation. Defaul
-0001f320: 7420 6973 2060 6046 616c 7365 6060 2e0a  t is ``False``..
-0001f330: 2020 2020 2020 2020 3a72 6574 7572 6e73          :returns
-0001f340: 3a20 3a70 793a 636c 6173 733a 607e 6d6c  : :py:class:`~ml
-0001f350: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
-0001f360: 6173 2e68 7562 2e48 7562 4974 656d 602e  as.hub.HubItem`.
-0001f370: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0001f380: 2020 2020 2070 6174 6820 3d20 2866 2268       path = (f"h
-0001f390: 7562 2f73 6f75 7263 6573 2f7b 736f 7572  ub/sources/{sour
-0001f3a0: 6365 5f6e 616d 657d 2f69 7465 6d73 2f7b  ce_name}/items/{
-0001f3b0: 6974 656d 5f6e 616d 657d 222c 290a 2020  item_name}",).  
-0001f3c0: 2020 2020 2020 7061 7261 6d73 203d 207b        params = {
-0001f3d0: 0a20 2020 2020 2020 2020 2020 2022 7665  .            "ve
-0001f3e0: 7273 696f 6e22 3a20 7665 7273 696f 6e2c  rsion": version,
-0001f3f0: 0a20 2020 2020 2020 2020 2020 2022 7461  .            "ta
-0001f400: 6722 3a20 7461 672c 0a20 2020 2020 2020  g": tag,.       
-0001f410: 2020 2020 2022 666f 7263 652d 7265 6672       "force-refr
-0001f420: 6573 6822 3a20 666f 7263 655f 7265 6672  esh": force_refr
-0001f430: 6573 682c 0a20 2020 2020 2020 207d 0a20  esh,.        }. 
-0001f440: 2020 2020 2020 2072 6573 706f 6e73 6520         response 
-0001f450: 3d20 7365 6c66 2e61 7069 5f63 616c 6c28  = self.api_call(
-0001f460: 6d65 7468 6f64 3d22 4745 5422 2c20 7061  method="GET", pa
-0001f470: 7468 3d70 6174 682c 2070 6172 616d 733d  th=path, params=
-0001f480: 7061 7261 6d73 290a 2020 2020 2020 2020  params).        
-0001f490: 7265 7475 726e 206d 6c72 756e 2e63 6f6d  return mlrun.com
-0001f4a0: 6d6f 6e2e 7363 6865 6d61 732e 4875 6249  mon.schemas.HubI
-0001f4b0: 7465 6d28 2a2a 7265 7370 6f6e 7365 2e6a  tem(**response.j
-0001f4c0: 736f 6e28 2929 0a0a 2020 2020 6465 6620  son())..    def 
-0001f4d0: 6765 745f 6875 625f 6173 7365 7428 0a20  get_hub_asset(. 
-0001f4e0: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-0001f4f0: 2020 2020 2073 6f75 7263 655f 6e61 6d65       source_name
-0001f500: 3a20 7374 722c 0a20 2020 2020 2020 2069  : str,.        i
-0001f510: 7465 6d5f 6e61 6d65 3a20 7374 722c 0a20  tem_name: str,. 
-0001f520: 2020 2020 2020 2061 7373 6574 5f6e 616d         asset_nam
-0001f530: 653a 2073 7472 2c0a 2020 2020 2020 2020  e: str,.        
-0001f540: 7665 7273 696f 6e3a 2073 7472 203d 204e  version: str = N
-0001f550: 6f6e 652c 0a20 2020 2020 2020 2074 6167  one,.        tag
-0001f560: 3a20 7374 7220 3d20 226c 6174 6573 7422  : str = "latest"
-0001f570: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
-0001f580: 2022 2222 0a20 2020 2020 2020 2047 6574   """.        Get
-0001f590: 2068 7562 2061 7373 6574 2066 726f 6d20   hub asset from 
-0001f5a0: 6974 656d 2e0a 0a20 2020 2020 2020 203a  item...        :
-0001f5b0: 7061 7261 6d20 736f 7572 6365 5f6e 616d  param source_nam
-0001f5c0: 653a 204e 616d 6520 6f66 2073 6f75 7263  e: Name of sourc
-0001f5d0: 652e 0a20 2020 2020 2020 203a 7061 7261  e..        :para
-0001f5e0: 6d20 6974 656d 5f6e 616d 653a 2020 204e  m item_name:   N
-0001f5f0: 616d 6520 6f66 2074 6865 2069 7465 6d20  ame of the item 
-0001f600: 7768 6963 6820 686f 6c64 7320 7468 6520  which holds the 
-0001f610: 6173 7365 742e 0a20 2020 2020 2020 203a  asset..        :
-0001f620: 7061 7261 6d20 6173 7365 745f 6e61 6d65  param asset_name
-0001f630: 3a20 204e 616d 6520 6f66 2074 6865 2061  :  Name of the a
-0001f640: 7373 6574 2074 6f20 7265 7472 6965 7665  sset to retrieve
-0001f650: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-0001f660: 2076 6572 7369 6f6e 3a20 4765 7420 6120   version: Get a 
-0001f670: 7370 6563 6966 6963 2076 6572 7369 6f6e  specific version
-0001f680: 206f 6620 7468 6520 6974 656d 2e20 4465   of the item. De
-0001f690: 6661 756c 7420 6973 2060 604e 6f6e 6560  fault is ``None`
-0001f6a0: 602e 0a20 2020 2020 2020 203a 7061 7261  `..        :para
-0001f6b0: 6d20 7461 673a 2047 6574 2061 2073 7065  m tag: Get a spe
-0001f6c0: 6369 6669 6320 7665 7273 696f 6e20 6f66  cific version of
-0001f6d0: 2074 6865 2069 7465 6d20 6964 656e 7469   the item identi
-0001f6e0: 6669 6564 2062 7920 7461 672e 2044 6566  fied by tag. Def
-0001f6f0: 6175 6c74 2069 7320 6060 6c61 7465 7374  ault is ``latest
-0001f700: 6060 2e0a 0a20 2020 2020 2020 203a 7265  ``...        :re
-0001f710: 7475 726e 3a20 6874 7470 2072 6573 706f  turn: http respo
-0001f720: 6e73 6520 7769 7468 2074 6865 2061 7373  nse with the ass
-0001f730: 6574 2069 6e20 7468 6520 636f 6e74 656e  et in the conten
-0001f740: 7420 6174 7472 6962 7574 650a 2020 2020  t attribute.    
-0001f750: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0001f760: 7061 7468 203d 2028 6622 6875 622f 736f  path = (f"hub/so
-0001f770: 7572 6365 732f 7b73 6f75 7263 655f 6e61  urces/{source_na
-0001f780: 6d65 7d2f 6974 656d 732f 7b69 7465 6d5f  me}/items/{item_
-0001f790: 6e61 6d65 7d2f 6173 7365 7473 2f7b 6173  name}/assets/{as
-0001f7a0: 7365 745f 6e61 6d65 7d22 2c29 0a20 2020  set_name}",).   
-0001f7b0: 2020 2020 2070 6172 616d 7320 3d20 7b0a       params = {.
-0001f7c0: 2020 2020 2020 2020 2020 2020 2276 6572              "ver
-0001f7d0: 7369 6f6e 223a 2076 6572 7369 6f6e 2c0a  sion": version,.
-0001f7e0: 2020 2020 2020 2020 2020 2020 2274 6167              "tag
-0001f7f0: 223a 2074 6167 2c0a 2020 2020 2020 2020  ": tag,.        
-0001f800: 7d0a 2020 2020 2020 2020 7265 7370 6f6e  }.        respon
-0001f810: 7365 203d 2073 656c 662e 6170 695f 6361  se = self.api_ca
-0001f820: 6c6c 286d 6574 686f 643d 2247 4554 222c  ll(method="GET",
-0001f830: 2070 6174 683d 7061 7468 2c20 7061 7261   path=path, para
-0001f840: 6d73 3d70 6172 616d 7329 0a20 2020 2020  ms=params).     
-0001f850: 2020 2072 6574 7572 6e20 7265 7370 6f6e     return respon
-0001f860: 7365 0a0a 2020 2020 6465 6620 7665 7269  se..    def veri
-0001f870: 6679 5f61 7574 686f 7269 7a61 7469 6f6e  fy_authorization
-0001f880: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-0001f890: 2020 2020 2020 2020 6175 7468 6f72 697a          authoriz
-0001f8a0: 6174 696f 6e5f 7665 7269 6669 6361 7469  ation_verificati
-0001f8b0: 6f6e 5f69 6e70 7574 3a20 6d6c 7275 6e2e  on_input: mlrun.
-0001f8c0: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e41  common.schemas.A
-0001f8d0: 7574 686f 7269 7a61 7469 6f6e 5665 7269  uthorizationVeri
-0001f8e0: 6669 6361 7469 6f6e 496e 7075 742c 0a20  ficationInput,. 
-0001f8f0: 2020 2029 3a0a 2020 2020 2020 2020 2222     ):.        ""
-0001f900: 2256 6572 6966 6965 7320 6175 7468 6f72  "Verifies author
-0001f910: 697a 6174 696f 6e20 666f 7220 7468 6520  ization for the 
-0001f920: 7072 6f76 6964 6564 2061 6374 696f 6e20  provided action 
-0001f930: 6f6e 2074 6865 2070 726f 7669 6465 6420  on the provided 
-0001f940: 7265 736f 7572 6365 2e0a 0a20 2020 2020  resource...     
-0001f950: 2020 203a 7061 7261 6d20 6175 7468 6f72     :param author
-0001f960: 697a 6174 696f 6e5f 7665 7269 6669 6361  ization_verifica
-0001f970: 7469 6f6e 5f69 6e70 7574 3a20 496e 7374  tion_input: Inst
-0001f980: 616e 6365 206f 660a 2020 2020 2020 2020  ance of.        
-0001f990: 2020 2020 3a70 793a 636c 6173 733a 607e      :py:class:`~
-0001f9a0: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
-0001f9b0: 656d 6173 2e41 7574 686f 7269 7a61 7469  emas.Authorizati
-0001f9c0: 6f6e 5665 7269 6669 6361 7469 6f6e 496e  onVerificationIn
-0001f9d0: 7075 7460 2074 6861 7420 696e 636c 7564  put` that includ
-0001f9e0: 6573 2061 6c6c 2074 6865 206e 6565 6465  es all the neede
-0001f9f0: 6420 7061 7261 6d65 7465 7273 2066 6f72  d parameters for
-0001fa00: 0a20 2020 2020 2020 2020 2020 2074 6865  .            the
-0001fa10: 2061 7574 6820 7665 7269 6669 6361 7469   auth verificati
-0001fa20: 6f6e 0a20 2020 2020 2020 2022 2222 0a20  on.        """. 
-0001fa30: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
-0001fa40: 7361 6765 203d 2022 4175 7468 6f72 697a  sage = "Authoriz
-0001fa50: 6174 696f 6e20 6368 6563 6b20 6661 696c  ation check fail
-0001fa60: 6564 220a 2020 2020 2020 2020 7365 6c66  ed".        self
-0001fa70: 2e61 7069 5f63 616c 6c28 0a20 2020 2020  .api_call(.     
-0001fa80: 2020 2020 2020 2022 504f 5354 222c 0a20         "POST",. 
-0001fa90: 2020 2020 2020 2020 2020 2022 6175 7468             "auth
-0001faa0: 6f72 697a 6174 696f 6e2f 7665 7269 6669  orization/verifi
-0001fab0: 6361 7469 6f6e 7322 2c0a 2020 2020 2020  cations",.      
-0001fac0: 2020 2020 2020 6572 726f 725f 6d65 7373        error_mess
-0001fad0: 6167 652c 0a20 2020 2020 2020 2020 2020  age,.           
-0001fae0: 2062 6f64 793d 6469 6374 5f74 6f5f 6a73   body=dict_to_js
-0001faf0: 6f6e 2861 7574 686f 7269 7a61 7469 6f6e  on(authorization
-0001fb00: 5f76 6572 6966 6963 6174 696f 6e5f 696e  _verification_in
-0001fb10: 7075 742e 6469 6374 2829 292c 0a20 2020  put.dict()),.   
-0001fb20: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
-0001fb30: 7472 6967 6765 725f 6d69 6772 6174 696f  trigger_migratio
-0001fb40: 6e73 2873 656c 6629 202d 3e20 4f70 7469  ns(self) -> Opti
-0001fb50: 6f6e 616c 5b6d 6c72 756e 2e63 6f6d 6d6f  onal[mlrun.commo
-0001fb60: 6e2e 7363 6865 6d61 732e 4261 636b 6772  n.schemas.Backgr
-0001fb70: 6f75 6e64 5461 736b 5d3a 0a20 2020 2020  oundTask]:.     
-0001fb80: 2020 2022 2222 5472 6967 6765 7220 6d69     """Trigger mi
-0001fb90: 6772 6174 696f 6e73 2028 7769 6c6c 2064  grations (will d
-0001fba0: 6f20 6e6f 7468 696e 6720 6966 206e 6f20  o nothing if no 
-0001fbb0: 6d69 6772 6174 696f 6e73 2061 7265 206e  migrations are n
-0001fbc0: 6565 6465 6429 2061 6e64 2077 6169 7420  eeded) and wait 
-0001fbd0: 666f 7220 7468 656d 2074 6f20 6669 6e69  for them to fini
-0001fbe0: 7368 2069 6620 6163 7475 616c 6c79 0a20  sh if actually. 
-0001fbf0: 2020 2020 2020 2074 7269 6767 6572 6564         triggered
-0001fc00: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
-0001fc10: 733a 203a 7079 3a63 6c61 7373 3a60 7e6d  s: :py:class:`~m
-0001fc20: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
-0001fc30: 6d61 732e 4261 636b 6772 6f75 6e64 5461  mas.BackgroundTa
-0001fc40: 736b 602e 0a20 2020 2020 2020 2022 2222  sk`..        """
-0001fc50: 0a20 2020 2020 2020 2072 6573 706f 6e73  .        respons
-0001fc60: 6520 3d20 7365 6c66 2e61 7069 5f63 616c  e = self.api_cal
-0001fc70: 6c28 0a20 2020 2020 2020 2020 2020 2022  l(.            "
-0001fc80: 504f 5354 222c 0a20 2020 2020 2020 2020  POST",.         
-0001fc90: 2020 2022 6f70 6572 6174 696f 6e73 2f6d     "operations/m
-0001fca0: 6967 7261 7469 6f6e 7322 2c0a 2020 2020  igrations",.    
-0001fcb0: 2020 2020 2020 2020 2246 6169 6c65 6420          "Failed 
-0001fcc0: 7472 6967 6765 7269 6e67 206d 6967 7261  triggering migra
-0001fcd0: 7469 6f6e 7322 2c0a 2020 2020 2020 2020  tions",.        
-0001fce0: 290a 2020 2020 2020 2020 6966 2072 6573  ).        if res
-0001fcf0: 706f 6e73 652e 7374 6174 7573 5f63 6f64  ponse.status_cod
-0001fd00: 6520 3d3d 2068 7474 702e 4854 5450 5374  e == http.HTTPSt
-0001fd10: 6174 7573 2e41 4343 4550 5445 443a 0a20  atus.ACCEPTED:. 
-0001fd20: 2020 2020 2020 2020 2020 2062 6163 6b67             backg
-0001fd30: 726f 756e 645f 7461 736b 203d 206d 6c72  round_task = mlr
-0001fd40: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
-0001fd50: 732e 4261 636b 6772 6f75 6e64 5461 736b  s.BackgroundTask
-0001fd60: 282a 2a72 6573 706f 6e73 652e 6a73 6f6e  (**response.json
-0001fd70: 2829 290a 2020 2020 2020 2020 2020 2020  ()).            
-0001fd80: 7265 7475 726e 2073 656c 662e 5f77 6169  return self._wai
-0001fd90: 745f 666f 725f 6261 636b 6772 6f75 6e64  t_for_background
-0001fda0: 5f74 6173 6b5f 746f 5f72 6561 6368 5f74  _task_to_reach_t
-0001fdb0: 6572 6d69 6e61 6c5f 7374 6174 6528 0a20  erminal_state(. 
-0001fdc0: 2020 2020 2020 2020 2020 2020 2020 2062                 b
-0001fdd0: 6163 6b67 726f 756e 645f 7461 736b 2e6d  ackground_task.m
-0001fde0: 6574 6164 6174 612e 6e61 6d65 0a20 2020  etadata.name.   
-0001fdf0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-0001fe00: 2020 2072 6574 7572 6e20 4e6f 6e65 0a0a     return None..
-0001fe10: 0a64 6566 205f 6173 5f6a 736f 6e28 6f62  .def _as_json(ob
-0001fe20: 6a29 3a0a 2020 2020 666e 203d 2067 6574  j):.    fn = get
-0001fe30: 6174 7472 286f 626a 2c20 2274 6f5f 6a73  attr(obj, "to_js
-0001fe40: 6f6e 222c 204e 6f6e 6529 0a20 2020 2069  on", None).    i
-0001fe50: 6620 666e 3a0a 2020 2020 2020 2020 7265  f fn:.        re
-0001fe60: 7475 726e 2066 6e28 290a 2020 2020 7265  turn fn().    re
-0001fe70: 7475 726e 2064 6963 745f 746f 5f6a 736f  turn dict_to_jso
-0001fe80: 6e28 6f62 6a29 0a                        n(obj).
+0001d550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d570: 2766 3227 3a20 7b27 7476 6427 3a20 302e  'f2': {'tvd': 0.
+0001d580: 352c 2027 6865 6c6c 696e 6765 7227 3a20  5, 'hellinger': 
+0001d590: 312e 302c 2027 6b6c 6427 3a20 362e 357d  1.0, 'kld': 6.5}
+0001d5a0: 7d0a 0a20 2020 2020 2020 2020 2020 2020  }..             
+0001d5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d5c0: 2020 2023 2043 7265 6174 6520 6174 7472     # Create attr
+0001d5d0: 6962 7574 6573 2064 6963 7469 6f6e 6172  ibutes dictionar
+0001d5e0: 7920 6163 636f 7264 696e 6720 746f 2074  y according to t
+0001d5f0: 6865 2072 6571 7569 7265 6420 666f 726d  he required form
+0001d600: 6174 0a20 2020 2020 2020 2020 2020 2020  at.             
+0001d610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d620: 2020 2061 7474 7269 6275 7465 7320 3d20     attributes = 
+0001d630: 7b60 6375 7272 656e 745f 7374 6174 7360  {`current_stats`
+0001d640: 3a20 6a73 6f6e 2e64 756d 7073 2863 7572  : json.dumps(cur
+0001d650: 7265 6e74 5f73 7461 7473 292c 0a20 2020  rent_stats),.   
+0001d660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d680: 2020 2020 2020 2020 2020 2060 6472 6966             `drif
+0001d690: 745f 7374 6174 7573 603a 2022 4452 4946  t_status`: "DRIF
+0001d6a0: 545f 4445 5445 4354 4544 227d 0a0a 2020  T_DETECTED"}..  
+0001d6b0: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
+0001d6c0: 2020 2061 7474 7269 6275 7465 7320 3d20     attributes = 
+0001d6d0: 7b22 6174 7472 6962 7574 6573 223a 205f  {"attributes": _
+0001d6e0: 6173 5f6a 736f 6e28 6174 7472 6962 7574  as_json(attribut
+0001d6f0: 6573 297d 0a20 2020 2020 2020 2070 6174  es)}.        pat
+0001d700: 6820 3d20 6622 7072 6f6a 6563 7473 2f7b  h = f"projects/{
+0001d710: 7072 6f6a 6563 747d 2f6d 6f64 656c 2d65  project}/model-e
+0001d720: 6e64 706f 696e 7473 2f7b 656e 6470 6f69  ndpoints/{endpoi
+0001d730: 6e74 5f69 647d 220a 2020 2020 2020 2020  nt_id}".        
+0001d740: 7365 6c66 2e61 7069 5f63 616c 6c28 0a20  self.api_call(. 
+0001d750: 2020 2020 2020 2020 2020 206d 6574 686f             metho
+0001d760: 643d 2250 4154 4348 222c 0a20 2020 2020  d="PATCH",.     
+0001d770: 2020 2020 2020 2070 6174 683d 7061 7468         path=path
+0001d780: 2c0a 2020 2020 2020 2020 2020 2020 7061  ,.            pa
+0001d790: 7261 6d73 3d61 7474 7269 6275 7465 732c  rams=attributes,
+0001d7a0: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+0001d7b0: 6465 6620 6372 6561 7465 5f68 7562 5f73  def create_hub_s
+0001d7c0: 6f75 7263 6528 0a20 2020 2020 2020 2073  ource(.        s
+0001d7d0: 656c 662c 2073 6f75 7263 653a 2055 6e69  elf, source: Uni
+0001d7e0: 6f6e 5b64 6963 742c 206d 6c72 756e 2e63  on[dict, mlrun.c
+0001d7f0: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 496e  ommon.schemas.In
+0001d800: 6465 7865 6448 7562 536f 7572 6365 5d0a  dexedHubSource].
+0001d810: 2020 2020 293a 0a20 2020 2020 2020 2022      ):.        "
+0001d820: 2222 0a20 2020 2020 2020 2041 6464 2061  "".        Add a
+0001d830: 206e 6577 2068 7562 2073 6f75 7263 652e   new hub source.
+0001d840: 0a0a 2020 2020 2020 2020 4d4c 5275 6e20  ..        MLRun 
+0001d850: 6d61 696e 7461 696e 7320 616e 206f 7264  maintains an ord
+0001d860: 6572 6564 206c 6973 7420 6f66 2068 7562  ered list of hub
+0001d870: 2073 6f75 7263 6573 2028 e280 9c73 6f75   sources (...sou
+0001d880: 7263 6573 e280 9d29 2045 6163 6820 736f  rces...) Each so
+0001d890: 7572 6365 2068 6173 0a20 2020 2020 2020  urce has.       
+0001d8a0: 2069 7473 2064 6574 6169 6c73 2072 6567   its details reg
+0001d8b0: 6973 7465 7265 6420 616e 6420 6974 7320  istered and its 
+0001d8c0: 6f72 6465 7220 7769 7468 696e 2074 6865  order within the
+0001d8d0: 206c 6973 742e 2057 6865 6e20 6372 6561   list. When crea
+0001d8e0: 7469 6e67 2061 206e 6577 2073 6f75 7263  ting a new sourc
+0001d8f0: 652c 2074 6865 2073 7065 6369 616c 206f  e, the special o
+0001d900: 7264 6572 2060 602d 3160 600a 2020 2020  rder ``-1``.    
+0001d910: 2020 2020 6361 6e20 6265 2075 7365 6420      can be used 
+0001d920: 746f 206d 6172 6b20 7468 6973 2073 6f75  to mark this sou
+0001d930: 7263 6520 6173 206c 6173 7420 696e 2074  rce as last in t
+0001d940: 6865 206c 6973 742e 2048 6f77 6576 6572  he list. However
+0001d950: 2c20 6f6e 6365 2074 6865 2073 6f75 7263  , once the sourc
+0001d960: 6520 6973 2069 6e20 7468 6520 4d4c 5275  e is in the MLRu
+0001d970: 6e20 6c69 7374 2c0a 2020 2020 2020 2020  n list,.        
+0001d980: 6974 7320 6f72 6465 7220 7769 6c6c 2061  its order will a
+0001d990: 6c77 6179 7320 6265 2060 603e 3060 602e  lways be ``>0``.
+0001d9a0: 0a0a 2020 2020 2020 2020 5468 6520 676c  ..        The gl
+0001d9b0: 6f62 616c 2068 7562 2073 6f75 7263 6520  obal hub source 
+0001d9c0: 616c 7761 7973 2065 7869 7374 7320 696e  always exists in
+0001d9d0: 2074 6865 206c 6973 742c 2061 6e64 2069   the list, and i
+0001d9e0: 7320 616c 7761 7973 2074 6865 206c 6173  s always the las
+0001d9f0: 7420 736f 7572 6365 0a20 2020 2020 2020  t source.       
+0001da00: 2028 6060 6f72 6465 7220 3d20 2d31 6060   (``order = -1``
+0001da10: 292e 2049 7420 6361 6e6e 6f74 2062 6520  ). It cannot be 
+0001da20: 6d6f 6469 6669 6564 206e 6f72 2063 616e  modified nor can
+0001da30: 2069 7420 6265 206d 6f76 6564 2074 6f20   it be moved to 
+0001da40: 616e 6f74 6865 7220 6f72 6465 7220 696e  another order in
+0001da50: 2074 6865 206c 6973 742e 0a0a 2020 2020   the list...    
+0001da60: 2020 2020 5468 6520 736f 7572 6365 206f      The source o
+0001da70: 626a 6563 7420 6d61 7920 636f 6e74 6169  bject may contai
+0001da80: 6e20 6372 6564 656e 7469 616c 7320 7768  n credentials wh
+0001da90: 6963 6820 6172 6520 6e65 6564 6564 2074  ich are needed t
+0001daa0: 6f20 6163 6365 7373 2074 6865 2064 6174  o access the dat
+0001dab0: 6173 746f 7265 2077 6865 7265 2074 6865  astore where the
+0001dac0: 2073 6f75 7263 6520 6973 2073 746f 7265   source is store
+0001dad0: 642e 0a20 2020 2020 2020 2054 6865 7365  d..        These
+0001dae0: 2063 7265 6465 6e74 6961 6c73 2061 7265   credentials are
+0001daf0: 206e 6f74 206b 6570 7420 696e 2074 6865   not kept in the
+0001db00: 204d 4c52 756e 2044 422c 2062 7574 2061   MLRun DB, but a
+0001db10: 7265 2073 746f 7265 6420 696e 7369 6465  re stored inside
+0001db20: 2061 206b 7562 6572 6e65 7465 7320 7365   a kubernetes se
+0001db30: 6372 6574 206f 626a 6563 7420 6d61 696e  cret object main
+0001db40: 7461 696e 6564 2062 790a 2020 2020 2020  tained by.      
+0001db50: 2020 4d4c 5275 6e2e 2054 6865 7920 6172    MLRun. They ar
+0001db60: 6520 6e6f 7420 7265 7475 726e 6564 2074  e not returned t
+0001db70: 6872 6f75 6768 2061 6e79 2041 5049 2066  hrough any API f
+0001db80: 726f 6d20 4d4c 5275 6e2e 0a0a 2020 2020  rom MLRun...    
+0001db90: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
+0001dba0: 2020 2020 2020 2020 2020 2069 6d70 6f72             impor
+0001dbb0: 7420 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  t mlrun.common.s
+0001dbc0: 6368 656d 6173 0a0a 2020 2020 2020 2020  chemas..        
+0001dbd0: 2020 2020 2320 4164 6420 6120 7072 6976      # Add a priv
+0001dbe0: 6174 6520 736f 7572 6365 2061 7320 7468  ate source as th
+0001dbf0: 6520 6c61 7374 206f 6e65 2028 7769 6c6c  e last one (will
+0001dc00: 2062 6520 2331 2069 6e20 7468 6520 6c69   be #1 in the li
+0001dc10: 7374 290a 2020 2020 2020 2020 2020 2020  st).            
+0001dc20: 7072 6976 6174 655f 736f 7572 6365 203d  private_source =
+0001dc30: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
+0001dc40: 6865 6d61 732e 496e 6465 7865 6448 7562  hemas.IndexedHub
+0001dc50: 6553 6f75 7263 6528 0a20 2020 2020 2020  eSource(.       
+0001dc60: 2020 2020 2020 2020 206f 7264 6572 3d2d           order=-
+0001dc70: 312c 0a20 2020 2020 2020 2020 2020 2020  1,.             
+0001dc80: 2020 2073 6f75 7263 653d 6d6c 7275 6e2e     source=mlrun.
+0001dc90: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e48  common.schemas.H
+0001dca0: 7562 536f 7572 6365 280a 2020 2020 2020  ubSource(.      
+0001dcb0: 2020 2020 2020 2020 2020 2020 2020 6d65                me
+0001dcc0: 7461 6461 7461 3d6d 6c72 756e 2e63 6f6d  tadata=mlrun.com
+0001dcd0: 6d6f 6e2e 7363 6865 6d61 732e 4875 624f  mon.schemas.HubO
+0001dce0: 626a 6563 744d 6574 6164 6174 6128 0a20  bjectMetadata(. 
+0001dcf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001dd00: 2020 2020 2020 206e 616d 653d 2270 7269         name="pri
+0001dd10: 7622 2c20 6465 7363 7269 7074 696f 6e3d  v", description=
+0001dd20: 2261 2070 7269 7661 7465 2073 6f75 7263  "a private sourc
+0001dd30: 6522 0a20 2020 2020 2020 2020 2020 2020  e".             
+0001dd40: 2020 2020 2020 2029 2c0a 2020 2020 2020         ),.      
+0001dd50: 2020 2020 2020 2020 2020 2020 2020 7370                sp
+0001dd60: 6563 3d6d 6c72 756e 2e63 6f6d 6d6f 6e2e  ec=mlrun.common.
+0001dd70: 7363 6865 6d61 732e 4875 6253 6f75 7263  schemas.HubSourc
+0001dd80: 6553 7065 6328 7061 7468 3d22 2f6c 6f63  eSpec(path="/loc
+0001dd90: 616c 2f70 6174 682f 746f 2f73 6f75 7263  al/path/to/sourc
+0001dda0: 6522 2c20 6368 616e 6e65 6c3d 2264 6576  e", channel="dev
+0001ddb0: 656c 6f70 6d65 6e74 2229 0a20 2020 2020  elopment").     
+0001ddc0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+0001ddd0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+0001dde0: 2020 2020 2020 2064 622e 6372 6561 7465         db.create
+0001ddf0: 5f68 7562 5f73 6f75 7263 6528 7072 6976  _hub_source(priv
+0001de00: 6174 655f 736f 7572 6365 290a 0a20 2020  ate_source)..   
+0001de10: 2020 2020 2020 2020 2023 2041 6464 2061           # Add a
+0001de20: 6e6f 7468 6572 2073 6f75 7263 6520 6173  nother source as
+0001de30: 2031 7374 2069 6e20 7468 6520 6c69 7374   1st in the list
+0001de40: 202d 2077 696c 6c20 7075 7368 2070 7265   - will push pre
+0001de50: 7669 6f75 7320 6f6e 6520 746f 2062 6520  vious one to be 
+0001de60: 2332 0a20 2020 2020 2020 2020 2020 2061  #2.            a
+0001de70: 6e6f 7468 6572 5f73 6f75 7263 6520 3d20  nother_source = 
+0001de80: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
+0001de90: 656d 6173 2e49 6e64 6578 6564 4875 6253  emas.IndexedHubS
+0001dea0: 6f75 7263 6528 0a20 2020 2020 2020 2020  ource(.         
+0001deb0: 2020 2020 2020 206f 7264 6572 3d31 2c0a         order=1,.
+0001dec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ded0: 736f 7572 6365 3d6d 6c72 756e 2e63 6f6d  source=mlrun.com
+0001dee0: 6d6f 6e2e 7363 6865 6d61 732e 4875 6253  mon.schemas.HubS
+0001def0: 6f75 7263 6528 0a20 2020 2020 2020 2020  ource(.         
+0001df00: 2020 2020 2020 2020 2020 206d 6574 6164             metad
+0001df10: 6174 613d 6d6c 7275 6e2e 636f 6d6d 6f6e  ata=mlrun.common
+0001df20: 2e73 6368 656d 6173 2e48 7562 4f62 6a65  .schemas.HubObje
+0001df30: 6374 4d65 7461 6461 7461 280a 2020 2020  ctMetadata(.    
+0001df40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001df50: 2020 2020 6e61 6d65 3d22 7072 6976 2d32      name="priv-2
+0001df60: 222c 2064 6573 6372 6970 7469 6f6e 3d22  ", description="
+0001df70: 616e 6f74 6865 7220 736f 7572 6365 220a  another source".
+0001df80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001df90: 2020 2020 292c 0a20 2020 2020 2020 2020      ),.         
+0001dfa0: 2020 2020 2020 2020 2020 2073 7065 633d             spec=
+0001dfb0: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
+0001dfc0: 656d 6173 2e48 7562 536f 7572 6365 5370  emas.HubSourceSp
+0001dfd0: 6563 280a 2020 2020 2020 2020 2020 2020  ec(.            
+0001dfe0: 2020 2020 2020 2020 2020 2020 7061 7468              path
+0001dff0: 3d22 2f6c 6f63 616c 2f70 6174 682f 746f  ="/local/path/to
+0001e000: 2f73 6f75 7263 652f 3222 2c0a 2020 2020  /source/2",.    
+0001e010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e020: 2020 2020 6368 616e 6e65 6c3d 2264 6576      channel="dev
+0001e030: 656c 6f70 6d65 6e74 222c 0a20 2020 2020  elopment",.     
+0001e040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e050: 2020 2063 7265 6465 6e74 6961 6c73 3d7b     credentials={
+0001e060: 2e2e 2e7d 0a20 2020 2020 2020 2020 2020  ...}.           
+0001e070: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+0001e080: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+0001e090: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+0001e0a0: 2020 2020 2020 2064 622e 6372 6561 7465         db.create
+0001e0b0: 5f68 7562 5f73 6f75 7263 6528 616e 6f74  _hub_source(anot
+0001e0c0: 6865 725f 736f 7572 6365 290a 0a20 2020  her_source)..   
+0001e0d0: 2020 2020 203a 7061 7261 6d20 736f 7572       :param sour
+0001e0e0: 6365 3a20 5468 6520 736f 7572 6365 2061  ce: The source a
+0001e0f0: 6e64 2069 7473 206f 7264 6572 2c20 6f66  nd its order, of
+0001e100: 2074 7970 650a 2020 2020 2020 2020 2020   type.          
+0001e110: 2020 3a70 793a 636c 6173 733a 607e 6d6c    :py:class:`~ml
+0001e120: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
+0001e130: 6173 2e68 7562 2e49 6e64 6578 6564 4875  as.hub.IndexedHu
+0001e140: 6253 6f75 7263 6560 2c20 6f72 2069 6e20  bSource`, or in 
+0001e150: 6469 6374 696f 6e61 7279 2066 6f72 6d2e  dictionary form.
+0001e160: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
+0001e170: 733a 2054 6865 2073 6f75 7263 6520 6f62  s: The source ob
+0001e180: 6a65 6374 2061 7320 696e 7365 7274 6564  ject as inserted
+0001e190: 2069 6e74 6f20 7468 6520 6461 7461 6261   into the databa
+0001e1a0: 7365 2c20 7769 7468 2063 7265 6465 6e74  se, with credent
+0001e1b0: 6961 6c73 2073 7472 6970 7065 642e 0a20  ials stripped.. 
+0001e1c0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0001e1d0: 2020 2070 6174 6820 3d20 2268 7562 2f73     path = "hub/s
+0001e1e0: 6f75 7263 6573 220a 2020 2020 2020 2020  ources".        
+0001e1f0: 6966 2069 7369 6e73 7461 6e63 6528 736f  if isinstance(so
+0001e200: 7572 6365 2c20 6d6c 7275 6e2e 636f 6d6d  urce, mlrun.comm
+0001e210: 6f6e 2e73 6368 656d 6173 2e49 6e64 6578  on.schemas.Index
+0001e220: 6564 4875 6253 6f75 7263 6529 3a0a 2020  edHubSource):.  
+0001e230: 2020 2020 2020 2020 2020 736f 7572 6365            source
+0001e240: 203d 2073 6f75 7263 652e 6469 6374 2829   = source.dict()
+0001e250: 0a20 2020 2020 2020 2072 6573 706f 6e73  .        respons
+0001e260: 6520 3d20 7365 6c66 2e61 7069 5f63 616c  e = self.api_cal
+0001e270: 6c28 6d65 7468 6f64 3d22 504f 5354 222c  l(method="POST",
+0001e280: 2070 6174 683d 7061 7468 2c20 6a73 6f6e   path=path, json
+0001e290: 3d73 6f75 7263 6529 0a20 2020 2020 2020  =source).       
+0001e2a0: 2072 6574 7572 6e20 6d6c 7275 6e2e 636f   return mlrun.co
+0001e2b0: 6d6d 6f6e 2e73 6368 656d 6173 2e49 6e64  mmon.schemas.Ind
+0001e2c0: 6578 6564 4875 6253 6f75 7263 6528 2a2a  exedHubSource(**
+0001e2d0: 7265 7370 6f6e 7365 2e6a 736f 6e28 2929  response.json())
+0001e2e0: 0a0a 2020 2020 6465 6620 7374 6f72 655f  ..    def store_
+0001e2f0: 6875 625f 736f 7572 6365 280a 2020 2020  hub_source(.    
+0001e300: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+0001e310: 2020 736f 7572 6365 5f6e 616d 653a 2073    source_name: s
+0001e320: 7472 2c0a 2020 2020 2020 2020 736f 7572  tr,.        sour
+0001e330: 6365 3a20 556e 696f 6e5b 6469 6374 2c20  ce: Union[dict, 
+0001e340: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
+0001e350: 656d 6173 2e49 6e64 6578 6564 4875 6253  emas.IndexedHubS
+0001e360: 6f75 7263 655d 2c0a 2020 2020 293a 0a20  ource],.    ):. 
+0001e370: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0001e380: 2020 2043 7265 6174 6520 6f72 2072 6570     Create or rep
+0001e390: 6c61 6365 2061 2068 7562 2073 6f75 7263  lace a hub sourc
+0001e3a0: 652e 0a20 2020 2020 2020 2046 6f72 2061  e..        For a
+0001e3b0: 6e20 6578 616d 706c 6520 6f66 2074 6865  n example of the
+0001e3c0: 2073 6f75 7263 6520 666f 726d 6174 2061   source format a
+0001e3d0: 6e64 2065 7870 6c61 6e61 7469 6f6e 206f  nd explanation o
+0001e3e0: 6620 7468 6520 736f 7572 6365 206f 7264  f the source ord
+0001e3f0: 6572 206c 6f67 6963 2c0a 2020 2020 2020  er logic,.      
+0001e400: 2020 706c 6561 7365 2073 6565 203a 7079    please see :py
+0001e410: 3a66 756e 633a 607e 6372 6561 7465 5f68  :func:`~create_h
+0001e420: 7562 5f73 6f75 7263 6560 2e20 5468 6973  ub_source`. This
+0001e430: 206d 6574 686f 6420 6361 6e20 6265 2075   method can be u
+0001e440: 7365 6420 746f 206d 6f64 6966 7920 7468  sed to modify th
+0001e450: 6520 736f 7572 6365 2069 7473 656c 6620  e source itself 
+0001e460: 6f72 2069 7473 0a20 2020 2020 2020 206f  or its.        o
+0001e470: 7264 6572 2069 6e20 7468 6520 6c69 7374  rder in the list
+0001e480: 206f 6620 736f 7572 6365 732e 0a0a 2020   of sources...  
+0001e490: 2020 2020 2020 3a70 6172 616d 2073 6f75        :param sou
+0001e4a0: 7263 655f 6e61 6d65 3a20 4e61 6d65 206f  rce_name: Name o
+0001e4b0: 6620 7468 6520 736f 7572 6365 206f 626a  f the source obj
+0001e4c0: 6563 7420 746f 206d 6f64 6966 792f 6372  ect to modify/cr
+0001e4d0: 6561 7465 2e20 4974 206d 7573 7420 6d61  eate. It must ma
+0001e4e0: 7463 6820 7468 6520 6060 736f 7572 6365  tch the ``source
+0001e4f0: 2e6d 6574 6164 6174 612e 6e61 6d65 6060  .metadata.name``
+0001e500: 0a20 2020 2020 2020 2020 2020 2070 6172  .            par
+0001e510: 616d 6574 6572 2069 6e20 7468 6520 736f  ameter in the so
+0001e520: 7572 6365 2069 7473 656c 662e 0a20 2020  urce itself..   
+0001e530: 2020 2020 203a 7061 7261 6d20 736f 7572       :param sour
+0001e540: 6365 3a20 536f 7572 6365 206f 626a 6563  ce: Source objec
+0001e550: 7420 746f 2073 746f 7265 2069 6e20 7468  t to store in th
+0001e560: 6520 6461 7461 6261 7365 2e0a 2020 2020  e database..    
+0001e570: 2020 2020 3a72 6574 7572 6e73 3a20 5468      :returns: Th
+0001e580: 6520 736f 7572 6365 206f 626a 6563 7420  e source object 
+0001e590: 6173 2073 746f 7265 6420 696e 2074 6865  as stored in the
+0001e5a0: 2044 422e 0a20 2020 2020 2020 2022 2222   DB..        """
+0001e5b0: 0a20 2020 2020 2020 2070 6174 6820 3d20  .        path = 
+0001e5c0: 6622 6875 622f 736f 7572 6365 732f 7b73  f"hub/sources/{s
+0001e5d0: 6f75 7263 655f 6e61 6d65 7d22 0a20 2020  ource_name}".   
+0001e5e0: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+0001e5f0: 6365 2873 6f75 7263 652c 206d 6c72 756e  ce(source, mlrun
+0001e600: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
+0001e610: 496e 6465 7865 6448 7562 536f 7572 6365  IndexedHubSource
+0001e620: 293a 0a20 2020 2020 2020 2020 2020 2073  ):.            s
+0001e630: 6f75 7263 6520 3d20 736f 7572 6365 2e64  ource = source.d
+0001e640: 6963 7428 290a 0a20 2020 2020 2020 2072  ict()..        r
+0001e650: 6573 706f 6e73 6520 3d20 7365 6c66 2e61  esponse = self.a
+0001e660: 7069 5f63 616c 6c28 6d65 7468 6f64 3d22  pi_call(method="
+0001e670: 5055 5422 2c20 7061 7468 3d70 6174 682c  PUT", path=path,
+0001e680: 206a 736f 6e3d 736f 7572 6365 290a 2020   json=source).  
+0001e690: 2020 2020 2020 7265 7475 726e 206d 6c72        return mlr
+0001e6a0: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
+0001e6b0: 732e 496e 6465 7865 6448 7562 536f 7572  s.IndexedHubSour
+0001e6c0: 6365 282a 2a72 6573 706f 6e73 652e 6a73  ce(**response.js
+0001e6d0: 6f6e 2829 290a 0a20 2020 2064 6566 206c  on())..    def l
+0001e6e0: 6973 745f 6875 625f 736f 7572 6365 7328  ist_hub_sources(
+0001e6f0: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
+0001e700: 2222 0a20 2020 2020 2020 204c 6973 7420  "".        List 
+0001e710: 6875 6220 736f 7572 6365 7320 696e 2074  hub sources in t
+0001e720: 6865 204d 4c52 756e 2044 422e 0a20 2020  he MLRun DB..   
+0001e730: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0001e740: 2070 6174 6820 3d20 2268 7562 2f73 6f75   path = "hub/sou
+0001e750: 7263 6573 220a 2020 2020 2020 2020 7265  rces".        re
+0001e760: 7370 6f6e 7365 203d 2073 656c 662e 6170  sponse = self.ap
+0001e770: 695f 6361 6c6c 286d 6574 686f 643d 2247  i_call(method="G
+0001e780: 4554 222c 2070 6174 683d 7061 7468 292e  ET", path=path).
+0001e790: 6a73 6f6e 2829 0a20 2020 2020 2020 2072  json().        r
+0001e7a0: 6573 756c 7473 203d 205b 5d0a 2020 2020  esults = [].    
+0001e7b0: 2020 2020 666f 7220 6974 656d 2069 6e20      for item in 
+0001e7c0: 7265 7370 6f6e 7365 3a0a 2020 2020 2020  response:.      
+0001e7d0: 2020 2020 2020 7265 7375 6c74 732e 6170        results.ap
+0001e7e0: 7065 6e64 286d 6c72 756e 2e63 6f6d 6d6f  pend(mlrun.commo
+0001e7f0: 6e2e 7363 6865 6d61 732e 496e 6465 7865  n.schemas.Indexe
+0001e800: 6448 7562 536f 7572 6365 282a 2a69 7465  dHubSource(**ite
+0001e810: 6d29 290a 2020 2020 2020 2020 7265 7475  m)).        retu
+0001e820: 726e 2072 6573 756c 7473 0a0a 2020 2020  rn results..    
+0001e830: 6465 6620 6765 745f 6875 625f 736f 7572  def get_hub_sour
+0001e840: 6365 2873 656c 662c 2073 6f75 7263 655f  ce(self, source_
+0001e850: 6e61 6d65 3a20 7374 7229 3a0a 2020 2020  name: str):.    
+0001e860: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0001e870: 5265 7472 6965 7665 2061 2068 7562 2073  Retrieve a hub s
+0001e880: 6f75 7263 6520 6672 6f6d 2074 6865 2044  ource from the D
+0001e890: 422e 0a0a 2020 2020 2020 2020 3a70 6172  B...        :par
+0001e8a0: 616d 2073 6f75 7263 655f 6e61 6d65 3a20  am source_name: 
+0001e8b0: 4e61 6d65 206f 6620 7468 6520 6875 6220  Name of the hub 
+0001e8c0: 736f 7572 6365 2074 6f20 7265 7472 6965  source to retrie
+0001e8d0: 7665 2e0a 2020 2020 2020 2020 2222 220a  ve..        """.
+0001e8e0: 2020 2020 2020 2020 7061 7468 203d 2066          path = f
+0001e8f0: 2268 7562 2f73 6f75 7263 6573 2f7b 736f  "hub/sources/{so
+0001e900: 7572 6365 5f6e 616d 657d 220a 2020 2020  urce_name}".    
+0001e910: 2020 2020 7265 7370 6f6e 7365 203d 2073      response = s
+0001e920: 656c 662e 6170 695f 6361 6c6c 286d 6574  elf.api_call(met
+0001e930: 686f 643d 2247 4554 222c 2070 6174 683d  hod="GET", path=
+0001e940: 7061 7468 290a 2020 2020 2020 2020 7265  path).        re
+0001e950: 7475 726e 206d 6c72 756e 2e63 6f6d 6d6f  turn mlrun.commo
+0001e960: 6e2e 7363 6865 6d61 732e 496e 6465 7865  n.schemas.Indexe
+0001e970: 6448 7562 536f 7572 6365 282a 2a72 6573  dHubSource(**res
+0001e980: 706f 6e73 652e 6a73 6f6e 2829 290a 0a20  ponse.json()).. 
+0001e990: 2020 2064 6566 2064 656c 6574 655f 6875     def delete_hu
+0001e9a0: 625f 736f 7572 6365 2873 656c 662c 2073  b_source(self, s
+0001e9b0: 6f75 7263 655f 6e61 6d65 3a20 7374 7229  ource_name: str)
+0001e9c0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+0001e9d0: 2020 2020 2020 4465 6c65 7465 2061 2068        Delete a h
+0001e9e0: 7562 2073 6f75 7263 6520 6672 6f6d 2074  ub source from t
+0001e9f0: 6865 2044 422e 0a20 2020 2020 2020 2054  he DB..        T
+0001ea00: 6865 2073 6f75 7263 6520 7769 6c6c 2062  he source will b
+0001ea10: 6520 6465 6c65 7465 6420 6672 6f6d 2074  e deleted from t
+0001ea20: 6865 206c 6973 742c 2061 6e64 2061 6e79  he list, and any
+0001ea30: 2066 6f6c 6c6f 7769 6e67 2073 6f75 7263   following sourc
+0001ea40: 6573 2077 696c 6c20 6265 2070 726f 6d6f  es will be promo
+0001ea50: 7465 6420 2d20 666f 7220 6578 616d 706c  ted - for exampl
+0001ea60: 652c 2069 6620 7468 650a 2020 2020 2020  e, if the.      
+0001ea70: 2020 3173 7420 736f 7572 6365 2069 7320    1st source is 
+0001ea80: 6465 6c65 7465 642c 2074 6865 2032 6e64  deleted, the 2nd
+0001ea90: 2073 6f75 7263 6520 7769 6c6c 2062 6563   source will bec
+0001eaa0: 6f6d 6520 2331 2069 6e20 7468 6520 6c69  ome #1 in the li
+0001eab0: 7374 2e0a 2020 2020 2020 2020 5468 6520  st..        The 
+0001eac0: 676c 6f62 616c 2068 7562 2073 6f75 7263  global hub sourc
+0001ead0: 6520 6361 6e6e 6f74 2062 6520 6465 6c65  e cannot be dele
+0001eae0: 7465 642e 0a0a 2020 2020 2020 2020 3a70  ted...        :p
+0001eaf0: 6172 616d 2073 6f75 7263 655f 6e61 6d65  aram source_name
+0001eb00: 3a20 4e61 6d65 206f 6620 7468 6520 6875  : Name of the hu
+0001eb10: 6220 736f 7572 6365 2074 6f20 6465 6c65  b source to dele
+0001eb20: 7465 2e0a 2020 2020 2020 2020 2222 220a  te..        """.
+0001eb30: 2020 2020 2020 2020 7061 7468 203d 2066          path = f
+0001eb40: 2268 7562 2f73 6f75 7263 6573 2f7b 736f  "hub/sources/{so
+0001eb50: 7572 6365 5f6e 616d 657d 220a 2020 2020  urce_name}".    
+0001eb60: 2020 2020 7365 6c66 2e61 7069 5f63 616c      self.api_cal
+0001eb70: 6c28 6d65 7468 6f64 3d22 4445 4c45 5445  l(method="DELETE
+0001eb80: 222c 2070 6174 683d 7061 7468 290a 0a20  ", path=path).. 
+0001eb90: 2020 2064 6566 2067 6574 5f68 7562 5f63     def get_hub_c
+0001eba0: 6174 616c 6f67 280a 2020 2020 2020 2020  atalog(.        
+0001ebb0: 7365 6c66 2c0a 2020 2020 2020 2020 736f  self,.        so
+0001ebc0: 7572 6365 5f6e 616d 653a 2073 7472 2c0a  urce_name: str,.
+0001ebd0: 2020 2020 2020 2020 7665 7273 696f 6e3a          version:
+0001ebe0: 2073 7472 203d 204e 6f6e 652c 0a20 2020   str = None,.   
+0001ebf0: 2020 2020 2074 6167 3a20 7374 7220 3d20       tag: str = 
+0001ec00: 4e6f 6e65 2c0a 2020 2020 2020 2020 666f  None,.        fo
+0001ec10: 7263 655f 7265 6672 6573 683a 2062 6f6f  rce_refresh: boo
+0001ec20: 6c20 3d20 4661 6c73 652c 0a20 2020 2029  l = False,.    )
+0001ec30: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+0001ec40: 2020 2020 2020 5265 7472 6965 7665 2074        Retrieve t
+0001ec50: 6865 2069 7465 6d20 6361 7461 6c6f 6720  he item catalog 
+0001ec60: 666f 7220 6120 7370 6563 6966 6965 6420  for a specified 
+0001ec70: 6875 6220 736f 7572 6365 2e0a 2020 2020  hub source..    
+0001ec80: 2020 2020 5468 6520 6c69 7374 206f 6620      The list of 
+0001ec90: 6974 656d 7320 6361 6e20 6265 2066 696c  items can be fil
+0001eca0: 7465 7265 6420 6163 636f 7264 696e 6720  tered according 
+0001ecb0: 746f 2076 6172 696f 7573 2066 696c 7465  to various filte
+0001ecc0: 7273 2c20 7573 696e 6720 6974 656d 2773  rs, using item's
+0001ecd0: 206d 6574 6164 6174 6120 746f 2066 696c   metadata to fil
+0001ece0: 7465 722e 0a0a 2020 2020 2020 2020 3a70  ter...        :p
+0001ecf0: 6172 616d 2073 6f75 7263 655f 6e61 6d65  aram source_name
+0001ed00: 3a20 4e61 6d65 206f 6620 7468 6520 736f  : Name of the so
+0001ed10: 7572 6365 2e0a 2020 2020 2020 2020 3a70  urce..        :p
+0001ed20: 6172 616d 2076 6572 7369 6f6e 3a20 4669  aram version: Fi
+0001ed30: 6c74 6572 2069 7465 6d73 2061 6363 6f72  lter items accor
+0001ed40: 6469 6e67 2074 6f20 7468 6569 7220 7665  ding to their ve
+0001ed50: 7273 696f 6e2e 0a20 2020 2020 2020 203a  rsion..        :
+0001ed60: 7061 7261 6d20 7461 673a 2046 696c 7465  param tag: Filte
+0001ed70: 7220 6974 656d 7320 6261 7365 6420 6f6e  r items based on
+0001ed80: 2074 6167 2e0a 2020 2020 2020 2020 3a70   tag..        :p
+0001ed90: 6172 616d 2066 6f72 6365 5f72 6566 7265  aram force_refre
+0001eda0: 7368 3a20 4d61 6b65 2074 6865 2073 6572  sh: Make the ser
+0001edb0: 7665 7220 6665 7463 6820 7468 6520 6361  ver fetch the ca
+0001edc0: 7461 6c6f 6720 6672 6f6d 2074 6865 2061  talog from the a
+0001edd0: 6374 7561 6c20 6875 6220 736f 7572 6365  ctual hub source
+0001ede0: 2c0a 2020 2020 2020 2020 2020 2020 7261  ,.            ra
+0001edf0: 7468 6572 2074 6861 6e20 7265 6c79 206f  ther than rely o
+0001ee00: 6e20 6361 6368 6564 2069 6e66 6f72 6d61  n cached informa
+0001ee10: 7469 6f6e 2077 6869 6368 206d 6179 2065  tion which may e
+0001ee20: 7869 7374 2066 726f 6d20 7072 6576 696f  xist from previo
+0001ee30: 7573 2067 6574 2072 6571 7565 7374 732e  us get requests.
+0001ee40: 2046 6f72 2065 7861 6d70 6c65 2c0a 2020   For example,.  
+0001ee50: 2020 2020 2020 2020 2020 6966 2074 6865            if the
+0001ee60: 2073 6f75 7263 6520 7761 7320 7265 2d62   source was re-b
+0001ee70: 7569 6c74 2c0a 2020 2020 2020 2020 2020  uilt,.          
+0001ee80: 2020 7468 6973 2077 696c 6c20 6d61 6b65    this will make
+0001ee90: 2074 6865 2073 6572 7665 7220 6765 7420   the server get 
+0001eea0: 7468 6520 7570 6461 7465 6420 696e 666f  the updated info
+0001eeb0: 726d 6174 696f 6e2e 2044 6566 6175 6c74  rmation. Default
+0001eec0: 2069 7320 6060 4661 6c73 6560 602e 0a20   is ``False``.. 
+0001eed0: 2020 2020 2020 203a 7265 7475 726e 733a         :returns:
+0001eee0: 203a 7079 3a63 6c61 7373 3a60 7e6d 6c72   :py:class:`~mlr
+0001eef0: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
+0001ef00: 732e 6875 622e 4875 6243 6174 616c 6f67  s.hub.HubCatalog
+0001ef10: 6020 6f62 6a65 6374 2c20 7768 6963 6820  ` object, which 
+0001ef20: 6973 2065 7373 656e 7469 616c 6c79 2061  is essentially a
+0001ef30: 206c 6973 740a 2020 2020 2020 2020 2020   list.          
+0001ef40: 2020 6f66 203a 7079 3a63 6c61 7373 3a60    of :py:class:`
+0001ef50: 7e6d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363  ~mlrun.common.sc
+0001ef60: 6865 6d61 732e 6875 622e 4875 6249 7465  hemas.hub.HubIte
+0001ef70: 6d60 2065 6e74 7269 6573 2e0a 2020 2020  m` entries..    
+0001ef80: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0001ef90: 7061 7468 203d 2028 6622 6875 622f 736f  path = (f"hub/so
+0001efa0: 7572 6365 732f 7b73 6f75 7263 655f 6e61  urces/{source_na
+0001efb0: 6d65 7d2f 6974 656d 7322 2c29 0a20 2020  me}/items",).   
+0001efc0: 2020 2020 2070 6172 616d 7320 3d20 7b0a       params = {.
+0001efd0: 2020 2020 2020 2020 2020 2020 2276 6572              "ver
+0001efe0: 7369 6f6e 223a 2076 6572 7369 6f6e 2c0a  sion": version,.
+0001eff0: 2020 2020 2020 2020 2020 2020 2274 6167              "tag
+0001f000: 223a 2074 6167 2c0a 2020 2020 2020 2020  ": tag,.        
+0001f010: 2020 2020 2266 6f72 6365 2d72 6566 7265      "force-refre
+0001f020: 7368 223a 2066 6f72 6365 5f72 6566 7265  sh": force_refre
+0001f030: 7368 2c0a 2020 2020 2020 2020 7d0a 2020  sh,.        }.  
+0001f040: 2020 2020 2020 7265 7370 6f6e 7365 203d        response =
+0001f050: 2073 656c 662e 6170 695f 6361 6c6c 286d   self.api_call(m
+0001f060: 6574 686f 643d 2247 4554 222c 2070 6174  ethod="GET", pat
+0001f070: 683d 7061 7468 2c20 7061 7261 6d73 3d70  h=path, params=p
+0001f080: 6172 616d 7329 0a20 2020 2020 2020 2072  arams).        r
+0001f090: 6574 7572 6e20 6d6c 7275 6e2e 636f 6d6d  eturn mlrun.comm
+0001f0a0: 6f6e 2e73 6368 656d 6173 2e48 7562 4361  on.schemas.HubCa
+0001f0b0: 7461 6c6f 6728 2a2a 7265 7370 6f6e 7365  talog(**response
+0001f0c0: 2e6a 736f 6e28 2929 0a0a 2020 2020 6465  .json())..    de
+0001f0d0: 6620 6765 745f 6875 625f 6974 656d 280a  f get_hub_item(.
+0001f0e0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+0001f0f0: 2020 2020 2020 736f 7572 6365 5f6e 616d        source_nam
+0001f100: 653a 2073 7472 2c0a 2020 2020 2020 2020  e: str,.        
+0001f110: 6974 656d 5f6e 616d 653a 2073 7472 2c0a  item_name: str,.
+0001f120: 2020 2020 2020 2020 7665 7273 696f 6e3a          version:
+0001f130: 2073 7472 203d 204e 6f6e 652c 0a20 2020   str = None,.   
+0001f140: 2020 2020 2074 6167 3a20 7374 7220 3d20       tag: str = 
+0001f150: 226c 6174 6573 7422 2c0a 2020 2020 2020  "latest",.      
+0001f160: 2020 666f 7263 655f 7265 6672 6573 683a    force_refresh:
+0001f170: 2062 6f6f 6c20 3d20 4661 6c73 652c 0a20   bool = False,. 
+0001f180: 2020 2029 3a0a 2020 2020 2020 2020 2222     ):.        ""
+0001f190: 220a 2020 2020 2020 2020 5265 7472 6965  ".        Retrie
+0001f1a0: 7665 2061 2073 7065 6369 6669 6320 6875  ve a specific hu
+0001f1b0: 6220 6974 656d 2e0a 0a20 2020 2020 2020  b item...       
+0001f1c0: 203a 7061 7261 6d20 736f 7572 6365 5f6e   :param source_n
+0001f1d0: 616d 653a 204e 616d 6520 6f66 2073 6f75  ame: Name of sou
+0001f1e0: 7263 652e 0a20 2020 2020 2020 203a 7061  rce..        :pa
+0001f1f0: 7261 6d20 6974 656d 5f6e 616d 653a 204e  ram item_name: N
+0001f200: 616d 6520 6f66 2074 6865 2069 7465 6d20  ame of the item 
+0001f210: 746f 2072 6574 7269 6576 652c 2061 7320  to retrieve, as 
+0001f220: 6974 2061 7070 6561 7273 2069 6e20 7468  it appears in th
+0001f230: 6520 6361 7461 6c6f 672e 0a20 2020 2020  e catalog..     
+0001f240: 2020 203a 7061 7261 6d20 7665 7273 696f     :param versio
+0001f250: 6e3a 2047 6574 2061 2073 7065 6369 6669  n: Get a specifi
+0001f260: 6320 7665 7273 696f 6e20 6f66 2074 6865  c version of the
+0001f270: 2069 7465 6d2e 2044 6566 6175 6c74 2069   item. Default i
+0001f280: 7320 6060 4e6f 6e65 6060 2e0a 2020 2020  s ``None``..    
+0001f290: 2020 2020 3a70 6172 616d 2074 6167 3a20      :param tag: 
+0001f2a0: 4765 7420 6120 7370 6563 6966 6963 2076  Get a specific v
+0001f2b0: 6572 7369 6f6e 206f 6620 7468 6520 6974  ersion of the it
+0001f2c0: 656d 2069 6465 6e74 6966 6965 6420 6279  em identified by
+0001f2d0: 2074 6167 2e20 4465 6661 756c 7420 6973   tag. Default is
+0001f2e0: 2060 606c 6174 6573 7460 602e 0a20 2020   ``latest``..   
+0001f2f0: 2020 2020 203a 7061 7261 6d20 666f 7263       :param forc
+0001f300: 655f 7265 6672 6573 683a 204d 616b 6520  e_refresh: Make 
+0001f310: 7468 6520 7365 7276 6572 2066 6574 6368  the server fetch
+0001f320: 2074 6865 2069 6e66 6f72 6d61 7469 6f6e   the information
+0001f330: 2066 726f 6d20 7468 6520 6163 7475 616c   from the actual
+0001f340: 2068 7562 0a20 2020 2020 2020 2020 2020   hub.           
+0001f350: 2073 6f75 7263 652c 2072 6174 6865 7220   source, rather 
+0001f360: 7468 616e 0a20 2020 2020 2020 2020 2020  than.           
+0001f370: 2072 656c 7920 6f6e 2063 6163 6865 6420   rely on cached 
+0001f380: 696e 666f 726d 6174 696f 6e2e 2044 6566  information. Def
+0001f390: 6175 6c74 2069 7320 6060 4661 6c73 6560  ault is ``False`
+0001f3a0: 602e 0a20 2020 2020 2020 203a 7265 7475  `..        :retu
+0001f3b0: 726e 733a 203a 7079 3a63 6c61 7373 3a60  rns: :py:class:`
+0001f3c0: 7e6d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363  ~mlrun.common.sc
+0001f3d0: 6865 6d61 732e 6875 622e 4875 6249 7465  hemas.hub.HubIte
+0001f3e0: 6d60 2e0a 2020 2020 2020 2020 2222 220a  m`..        """.
+0001f3f0: 2020 2020 2020 2020 7061 7468 203d 2028          path = (
+0001f400: 6622 6875 622f 736f 7572 6365 732f 7b73  f"hub/sources/{s
+0001f410: 6f75 7263 655f 6e61 6d65 7d2f 6974 656d  ource_name}/item
+0001f420: 732f 7b69 7465 6d5f 6e61 6d65 7d22 2c29  s/{item_name}",)
+0001f430: 0a20 2020 2020 2020 2070 6172 616d 7320  .        params 
+0001f440: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
+0001f450: 2276 6572 7369 6f6e 223a 2076 6572 7369  "version": versi
+0001f460: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
+0001f470: 2274 6167 223a 2074 6167 2c0a 2020 2020  "tag": tag,.    
+0001f480: 2020 2020 2020 2020 2266 6f72 6365 2d72          "force-r
+0001f490: 6566 7265 7368 223a 2066 6f72 6365 5f72  efresh": force_r
+0001f4a0: 6566 7265 7368 2c0a 2020 2020 2020 2020  efresh,.        
+0001f4b0: 7d0a 2020 2020 2020 2020 7265 7370 6f6e  }.        respon
+0001f4c0: 7365 203d 2073 656c 662e 6170 695f 6361  se = self.api_ca
+0001f4d0: 6c6c 286d 6574 686f 643d 2247 4554 222c  ll(method="GET",
+0001f4e0: 2070 6174 683d 7061 7468 2c20 7061 7261   path=path, para
+0001f4f0: 6d73 3d70 6172 616d 7329 0a20 2020 2020  ms=params).     
+0001f500: 2020 2072 6574 7572 6e20 6d6c 7275 6e2e     return mlrun.
+0001f510: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e48  common.schemas.H
+0001f520: 7562 4974 656d 282a 2a72 6573 706f 6e73  ubItem(**respons
+0001f530: 652e 6a73 6f6e 2829 290a 0a20 2020 2064  e.json())..    d
+0001f540: 6566 2067 6574 5f68 7562 5f61 7373 6574  ef get_hub_asset
+0001f550: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+0001f560: 2020 2020 2020 2020 736f 7572 6365 5f6e          source_n
+0001f570: 616d 653a 2073 7472 2c0a 2020 2020 2020  ame: str,.      
+0001f580: 2020 6974 656d 5f6e 616d 653a 2073 7472    item_name: str
+0001f590: 2c0a 2020 2020 2020 2020 6173 7365 745f  ,.        asset_
+0001f5a0: 6e61 6d65 3a20 7374 722c 0a20 2020 2020  name: str,.     
+0001f5b0: 2020 2076 6572 7369 6f6e 3a20 7374 7220     version: str 
+0001f5c0: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
+0001f5d0: 7461 673a 2073 7472 203d 2022 6c61 7465  tag: str = "late
+0001f5e0: 7374 222c 0a20 2020 2029 3a0a 2020 2020  st",.    ):.    
+0001f5f0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0001f600: 4765 7420 6875 6220 6173 7365 7420 6672  Get hub asset fr
+0001f610: 6f6d 2069 7465 6d2e 0a0a 2020 2020 2020  om item...      
+0001f620: 2020 3a70 6172 616d 2073 6f75 7263 655f    :param source_
+0001f630: 6e61 6d65 3a20 4e61 6d65 206f 6620 736f  name: Name of so
+0001f640: 7572 6365 2e0a 2020 2020 2020 2020 3a70  urce..        :p
+0001f650: 6172 616d 2069 7465 6d5f 6e61 6d65 3a20  aram item_name: 
+0001f660: 2020 4e61 6d65 206f 6620 7468 6520 6974    Name of the it
+0001f670: 656d 2077 6869 6368 2068 6f6c 6473 2074  em which holds t
+0001f680: 6865 2061 7373 6574 2e0a 2020 2020 2020  he asset..      
+0001f690: 2020 3a70 6172 616d 2061 7373 6574 5f6e    :param asset_n
+0001f6a0: 616d 653a 2020 4e61 6d65 206f 6620 7468  ame:  Name of th
+0001f6b0: 6520 6173 7365 7420 746f 2072 6574 7269  e asset to retri
+0001f6c0: 6576 652e 0a20 2020 2020 2020 203a 7061  eve..        :pa
+0001f6d0: 7261 6d20 7665 7273 696f 6e3a 2047 6574  ram version: Get
+0001f6e0: 2061 2073 7065 6369 6669 6320 7665 7273   a specific vers
+0001f6f0: 696f 6e20 6f66 2074 6865 2069 7465 6d2e  ion of the item.
+0001f700: 2044 6566 6175 6c74 2069 7320 6060 4e6f   Default is ``No
+0001f710: 6e65 6060 2e0a 2020 2020 2020 2020 3a70  ne``..        :p
+0001f720: 6172 616d 2074 6167 3a20 4765 7420 6120  aram tag: Get a 
+0001f730: 7370 6563 6966 6963 2076 6572 7369 6f6e  specific version
+0001f740: 206f 6620 7468 6520 6974 656d 2069 6465   of the item ide
+0001f750: 6e74 6966 6965 6420 6279 2074 6167 2e20  ntified by tag. 
+0001f760: 4465 6661 756c 7420 6973 2060 606c 6174  Default is ``lat
+0001f770: 6573 7460 602e 0a0a 2020 2020 2020 2020  est``...        
+0001f780: 3a72 6574 7572 6e3a 2068 7474 7020 7265  :return: http re
+0001f790: 7370 6f6e 7365 2077 6974 6820 7468 6520  sponse with the 
+0001f7a0: 6173 7365 7420 696e 2074 6865 2063 6f6e  asset in the con
+0001f7b0: 7465 6e74 2061 7474 7269 6275 7465 0a20  tent attribute. 
+0001f7c0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0001f7d0: 2020 2070 6174 6820 3d20 2866 2268 7562     path = (f"hub
+0001f7e0: 2f73 6f75 7263 6573 2f7b 736f 7572 6365  /sources/{source
+0001f7f0: 5f6e 616d 657d 2f69 7465 6d73 2f7b 6974  _name}/items/{it
+0001f800: 656d 5f6e 616d 657d 2f61 7373 6574 732f  em_name}/assets/
+0001f810: 7b61 7373 6574 5f6e 616d 657d 222c 290a  {asset_name}",).
+0001f820: 2020 2020 2020 2020 7061 7261 6d73 203d          params =
+0001f830: 207b 0a20 2020 2020 2020 2020 2020 2022   {.            "
+0001f840: 7665 7273 696f 6e22 3a20 7665 7273 696f  version": versio
+0001f850: 6e2c 0a20 2020 2020 2020 2020 2020 2022  n,.            "
+0001f860: 7461 6722 3a20 7461 672c 0a20 2020 2020  tag": tag,.     
+0001f870: 2020 207d 0a20 2020 2020 2020 2072 6573     }.        res
+0001f880: 706f 6e73 6520 3d20 7365 6c66 2e61 7069  ponse = self.api
+0001f890: 5f63 616c 6c28 6d65 7468 6f64 3d22 4745  _call(method="GE
+0001f8a0: 5422 2c20 7061 7468 3d70 6174 682c 2070  T", path=path, p
+0001f8b0: 6172 616d 733d 7061 7261 6d73 290a 2020  arams=params).  
+0001f8c0: 2020 2020 2020 7265 7475 726e 2072 6573        return res
+0001f8d0: 706f 6e73 650a 0a20 2020 2064 6566 2076  ponse..    def v
+0001f8e0: 6572 6966 795f 6175 7468 6f72 697a 6174  erify_authorizat
+0001f8f0: 696f 6e28 0a20 2020 2020 2020 2073 656c  ion(.        sel
+0001f900: 662c 0a20 2020 2020 2020 2061 7574 686f  f,.        autho
+0001f910: 7269 7a61 7469 6f6e 5f76 6572 6966 6963  rization_verific
+0001f920: 6174 696f 6e5f 696e 7075 743a 206d 6c72  ation_input: mlr
+0001f930: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
+0001f940: 732e 4175 7468 6f72 697a 6174 696f 6e56  s.AuthorizationV
+0001f950: 6572 6966 6963 6174 696f 6e49 6e70 7574  erificationInput
+0001f960: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
+0001f970: 2022 2222 5665 7269 6669 6573 2061 7574   """Verifies aut
+0001f980: 686f 7269 7a61 7469 6f6e 2066 6f72 2074  horization for t
+0001f990: 6865 2070 726f 7669 6465 6420 6163 7469  he provided acti
+0001f9a0: 6f6e 206f 6e20 7468 6520 7072 6f76 6964  on on the provid
+0001f9b0: 6564 2072 6573 6f75 7263 652e 0a0a 2020  ed resource...  
+0001f9c0: 2020 2020 2020 3a70 6172 616d 2061 7574        :param aut
+0001f9d0: 686f 7269 7a61 7469 6f6e 5f76 6572 6966  horization_verif
+0001f9e0: 6963 6174 696f 6e5f 696e 7075 743a 2049  ication_input: I
+0001f9f0: 6e73 7461 6e63 6520 6f66 0a20 2020 2020  nstance of.     
+0001fa00: 2020 2020 2020 203a 7079 3a63 6c61 7373         :py:class
+0001fa10: 3a60 7e6d 6c72 756e 2e63 6f6d 6d6f 6e2e  :`~mlrun.common.
+0001fa20: 7363 6865 6d61 732e 4175 7468 6f72 697a  schemas.Authoriz
+0001fa30: 6174 696f 6e56 6572 6966 6963 6174 696f  ationVerificatio
+0001fa40: 6e49 6e70 7574 6020 7468 6174 2069 6e63  nInput` that inc
+0001fa50: 6c75 6465 7320 616c 6c20 7468 6520 6e65  ludes all the ne
+0001fa60: 6564 6564 2070 6172 616d 6574 6572 7320  eded parameters 
+0001fa70: 666f 720a 2020 2020 2020 2020 2020 2020  for.            
+0001fa80: 7468 6520 6175 7468 2076 6572 6966 6963  the auth verific
+0001fa90: 6174 696f 6e0a 2020 2020 2020 2020 2222  ation.        ""
+0001faa0: 220a 2020 2020 2020 2020 6572 726f 725f  ".        error_
+0001fab0: 6d65 7373 6167 6520 3d20 2241 7574 686f  message = "Autho
+0001fac0: 7269 7a61 7469 6f6e 2063 6865 636b 2066  rization check f
+0001fad0: 6169 6c65 6422 0a20 2020 2020 2020 2073  ailed".        s
+0001fae0: 656c 662e 6170 695f 6361 6c6c 280a 2020  elf.api_call(.  
+0001faf0: 2020 2020 2020 2020 2020 2250 4f53 5422            "POST"
+0001fb00: 2c0a 2020 2020 2020 2020 2020 2020 2261  ,.            "a
+0001fb10: 7574 686f 7269 7a61 7469 6f6e 2f76 6572  uthorization/ver
+0001fb20: 6966 6963 6174 696f 6e73 222c 0a20 2020  ifications",.   
+0001fb30: 2020 2020 2020 2020 2065 7272 6f72 5f6d           error_m
+0001fb40: 6573 7361 6765 2c0a 2020 2020 2020 2020  essage,.        
+0001fb50: 2020 2020 626f 6479 3d64 6963 745f 746f      body=dict_to
+0001fb60: 5f6a 736f 6e28 6175 7468 6f72 697a 6174  _json(authorizat
+0001fb70: 696f 6e5f 7665 7269 6669 6361 7469 6f6e  ion_verification
+0001fb80: 5f69 6e70 7574 2e64 6963 7428 2929 2c0a  _input.dict()),.
+0001fb90: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
+0001fba0: 6566 2074 7269 6767 6572 5f6d 6967 7261  ef trigger_migra
+0001fbb0: 7469 6f6e 7328 7365 6c66 2920 2d3e 204f  tions(self) -> O
+0001fbc0: 7074 696f 6e61 6c5b 6d6c 7275 6e2e 636f  ptional[mlrun.co
+0001fbd0: 6d6d 6f6e 2e73 6368 656d 6173 2e42 6163  mmon.schemas.Bac
+0001fbe0: 6b67 726f 756e 6454 6173 6b5d 3a0a 2020  kgroundTask]:.  
+0001fbf0: 2020 2020 2020 2222 2254 7269 6767 6572        """Trigger
+0001fc00: 206d 6967 7261 7469 6f6e 7320 2877 696c   migrations (wil
+0001fc10: 6c20 646f 206e 6f74 6869 6e67 2069 6620  l do nothing if 
+0001fc20: 6e6f 206d 6967 7261 7469 6f6e 7320 6172  no migrations ar
+0001fc30: 6520 6e65 6564 6564 2920 616e 6420 7761  e needed) and wa
+0001fc40: 6974 2066 6f72 2074 6865 6d20 746f 2066  it for them to f
+0001fc50: 696e 6973 6820 6966 2061 6374 7561 6c6c  inish if actuall
+0001fc60: 790a 2020 2020 2020 2020 7472 6967 6765  y.        trigge
+0001fc70: 7265 640a 2020 2020 2020 2020 3a72 6574  red.        :ret
+0001fc80: 7572 6e73 3a20 3a70 793a 636c 6173 733a  urns: :py:class:
+0001fc90: 607e 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  `~mlrun.common.s
+0001fca0: 6368 656d 6173 2e42 6163 6b67 726f 756e  chemas.Backgroun
+0001fcb0: 6454 6173 6b60 2e0a 2020 2020 2020 2020  dTask`..        
+0001fcc0: 2222 220a 2020 2020 2020 2020 7265 7370  """.        resp
+0001fcd0: 6f6e 7365 203d 2073 656c 662e 6170 695f  onse = self.api_
+0001fce0: 6361 6c6c 280a 2020 2020 2020 2020 2020  call(.          
+0001fcf0: 2020 2250 4f53 5422 2c0a 2020 2020 2020    "POST",.      
+0001fd00: 2020 2020 2020 226f 7065 7261 7469 6f6e        "operation
+0001fd10: 732f 6d69 6772 6174 696f 6e73 222c 0a20  s/migrations",. 
+0001fd20: 2020 2020 2020 2020 2020 2022 4661 696c             "Fail
+0001fd30: 6564 2074 7269 6767 6572 696e 6720 6d69  ed triggering mi
+0001fd40: 6772 6174 696f 6e73 222c 0a20 2020 2020  grations",.     
+0001fd50: 2020 2029 0a20 2020 2020 2020 2069 6620     ).        if 
+0001fd60: 7265 7370 6f6e 7365 2e73 7461 7475 735f  response.status_
+0001fd70: 636f 6465 203d 3d20 6874 7470 2e48 5454  code == http.HTT
+0001fd80: 5053 7461 7475 732e 4143 4345 5054 4544  PStatus.ACCEPTED
+0001fd90: 3a0a 2020 2020 2020 2020 2020 2020 6261  :.            ba
+0001fda0: 636b 6772 6f75 6e64 5f74 6173 6b20 3d20  ckground_task = 
+0001fdb0: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
+0001fdc0: 656d 6173 2e42 6163 6b67 726f 756e 6454  emas.BackgroundT
+0001fdd0: 6173 6b28 2a2a 7265 7370 6f6e 7365 2e6a  ask(**response.j
+0001fde0: 736f 6e28 2929 0a20 2020 2020 2020 2020  son()).         
+0001fdf0: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+0001fe00: 7761 6974 5f66 6f72 5f62 6163 6b67 726f  wait_for_backgro
+0001fe10: 756e 645f 7461 736b 5f74 6f5f 7265 6163  und_task_to_reac
+0001fe20: 685f 7465 726d 696e 616c 5f73 7461 7465  h_terminal_state
+0001fe30: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0001fe40: 2020 6261 636b 6772 6f75 6e64 5f74 6173    background_tas
+0001fe50: 6b2e 6d65 7461 6461 7461 2e6e 616d 650a  k.metadata.name.
+0001fe60: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+0001fe70: 2020 2020 2020 7265 7475 726e 204e 6f6e        return Non
+0001fe80: 650a 0a0a 6465 6620 5f61 735f 6a73 6f6e  e...def _as_json
+0001fe90: 286f 626a 293a 0a20 2020 2066 6e20 3d20  (obj):.    fn = 
+0001fea0: 6765 7461 7474 7228 6f62 6a2c 2022 746f  getattr(obj, "to
+0001feb0: 5f6a 736f 6e22 2c20 4e6f 6e65 290a 2020  _json", None).  
+0001fec0: 2020 6966 2066 6e3a 0a20 2020 2020 2020    if fn:.       
+0001fed0: 2072 6574 7572 6e20 666e 2829 0a20 2020   return fn().   
+0001fee0: 2072 6574 7572 6e20 6469 6374 5f74 6f5f   return dict_to_
+0001fef0: 6a73 6f6e 286f 626a 290a                 json(obj).
```

## mlrun/feature_store/retrieval/job.py

```diff
@@ -103,15 +103,15 @@
             "drop_columns": drop_columns,
             "with_indexes": with_indexes,
             "query": query,
             "join_type": join_type,
             "order_by": order_by,
             "engine_args": engine_args,
         },
-        inputs={"entity_rows": entity_rows},
+        inputs={"entity_rows": entity_rows} if entity_rows is not None else {},
     )
     task.spec.secret_sources = run_config.secret_sources
     task.set_label("job-type", "feature-merge").set_label("feature-vector", vector.uri)
     task.metadata.uid = uuid.uuid4().hex
     vector.status.run_uri = task.metadata.uid
     vector.save()
```

## mlrun/runtimes/base.py

```diff
@@ -10,49 +10,47 @@
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 import enum
 import getpass
 import http
-import os.path
 import traceback
 import typing
 import uuid
 from abc import ABC, abstractmethod
 from ast import literal_eval
 from base64 import b64encode
 from copy import deepcopy
 from datetime import datetime, timedelta, timezone
 from os import environ
 from typing import Dict, List, Optional, Tuple, Union
 
-import IPython
 import requests.exceptions
 from kubernetes.client.rest import ApiException
 from nuclio.build import mlrun_footer
 from sqlalchemy.orm import Session
 
 import mlrun.api.db.sqldb.session
 import mlrun.api.utils.singletons.db
 import mlrun.common.schemas
 import mlrun.errors
+import mlrun.launcher.factory
 import mlrun.utils.helpers
 import mlrun.utils.notifications
 import mlrun.utils.regex
 from mlrun.api.constants import LogSources
 from mlrun.api.db.base import DBInterface
 from mlrun.utils.helpers import generate_object_uri, verify_field_regex
 
 from ..config import config, is_running_as_api
 from ..datastore import store_manager
 from ..db import RunDBError, get_or_set_dburl, get_run_db
 from ..errors import err_to_str
-from ..execution import MLClientCtx
-from ..kfpops import mlrun_op, write_kfpmeta
+from ..kfpops import mlrun_op
 from ..lists import RunList
 from ..model import (
     BaseMetadata,
     HyperParamOptions,
     ImageBuilder,
     ModelObj,
     RunObject,
@@ -61,27 +59,23 @@
 from ..secrets import SecretsStore
 from ..utils import (
     dict_to_json,
     dict_to_yaml,
     enrich_image_url,
     get_in,
     get_parsed_docker_registry,
-    get_ui_url,
-    is_ipython,
     logger,
     normalize_name,
     now_date,
     update_in,
 )
 from .constants import PodPhases, RunStates
 from .funcdoc import update_function_entry_points
-from .generators import get_generator
-from .utils import RunError, calc_hash, get_k8s, results_to_iter
+from .utils import RunError, calc_hash, get_k8s
 
-run_modes = ["pass"]
 spec_fields = [
     "command",
     "args",
     "image",
     "mode",
     "build",
     "entry_points",
@@ -185,22 +179,20 @@
         self._db_conn = None
         self._secrets = None
         self._k8s = None
         self._is_built = False
         self.is_child = False
         self._status = None
         self.status = None
-        self._is_api_server = False
         self.verbose = False
         self._enriched_image = False
 
     def set_db_connection(self, conn):
         if not self._db_conn:
             self._db_conn = conn
-        self._is_api_server = mlrun.config.is_running_as_api()
 
     @property
     def metadata(self) -> BaseMetadata:
         return self._metadata
 
     @metadata.setter
     def metadata(self, metadata):
@@ -235,47 +227,14 @@
 
     def _is_remote_api(self):
         db = self._get_db()
         if db and db.kind == "http":
             return True
         return False
 
-    def _use_remote_api(self):
-        if (
-            self._is_remote
-            and not self._is_api_server
-            and self._get_db()
-            and self._get_db().kind == "http"
-        ):
-            return True
-        return False
-
-    def _enrich_on_client_side(self):
-        self.try_auto_mount_based_on_config()
-        self._fill_credentials()
-
-    def _enrich_on_server_side(self):
-        pass
-
-    def _enrich_on_server_and_client_sides(self):
-        """
-        enrich function also in client side and also on server side
-        """
-        pass
-
-    def _enrich_function(self):
-        """
-        enriches the function based on the flow state we run in (sdk or server)
-        """
-        if self._use_remote_api():
-            self._enrich_on_client_side()
-        else:
-            self._enrich_on_server_side()
-        self._enrich_on_server_and_client_sides()
-
     def _function_uri(self, tag=None, hash_key=None):
         return generate_object_uri(
             self.metadata.project,
             self.metadata.name,
             tag=tag or self.metadata.tag,
             hash_key=hash_key,
         )
@@ -284,15 +243,14 @@
         self.spec.rundb = self.spec.rundb or get_or_set_dburl()
 
     def _get_db(self):
         self._ensure_run_db()
         if not self._db_conn:
             if self.spec.rundb:
                 self._db_conn = get_run_db(self.spec.rundb, secrets=self._secrets)
-                self._is_api_server = mlrun.config.is_running_as_api()
         return self._db_conn
 
     # This function is different than the auto_mount function, as it mounts to runtimes based on the configuration.
     # That's why it's named differently.
     def try_auto_mount_based_on_config(self):
         pass
 
@@ -388,218 +346,41 @@
                           "<key> : <type>". Available artifact types can be seen in `mlrun.ArtifactType`. If no
                           artifact type is specified, the object's default artifact type will be used.
                         * A dictionary of configurations to use when logging. Further info per object type and artifact
                           type can be given there. The artifact key must appear in the dictionary as "key": "the_key".
 
         :return: run context object (RunObject) with run metadata, results and status
         """
-        mlrun.utils.helpers.verify_dict_items_type("Inputs", inputs, [str], [str])
-
-        if self.spec.mode and self.spec.mode not in run_modes:
-            raise ValueError(f'run mode can only be {",".join(run_modes)}')
-
-        self._enrich_function()
-
-        run = self._create_run_object(runspec)
-
-        if local:
-
-            # do not allow local function to be scheduled
-            if schedule is not None:
-                raise mlrun.errors.MLRunInvalidArgumentError(
-                    "local and schedule cannot be used together"
-                )
-            result = self._run_local(
-                run,
-                local_code_path,
-                project,
-                name,
-                workdir,
-                handler,
-                params,
-                inputs,
-                returns,
-                artifact_path,
-                notifications=notifications,
-            )
-            self._save_or_push_notifications(result, local)
-            return result
-
-        run = self._enrich_run(
-            run,
-            handler,
-            project,
-            name,
-            params,
-            inputs,
-            returns,
-            hyperparams,
-            hyper_param_options,
-            verbose,
-            scrape_metrics,
-            out_path,
-            artifact_path,
-            workdir,
-            notifications,
+        launcher = mlrun.launcher.factory.LauncherFactory.create_launcher(
+            self._is_remote, local
         )
-        self._validate_output_path(run)
-        db = self._get_db()
-
-        if not self.is_deployed():
-            if self.spec.build.auto_build or auto_build:
-                logger.info(
-                    "Function is not deployed and auto_build flag is set, starting deploy..."
-                )
-                self.deploy(skip_deployed=True, show_on_failure=True)
-            else:
-                raise RunError(
-                    "function image is not built/ready, set auto_build=True or use .deploy() method first"
-                )
-
-        if self.verbose:
-            logger.info(f"runspec:\n{run.to_yaml()}")
-
-        if "V3IO_USERNAME" in environ and "v3io_user" not in run.metadata.labels:
-            run.metadata.labels["v3io_user"] = environ.get("V3IO_USERNAME")
-
-        if not self.is_child:
-            db_str = "self" if self._is_api_server else self.spec.rundb
-            logger.info(
-                "Storing function",
-                name=run.metadata.name,
-                uid=run.metadata.uid,
-                db=db_str,
-            )
-            self._store_function(run, run.metadata, db)
-
-        # execute the job remotely (to a k8s cluster via the API service)
-        if self._use_remote_api():
-            return self._submit_job(run, schedule, db, watch)
-
-        elif self._is_remote and not self._is_api_server and not self.kfp:
-            logger.warning(
-                "warning!, Api url not set, " "trying to exec remote runtime locally"
-            )
-
-        execution = MLClientCtx.from_dict(
-            run.to_dict(),
-            db,
-            autocommit=False,
-            is_api=self._is_api_server,
-            store_run=False,
-        )
-
-        self._verify_run_params(run.spec.parameters)
-
-        # create task generator (for child runs) from spec
-        task_generator = get_generator(
-            run.spec, execution, param_file_secrets=param_file_secrets
+        return launcher.launch(
+            runtime=self,
+            task=runspec,
+            handler=handler,
+            name=name,
+            project=project,
+            params=params,
+            inputs=inputs,
+            out_path=out_path,
+            workdir=workdir,
+            artifact_path=artifact_path,
+            watch=watch,
+            schedule=schedule,
+            hyperparams=hyperparams,
+            hyper_param_options=hyper_param_options,
+            verbose=verbose,
+            scrape_metrics=scrape_metrics,
+            local=local,
+            local_code_path=local_code_path,
+            auto_build=auto_build,
+            param_file_secrets=param_file_secrets,
+            notifications=notifications,
+            returns=returns,
         )
-        if task_generator:
-            # verify valid task parameters
-            tasks = task_generator.generate(run)
-            for task in tasks:
-                self._verify_run_params(task.spec.parameters)
-
-        # post verifications, store execution in db and run pre run hooks
-        execution.store_run()
-        self._pre_run(run, execution)  # hook for runtime specific prep
-
-        last_err = None
-        # If the runtime is nested, it means the hyper-run will run within a single instance of the run.
-        # So while in the API, we consider the hyper-run as a single run, and then in the runtime itself when the
-        # runtime is now a local runtime and therefore `self._is_nested == False`, we run each task as a separate run by
-        # using the task generator
-        if task_generator and not self._is_nested:
-            # multiple runs (based on hyper params or params file)
-            runner = self._run_many
-            if hasattr(self, "_parallel_run_many") and task_generator.use_parallel():
-                runner = self._parallel_run_many
-            results = runner(task_generator, execution, run)
-            results_to_iter(results, run, execution)
-            result = execution.to_dict()
-            result = self._update_run_state(result, task=run)
-
-        else:
-            # single run
-            try:
-                resp = self._run(run, execution)
-                if (
-                    watch
-                    and mlrun.runtimes.RuntimeKinds.is_watchable(self.kind)
-                    # API shouldn't watch logs, its the client job to query the run logs
-                    and not mlrun.config.is_running_as_api()
-                ):
-                    state, _ = run.logs(True, self._get_db())
-                    if state not in ["succeeded", "completed"]:
-                        logger.warning(f"run ended with state {state}")
-                result = self._update_run_state(resp, task=run)
-            except RunError as err:
-                last_err = err
-                result = self._update_run_state(task=run, err=err)
-
-        self._save_or_push_notifications(run)
-
-        self._post_run(result, execution)  # hook for runtime specific cleanup
-
-        return self._wrap_run_result(result, run, schedule=schedule, err=last_err)
-
-    def _wrap_run_result(
-        self, result: dict, runspec: RunObject, schedule=None, err=None
-    ):
-        # if the purpose was to schedule (and not to run) nothing to wrap
-        if schedule:
-            return
-
-        if result and self.kfp and err is None:
-            write_kfpmeta(result)
-
-        # show ipython/jupyter result table widget
-        results_tbl = RunList()
-        if result:
-            results_tbl.append(result)
-        else:
-            logger.info("no returned result (job may still be in progress)")
-            results_tbl.append(runspec.to_dict())
-
-        uid = runspec.metadata.uid
-        project = runspec.metadata.project
-        if is_ipython and config.ipython_widget:
-            results_tbl.show()
-            print()
-            ui_url = get_ui_url(project, uid)
-            if ui_url:
-                ui_url = f' or <a href="{ui_url}" target="_blank">click here</a> to open in UI'
-            IPython.display.display(
-                IPython.display.HTML(
-                    f"<b> > to track results use the .show() or .logs() methods {ui_url}</b>"
-                )
-            )
-        elif not (self.is_child and is_running_as_api()):
-            project_flag = f"-p {project}" if project else ""
-            info_cmd = f"mlrun get run {uid} {project_flag}"
-            logs_cmd = f"mlrun logs {uid} {project_flag}"
-            logger.info(
-                "To track results use the CLI", info_cmd=info_cmd, logs_cmd=logs_cmd
-            )
-            ui_url = get_ui_url(project, uid)
-            if ui_url:
-                logger.info("Or click for UI", ui_url=ui_url)
-        if result:
-            run = RunObject.from_dict(result)
-            logger.info(
-                f"run executed, status={run.status.state}", name=run.metadata.name
-            )
-            if run.status.state == "error":
-                if self._is_remote and not self.is_child:
-                    logger.error(f"runtime error: {run.status.error}")
-                raise RunError(run.status.error)
-            return run
-
-        return None
 
     def _get_db_run(self, task: RunObject = None):
         if self._get_db() and task:
             project = task.metadata.project
             uid = task.metadata.uid
             iter = task.metadata.iteration
             try:
@@ -620,51 +401,14 @@
             runtime_env["MLRUN_LOG_LEVEL"] = "DEBUG"
         if config.httpdb.api_url:
             runtime_env["MLRUN_DBPATH"] = config.httpdb.api_url
         if self.metadata.namespace or config.namespace:
             runtime_env["MLRUN_NAMESPACE"] = self.metadata.namespace or config.namespace
         return runtime_env
 
-    def _run_local(
-        self,
-        runspec,
-        local_code_path,
-        project,
-        name,
-        workdir,
-        handler,
-        params,
-        inputs,
-        returns,
-        artifact_path,
-        notifications: List[mlrun.model.Notification] = None,
-    ):
-        # allow local run simulation with a flip of a flag
-        command = self
-        if local_code_path:
-            project = project or self.metadata.project
-            name = name or self.metadata.name
-            command = local_code_path
-        return mlrun.run_local(
-            runspec,
-            command,
-            name,
-            self.spec.args,
-            workdir=workdir,
-            project=project,
-            handler=handler,
-            params=params,
-            inputs=inputs,
-            artifact_path=artifact_path,
-            mode=self.spec.mode,
-            allow_empty_resources=self.spec.allow_empty_resources,
-            notifications=notifications,
-            returns=returns,
-        )
-
     def _create_run_object(self, runspec):
         # TODO: Once implemented the `Runtime` handlers configurations (doc strings, params type hints and returning
         #       log hints, possible parameter values, etc), the configured type hints and log hints should be set into
         #       the `RunObject` from the `Runtime`.
         if runspec:
             runspec = deepcopy(runspec)
             if isinstance(runspec, str):
@@ -798,72 +542,14 @@
             runspec.spec.output_path = mlrun.utils.helpers.fill_artifact_path_template(
                 runspec.spec.output_path, runspec.metadata.project
             )
 
         runspec.spec.notifications = notifications or runspec.spec.notifications or []
         return runspec
 
-    def _submit_job(self, run: RunObject, schedule, db, watch):
-        if self._secrets:
-            run.spec.secret_sources = self._secrets.to_serial()
-        try:
-            resp = db.submit_job(run, schedule=schedule)
-            if schedule:
-                action = resp.pop("action", "created")
-                logger.info(f"task schedule {action}", **resp)
-                return
-
-        except (requests.HTTPError, Exception) as err:
-            logger.error(f"got remote run err, {err_to_str(err)}")
-
-            if isinstance(err, requests.HTTPError):
-                self._handle_submit_job_http_error(err)
-
-            result = None
-            # if we got a schedule no reason to do post_run stuff (it purposed to update the run status with error,
-            # but there's no run in case of schedule)
-            if not schedule:
-                result = self._update_run_state(task=run, err=err_to_str(err))
-            return self._wrap_run_result(result, run, schedule=schedule, err=err)
-
-        if resp:
-            txt = get_in(resp, "status.status_text")
-            if txt:
-                logger.info(txt)
-        # watch is None only in scenario where we run from pipeline step, in this case we don't want to watch the run
-        # logs too frequently but rather just pull the state of the run from the DB and pull the logs every x seconds
-        # which ideally greater than the pull state interval, this reduces unnecessary load on the API server, as
-        # running a pipeline is mostly not an interactive process which means the logs pulling doesn't need to be pulled
-        # in real time
-        if (
-            watch is None
-            and self.kfp
-            and config.httpdb.logs.pipelines.pull_state.mode == "enabled"
-        ):
-            state_interval = int(
-                config.httpdb.logs.pipelines.pull_state.pull_state_interval
-            )
-            logs_interval = int(
-                config.httpdb.logs.pipelines.pull_state.pull_logs_interval
-            )
-
-            run.wait_for_completion(
-                show_logs=True,
-                sleep=state_interval,
-                logs_interval=logs_interval,
-                raise_on_failure=False,
-            )
-            resp = self._get_db_run(run)
-
-        elif watch or self.kfp:
-            run.logs(True, self._get_db())
-            resp = self._get_db_run(run)
-
-        return self._wrap_run_result(resp, run, schedule=schedule)
-
     @staticmethod
     def _handle_submit_job_http_error(error: requests.HTTPError):
         # if we receive a 400 status code, this means the request was invalid and the run wasn't created in the DB.
         # so we don't need to update the run state and we can just raise the error.
         # more status code handling can be added here if needed
         if error.response.status_code == http.HTTPStatus.BAD_REQUEST.value:
             raise mlrun.errors.MLRunBadRequestError(
@@ -1350,28 +1036,14 @@
             # the base image for deployment
             and self._is_remote_api()
         ):
             # when the function require build use the image as the base_image for the build
             self.spec.build.base_image = image
             self.spec.image = ""
 
-    def _verify_run_params(self, parameters: typing.Dict[str, typing.Any]):
-        for param_name, param_value in parameters.items():
-
-            if isinstance(param_value, dict):
-                # if the parameter is a dict, we might have some nested parameters,
-                # in this case we need to verify them as well recursively
-                self._verify_run_params(param_value)
-
-            # verify that integer parameters don't exceed a int64
-            if isinstance(param_value, int) and abs(param_value) >= 2**63:
-                raise mlrun.errors.MLRunInvalidArgumentError(
-                    f"parameter {param_name} value {param_value} exceeds int64"
-                )
-
     def export(self, target="", format=".yaml", secrets=None, strip=True):
         """save function spec to a local/remote path (default to./function.yaml)
 
         :param target:   target path/url
         :param format:   `.yaml` (default) or `.json`
         :param secrets:  optional secrets dict/object for target path (e.g. s3)
         :param strip:    strip status data
@@ -1393,43 +1065,20 @@
         target = target or "function.yaml"
         datastore, subpath = stores.get_or_create_store(target)
         datastore.put(subpath, data)
         logger.info(f"function spec saved to path: {target}")
         return self
 
     def save(self, tag="", versioned=False, refresh=False) -> str:
-        db = self._get_db()
-        if not db:
-            logger.error("database connection is not configured")
-            return ""
-
-        if refresh and self._is_remote_api():
-            try:
-                meta = self.metadata
-                db_func = db.get_function(meta.name, meta.project, meta.tag)
-                if db_func and "status" in db_func:
-                    self.status = db_func["status"]
-                    if (
-                        self.status.state
-                        and self.status.state == "ready"
-                        and not hasattr(self.status, "nuclio_name")
-                    ):
-                        self.spec.image = get_in(db_func, "spec.image", self.spec.image)
-            except mlrun.errors.MLRunNotFoundError:
-                pass
-
-        tag = tag or self.metadata.tag
-
-        obj = self.to_dict()
-        logger.debug(f"saving function: {self.metadata.name}, tag: {tag}")
-        hash_key = db.store_function(
-            obj, self.metadata.name, self.metadata.project, tag, versioned
+        launcher = mlrun.launcher.factory.LauncherFactory.create_launcher(
+            is_remote=self._is_remote
+        )
+        return launcher.save_function(
+            self, tag=tag, versioned=versioned, refresh=refresh
         )
-        hash_key = hash_key if versioned else None
-        return "db://" + self._function_uri(hash_key=hash_key, tag=tag)
 
     def to_dict(self, fields=None, exclude=None, strip=False):
         struct = super().to_dict(fields, exclude=exclude)
         if strip:
             if "status" in struct:
                 del struct["status"]
         return struct
@@ -1476,42 +1125,14 @@
             if len(inline_comment) > 1:
                 requirement = inline_comment[0].strip()
 
             requirements.append(requirement)
 
         return requirements
 
-    def _validate_output_path(self, run):
-        if is_local(run.spec.output_path):
-            message = ""
-            if not os.path.isabs(run.spec.output_path):
-                message = (
-                    "artifact/output path is not defined or is local and relative,"
-                    " artifacts will not be visible in the UI"
-                )
-                if mlrun.runtimes.RuntimeKinds.requires_absolute_artifacts_path(
-                    self.kind
-                ):
-                    raise mlrun.errors.MLRunPreconditionFailedError(
-                        "artifact path (`artifact_path`) must be absolute for remote tasks"
-                    )
-            elif hasattr(self.spec, "volume_mounts") and not self.spec.volume_mounts:
-                message = (
-                    "artifact output path is local while no volume mount is specified. "
-                    "artifacts would not be visible via UI."
-                )
-            if message:
-                logger.warning(message, output_path=run.spec.output_path)
-
-
-def is_local(url):
-    if not url:
-        return True
-    return "://" not in url
-
 
 class BaseRuntimeHandler(ABC):
     # setting here to allow tests to override
     kind = "base"
     class_modes: typing.Dict[RuntimeClassMode, str] = {}
     wait_for_deletion_interval = 10
 
@@ -1522,15 +1143,15 @@
         Should return the label selector to get only resources of a specific object (with id object_id)
         """
         pass
 
     def _should_collect_logs(self) -> bool:
         """
         There are some runtimes which we don't collect logs for using the log collector
-        :return: whether should collect log for it
+        :return: whether it should collect log for it
         """
         return True
 
     def _get_possible_mlrun_class_label_values(
         self, class_mode: typing.Union[RuntimeClassMode, str] = None
     ) -> List[str]:
         """
```

## mlrun/runtimes/funcdoc.py

```diff
@@ -45,21 +45,31 @@
         "default": default,
         "doc": doc,
         "name": name,
         "type": type,
     }
 
 
-def func_dict(name, doc, params, returns, lineno):
+def func_dict(
+    name,
+    doc,
+    params,
+    returns,
+    lineno,
+    has_varargs: bool = False,
+    has_kwargs: bool = False,
+):
     return {
         "name": name,
         "doc": doc,
         "params": params,
         "return": returns,
         "lineno": lineno,
+        "has_varargs": has_varargs,
+        "has_kwargs": has_kwargs,
     }
 
 
 def func_info(fn) -> dict:
     sig = inspect.signature(fn)
     doc = inspect.getdoc(fn) or ""
 
@@ -161,25 +171,30 @@
     return doc, params, ret
 
 
 def ast_func_info(func: ast.FunctionDef):
     doc = ast.get_docstring(func) or ""
     rtype = getattr(func.returns, "id", "")
     params = [ast_param_dict(p) for p in func.args.args]
+    # adds info about *args and **kwargs to the function doc
+    has_varargs = func.args.vararg is not None
+    has_kwargs = func.args.kwarg is not None
     defaults = func.args.defaults
     if defaults:
         for param, default in zip(params[-len(defaults) :], defaults):
             param["default"] = ast_code(default)
 
     out = func_dict(
         name=func.name,
         doc=doc,
         params=params,
         returns=param_dict(type=rtype),
         lineno=func.lineno,
+        has_varargs=has_varargs,
+        has_kwargs=has_kwargs,
     )
 
     if not doc.strip():
         return out
 
     return merge_doc(out, doc)
```

## mlrun/runtimes/kubejob.py

```diff
@@ -18,15 +18,14 @@
 from kubernetes import client
 from kubernetes.client.rest import ApiException
 
 import mlrun.common.schemas
 import mlrun.errors
 from mlrun.runtimes.base import BaseRuntimeHandler
 
-from ..builder import build_runtime
 from ..db import RunDBError
 from ..errors import err_to_str
 from ..kfpops import build_op
 from ..model import RunObject
 from ..utils import get_in, logger
 from .base import RunError, RuntimeClassMode
 from .pod import KubeResource, kube_resource_spec_to_pod_spec
@@ -40,20 +39,21 @@
     _is_remote = True
 
     def is_deployed(self):
         """check if the function is deployed (has a valid container)"""
         if self.spec.image:
             return True
 
-        if self._is_remote_api():
-            db = self._get_db()
-            try:
-                db.get_builder_status(self, logs=False)
-            except Exception:
-                pass
+        db = self._get_db()
+        try:
+            # getting builder status enriches the runtime when it needs to be fetched from the API,
+            # otherwise it's a no-op
+            db.get_builder_status(self, logs=False)
+        except Exception:
+            pass
 
         if self.spec.image:
             return True
         if self.status.state and self.status.state == "ready":
             return True
         return False
 
@@ -211,14 +211,15 @@
             self.spec.image = ""
 
         # When we're in pipelines context we must watch otherwise the pipelines pod will exit before the operation
         # is actually done. (when a pipelines pod exits, the pipeline step marked as done)
         if is_kfp:
             watch = True
 
+        ready = False
         if self._is_remote_api():
             db = self._get_db()
             data = db.remote_builder(
                 self,
                 with_mlrun,
                 mlrun_version_specifier,
                 skip_deployed,
@@ -236,25 +237,14 @@
                 logger.info(
                     f"Started building image: {data.get('data', {}).get('spec', {}).get('build', {}).get('image')}"
                 )
             if watch and not ready:
                 state = self._build_watch(watch, show_on_failure=show_on_failure)
                 ready = state == "ready"
                 self.status.state = state
-        else:
-            self.save(versioned=False)
-            ready = build_runtime(
-                mlrun.common.schemas.AuthInfo(),
-                self,
-                with_mlrun,
-                mlrun_version_specifier,
-                skip_deployed,
-                watch,
-            )
-            self.save(versioned=False)
 
         if watch and not ready:
             raise mlrun.errors.MLRunRuntimeError("Deploy failed")
         return ready
 
     def _build_watch(self, watch=True, logs=True, show_on_failure=False):
         db = self._get_db()
```

## mlrun/runtimes/utils.py

```diff
@@ -20,15 +20,16 @@
 from io import StringIO
 from sys import stderr
 
 import pandas as pd
 from kubernetes import client
 
 import mlrun
-import mlrun.builder
+import mlrun.api.utils.builder
+import mlrun.common.constants
 import mlrun.utils.regex
 from mlrun.api.utils.clients import nuclio
 from mlrun.db import get_run_db
 from mlrun.errors import err_to_str
 from mlrun.frameworks.parallel_coordinates import gen_pcp_plot
 from mlrun.runtimes.constants import MPIJobCRDVersions
 
@@ -342,15 +343,19 @@
     return generate_function_image_name(project, name, tag)
 
 
 def generate_function_image_name(project: str, name: str, tag: str) -> str:
     _, repository = helpers.get_parsed_docker_registry()
     repository = helpers.get_docker_repository_or_default(repository)
     return fill_function_image_name_template(
-        mlrun.builder.IMAGE_NAME_ENRICH_REGISTRY_PREFIX, repository, project, name, tag
+        mlrun.common.constants.IMAGE_NAME_ENRICH_REGISTRY_PREFIX,
+        repository,
+        project,
+        name,
+        tag,
     )
 
 
 def fill_function_image_name_template(
     registry: str,
     repository: str,
     project: str,
@@ -367,15 +372,15 @@
     )
 
 
 def resolve_function_target_image_registries_to_enforce_prefix():
     registry, repository = helpers.get_parsed_docker_registry()
     repository = helpers.get_docker_repository_or_default(repository)
     return [
-        f"{mlrun.builder.IMAGE_NAME_ENRICH_REGISTRY_PREFIX}{repository}/",
+        f"{mlrun.common.constants.IMAGE_NAME_ENRICH_REGISTRY_PREFIX}{repository}/",
         f"{registry}/{repository}/",
     ]
 
 
 def set_named_item(obj, item):
     if isinstance(item, dict):
         obj[item["name"]] = item
```

## mlrun/utils/helpers.py

```diff
@@ -1010,17 +1010,24 @@
     pkg_module = ".".join(splits[:-1])
     cb_fname = splits[-1]
     pkg_module = __import__(pkg_module, fromlist=[cb_fname])
     function_ = getattr(pkg_module, cb_fname)
     return function_
 
 
-def get_caller_globals(level=2):
+def get_caller_globals():
+    """Returns a dictionary containing the first non-mlrun caller function's namespace."""
     try:
-        return inspect.stack()[level][0].f_globals
+        stack = inspect.stack()
+        # If an API function called this function directly, the first non-mlrun caller will be 2 levels up the stack.
+        # Otherwise, we keep going up the stack until we find it.
+        for level in range(2, len(stack)):
+            namespace = stack[level][0].f_globals
+            if not namespace["__name__"].startswith("mlrun."):
+                return namespace
     except Exception:
         return None
 
 
 def _module_to_namespace(namespace):
     if isinstance(namespace, ModuleType):
         members = inspect.getmembers(
```

## mlrun/utils/notifications/notification_pusher.py

```diff
@@ -18,15 +18,14 @@
 import os
 import typing
 
 from fastapi.concurrency import run_in_threadpool
 
 import mlrun.api.db.base
 import mlrun.api.db.session
-import mlrun.api.utils.singletons.k8s
 import mlrun.common.schemas
 import mlrun.config
 import mlrun.lists
 import mlrun.model
 import mlrun.utils.helpers
 from mlrun.utils import logger
 
@@ -188,14 +187,15 @@
         db: mlrun.api.db.base.DBInterface,
         run_uid: str,
         project: str,
         notification: mlrun.model.Notification,
         status: str = None,
         sent_time: datetime.datetime = None,
     ):
+        # TODO: move to api side
         db_session = mlrun.api.db.session.create_session()
         notification.status = status or notification.status
         notification.sent_time = sent_time or notification.sent_time
 
         # store directly in db, no need to use crud as the secrets are already loaded
         await run_in_threadpool(
             db.store_run_notifications,
```

## mlrun/utils/version/version.json

### Pretty-printed

 * *Similarity: 0.5%*

 * *Differences: {"'git_commit'": "'3618d468853e804de8f3e4ad15d1420efd5e8aac'", "'version'": "'1.4.0-rc4'"}*

```diff
@@ -1,4 +1,4 @@
 {
-    "git_commit": "207f6987e318c06f539ba3526acb03cc3323d2c1",
-    "version": "1.4.0-rc3"
+    "git_commit": "3618d468853e804de8f3e4ad15d1420efd5e8aac",
+    "version": "1.4.0-rc4"
 }
```

## Comparing `mlrun/builder.py` & `mlrun/api/utils/builder.py`

 * *Files 2% similar despite different names*

```diff
@@ -10,32 +10,33 @@
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 import os.path
 import pathlib
 import re
-import tarfile
 import tempfile
 from base64 import b64decode, b64encode
 from os import path
 from urllib.parse import urlparse
 
 from kubernetes import client
 
 import mlrun.api.utils.singletons.k8s
+import mlrun.common.constants
 import mlrun.common.schemas
 import mlrun.errors
 import mlrun.runtimes.utils
-
-from .config import config
-from .datastore import store_manager
-from .utils import enrich_image_url, get_parsed_docker_registry, logger, normalize_name
-
-IMAGE_NAME_ENRICH_REGISTRY_PREFIX = "."
+from mlrun.config import config
+from mlrun.utils import (
+    enrich_image_url,
+    get_parsed_docker_registry,
+    logger,
+    normalize_name,
+)
 
 
 def make_dockerfile(
     base_image: str,
     commands: list = None,
     source: str = None,
     requirements_path: str = None,
@@ -299,25 +300,14 @@
         command=["/bin/sh"],
         args=["-c", command],
         env=init_container_env,
         name="create-repos",
     )
 
 
-def upload_tarball(source_dir, target, secrets=None):
-
-    # will delete the temp file
-    with tempfile.NamedTemporaryFile(suffix=".tar.gz") as temp_fh:
-        with tarfile.open(mode="w:gz", fileobj=temp_fh) as tar:
-            tar.add(source_dir, arcname="")
-        stores = store_manager.set(secrets)
-        datastore, subpath = stores.get_or_create_store(target)
-        datastore.upload(subpath, temp_fh.name)
-
-
 def build_image(
     auth_info: mlrun.common.schemas.AuthInfo,
     project: str,
     image_target,
     commands=None,
     source="",
     base_image=None,
@@ -398,17 +388,31 @@
         source_to_copy = "."
 
     else:
         if v3io:
             source = parsed_url.path
             to_mount = True
             source_dir_to_mount, source_to_copy = path.split(source)
-        else:
+
+        # source is a path without a scheme, we allow to copy absolute paths assuming they are valid paths
+        # in the image, however, it is recommended to use `workdir` instead in such cases
+        # which is set during runtime (mlrun.runtimes.local.LocalRuntime._pre_run).
+        # relative paths are not supported at build time
+        # "." and "./" are considered as 'project context'
+        # TODO: enrich with project context if pulling on build time
+        elif path.isabs(source):
             source_to_copy = source
 
+        else:
+            raise mlrun.errors.MLRunInvalidArgumentError(
+                f"Load of relative source ({source}) is not supported at build time"
+                "see 'mlrun.runtimes.kubejob.KubejobRuntime.with_source_archive' or "
+                "'mlrun.projects.project.MlrunProject.set_source' for more details"
+            )
+
     user_unix_id = None
     enriched_group_id = None
     if (
         mlrun.mlconf.function.spec.security_context.enrichment_mode
         != mlrun.common.schemas.SecurityContextEnrichmentModes.disabled.value
     ):
         from mlrun.api.api.utils import ensure_function_security_context
@@ -673,18 +677,22 @@
 def _resolve_image_target_and_registry_secret(
     image_target: str, registry: str = None, secret_name: str = None
 ) -> (str, str):
     if registry:
         return "/".join([registry, image_target]), secret_name
 
     # if dest starts with a dot, we add the configured registry to the start of the dest
-    if image_target.startswith(IMAGE_NAME_ENRICH_REGISTRY_PREFIX):
+    if image_target.startswith(
+        mlrun.common.constants.IMAGE_NAME_ENRICH_REGISTRY_PREFIX
+    ):
 
         # remove prefix from image name
-        image_target = image_target[len(IMAGE_NAME_ENRICH_REGISTRY_PREFIX) :]
+        image_target = image_target[
+            len(mlrun.common.constants.IMAGE_NAME_ENRICH_REGISTRY_PREFIX) :
+        ]
 
         registry, repository = get_parsed_docker_registry()
         secret_name = secret_name or config.httpdb.builder.docker_registry_secret
         if not registry:
             raise ValueError(
                 "Default docker registry is not defined, set "
                 "MLRUN_HTTPDB__BUILDER__DOCKER_REGISTRY/MLRUN_HTTPDB__BUILDER__DOCKER_REGISTRY_SECRET env vars"
```

## Comparing `mlrun-1.4.0rc3.dist-info/LICENSE` & `mlrun-1.4.0rc4.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `mlrun-1.4.0rc3.dist-info/METADATA` & `mlrun-1.4.0rc4.dist-info/METADATA`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: mlrun
-Version: 1.4.0rc3
+Version: 1.4.0rc4
 Summary: Tracking and config of machine learning runs
 Home-page: https://github.com/mlrun/mlrun
 Author: Yaron Haviv
 Author-email: yaronh@iguazio.com
 License: MIT
 Platform: UNKNOWN
 Classifier: Development Status :: 4 - Beta
```

## Comparing `mlrun-1.4.0rc3.dist-info/RECORD` & `mlrun-1.4.0rc4.dist-info/RECORD`

 * *Files 1% similar despite different names*

```diff
@@ -1,41 +1,41 @@
 mlrun/__init__.py,sha256=cCTbgyTFsXvEdaq1Cvwz8s8FE75YGIJKX58um-fnfFs,8727
-mlrun/__main__.py,sha256=ldnSoPg_S6Rt_P8z2yPalqHLE9Xn97eQ7ErtekjZpKA,49356
-mlrun/builder.py,sha256=C8-nJbfPQLAf1mkTpDhKkh1GH5_qZTya7ByQyDJZ1ZQ,25103
+mlrun/__main__.py,sha256=seoOeUtUyks_qBRFOAnbt0Ze8DsrdRkJALQVBC3j9Hc,49342
 mlrun/config.py,sha256=d61-Kq6OpTsNZoalbN_KHh1R9cXOGCtkRCEWWXeH90A,54803
 mlrun/errors.py,sha256=XEb1pxwy5Lzr9q0VT4z_SjP74jy37HFSmdd2hddWgvY,6780
 mlrun/execution.py,sha256=RMuw1D78GOWxDk3aQfFtFRZZ5maM4T7BiXaApoQA_6E,39096
 mlrun/features.py,sha256=pDUvV6HlkxZnUwW3lg7oq3vBwdcJQBprvdyGPNv57X8,15624
 mlrun/k8s_utils.py,sha256=n-RgP564I5R08WAruGirDEssXCcVTlibOlWRV5TjmfI,4880
 mlrun/kfpops.py,sha256=fCq9kqsIO5six8AmHkiRLngyDclRymd7V6U5YXnX_ek,29645
 mlrun/lists.py,sha256=yOKwpS71Fua08sV825Anth8aaR9H5bHZyV544YbnXj4,8360
 mlrun/model.py,sha256=vZyeD1adOohG4E68wfQ1aDkerC7L-vvWY94kJ6CQNXQ,53415
 mlrun/render.py,sha256=983QAYawKTFlwXLpUwGC1gWEjUQUFxl1lo8bPQuXIA0,11828
 mlrun/run.py,sha256=pBnu7Ca4Ct4cUmGPvGvG_EeybJGwsM-XGBqSYFEfQzY,64472
 mlrun/secrets.py,sha256=xr-Omz0j5qjLGPCG_Gn2vsCP0CbqJldAAKpy5N1KAiM,7783
 mlrun/api/__init__.py,sha256=B-yvMk7vTs3QqtlPkM4pnZk_B4QKTGnfNhYr2n4Z30M,571
 mlrun/api/alembic.ini,sha256=oeSJRHwBbF3c3-N_RJilcZD-diq3F-oPv21gDIkrZGs,2105
 mlrun/api/constants.py,sha256=fyTQXJe4sx4GK8vZxklivgJgaSyOftk_NezGKA1J-mo,685
-mlrun/api/initial_data.py,sha256=ehDC44xzihNSbjbn9daGAfPmo-S4vNbr7D3tOoTZKV8,23464
+mlrun/api/initial_data.py,sha256=h4tY0xmv_kLApkJVCB1Ic9lNydVuCDQAxxMvbMuQy1w,25068
+mlrun/api/launcher.py,sha256=A5C6cYEtEDzr15f_yn2H9qURlBuK1icXGjyRaeGwY1I,7075
 mlrun/api/main.py,sha256=4u9h_vaYWnAK3Mps2f-7xBs_AptPxWWPy7XoTtZBXPg,26288
 mlrun/api/middlewares.py,sha256=D9d-3XudnhyK_J1EGdWexCCswiS4QuSWvhDvCH1LEEU,5247
 mlrun/api/api/__init__.py,sha256=B-yvMk7vTs3QqtlPkM4pnZk_B4QKTGnfNhYr2n4Z30M,571
 mlrun/api/api/api.py,sha256=N5QgIWwnm-wgeW_8bUqVTtnRqgOUJGKDUGpScHHs78Y,4243
 mlrun/api/api/deps.py,sha256=OZt6UxT9Yg0O6egcB7a_YbZkKYkk5Vh9tTMKQKxW8nI,3197
 mlrun/api/api/utils.py,sha256=1E0wpW9SzDcU3KZK4Xzbv7BcTGxTTBZ8bH8OVBNg1yA,36432
 mlrun/api/api/endpoints/__init__.py,sha256=B-yvMk7vTs3QqtlPkM4pnZk_B4QKTGnfNhYr2n4Z30M,571
 mlrun/api/api/endpoints/artifacts.py,sha256=FQOa8trbO53b4w864VFU5kyd4AlaRdU5LdUMUrchJhA,9545
 mlrun/api/api/endpoints/auth.py,sha256=YmcYs5pl8Il4jKDVjUGH_S5VXzam06kweO_xXpdSyeg,1199
 mlrun/api/api/endpoints/background_tasks.py,sha256=EQ5zvps1mXaVoNeoyOwMmRTAp0_nwpXtFAItvTA6uo4,3618
 mlrun/api/api/endpoints/client_spec.py,sha256=2hzm_Sq9JyPTfWgaKIjN_vGQX3xLnCScUpuoQjm3NU4,1214
 mlrun/api/api/endpoints/clusterization_spec.py,sha256=eBQya6jeYYBEe7WoCMNmXbkDxgmeDP5DCISGCZ4eAio,1175
 mlrun/api/api/endpoints/feature_store.py,sha256=_tq5xFLvhc0xolrtrrVS95p-m0j13QrmbOTqocWRg5w,29675
 mlrun/api/api/endpoints/files.py,sha256=v_FwFb-29mqDlx2tI8D9VUHthyjnmUpGsWTnfVZR7cE,6104
-mlrun/api/api/endpoints/frontend_spec.py,sha256=Axr4a9LS51mv6dNHe6P5-OfczGa_mcI3Xg5AY_a27hk,5729
-mlrun/api/api/endpoints/functions.py,sha256=zEyPB7mqAmDBlIS9qjnw1ctl4KVXnKD3XDd9NgL1eMI,34608
+mlrun/api/api/endpoints/frontend_spec.py,sha256=5qVJF5T0A74zBi-7GOauPvylX4KGCTldItht3d0f2PE,5749
+mlrun/api/api/endpoints/functions.py,sha256=GNChhESlX8qrKTB4KGcblr0LXRCvpuY00jngMBy5hBI,34618
 mlrun/api/api/endpoints/grafana_proxy.py,sha256=3tqafsudGF9Ru3VjZCRsXZuoLIEmIWnYJEQaIYWrqjg,5986
 mlrun/api/api/endpoints/healthz.py,sha256=rp_esZLesf92tiaFM_E50LR0m_EbsdZxuudYNMG9VVU,1344
 mlrun/api/api/endpoints/hub.py,sha256=D3hiBs4hYAjtqt6CTigM8kcQLT_Wkf0Gh_dAxTO8DEk,10399
 mlrun/api/api/endpoints/logs.py,sha256=CXKdbcQtEth2tqr8I6dEWVpb3kZjL7BNdlDHwNsDQ_s,2450
 mlrun/api/api/endpoints/model_endpoints.py,sha256=qeKxuocrubBARRu_EvHCIHly7WVgLrjMcHCjCpEmbi4,15817
 mlrun/api/api/endpoints/operations.py,sha256=lnfvQmZIcj1z6TgxCy5Tx5x7PiNls3DgE3Yzddvo-9Q,3756
 mlrun/api/api/endpoints/pipelines.py,sha256=eU0D_RFw6KYyL6hYuPjHfaIkXQ4_5u_ZTBxC3lSfJ1g,9220
@@ -72,15 +72,15 @@
 mlrun/api/crud/runtimes/nuclio/function.py,sha256=fEqGrM0yyyq8urUxzFcG43-m3txF-Oyxdhm6e4DCB4w,17168
 mlrun/api/crud/runtimes/nuclio/helpers.py,sha256=E3ThgKBZyPa-VVWv3rTRtQAdR9lIVLkYz8_hfyntocA,11398
 mlrun/api/db/__init__.py,sha256=B-yvMk7vTs3QqtlPkM4pnZk_B4QKTGnfNhYr2n4Z30M,571
 mlrun/api/db/base.py,sha256=ETSlJ24N0s63dLpDS5yVo7vFg3ap-ySwhaKyCOcqUZo,15056
 mlrun/api/db/init_db.py,sha256=5WSrojwOh79O3guN_7IEi9wjqzKj3H74DU2xbGtrElk,870
 mlrun/api/db/session.py,sha256=_5DVL4YyGGFG9sbtHx_Bq2C1aHrZC5V8MS7TJfNeWIk,993
 mlrun/api/db/sqldb/__init__.py,sha256=B-yvMk7vTs3QqtlPkM4pnZk_B4QKTGnfNhYr2n4Z30M,571
-mlrun/api/db/sqldb/db.py,sha256=SKS7gmnbFl1_8ssu_Q9AvzNWzBi_VCrnQvGVay-24Lw,144042
+mlrun/api/db/sqldb/db.py,sha256=NdANYfmHop9vS7vx9KLtcVr7Kmyq5bdTb6gZ8U1S8Ao,144136
 mlrun/api/db/sqldb/helpers.py,sha256=j8VK-l_qZ5vLUjGkFK3D3fBgDgPmi-U8hU1MkMIAhC0,2340
 mlrun/api/db/sqldb/session.py,sha256=97QcZc7EOhypk3ZMl0F5k1ogsgK834S3SxCj3UNry-s,2542
 mlrun/api/db/sqldb/models/__init__.py,sha256=0cHZKMpzqkC6u3WGPEYE8zPcahY6KxBrK2pwkzTCCME,1063
 mlrun/api/db/sqldb/models/models_mysql.py,sha256=zyFuS_tj6legl1QvJ5QBrLIgilAnDcZHSvHC-bXMqdQ,20642
 mlrun/api/db/sqldb/models/models_sqlite.py,sha256=10IzVBZ79Yj1vqFbWCocZ5QNrz1H91HzlzUFe6iu31k,18304
 mlrun/api/migrations_mysql/env.py,sha256=U5Fu1WLV5vggRYy4sa7d1ItJr1H3-T71BnkOw4ZjWIs,2906
 mlrun/api/migrations_mysql/versions/28383af526f3_market_place_to_hub.py,sha256=kcdNEMQHbTRGpzh4CfLlUJtClG_eHo-X0QNPOQEFBuI,1203
@@ -113,40 +113,41 @@
 mlrun/api/migrations_sqlite/versions/e5594ed3ab53_adding_name_and_updated_to_runs_table.py,sha256=lQ0lPq6xZD59iupkbAo0wCV-otE0G9lmjEpqIBZEguA,1831
 mlrun/api/migrations_sqlite/versions/f4249b4ba6fa_adding_feature_vectors.py,sha256=AWkrtG6jWOMJHyLqR8jrmbp95Fk9qB6qhjjYLb1mezo,3936
 mlrun/api/migrations_sqlite/versions/f7b5a1a03629_adding_feature_labels.py,sha256=KrIm5pHwHlJr5e3DdtMcBiEjgbopOniWzDi9T1XTSHQ,2588
 mlrun/api/schemas/__init__.py,sha256=JEimO9A93JbrxJQkJRDUNw4kAKyShmaD5McKulw3ykY,13338
 mlrun/api/utils/__init__.py,sha256=B-yvMk7vTs3QqtlPkM4pnZk_B4QKTGnfNhYr2n4Z30M,571
 mlrun/api/utils/asyncio.py,sha256=E80efqnDt-rRLVqbdjlzHjfe5SNwB4Krn1Y9D0C0JMg,1092
 mlrun/api/utils/background_tasks.py,sha256=4FIdUB2rDJDb7bndMZIr1kQeWPDi9_loHHsjaVMq5Ys,7371
+mlrun/api/utils/builder.py,sha256=PxF-Ct7jQtMcWJDjrqnES8cyQGOXJXphZ0P8gkbSP9A,25560
 mlrun/api/utils/helpers.py,sha256=kQglUe_oaTFll4LhHNg1pwkAkiynzFWowiQlWXc4_7U,2431
 mlrun/api/utils/memory_reports.py,sha256=Diraa4EbJJ28NGrfSuOuGroVsE2sNeRkjUp7Dl4qDlI,3728
 mlrun/api/utils/periodic.py,sha256=Vc8jz2WIsItkb7rcmdtxUfD4-Pohlg_XVbLEUw0S394,2599
 mlrun/api/utils/scheduler.py,sha256=5reTxTtKdQE4wJymnTemQmM8AJ3lvL8fEMeVWtcg0FY,39305
 mlrun/api/utils/auth/__init__.py,sha256=B-yvMk7vTs3QqtlPkM4pnZk_B4QKTGnfNhYr2n4Z30M,571
 mlrun/api/utils/auth/verifier.py,sha256=-JjXEX0tqqBymuR7P-f5mgsJF9FvwZGmb5k2SnTiekE,12383
 mlrun/api/utils/auth/providers/__init__.py,sha256=B-yvMk7vTs3QqtlPkM4pnZk_B4QKTGnfNhYr2n4Z30M,571
 mlrun/api/utils/auth/providers/base.py,sha256=VUvHxeh7HvyJRzo-xRj7ESjlwJ10ilt_-e9U53rui44,1381
 mlrun/api/utils/auth/providers/nop.py,sha256=Y1vv1aH7NDCXY3vnt3HHzZeDappHZx79Jp-C9or8t94,1460
 mlrun/api/utils/auth/providers/opa.py,sha256=xPjubPC29yIglhgBhKB5zVp7JqJC-x71xKwo2YKv9Jo,10883
 mlrun/api/utils/clients/__init__.py,sha256=B-yvMk7vTs3QqtlPkM4pnZk_B4QKTGnfNhYr2n4Z30M,571
 mlrun/api/utils/clients/chief.py,sha256=gI6-LgsZyPVIi8VnjmX1ILgGG-jLYvtYSZVC1QLP3Bg,13271
-mlrun/api/utils/clients/iguazio.py,sha256=G3S0Z6NFRtSkinRXhqUpVEAngO57xBxuk3x-OSLMDz0,31266
+mlrun/api/utils/clients/iguazio.py,sha256=VZun1-HGB1NBVGxMweVp8SzEa0lA38Oj00DcuM9ziHI,31249
 mlrun/api/utils/clients/log_collector.py,sha256=d1Tj680X0QSC83re1vhX62z_0tt5WvNjHqKv1wMVNF4,12109
 mlrun/api/utils/clients/nuclio.py,sha256=yT8atthDWpvlDU4rQiyHXo1tCFDrx3-s1iLJadhJ3nk,9916
 mlrun/api/utils/clients/protocols/__init__.py,sha256=xY3wHC4TEJgez7qtnn1pQvHosi8-5UJOCtyGBS7FcGE,571
 mlrun/api/utils/clients/protocols/grpc.py,sha256=P_He0oRyRvsCpTz7Pl2bZkqwA1W04Wl3BJMusM30pkY,2567
 mlrun/api/utils/db/__init__.py,sha256=B-yvMk7vTs3QqtlPkM4pnZk_B4QKTGnfNhYr2n4Z30M,571
 mlrun/api/utils/db/alembic.py,sha256=sUVnWHXRzA_Yhn2GWiSqeQ8dcfpC4IPQpTFBjTta_iU,3305
 mlrun/api/utils/db/backup.py,sha256=LL4qL3YaLAbehS-KHn-Ieys333ZReEnmFIOoYV7BKzc,8214
 mlrun/api/utils/db/mysql.py,sha256=KWvD37V2_1hztu_g4-Jpe4aLmcc5Gl6x7-HzYWqkBOM,3795
 mlrun/api/utils/db/sql_collation.py,sha256=t1pYJNPDwSP0PZwtlTqMAUgYhGZLRv0awbnEYy3Geis,992
 mlrun/api/utils/db/sqlite_migration.py,sha256=oPv2Knboe4vQGn9MDUfqbFrcIhvSuDoFji1Emj59MIA,3855
 mlrun/api/utils/projects/__init__.py,sha256=B-yvMk7vTs3QqtlPkM4pnZk_B4QKTGnfNhYr2n4Z30M,571
 mlrun/api/utils/projects/follower.py,sha256=htcIXP2BRtm3MUEfw5IFC-WHUwidCfHZArS-pfSfFyM,17423
-mlrun/api/utils/projects/leader.py,sha256=-AzryNjAfEdHRj9BkilIlyfJE3lSGiuHNUa0NxyGzBc,19549
+mlrun/api/utils/projects/leader.py,sha256=V636xbrvoTs5Bg-wtsNTWCAeB4I6hqMc5i43Hlgiizc,19372
 mlrun/api/utils/projects/member.py,sha256=hokfxVFnvWtQHeVQYSZTlv1GyOoRHUUoVRVG4MFxfhE,7133
 mlrun/api/utils/projects/remotes/__init__.py,sha256=B-yvMk7vTs3QqtlPkM4pnZk_B4QKTGnfNhYr2n4Z30M,571
 mlrun/api/utils/projects/remotes/follower.py,sha256=4bjZRHWrY8CKB_y7Juj-aQZn0YnbLCqVsJ93Aj_MniQ,2659
 mlrun/api/utils/projects/remotes/leader.py,sha256=uRC_WbKe1UfghVfCXD0ZomsJztk2HydBdz9Y_XjTfkY,2094
 mlrun/api/utils/projects/remotes/nop_follower.py,sha256=sP8BDve6471PEHomEJYAYEUsAlHwpy1frEfKbU9nAlc,5000
 mlrun/api/utils/projects/remotes/nop_leader.py,sha256=hslYEvKbQ4TdMzYnvqvU_oGfCvfQ2lxAglQqEn12AQ0,3861
 mlrun/api/utils/singletons/__init__.py,sha256=B-yvMk7vTs3QqtlPkM4pnZk_B4QKTGnfNhYr2n4Z30M,571
@@ -158,14 +159,15 @@
 mlrun/artifacts/__init__.py,sha256=b86JkwaOMjN9gPzeL-RlkAtiITaVmGS9viNlvGG1lrs,1091
 mlrun/artifacts/base.py,sha256=l-dRIaK89NOIiBqiSbo1vbPks8CeRv83wSKndybJt0U,30849
 mlrun/artifacts/dataset.py,sha256=d4ZrxECaJ-CJSbFvcWYrAK34IAOD0UPxLY0xrPc-04w,20432
 mlrun/artifacts/manager.py,sha256=O3V_T7Tw6Q425N6SwbWs5M4pAngRa6wc2DQdrdpZfDM,12110
 mlrun/artifacts/model.py,sha256=SmzieOo7d78CPhVyyHMmI6WltkCSVn-d72jAxhHKd7E,23673
 mlrun/artifacts/plots.py,sha256=0Jq5OgDB1srtUlcISF696E_q3S_D-mqeMe6Wyn1S6ZQ,15383
 mlrun/common/__init__.py,sha256=B-yvMk7vTs3QqtlPkM4pnZk_B4QKTGnfNhYr2n4Z30M,571
+mlrun/common/constants.py,sha256=aAMfWLUO_W49XVi2Aj_seNuKJZ0uPyCwu5nX3Iy5xB8,660
 mlrun/common/model_monitoring.py,sha256=6woOZSKb308qfBc5Io4z8coOBwqMB0H6vRUxhkUHeCc,5670
 mlrun/common/types.py,sha256=pUKq8f0L4sjKoik5bCAl2ir3_dmmCZ6eKyurSV10u6I,790
 mlrun/common/schemas/__init__.py,sha256=sxDYvhoYVmLuc4sB1rDf7x_8T0sErGkZV2h4i-hohak,3973
 mlrun/common/schemas/artifact.py,sha256=5ZiL-PSjkjkYrcD6uDrvS-Tjrguyqh-XQ55GBcWm4Ho,1923
 mlrun/common/schemas/auth.py,sha256=s5YeIELOxITr25_hhUfyMRpoRv6aURk4kDJBtw4L180,5251
 mlrun/common/schemas/background_task.py,sha256=tQNOhYXfCr72iCwOjuWulIPy0NcZFQ6x-vI59FVmffM,1553
 mlrun/common/schemas/client_spec.py,sha256=bQhGYtkcJg27yo82y3FNiiNZbYuwWce8SQxcXtVKJpg,2751
@@ -200,34 +202,34 @@
 mlrun/datastore/inmem.py,sha256=o6Svv12k5PxJNT24nMgV9FBYEPCzD3OQzuuvU6OeCYY,2627
 mlrun/datastore/redis.py,sha256=pywWgjGJ51pmvKuwX1MI3ILWqh6WtgDs9igOQAhmIhc,4873
 mlrun/datastore/s3.py,sha256=fn1Yg5Rs33ugHlwTKvBfu_jMKqkSZWgHNw0ocQ5nO7A,7035
 mlrun/datastore/sources.py,sha256=SJyVr_X5hdVv4m4RfIzN_F255qWz5k8bXVNXxY5valY,34385
 mlrun/datastore/spark_udf.py,sha256=xYw2EYO-jd7hKOlXXfJYH8dvRll4GktFM581K9m6ToE,1410
 mlrun/datastore/store_resources.py,sha256=Elvo33AVoDfOIFbTF_5NSf1VMzlgJTv5uzMgPkGTShw,6895
 mlrun/datastore/targets.py,sha256=IurALojY74ZaxiI3B3xMHEWeVM_blys6Dq1EGS9JOyc,62060
-mlrun/datastore/utils.py,sha256=OEBUAux1KD2dNCH2VS_eY3HN1MVk8BWrBHVrzDTvlo8,2409
+mlrun/datastore/utils.py,sha256=nnHcC_XgUWZi70-aZ2y61aJcJttDQYiCDDTGqI_Y6V4,2900
 mlrun/datastore/v3io.py,sha256=ArEYq78irv5bwlRwcLeVfFJvcwtXEamGsZ2I0sVt7Qg,8097
 mlrun/datastore/wasbfs/__init__.py,sha256=4CK7vZeJmC4Ak9cJjG07cGnk7jlkBlpCxw-ANfbBmzk,1343
 mlrun/datastore/wasbfs/fs.py,sha256=DEZgwrmQSPeR93MNlC9OCwuU9wvTSmIM534p5ccQzAE,6152
 mlrun/db/__init__.py,sha256=HA6ahbEFrRd5I81eJQ1xrHmUch6JOy3JeEKMf7KrOTM,2816
-mlrun/db/base.py,sha256=K0Hg-AVWxbRwFaKBxUDTPTStXtGlhesBLZYJzNJfI2E,15737
-mlrun/db/httpdb.py,sha256=2E65WCdxudz_kyUHCsQ09PWbwF9KAtzv2_gyfdlsSxQ,130695
+mlrun/db/base.py,sha256=7he8xfP09ZKLHjdWI2sZdgbfzV8Lw14kjYO-BJcp4VM,15968
+mlrun/db/httpdb.py,sha256=oYeuxEUVRy4dke6fgaujJDP6X0jywzPDvmTrx4NmJOE,130810
 mlrun/db/nopdb.py,sha256=mAEmOlxhnlk3DU8xTf2uWt_5QbDvo8YA9Jj-BKR_VtA,13197
 mlrun/db/sqldb.py,sha256=rgWLh2354qmc14AVGqzICcuphtM1_CKxI6PpVTmUzdw,25917
 mlrun/feature_store/__init__.py,sha256=guoak0hQTMoE4YsWwyoyso0CYE9NSPoP0eUal4crfVA,1501
 mlrun/feature_store/api.py,sha256=oL6x8ehykb-FGhwJAFkTTPn2EyvDx6vRKV3g8Astz3I,43820
 mlrun/feature_store/common.py,sha256=WR01cTgrJ88qRLKRz0U4VDOTg2vNzhYdch-jylkyoJ8,12781
 mlrun/feature_store/feature_set.py,sha256=_k-FBI8a97aKCL3IS9fXehD7cXUCsbMSEAXm4sq47K0,47273
 mlrun/feature_store/feature_vector.py,sha256=31kHErOGU_OhVauMK5svW50TKIDwKgdcDzst87JyB2c,21940
 mlrun/feature_store/ingestion.py,sha256=YQafLdoQmoWsEHLE8lMBBhhPe974TNJ6Tnq_Q0Xhpus,11681
 mlrun/feature_store/steps.py,sha256=khDqxTusXDtBNfS7ESZh-QEsWu3_8FTR5ep_AY_Nvdo,28635
 mlrun/feature_store/retrieval/__init__.py,sha256=2b2WoPmH4TqcSSJ2OQYSjsDIcUe1KA5DnG7-wkrIayM,1232
 mlrun/feature_store/retrieval/base.py,sha256=38n5qY60V-wvn5vAVSd4qQlfkMMTMchX0c2TdZ8XqqE,25911
 mlrun/feature_store/retrieval/dask_merger.py,sha256=-xRgRPWUblu3KtVhEoL0YXEAcgkZrSUykDe31xnEzRI,4261
-mlrun/feature_store/retrieval/job.py,sha256=NwVrTKlR_w4KpMgQwTkreddYUbWI-6pYuksXowZQY9c,7106
+mlrun/feature_store/retrieval/job.py,sha256=-b4AgG3D0jFduzBPmKrb6MjSRez-8-ocmbj9eWCPXaY,7141
 mlrun/feature_store/retrieval/local_merger.py,sha256=h6FE11EZxxqVe2EhVnQtwl5cxOBsOCXQCbTLOJk3op8,4765
 mlrun/feature_store/retrieval/online.py,sha256=tnpHqcbaA16lKTuvlU6WoXwnb_SLmbWBLzyJSvhss28,3352
 mlrun/feature_store/retrieval/spark_merger.py,sha256=R-xHI2ubdx8y_bvgnxYfLtOTOWCy5q6Bjd2AZD1fh1w,9661
 mlrun/frameworks/__init__.py,sha256=H1bU7R7Ua6e52HLpP-MivDJh-L47564uJNTsmgJ0LH4,743
 mlrun/frameworks/parallel_coordinates.py,sha256=83AvqW9z666XDWd29WopLeOdEFAA2HpRZS6d08z1Nbs,11466
 mlrun/frameworks/_common/__init__.py,sha256=5C5C4nQkaGHnv4WuCLjcjtb9nfhRK-7g7O6bbuJVkSY,962
 mlrun/frameworks/_common/artifacts_library.py,sha256=RVh-uIinpH1do5UE6C6iIT44S5VaRvvZONLOp7jCPyA,8515
@@ -307,14 +309,20 @@
 mlrun/frameworks/tf_keras/callbacks/logging_callback.py,sha256=Yv0pHsiQey5cfxdjBIaxpd3znnEzVK9PshV05SnT5IM,21886
 mlrun/frameworks/tf_keras/callbacks/mlrun_logging_callback.py,sha256=N1_lNXSig6FwSUt1P8ZNKf1Hie-9pMo2feFjV7AoJzg,8791
 mlrun/frameworks/tf_keras/callbacks/tensorboard_logging_callback.py,sha256=YM7gNuryhioDrvVPBhpIUo9lH-bhE5JdE-xSo-kriP4,28728
 mlrun/frameworks/xgboost/__init__.py,sha256=2-q_HGIgwzZUoBpxMC5OBYpn29qh84HHwZpHRcOke_I,10287
 mlrun/frameworks/xgboost/mlrun_interface.py,sha256=JwbFkYz97gmkjLN1V_zu8nTG9zSey1RtUmUO6XfaZ54,878
 mlrun/frameworks/xgboost/model_handler.py,sha256=3KSLoL_uBBhRPkGEgRxJz1MPxQbcbvuIxJawQConfrQ,11617
 mlrun/frameworks/xgboost/utils.py,sha256=Yz7vIfnFMqa2A0k2GweXL912-tt7JnQdYsNX-pFs45I,1069
+mlrun/launcher/__init__.py,sha256=pZgS6ZN126aJme4z5spCX-RmdchShxMnQeCPya8AsQI,577
+mlrun/launcher/base.py,sha256=nlnLy2DRSjwmBdnyqgWAFFFv54YF9PPrGEIph7Z1ck8,15021
+mlrun/launcher/client.py,sha256=lwJYUeKizNn54O9uQt6VXX9sq15MiX-F6RdlnP7ydy8,4717
+mlrun/launcher/factory.py,sha256=Co7Y9WI9_CCbr5slKTVDbTV0uO4XQZ9ysC8d2YlTG94,1883
+mlrun/launcher/local.py,sha256=Y5VBwMqaqgUkG62_dFx4PcfOMrVYpHpdZxt3BDpzChw,10024
+mlrun/launcher/remote.py,sha256=mX35LvdvN8jycdf6Z8eW2ZVySZteMzWqUxzIQIR6wxc,6874
 mlrun/mlutils/__init__.py,sha256=enRhuXMjuev4xr-0l1zLxtoDp79FHc-HXbUoagYomvk,760
 mlrun/mlutils/data.py,sha256=uQ45eaKYx3Jy93l2TqosFW68Kj_ZtVI06ilxGxydaUY,5325
 mlrun/mlutils/models.py,sha256=_CijiNJkLnWdz0HU3DAU6P8TbobY7R2QVpuCOHTJD-4,2598
 mlrun/mlutils/plots.py,sha256=0-Rih6th9WkgzZRPIPZwz08lv4bVSX7YbyGNgA02xdA,30120
 mlrun/model_monitoring/__init__.py,sha256=YIUIQs1hwX-PWBu23dH-IY9gQYXW8HA0oFX3izaG9d0,1208
 mlrun/model_monitoring/features_drift_table.py,sha256=DlMkc-GwRhIALXB0OdCQkvOZQUVNI69RpJ1PAwLqK9Y,23948
 mlrun/model_monitoring/helpers.py,sha256=6e7yA4a3tErirdSCuC-BIH8OqISzkFcx-h9-5K38STU,9756
@@ -333,28 +341,28 @@
 mlrun/platforms/iguazio.py,sha256=qKglLKYVOJqlDG9JEZ9b1kOvrVmk5exey-2eh6ejfdw,24102
 mlrun/platforms/other.py,sha256=DwqbdbMNlkC2nEl1yJ0jF9WZJzjVu2IVPTC3bQ_W9Y0,11852
 mlrun/projects/__init__.py,sha256=dsXSDyqBhLi8OOfpdjLJpYOwC2fy_Q_Ki95Bk6gVSwc,1153
 mlrun/projects/operations.py,sha256=ifZGJidODXsnbJt7wG94upzkNOU24NQNhbivGWYTHRs,17480
 mlrun/projects/pipelines.py,sha256=MVYNxdubl0RiuILSY9z2v0fszngMYEtV81YJ_uQD8oE,38336
 mlrun/projects/project.py,sha256=wE5gDyWxJ5V6f5vPregix9qitvoMnKbidfHTnk-jWMQ,105214
 mlrun/runtimes/__init__.py,sha256=NpPeD7XxDNxmeOqLSEmb7tUN59cYZlvw-DnJxla_peE,8773
-mlrun/runtimes/base.py,sha256=MnAg7FHhIPgrPcD9uQCkr3me85xxQb9XBJ1tRKMtLT0,109329
+mlrun/runtimes/base.py,sha256=4T1NlQZnrMP5Ls9KxD812xkxNOXRdruxuMEA1PbZamQ,95055
 mlrun/runtimes/constants.py,sha256=Os_6YpWE8WMhigm1h3RKvn9Uo4LXNaEbA2xNSEDDEao,6689
 mlrun/runtimes/daskjob.py,sha256=4D0BCCRAb-JsLijZ_2LHzwGcZnxhyZ4gnst3HKENqQg,30520
-mlrun/runtimes/funcdoc.py,sha256=U5Hrkeo7i7CUnZFQ5g7-CyWMvXiQXPGrfsNdgsDAraQ,9190
+mlrun/runtimes/funcdoc.py,sha256=PAvbUFXLei7vFYPwlntJhnUgBqn38kMlaSbp_Y2Ice4,9561
 mlrun/runtimes/function.py,sha256=GH6XUVOAvnhARg_oV3BUyLEG5xaYZHtiwrBbZ2FwniE,45205
 mlrun/runtimes/function_reference.py,sha256=ikxeXeFPAn7PpfYR1DPBRFc9MSXXFM34uH5z6iRTz9M,4911
 mlrun/runtimes/generators.py,sha256=WvXzsfZZWqxLV1ncZ-lzFHZH2ITK6ICROgDv2vfQUs4,6530
-mlrun/runtimes/kubejob.py,sha256=I5GCsLM_e_Kv_T38s5WP8i0Ea-oHmrgI7k73XwqxTiA,15406
+mlrun/runtimes/kubejob.py,sha256=1uCJAvs0FLxfAag4BykZEMzyHrefVELnZ9ht_Ctbzv0,15140
 mlrun/runtimes/local.py,sha256=gsLkfQSbvt1DjDuO6_9tjZC4AxOGBAypR3qJQomPqIY,18005
 mlrun/runtimes/nuclio.py,sha256=ih2iwrJieeEom3iW0yU99QG4_u_Bdv7VWgs1CK4Q1P8,2885
 mlrun/runtimes/pod.py,sha256=QjOffy6atS5x7R96n8HP5pI6Rm24qyAYdJ4DdCb7Jvo,60644
 mlrun/runtimes/remotesparkjob.py,sha256=Lp2EN32GQ1rY_34MEepdUzRTg-AP-OKyUM7xcy0Npb8,7695
 mlrun/runtimes/serving.py,sha256=jruUAxwi9PVHY-mlZkljMD7P5WGyfbSS8pJmzDqQI9E,29858
-mlrun/runtimes/utils.py,sha256=3le7YiK4pJh_BhVf0p6yi1QVMz8BBEjz6pcLUh3bco8,21131
+mlrun/runtimes/utils.py,sha256=7RjhqZAfUnjnPk2shrR_pdpyaqu19q5ECCTmxJJv4MM,21222
 mlrun/runtimes/mpijob/__init__.py,sha256=E0oiOsSYsRBBR0HV6e_EGaL_j2_dYEJwAcICnF8mOYU,790
 mlrun/runtimes/mpijob/abstract.py,sha256=0BbIziHG5ITg3gNClLuBwL6-J4IXXPxjifppQciQwNU,14713
 mlrun/runtimes/mpijob/v1.py,sha256=o-ZDw3O0HOzTMZ3lI3gMjGG0NYY0Ux3RqL0Kz9K3eV4,13845
 mlrun/runtimes/mpijob/v1alpha1.py,sha256=4rMpJk1C_gL6QtOmEFcgcmaCkHcor9mdKvIL46fEKFw,8460
 mlrun/runtimes/package/__init__.py,sha256=EHFvxDWnRkXqjmdv9Mj3O-nCYAFLbRsNgX5zR0ElwAk,673
 mlrun/runtimes/package/context_handler.py,sha256=Z33-nbg4h545n1gGgCSrb-0LiFbRsisST6w44oba22I,27068
 mlrun/runtimes/sparkjob/__init__.py,sha256=7damn-nBbM0unppemEuVwZxCAGwXq7EzXECMJ9AaRPY,751
@@ -371,32 +379,32 @@
 mlrun/serving/v1_serving.py,sha256=UF6Ydgyo-DuHZ4DkrEdNMQl5oopVaZqm4EfBMBSvhDY,11814
 mlrun/serving/v2_serving.py,sha256=7g-FBPqyc8zgCY6Xi8SoS23VldDnOoL2G81m8qGbDOU,21460
 mlrun/utils/__init__.py,sha256=YnW6IErGUxc1mdd7a3eNvoYO_fy-mv4Uvu5Go8uT-kM,826
 mlrun/utils/async_http.py,sha256=AvI4a9D0frI6XxHvqnQ4AzEXopezo90zZHvsOAJJt6g,10397
 mlrun/utils/azure_vault.py,sha256=atz9fIu1vfgWAND1g6flRQDhrX-xBxZ_6MOWm34Onh0,3456
 mlrun/utils/clones.py,sha256=lKgQeibQ3xQ9LH5bZTZCoYCXoOx_2mYNGD5A-OOxwAQ,6245
 mlrun/utils/db.py,sha256=SqDrvIpGX_qHs0MNx_PWQNRcUhHaKLngoHFKLW3m5j0,1662
-mlrun/utils/helpers.py,sha256=ZqKUv-PKxN-rvApnPDNwhayEk0NjVpBDoOXD87x6DE8,42139
+mlrun/utils/helpers.py,sha256=yESXiZRPaDhwHN8RWtyF6GpfUyumInGm7GuxLOWwgZU,42577
 mlrun/utils/http.py,sha256=FVgdYV8Np3TKbqszEtXrlgwqNyjScTMLAjJhlsWLifo,7093
 mlrun/utils/logger.py,sha256=O4pH45kdz0cO-e4eKeRxbZUIRLGn2X0BJcjSY9cWB04,5637
 mlrun/utils/model_monitoring.py,sha256=1y-E4AlR-yZ1qW2yfxcHvm3rHZoytDz4IbIju8cPOOU,9969
 mlrun/utils/regex.py,sha256=3hSOVEU5128xio_3BLBEmvvRGLipmGP2Sh7XgVAYs8w,3954
 mlrun/utils/singleton.py,sha256=kV9HhbzdmXo8gGKBPdbHWspRDutlkKX1ZEn96xs_LRs,883
 mlrun/utils/v3io_clients.py,sha256=ekxhjfcUnjV8cejQYTQUHnhYOKHA4KekIdSaywydTdM,1319
 mlrun/utils/vault.py,sha256=EgxGAfn-mxRCj8cKEzSrrZQ9SV7BFP8mIuSnbhJpNUQ,10447
 mlrun/utils/notifications/__init__.py,sha256=CgWLxslSqhTH-tExi_UR4AT-ipjkGUF4gwf9mKcNua8,990
-mlrun/utils/notifications/notification_pusher.py,sha256=ZnbnyjCaJi1tEXcz7uEnU-6Xr85j18o6y_-wl3qKeK4,12336
+mlrun/utils/notifications/notification_pusher.py,sha256=fLNXJRuHeOeSMWro1rBs5Q91FIR5fJYCfWSKkGf6Mq0,12331
 mlrun/utils/notifications/notification/__init__.py,sha256=iNF31hiEkenkp1VmJ4keyjixS17-gZ0oGuWNO7tlnm4,1803
 mlrun/utils/notifications/notification/base.py,sha256=ddlf70Cd59bMvvWi2EFqzJQTXSRHw19E4r-oX2Tk8rk,2177
 mlrun/utils/notifications/notification/console.py,sha256=JggUV_Ql8lluvlONtkmQWk6SeSPY7gEhICAbkg0jYas,1971
 mlrun/utils/notifications/notification/git.py,sha256=gKBBb0_EZpv7PJFDi62hmxih9a8JoaU37i1IXUM46e0,4742
 mlrun/utils/notifications/notification/ipython.py,sha256=bYIUpzb2QnLPhacL8l20NU4suRjE0-lxeYYXpHuqiTw,2021
 mlrun/utils/notifications/notification/slack.py,sha256=hONSD43eLSxQ5n3x8HHqI-zhHc4ZxThR8lLcfkKoHfw,3751
 mlrun/utils/version/__init__.py,sha256=hwfJgGWYGWFpepVGI1GbuCPqqEFGRbgguJg5sC0v4TU,614
-mlrun/utils/version/version.json,sha256=g1cF_51H-rzgFAMgKwCcNdylz5Bu3P8A6rbN0ywgslY,88
+mlrun/utils/version/version.json,sha256=uKa3ZO97PJO8ws2Cs-8l3NrYZKMSGATLwSgIJqo9yi0,88
 mlrun/utils/version/version.py,sha256=O4Q4kwtKlI73oK7oBPuz4SVkUI8BC11E9DJIKHT91kU,1970
-mlrun-1.4.0rc3.dist-info/LICENSE,sha256=xx0jnfkXJvxRnG63LTGOxlggYnIysveWIZ6H3PNdCrQ,11357
-mlrun-1.4.0rc3.dist-info/METADATA,sha256=HHvrb-7kQP1Dtsyz7qDRpp-DLzYC-6DrJ_z9ZdRoZ4E,17185
-mlrun-1.4.0rc3.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
-mlrun-1.4.0rc3.dist-info/entry_points.txt,sha256=ZbXmb36B9JmK7EaleP8MIAbZSOQXQV0iwKR6si0HUWk,47
-mlrun-1.4.0rc3.dist-info/top_level.txt,sha256=NObLzw3maSF9wVrgSeYBv-fgnHkAJ1kEkh12DLdd5KM,6
-mlrun-1.4.0rc3.dist-info/RECORD,,
+mlrun-1.4.0rc4.dist-info/LICENSE,sha256=xx0jnfkXJvxRnG63LTGOxlggYnIysveWIZ6H3PNdCrQ,11357
+mlrun-1.4.0rc4.dist-info/METADATA,sha256=ABtxgiFOhZD8EQrrp-C-SMnA9kL1cnDKL1ZJ_fxNAI4,17185
+mlrun-1.4.0rc4.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
+mlrun-1.4.0rc4.dist-info/entry_points.txt,sha256=ZbXmb36B9JmK7EaleP8MIAbZSOQXQV0iwKR6si0HUWk,47
+mlrun-1.4.0rc4.dist-info/top_level.txt,sha256=NObLzw3maSF9wVrgSeYBv-fgnHkAJ1kEkh12DLdd5KM,6
+mlrun-1.4.0rc4.dist-info/RECORD,,
```

