# Comparing `tmp/crepes-0.3.0.tar.gz` & `tmp/crepes-0.4.0.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "crepes-0.3.0.tar", last modified: Thu May 11 12:50:32 2023, max compression
+gzip compressed data, was "crepes-0.4.0.tar", last modified: Tue May 16 12:40:28 2023, max compression
```

## Comparing `crepes-0.3.0.tar` & `crepes-0.4.0.tar`

### file list

```diff
@@ -1,18 +1,18 @@
-drwxrwxr-x   0 henke     (1000) henke     (1000)        0 2023-05-11 12:50:32.122882 crepes-0.3.0/
--rw-rw-r--   0 henke     (1000) henke     (1000)     1459 2023-05-08 10:22:43.000000 crepes-0.3.0/LICENSE
--rw-rw-r--   0 henke     (1000) henke     (1000)    15436 2023-05-11 12:50:32.122882 crepes-0.3.0/PKG-INFO
--rw-rw-r--   0 henke     (1000) henke     (1000)    14913 2023-05-11 08:30:12.000000 crepes-0.3.0/README.md
--rw-rw-r--   0 henke     (1000) henke     (1000)      106 2023-05-08 10:22:43.000000 crepes-0.3.0/pyproject.toml
--rw-rw-r--   0 henke     (1000) henke     (1000)       38 2023-05-11 12:50:32.122882 crepes-0.3.0/setup.cfg
--rw-rw-r--   0 henke     (1000) henke     (1000)      865 2023-05-08 14:28:34.000000 crepes-0.3.0/setup.py
-drwxrwxr-x   0 henke     (1000) henke     (1000)        0 2023-05-11 12:50:32.122882 crepes-0.3.0/src/
-drwxrwxr-x   0 henke     (1000) henke     (1000)        0 2023-05-11 12:50:32.122882 crepes-0.3.0/src/crepes/
--rw-rw-r--   0 henke     (1000) henke     (1000)      104 2023-05-08 10:22:43.000000 crepes-0.3.0/src/crepes/__init__.py
--rw-rw-r--   0 henke     (1000) henke     (1000)    42079 2023-05-10 08:30:26.000000 crepes-0.3.0/src/crepes/base.py
--rw-rw-r--   0 henke     (1000) henke     (1000)    17418 2023-05-11 08:59:22.000000 crepes-0.3.0/src/crepes/fillings.py
-drwxrwxr-x   0 henke     (1000) henke     (1000)        0 2023-05-11 12:50:32.122882 crepes-0.3.0/src/crepes.egg-info/
--rw-rw-r--   0 henke     (1000) henke     (1000)    15436 2023-05-11 12:50:32.000000 crepes-0.3.0/src/crepes.egg-info/PKG-INFO
--rw-rw-r--   0 henke     (1000) henke     (1000)      275 2023-05-11 12:50:32.000000 crepes-0.3.0/src/crepes.egg-info/SOURCES.txt
--rw-rw-r--   0 henke     (1000) henke     (1000)        1 2023-05-11 12:50:32.000000 crepes-0.3.0/src/crepes.egg-info/dependency_links.txt
--rw-rw-r--   0 henke     (1000) henke     (1000)       13 2023-05-11 12:50:32.000000 crepes-0.3.0/src/crepes.egg-info/requires.txt
--rw-rw-r--   0 henke     (1000) henke     (1000)        7 2023-05-11 12:50:32.000000 crepes-0.3.0/src/crepes.egg-info/top_level.txt
+drwxrwxr-x   0 henke     (1000) henke     (1000)        0 2023-05-16 12:40:28.687824 crepes-0.4.0/
+-rw-rw-r--   0 henke     (1000) henke     (1000)     1461 2023-05-12 13:21:30.000000 crepes-0.4.0/LICENSE
+-rw-rw-r--   0 henke     (1000) henke     (1000)    15107 2023-05-16 12:40:28.687824 crepes-0.4.0/PKG-INFO
+-rw-rw-r--   0 henke     (1000) henke     (1000)    14584 2023-05-16 09:48:40.000000 crepes-0.4.0/README.md
+-rw-rw-r--   0 henke     (1000) henke     (1000)      108 2023-05-12 13:21:30.000000 crepes-0.4.0/pyproject.toml
+-rw-rw-r--   0 henke     (1000) henke     (1000)       38 2023-05-16 12:40:28.687824 crepes-0.4.0/setup.cfg
+-rw-rw-r--   0 henke     (1000) henke     (1000)      865 2023-05-16 12:37:31.000000 crepes-0.4.0/setup.py
+drwxrwxr-x   0 henke     (1000) henke     (1000)        0 2023-05-16 12:40:28.683824 crepes-0.4.0/src/
+drwxrwxr-x   0 henke     (1000) henke     (1000)        0 2023-05-16 12:40:28.687824 crepes-0.4.0/src/crepes/
+-rw-rw-r--   0 henke     (1000) henke     (1000)      110 2023-05-15 07:33:52.000000 crepes-0.4.0/src/crepes/__init__.py
+-rw-rw-r--   0 henke     (1000) henke     (1000)    61611 2023-05-16 12:32:23.000000 crepes-0.4.0/src/crepes/base.py
+-rw-rw-r--   0 henke     (1000) henke     (1000)    17407 2023-05-15 19:17:30.000000 crepes-0.4.0/src/crepes/extras.py
+drwxrwxr-x   0 henke     (1000) henke     (1000)        0 2023-05-16 12:40:28.687824 crepes-0.4.0/src/crepes.egg-info/
+-rw-rw-r--   0 henke     (1000) henke     (1000)    15107 2023-05-16 12:40:28.000000 crepes-0.4.0/src/crepes.egg-info/PKG-INFO
+-rw-rw-r--   0 henke     (1000) henke     (1000)      273 2023-05-16 12:40:28.000000 crepes-0.4.0/src/crepes.egg-info/SOURCES.txt
+-rw-rw-r--   0 henke     (1000) henke     (1000)        1 2023-05-16 12:40:28.000000 crepes-0.4.0/src/crepes.egg-info/dependency_links.txt
+-rw-rw-r--   0 henke     (1000) henke     (1000)       13 2023-05-16 12:40:28.000000 crepes-0.4.0/src/crepes.egg-info/requires.txt
+-rw-rw-r--   0 henke     (1000) henke     (1000)        7 2023-05-16 12:40:28.000000 crepes-0.4.0/src/crepes.egg-info/top_level.txt
```

### Comparing `crepes-0.3.0/LICENSE` & `crepes-0.4.0/LICENSE`

 * *Files 1% similar despite different names*

```diff
@@ -1,11 +1,11 @@
 Copyright 2023 Henrik BostrÃ¶m
 
 Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:
-
+ 
 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
 
 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
 
 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.
 
-THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
+THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
```

### Comparing `crepes-0.3.0/PKG-INFO` & `crepes-0.4.0/PKG-INFO`

 * *Files 10% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 00000000: 4d65 7461 6461 7461 2d56 6572 7369 6f6e  Metadata-Version
 00000010: 3a20 322e 310a 4e61 6d65 3a20 6372 6570  : 2.1.Name: crep
-00000020: 6573 0a56 6572 7369 6f6e 3a20 302e 332e  es.Version: 0.3.
+00000020: 6573 0a56 6572 7369 6f6e 3a20 302e 342e  es.Version: 0.4.
 00000030: 300a 5375 6d6d 6172 793a 2043 6f6e 666f  0.Summary: Confo
 00000040: 726d 616c 2072 6567 7265 7373 6f72 7320  rmal regressors 
 00000050: 616e 6420 7072 6564 6963 7469 7665 2073  and predictive s
 00000060: 7973 7465 6d73 2028 6372 6570 6573 290a  ystems (crepes).
 00000070: 486f 6d65 2d70 6167 653a 2068 7474 7073  Home-page: https
 00000080: 3a2f 2f67 6974 6875 622e 636f 6d2f 6865  ://github.com/he
 00000090: 6e72 696b 626f 7374 726f 6d2f 6372 6570  nrikbostrom/crep
@@ -26,940 +26,920 @@
 00000190: 3a20 4f70 6572 6174 696e 6720 5379 7374  : Operating Syst
 000001a0: 656d 203a 3a20 4f53 2049 6e64 6570 656e  em :: OS Indepen
 000001b0: 6465 6e74 0a52 6571 7569 7265 732d 5079  dent.Requires-Py
 000001c0: 7468 6f6e 3a20 3e3d 332e 380a 4465 7363  thon: >=3.8.Desc
 000001d0: 7269 7074 696f 6e2d 436f 6e74 656e 742d  ription-Content-
 000001e0: 5479 7065 3a20 7465 7874 2f6d 6172 6b64  Type: text/markd
 000001f0: 6f77 6e0a 4c69 6365 6e73 652d 4669 6c65  own.License-File
-00000200: 3a20 4c49 4345 4e53 450a 0a23 2060 6372  : LICENSE..# `cr
-00000210: 6570 6573 600a 0a60 6372 6570 6573 6020  epes`..`crepes` 
-00000220: 6973 2061 2050 7974 686f 6e20 7061 636b  is a Python pack
-00000230: 6167 6520 666f 7220 6765 6e65 7261 7469  age for generati
-00000240: 6e67 202a 636f 6e66 6f72 6d61 6c20 7265  ng *conformal re
-00000250: 6772 6573 736f 7273 2a2c 2077 6869 6368  gressors*, which
-00000260: 2074 7261 6e73 666f 726d 2070 6f69 6e74   transform point
-00000270: 2070 7265 6469 6374 696f 6e73 206f 6620   predictions of 
-00000280: 616e 7920 756e 6465 726c 7969 6e67 2072  any underlying r
-00000290: 6567 7265 7373 696f 6e20 6d6f 6465 6c20  egression model 
-000002a0: 696e 746f 2070 7265 6469 6374 696f 6e20  into prediction 
-000002b0: 696e 7465 7276 616c 7320 666f 7220 7370  intervals for sp
-000002c0: 6563 6966 6965 6420 6c65 7665 6c73 206f  ecified levels o
-000002d0: 6620 636f 6e66 6964 656e 6365 2e20 5468  f confidence. Th
-000002e0: 6520 7061 636b 6167 6520 616c 736f 2069  e package also i
-000002f0: 6d70 6c65 6d65 6e74 7320 2a63 6f6e 666f  mplements *confo
-00000300: 726d 616c 2070 7265 6469 6374 6976 6520  rmal predictive 
-00000310: 7379 7374 656d 732a 2c20 7768 6963 6820  systems*, which 
-00000320: 7472 616e 7366 6f72 6d20 7468 6520 706f  transform the po
-00000330: 696e 7420 7072 6564 6963 7469 6f6e 7320  int predictions 
-00000340: 696e 746f 2063 756d 756c 6174 6976 6520  into cumulative 
-00000350: 6469 7374 7269 6275 7469 6f6e 2066 756e  distribution fun
-00000360: 6374 696f 6e73 2e0a 0a54 6865 2060 6372  ctions...The `cr
-00000370: 6570 6573 6020 7061 636b 6167 6520 696d  epes` package im
-00000380: 706c 656d 656e 7473 2073 7461 6e64 6172  plements standar
-00000390: 642c 206e 6f72 6d61 6c69 7a65 6420 616e  d, normalized an
-000003a0: 6420 4d6f 6e64 7269 616e 2063 6f6e 666f  d Mondrian confo
-000003b0: 726d 616c 2072 6567 7265 7373 6f72 7320  rmal regressors 
-000003c0: 616e 6420 7072 6564 6963 7469 7665 2073  and predictive s
-000003d0: 7973 7465 6d73 2e20 5768 696c 6520 7468  ystems. While th
-000003e0: 6520 7061 636b 6167 6520 616c 6c6f 7773  e package allows
-000003f0: 2079 6f75 2074 6f20 7573 6520 796f 7572   you to use your
-00000400: 206f 776e 2064 6966 6669 6375 6c74 7920   own difficulty 
-00000410: 6573 7469 6d61 7465 7320 616e 6420 4d6f  estimates and Mo
-00000420: 6e64 7269 616e 2063 6174 6567 6f72 6965  ndrian categorie
-00000430: 732c 2074 6865 7265 2069 7320 616c 736f  s, there is also
-00000440: 2061 2073 6570 6172 6174 6520 6d6f 6475   a separate modu
-00000450: 6c65 2c20 6361 6c6c 6564 2060 6372 6570  le, called `crep
-00000460: 6573 2e66 696c 6c69 6e67 7360 2c20 7768  es.fillings`, wh
-00000470: 6963 6820 7072 6f76 6964 6573 2073 6f6d  ich provides som
-00000480: 6520 7374 616e 6461 7264 206f 7074 696f  e standard optio
-00000490: 6e73 2066 6f72 2074 6865 7365 2e0a 0a23  ns for these...#
-000004a0: 2320 496e 7374 616c 6c61 7469 6f6e 0a0a  # Installation..
-000004b0: 4672 6f6d 205b 5079 5049 5d28 6874 7470  From [PyPI](http
-000004c0: 733a 2f2f 7079 7069 2e6f 7267 2f70 726f  s://pypi.org/pro
-000004d0: 6a65 6374 2f63 7265 7065 732f 290a 0a60  ject/crepes/)..`
-000004e0: 6060 6261 7368 0a70 6970 2069 6e73 7461  ``bash.pip insta
-000004f0: 6c6c 2063 7265 7065 730a 6060 600a 0a46  ll crepes.```..F
-00000500: 726f 6d20 5b63 6f6e 6461 2d66 6f72 6765  rom [conda-forge
-00000510: 5d28 6874 7470 733a 2f2f 616e 6163 6f6e  ](https://anacon
+00000200: 3a20 4c49 4345 4e53 450a 0a3c 7020 616c  : LICENSE..<p al
+00000210: 6967 6e3d 2263 656e 7465 7222 3e3c 6120  ign="center"><a 
+00000220: 6872 6566 3d22 6874 7470 733a 2f2f 6372  href="https://cr
+00000230: 6570 6573 2e72 6561 6474 6865 646f 6373  epes.readthedocs
+00000240: 2e69 6f22 3e3c 696d 6720 616c 743d 2263  .io"><img alt="c
+00000250: 7265 7065 7322 2073 7263 3d22 6874 7470  repes" src="http
+00000260: 733a 2f2f 6769 7468 7562 2d70 726f 6475  s://github-produ
+00000270: 6374 696f 6e2d 7573 6572 2d61 7373 6574  ction-user-asset
+00000280: 2d36 3231 3064 662e 7333 2e61 6d61 7a6f  -6210df.s3.amazo
+00000290: 6e61 7773 2e63 6f6d 2f37 3833 3837 3431  naws.com/7838741
+000002a0: 2f32 3337 3935 3037 3732 2d31 6434 3438  /237950772-1d448
+000002b0: 3762 312d 3766 3433 2d34 6365 302d 3964  7b1-7f43-4ce0-9d
+000002c0: 6230 2d30 3332 6261 6564 6462 6563 652e  b0-032baeddbece.
+000002d0: 706e 6722 3e3c 2f61 3e3c 2f70 3e0a 0a3c  png"></a></p>..<
+000002e0: 7020 616c 6967 6e3d 2263 656e 7465 7222  p align="center"
+000002f0: 3e0a 3c61 2068 7265 663d 2268 7474 7073  >.<a href="https
+00000300: 3a2f 2f70 7970 692e 6f72 672f 7072 6f6a  ://pypi.org/proj
+00000310: 6563 742f 6372 6570 6573 2f22 3e3c 696d  ect/crepes/"><im
+00000320: 6720 7372 633d 2268 7474 7073 3a2f 2f62  g src="https://b
+00000330: 6164 6765 2e66 7572 792e 696f 2f70 792f  adge.fury.io/py/
+00000340: 6372 6570 6573 2e73 7667 2220 616c 743d  crepes.svg" alt=
+00000350: 2250 7950 4920 7665 7273 696f 6e22 2068  "PyPI version" h
+00000360: 6569 6768 743d 3230 2061 6c69 676e 3d22  eight=20 align="
+00000370: 6365 6e74 6572 223e 3c2f 613e 0a3c 6120  center"></a>.<a 
+00000380: 6872 6566 3d22 6874 7470 733a 2f2f 616e  href="https://an
+00000390: 6163 6f6e 6461 2e6f 7267 2f63 6f6e 6461  aconda.org/conda
+000003a0: 2d66 6f72 6765 2f63 7265 7065 7322 3e3c  -forge/crepes"><
+000003b0: 696d 6720 7372 633d 2268 7474 7073 3a2f  img src="https:/
+000003c0: 2f61 6e61 636f 6e64 612e 6f72 672f 636f  /anaconda.org/co
+000003d0: 6e64 612d 666f 7267 652f 6372 6570 6573  nda-forge/crepes
+000003e0: 2f62 6164 6765 732f 7665 7273 696f 6e2e  /badges/version.
+000003f0: 7376 6722 2061 6c74 3d22 416e 6163 6f6e  svg" alt="Anacon
+00000400: 6461 2076 6572 7369 6f6e 2220 6865 6967  da version" heig
+00000410: 6874 3d32 3020 616c 6967 6e3d 2263 656e  ht=20 align="cen
+00000420: 7465 7222 3e3c 2f61 3e0a 3c61 2068 7265  ter"></a>.<a hre
+00000430: 663d 2268 7474 7073 3a2f 2f63 7265 7065  f="https://crepe
+00000440: 732e 7265 6164 7468 6564 6f63 732e 696f  s.readthedocs.io
+00000450: 2f65 6e2f 6c61 7465 7374 223e 3c69 6d67  /en/latest"><img
+00000460: 2073 7263 3d22 6874 7470 733a 2f2f 7265   src="https://re
+00000470: 6164 7468 6564 6f63 732e 6f72 672f 7072  adthedocs.org/pr
+00000480: 6f6a 6563 7473 2f63 7265 7065 732f 6261  ojects/crepes/ba
+00000490: 6467 652f 3f76 6572 7369 6f6e 3d6c 6174  dge/?version=lat
+000004a0: 6573 7422 2061 6c74 3d22 646f 6373 2073  est" alt="docs s
+000004b0: 7461 7475 7322 2068 6569 6768 743d 3230  tatus" height=20
+000004c0: 2061 6c69 676e 3d22 6365 6e74 6572 223e   align="center">
+000004d0: 3c2f 613e 200a 3c61 2068 7265 663d 2268  </a> .<a href="h
+000004e0: 7474 7073 3a2f 2f61 6e61 636f 6e64 612e  ttps://anaconda.
+000004f0: 6f72 672f 636f 6e64 612d 666f 7267 652f  org/conda-forge/
+00000500: 6372 6570 6573 223e 3c69 6d67 2073 7263  crepes"><img src
+00000510: 3d22 6874 7470 733a 2f2f 616e 6163 6f6e  ="https://anacon
 00000520: 6461 2e6f 7267 2f63 6f6e 6461 2d66 6f72  da.org/conda-for
-00000530: 6765 2f63 7265 7065 7329 0a0a 6060 6062  ge/crepes)..```b
-00000540: 6173 680a 636f 6e64 6120 696e 7374 616c  ash.conda instal
-00000550: 6c20 2d63 2063 6f6e 6461 2d66 6f72 6765  l -c conda-forge
-00000560: 2063 7265 7065 730a 6060 600a 0a23 2320   crepes.```..## 
-00000570: 446f 6375 6d65 6e74 6174 696f 6e0a 0a46  Documentation..F
-00000580: 6f72 2063 6f6d 706c 6574 6520 646f 6375  or complete docu
-00000590: 6d65 6e74 6174 696f 6e20 6f66 2074 6865  mentation of the
-000005a0: 2060 6372 6570 6573 6020 7061 636b 6167   `crepes` packag
-000005b0: 652c 2073 6565 205b 6865 7265 5d28 6874  e, see [here](ht
-000005c0: 7470 733a 2f2f 6372 6570 6573 2e72 6561  tps://crepes.rea
-000005d0: 6474 6865 646f 6373 2e69 6f2f 656e 2f6c  dthedocs.io/en/l
-000005e0: 6174 6573 742f 292e 0a0a 2323 2051 7569  atest/)...## Qui
-000005f0: 636b 7374 6172 740a 0a23 2323 2043 6f6e  ckstart..### Con
-00000600: 666f 726d 616c 2072 6567 7265 7373 6f72  formal regressor
-00000610: 730a 0a57 6520 6669 7273 7420 696d 706f  s..We first impo
-00000620: 7274 2074 6865 206d 6169 6e20 636c 6173  rt the main clas
-00000630: 7320 6672 6f6d 2060 6372 6570 6573 6020  s from `crepes` 
-00000640: 616e 6420 6120 6865 6c70 6572 2063 6c61  and a helper cla
-00000650: 7373 2061 6e64 2066 756e 6374 696f 6e20  ss and function 
-00000660: 6672 6f6d 2060 6372 6570 6573 2e66 696c  from `crepes.fil
-00000670: 6c69 6e67 7360 3a0a 0a60 6060 7079 7468  lings`:..```pyth
-00000680: 6f6e 0a66 726f 6d20 6372 6570 6573 2069  on.from crepes i
-00000690: 6d70 6f72 7420 436f 6e66 6f72 6d61 6c52  mport ConformalR
-000006a0: 6567 7265 7373 6f72 0a66 726f 6d20 6372  egressor.from cr
-000006b0: 6570 6573 2e66 696c 6c69 6e67 7320 696d  epes.fillings im
-000006c0: 706f 7274 2044 6966 6669 6375 6c74 7945  port DifficultyE
-000006d0: 7374 696d 6174 6f72 2c20 6269 6e6e 696e  stimator, binnin
-000006e0: 670a 6060 600a 0a57 6520 7769 6c6c 2069  g.```..We will i
-000006f0: 6c6c 7573 7472 6174 6520 7468 6520 6162  llustrate the ab
-00000700: 6f76 6520 7573 696e 6720 6120 6461 7461  ove using a data
-00000710: 7365 7420 6672 6f6d 205b 7777 772e 6f70  set from [www.op
-00000720: 656e 6d6c 2e6f 7267 5d28 6874 7470 733a  enml.org](https:
-00000730: 2f2f 7777 772e 6f70 656e 6d6c 2e6f 7267  //www.openml.org
-00000740: 2920 616e 6420 6120 6052 616e 646f 6d46  ) and a `RandomF
-00000750: 6f72 6573 7452 6567 7265 7373 6f72 6020  orestRegressor` 
-00000760: 6672 6f6d 205b 736b 6c65 6172 6e5d 2868  from [sklearn](h
-00000770: 7474 7073 3a2f 2f73 6369 6b69 742d 6c65  ttps://scikit-le
-00000780: 6172 6e2e 6f72 6729 3a0a 0a60 6060 7079  arn.org):..```py
-00000790: 7468 6f6e 0a66 726f 6d20 736b 6c65 6172  thon.from sklear
-000007a0: 6e2e 6461 7461 7365 7473 2069 6d70 6f72  n.datasets impor
-000007b0: 7420 6665 7463 685f 6f70 656e 6d6c 0a66  t fetch_openml.f
-000007c0: 726f 6d20 736b 6c65 6172 6e2e 6d6f 6465  rom sklearn.mode
-000007d0: 6c5f 7365 6c65 6374 696f 6e20 696d 706f  l_selection impo
-000007e0: 7274 2074 7261 696e 5f74 6573 745f 7370  rt train_test_sp
-000007f0: 6c69 740a 6672 6f6d 2073 6b6c 6561 726e  lit.from sklearn
-00000800: 2e65 6e73 656d 626c 6520 696d 706f 7274  .ensemble import
-00000810: 2052 616e 646f 6d46 6f72 6573 7452 6567   RandomForestReg
-00000820: 7265 7373 6f72 0a0a 6461 7461 7365 7420  ressor..dataset 
-00000830: 3d20 6665 7463 685f 6f70 656e 6d6c 286e  = fetch_openml(n
-00000840: 616d 653d 2268 6f75 7365 5f73 616c 6573  ame="house_sales
-00000850: 222c 2076 6572 7369 6f6e 3d33 290a 5820  ", version=3).X 
-00000860: 3d20 6461 7461 7365 742e 6461 7461 2e76  = dataset.data.v
-00000870: 616c 7565 732e 6173 7479 7065 2866 6c6f  alues.astype(flo
-00000880: 6174 290a 7920 3d20 6461 7461 7365 742e  at).y = dataset.
-00000890: 7461 7267 6574 2e76 616c 7565 732e 6173  target.values.as
-000008a0: 7479 7065 2866 6c6f 6174 290a 6060 600a  type(float).```.
-000008b0: 0a57 6520 6e6f 7720 6669 7273 7420 7370  .We now first sp
-000008c0: 6c69 7420 7468 6520 6461 7461 7365 7420  lit the dataset 
-000008d0: 696e 746f 2061 2074 7261 696e 696e 6720  into a training 
-000008e0: 616e 6420 6120 7465 7374 2073 6574 2c20  and a test set, 
-000008f0: 616e 6420 7468 656e 2066 7572 7468 6572  and then further
-00000900: 2073 706c 6974 2074 6865 2074 7261 696e   split the train
-00000910: 696e 6720 7365 7420 696e 746f 2061 2070  ing set into a p
-00000920: 726f 7065 7220 7472 6169 6e69 6e67 2073  roper training s
-00000930: 6574 2061 6e64 2061 2063 616c 6962 7261  et and a calibra
-00000940: 7469 6f6e 2073 6574 2e20 4669 6e61 6c6c  tion set. Finall
-00000950: 792c 2077 6520 6669 7420 6120 7261 6e64  y, we fit a rand
-00000960: 6f6d 2066 6f72 6573 7420 746f 2074 6865  om forest to the
-00000970: 2070 726f 7065 7220 7472 6169 6e69 6e67   proper training
-00000980: 2073 6574 2061 6e64 2061 7070 6c79 2069   set and apply i
-00000990: 7420 746f 206f 6274 6169 6e20 706f 696e  t to obtain poin
-000009a0: 7420 7072 6564 6963 7469 6f6e 7320 666f  t predictions fo
-000009b0: 7220 7468 6520 7465 7374 2073 6574 2028  r the test set (
-000009c0: 6e6f 7468 696e 6720 6e65 7720 6865 7265  nothing new here
-000009d0: 292e 0a0a 6060 6070 7974 686f 6e0a 585f  )...```python.X_
-000009e0: 7472 6169 6e2c 2058 5f74 6573 742c 2079  train, X_test, y
-000009f0: 5f74 7261 696e 2c20 795f 7465 7374 203d  _train, y_test =
-00000a00: 2074 7261 696e 5f74 6573 745f 7370 6c69   train_test_spli
-00000a10: 7428 582c 2079 2c20 7465 7374 5f73 697a  t(X, y, test_siz
-00000a20: 653d 302e 3529 0a58 5f70 726f 705f 7472  e=0.5).X_prop_tr
-00000a30: 6169 6e2c 2058 5f63 616c 2c20 795f 7072  ain, X_cal, y_pr
-00000a40: 6f70 5f74 7261 696e 2c20 795f 6361 6c20  op_train, y_cal 
-00000a50: 3d20 7472 6169 6e5f 7465 7374 5f73 706c  = train_test_spl
-00000a60: 6974 2858 5f74 7261 696e 2c20 795f 7472  it(X_train, y_tr
-00000a70: 6169 6e2c 0a20 2020 2020 2020 2020 2020  ain,.           
-00000a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000ab0: 2074 6573 745f 7369 7a65 3d30 2e32 3529   test_size=0.25)
-00000ac0: 0a0a 6c65 6172 6e65 7220 3d20 5261 6e64  ..learner = Rand
-00000ad0: 6f6d 466f 7265 7374 5265 6772 6573 736f  omForestRegresso
-00000ae0: 7228 2920 0a6c 6561 726e 6572 2e66 6974  r() .learner.fit
-00000af0: 2858 5f70 726f 705f 7472 6169 6e2c 2079  (X_prop_train, y
-00000b00: 5f70 726f 705f 7472 6169 6e29 0a79 5f68  _prop_train).y_h
-00000b10: 6174 5f74 6573 7420 3d20 6c65 6172 6e65  at_test = learne
-00000b20: 722e 7072 6564 6963 7428 585f 7465 7374  r.predict(X_test
-00000b30: 290a 6060 600a 0a4e 6f77 2c20 7765 2077  ).```..Now, we w
-00000b40: 696c 6c20 6d61 6b65 2075 7365 206f 6620  ill make use of 
-00000b50: 7468 6520 6361 6c69 6272 6174 696f 6e20  the calibration 
-00000b60: 7365 742e 2057 6520 6170 706c 7920 7468  set. We apply th
-00000b70: 6520 6d6f 6465 6c20 616c 736f 2074 6f20  e model also to 
-00000b80: 7468 6520 6361 6c69 6272 6174 696f 6e20  the calibration 
-00000b90: 6f62 6a65 6374 7320 616e 6420 6361 6c63  objects and calc
-00000ba0: 756c 6174 6520 7468 6520 7265 7369 6475  ulate the residu
-00000bb0: 616c 732e 0a60 6060 7079 7468 6f6e 0a79  als..```python.y
-00000bc0: 5f68 6174 5f63 616c 203d 206c 6561 726e  _hat_cal = learn
-00000bd0: 6572 2e70 7265 6469 6374 2858 5f63 616c  er.predict(X_cal
-00000be0: 290a 7265 7369 6475 616c 735f 6361 6c20  ).residuals_cal 
-00000bf0: 3d20 795f 6361 6c20 2d20 795f 6861 745f  = y_cal - y_hat_
-00000c00: 6361 6c0a 6060 600a 0a54 6865 206c 6174  cal.```..The lat
-00000c10: 7465 7220 6973 206a 7573 7420 7768 6174  ter is just what
-00000c20: 2077 6520 6e65 6564 2074 6f20 6669 7420   we need to fit 
-00000c30: 6120 7374 616e 6461 7264 2063 6f6e 666f  a standard confo
-00000c40: 726d 616c 2072 6567 7265 7373 6f72 3a0a  rmal regressor:.
-00000c50: 6060 6070 7974 686f 6e0a 6372 5f73 7464  ```python.cr_std
-00000c60: 203d 2043 6f6e 666f 726d 616c 5265 6772   = ConformalRegr
-00000c70: 6573 736f 7228 290a 6372 5f73 7464 2e66  essor().cr_std.f
-00000c80: 6974 2872 6573 6964 7561 6c73 3d72 6573  it(residuals=res
-00000c90: 6964 7561 6c73 5f63 616c 290a 6060 600a  iduals_cal).```.
-00000ca0: 0a57 6520 6361 6e20 6e6f 7720 6170 706c  .We can now appl
-00000cb0: 7920 7468 6520 636f 6e66 6f72 6d61 6c20  y the conformal 
-00000cc0: 7265 6772 6573 736f 7220 746f 2067 6574  regressor to get
-00000cd0: 2070 7265 6469 6374 696f 6e20 696e 7465   prediction inte
-00000ce0: 7276 616c 7320 666f 7220 7468 6520 7465  rvals for the te
-00000cf0: 7374 206f 626a 6563 7473 2c20 7573 696e  st objects, usin
-00000d00: 6720 7468 6520 706f 696e 7420 7072 6564  g the point pred
-00000d10: 6963 7469 6f6e 7320 6173 2069 6e70 7574  ictions as input
-00000d20: 2c20 7768 6572 6520 7468 6520 7072 6f62  , where the prob
-00000d30: 6162 696c 6974 7920 6f66 206e 6f74 2069  ability of not i
-00000d40: 6e63 6c75 6469 6e67 2074 6865 2063 6f72  ncluding the cor
-00000d50: 7265 6374 2074 6172 6765 7420 696e 2061  rect target in a
-00000d60: 6e20 696e 7465 7276 616c 2069 7320 312d  n interval is 1-
-00000d70: 636f 6e66 6964 656e 6365 3a0a 6060 6070  confidence:.```p
-00000d80: 7974 686f 6e0a 7374 645f 696e 7465 7276  ython.std_interv
-00000d90: 616c 7320 3d20 6372 5f73 7464 2e70 7265  als = cr_std.pre
-00000da0: 6469 6374 2879 5f68 6174 3d79 5f68 6174  dict(y_hat=y_hat
-00000db0: 5f74 6573 742c 2063 6f6e 6669 6465 6e63  _test, confidenc
-00000dc0: 653d 302e 3939 290a 6060 600a 0a54 6865  e=0.99).```..The
-00000dd0: 206f 7574 7075 7420 6973 2061 205b 4e75   output is a [Nu
-00000de0: 6d50 795d 2868 7474 7073 3a2f 2f6e 756d  mPy](https://num
-00000df0: 7079 2e6f 7267 2920 6172 7261 792c 2073  py.org) array, s
-00000e00: 7065 6369 6679 696e 6720 7468 6520 6c6f  pecifying the lo
-00000e10: 7765 7220 616e 6420 7570 7065 7220 626f  wer and upper bo
-00000e20: 756e 6420 6f66 2065 6163 6820 696e 7465  und of each inte
-00000e30: 7276 616c 3a0a 0a60 6060 6e75 6d70 790a  rval:..```numpy.
-00000e40: 6172 7261 7928 5b5b 2d31 3731 3930 322e  array([[-171902.
-00000e50: 3220 2c20 2039 3533 3836 362e 3220 5d2c  2 ,  953866.2 ],
-00000e60: 0a20 2020 2020 2020 5b2d 3237 3638 3138  .       [-276818
-00000e70: 2e30 312c 2020 3834 3839 3530 2e33 395d  .01,  848950.39]
-00000e80: 2c0a 2020 2020 2020 205b 2020 3232 3637  ,.       [  2267
-00000e90: 392e 3337 2c20 3131 3438 3434 372e 3737  9.37, 1148447.77
-00000ea0: 5d2c 0a20 2020 2020 2020 2e2e 2e2c 0a20  ],.       ...,. 
-00000eb0: 2020 2020 2020 5b20 3234 3239 3534 2e30        [ 242954.0
-00000ec0: 322c 2031 3336 3837 3232 2e34 325d 2c0a  2, 1368722.42],.
-00000ed0: 2020 2020 2020 205b 2d33 3038 3039 332e         [-308093.
-00000ee0: 3733 2c20 2038 3137 3637 342e 3637 5d2c  73,  817674.67],
-00000ef0: 0a20 2020 2020 2020 5b2d 3232 3730 3537  .       [-227057
-00000f00: 2e34 202c 2020 3839 3837 3131 2e20 205d  .4 ,  898711.  ]
-00000f10: 5d29 0a60 6060 0a0a 5765 206d 6179 2072  ]).```..We may r
-00000f20: 6571 7565 7374 2074 6861 7420 7468 6520  equest that the 
-00000f30: 696e 7465 7276 616c 7320 6172 6520 6375  intervals are cu
-00000f40: 7420 746f 2065 7863 6c75 6465 2069 6d70  t to exclude imp
-00000f50: 6f73 7369 626c 6520 7661 6c75 6573 2c20  ossible values, 
-00000f60: 696e 2074 6869 7320 6361 7365 2062 656c  in this case bel
-00000f70: 6f77 2030 2c20 616e 6420 6966 2077 6520  ow 0, and if we 
-00000f80: 616c 736f 2072 656c 7920 6f6e 2074 6865  also rely on the
-00000f90: 2064 6566 6175 6c74 2063 6f6e 6669 6465   default confide
-00000fa0: 6e63 6520 6c65 7665 6c20 2830 2e39 3529  nce level (0.95)
-00000fb0: 2c20 7468 6520 6f75 7470 7574 2069 6e74  , the output int
-00000fc0: 6572 7661 6c73 2077 696c 6c20 6265 2061  ervals will be a
-00000fd0: 2062 6974 2074 6967 6874 6572 3a0a 0a60   bit tighter:..`
-00000fe0: 6060 7079 7468 6f6e 0a69 6e74 6572 7661  ``python.interva
-00000ff0: 6c73 5f73 7464 203d 2063 725f 7374 642e  ls_std = cr_std.
-00001000: 7072 6564 6963 7428 795f 6861 743d 795f  predict(y_hat=y_
-00001010: 6861 745f 7465 7374 2c20 795f 6d69 6e3d  hat_test, y_min=
-00001020: 3029 0a60 6060 0a0a 6060 606e 756d 7079  0).```..```numpy
-00001030: 0a61 7272 6179 285b 5b20 3135 3232 3538  .array([[ 152258
-00001040: 2e35 352c 2020 3632 3937 3035 2e34 355d  .55,  629705.45]
-00001050: 2c0a 2020 2020 2020 205b 2020 3437 3334  ,.       [  4734
-00001060: 322e 3734 2c20 2035 3234 3738 392e 3634  2.74,  524789.64
-00001070: 5d2c 0a20 2020 2020 2020 5b20 3334 3638  ],.       [ 3468
-00001080: 3430 2e31 322c 2020 3832 3432 3837 2e30  40.12,  824287.0
-00001090: 325d 2c0a 2020 2020 2020 202e 2e2e 2c0a  2],.       ...,.
-000010a0: 2020 2020 2020 205b 2035 3637 3131 342e         [ 567114.
-000010b0: 3737 2c20 3130 3434 3536 312e 3637 5d2c  77, 1044561.67],
-000010c0: 0a20 2020 2020 2020 5b20 2031 3630 3637  .       [  16067
-000010d0: 2e30 322c 2020 3439 3335 3133 2e39 325d  .02,  493513.92]
-000010e0: 2c0a 2020 2020 2020 205b 2020 3937 3130  ,.       [  9710
-000010f0: 332e 3335 2c20 2035 3734 3535 302e 3235  3.35,  574550.25
-00001100: 5d5d 290a 6060 600a 0a54 6865 2061 626f  ]]).```..The abo
-00001110: 7665 2069 6e74 6572 7661 6c73 2061 7265  ve intervals are
-00001120: 206e 6f74 206e 6f72 6d61 6c69 7a65 642c   not normalized,
-00001130: 2069 2e65 2e2c 2074 6865 7920 6172 6520   i.e., they are 
-00001140: 616c 6c20 6f66 2074 6865 2073 616d 6520  all of the same 
-00001150: 7369 7a65 2028 6174 206c 6561 7374 2062  size (at least b
-00001160: 6566 6f72 6520 7468 6579 2061 7265 2063  efore they are c
-00001170: 7574 292e 2057 6520 636f 756c 6420 6d61  ut). We could ma
-00001180: 6b65 2074 6865 2069 6e74 6572 7661 6c73  ke the intervals
-00001190: 206d 6f72 6520 696e 666f 726d 6174 6976   more informativ
-000011a0: 6520 7468 726f 7567 6820 6e6f 726d 616c  e through normal
-000011b0: 697a 6174 696f 6e20 7573 696e 6720 6469  ization using di
-000011c0: 6666 6963 756c 7479 2065 7374 696d 6174  fficulty estimat
-000011d0: 6573 3b20 6d6f 7265 2064 6966 6669 6375  es; more difficu
-000011e0: 6c74 2069 6e73 7461 6e63 6573 2077 696c  lt instances wil
-000011f0: 6c20 6265 2061 7373 6967 6e65 6420 7769  l be assigned wi
-00001200: 6465 7220 696e 7465 7276 616c 732e 0a0a  der intervals...
-00001210: 5765 2077 696c 6c20 7573 6520 6120 6044  We will use a `D
-00001220: 6966 6669 6375 6c74 7945 7374 696d 6174  ifficultyEstimat
-00001230: 6f72 6020 666f 7220 7468 6973 2070 7572  or` for this pur
-00001240: 706f 7365 2e20 4865 7265 2069 7420 6573  pose. Here it es
-00001250: 7469 6d61 7465 7320 7468 6520 6469 6666  timates the diff
-00001260: 6963 756c 7479 2062 7920 7468 6520 7374  iculty by the st
-00001270: 616e 6461 7264 2064 6576 6961 7469 6f6e  andard deviation
-00001280: 206f 6620 7468 6520 7461 7267 6574 206f   of the target o
-00001290: 6620 7468 6520 6b20 2864 6566 6175 6c74  f the k (default
-000012a0: 2060 6b3d 3235 6029 206e 6561 7265 7374   `k=25`) nearest
-000012b0: 206e 6569 6768 626f 7273 2069 6e20 7468   neighbors in th
-000012c0: 6520 7072 6f70 6572 2074 7261 696e 696e  e proper trainin
-000012d0: 6720 7365 7420 746f 2065 6163 6820 696e  g set to each in
-000012e0: 7374 616e 6365 2069 6e20 7468 6520 6361  stance in the ca
-000012f0: 6c69 6272 6174 696f 6e20 7365 742e 2041  libration set. A
-00001300: 2073 6d61 6c6c 2076 616c 7565 2028 6265   small value (be
-00001310: 7461 2920 6973 2061 6464 6564 2074 6f20  ta) is added to 
-00001320: 7468 6520 6573 7469 6d61 7465 732c 2077  the estimates, w
-00001330: 6869 6368 206d 6179 2062 6520 6769 7665  hich may be give
-00001340: 6e20 7468 726f 7567 6820 616e 2061 7267  n through an arg
-00001350: 756d 656e 7420 746f 2074 6865 2066 756e  ument to the fun
-00001360: 6374 696f 6e3b 2062 656c 6f77 2077 6520  ction; below we 
-00001370: 6a75 7374 2075 7365 2074 6865 2064 6566  just use the def
-00001380: 6175 6c74 2c20 692e 652e 2c20 6062 6574  ault, i.e., `bet
-00001390: 613d 302e 3031 602e 0a0a 6060 6070 7974  a=0.01`...```pyt
-000013a0: 686f 6e0a 6465 203d 2044 6966 6669 6375  hon.de = Difficu
-000013b0: 6c74 7945 7374 696d 6174 6f72 2829 0a64  ltyEstimator().d
-000013c0: 652e 6669 7428 585f 7072 6f70 5f74 7261  e.fit(X_prop_tra
-000013d0: 696e 2c20 793d 795f 7072 6f70 5f74 7261  in, y=y_prop_tra
-000013e0: 696e 290a 0a73 6967 6d61 735f 6361 6c20  in)..sigmas_cal 
-000013f0: 3d20 6465 2e61 7070 6c79 2858 5f63 616c  = de.apply(X_cal
-00001400: 290a 6060 600a 0a54 6865 2064 6966 6669  ).```..The diffi
-00001410: 6375 6c74 7920 6573 7469 6d61 7465 7320  culty estimates 
-00001420: 616e 6420 7265 7369 6475 616c 7320 6f66  and residuals of
-00001430: 2074 6865 2063 616c 6962 7261 7469 6f6e   the calibration
-00001440: 2065 7861 6d70 6c65 7320 6361 6e20 6e6f   examples can no
-00001450: 7720 6265 2075 7365 6420 746f 2066 6f72  w be used to for
-00001460: 6d20 6120 6e6f 726d 616c 697a 6564 2063  m a normalized c
-00001470: 6f6e 666f 726d 616c 2072 6567 7265 7373  onformal regress
-00001480: 6f72 3a0a 0a60 6060 7079 7468 6f6e 0a63  or:..```python.c
-00001490: 725f 6e6f 726d 203d 2043 6f6e 666f 726d  r_norm = Conform
-000014a0: 616c 5265 6772 6573 736f 7228 290a 6372  alRegressor().cr
-000014b0: 5f6e 6f72 6d2e 6669 7428 7265 7369 6475  _norm.fit(residu
-000014c0: 616c 733d 7265 7369 6475 616c 735f 6361  als=residuals_ca
-000014d0: 6c2c 2073 6967 6d61 733d 7369 676d 6173  l, sigmas=sigmas
-000014e0: 5f63 616c 290a 6060 600a 0a54 6f20 6765  _cal).```..To ge
-000014f0: 6e65 7261 7465 2070 7265 6469 6374 696f  nerate predictio
-00001500: 6e20 696e 7465 7276 616c 7320 666f 7220  n intervals for 
-00001510: 7468 6520 7465 7374 2073 6574 2075 7369  the test set usi
-00001520: 6e67 2074 6865 206e 6f72 6d61 6c69 7a65  ng the normalize
-00001530: 6420 636f 6e66 6f72 6d61 6c20 7265 6772  d conformal regr
-00001540: 6573 736f 722c 2077 6520 6e65 6564 2064  essor, we need d
-00001550: 6966 6669 6375 6c74 7920 6573 7469 6d61  ifficulty estima
-00001560: 7465 7320 666f 7220 7468 6520 7465 7374  tes for the test
-00001570: 2073 6574 2074 6f6f 2c20 7768 6963 6820   set too, which 
-00001580: 7765 2067 6574 2075 7369 6e67 2074 6865  we get using the
-00001590: 2073 616d 6520 6469 6666 6963 756c 7479   same difficulty
-000015a0: 2065 7374 696d 6174 6f72 2061 7320 666f   estimator as fo
-000015b0: 7220 7468 6520 6361 6c69 6272 6174 696f  r the calibratio
-000015c0: 6e20 7365 743a 0a0a 6060 6070 7974 686f  n set:..```pytho
-000015d0: 6e0a 7369 676d 6173 5f74 6573 7420 3d20  n.sigmas_test = 
-000015e0: 6465 2e61 7070 6c79 2858 5f74 6573 7429  de.apply(X_test)
-000015f0: 0a60 6060 0a0a 4e6f 7720 7765 2063 616e  .```..Now we can
-00001600: 206f 6274 6169 6e20 7468 6520 7072 6564   obtain the pred
-00001610: 6963 7469 6f6e 2069 6e74 6572 7661 6c73  iction intervals
-00001620: 2c20 7573 696e 6720 7468 6520 706f 696e  , using the poin
-00001630: 7420 7072 6564 6963 7469 6f6e 7320 616e  t predictions an
-00001640: 6420 6469 6666 6963 756c 7479 2065 7374  d difficulty est
-00001650: 696d 6174 6573 2066 6f72 2074 6865 2074  imates for the t
-00001660: 6573 7420 7365 743a 0a0a 6060 6070 7974  est set:..```pyt
-00001670: 686f 6e0a 696e 7465 7276 616c 735f 6e6f  hon.intervals_no
-00001680: 726d 203d 2063 725f 6e6f 726d 2e70 7265  rm = cr_norm.pre
-00001690: 6469 6374 2879 5f68 6174 3d79 5f68 6174  dict(y_hat=y_hat
-000016a0: 5f74 6573 742c 2073 6967 6d61 733d 7369  _test, sigmas=si
-000016b0: 676d 6173 5f74 6573 742c 200a 2020 2020  gmas_test, .    
-000016c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000016d0: 2020 2020 2020 2020 2020 2020 2079 5f6d               y_m
-000016e0: 696e 3d30 290a 6060 600a 0a60 6060 6e75  in=0).```..```nu
-000016f0: 6d70 790a 6172 7261 7928 5b5b 2032 3236  mpy.array([[ 226
-00001700: 3731 392e 3036 3630 3739 3737 2c20 2035  719.06607977,  5
-00001710: 3535 3234 342e 3933 3339 3230 3233 5d2c  55244.93392023],
-00001720: 0a20 2020 2020 2020 5b20 3137 3337 3637  .       [ 173767
-00001730: 2e39 3037 3533 3731 352c 2020 3339 3833  .90753715,  3983
-00001740: 3634 2e34 3732 3436 3238 355d 2c0a 2020  64.47246285],.  
-00001750: 2020 2020 205b 2031 3234 3639 302e 3730       [ 124690.70
-00001760: 3136 3639 3636 2c20 3130 3436 3433 362e  166966, 1046436.
-00001770: 3433 3833 3330 3334 5d2c 0a20 2020 2020  43833034],.     
-00001780: 2020 2e2e 2e2c 0a20 2020 2020 2020 5b20    ...,.       [ 
-00001790: 3630 3739 3439 2e37 3135 3430 3537 322c  607949.71540572,
-000017a0: 2031 3030 3337 3236 2e37 3234 3539 3432   1003726.7245942
-000017b0: 385d 2c0a 2020 2020 2020 205b 2031 3838  8],.       [ 188
-000017c0: 3637 312e 3337 3532 3237 3820 2c20 2033  671.3752278 ,  3
-000017d0: 3230 3930 392e 3536 3437 3732 3220 5d2c  20909.5647722 ],
-000017e0: 0a20 2020 2020 2020 5b20 3134 3533 3430  .       [ 145340
-000017f0: 2e33 3930 3736 3832 342c 2020 3532 3633  .39076824,  5263
-00001800: 3133 2e32 3039 3233 3137 365d 5d29 0a60  13.20923176]]).`
-00001810: 6060 0a0a 4465 7065 6e64 696e 6720 6f6e  ``..Depending on
-00001820: 2074 6865 2065 6d70 6c6f 7965 6420 6469   the employed di
-00001830: 6666 6963 756c 7479 2065 7374 696d 6174  fficulty estimat
-00001840: 6f72 2c20 7468 6520 6e6f 726d 616c 697a  or, the normaliz
-00001850: 6564 2069 6e74 6572 7661 6c73 206d 6179  ed intervals may
-00001860: 2073 6f6d 6574 696d 6573 2062 6520 756e   sometimes be un
-00001870: 7265 6173 6f6e 6162 6c79 206c 6172 6765  reasonably large
-00001880: 2c20 696e 2074 6865 2073 656e 7365 2074  , in the sense t
-00001890: 6861 7420 7468 6579 206d 6179 2062 6520  hat they may be 
-000018a0: 7365 7665 7261 6c20 7469 6d65 7320 6c61  several times la
-000018b0: 7267 6572 2074 6861 6e20 616e 7920 7072  rger than any pr
-000018c0: 6576 696f 7573 6c79 206f 6273 6572 7665  eviously observe
-000018d0: 6420 6572 726f 722e 204d 6f72 656f 7665  d error. Moreove
-000018e0: 722c 2069 6620 7468 6520 6469 6666 6963  r, if the diffic
-000018f0: 756c 7479 2065 7374 696d 6174 6f72 2069  ulty estimator i
-00001900: 7320 6e6f 7420 7665 7279 2069 6e66 6f72  s not very infor
-00001910: 6d61 7469 7665 2c20 652e 672e 2c20 636f  mative, e.g., co
-00001920: 6d70 6c65 7465 6c79 2072 616e 646f 6d2c  mpletely random,
-00001930: 2074 6865 2076 6172 7969 6e67 2069 6e74   the varying int
-00001940: 6572 7661 6c20 7369 7a65 7320 6d61 7920  erval sizes may 
-00001950: 6769 7665 2061 2066 616c 7365 2069 6d70  give a false imp
-00001960: 7265 7373 696f 6e20 6f66 2074 6861 7420  ression of that 
-00001970: 7765 2063 616e 2065 7870 6563 7420 6c6f  we can expect lo
-00001980: 7765 7220 7072 6564 6963 7469 6f6e 2065  wer prediction e
-00001990: 7272 6f72 7320 666f 7220 696e 7374 616e  rrors for instan
-000019a0: 6365 7320 7769 7468 2074 6967 6874 6572  ces with tighter
-000019b0: 2069 6e74 6572 7661 6c73 2e20 4964 6561   intervals. Idea
-000019c0: 6c6c 792c 2061 2064 6966 6669 6375 6c74  lly, a difficult
-000019d0: 7920 6573 7469 6d61 746f 7220 7072 6f76  y estimator prov
-000019e0: 6964 696e 6720 6c69 7474 6c65 206f 7220  iding little or 
-000019f0: 6e6f 2069 6e66 6f72 6d61 7469 6f6e 206f  no information o
-00001a00: 6e20 7468 6520 6578 7065 6374 6564 2065  n the expected e
-00001a10: 7272 6f72 2073 686f 756c 6420 696e 7374  rror should inst
-00001a20: 6561 6420 6c65 6164 2074 6f20 6d6f 7265  ead lead to more
-00001a30: 2075 6e69 666f 726d 6c79 2064 6973 7472   uniformly distr
-00001a40: 6962 7574 6564 2069 6e74 6572 7661 6c20  ibuted interval 
-00001a50: 7369 7a65 732e 0a0a 4120 4d6f 6e64 7269  sizes...A Mondri
-00001a60: 616e 2063 6f6e 666f 726d 616c 2072 6567  an conformal reg
-00001a70: 7265 7373 6f72 2063 616e 2062 6520 7573  ressor can be us
-00001a80: 6564 2074 6f20 6164 6472 6573 7320 7468  ed to address th
-00001a90: 6573 6520 7072 6f62 6c65 6d73 2c20 6279  ese problems, by
-00001aa0: 2064 6976 6964 696e 6720 7468 6520 6f62   dividing the ob
-00001ab0: 6a65 6374 2073 7061 6365 2069 6e74 6f20  ject space into 
-00001ac0: 6e6f 6e2d 6f76 6572 6c61 7070 696e 6720  non-overlapping 
-00001ad0: 736f 2d63 616c 6c65 6420 4d6f 6e64 7269  so-called Mondri
-00001ae0: 616e 2063 6174 6567 6f72 6965 732c 2061  an categories, a
-00001af0: 6e64 2066 6f72 6d69 6e67 2061 2028 7374  nd forming a (st
-00001b00: 616e 6461 7264 2920 636f 6e66 6f72 6d61  andard) conforma
-00001b10: 6c20 7265 6772 6573 736f 7220 666f 7220  l regressor for 
-00001b20: 6561 6368 2063 6174 6567 6f72 792e 2054  each category. T
-00001b30: 6865 2063 6174 6567 6f72 7920 6d65 6d62  he category memb
-00001b40: 6572 7368 6970 206f 6620 7468 6520 6f62  ership of the ob
-00001b50: 6a65 6374 7320 6361 6e20 6265 2070 726f  jects can be pro
-00001b60: 7669 6465 6420 6173 2061 6e20 6164 6469  vided as an addi
-00001b70: 7469 6f6e 616c 2061 7267 756d 656e 742c  tional argument,
-00001b80: 206e 616d 6564 2060 6269 6e73 602c 2066   named `bins`, f
-00001b90: 6f72 2074 6865 2060 6669 7460 206d 6574  or the `fit` met
-00001ba0: 686f 642e 0a0a 4865 7265 2077 6520 7769  hod...Here we wi
-00001bb0: 6c6c 2075 7365 2074 6865 2068 656c 7065  ll use the helpe
-00001bc0: 7220 6675 6e63 7469 6f6e 2060 6269 6e6e  r function `binn
-00001bd0: 696e 6760 2074 6f20 666f 726d 204d 6f6e  ing` to form Mon
-00001be0: 6472 6961 6e20 6361 7465 676f 7269 6573  drian categories
-00001bf0: 2062 7920 6571 7561 6c2d 7369 7a65 6420   by equal-sized 
-00001c00: 6269 6e6e 696e 6720 6f66 2074 6865 2064  binning of the d
-00001c10: 6966 6669 6375 6c74 7920 6573 7469 6d61  ifficulty estima
-00001c20: 7465 733b 2074 6865 2066 756e 6374 696f  tes; the functio
-00001c30: 6e20 7769 6c6c 2072 6574 7572 6e20 6c61  n will return la
-00001c40: 6265 6c73 2066 6f72 2074 6865 2063 616c  bels for the cal
-00001c50: 6962 7261 7469 6f6e 206f 626a 6563 7473  ibration objects
-00001c60: 2061 7320 7765 6c6c 2061 7320 7468 7265   as well as thre
-00001c70: 7368 6f6c 6473 2066 6f72 2074 6865 2062  sholds for the b
-00001c80: 696e 732c 2077 6869 6368 2061 7265 206c  ins, which are l
-00001c90: 6174 6572 2074 6f20 6265 2075 7365 6420  ater to be used 
-00001ca0: 7768 656e 2062 696e 6e69 6e67 2074 6865  when binning the
-00001cb0: 2074 6573 7420 6f62 6a65 6374 733a 0a0a   test objects:..
-00001cc0: 6060 6070 7974 686f 6e0a 6269 6e73 5f63  ```python.bins_c
-00001cd0: 616c 2c20 6269 6e5f 7468 7265 7368 6f6c  al, bin_threshol
-00001ce0: 6473 203d 2062 696e 6e69 6e67 2876 616c  ds = binning(val
-00001cf0: 7565 733d 7369 676d 6173 5f63 616c 2c20  ues=sigmas_cal, 
-00001d00: 6269 6e73 3d32 3029 0a60 6060 0a0a 4120  bins=20).```..A 
-00001d10: 4d6f 6e64 7269 616e 2063 6f6e 666f 726d  Mondrian conform
-00001d20: 616c 2072 6567 7265 7373 6f72 2069 7320  al regressor is 
-00001d30: 6f62 7461 696e 6564 2066 726f 6d20 7468  obtained from th
-00001d40: 6520 7265 7369 6475 616c 7320 616e 6420  e residuals and 
-00001d50: 4d6f 6e64 7269 616e 2063 6174 6567 6f72  Mondrian categor
-00001d60: 7920 6c61 6265 6c73 3a0a 0a60 6060 7079  y labels:..```py
-00001d70: 7468 6f6e 0a63 725f 6d6f 6e64 203d 2043  thon.cr_mond = C
-00001d80: 6f6e 666f 726d 616c 5265 6772 6573 736f  onformalRegresso
-00001d90: 7228 290a 6372 5f6d 6f6e 642e 6669 7428  r().cr_mond.fit(
-00001da0: 7265 7369 6475 616c 733d 7265 7369 6475  residuals=residu
-00001db0: 616c 735f 6361 6c2c 2062 696e 733d 6269  als_cal, bins=bi
-00001dc0: 6e73 5f63 616c 290a 6060 600a 0a49 6e20  ns_cal).```..In 
-00001dd0: 6f72 6465 7220 746f 2075 7365 2074 6865  order to use the
-00001de0: 204d 6f6e 6472 6961 6e20 636f 6e66 6f72   Mondrian confor
-00001df0: 6d61 6c20 7265 6772 6573 736f 7220 6f6e  mal regressor on
-00001e00: 2074 6865 2074 6573 7420 6f62 6a65 6374   the test object
-00001e10: 732c 2077 6520 6e65 6564 2074 6f20 6765  s, we need to ge
-00001e20: 7420 7468 6520 6c61 6265 6c73 206f 6620  t the labels of 
-00001e30: 7468 6520 4d6f 6e64 7269 616e 2063 6174  the Mondrian cat
-00001e40: 6567 6f72 6965 7320 666f 7220 7468 6573  egories for thes
-00001e50: 653a 0a0a 6060 6070 7974 686f 6e0a 6269  e:..```python.bi
-00001e60: 6e73 5f74 6573 7420 3d20 6269 6e6e 696e  ns_test = binnin
-00001e70: 6728 7661 6c75 6573 3d73 6967 6d61 735f  g(values=sigmas_
-00001e80: 7465 7374 2c20 6269 6e73 3d62 696e 5f74  test, bins=bin_t
-00001e90: 6872 6573 686f 6c64 7329 0a60 6060 0a0a  hresholds).```..
-00001ea0: 4e6f 7720 7765 2068 6176 6520 6576 6572  Now we have ever
-00001eb0: 7974 6869 6e67 2077 6520 6e65 6564 2074  ything we need t
-00001ec0: 6f20 6765 7420 7468 6520 7072 6564 6963  o get the predic
-00001ed0: 7469 6f6e 2069 6e74 6572 7661 6c73 3a0a  tion intervals:.
-00001ee0: 0a60 6060 7079 7468 6f6e 0a69 6e74 6572  .```python.inter
-00001ef0: 7661 6c73 5f6d 6f6e 6420 3d20 6372 5f6d  vals_mond = cr_m
-00001f00: 6f6e 642e 7072 6564 6963 7428 795f 6861  ond.predict(y_ha
-00001f10: 743d 795f 6861 745f 7465 7374 2c20 6269  t=y_hat_test, bi
-00001f20: 6e73 3d62 696e 735f 7465 7374 2c20 795f  ns=bins_test, y_
-00001f30: 6d69 6e3d 3029 0a60 6060 0a0a 6060 606e  min=0).```..```n
-00001f40: 756d 7079 0a61 7272 6179 285b 5b20 3230  umpy.array([[ 20
-00001f50: 3633 3739 2e37 202c 2020 3537 3535 3834  6379.7 ,  575584
-00001f60: 2e33 205d 2c0a 2020 2020 2020 205b 2031  .3 ],.       [ 1
-00001f70: 3434 3031 342e 3635 2c20 2034 3238 3131  44014.65,  42811
-00001f80: 372e 3733 5d2c 0a20 2020 2020 2020 5b20  7.73],.       [ 
-00001f90: 2031 3739 3635 2e35 372c 2031 3135 3331   17965.57, 11531
-00001fa0: 3631 2e35 375d 2c0a 2020 2020 2020 202e  61.57],.       .
-00001fb0: 2e2e 2c0a 2020 2020 2020 205b 2036 3533  ..,.       [ 653
-00001fc0: 3836 352e 3232 2c20 2039 3537 3831 312e  865.22,  957811.
-00001fd0: 3232 5d2c 0a20 2020 2020 2020 5b20 3137  22],.       [ 17
-00001fe0: 3432 3634 2e38 372c 2020 3333 3533 3136  4264.87,  335316
-00001ff0: 2e30 375d 2c0a 2020 2020 2020 205b 2031  .07],.       [ 1
-00002000: 3430 3538 372e 3436 2c20 2035 3331 3036  40587.46,  53106
-00002010: 362e 3134 5d5d 290a 6060 600a 0a23 2323  6.14]]).```..###
-00002020: 2043 6f6e 666f 726d 616c 2070 7265 6469   Conformal predi
-00002030: 6374 6976 6520 7379 7374 656d 730a 0a54  ctive systems..T
-00002040: 6865 2069 6e74 6572 6661 6365 2074 6f20  he interface to 
-00002050: 6120 6043 6f6e 666f 726d 616c 5072 6564  a `ConformalPred
-00002060: 6963 7469 7665 5379 7374 656d 6020 6973  ictiveSystem` is
-00002070: 2076 6572 7920 7369 6d69 6c61 7220 746f   very similar to
-00002080: 2074 6861 7420 6f66 2061 2063 6f6e 666f   that of a confo
-00002090: 726d 616c 2072 6567 7265 7373 6f72 3b20  rmal regressor; 
-000020a0: 6279 2070 726f 7669 6469 6e67 206a 7573  by providing jus
-000020b0: 7420 7468 6520 7265 7369 6475 616c 732c  t the residuals,
-000020c0: 2077 6520 6765 7420 6120 7374 616e 6461   we get a standa
-000020d0: 7264 2063 6f6e 666f 726d 616c 2070 7265  rd conformal pre
-000020e0: 6469 6374 6976 6520 7379 7374 656d 2c20  dictive system, 
-000020f0: 6279 2070 726f 7669 6469 6e67 2061 6c73  by providing als
-00002100: 6f20 6469 6666 6963 756c 7479 2065 7374  o difficulty est
-00002110: 696d 6174 6573 2c20 7765 2067 6574 2061  imates, we get a
-00002120: 206e 6f72 6d61 6c69 7a65 6420 636f 6e66   normalized conf
-00002130: 6f72 6d61 6c20 7072 6564 6963 7469 7665  ormal predictive
-00002140: 2073 7973 7465 6d20 616e 6420 6279 2070   system and by p
-00002150: 726f 7669 6469 6e67 206c 6162 656c 7320  roviding labels 
-00002160: 666f 7220 4d6f 6e64 7269 616e 2063 6174  for Mondrian cat
-00002170: 6567 6f72 6965 7320 2862 696e 7329 2c20  egories (bins), 
-00002180: 7765 2067 6574 2061 204d 6f6e 6472 6961  we get a Mondria
-00002190: 6e20 636f 6e66 6f72 6d61 6c20 7072 6564  n conformal pred
-000021a0: 6963 7469 7665 2073 7973 7465 6d2e 0a0a  ictive system...
-000021b0: 5468 6520 6d61 696e 2064 6966 6665 7265  The main differe
-000021c0: 6e63 6520 746f 2063 6f6e 666f 726d 616c  nce to conformal
-000021d0: 2072 6567 7265 7373 6f72 7320 636f 6e63   regressors conc
-000021e0: 6572 6e73 2074 6865 206f 7574 7075 743b  erns the output;
-000021f0: 2069 6e73 7465 6164 206f 6620 7072 6564   instead of pred
-00002200: 6963 7469 6f6e 2069 6e74 6572 7661 6c73  iction intervals
-00002210: 2c20 636f 6e66 6f72 6d61 6c20 7072 6564  , conformal pred
-00002220: 6963 7469 7665 2073 7973 7465 6d73 2070  ictive systems p
-00002230: 726f 6475 6365 2063 6f6d 706c 6574 6520  roduce complete 
-00002240: 6375 6d75 6c61 7469 7665 2064 6973 7472  cumulative distr
-00002250: 6962 7574 696f 6e20 6675 6e63 7469 6f6e  ibution function
-00002260: 7320 2863 6f6e 666f 726d 616c 2070 7265  s (conformal pre
-00002270: 6469 6374 6976 6520 6469 7374 7269 6275  dictive distribu
-00002280: 7469 6f6e 7329 2e20 4672 6f6d 2074 6865  tions). From the
-00002290: 7365 2077 6520 6361 6e20 6765 6e65 7261  se we can genera
-000022a0: 7465 2070 7265 6469 6374 696f 6e20 696e  te prediction in
-000022b0: 7465 7276 616c 732c 2062 7574 2077 6520  tervals, but we 
-000022c0: 6361 6e20 616c 736f 206f 6274 6169 6e20  can also obtain 
-000022d0: 7065 7263 656e 7469 6c65 732c 2063 616c  percentiles, cal
-000022e0: 6962 7261 7465 6420 706f 696e 7420 7072  ibrated point pr
-000022f0: 6564 6963 7469 6f6e 732c 2061 7320 7765  edictions, as we
-00002300: 6c6c 2061 7320 702d 7661 6c75 6573 2066  ll as p-values f
-00002310: 6f72 2067 6976 656e 2074 6172 6765 7420  or given target 
-00002320: 7661 6c75 6573 2e0a 0a4c 6574 2075 7320  values...Let us 
-00002330: 6669 7420 6120 4d6f 6e64 7269 616e 206e  fit a Mondrian n
-00002340: 6f72 6d61 6c69 7a65 6420 636f 6e66 6f72  ormalized confor
-00002350: 6d61 6c20 7072 6564 6963 7469 7665 2073  mal predictive s
-00002360: 7973 7465 6d2c 2075 7369 6e67 2074 6865  ystem, using the
-00002370: 2061 626f 7665 2072 6573 6964 7561 6c73   above residuals
-00002380: 2061 6e64 2064 6966 6669 6375 6c74 7920   and difficulty 
-00002390: 6573 7469 6d61 7465 7320 2873 6967 6d61  estimates (sigma
-000023a0: 7329 2c20 616e 6420 7768 6572 6520 7468  s), and where th
-000023b0: 6520 4d6f 6e64 7269 616e 2063 6174 6567  e Mondrian categ
-000023c0: 6f72 6965 7320 2862 696e 7329 2061 7265  ories (bins) are
-000023d0: 2066 6f72 6d65 6420 7573 696e 6720 7468   formed using th
-000023e0: 6520 706f 696e 7420 7072 6564 6963 7469  e point predicti
-000023f0: 6f6e 7320 666f 7220 7468 6520 6361 6c69  ons for the cali
-00002400: 6272 6174 696f 6e20 7365 743a 0a0a 6060  bration set:..``
-00002410: 6070 7974 686f 6e0a 6672 6f6d 2063 7265  `python.from cre
-00002420: 7065 7320 696d 706f 7274 2043 6f6e 666f  pes import Confo
-00002430: 726d 616c 5072 6564 6963 7469 7665 5379  rmalPredictiveSy
-00002440: 7374 656d 0a0a 6269 6e73 5f63 616c 2c20  stem..bins_cal, 
-00002450: 6269 6e5f 7468 7265 7368 6f6c 6473 203d  bin_thresholds =
-00002460: 2062 696e 6e69 6e67 2876 616c 7565 733d   binning(values=
-00002470: 795f 6861 745f 6361 6c2c 2062 696e 733d  y_hat_cal, bins=
-00002480: 3529 0a0a 6370 735f 6d6f 6e64 5f6e 6f72  5)..cps_mond_nor
-00002490: 6d20 3d20 436f 6e66 6f72 6d61 6c50 7265  m = ConformalPre
-000024a0: 6469 6374 6976 6553 7973 7465 6d28 292e  dictiveSystem().
-000024b0: 6669 7428 7265 7369 6475 616c 733d 7265  fit(residuals=re
-000024c0: 7369 6475 616c 735f 6361 6c2c 0a20 2020  siduals_cal,.   
-000024d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000024e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000024f0: 2020 2020 2020 2020 2020 2020 2073 6967               sig
-00002500: 6d61 733d 7369 676d 6173 5f63 616c 2c0a  mas=sigmas_cal,.
-00002510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002540: 6269 6e73 3d62 696e 735f 6361 6c29 0a60  bins=bins_cal).`
-00002550: 6060 0a0a 5765 2061 6c72 6561 6479 2068  ``..We already h
-00002560: 6176 6520 7468 6520 706f 696e 7420 7072  ave the point pr
-00002570: 6564 6963 7469 6f6e 7320 616e 6420 7468  edictions and th
-00002580: 6520 6469 6666 6963 756c 7479 2065 7374  e difficulty est
-00002590: 696d 6174 6573 2066 6f72 2074 6865 2074  imates for the t
-000025a0: 6573 7420 6f62 6a65 6374 732c 2073 6f20  est objects, so 
-000025b0: 7765 206a 7573 7420 6e65 6564 2074 6865  we just need the
-000025c0: 2063 6174 6567 6f72 7920 6c61 6265 6c73   category labels
-000025d0: 2061 6363 6f72 6469 6e67 2074 6f20 7468   according to th
-000025e0: 6520 6e65 7720 6269 6e20 7468 7265 7368  e new bin thresh
-000025f0: 6f6c 6473 3a0a 0a60 6060 7079 7468 6f6e  olds:..```python
-00002600: 0a62 696e 735f 7465 7374 203d 2062 696e  .bins_test = bin
-00002610: 6e69 6e67 2876 616c 7565 733d 795f 6861  ning(values=y_ha
-00002620: 745f 7465 7374 2c20 6269 6e73 3d62 696e  t_test, bins=bin
-00002630: 5f74 6872 6573 686f 6c64 7329 0a60 6060  _thresholds).```
-00002640: 0a0a 5765 2063 616e 206e 6f77 2065 7874  ..We can now ext
-00002650: 7261 6374 2070 7265 6469 6374 696f 6e20  ract prediction 
-00002660: 696e 7465 7276 616c 7320 6672 6f6d 2074  intervals from t
-00002670: 6865 2063 6f6e 666f 726d 616c 2070 7265  he conformal pre
-00002680: 6469 6374 6976 6520 6469 7374 7269 6275  dictive distribu
-00002690: 7469 6f6e 7320 666f 7220 7468 6520 7465  tions for the te
-000026a0: 7374 206f 626a 6563 7473 3a20 0a0a 6060  st objects: ..``
-000026b0: 6070 7974 686f 6e0a 696e 7465 7276 616c  `python.interval
-000026c0: 7320 3d20 6370 735f 6d6f 6e64 5f6e 6f72  s = cps_mond_nor
-000026d0: 6d2e 7072 6564 6963 7428 795f 6861 743d  m.predict(y_hat=
-000026e0: 795f 6861 745f 7465 7374 2c0a 2020 2020  y_hat_test,.    
-000026f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002700: 2020 2020 2020 2020 2020 2020 2020 7369                si
-00002710: 676d 6173 3d73 6967 6d61 735f 7465 7374  gmas=sigmas_test
-00002720: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00002730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002740: 2020 2020 6269 6e73 3d62 696e 735f 7465      bins=bins_te
-00002750: 7374 2c0a 2020 2020 2020 2020 2020 2020  st,.            
-00002760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002770: 2020 2020 2020 6c6f 7765 725f 7065 7263        lower_perc
-00002780: 656e 7469 6c65 733d 322e 352c 0a20 2020  entiles=2.5,.   
-00002790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000027a0: 2020 2020 2020 2020 2020 2020 2020 2068                 h
-000027b0: 6967 6865 725f 7065 7263 656e 7469 6c65  igher_percentile
-000027c0: 733d 3937 2e35 2c0a 2020 2020 2020 2020  s=97.5,.        
-000027d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000027e0: 2020 2020 2020 2020 2020 795f 6d69 6e3d            y_min=
-000027f0: 3029 0a60 6060 0a0a 6060 606e 756d 7079  0).```..```numpy
-00002800: 0a61 7272 6179 285b 5b20 3234 3538 3236  .array([[ 245826
-00002810: 2e33 3432 3236 3933 202c 2020 3531 3733  .3422693 ,  5173
-00002820: 3135 2e38 3336 3138 3938 355d 2c0a 2020  15.83618985],.  
-00002830: 2020 2020 205b 2031 3435 3334 382e 3033       [ 145348.03
-00002840: 3431 3538 3438 2c20 2033 3932 3936 382e  415848,  392968.
-00002850: 3135 3538 3739 3937 5d2c 0a20 2020 2020  15587997],.     
-00002860: 2020 5b20 3134 3837 3734 2e36 3534 3631    [ 148774.65461
-00002870: 3231 322c 2031 3033 3433 3030 2e38 3431  212, 1034300.841
-00002880: 3935 3937 365d 2c0a 2020 2020 2020 202e  95976],.       .
-00002890: 2e2e 2c0a 2020 2020 2020 205b 2035 3839  ..,.       [ 589
-000028a0: 3230 302e 3537 3235 3935 3720 2c20 3130  200.5725957 , 10
-000028b0: 3537 3031 332e 3839 3130 3230 3037 5d2c  57013.89102007],
-000028c0: 0a20 2020 2020 2020 5b20 3137 3139 3338  .       [ 171938
-000028d0: 2e32 3933 3832 3935 322c 2020 3331 3737  .29382952,  3177
-000028e0: 3332 2e33 3136 3131 3134 315d 2c0a 2020  32.31611141],.  
-000028f0: 2020 2020 205b 2031 3637 3439 382e 3031       [ 167498.01
-00002900: 3534 3035 3034 2c20 2034 3832 3332 382e  540504,  482328.
-00002910: 3938 3535 3236 3332 5d5d 290a 6060 600a  98552632]]).```.
-00002920: 0a57 6520 6361 6e20 616c 736f 2067 6574  .We can also get
-00002930: 2074 6865 2070 2d76 616c 7565 7320 666f   the p-values fo
-00002940: 7220 7468 6520 7472 7565 2074 6172 6765  r the true targe
-00002950: 7420 7661 6c75 6573 3b20 7468 6579 2073  t values; they s
-00002960: 686f 756c 6420 6265 2075 6e69 666f 726d  hould be uniform
-00002970: 6c79 2064 6973 7472 6962 7574 6564 2c20  ly distributed, 
-00002980: 6966 2074 6865 2074 6573 7420 6f62 6a65  if the test obje
-00002990: 6374 7320 6172 6520 6472 6177 6e20 6672  cts are drawn fr
-000029a0: 6f6d 2074 6865 2073 616d 6520 756e 6465  om the same unde
-000029b0: 726c 7969 6e67 2064 6973 7472 6962 7574  rlying distribut
-000029c0: 696f 6e20 6173 2074 6865 2063 616c 6962  ion as the calib
-000029d0: 7261 7469 6f6e 2065 7861 6d70 6c65 732e  ration examples.
-000029e0: 0a0a 6060 6070 7974 686f 6e0a 705f 7661  ..```python.p_va
-000029f0: 6c75 6573 203d 2063 7073 5f6d 6f6e 645f  lues = cps_mond_
-00002a00: 6e6f 726d 2e70 7265 6469 6374 2879 5f68  norm.predict(y_h
-00002a10: 6174 3d79 5f68 6174 5f74 6573 742c 0a20  at=y_hat_test,. 
-00002a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002a40: 7369 676d 6173 3d73 6967 6d61 735f 7465  sigmas=sigmas_te
-00002a50: 7374 2c0a 2020 2020 2020 2020 2020 2020  st,.            
-00002a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002a70: 2020 2020 2062 696e 733d 6269 6e73 5f74       bins=bins_t
-00002a80: 6573 742c 0a20 2020 2020 2020 2020 2020  est,.           
-00002a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002aa0: 2020 2020 2020 793d 795f 7465 7374 290a        y=y_test).
-00002ab0: 6060 600a 0a60 6060 6e75 6d70 790a 6172  ```..```numpy.ar
-00002ac0: 7261 7928 5b5b 302e 3938 3630 3336 3134  ray([[0.98603614
-00002ad0: 5d2c 0a20 2020 2020 2020 5b30 2e38 3731  ],.       [0.871
-00002ae0: 3738 3235 365d 2c0a 2020 2020 2020 205b  78256],.       [
-00002af0: 302e 3434 3230 3139 3834 5d2c 0a20 2020  0.44201984],.   
-00002b00: 2020 2020 2e2e 2e2c 0a20 2020 2020 2020      ...,.       
-00002b10: 5b30 2e30 3536 3838 3830 345d 2c0a 2020  [0.05688804],.  
-00002b20: 2020 2020 205b 302e 3039 3437 3336 3034       [0.09473604
-00002b30: 5d2c 0a20 2020 2020 2020 5b30 2e33 3130  ],.       [0.310
-00002b40: 3639 3931 335d 5d29 0a60 6060 0a0a 5765  69913]]).```..We
-00002b50: 206d 6179 2072 6571 7565 7374 2074 6861   may request tha
-00002b60: 7420 7468 6520 7072 6564 6963 7420 6d65  t the predict me
-00002b70: 7468 6f64 2072 6574 7572 6e73 2074 6865  thod returns the
-00002b80: 2066 756c 6c20 636f 6e66 6f72 6d61 6c20   full conformal 
-00002b90: 7072 6564 6963 7469 7665 2064 6973 7472  predictive distr
-00002ba0: 6962 7574 696f 6e20 2843 5044 2920 666f  ibution (CPD) fo
-00002bb0: 7220 6561 6368 2074 6573 7420 696e 7374  r each test inst
-00002bc0: 616e 6365 2c20 6173 2064 6566 696e 6564  ance, as defined
-00002bd0: 2062 7920 7468 6520 7468 7265 7368 6f6c   by the threshol
-00002be0: 6420 7661 6c75 6573 2c20 6279 2073 6574  d values, by set
-00002bf0: 7469 6e67 2060 7265 7475 726e 5f63 7064  ting `return_cpd
-00002c00: 733d 5472 7565 602e 2054 6865 2066 6f72  s=True`. The for
-00002c10: 6d61 7420 6f66 2074 6865 2064 6973 7472  mat of the distr
-00002c20: 6962 7574 696f 6e73 2076 6172 7920 7769  ibutions vary wi
-00002c30: 7468 2074 6865 2074 7970 6520 6f66 2063  th the type of c
-00002c40: 6f6e 666f 726d 616c 2070 7265 6469 6374  onformal predict
-00002c50: 6976 6520 7379 7374 656d 3b20 666f 7220  ive system; for 
-00002c60: 6120 7374 616e 6461 7264 2061 6e64 206e  a standard and n
-00002c70: 6f72 6d61 6c69 7a65 6420 4350 532c 2074  ormalized CPS, t
-00002c80: 6865 206f 7574 7075 7420 6973 2061 6e20  he output is an 
-00002c90: 6172 7261 7920 7769 7468 2061 2072 6f77  array with a row
-00002ca0: 2066 6f72 2065 6163 6820 7465 7374 2069   for each test i
-00002cb0: 6e73 7461 6e63 6520 616e 6420 6120 636f  nstance and a co
-00002cc0: 6c75 6d6e 2066 6f72 2065 6163 6820 6361  lumn for each ca
-00002cd0: 6c69 6272 6174 696f 6e20 696e 7374 616e  libration instan
-00002ce0: 6365 2028 7265 7369 6475 616c 292c 2077  ce (residual), w
-00002cf0: 6869 6c65 2066 6f72 2061 204d 6f6e 6472  hile for a Mondr
-00002d00: 6961 6e20 4350 532c 2074 6865 2064 6566  ian CPS, the def
-00002d10: 6175 6c74 206f 7574 7075 7420 6973 2061  ault output is a
-00002d20: 2076 6563 746f 7220 636f 6e74 6169 6e69   vector containi
-00002d30: 6e67 206f 6e65 2043 5044 2070 6572 2074  ng one CPD per t
-00002d40: 6573 7420 696e 7374 616e 6365 2c20 7369  est instance, si
-00002d50: 6e63 6520 7468 6520 6e75 6d62 6572 206f  nce the number o
-00002d60: 6620 7661 6c75 6573 206d 6179 2076 6172  f values may var
-00002d70: 7920 6265 7477 6565 6e20 6361 7465 676f  y between catego
-00002d80: 7269 6573 2e0a 0a60 6060 7079 7468 6f6e  ries...```python
-00002d90: 0a63 7064 7320 3d20 6370 735f 6d6f 6e64  .cpds = cps_mond
-00002da0: 5f6e 6f72 6d2e 7072 6564 6963 7428 795f  _norm.predict(y_
-00002db0: 6861 743d 795f 6861 745f 7465 7374 2c0a  hat=y_hat_test,.
-00002dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002dd0: 2020 2020 2020 2020 2020 2020 2073 6967               sig
-00002de0: 6d61 733d 7369 676d 6173 5f74 6573 742c  mas=sigmas_test,
-00002df0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00002e00: 2020 2020 2020 2020 2020 2020 2020 6269                bi
-00002e10: 6e73 3d62 696e 735f 7465 7374 2c0a 2020  ns=bins_test,.  
-00002e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002e30: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00002e40: 6e5f 6370 6473 3d54 7275 6529 0a60 6060  n_cpds=True).```
-00002e50: 0a0a 5468 6520 7265 7375 6c74 696e 6720  ..The resulting 
-00002e60: 7665 6374 6f72 206f 6620 6172 7261 7973  vector of arrays
-00002e70: 2069 7320 6e6f 7420 6469 7370 6c61 7965   is not displaye
-00002e80: 6420 6865 7265 2c20 6275 7420 7765 2069  d here, but we i
-00002e90: 6e73 7465 6164 2070 726f 7669 6465 2061  nstead provide a
-00002ea0: 2070 6c6f 7420 666f 7220 7468 6520 4350   plot for the CP
-00002eb0: 4420 6f66 2061 2072 616e 646f 6d20 7465  D of a random te
-00002ec0: 7374 2069 6e73 7461 6e63 653a 0a0a 215b  st instance:..![
-00002ed0: 6370 645d 2868 7474 7073 3a2f 2f75 7365  cpd](https://use
-00002ee0: 722d 696d 6167 6573 2e67 6974 6875 6275  r-images.githubu
-00002ef0: 7365 7263 6f6e 7465 6e74 2e63 6f6d 2f37  sercontent.com/7
-00002f00: 3833 3837 3431 2f32 3335 3038 3139 3639  838741/235081969
-00002f10: 2d33 3238 6437 6132 332d 3236 6339 2d34  -328d7a23-26c9-4
-00002f20: 3739 392d 6132 3436 2d38 6333 3566 6437  799-a246-8c35fd7
-00002f30: 6163 3838 652e 706e 6729 0a0a 2323 2045  ac88e.png)..## E
-00002f40: 7861 6d70 6c65 730a 0a46 6f72 2061 6464  xamples..For add
-00002f50: 6974 696f 6e61 6c20 6578 616d 706c 6573  itional examples
-00002f60: 206f 6620 686f 7720 746f 2075 7365 2074   of how to use t
-00002f70: 6865 2070 6163 6b61 6765 2061 6e64 206d  he package and m
-00002f80: 6f64 756c 652c 2069 6e63 6c75 6469 6e67  odule, including
-00002f90: 2068 6f77 2074 6f20 7573 6520 6f75 742d   how to use out-
-00002fa0: 6f66 2d62 6167 2070 7265 6469 6374 696f  of-bag predictio
-00002fb0: 6e73 2072 6174 6865 7220 7468 616e 2068  ns rather than h
-00002fc0: 6176 696e 6720 746f 2072 656c 7920 6f6e  aving to rely on
-00002fd0: 2064 6976 6964 696e 6720 7468 6520 7472   dividing the tr
-00002fe0: 6169 6e69 6e67 2073 6574 2069 6e74 6f20  aining set into 
-00002ff0: 6120 7072 6f70 6572 2074 7261 696e 696e  a proper trainin
-00003000: 6720 616e 6420 6361 6c69 6272 6174 696f  g and calibratio
-00003010: 6e20 7365 742c 2073 6565 205b 7468 6520  n set, see [the 
-00003020: 646f 6375 6d65 6e74 6174 696f 6e5d 2868  documentation](h
-00003030: 7474 7073 3a2f 2f63 7265 7065 732e 7265  ttps://crepes.re
-00003040: 6164 7468 6564 6f63 732e 696f 2f65 6e2f  adthedocs.io/en/
-00003050: 6c61 7465 7374 2f29 2061 6e64 205b 7468  latest/) and [th
-00003060: 6973 204a 7570 7974 6572 206e 6f74 6562  is Jupyter noteb
-00003070: 6f6f 6b5d 2868 7474 7073 3a2f 2f67 6974  ook](https://git
-00003080: 6875 622e 636f 6d2f 6865 6e72 696b 626f  hub.com/henrikbo
-00003090: 7374 726f 6d2f 6372 6570 6573 2f62 6c6f  strom/crepes/blo
-000030a0: 622f 6d61 696e 2f64 6f63 732f 6372 6570  b/main/docs/crep
-000030b0: 6573 5f6e 622e 6970 796e 6229 2e0a 0a23  es_nb.ipynb)...#
-000030c0: 2320 4369 7469 6e67 2063 7265 7065 730a  # Citing crepes.
-000030d0: 0a49 6620 796f 7520 7573 6520 6063 7265  .If you use `cre
-000030e0: 7065 7360 2066 6f72 2061 2073 6369 656e  pes` for a scien
-000030f0: 7469 6669 6320 7075 626c 6963 6174 696f  tific publicatio
-00003100: 6e2c 2079 6f75 206d 6179 2063 6974 6520  n, you may cite 
-00003110: 7468 6520 666f 6c6c 6f77 696e 6720 7061  the following pa
-00003120: 7065 723a 0a0a 426f 7374 72c3 b66d 2c20  per:..Bostr..m, 
-00003130: 482e 2c20 3230 3232 2e20 6372 6570 6573  H., 2022. crepes
-00003140: 3a20 6120 5079 7468 6f6e 2050 6163 6b61  : a Python Packa
-00003150: 6765 2066 6f72 2047 656e 6572 6174 696e  ge for Generatin
-00003160: 6720 436f 6e66 6f72 6d61 6c20 5265 6772  g Conformal Regr
-00003170: 6573 736f 7273 2061 6e64 2050 7265 6469  essors and Predi
-00003180: 6374 6976 6520 5379 7374 656d 732e 2049  ctive Systems. I
-00003190: 6e20 436f 6e66 6f72 6d61 6c20 616e 6420  n Conformal and 
-000031a0: 5072 6f62 6162 696c 6973 7469 6320 5072  Probabilistic Pr
-000031b0: 6564 6963 7469 6f6e 2061 6e64 2041 7070  ediction and App
-000031c0: 6c69 6361 7469 6f6e 732e 2050 4d4c 522c  lications. PMLR,
-000031d0: 2031 3739 2e20 5b4c 696e 6b5d 2868 7474   179. [Link](htt
-000031e0: 7073 3a2f 2f63 6f70 612d 636f 6e66 6572  ps://copa-confer
-000031f0: 656e 6365 2e63 6f6d 2f70 6170 6572 732f  ence.com/papers/
-00003200: 434f 5041 3230 3232 5f70 6170 6572 5f31  COPA2022_paper_1
-00003210: 312e 7064 6629 0a0a 4269 6274 6578 2065  1.pdf)..Bibtex e
-00003220: 6e74 7279 3a0a 0a60 6060 6269 6274 6578  ntry:..```bibtex
-00003230: 0a40 496e 5072 6f63 6565 6469 6e67 737b  .@InProceedings{
-00003240: 6372 6570 6573 2c0a 2020 7469 746c 6520  crepes,.  title 
-00003250: 3d20 0920 7b63 7265 7065 733a 2061 2050  = . {crepes: a P
-00003260: 7974 686f 6e20 5061 636b 6167 6520 666f  ython Package fo
-00003270: 7220 4765 6e65 7261 7469 6e67 2043 6f6e  r Generating Con
-00003280: 666f 726d 616c 2052 6567 7265 7373 6f72  formal Regressor
-00003290: 7320 616e 6420 5072 6564 6963 7469 7665  s and Predictive
-000032a0: 2053 7973 7465 6d73 7d2c 0a20 2061 7574   Systems},.  aut
-000032b0: 686f 7220 3d20 2020 2020 2020 7b42 6f73  hor =       {Bos
-000032c0: 7472 5c22 6f6d 2c20 4865 6e72 696b 7d2c  tr\"om, Henrik},
-000032d0: 0a20 2062 6f6f 6b74 6974 6c65 203d 2009  .  booktitle = .
-000032e0: 207b 5072 6f63 6565 6469 6e67 7320 6f66   {Proceedings of
-000032f0: 2074 6865 2045 6c65 7665 6e74 6820 5379   the Eleventh Sy
-00003300: 6d70 6f73 6975 6d20 6f6e 2043 6f6e 666f  mposium on Confo
-00003310: 726d 616c 2061 6e64 2050 726f 6261 6269  rmal and Probabi
-00003320: 6c69 7374 6963 2050 7265 6469 6374 696f  listic Predictio
-00003330: 6e20 616e 6420 4170 706c 6963 6174 696f  n and Applicatio
-00003340: 6e73 7d2c 0a20 2079 6561 7220 3d20 0920  ns},.  year = . 
-00003350: 7b32 3032 327d 2c0a 2020 6564 6974 6f72  {2022},.  editor
-00003360: 203d 2009 207b 4a6f 6861 6e73 736f 6e2c   = . {Johansson,
-00003370: 2055 6c66 2061 6e64 2042 6f73 7472 c3b6   Ulf and Bostr..
-00003380: 6d2c 2048 656e 7269 6b20 616e 6420 416e  m, Henrik and An
-00003390: 204e 6775 7965 6e2c 204b 6875 6f6e 6720   Nguyen, Khuong 
-000033a0: 616e 6420 4c75 6f2c 205a 6869 7975 616e  and Luo, Zhiyuan
-000033b0: 2061 6e64 2043 6172 6c73 736f 6e2c 204c   and Carlsson, L
-000033c0: 6172 737d 2c0a 2020 766f 6c75 6d65 203d  ars},.  volume =
-000033d0: 2009 207b 3137 397d 2c0a 2020 7365 7269   . {179},.  seri
-000033e0: 6573 203d 2009 207b 5072 6f63 6565 6469  es = . {Proceedi
-000033f0: 6e67 7320 6f66 204d 6163 6869 6e65 204c  ngs of Machine L
-00003400: 6561 726e 696e 6720 5265 7365 6172 6368  earning Research
-00003410: 7d2c 0a20 2070 7562 6c69 7368 6572 203d  },.  publisher =
-00003420: 2020 2020 7b50 4d4c 527d 0a7d 0a60 6060      {PMLR}.}.```
-00003430: 0a0a 2323 2052 6566 6572 656e 6365 730a  ..## References.
-00003440: 0a3c 6120 6964 3d22 3122 3e5b 315d 3c2f  .<a id="1">[1]</
-00003450: 613e 2056 6f76 6b2c 2056 2e2c 2047 616d  a> Vovk, V., Gam
-00003460: 6d65 726d 616e 2c20 412e 2061 6e64 2053  merman, A. and S
-00003470: 6861 6665 722c 2047 2e2c 2032 3030 352e  hafer, G., 2005.
-00003480: 2041 6c67 6f72 6974 686d 6963 206c 6561   Algorithmic lea
-00003490: 726e 696e 6720 696e 2061 2072 616e 646f  rning in a rando
-000034a0: 6d20 776f 726c 642e 2053 7072 696e 6765  m world. Springe
-000034b0: 7220 5b4c 696e 6b5d 2868 7474 7073 3a2f  r [Link](https:/
-000034c0: 2f6c 696e 6b2e 7370 7269 6e67 6572 2e63  /link.springer.c
-000034d0: 6f6d 2f62 6f6f 6b2f 3130 2e31 3030 372f  om/book/10.1007/
-000034e0: 6231 3036 3731 3529 0a0a 3c61 2069 643d  b106715)..<a id=
-000034f0: 2232 223e 5b32 5d3c 2f61 3e20 5061 7061  "2">[2]</a> Papa
-00003500: 646f 706f 756c 6f73 2c20 482e 2c20 5072  dopoulos, H., Pr
-00003510: 6f65 6472 6f75 2c20 4b2e 2c20 566f 766b  oedrou, K., Vovk
-00003520: 2c20 562e 2061 6e64 2047 616d 6d65 726d  , V. and Gammerm
-00003530: 616e 2c20 412e 2c20 3230 3032 2e20 496e  an, A., 2002. In
-00003540: 6475 6374 6976 6520 636f 6e66 6964 656e  ductive confiden
-00003550: 6365 206d 6163 6869 6e65 7320 666f 7220  ce machines for 
-00003560: 7265 6772 6573 7369 6f6e 2e20 4575 726f  regression. Euro
-00003570: 7065 616e 2043 6f6e 6665 7265 6e63 6520  pean Conference 
-00003580: 6f6e 204d 6163 6869 6e65 204c 6561 726e  on Machine Learn
-00003590: 696e 672c 2070 702e 2033 3435 2d33 3536  ing, pp. 345-356
-000035a0: 2e20 5b4c 696e 6b5d 2868 7474 7073 3a2f  . [Link](https:/
-000035b0: 2f6c 696e 6b2e 7370 7269 6e67 6572 2e63  /link.springer.c
-000035c0: 6f6d 2f63 6861 7074 6572 2f31 302e 3130  om/chapter/10.10
-000035d0: 3037 2f33 2d35 3430 2d33 3637 3535 2d31  07/3-540-36755-1
-000035e0: 5f32 3929 0a0a 3c61 2069 643d 2233 223e  _29)..<a id="3">
-000035f0: 5b33 5d3c 2f61 3e20 4a6f 6861 6e73 736f  [3]</a> Johansso
-00003600: 6e2c 2055 2e2c 2042 6f73 7472 c3b6 6d2c  n, U., Bostr..m,
-00003610: 2048 2e2c 204c c3b6 6673 7472 c3b6 6d2c   H., L..fstr..m,
-00003620: 2054 2e20 616e 6420 4c69 6e75 7373 6f6e   T. and Linusson
-00003630: 2c20 482e 2c20 3230 3134 2e20 5265 6772  , H., 2014. Regr
-00003640: 6573 7369 6f6e 2063 6f6e 666f 726d 616c  ession conformal
-00003650: 2070 7265 6469 6374 696f 6e20 7769 7468   prediction with
-00003660: 2072 616e 646f 6d20 666f 7265 7374 732e   random forests.
-00003670: 204d 6163 6869 6e65 206c 6561 726e 696e   Machine learnin
-00003680: 672c 2039 3728 312d 3229 2c20 7070 2e20  g, 97(1-2), pp. 
-00003690: 3135 352d 3137 362e 205b 4c69 6e6b 5d28  155-176. [Link](
-000036a0: 6874 7470 733a 2f2f 6c69 6e6b 2e73 7072  https://link.spr
-000036b0: 696e 6765 722e 636f 6d2f 6172 7469 636c  inger.com/articl
-000036c0: 652f 3130 2e31 3030 372f 7331 3039 3934  e/10.1007/s10994
-000036d0: 2d30 3134 2d35 3435 332d 3029 0a0a 3c61  -014-5453-0)..<a
-000036e0: 2069 643d 2234 223e 5b34 5d3c 2f61 3e20   id="4">[4]</a> 
-000036f0: 426f 7374 72c3 b66d 2c20 482e 2c20 4c69  Bostr..m, H., Li
-00003700: 6e75 7373 6f6e 2c20 482e 2c20 4cc3 b666  nusson, H., L..f
-00003710: 7374 72c3 b66d 2c20 542e 2061 6e64 204a  str..m, T. and J
-00003720: 6f68 616e 7373 6f6e 2c20 552e 2c20 3230  ohansson, U., 20
-00003730: 3137 2e20 4163 6365 6c65 7261 7469 6e67  17. Accelerating
-00003740: 2064 6966 6669 6375 6c74 7920 6573 7469   difficulty esti
-00003750: 6d61 7469 6f6e 2066 6f72 2063 6f6e 666f  mation for confo
-00003760: 726d 616c 2072 6567 7265 7373 696f 6e20  rmal regression 
-00003770: 666f 7265 7374 732e 2041 6e6e 616c 7320  forests. Annals 
-00003780: 6f66 204d 6174 6865 6d61 7469 6373 2061  of Mathematics a
-00003790: 6e64 2041 7274 6966 6963 6961 6c20 496e  nd Artificial In
-000037a0: 7465 6c6c 6967 656e 6365 2c20 3831 2831  telligence, 81(1
-000037b0: 2d32 292c 2070 702e 3132 352d 3134 342e  -2), pp.125-144.
-000037c0: 205b 4c69 6e6b 5d28 6874 7470 733a 2f2f   [Link](https://
-000037d0: 6c69 6e6b 2e73 7072 696e 6765 722e 636f  link.springer.co
-000037e0: 6d2f 6172 7469 636c 652f 3130 2e31 3030  m/article/10.100
-000037f0: 372f 7331 3034 3732 2d30 3137 2d39 3533  7/s10472-017-953
-00003800: 392d 3929 0a0a 3c61 2069 643d 2235 223e  9-9)..<a id="5">
-00003810: 5b35 5d3c 2f61 3e20 426f 7374 72c3 b66d  [5]</a> Bostr..m
-00003820: 2c20 482e 2061 6e64 204a 6f68 616e 7373  , H. and Johanss
-00003830: 6f6e 2c20 552e 2c20 3230 3230 2e20 4d6f  on, U., 2020. Mo
-00003840: 6e64 7269 616e 2063 6f6e 666f 726d 616c  ndrian conformal
-00003850: 2072 6567 7265 7373 6f72 732e 2049 6e20   regressors. In 
-00003860: 436f 6e66 6f72 6d61 6c20 616e 6420 5072  Conformal and Pr
-00003870: 6f62 6162 696c 6973 7469 6320 5072 6564  obabilistic Pred
-00003880: 6963 7469 6f6e 2061 6e64 2041 7070 6c69  iction and Appli
-00003890: 6361 7469 6f6e 732e 2050 4d4c 522c 2031  cations. PMLR, 1
-000038a0: 3238 2c20 7070 2e20 3131 342d 3133 332e  28, pp. 114-133.
-000038b0: 205b 4c69 6e6b 5d28 6874 7470 733a 2f2f   [Link](https://
-000038c0: 7072 6f63 6565 6469 6e67 732e 6d6c 722e  proceedings.mlr.
-000038d0: 7072 6573 732f 7631 3238 2f62 6f73 7472  press/v128/bostr
-000038e0: 6f6d 3230 612e 6874 6d6c 290a 0a3c 6120  om20a.html)..<a 
-000038f0: 6964 3d22 3622 3e5b 365d 3c2f 613e 2056  id="6">[6]</a> V
-00003900: 6f76 6b2c 2056 2e2c 2050 6574 656a 2c20  ovk, V., Petej, 
-00003910: 492e 2c20 4e6f 7572 6574 6469 6e6f 762c  I., Nouretdinov,
-00003920: 2049 2e2c 204d 616e 6f6b 6869 6e2c 2056   I., Manokhin, V
-00003930: 2e20 616e 6420 4761 6d6d 6572 6d61 6e2c  . and Gammerman,
-00003940: 2041 2e2c 2032 3032 302e 2043 6f6d 7075   A., 2020. Compu
-00003950: 7461 7469 6f6e 616c 6c79 2065 6666 6963  tationally effic
-00003960: 6965 6e74 2076 6572 7369 6f6e 7320 6f66  ient versions of
-00003970: 2063 6f6e 666f 726d 616c 2070 7265 6469   conformal predi
-00003980: 6374 6976 6520 6469 7374 7269 6275 7469  ctive distributi
-00003990: 6f6e 732e 204e 6575 726f 636f 6d70 7574  ons. Neurocomput
-000039a0: 696e 672c 2033 3937 2c20 7070 2e32 3932  ing, 397, pp.292
-000039b0: 2d33 3038 2e20 5b4c 696e 6b5d 2868 7474  -308. [Link](htt
-000039c0: 7073 3a2f 2f77 7777 2e61 6d69 6e65 722e  ps://www.aminer.
-000039d0: 6f72 672f 7075 622f 3565 3039 6161 6339  org/pub/5e09aac9
-000039e0: 6466 3161 3963 3063 3431 3663 3962 3730  df1a9c0c416c9b70
-000039f0: 2f63 6f6d 7075 7461 7469 6f6e 616c 6c79  /computationally
-00003a00: 2d65 6666 6963 6965 6e74 2d76 6572 7369  -efficient-versi
-00003a10: 6f6e 732d 6f66 2d63 6f6e 666f 726d 616c  ons-of-conformal
-00003a20: 2d70 7265 6469 6374 6976 652d 6469 7374  -predictive-dist
-00003a30: 7269 6275 7469 6f6e 7329 0a0a 3c61 2069  ributions)..<a i
-00003a40: 643d 2237 223e 5b37 5d3c 2f61 3e20 426f  d="7">[7]</a> Bo
-00003a50: 7374 72c3 b66d 2c20 482e 2c20 4a6f 6861  str..m, H., Joha
-00003a60: 6e73 736f 6e2c 2055 2e20 616e 6420 4cc3  nsson, U. and L.
-00003a70: b666 7374 72c3 b66d 2c20 542e 2c20 3230  .fstr..m, T., 20
-00003a80: 3231 2e20 4d6f 6e64 7269 616e 2063 6f6e  21. Mondrian con
-00003a90: 666f 726d 616c 2070 7265 6469 6374 6976  formal predictiv
-00003aa0: 6520 6469 7374 7269 6275 7469 6f6e 732e  e distributions.
-00003ab0: 2049 6e20 436f 6e66 6f72 6d61 6c20 616e   In Conformal an
-00003ac0: 6420 5072 6f62 6162 696c 6973 7469 6320  d Probabilistic 
-00003ad0: 5072 6564 6963 7469 6f6e 2061 6e64 2041  Prediction and A
-00003ae0: 7070 6c69 6361 7469 6f6e 732e 2050 4d4c  pplications. PML
-00003af0: 522c 2031 3532 2c20 7070 2e20 3234 2d33  R, 152, pp. 24-3
-00003b00: 382e 205b 4c69 6e6b 5d28 6874 7470 733a  8. [Link](https:
-00003b10: 2f2f 7072 6f63 6565 6469 6e67 732e 6d6c  //proceedings.ml
-00003b20: 722e 7072 6573 732f 7631 3532 2f62 6f73  r.press/v152/bos
-00003b30: 7472 6f6d 3231 612e 6874 6d6c 290a 0a3c  trom21a.html)..<
-00003b40: 6120 6964 3d22 3822 3e5b 385d 3c2f 613e  a id="8">[8]</a>
-00003b50: 2056 6f76 6b2c 2056 2e2c 2032 3032 322e   Vovk, V., 2022.
-00003b60: 2055 6e69 7665 7273 616c 2070 7265 6469   Universal predi
-00003b70: 6374 6976 6520 7379 7374 656d 732e 2050  ctive systems. P
-00003b80: 6174 7465 726e 2052 6563 6f67 6e69 7469  attern Recogniti
-00003b90: 6f6e 2e20 3132 363a 2070 702e 2031 3038  on. 126: pp. 108
-00003ba0: 3533 3620 5b4c 696e 6b5d 2868 7474 7073  536 [Link](https
-00003bb0: 3a2f 2f64 6c2e 6163 6d2e 6f72 672f 646f  ://dl.acm.org/do
-00003bc0: 692f 6162 732f 3130 2e31 3031 362f 6a2e  i/abs/10.1016/j.
-00003bd0: 7061 7463 6f67 2e32 3032 322e 3130 3835  patcog.2022.1085
-00003be0: 3336 290a 0a0a 2d20 2d20 2d0a 0a41 7574  36)...- - -..Aut
-00003bf0: 686f 723a 2048 656e 7269 6b20 426f 7374  hor: Henrik Bost
-00003c00: 72c3 b66d 2028 626f 7374 726f 6d68 406b  r..m (bostromh@k
-00003c10: 7468 2e73 6529 0a43 6f70 7972 6967 6874  th.se).Copyright
-00003c20: 2032 3032 3320 4865 6e72 696b 2042 6f73   2023 Henrik Bos
-00003c30: 7472 c3b6 6d0a 4c69 6365 6e73 653a 2042  tr..m.License: B
-00003c40: 5344 2033 2063 6c61 7573 650a            SD 3 clause.
+00000530: 6765 2f63 7265 7065 732f 6261 6467 6573  ge/crepes/badges
+00000540: 2f70 6c61 7466 6f72 6d73 2e73 7667 2220  /platforms.svg" 
+00000550: 616c 743d 2250 6c61 7466 6f72 6d73 2220  alt="Platforms" 
+00000560: 6865 6967 6874 3d32 3020 616c 6967 6e3d  height=20 align=
+00000570: 2263 656e 7465 7222 3e3c 2f61 3e0a 3c61  "center"></a>.<a
+00000580: 2068 7265 663d 2268 7474 7073 3a2f 2f61   href="https://a
+00000590: 6e61 636f 6e64 612e 6f72 672f 636f 6e64  naconda.org/cond
+000005a0: 612d 666f 7267 652f 6372 6570 6573 223e  a-forge/crepes">
+000005b0: 3c69 6d67 2073 7263 3d22 6874 7470 733a  <img src="https:
+000005c0: 2f2f 616e 6163 6f6e 6461 2e6f 7267 2f63  //anaconda.org/c
+000005d0: 6f6e 6461 2d66 6f72 6765 2f63 7265 7065  onda-forge/crepe
+000005e0: 732f 6261 6467 6573 2f6c 6963 656e 7365  s/badges/license
+000005f0: 2e73 7667 2220 616c 743d 224c 6963 656e  .svg" alt="Licen
+00000600: 7365 2220 6865 6967 6874 3d32 3020 616c  se" height=20 al
+00000610: 6967 6e3d 2263 656e 7465 7222 3e3c 2f61  ign="center"></a
+00000620: 3e0a 3c61 2068 7265 663d 2268 7474 7073  >.<a href="https
+00000630: 3a2f 2f61 6e61 636f 6e64 612e 6f72 672f  ://anaconda.org/
+00000640: 636f 6e64 612d 666f 7267 652f 6372 6570  conda-forge/crep
+00000650: 6573 223e 3c69 6d67 2073 7263 3d22 6874  es"><img src="ht
+00000660: 7470 733a 2f2f 616e 6163 6f6e 6461 2e6f  tps://anaconda.o
+00000670: 7267 2f63 6f6e 6461 2d66 6f72 6765 2f63  rg/conda-forge/c
+00000680: 7265 7065 732f 6261 6467 6573 2f6c 6174  repes/badges/lat
+00000690: 6573 745f 7265 6c65 6173 655f 6461 7465  est_release_date
+000006a0: 2e73 7667 2220 616c 743d 2252 656c 6561  .svg" alt="Relea
+000006b0: 7365 2064 6174 6522 2068 6569 6768 743d  se date" height=
+000006c0: 3230 2061 6c69 676e 3d22 6365 6e74 6572  20 align="center
+000006d0: 223e 3c2f 613e 0a3c 2f70 3e0a 3c62 723e  "></a>.</p>.<br>
+000006e0: 0a0a 6063 7265 7065 7360 2069 7320 6120  ..`crepes` is a 
+000006f0: 5079 7468 6f6e 2070 6163 6b61 6765 2066  Python package f
+00000700: 6f72 2067 656e 6572 6174 696e 6720 2a63  or generating *c
+00000710: 6f6e 666f 726d 616c 2072 6567 7265 7373  onformal regress
+00000720: 6f72 732a 2c20 7768 6963 6820 7472 616e  ors*, which tran
+00000730: 7366 6f72 6d20 706f 696e 7420 7072 6564  sform point pred
+00000740: 6963 7469 6f6e 7320 6f66 2061 6e79 2075  ictions of any u
+00000750: 6e64 6572 6c79 696e 6720 7265 6772 6573  nderlying regres
+00000760: 7369 6f6e 206d 6f64 656c 2069 6e74 6f20  sion model into 
+00000770: 7072 6564 6963 7469 6f6e 2069 6e74 6572  prediction inter
+00000780: 7661 6c73 2066 6f72 2073 7065 6369 6669  vals for specifi
+00000790: 6564 206c 6576 656c 7320 6f66 2063 6f6e  ed levels of con
+000007a0: 6669 6465 6e63 652e 2054 6865 2070 6163  fidence. The pac
+000007b0: 6b61 6765 2061 6c73 6f20 696d 706c 656d  kage also implem
+000007c0: 656e 7473 202a 636f 6e66 6f72 6d61 6c20  ents *conformal 
+000007d0: 7072 6564 6963 7469 7665 2073 7973 7465  predictive syste
+000007e0: 6d73 2a2c 2077 6869 6368 2074 7261 6e73  ms*, which trans
+000007f0: 666f 726d 2074 6865 2070 6f69 6e74 2070  form the point p
+00000800: 7265 6469 6374 696f 6e73 2069 6e74 6f20  redictions into 
+00000810: 6375 6d75 6c61 7469 7665 2064 6973 7472  cumulative distr
+00000820: 6962 7574 696f 6e20 6675 6e63 7469 6f6e  ibution function
+00000830: 732e 0a0a 5468 6520 6063 7265 7065 7360  s...The `crepes`
+00000840: 2070 6163 6b61 6765 2069 6d70 6c65 6d65   package impleme
+00000850: 6e74 7320 7374 616e 6461 7264 2c20 6e6f  nts standard, no
+00000860: 726d 616c 697a 6564 2061 6e64 204d 6f6e  rmalized and Mon
+00000870: 6472 6961 6e20 636f 6e66 6f72 6d61 6c20  drian conformal 
+00000880: 7265 6772 6573 736f 7273 2061 6e64 2070  regressors and p
+00000890: 7265 6469 6374 6976 6520 7379 7374 656d  redictive system
+000008a0: 732e 2057 6869 6c65 2074 6865 2070 6163  s. While the pac
+000008b0: 6b61 6765 2061 6c6c 6f77 7320 796f 7520  kage allows you 
+000008c0: 746f 2075 7365 2079 6f75 7220 6f77 6e20  to use your own 
+000008d0: 6469 6666 6963 756c 7479 2065 7374 696d  difficulty estim
+000008e0: 6174 6573 2061 6e64 204d 6f6e 6472 6961  ates and Mondria
+000008f0: 6e20 6361 7465 676f 7269 6573 2c20 7468  n categories, th
+00000900: 6572 6520 6973 2061 6c73 6f20 6120 7365  ere is also a se
+00000910: 7061 7261 7465 206d 6f64 756c 652c 2063  parate module, c
+00000920: 616c 6c65 6420 6063 7265 7065 732e 6669  alled `crepes.fi
+00000930: 6c6c 696e 6773 602c 2077 6869 6368 2070  llings`, which p
+00000940: 726f 7669 6465 7320 736f 6d65 2073 7461  rovides some sta
+00000950: 6e64 6172 6420 6f70 7469 6f6e 7320 666f  ndard options fo
+00000960: 7220 7468 6573 652e 0a0a 2323 2049 6e73  r these...## Ins
+00000970: 7461 6c6c 6174 696f 6e0a 0a46 726f 6d20  tallation..From 
+00000980: 5b50 7950 495d 2868 7474 7073 3a2f 2f70  [PyPI](https://p
+00000990: 7970 692e 6f72 672f 7072 6f6a 6563 742f  ypi.org/project/
+000009a0: 6372 6570 6573 2f29 0a0a 6060 6062 6173  crepes/)..```bas
+000009b0: 680a 7069 7020 696e 7374 616c 6c20 6372  h.pip install cr
+000009c0: 6570 6573 0a60 6060 0a0a 4672 6f6d 205b  epes.```..From [
+000009d0: 636f 6e64 612d 666f 7267 655d 2868 7474  conda-forge](htt
+000009e0: 7073 3a2f 2f61 6e61 636f 6e64 612e 6f72  ps://anaconda.or
+000009f0: 672f 636f 6e64 612d 666f 7267 652f 6372  g/conda-forge/cr
+00000a00: 6570 6573 290a 0a60 6060 6261 7368 0a63  epes)..```bash.c
+00000a10: 6f6e 6461 2069 6e73 7461 6c6c 202d 6320  onda install -c 
+00000a20: 636f 6e64 612d 666f 7267 6520 6372 6570  conda-forge crep
+00000a30: 6573 0a60 6060 0a0a 2323 2044 6f63 756d  es.```..## Docum
+00000a40: 656e 7461 7469 6f6e 0a0a 466f 7220 7468  entation..For th
+00000a50: 6520 636f 6d70 6c65 7465 2064 6f63 756d  e complete docum
+00000a60: 656e 7461 7469 6f6e 2c20 7365 6520 5b68  entation, see [h
+00000a70: 6572 655d 2868 7474 7073 3a2f 2f63 7265  ere](https://cre
+00000a80: 7065 732e 7265 6164 7468 6564 6f63 732e  pes.readthedocs.
+00000a90: 696f 2f65 6e2f 6c61 7465 7374 2f29 2e0a  io/en/latest/)..
+00000aa0: 0a23 2320 5175 6963 6b73 7461 7274 0a0a  .## Quickstart..
+00000ab0: 5765 2066 6972 7374 2069 6d70 6f72 7420  We first import 
+00000ac0: 7468 6520 636c 6173 7320 6057 7261 7060  the class `Wrap`
+00000ad0: 2066 726f 6d20 6063 7265 7065 7360 2061   from `crepes` a
+00000ae0: 6e64 2061 2068 656c 7065 7220 636c 6173  nd a helper clas
+00000af0: 7320 616e 6420 6675 6e63 7469 6f6e 2066  s and function f
+00000b00: 726f 6d20 6063 7265 7065 732e 6578 7472  rom `crepes.extr
+00000b10: 6173 603a 0a0a 6060 6070 7974 686f 6e0a  as`:..```python.
+00000b20: 6672 6f6d 2063 7265 7065 7320 696d 706f  from crepes impo
+00000b30: 7274 2057 7261 700a 6672 6f6d 2063 7265  rt Wrap.from cre
+00000b40: 7065 732e 6578 7472 6173 2069 6d70 6f72  pes.extras impor
+00000b50: 7420 4469 6666 6963 756c 7479 4573 7469  t DifficultyEsti
+00000b60: 6d61 746f 722c 2062 696e 6e69 6e67 0a60  mator, binning.`
+00000b70: 6060 0a0a 4c65 7420 7573 2061 6c73 6f20  ``..Let us also 
+00000b80: 696d 706f 7274 2073 6f6d 6520 6164 6469  import some addi
+00000b90: 7469 6f6e 616c 2066 756e 6374 696f 6e73  tional functions
+00000ba0: 2061 6e64 2061 2063 6c61 7373 2074 6f20   and a class to 
+00000bb0: 696c 6c75 7374 7261 7465 2074 6865 2061  illustrate the a
+00000bc0: 626f 7665 2075 7369 6e67 2061 2064 6174  bove using a dat
+00000bd0: 6173 6574 2066 726f 6d20 5b77 7777 2e6f  aset from [www.o
+00000be0: 7065 6e6d 6c2e 6f72 675d 2868 7474 7073  penml.org](https
+00000bf0: 3a2f 2f77 7777 2e6f 7065 6e6d 6c2e 6f72  ://www.openml.or
+00000c00: 6729 2061 6e64 2061 2060 5261 6e64 6f6d  g) and a `Random
+00000c10: 466f 7265 7374 5265 6772 6573 736f 7260  ForestRegressor`
+00000c20: 2066 726f 6d20 5b73 6b6c 6561 726e 5d28   from [sklearn](
+00000c30: 6874 7470 733a 2f2f 7363 696b 6974 2d6c  https://scikit-l
+00000c40: 6561 726e 2e6f 7267 293a 0a0a 6060 6070  earn.org):..```p
+00000c50: 7974 686f 6e0a 6672 6f6d 2073 6b6c 6561  ython.from sklea
+00000c60: 726e 2e64 6174 6173 6574 7320 696d 706f  rn.datasets impo
+00000c70: 7274 2066 6574 6368 5f6f 7065 6e6d 6c0a  rt fetch_openml.
+00000c80: 6672 6f6d 2073 6b6c 6561 726e 2e6d 6f64  from sklearn.mod
+00000c90: 656c 5f73 656c 6563 7469 6f6e 2069 6d70  el_selection imp
+00000ca0: 6f72 7420 7472 6169 6e5f 7465 7374 5f73  ort train_test_s
+00000cb0: 706c 6974 0a66 726f 6d20 736b 6c65 6172  plit.from sklear
+00000cc0: 6e2e 656e 7365 6d62 6c65 2069 6d70 6f72  n.ensemble impor
+00000cd0: 7420 5261 6e64 6f6d 466f 7265 7374 5265  t RandomForestRe
+00000ce0: 6772 6573 736f 720a 6060 600a 0a57 6520  gressor.```..We 
+00000cf0: 7769 6c6c 206e 6f77 2069 6d70 6f72 7420  will now import 
+00000d00: 616e 6420 7370 6c69 7420 7468 6520 6461  and split the da
+00000d10: 7461 7365 7420 696e 746f 2061 2074 7261  taset into a tra
+00000d20: 696e 696e 6720 616e 6420 6120 7465 7374  ining and a test
+00000d30: 2073 6574 2c20 616e 6420 7468 656e 2066   set, and then f
+00000d40: 7572 7468 6572 2073 706c 6974 2074 6865  urther split the
+00000d50: 2074 7261 696e 696e 6720 7365 7420 696e   training set in
+00000d60: 746f 2061 2070 726f 7065 7220 7472 6169  to a proper trai
+00000d70: 6e69 6e67 2073 6574 2061 6e64 2061 2063  ning set and a c
+00000d80: 616c 6962 7261 7469 6f6e 2073 6574 3a0a  alibration set:.
+00000d90: 0a60 6060 7079 7468 6f6e 0a64 6174 6173  .```python.datas
+00000da0: 6574 203d 2066 6574 6368 5f6f 7065 6e6d  et = fetch_openm
+00000db0: 6c28 6e61 6d65 3d22 686f 7573 655f 7361  l(name="house_sa
+00000dc0: 6c65 7322 2c20 7665 7273 696f 6e3d 3329  les", version=3)
+00000dd0: 0a58 203d 2064 6174 6173 6574 2e64 6174  .X = dataset.dat
+00000de0: 612e 7661 6c75 6573 2e61 7374 7970 6528  a.values.astype(
+00000df0: 666c 6f61 7429 0a79 203d 2064 6174 6173  float).y = datas
+00000e00: 6574 2e74 6172 6765 742e 7661 6c75 6573  et.target.values
+00000e10: 2e61 7374 7970 6528 666c 6f61 7429 0a0a  .astype(float)..
+00000e20: 585f 7472 6169 6e2c 2058 5f74 6573 742c  X_train, X_test,
+00000e30: 2079 5f74 7261 696e 2c20 795f 7465 7374   y_train, y_test
+00000e40: 203d 2074 7261 696e 5f74 6573 745f 7370   = train_test_sp
+00000e50: 6c69 7428 582c 2079 2c20 7465 7374 5f73  lit(X, y, test_s
+00000e60: 697a 653d 302e 3529 0a0a 585f 7072 6f70  ize=0.5)..X_prop
+00000e70: 5f74 7261 696e 2c20 585f 6361 6c2c 2079  _train, X_cal, y
+00000e80: 5f70 726f 705f 7472 6169 6e2c 2079 5f63  _prop_train, y_c
+00000e90: 616c 203d 2074 7261 696e 5f74 6573 745f  al = train_test_
+00000ea0: 7370 6c69 7428 585f 7472 6169 6e2c 2079  split(X_train, y
+00000eb0: 5f74 7261 696e 2c0a 2020 2020 2020 2020  _train,.        
+00000ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000ef0: 2020 2020 7465 7374 5f73 697a 653d 302e      test_size=0.
+00000f00: 3235 290a 6060 600a 0a4c 6574 2075 7320  25).```..Let us 
+00000f10: 6e6f 7720 2277 7261 7022 2061 2072 616e  now "wrap" a ran
+00000f20: 646f 6d20 666f 7265 7374 2072 6567 7265  dom forest regre
+00000f30: 7373 6f72 2061 6e64 2066 6974 2069 7420  ssor and fit it 
+00000f40: 2869 6e20 7468 6520 7573 7561 6c20 7761  (in the usual wa
+00000f50: 7929 2074 6f20 7468 6520 7072 6f70 6572  y) to the proper
+00000f60: 2074 7261 696e 696e 6720 7365 743a 0a0a   training set:..
+00000f70: 6060 6070 7974 686f 6e0a 7266 203d 2057  ```python.rf = W
+00000f80: 7261 7028 5261 6e64 6f6d 466f 7265 7374  rap(RandomForest
+00000f90: 5265 6772 6573 736f 7228 2929 0a72 662e  Regressor()).rf.
+00000fa0: 6669 7428 585f 7072 6f70 5f74 7261 696e  fit(X_prop_train
+00000fb0: 2c20 795f 7072 6f70 5f74 7261 696e 290a  , y_prop_train).
+00000fc0: 6060 600a 0a57 6520 6361 6e20 7573 6520  ```..We can use 
+00000fd0: 7468 6520 6669 7474 6564 206d 6f64 656c  the fitted model
+00000fe0: 2074 6f20 6f62 7461 696e 2070 6f69 6e74   to obtain point
+00000ff0: 2070 7265 6469 6374 696f 6e73 2028 6167   predictions (ag
+00001000: 6169 6e2c 2069 6e20 7468 6520 7573 7561  ain, in the usua
+00001010: 6c20 7761 7929 2066 6f72 2074 6865 2063  l way) for the c
+00001020: 616c 6962 7261 7469 6f6e 206f 626a 6563  alibration objec
+00001030: 7473 2c20 6672 6f6d 2077 6869 6368 2077  ts, from which w
+00001040: 6520 6361 6e20 6361 6c63 756c 6174 6520  e can calculate 
+00001050: 7468 6520 7265 7369 6475 616c 732e 2054  the residuals. T
+00001060: 6865 7365 2072 6573 6964 7561 6c73 2061  hese residuals a
+00001070: 7265 2065 7861 6374 6c79 2077 6861 7420  re exactly what 
+00001080: 7765 206e 6565 6420 746f 2022 6361 6c69  we need to "cali
+00001090: 6272 6174 6522 2074 6865 206c 6561 726e  brate" the learn
+000010a0: 6572 3a20 0a0a 6060 6070 7974 686f 6e0a  er: ..```python.
+000010b0: 7265 7369 6475 616c 7320 3d20 795f 6361  residuals = y_ca
+000010c0: 6c20 2d20 7266 2e70 7265 6469 6374 2858  l - rf.predict(X
+000010d0: 5f63 616c 290a 7266 2e63 616c 6962 7261  _cal).rf.calibra
+000010e0: 7465 2872 6573 6964 7561 6c73 290a 6060  te(residuals).``
+000010f0: 600a 0a41 2028 7374 616e 6461 7264 2920  `..A (standard) 
+00001100: 636f 6e66 6f72 6d61 6c20 7265 6772 6573  conformal regres
+00001110: 736f 7220 7761 7320 666f 726d 6564 2028  sor was formed (
+00001120: 756e 6465 7220 7468 6520 686f 6f64 292e  under the hood).
+00001130: 2057 6520 6d61 7920 6e6f 7720 7573 6520   We may now use 
+00001140: 6974 2066 6f72 206f 6274 6169 6e69 6e67  it for obtaining
+00001150: 2070 7265 6469 6374 696f 6e20 696e 7465   prediction inte
+00001160: 7276 616c 7320 666f 7220 7468 6520 7465  rvals for the te
+00001170: 7374 2073 6574 2c20 6865 7265 2075 7369  st set, here usi
+00001180: 6e67 2061 2063 6f6e 6669 6465 6e63 6520  ng a confidence 
+00001190: 6c65 7665 6c20 6f66 2039 3925 3a0a 0a60  level of 99%:..`
+000011a0: 6060 7079 7468 6f6e 0a72 662e 7072 6564  ``python.rf.pred
+000011b0: 6963 745f 696e 7428 585f 7465 7374 2c20  ict_int(X_test, 
+000011c0: 636f 6e66 6964 656e 6365 3d30 2e39 3929  confidence=0.99)
+000011d0: 0a60 6060 0a0a 6060 606e 756d 7079 0a61  .```..```numpy.a
+000011e0: 7272 6179 285b 5b2d 3137 3139 3032 2e32  rray([[-171902.2
+000011f0: 202c 2020 3935 3338 3636 2e32 205d 2c0a   ,  953866.2 ],.
+00001200: 2020 2020 2020 205b 2d32 3736 3831 382e         [-276818.
+00001210: 3031 2c20 2038 3438 3935 302e 3339 5d2c  01,  848950.39],
+00001220: 0a20 2020 2020 2020 5b20 2032 3236 3739  .       [  22679
+00001230: 2e33 372c 2031 3134 3834 3437 2e37 375d  .37, 1148447.77]
+00001240: 2c0a 2020 2020 2020 202e 2e2e 2c0a 2020  ,.       ...,.  
+00001250: 2020 2020 205b 2032 3432 3935 342e 3032       [ 242954.02
+00001260: 2c20 3133 3638 3732 322e 3432 5d2c 0a20  , 1368722.42],. 
+00001270: 2020 2020 2020 5b2d 3330 3830 3933 2e37        [-308093.7
+00001280: 332c 2020 3831 3736 3734 2e36 375d 2c0a  3,  817674.67],.
+00001290: 2020 2020 2020 205b 2d32 3237 3035 372e         [-227057.
+000012a0: 3420 2c20 2038 3938 3731 312e 2020 5d5d  4 ,  898711.  ]]
+000012b0: 290a 6060 600a 0a54 6865 206f 7574 7075  ).```..The outpu
+000012c0: 7420 6973 2061 205b 4e75 6d50 795d 2868  t is a [NumPy](h
+000012d0: 7474 7073 3a2f 2f6e 756d 7079 2e6f 7267  ttps://numpy.org
+000012e0: 2920 6172 7261 7920 7769 7468 2061 2072  ) array with a r
+000012f0: 6f77 2066 6f72 2065 6163 6820 7465 7374  ow for each test
+00001300: 2069 6e73 7461 6e63 652c 2061 6e64 2077   instance, and w
+00001310: 6865 7265 2074 6865 2074 776f 2063 6f6c  here the two col
+00001320: 756d 6e73 2073 7065 6369 6679 2074 6865  umns specify the
+00001330: 206c 6f77 6572 2061 6e64 2075 7070 6572   lower and upper
+00001340: 2062 6f75 6e64 206f 6620 6561 6368 2070   bound of each p
+00001350: 7265 6469 6374 696f 6e20 696e 7465 7276  rediction interv
+00001360: 616c 2e0a 0a57 6520 6d61 7920 7265 7175  al...We may requ
+00001370: 6573 7420 7468 6174 2074 6865 2069 6e74  est that the int
+00001380: 6572 7661 6c73 2061 7265 2063 7574 2074  ervals are cut t
+00001390: 6f20 6578 636c 7564 6520 696d 706f 7373  o exclude imposs
+000013a0: 6962 6c65 2076 616c 7565 732c 2069 6e20  ible values, in 
+000013b0: 7468 6973 2063 6173 6520 6265 6c6f 7720  this case below 
+000013c0: 302c 2061 6e64 2069 6620 7765 2061 6c73  0, and if we als
+000013d0: 6f20 7265 6c79 206f 6e20 7468 6520 6465  o rely on the de
+000013e0: 6661 756c 7420 636f 6e66 6964 656e 6365  fault confidence
+000013f0: 206c 6576 656c 2028 302e 3935 292c 2074   level (0.95), t
+00001400: 6865 206f 7574 7075 7420 696e 7465 7276  he output interv
+00001410: 616c 7320 7769 6c6c 2062 6520 6120 6269  als will be a bi
+00001420: 7420 7469 6768 7465 723a 0a0a 6060 6070  t tighter:..```p
+00001430: 7974 686f 6e0a 7266 2e70 7265 6469 6374  ython.rf.predict
+00001440: 5f69 6e74 2858 5f74 6573 742c 2079 5f6d  _int(X_test, y_m
+00001450: 696e 3d30 290a 6060 600a 0a60 6060 6e75  in=0).```..```nu
+00001460: 6d70 790a 6172 7261 7928 5b5b 2031 3532  mpy.array([[ 152
+00001470: 3235 382e 3535 2c20 2036 3239 3730 352e  258.55,  629705.
+00001480: 3435 5d2c 0a20 2020 2020 2020 5b20 2034  45],.       [  4
+00001490: 3733 3432 2e37 342c 2020 3532 3437 3839  7342.74,  524789
+000014a0: 2e36 345d 2c0a 2020 2020 2020 205b 2033  .64],.       [ 3
+000014b0: 3436 3834 302e 3132 2c20 2038 3234 3238  46840.12,  82428
+000014c0: 372e 3032 5d2c 0a20 2020 2020 2020 2e2e  7.02],.       ..
+000014d0: 2e2c 0a20 2020 2020 2020 5b20 3536 3731  .,.       [ 5671
+000014e0: 3134 2e37 372c 2031 3034 3435 3631 2e36  14.77, 1044561.6
+000014f0: 375d 2c0a 2020 2020 2020 205b 2020 3136  7],.       [  16
+00001500: 3036 372e 3032 2c20 2034 3933 3531 332e  067.02,  493513.
+00001510: 3932 5d2c 0a20 2020 2020 2020 5b20 2039  92],.       [  9
+00001520: 3731 3033 2e33 352c 2020 3537 3435 3530  7103.35,  574550
+00001530: 2e32 355d 5d29 0a60 6060 0a0a 5468 6520  .25]]).```..The 
+00001540: 6162 6f76 6520 696e 7465 7276 616c 7320  above intervals 
+00001550: 6172 6520 6e6f 7420 6e6f 726d 616c 697a  are not normaliz
+00001560: 6564 2c20 692e 652e 2c20 7468 6579 2061  ed, i.e., they a
+00001570: 7265 2061 6c6c 206f 6620 7468 6520 7361  re all of the sa
+00001580: 6d65 2073 697a 6520 2861 7420 6c65 6173  me size (at leas
+00001590: 7420 6265 666f 7265 2074 6865 7920 6172  t before they ar
+000015a0: 6520 6375 7429 2e20 5765 2063 6f75 6c64  e cut). We could
+000015b0: 206d 616b 6520 7468 656d 206d 6f72 6520   make them more 
+000015c0: 696e 666f 726d 6174 6976 6520 7468 726f  informative thro
+000015d0: 7567 6820 6e6f 726d 616c 697a 6174 696f  ugh normalizatio
+000015e0: 6e20 7573 696e 6720 6469 6666 6963 756c  n using difficul
+000015f0: 7479 2065 7374 696d 6174 6573 3b20 6f62  ty estimates; ob
+00001600: 6a65 6374 7320 636f 6e73 6964 6572 6564  jects considered
+00001610: 206d 6f72 6520 6469 6666 6963 756c 7420   more difficult 
+00001620: 7769 6c6c 2062 6520 6173 7369 676e 6564  will be assigned
+00001630: 2077 6964 6572 2069 6e74 6572 7661 6c73   wider intervals
+00001640: 2e0a 0a57 6520 7769 6c6c 2075 7365 2061  ...We will use a
+00001650: 2060 4469 6666 6963 756c 7479 4573 7469   `DifficultyEsti
+00001660: 6d61 746f 7260 2066 6f72 2074 6869 7320  mator` for this 
+00001670: 7075 7270 6f73 652e 2048 6572 6520 6974  purpose. Here it
+00001680: 2065 7374 696d 6174 6573 2074 6865 2064   estimates the d
+00001690: 6966 6669 6375 6c74 7920 6279 2074 6865  ifficulty by the
+000016a0: 2073 7461 6e64 6172 6420 6465 7669 6174   standard deviat
+000016b0: 696f 6e20 6f66 2074 6865 2074 6172 6765  ion of the targe
+000016c0: 7420 6f66 2074 6865 206b 2028 6465 6661  t of the k (defa
+000016d0: 756c 7420 606b 3d32 3560 2920 6e65 6172  ult `k=25`) near
+000016e0: 6573 7420 6e65 6967 6862 6f72 7320 696e  est neighbors in
+000016f0: 2074 6865 2070 726f 7065 7220 7472 6169   the proper trai
+00001700: 6e69 6e67 2073 6574 2074 6f20 6561 6368  ning set to each
+00001710: 206f 626a 6563 7420 696e 2074 6865 2063   object in the c
+00001720: 616c 6962 7261 7469 6f6e 2073 6574 2e20  alibration set. 
+00001730: 4120 736d 616c 6c20 7661 6c75 6520 2862  A small value (b
+00001740: 6574 6129 2069 7320 6164 6465 6420 746f  eta) is added to
+00001750: 2074 6865 2065 7374 696d 6174 6573 2c20   the estimates, 
+00001760: 7768 6963 6820 6d61 7920 6265 2067 6976  which may be giv
+00001770: 656e 2074 6872 6f75 6768 2061 6e20 6172  en through an ar
+00001780: 6775 6d65 6e74 2074 6f20 7468 6520 6675  gument to the fu
+00001790: 6e63 7469 6f6e 3b20 6265 6c6f 7720 7765  nction; below we
+000017a0: 206a 7573 7420 7573 6520 7468 6520 6465   just use the de
+000017b0: 6661 756c 742c 2069 2e65 2e2c 2060 6265  fault, i.e., `be
+000017c0: 7461 3d30 2e30 3160 2e0a 0a57 6520 6669  ta=0.01`...We fi
+000017d0: 7273 7420 6f62 7461 696e 2074 6865 2064  rst obtain the d
+000017e0: 6966 6669 6375 6c74 7920 6573 7469 6d61  ifficulty estima
+000017f0: 7465 7320 666f 7220 7468 6520 6361 6c69  tes for the cali
+00001800: 6272 6174 696f 6e20 7365 743a 0a0a 6060  bration set:..``
+00001810: 6070 7974 686f 6e0a 6465 203d 2044 6966  `python.de = Dif
+00001820: 6669 6375 6c74 7945 7374 696d 6174 6f72  ficultyEstimator
+00001830: 2829 0a64 652e 6669 7428 585f 7072 6f70  ().de.fit(X_prop
+00001840: 5f74 7261 696e 2c20 793d 795f 7072 6f70  _train, y=y_prop
+00001850: 5f74 7261 696e 290a 0a73 6967 6d61 735f  _train)..sigmas_
+00001860: 6361 6c20 3d20 6465 2e61 7070 6c79 2858  cal = de.apply(X
+00001870: 5f63 616c 290a 6060 600a 0a54 6865 7365  _cal).```..These
+00001880: 2063 616e 206e 6f77 2062 6520 7573 6564   can now be used
+00001890: 2066 6f72 2074 6865 2063 616c 6962 7261   for the calibra
+000018a0: 7469 6f6e 2c20 7768 6963 6820 2875 6e64  tion, which (und
+000018b0: 6572 2074 6865 2068 6f6f 6429 2077 696c  er the hood) wil
+000018c0: 6c20 7072 6f64 7563 6520 6120 6e6f 726d  l produce a norm
+000018d0: 616c 697a 6564 2063 6f6e 666f 726d 616c  alized conformal
+000018e0: 2072 6567 7265 7373 6f72 3a0a 0a60 6060   regressor:..```
+000018f0: 7079 7468 6f6e 0a72 662e 6361 6c69 6272  python.rf.calibr
+00001900: 6174 6528 7265 7369 6475 616c 732c 2073  ate(residuals, s
+00001910: 6967 6d61 733d 7369 676d 6173 5f63 616c  igmas=sigmas_cal
+00001920: 290a 6060 600a 0a57 6520 6e65 6564 2064  ).```..We need d
+00001930: 6966 6669 6375 6c74 7920 6573 7469 6d61  ifficulty estima
+00001940: 7465 7320 666f 7220 7468 6520 7465 7374  tes for the test
+00001950: 2073 6574 2074 6f6f 2c20 7768 6963 6820   set too, which 
+00001960: 7765 2070 726f 7669 6465 2061 7320 696e  we provide as in
+00001970: 7075 7420 746f 2060 7072 6564 6963 745f  put to `predict_
+00001980: 696e 7460 3a0a 6060 6070 7974 686f 6e0a  int`:.```python.
+00001990: 7369 676d 6173 5f74 6573 7420 3d20 6465  sigmas_test = de
+000019a0: 2e61 7070 6c79 2858 5f74 6573 7429 0a72  .apply(X_test).r
+000019b0: 662e 7072 6564 6963 745f 696e 7428 585f  f.predict_int(X_
+000019c0: 7465 7374 2c20 7369 676d 6173 3d73 6967  test, sigmas=sig
+000019d0: 6d61 735f 7465 7374 2c20 795f 6d69 6e3d  mas_test, y_min=
+000019e0: 3029 0a60 6060 0a0a 6060 606e 756d 7079  0).```..```numpy
+000019f0: 0a61 7272 6179 285b 5b20 3232 3637 3139  .array([[ 226719
+00001a00: 2e30 3636 3037 3937 372c 2020 3535 3532  .06607977,  5552
+00001a10: 3434 2e39 3333 3932 3032 335d 2c0a 2020  44.93392023],.  
+00001a20: 2020 2020 205b 2031 3733 3736 372e 3930       [ 173767.90
+00001a30: 3735 3337 3135 2c20 2033 3938 3336 342e  753715,  398364.
+00001a40: 3437 3234 3632 3835 5d2c 0a20 2020 2020  47246285],.     
+00001a50: 2020 5b20 3132 3436 3930 2e37 3031 3636    [ 124690.70166
+00001a60: 3936 362c 2031 3034 3634 3336 2e34 3338  966, 1046436.438
+00001a70: 3333 3033 345d 2c0a 2020 2020 2020 202e  33034],.       .
+00001a80: 2e2e 2c0a 2020 2020 2020 205b 2036 3037  ..,.       [ 607
+00001a90: 3934 392e 3731 3534 3035 3732 2c20 3130  949.71540572, 10
+00001aa0: 3033 3732 362e 3732 3435 3934 3238 5d2c  03726.72459428],
+00001ab0: 0a20 2020 2020 2020 5b20 3138 3836 3731  .       [ 188671
+00001ac0: 2e33 3735 3232 3738 202c 2020 3332 3039  .3752278 ,  3209
+00001ad0: 3039 2e35 3634 3737 3232 205d 2c0a 2020  09.5647722 ],.  
+00001ae0: 2020 2020 205b 2031 3435 3334 302e 3339       [ 145340.39
+00001af0: 3037 3638 3234 2c20 2035 3236 3331 332e  076824,  526313.
+00001b00: 3230 3932 3331 3736 5d5d 290a 6060 600a  20923176]]).```.
+00001b10: 0a44 6570 656e 6469 6e67 206f 6e20 7468  .Depending on th
+00001b20: 6520 656d 706c 6f79 6564 2064 6966 6669  e employed diffi
+00001b30: 6375 6c74 7920 6573 7469 6d61 746f 722c  culty estimator,
+00001b40: 2074 6865 206e 6f72 6d61 6c69 7a65 6420   the normalized 
+00001b50: 696e 7465 7276 616c 7320 6d61 7920 736f  intervals may so
+00001b60: 6d65 7469 6d65 7320 6265 2075 6e72 6561  metimes be unrea
+00001b70: 736f 6e61 626c 7920 6c61 7267 652c 2069  sonably large, i
+00001b80: 6e20 7468 6520 7365 6e73 6520 7468 6174  n the sense that
+00001b90: 2074 6865 7920 6d61 7920 6265 2073 6576   they may be sev
+00001ba0: 6572 616c 2074 696d 6573 206c 6172 6765  eral times large
+00001bb0: 7220 7468 616e 2061 6e79 2070 7265 7669  r than any previ
+00001bc0: 6f75 736c 7920 6f62 7365 7276 6564 2065  ously observed e
+00001bd0: 7272 6f72 2e20 4d6f 7265 6f76 6572 2c20  rror. Moreover, 
+00001be0: 6966 2074 6865 2064 6966 6669 6375 6c74  if the difficult
+00001bf0: 7920 6573 7469 6d61 746f 7220 6973 2075  y estimator is u
+00001c00: 6e69 6e66 6f72 6d61 7469 7665 2c20 652e  ninformative, e.
+00001c10: 672e 2c20 636f 6d70 6c65 7465 6c79 2072  g., completely r
+00001c20: 616e 646f 6d2c 2074 6865 2076 6172 7969  andom, the varyi
+00001c30: 6e67 2069 6e74 6572 7661 6c20 7369 7a65  ng interval size
+00001c40: 7320 6d61 7920 6769 7665 2061 2066 616c  s may give a fal
+00001c50: 7365 2069 6d70 7265 7373 696f 6e20 6f66  se impression of
+00001c60: 2074 6861 7420 7765 2063 616e 2065 7870   that we can exp
+00001c70: 6563 7420 6c6f 7765 7220 7072 6564 6963  ect lower predic
+00001c80: 7469 6f6e 2065 7272 6f72 7320 666f 7220  tion errors for 
+00001c90: 696e 7374 616e 6365 7320 7769 7468 2074  instances with t
+00001ca0: 6967 6874 6572 2069 6e74 6572 7661 6c73  ighter intervals
+00001cb0: 2e20 4964 6561 6c6c 792c 2061 2064 6966  . Ideally, a dif
+00001cc0: 6669 6375 6c74 7920 6573 7469 6d61 746f  ficulty estimato
+00001cd0: 7220 7072 6f76 6964 696e 6720 6c69 7474  r providing litt
+00001ce0: 6c65 206f 7220 6e6f 2069 6e66 6f72 6d61  le or no informa
+00001cf0: 7469 6f6e 206f 6e20 7468 6520 6578 7065  tion on the expe
+00001d00: 6374 6564 2065 7272 6f72 2073 686f 756c  cted error shoul
+00001d10: 6420 696e 7374 6561 6420 6c65 6164 2074  d instead lead t
+00001d20: 6f20 6d6f 7265 2075 6e69 666f 726d 6c79  o more uniformly
+00001d30: 2064 6973 7472 6962 7574 6564 2069 6e74   distributed int
+00001d40: 6572 7661 6c20 7369 7a65 732e 0a0a 4120  erval sizes...A 
+00001d50: 4d6f 6e64 7269 616e 2063 6f6e 666f 726d  Mondrian conform
+00001d60: 616c 2072 6567 7265 7373 6f72 2063 616e  al regressor can
+00001d70: 2062 6520 7573 6564 2074 6f20 6164 6472   be used to addr
+00001d80: 6573 7320 7468 6573 6520 7072 6f62 6c65  ess these proble
+00001d90: 6d73 2c20 6279 2064 6976 6964 696e 6720  ms, by dividing 
+00001da0: 7468 6520 6f62 6a65 6374 2073 7061 6365  the object space
+00001db0: 2069 6e74 6f20 6e6f 6e2d 6f76 6572 6c61   into non-overla
+00001dc0: 7070 696e 6720 736f 2d63 616c 6c65 6420  pping so-called 
+00001dd0: 4d6f 6e64 7269 616e 2063 6174 6567 6f72  Mondrian categor
+00001de0: 6965 732c 2061 6e64 2066 6f72 6d69 6e67  ies, and forming
+00001df0: 2061 2028 7374 616e 6461 7264 2920 636f   a (standard) co
+00001e00: 6e66 6f72 6d61 6c20 7265 6772 6573 736f  nformal regresso
+00001e10: 7220 666f 7220 6561 6368 2063 6174 6567  r for each categ
+00001e20: 6f72 792e 2054 6865 2063 6174 6567 6f72  ory. The categor
+00001e30: 7920 6d65 6d62 6572 7368 6970 206f 6620  y membership of 
+00001e40: 7468 6520 6f62 6a65 6374 7320 6361 6e20  the objects can 
+00001e50: 6265 2070 726f 7669 6465 6420 6173 2061  be provided as a
+00001e60: 6e20 6164 6469 7469 6f6e 616c 2061 7267  n additional arg
+00001e70: 756d 656e 742c 206e 616d 6564 2060 6269  ument, named `bi
+00001e80: 6e73 602c 2066 6f72 2074 6865 2060 6669  ns`, for the `fi
+00001e90: 7460 206d 6574 686f 642e 0a0a 4865 7265  t` method...Here
+00001ea0: 2077 6520 7573 6520 7468 6520 6865 6c70   we use the help
+00001eb0: 6572 2066 756e 6374 696f 6e20 6062 696e  er function `bin
+00001ec0: 6e69 6e67 6020 746f 2066 6f72 6d20 4d6f  ning` to form Mo
+00001ed0: 6e64 7269 616e 2063 6174 6567 6f72 6965  ndrian categorie
+00001ee0: 7320 6279 2065 7175 616c 2d73 697a 6564  s by equal-sized
+00001ef0: 2062 696e 6e69 6e67 206f 6620 7468 6520   binning of the 
+00001f00: 6469 6666 6963 756c 7479 2065 7374 696d  difficulty estim
+00001f10: 6174 6573 3b20 7468 6520 6675 6e63 7469  ates; the functi
+00001f20: 6f6e 2072 6574 7572 6e73 206c 6162 656c  on returns label
+00001f30: 7320 666f 7220 7468 6520 6361 6c69 6272  s for the calibr
+00001f40: 6174 696f 6e20 6f62 6a65 6374 7320 7468  ation objects th
+00001f50: 6520 7765 2070 726f 7669 6465 2061 7320  e we provide as 
+00001f60: 696e 7075 7420 746f 2074 6865 2063 616c  input to the cal
+00001f70: 6962 7261 7469 6f6e 2c20 616e 6420 7765  ibration, and we
+00001f80: 2061 6c73 6f20 6765 7420 7468 7265 7368   also get thresh
+00001f90: 6f6c 6473 2066 6f72 2074 6865 2062 696e  olds for the bin
+00001fa0: 732c 2077 6869 6368 2063 616e 2075 7365  s, which can use
+00001fb0: 206c 6174 6572 2077 6865 6e20 6269 6e6e   later when binn
+00001fc0: 696e 6720 7468 6520 7465 7374 206f 626a  ing the test obj
+00001fd0: 6563 7473 3a0a 0a60 6060 7079 7468 6f6e  ects:..```python
+00001fe0: 0a62 696e 735f 6361 6c2c 2062 696e 5f74  .bins_cal, bin_t
+00001ff0: 6872 6573 686f 6c64 7320 3d20 6269 6e6e  hresholds = binn
+00002000: 696e 6728 7369 676d 6173 5f63 616c 2c20  ing(sigmas_cal, 
+00002010: 6269 6e73 3d32 3029 0a72 662e 6361 6c69  bins=20).rf.cali
+00002020: 6272 6174 6528 7265 7369 6475 616c 732c  brate(residuals,
+00002030: 2062 696e 733d 6269 6e73 5f63 616c 290a   bins=bins_cal).
+00002040: 6060 600a 0a4c 6574 2075 7320 6e6f 7720  ```..Let us now 
+00002050: 6765 7420 7468 6520 6c61 6265 6c73 206f  get the labels o
+00002060: 6620 7468 6520 4d6f 6e64 7269 616e 2063  f the Mondrian c
+00002070: 6174 6567 6f72 6965 7320 666f 7220 7468  ategories for th
+00002080: 6520 7465 7374 206f 626a 6563 7473 2061  e test objects a
+00002090: 6e64 2075 7365 2074 6865 6d20 7768 656e  nd use them when
+000020a0: 2070 7265 6469 6374 696e 6720 696e 7465   predicting inte
+000020b0: 7276 616c 733a 0a0a 6060 6070 7974 686f  rvals:..```pytho
+000020c0: 6e0a 6269 6e73 5f74 6573 7420 3d20 6269  n.bins_test = bi
+000020d0: 6e6e 696e 6728 7369 676d 6173 5f74 6573  nning(sigmas_tes
+000020e0: 742c 2062 696e 733d 6269 6e5f 7468 7265  t, bins=bin_thre
+000020f0: 7368 6f6c 6473 290a 7266 2e70 7265 6469  sholds).rf.predi
+00002100: 6374 5f69 6e74 2858 5f74 6573 742c 2062  ct_int(X_test, b
+00002110: 696e 733d 6269 6e73 5f74 6573 742c 2079  ins=bins_test, y
+00002120: 5f6d 696e 3d30 290a 6060 600a 0a60 6060  _min=0).```..```
+00002130: 6e75 6d70 790a 6172 7261 7928 5b5b 2032  numpy.array([[ 2
+00002140: 3036 3337 392e 3720 2c20 2035 3735 3538  06379.7 ,  57558
+00002150: 342e 3320 5d2c 0a20 2020 2020 2020 5b20  4.3 ],.       [ 
+00002160: 3134 3430 3134 2e36 352c 2020 3432 3831  144014.65,  4281
+00002170: 3137 2e37 335d 2c0a 2020 2020 2020 205b  17.73],.       [
+00002180: 2020 3137 3936 352e 3537 2c20 3131 3533    17965.57, 1153
+00002190: 3136 312e 3537 5d2c 0a20 2020 2020 2020  161.57],.       
+000021a0: 2e2e 2e2c 0a20 2020 2020 2020 5b20 3635  ...,.       [ 65
+000021b0: 3338 3635 2e32 322c 2020 3935 3738 3131  3865.22,  957811
+000021c0: 2e32 325d 2c0a 2020 2020 2020 205b 2031  .22],.       [ 1
+000021d0: 3734 3236 342e 3837 2c20 2033 3335 3331  74264.87,  33531
+000021e0: 362e 3037 5d2c 0a20 2020 2020 2020 5b20  6.07],.       [ 
+000021f0: 3134 3035 3837 2e34 362c 2020 3533 3130  140587.46,  5310
+00002200: 3636 2e31 345d 5d29 0a60 6060 0a0a 5765  66.14]]).```..We
+00002210: 2063 6f75 6c64 2076 6572 7920 6561 7369   could very easi
+00002220: 6c79 2073 7769 7463 6820 6672 6f6d 2063  ly switch from c
+00002230: 6f6e 666f 726d 616c 2072 6567 7265 7373  onformal regress
+00002240: 6f72 7320 746f 2063 6f6e 666f 726d 616c  ors to conformal
+00002250: 2070 7265 6469 6374 6976 6520 7379 7374   predictive syst
+00002260: 656d 732e 2054 6865 206c 6174 7465 7220  ems. The latter 
+00002270: 7072 6f64 7563 6520 6375 6d75 6c61 7469  produce cumulati
+00002280: 7665 2064 6973 7472 6962 7574 696f 6e20  ve distribution 
+00002290: 6675 6e63 7469 6f6e 7320 2863 6f6e 666f  functions (confo
+000022a0: 726d 616c 2070 7265 6469 6374 6976 6520  rmal predictive 
+000022b0: 6469 7374 7269 6275 7469 6f6e 7329 2e20  distributions). 
+000022c0: 4672 6f6d 2074 6865 7365 2077 6520 6361  From these we ca
+000022d0: 6e20 6765 6e65 7261 7465 2070 7265 6469  n generate predi
+000022e0: 6374 696f 6e20 696e 7465 7276 616c 732c  ction intervals,
+000022f0: 2062 7574 2077 6520 6361 6e20 616c 736f   but we can also
+00002300: 206f 6274 6169 6e20 7065 7263 656e 7469   obtain percenti
+00002310: 6c65 732c 2063 616c 6962 7261 7465 6420  les, calibrated 
+00002320: 706f 696e 7420 7072 6564 6963 7469 6f6e  point prediction
+00002330: 732c 2061 7320 7765 6c6c 2061 7320 702d  s, as well as p-
+00002340: 7661 6c75 6573 2066 6f72 2067 6976 656e  values for given
+00002350: 2074 6172 6765 7420 7661 6c75 6573 2e20   target values. 
+00002360: 4c65 7420 7573 2073 6565 2068 6f77 2077  Let us see how w
+00002370: 6520 6361 6e20 676f 2061 6865 6164 2074  e can go ahead t
+00002380: 6f20 646f 2074 6861 742e 0a0a 5765 6c6c  o do that...Well
+00002390: 2c20 7468 6572 6520 6973 206f 6e6c 7920  , there is only 
+000023a0: 6f6e 6520 7468 696e 6720 6162 6f76 6520  one thing above 
+000023b0: 7468 6174 2063 6861 6e67 6573 3a20 6a75  that changes: ju
+000023c0: 7374 2070 726f 7669 6465 2060 6370 733d  st provide `cps=
+000023d0: 5472 7565 6020 746f 2074 6865 2060 6361  True` to the `ca
+000023e0: 6c69 6272 6174 6560 206d 6574 686f 642e  librate` method.
+000023f0: 0a0a 5765 2063 616e 2c20 666f 7220 6578  ..We can, for ex
+00002400: 616d 706c 652c 2066 6f72 6d20 6e6f 726d  ample, form norm
+00002410: 616c 697a 6564 204d 6f6e 6472 6961 6e20  alized Mondrian 
+00002420: 636f 6e66 6f72 6d61 6c20 7072 6564 6963  conformal predic
+00002430: 7469 7665 2073 7973 7465 6d73 2c20 6279  tive systems, by
+00002440: 2070 726f 7669 6469 6e67 2062 6f74 6820   providing both 
+00002450: 6062 696e 7360 2061 6e64 2060 7369 676d  `bins` and `sigm
+00002460: 6173 6020 746f 2074 6865 2060 6361 6c69  as` to the `cali
+00002470: 6272 6174 6560 206d 6574 686f 642e 2048  brate` method. H
+00002480: 6572 6520 7765 2077 696c 6c20 636f 6e73  ere we will cons
+00002490: 6964 6572 204d 6f6e 6472 6961 6e20 6361  ider Mondrian ca
+000024a0: 7465 676f 7269 6573 2066 6f72 6d65 6420  tegories formed 
+000024b0: 6672 6f6d 2062 696e 6e69 6e67 2074 6865  from binning the
+000024c0: 2070 6f69 6e74 2070 7265 6469 6374 696f   point predictio
+000024d0: 6e73 3a0a 0a60 6060 7079 7468 6f6e 0a62  ns:..```python.b
+000024e0: 696e 735f 6361 6c2c 2062 696e 5f74 6872  ins_cal, bin_thr
+000024f0: 6573 686f 6c64 7320 3d20 6269 6e6e 696e  esholds = binnin
+00002500: 6728 7266 2e70 7265 6469 6374 2858 5f63  g(rf.predict(X_c
+00002510: 616c 292c 2062 696e 733d 3529 0a72 662e  al), bins=5).rf.
+00002520: 6361 6c69 6272 6174 6528 7265 7369 6475  calibrate(residu
+00002530: 616c 732c 2073 6967 6d61 733d 7369 676d  als, sigmas=sigm
+00002540: 6173 5f63 616c 2c20 6269 6e73 3d62 696e  as_cal, bins=bin
+00002550: 735f 6361 6c2c 2063 7073 3d54 7275 6529  s_cal, cps=True)
+00002560: 0a60 6060 0a0a 4279 2070 726f 7669 6469  .```..By providi
+00002570: 6e67 2074 6865 2062 696e 7320 2861 6e64  ng the bins (and
+00002580: 2073 6967 6d61 7329 2066 6f72 2074 6865   sigmas) for the
+00002590: 2074 6573 7420 6f62 6a65 6374 732c 2077   test objects, w
+000025a0: 6520 6361 6e20 6e6f 7720 6d61 6b65 2070  e can now make p
+000025b0: 7265 6469 6374 696f 6e73 2077 6974 6820  redictions with 
+000025c0: 7468 6520 636f 6e66 6f72 6d61 6c20 7072  the conformal pr
+000025d0: 6564 6963 7469 7665 2073 7973 7465 6d2c  edictive system,
+000025e0: 2074 6872 6f75 6768 2074 6865 206d 6574   through the met
+000025f0: 686f 6420 6070 7265 6469 6374 5f63 7073  hod `predict_cps
+00002600: 602e 0a54 6865 206f 7574 7075 7420 6f66  `..The output of
+00002610: 2074 6869 7320 6d65 7468 6f64 2063 616e   this method can
+00002620: 2062 6520 636f 6e74 726f 6c6c 6564 2071   be controlled q
+00002630: 7569 7465 2066 6c65 7869 626c 793b 2068  uite flexibly; h
+00002640: 6572 6520 7765 2072 6571 7565 7374 2070  ere we request p
+00002650: 7265 6469 6374 696f 6e20 696e 7465 7276  rediction interv
+00002660: 616c 7320 7769 7468 2039 3525 2063 6f6e  als with 95% con
+00002670: 6669 6465 6e63 6520 746f 2062 6520 6f75  fidence to be ou
+00002680: 7470 7574 3a0a 0a60 6060 7079 7468 6f6e  tput:..```python
+00002690: 0a62 696e 735f 7465 7374 203d 2062 696e  .bins_test = bin
+000026a0: 6e69 6e67 2872 662e 7072 6564 6963 7428  ning(rf.predict(
+000026b0: 585f 7465 7374 292c 2062 696e 733d 6269  X_test), bins=bi
+000026c0: 6e5f 7468 7265 7368 6f6c 6473 290a 7266  n_thresholds).rf
+000026d0: 2e70 7265 6469 6374 5f63 7073 2858 5f74  .predict_cps(X_t
+000026e0: 6573 742c 2073 6967 6d61 733d 7369 676d  est, sigmas=sigm
+000026f0: 6173 5f74 6573 742c 2062 696e 733d 6269  as_test, bins=bi
+00002700: 6e73 5f74 6573 742c 0a20 2020 2020 2020  ns_test,.       
+00002710: 2020 2020 2020 2020 6c6f 7765 725f 7065          lower_pe
+00002720: 7263 656e 7469 6c65 733d 322e 352c 2068  rcentiles=2.5, h
+00002730: 6967 6865 725f 7065 7263 656e 7469 6c65  igher_percentile
+00002740: 733d 3937 2e35 2c20 795f 6d69 6e3d 3029  s=97.5, y_min=0)
+00002750: 0a60 6060 0a0a 6060 606e 756d 7079 0a61  .```..```numpy.a
+00002760: 7272 6179 285b 5b20 3234 3538 3236 2e33  rray([[ 245826.3
+00002770: 3432 3236 3933 202c 2020 3531 3733 3135  422693 ,  517315
+00002780: 2e38 3336 3138 3938 355d 2c0a 2020 2020  .83618985],.    
+00002790: 2020 205b 2031 3435 3334 382e 3033 3431     [ 145348.0341
+000027a0: 3538 3438 2c20 2033 3932 3936 382e 3135  5848,  392968.15
+000027b0: 3538 3739 3937 5d2c 0a20 2020 2020 2020  587997],.       
+000027c0: 5b20 3134 3837 3734 2e36 3534 3631 3231  [ 148774.6546121
+000027d0: 322c 2031 3033 3433 3030 2e38 3431 3935  2, 1034300.84195
+000027e0: 3937 365d 2c0a 2020 2020 2020 202e 2e2e  976],.       ...
+000027f0: 2c0a 2020 2020 2020 205b 2035 3839 3230  ,.       [ 58920
+00002800: 302e 3537 3235 3935 3720 2c20 3130 3537  0.5725957 , 1057
+00002810: 3031 332e 3839 3130 3230 3037 5d2c 0a20  013.89102007],. 
+00002820: 2020 2020 2020 5b20 3137 3139 3338 2e32        [ 171938.2
+00002830: 3933 3832 3935 322c 2020 3331 3737 3332  9382952,  317732
+00002840: 2e33 3136 3131 3134 315d 2c0a 2020 2020  .31611141],.    
+00002850: 2020 205b 2031 3637 3439 382e 3031 3534     [ 167498.0154
+00002860: 3035 3034 2c20 2034 3832 3332 382e 3938  0504,  482328.98
+00002870: 3535 3236 3332 5d5d 290a 6060 600a 0a49  552632]]).```..I
+00002880: 6620 7765 2077 6f75 6c64 206c 696b 6520  f we would like 
+00002890: 746f 2074 616b 6520 6120 6c6f 6f6b 2061  to take a look a
+000028a0: 7420 7468 6520 702d 7661 6c75 6573 2066  t the p-values f
+000028b0: 6f72 2074 6865 2074 7275 6520 7461 7267  or the true targ
+000028c0: 6574 7320 2874 6865 7365 2073 686f 756c  ets (these shoul
+000028d0: 6420 6265 2075 6e69 666f 726d 6c79 2064  d be uniformly d
+000028e0: 6973 7472 6962 7574 6564 292c 2077 6520  istributed), we 
+000028f0: 6361 6e20 646f 2074 6865 2066 6f6c 6c6f  can do the follo
+00002900: 7769 6e67 3a0a 0a60 6060 7079 7468 6f6e  wing:..```python
+00002910: 0a72 662e 7072 6564 6963 745f 6370 7328  .rf.predict_cps(
+00002920: 585f 7465 7374 2c20 7369 676d 6173 3d73  X_test, sigmas=s
+00002930: 6967 6d61 735f 7465 7374 2c20 6269 6e73  igmas_test, bins
+00002940: 3d62 696e 735f 7465 7374 2c20 793d 795f  =bins_test, y=y_
+00002950: 7465 7374 290a 6060 600a 0a60 6060 6e75  test).```..```nu
+00002960: 6d70 790a 6172 7261 7928 5b30 2e39 3836  mpy.array([0.986
+00002970: 3033 3631 342c 2030 2e38 3731 3738 3235  03614, 0.8717825
+00002980: 362c 2030 2e34 3432 3031 3938 342c 202e  6, 0.44201984, .
+00002990: 2e2e 2c20 302e 3035 3638 3838 3034 2c20  .., 0.05688804, 
+000029a0: 302e 3039 3437 3336 3034 2c0a 2020 2020  0.09473604,.    
+000029b0: 2020 2030 2e33 3130 3639 3931 335d 290a     0.31069913]).
+000029c0: 6060 600a 0a57 6520 6d61 7920 7265 7175  ```..We may requ
+000029d0: 6573 7420 7468 6174 2074 6865 2060 7072  est that the `pr
+000029e0: 6564 6963 745f 6370 7360 206d 6574 686f  edict_cps` metho
+000029f0: 6420 7265 7475 726e 7320 7468 6520 6675  d returns the fu
+00002a00: 6c6c 2063 6f6e 666f 726d 616c 2070 7265  ll conformal pre
+00002a10: 6469 6374 6976 6520 6469 7374 7269 6275  dictive distribu
+00002a20: 7469 6f6e 2028 4350 4429 2066 6f72 2065  tion (CPD) for e
+00002a30: 6163 6820 7465 7374 2069 6e73 7461 6e63  ach test instanc
+00002a40: 652c 2061 7320 6465 6669 6e65 6420 6279  e, as defined by
+00002a50: 2074 6865 2074 6872 6573 686f 6c64 2076   the threshold v
+00002a60: 616c 7565 732c 2062 7920 7365 7474 696e  alues, by settin
+00002a70: 6720 6072 6574 7572 6e5f 6370 6473 3d54  g `return_cpds=T
+00002a80: 7275 6560 2e20 5468 6520 666f 726d 6174  rue`. The format
+00002a90: 206f 6620 7468 6520 6469 7374 7269 6275   of the distribu
+00002aa0: 7469 6f6e 7320 7661 7279 2077 6974 6820  tions vary with 
+00002ab0: 7468 6520 7479 7065 206f 6620 636f 6e66  the type of conf
+00002ac0: 6f72 6d61 6c20 7072 6564 6963 7469 7665  ormal predictive
+00002ad0: 2073 7973 7465 6d3b 2066 6f72 2061 2073   system; for a s
+00002ae0: 7461 6e64 6172 6420 616e 6420 6e6f 726d  tandard and norm
+00002af0: 616c 697a 6564 2043 5053 2c20 7468 6520  alized CPS, the 
+00002b00: 6f75 7470 7574 2069 7320 616e 2061 7272  output is an arr
+00002b10: 6179 2077 6974 6820 6120 726f 7720 666f  ay with a row fo
+00002b20: 7220 6561 6368 2074 6573 7420 696e 7374  r each test inst
+00002b30: 616e 6365 2061 6e64 2061 2063 6f6c 756d  ance and a colum
+00002b40: 6e20 666f 7220 6561 6368 2063 616c 6962  n for each calib
+00002b50: 7261 7469 6f6e 2069 6e73 7461 6e63 6520  ration instance 
+00002b60: 2872 6573 6964 7561 6c29 2c20 7768 696c  (residual), whil
+00002b70: 6520 666f 7220 6120 4d6f 6e64 7269 616e  e for a Mondrian
+00002b80: 2043 5053 2c20 7468 6520 6465 6661 756c   CPS, the defaul
+00002b90: 7420 6f75 7470 7574 2069 7320 6120 7665  t output is a ve
+00002ba0: 6374 6f72 2063 6f6e 7461 696e 696e 6720  ctor containing 
+00002bb0: 6f6e 6520 4350 4420 7065 7220 7465 7374  one CPD per test
+00002bc0: 2069 6e73 7461 6e63 652c 2073 696e 6365   instance, since
+00002bd0: 2074 6865 206e 756d 6265 7220 6f66 2076   the number of v
+00002be0: 616c 7565 7320 6d61 7920 7661 7279 2062  alues may vary b
+00002bf0: 6574 7765 656e 2063 6174 6567 6f72 6965  etween categorie
+00002c00: 732e 0a0a 6060 6070 7974 686f 6e0a 7266  s...```python.rf
+00002c10: 2e70 7265 6469 6374 5f63 7073 2858 5f74  .predict_cps(X_t
+00002c20: 6573 742c 2073 6967 6d61 733d 7369 676d  est, sigmas=sigm
+00002c30: 6173 5f74 6573 742c 2062 696e 733d 6269  as_test, bins=bi
+00002c40: 6e73 5f74 6573 742c 2072 6574 7572 6e5f  ns_test, return_
+00002c50: 6370 6473 3d54 7275 6529 0a60 6060 0a0a  cpds=True).```..
+00002c60: 5468 6520 7265 7375 6c74 696e 6720 7665  The resulting ve
+00002c70: 6374 6f72 206f 6620 6172 7261 7973 2069  ctor of arrays i
+00002c80: 7320 6e6f 7420 6469 7370 6c61 7965 6420  s not displayed 
+00002c90: 6865 7265 2c20 6275 7420 7765 2069 6e73  here, but we ins
+00002ca0: 7465 6164 2070 726f 7669 6465 2061 2070  tead provide a p
+00002cb0: 6c6f 7420 666f 7220 7468 6520 4350 4420  lot for the CPD 
+00002cc0: 6f66 2061 2072 616e 646f 6d20 7465 7374  of a random test
+00002cd0: 2069 6e73 7461 6e63 653a 0a0a 215b 6370   instance:..![cp
+00002ce0: 645d 2868 7474 7073 3a2f 2f75 7365 722d  d](https://user-
+00002cf0: 696d 6167 6573 2e67 6974 6875 6275 7365  images.githubuse
+00002d00: 7263 6f6e 7465 6e74 2e63 6f6d 2f37 3833  rcontent.com/783
+00002d10: 3837 3431 2f32 3335 3038 3139 3639 2d33  8741/235081969-3
+00002d20: 3238 6437 6132 332d 3236 6339 2d34 3739  28d7a23-26c9-479
+00002d30: 392d 6132 3436 2d38 6333 3566 6437 6163  9-a246-8c35fd7ac
+00002d40: 3838 652e 706e 6729 0a0a 2323 2045 7861  88e.png)..## Exa
+00002d50: 6d70 6c65 730a 0a46 6f72 2061 6464 6974  mples..For addit
+00002d60: 696f 6e61 6c20 6578 616d 706c 6573 206f  ional examples o
+00002d70: 6620 686f 7720 746f 2075 7365 2074 6865  f how to use the
+00002d80: 2070 6163 6b61 6765 2061 6e64 206d 6f64   package and mod
+00002d90: 756c 652c 2069 6e63 6c75 6469 6e67 2068  ule, including h
+00002da0: 6f77 2074 6f20 7573 6520 6f75 742d 6f66  ow to use out-of
+00002db0: 2d62 6167 2070 7265 6469 6374 696f 6e73  -bag predictions
+00002dc0: 2072 6174 6865 7220 7468 616e 2068 6176   rather than hav
+00002dd0: 696e 6720 746f 2072 656c 7920 6f6e 2064  ing to rely on d
+00002de0: 6976 6964 696e 6720 7468 6520 7472 6169  ividing the trai
+00002df0: 6e69 6e67 2073 6574 2069 6e74 6f20 6120  ning set into a 
+00002e00: 7072 6f70 6572 2074 7261 696e 696e 6720  proper training 
+00002e10: 616e 6420 6361 6c69 6272 6174 696f 6e20  and calibration 
+00002e20: 7365 742c 2073 6565 205b 7468 6520 646f  set, see [the do
+00002e30: 6375 6d65 6e74 6174 696f 6e5d 2868 7474  cumentation](htt
+00002e40: 7073 3a2f 2f63 7265 7065 732e 7265 6164  ps://crepes.read
+00002e50: 7468 6564 6f63 732e 696f 2f65 6e2f 6c61  thedocs.io/en/la
+00002e60: 7465 7374 2f29 2c20 5b74 6869 7320 4a75  test/), [this Ju
+00002e70: 7079 7465 7220 6e6f 7465 626f 6f6b 2075  pyter notebook u
+00002e80: 7369 6e67 2057 7261 705d 2868 7474 7073  sing Wrap](https
+00002e90: 3a2f 2f67 6974 6875 622e 636f 6d2f 6865  ://github.com/he
+00002ea0: 6e72 696b 626f 7374 726f 6d2f 6372 6570  nrikbostrom/crep
+00002eb0: 6573 2f62 6c6f 622f 6d61 696e 2f64 6f63  es/blob/main/doc
+00002ec0: 732f 6372 6570 6573 5f6e 625f 7772 6170  s/crepes_nb_wrap
+00002ed0: 2e69 7079 6e62 292c 2061 6e64 205b 7468  .ipynb), and [th
+00002ee0: 6973 204a 7570 7974 6572 206e 6f74 6562  is Jupyter noteb
+00002ef0: 6f6f 6b20 7573 696e 6720 436f 6e66 6f72  ook using Confor
+00002f00: 6d61 6c52 6567 7265 7373 6f72 2061 6e64  malRegressor and
+00002f10: 2043 6f6e 666f 726d 616c 5072 6564 6963   ConformalPredic
+00002f20: 7469 7665 5379 7374 656d 5d28 6874 7470  tiveSystem](http
+00002f30: 733a 2f2f 6769 7468 7562 2e63 6f6d 2f68  s://github.com/h
+00002f40: 656e 7269 6b62 6f73 7472 6f6d 2f63 7265  enrikbostrom/cre
+00002f50: 7065 732f 626c 6f62 2f6d 6169 6e2f 646f  pes/blob/main/do
+00002f60: 6373 2f63 7265 7065 735f 6e62 2e69 7079  cs/crepes_nb.ipy
+00002f70: 6e62 292e 0a0a 2323 2043 6974 696e 6720  nb)...## Citing 
+00002f80: 6372 6570 6573 0a0a 4966 2079 6f75 2075  crepes..If you u
+00002f90: 7365 2060 6372 6570 6573 6020 666f 7220  se `crepes` for 
+00002fa0: 6120 7363 6965 6e74 6966 6963 2070 7562  a scientific pub
+00002fb0: 6c69 6361 7469 6f6e 2c20 796f 7520 6d61  lication, you ma
+00002fc0: 7920 6369 7465 2074 6865 2066 6f6c 6c6f  y cite the follo
+00002fd0: 7769 6e67 2070 6170 6572 3a0a 0a42 6f73  wing paper:..Bos
+00002fe0: 7472 c3b6 6d2c 2048 2e2c 2032 3032 322e  tr..m, H., 2022.
+00002ff0: 2063 7265 7065 733a 2061 2050 7974 686f   crepes: a Pytho
+00003000: 6e20 5061 636b 6167 6520 666f 7220 4765  n Package for Ge
+00003010: 6e65 7261 7469 6e67 2043 6f6e 666f 726d  nerating Conform
+00003020: 616c 2052 6567 7265 7373 6f72 7320 616e  al Regressors an
+00003030: 6420 5072 6564 6963 7469 7665 2053 7973  d Predictive Sys
+00003040: 7465 6d73 2e20 496e 2043 6f6e 666f 726d  tems. In Conform
+00003050: 616c 2061 6e64 2050 726f 6261 6269 6c69  al and Probabili
+00003060: 7374 6963 2050 7265 6469 6374 696f 6e20  stic Prediction 
+00003070: 616e 6420 4170 706c 6963 6174 696f 6e73  and Applications
+00003080: 2e20 504d 4c52 2c20 3137 392e 205b 4c69  . PMLR, 179. [Li
+00003090: 6e6b 5d28 6874 7470 733a 2f2f 636f 7061  nk](https://copa
+000030a0: 2d63 6f6e 6665 7265 6e63 652e 636f 6d2f  -conference.com/
+000030b0: 7061 7065 7273 2f43 4f50 4132 3032 325f  papers/COPA2022_
+000030c0: 7061 7065 725f 3131 2e70 6466 290a 0a42  paper_11.pdf)..B
+000030d0: 6962 7465 7820 656e 7472 793a 0a0a 6060  ibtex entry:..``
+000030e0: 6062 6962 7465 780a 4049 6e50 726f 6365  `bibtex.@InProce
+000030f0: 6564 696e 6773 7b63 7265 7065 732c 0a20  edings{crepes,. 
+00003100: 2074 6974 6c65 203d 2009 207b 6372 6570   title = . {crep
+00003110: 6573 3a20 6120 5079 7468 6f6e 2050 6163  es: a Python Pac
+00003120: 6b61 6765 2066 6f72 2047 656e 6572 6174  kage for Generat
+00003130: 696e 6720 436f 6e66 6f72 6d61 6c20 5265  ing Conformal Re
+00003140: 6772 6573 736f 7273 2061 6e64 2050 7265  gressors and Pre
+00003150: 6469 6374 6976 6520 5379 7374 656d 737d  dictive Systems}
+00003160: 2c0a 2020 6175 7468 6f72 203d 2020 2020  ,.  author =    
+00003170: 2020 207b 426f 7374 725c 226f 6d2c 2048     {Bostr\"om, H
+00003180: 656e 7269 6b7d 2c0a 2020 626f 6f6b 7469  enrik},.  bookti
+00003190: 746c 6520 3d20 0920 7b50 726f 6365 6564  tle = . {Proceed
+000031a0: 696e 6773 206f 6620 7468 6520 456c 6576  ings of the Elev
+000031b0: 656e 7468 2053 796d 706f 7369 756d 206f  enth Symposium o
+000031c0: 6e20 436f 6e66 6f72 6d61 6c20 616e 6420  n Conformal and 
+000031d0: 5072 6f62 6162 696c 6973 7469 6320 5072  Probabilistic Pr
+000031e0: 6564 6963 7469 6f6e 2061 6e64 2041 7070  ediction and App
+000031f0: 6c69 6361 7469 6f6e 737d 2c0a 2020 7965  lications},.  ye
+00003200: 6172 203d 2009 207b 3230 3232 7d2c 0a20  ar = . {2022},. 
+00003210: 2065 6469 746f 7220 3d20 0920 7b4a 6f68   editor = . {Joh
+00003220: 616e 7373 6f6e 2c20 556c 6620 616e 6420  ansson, Ulf and 
+00003230: 426f 7374 72c3 b66d 2c20 4865 6e72 696b  Bostr..m, Henrik
+00003240: 2061 6e64 2041 6e20 4e67 7579 656e 2c20   and An Nguyen, 
+00003250: 4b68 756f 6e67 2061 6e64 204c 756f 2c20  Khuong and Luo, 
+00003260: 5a68 6979 7561 6e20 616e 6420 4361 726c  Zhiyuan and Carl
+00003270: 7373 6f6e 2c20 4c61 7273 7d2c 0a20 2076  sson, Lars},.  v
+00003280: 6f6c 756d 6520 3d20 0920 7b31 3739 7d2c  olume = . {179},
+00003290: 0a20 2073 6572 6965 7320 3d20 0920 7b50  .  series = . {P
+000032a0: 726f 6365 6564 696e 6773 206f 6620 4d61  roceedings of Ma
+000032b0: 6368 696e 6520 4c65 6172 6e69 6e67 2052  chine Learning R
+000032c0: 6573 6561 7263 687d 2c0a 2020 7075 626c  esearch},.  publ
+000032d0: 6973 6865 7220 3d20 2020 207b 504d 4c52  isher =    {PMLR
+000032e0: 7d0a 7d0a 6060 600a 0a23 2320 5265 6665  }.}.```..## Refe
+000032f0: 7265 6e63 6573 0a0a 3c61 2069 643d 2231  rences..<a id="1
+00003300: 223e 5b31 5d3c 2f61 3e20 566f 766b 2c20  ">[1]</a> Vovk, 
+00003310: 562e 2c20 4761 6d6d 6572 6d61 6e2c 2041  V., Gammerman, A
+00003320: 2e20 616e 6420 5368 6166 6572 2c20 472e  . and Shafer, G.
+00003330: 2c20 3230 3035 2e20 416c 676f 7269 7468  , 2005. Algorith
+00003340: 6d69 6320 6c65 6172 6e69 6e67 2069 6e20  mic learning in 
+00003350: 6120 7261 6e64 6f6d 2077 6f72 6c64 2e20  a random world. 
+00003360: 5370 7269 6e67 6572 205b 4c69 6e6b 5d28  Springer [Link](
+00003370: 6874 7470 733a 2f2f 6c69 6e6b 2e73 7072  https://link.spr
+00003380: 696e 6765 722e 636f 6d2f 626f 6f6b 2f31  inger.com/book/1
+00003390: 302e 3130 3037 2f62 3130 3637 3135 290a  0.1007/b106715).
+000033a0: 0a3c 6120 6964 3d22 3222 3e5b 325d 3c2f  .<a id="2">[2]</
+000033b0: 613e 2050 6170 6164 6f70 6f75 6c6f 732c  a> Papadopoulos,
+000033c0: 2048 2e2c 2050 726f 6564 726f 752c 204b   H., Proedrou, K
+000033d0: 2e2c 2056 6f76 6b2c 2056 2e20 616e 6420  ., Vovk, V. and 
+000033e0: 4761 6d6d 6572 6d61 6e2c 2041 2e2c 2032  Gammerman, A., 2
+000033f0: 3030 322e 2049 6e64 7563 7469 7665 2063  002. Inductive c
+00003400: 6f6e 6669 6465 6e63 6520 6d61 6368 696e  onfidence machin
+00003410: 6573 2066 6f72 2072 6567 7265 7373 696f  es for regressio
+00003420: 6e2e 2045 7572 6f70 6561 6e20 436f 6e66  n. European Conf
+00003430: 6572 656e 6365 206f 6e20 4d61 6368 696e  erence on Machin
+00003440: 6520 4c65 6172 6e69 6e67 2c20 7070 2e20  e Learning, pp. 
+00003450: 3334 352d 3335 362e 205b 4c69 6e6b 5d28  345-356. [Link](
+00003460: 6874 7470 733a 2f2f 6c69 6e6b 2e73 7072  https://link.spr
+00003470: 696e 6765 722e 636f 6d2f 6368 6170 7465  inger.com/chapte
+00003480: 722f 3130 2e31 3030 372f 332d 3534 302d  r/10.1007/3-540-
+00003490: 3336 3735 352d 315f 3239 290a 0a3c 6120  36755-1_29)..<a 
+000034a0: 6964 3d22 3322 3e5b 335d 3c2f 613e 204a  id="3">[3]</a> J
+000034b0: 6f68 616e 7373 6f6e 2c20 552e 2c20 426f  ohansson, U., Bo
+000034c0: 7374 72c3 b66d 2c20 482e 2c20 4cc3 b666  str..m, H., L..f
+000034d0: 7374 72c3 b66d 2c20 542e 2061 6e64 204c  str..m, T. and L
+000034e0: 696e 7573 736f 6e2c 2048 2e2c 2032 3031  inusson, H., 201
+000034f0: 342e 2052 6567 7265 7373 696f 6e20 636f  4. Regression co
+00003500: 6e66 6f72 6d61 6c20 7072 6564 6963 7469  nformal predicti
+00003510: 6f6e 2077 6974 6820 7261 6e64 6f6d 2066  on with random f
+00003520: 6f72 6573 7473 2e20 4d61 6368 696e 6520  orests. Machine 
+00003530: 6c65 6172 6e69 6e67 2c20 3937 2831 2d32  learning, 97(1-2
+00003540: 292c 2070 702e 2031 3535 2d31 3736 2e20  ), pp. 155-176. 
+00003550: 5b4c 696e 6b5d 2868 7474 7073 3a2f 2f6c  [Link](https://l
+00003560: 696e 6b2e 7370 7269 6e67 6572 2e63 6f6d  ink.springer.com
+00003570: 2f61 7274 6963 6c65 2f31 302e 3130 3037  /article/10.1007
+00003580: 2f73 3130 3939 342d 3031 342d 3534 3533  /s10994-014-5453
+00003590: 2d30 290a 0a3c 6120 6964 3d22 3422 3e5b  -0)..<a id="4">[
+000035a0: 345d 3c2f 613e 2042 6f73 7472 c3b6 6d2c  4]</a> Bostr..m,
+000035b0: 2048 2e2c 204c 696e 7573 736f 6e2c 2048   H., Linusson, H
+000035c0: 2e2c 204c c3b6 6673 7472 c3b6 6d2c 2054  ., L..fstr..m, T
+000035d0: 2e20 616e 6420 4a6f 6861 6e73 736f 6e2c  . and Johansson,
+000035e0: 2055 2e2c 2032 3031 372e 2041 6363 656c   U., 2017. Accel
+000035f0: 6572 6174 696e 6720 6469 6666 6963 756c  erating difficul
+00003600: 7479 2065 7374 696d 6174 696f 6e20 666f  ty estimation fo
+00003610: 7220 636f 6e66 6f72 6d61 6c20 7265 6772  r conformal regr
+00003620: 6573 7369 6f6e 2066 6f72 6573 7473 2e20  ession forests. 
+00003630: 416e 6e61 6c73 206f 6620 4d61 7468 656d  Annals of Mathem
+00003640: 6174 6963 7320 616e 6420 4172 7469 6669  atics and Artifi
+00003650: 6369 616c 2049 6e74 656c 6c69 6765 6e63  cial Intelligenc
+00003660: 652c 2038 3128 312d 3229 2c20 7070 2e31  e, 81(1-2), pp.1
+00003670: 3235 2d31 3434 2e20 5b4c 696e 6b5d 2868  25-144. [Link](h
+00003680: 7474 7073 3a2f 2f6c 696e 6b2e 7370 7269  ttps://link.spri
+00003690: 6e67 6572 2e63 6f6d 2f61 7274 6963 6c65  nger.com/article
+000036a0: 2f31 302e 3130 3037 2f73 3130 3437 322d  /10.1007/s10472-
+000036b0: 3031 372d 3935 3339 2d39 290a 0a3c 6120  017-9539-9)..<a 
+000036c0: 6964 3d22 3522 3e5b 355d 3c2f 613e 2042  id="5">[5]</a> B
+000036d0: 6f73 7472 c3b6 6d2c 2048 2e20 616e 6420  ostr..m, H. and 
+000036e0: 4a6f 6861 6e73 736f 6e2c 2055 2e2c 2032  Johansson, U., 2
+000036f0: 3032 302e 204d 6f6e 6472 6961 6e20 636f  020. Mondrian co
+00003700: 6e66 6f72 6d61 6c20 7265 6772 6573 736f  nformal regresso
+00003710: 7273 2e20 496e 2043 6f6e 666f 726d 616c  rs. In Conformal
+00003720: 2061 6e64 2050 726f 6261 6269 6c69 7374   and Probabilist
+00003730: 6963 2050 7265 6469 6374 696f 6e20 616e  ic Prediction an
+00003740: 6420 4170 706c 6963 6174 696f 6e73 2e20  d Applications. 
+00003750: 504d 4c52 2c20 3132 382c 2070 702e 2031  PMLR, 128, pp. 1
+00003760: 3134 2d31 3333 2e20 5b4c 696e 6b5d 2868  14-133. [Link](h
+00003770: 7474 7073 3a2f 2f70 726f 6365 6564 696e  ttps://proceedin
+00003780: 6773 2e6d 6c72 2e70 7265 7373 2f76 3132  gs.mlr.press/v12
+00003790: 382f 626f 7374 726f 6d32 3061 2e68 746d  8/bostrom20a.htm
+000037a0: 6c29 0a0a 3c61 2069 643d 2236 223e 5b36  l)..<a id="6">[6
+000037b0: 5d3c 2f61 3e20 566f 766b 2c20 562e 2c20  ]</a> Vovk, V., 
+000037c0: 5065 7465 6a2c 2049 2e2c 204e 6f75 7265  Petej, I., Noure
+000037d0: 7464 696e 6f76 2c20 492e 2c20 4d61 6e6f  tdinov, I., Mano
+000037e0: 6b68 696e 2c20 562e 2061 6e64 2047 616d  khin, V. and Gam
+000037f0: 6d65 726d 616e 2c20 412e 2c20 3230 3230  merman, A., 2020
+00003800: 2e20 436f 6d70 7574 6174 696f 6e61 6c6c  . Computationall
+00003810: 7920 6566 6669 6369 656e 7420 7665 7273  y efficient vers
+00003820: 696f 6e73 206f 6620 636f 6e66 6f72 6d61  ions of conforma
+00003830: 6c20 7072 6564 6963 7469 7665 2064 6973  l predictive dis
+00003840: 7472 6962 7574 696f 6e73 2e20 4e65 7572  tributions. Neur
+00003850: 6f63 6f6d 7075 7469 6e67 2c20 3339 372c  ocomputing, 397,
+00003860: 2070 702e 3239 322d 3330 382e 205b 4c69   pp.292-308. [Li
+00003870: 6e6b 5d28 6874 7470 733a 2f2f 7777 772e  nk](https://www.
+00003880: 616d 696e 6572 2e6f 7267 2f70 7562 2f35  aminer.org/pub/5
+00003890: 6530 3961 6163 3964 6631 6139 6330 6334  e09aac9df1a9c0c4
+000038a0: 3136 6339 6237 302f 636f 6d70 7574 6174  16c9b70/computat
+000038b0: 696f 6e61 6c6c 792d 6566 6669 6369 656e  ionally-efficien
+000038c0: 742d 7665 7273 696f 6e73 2d6f 662d 636f  t-versions-of-co
+000038d0: 6e66 6f72 6d61 6c2d 7072 6564 6963 7469  nformal-predicti
+000038e0: 7665 2d64 6973 7472 6962 7574 696f 6e73  ve-distributions
+000038f0: 290a 0a3c 6120 6964 3d22 3722 3e5b 375d  )..<a id="7">[7]
+00003900: 3c2f 613e 2042 6f73 7472 c3b6 6d2c 2048  </a> Bostr..m, H
+00003910: 2e2c 204a 6f68 616e 7373 6f6e 2c20 552e  ., Johansson, U.
+00003920: 2061 6e64 204c c3b6 6673 7472 c3b6 6d2c   and L..fstr..m,
+00003930: 2054 2e2c 2032 3032 312e 204d 6f6e 6472   T., 2021. Mondr
+00003940: 6961 6e20 636f 6e66 6f72 6d61 6c20 7072  ian conformal pr
+00003950: 6564 6963 7469 7665 2064 6973 7472 6962  edictive distrib
+00003960: 7574 696f 6e73 2e20 496e 2043 6f6e 666f  utions. In Confo
+00003970: 726d 616c 2061 6e64 2050 726f 6261 6269  rmal and Probabi
+00003980: 6c69 7374 6963 2050 7265 6469 6374 696f  listic Predictio
+00003990: 6e20 616e 6420 4170 706c 6963 6174 696f  n and Applicatio
+000039a0: 6e73 2e20 504d 4c52 2c20 3135 322c 2070  ns. PMLR, 152, p
+000039b0: 702e 2032 342d 3338 2e20 5b4c 696e 6b5d  p. 24-38. [Link]
+000039c0: 2868 7474 7073 3a2f 2f70 726f 6365 6564  (https://proceed
+000039d0: 696e 6773 2e6d 6c72 2e70 7265 7373 2f76  ings.mlr.press/v
+000039e0: 3135 322f 626f 7374 726f 6d32 3161 2e68  152/bostrom21a.h
+000039f0: 746d 6c29 0a0a 3c61 2069 643d 2238 223e  tml)..<a id="8">
+00003a00: 5b38 5d3c 2f61 3e20 566f 766b 2c20 562e  [8]</a> Vovk, V.
+00003a10: 2c20 3230 3232 2e20 556e 6976 6572 7361  , 2022. Universa
+00003a20: 6c20 7072 6564 6963 7469 7665 2073 7973  l predictive sys
+00003a30: 7465 6d73 2e20 5061 7474 6572 6e20 5265  tems. Pattern Re
+00003a40: 636f 676e 6974 696f 6e2e 2031 3236 3a20  cognition. 126: 
+00003a50: 7070 2e20 3130 3835 3336 205b 4c69 6e6b  pp. 108536 [Link
+00003a60: 5d28 6874 7470 733a 2f2f 646c 2e61 636d  ](https://dl.acm
+00003a70: 2e6f 7267 2f64 6f69 2f61 6273 2f31 302e  .org/doi/abs/10.
+00003a80: 3130 3136 2f6a 2e70 6174 636f 672e 3230  1016/j.patcog.20
+00003a90: 3232 2e31 3038 3533 3629 0a0a 0a2d 202d  22.108536)...- -
+00003aa0: 202d 0a0a 4175 7468 6f72 3a20 4865 6e72   -..Author: Henr
+00003ab0: 696b 2042 6f73 7472 c3b6 6d20 2862 6f73  ik Bostr..m (bos
+00003ac0: 7472 6f6d 6840 6b74 682e 7365 290a 436f  tromh@kth.se).Co
+00003ad0: 7079 7269 6768 7420 3230 3233 2048 656e  pyright 2023 Hen
+00003ae0: 7269 6b20 426f 7374 72c3 b66d 0a4c 6963  rik Bostr..m.Lic
+00003af0: 656e 7365 3a20 4253 4420 3320 636c 6175  ense: BSD 3 clau
+00003b00: 7365 0a                                  se.
```

### Comparing `crepes-0.3.0/README.md` & `crepes-0.4.0/README.md`

 * *Files 14% similar despite different names*

```diff
@@ -1,933 +1,912 @@
-00000000: 2320 6063 7265 7065 7360 0a0a 6063 7265  # `crepes`..`cre
-00000010: 7065 7360 2069 7320 6120 5079 7468 6f6e  pes` is a Python
-00000020: 2070 6163 6b61 6765 2066 6f72 2067 656e   package for gen
-00000030: 6572 6174 696e 6720 2a63 6f6e 666f 726d  erating *conform
-00000040: 616c 2072 6567 7265 7373 6f72 732a 2c20  al regressors*, 
-00000050: 7768 6963 6820 7472 616e 7366 6f72 6d20  which transform 
-00000060: 706f 696e 7420 7072 6564 6963 7469 6f6e  point prediction
-00000070: 7320 6f66 2061 6e79 2075 6e64 6572 6c79  s of any underly
-00000080: 696e 6720 7265 6772 6573 7369 6f6e 206d  ing regression m
-00000090: 6f64 656c 2069 6e74 6f20 7072 6564 6963  odel into predic
-000000a0: 7469 6f6e 2069 6e74 6572 7661 6c73 2066  tion intervals f
-000000b0: 6f72 2073 7065 6369 6669 6564 206c 6576  or specified lev
-000000c0: 656c 7320 6f66 2063 6f6e 6669 6465 6e63  els of confidenc
-000000d0: 652e 2054 6865 2070 6163 6b61 6765 2061  e. The package a
-000000e0: 6c73 6f20 696d 706c 656d 656e 7473 202a  lso implements *
-000000f0: 636f 6e66 6f72 6d61 6c20 7072 6564 6963  conformal predic
-00000100: 7469 7665 2073 7973 7465 6d73 2a2c 2077  tive systems*, w
-00000110: 6869 6368 2074 7261 6e73 666f 726d 2074  hich transform t
-00000120: 6865 2070 6f69 6e74 2070 7265 6469 6374  he point predict
-00000130: 696f 6e73 2069 6e74 6f20 6375 6d75 6c61  ions into cumula
-00000140: 7469 7665 2064 6973 7472 6962 7574 696f  tive distributio
-00000150: 6e20 6675 6e63 7469 6f6e 732e 0a0a 5468  n functions...Th
-00000160: 6520 6063 7265 7065 7360 2070 6163 6b61  e `crepes` packa
-00000170: 6765 2069 6d70 6c65 6d65 6e74 7320 7374  ge implements st
-00000180: 616e 6461 7264 2c20 6e6f 726d 616c 697a  andard, normaliz
-00000190: 6564 2061 6e64 204d 6f6e 6472 6961 6e20  ed and Mondrian 
-000001a0: 636f 6e66 6f72 6d61 6c20 7265 6772 6573  conformal regres
-000001b0: 736f 7273 2061 6e64 2070 7265 6469 6374  sors and predict
-000001c0: 6976 6520 7379 7374 656d 732e 2057 6869  ive systems. Whi
-000001d0: 6c65 2074 6865 2070 6163 6b61 6765 2061  le the package a
-000001e0: 6c6c 6f77 7320 796f 7520 746f 2075 7365  llows you to use
-000001f0: 2079 6f75 7220 6f77 6e20 6469 6666 6963   your own diffic
-00000200: 756c 7479 2065 7374 696d 6174 6573 2061  ulty estimates a
-00000210: 6e64 204d 6f6e 6472 6961 6e20 6361 7465  nd Mondrian cate
-00000220: 676f 7269 6573 2c20 7468 6572 6520 6973  gories, there is
-00000230: 2061 6c73 6f20 6120 7365 7061 7261 7465   also a separate
-00000240: 206d 6f64 756c 652c 2063 616c 6c65 6420   module, called 
-00000250: 6063 7265 7065 732e 6669 6c6c 696e 6773  `crepes.fillings
-00000260: 602c 2077 6869 6368 2070 726f 7669 6465  `, which provide
-00000270: 7320 736f 6d65 2073 7461 6e64 6172 6420  s some standard 
-00000280: 6f70 7469 6f6e 7320 666f 7220 7468 6573  options for thes
-00000290: 652e 0a0a 2323 2049 6e73 7461 6c6c 6174  e...## Installat
-000002a0: 696f 6e0a 0a46 726f 6d20 5b50 7950 495d  ion..From [PyPI]
-000002b0: 2868 7474 7073 3a2f 2f70 7970 692e 6f72  (https://pypi.or
-000002c0: 672f 7072 6f6a 6563 742f 6372 6570 6573  g/project/crepes
-000002d0: 2f29 0a0a 6060 6062 6173 680a 7069 7020  /)..```bash.pip 
-000002e0: 696e 7374 616c 6c20 6372 6570 6573 0a60  install crepes.`
-000002f0: 6060 0a0a 4672 6f6d 205b 636f 6e64 612d  ``..From [conda-
-00000300: 666f 7267 655d 2868 7474 7073 3a2f 2f61  forge](https://a
+00000000: 3c70 2061 6c69 676e 3d22 6365 6e74 6572  <p align="center
+00000010: 223e 3c61 2068 7265 663d 2268 7474 7073  "><a href="https
+00000020: 3a2f 2f63 7265 7065 732e 7265 6164 7468  ://crepes.readth
+00000030: 6564 6f63 732e 696f 223e 3c69 6d67 2061  edocs.io"><img a
+00000040: 6c74 3d22 6372 6570 6573 2220 7372 633d  lt="crepes" src=
+00000050: 2268 7474 7073 3a2f 2f67 6974 6875 622d  "https://github-
+00000060: 7072 6f64 7563 7469 6f6e 2d75 7365 722d  production-user-
+00000070: 6173 7365 742d 3632 3130 6466 2e73 332e  asset-6210df.s3.
+00000080: 616d 617a 6f6e 6177 732e 636f 6d2f 3738  amazonaws.com/78
+00000090: 3338 3734 312f 3233 3739 3530 3737 322d  38741/237950772-
+000000a0: 3164 3434 3837 6231 2d37 6634 332d 3463  1d4487b1-7f43-4c
+000000b0: 6530 2d39 6462 302d 3033 3262 6165 6464  e0-9db0-032baedd
+000000c0: 6265 6365 2e70 6e67 223e 3c2f 613e 3c2f  bece.png"></a></
+000000d0: 703e 0a0a 3c70 2061 6c69 676e 3d22 6365  p>..<p align="ce
+000000e0: 6e74 6572 223e 0a3c 6120 6872 6566 3d22  nter">.<a href="
+000000f0: 6874 7470 733a 2f2f 7079 7069 2e6f 7267  https://pypi.org
+00000100: 2f70 726f 6a65 6374 2f63 7265 7065 732f  /project/crepes/
+00000110: 223e 3c69 6d67 2073 7263 3d22 6874 7470  "><img src="http
+00000120: 733a 2f2f 6261 6467 652e 6675 7279 2e69  s://badge.fury.i
+00000130: 6f2f 7079 2f63 7265 7065 732e 7376 6722  o/py/crepes.svg"
+00000140: 2061 6c74 3d22 5079 5049 2076 6572 7369   alt="PyPI versi
+00000150: 6f6e 2220 6865 6967 6874 3d32 3020 616c  on" height=20 al
+00000160: 6967 6e3d 2263 656e 7465 7222 3e3c 2f61  ign="center"></a
+00000170: 3e0a 3c61 2068 7265 663d 2268 7474 7073  >.<a href="https
+00000180: 3a2f 2f61 6e61 636f 6e64 612e 6f72 672f  ://anaconda.org/
+00000190: 636f 6e64 612d 666f 7267 652f 6372 6570  conda-forge/crep
+000001a0: 6573 223e 3c69 6d67 2073 7263 3d22 6874  es"><img src="ht
+000001b0: 7470 733a 2f2f 616e 6163 6f6e 6461 2e6f  tps://anaconda.o
+000001c0: 7267 2f63 6f6e 6461 2d66 6f72 6765 2f63  rg/conda-forge/c
+000001d0: 7265 7065 732f 6261 6467 6573 2f76 6572  repes/badges/ver
+000001e0: 7369 6f6e 2e73 7667 2220 616c 743d 2241  sion.svg" alt="A
+000001f0: 6e61 636f 6e64 6120 7665 7273 696f 6e22  naconda version"
+00000200: 2068 6569 6768 743d 3230 2061 6c69 676e   height=20 align
+00000210: 3d22 6365 6e74 6572 223e 3c2f 613e 0a3c  ="center"></a>.<
+00000220: 6120 6872 6566 3d22 6874 7470 733a 2f2f  a href="https://
+00000230: 6372 6570 6573 2e72 6561 6474 6865 646f  crepes.readthedo
+00000240: 6373 2e69 6f2f 656e 2f6c 6174 6573 7422  cs.io/en/latest"
+00000250: 3e3c 696d 6720 7372 633d 2268 7474 7073  ><img src="https
+00000260: 3a2f 2f72 6561 6474 6865 646f 6373 2e6f  ://readthedocs.o
+00000270: 7267 2f70 726f 6a65 6374 732f 6372 6570  rg/projects/crep
+00000280: 6573 2f62 6164 6765 2f3f 7665 7273 696f  es/badge/?versio
+00000290: 6e3d 6c61 7465 7374 2220 616c 743d 2264  n=latest" alt="d
+000002a0: 6f63 7320 7374 6174 7573 2220 6865 6967  ocs status" heig
+000002b0: 6874 3d32 3020 616c 6967 6e3d 2263 656e  ht=20 align="cen
+000002c0: 7465 7222 3e3c 2f61 3e20 0a3c 6120 6872  ter"></a> .<a hr
+000002d0: 6566 3d22 6874 7470 733a 2f2f 616e 6163  ef="https://anac
+000002e0: 6f6e 6461 2e6f 7267 2f63 6f6e 6461 2d66  onda.org/conda-f
+000002f0: 6f72 6765 2f63 7265 7065 7322 3e3c 696d  orge/crepes"><im
+00000300: 6720 7372 633d 2268 7474 7073 3a2f 2f61  g src="https://a
 00000310: 6e61 636f 6e64 612e 6f72 672f 636f 6e64  naconda.org/cond
-00000320: 612d 666f 7267 652f 6372 6570 6573 290a  a-forge/crepes).
-00000330: 0a60 6060 6261 7368 0a63 6f6e 6461 2069  .```bash.conda i
-00000340: 6e73 7461 6c6c 202d 6320 636f 6e64 612d  nstall -c conda-
-00000350: 666f 7267 6520 6372 6570 6573 0a60 6060  forge crepes.```
-00000360: 0a0a 2323 2044 6f63 756d 656e 7461 7469  ..## Documentati
-00000370: 6f6e 0a0a 466f 7220 636f 6d70 6c65 7465  on..For complete
-00000380: 2064 6f63 756d 656e 7461 7469 6f6e 206f   documentation o
-00000390: 6620 7468 6520 6063 7265 7065 7360 2070  f the `crepes` p
-000003a0: 6163 6b61 6765 2c20 7365 6520 5b68 6572  ackage, see [her
-000003b0: 655d 2868 7474 7073 3a2f 2f63 7265 7065  e](https://crepe
-000003c0: 732e 7265 6164 7468 6564 6f63 732e 696f  s.readthedocs.io
-000003d0: 2f65 6e2f 6c61 7465 7374 2f29 2e0a 0a23  /en/latest/)...#
-000003e0: 2320 5175 6963 6b73 7461 7274 0a0a 2323  # Quickstart..##
-000003f0: 2320 436f 6e66 6f72 6d61 6c20 7265 6772  # Conformal regr
-00000400: 6573 736f 7273 0a0a 5765 2066 6972 7374  essors..We first
-00000410: 2069 6d70 6f72 7420 7468 6520 6d61 696e   import the main
-00000420: 2063 6c61 7373 2066 726f 6d20 6063 7265   class from `cre
-00000430: 7065 7360 2061 6e64 2061 2068 656c 7065  pes` and a helpe
-00000440: 7220 636c 6173 7320 616e 6420 6675 6e63  r class and func
-00000450: 7469 6f6e 2066 726f 6d20 6063 7265 7065  tion from `crepe
-00000460: 732e 6669 6c6c 696e 6773 603a 0a0a 6060  s.fillings`:..``
-00000470: 6070 7974 686f 6e0a 6672 6f6d 2063 7265  `python.from cre
-00000480: 7065 7320 696d 706f 7274 2043 6f6e 666f  pes import Confo
-00000490: 726d 616c 5265 6772 6573 736f 720a 6672  rmalRegressor.fr
-000004a0: 6f6d 2063 7265 7065 732e 6669 6c6c 696e  om crepes.fillin
-000004b0: 6773 2069 6d70 6f72 7420 4469 6666 6963  gs import Diffic
-000004c0: 756c 7479 4573 7469 6d61 746f 722c 2062  ultyEstimator, b
-000004d0: 696e 6e69 6e67 0a60 6060 0a0a 5765 2077  inning.```..We w
-000004e0: 696c 6c20 696c 6c75 7374 7261 7465 2074  ill illustrate t
-000004f0: 6865 2061 626f 7665 2075 7369 6e67 2061  he above using a
-00000500: 2064 6174 6173 6574 2066 726f 6d20 5b77   dataset from [w
-00000510: 7777 2e6f 7065 6e6d 6c2e 6f72 675d 2868  ww.openml.org](h
-00000520: 7474 7073 3a2f 2f77 7777 2e6f 7065 6e6d  ttps://www.openm
-00000530: 6c2e 6f72 6729 2061 6e64 2061 2060 5261  l.org) and a `Ra
-00000540: 6e64 6f6d 466f 7265 7374 5265 6772 6573  ndomForestRegres
-00000550: 736f 7260 2066 726f 6d20 5b73 6b6c 6561  sor` from [sklea
-00000560: 726e 5d28 6874 7470 733a 2f2f 7363 696b  rn](https://scik
-00000570: 6974 2d6c 6561 726e 2e6f 7267 293a 0a0a  it-learn.org):..
-00000580: 6060 6070 7974 686f 6e0a 6672 6f6d 2073  ```python.from s
-00000590: 6b6c 6561 726e 2e64 6174 6173 6574 7320  klearn.datasets 
-000005a0: 696d 706f 7274 2066 6574 6368 5f6f 7065  import fetch_ope
-000005b0: 6e6d 6c0a 6672 6f6d 2073 6b6c 6561 726e  nml.from sklearn
-000005c0: 2e6d 6f64 656c 5f73 656c 6563 7469 6f6e  .model_selection
-000005d0: 2069 6d70 6f72 7420 7472 6169 6e5f 7465   import train_te
-000005e0: 7374 5f73 706c 6974 0a66 726f 6d20 736b  st_split.from sk
-000005f0: 6c65 6172 6e2e 656e 7365 6d62 6c65 2069  learn.ensemble i
-00000600: 6d70 6f72 7420 5261 6e64 6f6d 466f 7265  mport RandomFore
-00000610: 7374 5265 6772 6573 736f 720a 0a64 6174  stRegressor..dat
-00000620: 6173 6574 203d 2066 6574 6368 5f6f 7065  aset = fetch_ope
-00000630: 6e6d 6c28 6e61 6d65 3d22 686f 7573 655f  nml(name="house_
-00000640: 7361 6c65 7322 2c20 7665 7273 696f 6e3d  sales", version=
-00000650: 3329 0a58 203d 2064 6174 6173 6574 2e64  3).X = dataset.d
-00000660: 6174 612e 7661 6c75 6573 2e61 7374 7970  ata.values.astyp
-00000670: 6528 666c 6f61 7429 0a79 203d 2064 6174  e(float).y = dat
-00000680: 6173 6574 2e74 6172 6765 742e 7661 6c75  aset.target.valu
-00000690: 6573 2e61 7374 7970 6528 666c 6f61 7429  es.astype(float)
-000006a0: 0a60 6060 0a0a 5765 206e 6f77 2066 6972  .```..We now fir
-000006b0: 7374 2073 706c 6974 2074 6865 2064 6174  st split the dat
-000006c0: 6173 6574 2069 6e74 6f20 6120 7472 6169  aset into a trai
-000006d0: 6e69 6e67 2061 6e64 2061 2074 6573 7420  ning and a test 
-000006e0: 7365 742c 2061 6e64 2074 6865 6e20 6675  set, and then fu
-000006f0: 7274 6865 7220 7370 6c69 7420 7468 6520  rther split the 
-00000700: 7472 6169 6e69 6e67 2073 6574 2069 6e74  training set int
-00000710: 6f20 6120 7072 6f70 6572 2074 7261 696e  o a proper train
-00000720: 696e 6720 7365 7420 616e 6420 6120 6361  ing set and a ca
-00000730: 6c69 6272 6174 696f 6e20 7365 742e 2046  libration set. F
-00000740: 696e 616c 6c79 2c20 7765 2066 6974 2061  inally, we fit a
-00000750: 2072 616e 646f 6d20 666f 7265 7374 2074   random forest t
-00000760: 6f20 7468 6520 7072 6f70 6572 2074 7261  o the proper tra
-00000770: 696e 696e 6720 7365 7420 616e 6420 6170  ining set and ap
-00000780: 706c 7920 6974 2074 6f20 6f62 7461 696e  ply it to obtain
-00000790: 2070 6f69 6e74 2070 7265 6469 6374 696f   point predictio
-000007a0: 6e73 2066 6f72 2074 6865 2074 6573 7420  ns for the test 
-000007b0: 7365 7420 286e 6f74 6869 6e67 206e 6577  set (nothing new
-000007c0: 2068 6572 6529 2e0a 0a60 6060 7079 7468   here)...```pyth
-000007d0: 6f6e 0a58 5f74 7261 696e 2c20 585f 7465  on.X_train, X_te
-000007e0: 7374 2c20 795f 7472 6169 6e2c 2079 5f74  st, y_train, y_t
-000007f0: 6573 7420 3d20 7472 6169 6e5f 7465 7374  est = train_test
-00000800: 5f73 706c 6974 2858 2c20 792c 2074 6573  _split(X, y, tes
-00000810: 745f 7369 7a65 3d30 2e35 290a 585f 7072  t_size=0.5).X_pr
-00000820: 6f70 5f74 7261 696e 2c20 585f 6361 6c2c  op_train, X_cal,
-00000830: 2079 5f70 726f 705f 7472 6169 6e2c 2079   y_prop_train, y
-00000840: 5f63 616c 203d 2074 7261 696e 5f74 6573  _cal = train_tes
-00000850: 745f 7370 6c69 7428 585f 7472 6169 6e2c  t_split(X_train,
-00000860: 2079 5f74 7261 696e 2c0a 2020 2020 2020   y_train,.      
-00000870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000008a0: 2020 2020 2020 7465 7374 5f73 697a 653d        test_size=
-000008b0: 302e 3235 290a 0a6c 6561 726e 6572 203d  0.25)..learner =
-000008c0: 2052 616e 646f 6d46 6f72 6573 7452 6567   RandomForestReg
-000008d0: 7265 7373 6f72 2829 200a 6c65 6172 6e65  ressor() .learne
-000008e0: 722e 6669 7428 585f 7072 6f70 5f74 7261  r.fit(X_prop_tra
-000008f0: 696e 2c20 795f 7072 6f70 5f74 7261 696e  in, y_prop_train
-00000900: 290a 795f 6861 745f 7465 7374 203d 206c  ).y_hat_test = l
-00000910: 6561 726e 6572 2e70 7265 6469 6374 2858  earner.predict(X
-00000920: 5f74 6573 7429 0a60 6060 0a0a 4e6f 772c  _test).```..Now,
-00000930: 2077 6520 7769 6c6c 206d 616b 6520 7573   we will make us
-00000940: 6520 6f66 2074 6865 2063 616c 6962 7261  e of the calibra
-00000950: 7469 6f6e 2073 6574 2e20 5765 2061 7070  tion set. We app
-00000960: 6c79 2074 6865 206d 6f64 656c 2061 6c73  ly the model als
-00000970: 6f20 746f 2074 6865 2063 616c 6962 7261  o to the calibra
-00000980: 7469 6f6e 206f 626a 6563 7473 2061 6e64  tion objects and
-00000990: 2063 616c 6375 6c61 7465 2074 6865 2072   calculate the r
-000009a0: 6573 6964 7561 6c73 2e0a 6060 6070 7974  esiduals..```pyt
-000009b0: 686f 6e0a 795f 6861 745f 6361 6c20 3d20  hon.y_hat_cal = 
-000009c0: 6c65 6172 6e65 722e 7072 6564 6963 7428  learner.predict(
-000009d0: 585f 6361 6c29 0a72 6573 6964 7561 6c73  X_cal).residuals
-000009e0: 5f63 616c 203d 2079 5f63 616c 202d 2079  _cal = y_cal - y
-000009f0: 5f68 6174 5f63 616c 0a60 6060 0a0a 5468  _hat_cal.```..Th
-00000a00: 6520 6c61 7474 6572 2069 7320 6a75 7374  e latter is just
-00000a10: 2077 6861 7420 7765 206e 6565 6420 746f   what we need to
-00000a20: 2066 6974 2061 2073 7461 6e64 6172 6420   fit a standard 
-00000a30: 636f 6e66 6f72 6d61 6c20 7265 6772 6573  conformal regres
-00000a40: 736f 723a 0a60 6060 7079 7468 6f6e 0a63  sor:.```python.c
-00000a50: 725f 7374 6420 3d20 436f 6e66 6f72 6d61  r_std = Conforma
-00000a60: 6c52 6567 7265 7373 6f72 2829 0a63 725f  lRegressor().cr_
-00000a70: 7374 642e 6669 7428 7265 7369 6475 616c  std.fit(residual
-00000a80: 733d 7265 7369 6475 616c 735f 6361 6c29  s=residuals_cal)
-00000a90: 0a60 6060 0a0a 5765 2063 616e 206e 6f77  .```..We can now
-00000aa0: 2061 7070 6c79 2074 6865 2063 6f6e 666f   apply the confo
-00000ab0: 726d 616c 2072 6567 7265 7373 6f72 2074  rmal regressor t
-00000ac0: 6f20 6765 7420 7072 6564 6963 7469 6f6e  o get prediction
-00000ad0: 2069 6e74 6572 7661 6c73 2066 6f72 2074   intervals for t
-00000ae0: 6865 2074 6573 7420 6f62 6a65 6374 732c  he test objects,
-00000af0: 2075 7369 6e67 2074 6865 2070 6f69 6e74   using the point
-00000b00: 2070 7265 6469 6374 696f 6e73 2061 7320   predictions as 
-00000b10: 696e 7075 742c 2077 6865 7265 2074 6865  input, where the
-00000b20: 2070 726f 6261 6269 6c69 7479 206f 6620   probability of 
-00000b30: 6e6f 7420 696e 636c 7564 696e 6720 7468  not including th
-00000b40: 6520 636f 7272 6563 7420 7461 7267 6574  e correct target
-00000b50: 2069 6e20 616e 2069 6e74 6572 7661 6c20   in an interval 
-00000b60: 6973 2031 2d63 6f6e 6669 6465 6e63 653a  is 1-confidence:
-00000b70: 0a60 6060 7079 7468 6f6e 0a73 7464 5f69  .```python.std_i
-00000b80: 6e74 6572 7661 6c73 203d 2063 725f 7374  ntervals = cr_st
-00000b90: 642e 7072 6564 6963 7428 795f 6861 743d  d.predict(y_hat=
-00000ba0: 795f 6861 745f 7465 7374 2c20 636f 6e66  y_hat_test, conf
-00000bb0: 6964 656e 6365 3d30 2e39 3929 0a60 6060  idence=0.99).```
-00000bc0: 0a0a 5468 6520 6f75 7470 7574 2069 7320  ..The output is 
-00000bd0: 6120 5b4e 756d 5079 5d28 6874 7470 733a  a [NumPy](https:
-00000be0: 2f2f 6e75 6d70 792e 6f72 6729 2061 7272  //numpy.org) arr
-00000bf0: 6179 2c20 7370 6563 6966 7969 6e67 2074  ay, specifying t
-00000c00: 6865 206c 6f77 6572 2061 6e64 2075 7070  he lower and upp
-00000c10: 6572 2062 6f75 6e64 206f 6620 6561 6368  er bound of each
-00000c20: 2069 6e74 6572 7661 6c3a 0a0a 6060 606e   interval:..```n
-00000c30: 756d 7079 0a61 7272 6179 285b 5b2d 3137  umpy.array([[-17
-00000c40: 3139 3032 2e32 202c 2020 3935 3338 3636  1902.2 ,  953866
-00000c50: 2e32 205d 2c0a 2020 2020 2020 205b 2d32  .2 ],.       [-2
-00000c60: 3736 3831 382e 3031 2c20 2038 3438 3935  76818.01,  84895
-00000c70: 302e 3339 5d2c 0a20 2020 2020 2020 5b20  0.39],.       [ 
-00000c80: 2032 3236 3739 2e33 372c 2031 3134 3834   22679.37, 11484
-00000c90: 3437 2e37 375d 2c0a 2020 2020 2020 202e  47.77],.       .
-00000ca0: 2e2e 2c0a 2020 2020 2020 205b 2032 3432  ..,.       [ 242
-00000cb0: 3935 342e 3032 2c20 3133 3638 3732 322e  954.02, 1368722.
-00000cc0: 3432 5d2c 0a20 2020 2020 2020 5b2d 3330  42],.       [-30
-00000cd0: 3830 3933 2e37 332c 2020 3831 3736 3734  8093.73,  817674
-00000ce0: 2e36 375d 2c0a 2020 2020 2020 205b 2d32  .67],.       [-2
-00000cf0: 3237 3035 372e 3420 2c20 2038 3938 3731  27057.4 ,  89871
-00000d00: 312e 2020 5d5d 290a 6060 600a 0a57 6520  1.  ]]).```..We 
-00000d10: 6d61 7920 7265 7175 6573 7420 7468 6174  may request that
-00000d20: 2074 6865 2069 6e74 6572 7661 6c73 2061   the intervals a
-00000d30: 7265 2063 7574 2074 6f20 6578 636c 7564  re cut to exclud
-00000d40: 6520 696d 706f 7373 6962 6c65 2076 616c  e impossible val
-00000d50: 7565 732c 2069 6e20 7468 6973 2063 6173  ues, in this cas
-00000d60: 6520 6265 6c6f 7720 302c 2061 6e64 2069  e below 0, and i
-00000d70: 6620 7765 2061 6c73 6f20 7265 6c79 206f  f we also rely o
-00000d80: 6e20 7468 6520 6465 6661 756c 7420 636f  n the default co
-00000d90: 6e66 6964 656e 6365 206c 6576 656c 2028  nfidence level (
-00000da0: 302e 3935 292c 2074 6865 206f 7574 7075  0.95), the outpu
-00000db0: 7420 696e 7465 7276 616c 7320 7769 6c6c  t intervals will
-00000dc0: 2062 6520 6120 6269 7420 7469 6768 7465   be a bit tighte
-00000dd0: 723a 0a0a 6060 6070 7974 686f 6e0a 696e  r:..```python.in
-00000de0: 7465 7276 616c 735f 7374 6420 3d20 6372  tervals_std = cr
-00000df0: 5f73 7464 2e70 7265 6469 6374 2879 5f68  _std.predict(y_h
-00000e00: 6174 3d79 5f68 6174 5f74 6573 742c 2079  at=y_hat_test, y
-00000e10: 5f6d 696e 3d30 290a 6060 600a 0a60 6060  _min=0).```..```
-00000e20: 6e75 6d70 790a 6172 7261 7928 5b5b 2031  numpy.array([[ 1
-00000e30: 3532 3235 382e 3535 2c20 2036 3239 3730  52258.55,  62970
-00000e40: 352e 3435 5d2c 0a20 2020 2020 2020 5b20  5.45],.       [ 
-00000e50: 2034 3733 3432 2e37 342c 2020 3532 3437   47342.74,  5247
-00000e60: 3839 2e36 345d 2c0a 2020 2020 2020 205b  89.64],.       [
-00000e70: 2033 3436 3834 302e 3132 2c20 2038 3234   346840.12,  824
-00000e80: 3238 372e 3032 5d2c 0a20 2020 2020 2020  287.02],.       
-00000e90: 2e2e 2e2c 0a20 2020 2020 2020 5b20 3536  ...,.       [ 56
-00000ea0: 3731 3134 2e37 372c 2031 3034 3435 3631  7114.77, 1044561
-00000eb0: 2e36 375d 2c0a 2020 2020 2020 205b 2020  .67],.       [  
-00000ec0: 3136 3036 372e 3032 2c20 2034 3933 3531  16067.02,  49351
-00000ed0: 332e 3932 5d2c 0a20 2020 2020 2020 5b20  3.92],.       [ 
-00000ee0: 2039 3731 3033 2e33 352c 2020 3537 3435   97103.35,  5745
-00000ef0: 3530 2e32 355d 5d29 0a60 6060 0a0a 5468  50.25]]).```..Th
-00000f00: 6520 6162 6f76 6520 696e 7465 7276 616c  e above interval
-00000f10: 7320 6172 6520 6e6f 7420 6e6f 726d 616c  s are not normal
-00000f20: 697a 6564 2c20 692e 652e 2c20 7468 6579  ized, i.e., they
-00000f30: 2061 7265 2061 6c6c 206f 6620 7468 6520   are all of the 
-00000f40: 7361 6d65 2073 697a 6520 2861 7420 6c65  same size (at le
-00000f50: 6173 7420 6265 666f 7265 2074 6865 7920  ast before they 
-00000f60: 6172 6520 6375 7429 2e20 5765 2063 6f75  are cut). We cou
-00000f70: 6c64 206d 616b 6520 7468 6520 696e 7465  ld make the inte
-00000f80: 7276 616c 7320 6d6f 7265 2069 6e66 6f72  rvals more infor
-00000f90: 6d61 7469 7665 2074 6872 6f75 6768 206e  mative through n
-00000fa0: 6f72 6d61 6c69 7a61 7469 6f6e 2075 7369  ormalization usi
-00000fb0: 6e67 2064 6966 6669 6375 6c74 7920 6573  ng difficulty es
-00000fc0: 7469 6d61 7465 733b 206d 6f72 6520 6469  timates; more di
-00000fd0: 6666 6963 756c 7420 696e 7374 616e 6365  fficult instance
-00000fe0: 7320 7769 6c6c 2062 6520 6173 7369 676e  s will be assign
-00000ff0: 6564 2077 6964 6572 2069 6e74 6572 7661  ed wider interva
-00001000: 6c73 2e0a 0a57 6520 7769 6c6c 2075 7365  ls...We will use
-00001010: 2061 2060 4469 6666 6963 756c 7479 4573   a `DifficultyEs
-00001020: 7469 6d61 746f 7260 2066 6f72 2074 6869  timator` for thi
-00001030: 7320 7075 7270 6f73 652e 2048 6572 6520  s purpose. Here 
-00001040: 6974 2065 7374 696d 6174 6573 2074 6865  it estimates the
-00001050: 2064 6966 6669 6375 6c74 7920 6279 2074   difficulty by t
-00001060: 6865 2073 7461 6e64 6172 6420 6465 7669  he standard devi
-00001070: 6174 696f 6e20 6f66 2074 6865 2074 6172  ation of the tar
-00001080: 6765 7420 6f66 2074 6865 206b 2028 6465  get of the k (de
-00001090: 6661 756c 7420 606b 3d32 3560 2920 6e65  fault `k=25`) ne
-000010a0: 6172 6573 7420 6e65 6967 6862 6f72 7320  arest neighbors 
-000010b0: 696e 2074 6865 2070 726f 7065 7220 7472  in the proper tr
-000010c0: 6169 6e69 6e67 2073 6574 2074 6f20 6561  aining set to ea
-000010d0: 6368 2069 6e73 7461 6e63 6520 696e 2074  ch instance in t
-000010e0: 6865 2063 616c 6962 7261 7469 6f6e 2073  he calibration s
-000010f0: 6574 2e20 4120 736d 616c 6c20 7661 6c75  et. A small valu
-00001100: 6520 2862 6574 6129 2069 7320 6164 6465  e (beta) is adde
-00001110: 6420 746f 2074 6865 2065 7374 696d 6174  d to the estimat
-00001120: 6573 2c20 7768 6963 6820 6d61 7920 6265  es, which may be
-00001130: 2067 6976 656e 2074 6872 6f75 6768 2061   given through a
-00001140: 6e20 6172 6775 6d65 6e74 2074 6f20 7468  n argument to th
-00001150: 6520 6675 6e63 7469 6f6e 3b20 6265 6c6f  e function; belo
-00001160: 7720 7765 206a 7573 7420 7573 6520 7468  w we just use th
-00001170: 6520 6465 6661 756c 742c 2069 2e65 2e2c  e default, i.e.,
-00001180: 2060 6265 7461 3d30 2e30 3160 2e0a 0a60   `beta=0.01`...`
-00001190: 6060 7079 7468 6f6e 0a64 6520 3d20 4469  ``python.de = Di
-000011a0: 6666 6963 756c 7479 4573 7469 6d61 746f  fficultyEstimato
-000011b0: 7228 290a 6465 2e66 6974 2858 5f70 726f  r().de.fit(X_pro
-000011c0: 705f 7472 6169 6e2c 2079 3d79 5f70 726f  p_train, y=y_pro
-000011d0: 705f 7472 6169 6e29 0a0a 7369 676d 6173  p_train)..sigmas
-000011e0: 5f63 616c 203d 2064 652e 6170 706c 7928  _cal = de.apply(
-000011f0: 585f 6361 6c29 0a60 6060 0a0a 5468 6520  X_cal).```..The 
-00001200: 6469 6666 6963 756c 7479 2065 7374 696d  difficulty estim
-00001210: 6174 6573 2061 6e64 2072 6573 6964 7561  ates and residua
-00001220: 6c73 206f 6620 7468 6520 6361 6c69 6272  ls of the calibr
-00001230: 6174 696f 6e20 6578 616d 706c 6573 2063  ation examples c
-00001240: 616e 206e 6f77 2062 6520 7573 6564 2074  an now be used t
-00001250: 6f20 666f 726d 2061 206e 6f72 6d61 6c69  o form a normali
-00001260: 7a65 6420 636f 6e66 6f72 6d61 6c20 7265  zed conformal re
-00001270: 6772 6573 736f 723a 0a0a 6060 6070 7974  gressor:..```pyt
-00001280: 686f 6e0a 6372 5f6e 6f72 6d20 3d20 436f  hon.cr_norm = Co
-00001290: 6e66 6f72 6d61 6c52 6567 7265 7373 6f72  nformalRegressor
-000012a0: 2829 0a63 725f 6e6f 726d 2e66 6974 2872  ().cr_norm.fit(r
-000012b0: 6573 6964 7561 6c73 3d72 6573 6964 7561  esiduals=residua
-000012c0: 6c73 5f63 616c 2c20 7369 676d 6173 3d73  ls_cal, sigmas=s
-000012d0: 6967 6d61 735f 6361 6c29 0a60 6060 0a0a  igmas_cal).```..
-000012e0: 546f 2067 656e 6572 6174 6520 7072 6564  To generate pred
-000012f0: 6963 7469 6f6e 2069 6e74 6572 7661 6c73  iction intervals
-00001300: 2066 6f72 2074 6865 2074 6573 7420 7365   for the test se
-00001310: 7420 7573 696e 6720 7468 6520 6e6f 726d  t using the norm
-00001320: 616c 697a 6564 2063 6f6e 666f 726d 616c  alized conformal
-00001330: 2072 6567 7265 7373 6f72 2c20 7765 206e   regressor, we n
-00001340: 6565 6420 6469 6666 6963 756c 7479 2065  eed difficulty e
-00001350: 7374 696d 6174 6573 2066 6f72 2074 6865  stimates for the
-00001360: 2074 6573 7420 7365 7420 746f 6f2c 2077   test set too, w
-00001370: 6869 6368 2077 6520 6765 7420 7573 696e  hich we get usin
-00001380: 6720 7468 6520 7361 6d65 2064 6966 6669  g the same diffi
-00001390: 6375 6c74 7920 6573 7469 6d61 746f 7220  culty estimator 
-000013a0: 6173 2066 6f72 2074 6865 2063 616c 6962  as for the calib
-000013b0: 7261 7469 6f6e 2073 6574 3a0a 0a60 6060  ration set:..```
-000013c0: 7079 7468 6f6e 0a73 6967 6d61 735f 7465  python.sigmas_te
-000013d0: 7374 203d 2064 652e 6170 706c 7928 585f  st = de.apply(X_
-000013e0: 7465 7374 290a 6060 600a 0a4e 6f77 2077  test).```..Now w
-000013f0: 6520 6361 6e20 6f62 7461 696e 2074 6865  e can obtain the
-00001400: 2070 7265 6469 6374 696f 6e20 696e 7465   prediction inte
-00001410: 7276 616c 732c 2075 7369 6e67 2074 6865  rvals, using the
-00001420: 2070 6f69 6e74 2070 7265 6469 6374 696f   point predictio
-00001430: 6e73 2061 6e64 2064 6966 6669 6375 6c74  ns and difficult
-00001440: 7920 6573 7469 6d61 7465 7320 666f 7220  y estimates for 
-00001450: 7468 6520 7465 7374 2073 6574 3a0a 0a60  the test set:..`
-00001460: 6060 7079 7468 6f6e 0a69 6e74 6572 7661  ``python.interva
-00001470: 6c73 5f6e 6f72 6d20 3d20 6372 5f6e 6f72  ls_norm = cr_nor
-00001480: 6d2e 7072 6564 6963 7428 795f 6861 743d  m.predict(y_hat=
-00001490: 795f 6861 745f 7465 7374 2c20 7369 676d  y_hat_test, sigm
-000014a0: 6173 3d73 6967 6d61 735f 7465 7374 2c20  as=sigmas_test, 
-000014b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000014c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000014d0: 2020 795f 6d69 6e3d 3029 0a60 6060 0a0a    y_min=0).```..
-000014e0: 6060 606e 756d 7079 0a61 7272 6179 285b  ```numpy.array([
-000014f0: 5b20 3232 3637 3139 2e30 3636 3037 3937  [ 226719.0660797
-00001500: 372c 2020 3535 3532 3434 2e39 3333 3932  7,  555244.93392
-00001510: 3032 335d 2c0a 2020 2020 2020 205b 2031  023],.       [ 1
-00001520: 3733 3736 372e 3930 3735 3337 3135 2c20  73767.90753715, 
-00001530: 2033 3938 3336 342e 3437 3234 3632 3835   398364.47246285
-00001540: 5d2c 0a20 2020 2020 2020 5b20 3132 3436  ],.       [ 1246
-00001550: 3930 2e37 3031 3636 3936 362c 2031 3034  90.70166966, 104
-00001560: 3634 3336 2e34 3338 3333 3033 345d 2c0a  6436.43833034],.
-00001570: 2020 2020 2020 202e 2e2e 2c0a 2020 2020         ...,.    
-00001580: 2020 205b 2036 3037 3934 392e 3731 3534     [ 607949.7154
-00001590: 3035 3732 2c20 3130 3033 3732 362e 3732  0572, 1003726.72
-000015a0: 3435 3934 3238 5d2c 0a20 2020 2020 2020  459428],.       
-000015b0: 5b20 3138 3836 3731 2e33 3735 3232 3738  [ 188671.3752278
-000015c0: 202c 2020 3332 3039 3039 2e35 3634 3737   ,  320909.56477
-000015d0: 3232 205d 2c0a 2020 2020 2020 205b 2031  22 ],.       [ 1
-000015e0: 3435 3334 302e 3339 3037 3638 3234 2c20  45340.39076824, 
-000015f0: 2035 3236 3331 332e 3230 3932 3331 3736   526313.20923176
-00001600: 5d5d 290a 6060 600a 0a44 6570 656e 6469  ]]).```..Dependi
-00001610: 6e67 206f 6e20 7468 6520 656d 706c 6f79  ng on the employ
-00001620: 6564 2064 6966 6669 6375 6c74 7920 6573  ed difficulty es
-00001630: 7469 6d61 746f 722c 2074 6865 206e 6f72  timator, the nor
-00001640: 6d61 6c69 7a65 6420 696e 7465 7276 616c  malized interval
-00001650: 7320 6d61 7920 736f 6d65 7469 6d65 7320  s may sometimes 
-00001660: 6265 2075 6e72 6561 736f 6e61 626c 7920  be unreasonably 
-00001670: 6c61 7267 652c 2069 6e20 7468 6520 7365  large, in the se
-00001680: 6e73 6520 7468 6174 2074 6865 7920 6d61  nse that they ma
-00001690: 7920 6265 2073 6576 6572 616c 2074 696d  y be several tim
-000016a0: 6573 206c 6172 6765 7220 7468 616e 2061  es larger than a
-000016b0: 6e79 2070 7265 7669 6f75 736c 7920 6f62  ny previously ob
-000016c0: 7365 7276 6564 2065 7272 6f72 2e20 4d6f  served error. Mo
-000016d0: 7265 6f76 6572 2c20 6966 2074 6865 2064  reover, if the d
-000016e0: 6966 6669 6375 6c74 7920 6573 7469 6d61  ifficulty estima
-000016f0: 746f 7220 6973 206e 6f74 2076 6572 7920  tor is not very 
-00001700: 696e 666f 726d 6174 6976 652c 2065 2e67  informative, e.g
-00001710: 2e2c 2063 6f6d 706c 6574 656c 7920 7261  ., completely ra
-00001720: 6e64 6f6d 2c20 7468 6520 7661 7279 696e  ndom, the varyin
-00001730: 6720 696e 7465 7276 616c 2073 697a 6573  g interval sizes
-00001740: 206d 6179 2067 6976 6520 6120 6661 6c73   may give a fals
-00001750: 6520 696d 7072 6573 7369 6f6e 206f 6620  e impression of 
-00001760: 7468 6174 2077 6520 6361 6e20 6578 7065  that we can expe
-00001770: 6374 206c 6f77 6572 2070 7265 6469 6374  ct lower predict
-00001780: 696f 6e20 6572 726f 7273 2066 6f72 2069  ion errors for i
-00001790: 6e73 7461 6e63 6573 2077 6974 6820 7469  nstances with ti
-000017a0: 6768 7465 7220 696e 7465 7276 616c 732e  ghter intervals.
-000017b0: 2049 6465 616c 6c79 2c20 6120 6469 6666   Ideally, a diff
-000017c0: 6963 756c 7479 2065 7374 696d 6174 6f72  iculty estimator
-000017d0: 2070 726f 7669 6469 6e67 206c 6974 746c   providing littl
-000017e0: 6520 6f72 206e 6f20 696e 666f 726d 6174  e or no informat
-000017f0: 696f 6e20 6f6e 2074 6865 2065 7870 6563  ion on the expec
-00001800: 7465 6420 6572 726f 7220 7368 6f75 6c64  ted error should
-00001810: 2069 6e73 7465 6164 206c 6561 6420 746f   instead lead to
-00001820: 206d 6f72 6520 756e 6966 6f72 6d6c 7920   more uniformly 
-00001830: 6469 7374 7269 6275 7465 6420 696e 7465  distributed inte
-00001840: 7276 616c 2073 697a 6573 2e0a 0a41 204d  rval sizes...A M
-00001850: 6f6e 6472 6961 6e20 636f 6e66 6f72 6d61  ondrian conforma
-00001860: 6c20 7265 6772 6573 736f 7220 6361 6e20  l regressor can 
-00001870: 6265 2075 7365 6420 746f 2061 6464 7265  be used to addre
-00001880: 7373 2074 6865 7365 2070 726f 626c 656d  ss these problem
-00001890: 732c 2062 7920 6469 7669 6469 6e67 2074  s, by dividing t
-000018a0: 6865 206f 626a 6563 7420 7370 6163 6520  he object space 
-000018b0: 696e 746f 206e 6f6e 2d6f 7665 726c 6170  into non-overlap
-000018c0: 7069 6e67 2073 6f2d 6361 6c6c 6564 204d  ping so-called M
-000018d0: 6f6e 6472 6961 6e20 6361 7465 676f 7269  ondrian categori
-000018e0: 6573 2c20 616e 6420 666f 726d 696e 6720  es, and forming 
-000018f0: 6120 2873 7461 6e64 6172 6429 2063 6f6e  a (standard) con
-00001900: 666f 726d 616c 2072 6567 7265 7373 6f72  formal regressor
-00001910: 2066 6f72 2065 6163 6820 6361 7465 676f   for each catego
-00001920: 7279 2e20 5468 6520 6361 7465 676f 7279  ry. The category
-00001930: 206d 656d 6265 7273 6869 7020 6f66 2074   membership of t
-00001940: 6865 206f 626a 6563 7473 2063 616e 2062  he objects can b
-00001950: 6520 7072 6f76 6964 6564 2061 7320 616e  e provided as an
-00001960: 2061 6464 6974 696f 6e61 6c20 6172 6775   additional argu
-00001970: 6d65 6e74 2c20 6e61 6d65 6420 6062 696e  ment, named `bin
-00001980: 7360 2c20 666f 7220 7468 6520 6066 6974  s`, for the `fit
-00001990: 6020 6d65 7468 6f64 2e0a 0a48 6572 6520  ` method...Here 
-000019a0: 7765 2077 696c 6c20 7573 6520 7468 6520  we will use the 
-000019b0: 6865 6c70 6572 2066 756e 6374 696f 6e20  helper function 
-000019c0: 6062 696e 6e69 6e67 6020 746f 2066 6f72  `binning` to for
-000019d0: 6d20 4d6f 6e64 7269 616e 2063 6174 6567  m Mondrian categ
-000019e0: 6f72 6965 7320 6279 2065 7175 616c 2d73  ories by equal-s
-000019f0: 697a 6564 2062 696e 6e69 6e67 206f 6620  ized binning of 
-00001a00: 7468 6520 6469 6666 6963 756c 7479 2065  the difficulty e
-00001a10: 7374 696d 6174 6573 3b20 7468 6520 6675  stimates; the fu
-00001a20: 6e63 7469 6f6e 2077 696c 6c20 7265 7475  nction will retu
-00001a30: 726e 206c 6162 656c 7320 666f 7220 7468  rn labels for th
-00001a40: 6520 6361 6c69 6272 6174 696f 6e20 6f62  e calibration ob
-00001a50: 6a65 6374 7320 6173 2077 656c 6c20 6173  jects as well as
-00001a60: 2074 6872 6573 686f 6c64 7320 666f 7220   thresholds for 
-00001a70: 7468 6520 6269 6e73 2c20 7768 6963 6820  the bins, which 
-00001a80: 6172 6520 6c61 7465 7220 746f 2062 6520  are later to be 
-00001a90: 7573 6564 2077 6865 6e20 6269 6e6e 696e  used when binnin
-00001aa0: 6720 7468 6520 7465 7374 206f 626a 6563  g the test objec
-00001ab0: 7473 3a0a 0a60 6060 7079 7468 6f6e 0a62  ts:..```python.b
-00001ac0: 696e 735f 6361 6c2c 2062 696e 5f74 6872  ins_cal, bin_thr
-00001ad0: 6573 686f 6c64 7320 3d20 6269 6e6e 696e  esholds = binnin
-00001ae0: 6728 7661 6c75 6573 3d73 6967 6d61 735f  g(values=sigmas_
-00001af0: 6361 6c2c 2062 696e 733d 3230 290a 6060  cal, bins=20).``
-00001b00: 600a 0a41 204d 6f6e 6472 6961 6e20 636f  `..A Mondrian co
-00001b10: 6e66 6f72 6d61 6c20 7265 6772 6573 736f  nformal regresso
-00001b20: 7220 6973 206f 6274 6169 6e65 6420 6672  r is obtained fr
-00001b30: 6f6d 2074 6865 2072 6573 6964 7561 6c73  om the residuals
-00001b40: 2061 6e64 204d 6f6e 6472 6961 6e20 6361   and Mondrian ca
-00001b50: 7465 676f 7279 206c 6162 656c 733a 0a0a  tegory labels:..
-00001b60: 6060 6070 7974 686f 6e0a 6372 5f6d 6f6e  ```python.cr_mon
-00001b70: 6420 3d20 436f 6e66 6f72 6d61 6c52 6567  d = ConformalReg
-00001b80: 7265 7373 6f72 2829 0a63 725f 6d6f 6e64  ressor().cr_mond
-00001b90: 2e66 6974 2872 6573 6964 7561 6c73 3d72  .fit(residuals=r
-00001ba0: 6573 6964 7561 6c73 5f63 616c 2c20 6269  esiduals_cal, bi
-00001bb0: 6e73 3d62 696e 735f 6361 6c29 0a60 6060  ns=bins_cal).```
-00001bc0: 0a0a 496e 206f 7264 6572 2074 6f20 7573  ..In order to us
-00001bd0: 6520 7468 6520 4d6f 6e64 7269 616e 2063  e the Mondrian c
-00001be0: 6f6e 666f 726d 616c 2072 6567 7265 7373  onformal regress
-00001bf0: 6f72 206f 6e20 7468 6520 7465 7374 206f  or on the test o
-00001c00: 626a 6563 7473 2c20 7765 206e 6565 6420  bjects, we need 
-00001c10: 746f 2067 6574 2074 6865 206c 6162 656c  to get the label
-00001c20: 7320 6f66 2074 6865 204d 6f6e 6472 6961  s of the Mondria
-00001c30: 6e20 6361 7465 676f 7269 6573 2066 6f72  n categories for
-00001c40: 2074 6865 7365 3a0a 0a60 6060 7079 7468   these:..```pyth
-00001c50: 6f6e 0a62 696e 735f 7465 7374 203d 2062  on.bins_test = b
-00001c60: 696e 6e69 6e67 2876 616c 7565 733d 7369  inning(values=si
-00001c70: 676d 6173 5f74 6573 742c 2062 696e 733d  gmas_test, bins=
-00001c80: 6269 6e5f 7468 7265 7368 6f6c 6473 290a  bin_thresholds).
-00001c90: 6060 600a 0a4e 6f77 2077 6520 6861 7665  ```..Now we have
-00001ca0: 2065 7665 7279 7468 696e 6720 7765 206e   everything we n
-00001cb0: 6565 6420 746f 2067 6574 2074 6865 2070  eed to get the p
-00001cc0: 7265 6469 6374 696f 6e20 696e 7465 7276  rediction interv
-00001cd0: 616c 733a 0a0a 6060 6070 7974 686f 6e0a  als:..```python.
-00001ce0: 696e 7465 7276 616c 735f 6d6f 6e64 203d  intervals_mond =
-00001cf0: 2063 725f 6d6f 6e64 2e70 7265 6469 6374   cr_mond.predict
-00001d00: 2879 5f68 6174 3d79 5f68 6174 5f74 6573  (y_hat=y_hat_tes
-00001d10: 742c 2062 696e 733d 6269 6e73 5f74 6573  t, bins=bins_tes
-00001d20: 742c 2079 5f6d 696e 3d30 290a 6060 600a  t, y_min=0).```.
-00001d30: 0a60 6060 6e75 6d70 790a 6172 7261 7928  .```numpy.array(
-00001d40: 5b5b 2032 3036 3337 392e 3720 2c20 2035  [[ 206379.7 ,  5
-00001d50: 3735 3538 342e 3320 5d2c 0a20 2020 2020  75584.3 ],.     
-00001d60: 2020 5b20 3134 3430 3134 2e36 352c 2020    [ 144014.65,  
-00001d70: 3432 3831 3137 2e37 335d 2c0a 2020 2020  428117.73],.    
-00001d80: 2020 205b 2020 3137 3936 352e 3537 2c20     [  17965.57, 
-00001d90: 3131 3533 3136 312e 3537 5d2c 0a20 2020  1153161.57],.   
-00001da0: 2020 2020 2e2e 2e2c 0a20 2020 2020 2020      ...,.       
-00001db0: 5b20 3635 3338 3635 2e32 322c 2020 3935  [ 653865.22,  95
-00001dc0: 3738 3131 2e32 325d 2c0a 2020 2020 2020  7811.22],.      
-00001dd0: 205b 2031 3734 3236 342e 3837 2c20 2033   [ 174264.87,  3
-00001de0: 3335 3331 362e 3037 5d2c 0a20 2020 2020  35316.07],.     
-00001df0: 2020 5b20 3134 3035 3837 2e34 362c 2020    [ 140587.46,  
-00001e00: 3533 3130 3636 2e31 345d 5d29 0a60 6060  531066.14]]).```
-00001e10: 0a0a 2323 2320 436f 6e66 6f72 6d61 6c20  ..### Conformal 
-00001e20: 7072 6564 6963 7469 7665 2073 7973 7465  predictive syste
-00001e30: 6d73 0a0a 5468 6520 696e 7465 7266 6163  ms..The interfac
-00001e40: 6520 746f 2061 2060 436f 6e66 6f72 6d61  e to a `Conforma
-00001e50: 6c50 7265 6469 6374 6976 6553 7973 7465  lPredictiveSyste
-00001e60: 6d60 2069 7320 7665 7279 2073 696d 696c  m` is very simil
-00001e70: 6172 2074 6f20 7468 6174 206f 6620 6120  ar to that of a 
-00001e80: 636f 6e66 6f72 6d61 6c20 7265 6772 6573  conformal regres
-00001e90: 736f 723b 2062 7920 7072 6f76 6964 696e  sor; by providin
-00001ea0: 6720 6a75 7374 2074 6865 2072 6573 6964  g just the resid
-00001eb0: 7561 6c73 2c20 7765 2067 6574 2061 2073  uals, we get a s
-00001ec0: 7461 6e64 6172 6420 636f 6e66 6f72 6d61  tandard conforma
-00001ed0: 6c20 7072 6564 6963 7469 7665 2073 7973  l predictive sys
-00001ee0: 7465 6d2c 2062 7920 7072 6f76 6964 696e  tem, by providin
-00001ef0: 6720 616c 736f 2064 6966 6669 6375 6c74  g also difficult
-00001f00: 7920 6573 7469 6d61 7465 732c 2077 6520  y estimates, we 
-00001f10: 6765 7420 6120 6e6f 726d 616c 697a 6564  get a normalized
-00001f20: 2063 6f6e 666f 726d 616c 2070 7265 6469   conformal predi
-00001f30: 6374 6976 6520 7379 7374 656d 2061 6e64  ctive system and
-00001f40: 2062 7920 7072 6f76 6964 696e 6720 6c61   by providing la
-00001f50: 6265 6c73 2066 6f72 204d 6f6e 6472 6961  bels for Mondria
-00001f60: 6e20 6361 7465 676f 7269 6573 2028 6269  n categories (bi
-00001f70: 6e73 292c 2077 6520 6765 7420 6120 4d6f  ns), we get a Mo
-00001f80: 6e64 7269 616e 2063 6f6e 666f 726d 616c  ndrian conformal
-00001f90: 2070 7265 6469 6374 6976 6520 7379 7374   predictive syst
-00001fa0: 656d 2e0a 0a54 6865 206d 6169 6e20 6469  em...The main di
-00001fb0: 6666 6572 656e 6365 2074 6f20 636f 6e66  fference to conf
-00001fc0: 6f72 6d61 6c20 7265 6772 6573 736f 7273  ormal regressors
-00001fd0: 2063 6f6e 6365 726e 7320 7468 6520 6f75   concerns the ou
-00001fe0: 7470 7574 3b20 696e 7374 6561 6420 6f66  tput; instead of
-00001ff0: 2070 7265 6469 6374 696f 6e20 696e 7465   prediction inte
-00002000: 7276 616c 732c 2063 6f6e 666f 726d 616c  rvals, conformal
-00002010: 2070 7265 6469 6374 6976 6520 7379 7374   predictive syst
-00002020: 656d 7320 7072 6f64 7563 6520 636f 6d70  ems produce comp
-00002030: 6c65 7465 2063 756d 756c 6174 6976 6520  lete cumulative 
-00002040: 6469 7374 7269 6275 7469 6f6e 2066 756e  distribution fun
-00002050: 6374 696f 6e73 2028 636f 6e66 6f72 6d61  ctions (conforma
-00002060: 6c20 7072 6564 6963 7469 7665 2064 6973  l predictive dis
-00002070: 7472 6962 7574 696f 6e73 292e 2046 726f  tributions). Fro
-00002080: 6d20 7468 6573 6520 7765 2063 616e 2067  m these we can g
-00002090: 656e 6572 6174 6520 7072 6564 6963 7469  enerate predicti
-000020a0: 6f6e 2069 6e74 6572 7661 6c73 2c20 6275  on intervals, bu
-000020b0: 7420 7765 2063 616e 2061 6c73 6f20 6f62  t we can also ob
-000020c0: 7461 696e 2070 6572 6365 6e74 696c 6573  tain percentiles
-000020d0: 2c20 6361 6c69 6272 6174 6564 2070 6f69  , calibrated poi
-000020e0: 6e74 2070 7265 6469 6374 696f 6e73 2c20  nt predictions, 
-000020f0: 6173 2077 656c 6c20 6173 2070 2d76 616c  as well as p-val
-00002100: 7565 7320 666f 7220 6769 7665 6e20 7461  ues for given ta
-00002110: 7267 6574 2076 616c 7565 732e 0a0a 4c65  rget values...Le
-00002120: 7420 7573 2066 6974 2061 204d 6f6e 6472  t us fit a Mondr
-00002130: 6961 6e20 6e6f 726d 616c 697a 6564 2063  ian normalized c
-00002140: 6f6e 666f 726d 616c 2070 7265 6469 6374  onformal predict
-00002150: 6976 6520 7379 7374 656d 2c20 7573 696e  ive system, usin
-00002160: 6720 7468 6520 6162 6f76 6520 7265 7369  g the above resi
-00002170: 6475 616c 7320 616e 6420 6469 6666 6963  duals and diffic
-00002180: 756c 7479 2065 7374 696d 6174 6573 2028  ulty estimates (
-00002190: 7369 676d 6173 292c 2061 6e64 2077 6865  sigmas), and whe
-000021a0: 7265 2074 6865 204d 6f6e 6472 6961 6e20  re the Mondrian 
-000021b0: 6361 7465 676f 7269 6573 2028 6269 6e73  categories (bins
-000021c0: 2920 6172 6520 666f 726d 6564 2075 7369  ) are formed usi
-000021d0: 6e67 2074 6865 2070 6f69 6e74 2070 7265  ng the point pre
-000021e0: 6469 6374 696f 6e73 2066 6f72 2074 6865  dictions for the
-000021f0: 2063 616c 6962 7261 7469 6f6e 2073 6574   calibration set
-00002200: 3a0a 0a60 6060 7079 7468 6f6e 0a66 726f  :..```python.fro
-00002210: 6d20 6372 6570 6573 2069 6d70 6f72 7420  m crepes import 
-00002220: 436f 6e66 6f72 6d61 6c50 7265 6469 6374  ConformalPredict
-00002230: 6976 6553 7973 7465 6d0a 0a62 696e 735f  iveSystem..bins_
-00002240: 6361 6c2c 2062 696e 5f74 6872 6573 686f  cal, bin_thresho
-00002250: 6c64 7320 3d20 6269 6e6e 696e 6728 7661  lds = binning(va
-00002260: 6c75 6573 3d79 5f68 6174 5f63 616c 2c20  lues=y_hat_cal, 
-00002270: 6269 6e73 3d35 290a 0a63 7073 5f6d 6f6e  bins=5)..cps_mon
-00002280: 645f 6e6f 726d 203d 2043 6f6e 666f 726d  d_norm = Conform
-00002290: 616c 5072 6564 6963 7469 7665 5379 7374  alPredictiveSyst
-000022a0: 656d 2829 2e66 6974 2872 6573 6964 7561  em().fit(residua
-000022b0: 6c73 3d72 6573 6964 7561 6c73 5f63 616c  ls=residuals_cal
-000022c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000022d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000022e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000022f0: 2020 7369 676d 6173 3d73 6967 6d61 735f    sigmas=sigmas_
-00002300: 6361 6c2c 0a20 2020 2020 2020 2020 2020  cal,.           
-00002310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002330: 2020 2020 2062 696e 733d 6269 6e73 5f63       bins=bins_c
-00002340: 616c 290a 6060 600a 0a57 6520 616c 7265  al).```..We alre
-00002350: 6164 7920 6861 7665 2074 6865 2070 6f69  ady have the poi
-00002360: 6e74 2070 7265 6469 6374 696f 6e73 2061  nt predictions a
-00002370: 6e64 2074 6865 2064 6966 6669 6375 6c74  nd the difficult
-00002380: 7920 6573 7469 6d61 7465 7320 666f 7220  y estimates for 
-00002390: 7468 6520 7465 7374 206f 626a 6563 7473  the test objects
-000023a0: 2c20 736f 2077 6520 6a75 7374 206e 6565  , so we just nee
-000023b0: 6420 7468 6520 6361 7465 676f 7279 206c  d the category l
-000023c0: 6162 656c 7320 6163 636f 7264 696e 6720  abels according 
-000023d0: 746f 2074 6865 206e 6577 2062 696e 2074  to the new bin t
-000023e0: 6872 6573 686f 6c64 733a 0a0a 6060 6070  hresholds:..```p
-000023f0: 7974 686f 6e0a 6269 6e73 5f74 6573 7420  ython.bins_test 
-00002400: 3d20 6269 6e6e 696e 6728 7661 6c75 6573  = binning(values
-00002410: 3d79 5f68 6174 5f74 6573 742c 2062 696e  =y_hat_test, bin
-00002420: 733d 6269 6e5f 7468 7265 7368 6f6c 6473  s=bin_thresholds
-00002430: 290a 6060 600a 0a57 6520 6361 6e20 6e6f  ).```..We can no
-00002440: 7720 6578 7472 6163 7420 7072 6564 6963  w extract predic
-00002450: 7469 6f6e 2069 6e74 6572 7661 6c73 2066  tion intervals f
-00002460: 726f 6d20 7468 6520 636f 6e66 6f72 6d61  rom the conforma
-00002470: 6c20 7072 6564 6963 7469 7665 2064 6973  l predictive dis
-00002480: 7472 6962 7574 696f 6e73 2066 6f72 2074  tributions for t
-00002490: 6865 2074 6573 7420 6f62 6a65 6374 733a  he test objects:
-000024a0: 200a 0a60 6060 7079 7468 6f6e 0a69 6e74   ..```python.int
-000024b0: 6572 7661 6c73 203d 2063 7073 5f6d 6f6e  ervals = cps_mon
-000024c0: 645f 6e6f 726d 2e70 7265 6469 6374 2879  d_norm.predict(y
-000024d0: 5f68 6174 3d79 5f68 6174 5f74 6573 742c  _hat=y_hat_test,
-000024e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000024f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002500: 2020 2073 6967 6d61 733d 7369 676d 6173     sigmas=sigmas
-00002510: 5f74 6573 742c 0a20 2020 2020 2020 2020  _test,.         
-00002520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002530: 2020 2020 2020 2020 2062 696e 733d 6269           bins=bi
-00002540: 6e73 5f74 6573 742c 0a20 2020 2020 2020  ns_test,.       
-00002550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002560: 2020 2020 2020 2020 2020 206c 6f77 6572             lower
-00002570: 5f70 6572 6365 6e74 696c 6573 3d32 2e35  _percentiles=2.5
-00002580: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00002590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000025a0: 2020 2020 6869 6768 6572 5f70 6572 6365      higher_perce
-000025b0: 6e74 696c 6573 3d39 372e 352c 0a20 2020  ntiles=97.5,.   
-000025c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000025d0: 2020 2020 2020 2020 2020 2020 2020 2079                 y
-000025e0: 5f6d 696e 3d30 290a 6060 600a 0a60 6060  _min=0).```..```
-000025f0: 6e75 6d70 790a 6172 7261 7928 5b5b 2032  numpy.array([[ 2
-00002600: 3435 3832 362e 3334 3232 3639 3320 2c20  45826.3422693 , 
-00002610: 2035 3137 3331 352e 3833 3631 3839 3835   517315.83618985
-00002620: 5d2c 0a20 2020 2020 2020 5b20 3134 3533  ],.       [ 1453
-00002630: 3438 2e30 3334 3135 3834 382c 2020 3339  48.03415848,  39
-00002640: 3239 3638 2e31 3535 3837 3939 375d 2c0a  2968.15587997],.
-00002650: 2020 2020 2020 205b 2031 3438 3737 342e         [ 148774.
-00002660: 3635 3436 3132 3132 2c20 3130 3334 3330  65461212, 103430
-00002670: 302e 3834 3139 3539 3736 5d2c 0a20 2020  0.84195976],.   
-00002680: 2020 2020 2e2e 2e2c 0a20 2020 2020 2020      ...,.       
-00002690: 5b20 3538 3932 3030 2e35 3732 3539 3537  [ 589200.5725957
-000026a0: 202c 2031 3035 3730 3133 2e38 3931 3032   , 1057013.89102
-000026b0: 3030 375d 2c0a 2020 2020 2020 205b 2031  007],.       [ 1
-000026c0: 3731 3933 382e 3239 3338 3239 3532 2c20  71938.29382952, 
-000026d0: 2033 3137 3733 322e 3331 3631 3131 3431   317732.31611141
-000026e0: 5d2c 0a20 2020 2020 2020 5b20 3136 3734  ],.       [ 1674
-000026f0: 3938 2e30 3135 3430 3530 342c 2020 3438  98.01540504,  48
-00002700: 3233 3238 2e39 3835 3532 3633 325d 5d29  2328.98552632]])
-00002710: 0a60 6060 0a0a 5765 2063 616e 2061 6c73  .```..We can als
-00002720: 6f20 6765 7420 7468 6520 702d 7661 6c75  o get the p-valu
-00002730: 6573 2066 6f72 2074 6865 2074 7275 6520  es for the true 
-00002740: 7461 7267 6574 2076 616c 7565 733b 2074  target values; t
-00002750: 6865 7920 7368 6f75 6c64 2062 6520 756e  hey should be un
-00002760: 6966 6f72 6d6c 7920 6469 7374 7269 6275  iformly distribu
-00002770: 7465 642c 2069 6620 7468 6520 7465 7374  ted, if the test
-00002780: 206f 626a 6563 7473 2061 7265 2064 7261   objects are dra
-00002790: 776e 2066 726f 6d20 7468 6520 7361 6d65  wn from the same
-000027a0: 2075 6e64 6572 6c79 696e 6720 6469 7374   underlying dist
-000027b0: 7269 6275 7469 6f6e 2061 7320 7468 6520  ribution as the 
-000027c0: 6361 6c69 6272 6174 696f 6e20 6578 616d  calibration exam
-000027d0: 706c 6573 2e0a 0a60 6060 7079 7468 6f6e  ples...```python
-000027e0: 0a70 5f76 616c 7565 7320 3d20 6370 735f  .p_values = cps_
-000027f0: 6d6f 6e64 5f6e 6f72 6d2e 7072 6564 6963  mond_norm.predic
-00002800: 7428 795f 6861 743d 795f 6861 745f 7465  t(y_hat=y_hat_te
-00002810: 7374 2c0a 2020 2020 2020 2020 2020 2020  st,.            
-00002820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002830: 2020 2020 2073 6967 6d61 733d 7369 676d       sigmas=sigm
-00002840: 6173 5f74 6573 742c 0a20 2020 2020 2020  as_test,.       
-00002850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002860: 2020 2020 2020 2020 2020 6269 6e73 3d62            bins=b
-00002870: 696e 735f 7465 7374 2c0a 2020 2020 2020  ins_test,.      
-00002880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002890: 2020 2020 2020 2020 2020 2079 3d79 5f74             y=y_t
-000028a0: 6573 7429 0a60 6060 0a0a 6060 606e 756d  est).```..```num
-000028b0: 7079 0a61 7272 6179 285b 5b30 2e39 3836  py.array([[0.986
-000028c0: 3033 3631 345d 2c0a 2020 2020 2020 205b  03614],.       [
-000028d0: 302e 3837 3137 3832 3536 5d2c 0a20 2020  0.87178256],.   
-000028e0: 2020 2020 5b30 2e34 3432 3031 3938 345d      [0.44201984]
-000028f0: 2c0a 2020 2020 2020 202e 2e2e 2c0a 2020  ,.       ...,.  
-00002900: 2020 2020 205b 302e 3035 3638 3838 3034       [0.05688804
-00002910: 5d2c 0a20 2020 2020 2020 5b30 2e30 3934  ],.       [0.094
-00002920: 3733 3630 345d 2c0a 2020 2020 2020 205b  73604],.       [
-00002930: 302e 3331 3036 3939 3133 5d5d 290a 6060  0.31069913]]).``
-00002940: 600a 0a57 6520 6d61 7920 7265 7175 6573  `..We may reques
-00002950: 7420 7468 6174 2074 6865 2070 7265 6469  t that the predi
-00002960: 6374 206d 6574 686f 6420 7265 7475 726e  ct method return
-00002970: 7320 7468 6520 6675 6c6c 2063 6f6e 666f  s the full confo
-00002980: 726d 616c 2070 7265 6469 6374 6976 6520  rmal predictive 
-00002990: 6469 7374 7269 6275 7469 6f6e 2028 4350  distribution (CP
-000029a0: 4429 2066 6f72 2065 6163 6820 7465 7374  D) for each test
-000029b0: 2069 6e73 7461 6e63 652c 2061 7320 6465   instance, as de
-000029c0: 6669 6e65 6420 6279 2074 6865 2074 6872  fined by the thr
-000029d0: 6573 686f 6c64 2076 616c 7565 732c 2062  eshold values, b
-000029e0: 7920 7365 7474 696e 6720 6072 6574 7572  y setting `retur
-000029f0: 6e5f 6370 6473 3d54 7275 6560 2e20 5468  n_cpds=True`. Th
-00002a00: 6520 666f 726d 6174 206f 6620 7468 6520  e format of the 
-00002a10: 6469 7374 7269 6275 7469 6f6e 7320 7661  distributions va
-00002a20: 7279 2077 6974 6820 7468 6520 7479 7065  ry with the type
-00002a30: 206f 6620 636f 6e66 6f72 6d61 6c20 7072   of conformal pr
-00002a40: 6564 6963 7469 7665 2073 7973 7465 6d3b  edictive system;
-00002a50: 2066 6f72 2061 2073 7461 6e64 6172 6420   for a standard 
-00002a60: 616e 6420 6e6f 726d 616c 697a 6564 2043  and normalized C
-00002a70: 5053 2c20 7468 6520 6f75 7470 7574 2069  PS, the output i
-00002a80: 7320 616e 2061 7272 6179 2077 6974 6820  s an array with 
-00002a90: 6120 726f 7720 666f 7220 6561 6368 2074  a row for each t
-00002aa0: 6573 7420 696e 7374 616e 6365 2061 6e64  est instance and
-00002ab0: 2061 2063 6f6c 756d 6e20 666f 7220 6561   a column for ea
-00002ac0: 6368 2063 616c 6962 7261 7469 6f6e 2069  ch calibration i
-00002ad0: 6e73 7461 6e63 6520 2872 6573 6964 7561  nstance (residua
-00002ae0: 6c29 2c20 7768 696c 6520 666f 7220 6120  l), while for a 
-00002af0: 4d6f 6e64 7269 616e 2043 5053 2c20 7468  Mondrian CPS, th
-00002b00: 6520 6465 6661 756c 7420 6f75 7470 7574  e default output
-00002b10: 2069 7320 6120 7665 6374 6f72 2063 6f6e   is a vector con
-00002b20: 7461 696e 696e 6720 6f6e 6520 4350 4420  taining one CPD 
-00002b30: 7065 7220 7465 7374 2069 6e73 7461 6e63  per test instanc
-00002b40: 652c 2073 696e 6365 2074 6865 206e 756d  e, since the num
-00002b50: 6265 7220 6f66 2076 616c 7565 7320 6d61  ber of values ma
-00002b60: 7920 7661 7279 2062 6574 7765 656e 2063  y vary between c
-00002b70: 6174 6567 6f72 6965 732e 0a0a 6060 6070  ategories...```p
-00002b80: 7974 686f 6e0a 6370 6473 203d 2063 7073  ython.cpds = cps
-00002b90: 5f6d 6f6e 645f 6e6f 726d 2e70 7265 6469  _mond_norm.predi
-00002ba0: 6374 2879 5f68 6174 3d79 5f68 6174 5f74  ct(y_hat=y_hat_t
-00002bb0: 6573 742c 0a20 2020 2020 2020 2020 2020  est,.           
-00002bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002bd0: 2020 7369 676d 6173 3d73 6967 6d61 735f    sigmas=sigmas_
-00002be0: 7465 7374 2c0a 2020 2020 2020 2020 2020  test,.          
-00002bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002c00: 2020 2062 696e 733d 6269 6e73 5f74 6573     bins=bins_tes
-00002c10: 742c 0a20 2020 2020 2020 2020 2020 2020  t,.             
-00002c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002c30: 7265 7475 726e 5f63 7064 733d 5472 7565  return_cpds=True
-00002c40: 290a 6060 600a 0a54 6865 2072 6573 756c  ).```..The resul
-00002c50: 7469 6e67 2076 6563 746f 7220 6f66 2061  ting vector of a
-00002c60: 7272 6179 7320 6973 206e 6f74 2064 6973  rrays is not dis
-00002c70: 706c 6179 6564 2068 6572 652c 2062 7574  played here, but
-00002c80: 2077 6520 696e 7374 6561 6420 7072 6f76   we instead prov
-00002c90: 6964 6520 6120 706c 6f74 2066 6f72 2074  ide a plot for t
-00002ca0: 6865 2043 5044 206f 6620 6120 7261 6e64  he CPD of a rand
-00002cb0: 6f6d 2074 6573 7420 696e 7374 616e 6365  om test instance
-00002cc0: 3a0a 0a21 5b63 7064 5d28 6874 7470 733a  :..![cpd](https:
-00002cd0: 2f2f 7573 6572 2d69 6d61 6765 732e 6769  //user-images.gi
-00002ce0: 7468 7562 7573 6572 636f 6e74 656e 742e  thubusercontent.
-00002cf0: 636f 6d2f 3738 3338 3734 312f 3233 3530  com/7838741/2350
-00002d00: 3831 3936 392d 3332 3864 3761 3233 2d32  81969-328d7a23-2
-00002d10: 3663 392d 3437 3939 2d61 3234 362d 3863  6c9-4799-a246-8c
-00002d20: 3335 6664 3761 6338 3865 2e70 6e67 290a  35fd7ac88e.png).
-00002d30: 0a23 2320 4578 616d 706c 6573 0a0a 466f  .## Examples..Fo
-00002d40: 7220 6164 6469 7469 6f6e 616c 2065 7861  r additional exa
-00002d50: 6d70 6c65 7320 6f66 2068 6f77 2074 6f20  mples of how to 
-00002d60: 7573 6520 7468 6520 7061 636b 6167 6520  use the package 
-00002d70: 616e 6420 6d6f 6475 6c65 2c20 696e 636c  and module, incl
-00002d80: 7564 696e 6720 686f 7720 746f 2075 7365  uding how to use
-00002d90: 206f 7574 2d6f 662d 6261 6720 7072 6564   out-of-bag pred
-00002da0: 6963 7469 6f6e 7320 7261 7468 6572 2074  ictions rather t
-00002db0: 6861 6e20 6861 7669 6e67 2074 6f20 7265  han having to re
-00002dc0: 6c79 206f 6e20 6469 7669 6469 6e67 2074  ly on dividing t
-00002dd0: 6865 2074 7261 696e 696e 6720 7365 7420  he training set 
-00002de0: 696e 746f 2061 2070 726f 7065 7220 7472  into a proper tr
-00002df0: 6169 6e69 6e67 2061 6e64 2063 616c 6962  aining and calib
-00002e00: 7261 7469 6f6e 2073 6574 2c20 7365 6520  ration set, see 
-00002e10: 5b74 6865 2064 6f63 756d 656e 7461 7469  [the documentati
-00002e20: 6f6e 5d28 6874 7470 733a 2f2f 6372 6570  on](https://crep
-00002e30: 6573 2e72 6561 6474 6865 646f 6373 2e69  es.readthedocs.i
-00002e40: 6f2f 656e 2f6c 6174 6573 742f 2920 616e  o/en/latest/) an
-00002e50: 6420 5b74 6869 7320 4a75 7079 7465 7220  d [this Jupyter 
-00002e60: 6e6f 7465 626f 6f6b 5d28 6874 7470 733a  notebook](https:
-00002e70: 2f2f 6769 7468 7562 2e63 6f6d 2f68 656e  //github.com/hen
-00002e80: 7269 6b62 6f73 7472 6f6d 2f63 7265 7065  rikbostrom/crepe
-00002e90: 732f 626c 6f62 2f6d 6169 6e2f 646f 6373  s/blob/main/docs
-00002ea0: 2f63 7265 7065 735f 6e62 2e69 7079 6e62  /crepes_nb.ipynb
-00002eb0: 292e 0a0a 2323 2043 6974 696e 6720 6372  )...## Citing cr
-00002ec0: 6570 6573 0a0a 4966 2079 6f75 2075 7365  epes..If you use
-00002ed0: 2060 6372 6570 6573 6020 666f 7220 6120   `crepes` for a 
-00002ee0: 7363 6965 6e74 6966 6963 2070 7562 6c69  scientific publi
-00002ef0: 6361 7469 6f6e 2c20 796f 7520 6d61 7920  cation, you may 
-00002f00: 6369 7465 2074 6865 2066 6f6c 6c6f 7769  cite the followi
-00002f10: 6e67 2070 6170 6572 3a0a 0a42 6f73 7472  ng paper:..Bostr
-00002f20: c3b6 6d2c 2048 2e2c 2032 3032 322e 2063  ..m, H., 2022. c
-00002f30: 7265 7065 733a 2061 2050 7974 686f 6e20  repes: a Python 
-00002f40: 5061 636b 6167 6520 666f 7220 4765 6e65  Package for Gene
-00002f50: 7261 7469 6e67 2043 6f6e 666f 726d 616c  rating Conformal
-00002f60: 2052 6567 7265 7373 6f72 7320 616e 6420   Regressors and 
-00002f70: 5072 6564 6963 7469 7665 2053 7973 7465  Predictive Syste
-00002f80: 6d73 2e20 496e 2043 6f6e 666f 726d 616c  ms. In Conformal
-00002f90: 2061 6e64 2050 726f 6261 6269 6c69 7374   and Probabilist
-00002fa0: 6963 2050 7265 6469 6374 696f 6e20 616e  ic Prediction an
-00002fb0: 6420 4170 706c 6963 6174 696f 6e73 2e20  d Applications. 
-00002fc0: 504d 4c52 2c20 3137 392e 205b 4c69 6e6b  PMLR, 179. [Link
-00002fd0: 5d28 6874 7470 733a 2f2f 636f 7061 2d63  ](https://copa-c
-00002fe0: 6f6e 6665 7265 6e63 652e 636f 6d2f 7061  onference.com/pa
-00002ff0: 7065 7273 2f43 4f50 4132 3032 325f 7061  pers/COPA2022_pa
-00003000: 7065 725f 3131 2e70 6466 290a 0a42 6962  per_11.pdf)..Bib
-00003010: 7465 7820 656e 7472 793a 0a0a 6060 6062  tex entry:..```b
-00003020: 6962 7465 780a 4049 6e50 726f 6365 6564  ibtex.@InProceed
-00003030: 696e 6773 7b63 7265 7065 732c 0a20 2074  ings{crepes,.  t
-00003040: 6974 6c65 203d 2009 207b 6372 6570 6573  itle = . {crepes
-00003050: 3a20 6120 5079 7468 6f6e 2050 6163 6b61  : a Python Packa
-00003060: 6765 2066 6f72 2047 656e 6572 6174 696e  ge for Generatin
-00003070: 6720 436f 6e66 6f72 6d61 6c20 5265 6772  g Conformal Regr
-00003080: 6573 736f 7273 2061 6e64 2050 7265 6469  essors and Predi
-00003090: 6374 6976 6520 5379 7374 656d 737d 2c0a  ctive Systems},.
-000030a0: 2020 6175 7468 6f72 203d 2020 2020 2020    author =      
-000030b0: 207b 426f 7374 725c 226f 6d2c 2048 656e   {Bostr\"om, Hen
-000030c0: 7269 6b7d 2c0a 2020 626f 6f6b 7469 746c  rik},.  booktitl
-000030d0: 6520 3d20 0920 7b50 726f 6365 6564 696e  e = . {Proceedin
-000030e0: 6773 206f 6620 7468 6520 456c 6576 656e  gs of the Eleven
-000030f0: 7468 2053 796d 706f 7369 756d 206f 6e20  th Symposium on 
-00003100: 436f 6e66 6f72 6d61 6c20 616e 6420 5072  Conformal and Pr
-00003110: 6f62 6162 696c 6973 7469 6320 5072 6564  obabilistic Pred
-00003120: 6963 7469 6f6e 2061 6e64 2041 7070 6c69  iction and Appli
-00003130: 6361 7469 6f6e 737d 2c0a 2020 7965 6172  cations},.  year
-00003140: 203d 2009 207b 3230 3232 7d2c 0a20 2065   = . {2022},.  e
-00003150: 6469 746f 7220 3d20 0920 7b4a 6f68 616e  ditor = . {Johan
-00003160: 7373 6f6e 2c20 556c 6620 616e 6420 426f  sson, Ulf and Bo
-00003170: 7374 72c3 b66d 2c20 4865 6e72 696b 2061  str..m, Henrik a
-00003180: 6e64 2041 6e20 4e67 7579 656e 2c20 4b68  nd An Nguyen, Kh
-00003190: 756f 6e67 2061 6e64 204c 756f 2c20 5a68  uong and Luo, Zh
-000031a0: 6979 7561 6e20 616e 6420 4361 726c 7373  iyuan and Carlss
-000031b0: 6f6e 2c20 4c61 7273 7d2c 0a20 2076 6f6c  on, Lars},.  vol
-000031c0: 756d 6520 3d20 0920 7b31 3739 7d2c 0a20  ume = . {179},. 
-000031d0: 2073 6572 6965 7320 3d20 0920 7b50 726f   series = . {Pro
-000031e0: 6365 6564 696e 6773 206f 6620 4d61 6368  ceedings of Mach
-000031f0: 696e 6520 4c65 6172 6e69 6e67 2052 6573  ine Learning Res
-00003200: 6561 7263 687d 2c0a 2020 7075 626c 6973  earch},.  publis
-00003210: 6865 7220 3d20 2020 207b 504d 4c52 7d0a  her =    {PMLR}.
-00003220: 7d0a 6060 600a 0a23 2320 5265 6665 7265  }.```..## Refere
-00003230: 6e63 6573 0a0a 3c61 2069 643d 2231 223e  nces..<a id="1">
-00003240: 5b31 5d3c 2f61 3e20 566f 766b 2c20 562e  [1]</a> Vovk, V.
-00003250: 2c20 4761 6d6d 6572 6d61 6e2c 2041 2e20  , Gammerman, A. 
-00003260: 616e 6420 5368 6166 6572 2c20 472e 2c20  and Shafer, G., 
-00003270: 3230 3035 2e20 416c 676f 7269 7468 6d69  2005. Algorithmi
-00003280: 6320 6c65 6172 6e69 6e67 2069 6e20 6120  c learning in a 
-00003290: 7261 6e64 6f6d 2077 6f72 6c64 2e20 5370  random world. Sp
-000032a0: 7269 6e67 6572 205b 4c69 6e6b 5d28 6874  ringer [Link](ht
-000032b0: 7470 733a 2f2f 6c69 6e6b 2e73 7072 696e  tps://link.sprin
-000032c0: 6765 722e 636f 6d2f 626f 6f6b 2f31 302e  ger.com/book/10.
-000032d0: 3130 3037 2f62 3130 3637 3135 290a 0a3c  1007/b106715)..<
-000032e0: 6120 6964 3d22 3222 3e5b 325d 3c2f 613e  a id="2">[2]</a>
-000032f0: 2050 6170 6164 6f70 6f75 6c6f 732c 2048   Papadopoulos, H
-00003300: 2e2c 2050 726f 6564 726f 752c 204b 2e2c  ., Proedrou, K.,
-00003310: 2056 6f76 6b2c 2056 2e20 616e 6420 4761   Vovk, V. and Ga
-00003320: 6d6d 6572 6d61 6e2c 2041 2e2c 2032 3030  mmerman, A., 200
-00003330: 322e 2049 6e64 7563 7469 7665 2063 6f6e  2. Inductive con
-00003340: 6669 6465 6e63 6520 6d61 6368 696e 6573  fidence machines
-00003350: 2066 6f72 2072 6567 7265 7373 696f 6e2e   for regression.
-00003360: 2045 7572 6f70 6561 6e20 436f 6e66 6572   European Confer
-00003370: 656e 6365 206f 6e20 4d61 6368 696e 6520  ence on Machine 
-00003380: 4c65 6172 6e69 6e67 2c20 7070 2e20 3334  Learning, pp. 34
-00003390: 352d 3335 362e 205b 4c69 6e6b 5d28 6874  5-356. [Link](ht
-000033a0: 7470 733a 2f2f 6c69 6e6b 2e73 7072 696e  tps://link.sprin
-000033b0: 6765 722e 636f 6d2f 6368 6170 7465 722f  ger.com/chapter/
-000033c0: 3130 2e31 3030 372f 332d 3534 302d 3336  10.1007/3-540-36
-000033d0: 3735 352d 315f 3239 290a 0a3c 6120 6964  755-1_29)..<a id
-000033e0: 3d22 3322 3e5b 335d 3c2f 613e 204a 6f68  ="3">[3]</a> Joh
-000033f0: 616e 7373 6f6e 2c20 552e 2c20 426f 7374  ansson, U., Bost
-00003400: 72c3 b66d 2c20 482e 2c20 4cc3 b666 7374  r..m, H., L..fst
-00003410: 72c3 b66d 2c20 542e 2061 6e64 204c 696e  r..m, T. and Lin
-00003420: 7573 736f 6e2c 2048 2e2c 2032 3031 342e  usson, H., 2014.
-00003430: 2052 6567 7265 7373 696f 6e20 636f 6e66   Regression conf
-00003440: 6f72 6d61 6c20 7072 6564 6963 7469 6f6e  ormal prediction
-00003450: 2077 6974 6820 7261 6e64 6f6d 2066 6f72   with random for
-00003460: 6573 7473 2e20 4d61 6368 696e 6520 6c65  ests. Machine le
-00003470: 6172 6e69 6e67 2c20 3937 2831 2d32 292c  arning, 97(1-2),
-00003480: 2070 702e 2031 3535 2d31 3736 2e20 5b4c   pp. 155-176. [L
-00003490: 696e 6b5d 2868 7474 7073 3a2f 2f6c 696e  ink](https://lin
-000034a0: 6b2e 7370 7269 6e67 6572 2e63 6f6d 2f61  k.springer.com/a
-000034b0: 7274 6963 6c65 2f31 302e 3130 3037 2f73  rticle/10.1007/s
-000034c0: 3130 3939 342d 3031 342d 3534 3533 2d30  10994-014-5453-0
-000034d0: 290a 0a3c 6120 6964 3d22 3422 3e5b 345d  )..<a id="4">[4]
-000034e0: 3c2f 613e 2042 6f73 7472 c3b6 6d2c 2048  </a> Bostr..m, H
-000034f0: 2e2c 204c 696e 7573 736f 6e2c 2048 2e2c  ., Linusson, H.,
-00003500: 204c c3b6 6673 7472 c3b6 6d2c 2054 2e20   L..fstr..m, T. 
-00003510: 616e 6420 4a6f 6861 6e73 736f 6e2c 2055  and Johansson, U
-00003520: 2e2c 2032 3031 372e 2041 6363 656c 6572  ., 2017. Acceler
-00003530: 6174 696e 6720 6469 6666 6963 756c 7479  ating difficulty
-00003540: 2065 7374 696d 6174 696f 6e20 666f 7220   estimation for 
-00003550: 636f 6e66 6f72 6d61 6c20 7265 6772 6573  conformal regres
-00003560: 7369 6f6e 2066 6f72 6573 7473 2e20 416e  sion forests. An
-00003570: 6e61 6c73 206f 6620 4d61 7468 656d 6174  nals of Mathemat
-00003580: 6963 7320 616e 6420 4172 7469 6669 6369  ics and Artifici
-00003590: 616c 2049 6e74 656c 6c69 6765 6e63 652c  al Intelligence,
-000035a0: 2038 3128 312d 3229 2c20 7070 2e31 3235   81(1-2), pp.125
-000035b0: 2d31 3434 2e20 5b4c 696e 6b5d 2868 7474  -144. [Link](htt
-000035c0: 7073 3a2f 2f6c 696e 6b2e 7370 7269 6e67  ps://link.spring
-000035d0: 6572 2e63 6f6d 2f61 7274 6963 6c65 2f31  er.com/article/1
-000035e0: 302e 3130 3037 2f73 3130 3437 322d 3031  0.1007/s10472-01
-000035f0: 372d 3935 3339 2d39 290a 0a3c 6120 6964  7-9539-9)..<a id
-00003600: 3d22 3522 3e5b 355d 3c2f 613e 2042 6f73  ="5">[5]</a> Bos
-00003610: 7472 c3b6 6d2c 2048 2e20 616e 6420 4a6f  tr..m, H. and Jo
-00003620: 6861 6e73 736f 6e2c 2055 2e2c 2032 3032  hansson, U., 202
-00003630: 302e 204d 6f6e 6472 6961 6e20 636f 6e66  0. Mondrian conf
-00003640: 6f72 6d61 6c20 7265 6772 6573 736f 7273  ormal regressors
-00003650: 2e20 496e 2043 6f6e 666f 726d 616c 2061  . In Conformal a
-00003660: 6e64 2050 726f 6261 6269 6c69 7374 6963  nd Probabilistic
-00003670: 2050 7265 6469 6374 696f 6e20 616e 6420   Prediction and 
-00003680: 4170 706c 6963 6174 696f 6e73 2e20 504d  Applications. PM
-00003690: 4c52 2c20 3132 382c 2070 702e 2031 3134  LR, 128, pp. 114
-000036a0: 2d31 3333 2e20 5b4c 696e 6b5d 2868 7474  -133. [Link](htt
-000036b0: 7073 3a2f 2f70 726f 6365 6564 696e 6773  ps://proceedings
-000036c0: 2e6d 6c72 2e70 7265 7373 2f76 3132 382f  .mlr.press/v128/
-000036d0: 626f 7374 726f 6d32 3061 2e68 746d 6c29  bostrom20a.html)
-000036e0: 0a0a 3c61 2069 643d 2236 223e 5b36 5d3c  ..<a id="6">[6]<
-000036f0: 2f61 3e20 566f 766b 2c20 562e 2c20 5065  /a> Vovk, V., Pe
-00003700: 7465 6a2c 2049 2e2c 204e 6f75 7265 7464  tej, I., Nouretd
-00003710: 696e 6f76 2c20 492e 2c20 4d61 6e6f 6b68  inov, I., Manokh
-00003720: 696e 2c20 562e 2061 6e64 2047 616d 6d65  in, V. and Gamme
-00003730: 726d 616e 2c20 412e 2c20 3230 3230 2e20  rman, A., 2020. 
-00003740: 436f 6d70 7574 6174 696f 6e61 6c6c 7920  Computationally 
-00003750: 6566 6669 6369 656e 7420 7665 7273 696f  efficient versio
-00003760: 6e73 206f 6620 636f 6e66 6f72 6d61 6c20  ns of conformal 
-00003770: 7072 6564 6963 7469 7665 2064 6973 7472  predictive distr
-00003780: 6962 7574 696f 6e73 2e20 4e65 7572 6f63  ibutions. Neuroc
-00003790: 6f6d 7075 7469 6e67 2c20 3339 372c 2070  omputing, 397, p
-000037a0: 702e 3239 322d 3330 382e 205b 4c69 6e6b  p.292-308. [Link
-000037b0: 5d28 6874 7470 733a 2f2f 7777 772e 616d  ](https://www.am
-000037c0: 696e 6572 2e6f 7267 2f70 7562 2f35 6530  iner.org/pub/5e0
-000037d0: 3961 6163 3964 6631 6139 6330 6334 3136  9aac9df1a9c0c416
-000037e0: 6339 6237 302f 636f 6d70 7574 6174 696f  c9b70/computatio
-000037f0: 6e61 6c6c 792d 6566 6669 6369 656e 742d  nally-efficient-
-00003800: 7665 7273 696f 6e73 2d6f 662d 636f 6e66  versions-of-conf
-00003810: 6f72 6d61 6c2d 7072 6564 6963 7469 7665  ormal-predictive
-00003820: 2d64 6973 7472 6962 7574 696f 6e73 290a  -distributions).
-00003830: 0a3c 6120 6964 3d22 3722 3e5b 375d 3c2f  .<a id="7">[7]</
-00003840: 613e 2042 6f73 7472 c3b6 6d2c 2048 2e2c  a> Bostr..m, H.,
-00003850: 204a 6f68 616e 7373 6f6e 2c20 552e 2061   Johansson, U. a
-00003860: 6e64 204c c3b6 6673 7472 c3b6 6d2c 2054  nd L..fstr..m, T
-00003870: 2e2c 2032 3032 312e 204d 6f6e 6472 6961  ., 2021. Mondria
-00003880: 6e20 636f 6e66 6f72 6d61 6c20 7072 6564  n conformal pred
-00003890: 6963 7469 7665 2064 6973 7472 6962 7574  ictive distribut
-000038a0: 696f 6e73 2e20 496e 2043 6f6e 666f 726d  ions. In Conform
-000038b0: 616c 2061 6e64 2050 726f 6261 6269 6c69  al and Probabili
-000038c0: 7374 6963 2050 7265 6469 6374 696f 6e20  stic Prediction 
-000038d0: 616e 6420 4170 706c 6963 6174 696f 6e73  and Applications
-000038e0: 2e20 504d 4c52 2c20 3135 322c 2070 702e  . PMLR, 152, pp.
-000038f0: 2032 342d 3338 2e20 5b4c 696e 6b5d 2868   24-38. [Link](h
-00003900: 7474 7073 3a2f 2f70 726f 6365 6564 696e  ttps://proceedin
-00003910: 6773 2e6d 6c72 2e70 7265 7373 2f76 3135  gs.mlr.press/v15
-00003920: 322f 626f 7374 726f 6d32 3161 2e68 746d  2/bostrom21a.htm
-00003930: 6c29 0a0a 3c61 2069 643d 2238 223e 5b38  l)..<a id="8">[8
-00003940: 5d3c 2f61 3e20 566f 766b 2c20 562e 2c20  ]</a> Vovk, V., 
-00003950: 3230 3232 2e20 556e 6976 6572 7361 6c20  2022. Universal 
-00003960: 7072 6564 6963 7469 7665 2073 7973 7465  predictive syste
-00003970: 6d73 2e20 5061 7474 6572 6e20 5265 636f  ms. Pattern Reco
-00003980: 676e 6974 696f 6e2e 2031 3236 3a20 7070  gnition. 126: pp
-00003990: 2e20 3130 3835 3336 205b 4c69 6e6b 5d28  . 108536 [Link](
-000039a0: 6874 7470 733a 2f2f 646c 2e61 636d 2e6f  https://dl.acm.o
-000039b0: 7267 2f64 6f69 2f61 6273 2f31 302e 3130  rg/doi/abs/10.10
-000039c0: 3136 2f6a 2e70 6174 636f 672e 3230 3232  16/j.patcog.2022
-000039d0: 2e31 3038 3533 3629 0a0a 0a2d 202d 202d  .108536)...- - -
-000039e0: 0a0a 4175 7468 6f72 3a20 4865 6e72 696b  ..Author: Henrik
-000039f0: 2042 6f73 7472 c3b6 6d20 2862 6f73 7472   Bostr..m (bostr
-00003a00: 6f6d 6840 6b74 682e 7365 290a 436f 7079  omh@kth.se).Copy
-00003a10: 7269 6768 7420 3230 3233 2048 656e 7269  right 2023 Henri
-00003a20: 6b20 426f 7374 72c3 b66d 0a4c 6963 656e  k Bostr..m.Licen
-00003a30: 7365 3a20 4253 4420 3320 636c 6175 7365  se: BSD 3 clause
-00003a40: 0a                                       .
+00000320: 612d 666f 7267 652f 6372 6570 6573 2f62  a-forge/crepes/b
+00000330: 6164 6765 732f 706c 6174 666f 726d 732e  adges/platforms.
+00000340: 7376 6722 2061 6c74 3d22 506c 6174 666f  svg" alt="Platfo
+00000350: 726d 7322 2068 6569 6768 743d 3230 2061  rms" height=20 a
+00000360: 6c69 676e 3d22 6365 6e74 6572 223e 3c2f  lign="center"></
+00000370: 613e 0a3c 6120 6872 6566 3d22 6874 7470  a>.<a href="http
+00000380: 733a 2f2f 616e 6163 6f6e 6461 2e6f 7267  s://anaconda.org
+00000390: 2f63 6f6e 6461 2d66 6f72 6765 2f63 7265  /conda-forge/cre
+000003a0: 7065 7322 3e3c 696d 6720 7372 633d 2268  pes"><img src="h
+000003b0: 7474 7073 3a2f 2f61 6e61 636f 6e64 612e  ttps://anaconda.
+000003c0: 6f72 672f 636f 6e64 612d 666f 7267 652f  org/conda-forge/
+000003d0: 6372 6570 6573 2f62 6164 6765 732f 6c69  crepes/badges/li
+000003e0: 6365 6e73 652e 7376 6722 2061 6c74 3d22  cense.svg" alt="
+000003f0: 4c69 6365 6e73 6522 2068 6569 6768 743d  License" height=
+00000400: 3230 2061 6c69 676e 3d22 6365 6e74 6572  20 align="center
+00000410: 223e 3c2f 613e 0a3c 6120 6872 6566 3d22  "></a>.<a href="
+00000420: 6874 7470 733a 2f2f 616e 6163 6f6e 6461  https://anaconda
+00000430: 2e6f 7267 2f63 6f6e 6461 2d66 6f72 6765  .org/conda-forge
+00000440: 2f63 7265 7065 7322 3e3c 696d 6720 7372  /crepes"><img sr
+00000450: 633d 2268 7474 7073 3a2f 2f61 6e61 636f  c="https://anaco
+00000460: 6e64 612e 6f72 672f 636f 6e64 612d 666f  nda.org/conda-fo
+00000470: 7267 652f 6372 6570 6573 2f62 6164 6765  rge/crepes/badge
+00000480: 732f 6c61 7465 7374 5f72 656c 6561 7365  s/latest_release
+00000490: 5f64 6174 652e 7376 6722 2061 6c74 3d22  _date.svg" alt="
+000004a0: 5265 6c65 6173 6520 6461 7465 2220 6865  Release date" he
+000004b0: 6967 6874 3d32 3020 616c 6967 6e3d 2263  ight=20 align="c
+000004c0: 656e 7465 7222 3e3c 2f61 3e0a 3c2f 703e  enter"></a>.</p>
+000004d0: 0a3c 6272 3e0a 0a60 6372 6570 6573 6020  .<br>..`crepes` 
+000004e0: 6973 2061 2050 7974 686f 6e20 7061 636b  is a Python pack
+000004f0: 6167 6520 666f 7220 6765 6e65 7261 7469  age for generati
+00000500: 6e67 202a 636f 6e66 6f72 6d61 6c20 7265  ng *conformal re
+00000510: 6772 6573 736f 7273 2a2c 2077 6869 6368  gressors*, which
+00000520: 2074 7261 6e73 666f 726d 2070 6f69 6e74   transform point
+00000530: 2070 7265 6469 6374 696f 6e73 206f 6620   predictions of 
+00000540: 616e 7920 756e 6465 726c 7969 6e67 2072  any underlying r
+00000550: 6567 7265 7373 696f 6e20 6d6f 6465 6c20  egression model 
+00000560: 696e 746f 2070 7265 6469 6374 696f 6e20  into prediction 
+00000570: 696e 7465 7276 616c 7320 666f 7220 7370  intervals for sp
+00000580: 6563 6966 6965 6420 6c65 7665 6c73 206f  ecified levels o
+00000590: 6620 636f 6e66 6964 656e 6365 2e20 5468  f confidence. Th
+000005a0: 6520 7061 636b 6167 6520 616c 736f 2069  e package also i
+000005b0: 6d70 6c65 6d65 6e74 7320 2a63 6f6e 666f  mplements *confo
+000005c0: 726d 616c 2070 7265 6469 6374 6976 6520  rmal predictive 
+000005d0: 7379 7374 656d 732a 2c20 7768 6963 6820  systems*, which 
+000005e0: 7472 616e 7366 6f72 6d20 7468 6520 706f  transform the po
+000005f0: 696e 7420 7072 6564 6963 7469 6f6e 7320  int predictions 
+00000600: 696e 746f 2063 756d 756c 6174 6976 6520  into cumulative 
+00000610: 6469 7374 7269 6275 7469 6f6e 2066 756e  distribution fun
+00000620: 6374 696f 6e73 2e0a 0a54 6865 2060 6372  ctions...The `cr
+00000630: 6570 6573 6020 7061 636b 6167 6520 696d  epes` package im
+00000640: 706c 656d 656e 7473 2073 7461 6e64 6172  plements standar
+00000650: 642c 206e 6f72 6d61 6c69 7a65 6420 616e  d, normalized an
+00000660: 6420 4d6f 6e64 7269 616e 2063 6f6e 666f  d Mondrian confo
+00000670: 726d 616c 2072 6567 7265 7373 6f72 7320  rmal regressors 
+00000680: 616e 6420 7072 6564 6963 7469 7665 2073  and predictive s
+00000690: 7973 7465 6d73 2e20 5768 696c 6520 7468  ystems. While th
+000006a0: 6520 7061 636b 6167 6520 616c 6c6f 7773  e package allows
+000006b0: 2079 6f75 2074 6f20 7573 6520 796f 7572   you to use your
+000006c0: 206f 776e 2064 6966 6669 6375 6c74 7920   own difficulty 
+000006d0: 6573 7469 6d61 7465 7320 616e 6420 4d6f  estimates and Mo
+000006e0: 6e64 7269 616e 2063 6174 6567 6f72 6965  ndrian categorie
+000006f0: 732c 2074 6865 7265 2069 7320 616c 736f  s, there is also
+00000700: 2061 2073 6570 6172 6174 6520 6d6f 6475   a separate modu
+00000710: 6c65 2c20 6361 6c6c 6564 2060 6372 6570  le, called `crep
+00000720: 6573 2e66 696c 6c69 6e67 7360 2c20 7768  es.fillings`, wh
+00000730: 6963 6820 7072 6f76 6964 6573 2073 6f6d  ich provides som
+00000740: 6520 7374 616e 6461 7264 206f 7074 696f  e standard optio
+00000750: 6e73 2066 6f72 2074 6865 7365 2e0a 0a23  ns for these...#
+00000760: 2320 496e 7374 616c 6c61 7469 6f6e 0a0a  # Installation..
+00000770: 4672 6f6d 205b 5079 5049 5d28 6874 7470  From [PyPI](http
+00000780: 733a 2f2f 7079 7069 2e6f 7267 2f70 726f  s://pypi.org/pro
+00000790: 6a65 6374 2f63 7265 7065 732f 290a 0a60  ject/crepes/)..`
+000007a0: 6060 6261 7368 0a70 6970 2069 6e73 7461  ``bash.pip insta
+000007b0: 6c6c 2063 7265 7065 730a 6060 600a 0a46  ll crepes.```..F
+000007c0: 726f 6d20 5b63 6f6e 6461 2d66 6f72 6765  rom [conda-forge
+000007d0: 5d28 6874 7470 733a 2f2f 616e 6163 6f6e  ](https://anacon
+000007e0: 6461 2e6f 7267 2f63 6f6e 6461 2d66 6f72  da.org/conda-for
+000007f0: 6765 2f63 7265 7065 7329 0a0a 6060 6062  ge/crepes)..```b
+00000800: 6173 680a 636f 6e64 6120 696e 7374 616c  ash.conda instal
+00000810: 6c20 2d63 2063 6f6e 6461 2d66 6f72 6765  l -c conda-forge
+00000820: 2063 7265 7065 730a 6060 600a 0a23 2320   crepes.```..## 
+00000830: 446f 6375 6d65 6e74 6174 696f 6e0a 0a46  Documentation..F
+00000840: 6f72 2074 6865 2063 6f6d 706c 6574 6520  or the complete 
+00000850: 646f 6375 6d65 6e74 6174 696f 6e2c 2073  documentation, s
+00000860: 6565 205b 6865 7265 5d28 6874 7470 733a  ee [here](https:
+00000870: 2f2f 6372 6570 6573 2e72 6561 6474 6865  //crepes.readthe
+00000880: 646f 6373 2e69 6f2f 656e 2f6c 6174 6573  docs.io/en/lates
+00000890: 742f 292e 0a0a 2323 2051 7569 636b 7374  t/)...## Quickst
+000008a0: 6172 740a 0a57 6520 6669 7273 7420 696d  art..We first im
+000008b0: 706f 7274 2074 6865 2063 6c61 7373 2060  port the class `
+000008c0: 5772 6170 6020 6672 6f6d 2060 6372 6570  Wrap` from `crep
+000008d0: 6573 6020 616e 6420 6120 6865 6c70 6572  es` and a helper
+000008e0: 2063 6c61 7373 2061 6e64 2066 756e 6374   class and funct
+000008f0: 696f 6e20 6672 6f6d 2060 6372 6570 6573  ion from `crepes
+00000900: 2e65 7874 7261 7360 3a0a 0a60 6060 7079  .extras`:..```py
+00000910: 7468 6f6e 0a66 726f 6d20 6372 6570 6573  thon.from crepes
+00000920: 2069 6d70 6f72 7420 5772 6170 0a66 726f   import Wrap.fro
+00000930: 6d20 6372 6570 6573 2e65 7874 7261 7320  m crepes.extras 
+00000940: 696d 706f 7274 2044 6966 6669 6375 6c74  import Difficult
+00000950: 7945 7374 696d 6174 6f72 2c20 6269 6e6e  yEstimator, binn
+00000960: 696e 670a 6060 600a 0a4c 6574 2075 7320  ing.```..Let us 
+00000970: 616c 736f 2069 6d70 6f72 7420 736f 6d65  also import some
+00000980: 2061 6464 6974 696f 6e61 6c20 6675 6e63   additional func
+00000990: 7469 6f6e 7320 616e 6420 6120 636c 6173  tions and a clas
+000009a0: 7320 746f 2069 6c6c 7573 7472 6174 6520  s to illustrate 
+000009b0: 7468 6520 6162 6f76 6520 7573 696e 6720  the above using 
+000009c0: 6120 6461 7461 7365 7420 6672 6f6d 205b  a dataset from [
+000009d0: 7777 772e 6f70 656e 6d6c 2e6f 7267 5d28  www.openml.org](
+000009e0: 6874 7470 733a 2f2f 7777 772e 6f70 656e  https://www.open
+000009f0: 6d6c 2e6f 7267 2920 616e 6420 6120 6052  ml.org) and a `R
+00000a00: 616e 646f 6d46 6f72 6573 7452 6567 7265  andomForestRegre
+00000a10: 7373 6f72 6020 6672 6f6d 205b 736b 6c65  ssor` from [skle
+00000a20: 6172 6e5d 2868 7474 7073 3a2f 2f73 6369  arn](https://sci
+00000a30: 6b69 742d 6c65 6172 6e2e 6f72 6729 3a0a  kit-learn.org):.
+00000a40: 0a60 6060 7079 7468 6f6e 0a66 726f 6d20  .```python.from 
+00000a50: 736b 6c65 6172 6e2e 6461 7461 7365 7473  sklearn.datasets
+00000a60: 2069 6d70 6f72 7420 6665 7463 685f 6f70   import fetch_op
+00000a70: 656e 6d6c 0a66 726f 6d20 736b 6c65 6172  enml.from sklear
+00000a80: 6e2e 6d6f 6465 6c5f 7365 6c65 6374 696f  n.model_selectio
+00000a90: 6e20 696d 706f 7274 2074 7261 696e 5f74  n import train_t
+00000aa0: 6573 745f 7370 6c69 740a 6672 6f6d 2073  est_split.from s
+00000ab0: 6b6c 6561 726e 2e65 6e73 656d 626c 6520  klearn.ensemble 
+00000ac0: 696d 706f 7274 2052 616e 646f 6d46 6f72  import RandomFor
+00000ad0: 6573 7452 6567 7265 7373 6f72 0a60 6060  estRegressor.```
+00000ae0: 0a0a 5765 2077 696c 6c20 6e6f 7720 696d  ..We will now im
+00000af0: 706f 7274 2061 6e64 2073 706c 6974 2074  port and split t
+00000b00: 6865 2064 6174 6173 6574 2069 6e74 6f20  he dataset into 
+00000b10: 6120 7472 6169 6e69 6e67 2061 6e64 2061  a training and a
+00000b20: 2074 6573 7420 7365 742c 2061 6e64 2074   test set, and t
+00000b30: 6865 6e20 6675 7274 6865 7220 7370 6c69  hen further spli
+00000b40: 7420 7468 6520 7472 6169 6e69 6e67 2073  t the training s
+00000b50: 6574 2069 6e74 6f20 6120 7072 6f70 6572  et into a proper
+00000b60: 2074 7261 696e 696e 6720 7365 7420 616e   training set an
+00000b70: 6420 6120 6361 6c69 6272 6174 696f 6e20  d a calibration 
+00000b80: 7365 743a 0a0a 6060 6070 7974 686f 6e0a  set:..```python.
+00000b90: 6461 7461 7365 7420 3d20 6665 7463 685f  dataset = fetch_
+00000ba0: 6f70 656e 6d6c 286e 616d 653d 2268 6f75  openml(name="hou
+00000bb0: 7365 5f73 616c 6573 222c 2076 6572 7369  se_sales", versi
+00000bc0: 6f6e 3d33 290a 5820 3d20 6461 7461 7365  on=3).X = datase
+00000bd0: 742e 6461 7461 2e76 616c 7565 732e 6173  t.data.values.as
+00000be0: 7479 7065 2866 6c6f 6174 290a 7920 3d20  type(float).y = 
+00000bf0: 6461 7461 7365 742e 7461 7267 6574 2e76  dataset.target.v
+00000c00: 616c 7565 732e 6173 7479 7065 2866 6c6f  alues.astype(flo
+00000c10: 6174 290a 0a58 5f74 7261 696e 2c20 585f  at)..X_train, X_
+00000c20: 7465 7374 2c20 795f 7472 6169 6e2c 2079  test, y_train, y
+00000c30: 5f74 6573 7420 3d20 7472 6169 6e5f 7465  _test = train_te
+00000c40: 7374 5f73 706c 6974 2858 2c20 792c 2074  st_split(X, y, t
+00000c50: 6573 745f 7369 7a65 3d30 2e35 290a 0a58  est_size=0.5)..X
+00000c60: 5f70 726f 705f 7472 6169 6e2c 2058 5f63  _prop_train, X_c
+00000c70: 616c 2c20 795f 7072 6f70 5f74 7261 696e  al, y_prop_train
+00000c80: 2c20 795f 6361 6c20 3d20 7472 6169 6e5f  , y_cal = train_
+00000c90: 7465 7374 5f73 706c 6974 2858 5f74 7261  test_split(X_tra
+00000ca0: 696e 2c20 795f 7472 6169 6e2c 0a20 2020  in, y_train,.   
+00000cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000ce0: 2020 2020 2020 2020 2074 6573 745f 7369           test_si
+00000cf0: 7a65 3d30 2e32 3529 0a60 6060 0a0a 4c65  ze=0.25).```..Le
+00000d00: 7420 7573 206e 6f77 2022 7772 6170 2220  t us now "wrap" 
+00000d10: 6120 7261 6e64 6f6d 2066 6f72 6573 7420  a random forest 
+00000d20: 7265 6772 6573 736f 7220 616e 6420 6669  regressor and fi
+00000d30: 7420 6974 2028 696e 2074 6865 2075 7375  t it (in the usu
+00000d40: 616c 2077 6179 2920 746f 2074 6865 2070  al way) to the p
+00000d50: 726f 7065 7220 7472 6169 6e69 6e67 2073  roper training s
+00000d60: 6574 3a0a 0a60 6060 7079 7468 6f6e 0a72  et:..```python.r
+00000d70: 6620 3d20 5772 6170 2852 616e 646f 6d46  f = Wrap(RandomF
+00000d80: 6f72 6573 7452 6567 7265 7373 6f72 2829  orestRegressor()
+00000d90: 290a 7266 2e66 6974 2858 5f70 726f 705f  ).rf.fit(X_prop_
+00000da0: 7472 6169 6e2c 2079 5f70 726f 705f 7472  train, y_prop_tr
+00000db0: 6169 6e29 0a60 6060 0a0a 5765 2063 616e  ain).```..We can
+00000dc0: 2075 7365 2074 6865 2066 6974 7465 6420   use the fitted 
+00000dd0: 6d6f 6465 6c20 746f 206f 6274 6169 6e20  model to obtain 
+00000de0: 706f 696e 7420 7072 6564 6963 7469 6f6e  point prediction
+00000df0: 7320 2861 6761 696e 2c20 696e 2074 6865  s (again, in the
+00000e00: 2075 7375 616c 2077 6179 2920 666f 7220   usual way) for 
+00000e10: 7468 6520 6361 6c69 6272 6174 696f 6e20  the calibration 
+00000e20: 6f62 6a65 6374 732c 2066 726f 6d20 7768  objects, from wh
+00000e30: 6963 6820 7765 2063 616e 2063 616c 6375  ich we can calcu
+00000e40: 6c61 7465 2074 6865 2072 6573 6964 7561  late the residua
+00000e50: 6c73 2e20 5468 6573 6520 7265 7369 6475  ls. These residu
+00000e60: 616c 7320 6172 6520 6578 6163 746c 7920  als are exactly 
+00000e70: 7768 6174 2077 6520 6e65 6564 2074 6f20  what we need to 
+00000e80: 2263 616c 6962 7261 7465 2220 7468 6520  "calibrate" the 
+00000e90: 6c65 6172 6e65 723a 200a 0a60 6060 7079  learner: ..```py
+00000ea0: 7468 6f6e 0a72 6573 6964 7561 6c73 203d  thon.residuals =
+00000eb0: 2079 5f63 616c 202d 2072 662e 7072 6564   y_cal - rf.pred
+00000ec0: 6963 7428 585f 6361 6c29 0a72 662e 6361  ict(X_cal).rf.ca
+00000ed0: 6c69 6272 6174 6528 7265 7369 6475 616c  librate(residual
+00000ee0: 7329 0a60 6060 0a0a 4120 2873 7461 6e64  s).```..A (stand
+00000ef0: 6172 6429 2063 6f6e 666f 726d 616c 2072  ard) conformal r
+00000f00: 6567 7265 7373 6f72 2077 6173 2066 6f72  egressor was for
+00000f10: 6d65 6420 2875 6e64 6572 2074 6865 2068  med (under the h
+00000f20: 6f6f 6429 2e20 5765 206d 6179 206e 6f77  ood). We may now
+00000f30: 2075 7365 2069 7420 666f 7220 6f62 7461   use it for obta
+00000f40: 696e 696e 6720 7072 6564 6963 7469 6f6e  ining prediction
+00000f50: 2069 6e74 6572 7661 6c73 2066 6f72 2074   intervals for t
+00000f60: 6865 2074 6573 7420 7365 742c 2068 6572  he test set, her
+00000f70: 6520 7573 696e 6720 6120 636f 6e66 6964  e using a confid
+00000f80: 656e 6365 206c 6576 656c 206f 6620 3939  ence level of 99
+00000f90: 253a 0a0a 6060 6070 7974 686f 6e0a 7266  %:..```python.rf
+00000fa0: 2e70 7265 6469 6374 5f69 6e74 2858 5f74  .predict_int(X_t
+00000fb0: 6573 742c 2063 6f6e 6669 6465 6e63 653d  est, confidence=
+00000fc0: 302e 3939 290a 6060 600a 0a60 6060 6e75  0.99).```..```nu
+00000fd0: 6d70 790a 6172 7261 7928 5b5b 2d31 3731  mpy.array([[-171
+00000fe0: 3930 322e 3220 2c20 2039 3533 3836 362e  902.2 ,  953866.
+00000ff0: 3220 5d2c 0a20 2020 2020 2020 5b2d 3237  2 ],.       [-27
+00001000: 3638 3138 2e30 312c 2020 3834 3839 3530  6818.01,  848950
+00001010: 2e33 395d 2c0a 2020 2020 2020 205b 2020  .39],.       [  
+00001020: 3232 3637 392e 3337 2c20 3131 3438 3434  22679.37, 114844
+00001030: 372e 3737 5d2c 0a20 2020 2020 2020 2e2e  7.77],.       ..
+00001040: 2e2c 0a20 2020 2020 2020 5b20 3234 3239  .,.       [ 2429
+00001050: 3534 2e30 322c 2031 3336 3837 3232 2e34  54.02, 1368722.4
+00001060: 325d 2c0a 2020 2020 2020 205b 2d33 3038  2],.       [-308
+00001070: 3039 332e 3733 2c20 2038 3137 3637 342e  093.73,  817674.
+00001080: 3637 5d2c 0a20 2020 2020 2020 5b2d 3232  67],.       [-22
+00001090: 3730 3537 2e34 202c 2020 3839 3837 3131  7057.4 ,  898711
+000010a0: 2e20 205d 5d29 0a60 6060 0a0a 5468 6520  .  ]]).```..The 
+000010b0: 6f75 7470 7574 2069 7320 6120 5b4e 756d  output is a [Num
+000010c0: 5079 5d28 6874 7470 733a 2f2f 6e75 6d70  Py](https://nump
+000010d0: 792e 6f72 6729 2061 7272 6179 2077 6974  y.org) array wit
+000010e0: 6820 6120 726f 7720 666f 7220 6561 6368  h a row for each
+000010f0: 2074 6573 7420 696e 7374 616e 6365 2c20   test instance, 
+00001100: 616e 6420 7768 6572 6520 7468 6520 7477  and where the tw
+00001110: 6f20 636f 6c75 6d6e 7320 7370 6563 6966  o columns specif
+00001120: 7920 7468 6520 6c6f 7765 7220 616e 6420  y the lower and 
+00001130: 7570 7065 7220 626f 756e 6420 6f66 2065  upper bound of e
+00001140: 6163 6820 7072 6564 6963 7469 6f6e 2069  ach prediction i
+00001150: 6e74 6572 7661 6c2e 0a0a 5765 206d 6179  nterval...We may
+00001160: 2072 6571 7565 7374 2074 6861 7420 7468   request that th
+00001170: 6520 696e 7465 7276 616c 7320 6172 6520  e intervals are 
+00001180: 6375 7420 746f 2065 7863 6c75 6465 2069  cut to exclude i
+00001190: 6d70 6f73 7369 626c 6520 7661 6c75 6573  mpossible values
+000011a0: 2c20 696e 2074 6869 7320 6361 7365 2062  , in this case b
+000011b0: 656c 6f77 2030 2c20 616e 6420 6966 2077  elow 0, and if w
+000011c0: 6520 616c 736f 2072 656c 7920 6f6e 2074  e also rely on t
+000011d0: 6865 2064 6566 6175 6c74 2063 6f6e 6669  he default confi
+000011e0: 6465 6e63 6520 6c65 7665 6c20 2830 2e39  dence level (0.9
+000011f0: 3529 2c20 7468 6520 6f75 7470 7574 2069  5), the output i
+00001200: 6e74 6572 7661 6c73 2077 696c 6c20 6265  ntervals will be
+00001210: 2061 2062 6974 2074 6967 6874 6572 3a0a   a bit tighter:.
+00001220: 0a60 6060 7079 7468 6f6e 0a72 662e 7072  .```python.rf.pr
+00001230: 6564 6963 745f 696e 7428 585f 7465 7374  edict_int(X_test
+00001240: 2c20 795f 6d69 6e3d 3029 0a60 6060 0a0a  , y_min=0).```..
+00001250: 6060 606e 756d 7079 0a61 7272 6179 285b  ```numpy.array([
+00001260: 5b20 3135 3232 3538 2e35 352c 2020 3632  [ 152258.55,  62
+00001270: 3937 3035 2e34 355d 2c0a 2020 2020 2020  9705.45],.      
+00001280: 205b 2020 3437 3334 322e 3734 2c20 2035   [  47342.74,  5
+00001290: 3234 3738 392e 3634 5d2c 0a20 2020 2020  24789.64],.     
+000012a0: 2020 5b20 3334 3638 3430 2e31 322c 2020    [ 346840.12,  
+000012b0: 3832 3432 3837 2e30 325d 2c0a 2020 2020  824287.02],.    
+000012c0: 2020 202e 2e2e 2c0a 2020 2020 2020 205b     ...,.       [
+000012d0: 2035 3637 3131 342e 3737 2c20 3130 3434   567114.77, 1044
+000012e0: 3536 312e 3637 5d2c 0a20 2020 2020 2020  561.67],.       
+000012f0: 5b20 2031 3630 3637 2e30 322c 2020 3439  [  16067.02,  49
+00001300: 3335 3133 2e39 325d 2c0a 2020 2020 2020  3513.92],.      
+00001310: 205b 2020 3937 3130 332e 3335 2c20 2035   [  97103.35,  5
+00001320: 3734 3535 302e 3235 5d5d 290a 6060 600a  74550.25]]).```.
+00001330: 0a54 6865 2061 626f 7665 2069 6e74 6572  .The above inter
+00001340: 7661 6c73 2061 7265 206e 6f74 206e 6f72  vals are not nor
+00001350: 6d61 6c69 7a65 642c 2069 2e65 2e2c 2074  malized, i.e., t
+00001360: 6865 7920 6172 6520 616c 6c20 6f66 2074  hey are all of t
+00001370: 6865 2073 616d 6520 7369 7a65 2028 6174  he same size (at
+00001380: 206c 6561 7374 2062 6566 6f72 6520 7468   least before th
+00001390: 6579 2061 7265 2063 7574 292e 2057 6520  ey are cut). We 
+000013a0: 636f 756c 6420 6d61 6b65 2074 6865 6d20  could make them 
+000013b0: 6d6f 7265 2069 6e66 6f72 6d61 7469 7665  more informative
+000013c0: 2074 6872 6f75 6768 206e 6f72 6d61 6c69   through normali
+000013d0: 7a61 7469 6f6e 2075 7369 6e67 2064 6966  zation using dif
+000013e0: 6669 6375 6c74 7920 6573 7469 6d61 7465  ficulty estimate
+000013f0: 733b 206f 626a 6563 7473 2063 6f6e 7369  s; objects consi
+00001400: 6465 7265 6420 6d6f 7265 2064 6966 6669  dered more diffi
+00001410: 6375 6c74 2077 696c 6c20 6265 2061 7373  cult will be ass
+00001420: 6967 6e65 6420 7769 6465 7220 696e 7465  igned wider inte
+00001430: 7276 616c 732e 0a0a 5765 2077 696c 6c20  rvals...We will 
+00001440: 7573 6520 6120 6044 6966 6669 6375 6c74  use a `Difficult
+00001450: 7945 7374 696d 6174 6f72 6020 666f 7220  yEstimator` for 
+00001460: 7468 6973 2070 7572 706f 7365 2e20 4865  this purpose. He
+00001470: 7265 2069 7420 6573 7469 6d61 7465 7320  re it estimates 
+00001480: 7468 6520 6469 6666 6963 756c 7479 2062  the difficulty b
+00001490: 7920 7468 6520 7374 616e 6461 7264 2064  y the standard d
+000014a0: 6576 6961 7469 6f6e 206f 6620 7468 6520  eviation of the 
+000014b0: 7461 7267 6574 206f 6620 7468 6520 6b20  target of the k 
+000014c0: 2864 6566 6175 6c74 2060 6b3d 3235 6029  (default `k=25`)
+000014d0: 206e 6561 7265 7374 206e 6569 6768 626f   nearest neighbo
+000014e0: 7273 2069 6e20 7468 6520 7072 6f70 6572  rs in the proper
+000014f0: 2074 7261 696e 696e 6720 7365 7420 746f   training set to
+00001500: 2065 6163 6820 6f62 6a65 6374 2069 6e20   each object in 
+00001510: 7468 6520 6361 6c69 6272 6174 696f 6e20  the calibration 
+00001520: 7365 742e 2041 2073 6d61 6c6c 2076 616c  set. A small val
+00001530: 7565 2028 6265 7461 2920 6973 2061 6464  ue (beta) is add
+00001540: 6564 2074 6f20 7468 6520 6573 7469 6d61  ed to the estima
+00001550: 7465 732c 2077 6869 6368 206d 6179 2062  tes, which may b
+00001560: 6520 6769 7665 6e20 7468 726f 7567 6820  e given through 
+00001570: 616e 2061 7267 756d 656e 7420 746f 2074  an argument to t
+00001580: 6865 2066 756e 6374 696f 6e3b 2062 656c  he function; bel
+00001590: 6f77 2077 6520 6a75 7374 2075 7365 2074  ow we just use t
+000015a0: 6865 2064 6566 6175 6c74 2c20 692e 652e  he default, i.e.
+000015b0: 2c20 6062 6574 613d 302e 3031 602e 0a0a  , `beta=0.01`...
+000015c0: 5765 2066 6972 7374 206f 6274 6169 6e20  We first obtain 
+000015d0: 7468 6520 6469 6666 6963 756c 7479 2065  the difficulty e
+000015e0: 7374 696d 6174 6573 2066 6f72 2074 6865  stimates for the
+000015f0: 2063 616c 6962 7261 7469 6f6e 2073 6574   calibration set
+00001600: 3a0a 0a60 6060 7079 7468 6f6e 0a64 6520  :..```python.de 
+00001610: 3d20 4469 6666 6963 756c 7479 4573 7469  = DifficultyEsti
+00001620: 6d61 746f 7228 290a 6465 2e66 6974 2858  mator().de.fit(X
+00001630: 5f70 726f 705f 7472 6169 6e2c 2079 3d79  _prop_train, y=y
+00001640: 5f70 726f 705f 7472 6169 6e29 0a0a 7369  _prop_train)..si
+00001650: 676d 6173 5f63 616c 203d 2064 652e 6170  gmas_cal = de.ap
+00001660: 706c 7928 585f 6361 6c29 0a60 6060 0a0a  ply(X_cal).```..
+00001670: 5468 6573 6520 6361 6e20 6e6f 7720 6265  These can now be
+00001680: 2075 7365 6420 666f 7220 7468 6520 6361   used for the ca
+00001690: 6c69 6272 6174 696f 6e2c 2077 6869 6368  libration, which
+000016a0: 2028 756e 6465 7220 7468 6520 686f 6f64   (under the hood
+000016b0: 2920 7769 6c6c 2070 726f 6475 6365 2061  ) will produce a
+000016c0: 206e 6f72 6d61 6c69 7a65 6420 636f 6e66   normalized conf
+000016d0: 6f72 6d61 6c20 7265 6772 6573 736f 723a  ormal regressor:
+000016e0: 0a0a 6060 6070 7974 686f 6e0a 7266 2e63  ..```python.rf.c
+000016f0: 616c 6962 7261 7465 2872 6573 6964 7561  alibrate(residua
+00001700: 6c73 2c20 7369 676d 6173 3d73 6967 6d61  ls, sigmas=sigma
+00001710: 735f 6361 6c29 0a60 6060 0a0a 5765 206e  s_cal).```..We n
+00001720: 6565 6420 6469 6666 6963 756c 7479 2065  eed difficulty e
+00001730: 7374 696d 6174 6573 2066 6f72 2074 6865  stimates for the
+00001740: 2074 6573 7420 7365 7420 746f 6f2c 2077   test set too, w
+00001750: 6869 6368 2077 6520 7072 6f76 6964 6520  hich we provide 
+00001760: 6173 2069 6e70 7574 2074 6f20 6070 7265  as input to `pre
+00001770: 6469 6374 5f69 6e74 603a 0a60 6060 7079  dict_int`:.```py
+00001780: 7468 6f6e 0a73 6967 6d61 735f 7465 7374  thon.sigmas_test
+00001790: 203d 2064 652e 6170 706c 7928 585f 7465   = de.apply(X_te
+000017a0: 7374 290a 7266 2e70 7265 6469 6374 5f69  st).rf.predict_i
+000017b0: 6e74 2858 5f74 6573 742c 2073 6967 6d61  nt(X_test, sigma
+000017c0: 733d 7369 676d 6173 5f74 6573 742c 2079  s=sigmas_test, y
+000017d0: 5f6d 696e 3d30 290a 6060 600a 0a60 6060  _min=0).```..```
+000017e0: 6e75 6d70 790a 6172 7261 7928 5b5b 2032  numpy.array([[ 2
+000017f0: 3236 3731 392e 3036 3630 3739 3737 2c20  26719.06607977, 
+00001800: 2035 3535 3234 342e 3933 3339 3230 3233   555244.93392023
+00001810: 5d2c 0a20 2020 2020 2020 5b20 3137 3337  ],.       [ 1737
+00001820: 3637 2e39 3037 3533 3731 352c 2020 3339  67.90753715,  39
+00001830: 3833 3634 2e34 3732 3436 3238 355d 2c0a  8364.47246285],.
+00001840: 2020 2020 2020 205b 2031 3234 3639 302e         [ 124690.
+00001850: 3730 3136 3639 3636 2c20 3130 3436 3433  70166966, 104643
+00001860: 362e 3433 3833 3330 3334 5d2c 0a20 2020  6.43833034],.   
+00001870: 2020 2020 2e2e 2e2c 0a20 2020 2020 2020      ...,.       
+00001880: 5b20 3630 3739 3439 2e37 3135 3430 3537  [ 607949.7154057
+00001890: 322c 2031 3030 3337 3236 2e37 3234 3539  2, 1003726.72459
+000018a0: 3432 385d 2c0a 2020 2020 2020 205b 2031  428],.       [ 1
+000018b0: 3838 3637 312e 3337 3532 3237 3820 2c20  88671.3752278 , 
+000018c0: 2033 3230 3930 392e 3536 3437 3732 3220   320909.5647722 
+000018d0: 5d2c 0a20 2020 2020 2020 5b20 3134 3533  ],.       [ 1453
+000018e0: 3430 2e33 3930 3736 3832 342c 2020 3532  40.39076824,  52
+000018f0: 3633 3133 2e32 3039 3233 3137 365d 5d29  6313.20923176]])
+00001900: 0a60 6060 0a0a 4465 7065 6e64 696e 6720  .```..Depending 
+00001910: 6f6e 2074 6865 2065 6d70 6c6f 7965 6420  on the employed 
+00001920: 6469 6666 6963 756c 7479 2065 7374 696d  difficulty estim
+00001930: 6174 6f72 2c20 7468 6520 6e6f 726d 616c  ator, the normal
+00001940: 697a 6564 2069 6e74 6572 7661 6c73 206d  ized intervals m
+00001950: 6179 2073 6f6d 6574 696d 6573 2062 6520  ay sometimes be 
+00001960: 756e 7265 6173 6f6e 6162 6c79 206c 6172  unreasonably lar
+00001970: 6765 2c20 696e 2074 6865 2073 656e 7365  ge, in the sense
+00001980: 2074 6861 7420 7468 6579 206d 6179 2062   that they may b
+00001990: 6520 7365 7665 7261 6c20 7469 6d65 7320  e several times 
+000019a0: 6c61 7267 6572 2074 6861 6e20 616e 7920  larger than any 
+000019b0: 7072 6576 696f 7573 6c79 206f 6273 6572  previously obser
+000019c0: 7665 6420 6572 726f 722e 204d 6f72 656f  ved error. Moreo
+000019d0: 7665 722c 2069 6620 7468 6520 6469 6666  ver, if the diff
+000019e0: 6963 756c 7479 2065 7374 696d 6174 6f72  iculty estimator
+000019f0: 2069 7320 756e 696e 666f 726d 6174 6976   is uninformativ
+00001a00: 652c 2065 2e67 2e2c 2063 6f6d 706c 6574  e, e.g., complet
+00001a10: 656c 7920 7261 6e64 6f6d 2c20 7468 6520  ely random, the 
+00001a20: 7661 7279 696e 6720 696e 7465 7276 616c  varying interval
+00001a30: 2073 697a 6573 206d 6179 2067 6976 6520   sizes may give 
+00001a40: 6120 6661 6c73 6520 696d 7072 6573 7369  a false impressi
+00001a50: 6f6e 206f 6620 7468 6174 2077 6520 6361  on of that we ca
+00001a60: 6e20 6578 7065 6374 206c 6f77 6572 2070  n expect lower p
+00001a70: 7265 6469 6374 696f 6e20 6572 726f 7273  rediction errors
+00001a80: 2066 6f72 2069 6e73 7461 6e63 6573 2077   for instances w
+00001a90: 6974 6820 7469 6768 7465 7220 696e 7465  ith tighter inte
+00001aa0: 7276 616c 732e 2049 6465 616c 6c79 2c20  rvals. Ideally, 
+00001ab0: 6120 6469 6666 6963 756c 7479 2065 7374  a difficulty est
+00001ac0: 696d 6174 6f72 2070 726f 7669 6469 6e67  imator providing
+00001ad0: 206c 6974 746c 6520 6f72 206e 6f20 696e   little or no in
+00001ae0: 666f 726d 6174 696f 6e20 6f6e 2074 6865  formation on the
+00001af0: 2065 7870 6563 7465 6420 6572 726f 7220   expected error 
+00001b00: 7368 6f75 6c64 2069 6e73 7465 6164 206c  should instead l
+00001b10: 6561 6420 746f 206d 6f72 6520 756e 6966  ead to more unif
+00001b20: 6f72 6d6c 7920 6469 7374 7269 6275 7465  ormly distribute
+00001b30: 6420 696e 7465 7276 616c 2073 697a 6573  d interval sizes
+00001b40: 2e0a 0a41 204d 6f6e 6472 6961 6e20 636f  ...A Mondrian co
+00001b50: 6e66 6f72 6d61 6c20 7265 6772 6573 736f  nformal regresso
+00001b60: 7220 6361 6e20 6265 2075 7365 6420 746f  r can be used to
+00001b70: 2061 6464 7265 7373 2074 6865 7365 2070   address these p
+00001b80: 726f 626c 656d 732c 2062 7920 6469 7669  roblems, by divi
+00001b90: 6469 6e67 2074 6865 206f 626a 6563 7420  ding the object 
+00001ba0: 7370 6163 6520 696e 746f 206e 6f6e 2d6f  space into non-o
+00001bb0: 7665 726c 6170 7069 6e67 2073 6f2d 6361  verlapping so-ca
+00001bc0: 6c6c 6564 204d 6f6e 6472 6961 6e20 6361  lled Mondrian ca
+00001bd0: 7465 676f 7269 6573 2c20 616e 6420 666f  tegories, and fo
+00001be0: 726d 696e 6720 6120 2873 7461 6e64 6172  rming a (standar
+00001bf0: 6429 2063 6f6e 666f 726d 616c 2072 6567  d) conformal reg
+00001c00: 7265 7373 6f72 2066 6f72 2065 6163 6820  ressor for each 
+00001c10: 6361 7465 676f 7279 2e20 5468 6520 6361  category. The ca
+00001c20: 7465 676f 7279 206d 656d 6265 7273 6869  tegory membershi
+00001c30: 7020 6f66 2074 6865 206f 626a 6563 7473  p of the objects
+00001c40: 2063 616e 2062 6520 7072 6f76 6964 6564   can be provided
+00001c50: 2061 7320 616e 2061 6464 6974 696f 6e61   as an additiona
+00001c60: 6c20 6172 6775 6d65 6e74 2c20 6e61 6d65  l argument, name
+00001c70: 6420 6062 696e 7360 2c20 666f 7220 7468  d `bins`, for th
+00001c80: 6520 6066 6974 6020 6d65 7468 6f64 2e0a  e `fit` method..
+00001c90: 0a48 6572 6520 7765 2075 7365 2074 6865  .Here we use the
+00001ca0: 2068 656c 7065 7220 6675 6e63 7469 6f6e   helper function
+00001cb0: 2060 6269 6e6e 696e 6760 2074 6f20 666f   `binning` to fo
+00001cc0: 726d 204d 6f6e 6472 6961 6e20 6361 7465  rm Mondrian cate
+00001cd0: 676f 7269 6573 2062 7920 6571 7561 6c2d  gories by equal-
+00001ce0: 7369 7a65 6420 6269 6e6e 696e 6720 6f66  sized binning of
+00001cf0: 2074 6865 2064 6966 6669 6375 6c74 7920   the difficulty 
+00001d00: 6573 7469 6d61 7465 733b 2074 6865 2066  estimates; the f
+00001d10: 756e 6374 696f 6e20 7265 7475 726e 7320  unction returns 
+00001d20: 6c61 6265 6c73 2066 6f72 2074 6865 2063  labels for the c
+00001d30: 616c 6962 7261 7469 6f6e 206f 626a 6563  alibration objec
+00001d40: 7473 2074 6865 2077 6520 7072 6f76 6964  ts the we provid
+00001d50: 6520 6173 2069 6e70 7574 2074 6f20 7468  e as input to th
+00001d60: 6520 6361 6c69 6272 6174 696f 6e2c 2061  e calibration, a
+00001d70: 6e64 2077 6520 616c 736f 2067 6574 2074  nd we also get t
+00001d80: 6872 6573 686f 6c64 7320 666f 7220 7468  hresholds for th
+00001d90: 6520 6269 6e73 2c20 7768 6963 6820 6361  e bins, which ca
+00001da0: 6e20 7573 6520 6c61 7465 7220 7768 656e  n use later when
+00001db0: 2062 696e 6e69 6e67 2074 6865 2074 6573   binning the tes
+00001dc0: 7420 6f62 6a65 6374 733a 0a0a 6060 6070  t objects:..```p
+00001dd0: 7974 686f 6e0a 6269 6e73 5f63 616c 2c20  ython.bins_cal, 
+00001de0: 6269 6e5f 7468 7265 7368 6f6c 6473 203d  bin_thresholds =
+00001df0: 2062 696e 6e69 6e67 2873 6967 6d61 735f   binning(sigmas_
+00001e00: 6361 6c2c 2062 696e 733d 3230 290a 7266  cal, bins=20).rf
+00001e10: 2e63 616c 6962 7261 7465 2872 6573 6964  .calibrate(resid
+00001e20: 7561 6c73 2c20 6269 6e73 3d62 696e 735f  uals, bins=bins_
+00001e30: 6361 6c29 0a60 6060 0a0a 4c65 7420 7573  cal).```..Let us
+00001e40: 206e 6f77 2067 6574 2074 6865 206c 6162   now get the lab
+00001e50: 656c 7320 6f66 2074 6865 204d 6f6e 6472  els of the Mondr
+00001e60: 6961 6e20 6361 7465 676f 7269 6573 2066  ian categories f
+00001e70: 6f72 2074 6865 2074 6573 7420 6f62 6a65  or the test obje
+00001e80: 6374 7320 616e 6420 7573 6520 7468 656d  cts and use them
+00001e90: 2077 6865 6e20 7072 6564 6963 7469 6e67   when predicting
+00001ea0: 2069 6e74 6572 7661 6c73 3a0a 0a60 6060   intervals:..```
+00001eb0: 7079 7468 6f6e 0a62 696e 735f 7465 7374  python.bins_test
+00001ec0: 203d 2062 696e 6e69 6e67 2873 6967 6d61   = binning(sigma
+00001ed0: 735f 7465 7374 2c20 6269 6e73 3d62 696e  s_test, bins=bin
+00001ee0: 5f74 6872 6573 686f 6c64 7329 0a72 662e  _thresholds).rf.
+00001ef0: 7072 6564 6963 745f 696e 7428 585f 7465  predict_int(X_te
+00001f00: 7374 2c20 6269 6e73 3d62 696e 735f 7465  st, bins=bins_te
+00001f10: 7374 2c20 795f 6d69 6e3d 3029 0a60 6060  st, y_min=0).```
+00001f20: 0a0a 6060 606e 756d 7079 0a61 7272 6179  ..```numpy.array
+00001f30: 285b 5b20 3230 3633 3739 2e37 202c 2020  ([[ 206379.7 ,  
+00001f40: 3537 3535 3834 2e33 205d 2c0a 2020 2020  575584.3 ],.    
+00001f50: 2020 205b 2031 3434 3031 342e 3635 2c20     [ 144014.65, 
+00001f60: 2034 3238 3131 372e 3733 5d2c 0a20 2020   428117.73],.   
+00001f70: 2020 2020 5b20 2031 3739 3635 2e35 372c      [  17965.57,
+00001f80: 2031 3135 3331 3631 2e35 375d 2c0a 2020   1153161.57],.  
+00001f90: 2020 2020 202e 2e2e 2c0a 2020 2020 2020       ...,.      
+00001fa0: 205b 2036 3533 3836 352e 3232 2c20 2039   [ 653865.22,  9
+00001fb0: 3537 3831 312e 3232 5d2c 0a20 2020 2020  57811.22],.     
+00001fc0: 2020 5b20 3137 3432 3634 2e38 372c 2020    [ 174264.87,  
+00001fd0: 3333 3533 3136 2e30 375d 2c0a 2020 2020  335316.07],.    
+00001fe0: 2020 205b 2031 3430 3538 372e 3436 2c20     [ 140587.46, 
+00001ff0: 2035 3331 3036 362e 3134 5d5d 290a 6060   531066.14]]).``
+00002000: 600a 0a57 6520 636f 756c 6420 7665 7279  `..We could very
+00002010: 2065 6173 696c 7920 7377 6974 6368 2066   easily switch f
+00002020: 726f 6d20 636f 6e66 6f72 6d61 6c20 7265  rom conformal re
+00002030: 6772 6573 736f 7273 2074 6f20 636f 6e66  gressors to conf
+00002040: 6f72 6d61 6c20 7072 6564 6963 7469 7665  ormal predictive
+00002050: 2073 7973 7465 6d73 2e20 5468 6520 6c61   systems. The la
+00002060: 7474 6572 2070 726f 6475 6365 2063 756d  tter produce cum
+00002070: 756c 6174 6976 6520 6469 7374 7269 6275  ulative distribu
+00002080: 7469 6f6e 2066 756e 6374 696f 6e73 2028  tion functions (
+00002090: 636f 6e66 6f72 6d61 6c20 7072 6564 6963  conformal predic
+000020a0: 7469 7665 2064 6973 7472 6962 7574 696f  tive distributio
+000020b0: 6e73 292e 2046 726f 6d20 7468 6573 6520  ns). From these 
+000020c0: 7765 2063 616e 2067 656e 6572 6174 6520  we can generate 
+000020d0: 7072 6564 6963 7469 6f6e 2069 6e74 6572  prediction inter
+000020e0: 7661 6c73 2c20 6275 7420 7765 2063 616e  vals, but we can
+000020f0: 2061 6c73 6f20 6f62 7461 696e 2070 6572   also obtain per
+00002100: 6365 6e74 696c 6573 2c20 6361 6c69 6272  centiles, calibr
+00002110: 6174 6564 2070 6f69 6e74 2070 7265 6469  ated point predi
+00002120: 6374 696f 6e73 2c20 6173 2077 656c 6c20  ctions, as well 
+00002130: 6173 2070 2d76 616c 7565 7320 666f 7220  as p-values for 
+00002140: 6769 7665 6e20 7461 7267 6574 2076 616c  given target val
+00002150: 7565 732e 204c 6574 2075 7320 7365 6520  ues. Let us see 
+00002160: 686f 7720 7765 2063 616e 2067 6f20 6168  how we can go ah
+00002170: 6561 6420 746f 2064 6f20 7468 6174 2e0a  ead to do that..
+00002180: 0a57 656c 6c2c 2074 6865 7265 2069 7320  .Well, there is 
+00002190: 6f6e 6c79 206f 6e65 2074 6869 6e67 2061  only one thing a
+000021a0: 626f 7665 2074 6861 7420 6368 616e 6765  bove that change
+000021b0: 733a 206a 7573 7420 7072 6f76 6964 6520  s: just provide 
+000021c0: 6063 7073 3d54 7275 6560 2074 6f20 7468  `cps=True` to th
+000021d0: 6520 6063 616c 6962 7261 7465 6020 6d65  e `calibrate` me
+000021e0: 7468 6f64 2e0a 0a57 6520 6361 6e2c 2066  thod...We can, f
+000021f0: 6f72 2065 7861 6d70 6c65 2c20 666f 726d  or example, form
+00002200: 206e 6f72 6d61 6c69 7a65 6420 4d6f 6e64   normalized Mond
+00002210: 7269 616e 2063 6f6e 666f 726d 616c 2070  rian conformal p
+00002220: 7265 6469 6374 6976 6520 7379 7374 656d  redictive system
+00002230: 732c 2062 7920 7072 6f76 6964 696e 6720  s, by providing 
+00002240: 626f 7468 2060 6269 6e73 6020 616e 6420  both `bins` and 
+00002250: 6073 6967 6d61 7360 2074 6f20 7468 6520  `sigmas` to the 
+00002260: 6063 616c 6962 7261 7465 6020 6d65 7468  `calibrate` meth
+00002270: 6f64 2e20 4865 7265 2077 6520 7769 6c6c  od. Here we will
+00002280: 2063 6f6e 7369 6465 7220 4d6f 6e64 7269   consider Mondri
+00002290: 616e 2063 6174 6567 6f72 6965 7320 666f  an categories fo
+000022a0: 726d 6564 2066 726f 6d20 6269 6e6e 696e  rmed from binnin
+000022b0: 6720 7468 6520 706f 696e 7420 7072 6564  g the point pred
+000022c0: 6963 7469 6f6e 733a 0a0a 6060 6070 7974  ictions:..```pyt
+000022d0: 686f 6e0a 6269 6e73 5f63 616c 2c20 6269  hon.bins_cal, bi
+000022e0: 6e5f 7468 7265 7368 6f6c 6473 203d 2062  n_thresholds = b
+000022f0: 696e 6e69 6e67 2872 662e 7072 6564 6963  inning(rf.predic
+00002300: 7428 585f 6361 6c29 2c20 6269 6e73 3d35  t(X_cal), bins=5
+00002310: 290a 7266 2e63 616c 6962 7261 7465 2872  ).rf.calibrate(r
+00002320: 6573 6964 7561 6c73 2c20 7369 676d 6173  esiduals, sigmas
+00002330: 3d73 6967 6d61 735f 6361 6c2c 2062 696e  =sigmas_cal, bin
+00002340: 733d 6269 6e73 5f63 616c 2c20 6370 733d  s=bins_cal, cps=
+00002350: 5472 7565 290a 6060 600a 0a42 7920 7072  True).```..By pr
+00002360: 6f76 6964 696e 6720 7468 6520 6269 6e73  oviding the bins
+00002370: 2028 616e 6420 7369 676d 6173 2920 666f   (and sigmas) fo
+00002380: 7220 7468 6520 7465 7374 206f 626a 6563  r the test objec
+00002390: 7473 2c20 7765 2063 616e 206e 6f77 206d  ts, we can now m
+000023a0: 616b 6520 7072 6564 6963 7469 6f6e 7320  ake predictions 
+000023b0: 7769 7468 2074 6865 2063 6f6e 666f 726d  with the conform
+000023c0: 616c 2070 7265 6469 6374 6976 6520 7379  al predictive sy
+000023d0: 7374 656d 2c20 7468 726f 7567 6820 7468  stem, through th
+000023e0: 6520 6d65 7468 6f64 2060 7072 6564 6963  e method `predic
+000023f0: 745f 6370 7360 2e0a 5468 6520 6f75 7470  t_cps`..The outp
+00002400: 7574 206f 6620 7468 6973 206d 6574 686f  ut of this metho
+00002410: 6420 6361 6e20 6265 2063 6f6e 7472 6f6c  d can be control
+00002420: 6c65 6420 7175 6974 6520 666c 6578 6962  led quite flexib
+00002430: 6c79 3b20 6865 7265 2077 6520 7265 7175  ly; here we requ
+00002440: 6573 7420 7072 6564 6963 7469 6f6e 2069  est prediction i
+00002450: 6e74 6572 7661 6c73 2077 6974 6820 3935  ntervals with 95
+00002460: 2520 636f 6e66 6964 656e 6365 2074 6f20  % confidence to 
+00002470: 6265 206f 7574 7075 743a 0a0a 6060 6070  be output:..```p
+00002480: 7974 686f 6e0a 6269 6e73 5f74 6573 7420  ython.bins_test 
+00002490: 3d20 6269 6e6e 696e 6728 7266 2e70 7265  = binning(rf.pre
+000024a0: 6469 6374 2858 5f74 6573 7429 2c20 6269  dict(X_test), bi
+000024b0: 6e73 3d62 696e 5f74 6872 6573 686f 6c64  ns=bin_threshold
+000024c0: 7329 0a72 662e 7072 6564 6963 745f 6370  s).rf.predict_cp
+000024d0: 7328 585f 7465 7374 2c20 7369 676d 6173  s(X_test, sigmas
+000024e0: 3d73 6967 6d61 735f 7465 7374 2c20 6269  =sigmas_test, bi
+000024f0: 6e73 3d62 696e 735f 7465 7374 2c0a 2020  ns=bins_test,.  
+00002500: 2020 2020 2020 2020 2020 2020 206c 6f77               low
+00002510: 6572 5f70 6572 6365 6e74 696c 6573 3d32  er_percentiles=2
+00002520: 2e35 2c20 6869 6768 6572 5f70 6572 6365  .5, higher_perce
+00002530: 6e74 696c 6573 3d39 372e 352c 2079 5f6d  ntiles=97.5, y_m
+00002540: 696e 3d30 290a 6060 600a 0a60 6060 6e75  in=0).```..```nu
+00002550: 6d70 790a 6172 7261 7928 5b5b 2032 3435  mpy.array([[ 245
+00002560: 3832 362e 3334 3232 3639 3320 2c20 2035  826.3422693 ,  5
+00002570: 3137 3331 352e 3833 3631 3839 3835 5d2c  17315.83618985],
+00002580: 0a20 2020 2020 2020 5b20 3134 3533 3438  .       [ 145348
+00002590: 2e30 3334 3135 3834 382c 2020 3339 3239  .03415848,  3929
+000025a0: 3638 2e31 3535 3837 3939 375d 2c0a 2020  68.15587997],.  
+000025b0: 2020 2020 205b 2031 3438 3737 342e 3635       [ 148774.65
+000025c0: 3436 3132 3132 2c20 3130 3334 3330 302e  461212, 1034300.
+000025d0: 3834 3139 3539 3736 5d2c 0a20 2020 2020  84195976],.     
+000025e0: 2020 2e2e 2e2c 0a20 2020 2020 2020 5b20    ...,.       [ 
+000025f0: 3538 3932 3030 2e35 3732 3539 3537 202c  589200.5725957 ,
+00002600: 2031 3035 3730 3133 2e38 3931 3032 3030   1057013.8910200
+00002610: 375d 2c0a 2020 2020 2020 205b 2031 3731  7],.       [ 171
+00002620: 3933 382e 3239 3338 3239 3532 2c20 2033  938.29382952,  3
+00002630: 3137 3733 322e 3331 3631 3131 3431 5d2c  17732.31611141],
+00002640: 0a20 2020 2020 2020 5b20 3136 3734 3938  .       [ 167498
+00002650: 2e30 3135 3430 3530 342c 2020 3438 3233  .01540504,  4823
+00002660: 3238 2e39 3835 3532 3633 325d 5d29 0a60  28.98552632]]).`
+00002670: 6060 0a0a 4966 2077 6520 776f 756c 6420  ``..If we would 
+00002680: 6c69 6b65 2074 6f20 7461 6b65 2061 206c  like to take a l
+00002690: 6f6f 6b20 6174 2074 6865 2070 2d76 616c  ook at the p-val
+000026a0: 7565 7320 666f 7220 7468 6520 7472 7565  ues for the true
+000026b0: 2074 6172 6765 7473 2028 7468 6573 6520   targets (these 
+000026c0: 7368 6f75 6c64 2062 6520 756e 6966 6f72  should be unifor
+000026d0: 6d6c 7920 6469 7374 7269 6275 7465 6429  mly distributed)
+000026e0: 2c20 7765 2063 616e 2064 6f20 7468 6520  , we can do the 
+000026f0: 666f 6c6c 6f77 696e 673a 0a0a 6060 6070  following:..```p
+00002700: 7974 686f 6e0a 7266 2e70 7265 6469 6374  ython.rf.predict
+00002710: 5f63 7073 2858 5f74 6573 742c 2073 6967  _cps(X_test, sig
+00002720: 6d61 733d 7369 676d 6173 5f74 6573 742c  mas=sigmas_test,
+00002730: 2062 696e 733d 6269 6e73 5f74 6573 742c   bins=bins_test,
+00002740: 2079 3d79 5f74 6573 7429 0a60 6060 0a0a   y=y_test).```..
+00002750: 6060 606e 756d 7079 0a61 7272 6179 285b  ```numpy.array([
+00002760: 302e 3938 3630 3336 3134 2c20 302e 3837  0.98603614, 0.87
+00002770: 3137 3832 3536 2c20 302e 3434 3230 3139  178256, 0.442019
+00002780: 3834 2c20 2e2e 2e2c 2030 2e30 3536 3838  84, ..., 0.05688
+00002790: 3830 342c 2030 2e30 3934 3733 3630 342c  804, 0.09473604,
+000027a0: 0a20 2020 2020 2020 302e 3331 3036 3939  .       0.310699
+000027b0: 3133 5d29 0a60 6060 0a0a 5765 206d 6179  13]).```..We may
+000027c0: 2072 6571 7565 7374 2074 6861 7420 7468   request that th
+000027d0: 6520 6070 7265 6469 6374 5f63 7073 6020  e `predict_cps` 
+000027e0: 6d65 7468 6f64 2072 6574 7572 6e73 2074  method returns t
+000027f0: 6865 2066 756c 6c20 636f 6e66 6f72 6d61  he full conforma
+00002800: 6c20 7072 6564 6963 7469 7665 2064 6973  l predictive dis
+00002810: 7472 6962 7574 696f 6e20 2843 5044 2920  tribution (CPD) 
+00002820: 666f 7220 6561 6368 2074 6573 7420 696e  for each test in
+00002830: 7374 616e 6365 2c20 6173 2064 6566 696e  stance, as defin
+00002840: 6564 2062 7920 7468 6520 7468 7265 7368  ed by the thresh
+00002850: 6f6c 6420 7661 6c75 6573 2c20 6279 2073  old values, by s
+00002860: 6574 7469 6e67 2060 7265 7475 726e 5f63  etting `return_c
+00002870: 7064 733d 5472 7565 602e 2054 6865 2066  pds=True`. The f
+00002880: 6f72 6d61 7420 6f66 2074 6865 2064 6973  ormat of the dis
+00002890: 7472 6962 7574 696f 6e73 2076 6172 7920  tributions vary 
+000028a0: 7769 7468 2074 6865 2074 7970 6520 6f66  with the type of
+000028b0: 2063 6f6e 666f 726d 616c 2070 7265 6469   conformal predi
+000028c0: 6374 6976 6520 7379 7374 656d 3b20 666f  ctive system; fo
+000028d0: 7220 6120 7374 616e 6461 7264 2061 6e64  r a standard and
+000028e0: 206e 6f72 6d61 6c69 7a65 6420 4350 532c   normalized CPS,
+000028f0: 2074 6865 206f 7574 7075 7420 6973 2061   the output is a
+00002900: 6e20 6172 7261 7920 7769 7468 2061 2072  n array with a r
+00002910: 6f77 2066 6f72 2065 6163 6820 7465 7374  ow for each test
+00002920: 2069 6e73 7461 6e63 6520 616e 6420 6120   instance and a 
+00002930: 636f 6c75 6d6e 2066 6f72 2065 6163 6820  column for each 
+00002940: 6361 6c69 6272 6174 696f 6e20 696e 7374  calibration inst
+00002950: 616e 6365 2028 7265 7369 6475 616c 292c  ance (residual),
+00002960: 2077 6869 6c65 2066 6f72 2061 204d 6f6e   while for a Mon
+00002970: 6472 6961 6e20 4350 532c 2074 6865 2064  drian CPS, the d
+00002980: 6566 6175 6c74 206f 7574 7075 7420 6973  efault output is
+00002990: 2061 2076 6563 746f 7220 636f 6e74 6169   a vector contai
+000029a0: 6e69 6e67 206f 6e65 2043 5044 2070 6572  ning one CPD per
+000029b0: 2074 6573 7420 696e 7374 616e 6365 2c20   test instance, 
+000029c0: 7369 6e63 6520 7468 6520 6e75 6d62 6572  since the number
+000029d0: 206f 6620 7661 6c75 6573 206d 6179 2076   of values may v
+000029e0: 6172 7920 6265 7477 6565 6e20 6361 7465  ary between cate
+000029f0: 676f 7269 6573 2e0a 0a60 6060 7079 7468  gories...```pyth
+00002a00: 6f6e 0a72 662e 7072 6564 6963 745f 6370  on.rf.predict_cp
+00002a10: 7328 585f 7465 7374 2c20 7369 676d 6173  s(X_test, sigmas
+00002a20: 3d73 6967 6d61 735f 7465 7374 2c20 6269  =sigmas_test, bi
+00002a30: 6e73 3d62 696e 735f 7465 7374 2c20 7265  ns=bins_test, re
+00002a40: 7475 726e 5f63 7064 733d 5472 7565 290a  turn_cpds=True).
+00002a50: 6060 600a 0a54 6865 2072 6573 756c 7469  ```..The resulti
+00002a60: 6e67 2076 6563 746f 7220 6f66 2061 7272  ng vector of arr
+00002a70: 6179 7320 6973 206e 6f74 2064 6973 706c  ays is not displ
+00002a80: 6179 6564 2068 6572 652c 2062 7574 2077  ayed here, but w
+00002a90: 6520 696e 7374 6561 6420 7072 6f76 6964  e instead provid
+00002aa0: 6520 6120 706c 6f74 2066 6f72 2074 6865  e a plot for the
+00002ab0: 2043 5044 206f 6620 6120 7261 6e64 6f6d   CPD of a random
+00002ac0: 2074 6573 7420 696e 7374 616e 6365 3a0a   test instance:.
+00002ad0: 0a21 5b63 7064 5d28 6874 7470 733a 2f2f  .![cpd](https://
+00002ae0: 7573 6572 2d69 6d61 6765 732e 6769 7468  user-images.gith
+00002af0: 7562 7573 6572 636f 6e74 656e 742e 636f  ubusercontent.co
+00002b00: 6d2f 3738 3338 3734 312f 3233 3530 3831  m/7838741/235081
+00002b10: 3936 392d 3332 3864 3761 3233 2d32 3663  969-328d7a23-26c
+00002b20: 392d 3437 3939 2d61 3234 362d 3863 3335  9-4799-a246-8c35
+00002b30: 6664 3761 6338 3865 2e70 6e67 290a 0a23  fd7ac88e.png)..#
+00002b40: 2320 4578 616d 706c 6573 0a0a 466f 7220  # Examples..For 
+00002b50: 6164 6469 7469 6f6e 616c 2065 7861 6d70  additional examp
+00002b60: 6c65 7320 6f66 2068 6f77 2074 6f20 7573  les of how to us
+00002b70: 6520 7468 6520 7061 636b 6167 6520 616e  e the package an
+00002b80: 6420 6d6f 6475 6c65 2c20 696e 636c 7564  d module, includ
+00002b90: 696e 6720 686f 7720 746f 2075 7365 206f  ing how to use o
+00002ba0: 7574 2d6f 662d 6261 6720 7072 6564 6963  ut-of-bag predic
+00002bb0: 7469 6f6e 7320 7261 7468 6572 2074 6861  tions rather tha
+00002bc0: 6e20 6861 7669 6e67 2074 6f20 7265 6c79  n having to rely
+00002bd0: 206f 6e20 6469 7669 6469 6e67 2074 6865   on dividing the
+00002be0: 2074 7261 696e 696e 6720 7365 7420 696e   training set in
+00002bf0: 746f 2061 2070 726f 7065 7220 7472 6169  to a proper trai
+00002c00: 6e69 6e67 2061 6e64 2063 616c 6962 7261  ning and calibra
+00002c10: 7469 6f6e 2073 6574 2c20 7365 6520 5b74  tion set, see [t
+00002c20: 6865 2064 6f63 756d 656e 7461 7469 6f6e  he documentation
+00002c30: 5d28 6874 7470 733a 2f2f 6372 6570 6573  ](https://crepes
+00002c40: 2e72 6561 6474 6865 646f 6373 2e69 6f2f  .readthedocs.io/
+00002c50: 656e 2f6c 6174 6573 742f 292c 205b 7468  en/latest/), [th
+00002c60: 6973 204a 7570 7974 6572 206e 6f74 6562  is Jupyter noteb
+00002c70: 6f6f 6b20 7573 696e 6720 5772 6170 5d28  ook using Wrap](
+00002c80: 6874 7470 733a 2f2f 6769 7468 7562 2e63  https://github.c
+00002c90: 6f6d 2f68 656e 7269 6b62 6f73 7472 6f6d  om/henrikbostrom
+00002ca0: 2f63 7265 7065 732f 626c 6f62 2f6d 6169  /crepes/blob/mai
+00002cb0: 6e2f 646f 6373 2f63 7265 7065 735f 6e62  n/docs/crepes_nb
+00002cc0: 5f77 7261 702e 6970 796e 6229 2c20 616e  _wrap.ipynb), an
+00002cd0: 6420 5b74 6869 7320 4a75 7079 7465 7220  d [this Jupyter 
+00002ce0: 6e6f 7465 626f 6f6b 2075 7369 6e67 2043  notebook using C
+00002cf0: 6f6e 666f 726d 616c 5265 6772 6573 736f  onformalRegresso
+00002d00: 7220 616e 6420 436f 6e66 6f72 6d61 6c50  r and ConformalP
+00002d10: 7265 6469 6374 6976 6553 7973 7465 6d5d  redictiveSystem]
+00002d20: 2868 7474 7073 3a2f 2f67 6974 6875 622e  (https://github.
+00002d30: 636f 6d2f 6865 6e72 696b 626f 7374 726f  com/henrikbostro
+00002d40: 6d2f 6372 6570 6573 2f62 6c6f 622f 6d61  m/crepes/blob/ma
+00002d50: 696e 2f64 6f63 732f 6372 6570 6573 5f6e  in/docs/crepes_n
+00002d60: 622e 6970 796e 6229 2e0a 0a23 2320 4369  b.ipynb)...## Ci
+00002d70: 7469 6e67 2063 7265 7065 730a 0a49 6620  ting crepes..If 
+00002d80: 796f 7520 7573 6520 6063 7265 7065 7360  you use `crepes`
+00002d90: 2066 6f72 2061 2073 6369 656e 7469 6669   for a scientifi
+00002da0: 6320 7075 626c 6963 6174 696f 6e2c 2079  c publication, y
+00002db0: 6f75 206d 6179 2063 6974 6520 7468 6520  ou may cite the 
+00002dc0: 666f 6c6c 6f77 696e 6720 7061 7065 723a  following paper:
+00002dd0: 0a0a 426f 7374 72c3 b66d 2c20 482e 2c20  ..Bostr..m, H., 
+00002de0: 3230 3232 2e20 6372 6570 6573 3a20 6120  2022. crepes: a 
+00002df0: 5079 7468 6f6e 2050 6163 6b61 6765 2066  Python Package f
+00002e00: 6f72 2047 656e 6572 6174 696e 6720 436f  or Generating Co
+00002e10: 6e66 6f72 6d61 6c20 5265 6772 6573 736f  nformal Regresso
+00002e20: 7273 2061 6e64 2050 7265 6469 6374 6976  rs and Predictiv
+00002e30: 6520 5379 7374 656d 732e 2049 6e20 436f  e Systems. In Co
+00002e40: 6e66 6f72 6d61 6c20 616e 6420 5072 6f62  nformal and Prob
+00002e50: 6162 696c 6973 7469 6320 5072 6564 6963  abilistic Predic
+00002e60: 7469 6f6e 2061 6e64 2041 7070 6c69 6361  tion and Applica
+00002e70: 7469 6f6e 732e 2050 4d4c 522c 2031 3739  tions. PMLR, 179
+00002e80: 2e20 5b4c 696e 6b5d 2868 7474 7073 3a2f  . [Link](https:/
+00002e90: 2f63 6f70 612d 636f 6e66 6572 656e 6365  /copa-conference
+00002ea0: 2e63 6f6d 2f70 6170 6572 732f 434f 5041  .com/papers/COPA
+00002eb0: 3230 3232 5f70 6170 6572 5f31 312e 7064  2022_paper_11.pd
+00002ec0: 6629 0a0a 4269 6274 6578 2065 6e74 7279  f)..Bibtex entry
+00002ed0: 3a0a 0a60 6060 6269 6274 6578 0a40 496e  :..```bibtex.@In
+00002ee0: 5072 6f63 6565 6469 6e67 737b 6372 6570  Proceedings{crep
+00002ef0: 6573 2c0a 2020 7469 746c 6520 3d20 0920  es,.  title = . 
+00002f00: 7b63 7265 7065 733a 2061 2050 7974 686f  {crepes: a Pytho
+00002f10: 6e20 5061 636b 6167 6520 666f 7220 4765  n Package for Ge
+00002f20: 6e65 7261 7469 6e67 2043 6f6e 666f 726d  nerating Conform
+00002f30: 616c 2052 6567 7265 7373 6f72 7320 616e  al Regressors an
+00002f40: 6420 5072 6564 6963 7469 7665 2053 7973  d Predictive Sys
+00002f50: 7465 6d73 7d2c 0a20 2061 7574 686f 7220  tems},.  author 
+00002f60: 3d20 2020 2020 2020 7b42 6f73 7472 5c22  =       {Bostr\"
+00002f70: 6f6d 2c20 4865 6e72 696b 7d2c 0a20 2062  om, Henrik},.  b
+00002f80: 6f6f 6b74 6974 6c65 203d 2009 207b 5072  ooktitle = . {Pr
+00002f90: 6f63 6565 6469 6e67 7320 6f66 2074 6865  oceedings of the
+00002fa0: 2045 6c65 7665 6e74 6820 5379 6d70 6f73   Eleventh Sympos
+00002fb0: 6975 6d20 6f6e 2043 6f6e 666f 726d 616c  ium on Conformal
+00002fc0: 2061 6e64 2050 726f 6261 6269 6c69 7374   and Probabilist
+00002fd0: 6963 2050 7265 6469 6374 696f 6e20 616e  ic Prediction an
+00002fe0: 6420 4170 706c 6963 6174 696f 6e73 7d2c  d Applications},
+00002ff0: 0a20 2079 6561 7220 3d20 0920 7b32 3032  .  year = . {202
+00003000: 327d 2c0a 2020 6564 6974 6f72 203d 2009  2},.  editor = .
+00003010: 207b 4a6f 6861 6e73 736f 6e2c 2055 6c66   {Johansson, Ulf
+00003020: 2061 6e64 2042 6f73 7472 c3b6 6d2c 2048   and Bostr..m, H
+00003030: 656e 7269 6b20 616e 6420 416e 204e 6775  enrik and An Ngu
+00003040: 7965 6e2c 204b 6875 6f6e 6720 616e 6420  yen, Khuong and 
+00003050: 4c75 6f2c 205a 6869 7975 616e 2061 6e64  Luo, Zhiyuan and
+00003060: 2043 6172 6c73 736f 6e2c 204c 6172 737d   Carlsson, Lars}
+00003070: 2c0a 2020 766f 6c75 6d65 203d 2009 207b  ,.  volume = . {
+00003080: 3137 397d 2c0a 2020 7365 7269 6573 203d  179},.  series =
+00003090: 2009 207b 5072 6f63 6565 6469 6e67 7320   . {Proceedings 
+000030a0: 6f66 204d 6163 6869 6e65 204c 6561 726e  of Machine Learn
+000030b0: 696e 6720 5265 7365 6172 6368 7d2c 0a20  ing Research},. 
+000030c0: 2070 7562 6c69 7368 6572 203d 2020 2020   publisher =    
+000030d0: 7b50 4d4c 527d 0a7d 0a60 6060 0a0a 2323  {PMLR}.}.```..##
+000030e0: 2052 6566 6572 656e 6365 730a 0a3c 6120   References..<a 
+000030f0: 6964 3d22 3122 3e5b 315d 3c2f 613e 2056  id="1">[1]</a> V
+00003100: 6f76 6b2c 2056 2e2c 2047 616d 6d65 726d  ovk, V., Gammerm
+00003110: 616e 2c20 412e 2061 6e64 2053 6861 6665  an, A. and Shafe
+00003120: 722c 2047 2e2c 2032 3030 352e 2041 6c67  r, G., 2005. Alg
+00003130: 6f72 6974 686d 6963 206c 6561 726e 696e  orithmic learnin
+00003140: 6720 696e 2061 2072 616e 646f 6d20 776f  g in a random wo
+00003150: 726c 642e 2053 7072 696e 6765 7220 5b4c  rld. Springer [L
+00003160: 696e 6b5d 2868 7474 7073 3a2f 2f6c 696e  ink](https://lin
+00003170: 6b2e 7370 7269 6e67 6572 2e63 6f6d 2f62  k.springer.com/b
+00003180: 6f6f 6b2f 3130 2e31 3030 372f 6231 3036  ook/10.1007/b106
+00003190: 3731 3529 0a0a 3c61 2069 643d 2232 223e  715)..<a id="2">
+000031a0: 5b32 5d3c 2f61 3e20 5061 7061 646f 706f  [2]</a> Papadopo
+000031b0: 756c 6f73 2c20 482e 2c20 5072 6f65 6472  ulos, H., Proedr
+000031c0: 6f75 2c20 4b2e 2c20 566f 766b 2c20 562e  ou, K., Vovk, V.
+000031d0: 2061 6e64 2047 616d 6d65 726d 616e 2c20   and Gammerman, 
+000031e0: 412e 2c20 3230 3032 2e20 496e 6475 6374  A., 2002. Induct
+000031f0: 6976 6520 636f 6e66 6964 656e 6365 206d  ive confidence m
+00003200: 6163 6869 6e65 7320 666f 7220 7265 6772  achines for regr
+00003210: 6573 7369 6f6e 2e20 4575 726f 7065 616e  ession. European
+00003220: 2043 6f6e 6665 7265 6e63 6520 6f6e 204d   Conference on M
+00003230: 6163 6869 6e65 204c 6561 726e 696e 672c  achine Learning,
+00003240: 2070 702e 2033 3435 2d33 3536 2e20 5b4c   pp. 345-356. [L
+00003250: 696e 6b5d 2868 7474 7073 3a2f 2f6c 696e  ink](https://lin
+00003260: 6b2e 7370 7269 6e67 6572 2e63 6f6d 2f63  k.springer.com/c
+00003270: 6861 7074 6572 2f31 302e 3130 3037 2f33  hapter/10.1007/3
+00003280: 2d35 3430 2d33 3637 3535 2d31 5f32 3929  -540-36755-1_29)
+00003290: 0a0a 3c61 2069 643d 2233 223e 5b33 5d3c  ..<a id="3">[3]<
+000032a0: 2f61 3e20 4a6f 6861 6e73 736f 6e2c 2055  /a> Johansson, U
+000032b0: 2e2c 2042 6f73 7472 c3b6 6d2c 2048 2e2c  ., Bostr..m, H.,
+000032c0: 204c c3b6 6673 7472 c3b6 6d2c 2054 2e20   L..fstr..m, T. 
+000032d0: 616e 6420 4c69 6e75 7373 6f6e 2c20 482e  and Linusson, H.
+000032e0: 2c20 3230 3134 2e20 5265 6772 6573 7369  , 2014. Regressi
+000032f0: 6f6e 2063 6f6e 666f 726d 616c 2070 7265  on conformal pre
+00003300: 6469 6374 696f 6e20 7769 7468 2072 616e  diction with ran
+00003310: 646f 6d20 666f 7265 7374 732e 204d 6163  dom forests. Mac
+00003320: 6869 6e65 206c 6561 726e 696e 672c 2039  hine learning, 9
+00003330: 3728 312d 3229 2c20 7070 2e20 3135 352d  7(1-2), pp. 155-
+00003340: 3137 362e 205b 4c69 6e6b 5d28 6874 7470  176. [Link](http
+00003350: 733a 2f2f 6c69 6e6b 2e73 7072 696e 6765  s://link.springe
+00003360: 722e 636f 6d2f 6172 7469 636c 652f 3130  r.com/article/10
+00003370: 2e31 3030 372f 7331 3039 3934 2d30 3134  .1007/s10994-014
+00003380: 2d35 3435 332d 3029 0a0a 3c61 2069 643d  -5453-0)..<a id=
+00003390: 2234 223e 5b34 5d3c 2f61 3e20 426f 7374  "4">[4]</a> Bost
+000033a0: 72c3 b66d 2c20 482e 2c20 4c69 6e75 7373  r..m, H., Linuss
+000033b0: 6f6e 2c20 482e 2c20 4cc3 b666 7374 72c3  on, H., L..fstr.
+000033c0: b66d 2c20 542e 2061 6e64 204a 6f68 616e  .m, T. and Johan
+000033d0: 7373 6f6e 2c20 552e 2c20 3230 3137 2e20  sson, U., 2017. 
+000033e0: 4163 6365 6c65 7261 7469 6e67 2064 6966  Accelerating dif
+000033f0: 6669 6375 6c74 7920 6573 7469 6d61 7469  ficulty estimati
+00003400: 6f6e 2066 6f72 2063 6f6e 666f 726d 616c  on for conformal
+00003410: 2072 6567 7265 7373 696f 6e20 666f 7265   regression fore
+00003420: 7374 732e 2041 6e6e 616c 7320 6f66 204d  sts. Annals of M
+00003430: 6174 6865 6d61 7469 6373 2061 6e64 2041  athematics and A
+00003440: 7274 6966 6963 6961 6c20 496e 7465 6c6c  rtificial Intell
+00003450: 6967 656e 6365 2c20 3831 2831 2d32 292c  igence, 81(1-2),
+00003460: 2070 702e 3132 352d 3134 342e 205b 4c69   pp.125-144. [Li
+00003470: 6e6b 5d28 6874 7470 733a 2f2f 6c69 6e6b  nk](https://link
+00003480: 2e73 7072 696e 6765 722e 636f 6d2f 6172  .springer.com/ar
+00003490: 7469 636c 652f 3130 2e31 3030 372f 7331  ticle/10.1007/s1
+000034a0: 3034 3732 2d30 3137 2d39 3533 392d 3929  0472-017-9539-9)
+000034b0: 0a0a 3c61 2069 643d 2235 223e 5b35 5d3c  ..<a id="5">[5]<
+000034c0: 2f61 3e20 426f 7374 72c3 b66d 2c20 482e  /a> Bostr..m, H.
+000034d0: 2061 6e64 204a 6f68 616e 7373 6f6e 2c20   and Johansson, 
+000034e0: 552e 2c20 3230 3230 2e20 4d6f 6e64 7269  U., 2020. Mondri
+000034f0: 616e 2063 6f6e 666f 726d 616c 2072 6567  an conformal reg
+00003500: 7265 7373 6f72 732e 2049 6e20 436f 6e66  ressors. In Conf
+00003510: 6f72 6d61 6c20 616e 6420 5072 6f62 6162  ormal and Probab
+00003520: 696c 6973 7469 6320 5072 6564 6963 7469  ilistic Predicti
+00003530: 6f6e 2061 6e64 2041 7070 6c69 6361 7469  on and Applicati
+00003540: 6f6e 732e 2050 4d4c 522c 2031 3238 2c20  ons. PMLR, 128, 
+00003550: 7070 2e20 3131 342d 3133 332e 205b 4c69  pp. 114-133. [Li
+00003560: 6e6b 5d28 6874 7470 733a 2f2f 7072 6f63  nk](https://proc
+00003570: 6565 6469 6e67 732e 6d6c 722e 7072 6573  eedings.mlr.pres
+00003580: 732f 7631 3238 2f62 6f73 7472 6f6d 3230  s/v128/bostrom20
+00003590: 612e 6874 6d6c 290a 0a3c 6120 6964 3d22  a.html)..<a id="
+000035a0: 3622 3e5b 365d 3c2f 613e 2056 6f76 6b2c  6">[6]</a> Vovk,
+000035b0: 2056 2e2c 2050 6574 656a 2c20 492e 2c20   V., Petej, I., 
+000035c0: 4e6f 7572 6574 6469 6e6f 762c 2049 2e2c  Nouretdinov, I.,
+000035d0: 204d 616e 6f6b 6869 6e2c 2056 2e20 616e   Manokhin, V. an
+000035e0: 6420 4761 6d6d 6572 6d61 6e2c 2041 2e2c  d Gammerman, A.,
+000035f0: 2032 3032 302e 2043 6f6d 7075 7461 7469   2020. Computati
+00003600: 6f6e 616c 6c79 2065 6666 6963 6965 6e74  onally efficient
+00003610: 2076 6572 7369 6f6e 7320 6f66 2063 6f6e   versions of con
+00003620: 666f 726d 616c 2070 7265 6469 6374 6976  formal predictiv
+00003630: 6520 6469 7374 7269 6275 7469 6f6e 732e  e distributions.
+00003640: 204e 6575 726f 636f 6d70 7574 696e 672c   Neurocomputing,
+00003650: 2033 3937 2c20 7070 2e32 3932 2d33 3038   397, pp.292-308
+00003660: 2e20 5b4c 696e 6b5d 2868 7474 7073 3a2f  . [Link](https:/
+00003670: 2f77 7777 2e61 6d69 6e65 722e 6f72 672f  /www.aminer.org/
+00003680: 7075 622f 3565 3039 6161 6339 6466 3161  pub/5e09aac9df1a
+00003690: 3963 3063 3431 3663 3962 3730 2f63 6f6d  9c0c416c9b70/com
+000036a0: 7075 7461 7469 6f6e 616c 6c79 2d65 6666  putationally-eff
+000036b0: 6963 6965 6e74 2d76 6572 7369 6f6e 732d  icient-versions-
+000036c0: 6f66 2d63 6f6e 666f 726d 616c 2d70 7265  of-conformal-pre
+000036d0: 6469 6374 6976 652d 6469 7374 7269 6275  dictive-distribu
+000036e0: 7469 6f6e 7329 0a0a 3c61 2069 643d 2237  tions)..<a id="7
+000036f0: 223e 5b37 5d3c 2f61 3e20 426f 7374 72c3  ">[7]</a> Bostr.
+00003700: b66d 2c20 482e 2c20 4a6f 6861 6e73 736f  .m, H., Johansso
+00003710: 6e2c 2055 2e20 616e 6420 4cc3 b666 7374  n, U. and L..fst
+00003720: 72c3 b66d 2c20 542e 2c20 3230 3231 2e20  r..m, T., 2021. 
+00003730: 4d6f 6e64 7269 616e 2063 6f6e 666f 726d  Mondrian conform
+00003740: 616c 2070 7265 6469 6374 6976 6520 6469  al predictive di
+00003750: 7374 7269 6275 7469 6f6e 732e 2049 6e20  stributions. In 
+00003760: 436f 6e66 6f72 6d61 6c20 616e 6420 5072  Conformal and Pr
+00003770: 6f62 6162 696c 6973 7469 6320 5072 6564  obabilistic Pred
+00003780: 6963 7469 6f6e 2061 6e64 2041 7070 6c69  iction and Appli
+00003790: 6361 7469 6f6e 732e 2050 4d4c 522c 2031  cations. PMLR, 1
+000037a0: 3532 2c20 7070 2e20 3234 2d33 382e 205b  52, pp. 24-38. [
+000037b0: 4c69 6e6b 5d28 6874 7470 733a 2f2f 7072  Link](https://pr
+000037c0: 6f63 6565 6469 6e67 732e 6d6c 722e 7072  oceedings.mlr.pr
+000037d0: 6573 732f 7631 3532 2f62 6f73 7472 6f6d  ess/v152/bostrom
+000037e0: 3231 612e 6874 6d6c 290a 0a3c 6120 6964  21a.html)..<a id
+000037f0: 3d22 3822 3e5b 385d 3c2f 613e 2056 6f76  ="8">[8]</a> Vov
+00003800: 6b2c 2056 2e2c 2032 3032 322e 2055 6e69  k, V., 2022. Uni
+00003810: 7665 7273 616c 2070 7265 6469 6374 6976  versal predictiv
+00003820: 6520 7379 7374 656d 732e 2050 6174 7465  e systems. Patte
+00003830: 726e 2052 6563 6f67 6e69 7469 6f6e 2e20  rn Recognition. 
+00003840: 3132 363a 2070 702e 2031 3038 3533 3620  126: pp. 108536 
+00003850: 5b4c 696e 6b5d 2868 7474 7073 3a2f 2f64  [Link](https://d
+00003860: 6c2e 6163 6d2e 6f72 672f 646f 692f 6162  l.acm.org/doi/ab
+00003870: 732f 3130 2e31 3031 362f 6a2e 7061 7463  s/10.1016/j.patc
+00003880: 6f67 2e32 3032 322e 3130 3835 3336 290a  og.2022.108536).
+00003890: 0a0a 2d20 2d20 2d0a 0a41 7574 686f 723a  ..- - -..Author:
+000038a0: 2048 656e 7269 6b20 426f 7374 72c3 b66d   Henrik Bostr..m
+000038b0: 2028 626f 7374 726f 6d68 406b 7468 2e73   (bostromh@kth.s
+000038c0: 6529 0a43 6f70 7972 6967 6874 2032 3032  e).Copyright 202
+000038d0: 3320 4865 6e72 696b 2042 6f73 7472 c3b6  3 Henrik Bostr..
+000038e0: 6d0a 4c69 6365 6e73 653a 2042 5344 2033  m.License: BSD 3
+000038f0: 2063 6c61 7573 650a                       clause.
```

### Comparing `crepes-0.3.0/setup.py` & `crepes-0.4.0/setup.py`

 * *Files 14% similar despite different names*

```diff
@@ -1,15 +1,15 @@
 import setuptools
 
 with open("README.md", "r", encoding="utf-8") as fh:
     long_description = fh.read()
 
 setuptools.setup(
     name="crepes",
-    version="0.3.0",
+    version="0.4.0",
     author="Henrik BostrÃ¶m",
     author_email="bostromh@kth.se",
     description="Conformal regressors and predictive systems (crepes)",
     long_description=long_description,
     long_description_content_type="text/markdown",
     url="https://github.com/henrikbostrom/crepes",
     project_urls={
```

### Comparing `crepes-0.3.0/src/crepes/fillings.py` & `crepes-0.4.0/src/crepes/extras.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,8 @@
-"""Conformal regressors and predictive systems (crepes) fillings
+"""Conformal regressors and predictive systems (crepes) extras
 
 Helper class and functions to generate difficulty estimates, with and
 without out-of-bag predictions, and Mondrian categories (bins) for
 conformal regressors and conformal predictive systems.
 
 Author: Henrik BostrÃ¶m (bostromh@kth.se)
 
@@ -49,17 +49,17 @@
         """
         Fit difficulty estimator.
 
         Parameters
         ----------
         X : array-like of shape (n_samples, n_features), default=None
            set of objects
-        y : array-like of shape (n_values,), default=None
+        y : array-like of shape (n_samples,), default=None
             target values
-        residuals : array-like of shape (n_values,), default=None
+        residuals : array-like of shape (n_samples,), default=None
             true target values - predicted values
         learner : an object with attribute ``learner.estimators_``, default=None
            an ensemble model where each model m in ``learner.estimators_`` has a
            method ``m.predict``
         k: int, default=25
            number of neighbors (used only if learner=None)
         scaler : bool, default=True
@@ -129,23 +129,23 @@
         be employed for the latter, objects have to be included:
 
         .. code-block:: python
 
            de_var = DifficultyEstimator() 
            de_var.fit(X_proper_train, learner=learner_prop, scaler=True)
 
-        The ``DifficultyEstimator`` can also support the construction of conformal
+        The :class:`.DifficultyEstimator` can also support the construction of conformal
         regressors and predictive systems that employ out-of-bag calibration. 
         For the k-nearest neighbor approaches, the difficulty of each object 
         in the provided training set will be computed using a leave-one-out 
         procedure, while for the variance-based approach the out-of-bag predictions 
         will be employed. This is enabled by setting ``oob=True`` when calling the 
-        ``fit`` method, which also requires the (full) training set (``X_train``),
-        and for the variance-based approach a corresponding trained model 
-        (``learner_full``) to be provided: 
+        :meth:`.fit` method, which also requires the (full) 
+        training set (``X_train``), and for the variance-based approach a corresponding 
+        trained model (``learner_full``) to be provided: 
 
         .. code-block:: python
 
            de_var_oob = DifficultyEstimator() 
            de_var_oob.fit(X_train, learner=learner_full, scaler=True, oob=True)
 
         A small value (beta) is added to the difficulty estimates. The default 
@@ -264,26 +264,25 @@
         Returns
         -------
         sigmas : array-like of shape (n_samples,)
             difficulty estimates 
 
         Examples
         --------
-        Assuming ``de`` to be a fitted ``DifficultyEstimator``, i.e., for which
-        the ``fit`` method has earlier been successfully called, then difficulty
-        estimates for a set of objects ``X`` is obtained by:
+        Assuming ``de`` to be a fitted :class:`.DifficultyEstimator`, i.e., for
+        which :meth:`.fit` has earlier been called, difficulty estimates for a
+        set of objects ``X`` is obtained by:
 
         .. code-block:: python
         
            difficulty_estimates = de.apply(X)
 
-        If ``de_oob`` is a ``DifficultyEstimator`` that has been fitted with
-        the option ``oob=True`` and a training set, then a call to the ``apply`` 
-        method without any objects will return the estimates for the training 
-        set:
+        If ``de_oob`` is a :class:`.DifficultyEstimator` that has been fitted with
+        the option ``oob=True`` and a training set, then a call to :meth:`.apply` 
+        without any objects will return the estimates for the training set:
 
         .. code-block:: python
         
            oob_difficulty_estimates = de.apply()
 
         For a difficulty estimator employing any of the k-nearest neighbor 
         approaches, the above will return an estimate for the difficulty 
@@ -384,15 +383,15 @@
        bins, bin_thresholds = binning(values=sigmas, bins=20)
 
     The above will result in that ``bins`` is assigned a vector
     of the same length as ``sigmas`` with label names (integers
     from 0 to 19), while ``bin_thresholds`` define the boundaries
     for the bins. The latter can be used to assign bin labels
     to another vector, e.g., ``sigmas_test``, by providing the thresholds 
-    as input to ``binning``:
+    as input to :meth:`binning`:
 
     .. code-block:: python
         
        test_bins  = binning(values=sigmas_test, bins=bin_thresholds)
 
     Here the output is just a vector ``test_bins`` with label names
     of the same length as ``sigmas_test``.
```

### Comparing `crepes-0.3.0/src/crepes.egg-info/PKG-INFO` & `crepes-0.4.0/src/crepes.egg-info/PKG-INFO`

 * *Files 10% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 00000000: 4d65 7461 6461 7461 2d56 6572 7369 6f6e  Metadata-Version
 00000010: 3a20 322e 310a 4e61 6d65 3a20 6372 6570  : 2.1.Name: crep
-00000020: 6573 0a56 6572 7369 6f6e 3a20 302e 332e  es.Version: 0.3.
+00000020: 6573 0a56 6572 7369 6f6e 3a20 302e 342e  es.Version: 0.4.
 00000030: 300a 5375 6d6d 6172 793a 2043 6f6e 666f  0.Summary: Confo
 00000040: 726d 616c 2072 6567 7265 7373 6f72 7320  rmal regressors 
 00000050: 616e 6420 7072 6564 6963 7469 7665 2073  and predictive s
 00000060: 7973 7465 6d73 2028 6372 6570 6573 290a  ystems (crepes).
 00000070: 486f 6d65 2d70 6167 653a 2068 7474 7073  Home-page: https
 00000080: 3a2f 2f67 6974 6875 622e 636f 6d2f 6865  ://github.com/he
 00000090: 6e72 696b 626f 7374 726f 6d2f 6372 6570  nrikbostrom/crep
@@ -26,940 +26,920 @@
 00000190: 3a20 4f70 6572 6174 696e 6720 5379 7374  : Operating Syst
 000001a0: 656d 203a 3a20 4f53 2049 6e64 6570 656e  em :: OS Indepen
 000001b0: 6465 6e74 0a52 6571 7569 7265 732d 5079  dent.Requires-Py
 000001c0: 7468 6f6e 3a20 3e3d 332e 380a 4465 7363  thon: >=3.8.Desc
 000001d0: 7269 7074 696f 6e2d 436f 6e74 656e 742d  ription-Content-
 000001e0: 5479 7065 3a20 7465 7874 2f6d 6172 6b64  Type: text/markd
 000001f0: 6f77 6e0a 4c69 6365 6e73 652d 4669 6c65  own.License-File
-00000200: 3a20 4c49 4345 4e53 450a 0a23 2060 6372  : LICENSE..# `cr
-00000210: 6570 6573 600a 0a60 6372 6570 6573 6020  epes`..`crepes` 
-00000220: 6973 2061 2050 7974 686f 6e20 7061 636b  is a Python pack
-00000230: 6167 6520 666f 7220 6765 6e65 7261 7469  age for generati
-00000240: 6e67 202a 636f 6e66 6f72 6d61 6c20 7265  ng *conformal re
-00000250: 6772 6573 736f 7273 2a2c 2077 6869 6368  gressors*, which
-00000260: 2074 7261 6e73 666f 726d 2070 6f69 6e74   transform point
-00000270: 2070 7265 6469 6374 696f 6e73 206f 6620   predictions of 
-00000280: 616e 7920 756e 6465 726c 7969 6e67 2072  any underlying r
-00000290: 6567 7265 7373 696f 6e20 6d6f 6465 6c20  egression model 
-000002a0: 696e 746f 2070 7265 6469 6374 696f 6e20  into prediction 
-000002b0: 696e 7465 7276 616c 7320 666f 7220 7370  intervals for sp
-000002c0: 6563 6966 6965 6420 6c65 7665 6c73 206f  ecified levels o
-000002d0: 6620 636f 6e66 6964 656e 6365 2e20 5468  f confidence. Th
-000002e0: 6520 7061 636b 6167 6520 616c 736f 2069  e package also i
-000002f0: 6d70 6c65 6d65 6e74 7320 2a63 6f6e 666f  mplements *confo
-00000300: 726d 616c 2070 7265 6469 6374 6976 6520  rmal predictive 
-00000310: 7379 7374 656d 732a 2c20 7768 6963 6820  systems*, which 
-00000320: 7472 616e 7366 6f72 6d20 7468 6520 706f  transform the po
-00000330: 696e 7420 7072 6564 6963 7469 6f6e 7320  int predictions 
-00000340: 696e 746f 2063 756d 756c 6174 6976 6520  into cumulative 
-00000350: 6469 7374 7269 6275 7469 6f6e 2066 756e  distribution fun
-00000360: 6374 696f 6e73 2e0a 0a54 6865 2060 6372  ctions...The `cr
-00000370: 6570 6573 6020 7061 636b 6167 6520 696d  epes` package im
-00000380: 706c 656d 656e 7473 2073 7461 6e64 6172  plements standar
-00000390: 642c 206e 6f72 6d61 6c69 7a65 6420 616e  d, normalized an
-000003a0: 6420 4d6f 6e64 7269 616e 2063 6f6e 666f  d Mondrian confo
-000003b0: 726d 616c 2072 6567 7265 7373 6f72 7320  rmal regressors 
-000003c0: 616e 6420 7072 6564 6963 7469 7665 2073  and predictive s
-000003d0: 7973 7465 6d73 2e20 5768 696c 6520 7468  ystems. While th
-000003e0: 6520 7061 636b 6167 6520 616c 6c6f 7773  e package allows
-000003f0: 2079 6f75 2074 6f20 7573 6520 796f 7572   you to use your
-00000400: 206f 776e 2064 6966 6669 6375 6c74 7920   own difficulty 
-00000410: 6573 7469 6d61 7465 7320 616e 6420 4d6f  estimates and Mo
-00000420: 6e64 7269 616e 2063 6174 6567 6f72 6965  ndrian categorie
-00000430: 732c 2074 6865 7265 2069 7320 616c 736f  s, there is also
-00000440: 2061 2073 6570 6172 6174 6520 6d6f 6475   a separate modu
-00000450: 6c65 2c20 6361 6c6c 6564 2060 6372 6570  le, called `crep
-00000460: 6573 2e66 696c 6c69 6e67 7360 2c20 7768  es.fillings`, wh
-00000470: 6963 6820 7072 6f76 6964 6573 2073 6f6d  ich provides som
-00000480: 6520 7374 616e 6461 7264 206f 7074 696f  e standard optio
-00000490: 6e73 2066 6f72 2074 6865 7365 2e0a 0a23  ns for these...#
-000004a0: 2320 496e 7374 616c 6c61 7469 6f6e 0a0a  # Installation..
-000004b0: 4672 6f6d 205b 5079 5049 5d28 6874 7470  From [PyPI](http
-000004c0: 733a 2f2f 7079 7069 2e6f 7267 2f70 726f  s://pypi.org/pro
-000004d0: 6a65 6374 2f63 7265 7065 732f 290a 0a60  ject/crepes/)..`
-000004e0: 6060 6261 7368 0a70 6970 2069 6e73 7461  ``bash.pip insta
-000004f0: 6c6c 2063 7265 7065 730a 6060 600a 0a46  ll crepes.```..F
-00000500: 726f 6d20 5b63 6f6e 6461 2d66 6f72 6765  rom [conda-forge
-00000510: 5d28 6874 7470 733a 2f2f 616e 6163 6f6e  ](https://anacon
+00000200: 3a20 4c49 4345 4e53 450a 0a3c 7020 616c  : LICENSE..<p al
+00000210: 6967 6e3d 2263 656e 7465 7222 3e3c 6120  ign="center"><a 
+00000220: 6872 6566 3d22 6874 7470 733a 2f2f 6372  href="https://cr
+00000230: 6570 6573 2e72 6561 6474 6865 646f 6373  epes.readthedocs
+00000240: 2e69 6f22 3e3c 696d 6720 616c 743d 2263  .io"><img alt="c
+00000250: 7265 7065 7322 2073 7263 3d22 6874 7470  repes" src="http
+00000260: 733a 2f2f 6769 7468 7562 2d70 726f 6475  s://github-produ
+00000270: 6374 696f 6e2d 7573 6572 2d61 7373 6574  ction-user-asset
+00000280: 2d36 3231 3064 662e 7333 2e61 6d61 7a6f  -6210df.s3.amazo
+00000290: 6e61 7773 2e63 6f6d 2f37 3833 3837 3431  naws.com/7838741
+000002a0: 2f32 3337 3935 3037 3732 2d31 6434 3438  /237950772-1d448
+000002b0: 3762 312d 3766 3433 2d34 6365 302d 3964  7b1-7f43-4ce0-9d
+000002c0: 6230 2d30 3332 6261 6564 6462 6563 652e  b0-032baeddbece.
+000002d0: 706e 6722 3e3c 2f61 3e3c 2f70 3e0a 0a3c  png"></a></p>..<
+000002e0: 7020 616c 6967 6e3d 2263 656e 7465 7222  p align="center"
+000002f0: 3e0a 3c61 2068 7265 663d 2268 7474 7073  >.<a href="https
+00000300: 3a2f 2f70 7970 692e 6f72 672f 7072 6f6a  ://pypi.org/proj
+00000310: 6563 742f 6372 6570 6573 2f22 3e3c 696d  ect/crepes/"><im
+00000320: 6720 7372 633d 2268 7474 7073 3a2f 2f62  g src="https://b
+00000330: 6164 6765 2e66 7572 792e 696f 2f70 792f  adge.fury.io/py/
+00000340: 6372 6570 6573 2e73 7667 2220 616c 743d  crepes.svg" alt=
+00000350: 2250 7950 4920 7665 7273 696f 6e22 2068  "PyPI version" h
+00000360: 6569 6768 743d 3230 2061 6c69 676e 3d22  eight=20 align="
+00000370: 6365 6e74 6572 223e 3c2f 613e 0a3c 6120  center"></a>.<a 
+00000380: 6872 6566 3d22 6874 7470 733a 2f2f 616e  href="https://an
+00000390: 6163 6f6e 6461 2e6f 7267 2f63 6f6e 6461  aconda.org/conda
+000003a0: 2d66 6f72 6765 2f63 7265 7065 7322 3e3c  -forge/crepes"><
+000003b0: 696d 6720 7372 633d 2268 7474 7073 3a2f  img src="https:/
+000003c0: 2f61 6e61 636f 6e64 612e 6f72 672f 636f  /anaconda.org/co
+000003d0: 6e64 612d 666f 7267 652f 6372 6570 6573  nda-forge/crepes
+000003e0: 2f62 6164 6765 732f 7665 7273 696f 6e2e  /badges/version.
+000003f0: 7376 6722 2061 6c74 3d22 416e 6163 6f6e  svg" alt="Anacon
+00000400: 6461 2076 6572 7369 6f6e 2220 6865 6967  da version" heig
+00000410: 6874 3d32 3020 616c 6967 6e3d 2263 656e  ht=20 align="cen
+00000420: 7465 7222 3e3c 2f61 3e0a 3c61 2068 7265  ter"></a>.<a hre
+00000430: 663d 2268 7474 7073 3a2f 2f63 7265 7065  f="https://crepe
+00000440: 732e 7265 6164 7468 6564 6f63 732e 696f  s.readthedocs.io
+00000450: 2f65 6e2f 6c61 7465 7374 223e 3c69 6d67  /en/latest"><img
+00000460: 2073 7263 3d22 6874 7470 733a 2f2f 7265   src="https://re
+00000470: 6164 7468 6564 6f63 732e 6f72 672f 7072  adthedocs.org/pr
+00000480: 6f6a 6563 7473 2f63 7265 7065 732f 6261  ojects/crepes/ba
+00000490: 6467 652f 3f76 6572 7369 6f6e 3d6c 6174  dge/?version=lat
+000004a0: 6573 7422 2061 6c74 3d22 646f 6373 2073  est" alt="docs s
+000004b0: 7461 7475 7322 2068 6569 6768 743d 3230  tatus" height=20
+000004c0: 2061 6c69 676e 3d22 6365 6e74 6572 223e   align="center">
+000004d0: 3c2f 613e 200a 3c61 2068 7265 663d 2268  </a> .<a href="h
+000004e0: 7474 7073 3a2f 2f61 6e61 636f 6e64 612e  ttps://anaconda.
+000004f0: 6f72 672f 636f 6e64 612d 666f 7267 652f  org/conda-forge/
+00000500: 6372 6570 6573 223e 3c69 6d67 2073 7263  crepes"><img src
+00000510: 3d22 6874 7470 733a 2f2f 616e 6163 6f6e  ="https://anacon
 00000520: 6461 2e6f 7267 2f63 6f6e 6461 2d66 6f72  da.org/conda-for
-00000530: 6765 2f63 7265 7065 7329 0a0a 6060 6062  ge/crepes)..```b
-00000540: 6173 680a 636f 6e64 6120 696e 7374 616c  ash.conda instal
-00000550: 6c20 2d63 2063 6f6e 6461 2d66 6f72 6765  l -c conda-forge
-00000560: 2063 7265 7065 730a 6060 600a 0a23 2320   crepes.```..## 
-00000570: 446f 6375 6d65 6e74 6174 696f 6e0a 0a46  Documentation..F
-00000580: 6f72 2063 6f6d 706c 6574 6520 646f 6375  or complete docu
-00000590: 6d65 6e74 6174 696f 6e20 6f66 2074 6865  mentation of the
-000005a0: 2060 6372 6570 6573 6020 7061 636b 6167   `crepes` packag
-000005b0: 652c 2073 6565 205b 6865 7265 5d28 6874  e, see [here](ht
-000005c0: 7470 733a 2f2f 6372 6570 6573 2e72 6561  tps://crepes.rea
-000005d0: 6474 6865 646f 6373 2e69 6f2f 656e 2f6c  dthedocs.io/en/l
-000005e0: 6174 6573 742f 292e 0a0a 2323 2051 7569  atest/)...## Qui
-000005f0: 636b 7374 6172 740a 0a23 2323 2043 6f6e  ckstart..### Con
-00000600: 666f 726d 616c 2072 6567 7265 7373 6f72  formal regressor
-00000610: 730a 0a57 6520 6669 7273 7420 696d 706f  s..We first impo
-00000620: 7274 2074 6865 206d 6169 6e20 636c 6173  rt the main clas
-00000630: 7320 6672 6f6d 2060 6372 6570 6573 6020  s from `crepes` 
-00000640: 616e 6420 6120 6865 6c70 6572 2063 6c61  and a helper cla
-00000650: 7373 2061 6e64 2066 756e 6374 696f 6e20  ss and function 
-00000660: 6672 6f6d 2060 6372 6570 6573 2e66 696c  from `crepes.fil
-00000670: 6c69 6e67 7360 3a0a 0a60 6060 7079 7468  lings`:..```pyth
-00000680: 6f6e 0a66 726f 6d20 6372 6570 6573 2069  on.from crepes i
-00000690: 6d70 6f72 7420 436f 6e66 6f72 6d61 6c52  mport ConformalR
-000006a0: 6567 7265 7373 6f72 0a66 726f 6d20 6372  egressor.from cr
-000006b0: 6570 6573 2e66 696c 6c69 6e67 7320 696d  epes.fillings im
-000006c0: 706f 7274 2044 6966 6669 6375 6c74 7945  port DifficultyE
-000006d0: 7374 696d 6174 6f72 2c20 6269 6e6e 696e  stimator, binnin
-000006e0: 670a 6060 600a 0a57 6520 7769 6c6c 2069  g.```..We will i
-000006f0: 6c6c 7573 7472 6174 6520 7468 6520 6162  llustrate the ab
-00000700: 6f76 6520 7573 696e 6720 6120 6461 7461  ove using a data
-00000710: 7365 7420 6672 6f6d 205b 7777 772e 6f70  set from [www.op
-00000720: 656e 6d6c 2e6f 7267 5d28 6874 7470 733a  enml.org](https:
-00000730: 2f2f 7777 772e 6f70 656e 6d6c 2e6f 7267  //www.openml.org
-00000740: 2920 616e 6420 6120 6052 616e 646f 6d46  ) and a `RandomF
-00000750: 6f72 6573 7452 6567 7265 7373 6f72 6020  orestRegressor` 
-00000760: 6672 6f6d 205b 736b 6c65 6172 6e5d 2868  from [sklearn](h
-00000770: 7474 7073 3a2f 2f73 6369 6b69 742d 6c65  ttps://scikit-le
-00000780: 6172 6e2e 6f72 6729 3a0a 0a60 6060 7079  arn.org):..```py
-00000790: 7468 6f6e 0a66 726f 6d20 736b 6c65 6172  thon.from sklear
-000007a0: 6e2e 6461 7461 7365 7473 2069 6d70 6f72  n.datasets impor
-000007b0: 7420 6665 7463 685f 6f70 656e 6d6c 0a66  t fetch_openml.f
-000007c0: 726f 6d20 736b 6c65 6172 6e2e 6d6f 6465  rom sklearn.mode
-000007d0: 6c5f 7365 6c65 6374 696f 6e20 696d 706f  l_selection impo
-000007e0: 7274 2074 7261 696e 5f74 6573 745f 7370  rt train_test_sp
-000007f0: 6c69 740a 6672 6f6d 2073 6b6c 6561 726e  lit.from sklearn
-00000800: 2e65 6e73 656d 626c 6520 696d 706f 7274  .ensemble import
-00000810: 2052 616e 646f 6d46 6f72 6573 7452 6567   RandomForestReg
-00000820: 7265 7373 6f72 0a0a 6461 7461 7365 7420  ressor..dataset 
-00000830: 3d20 6665 7463 685f 6f70 656e 6d6c 286e  = fetch_openml(n
-00000840: 616d 653d 2268 6f75 7365 5f73 616c 6573  ame="house_sales
-00000850: 222c 2076 6572 7369 6f6e 3d33 290a 5820  ", version=3).X 
-00000860: 3d20 6461 7461 7365 742e 6461 7461 2e76  = dataset.data.v
-00000870: 616c 7565 732e 6173 7479 7065 2866 6c6f  alues.astype(flo
-00000880: 6174 290a 7920 3d20 6461 7461 7365 742e  at).y = dataset.
-00000890: 7461 7267 6574 2e76 616c 7565 732e 6173  target.values.as
-000008a0: 7479 7065 2866 6c6f 6174 290a 6060 600a  type(float).```.
-000008b0: 0a57 6520 6e6f 7720 6669 7273 7420 7370  .We now first sp
-000008c0: 6c69 7420 7468 6520 6461 7461 7365 7420  lit the dataset 
-000008d0: 696e 746f 2061 2074 7261 696e 696e 6720  into a training 
-000008e0: 616e 6420 6120 7465 7374 2073 6574 2c20  and a test set, 
-000008f0: 616e 6420 7468 656e 2066 7572 7468 6572  and then further
-00000900: 2073 706c 6974 2074 6865 2074 7261 696e   split the train
-00000910: 696e 6720 7365 7420 696e 746f 2061 2070  ing set into a p
-00000920: 726f 7065 7220 7472 6169 6e69 6e67 2073  roper training s
-00000930: 6574 2061 6e64 2061 2063 616c 6962 7261  et and a calibra
-00000940: 7469 6f6e 2073 6574 2e20 4669 6e61 6c6c  tion set. Finall
-00000950: 792c 2077 6520 6669 7420 6120 7261 6e64  y, we fit a rand
-00000960: 6f6d 2066 6f72 6573 7420 746f 2074 6865  om forest to the
-00000970: 2070 726f 7065 7220 7472 6169 6e69 6e67   proper training
-00000980: 2073 6574 2061 6e64 2061 7070 6c79 2069   set and apply i
-00000990: 7420 746f 206f 6274 6169 6e20 706f 696e  t to obtain poin
-000009a0: 7420 7072 6564 6963 7469 6f6e 7320 666f  t predictions fo
-000009b0: 7220 7468 6520 7465 7374 2073 6574 2028  r the test set (
-000009c0: 6e6f 7468 696e 6720 6e65 7720 6865 7265  nothing new here
-000009d0: 292e 0a0a 6060 6070 7974 686f 6e0a 585f  )...```python.X_
-000009e0: 7472 6169 6e2c 2058 5f74 6573 742c 2079  train, X_test, y
-000009f0: 5f74 7261 696e 2c20 795f 7465 7374 203d  _train, y_test =
-00000a00: 2074 7261 696e 5f74 6573 745f 7370 6c69   train_test_spli
-00000a10: 7428 582c 2079 2c20 7465 7374 5f73 697a  t(X, y, test_siz
-00000a20: 653d 302e 3529 0a58 5f70 726f 705f 7472  e=0.5).X_prop_tr
-00000a30: 6169 6e2c 2058 5f63 616c 2c20 795f 7072  ain, X_cal, y_pr
-00000a40: 6f70 5f74 7261 696e 2c20 795f 6361 6c20  op_train, y_cal 
-00000a50: 3d20 7472 6169 6e5f 7465 7374 5f73 706c  = train_test_spl
-00000a60: 6974 2858 5f74 7261 696e 2c20 795f 7472  it(X_train, y_tr
-00000a70: 6169 6e2c 0a20 2020 2020 2020 2020 2020  ain,.           
-00000a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000ab0: 2074 6573 745f 7369 7a65 3d30 2e32 3529   test_size=0.25)
-00000ac0: 0a0a 6c65 6172 6e65 7220 3d20 5261 6e64  ..learner = Rand
-00000ad0: 6f6d 466f 7265 7374 5265 6772 6573 736f  omForestRegresso
-00000ae0: 7228 2920 0a6c 6561 726e 6572 2e66 6974  r() .learner.fit
-00000af0: 2858 5f70 726f 705f 7472 6169 6e2c 2079  (X_prop_train, y
-00000b00: 5f70 726f 705f 7472 6169 6e29 0a79 5f68  _prop_train).y_h
-00000b10: 6174 5f74 6573 7420 3d20 6c65 6172 6e65  at_test = learne
-00000b20: 722e 7072 6564 6963 7428 585f 7465 7374  r.predict(X_test
-00000b30: 290a 6060 600a 0a4e 6f77 2c20 7765 2077  ).```..Now, we w
-00000b40: 696c 6c20 6d61 6b65 2075 7365 206f 6620  ill make use of 
-00000b50: 7468 6520 6361 6c69 6272 6174 696f 6e20  the calibration 
-00000b60: 7365 742e 2057 6520 6170 706c 7920 7468  set. We apply th
-00000b70: 6520 6d6f 6465 6c20 616c 736f 2074 6f20  e model also to 
-00000b80: 7468 6520 6361 6c69 6272 6174 696f 6e20  the calibration 
-00000b90: 6f62 6a65 6374 7320 616e 6420 6361 6c63  objects and calc
-00000ba0: 756c 6174 6520 7468 6520 7265 7369 6475  ulate the residu
-00000bb0: 616c 732e 0a60 6060 7079 7468 6f6e 0a79  als..```python.y
-00000bc0: 5f68 6174 5f63 616c 203d 206c 6561 726e  _hat_cal = learn
-00000bd0: 6572 2e70 7265 6469 6374 2858 5f63 616c  er.predict(X_cal
-00000be0: 290a 7265 7369 6475 616c 735f 6361 6c20  ).residuals_cal 
-00000bf0: 3d20 795f 6361 6c20 2d20 795f 6861 745f  = y_cal - y_hat_
-00000c00: 6361 6c0a 6060 600a 0a54 6865 206c 6174  cal.```..The lat
-00000c10: 7465 7220 6973 206a 7573 7420 7768 6174  ter is just what
-00000c20: 2077 6520 6e65 6564 2074 6f20 6669 7420   we need to fit 
-00000c30: 6120 7374 616e 6461 7264 2063 6f6e 666f  a standard confo
-00000c40: 726d 616c 2072 6567 7265 7373 6f72 3a0a  rmal regressor:.
-00000c50: 6060 6070 7974 686f 6e0a 6372 5f73 7464  ```python.cr_std
-00000c60: 203d 2043 6f6e 666f 726d 616c 5265 6772   = ConformalRegr
-00000c70: 6573 736f 7228 290a 6372 5f73 7464 2e66  essor().cr_std.f
-00000c80: 6974 2872 6573 6964 7561 6c73 3d72 6573  it(residuals=res
-00000c90: 6964 7561 6c73 5f63 616c 290a 6060 600a  iduals_cal).```.
-00000ca0: 0a57 6520 6361 6e20 6e6f 7720 6170 706c  .We can now appl
-00000cb0: 7920 7468 6520 636f 6e66 6f72 6d61 6c20  y the conformal 
-00000cc0: 7265 6772 6573 736f 7220 746f 2067 6574  regressor to get
-00000cd0: 2070 7265 6469 6374 696f 6e20 696e 7465   prediction inte
-00000ce0: 7276 616c 7320 666f 7220 7468 6520 7465  rvals for the te
-00000cf0: 7374 206f 626a 6563 7473 2c20 7573 696e  st objects, usin
-00000d00: 6720 7468 6520 706f 696e 7420 7072 6564  g the point pred
-00000d10: 6963 7469 6f6e 7320 6173 2069 6e70 7574  ictions as input
-00000d20: 2c20 7768 6572 6520 7468 6520 7072 6f62  , where the prob
-00000d30: 6162 696c 6974 7920 6f66 206e 6f74 2069  ability of not i
-00000d40: 6e63 6c75 6469 6e67 2074 6865 2063 6f72  ncluding the cor
-00000d50: 7265 6374 2074 6172 6765 7420 696e 2061  rect target in a
-00000d60: 6e20 696e 7465 7276 616c 2069 7320 312d  n interval is 1-
-00000d70: 636f 6e66 6964 656e 6365 3a0a 6060 6070  confidence:.```p
-00000d80: 7974 686f 6e0a 7374 645f 696e 7465 7276  ython.std_interv
-00000d90: 616c 7320 3d20 6372 5f73 7464 2e70 7265  als = cr_std.pre
-00000da0: 6469 6374 2879 5f68 6174 3d79 5f68 6174  dict(y_hat=y_hat
-00000db0: 5f74 6573 742c 2063 6f6e 6669 6465 6e63  _test, confidenc
-00000dc0: 653d 302e 3939 290a 6060 600a 0a54 6865  e=0.99).```..The
-00000dd0: 206f 7574 7075 7420 6973 2061 205b 4e75   output is a [Nu
-00000de0: 6d50 795d 2868 7474 7073 3a2f 2f6e 756d  mPy](https://num
-00000df0: 7079 2e6f 7267 2920 6172 7261 792c 2073  py.org) array, s
-00000e00: 7065 6369 6679 696e 6720 7468 6520 6c6f  pecifying the lo
-00000e10: 7765 7220 616e 6420 7570 7065 7220 626f  wer and upper bo
-00000e20: 756e 6420 6f66 2065 6163 6820 696e 7465  und of each inte
-00000e30: 7276 616c 3a0a 0a60 6060 6e75 6d70 790a  rval:..```numpy.
-00000e40: 6172 7261 7928 5b5b 2d31 3731 3930 322e  array([[-171902.
-00000e50: 3220 2c20 2039 3533 3836 362e 3220 5d2c  2 ,  953866.2 ],
-00000e60: 0a20 2020 2020 2020 5b2d 3237 3638 3138  .       [-276818
-00000e70: 2e30 312c 2020 3834 3839 3530 2e33 395d  .01,  848950.39]
-00000e80: 2c0a 2020 2020 2020 205b 2020 3232 3637  ,.       [  2267
-00000e90: 392e 3337 2c20 3131 3438 3434 372e 3737  9.37, 1148447.77
-00000ea0: 5d2c 0a20 2020 2020 2020 2e2e 2e2c 0a20  ],.       ...,. 
-00000eb0: 2020 2020 2020 5b20 3234 3239 3534 2e30        [ 242954.0
-00000ec0: 322c 2031 3336 3837 3232 2e34 325d 2c0a  2, 1368722.42],.
-00000ed0: 2020 2020 2020 205b 2d33 3038 3039 332e         [-308093.
-00000ee0: 3733 2c20 2038 3137 3637 342e 3637 5d2c  73,  817674.67],
-00000ef0: 0a20 2020 2020 2020 5b2d 3232 3730 3537  .       [-227057
-00000f00: 2e34 202c 2020 3839 3837 3131 2e20 205d  .4 ,  898711.  ]
-00000f10: 5d29 0a60 6060 0a0a 5765 206d 6179 2072  ]).```..We may r
-00000f20: 6571 7565 7374 2074 6861 7420 7468 6520  equest that the 
-00000f30: 696e 7465 7276 616c 7320 6172 6520 6375  intervals are cu
-00000f40: 7420 746f 2065 7863 6c75 6465 2069 6d70  t to exclude imp
-00000f50: 6f73 7369 626c 6520 7661 6c75 6573 2c20  ossible values, 
-00000f60: 696e 2074 6869 7320 6361 7365 2062 656c  in this case bel
-00000f70: 6f77 2030 2c20 616e 6420 6966 2077 6520  ow 0, and if we 
-00000f80: 616c 736f 2072 656c 7920 6f6e 2074 6865  also rely on the
-00000f90: 2064 6566 6175 6c74 2063 6f6e 6669 6465   default confide
-00000fa0: 6e63 6520 6c65 7665 6c20 2830 2e39 3529  nce level (0.95)
-00000fb0: 2c20 7468 6520 6f75 7470 7574 2069 6e74  , the output int
-00000fc0: 6572 7661 6c73 2077 696c 6c20 6265 2061  ervals will be a
-00000fd0: 2062 6974 2074 6967 6874 6572 3a0a 0a60   bit tighter:..`
-00000fe0: 6060 7079 7468 6f6e 0a69 6e74 6572 7661  ``python.interva
-00000ff0: 6c73 5f73 7464 203d 2063 725f 7374 642e  ls_std = cr_std.
-00001000: 7072 6564 6963 7428 795f 6861 743d 795f  predict(y_hat=y_
-00001010: 6861 745f 7465 7374 2c20 795f 6d69 6e3d  hat_test, y_min=
-00001020: 3029 0a60 6060 0a0a 6060 606e 756d 7079  0).```..```numpy
-00001030: 0a61 7272 6179 285b 5b20 3135 3232 3538  .array([[ 152258
-00001040: 2e35 352c 2020 3632 3937 3035 2e34 355d  .55,  629705.45]
-00001050: 2c0a 2020 2020 2020 205b 2020 3437 3334  ,.       [  4734
-00001060: 322e 3734 2c20 2035 3234 3738 392e 3634  2.74,  524789.64
-00001070: 5d2c 0a20 2020 2020 2020 5b20 3334 3638  ],.       [ 3468
-00001080: 3430 2e31 322c 2020 3832 3432 3837 2e30  40.12,  824287.0
-00001090: 325d 2c0a 2020 2020 2020 202e 2e2e 2c0a  2],.       ...,.
-000010a0: 2020 2020 2020 205b 2035 3637 3131 342e         [ 567114.
-000010b0: 3737 2c20 3130 3434 3536 312e 3637 5d2c  77, 1044561.67],
-000010c0: 0a20 2020 2020 2020 5b20 2031 3630 3637  .       [  16067
-000010d0: 2e30 322c 2020 3439 3335 3133 2e39 325d  .02,  493513.92]
-000010e0: 2c0a 2020 2020 2020 205b 2020 3937 3130  ,.       [  9710
-000010f0: 332e 3335 2c20 2035 3734 3535 302e 3235  3.35,  574550.25
-00001100: 5d5d 290a 6060 600a 0a54 6865 2061 626f  ]]).```..The abo
-00001110: 7665 2069 6e74 6572 7661 6c73 2061 7265  ve intervals are
-00001120: 206e 6f74 206e 6f72 6d61 6c69 7a65 642c   not normalized,
-00001130: 2069 2e65 2e2c 2074 6865 7920 6172 6520   i.e., they are 
-00001140: 616c 6c20 6f66 2074 6865 2073 616d 6520  all of the same 
-00001150: 7369 7a65 2028 6174 206c 6561 7374 2062  size (at least b
-00001160: 6566 6f72 6520 7468 6579 2061 7265 2063  efore they are c
-00001170: 7574 292e 2057 6520 636f 756c 6420 6d61  ut). We could ma
-00001180: 6b65 2074 6865 2069 6e74 6572 7661 6c73  ke the intervals
-00001190: 206d 6f72 6520 696e 666f 726d 6174 6976   more informativ
-000011a0: 6520 7468 726f 7567 6820 6e6f 726d 616c  e through normal
-000011b0: 697a 6174 696f 6e20 7573 696e 6720 6469  ization using di
-000011c0: 6666 6963 756c 7479 2065 7374 696d 6174  fficulty estimat
-000011d0: 6573 3b20 6d6f 7265 2064 6966 6669 6375  es; more difficu
-000011e0: 6c74 2069 6e73 7461 6e63 6573 2077 696c  lt instances wil
-000011f0: 6c20 6265 2061 7373 6967 6e65 6420 7769  l be assigned wi
-00001200: 6465 7220 696e 7465 7276 616c 732e 0a0a  der intervals...
-00001210: 5765 2077 696c 6c20 7573 6520 6120 6044  We will use a `D
-00001220: 6966 6669 6375 6c74 7945 7374 696d 6174  ifficultyEstimat
-00001230: 6f72 6020 666f 7220 7468 6973 2070 7572  or` for this pur
-00001240: 706f 7365 2e20 4865 7265 2069 7420 6573  pose. Here it es
-00001250: 7469 6d61 7465 7320 7468 6520 6469 6666  timates the diff
-00001260: 6963 756c 7479 2062 7920 7468 6520 7374  iculty by the st
-00001270: 616e 6461 7264 2064 6576 6961 7469 6f6e  andard deviation
-00001280: 206f 6620 7468 6520 7461 7267 6574 206f   of the target o
-00001290: 6620 7468 6520 6b20 2864 6566 6175 6c74  f the k (default
-000012a0: 2060 6b3d 3235 6029 206e 6561 7265 7374   `k=25`) nearest
-000012b0: 206e 6569 6768 626f 7273 2069 6e20 7468   neighbors in th
-000012c0: 6520 7072 6f70 6572 2074 7261 696e 696e  e proper trainin
-000012d0: 6720 7365 7420 746f 2065 6163 6820 696e  g set to each in
-000012e0: 7374 616e 6365 2069 6e20 7468 6520 6361  stance in the ca
-000012f0: 6c69 6272 6174 696f 6e20 7365 742e 2041  libration set. A
-00001300: 2073 6d61 6c6c 2076 616c 7565 2028 6265   small value (be
-00001310: 7461 2920 6973 2061 6464 6564 2074 6f20  ta) is added to 
-00001320: 7468 6520 6573 7469 6d61 7465 732c 2077  the estimates, w
-00001330: 6869 6368 206d 6179 2062 6520 6769 7665  hich may be give
-00001340: 6e20 7468 726f 7567 6820 616e 2061 7267  n through an arg
-00001350: 756d 656e 7420 746f 2074 6865 2066 756e  ument to the fun
-00001360: 6374 696f 6e3b 2062 656c 6f77 2077 6520  ction; below we 
-00001370: 6a75 7374 2075 7365 2074 6865 2064 6566  just use the def
-00001380: 6175 6c74 2c20 692e 652e 2c20 6062 6574  ault, i.e., `bet
-00001390: 613d 302e 3031 602e 0a0a 6060 6070 7974  a=0.01`...```pyt
-000013a0: 686f 6e0a 6465 203d 2044 6966 6669 6375  hon.de = Difficu
-000013b0: 6c74 7945 7374 696d 6174 6f72 2829 0a64  ltyEstimator().d
-000013c0: 652e 6669 7428 585f 7072 6f70 5f74 7261  e.fit(X_prop_tra
-000013d0: 696e 2c20 793d 795f 7072 6f70 5f74 7261  in, y=y_prop_tra
-000013e0: 696e 290a 0a73 6967 6d61 735f 6361 6c20  in)..sigmas_cal 
-000013f0: 3d20 6465 2e61 7070 6c79 2858 5f63 616c  = de.apply(X_cal
-00001400: 290a 6060 600a 0a54 6865 2064 6966 6669  ).```..The diffi
-00001410: 6375 6c74 7920 6573 7469 6d61 7465 7320  culty estimates 
-00001420: 616e 6420 7265 7369 6475 616c 7320 6f66  and residuals of
-00001430: 2074 6865 2063 616c 6962 7261 7469 6f6e   the calibration
-00001440: 2065 7861 6d70 6c65 7320 6361 6e20 6e6f   examples can no
-00001450: 7720 6265 2075 7365 6420 746f 2066 6f72  w be used to for
-00001460: 6d20 6120 6e6f 726d 616c 697a 6564 2063  m a normalized c
-00001470: 6f6e 666f 726d 616c 2072 6567 7265 7373  onformal regress
-00001480: 6f72 3a0a 0a60 6060 7079 7468 6f6e 0a63  or:..```python.c
-00001490: 725f 6e6f 726d 203d 2043 6f6e 666f 726d  r_norm = Conform
-000014a0: 616c 5265 6772 6573 736f 7228 290a 6372  alRegressor().cr
-000014b0: 5f6e 6f72 6d2e 6669 7428 7265 7369 6475  _norm.fit(residu
-000014c0: 616c 733d 7265 7369 6475 616c 735f 6361  als=residuals_ca
-000014d0: 6c2c 2073 6967 6d61 733d 7369 676d 6173  l, sigmas=sigmas
-000014e0: 5f63 616c 290a 6060 600a 0a54 6f20 6765  _cal).```..To ge
-000014f0: 6e65 7261 7465 2070 7265 6469 6374 696f  nerate predictio
-00001500: 6e20 696e 7465 7276 616c 7320 666f 7220  n intervals for 
-00001510: 7468 6520 7465 7374 2073 6574 2075 7369  the test set usi
-00001520: 6e67 2074 6865 206e 6f72 6d61 6c69 7a65  ng the normalize
-00001530: 6420 636f 6e66 6f72 6d61 6c20 7265 6772  d conformal regr
-00001540: 6573 736f 722c 2077 6520 6e65 6564 2064  essor, we need d
-00001550: 6966 6669 6375 6c74 7920 6573 7469 6d61  ifficulty estima
-00001560: 7465 7320 666f 7220 7468 6520 7465 7374  tes for the test
-00001570: 2073 6574 2074 6f6f 2c20 7768 6963 6820   set too, which 
-00001580: 7765 2067 6574 2075 7369 6e67 2074 6865  we get using the
-00001590: 2073 616d 6520 6469 6666 6963 756c 7479   same difficulty
-000015a0: 2065 7374 696d 6174 6f72 2061 7320 666f   estimator as fo
-000015b0: 7220 7468 6520 6361 6c69 6272 6174 696f  r the calibratio
-000015c0: 6e20 7365 743a 0a0a 6060 6070 7974 686f  n set:..```pytho
-000015d0: 6e0a 7369 676d 6173 5f74 6573 7420 3d20  n.sigmas_test = 
-000015e0: 6465 2e61 7070 6c79 2858 5f74 6573 7429  de.apply(X_test)
-000015f0: 0a60 6060 0a0a 4e6f 7720 7765 2063 616e  .```..Now we can
-00001600: 206f 6274 6169 6e20 7468 6520 7072 6564   obtain the pred
-00001610: 6963 7469 6f6e 2069 6e74 6572 7661 6c73  iction intervals
-00001620: 2c20 7573 696e 6720 7468 6520 706f 696e  , using the poin
-00001630: 7420 7072 6564 6963 7469 6f6e 7320 616e  t predictions an
-00001640: 6420 6469 6666 6963 756c 7479 2065 7374  d difficulty est
-00001650: 696d 6174 6573 2066 6f72 2074 6865 2074  imates for the t
-00001660: 6573 7420 7365 743a 0a0a 6060 6070 7974  est set:..```pyt
-00001670: 686f 6e0a 696e 7465 7276 616c 735f 6e6f  hon.intervals_no
-00001680: 726d 203d 2063 725f 6e6f 726d 2e70 7265  rm = cr_norm.pre
-00001690: 6469 6374 2879 5f68 6174 3d79 5f68 6174  dict(y_hat=y_hat
-000016a0: 5f74 6573 742c 2073 6967 6d61 733d 7369  _test, sigmas=si
-000016b0: 676d 6173 5f74 6573 742c 200a 2020 2020  gmas_test, .    
-000016c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000016d0: 2020 2020 2020 2020 2020 2020 2079 5f6d               y_m
-000016e0: 696e 3d30 290a 6060 600a 0a60 6060 6e75  in=0).```..```nu
-000016f0: 6d70 790a 6172 7261 7928 5b5b 2032 3236  mpy.array([[ 226
-00001700: 3731 392e 3036 3630 3739 3737 2c20 2035  719.06607977,  5
-00001710: 3535 3234 342e 3933 3339 3230 3233 5d2c  55244.93392023],
-00001720: 0a20 2020 2020 2020 5b20 3137 3337 3637  .       [ 173767
-00001730: 2e39 3037 3533 3731 352c 2020 3339 3833  .90753715,  3983
-00001740: 3634 2e34 3732 3436 3238 355d 2c0a 2020  64.47246285],.  
-00001750: 2020 2020 205b 2031 3234 3639 302e 3730       [ 124690.70
-00001760: 3136 3639 3636 2c20 3130 3436 3433 362e  166966, 1046436.
-00001770: 3433 3833 3330 3334 5d2c 0a20 2020 2020  43833034],.     
-00001780: 2020 2e2e 2e2c 0a20 2020 2020 2020 5b20    ...,.       [ 
-00001790: 3630 3739 3439 2e37 3135 3430 3537 322c  607949.71540572,
-000017a0: 2031 3030 3337 3236 2e37 3234 3539 3432   1003726.7245942
-000017b0: 385d 2c0a 2020 2020 2020 205b 2031 3838  8],.       [ 188
-000017c0: 3637 312e 3337 3532 3237 3820 2c20 2033  671.3752278 ,  3
-000017d0: 3230 3930 392e 3536 3437 3732 3220 5d2c  20909.5647722 ],
-000017e0: 0a20 2020 2020 2020 5b20 3134 3533 3430  .       [ 145340
-000017f0: 2e33 3930 3736 3832 342c 2020 3532 3633  .39076824,  5263
-00001800: 3133 2e32 3039 3233 3137 365d 5d29 0a60  13.20923176]]).`
-00001810: 6060 0a0a 4465 7065 6e64 696e 6720 6f6e  ``..Depending on
-00001820: 2074 6865 2065 6d70 6c6f 7965 6420 6469   the employed di
-00001830: 6666 6963 756c 7479 2065 7374 696d 6174  fficulty estimat
-00001840: 6f72 2c20 7468 6520 6e6f 726d 616c 697a  or, the normaliz
-00001850: 6564 2069 6e74 6572 7661 6c73 206d 6179  ed intervals may
-00001860: 2073 6f6d 6574 696d 6573 2062 6520 756e   sometimes be un
-00001870: 7265 6173 6f6e 6162 6c79 206c 6172 6765  reasonably large
-00001880: 2c20 696e 2074 6865 2073 656e 7365 2074  , in the sense t
-00001890: 6861 7420 7468 6579 206d 6179 2062 6520  hat they may be 
-000018a0: 7365 7665 7261 6c20 7469 6d65 7320 6c61  several times la
-000018b0: 7267 6572 2074 6861 6e20 616e 7920 7072  rger than any pr
-000018c0: 6576 696f 7573 6c79 206f 6273 6572 7665  eviously observe
-000018d0: 6420 6572 726f 722e 204d 6f72 656f 7665  d error. Moreove
-000018e0: 722c 2069 6620 7468 6520 6469 6666 6963  r, if the diffic
-000018f0: 756c 7479 2065 7374 696d 6174 6f72 2069  ulty estimator i
-00001900: 7320 6e6f 7420 7665 7279 2069 6e66 6f72  s not very infor
-00001910: 6d61 7469 7665 2c20 652e 672e 2c20 636f  mative, e.g., co
-00001920: 6d70 6c65 7465 6c79 2072 616e 646f 6d2c  mpletely random,
-00001930: 2074 6865 2076 6172 7969 6e67 2069 6e74   the varying int
-00001940: 6572 7661 6c20 7369 7a65 7320 6d61 7920  erval sizes may 
-00001950: 6769 7665 2061 2066 616c 7365 2069 6d70  give a false imp
-00001960: 7265 7373 696f 6e20 6f66 2074 6861 7420  ression of that 
-00001970: 7765 2063 616e 2065 7870 6563 7420 6c6f  we can expect lo
-00001980: 7765 7220 7072 6564 6963 7469 6f6e 2065  wer prediction e
-00001990: 7272 6f72 7320 666f 7220 696e 7374 616e  rrors for instan
-000019a0: 6365 7320 7769 7468 2074 6967 6874 6572  ces with tighter
-000019b0: 2069 6e74 6572 7661 6c73 2e20 4964 6561   intervals. Idea
-000019c0: 6c6c 792c 2061 2064 6966 6669 6375 6c74  lly, a difficult
-000019d0: 7920 6573 7469 6d61 746f 7220 7072 6f76  y estimator prov
-000019e0: 6964 696e 6720 6c69 7474 6c65 206f 7220  iding little or 
-000019f0: 6e6f 2069 6e66 6f72 6d61 7469 6f6e 206f  no information o
-00001a00: 6e20 7468 6520 6578 7065 6374 6564 2065  n the expected e
-00001a10: 7272 6f72 2073 686f 756c 6420 696e 7374  rror should inst
-00001a20: 6561 6420 6c65 6164 2074 6f20 6d6f 7265  ead lead to more
-00001a30: 2075 6e69 666f 726d 6c79 2064 6973 7472   uniformly distr
-00001a40: 6962 7574 6564 2069 6e74 6572 7661 6c20  ibuted interval 
-00001a50: 7369 7a65 732e 0a0a 4120 4d6f 6e64 7269  sizes...A Mondri
-00001a60: 616e 2063 6f6e 666f 726d 616c 2072 6567  an conformal reg
-00001a70: 7265 7373 6f72 2063 616e 2062 6520 7573  ressor can be us
-00001a80: 6564 2074 6f20 6164 6472 6573 7320 7468  ed to address th
-00001a90: 6573 6520 7072 6f62 6c65 6d73 2c20 6279  ese problems, by
-00001aa0: 2064 6976 6964 696e 6720 7468 6520 6f62   dividing the ob
-00001ab0: 6a65 6374 2073 7061 6365 2069 6e74 6f20  ject space into 
-00001ac0: 6e6f 6e2d 6f76 6572 6c61 7070 696e 6720  non-overlapping 
-00001ad0: 736f 2d63 616c 6c65 6420 4d6f 6e64 7269  so-called Mondri
-00001ae0: 616e 2063 6174 6567 6f72 6965 732c 2061  an categories, a
-00001af0: 6e64 2066 6f72 6d69 6e67 2061 2028 7374  nd forming a (st
-00001b00: 616e 6461 7264 2920 636f 6e66 6f72 6d61  andard) conforma
-00001b10: 6c20 7265 6772 6573 736f 7220 666f 7220  l regressor for 
-00001b20: 6561 6368 2063 6174 6567 6f72 792e 2054  each category. T
-00001b30: 6865 2063 6174 6567 6f72 7920 6d65 6d62  he category memb
-00001b40: 6572 7368 6970 206f 6620 7468 6520 6f62  ership of the ob
-00001b50: 6a65 6374 7320 6361 6e20 6265 2070 726f  jects can be pro
-00001b60: 7669 6465 6420 6173 2061 6e20 6164 6469  vided as an addi
-00001b70: 7469 6f6e 616c 2061 7267 756d 656e 742c  tional argument,
-00001b80: 206e 616d 6564 2060 6269 6e73 602c 2066   named `bins`, f
-00001b90: 6f72 2074 6865 2060 6669 7460 206d 6574  or the `fit` met
-00001ba0: 686f 642e 0a0a 4865 7265 2077 6520 7769  hod...Here we wi
-00001bb0: 6c6c 2075 7365 2074 6865 2068 656c 7065  ll use the helpe
-00001bc0: 7220 6675 6e63 7469 6f6e 2060 6269 6e6e  r function `binn
-00001bd0: 696e 6760 2074 6f20 666f 726d 204d 6f6e  ing` to form Mon
-00001be0: 6472 6961 6e20 6361 7465 676f 7269 6573  drian categories
-00001bf0: 2062 7920 6571 7561 6c2d 7369 7a65 6420   by equal-sized 
-00001c00: 6269 6e6e 696e 6720 6f66 2074 6865 2064  binning of the d
-00001c10: 6966 6669 6375 6c74 7920 6573 7469 6d61  ifficulty estima
-00001c20: 7465 733b 2074 6865 2066 756e 6374 696f  tes; the functio
-00001c30: 6e20 7769 6c6c 2072 6574 7572 6e20 6c61  n will return la
-00001c40: 6265 6c73 2066 6f72 2074 6865 2063 616c  bels for the cal
-00001c50: 6962 7261 7469 6f6e 206f 626a 6563 7473  ibration objects
-00001c60: 2061 7320 7765 6c6c 2061 7320 7468 7265   as well as thre
-00001c70: 7368 6f6c 6473 2066 6f72 2074 6865 2062  sholds for the b
-00001c80: 696e 732c 2077 6869 6368 2061 7265 206c  ins, which are l
-00001c90: 6174 6572 2074 6f20 6265 2075 7365 6420  ater to be used 
-00001ca0: 7768 656e 2062 696e 6e69 6e67 2074 6865  when binning the
-00001cb0: 2074 6573 7420 6f62 6a65 6374 733a 0a0a   test objects:..
-00001cc0: 6060 6070 7974 686f 6e0a 6269 6e73 5f63  ```python.bins_c
-00001cd0: 616c 2c20 6269 6e5f 7468 7265 7368 6f6c  al, bin_threshol
-00001ce0: 6473 203d 2062 696e 6e69 6e67 2876 616c  ds = binning(val
-00001cf0: 7565 733d 7369 676d 6173 5f63 616c 2c20  ues=sigmas_cal, 
-00001d00: 6269 6e73 3d32 3029 0a60 6060 0a0a 4120  bins=20).```..A 
-00001d10: 4d6f 6e64 7269 616e 2063 6f6e 666f 726d  Mondrian conform
-00001d20: 616c 2072 6567 7265 7373 6f72 2069 7320  al regressor is 
-00001d30: 6f62 7461 696e 6564 2066 726f 6d20 7468  obtained from th
-00001d40: 6520 7265 7369 6475 616c 7320 616e 6420  e residuals and 
-00001d50: 4d6f 6e64 7269 616e 2063 6174 6567 6f72  Mondrian categor
-00001d60: 7920 6c61 6265 6c73 3a0a 0a60 6060 7079  y labels:..```py
-00001d70: 7468 6f6e 0a63 725f 6d6f 6e64 203d 2043  thon.cr_mond = C
-00001d80: 6f6e 666f 726d 616c 5265 6772 6573 736f  onformalRegresso
-00001d90: 7228 290a 6372 5f6d 6f6e 642e 6669 7428  r().cr_mond.fit(
-00001da0: 7265 7369 6475 616c 733d 7265 7369 6475  residuals=residu
-00001db0: 616c 735f 6361 6c2c 2062 696e 733d 6269  als_cal, bins=bi
-00001dc0: 6e73 5f63 616c 290a 6060 600a 0a49 6e20  ns_cal).```..In 
-00001dd0: 6f72 6465 7220 746f 2075 7365 2074 6865  order to use the
-00001de0: 204d 6f6e 6472 6961 6e20 636f 6e66 6f72   Mondrian confor
-00001df0: 6d61 6c20 7265 6772 6573 736f 7220 6f6e  mal regressor on
-00001e00: 2074 6865 2074 6573 7420 6f62 6a65 6374   the test object
-00001e10: 732c 2077 6520 6e65 6564 2074 6f20 6765  s, we need to ge
-00001e20: 7420 7468 6520 6c61 6265 6c73 206f 6620  t the labels of 
-00001e30: 7468 6520 4d6f 6e64 7269 616e 2063 6174  the Mondrian cat
-00001e40: 6567 6f72 6965 7320 666f 7220 7468 6573  egories for thes
-00001e50: 653a 0a0a 6060 6070 7974 686f 6e0a 6269  e:..```python.bi
-00001e60: 6e73 5f74 6573 7420 3d20 6269 6e6e 696e  ns_test = binnin
-00001e70: 6728 7661 6c75 6573 3d73 6967 6d61 735f  g(values=sigmas_
-00001e80: 7465 7374 2c20 6269 6e73 3d62 696e 5f74  test, bins=bin_t
-00001e90: 6872 6573 686f 6c64 7329 0a60 6060 0a0a  hresholds).```..
-00001ea0: 4e6f 7720 7765 2068 6176 6520 6576 6572  Now we have ever
-00001eb0: 7974 6869 6e67 2077 6520 6e65 6564 2074  ything we need t
-00001ec0: 6f20 6765 7420 7468 6520 7072 6564 6963  o get the predic
-00001ed0: 7469 6f6e 2069 6e74 6572 7661 6c73 3a0a  tion intervals:.
-00001ee0: 0a60 6060 7079 7468 6f6e 0a69 6e74 6572  .```python.inter
-00001ef0: 7661 6c73 5f6d 6f6e 6420 3d20 6372 5f6d  vals_mond = cr_m
-00001f00: 6f6e 642e 7072 6564 6963 7428 795f 6861  ond.predict(y_ha
-00001f10: 743d 795f 6861 745f 7465 7374 2c20 6269  t=y_hat_test, bi
-00001f20: 6e73 3d62 696e 735f 7465 7374 2c20 795f  ns=bins_test, y_
-00001f30: 6d69 6e3d 3029 0a60 6060 0a0a 6060 606e  min=0).```..```n
-00001f40: 756d 7079 0a61 7272 6179 285b 5b20 3230  umpy.array([[ 20
-00001f50: 3633 3739 2e37 202c 2020 3537 3535 3834  6379.7 ,  575584
-00001f60: 2e33 205d 2c0a 2020 2020 2020 205b 2031  .3 ],.       [ 1
-00001f70: 3434 3031 342e 3635 2c20 2034 3238 3131  44014.65,  42811
-00001f80: 372e 3733 5d2c 0a20 2020 2020 2020 5b20  7.73],.       [ 
-00001f90: 2031 3739 3635 2e35 372c 2031 3135 3331   17965.57, 11531
-00001fa0: 3631 2e35 375d 2c0a 2020 2020 2020 202e  61.57],.       .
-00001fb0: 2e2e 2c0a 2020 2020 2020 205b 2036 3533  ..,.       [ 653
-00001fc0: 3836 352e 3232 2c20 2039 3537 3831 312e  865.22,  957811.
-00001fd0: 3232 5d2c 0a20 2020 2020 2020 5b20 3137  22],.       [ 17
-00001fe0: 3432 3634 2e38 372c 2020 3333 3533 3136  4264.87,  335316
-00001ff0: 2e30 375d 2c0a 2020 2020 2020 205b 2031  .07],.       [ 1
-00002000: 3430 3538 372e 3436 2c20 2035 3331 3036  40587.46,  53106
-00002010: 362e 3134 5d5d 290a 6060 600a 0a23 2323  6.14]]).```..###
-00002020: 2043 6f6e 666f 726d 616c 2070 7265 6469   Conformal predi
-00002030: 6374 6976 6520 7379 7374 656d 730a 0a54  ctive systems..T
-00002040: 6865 2069 6e74 6572 6661 6365 2074 6f20  he interface to 
-00002050: 6120 6043 6f6e 666f 726d 616c 5072 6564  a `ConformalPred
-00002060: 6963 7469 7665 5379 7374 656d 6020 6973  ictiveSystem` is
-00002070: 2076 6572 7920 7369 6d69 6c61 7220 746f   very similar to
-00002080: 2074 6861 7420 6f66 2061 2063 6f6e 666f   that of a confo
-00002090: 726d 616c 2072 6567 7265 7373 6f72 3b20  rmal regressor; 
-000020a0: 6279 2070 726f 7669 6469 6e67 206a 7573  by providing jus
-000020b0: 7420 7468 6520 7265 7369 6475 616c 732c  t the residuals,
-000020c0: 2077 6520 6765 7420 6120 7374 616e 6461   we get a standa
-000020d0: 7264 2063 6f6e 666f 726d 616c 2070 7265  rd conformal pre
-000020e0: 6469 6374 6976 6520 7379 7374 656d 2c20  dictive system, 
-000020f0: 6279 2070 726f 7669 6469 6e67 2061 6c73  by providing als
-00002100: 6f20 6469 6666 6963 756c 7479 2065 7374  o difficulty est
-00002110: 696d 6174 6573 2c20 7765 2067 6574 2061  imates, we get a
-00002120: 206e 6f72 6d61 6c69 7a65 6420 636f 6e66   normalized conf
-00002130: 6f72 6d61 6c20 7072 6564 6963 7469 7665  ormal predictive
-00002140: 2073 7973 7465 6d20 616e 6420 6279 2070   system and by p
-00002150: 726f 7669 6469 6e67 206c 6162 656c 7320  roviding labels 
-00002160: 666f 7220 4d6f 6e64 7269 616e 2063 6174  for Mondrian cat
-00002170: 6567 6f72 6965 7320 2862 696e 7329 2c20  egories (bins), 
-00002180: 7765 2067 6574 2061 204d 6f6e 6472 6961  we get a Mondria
-00002190: 6e20 636f 6e66 6f72 6d61 6c20 7072 6564  n conformal pred
-000021a0: 6963 7469 7665 2073 7973 7465 6d2e 0a0a  ictive system...
-000021b0: 5468 6520 6d61 696e 2064 6966 6665 7265  The main differe
-000021c0: 6e63 6520 746f 2063 6f6e 666f 726d 616c  nce to conformal
-000021d0: 2072 6567 7265 7373 6f72 7320 636f 6e63   regressors conc
-000021e0: 6572 6e73 2074 6865 206f 7574 7075 743b  erns the output;
-000021f0: 2069 6e73 7465 6164 206f 6620 7072 6564   instead of pred
-00002200: 6963 7469 6f6e 2069 6e74 6572 7661 6c73  iction intervals
-00002210: 2c20 636f 6e66 6f72 6d61 6c20 7072 6564  , conformal pred
-00002220: 6963 7469 7665 2073 7973 7465 6d73 2070  ictive systems p
-00002230: 726f 6475 6365 2063 6f6d 706c 6574 6520  roduce complete 
-00002240: 6375 6d75 6c61 7469 7665 2064 6973 7472  cumulative distr
-00002250: 6962 7574 696f 6e20 6675 6e63 7469 6f6e  ibution function
-00002260: 7320 2863 6f6e 666f 726d 616c 2070 7265  s (conformal pre
-00002270: 6469 6374 6976 6520 6469 7374 7269 6275  dictive distribu
-00002280: 7469 6f6e 7329 2e20 4672 6f6d 2074 6865  tions). From the
-00002290: 7365 2077 6520 6361 6e20 6765 6e65 7261  se we can genera
-000022a0: 7465 2070 7265 6469 6374 696f 6e20 696e  te prediction in
-000022b0: 7465 7276 616c 732c 2062 7574 2077 6520  tervals, but we 
-000022c0: 6361 6e20 616c 736f 206f 6274 6169 6e20  can also obtain 
-000022d0: 7065 7263 656e 7469 6c65 732c 2063 616c  percentiles, cal
-000022e0: 6962 7261 7465 6420 706f 696e 7420 7072  ibrated point pr
-000022f0: 6564 6963 7469 6f6e 732c 2061 7320 7765  edictions, as we
-00002300: 6c6c 2061 7320 702d 7661 6c75 6573 2066  ll as p-values f
-00002310: 6f72 2067 6976 656e 2074 6172 6765 7420  or given target 
-00002320: 7661 6c75 6573 2e0a 0a4c 6574 2075 7320  values...Let us 
-00002330: 6669 7420 6120 4d6f 6e64 7269 616e 206e  fit a Mondrian n
-00002340: 6f72 6d61 6c69 7a65 6420 636f 6e66 6f72  ormalized confor
-00002350: 6d61 6c20 7072 6564 6963 7469 7665 2073  mal predictive s
-00002360: 7973 7465 6d2c 2075 7369 6e67 2074 6865  ystem, using the
-00002370: 2061 626f 7665 2072 6573 6964 7561 6c73   above residuals
-00002380: 2061 6e64 2064 6966 6669 6375 6c74 7920   and difficulty 
-00002390: 6573 7469 6d61 7465 7320 2873 6967 6d61  estimates (sigma
-000023a0: 7329 2c20 616e 6420 7768 6572 6520 7468  s), and where th
-000023b0: 6520 4d6f 6e64 7269 616e 2063 6174 6567  e Mondrian categ
-000023c0: 6f72 6965 7320 2862 696e 7329 2061 7265  ories (bins) are
-000023d0: 2066 6f72 6d65 6420 7573 696e 6720 7468   formed using th
-000023e0: 6520 706f 696e 7420 7072 6564 6963 7469  e point predicti
-000023f0: 6f6e 7320 666f 7220 7468 6520 6361 6c69  ons for the cali
-00002400: 6272 6174 696f 6e20 7365 743a 0a0a 6060  bration set:..``
-00002410: 6070 7974 686f 6e0a 6672 6f6d 2063 7265  `python.from cre
-00002420: 7065 7320 696d 706f 7274 2043 6f6e 666f  pes import Confo
-00002430: 726d 616c 5072 6564 6963 7469 7665 5379  rmalPredictiveSy
-00002440: 7374 656d 0a0a 6269 6e73 5f63 616c 2c20  stem..bins_cal, 
-00002450: 6269 6e5f 7468 7265 7368 6f6c 6473 203d  bin_thresholds =
-00002460: 2062 696e 6e69 6e67 2876 616c 7565 733d   binning(values=
-00002470: 795f 6861 745f 6361 6c2c 2062 696e 733d  y_hat_cal, bins=
-00002480: 3529 0a0a 6370 735f 6d6f 6e64 5f6e 6f72  5)..cps_mond_nor
-00002490: 6d20 3d20 436f 6e66 6f72 6d61 6c50 7265  m = ConformalPre
-000024a0: 6469 6374 6976 6553 7973 7465 6d28 292e  dictiveSystem().
-000024b0: 6669 7428 7265 7369 6475 616c 733d 7265  fit(residuals=re
-000024c0: 7369 6475 616c 735f 6361 6c2c 0a20 2020  siduals_cal,.   
-000024d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000024e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000024f0: 2020 2020 2020 2020 2020 2020 2073 6967               sig
-00002500: 6d61 733d 7369 676d 6173 5f63 616c 2c0a  mas=sigmas_cal,.
-00002510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002540: 6269 6e73 3d62 696e 735f 6361 6c29 0a60  bins=bins_cal).`
-00002550: 6060 0a0a 5765 2061 6c72 6561 6479 2068  ``..We already h
-00002560: 6176 6520 7468 6520 706f 696e 7420 7072  ave the point pr
-00002570: 6564 6963 7469 6f6e 7320 616e 6420 7468  edictions and th
-00002580: 6520 6469 6666 6963 756c 7479 2065 7374  e difficulty est
-00002590: 696d 6174 6573 2066 6f72 2074 6865 2074  imates for the t
-000025a0: 6573 7420 6f62 6a65 6374 732c 2073 6f20  est objects, so 
-000025b0: 7765 206a 7573 7420 6e65 6564 2074 6865  we just need the
-000025c0: 2063 6174 6567 6f72 7920 6c61 6265 6c73   category labels
-000025d0: 2061 6363 6f72 6469 6e67 2074 6f20 7468   according to th
-000025e0: 6520 6e65 7720 6269 6e20 7468 7265 7368  e new bin thresh
-000025f0: 6f6c 6473 3a0a 0a60 6060 7079 7468 6f6e  olds:..```python
-00002600: 0a62 696e 735f 7465 7374 203d 2062 696e  .bins_test = bin
-00002610: 6e69 6e67 2876 616c 7565 733d 795f 6861  ning(values=y_ha
-00002620: 745f 7465 7374 2c20 6269 6e73 3d62 696e  t_test, bins=bin
-00002630: 5f74 6872 6573 686f 6c64 7329 0a60 6060  _thresholds).```
-00002640: 0a0a 5765 2063 616e 206e 6f77 2065 7874  ..We can now ext
-00002650: 7261 6374 2070 7265 6469 6374 696f 6e20  ract prediction 
-00002660: 696e 7465 7276 616c 7320 6672 6f6d 2074  intervals from t
-00002670: 6865 2063 6f6e 666f 726d 616c 2070 7265  he conformal pre
-00002680: 6469 6374 6976 6520 6469 7374 7269 6275  dictive distribu
-00002690: 7469 6f6e 7320 666f 7220 7468 6520 7465  tions for the te
-000026a0: 7374 206f 626a 6563 7473 3a20 0a0a 6060  st objects: ..``
-000026b0: 6070 7974 686f 6e0a 696e 7465 7276 616c  `python.interval
-000026c0: 7320 3d20 6370 735f 6d6f 6e64 5f6e 6f72  s = cps_mond_nor
-000026d0: 6d2e 7072 6564 6963 7428 795f 6861 743d  m.predict(y_hat=
-000026e0: 795f 6861 745f 7465 7374 2c0a 2020 2020  y_hat_test,.    
-000026f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002700: 2020 2020 2020 2020 2020 2020 2020 7369                si
-00002710: 676d 6173 3d73 6967 6d61 735f 7465 7374  gmas=sigmas_test
-00002720: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00002730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002740: 2020 2020 6269 6e73 3d62 696e 735f 7465      bins=bins_te
-00002750: 7374 2c0a 2020 2020 2020 2020 2020 2020  st,.            
-00002760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002770: 2020 2020 2020 6c6f 7765 725f 7065 7263        lower_perc
-00002780: 656e 7469 6c65 733d 322e 352c 0a20 2020  entiles=2.5,.   
-00002790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000027a0: 2020 2020 2020 2020 2020 2020 2020 2068                 h
-000027b0: 6967 6865 725f 7065 7263 656e 7469 6c65  igher_percentile
-000027c0: 733d 3937 2e35 2c0a 2020 2020 2020 2020  s=97.5,.        
-000027d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000027e0: 2020 2020 2020 2020 2020 795f 6d69 6e3d            y_min=
-000027f0: 3029 0a60 6060 0a0a 6060 606e 756d 7079  0).```..```numpy
-00002800: 0a61 7272 6179 285b 5b20 3234 3538 3236  .array([[ 245826
-00002810: 2e33 3432 3236 3933 202c 2020 3531 3733  .3422693 ,  5173
-00002820: 3135 2e38 3336 3138 3938 355d 2c0a 2020  15.83618985],.  
-00002830: 2020 2020 205b 2031 3435 3334 382e 3033       [ 145348.03
-00002840: 3431 3538 3438 2c20 2033 3932 3936 382e  415848,  392968.
-00002850: 3135 3538 3739 3937 5d2c 0a20 2020 2020  15587997],.     
-00002860: 2020 5b20 3134 3837 3734 2e36 3534 3631    [ 148774.65461
-00002870: 3231 322c 2031 3033 3433 3030 2e38 3431  212, 1034300.841
-00002880: 3935 3937 365d 2c0a 2020 2020 2020 202e  95976],.       .
-00002890: 2e2e 2c0a 2020 2020 2020 205b 2035 3839  ..,.       [ 589
-000028a0: 3230 302e 3537 3235 3935 3720 2c20 3130  200.5725957 , 10
-000028b0: 3537 3031 332e 3839 3130 3230 3037 5d2c  57013.89102007],
-000028c0: 0a20 2020 2020 2020 5b20 3137 3139 3338  .       [ 171938
-000028d0: 2e32 3933 3832 3935 322c 2020 3331 3737  .29382952,  3177
-000028e0: 3332 2e33 3136 3131 3134 315d 2c0a 2020  32.31611141],.  
-000028f0: 2020 2020 205b 2031 3637 3439 382e 3031       [ 167498.01
-00002900: 3534 3035 3034 2c20 2034 3832 3332 382e  540504,  482328.
-00002910: 3938 3535 3236 3332 5d5d 290a 6060 600a  98552632]]).```.
-00002920: 0a57 6520 6361 6e20 616c 736f 2067 6574  .We can also get
-00002930: 2074 6865 2070 2d76 616c 7565 7320 666f   the p-values fo
-00002940: 7220 7468 6520 7472 7565 2074 6172 6765  r the true targe
-00002950: 7420 7661 6c75 6573 3b20 7468 6579 2073  t values; they s
-00002960: 686f 756c 6420 6265 2075 6e69 666f 726d  hould be uniform
-00002970: 6c79 2064 6973 7472 6962 7574 6564 2c20  ly distributed, 
-00002980: 6966 2074 6865 2074 6573 7420 6f62 6a65  if the test obje
-00002990: 6374 7320 6172 6520 6472 6177 6e20 6672  cts are drawn fr
-000029a0: 6f6d 2074 6865 2073 616d 6520 756e 6465  om the same unde
-000029b0: 726c 7969 6e67 2064 6973 7472 6962 7574  rlying distribut
-000029c0: 696f 6e20 6173 2074 6865 2063 616c 6962  ion as the calib
-000029d0: 7261 7469 6f6e 2065 7861 6d70 6c65 732e  ration examples.
-000029e0: 0a0a 6060 6070 7974 686f 6e0a 705f 7661  ..```python.p_va
-000029f0: 6c75 6573 203d 2063 7073 5f6d 6f6e 645f  lues = cps_mond_
-00002a00: 6e6f 726d 2e70 7265 6469 6374 2879 5f68  norm.predict(y_h
-00002a10: 6174 3d79 5f68 6174 5f74 6573 742c 0a20  at=y_hat_test,. 
-00002a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002a40: 7369 676d 6173 3d73 6967 6d61 735f 7465  sigmas=sigmas_te
-00002a50: 7374 2c0a 2020 2020 2020 2020 2020 2020  st,.            
-00002a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002a70: 2020 2020 2062 696e 733d 6269 6e73 5f74       bins=bins_t
-00002a80: 6573 742c 0a20 2020 2020 2020 2020 2020  est,.           
-00002a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002aa0: 2020 2020 2020 793d 795f 7465 7374 290a        y=y_test).
-00002ab0: 6060 600a 0a60 6060 6e75 6d70 790a 6172  ```..```numpy.ar
-00002ac0: 7261 7928 5b5b 302e 3938 3630 3336 3134  ray([[0.98603614
-00002ad0: 5d2c 0a20 2020 2020 2020 5b30 2e38 3731  ],.       [0.871
-00002ae0: 3738 3235 365d 2c0a 2020 2020 2020 205b  78256],.       [
-00002af0: 302e 3434 3230 3139 3834 5d2c 0a20 2020  0.44201984],.   
-00002b00: 2020 2020 2e2e 2e2c 0a20 2020 2020 2020      ...,.       
-00002b10: 5b30 2e30 3536 3838 3830 345d 2c0a 2020  [0.05688804],.  
-00002b20: 2020 2020 205b 302e 3039 3437 3336 3034       [0.09473604
-00002b30: 5d2c 0a20 2020 2020 2020 5b30 2e33 3130  ],.       [0.310
-00002b40: 3639 3931 335d 5d29 0a60 6060 0a0a 5765  69913]]).```..We
-00002b50: 206d 6179 2072 6571 7565 7374 2074 6861   may request tha
-00002b60: 7420 7468 6520 7072 6564 6963 7420 6d65  t the predict me
-00002b70: 7468 6f64 2072 6574 7572 6e73 2074 6865  thod returns the
-00002b80: 2066 756c 6c20 636f 6e66 6f72 6d61 6c20   full conformal 
-00002b90: 7072 6564 6963 7469 7665 2064 6973 7472  predictive distr
-00002ba0: 6962 7574 696f 6e20 2843 5044 2920 666f  ibution (CPD) fo
-00002bb0: 7220 6561 6368 2074 6573 7420 696e 7374  r each test inst
-00002bc0: 616e 6365 2c20 6173 2064 6566 696e 6564  ance, as defined
-00002bd0: 2062 7920 7468 6520 7468 7265 7368 6f6c   by the threshol
-00002be0: 6420 7661 6c75 6573 2c20 6279 2073 6574  d values, by set
-00002bf0: 7469 6e67 2060 7265 7475 726e 5f63 7064  ting `return_cpd
-00002c00: 733d 5472 7565 602e 2054 6865 2066 6f72  s=True`. The for
-00002c10: 6d61 7420 6f66 2074 6865 2064 6973 7472  mat of the distr
-00002c20: 6962 7574 696f 6e73 2076 6172 7920 7769  ibutions vary wi
-00002c30: 7468 2074 6865 2074 7970 6520 6f66 2063  th the type of c
-00002c40: 6f6e 666f 726d 616c 2070 7265 6469 6374  onformal predict
-00002c50: 6976 6520 7379 7374 656d 3b20 666f 7220  ive system; for 
-00002c60: 6120 7374 616e 6461 7264 2061 6e64 206e  a standard and n
-00002c70: 6f72 6d61 6c69 7a65 6420 4350 532c 2074  ormalized CPS, t
-00002c80: 6865 206f 7574 7075 7420 6973 2061 6e20  he output is an 
-00002c90: 6172 7261 7920 7769 7468 2061 2072 6f77  array with a row
-00002ca0: 2066 6f72 2065 6163 6820 7465 7374 2069   for each test i
-00002cb0: 6e73 7461 6e63 6520 616e 6420 6120 636f  nstance and a co
-00002cc0: 6c75 6d6e 2066 6f72 2065 6163 6820 6361  lumn for each ca
-00002cd0: 6c69 6272 6174 696f 6e20 696e 7374 616e  libration instan
-00002ce0: 6365 2028 7265 7369 6475 616c 292c 2077  ce (residual), w
-00002cf0: 6869 6c65 2066 6f72 2061 204d 6f6e 6472  hile for a Mondr
-00002d00: 6961 6e20 4350 532c 2074 6865 2064 6566  ian CPS, the def
-00002d10: 6175 6c74 206f 7574 7075 7420 6973 2061  ault output is a
-00002d20: 2076 6563 746f 7220 636f 6e74 6169 6e69   vector containi
-00002d30: 6e67 206f 6e65 2043 5044 2070 6572 2074  ng one CPD per t
-00002d40: 6573 7420 696e 7374 616e 6365 2c20 7369  est instance, si
-00002d50: 6e63 6520 7468 6520 6e75 6d62 6572 206f  nce the number o
-00002d60: 6620 7661 6c75 6573 206d 6179 2076 6172  f values may var
-00002d70: 7920 6265 7477 6565 6e20 6361 7465 676f  y between catego
-00002d80: 7269 6573 2e0a 0a60 6060 7079 7468 6f6e  ries...```python
-00002d90: 0a63 7064 7320 3d20 6370 735f 6d6f 6e64  .cpds = cps_mond
-00002da0: 5f6e 6f72 6d2e 7072 6564 6963 7428 795f  _norm.predict(y_
-00002db0: 6861 743d 795f 6861 745f 7465 7374 2c0a  hat=y_hat_test,.
-00002dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002dd0: 2020 2020 2020 2020 2020 2020 2073 6967               sig
-00002de0: 6d61 733d 7369 676d 6173 5f74 6573 742c  mas=sigmas_test,
-00002df0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00002e00: 2020 2020 2020 2020 2020 2020 2020 6269                bi
-00002e10: 6e73 3d62 696e 735f 7465 7374 2c0a 2020  ns=bins_test,.  
-00002e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002e30: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00002e40: 6e5f 6370 6473 3d54 7275 6529 0a60 6060  n_cpds=True).```
-00002e50: 0a0a 5468 6520 7265 7375 6c74 696e 6720  ..The resulting 
-00002e60: 7665 6374 6f72 206f 6620 6172 7261 7973  vector of arrays
-00002e70: 2069 7320 6e6f 7420 6469 7370 6c61 7965   is not displaye
-00002e80: 6420 6865 7265 2c20 6275 7420 7765 2069  d here, but we i
-00002e90: 6e73 7465 6164 2070 726f 7669 6465 2061  nstead provide a
-00002ea0: 2070 6c6f 7420 666f 7220 7468 6520 4350   plot for the CP
-00002eb0: 4420 6f66 2061 2072 616e 646f 6d20 7465  D of a random te
-00002ec0: 7374 2069 6e73 7461 6e63 653a 0a0a 215b  st instance:..![
-00002ed0: 6370 645d 2868 7474 7073 3a2f 2f75 7365  cpd](https://use
-00002ee0: 722d 696d 6167 6573 2e67 6974 6875 6275  r-images.githubu
-00002ef0: 7365 7263 6f6e 7465 6e74 2e63 6f6d 2f37  sercontent.com/7
-00002f00: 3833 3837 3431 2f32 3335 3038 3139 3639  838741/235081969
-00002f10: 2d33 3238 6437 6132 332d 3236 6339 2d34  -328d7a23-26c9-4
-00002f20: 3739 392d 6132 3436 2d38 6333 3566 6437  799-a246-8c35fd7
-00002f30: 6163 3838 652e 706e 6729 0a0a 2323 2045  ac88e.png)..## E
-00002f40: 7861 6d70 6c65 730a 0a46 6f72 2061 6464  xamples..For add
-00002f50: 6974 696f 6e61 6c20 6578 616d 706c 6573  itional examples
-00002f60: 206f 6620 686f 7720 746f 2075 7365 2074   of how to use t
-00002f70: 6865 2070 6163 6b61 6765 2061 6e64 206d  he package and m
-00002f80: 6f64 756c 652c 2069 6e63 6c75 6469 6e67  odule, including
-00002f90: 2068 6f77 2074 6f20 7573 6520 6f75 742d   how to use out-
-00002fa0: 6f66 2d62 6167 2070 7265 6469 6374 696f  of-bag predictio
-00002fb0: 6e73 2072 6174 6865 7220 7468 616e 2068  ns rather than h
-00002fc0: 6176 696e 6720 746f 2072 656c 7920 6f6e  aving to rely on
-00002fd0: 2064 6976 6964 696e 6720 7468 6520 7472   dividing the tr
-00002fe0: 6169 6e69 6e67 2073 6574 2069 6e74 6f20  aining set into 
-00002ff0: 6120 7072 6f70 6572 2074 7261 696e 696e  a proper trainin
-00003000: 6720 616e 6420 6361 6c69 6272 6174 696f  g and calibratio
-00003010: 6e20 7365 742c 2073 6565 205b 7468 6520  n set, see [the 
-00003020: 646f 6375 6d65 6e74 6174 696f 6e5d 2868  documentation](h
-00003030: 7474 7073 3a2f 2f63 7265 7065 732e 7265  ttps://crepes.re
-00003040: 6164 7468 6564 6f63 732e 696f 2f65 6e2f  adthedocs.io/en/
-00003050: 6c61 7465 7374 2f29 2061 6e64 205b 7468  latest/) and [th
-00003060: 6973 204a 7570 7974 6572 206e 6f74 6562  is Jupyter noteb
-00003070: 6f6f 6b5d 2868 7474 7073 3a2f 2f67 6974  ook](https://git
-00003080: 6875 622e 636f 6d2f 6865 6e72 696b 626f  hub.com/henrikbo
-00003090: 7374 726f 6d2f 6372 6570 6573 2f62 6c6f  strom/crepes/blo
-000030a0: 622f 6d61 696e 2f64 6f63 732f 6372 6570  b/main/docs/crep
-000030b0: 6573 5f6e 622e 6970 796e 6229 2e0a 0a23  es_nb.ipynb)...#
-000030c0: 2320 4369 7469 6e67 2063 7265 7065 730a  # Citing crepes.
-000030d0: 0a49 6620 796f 7520 7573 6520 6063 7265  .If you use `cre
-000030e0: 7065 7360 2066 6f72 2061 2073 6369 656e  pes` for a scien
-000030f0: 7469 6669 6320 7075 626c 6963 6174 696f  tific publicatio
-00003100: 6e2c 2079 6f75 206d 6179 2063 6974 6520  n, you may cite 
-00003110: 7468 6520 666f 6c6c 6f77 696e 6720 7061  the following pa
-00003120: 7065 723a 0a0a 426f 7374 72c3 b66d 2c20  per:..Bostr..m, 
-00003130: 482e 2c20 3230 3232 2e20 6372 6570 6573  H., 2022. crepes
-00003140: 3a20 6120 5079 7468 6f6e 2050 6163 6b61  : a Python Packa
-00003150: 6765 2066 6f72 2047 656e 6572 6174 696e  ge for Generatin
-00003160: 6720 436f 6e66 6f72 6d61 6c20 5265 6772  g Conformal Regr
-00003170: 6573 736f 7273 2061 6e64 2050 7265 6469  essors and Predi
-00003180: 6374 6976 6520 5379 7374 656d 732e 2049  ctive Systems. I
-00003190: 6e20 436f 6e66 6f72 6d61 6c20 616e 6420  n Conformal and 
-000031a0: 5072 6f62 6162 696c 6973 7469 6320 5072  Probabilistic Pr
-000031b0: 6564 6963 7469 6f6e 2061 6e64 2041 7070  ediction and App
-000031c0: 6c69 6361 7469 6f6e 732e 2050 4d4c 522c  lications. PMLR,
-000031d0: 2031 3739 2e20 5b4c 696e 6b5d 2868 7474   179. [Link](htt
-000031e0: 7073 3a2f 2f63 6f70 612d 636f 6e66 6572  ps://copa-confer
-000031f0: 656e 6365 2e63 6f6d 2f70 6170 6572 732f  ence.com/papers/
-00003200: 434f 5041 3230 3232 5f70 6170 6572 5f31  COPA2022_paper_1
-00003210: 312e 7064 6629 0a0a 4269 6274 6578 2065  1.pdf)..Bibtex e
-00003220: 6e74 7279 3a0a 0a60 6060 6269 6274 6578  ntry:..```bibtex
-00003230: 0a40 496e 5072 6f63 6565 6469 6e67 737b  .@InProceedings{
-00003240: 6372 6570 6573 2c0a 2020 7469 746c 6520  crepes,.  title 
-00003250: 3d20 0920 7b63 7265 7065 733a 2061 2050  = . {crepes: a P
-00003260: 7974 686f 6e20 5061 636b 6167 6520 666f  ython Package fo
-00003270: 7220 4765 6e65 7261 7469 6e67 2043 6f6e  r Generating Con
-00003280: 666f 726d 616c 2052 6567 7265 7373 6f72  formal Regressor
-00003290: 7320 616e 6420 5072 6564 6963 7469 7665  s and Predictive
-000032a0: 2053 7973 7465 6d73 7d2c 0a20 2061 7574   Systems},.  aut
-000032b0: 686f 7220 3d20 2020 2020 2020 7b42 6f73  hor =       {Bos
-000032c0: 7472 5c22 6f6d 2c20 4865 6e72 696b 7d2c  tr\"om, Henrik},
-000032d0: 0a20 2062 6f6f 6b74 6974 6c65 203d 2009  .  booktitle = .
-000032e0: 207b 5072 6f63 6565 6469 6e67 7320 6f66   {Proceedings of
-000032f0: 2074 6865 2045 6c65 7665 6e74 6820 5379   the Eleventh Sy
-00003300: 6d70 6f73 6975 6d20 6f6e 2043 6f6e 666f  mposium on Confo
-00003310: 726d 616c 2061 6e64 2050 726f 6261 6269  rmal and Probabi
-00003320: 6c69 7374 6963 2050 7265 6469 6374 696f  listic Predictio
-00003330: 6e20 616e 6420 4170 706c 6963 6174 696f  n and Applicatio
-00003340: 6e73 7d2c 0a20 2079 6561 7220 3d20 0920  ns},.  year = . 
-00003350: 7b32 3032 327d 2c0a 2020 6564 6974 6f72  {2022},.  editor
-00003360: 203d 2009 207b 4a6f 6861 6e73 736f 6e2c   = . {Johansson,
-00003370: 2055 6c66 2061 6e64 2042 6f73 7472 c3b6   Ulf and Bostr..
-00003380: 6d2c 2048 656e 7269 6b20 616e 6420 416e  m, Henrik and An
-00003390: 204e 6775 7965 6e2c 204b 6875 6f6e 6720   Nguyen, Khuong 
-000033a0: 616e 6420 4c75 6f2c 205a 6869 7975 616e  and Luo, Zhiyuan
-000033b0: 2061 6e64 2043 6172 6c73 736f 6e2c 204c   and Carlsson, L
-000033c0: 6172 737d 2c0a 2020 766f 6c75 6d65 203d  ars},.  volume =
-000033d0: 2009 207b 3137 397d 2c0a 2020 7365 7269   . {179},.  seri
-000033e0: 6573 203d 2009 207b 5072 6f63 6565 6469  es = . {Proceedi
-000033f0: 6e67 7320 6f66 204d 6163 6869 6e65 204c  ngs of Machine L
-00003400: 6561 726e 696e 6720 5265 7365 6172 6368  earning Research
-00003410: 7d2c 0a20 2070 7562 6c69 7368 6572 203d  },.  publisher =
-00003420: 2020 2020 7b50 4d4c 527d 0a7d 0a60 6060      {PMLR}.}.```
-00003430: 0a0a 2323 2052 6566 6572 656e 6365 730a  ..## References.
-00003440: 0a3c 6120 6964 3d22 3122 3e5b 315d 3c2f  .<a id="1">[1]</
-00003450: 613e 2056 6f76 6b2c 2056 2e2c 2047 616d  a> Vovk, V., Gam
-00003460: 6d65 726d 616e 2c20 412e 2061 6e64 2053  merman, A. and S
-00003470: 6861 6665 722c 2047 2e2c 2032 3030 352e  hafer, G., 2005.
-00003480: 2041 6c67 6f72 6974 686d 6963 206c 6561   Algorithmic lea
-00003490: 726e 696e 6720 696e 2061 2072 616e 646f  rning in a rando
-000034a0: 6d20 776f 726c 642e 2053 7072 696e 6765  m world. Springe
-000034b0: 7220 5b4c 696e 6b5d 2868 7474 7073 3a2f  r [Link](https:/
-000034c0: 2f6c 696e 6b2e 7370 7269 6e67 6572 2e63  /link.springer.c
-000034d0: 6f6d 2f62 6f6f 6b2f 3130 2e31 3030 372f  om/book/10.1007/
-000034e0: 6231 3036 3731 3529 0a0a 3c61 2069 643d  b106715)..<a id=
-000034f0: 2232 223e 5b32 5d3c 2f61 3e20 5061 7061  "2">[2]</a> Papa
-00003500: 646f 706f 756c 6f73 2c20 482e 2c20 5072  dopoulos, H., Pr
-00003510: 6f65 6472 6f75 2c20 4b2e 2c20 566f 766b  oedrou, K., Vovk
-00003520: 2c20 562e 2061 6e64 2047 616d 6d65 726d  , V. and Gammerm
-00003530: 616e 2c20 412e 2c20 3230 3032 2e20 496e  an, A., 2002. In
-00003540: 6475 6374 6976 6520 636f 6e66 6964 656e  ductive confiden
-00003550: 6365 206d 6163 6869 6e65 7320 666f 7220  ce machines for 
-00003560: 7265 6772 6573 7369 6f6e 2e20 4575 726f  regression. Euro
-00003570: 7065 616e 2043 6f6e 6665 7265 6e63 6520  pean Conference 
-00003580: 6f6e 204d 6163 6869 6e65 204c 6561 726e  on Machine Learn
-00003590: 696e 672c 2070 702e 2033 3435 2d33 3536  ing, pp. 345-356
-000035a0: 2e20 5b4c 696e 6b5d 2868 7474 7073 3a2f  . [Link](https:/
-000035b0: 2f6c 696e 6b2e 7370 7269 6e67 6572 2e63  /link.springer.c
-000035c0: 6f6d 2f63 6861 7074 6572 2f31 302e 3130  om/chapter/10.10
-000035d0: 3037 2f33 2d35 3430 2d33 3637 3535 2d31  07/3-540-36755-1
-000035e0: 5f32 3929 0a0a 3c61 2069 643d 2233 223e  _29)..<a id="3">
-000035f0: 5b33 5d3c 2f61 3e20 4a6f 6861 6e73 736f  [3]</a> Johansso
-00003600: 6e2c 2055 2e2c 2042 6f73 7472 c3b6 6d2c  n, U., Bostr..m,
-00003610: 2048 2e2c 204c c3b6 6673 7472 c3b6 6d2c   H., L..fstr..m,
-00003620: 2054 2e20 616e 6420 4c69 6e75 7373 6f6e   T. and Linusson
-00003630: 2c20 482e 2c20 3230 3134 2e20 5265 6772  , H., 2014. Regr
-00003640: 6573 7369 6f6e 2063 6f6e 666f 726d 616c  ession conformal
-00003650: 2070 7265 6469 6374 696f 6e20 7769 7468   prediction with
-00003660: 2072 616e 646f 6d20 666f 7265 7374 732e   random forests.
-00003670: 204d 6163 6869 6e65 206c 6561 726e 696e   Machine learnin
-00003680: 672c 2039 3728 312d 3229 2c20 7070 2e20  g, 97(1-2), pp. 
-00003690: 3135 352d 3137 362e 205b 4c69 6e6b 5d28  155-176. [Link](
-000036a0: 6874 7470 733a 2f2f 6c69 6e6b 2e73 7072  https://link.spr
-000036b0: 696e 6765 722e 636f 6d2f 6172 7469 636c  inger.com/articl
-000036c0: 652f 3130 2e31 3030 372f 7331 3039 3934  e/10.1007/s10994
-000036d0: 2d30 3134 2d35 3435 332d 3029 0a0a 3c61  -014-5453-0)..<a
-000036e0: 2069 643d 2234 223e 5b34 5d3c 2f61 3e20   id="4">[4]</a> 
-000036f0: 426f 7374 72c3 b66d 2c20 482e 2c20 4c69  Bostr..m, H., Li
-00003700: 6e75 7373 6f6e 2c20 482e 2c20 4cc3 b666  nusson, H., L..f
-00003710: 7374 72c3 b66d 2c20 542e 2061 6e64 204a  str..m, T. and J
-00003720: 6f68 616e 7373 6f6e 2c20 552e 2c20 3230  ohansson, U., 20
-00003730: 3137 2e20 4163 6365 6c65 7261 7469 6e67  17. Accelerating
-00003740: 2064 6966 6669 6375 6c74 7920 6573 7469   difficulty esti
-00003750: 6d61 7469 6f6e 2066 6f72 2063 6f6e 666f  mation for confo
-00003760: 726d 616c 2072 6567 7265 7373 696f 6e20  rmal regression 
-00003770: 666f 7265 7374 732e 2041 6e6e 616c 7320  forests. Annals 
-00003780: 6f66 204d 6174 6865 6d61 7469 6373 2061  of Mathematics a
-00003790: 6e64 2041 7274 6966 6963 6961 6c20 496e  nd Artificial In
-000037a0: 7465 6c6c 6967 656e 6365 2c20 3831 2831  telligence, 81(1
-000037b0: 2d32 292c 2070 702e 3132 352d 3134 342e  -2), pp.125-144.
-000037c0: 205b 4c69 6e6b 5d28 6874 7470 733a 2f2f   [Link](https://
-000037d0: 6c69 6e6b 2e73 7072 696e 6765 722e 636f  link.springer.co
-000037e0: 6d2f 6172 7469 636c 652f 3130 2e31 3030  m/article/10.100
-000037f0: 372f 7331 3034 3732 2d30 3137 2d39 3533  7/s10472-017-953
-00003800: 392d 3929 0a0a 3c61 2069 643d 2235 223e  9-9)..<a id="5">
-00003810: 5b35 5d3c 2f61 3e20 426f 7374 72c3 b66d  [5]</a> Bostr..m
-00003820: 2c20 482e 2061 6e64 204a 6f68 616e 7373  , H. and Johanss
-00003830: 6f6e 2c20 552e 2c20 3230 3230 2e20 4d6f  on, U., 2020. Mo
-00003840: 6e64 7269 616e 2063 6f6e 666f 726d 616c  ndrian conformal
-00003850: 2072 6567 7265 7373 6f72 732e 2049 6e20   regressors. In 
-00003860: 436f 6e66 6f72 6d61 6c20 616e 6420 5072  Conformal and Pr
-00003870: 6f62 6162 696c 6973 7469 6320 5072 6564  obabilistic Pred
-00003880: 6963 7469 6f6e 2061 6e64 2041 7070 6c69  iction and Appli
-00003890: 6361 7469 6f6e 732e 2050 4d4c 522c 2031  cations. PMLR, 1
-000038a0: 3238 2c20 7070 2e20 3131 342d 3133 332e  28, pp. 114-133.
-000038b0: 205b 4c69 6e6b 5d28 6874 7470 733a 2f2f   [Link](https://
-000038c0: 7072 6f63 6565 6469 6e67 732e 6d6c 722e  proceedings.mlr.
-000038d0: 7072 6573 732f 7631 3238 2f62 6f73 7472  press/v128/bostr
-000038e0: 6f6d 3230 612e 6874 6d6c 290a 0a3c 6120  om20a.html)..<a 
-000038f0: 6964 3d22 3622 3e5b 365d 3c2f 613e 2056  id="6">[6]</a> V
-00003900: 6f76 6b2c 2056 2e2c 2050 6574 656a 2c20  ovk, V., Petej, 
-00003910: 492e 2c20 4e6f 7572 6574 6469 6e6f 762c  I., Nouretdinov,
-00003920: 2049 2e2c 204d 616e 6f6b 6869 6e2c 2056   I., Manokhin, V
-00003930: 2e20 616e 6420 4761 6d6d 6572 6d61 6e2c  . and Gammerman,
-00003940: 2041 2e2c 2032 3032 302e 2043 6f6d 7075   A., 2020. Compu
-00003950: 7461 7469 6f6e 616c 6c79 2065 6666 6963  tationally effic
-00003960: 6965 6e74 2076 6572 7369 6f6e 7320 6f66  ient versions of
-00003970: 2063 6f6e 666f 726d 616c 2070 7265 6469   conformal predi
-00003980: 6374 6976 6520 6469 7374 7269 6275 7469  ctive distributi
-00003990: 6f6e 732e 204e 6575 726f 636f 6d70 7574  ons. Neurocomput
-000039a0: 696e 672c 2033 3937 2c20 7070 2e32 3932  ing, 397, pp.292
-000039b0: 2d33 3038 2e20 5b4c 696e 6b5d 2868 7474  -308. [Link](htt
-000039c0: 7073 3a2f 2f77 7777 2e61 6d69 6e65 722e  ps://www.aminer.
-000039d0: 6f72 672f 7075 622f 3565 3039 6161 6339  org/pub/5e09aac9
-000039e0: 6466 3161 3963 3063 3431 3663 3962 3730  df1a9c0c416c9b70
-000039f0: 2f63 6f6d 7075 7461 7469 6f6e 616c 6c79  /computationally
-00003a00: 2d65 6666 6963 6965 6e74 2d76 6572 7369  -efficient-versi
-00003a10: 6f6e 732d 6f66 2d63 6f6e 666f 726d 616c  ons-of-conformal
-00003a20: 2d70 7265 6469 6374 6976 652d 6469 7374  -predictive-dist
-00003a30: 7269 6275 7469 6f6e 7329 0a0a 3c61 2069  ributions)..<a i
-00003a40: 643d 2237 223e 5b37 5d3c 2f61 3e20 426f  d="7">[7]</a> Bo
-00003a50: 7374 72c3 b66d 2c20 482e 2c20 4a6f 6861  str..m, H., Joha
-00003a60: 6e73 736f 6e2c 2055 2e20 616e 6420 4cc3  nsson, U. and L.
-00003a70: b666 7374 72c3 b66d 2c20 542e 2c20 3230  .fstr..m, T., 20
-00003a80: 3231 2e20 4d6f 6e64 7269 616e 2063 6f6e  21. Mondrian con
-00003a90: 666f 726d 616c 2070 7265 6469 6374 6976  formal predictiv
-00003aa0: 6520 6469 7374 7269 6275 7469 6f6e 732e  e distributions.
-00003ab0: 2049 6e20 436f 6e66 6f72 6d61 6c20 616e   In Conformal an
-00003ac0: 6420 5072 6f62 6162 696c 6973 7469 6320  d Probabilistic 
-00003ad0: 5072 6564 6963 7469 6f6e 2061 6e64 2041  Prediction and A
-00003ae0: 7070 6c69 6361 7469 6f6e 732e 2050 4d4c  pplications. PML
-00003af0: 522c 2031 3532 2c20 7070 2e20 3234 2d33  R, 152, pp. 24-3
-00003b00: 382e 205b 4c69 6e6b 5d28 6874 7470 733a  8. [Link](https:
-00003b10: 2f2f 7072 6f63 6565 6469 6e67 732e 6d6c  //proceedings.ml
-00003b20: 722e 7072 6573 732f 7631 3532 2f62 6f73  r.press/v152/bos
-00003b30: 7472 6f6d 3231 612e 6874 6d6c 290a 0a3c  trom21a.html)..<
-00003b40: 6120 6964 3d22 3822 3e5b 385d 3c2f 613e  a id="8">[8]</a>
-00003b50: 2056 6f76 6b2c 2056 2e2c 2032 3032 322e   Vovk, V., 2022.
-00003b60: 2055 6e69 7665 7273 616c 2070 7265 6469   Universal predi
-00003b70: 6374 6976 6520 7379 7374 656d 732e 2050  ctive systems. P
-00003b80: 6174 7465 726e 2052 6563 6f67 6e69 7469  attern Recogniti
-00003b90: 6f6e 2e20 3132 363a 2070 702e 2031 3038  on. 126: pp. 108
-00003ba0: 3533 3620 5b4c 696e 6b5d 2868 7474 7073  536 [Link](https
-00003bb0: 3a2f 2f64 6c2e 6163 6d2e 6f72 672f 646f  ://dl.acm.org/do
-00003bc0: 692f 6162 732f 3130 2e31 3031 362f 6a2e  i/abs/10.1016/j.
-00003bd0: 7061 7463 6f67 2e32 3032 322e 3130 3835  patcog.2022.1085
-00003be0: 3336 290a 0a0a 2d20 2d20 2d0a 0a41 7574  36)...- - -..Aut
-00003bf0: 686f 723a 2048 656e 7269 6b20 426f 7374  hor: Henrik Bost
-00003c00: 72c3 b66d 2028 626f 7374 726f 6d68 406b  r..m (bostromh@k
-00003c10: 7468 2e73 6529 0a43 6f70 7972 6967 6874  th.se).Copyright
-00003c20: 2032 3032 3320 4865 6e72 696b 2042 6f73   2023 Henrik Bos
-00003c30: 7472 c3b6 6d0a 4c69 6365 6e73 653a 2042  tr..m.License: B
-00003c40: 5344 2033 2063 6c61 7573 650a            SD 3 clause.
+00000530: 6765 2f63 7265 7065 732f 6261 6467 6573  ge/crepes/badges
+00000540: 2f70 6c61 7466 6f72 6d73 2e73 7667 2220  /platforms.svg" 
+00000550: 616c 743d 2250 6c61 7466 6f72 6d73 2220  alt="Platforms" 
+00000560: 6865 6967 6874 3d32 3020 616c 6967 6e3d  height=20 align=
+00000570: 2263 656e 7465 7222 3e3c 2f61 3e0a 3c61  "center"></a>.<a
+00000580: 2068 7265 663d 2268 7474 7073 3a2f 2f61   href="https://a
+00000590: 6e61 636f 6e64 612e 6f72 672f 636f 6e64  naconda.org/cond
+000005a0: 612d 666f 7267 652f 6372 6570 6573 223e  a-forge/crepes">
+000005b0: 3c69 6d67 2073 7263 3d22 6874 7470 733a  <img src="https:
+000005c0: 2f2f 616e 6163 6f6e 6461 2e6f 7267 2f63  //anaconda.org/c
+000005d0: 6f6e 6461 2d66 6f72 6765 2f63 7265 7065  onda-forge/crepe
+000005e0: 732f 6261 6467 6573 2f6c 6963 656e 7365  s/badges/license
+000005f0: 2e73 7667 2220 616c 743d 224c 6963 656e  .svg" alt="Licen
+00000600: 7365 2220 6865 6967 6874 3d32 3020 616c  se" height=20 al
+00000610: 6967 6e3d 2263 656e 7465 7222 3e3c 2f61  ign="center"></a
+00000620: 3e0a 3c61 2068 7265 663d 2268 7474 7073  >.<a href="https
+00000630: 3a2f 2f61 6e61 636f 6e64 612e 6f72 672f  ://anaconda.org/
+00000640: 636f 6e64 612d 666f 7267 652f 6372 6570  conda-forge/crep
+00000650: 6573 223e 3c69 6d67 2073 7263 3d22 6874  es"><img src="ht
+00000660: 7470 733a 2f2f 616e 6163 6f6e 6461 2e6f  tps://anaconda.o
+00000670: 7267 2f63 6f6e 6461 2d66 6f72 6765 2f63  rg/conda-forge/c
+00000680: 7265 7065 732f 6261 6467 6573 2f6c 6174  repes/badges/lat
+00000690: 6573 745f 7265 6c65 6173 655f 6461 7465  est_release_date
+000006a0: 2e73 7667 2220 616c 743d 2252 656c 6561  .svg" alt="Relea
+000006b0: 7365 2064 6174 6522 2068 6569 6768 743d  se date" height=
+000006c0: 3230 2061 6c69 676e 3d22 6365 6e74 6572  20 align="center
+000006d0: 223e 3c2f 613e 0a3c 2f70 3e0a 3c62 723e  "></a>.</p>.<br>
+000006e0: 0a0a 6063 7265 7065 7360 2069 7320 6120  ..`crepes` is a 
+000006f0: 5079 7468 6f6e 2070 6163 6b61 6765 2066  Python package f
+00000700: 6f72 2067 656e 6572 6174 696e 6720 2a63  or generating *c
+00000710: 6f6e 666f 726d 616c 2072 6567 7265 7373  onformal regress
+00000720: 6f72 732a 2c20 7768 6963 6820 7472 616e  ors*, which tran
+00000730: 7366 6f72 6d20 706f 696e 7420 7072 6564  sform point pred
+00000740: 6963 7469 6f6e 7320 6f66 2061 6e79 2075  ictions of any u
+00000750: 6e64 6572 6c79 696e 6720 7265 6772 6573  nderlying regres
+00000760: 7369 6f6e 206d 6f64 656c 2069 6e74 6f20  sion model into 
+00000770: 7072 6564 6963 7469 6f6e 2069 6e74 6572  prediction inter
+00000780: 7661 6c73 2066 6f72 2073 7065 6369 6669  vals for specifi
+00000790: 6564 206c 6576 656c 7320 6f66 2063 6f6e  ed levels of con
+000007a0: 6669 6465 6e63 652e 2054 6865 2070 6163  fidence. The pac
+000007b0: 6b61 6765 2061 6c73 6f20 696d 706c 656d  kage also implem
+000007c0: 656e 7473 202a 636f 6e66 6f72 6d61 6c20  ents *conformal 
+000007d0: 7072 6564 6963 7469 7665 2073 7973 7465  predictive syste
+000007e0: 6d73 2a2c 2077 6869 6368 2074 7261 6e73  ms*, which trans
+000007f0: 666f 726d 2074 6865 2070 6f69 6e74 2070  form the point p
+00000800: 7265 6469 6374 696f 6e73 2069 6e74 6f20  redictions into 
+00000810: 6375 6d75 6c61 7469 7665 2064 6973 7472  cumulative distr
+00000820: 6962 7574 696f 6e20 6675 6e63 7469 6f6e  ibution function
+00000830: 732e 0a0a 5468 6520 6063 7265 7065 7360  s...The `crepes`
+00000840: 2070 6163 6b61 6765 2069 6d70 6c65 6d65   package impleme
+00000850: 6e74 7320 7374 616e 6461 7264 2c20 6e6f  nts standard, no
+00000860: 726d 616c 697a 6564 2061 6e64 204d 6f6e  rmalized and Mon
+00000870: 6472 6961 6e20 636f 6e66 6f72 6d61 6c20  drian conformal 
+00000880: 7265 6772 6573 736f 7273 2061 6e64 2070  regressors and p
+00000890: 7265 6469 6374 6976 6520 7379 7374 656d  redictive system
+000008a0: 732e 2057 6869 6c65 2074 6865 2070 6163  s. While the pac
+000008b0: 6b61 6765 2061 6c6c 6f77 7320 796f 7520  kage allows you 
+000008c0: 746f 2075 7365 2079 6f75 7220 6f77 6e20  to use your own 
+000008d0: 6469 6666 6963 756c 7479 2065 7374 696d  difficulty estim
+000008e0: 6174 6573 2061 6e64 204d 6f6e 6472 6961  ates and Mondria
+000008f0: 6e20 6361 7465 676f 7269 6573 2c20 7468  n categories, th
+00000900: 6572 6520 6973 2061 6c73 6f20 6120 7365  ere is also a se
+00000910: 7061 7261 7465 206d 6f64 756c 652c 2063  parate module, c
+00000920: 616c 6c65 6420 6063 7265 7065 732e 6669  alled `crepes.fi
+00000930: 6c6c 696e 6773 602c 2077 6869 6368 2070  llings`, which p
+00000940: 726f 7669 6465 7320 736f 6d65 2073 7461  rovides some sta
+00000950: 6e64 6172 6420 6f70 7469 6f6e 7320 666f  ndard options fo
+00000960: 7220 7468 6573 652e 0a0a 2323 2049 6e73  r these...## Ins
+00000970: 7461 6c6c 6174 696f 6e0a 0a46 726f 6d20  tallation..From 
+00000980: 5b50 7950 495d 2868 7474 7073 3a2f 2f70  [PyPI](https://p
+00000990: 7970 692e 6f72 672f 7072 6f6a 6563 742f  ypi.org/project/
+000009a0: 6372 6570 6573 2f29 0a0a 6060 6062 6173  crepes/)..```bas
+000009b0: 680a 7069 7020 696e 7374 616c 6c20 6372  h.pip install cr
+000009c0: 6570 6573 0a60 6060 0a0a 4672 6f6d 205b  epes.```..From [
+000009d0: 636f 6e64 612d 666f 7267 655d 2868 7474  conda-forge](htt
+000009e0: 7073 3a2f 2f61 6e61 636f 6e64 612e 6f72  ps://anaconda.or
+000009f0: 672f 636f 6e64 612d 666f 7267 652f 6372  g/conda-forge/cr
+00000a00: 6570 6573 290a 0a60 6060 6261 7368 0a63  epes)..```bash.c
+00000a10: 6f6e 6461 2069 6e73 7461 6c6c 202d 6320  onda install -c 
+00000a20: 636f 6e64 612d 666f 7267 6520 6372 6570  conda-forge crep
+00000a30: 6573 0a60 6060 0a0a 2323 2044 6f63 756d  es.```..## Docum
+00000a40: 656e 7461 7469 6f6e 0a0a 466f 7220 7468  entation..For th
+00000a50: 6520 636f 6d70 6c65 7465 2064 6f63 756d  e complete docum
+00000a60: 656e 7461 7469 6f6e 2c20 7365 6520 5b68  entation, see [h
+00000a70: 6572 655d 2868 7474 7073 3a2f 2f63 7265  ere](https://cre
+00000a80: 7065 732e 7265 6164 7468 6564 6f63 732e  pes.readthedocs.
+00000a90: 696f 2f65 6e2f 6c61 7465 7374 2f29 2e0a  io/en/latest/)..
+00000aa0: 0a23 2320 5175 6963 6b73 7461 7274 0a0a  .## Quickstart..
+00000ab0: 5765 2066 6972 7374 2069 6d70 6f72 7420  We first import 
+00000ac0: 7468 6520 636c 6173 7320 6057 7261 7060  the class `Wrap`
+00000ad0: 2066 726f 6d20 6063 7265 7065 7360 2061   from `crepes` a
+00000ae0: 6e64 2061 2068 656c 7065 7220 636c 6173  nd a helper clas
+00000af0: 7320 616e 6420 6675 6e63 7469 6f6e 2066  s and function f
+00000b00: 726f 6d20 6063 7265 7065 732e 6578 7472  rom `crepes.extr
+00000b10: 6173 603a 0a0a 6060 6070 7974 686f 6e0a  as`:..```python.
+00000b20: 6672 6f6d 2063 7265 7065 7320 696d 706f  from crepes impo
+00000b30: 7274 2057 7261 700a 6672 6f6d 2063 7265  rt Wrap.from cre
+00000b40: 7065 732e 6578 7472 6173 2069 6d70 6f72  pes.extras impor
+00000b50: 7420 4469 6666 6963 756c 7479 4573 7469  t DifficultyEsti
+00000b60: 6d61 746f 722c 2062 696e 6e69 6e67 0a60  mator, binning.`
+00000b70: 6060 0a0a 4c65 7420 7573 2061 6c73 6f20  ``..Let us also 
+00000b80: 696d 706f 7274 2073 6f6d 6520 6164 6469  import some addi
+00000b90: 7469 6f6e 616c 2066 756e 6374 696f 6e73  tional functions
+00000ba0: 2061 6e64 2061 2063 6c61 7373 2074 6f20   and a class to 
+00000bb0: 696c 6c75 7374 7261 7465 2074 6865 2061  illustrate the a
+00000bc0: 626f 7665 2075 7369 6e67 2061 2064 6174  bove using a dat
+00000bd0: 6173 6574 2066 726f 6d20 5b77 7777 2e6f  aset from [www.o
+00000be0: 7065 6e6d 6c2e 6f72 675d 2868 7474 7073  penml.org](https
+00000bf0: 3a2f 2f77 7777 2e6f 7065 6e6d 6c2e 6f72  ://www.openml.or
+00000c00: 6729 2061 6e64 2061 2060 5261 6e64 6f6d  g) and a `Random
+00000c10: 466f 7265 7374 5265 6772 6573 736f 7260  ForestRegressor`
+00000c20: 2066 726f 6d20 5b73 6b6c 6561 726e 5d28   from [sklearn](
+00000c30: 6874 7470 733a 2f2f 7363 696b 6974 2d6c  https://scikit-l
+00000c40: 6561 726e 2e6f 7267 293a 0a0a 6060 6070  earn.org):..```p
+00000c50: 7974 686f 6e0a 6672 6f6d 2073 6b6c 6561  ython.from sklea
+00000c60: 726e 2e64 6174 6173 6574 7320 696d 706f  rn.datasets impo
+00000c70: 7274 2066 6574 6368 5f6f 7065 6e6d 6c0a  rt fetch_openml.
+00000c80: 6672 6f6d 2073 6b6c 6561 726e 2e6d 6f64  from sklearn.mod
+00000c90: 656c 5f73 656c 6563 7469 6f6e 2069 6d70  el_selection imp
+00000ca0: 6f72 7420 7472 6169 6e5f 7465 7374 5f73  ort train_test_s
+00000cb0: 706c 6974 0a66 726f 6d20 736b 6c65 6172  plit.from sklear
+00000cc0: 6e2e 656e 7365 6d62 6c65 2069 6d70 6f72  n.ensemble impor
+00000cd0: 7420 5261 6e64 6f6d 466f 7265 7374 5265  t RandomForestRe
+00000ce0: 6772 6573 736f 720a 6060 600a 0a57 6520  gressor.```..We 
+00000cf0: 7769 6c6c 206e 6f77 2069 6d70 6f72 7420  will now import 
+00000d00: 616e 6420 7370 6c69 7420 7468 6520 6461  and split the da
+00000d10: 7461 7365 7420 696e 746f 2061 2074 7261  taset into a tra
+00000d20: 696e 696e 6720 616e 6420 6120 7465 7374  ining and a test
+00000d30: 2073 6574 2c20 616e 6420 7468 656e 2066   set, and then f
+00000d40: 7572 7468 6572 2073 706c 6974 2074 6865  urther split the
+00000d50: 2074 7261 696e 696e 6720 7365 7420 696e   training set in
+00000d60: 746f 2061 2070 726f 7065 7220 7472 6169  to a proper trai
+00000d70: 6e69 6e67 2073 6574 2061 6e64 2061 2063  ning set and a c
+00000d80: 616c 6962 7261 7469 6f6e 2073 6574 3a0a  alibration set:.
+00000d90: 0a60 6060 7079 7468 6f6e 0a64 6174 6173  .```python.datas
+00000da0: 6574 203d 2066 6574 6368 5f6f 7065 6e6d  et = fetch_openm
+00000db0: 6c28 6e61 6d65 3d22 686f 7573 655f 7361  l(name="house_sa
+00000dc0: 6c65 7322 2c20 7665 7273 696f 6e3d 3329  les", version=3)
+00000dd0: 0a58 203d 2064 6174 6173 6574 2e64 6174  .X = dataset.dat
+00000de0: 612e 7661 6c75 6573 2e61 7374 7970 6528  a.values.astype(
+00000df0: 666c 6f61 7429 0a79 203d 2064 6174 6173  float).y = datas
+00000e00: 6574 2e74 6172 6765 742e 7661 6c75 6573  et.target.values
+00000e10: 2e61 7374 7970 6528 666c 6f61 7429 0a0a  .astype(float)..
+00000e20: 585f 7472 6169 6e2c 2058 5f74 6573 742c  X_train, X_test,
+00000e30: 2079 5f74 7261 696e 2c20 795f 7465 7374   y_train, y_test
+00000e40: 203d 2074 7261 696e 5f74 6573 745f 7370   = train_test_sp
+00000e50: 6c69 7428 582c 2079 2c20 7465 7374 5f73  lit(X, y, test_s
+00000e60: 697a 653d 302e 3529 0a0a 585f 7072 6f70  ize=0.5)..X_prop
+00000e70: 5f74 7261 696e 2c20 585f 6361 6c2c 2079  _train, X_cal, y
+00000e80: 5f70 726f 705f 7472 6169 6e2c 2079 5f63  _prop_train, y_c
+00000e90: 616c 203d 2074 7261 696e 5f74 6573 745f  al = train_test_
+00000ea0: 7370 6c69 7428 585f 7472 6169 6e2c 2079  split(X_train, y
+00000eb0: 5f74 7261 696e 2c0a 2020 2020 2020 2020  _train,.        
+00000ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000ef0: 2020 2020 7465 7374 5f73 697a 653d 302e      test_size=0.
+00000f00: 3235 290a 6060 600a 0a4c 6574 2075 7320  25).```..Let us 
+00000f10: 6e6f 7720 2277 7261 7022 2061 2072 616e  now "wrap" a ran
+00000f20: 646f 6d20 666f 7265 7374 2072 6567 7265  dom forest regre
+00000f30: 7373 6f72 2061 6e64 2066 6974 2069 7420  ssor and fit it 
+00000f40: 2869 6e20 7468 6520 7573 7561 6c20 7761  (in the usual wa
+00000f50: 7929 2074 6f20 7468 6520 7072 6f70 6572  y) to the proper
+00000f60: 2074 7261 696e 696e 6720 7365 743a 0a0a   training set:..
+00000f70: 6060 6070 7974 686f 6e0a 7266 203d 2057  ```python.rf = W
+00000f80: 7261 7028 5261 6e64 6f6d 466f 7265 7374  rap(RandomForest
+00000f90: 5265 6772 6573 736f 7228 2929 0a72 662e  Regressor()).rf.
+00000fa0: 6669 7428 585f 7072 6f70 5f74 7261 696e  fit(X_prop_train
+00000fb0: 2c20 795f 7072 6f70 5f74 7261 696e 290a  , y_prop_train).
+00000fc0: 6060 600a 0a57 6520 6361 6e20 7573 6520  ```..We can use 
+00000fd0: 7468 6520 6669 7474 6564 206d 6f64 656c  the fitted model
+00000fe0: 2074 6f20 6f62 7461 696e 2070 6f69 6e74   to obtain point
+00000ff0: 2070 7265 6469 6374 696f 6e73 2028 6167   predictions (ag
+00001000: 6169 6e2c 2069 6e20 7468 6520 7573 7561  ain, in the usua
+00001010: 6c20 7761 7929 2066 6f72 2074 6865 2063  l way) for the c
+00001020: 616c 6962 7261 7469 6f6e 206f 626a 6563  alibration objec
+00001030: 7473 2c20 6672 6f6d 2077 6869 6368 2077  ts, from which w
+00001040: 6520 6361 6e20 6361 6c63 756c 6174 6520  e can calculate 
+00001050: 7468 6520 7265 7369 6475 616c 732e 2054  the residuals. T
+00001060: 6865 7365 2072 6573 6964 7561 6c73 2061  hese residuals a
+00001070: 7265 2065 7861 6374 6c79 2077 6861 7420  re exactly what 
+00001080: 7765 206e 6565 6420 746f 2022 6361 6c69  we need to "cali
+00001090: 6272 6174 6522 2074 6865 206c 6561 726e  brate" the learn
+000010a0: 6572 3a20 0a0a 6060 6070 7974 686f 6e0a  er: ..```python.
+000010b0: 7265 7369 6475 616c 7320 3d20 795f 6361  residuals = y_ca
+000010c0: 6c20 2d20 7266 2e70 7265 6469 6374 2858  l - rf.predict(X
+000010d0: 5f63 616c 290a 7266 2e63 616c 6962 7261  _cal).rf.calibra
+000010e0: 7465 2872 6573 6964 7561 6c73 290a 6060  te(residuals).``
+000010f0: 600a 0a41 2028 7374 616e 6461 7264 2920  `..A (standard) 
+00001100: 636f 6e66 6f72 6d61 6c20 7265 6772 6573  conformal regres
+00001110: 736f 7220 7761 7320 666f 726d 6564 2028  sor was formed (
+00001120: 756e 6465 7220 7468 6520 686f 6f64 292e  under the hood).
+00001130: 2057 6520 6d61 7920 6e6f 7720 7573 6520   We may now use 
+00001140: 6974 2066 6f72 206f 6274 6169 6e69 6e67  it for obtaining
+00001150: 2070 7265 6469 6374 696f 6e20 696e 7465   prediction inte
+00001160: 7276 616c 7320 666f 7220 7468 6520 7465  rvals for the te
+00001170: 7374 2073 6574 2c20 6865 7265 2075 7369  st set, here usi
+00001180: 6e67 2061 2063 6f6e 6669 6465 6e63 6520  ng a confidence 
+00001190: 6c65 7665 6c20 6f66 2039 3925 3a0a 0a60  level of 99%:..`
+000011a0: 6060 7079 7468 6f6e 0a72 662e 7072 6564  ``python.rf.pred
+000011b0: 6963 745f 696e 7428 585f 7465 7374 2c20  ict_int(X_test, 
+000011c0: 636f 6e66 6964 656e 6365 3d30 2e39 3929  confidence=0.99)
+000011d0: 0a60 6060 0a0a 6060 606e 756d 7079 0a61  .```..```numpy.a
+000011e0: 7272 6179 285b 5b2d 3137 3139 3032 2e32  rray([[-171902.2
+000011f0: 202c 2020 3935 3338 3636 2e32 205d 2c0a   ,  953866.2 ],.
+00001200: 2020 2020 2020 205b 2d32 3736 3831 382e         [-276818.
+00001210: 3031 2c20 2038 3438 3935 302e 3339 5d2c  01,  848950.39],
+00001220: 0a20 2020 2020 2020 5b20 2032 3236 3739  .       [  22679
+00001230: 2e33 372c 2031 3134 3834 3437 2e37 375d  .37, 1148447.77]
+00001240: 2c0a 2020 2020 2020 202e 2e2e 2c0a 2020  ,.       ...,.  
+00001250: 2020 2020 205b 2032 3432 3935 342e 3032       [ 242954.02
+00001260: 2c20 3133 3638 3732 322e 3432 5d2c 0a20  , 1368722.42],. 
+00001270: 2020 2020 2020 5b2d 3330 3830 3933 2e37        [-308093.7
+00001280: 332c 2020 3831 3736 3734 2e36 375d 2c0a  3,  817674.67],.
+00001290: 2020 2020 2020 205b 2d32 3237 3035 372e         [-227057.
+000012a0: 3420 2c20 2038 3938 3731 312e 2020 5d5d  4 ,  898711.  ]]
+000012b0: 290a 6060 600a 0a54 6865 206f 7574 7075  ).```..The outpu
+000012c0: 7420 6973 2061 205b 4e75 6d50 795d 2868  t is a [NumPy](h
+000012d0: 7474 7073 3a2f 2f6e 756d 7079 2e6f 7267  ttps://numpy.org
+000012e0: 2920 6172 7261 7920 7769 7468 2061 2072  ) array with a r
+000012f0: 6f77 2066 6f72 2065 6163 6820 7465 7374  ow for each test
+00001300: 2069 6e73 7461 6e63 652c 2061 6e64 2077   instance, and w
+00001310: 6865 7265 2074 6865 2074 776f 2063 6f6c  here the two col
+00001320: 756d 6e73 2073 7065 6369 6679 2074 6865  umns specify the
+00001330: 206c 6f77 6572 2061 6e64 2075 7070 6572   lower and upper
+00001340: 2062 6f75 6e64 206f 6620 6561 6368 2070   bound of each p
+00001350: 7265 6469 6374 696f 6e20 696e 7465 7276  rediction interv
+00001360: 616c 2e0a 0a57 6520 6d61 7920 7265 7175  al...We may requ
+00001370: 6573 7420 7468 6174 2074 6865 2069 6e74  est that the int
+00001380: 6572 7661 6c73 2061 7265 2063 7574 2074  ervals are cut t
+00001390: 6f20 6578 636c 7564 6520 696d 706f 7373  o exclude imposs
+000013a0: 6962 6c65 2076 616c 7565 732c 2069 6e20  ible values, in 
+000013b0: 7468 6973 2063 6173 6520 6265 6c6f 7720  this case below 
+000013c0: 302c 2061 6e64 2069 6620 7765 2061 6c73  0, and if we als
+000013d0: 6f20 7265 6c79 206f 6e20 7468 6520 6465  o rely on the de
+000013e0: 6661 756c 7420 636f 6e66 6964 656e 6365  fault confidence
+000013f0: 206c 6576 656c 2028 302e 3935 292c 2074   level (0.95), t
+00001400: 6865 206f 7574 7075 7420 696e 7465 7276  he output interv
+00001410: 616c 7320 7769 6c6c 2062 6520 6120 6269  als will be a bi
+00001420: 7420 7469 6768 7465 723a 0a0a 6060 6070  t tighter:..```p
+00001430: 7974 686f 6e0a 7266 2e70 7265 6469 6374  ython.rf.predict
+00001440: 5f69 6e74 2858 5f74 6573 742c 2079 5f6d  _int(X_test, y_m
+00001450: 696e 3d30 290a 6060 600a 0a60 6060 6e75  in=0).```..```nu
+00001460: 6d70 790a 6172 7261 7928 5b5b 2031 3532  mpy.array([[ 152
+00001470: 3235 382e 3535 2c20 2036 3239 3730 352e  258.55,  629705.
+00001480: 3435 5d2c 0a20 2020 2020 2020 5b20 2034  45],.       [  4
+00001490: 3733 3432 2e37 342c 2020 3532 3437 3839  7342.74,  524789
+000014a0: 2e36 345d 2c0a 2020 2020 2020 205b 2033  .64],.       [ 3
+000014b0: 3436 3834 302e 3132 2c20 2038 3234 3238  46840.12,  82428
+000014c0: 372e 3032 5d2c 0a20 2020 2020 2020 2e2e  7.02],.       ..
+000014d0: 2e2c 0a20 2020 2020 2020 5b20 3536 3731  .,.       [ 5671
+000014e0: 3134 2e37 372c 2031 3034 3435 3631 2e36  14.77, 1044561.6
+000014f0: 375d 2c0a 2020 2020 2020 205b 2020 3136  7],.       [  16
+00001500: 3036 372e 3032 2c20 2034 3933 3531 332e  067.02,  493513.
+00001510: 3932 5d2c 0a20 2020 2020 2020 5b20 2039  92],.       [  9
+00001520: 3731 3033 2e33 352c 2020 3537 3435 3530  7103.35,  574550
+00001530: 2e32 355d 5d29 0a60 6060 0a0a 5468 6520  .25]]).```..The 
+00001540: 6162 6f76 6520 696e 7465 7276 616c 7320  above intervals 
+00001550: 6172 6520 6e6f 7420 6e6f 726d 616c 697a  are not normaliz
+00001560: 6564 2c20 692e 652e 2c20 7468 6579 2061  ed, i.e., they a
+00001570: 7265 2061 6c6c 206f 6620 7468 6520 7361  re all of the sa
+00001580: 6d65 2073 697a 6520 2861 7420 6c65 6173  me size (at leas
+00001590: 7420 6265 666f 7265 2074 6865 7920 6172  t before they ar
+000015a0: 6520 6375 7429 2e20 5765 2063 6f75 6c64  e cut). We could
+000015b0: 206d 616b 6520 7468 656d 206d 6f72 6520   make them more 
+000015c0: 696e 666f 726d 6174 6976 6520 7468 726f  informative thro
+000015d0: 7567 6820 6e6f 726d 616c 697a 6174 696f  ugh normalizatio
+000015e0: 6e20 7573 696e 6720 6469 6666 6963 756c  n using difficul
+000015f0: 7479 2065 7374 696d 6174 6573 3b20 6f62  ty estimates; ob
+00001600: 6a65 6374 7320 636f 6e73 6964 6572 6564  jects considered
+00001610: 206d 6f72 6520 6469 6666 6963 756c 7420   more difficult 
+00001620: 7769 6c6c 2062 6520 6173 7369 676e 6564  will be assigned
+00001630: 2077 6964 6572 2069 6e74 6572 7661 6c73   wider intervals
+00001640: 2e0a 0a57 6520 7769 6c6c 2075 7365 2061  ...We will use a
+00001650: 2060 4469 6666 6963 756c 7479 4573 7469   `DifficultyEsti
+00001660: 6d61 746f 7260 2066 6f72 2074 6869 7320  mator` for this 
+00001670: 7075 7270 6f73 652e 2048 6572 6520 6974  purpose. Here it
+00001680: 2065 7374 696d 6174 6573 2074 6865 2064   estimates the d
+00001690: 6966 6669 6375 6c74 7920 6279 2074 6865  ifficulty by the
+000016a0: 2073 7461 6e64 6172 6420 6465 7669 6174   standard deviat
+000016b0: 696f 6e20 6f66 2074 6865 2074 6172 6765  ion of the targe
+000016c0: 7420 6f66 2074 6865 206b 2028 6465 6661  t of the k (defa
+000016d0: 756c 7420 606b 3d32 3560 2920 6e65 6172  ult `k=25`) near
+000016e0: 6573 7420 6e65 6967 6862 6f72 7320 696e  est neighbors in
+000016f0: 2074 6865 2070 726f 7065 7220 7472 6169   the proper trai
+00001700: 6e69 6e67 2073 6574 2074 6f20 6561 6368  ning set to each
+00001710: 206f 626a 6563 7420 696e 2074 6865 2063   object in the c
+00001720: 616c 6962 7261 7469 6f6e 2073 6574 2e20  alibration set. 
+00001730: 4120 736d 616c 6c20 7661 6c75 6520 2862  A small value (b
+00001740: 6574 6129 2069 7320 6164 6465 6420 746f  eta) is added to
+00001750: 2074 6865 2065 7374 696d 6174 6573 2c20   the estimates, 
+00001760: 7768 6963 6820 6d61 7920 6265 2067 6976  which may be giv
+00001770: 656e 2074 6872 6f75 6768 2061 6e20 6172  en through an ar
+00001780: 6775 6d65 6e74 2074 6f20 7468 6520 6675  gument to the fu
+00001790: 6e63 7469 6f6e 3b20 6265 6c6f 7720 7765  nction; below we
+000017a0: 206a 7573 7420 7573 6520 7468 6520 6465   just use the de
+000017b0: 6661 756c 742c 2069 2e65 2e2c 2060 6265  fault, i.e., `be
+000017c0: 7461 3d30 2e30 3160 2e0a 0a57 6520 6669  ta=0.01`...We fi
+000017d0: 7273 7420 6f62 7461 696e 2074 6865 2064  rst obtain the d
+000017e0: 6966 6669 6375 6c74 7920 6573 7469 6d61  ifficulty estima
+000017f0: 7465 7320 666f 7220 7468 6520 6361 6c69  tes for the cali
+00001800: 6272 6174 696f 6e20 7365 743a 0a0a 6060  bration set:..``
+00001810: 6070 7974 686f 6e0a 6465 203d 2044 6966  `python.de = Dif
+00001820: 6669 6375 6c74 7945 7374 696d 6174 6f72  ficultyEstimator
+00001830: 2829 0a64 652e 6669 7428 585f 7072 6f70  ().de.fit(X_prop
+00001840: 5f74 7261 696e 2c20 793d 795f 7072 6f70  _train, y=y_prop
+00001850: 5f74 7261 696e 290a 0a73 6967 6d61 735f  _train)..sigmas_
+00001860: 6361 6c20 3d20 6465 2e61 7070 6c79 2858  cal = de.apply(X
+00001870: 5f63 616c 290a 6060 600a 0a54 6865 7365  _cal).```..These
+00001880: 2063 616e 206e 6f77 2062 6520 7573 6564   can now be used
+00001890: 2066 6f72 2074 6865 2063 616c 6962 7261   for the calibra
+000018a0: 7469 6f6e 2c20 7768 6963 6820 2875 6e64  tion, which (und
+000018b0: 6572 2074 6865 2068 6f6f 6429 2077 696c  er the hood) wil
+000018c0: 6c20 7072 6f64 7563 6520 6120 6e6f 726d  l produce a norm
+000018d0: 616c 697a 6564 2063 6f6e 666f 726d 616c  alized conformal
+000018e0: 2072 6567 7265 7373 6f72 3a0a 0a60 6060   regressor:..```
+000018f0: 7079 7468 6f6e 0a72 662e 6361 6c69 6272  python.rf.calibr
+00001900: 6174 6528 7265 7369 6475 616c 732c 2073  ate(residuals, s
+00001910: 6967 6d61 733d 7369 676d 6173 5f63 616c  igmas=sigmas_cal
+00001920: 290a 6060 600a 0a57 6520 6e65 6564 2064  ).```..We need d
+00001930: 6966 6669 6375 6c74 7920 6573 7469 6d61  ifficulty estima
+00001940: 7465 7320 666f 7220 7468 6520 7465 7374  tes for the test
+00001950: 2073 6574 2074 6f6f 2c20 7768 6963 6820   set too, which 
+00001960: 7765 2070 726f 7669 6465 2061 7320 696e  we provide as in
+00001970: 7075 7420 746f 2060 7072 6564 6963 745f  put to `predict_
+00001980: 696e 7460 3a0a 6060 6070 7974 686f 6e0a  int`:.```python.
+00001990: 7369 676d 6173 5f74 6573 7420 3d20 6465  sigmas_test = de
+000019a0: 2e61 7070 6c79 2858 5f74 6573 7429 0a72  .apply(X_test).r
+000019b0: 662e 7072 6564 6963 745f 696e 7428 585f  f.predict_int(X_
+000019c0: 7465 7374 2c20 7369 676d 6173 3d73 6967  test, sigmas=sig
+000019d0: 6d61 735f 7465 7374 2c20 795f 6d69 6e3d  mas_test, y_min=
+000019e0: 3029 0a60 6060 0a0a 6060 606e 756d 7079  0).```..```numpy
+000019f0: 0a61 7272 6179 285b 5b20 3232 3637 3139  .array([[ 226719
+00001a00: 2e30 3636 3037 3937 372c 2020 3535 3532  .06607977,  5552
+00001a10: 3434 2e39 3333 3932 3032 335d 2c0a 2020  44.93392023],.  
+00001a20: 2020 2020 205b 2031 3733 3736 372e 3930       [ 173767.90
+00001a30: 3735 3337 3135 2c20 2033 3938 3336 342e  753715,  398364.
+00001a40: 3437 3234 3632 3835 5d2c 0a20 2020 2020  47246285],.     
+00001a50: 2020 5b20 3132 3436 3930 2e37 3031 3636    [ 124690.70166
+00001a60: 3936 362c 2031 3034 3634 3336 2e34 3338  966, 1046436.438
+00001a70: 3333 3033 345d 2c0a 2020 2020 2020 202e  33034],.       .
+00001a80: 2e2e 2c0a 2020 2020 2020 205b 2036 3037  ..,.       [ 607
+00001a90: 3934 392e 3731 3534 3035 3732 2c20 3130  949.71540572, 10
+00001aa0: 3033 3732 362e 3732 3435 3934 3238 5d2c  03726.72459428],
+00001ab0: 0a20 2020 2020 2020 5b20 3138 3836 3731  .       [ 188671
+00001ac0: 2e33 3735 3232 3738 202c 2020 3332 3039  .3752278 ,  3209
+00001ad0: 3039 2e35 3634 3737 3232 205d 2c0a 2020  09.5647722 ],.  
+00001ae0: 2020 2020 205b 2031 3435 3334 302e 3339       [ 145340.39
+00001af0: 3037 3638 3234 2c20 2035 3236 3331 332e  076824,  526313.
+00001b00: 3230 3932 3331 3736 5d5d 290a 6060 600a  20923176]]).```.
+00001b10: 0a44 6570 656e 6469 6e67 206f 6e20 7468  .Depending on th
+00001b20: 6520 656d 706c 6f79 6564 2064 6966 6669  e employed diffi
+00001b30: 6375 6c74 7920 6573 7469 6d61 746f 722c  culty estimator,
+00001b40: 2074 6865 206e 6f72 6d61 6c69 7a65 6420   the normalized 
+00001b50: 696e 7465 7276 616c 7320 6d61 7920 736f  intervals may so
+00001b60: 6d65 7469 6d65 7320 6265 2075 6e72 6561  metimes be unrea
+00001b70: 736f 6e61 626c 7920 6c61 7267 652c 2069  sonably large, i
+00001b80: 6e20 7468 6520 7365 6e73 6520 7468 6174  n the sense that
+00001b90: 2074 6865 7920 6d61 7920 6265 2073 6576   they may be sev
+00001ba0: 6572 616c 2074 696d 6573 206c 6172 6765  eral times large
+00001bb0: 7220 7468 616e 2061 6e79 2070 7265 7669  r than any previ
+00001bc0: 6f75 736c 7920 6f62 7365 7276 6564 2065  ously observed e
+00001bd0: 7272 6f72 2e20 4d6f 7265 6f76 6572 2c20  rror. Moreover, 
+00001be0: 6966 2074 6865 2064 6966 6669 6375 6c74  if the difficult
+00001bf0: 7920 6573 7469 6d61 746f 7220 6973 2075  y estimator is u
+00001c00: 6e69 6e66 6f72 6d61 7469 7665 2c20 652e  ninformative, e.
+00001c10: 672e 2c20 636f 6d70 6c65 7465 6c79 2072  g., completely r
+00001c20: 616e 646f 6d2c 2074 6865 2076 6172 7969  andom, the varyi
+00001c30: 6e67 2069 6e74 6572 7661 6c20 7369 7a65  ng interval size
+00001c40: 7320 6d61 7920 6769 7665 2061 2066 616c  s may give a fal
+00001c50: 7365 2069 6d70 7265 7373 696f 6e20 6f66  se impression of
+00001c60: 2074 6861 7420 7765 2063 616e 2065 7870   that we can exp
+00001c70: 6563 7420 6c6f 7765 7220 7072 6564 6963  ect lower predic
+00001c80: 7469 6f6e 2065 7272 6f72 7320 666f 7220  tion errors for 
+00001c90: 696e 7374 616e 6365 7320 7769 7468 2074  instances with t
+00001ca0: 6967 6874 6572 2069 6e74 6572 7661 6c73  ighter intervals
+00001cb0: 2e20 4964 6561 6c6c 792c 2061 2064 6966  . Ideally, a dif
+00001cc0: 6669 6375 6c74 7920 6573 7469 6d61 746f  ficulty estimato
+00001cd0: 7220 7072 6f76 6964 696e 6720 6c69 7474  r providing litt
+00001ce0: 6c65 206f 7220 6e6f 2069 6e66 6f72 6d61  le or no informa
+00001cf0: 7469 6f6e 206f 6e20 7468 6520 6578 7065  tion on the expe
+00001d00: 6374 6564 2065 7272 6f72 2073 686f 756c  cted error shoul
+00001d10: 6420 696e 7374 6561 6420 6c65 6164 2074  d instead lead t
+00001d20: 6f20 6d6f 7265 2075 6e69 666f 726d 6c79  o more uniformly
+00001d30: 2064 6973 7472 6962 7574 6564 2069 6e74   distributed int
+00001d40: 6572 7661 6c20 7369 7a65 732e 0a0a 4120  erval sizes...A 
+00001d50: 4d6f 6e64 7269 616e 2063 6f6e 666f 726d  Mondrian conform
+00001d60: 616c 2072 6567 7265 7373 6f72 2063 616e  al regressor can
+00001d70: 2062 6520 7573 6564 2074 6f20 6164 6472   be used to addr
+00001d80: 6573 7320 7468 6573 6520 7072 6f62 6c65  ess these proble
+00001d90: 6d73 2c20 6279 2064 6976 6964 696e 6720  ms, by dividing 
+00001da0: 7468 6520 6f62 6a65 6374 2073 7061 6365  the object space
+00001db0: 2069 6e74 6f20 6e6f 6e2d 6f76 6572 6c61   into non-overla
+00001dc0: 7070 696e 6720 736f 2d63 616c 6c65 6420  pping so-called 
+00001dd0: 4d6f 6e64 7269 616e 2063 6174 6567 6f72  Mondrian categor
+00001de0: 6965 732c 2061 6e64 2066 6f72 6d69 6e67  ies, and forming
+00001df0: 2061 2028 7374 616e 6461 7264 2920 636f   a (standard) co
+00001e00: 6e66 6f72 6d61 6c20 7265 6772 6573 736f  nformal regresso
+00001e10: 7220 666f 7220 6561 6368 2063 6174 6567  r for each categ
+00001e20: 6f72 792e 2054 6865 2063 6174 6567 6f72  ory. The categor
+00001e30: 7920 6d65 6d62 6572 7368 6970 206f 6620  y membership of 
+00001e40: 7468 6520 6f62 6a65 6374 7320 6361 6e20  the objects can 
+00001e50: 6265 2070 726f 7669 6465 6420 6173 2061  be provided as a
+00001e60: 6e20 6164 6469 7469 6f6e 616c 2061 7267  n additional arg
+00001e70: 756d 656e 742c 206e 616d 6564 2060 6269  ument, named `bi
+00001e80: 6e73 602c 2066 6f72 2074 6865 2060 6669  ns`, for the `fi
+00001e90: 7460 206d 6574 686f 642e 0a0a 4865 7265  t` method...Here
+00001ea0: 2077 6520 7573 6520 7468 6520 6865 6c70   we use the help
+00001eb0: 6572 2066 756e 6374 696f 6e20 6062 696e  er function `bin
+00001ec0: 6e69 6e67 6020 746f 2066 6f72 6d20 4d6f  ning` to form Mo
+00001ed0: 6e64 7269 616e 2063 6174 6567 6f72 6965  ndrian categorie
+00001ee0: 7320 6279 2065 7175 616c 2d73 697a 6564  s by equal-sized
+00001ef0: 2062 696e 6e69 6e67 206f 6620 7468 6520   binning of the 
+00001f00: 6469 6666 6963 756c 7479 2065 7374 696d  difficulty estim
+00001f10: 6174 6573 3b20 7468 6520 6675 6e63 7469  ates; the functi
+00001f20: 6f6e 2072 6574 7572 6e73 206c 6162 656c  on returns label
+00001f30: 7320 666f 7220 7468 6520 6361 6c69 6272  s for the calibr
+00001f40: 6174 696f 6e20 6f62 6a65 6374 7320 7468  ation objects th
+00001f50: 6520 7765 2070 726f 7669 6465 2061 7320  e we provide as 
+00001f60: 696e 7075 7420 746f 2074 6865 2063 616c  input to the cal
+00001f70: 6962 7261 7469 6f6e 2c20 616e 6420 7765  ibration, and we
+00001f80: 2061 6c73 6f20 6765 7420 7468 7265 7368   also get thresh
+00001f90: 6f6c 6473 2066 6f72 2074 6865 2062 696e  olds for the bin
+00001fa0: 732c 2077 6869 6368 2063 616e 2075 7365  s, which can use
+00001fb0: 206c 6174 6572 2077 6865 6e20 6269 6e6e   later when binn
+00001fc0: 696e 6720 7468 6520 7465 7374 206f 626a  ing the test obj
+00001fd0: 6563 7473 3a0a 0a60 6060 7079 7468 6f6e  ects:..```python
+00001fe0: 0a62 696e 735f 6361 6c2c 2062 696e 5f74  .bins_cal, bin_t
+00001ff0: 6872 6573 686f 6c64 7320 3d20 6269 6e6e  hresholds = binn
+00002000: 696e 6728 7369 676d 6173 5f63 616c 2c20  ing(sigmas_cal, 
+00002010: 6269 6e73 3d32 3029 0a72 662e 6361 6c69  bins=20).rf.cali
+00002020: 6272 6174 6528 7265 7369 6475 616c 732c  brate(residuals,
+00002030: 2062 696e 733d 6269 6e73 5f63 616c 290a   bins=bins_cal).
+00002040: 6060 600a 0a4c 6574 2075 7320 6e6f 7720  ```..Let us now 
+00002050: 6765 7420 7468 6520 6c61 6265 6c73 206f  get the labels o
+00002060: 6620 7468 6520 4d6f 6e64 7269 616e 2063  f the Mondrian c
+00002070: 6174 6567 6f72 6965 7320 666f 7220 7468  ategories for th
+00002080: 6520 7465 7374 206f 626a 6563 7473 2061  e test objects a
+00002090: 6e64 2075 7365 2074 6865 6d20 7768 656e  nd use them when
+000020a0: 2070 7265 6469 6374 696e 6720 696e 7465   predicting inte
+000020b0: 7276 616c 733a 0a0a 6060 6070 7974 686f  rvals:..```pytho
+000020c0: 6e0a 6269 6e73 5f74 6573 7420 3d20 6269  n.bins_test = bi
+000020d0: 6e6e 696e 6728 7369 676d 6173 5f74 6573  nning(sigmas_tes
+000020e0: 742c 2062 696e 733d 6269 6e5f 7468 7265  t, bins=bin_thre
+000020f0: 7368 6f6c 6473 290a 7266 2e70 7265 6469  sholds).rf.predi
+00002100: 6374 5f69 6e74 2858 5f74 6573 742c 2062  ct_int(X_test, b
+00002110: 696e 733d 6269 6e73 5f74 6573 742c 2079  ins=bins_test, y
+00002120: 5f6d 696e 3d30 290a 6060 600a 0a60 6060  _min=0).```..```
+00002130: 6e75 6d70 790a 6172 7261 7928 5b5b 2032  numpy.array([[ 2
+00002140: 3036 3337 392e 3720 2c20 2035 3735 3538  06379.7 ,  57558
+00002150: 342e 3320 5d2c 0a20 2020 2020 2020 5b20  4.3 ],.       [ 
+00002160: 3134 3430 3134 2e36 352c 2020 3432 3831  144014.65,  4281
+00002170: 3137 2e37 335d 2c0a 2020 2020 2020 205b  17.73],.       [
+00002180: 2020 3137 3936 352e 3537 2c20 3131 3533    17965.57, 1153
+00002190: 3136 312e 3537 5d2c 0a20 2020 2020 2020  161.57],.       
+000021a0: 2e2e 2e2c 0a20 2020 2020 2020 5b20 3635  ...,.       [ 65
+000021b0: 3338 3635 2e32 322c 2020 3935 3738 3131  3865.22,  957811
+000021c0: 2e32 325d 2c0a 2020 2020 2020 205b 2031  .22],.       [ 1
+000021d0: 3734 3236 342e 3837 2c20 2033 3335 3331  74264.87,  33531
+000021e0: 362e 3037 5d2c 0a20 2020 2020 2020 5b20  6.07],.       [ 
+000021f0: 3134 3035 3837 2e34 362c 2020 3533 3130  140587.46,  5310
+00002200: 3636 2e31 345d 5d29 0a60 6060 0a0a 5765  66.14]]).```..We
+00002210: 2063 6f75 6c64 2076 6572 7920 6561 7369   could very easi
+00002220: 6c79 2073 7769 7463 6820 6672 6f6d 2063  ly switch from c
+00002230: 6f6e 666f 726d 616c 2072 6567 7265 7373  onformal regress
+00002240: 6f72 7320 746f 2063 6f6e 666f 726d 616c  ors to conformal
+00002250: 2070 7265 6469 6374 6976 6520 7379 7374   predictive syst
+00002260: 656d 732e 2054 6865 206c 6174 7465 7220  ems. The latter 
+00002270: 7072 6f64 7563 6520 6375 6d75 6c61 7469  produce cumulati
+00002280: 7665 2064 6973 7472 6962 7574 696f 6e20  ve distribution 
+00002290: 6675 6e63 7469 6f6e 7320 2863 6f6e 666f  functions (confo
+000022a0: 726d 616c 2070 7265 6469 6374 6976 6520  rmal predictive 
+000022b0: 6469 7374 7269 6275 7469 6f6e 7329 2e20  distributions). 
+000022c0: 4672 6f6d 2074 6865 7365 2077 6520 6361  From these we ca
+000022d0: 6e20 6765 6e65 7261 7465 2070 7265 6469  n generate predi
+000022e0: 6374 696f 6e20 696e 7465 7276 616c 732c  ction intervals,
+000022f0: 2062 7574 2077 6520 6361 6e20 616c 736f   but we can also
+00002300: 206f 6274 6169 6e20 7065 7263 656e 7469   obtain percenti
+00002310: 6c65 732c 2063 616c 6962 7261 7465 6420  les, calibrated 
+00002320: 706f 696e 7420 7072 6564 6963 7469 6f6e  point prediction
+00002330: 732c 2061 7320 7765 6c6c 2061 7320 702d  s, as well as p-
+00002340: 7661 6c75 6573 2066 6f72 2067 6976 656e  values for given
+00002350: 2074 6172 6765 7420 7661 6c75 6573 2e20   target values. 
+00002360: 4c65 7420 7573 2073 6565 2068 6f77 2077  Let us see how w
+00002370: 6520 6361 6e20 676f 2061 6865 6164 2074  e can go ahead t
+00002380: 6f20 646f 2074 6861 742e 0a0a 5765 6c6c  o do that...Well
+00002390: 2c20 7468 6572 6520 6973 206f 6e6c 7920  , there is only 
+000023a0: 6f6e 6520 7468 696e 6720 6162 6f76 6520  one thing above 
+000023b0: 7468 6174 2063 6861 6e67 6573 3a20 6a75  that changes: ju
+000023c0: 7374 2070 726f 7669 6465 2060 6370 733d  st provide `cps=
+000023d0: 5472 7565 6020 746f 2074 6865 2060 6361  True` to the `ca
+000023e0: 6c69 6272 6174 6560 206d 6574 686f 642e  librate` method.
+000023f0: 0a0a 5765 2063 616e 2c20 666f 7220 6578  ..We can, for ex
+00002400: 616d 706c 652c 2066 6f72 6d20 6e6f 726d  ample, form norm
+00002410: 616c 697a 6564 204d 6f6e 6472 6961 6e20  alized Mondrian 
+00002420: 636f 6e66 6f72 6d61 6c20 7072 6564 6963  conformal predic
+00002430: 7469 7665 2073 7973 7465 6d73 2c20 6279  tive systems, by
+00002440: 2070 726f 7669 6469 6e67 2062 6f74 6820   providing both 
+00002450: 6062 696e 7360 2061 6e64 2060 7369 676d  `bins` and `sigm
+00002460: 6173 6020 746f 2074 6865 2060 6361 6c69  as` to the `cali
+00002470: 6272 6174 6560 206d 6574 686f 642e 2048  brate` method. H
+00002480: 6572 6520 7765 2077 696c 6c20 636f 6e73  ere we will cons
+00002490: 6964 6572 204d 6f6e 6472 6961 6e20 6361  ider Mondrian ca
+000024a0: 7465 676f 7269 6573 2066 6f72 6d65 6420  tegories formed 
+000024b0: 6672 6f6d 2062 696e 6e69 6e67 2074 6865  from binning the
+000024c0: 2070 6f69 6e74 2070 7265 6469 6374 696f   point predictio
+000024d0: 6e73 3a0a 0a60 6060 7079 7468 6f6e 0a62  ns:..```python.b
+000024e0: 696e 735f 6361 6c2c 2062 696e 5f74 6872  ins_cal, bin_thr
+000024f0: 6573 686f 6c64 7320 3d20 6269 6e6e 696e  esholds = binnin
+00002500: 6728 7266 2e70 7265 6469 6374 2858 5f63  g(rf.predict(X_c
+00002510: 616c 292c 2062 696e 733d 3529 0a72 662e  al), bins=5).rf.
+00002520: 6361 6c69 6272 6174 6528 7265 7369 6475  calibrate(residu
+00002530: 616c 732c 2073 6967 6d61 733d 7369 676d  als, sigmas=sigm
+00002540: 6173 5f63 616c 2c20 6269 6e73 3d62 696e  as_cal, bins=bin
+00002550: 735f 6361 6c2c 2063 7073 3d54 7275 6529  s_cal, cps=True)
+00002560: 0a60 6060 0a0a 4279 2070 726f 7669 6469  .```..By providi
+00002570: 6e67 2074 6865 2062 696e 7320 2861 6e64  ng the bins (and
+00002580: 2073 6967 6d61 7329 2066 6f72 2074 6865   sigmas) for the
+00002590: 2074 6573 7420 6f62 6a65 6374 732c 2077   test objects, w
+000025a0: 6520 6361 6e20 6e6f 7720 6d61 6b65 2070  e can now make p
+000025b0: 7265 6469 6374 696f 6e73 2077 6974 6820  redictions with 
+000025c0: 7468 6520 636f 6e66 6f72 6d61 6c20 7072  the conformal pr
+000025d0: 6564 6963 7469 7665 2073 7973 7465 6d2c  edictive system,
+000025e0: 2074 6872 6f75 6768 2074 6865 206d 6574   through the met
+000025f0: 686f 6420 6070 7265 6469 6374 5f63 7073  hod `predict_cps
+00002600: 602e 0a54 6865 206f 7574 7075 7420 6f66  `..The output of
+00002610: 2074 6869 7320 6d65 7468 6f64 2063 616e   this method can
+00002620: 2062 6520 636f 6e74 726f 6c6c 6564 2071   be controlled q
+00002630: 7569 7465 2066 6c65 7869 626c 793b 2068  uite flexibly; h
+00002640: 6572 6520 7765 2072 6571 7565 7374 2070  ere we request p
+00002650: 7265 6469 6374 696f 6e20 696e 7465 7276  rediction interv
+00002660: 616c 7320 7769 7468 2039 3525 2063 6f6e  als with 95% con
+00002670: 6669 6465 6e63 6520 746f 2062 6520 6f75  fidence to be ou
+00002680: 7470 7574 3a0a 0a60 6060 7079 7468 6f6e  tput:..```python
+00002690: 0a62 696e 735f 7465 7374 203d 2062 696e  .bins_test = bin
+000026a0: 6e69 6e67 2872 662e 7072 6564 6963 7428  ning(rf.predict(
+000026b0: 585f 7465 7374 292c 2062 696e 733d 6269  X_test), bins=bi
+000026c0: 6e5f 7468 7265 7368 6f6c 6473 290a 7266  n_thresholds).rf
+000026d0: 2e70 7265 6469 6374 5f63 7073 2858 5f74  .predict_cps(X_t
+000026e0: 6573 742c 2073 6967 6d61 733d 7369 676d  est, sigmas=sigm
+000026f0: 6173 5f74 6573 742c 2062 696e 733d 6269  as_test, bins=bi
+00002700: 6e73 5f74 6573 742c 0a20 2020 2020 2020  ns_test,.       
+00002710: 2020 2020 2020 2020 6c6f 7765 725f 7065          lower_pe
+00002720: 7263 656e 7469 6c65 733d 322e 352c 2068  rcentiles=2.5, h
+00002730: 6967 6865 725f 7065 7263 656e 7469 6c65  igher_percentile
+00002740: 733d 3937 2e35 2c20 795f 6d69 6e3d 3029  s=97.5, y_min=0)
+00002750: 0a60 6060 0a0a 6060 606e 756d 7079 0a61  .```..```numpy.a
+00002760: 7272 6179 285b 5b20 3234 3538 3236 2e33  rray([[ 245826.3
+00002770: 3432 3236 3933 202c 2020 3531 3733 3135  422693 ,  517315
+00002780: 2e38 3336 3138 3938 355d 2c0a 2020 2020  .83618985],.    
+00002790: 2020 205b 2031 3435 3334 382e 3033 3431     [ 145348.0341
+000027a0: 3538 3438 2c20 2033 3932 3936 382e 3135  5848,  392968.15
+000027b0: 3538 3739 3937 5d2c 0a20 2020 2020 2020  587997],.       
+000027c0: 5b20 3134 3837 3734 2e36 3534 3631 3231  [ 148774.6546121
+000027d0: 322c 2031 3033 3433 3030 2e38 3431 3935  2, 1034300.84195
+000027e0: 3937 365d 2c0a 2020 2020 2020 202e 2e2e  976],.       ...
+000027f0: 2c0a 2020 2020 2020 205b 2035 3839 3230  ,.       [ 58920
+00002800: 302e 3537 3235 3935 3720 2c20 3130 3537  0.5725957 , 1057
+00002810: 3031 332e 3839 3130 3230 3037 5d2c 0a20  013.89102007],. 
+00002820: 2020 2020 2020 5b20 3137 3139 3338 2e32        [ 171938.2
+00002830: 3933 3832 3935 322c 2020 3331 3737 3332  9382952,  317732
+00002840: 2e33 3136 3131 3134 315d 2c0a 2020 2020  .31611141],.    
+00002850: 2020 205b 2031 3637 3439 382e 3031 3534     [ 167498.0154
+00002860: 3035 3034 2c20 2034 3832 3332 382e 3938  0504,  482328.98
+00002870: 3535 3236 3332 5d5d 290a 6060 600a 0a49  552632]]).```..I
+00002880: 6620 7765 2077 6f75 6c64 206c 696b 6520  f we would like 
+00002890: 746f 2074 616b 6520 6120 6c6f 6f6b 2061  to take a look a
+000028a0: 7420 7468 6520 702d 7661 6c75 6573 2066  t the p-values f
+000028b0: 6f72 2074 6865 2074 7275 6520 7461 7267  or the true targ
+000028c0: 6574 7320 2874 6865 7365 2073 686f 756c  ets (these shoul
+000028d0: 6420 6265 2075 6e69 666f 726d 6c79 2064  d be uniformly d
+000028e0: 6973 7472 6962 7574 6564 292c 2077 6520  istributed), we 
+000028f0: 6361 6e20 646f 2074 6865 2066 6f6c 6c6f  can do the follo
+00002900: 7769 6e67 3a0a 0a60 6060 7079 7468 6f6e  wing:..```python
+00002910: 0a72 662e 7072 6564 6963 745f 6370 7328  .rf.predict_cps(
+00002920: 585f 7465 7374 2c20 7369 676d 6173 3d73  X_test, sigmas=s
+00002930: 6967 6d61 735f 7465 7374 2c20 6269 6e73  igmas_test, bins
+00002940: 3d62 696e 735f 7465 7374 2c20 793d 795f  =bins_test, y=y_
+00002950: 7465 7374 290a 6060 600a 0a60 6060 6e75  test).```..```nu
+00002960: 6d70 790a 6172 7261 7928 5b30 2e39 3836  mpy.array([0.986
+00002970: 3033 3631 342c 2030 2e38 3731 3738 3235  03614, 0.8717825
+00002980: 362c 2030 2e34 3432 3031 3938 342c 202e  6, 0.44201984, .
+00002990: 2e2e 2c20 302e 3035 3638 3838 3034 2c20  .., 0.05688804, 
+000029a0: 302e 3039 3437 3336 3034 2c0a 2020 2020  0.09473604,.    
+000029b0: 2020 2030 2e33 3130 3639 3931 335d 290a     0.31069913]).
+000029c0: 6060 600a 0a57 6520 6d61 7920 7265 7175  ```..We may requ
+000029d0: 6573 7420 7468 6174 2074 6865 2060 7072  est that the `pr
+000029e0: 6564 6963 745f 6370 7360 206d 6574 686f  edict_cps` metho
+000029f0: 6420 7265 7475 726e 7320 7468 6520 6675  d returns the fu
+00002a00: 6c6c 2063 6f6e 666f 726d 616c 2070 7265  ll conformal pre
+00002a10: 6469 6374 6976 6520 6469 7374 7269 6275  dictive distribu
+00002a20: 7469 6f6e 2028 4350 4429 2066 6f72 2065  tion (CPD) for e
+00002a30: 6163 6820 7465 7374 2069 6e73 7461 6e63  ach test instanc
+00002a40: 652c 2061 7320 6465 6669 6e65 6420 6279  e, as defined by
+00002a50: 2074 6865 2074 6872 6573 686f 6c64 2076   the threshold v
+00002a60: 616c 7565 732c 2062 7920 7365 7474 696e  alues, by settin
+00002a70: 6720 6072 6574 7572 6e5f 6370 6473 3d54  g `return_cpds=T
+00002a80: 7275 6560 2e20 5468 6520 666f 726d 6174  rue`. The format
+00002a90: 206f 6620 7468 6520 6469 7374 7269 6275   of the distribu
+00002aa0: 7469 6f6e 7320 7661 7279 2077 6974 6820  tions vary with 
+00002ab0: 7468 6520 7479 7065 206f 6620 636f 6e66  the type of conf
+00002ac0: 6f72 6d61 6c20 7072 6564 6963 7469 7665  ormal predictive
+00002ad0: 2073 7973 7465 6d3b 2066 6f72 2061 2073   system; for a s
+00002ae0: 7461 6e64 6172 6420 616e 6420 6e6f 726d  tandard and norm
+00002af0: 616c 697a 6564 2043 5053 2c20 7468 6520  alized CPS, the 
+00002b00: 6f75 7470 7574 2069 7320 616e 2061 7272  output is an arr
+00002b10: 6179 2077 6974 6820 6120 726f 7720 666f  ay with a row fo
+00002b20: 7220 6561 6368 2074 6573 7420 696e 7374  r each test inst
+00002b30: 616e 6365 2061 6e64 2061 2063 6f6c 756d  ance and a colum
+00002b40: 6e20 666f 7220 6561 6368 2063 616c 6962  n for each calib
+00002b50: 7261 7469 6f6e 2069 6e73 7461 6e63 6520  ration instance 
+00002b60: 2872 6573 6964 7561 6c29 2c20 7768 696c  (residual), whil
+00002b70: 6520 666f 7220 6120 4d6f 6e64 7269 616e  e for a Mondrian
+00002b80: 2043 5053 2c20 7468 6520 6465 6661 756c   CPS, the defaul
+00002b90: 7420 6f75 7470 7574 2069 7320 6120 7665  t output is a ve
+00002ba0: 6374 6f72 2063 6f6e 7461 696e 696e 6720  ctor containing 
+00002bb0: 6f6e 6520 4350 4420 7065 7220 7465 7374  one CPD per test
+00002bc0: 2069 6e73 7461 6e63 652c 2073 696e 6365   instance, since
+00002bd0: 2074 6865 206e 756d 6265 7220 6f66 2076   the number of v
+00002be0: 616c 7565 7320 6d61 7920 7661 7279 2062  alues may vary b
+00002bf0: 6574 7765 656e 2063 6174 6567 6f72 6965  etween categorie
+00002c00: 732e 0a0a 6060 6070 7974 686f 6e0a 7266  s...```python.rf
+00002c10: 2e70 7265 6469 6374 5f63 7073 2858 5f74  .predict_cps(X_t
+00002c20: 6573 742c 2073 6967 6d61 733d 7369 676d  est, sigmas=sigm
+00002c30: 6173 5f74 6573 742c 2062 696e 733d 6269  as_test, bins=bi
+00002c40: 6e73 5f74 6573 742c 2072 6574 7572 6e5f  ns_test, return_
+00002c50: 6370 6473 3d54 7275 6529 0a60 6060 0a0a  cpds=True).```..
+00002c60: 5468 6520 7265 7375 6c74 696e 6720 7665  The resulting ve
+00002c70: 6374 6f72 206f 6620 6172 7261 7973 2069  ctor of arrays i
+00002c80: 7320 6e6f 7420 6469 7370 6c61 7965 6420  s not displayed 
+00002c90: 6865 7265 2c20 6275 7420 7765 2069 6e73  here, but we ins
+00002ca0: 7465 6164 2070 726f 7669 6465 2061 2070  tead provide a p
+00002cb0: 6c6f 7420 666f 7220 7468 6520 4350 4420  lot for the CPD 
+00002cc0: 6f66 2061 2072 616e 646f 6d20 7465 7374  of a random test
+00002cd0: 2069 6e73 7461 6e63 653a 0a0a 215b 6370   instance:..![cp
+00002ce0: 645d 2868 7474 7073 3a2f 2f75 7365 722d  d](https://user-
+00002cf0: 696d 6167 6573 2e67 6974 6875 6275 7365  images.githubuse
+00002d00: 7263 6f6e 7465 6e74 2e63 6f6d 2f37 3833  rcontent.com/783
+00002d10: 3837 3431 2f32 3335 3038 3139 3639 2d33  8741/235081969-3
+00002d20: 3238 6437 6132 332d 3236 6339 2d34 3739  28d7a23-26c9-479
+00002d30: 392d 6132 3436 2d38 6333 3566 6437 6163  9-a246-8c35fd7ac
+00002d40: 3838 652e 706e 6729 0a0a 2323 2045 7861  88e.png)..## Exa
+00002d50: 6d70 6c65 730a 0a46 6f72 2061 6464 6974  mples..For addit
+00002d60: 696f 6e61 6c20 6578 616d 706c 6573 206f  ional examples o
+00002d70: 6620 686f 7720 746f 2075 7365 2074 6865  f how to use the
+00002d80: 2070 6163 6b61 6765 2061 6e64 206d 6f64   package and mod
+00002d90: 756c 652c 2069 6e63 6c75 6469 6e67 2068  ule, including h
+00002da0: 6f77 2074 6f20 7573 6520 6f75 742d 6f66  ow to use out-of
+00002db0: 2d62 6167 2070 7265 6469 6374 696f 6e73  -bag predictions
+00002dc0: 2072 6174 6865 7220 7468 616e 2068 6176   rather than hav
+00002dd0: 696e 6720 746f 2072 656c 7920 6f6e 2064  ing to rely on d
+00002de0: 6976 6964 696e 6720 7468 6520 7472 6169  ividing the trai
+00002df0: 6e69 6e67 2073 6574 2069 6e74 6f20 6120  ning set into a 
+00002e00: 7072 6f70 6572 2074 7261 696e 696e 6720  proper training 
+00002e10: 616e 6420 6361 6c69 6272 6174 696f 6e20  and calibration 
+00002e20: 7365 742c 2073 6565 205b 7468 6520 646f  set, see [the do
+00002e30: 6375 6d65 6e74 6174 696f 6e5d 2868 7474  cumentation](htt
+00002e40: 7073 3a2f 2f63 7265 7065 732e 7265 6164  ps://crepes.read
+00002e50: 7468 6564 6f63 732e 696f 2f65 6e2f 6c61  thedocs.io/en/la
+00002e60: 7465 7374 2f29 2c20 5b74 6869 7320 4a75  test/), [this Ju
+00002e70: 7079 7465 7220 6e6f 7465 626f 6f6b 2075  pyter notebook u
+00002e80: 7369 6e67 2057 7261 705d 2868 7474 7073  sing Wrap](https
+00002e90: 3a2f 2f67 6974 6875 622e 636f 6d2f 6865  ://github.com/he
+00002ea0: 6e72 696b 626f 7374 726f 6d2f 6372 6570  nrikbostrom/crep
+00002eb0: 6573 2f62 6c6f 622f 6d61 696e 2f64 6f63  es/blob/main/doc
+00002ec0: 732f 6372 6570 6573 5f6e 625f 7772 6170  s/crepes_nb_wrap
+00002ed0: 2e69 7079 6e62 292c 2061 6e64 205b 7468  .ipynb), and [th
+00002ee0: 6973 204a 7570 7974 6572 206e 6f74 6562  is Jupyter noteb
+00002ef0: 6f6f 6b20 7573 696e 6720 436f 6e66 6f72  ook using Confor
+00002f00: 6d61 6c52 6567 7265 7373 6f72 2061 6e64  malRegressor and
+00002f10: 2043 6f6e 666f 726d 616c 5072 6564 6963   ConformalPredic
+00002f20: 7469 7665 5379 7374 656d 5d28 6874 7470  tiveSystem](http
+00002f30: 733a 2f2f 6769 7468 7562 2e63 6f6d 2f68  s://github.com/h
+00002f40: 656e 7269 6b62 6f73 7472 6f6d 2f63 7265  enrikbostrom/cre
+00002f50: 7065 732f 626c 6f62 2f6d 6169 6e2f 646f  pes/blob/main/do
+00002f60: 6373 2f63 7265 7065 735f 6e62 2e69 7079  cs/crepes_nb.ipy
+00002f70: 6e62 292e 0a0a 2323 2043 6974 696e 6720  nb)...## Citing 
+00002f80: 6372 6570 6573 0a0a 4966 2079 6f75 2075  crepes..If you u
+00002f90: 7365 2060 6372 6570 6573 6020 666f 7220  se `crepes` for 
+00002fa0: 6120 7363 6965 6e74 6966 6963 2070 7562  a scientific pub
+00002fb0: 6c69 6361 7469 6f6e 2c20 796f 7520 6d61  lication, you ma
+00002fc0: 7920 6369 7465 2074 6865 2066 6f6c 6c6f  y cite the follo
+00002fd0: 7769 6e67 2070 6170 6572 3a0a 0a42 6f73  wing paper:..Bos
+00002fe0: 7472 c3b6 6d2c 2048 2e2c 2032 3032 322e  tr..m, H., 2022.
+00002ff0: 2063 7265 7065 733a 2061 2050 7974 686f   crepes: a Pytho
+00003000: 6e20 5061 636b 6167 6520 666f 7220 4765  n Package for Ge
+00003010: 6e65 7261 7469 6e67 2043 6f6e 666f 726d  nerating Conform
+00003020: 616c 2052 6567 7265 7373 6f72 7320 616e  al Regressors an
+00003030: 6420 5072 6564 6963 7469 7665 2053 7973  d Predictive Sys
+00003040: 7465 6d73 2e20 496e 2043 6f6e 666f 726d  tems. In Conform
+00003050: 616c 2061 6e64 2050 726f 6261 6269 6c69  al and Probabili
+00003060: 7374 6963 2050 7265 6469 6374 696f 6e20  stic Prediction 
+00003070: 616e 6420 4170 706c 6963 6174 696f 6e73  and Applications
+00003080: 2e20 504d 4c52 2c20 3137 392e 205b 4c69  . PMLR, 179. [Li
+00003090: 6e6b 5d28 6874 7470 733a 2f2f 636f 7061  nk](https://copa
+000030a0: 2d63 6f6e 6665 7265 6e63 652e 636f 6d2f  -conference.com/
+000030b0: 7061 7065 7273 2f43 4f50 4132 3032 325f  papers/COPA2022_
+000030c0: 7061 7065 725f 3131 2e70 6466 290a 0a42  paper_11.pdf)..B
+000030d0: 6962 7465 7820 656e 7472 793a 0a0a 6060  ibtex entry:..``
+000030e0: 6062 6962 7465 780a 4049 6e50 726f 6365  `bibtex.@InProce
+000030f0: 6564 696e 6773 7b63 7265 7065 732c 0a20  edings{crepes,. 
+00003100: 2074 6974 6c65 203d 2009 207b 6372 6570   title = . {crep
+00003110: 6573 3a20 6120 5079 7468 6f6e 2050 6163  es: a Python Pac
+00003120: 6b61 6765 2066 6f72 2047 656e 6572 6174  kage for Generat
+00003130: 696e 6720 436f 6e66 6f72 6d61 6c20 5265  ing Conformal Re
+00003140: 6772 6573 736f 7273 2061 6e64 2050 7265  gressors and Pre
+00003150: 6469 6374 6976 6520 5379 7374 656d 737d  dictive Systems}
+00003160: 2c0a 2020 6175 7468 6f72 203d 2020 2020  ,.  author =    
+00003170: 2020 207b 426f 7374 725c 226f 6d2c 2048     {Bostr\"om, H
+00003180: 656e 7269 6b7d 2c0a 2020 626f 6f6b 7469  enrik},.  bookti
+00003190: 746c 6520 3d20 0920 7b50 726f 6365 6564  tle = . {Proceed
+000031a0: 696e 6773 206f 6620 7468 6520 456c 6576  ings of the Elev
+000031b0: 656e 7468 2053 796d 706f 7369 756d 206f  enth Symposium o
+000031c0: 6e20 436f 6e66 6f72 6d61 6c20 616e 6420  n Conformal and 
+000031d0: 5072 6f62 6162 696c 6973 7469 6320 5072  Probabilistic Pr
+000031e0: 6564 6963 7469 6f6e 2061 6e64 2041 7070  ediction and App
+000031f0: 6c69 6361 7469 6f6e 737d 2c0a 2020 7965  lications},.  ye
+00003200: 6172 203d 2009 207b 3230 3232 7d2c 0a20  ar = . {2022},. 
+00003210: 2065 6469 746f 7220 3d20 0920 7b4a 6f68   editor = . {Joh
+00003220: 616e 7373 6f6e 2c20 556c 6620 616e 6420  ansson, Ulf and 
+00003230: 426f 7374 72c3 b66d 2c20 4865 6e72 696b  Bostr..m, Henrik
+00003240: 2061 6e64 2041 6e20 4e67 7579 656e 2c20   and An Nguyen, 
+00003250: 4b68 756f 6e67 2061 6e64 204c 756f 2c20  Khuong and Luo, 
+00003260: 5a68 6979 7561 6e20 616e 6420 4361 726c  Zhiyuan and Carl
+00003270: 7373 6f6e 2c20 4c61 7273 7d2c 0a20 2076  sson, Lars},.  v
+00003280: 6f6c 756d 6520 3d20 0920 7b31 3739 7d2c  olume = . {179},
+00003290: 0a20 2073 6572 6965 7320 3d20 0920 7b50  .  series = . {P
+000032a0: 726f 6365 6564 696e 6773 206f 6620 4d61  roceedings of Ma
+000032b0: 6368 696e 6520 4c65 6172 6e69 6e67 2052  chine Learning R
+000032c0: 6573 6561 7263 687d 2c0a 2020 7075 626c  esearch},.  publ
+000032d0: 6973 6865 7220 3d20 2020 207b 504d 4c52  isher =    {PMLR
+000032e0: 7d0a 7d0a 6060 600a 0a23 2320 5265 6665  }.}.```..## Refe
+000032f0: 7265 6e63 6573 0a0a 3c61 2069 643d 2231  rences..<a id="1
+00003300: 223e 5b31 5d3c 2f61 3e20 566f 766b 2c20  ">[1]</a> Vovk, 
+00003310: 562e 2c20 4761 6d6d 6572 6d61 6e2c 2041  V., Gammerman, A
+00003320: 2e20 616e 6420 5368 6166 6572 2c20 472e  . and Shafer, G.
+00003330: 2c20 3230 3035 2e20 416c 676f 7269 7468  , 2005. Algorith
+00003340: 6d69 6320 6c65 6172 6e69 6e67 2069 6e20  mic learning in 
+00003350: 6120 7261 6e64 6f6d 2077 6f72 6c64 2e20  a random world. 
+00003360: 5370 7269 6e67 6572 205b 4c69 6e6b 5d28  Springer [Link](
+00003370: 6874 7470 733a 2f2f 6c69 6e6b 2e73 7072  https://link.spr
+00003380: 696e 6765 722e 636f 6d2f 626f 6f6b 2f31  inger.com/book/1
+00003390: 302e 3130 3037 2f62 3130 3637 3135 290a  0.1007/b106715).
+000033a0: 0a3c 6120 6964 3d22 3222 3e5b 325d 3c2f  .<a id="2">[2]</
+000033b0: 613e 2050 6170 6164 6f70 6f75 6c6f 732c  a> Papadopoulos,
+000033c0: 2048 2e2c 2050 726f 6564 726f 752c 204b   H., Proedrou, K
+000033d0: 2e2c 2056 6f76 6b2c 2056 2e20 616e 6420  ., Vovk, V. and 
+000033e0: 4761 6d6d 6572 6d61 6e2c 2041 2e2c 2032  Gammerman, A., 2
+000033f0: 3030 322e 2049 6e64 7563 7469 7665 2063  002. Inductive c
+00003400: 6f6e 6669 6465 6e63 6520 6d61 6368 696e  onfidence machin
+00003410: 6573 2066 6f72 2072 6567 7265 7373 696f  es for regressio
+00003420: 6e2e 2045 7572 6f70 6561 6e20 436f 6e66  n. European Conf
+00003430: 6572 656e 6365 206f 6e20 4d61 6368 696e  erence on Machin
+00003440: 6520 4c65 6172 6e69 6e67 2c20 7070 2e20  e Learning, pp. 
+00003450: 3334 352d 3335 362e 205b 4c69 6e6b 5d28  345-356. [Link](
+00003460: 6874 7470 733a 2f2f 6c69 6e6b 2e73 7072  https://link.spr
+00003470: 696e 6765 722e 636f 6d2f 6368 6170 7465  inger.com/chapte
+00003480: 722f 3130 2e31 3030 372f 332d 3534 302d  r/10.1007/3-540-
+00003490: 3336 3735 352d 315f 3239 290a 0a3c 6120  36755-1_29)..<a 
+000034a0: 6964 3d22 3322 3e5b 335d 3c2f 613e 204a  id="3">[3]</a> J
+000034b0: 6f68 616e 7373 6f6e 2c20 552e 2c20 426f  ohansson, U., Bo
+000034c0: 7374 72c3 b66d 2c20 482e 2c20 4cc3 b666  str..m, H., L..f
+000034d0: 7374 72c3 b66d 2c20 542e 2061 6e64 204c  str..m, T. and L
+000034e0: 696e 7573 736f 6e2c 2048 2e2c 2032 3031  inusson, H., 201
+000034f0: 342e 2052 6567 7265 7373 696f 6e20 636f  4. Regression co
+00003500: 6e66 6f72 6d61 6c20 7072 6564 6963 7469  nformal predicti
+00003510: 6f6e 2077 6974 6820 7261 6e64 6f6d 2066  on with random f
+00003520: 6f72 6573 7473 2e20 4d61 6368 696e 6520  orests. Machine 
+00003530: 6c65 6172 6e69 6e67 2c20 3937 2831 2d32  learning, 97(1-2
+00003540: 292c 2070 702e 2031 3535 2d31 3736 2e20  ), pp. 155-176. 
+00003550: 5b4c 696e 6b5d 2868 7474 7073 3a2f 2f6c  [Link](https://l
+00003560: 696e 6b2e 7370 7269 6e67 6572 2e63 6f6d  ink.springer.com
+00003570: 2f61 7274 6963 6c65 2f31 302e 3130 3037  /article/10.1007
+00003580: 2f73 3130 3939 342d 3031 342d 3534 3533  /s10994-014-5453
+00003590: 2d30 290a 0a3c 6120 6964 3d22 3422 3e5b  -0)..<a id="4">[
+000035a0: 345d 3c2f 613e 2042 6f73 7472 c3b6 6d2c  4]</a> Bostr..m,
+000035b0: 2048 2e2c 204c 696e 7573 736f 6e2c 2048   H., Linusson, H
+000035c0: 2e2c 204c c3b6 6673 7472 c3b6 6d2c 2054  ., L..fstr..m, T
+000035d0: 2e20 616e 6420 4a6f 6861 6e73 736f 6e2c  . and Johansson,
+000035e0: 2055 2e2c 2032 3031 372e 2041 6363 656c   U., 2017. Accel
+000035f0: 6572 6174 696e 6720 6469 6666 6963 756c  erating difficul
+00003600: 7479 2065 7374 696d 6174 696f 6e20 666f  ty estimation fo
+00003610: 7220 636f 6e66 6f72 6d61 6c20 7265 6772  r conformal regr
+00003620: 6573 7369 6f6e 2066 6f72 6573 7473 2e20  ession forests. 
+00003630: 416e 6e61 6c73 206f 6620 4d61 7468 656d  Annals of Mathem
+00003640: 6174 6963 7320 616e 6420 4172 7469 6669  atics and Artifi
+00003650: 6369 616c 2049 6e74 656c 6c69 6765 6e63  cial Intelligenc
+00003660: 652c 2038 3128 312d 3229 2c20 7070 2e31  e, 81(1-2), pp.1
+00003670: 3235 2d31 3434 2e20 5b4c 696e 6b5d 2868  25-144. [Link](h
+00003680: 7474 7073 3a2f 2f6c 696e 6b2e 7370 7269  ttps://link.spri
+00003690: 6e67 6572 2e63 6f6d 2f61 7274 6963 6c65  nger.com/article
+000036a0: 2f31 302e 3130 3037 2f73 3130 3437 322d  /10.1007/s10472-
+000036b0: 3031 372d 3935 3339 2d39 290a 0a3c 6120  017-9539-9)..<a 
+000036c0: 6964 3d22 3522 3e5b 355d 3c2f 613e 2042  id="5">[5]</a> B
+000036d0: 6f73 7472 c3b6 6d2c 2048 2e20 616e 6420  ostr..m, H. and 
+000036e0: 4a6f 6861 6e73 736f 6e2c 2055 2e2c 2032  Johansson, U., 2
+000036f0: 3032 302e 204d 6f6e 6472 6961 6e20 636f  020. Mondrian co
+00003700: 6e66 6f72 6d61 6c20 7265 6772 6573 736f  nformal regresso
+00003710: 7273 2e20 496e 2043 6f6e 666f 726d 616c  rs. In Conformal
+00003720: 2061 6e64 2050 726f 6261 6269 6c69 7374   and Probabilist
+00003730: 6963 2050 7265 6469 6374 696f 6e20 616e  ic Prediction an
+00003740: 6420 4170 706c 6963 6174 696f 6e73 2e20  d Applications. 
+00003750: 504d 4c52 2c20 3132 382c 2070 702e 2031  PMLR, 128, pp. 1
+00003760: 3134 2d31 3333 2e20 5b4c 696e 6b5d 2868  14-133. [Link](h
+00003770: 7474 7073 3a2f 2f70 726f 6365 6564 696e  ttps://proceedin
+00003780: 6773 2e6d 6c72 2e70 7265 7373 2f76 3132  gs.mlr.press/v12
+00003790: 382f 626f 7374 726f 6d32 3061 2e68 746d  8/bostrom20a.htm
+000037a0: 6c29 0a0a 3c61 2069 643d 2236 223e 5b36  l)..<a id="6">[6
+000037b0: 5d3c 2f61 3e20 566f 766b 2c20 562e 2c20  ]</a> Vovk, V., 
+000037c0: 5065 7465 6a2c 2049 2e2c 204e 6f75 7265  Petej, I., Noure
+000037d0: 7464 696e 6f76 2c20 492e 2c20 4d61 6e6f  tdinov, I., Mano
+000037e0: 6b68 696e 2c20 562e 2061 6e64 2047 616d  khin, V. and Gam
+000037f0: 6d65 726d 616e 2c20 412e 2c20 3230 3230  merman, A., 2020
+00003800: 2e20 436f 6d70 7574 6174 696f 6e61 6c6c  . Computationall
+00003810: 7920 6566 6669 6369 656e 7420 7665 7273  y efficient vers
+00003820: 696f 6e73 206f 6620 636f 6e66 6f72 6d61  ions of conforma
+00003830: 6c20 7072 6564 6963 7469 7665 2064 6973  l predictive dis
+00003840: 7472 6962 7574 696f 6e73 2e20 4e65 7572  tributions. Neur
+00003850: 6f63 6f6d 7075 7469 6e67 2c20 3339 372c  ocomputing, 397,
+00003860: 2070 702e 3239 322d 3330 382e 205b 4c69   pp.292-308. [Li
+00003870: 6e6b 5d28 6874 7470 733a 2f2f 7777 772e  nk](https://www.
+00003880: 616d 696e 6572 2e6f 7267 2f70 7562 2f35  aminer.org/pub/5
+00003890: 6530 3961 6163 3964 6631 6139 6330 6334  e09aac9df1a9c0c4
+000038a0: 3136 6339 6237 302f 636f 6d70 7574 6174  16c9b70/computat
+000038b0: 696f 6e61 6c6c 792d 6566 6669 6369 656e  ionally-efficien
+000038c0: 742d 7665 7273 696f 6e73 2d6f 662d 636f  t-versions-of-co
+000038d0: 6e66 6f72 6d61 6c2d 7072 6564 6963 7469  nformal-predicti
+000038e0: 7665 2d64 6973 7472 6962 7574 696f 6e73  ve-distributions
+000038f0: 290a 0a3c 6120 6964 3d22 3722 3e5b 375d  )..<a id="7">[7]
+00003900: 3c2f 613e 2042 6f73 7472 c3b6 6d2c 2048  </a> Bostr..m, H
+00003910: 2e2c 204a 6f68 616e 7373 6f6e 2c20 552e  ., Johansson, U.
+00003920: 2061 6e64 204c c3b6 6673 7472 c3b6 6d2c   and L..fstr..m,
+00003930: 2054 2e2c 2032 3032 312e 204d 6f6e 6472   T., 2021. Mondr
+00003940: 6961 6e20 636f 6e66 6f72 6d61 6c20 7072  ian conformal pr
+00003950: 6564 6963 7469 7665 2064 6973 7472 6962  edictive distrib
+00003960: 7574 696f 6e73 2e20 496e 2043 6f6e 666f  utions. In Confo
+00003970: 726d 616c 2061 6e64 2050 726f 6261 6269  rmal and Probabi
+00003980: 6c69 7374 6963 2050 7265 6469 6374 696f  listic Predictio
+00003990: 6e20 616e 6420 4170 706c 6963 6174 696f  n and Applicatio
+000039a0: 6e73 2e20 504d 4c52 2c20 3135 322c 2070  ns. PMLR, 152, p
+000039b0: 702e 2032 342d 3338 2e20 5b4c 696e 6b5d  p. 24-38. [Link]
+000039c0: 2868 7474 7073 3a2f 2f70 726f 6365 6564  (https://proceed
+000039d0: 696e 6773 2e6d 6c72 2e70 7265 7373 2f76  ings.mlr.press/v
+000039e0: 3135 322f 626f 7374 726f 6d32 3161 2e68  152/bostrom21a.h
+000039f0: 746d 6c29 0a0a 3c61 2069 643d 2238 223e  tml)..<a id="8">
+00003a00: 5b38 5d3c 2f61 3e20 566f 766b 2c20 562e  [8]</a> Vovk, V.
+00003a10: 2c20 3230 3232 2e20 556e 6976 6572 7361  , 2022. Universa
+00003a20: 6c20 7072 6564 6963 7469 7665 2073 7973  l predictive sys
+00003a30: 7465 6d73 2e20 5061 7474 6572 6e20 5265  tems. Pattern Re
+00003a40: 636f 676e 6974 696f 6e2e 2031 3236 3a20  cognition. 126: 
+00003a50: 7070 2e20 3130 3835 3336 205b 4c69 6e6b  pp. 108536 [Link
+00003a60: 5d28 6874 7470 733a 2f2f 646c 2e61 636d  ](https://dl.acm
+00003a70: 2e6f 7267 2f64 6f69 2f61 6273 2f31 302e  .org/doi/abs/10.
+00003a80: 3130 3136 2f6a 2e70 6174 636f 672e 3230  1016/j.patcog.20
+00003a90: 3232 2e31 3038 3533 3629 0a0a 0a2d 202d  22.108536)...- -
+00003aa0: 202d 0a0a 4175 7468 6f72 3a20 4865 6e72   -..Author: Henr
+00003ab0: 696b 2042 6f73 7472 c3b6 6d20 2862 6f73  ik Bostr..m (bos
+00003ac0: 7472 6f6d 6840 6b74 682e 7365 290a 436f  tromh@kth.se).Co
+00003ad0: 7079 7269 6768 7420 3230 3233 2048 656e  pyright 2023 Hen
+00003ae0: 7269 6b20 426f 7374 72c3 b66d 0a4c 6963  rik Bostr..m.Lic
+00003af0: 656e 7365 3a20 4253 4420 3320 636c 6175  ense: BSD 3 clau
+00003b00: 7365 0a                                  se.
```

